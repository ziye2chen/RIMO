problem_id,problem,solution,solution_word_count,parts
2023a2,"Let $\mathbb{R}$ be the set of real numbers. Let $f: \mathbb{R} \rightarrow \mathbb{R}$ be a function such that

$$
f(x+y) f(x-y) \geqslant f(x)^{2}-f(y)^{2}
$$

for every $x, y \in \mathbb{R}$. Assume that the inequality is strict for some $x_{0}, y_{0} \in \mathbb{R}$.\\
Prove that $f(x) \geqslant 0$ for every $x \in \mathbb{R}$ or $f(x) \leqslant 0$ for every $x \in \mathbb{R}$.","We introduce the new variables $s:=x+y$ and $t:=x-y$. Equivalently, $x=\frac{s+t}{2}$ and $y=\frac{s-t}{2}$. The inequality becomes

$$
f(s) f(t) \geqslant f\left(\frac{s+t}{2}\right)^{2}-f\left(\frac{s-t}{2}\right)^{2}
$$

for every $s, t \in \mathbb{R}$. We replace $t$ by $-t$ to obtain

$$
f(s) f(-t) \geqslant f\left(\frac{s-t}{2}\right)^{2}-f\left(\frac{s+t}{2}\right)^{2}
$$

Summing the previous two inequalities gives

$$
f(s)(f(t)+f(-t)) \geqslant 0
$$

for every $s, t \in \mathbb{R}$. This inequality is strict for $s=x_{0}+y_{0}$ and $t=x_{0}-y_{0}$ by assumption. In particular, there exists some $t_{0}=x_{0}-y_{0}$ for which $f\left(t_{0}\right)+f\left(-t_{0}\right) \neq 0$. Since $f(s)\left(f\left(t_{0}\right)+\right.$ $\left.f\left(-t_{0}\right)\right) \geqslant 0$ for every $s \in \mathbb{R}$, we conclude that $f(s)$ must have constant sign.",96,1
2023a3,"Let $x_{1}, x_{2}, \ldots, x_{2023}$ be distinct real positive numbers such that

$$
a_{n}=\sqrt{\left(x_{1}+x_{2}+\cdots+x_{n}\right)\left(\frac{1}{x_{1}}+\frac{1}{x_{2}}+\cdots+\frac{1}{x_{n}}\right)}
$$

is an integer for every $n=1,2, \ldots, 2023$. Prove that $a_{2023} \geqslant 3034$.","We start with some basic observations. First note that the sequence $a_{1}, a_{2}, \ldots, a_{2023}$ is increasing and thus, since all elements are integers, $a_{n+1}-a_{n} \geqslant 1$. We also observe that $a_{1}=1$ and

$$
a_{2}=\sqrt{\left(x_{1}+x_{2}\right)\left(\frac{1}{x_{1}}+\frac{1}{x_{2}}\right)}>2
$$

by Cauchy-Schwarz inequality and using $x_{1} \neq x_{2}$. So, $a_{2} \geqslant 3$.\\
Now, we proceed to the main part of the argument. We observe that 3034 is about three halves of 2023. Motivated by this observation, we will prove the following.\\
Claim. If $a_{n+1}-a_{n}=1$, then $a_{n+2}-a_{n+1} \geqslant 2$.\\
In other words, the sequence has to increase by at least 2 at least half of the times. Assuming the claim is true, since $a_{1}=1$, we would be done since

$$
\begin{aligned}
a_{2023} & =\left(a_{2023}-a_{2022}\right)+\left(a_{2022}-a_{2021}\right)+\cdots+\left(a_{2}-a_{1}\right)+a_{1} \\
& \geqslant(2+1) \cdot 1011+1 \\
& =3034
\end{aligned}
$$

We now prove the claim. We start by observing that

$$
\begin{aligned}
a_{n+1}^{2}= & \left(x_{1}+\cdots+x_{n+1}\right)\left(\frac{1}{x_{1}}+\cdots+\frac{1}{x_{n+1}}\right) \\
= & \left(x_{1}+\cdots+x_{n}\right)\left(\frac{1}{x_{1}}+\cdots+\frac{1}{x_{n}}\right)+1 \\
& \quad+\frac{1}{x_{n+1}}\left(x_{1}+\cdots+x_{n}\right)+x_{n+1}\left(\frac{1}{x_{1}}+\cdots+\frac{1}{x_{n}}\right) \\
\geqslant & a_{n}^{2}+1+2 \sqrt{\frac{1}{x_{n+1}}\left(x_{1}+\cdots+x_{n}\right) \cdot x_{n+1}\left(\frac{1}{x_{1}}+\cdots+\frac{1}{x_{n}}\right)} \\
= & a_{n}^{2}+1+2 a_{n} \\
= & \left(a_{n}+1\right)^{2}
\end{aligned}
$$

where we used AM-GM to obtain the inequality. In particular, if $a_{n+1}=a_{n}+1$, then


\begin{equation*}
\frac{1}{x_{n+1}}\left(x_{1}+\cdots+x_{n}\right)=x_{n+1}\left(\frac{1}{x_{1}}+\cdots+\frac{1}{x_{n}}\right) . \tag{1}
\end{equation*}


Now, assume for the sake of contradiction that both $a_{n+1}=a_{n}+1$ and $a_{n+2}=a_{n+1}+1$ hold. In this case, (1) gives

$$
\frac{1}{x_{n+2}}\left(x_{1}+\cdots+x_{n+1}\right)=x_{n+2}\left(\frac{1}{x_{1}}+\cdots+\frac{1}{x_{n+1}}\right) .
$$

We can rewrite this relation as

$$
\frac{x_{n+1}}{x_{n+2}}\left(\frac{1}{x_{n+1}}\left(x_{1}+\cdots+x_{n}\right)+1\right)=\frac{x_{n+2}}{x_{n+1}}\left(x_{n+1}\left(\frac{1}{x_{1}}+\cdots+\frac{1}{x_{n}}\right)+1\right)
$$

From (1) again, we conclude that $x_{n+1}=x_{n+2}$ which is a contradiction.",229,2
2023a5,"Let $a_{1}, a_{2}, \ldots, a_{2023}$ be positive integers such that}
\begin{itemize}
  \item $a_{1}, a_{2}, \ldots, a_{2023}$ is a permutation of $1,2, \ldots, 2023$, and
  \item $\left|a_{1}-a_{2}\right|,\left|a_{2}-a_{3}\right|, \ldots,\left|a_{2022}-a_{2023}\right|$ is a permutation of $1,2, \ldots, 2022$.
\end{itemize}

Prove that $\max \left(a_{1}, a_{2023}\right) \geqslant 507$.","Let $N$ be a positive integer and $a_{1}, a_{2}, \ldots, a_{2 N-1}$ be positive integers such that

\begin{itemize}
  \item $a_{1}, a_{2}, \ldots, a_{2 N-1}$ is a permutation of $1,2, \ldots, 2 N-1$, and
  \item $\left|a_{1}-a_{2}\right|,\left|a_{2}-a_{3}\right|, \ldots,\left|a_{2 N-2}-a_{2 N-1}\right|$ is a permutation of $1,2, \ldots, 2 N-2$.
\end{itemize}

Then $a_{1}+a_{2 N-1} \geqslant N+1$ and hence $\max \left(a_{1}, a_{2 N-1}\right) \geqslant\left\lceil\frac{N+1}{2}\right\rceil$.\\
Now we proceed to the proof of the generalised statement. We introduce the notion of score of a number $a \in\{1,2, \ldots, 2 N-1\}$. The score of $a$ is defined to be

$$
s(a):=|a-N| .
$$

Note that, by the triangle inequality,

$$
|a-b| \leqslant|a-N|+|N-b|=s(a)+s(b) .
$$

Considering the sum $\left|a_{1}-a_{2}\right|+\left|a_{2}-a_{3}\right|+\cdots+\left|a_{2 N-2}-a_{2 N-1}\right|$, we find that

$$
\begin{aligned}
(N-1)(2 N-1) & =\left|a_{1}-a_{2}\right|+\left|a_{2}-a_{3}\right|+\cdots+\left|a_{2 N-2}-a_{2 N-1}\right| \\
& \leqslant 2\left(s\left(a_{1}\right)+s\left(a_{2}\right)+\cdots+s\left(a_{2 N-1}\right)\right)-\left(s\left(a_{1}\right)+s\left(a_{2 N-1}\right)\right) \\
& =2 N(N-1)-\left(s\left(a_{1}\right)+s\left(a_{2 N-1}\right)\right) .
\end{aligned}
$$

For the last equality we used that the numbers $s\left(a_{1}\right), s\left(a_{2}\right), \ldots, s\left(a_{2 N-1}\right)$ are a permutation of $0,1,1,2,2, \ldots, N-1, N-1$.

Hence, $s\left(a_{1}\right)+s\left(a_{2 N-1}\right) \leqslant 2 N(N-1)-(N-1)(2 N-1)=N-1$. We conclude that

$$
\left(N-a_{1}\right)+\left(N-a_{2 N-1}\right) \leqslant s\left(a_{1}\right)+s\left(a_{2 N-1}\right) \leqslant N-1,
$$

which implies $a_{1}+a_{2 N-1} \geqslant N+1$.",184,2
2023a7,"Let $N$ be a positive integer. Prove that there exist three permutations $a_{1}, a_{2}, \ldots, a_{N}$; $b_{1}, b_{2}, \ldots, b_{N}$; and $c_{1}, c_{2}, \ldots, c_{N}$ of $1,2, \ldots, N$ such that

$$
\left|\sqrt{a_{k}}+\sqrt{b_{k}}+\sqrt{c_{k}}-2 \sqrt{N}\right|<2023
$$

for every $k=1,2, \ldots, N$.","The idea is to approximate the numbers $\sqrt{1}, \sqrt{2}, \ldots, \sqrt{N}$ by the nearest integer with errors $<0.5$. This gives the following sequence

$$
1,1,2,2,2,2,3,3,3,3,3,3,4, \ldots
$$

More precisely, for each $k \geqslant 1$, we round $\sqrt{k^{2}-k+1}, \ldots, \sqrt{k^{2}+k}$ to $k$, so that there are $2 k$ copies of $k$.

Step 1. We first consider the easier case when $N$ has the form

$$
N=m(m+1) .
$$

In this case, the numbers $\sqrt{1}, \sqrt{2}, \ldots, \sqrt{N}$ are approximated by the elements of the multiset $\left\{1_{\times 2}, 2_{\times 4}, 3_{\times 6}, \ldots, m_{\times 2 m}\right\}$. Let $T_{m}$ denote ""half of"" the multiset, i.e.

$$
T_{m}:=\left\{1_{\times 1}, 2_{\times 2}, 3_{\times 3}, \ldots, m_{\times m}\right\} .
$$

We will prove by induction that there exists three permutations $\left(u_{k}\right),\left(v_{k}\right)$, and $\left(w_{k}\right)$ of the elements in the multiset $T_{m}$ such that $u_{k}+v_{k}+w_{k}=2 m+1$ is constant for $k=1,2, \ldots, \frac{m(m+1)}{2}$.

When $m=1$, take $1+1+1=3$. When $m=2$, take $(1,2,2)+(2,1,2)+(2,2,1)=(5,5,5)$. Suppose that we have constructed three permutations $\left(u_{k}\right),\left(v_{k}\right)$, and ( $w_{k}$ ) of $T_{m-1}$ satisfying $u_{k}+v_{k}+w_{k}=2 m-1$ for every $k=1,2, \ldots, \frac{m(m-1)}{2}$. For $T_{m}$, we note that

$$
T_{m}=T_{m-1} \sqcup\left\{m_{\times m}\right\},
$$

and also


\begin{equation*}
T_{m}=\left(T_{m-1}+1\right) \sqcup\{1,2, \ldots, m\} . \tag{1}
\end{equation*}


Here $T_{m-1}+1$ means to add 1 to all elements in $T_{m-1}$. We construct the permutations $\left(u_{k}^{\prime}\right)$, $\left(v_{k}^{\prime}\right)$, and ( $w_{k}^{\prime}$ ) of $T_{m}$ as follows:

\begin{itemize}
  \item For $k=1,2, \ldots, \frac{m(m-1)}{2}$, we set $u_{k}^{\prime}=u_{k}, v_{k}^{\prime}=v_{k}+1, w_{k}^{\prime}=w_{k}+1$.
  \item For $k=\frac{m(m-1)}{2}+r$ with $r=1,2, \ldots, m$, we set $u_{k}^{\prime}=m, v_{k}^{\prime}=r, w_{k}^{\prime}=m+1-r$.
\end{itemize}

It is clear from (1) that $\left(u_{k}^{\prime}\right),\left(v_{k}^{\prime}\right)$, and $\left(w_{k}^{\prime}\right)$ give three permutations of $T_{m}$, and that they satisfy $u_{k}^{\prime}+v_{k}^{\prime}+w_{k}^{\prime}=2 m+1$ for every $k=1,2, \ldots, \frac{m(m+1)}{2}$.

The inductive construction can be visualised by the $3 \times \frac{m(m+1)}{2}$ matrix

$$
\left[\begin{array}{cccccc}
u_{1} & \ldots & u_{m(m-1) / 2} & m & \ldots & m \\
v_{1}+1 & \ldots & v_{m(m-1) / 2}+1 & 1 & \ldots & m \\
w_{1}+1 & \ldots & w_{m(m-1) / 2}+1 & m & \ldots & 1
\end{array}\right],
$$

in which the three rows represent the permutations $\left(u_{k}^{\prime}\right),\left(v_{k}^{\prime}\right),\left(w_{k}^{\prime}\right)$, and the sum of the three entries of each column is $2 m+1$.

Thus, when $N=m^{2}+m$, we can construct permutations $\left(a_{k}\right),\left(b_{k}\right)$, and $\left(c_{k}\right)$ of $1,2, \ldots, N$ such that


\begin{equation*}
2 m+1-1.5<\sqrt{a_{k}}+\sqrt{b_{k}}+\sqrt{c_{k}}<2 m+1+1.5 \tag{2}
\end{equation*}


This gives

$$
\left|\sqrt{a_{k}}+\sqrt{b_{k}}+\sqrt{c_{k}}-2 \sqrt{N}\right|<2.5<2023
$$

where we used that $-1<2 m-2 \sqrt{m^{2}+m}<0$ for positive $m$.\\
Step 2. We now proceed to the general case. Let $m$ be such that

$$
m(m+1) \leqslant N<(m+1)(m+2)
$$

Write $N=m(m+1)+t$ for some $t \in\{0,1, \ldots, 2 m+1\}$ and let

$$
L:=\left\lfloor\frac{4}{9} N\right\rfloor .
$$

We will make use of the following inequalities below:

$$
N>m^{2}, \quad N<(m+2)^{2}, \quad t \leqslant 2 m+1, \quad L+1>4 N / 9, \quad L \leqslant 4 N / 9
$$

As above, we construct three permutations $\left(a_{k}\right),\left(b_{k}\right)$, and $\left(c_{k}\right)$ of $1,2, \ldots, m(m+1)$ satisfying (2). Now we construct the three required permutations $\left(A_{k}\right),\left(B_{k}\right)$, and $\left(C_{k}\right)$ of $1,2, \ldots, N$ as follows:

For $k=1,2, \ldots, m(m+1)$, if $a_{k} \leqslant L$, take $A_{k}=a_{k}$, and if $a_{k}>L$, take $A_{k}=a_{k}+t$. For $k=m(m+1)+r$ with $r=1,2, \ldots, t$, set $A_{k}=L+r$. Define the permutations $\left(B_{k}\right)$ and $\left(C_{k}\right)$ similarly. Now for $k=1,2, \ldots, m(m+1)$, we show $0 \leqslant \sqrt{A_{k}}-\sqrt{a_{k}} \leqslant 2$. The lower bound is obvious. If $m \leqslant 1$, then $N \leqslant 5$ and hence $\sqrt{A_{k}}-\sqrt{a_{k}} \leqslant \sqrt{5}-\sqrt{1} \leqslant 2$. If $m \geqslant 2$, then

$$
\sqrt{A_{k}}-\sqrt{a_{k}}=\frac{A_{k}-a_{k}}{\sqrt{A_{k}}+\sqrt{a_{k}}} \leqslant \frac{t}{2 \sqrt{L+1}} \leqslant \frac{2 m+1}{\frac{4}{3} m} \leqslant 2
$$

We have similar inequalities for $\left(B_{k}\right)$ and $\left(C_{k}\right)$. Thus

$$
2 \sqrt{N}-4.5<2 m+1-1.5 \leqslant \sqrt{A_{k}}+\sqrt{B_{k}}+\sqrt{C_{k}} \leqslant 2 m+1+1.5+6<2 \sqrt{N}+8.5
$$

For $k=m^{2}+m+1, \ldots, m^{2}+m+t$, we have

$$
2 \sqrt{N}<3 \sqrt{L+1} \leqslant \sqrt{A_{k}}+\sqrt{B_{k}}+\sqrt{C_{k}} \leqslant 3 \sqrt{L+t} \leqslant \sqrt{4 N+9 t}<2 \sqrt{N}+8.5
$$

To sum up, we have defined three permutations $\left(A_{k}\right),\left(B_{k}\right)$, and $\left(C_{k}\right)$ of $1,2, \ldots, N$, such that

$$
\left|\sqrt{A_{k}}+\sqrt{B_{k}}+\sqrt{C_{k}}-2 \sqrt{N}\right|<8.5<2023
$$

holds for every $k=1,2, \ldots, N$.
",629,4
2023c5,"Elisa has 2023 treasure chests, all of which are unlocked and empty at first. Each day, Elisa adds a new gem to one of the unlocked chests of her choice, and afterwards, a fairy acts according to the following rules:

\begin{itemize}
  \item if more than one chests are unlocked, it locks one of them, or
  \item if there is only one unlocked chest, it unlocks all the chests.
\end{itemize}

Given that this process goes on forever, prove that there is a constant $C$ with the following property: Elisa can ensure that the difference between the numbers of gems in any two chests never exceeds $C$, regardless of how the fairy chooses the chests to lock.","We will prove that such a constant $C$ exists when there are $n$ chests for $n$ an odd positive integer. In fact we can take $C=n-1$. Elisa's strategy is simple: place a gem in the chest with the fewest gems (in case there are more than one such chests, pick one arbitrarily).

For each integer $t \geqslant 0$, let $a_{1}^{t} \leqslant a_{2}^{t} \leqslant \cdots \leqslant a_{n}^{t}$ be the numbers of gems in the $n$ chests at the end of the $t^{\text {th }}$ day. In particular, $a_{1}^{0}=\cdots=a_{n}^{0}=0$ and

$$
a_{1}^{t}+a_{2}^{t}+\cdots+a_{n}^{t}=t .
$$

For each $t \geqslant 0$, there is a unique index $m=m(t)$ for which $a_{m}^{t+1}=a_{m}^{t}+1$. We know that $a_{j}^{t}>a_{m(t)}^{t}$ for all $j>m(t)$, since $a_{m(t)}^{t}<a_{m(t)}^{t+1} \leqslant a_{j}^{t+1}=a_{j}^{t}$. Elisa's strategy also guarantees that if an index $j$ is greater than the remainder of $t$ when divided by $n$ (i.e. the number of locked chests at the end of the $t^{\text {th }}$ day), then $a_{j}^{t} \geqslant a_{m(t)}^{t}$, because some chest with at most $a_{j}^{t}$ gems must still be unlocked at the end of the $t^{\text {th }}$ day.

Recall that a sequence $x_{1} \leqslant x_{2} \leqslant \cdots \leqslant x_{n}$ of real numbers is said to majorise another sequence $y_{1} \leqslant y_{2} \leqslant \cdots \leqslant y_{n}$ of real numbers when for all $1 \leqslant k \leqslant n$ we have

$$
x_{1}+x_{2}+\cdots+x_{k} \leqslant y_{1}+y_{2}+\cdots+y_{k}
$$

and

$$
x_{1}+x_{2}+\cdots+x_{n}=y_{1}+y_{2}+\cdots+y_{n} .
$$

Our strategy for proving $a_{n}^{t}-a_{1}^{t} \leqslant n-1$ is to inductively show that the sequence ( $a_{i}^{t}$ ) is majorised by some other sequence ( $b_{i}^{t}$ ).

We define this other sequence $\left(b_{i}^{t}\right)$ as follows. Let $b_{k}^{0}=k-\frac{n+1}{2}$ for $1 \leqslant k \leqslant n$. As $n$ is odd, this is a strictly increasing sequence of integers, and the sum of its terms is 0 . Now define $b_{i}^{t}=b_{i}^{0}+\left\lfloor\frac{t-i}{n}\right\rfloor+1$ for $t \geqslant 1$ and $1 \leqslant i \leqslant n$. Thus for $t \geqslant 0$,

$$
b_{i}^{t+1}=\left\{\begin{array}{lll}
b_{i}^{t} & \text { if } t+1 \not \equiv i & (\bmod n), \\
b_{i}^{t}+1 & \text { if } t+1 \equiv i & (\bmod n) .
\end{array}\right.
$$

From these properties it is easy to see that

\begin{itemize}
  \item $b_{1}^{t}+b_{2}^{t}+\cdots+b_{n}^{t}=t$ for all $t \geqslant 0$, and
  \item $b_{i}^{t} \leqslant b_{i+1}^{t}$ for all $t \geqslant 0$ and $1 \leqslant i \leqslant n-1$, with the inequality being strict if $t \not \equiv i(\bmod n)$.
\end{itemize}

Claim 1. For each $t \geqslant 0$, the sequence of integers $b_{1}^{t}, b_{2}^{t}, \ldots, b_{n}^{t}$ majorises the sequence of integers $a_{1}^{t}, a_{2}^{t}, \ldots, a_{n}^{t}$.

Proof. We use induction on $t$. The base case $t=0$ is trivial. Assume $t \geqslant 0$ and that $\left(b_{i}^{t}\right)$ majorises $\left(a_{i}^{t}\right)$. We want to prove the same holds for $t+1$.

First note that the two sequences $\left(b_{i}^{t+1}\right)$ and $\left(a_{i}^{t+1}\right)$ both sum up to $t+1$. Next, we wish to show that for $1 \leqslant k<n$, we have

$$
b_{1}^{t+1}+b_{2}^{t+1}+\cdots+b_{k}^{t+1} \leqslant a_{1}^{t+1}+a_{2}^{t+1}+\cdots+a_{k}^{t+1} .
$$

When $t+1$ is replaced by $t$, the above inequality holds by the induction hypothesis. For the sake of contradiction, suppose $k$ is the smallest index such that the inequality for $t+1$ fails. Since the left hand side increases by at most 1 during the transition from $t$ to $t+1$, the inequality for $t+1$ can fail only if all of the following occur:

\begin{itemize}
  \item $b_{1}^{t}+b_{2}^{t}+\cdots+b_{k}^{t}=a_{1}^{t}+a_{2}^{t}+\cdots+a_{k}^{t}$,
  \item $t+1 \equiv j(\bmod n)$ for some $1 \leqslant j \leqslant k\left(\right.$ so that $\left.b_{j}^{t+1}=b_{j}^{t}+1\right)$,
  \item $m(t)>k$ (so that $a_{i}^{t+1}=a_{i}^{t}$ for $\left.1 \leqslant i \leqslant k\right)$.
\end{itemize}

The first point and the minimality of $k$ tell us that $b_{1}^{t}, \ldots, b_{k}^{t}$ majorises $a_{1}^{t}, \ldots, a_{k}^{t}$ as well (again using the induction hypothesis), and in particular $b_{k}^{t} \geqslant a_{k}^{t}$.

The second point tells us that the remainder of $t$ when divided by $n$ is at most $k-1$, so $a_{k}^{t} \geqslant a_{m(t)}^{t}$ (by Elisa's strategy). But by the third point $(m(t) \geqslant k+1)$ and the nondecreasing property of $a_{i}^{t}$, we must have the equalities $a_{k}^{t}=a_{k+1}^{t}=a_{m(t)}^{t}$. On the other hand, $a_{k}^{t} \leqslant b_{k}^{t}<b_{k+1}^{t}$, with the second inequality being strict because $t \not \equiv k(\bmod n)$. We conclude that

$$
b_{1}^{t}+b_{2}^{t}+\cdots+b_{k+1}^{t}>a_{1}^{t}+a_{2}^{t}+\cdots+a_{k+1}^{t},
$$

a contradiction to the induction hypothesis.\\
This completes the proof as it implies

$$
a_{n}^{t}-a_{1}^{t} \leqslant b_{n}^{t}-b_{1}^{t} \leqslant b_{n}^{0}-b_{1}^{0}=n-1 .
$$",684,4
2023g1,"Let $A B C D E$ be a convex pentagon such that $\angle A B C=\angle A E D=90^{\circ}$. Suppose that the midpoint of $C D$ is the circumcentre of triangle $A B E$. Let $O$ be the circumcentre of triangle $A C D$.

Prove that line $A O$ passes through the midpoint of segment $B E$.","Let $M$ be the midpoint of $C D$ and $X=B C \cap E D$. Since $\angle A B X=\angle A E X=90^{\circ}, A X$ is a diameter of the circumcircle of $\triangle A B E$ so the midpoint of $A X$ is the circumcentre of $\triangle A B E$. Therefore, the midpoint of $A X$ coincides with $M$. This means $A C X D$ is a parallelogram and in particular, $A D \| B C$ and $A C \| E D$.

We denote the area of $\triangle P_{1} P_{2} P_{3}$ by $\left[P_{1} P_{2} P_{3}\right]$. To prove that line $A O$ bisects $B E$, it suffices to show $[O A B]=[O A E]$.

Let $C^{\prime}, D^{\prime}$ be the midpoints of $A C, A D$ respectively. Since $O D^{\prime} \perp A D, A D \| B C$, and $B C \perp A B$, we have $A B \| O D^{\prime}$, so $[O A B]=\left[D^{\prime} A B\right]$. Using $A D \| B C$ again, we have $\left[D^{\prime} A B\right]=\left[D^{\prime} A C\right]$. Therefore

$$
[O A B]=\left[D^{\prime} A B\right]=\left[D^{\prime} A C\right]=\frac{1}{2}[A C D] .
$$

Similarly

$$
[O A E]=\left[C^{\prime} A E\right]=\left[C^{\prime} A D\right]=\frac{1}{2}[A C D] .
$$

Combining these gives $[O A B]=[O A E]$.",202,2
2023g2,"Let $A B C$ be a triangle with $A C>B C$. Let $\omega$ be the circumcircle of triangle $A B C$ and let $r$ be the radius of $\omega$. Point $P$ lies on segment $A C$ such that $B C=C P$ and point $S$ is the foot of the perpendicular from $P$ to line $A B$. Let ray $B P$ intersect $\omega$ again at $D$ and let $Q$ lie on line $S P$ such that $P Q=r$ and $S, P, Q$ lie on the line in that order. Finally, let the line perpendicular to $C Q$ from $A$ intersect the line perpendicular to $D Q$ from $B$ at $E$.

Prove that $E$ lies on $\omega$.","First observe that

$$
\angle D P A=\angle B P C^{C P=C B} \angle \angle C B P=\angle C B D=\angle C A D=\angle P A D
$$

so $D P=D A$. Thus there is a symmetry in the problem statement swapping $(A, D) \leftrightarrow(B, C)$.\\
Let $O$ be the centre of $\omega$ and let $E$ be the reflection of $P$ in $C D$ which, by

$$
\angle C E D=\angle D P C=180^{\circ}-\angle C P B B^{C P=C B}={ }^{\circ} 180^{\circ}-\angle P B C=180^{\circ}-\angle D B C
$$

lies on $\omega$. We claim the two lines concur at $E$. By the symmetry noted above, it suffices to prove that $B E \perp D Q$ and then $A E \perp C Q$ will follow by symmetry.

We have $A O=P Q, A D=D P$ and

$$
\angle D A O=90^{\circ}-\angle A B D^{P Q \perp A B} \angle D P Q .
$$

Hence $\triangle A O D \cong \triangle P Q D$. Thus\\
$\angle Q D B+\angle D B E=\angle O D A+\angle D A E \stackrel{D E=D A}{=} \angle O D A+\angle A E D=\left(90^{\circ}-\angle A E D\right)+\angle A E D=90^{\circ}$ giving $B E \perp D Q$ as required.",201,2
2023g3,"Let $A B C D$ be a cyclic quadrilateral with $\angle B A D<\angle A D C$. Let $M$ be the midpoint of the arc $C D$ not containing $A$. Suppose there is a point $P$ inside $A B C D$ such that $\angle A D B=$ $\angle C P D$ and $\angle A D P=\angle P C B$.

Prove that lines $A D, P M, B C$ are concurrent.","Let $X$ and $Y$ be the intersection points of $A M$ and $B M$ with $P D$ and $P C$ respectively. Since $A B C M D$ is cyclic and $C M=M D$, we have

$$
\angle X A D=\angle M A D=\angle C B M=\angle C B Y .
$$

Combining this with $\angle A D X=\angle Y C B$, we get $\angle D X A=\angle B Y C$, and so $\angle P X M=\angle M Y P$. Moreover, $\angle Y P X=\angle C P D=\angle A D B=\angle A M B$. The quadrilateral $M X P Y$ therefore has equal opposite angles and so is a parallelogram.\\
\includegraphics[max width=\textwidth, center]{2025_04_28_d3623935e31baf0b55e8g-63}

Let $R$ and $S$ be the intersection points of $A M$ and $B M$ with $B C$ and $A D$ respectively. Due to $A M \| P C$ and $B M \| P D$, we have $\angle A S B=\angle A D P=\angle P C B=\angle A R B$ and so the quadrilateral $A B R S$ is cyclic. We then have $\angle S R B=180^{\circ}-\angle B A S=\angle D C B$ and so $S R \| C D$. In triangles $P C D$ and $M R S$, the corresponding sides are parallel so they are homothetic meaning lines $D S, P M, C R$ concur at the centre of this homothety.",224,2
2023g4,"Let $A B C$ be an acute-angled triangle with $A B<A C$. Denote its circumcircle by $\Omega$ and denote the midpoint of arc $C A B$ by $S$. Let the perpendicular from $A$ to $B C$ meet $B S$ and $\Omega$ at $D$ and $E \neq A$ respectively. Let the line through $D$ parallel to $B C$ meet line $B E$ at $L$ and denote the circumcircle of triangle $B D L$ by $\omega$. Let $\omega$ meet $\Omega$ again at $P \neq B$.

Prove that the line tangent to $\omega$ at $P$, and line $B S$ intersect on the internal bisector of $\angle B A C$.","Let $S^{\prime}$ be the midpoint of arc $B C$ of $\Omega$, diametrically opposite to $S$ so $S S^{\prime}$ is a diameter in $\Omega$ and $A S^{\prime}$ is the angle bisector of $\angle B A C$. Let the tangent of $\omega$ at $P$ meet $\Omega$ again at $Q \neq P$, then we have $\angle S Q S^{\prime}=90^{\circ}$.

We will show that triangles $A P D$ and $S^{\prime} Q S$ are similar and their corresponding sides are parallel. Then it will follow that the lines connecting the corresponding vertices, namely line $A S^{\prime}$, that is the angle bisector of $\angle B A C$, line $P Q$, that is the tangent to $\omega$ at $P$, and $D S$ are concurrent. Note that the sides $A D$ and $S^{\prime} S$ have opposite directions, so the three lines cannot be parallel.\\
\includegraphics[max width=\textwidth, center]{2025_04_28_d3623935e31baf0b55e8g-65}

First we show that $A P \perp D P$. Indeed, from cyclic quadrilaterals $A P B E$ and $D P L B$ we can see that

$$
\angle P A D=\angle P A E=180^{\circ}-\angle E B P=\angle P B L=\angle P D L=90^{\circ}-\angle A D P .
$$

Then, in triangle $A P D$ we have $\angle D P A=180^{\circ}-\angle P A D-\angle A D P=90^{\circ}$.\\
Now we can see that:

\begin{itemize}
  \item Both lines $A D E$ and $S S^{\prime}$ are perpendicular to $B C$, so $A D \| S^{\prime} S$.
  \item Line $P Q$ is tangent to circle $\omega$ at $P$ so $\angle D P Q=\angle D B P=\angle S B P=\angle S Q P$; it follows that $P D \| Q S$.
  \item Finally, since $A P \perp P D \| Q S \perp S^{\prime} Q$, we have $A P \| S^{\prime} Q$ as well.
\end{itemize}

Hence the corresponding sides of triangles $A P D$ and $S^{\prime} Q S$ are parallel completing the solution.",306,3
2023g6,"Let $A B C$ be an acute-angled triangle with circumcircle $\omega$. A circle $\Gamma$ is internally tangent to $\omega$ at $A$ and also tangent to $B C$ at $D$. Let $A B$ and $A C$ intersect $\Gamma$ at $P$ and $Q$ respectively. Let $M$ and $N$ be points on line $B C$ such that $B$ is the midpoint of $D M$ and $C$ is the midpoint of $D N$. Lines $M P$ and $N Q$ meet at $K$ and intersect $\Gamma$ again at $I$ and $J$ respectively. The ray $K A$ meets the circumcircle of triangle $I J K$ at $X \neq K$.

Prove that $\angle B X P=\angle C X Q$.","Let $M P$ and $N Q$ intersect $A D$ at $K_{1}$ and $K_{2}$ respectively. By applying Menelaus' theorem to triangle $A B D$ and line $M P K_{1}$, we have

$$
\frac{A K_{1}}{K_{1} D}=\frac{A P}{P B} \cdot \frac{B M}{M D}=\frac{A P}{2 P B}
$$

and similarly $\frac{A K_{2}}{K_{2} D}=\frac{A Q}{2 Q C}$. A homothety at $A$ takes $\Gamma \rightarrow \omega$ and $D$ to the midpoint of arc $B C$ not containing $A$, so $P Q \| B C$ and $A D$ bisects $\angle B A C$. Thus

$$
\frac{A K_{1}}{K_{1} D}=\frac{A P}{2 P B}=\frac{A Q}{2 Q C}=\frac{A K_{2}}{K_{2} D}
$$

which implies $K_{1} \equiv K_{2}$, and $K$ lies on $A D$.\\
Then we obtain

$$
\angle J X D=\angle J X K=\angle J I K=\angle J I P=\angle J Q P=\angle J N D
$$

where the last equality follows from $P Q \| B C$. This shows $J X N D$ is cyclic and hence

$$
\angle D X N=\angle D J N=\angle D J Q=\angle D A Q=\angle D A C
$$

which shows $A C \| X N$. As $C$ is the midpoint of $D N, A$ is the midpoint of $X D$.\\
Now observe that $\angle A D P=\angle A Q P=\angle A C B$ and $\angle P A D=\angle D A C=\frac{\angle A}{2}$ so triangle $A P D$ and $A D C$ are similar. Therefore we have

$$
\frac{C D}{D P}=\frac{A D}{A P}=\frac{X A}{A P}
$$

and also have

$$
\angle C D P=180^{\circ}-\angle P D B=180^{\circ}-\angle P A D=\angle X A P .
$$

Combining the two results gives triangles $P D C$ and $P A X$ are similar, which shows $P$ is the centre of spiral similarity taking $C D \rightarrow X A$. Hence also triangles $P X C$ and $P A D$ are similar which shows $\angle P X C=\angle P A D=\frac{\angle A}{2}$. This gives

$$
\angle B X P=\angle B X C-\angle P X C=\angle B X C-\frac{\angle A}{2}
$$

which is symmetric in $B, C$ giving the result.",339,3
2023g7,"Let $A B C$ be an acute, scalene triangle with orthocentre $H$. Let $\ell_{a}$ be the line through the reflection of $B$ with respect to $C H$ and the reflection of $C$ with respect to $B H$. Lines $\ell_{b}$ and $\ell_{c}$ are defined similarly. Suppose lines $\ell_{a}, \ell_{b}$, and $\ell_{c}$ determine a triangle $\mathcal{T}$.

Prove that the orthocentre of $\mathcal{T}$, the circumcentre of $\mathcal{T}$ and $H$ are collinear.","We write $\triangle P_{1} P_{2} P_{3} \stackrel{ \pm}{ } \triangle Q_{1} Q_{2} Q_{3}$ (resp. $\triangle P_{1} P_{2} P_{3} \approx \triangle Q_{1} Q_{2} Q_{3}$ ) to indicate that two triangles are directly (resp. oppositely) similar. We use directed angles throughout denoted with $\Varangle$.

Denote by $A_{b}, A_{c}$ the reflections of $A$ in $B H$ and $C H$ respectively. $B_{c}, B_{a}$ and $C_{a}, C_{b}$ are defined similarly. By definition, $\ell_{a}=B_{c} C_{b}, \ell_{b}=C_{a} A_{c}, \ell_{c}=A_{b} B_{a}$. Let $A_{1}=\ell_{b} \cap \ell_{c}$, $B_{1}=\ell_{c} \cap \ell_{a}, C_{1}=\ell_{a} \cap \ell_{b}$ and let $O_{1}, H_{1}$ be the orthocentre and circumcentre of $\mathcal{T} \equiv \triangle A_{1} B_{1} C_{1}$ respectively.

Claim 1. $\triangle A A_{b} A_{c} \approx \triangle A B C$.\\
Proof. Let $P=B H \cap A C, Q=C H \cap A B$, then it is well known that $\triangle A P Q \approx \triangle A B C$. By the dilation with factor 2 centred at $A, \triangle A P Q$ is sent to $\triangle A A_{b} A_{c}$, so we have $\triangle A A_{b} A_{c} \sim \triangle A B C$.

Claim 2. $\triangle A A_{b} A_{c} \stackrel{\perp}{\sim} \triangle A B_{a} C_{a}$ and $A_{1}$ lies on the circumcircle of $\triangle A A_{b} A_{c}$ which is centred at H.

Proof. Since $B_{a}, C_{a}$ are reflections of $B, C$ in $A H$, we have $\triangle A B_{a} C_{a} \approx \triangle A B C$. Combining this with Claim 1, we have $\triangle A A_{b} A_{c} \stackrel{\downarrow}{\sim} \triangle A B_{a} C_{a}$, where $A$ is the centre of this similarity. Therefore, $\Varangle A_{c} A_{1} A_{b}=\Varangle A_{c} A A_{b}$ meaning $A_{1}$ lies on $\odot A A_{b} A_{c}$. By symmetry, $H A_{b}=H A=H A_{c}$, so $H$ is centre of this circle.

Claim 3. $\triangle A_{1} B_{1} C_{1} \sim \triangle A B C$.\\
Proof. From Claim 2 we have

$$
\Varangle C_{1} A_{1} B_{1}=\Varangle A_{c} A_{1} A_{b} \stackrel{\text { Claim } 2}{=} \not A_{c} A A_{b}=-\Varangle C A B
$$

and similarly $\Varangle A_{1} B_{1} C_{1}=-\Varangle A B C, \Varangle B_{1} C_{1} A_{1}=-\Varangle B C A$, which imply $\triangle A_{1} B_{1} C_{1} \approx \triangle A B C$.

Denote the ratio of similitude of $\triangle A_{1} B_{1} C_{1}$ and $\triangle A B C$ by $\lambda\left(=\frac{B_{1} C_{1}}{B C}\right)$, then

$$
\lambda=\frac{H_{1} A_{1}}{H A}=\frac{H_{1} B_{1}}{H B}=\frac{H_{1} C_{1}}{H C} .
$$

Since $H A=H A_{1}$ and similarly $H B=H B_{1}, H C=H C_{1}$ from Claim 2, we get

$$
\lambda=\frac{H_{1} A_{1}}{H A_{1}}=\frac{H_{1} B_{1}}{H B_{1}}=\frac{H_{1} C_{1}}{H C_{1}} .
$$

Therefore, the circle $A_{1} B_{1} C_{1}$ is the Apollonian circle of the segment $H H_{1}$ with ratio $\lambda$ so the line $H H_{1}$ passes through $O_{1}$.",421,3
2023g8,"Let $A B C$ be an equilateral triangle. Points $A_{1}, B_{1}, C_{1}$ lie inside triangle $A B C$ such that triangle $A_{1} B_{1} C_{1}$ is scalene, $B A_{1}=A_{1} C, C B_{1}=B_{1} A, A C_{1}=C_{1} B$ and

$$
\angle B A_{1} C+\angle C B_{1} A+\angle A C_{1} B=480^{\circ} .
$$

Lines $B C_{1}$ and $C B_{1}$ intersect at $A_{2}$; lines $C A_{1}$ and $A C_{1}$ intersect at $B_{2}$; and lines $A B_{1}$ and $B A_{1}$ intersect at $C_{2}$.

Prove that the circumcircles of triangles $A A_{1} A_{2}, B B_{1} B_{2}, C C_{1} C_{2}$ have two common points.","Let $\delta_{A}, \delta_{B}, \delta_{C}$ be the circumcircles of $\triangle A A_{1} A_{2}, \triangle B B_{1} B_{2}, \triangle C C_{1} C_{2}$. The general strategy of the solution is to find two different points having equal power with respect to $\delta_{A}, \delta_{B}, \delta_{C}$.\\
Claim. $A_{1}$ is the circumcentre of $A_{2} B C$ and cyclic variations.\\
Proof. Since $A_{1}$ lies on the perpendicular bisector of $B C$ and inside $\triangle B A_{2} C$, it suffices to prove $\angle B A_{1} C=2 \angle B A_{2} C$. This follows from

$$
\begin{aligned}
\angle B A_{2} C & =\angle A_{2} B A+\angle B A C+\angle A C A_{2} \\
& =\frac{1}{2}\left(\left(180^{\circ}-\angle A C_{1} B\right)+\left(180^{\circ}-\angle C B_{1} A\right)\right)+60^{\circ} \\
& =240^{\circ}-\frac{1}{2}\left(480^{\circ}-\angle B A_{1} C\right) \\
& =\frac{1}{2} \angle B A_{1} C
\end{aligned}
$$

\begin{center}
\includegraphics[max width=\textwidth]{2025_04_28_d3623935e31baf0b55e8g-80}
\end{center}

The circumcentres above give

$$
\angle B_{1} B_{2} C_{1}=\angle B_{1} B_{2} A=\angle B_{2} A B_{1}=\angle C_{1} A C_{2}=\angle A C_{2} C_{1}=\angle B_{1} C_{2} C_{1}
$$

and so $B_{1} C_{1} B_{2} C_{2}$ is cyclic. Likewise $C_{1} A_{1} C_{2} A_{2}$ and $A_{1} B_{1} A_{2} B_{2}$ are cyclic. Note that hexagon $A_{1} B_{2} C_{1} A_{2} B_{1} C_{2}$ is not cyclic since

$$
\angle C_{2} A_{1} B_{2}+\angle B_{2} C_{1} A_{2}+\angle A_{2} B_{1} C_{2}=480^{\circ} \neq 360^{\circ} .
$$

Thus we can apply radical axis theorem to the three circles to show that $A_{1} A_{2}, B_{1} B_{2}, C_{1}, C_{2}$ concur at a point $X$ and this point has equal power with respect to $\delta_{A}, \delta_{B}, \delta_{C}$.

Let the circumcircle of $\triangle A_{2} B C$ meet $\delta_{A}$ at $A_{3} \neq A_{2}$. Define $B_{3}$ and $C_{3}$ similarly.\\
Claim. $\mathrm{BCB}_{3} C_{3}$ cyclic.\\
Proof. Using directed angles


\begin{align*}
\Varangle B C_{3} C & =\Varangle B C_{3} C_{2}+\Varangle C_{2} C_{3} C \\
& =\Varangle B A C_{2}+\Varangle C_{2} C_{1} C \\
& =90^{\circ}+\Varangle\left(C_{1} C, A C_{2}\right)+\Varangle C_{2} C_{1} C  \tag{1}\\
& =90^{\circ}+\Varangle C_{1} C_{2} B_{1} .
\end{align*}


Similarly $\Varangle C B_{3} B=90^{\circ}+\Varangle B_{1} B_{2} C_{1}$. Hence, using $B_{1} C_{1} B_{2} C_{2}$ cyclic

$$
\Varangle B B_{3} C=90^{\circ}+\Varangle C_{1} B_{2} B_{1}=90^{\circ}+\Varangle C_{1} C_{2} B_{1}=\Varangle B C_{3} C
$$

as required.\\
\includegraphics[max width=\textwidth, center]{2025_04_28_d3623935e31baf0b55e8g-81}

Similarly $C A C_{3} A_{3}$ and $A B A_{3} B_{3}$ are cyclic. $A C_{3} B A_{3} C B_{3}$ is not cyclic because then $A B_{2} C B_{3}$ cyclic would mean $B_{2}$ lies on $\odot A B C$ which is impossible since $B_{2}$ lies inside $\triangle A B C$. Thus we can apply radical axis theorem to the three circles to get $A A_{3}, B B_{3}, C C_{3}$ concur at a point $Y$ which has equal power with respect to $\delta_{A}, \delta_{B}, \delta_{C}$.

We now make some technical observations before finishing.

\begin{itemize}
  \item Let $O$ be the centre of $\triangle A B C$. We have that
\end{itemize}

$$
\angle B A_{1} C=480^{\circ}-\angle C B_{1} A-\angle A C_{1} B>480^{\circ}-180^{\circ}-180^{\circ}=120^{\circ} .
$$

so $A_{1}$ lies inside $\triangle B O C$. We have similar results for $B_{1}, C_{1}$ and thus $\triangle B A_{1} C, \triangle C B_{1} A$, $\triangle A C_{1} B$ have disjoint interiors. It follows that $A_{1} B_{2} C_{1} A_{2} B_{1} C_{2}$ is a convex hexagon thus $X$ lies on segment $A_{1} A_{2}$ and therefore is inside $\delta_{A}$.

\begin{itemize}
  \item Since $A_{1}$ is the centre of $A_{2} B C$ we have that $A_{1} A_{2}=A_{1} A_{3}$ so, from cyclic quadrilateral $A A_{2} A_{1} A_{3}$ we get that lines $A A_{2}$ and $A A_{3} \equiv A Y$ are reflections in line $A A_{1}$. As $X$ lies on segment $A_{1} A_{2}$, the only way $X \equiv Y$ is if $A_{1}$ and $A_{2}$ both lie on the perpendicular bisector of $B C$. But this forces $B_{1}$ and $C_{1}$ to also be reflections in this line meaning $A_{1} B_{1}=A_{1} C_{1}$ contradicting the scalene condition.
\end{itemize}

Summarising, we have distinct points $X, Y$ with equal power with respect to $\delta_{A}, \delta_{B}, \delta_{C}$ thus these circles have a common radical axis. As $X$ lies inside $\delta_{A}$ (and similarly $\delta_{B}, \delta_{C}$ ), this radical axis intersects the circles at two points and so $\delta_{A}, \delta_{B}, \delta_{C}$ have two points in common.",662,4
2023n3,For positive integers $n$ and $k \geqslant 2$ define $E_{k}(n)$ as the greatest exponent $r$ such that $k^{r}$ divides $n!$. Prove that there are infinitely many $n$ such that $E_{10}(n)>E_{9}(n)$ and infinitely many $m$ such that $E_{10}(m)<E_{9}(m)$.," We let $v_{p}(m)$ denote the $p$-adic valuation of $m$. By Legendre's Formula we know, for $p$ prime, that $v_{p}(n!)=\lfloor n / p\rfloor+\left\lfloor n / p^{2}\right\rfloor+\cdots$. We can see that $E_{9}(n)=\left\lfloor\frac{v_{3}(n!)}{2}\right\rfloor$. Since $v_{5}(n!) \leqslant v_{2}(n!)$ and $E_{10}(n)=\min \left(v_{5}(n!), v_{2}(n!)\right)$, we have $E_{10}(n)=v_{5}(n!)$.

Let $l$ be a positive integer. Set $n=5^{2 l-1}$. Then we have

$$
E_{10}(n)=v_{5}(n!)=5^{2 l-2}+5^{2 l-3}+\cdots+5+1=\frac{5^{2 l-1}-1}{4}=\frac{n-1}{4} .
$$

Since $n=5^{2 l-1} \equiv 2(\bmod 3)$, we have $\left\lfloor\frac{n}{3}\right\rfloor=\frac{n-2}{3}$ and it implying

$$
v_{3}(n!)=\left\lfloor\frac{n}{3}\right\rfloor+\left\lfloor\frac{n}{3^{2}}\right\rfloor+\left\lfloor\frac{n}{3^{3}}\right\rfloor+\cdots<\frac{n-2}{3}+\frac{n}{3^{2}}+\frac{n}{3^{3}}+\cdots=\frac{n}{2}-\frac{2}{3} .
$$

From this we obtain

$$
E_{9}(n)=\left\lfloor\frac{v_{3}(n!)}{2}\right\rfloor \leqslant \frac{v_{3}(n!)}{2} \leqslant \frac{n}{4}-\frac{1}{3}<\frac{n}{4}-\frac{1}{4}=E_{10}(n) .
$$

In a similar way, we set now $m=3^{4 l-2}$. Then we have

$$
v_{3}(m!)=3^{4 l-3}+3^{4 l-4}+\cdots+3+1=\frac{3^{4 l-2}-1}{2}=\frac{m-1}{2} .
$$

Note that $m=3^{4 l-2} \equiv 1(\bmod 4)$ and hence $E_{9}(m)=\left\lfloor\frac{v_{3}(m!)}{2}\right\rfloor=\left\lfloor\frac{m-1}{4}\right\rfloor=\frac{m-1}{4}$. We also have $m=3^{4 l-2} \equiv 4(\bmod 5)$ implying $\left\lfloor\frac{m}{5}\right\rfloor=\frac{m-4}{5}$. Therefore we obtain

$$
E_{10}(m)=v_{5}(m!)=\left\lfloor\frac{m}{5}\right\rfloor+\left\lfloor\frac{m}{5^{2}}\right\rfloor+\cdots<\frac{m-4}{5}+\frac{m}{5^{2}}+\cdots=\frac{m}{4}-\frac{4}{5}<\frac{m}{4}-\frac{1}{4}=E_{9}(m) .
$$

We can take infinitely many $n=5^{2 l-1}$ and $m=3^{4 l-2}$ completing the proof.\\",147,2
2023n5,"Let $a_{1}<a_{2}<a_{3}<\cdots$ be positive integers such that $a_{k+1}$ divides $2\left(a_{1}+a_{2}+\cdots+a_{k}\right)$ for every $k \geqslant 1$. Suppose that for infinitely many primes $p$, there exists $k$ such that $p$ divides $a_{k}$. Prove that for every positive integer $n$, there exists $k$ such that $n$ divides $a_{k}$.","For every $k \geqslant 2$ define the quotient $b_{k}=2\left(a_{1}+\cdots+a_{k-1}\right) / a_{k}$, which must be a positive integer. We first prove the following properties of the sequence $\left(b_{k}\right)$ :\\
Claim 1. We have $b_{k+1} \leqslant b_{k}+1$ for all $k \geqslant 2$.\\
Proof. By subtracting $b_{k} a_{k}=2\left(a_{1}+\cdots+a_{k-1}\right)$ from $b_{k+1} a_{k+1}=2\left(a_{1}+\cdots+a_{k}\right)$, we find that $b_{k+1} a_{k+1}=b_{k} a_{k}+2 a_{k}=\left(b_{k}+2\right) a_{k}$. From $a_{k}<a_{k+1}$ it follows that $b_{k}+2>b_{k+1}$.\\
Claim 2. The sequence $\left(b_{k}\right)$ is unbounded.\\
Proof. We start by rewriting $b_{k+1} a_{k+1}=\left(b_{k}+2\right) a_{k}$ as

$$
\left.a_{k+1}=a_{k} \cdot \frac{b_{k}+2}{b_{k+1}} \Longrightarrow a_{k+1} \right\rvert\, a_{k}\left(b_{k}+2\right) .
$$

If the sequence $\left(b_{k}\right)$ were bounded, say by some positive integer $B$, then the prime factors of the terms of the sequence $\left(a_{k}\right)$ could only be primes less than or equal to $B+2$ or those dividing $a_{1}$ or $a_{2}$, which contradicts the property in the statement of the problem.

Consider now an arbitrary positive integer $n$. We assume $n>b_{2}$, otherwise we replace $n$ by an arbitrary multiple of $n$ that is bigger than $b_{2}$. By Claim 2, there exists $k$ such that $b_{k+1} \geqslant n$. Consider the smallest such $k$. From Claim 1, it follows that we must have $b_{k}=n-1$ and $b_{k+1}=n$ (we assumed $n>b_{2}$ to ensure that $k \geqslant 2$ ). We now find that

$$
a_{k+1}=a_{k} \cdot \frac{b_{k}+2}{b_{k+1}}=a_{k} \cdot \frac{n+1}{n} .
$$

Because $n$ and $n+1$ are coprime, this immediately implies that $a_{k}$ is divisible by $n$.",227,2
2023n6,"A sequence of integers $a_{0}, a_{1}, a_{2}, \ldots$ is called kawaii, if $a_{0}=0, a_{1}=1$, and, for any positive integer $n$, we have

$$
\left(a_{n+1}-3 a_{n}+2 a_{n-1}\right)\left(a_{n+1}-4 a_{n}+3 a_{n-1}\right)=0 .
$$

An integer is called kawaii if it belongs to a kawaii sequence.\\
Suppose that two consecutive positive integers $m$ and $m+1$ are both kawaii (not necessarily belonging to the same kawaii sequence). Prove that 3 divides $m$, and that $m / 3$ is kawaii.","We start by rewriting the condition in the problem as:

$$
a_{n+1}=3 a_{n}-2 a_{n-1} \text {, or } a_{n+1}=4 a_{n}-3 a_{n-1} \text {. }
$$

We have $a_{n+1} \equiv a_{n}$ or $a_{n-1}(\bmod 2)$ and $a_{n+1} \equiv a_{n-1}$ or $a_{n}(\bmod 3)$ for all $n \geqslant 1$. Now, since $a_{0}=0$ and $a_{1}=1$, we have that $a_{n} \equiv 0,1 \bmod 3$ for all $n \geqslant 0$. Since $m$ and $m+1$ are kawaii integers, then necessarily $m \equiv 0 \bmod 3$.

We also observe that $a_{2}=3$ or $a_{2}=4$. Moreover,\\
(1) If $a_{2}=3$, then $a_{n} \equiv 1(\bmod 2)$ for all $n \geqslant 1$ since $a_{1} \equiv a_{2} \equiv 1(\bmod 2)$.\\
(2) If $a_{2}=4$, then $a_{n} \equiv 1(\bmod 3)$ for all $n \geqslant 1$ since $a_{1} \equiv a_{2} \equiv 1(\bmod 3)$.

Since $m \equiv 0(\bmod 3)$, any kawaii sequence containing $m$ does not satisfy (2), so it must satisfy (1). Hence, $m$ is odd and $m+1$ is even.

Take a kawaii sequence $\left(a_{n}\right)$ containing $m+1$. Let $t \geqslant 2$ be such that $a_{t}=m+1$. As $\left(a_{n}\right)$ does not satisfy (1), it must satisfy (2). Then $a_{n} \equiv 1(\bmod 3)$ for all $n \geqslant 1$. We define the sequence $a_{n}^{\prime}=\left(a_{n+1}-1\right) / 3$. This is a kawaii sequence: $a_{0}^{\prime}=0, a_{1}^{\prime}=1$ and for all $n \geqslant 1$, $\left(a_{n+1}^{\prime}-3 a_{n}^{\prime}+2 a_{n-1}^{\prime}\right)\left(a_{n+1}^{\prime}-4 a_{n}^{\prime}+3 a_{n-1}^{\prime}\right)=\left(a_{n+2}-3 a_{n+1}+2 a_{n}\right)\left(a_{n+2}-4 a_{n+1}+3 a_{n}\right) / 9=0$.

Finally, we notice that the term $a_{t-1}^{\prime}=m / 3$ which implies that $m / 3$ is kawaii.",235,2
2022a1,"Let $\left(a_{n}\right)_{n \geqslant 1}$ be a sequence of positive real numbers with the property that

$$
\left(a_{n+1}\right)^{2}+a_{n} a_{n+2} \leqslant a_{n}+a_{n+2}
$$

for all positive integers $n$. Show that $a_{2022} \leqslant 1$.","We begin by observing that $\left(a_{n+1}\right)^{2}-1 \leqslant a_{n}+a_{n+2}-a_{n} a_{n+2}-1$, which is equivalent to

$$
\left(a_{n+1}\right)^{2}-1 \leqslant\left(1-a_{n}\right)\left(a_{n+2}-1\right) .
$$

Suppose now that there exists a positive integer $n$ such that $a_{n+1}>1$ and $a_{n+2}>1$. Since $\left(a_{n+1}\right)^{2}-1 \leqslant\left(1-a_{n}\right)\left(a_{n+2}-1\right)$, we deduce that $0<1-a_{n}<1<1+a_{n+2}$, thus $\left(a_{n+1}\right)^{2}-1<\left(a_{n+2}+1\right)\left(a_{n+2}-1\right)=\left(a_{n+2}\right)^{2}-1$.

On the other hand, $\left(a_{n+2}\right)^{2}-1 \leqslant\left(1-a_{n+3}\right)\left(a_{n+1}-1\right)<\left(1+a_{n+1}\right)\left(a_{n+1}-1\right)=\left(a_{n+1}\right)^{2}-1$, a contradiction. We have shown that we cannot have two consecutive terms, except maybe $a_{1}$ and $a_{2}$, strictly greater than 1 .

Finally, suppose $a_{2022}>1$. This implies that $a_{2021} \leqslant 1$ and $a_{2023} \leqslant 1$. Therefore $0<$ $\left(a_{2022}\right)^{2}-1 \leqslant\left(1-a_{2021}\right)\left(a_{2023}-1\right) \leqslant 0$, a contradiction. We conclude that $a_{2022} \leqslant 1$.",96,1
2022a4,"Let $n \geqslant 3$ be an integer, and let $x_{1}, x_{2}, \ldots, x_{n}$ be real numbers in the interval [0, 1]. Let $s=x_{1}+x_{2}+\ldots+x_{n}$, and assume that $s \geqslant 3$. Prove that there exist integers $i$ and $j$ with $1 \leqslant i<j \leqslant n$ such that

$$
2^{j-i} x_{i} x_{j}>2^{s-3} .
$$","Let $1 \leqslant a<b \leqslant n$ be such that $2^{b-a} x_{a} x_{b}$ is maximal. This choice of $a$ and $b$ implies that $x_{a+t} \leqslant 2^{t} x_{a}$ for all $1-a \leqslant t \leqslant b-a-1$, and similarly $x_{b-t} \leqslant 2^{t} x_{b}$ for all $b-n \leqslant t \leqslant b-a+1$. Now, suppose that $x_{a} \in\left(\frac{1}{2^{u+1}}, \frac{1}{2^{u}}\right]$ and $x_{b} \in\left(\frac{1}{2^{v+1}}, \frac{1}{2^{v}}\right]$, and write $x_{a}=2^{-\alpha}, x_{b}=2^{-\beta}$. Then

$$
\sum_{i=1}^{a+u-1} x_{i} \leqslant 2^{u} x_{a}\left(\frac{1}{2}+\frac{1}{4}+\ldots+\frac{1}{2^{a+u-1}}\right)<2^{u} x_{a} \leqslant 1,
$$

and similarly,

$$
\sum_{i=b-v+1}^{n} x_{i} \leqslant 2^{v} x_{b}\left(\frac{1}{2}+\frac{1}{4}+\ldots+\frac{1}{2^{n-b+v}}\right)<2^{v} x_{b} \leqslant 1,
$$

In other words, the sum of the $x_{i}$ 's for $i$ outside of the interval $[a+u, b-v]$ is strictly less than 2. Since the total sum is at least 3 , and each term is at most 1 , it follows that this interval must have at least two integers. i.e., $a+u<b-v$. Thus, by bounding the sum of the $x_{i}$ for $i \in[1, a+u] \cup[b-v, n]$ like above, and trivially bounding each $x_{i} \in(a+u, b-v)$ by 1 , we obtain

$$
s<2^{u+1} x_{a}+2^{v+1} x_{b}+((b-v)-(a+u)-1)=b-a+\left(2^{u+1-\alpha}+2^{v+1-\beta}-(u+v+1)\right) .
$$

Now recall $\alpha \in(u, u+1]$ and $\beta \in(v, v+1]$, so applying Bernoulli's inequality yields $\left.2^{u+1-\alpha}+2^{v+1-\beta}-u-v-1 \leqslant(1+(u+1-\alpha))\right)+(1+(v+1-\beta))-u-v-1=3-\alpha-\beta$.

It follows that $s-3<b-a-\alpha-\beta$, and so

$$
2^{s-3}<2^{b-a-\alpha-\beta}=2^{b-a} x_{a} x_{b} .
$$

Comment 1. It is not hard to see that the inequality is tight. Suppose that $n=2 k+1$, and we set $x_{k+1}=1, x_{k}=x_{k+2}=\frac{1}{2}+\frac{1}{2^{k}}$, and $x_{k+1-t}=x_{k+1+t}=\frac{1}{2^{2}}$. Then $s=3$ (so the right hand side is 1 ), and

$$
\max _{i<j} 2^{j-i} x_{i} x_{j}=2^{2}\left(\frac{1}{2}+\frac{1}{2^{k}}\right)^{2},
$$

which can be made arbitrarily close to 1 . Note that $s$ can be made larger by putting in more 1 -s in the middle (and this accommodates even $n$ as well).

Comment 2. An alternative formulation of the problem is to show that there exists a positive constant $c$ (or find the best such $c$ ) such that

$$
\max _{i<j} 2^{j-i} x_{i} x_{j}>c 2^{s} .
$$

The above shows that $c=1 / 8$ is the best possible. A somewhat simpler ending to the proof can be given for $c=1 / 32$.\\
End of solution for $c=1 / 32$.\\
As in the original solution, we arrive at

$$
s<2^{u+1} x_{a}+2^{v+1} x_{b}+((b-v)-(a+u)-1)=b-a+\left(2^{u+1-\alpha}+2^{v+1-\beta}-(u+v+1)\right) .
$$

Now $2^{b-a} x_{a} x_{b} \geqslant 2^{b-a} 2^{-u-1} 2^{-v-1}$, so it is enough to show $s-5<b-a-u-v-2$, or $s<b-a-$ $u-v+3$. The fact that $u+1-\alpha<1$ and $v+1-\beta<1$ implies $2^{u+1-\alpha}+2^{v+1-\beta}<4$, and so $s<b-a+(2+2-u-v-1)=b-a-u-v-3$.",382,3
2022c5,"Let $m, n \geqslant 2$ be integers, let $X$ be a set with $n$ elements, and let $X_{1}, X_{2}, \ldots, X_{m}$ be pairwise distinct non-empty, not necessary disjoint subsets of $X$. A function $f: X \rightarrow$ $\{1,2, \ldots, n+1\}$ is called nice if there exists an index $k$ such that

$$
\sum_{x \in X_{k}} f(x)>\sum_{x \in X_{i}} f(x) \text { for all } i \neq k
$$

Prove that the number of nice functions is at least $n^{n}$.","Solution. For a subset $Y \subseteq X$, we write $f(Y)$ for $\sum_{y \in Y} f(y)$. Note that a function $f: X \rightarrow$ $\{1, \ldots, n+1\}$ is nice, if and only if $f\left(X_{i}\right)$ is maximized by a unique index $i \in\{1, \ldots, m\}$.

We will first investigate the set $\mathcal{F}$ of functions $f: X \rightarrow\{1, \ldots, n\}$; note that $|\mathcal{F}|=n^{n}$. For every function $f \in \mathcal{F}$, define a corresponding function $f^{+}: X \rightarrow\{1,2, \ldots, n+1\}$ in the following way: Pick some set $X_{l}$ that maximizes the value $f\left(X_{l}\right)$.

\begin{itemize}
  \item For all $x \in X_{l}$, define $f^{+}(x)=f(x)+1$.
  \item For all $x \in X \backslash X_{l}$, define $f^{+}(x)=f(x)$.
\end{itemize}

Claim. The resulting function $f^{+}$is nice.\\
Proof. Note that $f^{+}\left(X_{i}\right)=f\left(X_{i}\right)+\left|X_{i} \cap X_{l}\right|$ holds for all $X_{i}$. We show that $f^{+}\left(X_{i}\right)$ is maximized at the unique index $i=l$. Hence consider some arbitrary index $j \neq l$. Then $X_{l} \subset X_{j}$ is impossible, as this would imply $f\left(X_{j}\right)>f\left(X_{l}\right)$ and thereby contradict the choice of set $X_{l}$; this in particular yields $\left|X_{l}\right|>\left|X_{j} \cap X_{l}\right|$.

$$
f^{+}\left(X_{l}\right)=f\left(X_{l}\right)+\left|X_{l}\right| \geqslant f\left(X_{j}\right)+\left|X_{l}\right|>f\left(X_{j}\right)+\left|X_{j} \cap X_{l}\right|=f^{+}\left(X_{j}\right)
$$

The first inequality follows since $X_{l}$ was chosen to maximize the value $f\left(X_{l}\right)$. The second (strict) inequality follows from $\left|X_{l}\right|>\left|X_{j} \cap X_{l}\right|$ as observed above. This completes the proof of the claim.

Next observe that function $f$ can be uniquely reconstructed from $f^{+}$: the claim yields that $f^{+}$has a unique maximizer $X_{l}$, and by decreasing the value of $f^{+}$on $X_{l}$ by 1 , we get we can fully determine the values of $f$. As each of the $n^{n}$ functions $f \in \mathcal{F}$ yields a (unique) corresponding nice function $f^{+}: X \rightarrow\{1,2, \ldots, n+1\}$, the proof is complete.",272,3
2022g1,"Let $A B C D E$ be a convex pentagon such that $B C=D E$. Assume there is a point $T$ inside $A B C D E$ with $T B=T D, T C=T E$ and $\angle T B A=\angle A E T$. Let lines $C D$ and $C T$ intersect line $A B$ at points $P$ and $Q$, respectively, and let lines $C D$ and $D T$ intersect line $A E$ at points $R$ and $S$, respectively. Assume that points $P, B, A, Q$ and $R, E, A, S$ respectively, are collinear and occur on their lines in this order. Prove that the points $P, S, Q, R$ are concyclic.","By the conditions we have $B C=D E, C T=E T$ and $T B=T D$, so the triangles $T B C$ and $T D E$ are congruent, in particular $\angle B T C=\angle D T E$.

In triangles $T B Q$ and $T E S$ we have $\angle T B Q=\angle S E T$ and $\angle Q T B=180^{\circ}-\angle B T C=180^{\circ}-$ $\angle D T E=\angle E T S$, so these triangles are similar to each other. It follows that $\angle T S E=\angle B Q T$ and

$$
\frac{T D}{T Q}=\frac{T B}{T Q}=\frac{T E}{T S}=\frac{T C}{T S} .
$$

By rearranging this relation we get $T D \cdot T S=T C \cdot T Q$, so $C, D, Q$ and $S$ are concyclic. (Alternatively, we can get $\angle C Q D=\angle C S D$ from the similar triangles $T C S$ and $T D Q$.) Hence, $\angle D C Q=\angle D S Q$.

Finally, from the angles of triangle $C Q P$ we get

$$
\angle R P Q=\angle R C Q-\angle P Q C=\angle D S Q-\angle D S R=\angle R S Q,
$$

which proves that $P, Q, R$ and $S$ are concyclic.\\
",195,2
2022g2,"In the acute-angled triangle $A B C$, the point $F$ is the foot of the altitude from $A$, and $P$ is a point on the segment $A F$. The lines through $P$ parallel to $A C$ and $A B$ meet $B C$ at $D$ and $E$, respectively. Points $X \neq A$ and $Y \neq A$ lie on the circles $A B D$ and $A C E$, respectively, such that $D A=D X$ and $E A=E Y$.

Prove that $B, C, X$ and $Y$ are concyclic.","Let $A^{\prime}$ be the intersection of lines $B X$ and $C Y$. By power of a point, it suffices to prove that $A^{\prime} B \cdot A^{\prime} X=A^{\prime} C \cdot A^{\prime} Y$, or, equivalently, that $A^{\prime}$ lies on the radical axis of the circles $A B D X$ and $A C E Y$.

From $D A=D X$ it follows that in circle $A B D X$, point $D$ bisects of one of the arcs $A X$. Therefore, depending on the order of points, the line $B C$ is either the internal or external bisector of $\angle A B X$. In both cases, line $B X$ is the reflection of $B A$ in line $B D C$. Analogously, line $C Y$ is the reflection of $C A$ in line $B C$; we can see that $A^{\prime}$ is the reflection of $A$ in line $B C$, so $A, F$ and $A^{\prime}$ are collinear.

By $P D \| A C$ and $P E \| A B$ we have $\frac{F D}{F C}=\frac{F P}{F A}=\frac{F E}{F B}$, hence $F D \cdot F B=F E \cdot F C$. So, point $F$ has equal powers with respect to circles $A B D X$ and $A C E Y$.

Point $A$, being a common point of the two circles, is another point with equal powers, so the radical axis of circles $A B D X$ and $A C E Y$ is the altitude $A F$ that passes through $A^{\prime}$.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_d37d4d050b74b6f29ab9g-48}
",243,2
2022g3,"Let $A B C D$ be a cyclic quadrilateral. Assume that the points $Q, A, B, P$ are collinear in this order, in such a way that the line $A C$ is tangent to the circle $A D Q$, and the line $B D$ is tangent to the circle $B C P$. Let $M$ and $N$ be the midpoints of $B C$ and $A D$, respectively. Prove that the following three lines are concurrent: line $C D$, the tangent of circle $A N Q$ at point $A$, and the tangent to circle $B M P$ at point $B$.","We first prove that triangles $A D Q$ and $C D B$ are similar. Since $A B C D$ is cyclic, we have $\angle D A Q=\angle D C B$. By the tangency of $A C$ to the circle $A Q D$ we also have $\angle C B D=\angle C A D=\angle A Q D$. The claimed similarity is proven.

Let $R$ be the midpoint of $C D$. Points $N$ and $R$ correspond in the proven similarity, and so $\angle Q N A=\angle B R C$.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_d37d4d050b74b6f29ab9g-49}

Let $K$ be the second common point of line $C D$ with circle $A B R$ (i.e., if $C D$ intersects circle $A B R$, then $K \neq R$ is the other intersection; otherwise, if $C D$ is tangent to $C D$, then $K=R$ ). In both cases, we have $\angle B A K=\angle B R C=\angle Q N A$; that indicates that $A K$ is tangent to circle $A N Q$. It can be showed analogously that $B K$ is tangent to circle $B M P$.

Comment. Note that $M$ and $N$ can be any points on lines $B C$ and $A D$ such that $B M: M C=$ $D N: N A$, as we then simply choose $R$ to be such that $D R: R C$ is that same ratio, and the rest of the proof remains unchanged.
",229,2
2022g4,"Let $A B C$ be an acute-angled triangle with $A C>A B$, let $O$ be its circumcentre, and let $D$ be a point on the segment $B C$. The line through $D$ perpendicular to $B C$ intersects the lines $A O, A C$ and $A B$ at $W, X$ and $Y$, respectively. The circumcircles of triangles $A X Y$ and $A B C$ intersect again at $Z \neq A$.

Prove that if $O W=O D$, then $D Z$ is tangent to the circle $A X Y$.","Let $A O$ intersect $B C$ at $E$. As $E D W$ is a right-angled triangle and $O$ is on $W E$, the condition $O W=O D$ means $O$ is the circumcentre of this triangle. So $O D=O E$ which establishes that $D, E$ are reflections in the perpendicular bisector of $B C$.

Now observe:

$$
180^{\circ}-\angle D X Z=\angle Z X Y=\angle Z A Y=\angle Z C D,
$$

which shows $C D X Z$ is cyclic.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_d37d4d050b74b6f29ab9g-51}

We next show that $A Z \| B C$. To do this, introduce point $Z^{\prime}$ on circle $A B C$ such that $A Z^{\prime} \| B C$. By the previous result, it suffices to prove that $C D X Z^{\prime}$ is cyclic. Notice that triangles $B A E$ and $C Z^{\prime} D$ are reflections in the perpendicular bisector of $B C$. Using this and that $A, O, E$ are collinear:

$$
\angle D Z^{\prime} C=\angle B A E=\angle B A O=90^{\circ}-\frac{1}{2} \angle A O B=90^{\circ}-\angle C=\angle D X C \text {, }
$$

so $D X Z^{\prime} C$ is cyclic, giving $Z \equiv Z^{\prime}$ as desired.\\
Using $A Z \| B C$ and $C D X Z$ cyclic we get:

$$
\angle A Z D=\angle C D Z=\angle C X Z=\angle A Y Z,
$$

which by the converse of alternate segment theorem shows $D Z$ is tangent to circle $A X Y$.
",234,2
2022g5,"Let $A B C$ be a triangle, and let $\ell_{1}$ and $\ell_{2}$ be two parallel lines. For $i=1,2$, let $\ell_{i}$ meet the lines $B C, C A$, and $A B$ at $X_{i}, Y_{i}$, and $Z_{i}$, respectively. Suppose that the line through $X_{i}$ perpendicular to $B C$, the line through $Y_{i}$ perpendicular to $C A$, and finally the line through $Z_{i}$ perpendicular to $A B$, determine a non-degenerate triangle $\Delta_{i}$.

Show that the circumcircles of $\Delta_{1}$ and $\Delta_{2}$ are tangent to each other.","Throughout the solutions, $\Varangle(p, q)$ will denote the directed angle between lines $p$ and $q$, taken modulo $180^{\circ}$.

Let the vertices of $\Delta_{i}$ be $D_{i}, E_{i}, F_{i}$, such that lines $E_{i} F_{i}, F_{i} D_{i}$ and $D_{i} E_{i}$ are the perpendiculars through $X, Y$ and $Z$, respectively, and denote the circumcircle of $\Delta_{i}$ by $\omega_{i}$.

In triangles $D_{1} Y_{1} Z_{1}$ and $D_{2} Y_{2} Z_{2}$ we have $Y_{1} Z_{1} \| Y_{2} Z_{2}$ because they are parts of $\ell_{1}$ and $\ell_{2}$. Moreover, $D_{1} Y_{1} \| D_{2} Y_{2}$ are perpendicular to $A C$ and $D_{1} Z_{1} \| D_{2} Z_{2}$ are perpendicular to $A B$, so the two triangles are homothetic and their homothetic centre is $Y_{1} Y_{2} \cap Z_{1} Z_{2}=A$. Hence, line $D_{1} D_{2}$ passes through $A$. Analogously, line $E_{1} E_{2}$ passes through $B$ and $F_{1} F_{2}$ passes through $C$.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_d37d4d050b74b6f29ab9g-53}

The corresponding sides of $\Delta_{1}$ and $\Delta_{2}$ are parallel, because they are perpendicular to the respective sides of triangle $A B C$. Hence, $\Delta_{1}$ and $\Delta_{2}$ are either homothetic, or they can be translated to each other. Using that $B, X_{2}, Z_{2}$ and $E_{2}$ are concyclic, $C, X_{2}, Y_{2}$ and $F_{2}$ are concyclic, $Z_{2} E_{2} \perp A B$ and $Y_{2}, F_{2} \perp A C$ we can calculate


\begin{align*}
\Varangle\left(E_{1} E_{2}, F_{1} F_{2}\right) & =\Varangle\left(E_{1} E_{2}, X_{1} X_{2}\right)+\Varangle\left(X_{1} X_{2}, F_{1} F_{2}\right)=\Varangle\left(B E_{2}, B X_{2}\right)+\Varangle\left(C X_{2}, C F_{2}\right) \\
& =\Varangle\left(Z_{2} E_{2}, Z_{2} X_{2}\right)+\Varangle\left(Y_{2} X_{2}, Y_{2} F_{2}\right)=\Varangle\left(Z_{2} E_{2}, \ell_{2}\right)+\Varangle\left(\ell_{2}, Y_{2} F_{2}\right) \\
& =\Varangle\left(Z_{2} E_{2}, Y_{2} F_{2}\right)=\Varangle(A B, A C) \not \equiv 0, \tag{1}
\end{align*}


and conclude that lines $E_{1} E_{2}$ and $F_{1} F_{2}$ are not parallel. Hence, $\Delta_{1}$ and $\Delta_{2}$ are homothetic; the lines $D_{1} D_{2}, E_{1} E_{2}$, and $F_{1} F_{2}$ are concurrent at the homothetic centre of the two triangles. Denote this homothetic centre by $H$.

For $i=1,2$, using (1), and that $A, Y_{i}, Z_{i}$ and $D_{i}$ are concyclic,

$$
\begin{aligned}
\Varangle\left(H E_{i}, H F_{i}\right) & =\Varangle\left(E_{1} E_{2}, F_{1} F_{2}\right)=\Varangle(A B, A C) \\
& =\Varangle\left(A Z_{i}, A Y_{i}\right)=\Varangle\left(D_{i} Z_{i}, D_{i} Y_{i}\right)=\Varangle\left(D_{i} E_{i}, D_{i} F_{i}\right),
\end{aligned}
$$

so $H$ lies on circle $\omega_{i}$.\\
The same homothety that maps $\Delta_{1}$ to $\Delta_{2}$, sends $\omega_{1}$ to $\omega_{2}$ as well. Point $H$, that is the centre of the homothety, is a common point of the two circles, That finishes proving that $\omega_{1}$ and $\omega_{2}$ are tangent to each other.
",385,3
2022g6,"In an acute-angled triangle $A B C$, point $H$ is the foot of the altitude from $A$. Let $P$ be a moving point such that the bisectors $k$ and $\ell$ of angles $P B C$ and $P C B$, respectively, intersect each other on the line segment $A H$. Let $k$ and $A C$ meet at $E$, let $\ell$ and $A B$ meet at $F$, and let $E F$ and $A H$ meet at $Q$. Prove that, as $P$ varies, the line $P Q$ passes through a fixed point.","Let the reflections of the line $B C$ with respect to the lines $A B$ and $A C$ intersect at point $K$. We will prove that $P, Q$ and $K$ are collinear, so $K$ is the common point of the varying line $P Q$.

Let lines $B E$ and $C F$ intersect at $I$. For every point $O$ and $d>0$, denote by $(O, d)$ the circle centred at $O$ with radius $d$, and define $\omega_{I}=(I, I H)$ and $\omega_{A}=(A, A H)$. Let $\omega_{K}$ and $\omega_{P}$ be the incircle of triangle $K B C$ and the $P$-excircle of triangle $P B C$, respectively.

Since $I H \perp B C$ and $A H \perp B C$, the circles $\omega_{A}$ and $\omega_{I}$ are tangent to each other at $H$. So, $H$ is the external homothetic centre of $\omega_{A}$ and $\omega_{I}$. From the complete quadrangle $B C E F$ we have $(A, I ; Q, H)=-1$, therefore $Q$ is the internal homothetic centre of $\omega_{A}$ and $\omega_{I}$. Since $B A$ and $C A$ are the external bisectors of angles $\angle K B C$ and $\angle K C B$, circle $\omega_{A}$ is the $K$-excircle in triangle $B K C$. Hence, $K$ is the external homothetic centre of $\omega_{A}$ and $\omega_{K}$. Also it is clear that $P$ is the external homothetic centre of $\omega_{I}$ and $\omega_{P}$. Let point $T$ be the tangency point of $\omega_{P}$ and $B C$, and let $T^{\prime}$ be the tangency point of $\omega_{K}$ and $B C$. Since $\omega_{I}$ is the incircle and $\omega_{P}$ is the $P$-excircle of $P B C, T C=B H$ and since $\omega_{K}$ is the incircle and $\omega_{A}$ is the $K$-excircle of $K B C, T^{\prime} C=B H$. Therefore $T C=T^{\prime} C$ and $T \equiv T^{\prime}$. It yields that $\omega_{K}$ and $\omega_{P}$ are tangent to each other at $T$.\\

Let point $S$ be the internal homothetic centre of $\omega_{A}$ and $\omega_{P}$, and let $S^{\prime}$ be the internal homothetic centre of $\omega_{I}$ and $\omega_{K}$. It's obvious that $S$ and $S^{\prime}$ lie on $B C$. We claim that $S \equiv S^{\prime}$. To prove our claim, let $r_{A}, r_{I}, r_{P}$, and $r_{K}$ be the radii of $\omega_{A}, \omega_{I}, \omega_{P}$ and $\omega_{k}$, respectively.

It is well known that if the sides of a triangle are $a, b, c$, its semiperimeter is $s=(a+b+c) / 2$, and the radii of the incircle and the $a$-excircle are $r$ and $r_{a}$, respectively, then $r \cdot r_{a}=(s-b)(s-c)$. Applying this fact to triangle $P B C$ we get $r_{I} \cdot r_{P}=B H \cdot C H$. The same fact in triangle $K C B$\\
yields $r_{K} \cdot r_{A}=C T \cdot B T$. Since $B H=C T$ and $B T=C H$, from these two we get

$$
\frac{H S}{S T}=\frac{r_{A}}{r_{P}}=\frac{r_{I}}{r_{K}}=\frac{H S^{\prime}}{S^{\prime} T},
$$

so $S=S^{\prime}$ indeed.\\
Finally, by applying the generalised Monge's theorem to the circles $\omega_{A}, \omega_{I}$, and $\omega_{K}$ (with two pairs of internal and one pair of external common tangents), we can see that points $Q$, $S$, and $K$ are collinear. Similarly one can show that $Q, S$ and $P$ are collinear, and the result follows.
",507,4
2022g7,"Let $A B C$ and $A^{\prime} B^{\prime} C^{\prime}$ be two triangles having the same circumcircle $\omega$, and the same orthocentre $H$. Let $\Omega$ be the circumcircle of the triangle determined by the lines $A A^{\prime}, B B^{\prime}$ and $C C^{\prime}$. Prove that $H$, the centre of $\omega$, and the centre of $\Omega$ are collinear.","In what follows, $\Varangle(p, q)$ will denote the directed angle between lines $p$ and $q$, taken modulo $180^{\circ}$. Denote by $O$ the centre of $\omega$. In any triangle, the homothety with ratio $-\frac{1}{2}$ centred at the centroid of the triangle takes the vertices to the midpoints of the opposite sides and it takes the orthocentre to the circumcentre. Therefore the triangles $A B C$ and $A^{\prime} B^{\prime} C^{\prime}$ share the same centroid $G$ and the midpoints of their sides lie on a circle $\rho$ with centre on $O H$. We will prove that $\omega, \Omega$, and $\rho$ are coaxial, so in particular it follows that their centres are collinear on OH .

Let $D=B B^{\prime} \cap C C^{\prime}, E=C C^{\prime} \cap A A^{\prime}, F=A A^{\prime} \cap B B^{\prime}, S=B C^{\prime} \cap B^{\prime} C$, and $T=B C \cap B^{\prime} C^{\prime}$. Since $D, S$, and $T$ are the intersections of opposite sides and of the diagonals in the quadrilateral $B B^{\prime} C C^{\prime}$ inscribed in $\omega$, by Brocard's theorem triangle $D S T$ is self-polar with respect to $\omega$, i.e. each vertex is the pole of the opposite side. We apply this in two ways.\\

First, from $D$ being the pole of $S T$ it follows that the inverse $D^{*}$ of $D$ with respect to $\omega$ is the projection of $D$ onto $S T$. In particular, $D^{*}$ lies on the circle with diameter $S D$. If $N$ denotes the midpoint of $S D$ and $R$ the radius of $\omega$, then the power of $O$ with respect to this circle is $O N^{2}-N D^{2}=O D \cdot O D^{*}=R^{2}$. By rearranging, we see that $N D^{2}$ is the power of $N$ with respect to $\omega$.

Second, from $T$ being the pole of $S D$ it follows that $O T$ is perpendicular to $S D$. Let $M$ and $M^{\prime}$ denote the midpoints of $B C$ and $B^{\prime} C^{\prime}$. Then since $O M \perp B C$ and $O M^{\prime} \perp B^{\prime} C^{\prime}$ it follows that $O M M^{\prime} T$ is cyclic and

$$
\Varangle(S D, B C)=\Varangle(O T, O M)=\Varangle\left(B^{\prime} C^{\prime}, M M^{\prime}\right) .
$$

From $B B^{\prime} C C^{\prime}$ being cyclic we also have $\Varangle\left(B C, B B^{\prime}\right)=\Varangle\left(C C^{\prime}, B^{\prime} C^{\prime}\right)$, hence we obtain

$$
\begin{aligned}
\Varangle\left(S D, B B^{\prime}\right) & =\Varangle(S D, B C)+\Varangle\left(B C, B B^{\prime}\right) \\
& =\Varangle\left(B^{\prime} C^{\prime}, M M^{\prime}\right)+\Varangle\left(C C^{\prime}, B^{\prime} C^{\prime}\right)=\Varangle\left(C C^{\prime}, M M^{\prime}\right) .
\end{aligned}
$$

Now from the homothety mentioned in the beginning, we know that $M M^{\prime}$ is parallel to $A A^{\prime}$, hence the above implies that $\Varangle\left(S D, B B^{\prime}\right)=\Varangle\left(C C^{\prime}, A A^{\prime}\right)$, which shows that $\Omega$ is tangent to $S D$ at $D$. In particular, $N D^{2}$ is also the power of $N$ with respect to $\Omega$.

Additionally, from $B B^{\prime} C C^{\prime}$ being cyclic it follows that triangles $D B C$ and $D C^{\prime} B^{\prime}$ are inversely similar, so $\Varangle\left(B B^{\prime}, D M^{\prime}\right)=\Varangle\left(D M, C C^{\prime}\right)$. This yields

$$
\begin{aligned}
\Varangle\left(S D, D M^{\prime}\right) & =\Varangle\left(S D, B B^{\prime}\right)+\Varangle\left(B B^{\prime}, D M^{\prime}\right) \\
& =\Varangle\left(C C^{\prime}, M M^{\prime}\right)+\Varangle\left(D M, C C^{\prime}\right)=\Varangle\left(D M, M M^{\prime}\right),
\end{aligned}
$$

which shows that the circle $D M M^{\prime}$ is also tangent to $S D$. Since $N, M$, and $M^{\prime}$ are collinear on the Newton-Gauss line of the complete quadrilateral determined by the lines $B B^{\prime}, C C^{\prime}, B C^{\prime}$, and $B^{\prime} C$, it follows that $N D^{2}=N M \cdot N M^{\prime}$. Hence $N$ has the same power with respect to $\omega$, $\Omega$, and $\rho$.

By the same arguments there exist points on the tangents to $\Omega$ at $E$ and $F$ which have the same power with respect to $\omega, \Omega$, and $\rho$. The tangents to a given circle at three distinct points cannot be concurrent, hence we obtain at least two distinct points with the same power with respect to $\omega, \Omega$, and $\rho$. Hence the three circles are coaxial, as desired.

",645,4
2022g8,"Let $A A^{\prime} B C C^{\prime} B^{\prime}$ be a convex cyclic hexagon such that $A C$ is tangent to the incircle of the triangle $A^{\prime} B^{\prime} C^{\prime}$, and $A^{\prime} C^{\prime}$ is tangent to the incircle of the triangle $A B C$. Let the lines $A B$ and $A^{\prime} B^{\prime}$ meet at $X$ and let the lines $B C$ and $B^{\prime} C^{\prime}$ meet at $Y$.

Prove that if $X B Y B^{\prime}$ is a convex quadrilateral, then it has an incircle.","Solution. Denote by $\omega$ and $\omega^{\prime}$ the incircles of $\triangle A B C$ and $\triangle A^{\prime} B^{\prime} C^{\prime}$ and let $I$ and $I^{\prime}$ be the centres of these circles. Let $N$ and $N^{\prime}$ be the second intersections of $B I$ and $B^{\prime} I^{\prime}$ with $\Omega$, the circumcircle of $A^{\prime} B C C^{\prime} B^{\prime} A$, and let $O$ be the centre of $\Omega$. Note that $O N \perp A C, O N^{\prime} \perp A^{\prime} C^{\prime}$ and $O N=O N^{\prime}$ so $N N^{\prime}$ is parallel to the angle bisector $I I^{\prime}$ of $A C$ and $A^{\prime} C^{\prime}$. Thus $I I^{\prime} \| N N^{\prime}$ which is antiparallel to $B B^{\prime}$ with respect to $B I$ and $B^{\prime} I^{\prime}$. Therefore $B, I, I^{\prime}, B^{\prime}$ are concyclic.

Further define $P$ as the intersection of $A C$ and $A^{\prime} C^{\prime}$ and $M$ as the antipode of $N^{\prime}$ in $\Omega$. Consider the circle $\Gamma_{1}$ with centre $N$ and radius $N A=N C$ and the circle $\Gamma_{2}$ with centre $M$ and radius $M A^{\prime}=M C^{\prime}$. Their radical axis passes through $P$ and is perpendicular to $M N \perp N N^{\prime} \| I P$, so $I$ lies on their radical axis. Therefore, since $I$ lies on $\Gamma_{1}$, it must also lie on $\Gamma_{2}$. Thus, if we define $Z$ as the second intersection of $M I$ with $\Omega$, we have that $I$ is the incentre of triangle $Z A^{\prime} C^{\prime}$. (Note that the point $Z$ can also be constructed directly via Poncelet's porism.)

Consider the incircle $\omega_{c}$ with centre $I_{c}$ of triangle $C^{\prime} B^{\prime} Z$. Note that $\angle Z I C^{\prime}=90^{\circ}+$ $\frac{1}{2} \angle Z A^{\prime} C^{\prime}=90^{\circ}+\frac{1}{2} \angle Z B^{\prime} C^{\prime}=\angle Z I_{c} C^{\prime}$, so $Z, I, I_{c}, C^{\prime}$ are concyclic. Similarly $B^{\prime}, I^{\prime}, I_{c}, C^{\prime}$ are concyclic.

The external centre of dilation from $\omega$ to $\omega_{c}$ is the intersection of $I I_{c}$ and $C^{\prime} Z(D$ in the picture), that is the radical centre of circles $\Omega, C^{\prime} I_{c} I Z$ and $I I^{\prime} I_{c}$. Similarly, the external centre of dilation from $\omega^{\prime}$ to $\omega_{c}$ is the intersection of $I^{\prime} I_{c}$ and $B^{\prime} C^{\prime}$ ( $D^{\prime}$ in the picture), that is the radical centre of circles $\Omega, B^{\prime} I^{\prime} I_{c} C^{\prime}$ and $I I^{\prime} I_{c}$. Therefore the Monge line of $\omega, \omega^{\prime}$ and $\omega_{c}$ is line $D D^{\prime}$, and the radical axis of $\Omega$ and circle $I I^{\prime} I_{c}$ coincide. Hence the external centre $T$ of dilation from $\omega$ to $\omega^{\prime}$ is also on the radical axis of $\Omega$ and circle $I I^{\prime} I_{c}$.\\

Now since $B, I, I^{\prime}, B^{\prime}$ are concyclic, the intersection $T^{\prime}$ of $B B^{\prime}$ and $I I^{\prime}$ is on the radical axis of $\Omega$ and circle $I I^{\prime} I_{c}$. Thus $T^{\prime}=T$ and $T$ lies on line $B B^{\prime}$. Finally, construct a circle $\Omega_{0}$ tangent to $A^{\prime} B^{\prime}, B^{\prime} C^{\prime}, A B$ on the same side of these lines as $\omega^{\prime}$. The centre of dilation from $\omega^{\prime}$ to $\Omega_{0}$ is $B^{\prime}$, so by Monge's theorem the external centre of dilation from $\Omega_{0}$ to $\omega$ must be on the line $T B B^{\prime}$. However, it is on line $A B$, so it must be $B$ and $B C$ must be tangent to $\Omega_{0}$ as desired.\\",526,4
2022n5,"For each $1 \leqslant i \leqslant 9$ and $T \in \mathbb{N}$, define $d_{i}(T)$ to be the total number of times the digit $i$ appears when all the multiples of 1829 between 1 and $T$ inclusive are written out in base 10.

Show that there are infinitely many $T \in \mathbb{N}$ such that there are precisely two distinct values among $d_{1}(T), d_{2}(T), \ldots, d_{9}(T)$.","Solution. Let $n:=1829$. First, we choose some $k$ such that $n \mid 10^{k}-1$. For instance, any multiple of $\varphi(n)$ would work since $n$ is coprime to 10 . We will show that either $T=10^{k}-1$ or $T=10^{k}-2$ has the desired property, which completes the proof since $k$ can be taken to be arbitrary large.

For this it suffices to show that $\#\left\{d_{i}\left(10^{k}-1\right): 1 \leqslant i \leqslant 9\right\} \leqslant 2$. Indeed, if

$$
\#\left\{d_{i}\left(10^{k}-1\right): 1 \leqslant i \leqslant 9\right\}=1
$$

then, since $10^{k}-1$ which consists of all nines is a multiple of $n$, we have

$$
d_{i}\left(10^{k}-2\right)=d_{i}\left(10^{k}-1\right) \text { for } i \in\{1, \ldots, 8\} \text {, and } d_{9}\left(10^{k}-2\right)<d_{9}\left(10^{k}-1\right)
$$

This means that $\#\left\{d_{i}\left(10^{k}-2\right): 1 \leqslant i \leqslant 9\right\}=2$.\\
To prove that $\#\left\{d_{i}\left(10^{k}-1\right)\right\} \leqslant 2$ we need an observation. Let $\overline{a_{k-1} a_{k-2} \ldots a_{0}} \in\left\{1, \ldots, 10^{k}-1\right\}$ be the decimal expansion of an arbitrary number, possibly with leading zeroes. Then $\overline{a_{k-1} a_{k-2} \ldots a_{0}}$ is divisible by $n$ if and only if $\overline{a_{k-2} \ldots a_{0} a_{k-1}}$ is divisible by $n$. Indeed, this follows from the fact that

$$
10 \cdot \overline{a_{k-1} a_{k-2} \ldots a_{0}}-\overline{a_{k-2} \ldots a_{0} a_{k-1}}=\left(10^{k}-1\right) \cdot a_{k-1}
$$

is divisible by $n$.\\
This observation shows that the set of multiples of $n$ between 1 and $10^{k}-1$ is invariant under simultaneous cyclic permutation of digits when numbers are written with leading zeroes. Hence, for each $i \in\{1, \ldots, 9\}$ the number $d_{i}\left(10^{k}-1\right)$ is $k$ times larger than the number of $k$ digit numbers which start from the digit $i$ and are divisible by $n$. Since the latter number is either $\left\lfloor 10^{k-1} / n\right\rfloor$ or $1+\left\lfloor 10^{k-1} / n\right\rfloor$, we conclude that $\#\left\{d_{i}\left(10^{k}-1\right)\right\} \leqslant 2$.

Comment. More careful analysis shows that $\#\left\{d_{i}\left(10^{k}-1\right): 1 \leqslant i \leqslant 9\right\}=1$ if and only if $n \equiv 1$ $(\bmod 10)$, which is not the case for $n=1829$.",303,3
2022n6,"Let $Q$ be a set of prime numbers, not necessarily finite. For a positive integer $n$ consider its prime factorisation; define $p(n)$ to be the sum of all the exponents and $q(n)$ to be the sum of the exponents corresponding only to primes in $Q$. A positive integer $n$ is called special if $p(n)+p(n+1)$ and $q(n)+q(n+1)$ are both even integers. Prove that there is a constant $c>0$ independent of the set $Q$ such that for any positive integer $N>100$, the number of special integers in $[1, N]$ is at least $c N$.\\
(For example, if $Q=\{3,7\}$, then $p(42)=3, q(42)=2, p(63)=3, q(63)=3, p(2022)=3$, $q(2022)=1$.)","Solution. Let us call two positive integers $m, n$ friends if $p(m)+p(n)$ and $q(m)+q(n)$ are both even integers. We start by noting that the pairs $(p(k), q(k))$ modulo 2 can take at most 4 different values; thus, among any five different positive integers there are two which are friends.

In addition, both functions $p$ and $q$ satisfy $f(a b)=f(a)+f(b)$ for any $a, b$. Therefore, if $m$ and $n$ are divisible by $d$, then both $p$ and $q$ satisfy the equality $f(m)+f(n)=f(m / d)+$ $f(n / d)+2 f(d)$. This implies that $m, n$ are friends if and only if $m / d, n / d$ are friends.

Let us call a set of integers $\left\{n_{1}, n_{2}, \ldots, n_{5}\right\}$ an interesting set if for any indexes $i, j$, the difference $d_{i j}=\left|n_{i}-n_{j}\right|$ divides both $n_{i}$ and $n_{j}$. We claim that if elements of an interesting set are all positive, then we can obtain a special integer. Indeed, if we were able to construct such a set, then there would be a pair of integers $\left\{n_{i}, n_{j}\right\}$ which are friends, according to the first observation. Additionally, the second observation yields that the quotients $n_{i} / d_{i j}, n_{j} / d_{i j}$ form a pair of friends, which happen to be consecutive integers, thus giving a special integer as desired.

In order to construct a family of interesting sets, we can start by observing that the set $\{0,6,8,9,12\}$ is an interesting set. Using that $72=2^{3} \cdot 3^{2}$ is the least common multiple of all pairwise differences in this set, we obtain a family of interesting sets by considering

$$
\{72 k, 72 k+6,72 k+8,72 k+9,72 k+12\}
$$

for any $k \geqslant 1$. If we consider the quotients (of these numbers by the appropriate differences), then we obtain that the set

$$
S_{k}=\{6 k, 8 k, 9 k, 12 k, 12 k+1,18 k+2,24 k+2,24 k+3,36 k+3,72 k+8\}
$$

has at least one special integer. In particular, the interval $[1,100 k]$ contains the sets $S_{1}, S_{2}, \ldots, S_{k}$, each of which has a special number. Any special number can be contained in at most ten sets $S_{k}$, from where we conclude that the number of special integers in $[1,100 k]$ is at least $k / 10$.

Finally, let $N=100 k+r$, with $k \geqslant 1$ and $0 \leqslant r<100$, so that we have $N<100(k+1) \leqslant$ $200 k$. Then the number of special integers in $[1, N]$ is at least $k / 10>N / 2000$, as we wanted to prove.

Comment 1. The statement is also true for $N \geqslant 15$ as at least one of the numbers $7,14,15$ is special.\\
Comment 2. Another approach would be to note that if $p(2 n), p(2 n+1), p(2 n+2)$ all have the same parity then one of the numbers $n, 2 n, 2 n+1$ is special. Indeed, if $q(n)+q(n+1)$ is even then $n$ is special since $p(n)+p(n+1) \equiv p(2 n)+p(2 n+2) \equiv 0(\bmod 2)$. Otherwise, if $q(n)+q(n+1)$ is odd, so is $q(2 n)+q(2 n+2)$ which implies that exactly one of the numbers $2 n, 2 n+1$ is special.

Unfortunately, it seems hard to show that the set of such $n$ has positive density: see a recent paper \href{https://arxiv.org/abs/1509.01545}{https://arxiv.org/abs/1509.01545} for the proof that all eight patterns of the parities of $p(n), p(n+1), p(n+2)$ appear for a positive proportion of positive integers.",550,4
2022n7,Let $k$ be a positive integer and let $S$ be a finite set of odd prime numbers. Prove that there is at most one way (modulo rotation and reflection) to place the elements of $S$ around a circle such that the product of any two neighbors is of the form $x^{2}+x+k$ for some positive integer $x$.,"Solution. Let us allow the value $x=0$ as well; we prove the same statement under this more general constraint. Obviously that implies the statement with the original conditions.

Call a pair $\{p, q\}$ of primes with $p \neq q$ special if $p q=x^{2}+x+k$ for some nonnegative integer $x$. The following claim is the key mechanism of the problem:\\
Claim.\\
(a) For every prime $r$, there are at most two primes less than $r$ forming a special pair with $r$.\\
(b) If such $p$ and $q$ exist, then $\{p, q\}$ is itself special.

We present two proofs of the claim.\\
Proof 1. We are interested in integers $1 \leqslant x<r$ satsfying


\begin{equation*}
x^{2}+x+k \equiv 0 \quad(\bmod r) \tag{1}
\end{equation*}


Since there are at most two residues modulo $r$ that can satisfy that quadratic congruence, there are at most two possible values of $x$. That proves (a).

Now suppose there are primes $p, q$ with $p<q<r$ and nonnegative integers $x, y$ such that

$$
\begin{aligned}
& x^{2}+x+k=p r \\
& y^{2}+y+k=q r .
\end{aligned}
$$

From $p<q<r$ we can see that $0 \leqslant x<y \leqslant r-1$. The numbers $x, y$ are the two solutions of (1); by Vieta's formulas, we should have $x+y \equiv-1(\bmod r)$, so $x+y=r-1$.

Letting $K=4 k-1, X=2 x+1$, and $Y=2 y+1$, we obtain

$$
\begin{gathered}
4 p r=X^{2}+K \\
4 q r=Y^{2}+K
\end{gathered}
$$

with $X+Y=2 r$. Multiplying the two above equations,

$$
\begin{aligned}
16 p q r^{2} & =\left(X^{2}+K\right)\left(Y^{2}+K\right) \\
& =(X Y-K)^{2}+K(X+Y)^{2} \\
& =(X Y-K)^{2}+4 K r^{2} \\
4 p q & =\left(\frac{X Y-K}{2 r}\right)^{2}+K .
\end{aligned}
$$

In particular, the number $Z=\frac{X Y-K}{2 r}$ should be an integer, and so $4 p q=Z^{2}+K$. By parity, $Z$ is odd, and thus

$$
p q=z^{2}+z+k \quad \text { where } z=\frac{Z-1}{2}
$$

so $\{p, q\}$ is special.

Proof 2. As before, we suppose that

$$
\begin{aligned}
& x^{2}+x+k=p r \\
& y^{2}+y+k=q r .
\end{aligned}
$$

Subtracting, we have

$$
(x+y+1)(x-y)=r(p-q) .
$$

As before, we have $x+y=r-1$, so $x-y=p-q$, and

$$
\begin{aligned}
& x=\frac{1}{2}(r+p-q-1) \\
& y=\frac{1}{2}(r+q-p-1) .
\end{aligned}
$$

Then,

$$
\begin{aligned}
k=p r-x^{2}-x & =\frac{1}{4}\left(4 p r-(r+p-q-1)^{2}-2(r+p-q-1)\right) \\
& =\frac{1}{4}\left(4 p r-(r+p-q)^{2}+1\right) \\
& =\frac{1}{4}\left(2 p q+2 p r+2 q r-p^{2}-q^{2}-r^{2}+1\right),
\end{aligned}
$$

which is symmetric in $p, q, r$, so

$$
p q=z^{2}+z+k \quad \text { where } z=\frac{1}{2}(p+q-r-1),
$$

and $\{p, q\}$ is special.\\
Now we settle the problem by induction on $|S|$, with $|S| \leqslant 3$ clear.\\
Suppose we have proven it for $|S|=n$ and consider $|S|=n+1$. Let $r$ be the largest prime in $S$; the claim tells us that in any valid cycle of primes:

\begin{itemize}
  \item the neighbors of $r$ are uniquely determined, and
  \item removing $r$ from the cycle results in a smaller valid cycle.
\end{itemize}

It follows that there is at most one valid cycle, completing the inductive step.\\
Comment. The statement is not as inapplicable as it might seem. For example, for $k=41$, the following 385 primes form a valid cycle of primes:

\footnotetext{$53,4357,104173,65921,36383,99527,193789,2089123,1010357,2465263,319169,15559,3449,2647,1951,152297$, $542189,119773,91151,66431,222137,1336799,469069,45613,1047941,656291,355867,146669,874879,2213327$, 305119, 3336209, 1623467, 520963, 794201, 1124833, 28697, 15683, 42557, 6571, 39607, 1238833, 835421, 2653681, 5494387, 9357539, 511223, 1515317, 8868173, 114079681, 59334071, 22324807, 3051889, 5120939, 7722467, 266239, 693809 , 3931783 , 1322317, 100469, 13913, 74419, 23977, 1361, 62983, 935021, 512657, 1394849, 216259, 45827, 31393,100787 , 1193989, 600979, 209543, 357661, 545141, 19681, 10691, 28867, 165089, 2118023, 6271891, 12626693, 21182429,1100467 , 413089, 772867, 1244423, 1827757, 55889, 1558873, 5110711, 1024427, 601759, 290869, 91757, $951109,452033,136471,190031,4423,9239,15809,24133,115811,275911,34211,877,6653,88001,46261,317741$, 121523, 232439, 379009, 17827, 2699, 15937, 497729, 335539, 205223, 106781, 1394413, 4140947, 8346383, 43984757, 14010721, 21133961, 729451, 4997297, 1908223, 278051, 529747, 40213, 768107, 456821, 1325351, 225961, 1501921, $562763,75527,5519,9337,14153,499,1399,2753,14401,94583,245107,35171,397093,195907,2505623,34680911$, 18542791, 7415917, 144797293, 455529251, 86675291, 252704911, 43385123, 109207907, 204884269, 330414209, 14926789, 1300289, 486769, 2723989, 907757, 1458871, 65063, 4561, 124427, 81343, 252887, 2980139, 1496779, 3779057, 519193, 47381, 135283, 268267, 446333, 669481, 22541, 54167, 99439, 158357, 6823, 32497, 1390709, 998029, 670343, 5180017, 13936673, 2123491, 4391941, 407651, 209953, 77249, 867653, 427117, 141079, 9539, 227, $1439,18679,9749,25453,3697,42139,122327,712303,244261,20873,52051,589997,4310569,1711069,291563$, 3731527, 11045429, 129098443, 64620427, 162661963, 22233269, 37295047, 1936969, 5033449, 725537, 1353973, 6964457, 2176871, 97231, 7001, 11351, 55673, 16747, 169003, 1218571, 479957, 2779783, 949609, 4975787, 1577959, 2365007, 3310753, 79349, 23189, 107209, 688907, 252583, 30677, 523, 941, 25981, 205103, 85087, 1011233, 509659, 178259, 950479, 6262847, 2333693, 305497, 3199319, 9148267, 1527563, 466801, 17033, 9967, 323003, 4724099, 14278309, 2576557, 1075021, 6462593, 2266021, 63922471, 209814503, 42117791, 131659867, 270892249, 24845153, 12104557, 3896003, 219491, 135913, 406397, 72269, 191689, 2197697, 1091273, 2727311, 368227, 1911661, 601883, 892657, 28559, 4783, 60497, 31259, 80909, 457697, 153733, 11587, 1481, 26161, 15193, 7187, 2143, 21517, 10079, 207643, 1604381, 657661, 126227, 372313, 2176331, 748337, 64969, 844867, 2507291, 29317943, 14677801, 36952793, 69332267, 111816223, 5052241, 8479717, 441263, 3020431, 1152751, 13179611, 38280013, 6536771, 16319657, $91442699,30501409,49082027,72061511,2199433,167597,317963,23869,2927,3833,17327,110879,285517$, 40543, 4861, 21683, 50527, 565319, 277829, 687917, 3846023, 25542677, 174261149, 66370753, 9565711, 1280791, 91393, 6011, 7283, 31859, 8677, 10193, 43987, 11831, 13591, 127843, 358229, 58067, 15473, 65839, 17477, 74099, 19603, 82847, 21851, 61.
}",802,4
2022n8,Prove that $5^{n}-3^{n}$ is not divisible by $2^{n}+65$ for any positive integer $n$.,"Let $n$ be a positive integer, and let $m=2^{n}+65$. For the sake of contradiction, suppose that $m \mid 5^{n}-3^{n}$, so $5^{n} \equiv 3^{n}(\bmod m)$.

Notice that if $n$ is even, then $3 \mid m$, but $3 \nmid 5^{n}-3^{n}$, contradiction. So, from now on we assume that $n$ is odd, $n=2 k+1$. Obviously $n=1$ is not possible, so $n \geqslant 3$. Notice that $m$ is coprime to 2,3 and 5 .

\section*{Let $m_{1}$ be the smallest positive multiple of $m$ that can be written in the form of either $\left|5 a^{2}-3 b^{2}\right|$ or $\left|a^{2}-15 b^{2}\right|$ with some integers $a$ and $b$.}
Note that $5^{n}-3^{n}=5\left(5^{k}\right)^{2}-3\left(3^{k}\right)^{2}$ is a multiple of $m$, so the set of such multiples is non-empty, and therefore $m_{1}$ is well-defined.\\
I. First we show that $m_{1} \leqslant 5 m$. Consider the numbers

$$
5^{k+1} x+3^{k+1} y, \quad 0 \leqslant x, y \leqslant \sqrt{m} .
$$

There are $\lfloor\sqrt{m}\rfloor+1>\sqrt{m}$ choices for $x$ and $y$, so there are more than $m$ possible pairs $(x, y)$. Hence, two of these sums are congruent modulo $m$ : $5^{k+1} x_{1}+3^{k+1} y_{1} \equiv 5^{k+1} x_{2}+3^{k+1} y_{2}(\bmod m)$.

Now choose $a=x_{1}-x_{2}$ and $b=y_{1}-y_{2}$; at least one of $a, b$ is nonzero, and

$$
5^{k+1} a+3^{k+1} b \equiv 0 \quad(\bmod m), \quad|a|,|b| \leqslant \sqrt{m} .
$$

From

$$
0 \equiv\left(5^{k+1} a\right)^{2}-\left(3^{k+1} b\right)^{2}=5^{n+1} a^{2}-3^{n+1} b^{2} \equiv 5 \cdot 3^{n} a^{2}-3^{n+1} b^{2}=3^{n}\left(5 a^{2}-3 b^{2}\right) \quad(\bmod m)
$$

we can see that $\left|5 a^{2}-3 b^{2}\right|$ is a multiple of $m$. Since at least one of $a$ and $b$ is nonzero, $5 a^{2} \neq 3 b^{2}$. Hence, by the choice of $a, b$, we have $0<\left|5 a^{2}-3 b^{2}\right| \leqslant \max \left(5 a^{2}, 3 b^{2}\right) \leqslant 5 m$. That shows that $m_{1} \leqslant 5 m$.\\
II. Next, we show that $m_{1}$ cannot be divisible by 2,3 and 5 . Since $m_{1}$ equals either $\left|5 a^{2}-3 b^{2}\right|$ or $\left|a^{2}-15 b^{2}\right|$ with some integers $a, b$, we have six cases to check. In all six cases, we will get a contradiction by presenting another multiple of $m$, smaller than $m_{1}$.

\begin{itemize}
  \item If $5 \mid m_{1}$ and $m_{1}=\left|5 a^{2}-3 b^{2}\right|$, then $5 \mid b$ and $\left|a^{2}-15\left(\frac{b}{5}\right)^{2}\right|=\frac{m_{1}}{5}<m_{1}$.
  \item If $5 \mid m_{1}$ and $m_{1}=\left|a^{2}-15 b^{2}\right|$, then $5 \mid a$ and $\left|5\left(\frac{a}{5}\right)^{2}-3 b^{2}\right|=\frac{m_{1}}{5}<m_{1}$.
  \item If $3 \mid m_{1}$ and $m_{1}=\left|5 a^{2}-3 b^{2}\right|$, then $3 \mid a$ and $\left|b^{2}-15\left(\frac{a}{3}\right)^{2}\right|=\frac{m_{1}}{3}<m_{1}$.
  \item If $3 \mid m_{1}$ and $m_{1}=\left|a^{2}-15 b^{2}\right|$, then $3 \mid a$ and $\left|5 b^{2}-3\left(\frac{a}{3}\right)^{2}\right|=\frac{m_{1}}{3}<m_{1}$.
  \item If $2 \mid m_{1}$ and $m_{1}=\left|5 a^{2}-3 b^{2}\right|$, then $\left|\left(\frac{5 a-3 b}{2}\right)^{2}-15\left(\frac{a-b}{2}\right)^{2}\right|=\frac{m_{1}}{2}<m_{1}$.
  \item If $2 \mid m_{1}$ and $m_{1}=\left|a^{2}-15 b^{2}\right|$, then $\left|5\left(\frac{a-3 b}{2}\right)^{2}-3\left(\frac{a-5 b}{2}\right)^{2}\right|=\frac{m_{1}}{2}<m_{1}$.\\
(The last two expressions can be obtained from $(\sqrt{5} a+\sqrt{3} b)(\sqrt{5}-\sqrt{3})=(5 a-3 b)+\sqrt{15}(b-a)$ and $(a+\sqrt{15} b)(\sqrt{5}-\sqrt{3})=\sqrt{5}(a-3 b)+\sqrt{3}(5 b-a)$.)
\end{itemize}

In all six cases, we found that either $\frac{m_{1}}{2}, \frac{m_{1}}{3}$ or $\frac{m_{1}}{5}$ is of the form $\left|5 x^{2}-3 y^{2}\right|$ or $\left|x^{2}-15 y^{2}\right|$. Since $m$ is coprime to 2,3 and 5 , the presented number is a multiple of $m$, but this contradicts the minimality of $m_{1}$.\\
III. The last remaining case is $m_{1}=m$, so either $m=\left|5 a^{2}-3 b^{2}\right|$ or $m=\left|a^{2}-15 b^{2}\right|$. We will get a contradiction by considering the two sides modulo 3,4 and 5 .

\begin{itemize}
  \item $2^{n}+65=5 a^{2}-3 b^{2}$ is not possible, because $2^{n}+65 \equiv 1(\bmod 3)$, but $5 a^{2}-3 b^{2} \not \equiv 1$ $(\bmod 3)$.
  \item $2^{n}+65=3 b^{2}-5 a^{2}$ is not possible, because $2^{n}+65 \equiv 1(\bmod 4)$, but $3 b^{2}-5 a^{2} \not \equiv 1$ $(\bmod 4)$.
  \item $2^{n}+65=a^{2}-15 b^{2}$ is not possible, because $2^{n}+65 \equiv \pm 2(\bmod 5)$, but $a^{2}-15 b^{2} \not \equiv \pm 2$ $(\bmod 5)$.
  \item $2^{n}+65=15 b^{2}-a^{2}$ is not possible, because $2^{n}+65 \equiv 1(\bmod 4)$, but $15 b^{2}-a^{2} \not \equiv 1$ $(\bmod 4)$.
\end{itemize}

We found a contradiction in all cases, that completes the solution.\\
Comment 1. Part I is a standard application of Thue's lemma:\\
Lemma (Thue). Suppose that $m>1$ and $c$ are integers, and $X, Y$ are positive integers such that $X \leqslant m<X Y$. Then there exist some integers $x, y$ with $|x|<X$ and $0<y<Y$, such that $x \equiv c y(\bmod m)$.

It is a well-known corollary that if $c, d$ are coprime to $m$, the congruence $c x^{2} \equiv d y^{2}(\bmod m)$ has a solution such that $x, y$ are coprime to $m$, and $X, Y$ are positive integers such that $X Y>m$, then $c x^{2} \equiv d y^{2}(\bmod m)$ has a solution such that at least one of $x, y$ is nonzero, $|x|<X$ and $|y|<Y$.

In the solution we applied this corollary with $c=5, d=3, X=Y=\lfloor\sqrt{m}\rfloor+1$.\\
Comment 2. In fact, we proved that a positive integer $m$ with $m \equiv 13$ or $37(\bmod 60)$ cannot divide any nonzero integer of the form $5 a^{2}-3 b^{2}$ or $a^{2}-15 b^{2}$ with coprime integers $a, b$. In other words, if $m \equiv 13$ or $37(\bmod 60)$, then 15 is not a quadratic residue modulo $m$. Using the tools of quadratic reciprocity, the solution can be significantly shortened.

Suppose that $a$ and $b$ are coprime. For every prime divisor $p>5$ of $5 a^{2}-3 b^{2}$ or $a^{2}-15 b^{2}$, we have


\begin{equation*}
1=\left(\frac{15}{p}\right)=\left(\frac{3}{p}\right)\left(\frac{5}{p}\right)=(-1)^{\frac{p-1}{2}}\left(\frac{p}{3}\right)\left(\frac{p}{5}\right) \tag{1}
\end{equation*}


where $\left(\frac{a}{p}\right)$ stands for the Legendre symbol. Considering the remainders of $p$ when divided by 4,3 and 5, (1) leads to

$$
p \equiv \pm 1, \pm 7, \pm 11 \text { or } \pm 17 \bmod 60
$$

These remainders form a subgroup of the reduced remainders modulo 60. Since 13 and 37 are not elements in this subgroup, the number $m=2^{n}+65$ cannot be a product of such primes.

Instead of handling the prime divisors of $m$ separately, we can use Jacobi symbols for further simplification, as shown in the next solution.

",924,4
2021a1,"Let $n$ be an integer, and let $A$ be a subset of $\left\{0,1,2,3, \ldots, 5^{n}\right\}$ consisting of $4 n+2$ numbers. Prove that there exist $a, b, c \in A$ such that $a<b<c$ and $c+2 a>3 b$.","(By contradiction) Suppose that there exist $4 n+2$ non-negative integers $x_{0}<$ $x_{1}<\cdots<x_{4 n+1}$ that violate the problem statement. Then in particular $x_{4 n+1}+2 x_{i} \leqslant 3 x_{i+1}$ for all $i=0, \ldots, 4 n-1$, which gives

$$
x_{4 n+1}-x_{i} \geqslant \frac{3}{2}\left(x_{4 n+1}-x_{i+1}\right) .
$$

By a trivial induction we then get

$$
x_{4 n+1}-x_{i} \geqslant\left(\frac{3}{2}\right)^{4 n-i}\left(x_{4 n+1}-x_{4 n}\right)
$$

which for $i=0$ yields the contradiction

$$
x_{4 n+1}-x_{0} \geqslant\left(\frac{3}{2}\right)^{4 n}\left(x_{4 n+1}-x_{4 n}\right)=\left(\frac{81}{16}\right)^{n}\left(x_{4 n+1}-x_{4 n}\right)>5^{n} \cdot 1
$$
",76,1
2021a4,"Show that for all real numbers $x_{1}, \ldots, x_{n}$ the following inequality holds:

$$
\sum_{i=1}^{n} \sum_{j=1}^{n} \sqrt{\left|x_{i}-x_{j}\right|} \leqslant \sum_{i=1}^{n} \sum_{j=1}^{n} \sqrt{\left|x_{i}+x_{j}\right|} .
$$","If we add $t$ to all the variables then the left-hand side remains constant and the right-hand side becomes

$$
H(t):=\sum_{i=1}^{n} \sum_{j=1}^{n} \sqrt{\left|x_{i}+x_{j}+2 t\right|} .
$$

Let $T$ be large enough such that both $H(-T)$ and $H(T)$ are larger than the value $L$ of the lefthand side of the inequality we want to prove. Not necessarily distinct points $p_{i, j}:=-\left(x_{i}+x_{j}\right) / 2$ together with $T$ and $-T$ split the real line into segments and two rays such that on each of these segments and rays the function $H(t)$ is concave since $f(t):=\sqrt{|\ell+2 t|}$ is concave on both intervals $(-\infty,-\ell / 2]$ and $[-\ell / 2,+\infty)$. Let $[a, b]$ be the segment containing zero. Then concavity implies $H(0) \geqslant \min \{H(a), H(b)\}$ and, since $H( \pm T)>L$, it suffices to prove the inequalities $H\left(-\left(x_{i}+x_{j}\right) / 2\right) \geqslant L$, that is to prove the original inequality in the case when all numbers are shifted in such a way that two variables $x_{i}$ and $x_{j}$ add up to zero. In the following we denote the shifted variables still by $x_{i}$.

If $i=j$, i.e. $x_{i}=0$ for some index $i$, then we can remove $x_{i}$ which will decrease both sides by $2 \sum_{k} \sqrt{\left|x_{k}\right|}$. Similarly, if $x_{i}+x_{j}=0$ for distinct $i$ and $j$ we can remove both $x_{i}$ and $x_{j}$ which decreases both sides by

$$
2 \sqrt{2\left|x_{i}\right|}+2 \cdot \sum_{k \neq i, j}\left(\sqrt{\left|x_{k}+x_{i}\right|}+\sqrt{\left|x_{k}+x_{j}\right|}\right)
$$

In either case we reduced our inequality to the case of smaller $n$. It remains to note that for $n=0$ and $n=1$ the inequality is trivial.\\

",254,3
2021a5,"Let $n \geqslant 2$ be an integer, and let $a_{1}, a_{2}, \ldots, a_{n}$ be positive real numbers such that $a_{1}+a_{2}+\cdots+a_{n}=1$. Prove that

$$
\sum_{k=1}^{n} \frac{a_{k}}{1-a_{k}}\left(a_{1}+a_{2}+\cdots+a_{k-1}\right)^{2}<\frac{1}{3} .
$$","For all $k \leqslant n$, let

$$
s_{k}=a_{1}+a_{2}+\cdots+a_{k} \quad \text { and } \quad b_{k}=\frac{a_{k} s_{k-1}^{2}}{1-a_{k}}
$$

with the convention that $s_{0}=0$. Note that $b_{k}$ is exactly a summand in the sum we need to estimate. We shall prove the inequality


\begin{equation*}
b_{k}<\frac{s_{k}^{3}-s_{k-1}^{3}}{3} \tag{1}
\end{equation*}


Indeed, it suffices to check that

$$
\begin{aligned}
(1) & \Longleftrightarrow 0<\left(1-a_{k}\right)\left(\left(s_{k-1}+a_{k}\right)^{3}-s_{k-1}^{3}\right)-3 a_{k} s_{k-1}^{2} \\
& \Longleftrightarrow 0<\left(1-a_{k}\right)\left(3 s_{k-1}^{2}+3 s_{k-1} a_{k}+a_{k}^{2}\right)-3 s_{k-1}^{2} \\
& \Longleftrightarrow 0<-3 a_{k} s_{k-1}^{2}+3\left(1-a_{k}\right) s_{k-1} a_{k}+\left(1-a_{k}\right) a_{k}^{2} \\
& \Longleftrightarrow 0<3\left(1-a_{k}-s_{k-1}\right) s_{k-1} a_{k}+\left(1-a_{k}\right) a_{k}^{2}
\end{aligned}
$$

which holds since $a_{k}+s_{k-1}=s_{k} \leqslant 1$ and $a_{k} \in(0,1)$.\\
Thus, adding inequalities (1) for $k=1, \ldots, n$, we conclude that

$$
b_{1}+b_{2}+\cdots+b_{n}<\frac{s_{n}^{3}-s_{0}^{3}}{3}=\frac{1}{3}
$$

as desired.\\
Comment 1. There are many ways of proving (1) which can be written as


\begin{equation*}
\frac{a s^{2}}{1-a}-\frac{(a+s)^{3}-s^{3}}{3}<0, \tag{2}
\end{equation*}


for non-negative $a$ and $s$ satisfying $a+s \leqslant 1$ and $a>0$.\\
E.g., note that for any fixed $a$ the expression in (2) is quadratic in $s$ with the leading coefficient $a /(1-a)-a>0$. Hence, it is convex as a function in $s$, so it suffices to check the inequality at $s=0$ and $s=1-a$. The former case is trivial and in the latter case the inequality can be rewritten as

$$
a s-\frac{3 a s(a+s)+a^{3}}{3}<0,
$$

which is trivial since $a+s=1$.\\
",208,2
2021a6,"Let $A$ be a finite set of (not necessarily positive) integers, and let $m \geqslant 2$ be an integer. Assume that there exist non-empty subsets $B_{1}, B_{2}, B_{3}, \ldots, B_{m}$ of $A$ whose elements add up to the sums $m^{1}, m^{2}, m^{3}, \ldots, m^{m}$, respectively. Prove that $A$ contains at least $m / 2$ elements.","Solution. Let $A=\left\{a_{1}, \ldots, a_{k}\right\}$. Assume that, on the contrary, $k=|A|<m / 2$. Let

$$
s_{i}:=\sum_{j: a_{j} \in B_{i}} a_{j}
$$

be the sum of elements of $B_{i}$. We are given that $s_{i}=m^{i}$ for $i=1, \ldots, m$.\\
Now consider all $m^{m}$ expressions of the form

$$
f\left(c_{1}, \ldots, c_{m}\right):=c_{1} s_{1}+c_{2} s_{2}+\ldots+c_{m} s_{m}, c_{i} \in\{0,1, \ldots, m-1\} \text { for all } i=1,2, \ldots, m .
$$

Note that every number $f\left(c_{1}, \ldots, c_{m}\right)$ has the form

$$
\alpha_{1} a_{1}+\ldots+\alpha_{k} a_{k}, \alpha_{i} \in\{0,1, \ldots, m(m-1)\} .
$$

Hence, there are at most $(m(m-1)+1)^{k}<m^{2 k}<m^{m}$ distinct values of our expressions; therefore, at least two of them coincide.

Since $s_{i}=m^{i}$, this contradicts the uniqueness of representation of positive integers in the base- $m$ system.

Comment 1. For other rapidly increasing sequences of sums of $B_{i}$ 's the similar argument also provides lower estimates on $k=|A|$. For example, if the sums of $B_{i}$ are equal to $1!, 2!, 3!, \ldots, m!$, then for any fixed $\varepsilon>0$ and large enough $m$ we get $k \geqslant(1 / 2-\varepsilon) m$. The proof uses the fact that the combinations $\sum c_{i}$ ! with $c_{i} \in\{0,1, \ldots, i\}$ are all distinct.

Comment 2. The problem statement holds also if $A$ is a set of real numbers (not necessarily integers), the above proofs work in the real case.",218,2
2021a7,"Let $n \geqslant 1$ be an integer, and let $x_{0}, x_{1}, \ldots, x_{n+1}$ be $n+2$ non-negative real numbers that satisfy $x_{i} x_{i+1}-x_{i-1}^{2} \geqslant 1$ for all $i=1,2, \ldots, n$. Show that

$$
x_{0}+x_{1}+\cdots+x_{n}+x_{n+1}>\left(\frac{2 n}{3}\right)^{3 / 2}
$$","Lemma 1.1. If $a, b, c$ are non-negative numbers such that $a b-c^{2} \geqslant 1$, then

$$
(a+2 b)^{2} \geqslant(b+2 c)^{2}+6
$$

Proof. $(a+2 b)^{2}-(b+2 c)^{2}=(a-b)^{2}+2(b-c)^{2}+6\left(a b-c^{2}\right) \geqslant 6$.\\
Lemma 1.2. $\sqrt{1}+\cdots+\sqrt{n}>\frac{2}{3} n^{3 / 2}$.\\
Proof. Bernoulli's inequality $(1+t)^{3 / 2}>1+\frac{3}{2} t$ for $0>t \geqslant-1$ (or, alternatively, a straightforward check) gives


\begin{equation*}
(k-1)^{3 / 2}=k^{3 / 2}\left(1-\frac{1}{k}\right)^{3 / 2}>k^{3 / 2}\left(1-\frac{3}{2 k}\right)=k^{3 / 2}-\frac{3}{2} \sqrt{k} \tag{*}
\end{equation*}


Summing up (*) over $k=1,2, \ldots, n$ yields

$$
0>n^{3 / 2}-\frac{3}{2}(\sqrt{1}+\cdots+\sqrt{n})
$$

Now put $y_{i}:=2 x_{i}+x_{i+1}$ for $i=0,1, \ldots, n$. We get $y_{0} \geqslant 0$ and $y_{i}^{2} \geqslant y_{i-1}^{2}+6$ for $i=1,2, \ldots, n$ by Lemma 1.1. Thus, an easy induction on $i$ gives $y_{i} \geqslant \sqrt{6 i}$. Using this estimate and Lemma 1.2 we get

$$
3\left(x_{0}+\ldots+x_{n+1}\right) \geqslant y_{1}+\ldots+y_{n} \geqslant \sqrt{6}(\sqrt{1}+\sqrt{2}+\ldots+\sqrt{n})>\sqrt{6} \cdot \frac{2}{3} n^{3 / 2}=3\left(\frac{2 n}{3}\right)^{3 / 2}
$$

",138,2
2021c1,"Let $S$ be an infinite set of positive integers, such that there exist four pairwise distinct $a, b, c, d \in S$ with $\operatorname{gcd}(a, b) \neq \operatorname{gcd}(c, d)$. Prove that there exist three pairwise distinct $x, y, z \in S$ such that $\operatorname{gcd}(x, y)=\operatorname{gcd}(y, z) \neq \operatorname{gcd}(z, x)$.","Solution. There exists $\alpha \in S$ so that $\{\operatorname{gcd}(\alpha, s) \mid s \in S, s \neq \alpha\}$ contains at least two elements. Since $\alpha$ has only finitely many divisors, there is a $d \mid \alpha$ such that the set $B=\{\beta \in$ $S \mid \operatorname{gcd}(\alpha, \beta)=d\}$ is infinite. Pick $\gamma \in S$ so that $\operatorname{gcd}(\alpha, \gamma) \neq d$. Pick $\beta_{1}, \beta_{2} \in B$ so that $\operatorname{gcd}\left(\beta_{1}, \gamma\right)=\operatorname{gcd}\left(\beta_{2}, \gamma\right)=: d^{\prime}$. If $d=d^{\prime}$, then $\operatorname{gcd}\left(\alpha, \beta_{1}\right)=\operatorname{gcd}\left(\gamma, \beta_{1}\right) \neq \operatorname{gcd}(\alpha, \gamma)$. If $d \neq d^{\prime}$, then either $\operatorname{gcd}\left(\alpha, \beta_{1}\right)=\operatorname{gcd}\left(\alpha, \beta_{2}\right)=d$ and $\operatorname{gcd}\left(\beta_{1}, \beta_{2}\right) \neq d$ or $\operatorname{gcd}\left(\gamma, \beta_{1}\right)=\operatorname{gcd}\left(\gamma, \beta_{2}\right)=d^{\prime}$ and $\operatorname{gcd}\left(\beta_{1}, \beta_{2}\right) \neq d^{\prime}$.

Comment. The situation can be modelled as a complete graph on the infinite vertex set $S$, where every edge $\{s, t\}$ is colored by $c(s, t):=\operatorname{gcd}(s, t)$. For every vertex the incident edges carry only finitely many different colors, and by the problem statement at least two different colors show up on the edge set. The goal is to show that there exists a bi-colored triangle (a triangle, whose edges carry exactly two different colors).

For the proof, consider a vertex $v$ whose incident edges carry at least two different colors. Let $X \subset S$ be an infinite subset so that $c(v, x) \equiv c_{1}$ for all $x \in X$. Let $y \in S$ be a vertex so that $c(v, y) \neq c_{1}$. Let $x_{1}, x_{2} \in X$ be two vertices with $c\left(y, x_{1}\right)=c\left(y, x_{2}\right)=c_{2}$. If $c_{1}=c_{2}$, then the triangle $v, y, x_{1}$ is bi-colored. If $c_{1} \neq c_{2}$, then one of $v, x_{1}, x_{2}$ and $y, x_{1}, x_{2}$ is bi-colored.",261,3
2021c3,"A thimblerigger has 2021 thimbles numbered from 1 through 2021. The thimbles are arranged in a circle in arbitrary order. The thimblerigger performs a sequence of 2021 moves; in the $k^{\text {th }}$ move, he swaps the positions of the two thimbles adjacent to thimble $k$.

Prove that there exists a value of $k$ such that, in the $k^{\text {th }}$ move, the thimblerigger swaps some thimbles $a$ and $b$ such that $a<k<b$.","Solution. Assume the contrary. Say that the $k^{\text {th }}$ thimble is the central thimble of the $k^{\text {th }}$ move, and its position on that move is the central position of the move.\\
Step 1: Black and white colouring.\\
Before the moves start, let us paint all thimbles in white. Then, after each move, we repaint its central thimble in black. This way, at the end of the process all thimbles have become black.

By our assumption, in every move $k$, the two swapped thimbles have the same colour (as their numbers are either both larger or both smaller than $k$ ). At every moment, assign the colours of the thimbles to their current positions; then the only position which changes its colour in a move is its central position. In particular, each position is central for exactly one move (when it is being repainted to black).\\
Step 2: Red and green colouring.\\
Now we introduce a colouring of the positions. If in the $k^{\text {th }}$ move, the numbers of the two swapped thimbles are both less than $k$, then we paint the central position of the move in red; otherwise we paint that position in green. This way, each position has been painted in red or green exactly once. We claim that among any two adjacent positions, one becomes green and the other one becomes red; this will provide the desired contradiction since 2021 is odd.

Consider two adjacent positions $A$ and $B$, which are central in the $a^{\text {th }}$ and in the $b^{\text {th }}$ moves, respectively, with $a<b$. Then in the $a^{\text {th }}$ move the thimble at position $B$ is white, and therefore has a number greater than $a$. After the $a^{\text {th }}$ move, position $A$ is green and the thimble at position $A$ is black. By the arguments from Step 1, position $A$ contains only black thimbles after the $a^{\text {th }}$ step. Therefore, on the $b^{\text {th }}$ move, position $A$ contains a black thimble whose number is therefore less than $b$, while thimble $b$ is at position $B$. So position $B$ becomes red, and hence $A$ and $B$ have different colours.

Comment 1. Essentially, Step 1 provides the proof of the following two assertions (under the indirect assumption):\\
(1) Each position $P$ becomes central in exactly one move (denote that move's number by $k$ ); and\\
(2) Before the $k^{\text {th }}$ move, position $P$ always contains a thimble whose number is larger than the number of the current move, while after the $k^{\text {th }}$ move the position always contains a thimble whose number is smaller than the number of the current move.

Both (1) and (2) can be proved without introduction of colours, yet the colours help to visualise the argument.

After these two assertions have been proved, Step 2 can be performed in various ways, e.g., as follows.

At any moment in the process, the black positions are split into several groups consisting of one or more contiguous black positions each; different groups are separated by white positions. Now one can prove by induction on $k$ that, after the $k^{\text {th }}$ move, all groups have odd sizes. Indeed, in every move, the new black position either forms a separate group, or merges two groups (say, of lengths $a$ and $b$ ) into a single group of length $a+b+1$.

However, after the $2020^{\text {th }}$ move the black positions should form one group of length 2020 . This is a contradiction.

This argument has several variations; e.g., one can check in a similar way that, after the process starts, at least one among the groups of white positions has an even size.

Comment 2. The solution above works equally well for any odd number of thimbles greater than 1 , instead of 2021. On the other hand, a similar statement with an even number $n=2 k \geqslant 4$ of thimbles is wrong. To show that, the thimblerigger can enumerate positions from 1 through $n$ clockwise, and then put thimbles $1,2, \ldots, k$ at the odd positions, and thimbles $k+1, k+2, \ldots, 2 k$ at the even positions.",691,4
2021c4,"The kingdom of Anisotropy consists of $n$ cities. For every two cities there exists exactly one direct one-way road between them. We say that a path from $X$ to $Y$ is a sequence of roads such that one can move from $X$ to $Y$ along this sequence without returning to an already visited city. A collection of paths is called diverse if no road belongs to two or more paths in the collection.

Let $A$ and $B$ be two distinct cities in Anisotropy. Let $N_{A B}$ denote the maximal number of paths in a diverse collection of paths from $A$ to $B$. Similarly, let $N_{B A}$ denote the maximal number of paths in a diverse collection of paths from $B$ to $A$. Prove that the equality $N_{A B}=N_{B A}$ holds if and only if the number of roads going out from $A$ is the same as the number of roads going out from $B$.","We write $X \rightarrow Y($ or $Y \leftarrow X)$ if the road between $X$ and $Y$ goes from $X$ to $Y$. Notice that, if there is any route moving from $X$ to $Y$ (possibly passing through some cities more than once), then there is a path from $X$ to $Y$ consisting of some roads in the route. Indeed, any cycle in the route may be removed harmlessly; after some removals one obtains a path.

Say that a path is short if it consists of one or two roads.\\
Partition all cities different from $A$ and $B$ into four groups, $\mathcal{I}, \mathcal{O}, \mathcal{A}$, and $\mathcal{B}$ according to the following rules: for each city $C$,

$$
\begin{array}{ll}
C \in \mathcal{I} \Longleftrightarrow A \rightarrow C \leftarrow B ; & C \in \mathcal{O} \Longleftrightarrow A \leftarrow C \rightarrow B ; \\
C \in \mathcal{A} \Longleftrightarrow A \rightarrow C \rightarrow B ; & C \in \mathcal{B} \Longleftrightarrow A \leftarrow C \leftarrow B .
\end{array}
$$

Lemma. Let $\mathcal{P}$ be a diverse collection consisting of $p$ paths from $A$ to $B$. Then there exists a diverse collection consisting of at least $p$ paths from $A$ to $B$ and containing all short paths from $A$ to $B$.\\
Proof. In order to obtain the desired collection, modify $\mathcal{P}$ as follows.\\
If there is a direct road $A \rightarrow B$ and the path consisting of this single road is not in $\mathcal{P}$, merely add it to $\mathcal{P}$.

Now consider any city $C \in \mathcal{A}$ such that the path $A \rightarrow C \rightarrow B$ is not in $\mathcal{P}$. If $\mathcal{P}$ contains at most one path containing a road $A \rightarrow C$ or $C \rightarrow B$, remove that path (if it exists), and add the path $A \rightarrow C \rightarrow B$ to $\mathcal{P}$ instead. Otherwise, $\mathcal{P}$ contains two paths of the forms $A \rightarrow C \rightarrow B$ and $A \rightarrow C \rightarrow B$, where $C \rightarrow B$ and $A \rightarrow C$ are some paths. In this case, we recombine the edges to form two new paths $A \rightarrow C \rightarrow B$ and $A \rightarrow C \rightarrow B$ (removing cycles from the latter if needed). Now we replace the old two paths in $\mathcal{P}$ with the two new ones.

After any operation described above, the number of paths in the collection does not decrease, and the collection remains diverse. Applying such operation to each $C \in \mathcal{A}$, we obtain the desired collection.

Back to the problem, assume, without loss of generality, that there is a road $A \rightarrow B$, and let $a$ and $b$ denote the numbers of roads going out from $A$ and $B$, respectively. Choose a diverse collection $\mathcal{P}$ consisting of $N_{A B}$ paths from $A$ to $B$. We will transform it into a diverse collection $\mathcal{Q}$ consisting of at least $N_{A B}+(b-a)$ paths from $B$ to $A$. This construction yields

$$
N_{B A} \geqslant N_{A B}+(b-a) ; \quad \text { similarly, we get } \quad N_{A B} \geqslant N_{B A}+(a-b)
$$

whence $N_{B A}-N_{A B}=b-a$. This yields the desired equivalence.\\
Apply the lemma to get a diverse collection $\mathcal{P}^{\prime}$ of at least $N_{A B}$ paths containing all $|\mathcal{A}|+1$ short paths from $A$ to $B$. Notice that the paths in $\mathcal{P}^{\prime}$ contain no edge of a short path from $B$ to $A$. Each non-short path in $\mathcal{P}^{\prime}$ has the form $A \rightarrow C \rightarrow D \rightarrow B$, where $C \rightarrow D$ is a path from some city $C \in \mathcal{I}$ to some city $D \in \mathcal{O}$. For each such path, put into $\mathcal{Q}$ the\\
path $B \rightarrow C \longrightarrow D \rightarrow A$; also put into $\mathcal{Q}$ all short paths from $B$ to $A$. Clearly, the collection $\mathcal{Q}$ is diverse.

Now, all roads going out from $A$ end in the cities from $\mathcal{I} \cup \mathcal{A} \cup\{B\}$, while all roads going out from $B$ end in the cities from $\mathcal{I} \cup \mathcal{B}$. Therefore,

$$
a=|\mathcal{I}|+|\mathcal{A}|+1, \quad b=|\mathcal{I}|+|\mathcal{B}|, \quad \text { and hence } \quad a-b=|\mathcal{A}|-|\mathcal{B}|+1
$$

On the other hand, since there are $|\mathcal{A}|+1$ short paths from $A$ to $B$ (including $A \rightarrow B$ ) and $|\mathcal{B}|$ short paths from $B$ to $A$, we infer

$$
|\mathcal{Q}|=\left|\mathcal{P}^{\prime}\right|-(|\mathcal{A}|+1)+|\mathcal{B}| \geqslant N_{A B}+(b-a)
$$

as desired.
",691,4
2021c5,"Let $n$ and $k$ be two integers with $n>k \geqslant 1$. There are $2 n+1$ students standing in a circle. Each student $S$ has $2 k$ neighbours - namely, the $k$ students closest to $S$ on the right, and the $k$ students closest to $S$ on the left.

Suppose that $n+1$ of the students are girls, and the other $n$ are boys. Prove that there is a girl with at least $k$ girls among her neighbours.","Solution. We replace the girls by 1's, and the boys by 0's, getting the numbers $a_{1}, a_{2}, \ldots, a_{2 n+1}$ arranged in a circle. We extend this sequence periodically by letting $a_{2 n+1+k}=a_{k}$ for all $k \in \mathbb{Z}$. We get an infinite periodic sequence

$$
\ldots, a_{1}, a_{2}, \ldots, a_{2 n+1}, a_{1}, a_{2}, \ldots, a_{2 n+1}, \ldots
$$

Consider the numbers $b_{i}=a_{i}+a_{i-k-1}-1 \in\{-1,0,1\}$ for all $i \in \mathbb{Z}$. We know that


\begin{equation*}
b_{m+1}+b_{m+2}+\cdots+b_{m+2 n+1}=1 \quad(m \in \mathbb{Z}) \tag{1}
\end{equation*}


in particular, this yields that there exists some $i_{0}$ with $b_{i_{0}}=1$. Now we want to find an index $i$ such that


\begin{equation*}
b_{i}=1 \quad \text { and } \quad b_{i+1}+b_{i+2}+\cdots+b_{i+k} \geqslant 0 \tag{2}
\end{equation*}


This will imply that $a_{i}=1$ and

$$
\left(a_{i-k}+a_{i-k+1}+\cdots+a_{i-1}\right)+\left(a_{i+1}+a_{i+2}+\cdots+a_{i+k}\right) \geqslant k
$$

as desired.\\
Suppose, to the contrary, that for every index $i$ with $b_{i}=1$ the sum $b_{i+1}+b_{i+2}+\cdots+b_{i+k}$ is negative. We start from some index $i_{0}$ with $b_{i_{0}}=1$ and construct a sequence $i_{0}, i_{1}, i_{2}, \ldots$, where $i_{j}(j>0)$ is the smallest possible index such that $i_{j}>i_{j-1}+k$ and $b_{i_{j}}=1$. We can choose two numbers among $i_{0}, i_{1}, \ldots, i_{2 n+1}$ which are congruent modulo $2 n+1$ (without loss of generality, we may assume that these numbers are $i_{0}$ and $i_{T}$ ).

On the one hand, for every $j$ with $0 \leqslant j \leqslant T-1$ we have

$$
S_{j}:=b_{i_{j}}+b_{i_{j}+1}+b_{i_{j}+2}+\cdots+b_{i_{j+1}-1} \leqslant b_{i_{j}}+b_{i_{j}+1}+b_{i_{j}+2}+\cdots+b_{i_{j}+k} \leqslant 0
$$

since $b_{i_{j}+k+1}, \ldots, b_{i_{j+1}-1} \leqslant 0$. On the other hand, since $\left(i_{T}-i_{0}\right) \mid(2 n+1)$, from (1) we deduce

$$
S_{0}+\cdots+S_{T-1}=\sum_{i=i_{0}}^{i_{T}-1} b_{i}=\frac{i_{T}-i_{0}}{2 n+1}>0
$$

This contradiction finishes the solution.\\
Comment 1. After the problem is reduced to finding an index $i$ satisfying (2), one can finish the solution by applying the (existence part of) following statement.\\
Lemma (Raney). If $\left\langle x_{1}, x_{2}, \ldots, x_{m}\right\rangle$ is any sequence of integers whose sum is +1 , exactly one of the cyclic shifts $\left\langle x_{1}, x_{2}, \ldots, x_{m}\right\rangle,\left\langle x_{2}, \ldots, x_{m}, x_{1}\right\rangle, \ldots,\left\langle x_{m}, x_{1}, \ldots, x_{m-1}\right\rangle$ has all of its partial sums positive.

A (possibly wider known) version of this lemma, which also can be used in order to solve the problem, is the following\\
Claim (Gas stations problem). Assume that there are several fuel stations located on a circular route which together contain just enough gas to make one trip around. Then one can make it all the way around, starting at the right station with an empty tank.

Both Raney's theorem and the Gas stations problem admit many different (parallel) proofs. Their ideas can be disguised in direct solutions of the problem at hand (as it, in fact, happens in the above solution); such solutions may avoid the introduction of the $b_{i}$. Below, in Comment 2 we present a variant of such solution, while in Comment 3 we present an alternative proof of Raney's theorem.

Comment 2. Here is a version of the solution which avoids the use of the $b_{i}$.\\
Suppose the contrary. Introduce the numbers $a_{i}$ as above. Starting from any index $s_{0}$ with $a_{s_{0}}=1$, we construct a sequence $s_{0}, s_{1}, s_{2}, \ldots$ by letting $s_{i}$ to be the smallest index larger than $s_{i-1}+k$ such that $a_{s_{i}}=1$, for $i=1,2, \ldots$ Choose two indices among $s_{1}, \ldots, s_{2 n+1}$ which are congruent modulo $2 n+1$; we assume those two are $s_{0}$ and $s_{T}$, with $s_{T}-s_{0}=t(2 n+1)$. Notice here that $s_{T+1}-s_{T}=s_{1}-s_{0}$.

For every $i=0,1,2, \ldots, T$, put

$$
L_{i}=s_{i+1}-s_{i} \quad \text { and } \quad S_{i}=a_{s_{i}}+a_{s_{i}+1}+\cdots+a_{s_{i+1}-1}
$$

Now, by the indirect assumption, for every $i=1,2, \ldots, T$, we have

$$
a_{s_{i}-k}+a_{s_{i}-k+1}+\cdots+a_{s_{i}+k} \leqslant a_{s_{i}}+(k-1)=k
$$

Recall that $a_{j}=0$ for all $j$ with $s_{i}+k<j<a_{s_{i+1}}$. Therefore,

$$
S_{i-1}+S_{i}=\sum_{j=s_{i-1}}^{s_{i}+k} a_{j}=\sum_{j=s_{i-1}}^{s_{i}-k-1} a_{j}+\sum_{j=s_{i}-k}^{s_{i}+k} a_{j} \leqslant\left(s_{i}-s_{i-1}-k\right)+k=L_{i-1}
$$

Summing up these equalities over $i=1,2, \ldots, T$ we get

$$
2 t(n+1)=\sum_{i=1}^{T}\left(S_{i-1}+S_{i}\right) \leqslant \sum_{i=1}^{T} L_{i-1}=(2 n+1) t
$$

which is a contradiction.\\
Comment 3. Here we present a proof of Raney's lemma different from the one used above.\\
If we plot the partial sums $s_{n}=x_{1}+\cdots+x_{n}$ as a function of $n$, the graph of $s_{n}$ has an average slope of $1 / m$, because $s_{m+n}=s_{n}+1$.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_9f325c9d511f2c38a6b8g-33}

The entire graph can be contained between two lines of slope $1 / m$. In general these bounding lines touch the graph just once in each cycle of $m$ points, since lines of slope $1 / m$ hit points with integer coordinates only once per $m$ units. The unique (in one cycle) lower point of intersection is the only place in the cycle from which all partial sums will be positive.

Comment 4. The following example shows that for different values of $k$ the required girl may have different positions: 011001101.",752,4
2021g1,"Let $A B C D$ be a parallelogram such that $A C=B C$. A point $P$ is chosen on the extension of the segment $A B$ beyond $B$. The circumcircle of the triangle $A C D$ meets the segment $P D$ again at $Q$, and the circumcircle of the triangle $A P Q$ meets the segment $P C$ again at $R$. Prove that the lines $C D, A Q$, and $B R$ are concurrent.","Common remarks. The introductory steps presented here are used in all solutions below.\\
Since $A C=B C=A D$, we have $\angle A B C=\angle B A C=\angle A C D=\angle A D C$. Since the quadrilaterals $A P R Q$ and $A Q C D$ are cyclic, we obtain

$$
\angle C R A=180^{\circ}-\angle A R P=180^{\circ}-\angle A Q P=\angle D Q A=\angle D C A=\angle C B A,
$$

so the points $A, B, C$, and $R$ lie on some circle $\gamma$.\\
Introduce the point $X=A Q \cap C D$; we need to prove that $B, R$ and $X$ are collinear.

By means of the circle $(A P R Q)$ we have

$$
\angle R Q X=180^{\circ}-\angle A Q R=\angle R P A=\angle R C X
$$

(the last equality holds in view of $A B \| C D$ ), which means that the points $C, Q, R$, and $X$ also lie on some circle $\delta$.

Using the circles $\delta$ and $\gamma$ we finally obtain

$$
\angle X R C=\angle X Q C=180^{\circ}-\angle C Q A=\angle A D C=\angle B A C=180^{\circ}-\angle C R B,
$$

that proves the desired collinearity.\\

",192,2
2021g2,"Let $A B C D$ be a convex quadrilateral circumscribed around a circle with centre $I$. Let $\omega$ be the circumcircle of the triangle $A C I$. The extensions of $B A$ and $B C$ beyond $A$ and $C$ meet $\omega$ at $X$ and $Z$, respectively. The extensions of $A D$ and $C D$ beyond $D$ meet $\omega$ at $Y$ and $T$, respectively. Prove that the perimeters of the (possibly self-intersecting) quadrilaterals $A D T X$ and $C D Y Z$ are equal.","Solution. The point $I$ is the intersection of the external bisector of the angle $T C Z$ with the circumcircle $\omega$ of the triangle $T C Z$, so $I$ is the midpoint of the arc $T C Z$ and $I T=I Z$. Similarly, $I$ is the midpoint of the arc $Y A X$ and $I X=I Y$. Let $O$ be the centre of $\omega$. Then $X$ and $T$ are the reflections of $Y$ and $Z$ in $I O$, respectively. So $X T=Y Z$.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_9f325c9d511f2c38a6b8g-44}

Let the incircle of $A B C D$ touch $A B, B C, C D$, and $D A$ at points $P, Q, R$, and $S$, respectively.

The right triangles $I X P$ and $I Y S$ are congruent, since $I P=I S$ and $I X=I Y$. Similarly, the right triangles $I R T$ and $I Q Z$ are congruent. Therefore, $X P=Y S$ and $R T=Q Z$.

Denote the perimeters of $A D T X$ and $C D Y Z$ by $P_{A D T X}$ and $P_{C D Y Z}$ respectively. Since $A S=A P, C Q=R C$, and $S D=D R$, we obtain

$$
\begin{aligned}
P_{A D T X}=X T+X A+A S+ & S D+D T=X T+X P+R T \\
& =Y Z+Y S+Q Z=Y Z+Y D+D R+R C+C Z=P_{C D Y Z},
\end{aligned}
$$

as required.\\
Comment 1. After proving that $X$ and $T$ are the reflections of $Y$ and $Z$ in $I O$, respectively, one can finish the solution as follows. Since $X T=Y Z$, the problem statement is equivalent to


\begin{equation*}
X A+A D+D T=Y D+D C+C Z . \tag{1}
\end{equation*}


Since $A B C D$ is circumscribed, $A B-A D=B C-C D$. Adding this to (1), we come to an equivalent equality $X A+A B+D T=Y D+B C+C Z$, or


\begin{equation*}
X B+D T=Y D+B Z . \tag{2}
\end{equation*}


Let $\lambda=\frac{X Z}{A C}=\frac{T Y}{A C}$. Since $X A C Z$ is cyclic, the triangles $Z B X$ and $A B C$ are similar, hence

$$
\frac{X B}{B C}=\frac{B Z}{A B}=\frac{X Z}{A C}=\lambda .
$$

It follows that $X B=\lambda B C$ and $B Z=\lambda A B$. Likewise, the triangles $T D Y$ and $A D C$ are similar, hence

$$
\frac{D T}{A D}=\frac{D Y}{C D}=\frac{T Y}{A C}=\lambda
$$

Therefore, (2) rewrites as $\lambda B C+\lambda A D=\lambda C D+\lambda A B$.\\
This is equivalent to $B C+A D=C D+A B$ which is true as $A B C D$ is circumscribed.\\
Comment 2. Here is a more difficult modification of the original problem, found by the PSC.\\
Let $A B C D$ be a convex quadrilateral circumscribed around a circle with centre $I$. Let $\omega$ be the circumcircle of the triangle $A C I$. The extensions of $B A$ and $B C$ beyond $A$ and $C$ meet $\omega$ at $X$ and $Z$, respectively. The extensions of $A D$ and $C D$ beyond $D$ meet $\omega$ at $Y$ and $T$, respectively. Let $U=B C \cap A D$ and $V=B A \cap C D$. Let $I_{U}$ be the incentre of $U Y Z$ and let $J_{V}$ be the $V$-excentre of $V X T$. Then $I_{U} J_{V} \perp B D$.",527,4
2021g4,"Let $A B C D$ be a quadrilateral inscribed in a circle $\Omega$. Let the tangent to $\Omega$ at $D$ intersect the rays $B A$ and $B C$ at points $E$ and $F$, respectively. A point $T$ is chosen inside the triangle $A B C$ so that $T E \| C D$ and $T F \| A D$. Let $K \neq D$ be a point on the segment $D F$ such that $T D=T K$. Prove that the lines $A C, D T$ and $B K$ intersect at one point.","Let the segments $T E$ and $T F$ cross $A C$ at $P$ and $Q$, respectively. Since $P E \| C D$ and $E D$ is tangent to the circumcircle of $A B C D$, we have

$$
\angle E P A=\angle D C A=\angle E D A,
$$

and so the points $A, P, D$, and $E$ lie on some circle $\alpha$. Similarly, the points $C, Q, D$, and $F$ lie on some circle $\gamma$.

We now want to prove that the line $D T$ is tangent to both $\alpha$ and $\gamma$ at $D$. Indeed, since $\angle F C D+\angle E A D=180^{\circ}$, the circles $\alpha$ and $\gamma$ are tangent to each other at $D$. To prove that $T$ lies on their common tangent line at $D$ (i.e., on their radical axis), it suffices to check that $T P \cdot T E=T Q \cdot T F$, or that the quadrilateral $P E F Q$ is cyclic. This fact follows from

$$
\angle Q F E=\angle A D E=\angle A P E .
$$

Since $T D=T K$, we have $\angle T K D=\angle T D K$. Next, as $T D$ and $D E$ are tangent to $\alpha$ and $\Omega$, respectively, we obtain

$$
\angle T K D=\angle T D K=\angle E A D=\angle B D E,
$$

which implies $T K \| B D$.\\
Next we prove that the five points $T, P, Q, D$, and $K$ lie on some circle $\tau$. Indeed, since $T D$ is tangent to the circle $\alpha$ we have

$$
\angle E P D=\angle T D F=\angle T K D,
$$

which means that the point $P$ lies on the circle (TDK). Similarly, we have $Q \in(T D K)$.\\
Finally, we prove that $P K \| B C$. Indeed, using the circles $\tau$ and $\gamma$ we conclude that

$$
\angle P K D=\angle P Q D=\angle D F C,
$$

which means that $P K \| B C$.\\
Triangles $T P K$ and $D C B$ have pairwise parallel sides, which implies the fact that $T D, P C$ and $K B$ are concurrent, as desired.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_9f325c9d511f2c38a6b8g-49}

Comment 1. There are several variations of the above solution.\\
E.g., after finding circles $\alpha$ and $\gamma$, one can notice that there exists a homothety $h$ mapping the triangle $T P Q$ to the triangle $D C A$; the centre of that homothety is $Y=A C \cap T D$. Since

$$
\angle D P E=\angle D A E=\angle D C B=\angle D Q T
$$

the quadrilateral $T P D Q$ is inscribed in some circle $\tau$. We have $h(\tau)=\Omega$, so the point $D^{*}=h(D)$ lies on $\Omega$.

Finally, by

$$
\angle D C D^{*}=\angle T P D=\angle B A D
$$

the points $B$ and $D^{*}$ are symmetric with respect to the diameter of $\Omega$ passing through $D$. This yields $D B=D D^{*}$ and $B D^{*} \| E F$, so $h(K)=B$, and $B K$ passes through $Y$.
",492,3
2021g5,"Let $A B C D$ be a cyclic quadrilateral whose sides have pairwise different lengths. Let $O$ be the circumcentre of $A B C D$. The internal angle bisectors of $\angle A B C$ and $\angle A D C$ meet $A C$ at $B_{1}$ and $D_{1}$, respectively. Let $O_{B}$ be the centre of the circle which passes through $B$ and is tangent to $A C$ at $D_{1}$. Similarly, let $O_{D}$ be the centre of the circle which passes through $D$ and is tangent to $A C$ at $B_{1}$.

Assume that $B D_{1} \| D B_{1}$. Prove that $O$ lies on the line $O_{B} O_{D}$.","Common remarks. We introduce some objects and establish some preliminary facts common for all solutions below.

Let $\Omega$ denote the circle $(A B C D)$, and let $\gamma_{B}$ and $\gamma_{D}$ denote the two circles from the problem statement (their centres are $O_{B}$ and $O_{D}$, respectively). Clearly, all three centres $O, O_{B}$, and $O_{D}$ are distinct.

Assume, without loss of generality, that $A B>B C$. Suppose that $A D>D C$, and let $H=A C \cap B D$. Then the rays $B B_{1}$ and $D D_{1}$ lie on one side of $B D$, as they contain the midpoints of the arcs $A D C$ and $A B C$, respectively. However, if $B D_{1} \| D B_{1}$, then $B_{1}$ and $D_{1}$ should be separated by $H$. This contradiction shows that $A D<C D$.

Let $\gamma_{B}$ and $\gamma_{D}$ meet $\Omega$ again at $T_{B}$ and $T_{D}$, respectively. The common chord $B T_{B}$ of $\Omega$ and $\gamma_{B}$ is perpendicular to their line of\\
\includegraphics[max width=\textwidth]{2025_04_29_9f325c9d511f2c38a6b8g-52} centres $O_{B} O$; likewise, $D T_{D} \perp O_{D} O$. Therefore, $O \in O_{B} O_{D} \Longleftrightarrow O_{B} O\left\|O_{D} O \Longleftrightarrow B T_{B}\right\|$ $D T_{D}$, and the problem reduces to showing that


\begin{equation*}
B T_{B} \| D T_{D} \tag{1}
\end{equation*}


Comment 1. It seems that the discussion of the positions of points is necessary for both Solutions below. However, this part automatically follows from the angle chasing in Comment 2.

Let the diagonals $A C$ and $B D$ cross at $H$. Consider the homothety $h$ centred at $H$ and mapping $B$ to $D$. Since $B D_{1} \| D B_{1}$, we have $h\left(D_{1}\right)=B_{1}$.

Let the tangents to $\Omega$ at $B$ and $D$ meet $A C$ at $L_{B}$ and $L_{D}$, respectively. We have

$$
\angle L_{B} B B_{1}=\angle L_{B} B C+\angle C B B_{1}=\angle B A L_{B}+\angle B_{1} B A=\angle B B_{1} L_{B}
$$

which means that the triangle $L_{B} B B_{1}$ is isosceles, $L_{B} B=L_{B} B_{1}$. The powers of $L_{B}$ with respect to $\Omega$ and $\gamma_{D}$ are $L_{B} B^{2}$ and $L_{B} B_{1}^{2}$, respectively; so they are equal, whence $L_{B}$ lies on the radical axis $T_{D} D$ of those two circles. Similarly, $L_{D}$ lies on the radical axis $T_{B} B$ of $\Omega$ and $\gamma_{B}$.

By the sine rule in the triangle $B H L_{B}$, we obtain


\begin{equation*}
\frac{H L_{B}}{\sin \angle H B L_{B}}=\frac{B L_{B}}{\sin \angle B H L_{B}}=\frac{B_{1} L_{B}}{\sin \angle B H L_{B}} \tag{2}
\end{equation*}


similarly,


\begin{equation*}
\frac{H L_{D}}{\sin \angle H D L_{D}}=\frac{D L_{D}}{\sin \angle D H L_{D}}=\frac{D_{1} L_{D}}{\sin \angle D H L_{D}} . \tag{3}
\end{equation*}


Clearly, $\angle B H L_{B}=\angle D H L_{D}$. In the circle $\Omega$, tangent lines $B L_{B}$ and $D L_{D}$ form equal angles with the chord $B D$, so $\sin \angle H B L_{B}=\sin \angle H D L_{D}$ (this equality does not depend on the picture). Thus, dividing (2) by (3) we get

$$
\frac{H L_{B}}{H L_{D}}=\frac{B_{1} L_{B}}{D_{1} L_{D}}, \quad \text { and hence } \quad \frac{H L_{B}}{H L_{D}}=\frac{H L_{B}-B_{1} L_{B}}{H L_{D}-D_{1} L_{D}}=\frac{H B_{1}}{H D_{1}}
$$

Since $h\left(D_{1}\right)=B_{1}$, the obtained relation yields $h\left(L_{D}\right)=L_{B}$, so $h$ maps the line $L_{D} B$ to $L_{B} D$, and these lines are parallel, as desired.\\

",510,4
2021g7,"A point $D$ is chosen inside an acute-angled triangle $A B C$ with $A B>A C$ so that $\angle B A D=\angle D A C$. A point $E$ is constructed on the segment $A C$ so that $\angle A D E=\angle D C B$. Similarly, a point $F$ is constructed on the segment $A B$ so that $\angle A D F=\angle D B C$. A point $X$ is chosen on the line $A C$ so that $C X=B X$. Let $O_{1}$ and $O_{2}$ be the circumcentres of the triangles $A D C$ and $D X E$. Prove that the lines $B C, E F$, and $O_{1} O_{2}$ are concurrent.","Common remarks. Let $Q$ be the isogonal conjugate of $D$ with respect to the triangle $A B C$. Since $\angle B A D=\angle D A C$, the point $Q$ lies on $A D$. Then $\angle Q B A=\angle D B C=\angle F D A$, so the points $Q, D, F$, and $B$ are concyclic. Analogously, the points $Q, D, E$, and $C$ are concyclic. Thus $A F \cdot A B=A D \cdot A Q=A E \cdot A C$ and so the points $B, F, E$, and $C$ are also concyclic.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_9f325c9d511f2c38a6b8g-60}

Let $T$ be the intersection of $B C$ and $F E$.\\
Claim. $T D^{2}=T B \cdot T C=T F \cdot T E$.\\
Proof. We will prove that the circles $(D E F)$ and $(B D C)$ are tangent to each other. Indeed, using the above arguments, we get

$$
\begin{gathered}
\angle B D F=\angle A F D-\angle A B D=\left(180^{\circ}-\angle F A D-\angle F D A\right)-(\angle A B C-\angle D B C) \\
=180^{\circ}-\angle F A D-\angle A B C=180^{\circ}-\angle D A E-\angle F E A=\angle F E D+\angle A D E=\angle F E D+\angle D C B,
\end{gathered}
$$

which implies the desired tangency.\\
Since the points $B, C, E$, and $F$ are concyclic, the powers of the point $T$ with respect to the circles $(B D C)$ and $(E D F)$ are equal. So their radical axis, which coincides with the common tangent at $D$, passes through $T$, and hence $T D^{2}=T E \cdot T F=T B \cdot T C$.

Let $T A$ intersect the circle $(A B C)$ again at $M$. Due to the circles ( $B C E F$ ) and $(A M C B)$, and using the above Claim, we get $T M \cdot T A=T F \cdot T E=T B \cdot T C=T D^{2}$; in particular, the points $A, M, E$, and $F$ are concyclic.

Under the inversion with centre $T$ and radius $T D$, the point $M$ maps to $A$, and $B$ maps to $C$, which implies that the circle ( $M B D$ ) maps to the circle ( $A D C$ ). Their common point $D$ lies on the circle of the inversion, so the second intersection point $K$ also lies on that circle, which means $T K=T D$. It follows that the point $T$ and the centres of the circles ( $K D E$ ) and $(A D C)$ lie on the perpendicular bisector of $K D$.

Since the center of $(A D C)$ is $O_{1}$, it suffices to show now that the points $D, K, E$, and $X$ are concyclic (the center of the corresponding circle will be $O_{2}$ ).

The lines $B M, D K$, and $A C$ are the pairwise radical axes of the circles ( $A B C M$ ), $(A C D K)$ and ( $B M D K$ ), so they are concurrent at some point $P$. Also, $M$ lies on the circle ( $A E F$ ), thus

$$
\begin{aligned}
\Varangle(E X, X B) & =\Varangle(C X, X B)=\Varangle(X C, B C)+\Varangle(B C, B X)=2 \Varangle(A C, C B) \\
& =\Varangle(A C, C B)+\Varangle(E F, F A)=\Varangle(A M, B M)+\Varangle(E M, M A)=\Varangle(E M, B M),
\end{aligned}
$$

so the points $M, E, X$, and $B$ are concyclic. Therefore, $P E \cdot P X=P M \cdot P B=P K \cdot P D$, so the points $E, K, D$, and $X$ are concyclic, as desired.\\

",575,4
2021g8,"Let $\omega$ be the circumcircle of a triangle $A B C$, and let $\Omega_{A}$ be its excircle which is tangent to the segment $B C$. Let $X$ and $Y$ be the intersection points of $\omega$ and $\Omega_{A}$. Let $P$ and $Q$ be the projections of $A$ onto the tangent lines to $\Omega_{A}$ at $X$ and $Y$, respectively. The tangent line at $P$ to the circumcircle of the triangle $A P X$ intersects the tangent line at $Q$ to the circumcircle of the triangle $A Q Y$ at a point $R$. Prove that $A R \perp B C$.","Let $D$ be the point of tangency of $B C$ and $\Omega_{A}$. Let $D^{\prime}$ be the point such that $D D^{\prime}$ is a diameter of $\Omega_{A}$. Let $R^{\prime}$ be (the unique) point such that $A R^{\prime} \perp B C$ and $R^{\prime} D^{\prime} \| B C$. We shall prove that $R^{\prime}$ coincides with $R$.

Let $P X$ intersect $A B$ and $D^{\prime} R^{\prime}$ at $S$ and $T$, respectively. Let $U$ be the ideal common point of the parallel lines $B C$ and $D^{\prime} R^{\prime}$. Note that the (degenerate) hexagon $A S X T U C$ is circumscribed around $\Omega_{A}$, hence by the Brianchon theorem $A T, S U$, and $X C$ concur at a point which we denote by $V$. Then $V S \| B C$. It follows that $\Varangle(S V, V X)=\Varangle(B C, C X)=$ $\Varangle(B A, A X)$, hence $A X S V$ is cyclic. Therefore, $\Varangle(P X, X A)=\Varangle(S V, V A)=\Varangle\left(R^{\prime} T, T A\right)$. Since $\angle A P T=\angle A R^{\prime} T=90^{\circ}$, the quadrilateral $A P R^{\prime} T$ is cyclic. Hence,

$$
\Varangle(X A, A P)=90^{\circ}-\Varangle(P X, X A)=90^{\circ}-\Varangle\left(R^{\prime} T, T A\right)=\Varangle\left(T A, A R^{\prime}\right)=\Varangle\left(T P, P R^{\prime}\right)
$$

It follows that $P R^{\prime}$ is tangent to the circle $(A P X)$.\\
Analogous argument shows that $Q R^{\prime}$ is tangent to the circle $(A Q Y)$. Therefore, $R=R^{\prime}$ and $A R \perp B C$.\\
",227,2
2021n2,"Let $n \geqslant 100$ be an integer. The numbers $n, n+1, \ldots, 2 n$ are written on $n+1$ cards, one number per card. The cards are shuffled and divided into two piles. Prove that one of the piles contains two cards such that the sum of their numbers is a perfect square.","Solution. To solve the problem it suffices to find three squares and three cards with numbers $a, b, c$ on them such that pairwise sums $a+b, b+c, a+c$ are equal to the chosen squares. By choosing the three consecutive squares $(2 k-1)^{2},(2 k)^{2},(2 k+1)^{2}$ we arrive at the triple

$$
(a, b, c)=\left(2 k^{2}-4 k, \quad 2 k^{2}+1, \quad 2 k^{2}+4 k\right)
$$

We need a value for $k$ such that

$$
n \leqslant 2 k^{2}-4 k, \quad \text { and } \quad 2 k^{2}+4 k \leqslant 2 n
$$

A concrete $k$ is suitable for all $n$ with

$$
n \in\left[k^{2}+2 k, 2 k^{2}-4 k+1\right]=: I_{k} .
$$

For $k \geqslant 9$ the intervals $I_{k}$ and $I_{k+1}$ overlap because

$$
(k+1)^{2}+2(k+1) \leqslant 2 k^{2}-4 k+1
$$

Hence $I_{9} \cup I_{10} \cup \ldots=[99, \infty)$, which proves the statement for $n \geqslant 99$.\\
Comment 1. There exist approaches which only work for sufficiently large $n$.\\
One possible approach is to consider three cards with numbers $70 k^{2}, 99 k^{2}, 126 k^{2}$ on them. Then their pairwise sums are perfect squares and so it suffices to find $k$ such that $70 k^{2} \geqslant n$ and $126 k^{2} \leqslant 2 n$ which exists for sufficiently large $n$.

Another approach is to prove, arguing by contradiction, that $a$ and $a-2$ are in the same pile provided that $n$ is large enough and $a$ is sufficiently close to $n$. For that purpose, note that every pair of neighbouring numbers in the sequence $a, x^{2}-a, a+(2 x+1), x^{2}+2 x+3-a, a-2$ adds up to a perfect square for any $x$; so by choosing $x=\lfloor\sqrt{2 a}\rfloor+1$ and assuming that $n$ is large enough we conclude that $a$ and $a-2$ are in the same pile for any $a \in[n+2,3 n / 2]$. This gives a contradiction since it is easy to find two numbers from $[n+2,3 n / 2]$ of the same parity which sum to a square.

It then remains to separately cover the cases of small $n$ which appears to be quite technical.\\
Comment 2. An alternative formulation for this problem could ask for a proof of the statement for all $n>10^{6}$. An advantage of this formulation is that some solutions, e.g. those mentioned in Comment 1 need not contain a technical part which deals with the cases of small $n$. However, the original formulation seems to be better because the bound it gives for $n$ is almost sharp, see the next comment for details.

Comment 3. The statement of the problem is false for $n=98$. As a counterexample, the first pile may contain the even numbers from 98 to 126 , the odd numbers from 129 to 161 , and the even numbers from 162 to 196 .",452,3
2021n5,"Prove that there are only finitely many quadruples $(a, b, c, n)$ of positive integers such that

$$
n!=a^{n-1}+b^{n-1}+c^{n-1}
$$","Solution. For fixed $n$ there are clearly finitely many solutions; we will show that there is no solution with $n>100$. So, assume $n>100$. By the AM-GM inequality,

$$
\begin{aligned}
n! & =2 n(n-1)(n-2)(n-3) \cdot(3 \cdot 4 \cdots(n-4)) \\
& \leqslant 2(n-1)^{4}\left(\frac{3+\cdots+(n-4)}{n-6}\right)^{n-6}=2(n-1)^{4}\left(\frac{n-1}{2}\right)^{n-6}<\left(\frac{n-1}{2}\right)^{n-1}
\end{aligned}
$$

thus $a, b, c<(n-1) / 2$.\\
For every prime $p$ and integer $m \neq 0$, let $\nu_{p}(m)$ denote the $p$-adic valuation of $m$; that is, the greatest non-negative integer $k$ for which $p^{k}$ divides $m$. Legendre's formula states that

$$
\nu_{p}(n!)=\sum_{s=1}^{\infty}\left\lfloor\frac{n}{p^{s}}\right\rfloor
$$

and a well-know corollary of this formula is that


\begin{equation*}
\nu_{p}(n!)<\sum_{s=1}^{\infty} \frac{n}{p^{s}}=\frac{n}{p-1} \tag{$\diamond$}
\end{equation*}


If $n$ is odd then $a^{n-1}, b^{n-1}, c^{n-1}$ are squares, and by considering them modulo 4 we conclude that $a, b$ and $c$ must be even. Hence, $2^{n-1} \mid n$ ! but that is impossible for odd $n$ because $\nu_{2}(n!)=\nu_{2}((n-1)!)<n-1$ by $(\Omega)$.

From now on we assume that $n$ is even. If all three numbers $a+b, b+c, c+a$ are powers of 2 then $a, b, c$ have the same parity. If they all are odd, then $n!=a^{n-1}+b^{n-1}+c^{n-1}$ is also odd which is absurd. If all $a, b, c$ are divisible by 4 , this contradicts $\nu_{2}(n!) \leqslant n-1$. If, say, $a$ is not divisible by 4 , then $2 a=(a+b)+(a+c)-(b+c)$ is not divisible by 8 , and since all $a+b, b+c$, $c+a$ are powers of 2 , we get that one of these sums equals 4 , so two of the numbers of $a, b, c$ are equal to 2. Say, $a=b=2$, then $c=2^{r}-2$ and, since $c \mid n$ !, we must have $c \mid a^{n-1}+b^{n-1}=2^{n}$ implying $r=2$, and so $c=2$, which is impossible because $n!\equiv 0 \not \equiv 3 \cdot 2^{n-1}(\bmod 5)$.

So now we assume that the sum of two numbers among $a, b, c$, say $a+b$, is not a power of 2 , so it is divisible by some odd prime $p$. Then $p \leqslant a+b<n$ and so $c^{n-1}=n!-\left(a^{n-1}+b^{n-1}\right)$ is divisible by $p$. If $p$ divides $a$ and $b$, we get $p^{n-1} \mid n!$, contradicting ( () . Next, using ( $\varnothing$ ) and the Lifting the Exponent Lemma we get


\begin{equation*}
\nu_{p}(1)+\nu_{p}(2)+\cdots+\nu_{p}(n)=\nu_{p}(n!)=\nu_{p}\left(n!-c^{n-1}\right)=\nu_{p}\left(a^{n-1}+b^{n-1}\right)=\nu_{p}(a+b)+\nu_{p}(n-1) \tag{$\diamond$}
\end{equation*}


In view of $(\diamond)$, no number of $1,2, \ldots, n$ can be divisible by $p$, except $a+b$ and $n-1>a+b$. On the other hand, $p \mid c$ implies that $p<n / 2$ and so there must be at least two such numbers. Hence, there are two multiples of $p$ among $1,2, \ldots, n$, namely $a+b=p$ and $n-1=2 p$. But this is another contradiction because $n-1$ is odd. This final contradiction shows that there is no solution of the equation for $n>100$.

Comment 1. The original version of the problem asked to find all solutions to the equation. The solution to that version is not much different but is more technical.

Comment 2. To find all solutions we can replace the bound $a, b, c<(n-1) / 2$ for all $n$ with a weaker bound $a, b, c \leqslant n / 2$ only for even $n$, which is a trivial application of AM-GM to the tuple $(2,3, \ldots, n)$. Then we may use the same argument for odd $n$ (it works for $n \geqslant 5$ and does not require any bound on $a, b, c$ ), and for even $n$ the same solution works for $n \geqslant 6$ unless we have $a+b=n-1$ and $2 \nu_{p}(n-1)=\nu_{p}(n!)$. This is only possible for $p=3$ and $n=10$ in which case we can consider the original equation modulo 7 to deduce that $7 \mid a b c$ which contradicts the fact that $7^{9}>10$ !. Looking at $n \leqslant 4$ we find four solutions, namely,

$$
(a, b, c, n)=(1,1,2,3),(1,2,1,3),(2,1,1,3),(2,2,2,4)
$$

Comment 3. For sufficiently large $n$, the inequality $a, b, c<(n-1) / 2$ also follows from Stirling's formula.",627,4
2021n7,"Let $a_{1}, a_{2}, a_{3}, \ldots$ be an infinite sequence of positive integers such that $a_{n+2 m}$ divides $a_{n}+a_{n+m}$ for all positive integers $n$ and $m$. Prove that this sequence is eventually periodic, i.e. there exist positive integers $N$ and $d$ such that $a_{n}=a_{n+d}$ for all $n>N$.","Solution. We will make repeated use of the following simple observation:\\
Lemma 1. If a positive integer $d$ divides $a_{n}$ and $a_{n-m}$ for some $m$ and $n>2 m$, it also divides $a_{n-2 m}$. If $d$ divides $a_{n}$ and $a_{n-2 m}$, it also divides $a_{n-m}$.\\
Proof. Both parts are obvious since $a_{n}$ divides $a_{n-2 m}+a_{n-m}$.\\
Claim. The sequence $\left(a_{n}\right)$ is bounded.\\
Proof. Suppose the contrary. Then there exist infinitely many indices $n$ such that $a_{n}$ is greater than each of the previous terms $a_{1}, a_{2}, \ldots, a_{n-1}$. Let $a_{n}=k$ be such a term, $n>10$. For each $s<\frac{n}{2}$ the number $a_{n}=k$ divides $a_{n-s}+a_{n-2 s}<2 k$, therefore

$$
a_{n-s}+a_{n-2 s}=k
$$

In particular,

$$
a_{n}=a_{n-1}+a_{n-2}=a_{n-2}+a_{n-4}=a_{n-4}+a_{n-8}
$$

that is, $a_{n-1}=a_{n-4}$ and $a_{n-2}=a_{n-8}$. It follows from Lemma 1 that $a_{n-1}$ divides $a_{n-1-3 s}$ for $3 s<n-1$ and $a_{n-2}$ divides $a_{n-2-6 s}$ for $6 s<n-2$. Since at least one of the numbers $a_{n-1}$ and $a_{n-2}$ is at least $a_{n} / 2$, so is some $a_{i}$ with $i \leqslant 6$. However, $a_{n}$ can be arbitrarily large, a contradiction.

Since $\left(a_{n}\right)$ is bounded, there exist only finitely many $i$ for which $a_{i}$ appears in the sequence finitely many times. In other words, there exists $N$ such that if $a_{i}=t$ and $i>N$, then $a_{j}=t$ for infinitely many $j$.

Clearly the sequence $\left(a_{n+N}\right)_{n>0}$ satisfies the divisibility condition, and it is enough to prove that this sequence is eventually periodic. Thus truncating the sequence if necessary, we can assume that each number appears infinitely many times in the sequence. Let $k$ be the maximum number appearing in the sequence.\\
Lemma 2. If a positive integer $d$ divides $a_{n}$ for some $n$, then the numbers $i$ such that $d$ divides $a_{i}$ form an arithmetical progression with an odd difference.\\
Proof. Let $i_{1}<i_{2}<i_{3}<\ldots$ be all the indices $i$ such that $d$ divides $a_{i}$. If $i_{s}+i_{s+1}$ is even, it follows from Lemma 1 that $d$ also divides $\frac{a_{i_{s}+i_{s+1}}^{2}}{2}$, impossible since $i_{s}<\frac{i_{s}+i_{s+1}}{2}<i_{s+1}$. Thus $i_{s}$ and $i_{s+1}$ are always of different parity, and therefore $i_{s}+i_{s+2}$ is even. Applying Lemma 1 again, we see that $d$ divides $a_{\frac{i_{s}+i_{s+2}}{2}}$, hence $\frac{i_{s}+i_{s+2}}{2}=i_{s+1}$,

We are ready now to solve the problem.\\
The number of positive divisors of all terms of the progression is finite. Let $d_{s}$ be the difference of the progression corresponding to $s$, that is, $s$ divides $a_{n}$ if and only if it divides $a_{n+t d_{s}}$ for any positive integer $t$. Let $D$ be the product of all $d_{s}$. Then each $s$ dividing a term of the progression divides $a_{n}$ if and only if it divides $a_{n+D}$. This means that the sets of divisors of $a_{n}$ and $a_{n+D}$ coincide, and $a_{n+D}=a_{n}$. Thus $D$ is a period of the sequence.

Comment. In the above solution we did not try to find the exact structure of the periodic part of $\left(a_{n}\right)$. A little addition to the argument above shows that the period of the sequence has one of the following three forms:\\
(i) $t$ (in this case the sequence is eventually constant);\\
(ii) $t, 2 t, 3 t$ or $2 t, t, 3 t$ (so the period is 3 );\\
(iii) $t, t, \ldots, 2 t$ (the period can be any odd number).

In these three cases $t$ can be any positive integer. It is easy to see that all three cases satisfy the original condition.

We again denote by $k$ be the maximum number appearing in the sequence. All the indices $i$ such that $a_{i}=k$ form an arithmetical progression. If the difference of this progression is 1 , the sequence $\left(a_{n}\right)$ is constant, and we get the case (i). Assume that the difference $T$ is at least 3 .

Take an index $n$ such that $a_{n}=k$ and let $a=a_{n-2}, b=a_{n-1}$. We have $a, b<k$ and therefore $k=a_{n}=a_{n-1}+a_{n-2}=a+b$. If $a=b=\frac{k}{2}$, then all the terms $a_{1}, a_{2}, \ldots, a_{n}$ are divisible by $k / 2$, that is, are equal to $k$ or $k / 2$. Since the indices $i$ such that $a_{i}=k$ form an arithmetical progression with odd diference, we get the case (iii).

Suppose now that $a \neq b$.\\
Claim. For $\frac{n}{2}<m<n$ we have $a_{m}=a$ if $m \equiv n-2(\bmod 3)$ and $a_{m}=b$ if $m \equiv n-1(\bmod 3)$.\\
Proof. The number $k=a_{n}$ divides $a_{n-2}+a_{n-1}=a+b$ and $a_{n-4}+a_{n-2}=a_{n-4}+a$ and is therefore equal to these sums (since $a, b<k$ and $a_{i} \leqslant k$ for all $i$. Therefore $a_{n-1}=a_{n-4}=b$, that is, $a_{n-4}<k$, $a_{n-4}+a_{n-8}=k$ and $a_{n-8}=a_{n-2}=a$. One of the numbers $a$ and $b$ is greater than $k / 2$.

If $b=a_{n-1}=a_{n-4}>\frac{k}{2}$, it follows from Lemma 1 that $a_{n-1}$ divides $a_{n-1-3 s}$ when $3 s<n-1$, and therefore $a_{n-1-3 s}=b$ when $3 s<n-1$. When $6 s<n-4, k$ also divides $a_{n-4-6 s}+a_{n-2-3 s}=b+a_{n-2-3 s}$, thus, $a_{n-2-3 s}=k-b=a$.

If $a=a_{n-2}=a_{n-8}>\frac{k}{2}$, all the terms $a_{n-2-6 s}$ with $6 s<n-2$ are divisible by $a$, that is, the indices $i$ for which $a$ divides $a_{i}$ form a progression with difference dividing 6 . Since this difference is odd and greater than 1 , it must be 3 , that is, $a_{n-2-3 s}=a$ when $3 s<n-2$. Similarly to the previous case, we have $a_{n-1-3 s}=a_{n}-a_{n-2-6 s}=k-a=b$ when $6 s<n-2$.

Let $a_{n}$ and $a_{n+T}$ be two consecutive terms of the sequence equal to $k$. If $n$ is large enough, $\frac{n+T}{2}<n-2$, and applying the claim to $n+T$ instead of $n$ we see that the three consecutive terms $a_{n-2}=a, a_{n-1}=b, a_{n}=k$ must be equal to $a_{n+T-2}, a_{n+T-1}$ and $a_{n+T}$ respectively. Thus, for some $i$ we have $a_{i+3 s}=a$ and $a_{i+1+3 s}=b$ for all $s$. Truncating the sequence again if necessary, we may assume that $a_{3 s+1}=a$ and $a_{3 s+2}=b$ for all $s$. We know also that $a_{n}=k$ if and only if $n$ is divisible by $T$ (incidentally, this proves that $T$ is divisible by 3 ).

If $a_{3 s}=c$ for some integer $s$, each of the numbers $a, b, c$ divides the sum of the other two. It is easy to see that these numbers are proportional to one of the triplets $(1,1,1),(1,1,2)$ and $(1,2,3)$ in some order. It follows that the greater of the two numbers $a$ and $b$ is the smaller multiplied by 2,3 or $3 / 2$. The last two cases are impossible because then $c$ cannot be the maximum element in the triplet $(a, b, c)$, while $c=k=a+b$ for infinitely many $s$. Thus the only possible case is 2 , the numbers $a$ and $b$ are $k / 3$ and $2 k / 3$ in some order, and the only possible values of $c$ are $k$ and $k / 3$. Suppose that $a_{3 s}=k / 3$ for some $s>1$. We can choose $s$ so that $a_{3 s+3}=k$. Therefore $T$, which we already know to be odd and divisible by 3 , is greater than 3 , that is, at least 9 . Then $a_{3 s-3} \neq k$, and the only other possibility is $a_{3 s-3}=k / 3$. However, $a_{3 s+3}=k$ must divide $a_{3 s}+a_{3 s-3}=2 k / 3$, which is impossible. We have proved then that $a_{3 s}=k$ for all $s>1$, which is the case (ii).",1153,4
2020a4,"Let $a, b, c, d$ be four real numbers such that $a \geqslant b \geqslant c \geqslant d>0$ and $a+b+c+d=1$. Prove that

$$
(a+2 b+3 c+4 d) a^{a} b^{b} c^{c} d^{d}<1
$$","The weighted AM-GM inequality with weights $a, b, c, d$ gives

$$
a^{a} b^{b} c^{c} d^{d} \leqslant a \cdot a+b \cdot b+c \cdot c+d \cdot d=a^{2}+b^{2}+c^{2}+d^{2}
$$

so it suffices to prove that $(a+2 b+3 c+4 d)\left(a^{2}+b^{2}+c^{2}+d^{2}\right)<1=(a+b+c+d)^{3}$. This can be done in various ways, for example:

$$
\begin{aligned}
(a+b+c+d)^{3}> & a^{2}(a+3 b+3 c+3 d)+b^{2}(3 a+b+3 c+3 d) \\
& \quad+c^{2}(3 a+3 b+c+3 d)+d^{2}(3 a+3 b+3 c+d) \\
\geqslant & \left(a^{2}+b^{2}+c^{2}+d^{2}\right) \cdot(a+2 b+3 c+4 d)
\end{aligned}
$$

",76,1
2020a6," Let $n$ and $k$ be positive integers. Prove that for $a_{1}, \ldots, a_{n} \in\left[1,2^{k}\right]$ one has


\begin{equation*}
\sum_{i=1}^{n} \frac{a_{i}}{\sqrt{a_{1}^{2}+\ldots+a_{i}^{2}}} \leqslant 4 \sqrt{k n} \tag{Iran}
\end{equation*}","Partition the set of indices $\{1,2, \ldots, n\}$ into disjoint subsets $M_{1}, M_{2}, \ldots, M_{k}$ so that $a_{\ell} \in\left[2^{j-1}, 2^{j}\right]$ for $\ell \in M_{j}$. Then, if $\left|M_{j}\right|=: p_{j}$, we have

$$
\sum_{\ell \in M_{j}} \frac{a_{\ell}}{\sqrt{a_{1}^{2}+\ldots+a_{\ell}^{2}}} \leqslant \sum_{i=1}^{p_{j}} \frac{2^{j}}{2^{j-1} \sqrt{i}}=2 \sum_{i=1}^{p_{j}} \frac{1}{\sqrt{i}}
$$

where we used that $a_{\ell} \leqslant 2^{j}$ and in the denominator every index from $M_{j}$ contributes at least $\left(2^{j-1}\right)^{2}$. Now, using $\sqrt{i}-\sqrt{i-1}=\frac{1}{\sqrt{i}+\sqrt{i-1}} \geqslant \frac{1}{2 \sqrt{i}}$, we deduce that

$$
\sum_{\ell \in M_{j}} \frac{a_{\ell}}{\sqrt{a_{1}^{2}+\ldots+a_{\ell}^{2}}} \leqslant 2 \sum_{i=1}^{p_{j}} \frac{1}{\sqrt{i}} \leqslant 2 \sum_{i=1}^{p_{j}} 2(\sqrt{i}-\sqrt{i-1})=4 \sqrt{p_{j}}
$$

Therefore, summing over $j=1, \ldots, k$ and using the QM-AM inequality, we obtain

$$
\sum_{\ell=1}^{n} \frac{a_{\ell}}{\sqrt{a_{1}^{2}+\ldots+a_{\ell}^{2}}} \leqslant 4 \sum_{j=1}^{k} \sqrt{\left|M_{j}\right|} \leqslant 4 \sqrt{k \sum_{j=1}^{k}\left|M_{j}\right|}=4 \sqrt{k n}
$$
",112,2
2020c2,"In a regular 100-gon, 41 vertices are colored black and the remaining 59 vertices are colored white. Prove that there exist 24 convex quadrilaterals $Q_{1}, \ldots, Q_{24}$ whose corners are vertices of the 100 -gon, so that

\begin{itemize}
  \item the quadrilaterals $Q_{1}, \ldots, Q_{24}$ are pairwise disjoint, and
  \item every quadrilateral $Q_{i}$ has three corners of one color and one corner of the other color.","Solution. Call a quadrilateral skew-colored, if it has three corners of one color and one corner of the other color. We will prove the following\\
Claim. If the vertices of a convex $(4 k+1)$-gon $P$ are colored black and white such that each color is used at least $k$ times, then there exist $k$ pairwise disjoint skew-colored quadrilaterals whose vertices are vertices of $P$. (One vertex of $P$ remains unused.)
\end{itemize}

The problem statement follows by removing 3 arbitrary vertices of the 100 -gon and applying the Claim to the remaining 97 vertices with $k=24$.\\
Proof of the Claim. We prove by induction. For $k=1$ we have a pentagon with at least one black and at least one white vertex. If the number of black vertices is even then remove a black vertex; otherwise remove a white vertex. In the remaining quadrilateral, there are an odd number of black and an odd number of white vertices, so the quadrilateral is skew-colored.

For the induction step, assume $k \geqslant 2$. Let $b$ and $w$ be the numbers of black and white vertices, respectively; then $b, w \geqslant k$ and $b+w=4 k+1$. Without loss of generality we may assume $w \geqslant b$, so $k \leqslant b \leqslant 2 k$ and $2 k+1 \leqslant w \leqslant 3 k+1$.

We want to find four consecutive vertices such that three of them are white, the fourth one is black. Denote the vertices by $V_{1}, V_{2}, \ldots, V_{4 k+1}$ in counterclockwise order, such that $V_{4 k+1}$ is black, and consider the following $k$ groups of vertices:

$$
\left(V_{1}, V_{2}, V_{3}, V_{4}\right),\left(V_{5}, V_{6}, V_{7}, V_{8}\right), \ldots,\left(V_{4 k-3}, V_{4 k-2}, V_{4 k-1}, V_{4 k}\right)
$$

In these groups there are $w$ white and $b-1$ black vertices. Since $w>b-1$, there is a group, $\left(V_{i}, V_{i+1}, V_{i+2}, V_{i+3}\right)$ that contains more white than black vertices. If three are white and one is black in that group, we are done. Otherwise, if $V_{i}, V_{i+1}, V_{i+2}, V_{i+3}$ are all white then let $V_{j}$ be the first black vertex among $V_{i+4}, \ldots, V_{4 k+1}$ (recall that $V_{4 k+1}$ is black); then $V_{j-3}, V_{j-2}$ and $V_{j-1}$ are white and $V_{j}$ is black.

Now we have four consecutive vertices $V_{i}, V_{i+1}, V_{i+2}, V_{i+3}$ that form a skew-colored quadrilateral. The remaining vertices form a convex $(4 k-3)$-gon; $w-3$ of them are white and $b-1$ are black. Since $b-1 \geqslant k-1$ and $w-3 \geqslant(2 k+1)-3>k-1$, we can apply the Claim with $k-1$.

Comment. It is not true that the vertices of the 100 -gon can be split into 25 skew-colored quadrilaterals. A possible counter-example is when the vertices $V_{1}, V_{3}, V_{5}, \ldots, V_{81}$ are black and the other vertices, $V_{2}, V_{4}, \ldots, V_{80}$ and $V_{82}, V_{83}, \ldots, V_{100}$ are white. For having 25 skew-colored quadrilaterals, there should be 8 containing three black vertices. But such a quadrilateral splits the other 96 vertices into four sets in such a way that at least two sets contain odd numbers of vertices and therefore they cannot be grouped into disjoint quadrilaterals.\\",501,4
2020c5,"Let $p$ be an odd prime, and put $N=\frac{1}{4}\left(p^{3}-p\right)-1$. The numbers $1,2, \ldots, N$ are painted arbitrarily in two colors, red and blue. For any positive integer $n \leqslant N$, denote by $r(n)$ the fraction of integers in $\{1,2, \ldots, n\}$ that are red.

Prove that there exists a positive integer $a \in\{1,2, \ldots, p-1\}$ such that $r(n) \neq a / p$ for all $n=1,2, \ldots, N$.\\","Solution. Denote by $R(n)$ the number of red numbers in $\{1,2, \ldots, n\}$, i.e., $R(n)=n r(n)$. Similarly, denote by $B(n)$ and $b(n)=B(n) / n$ the number and proportion of blue numbers in $\{1,2, \ldots, n\}$, respectively. Notice that $B(n)+R(n)=n$ and $b(n)+r(n)=1$. Therefore, the statement of the problem does not change after swapping the colors.

Arguing indirectly, for every $a \in\{1,2, \ldots, p-1\}$ choose some positive integer $n_{a}$ such that $r\left(n_{a}\right)=a / p$ and, hence, $R\left(n_{a}\right)=a n_{a} / p$. Clearly, $p \mid n_{a}$, so that $n_{a}=p m_{a}$ for some positive integer $m_{a}$, and $R\left(n_{a}\right)=a m_{a}$. Without loss of generality, we assume that $m_{1}<m_{p-1}$, as otherwise one may swap the colors. Notice that


\begin{equation*}
m_{a} \leqslant \frac{N}{p}<\frac{p^{2}-1}{4} \quad \text { for all } a=1,2, \ldots, p-1 \tag{1}
\end{equation*}


The solution is based on a repeated application of the following simple observation. Claim. Assume that $m_{a}<m_{b}$ for some $a, b \in\{1,2, \ldots, p-1\}$. Then

$$
m_{b} \geqslant \frac{a}{b} m_{a} \quad \text { and } \quad m_{b} \geqslant \frac{p-a}{p-b} m_{a}
$$

Proof. The first inequality follows from $b m_{b}=R\left(n_{b}\right) \geqslant R\left(n_{a}\right)=a m_{a}$. The second inequality is obtained by swapping colors .

Let $q=(p-1) / 2$. We distinguish two cases.\\
Case 1: All $q$ numbers $m_{1}, m_{2}, \ldots, m_{q}$ are smaller than $m_{p-1}$.\\
Let $m_{a}$ be the maximal number among $m_{1}, m_{2}, \ldots, m_{q}$; then $m_{a} \geqslant q \geqslant a$. Applying the Claim, we get

$$
m_{p-1} \geqslant \frac{p-a}{p-(p-1)} m_{a} \geqslant(p-q) q=\frac{p^{2}-1}{4}
$$

which contradicts (1).\\
Case 2: There exists $k \leqslant q$ such that $m_{k}>m_{p-1}$.\\
Choose $k$ to be the smallest index satisfying $m_{k}>m_{p-1}$; by our assumptions, we have $1<k \leqslant$ $q<p-1$.

Let $m_{a}$ be the maximal number among $m_{1}, m_{2}, \ldots, m_{k-1}$; then $a \leqslant k-1 \leqslant m_{a}<m_{p-1}$. Applying the Claim, we get

$$
\begin{aligned}
m_{k} \geqslant \frac{p-1}{k} m_{p-1} \geqslant \frac{p-1}{k} & \cdot \frac{p-a}{p-(p-1)} m_{a} \\
& \geqslant \frac{p-1}{k} \cdot(p-k+1)(k-1) \geqslant \frac{k-1}{k} \cdot(p-1)(p-q) \geqslant \frac{1}{2} \cdot \frac{p^{2}-1}{2}
\end{aligned}
$$

which contradicts (1) again.\\
Comment 1. The argument in Case 2, after a slight modification of estimates at the end, applies as soon as there exists $k<\frac{3(p+1)}{4}$ with $a_{k}<a_{p-1}$. However, this argument does not seem to work if there is no such $k$.

Comment 2. If $p$ is small enough, then one can color $\{1,2, \ldots, N+1\}$ so that there exist numbers $m_{1}$, $m_{2}, \ldots, m_{p-1}$ satisfying $r\left(p m_{a}\right)=a / p$. For $p=3,5,7$, one can find colorings providing the following sequences:

$$
\left(m_{1}, m_{2}\right)=(1,2), \quad\left(m_{1}, m_{2}, m_{3}, m_{4}\right)=(1,2,3,6), \quad \text { and } \quad\left(m_{1}, \ldots, m_{6}\right)=(1,2,3,4,6,12)
$$

respectively.\\
Thus, for small values of $p$, the number $N$ in the problem statement cannot be increased. However, a careful analysis of the estimates shows that this number can be slightly increased for $p \geqslant 11$.",449,3
2020c6,"$4 n$ coins of weights $1,2,3, \ldots, 4 n$ are given. Each coin is colored in one of $n$ colors and there are four coins of each color. Show that all these coins can be partitioned into two sets with the same total weight, such that each set contains two coins of each color.","Let us pair the coins with weights summing up to $4 n+1$, resulting in the set $S$ of $2 n$ pairs: $\{1,4 n\},\{2,4 n-1\}, \ldots,\{2 n, 2 n+1\}$. It suffices to partition $S$ into two sets, each consisting of $n$ pairs, such that each set contains two coins of each color.

Introduce a multi-graph $G$ (i.e., a graph with loops and multiple edges allowed) on $n$ vertices, so that each vertex corresponds to a color. For each pair of coins from $S$, we add an edge between the vertices corresponding to the colors of those coins. Note that each vertex has degree 4. Also, a desired partition of the coins corresponds to a coloring of the edges of $G$ in two colors, say red and blue, so that each vertex has degree 2 with respect to each color (i.e., each vertex has equal red and blue degrees).

To complete the solution, it suffices to provide such a coloring for each component $G^{\prime}$ of $G$. Since all degrees of the vertices are even, in $G^{\prime}$ there exists an Euler circuit $C$ (i.e., a circuit passing through each edge of $G^{\prime}$ exactly once). Note that the number of edges in $C$ is even (it equals twice the number of vertices in $G^{\prime}$ ). Hence all the edges can be colored red and blue so that any two edges adjacent in $C$ have different colors (one may move along $C$ and color the edges one by one alternating red and blue colors). Thus in $G^{\prime}$ each vertex has equal red and blue degrees, as desired.

",262,3
2020c7,"Consider any rectangular table having finitely many rows and columns, with a real number $a(r, c)$ in the cell in row $r$ and column $c$. A pair $(R, C)$, where $R$ is a set of rows and $C$ a set of columns, is called a saddle pair if the following two conditions are satisfied:\\
(i) For each row $r^{\prime}$, there is $r \in R$ such that $a(r, c) \geqslant a\left(r^{\prime}, c\right)$ for all $c \in C$;\\
(ii) For each column $c^{\prime}$, there is $c \in C$ such that $a(r, c) \leqslant a\left(r, c^{\prime}\right)$ for all $r \in R$.

A saddle pair $(R, C)$ is called a minimal pair if for each saddle pair $\left(R^{\prime}, C^{\prime}\right)$ with $R^{\prime} \subseteq R$ and $C^{\prime} \subseteq C$, we have $R^{\prime}=R$ and $C^{\prime}=C$.

Prove that any two minimal pairs contain the same number of rows.","We say that a pair $\left(R^{\prime}, C^{\prime}\right)$ of nonempty sets is a subpair of a pair $(R, C)$ if $R^{\prime} \subseteq R$ and $C^{\prime} \subseteq C$. The subpair is proper if at least one of the inclusions is strict.

Let $\left(R_{1}, C_{1}\right)$ and $\left(R_{2}, C_{2}\right)$ be two saddle pairs with $\left|R_{1}\right|>\left|R_{2}\right|$. We will find a saddle subpair $\left(R^{\prime}, C^{\prime}\right)$ of $\left(R_{1}, C_{1}\right)$ with $\left|R^{\prime}\right| \leqslant\left|R_{2}\right|$; clearly, this implies the desired statement.\\
Step 1: We construct maps $\rho: R_{1} \rightarrow R_{1}$ and $\sigma: C_{1} \rightarrow C_{1}$ such that $\left|\rho\left(R_{1}\right)\right| \leqslant\left|R_{2}\right|$, and $a\left(\rho\left(r_{1}\right), c_{1}\right) \geqslant a\left(r_{1}, \sigma\left(c_{1}\right)\right)$ for all $r_{1} \in R_{1}$ and $c_{1} \in C_{1}$.

Since $\left(R_{1}, C_{1}\right)$ is a saddle pair, for each $r_{2} \in R_{2}$ there is $r_{1} \in R_{1}$ such that $a\left(r_{1}, c_{1}\right) \geqslant a\left(r_{2}, c_{1}\right)$ for all $c_{1} \in C_{1}$; denote one such an $r_{1}$ by $\rho_{1}\left(r_{2}\right)$. Similarly, we define four functions


\begin{align*}
& \rho_{1}: R_{2} \rightarrow R_{1} \quad \text { such that } a\left(\rho_{1}\left(r_{2}\right), c_{1}\right) \geqslant a\left(r_{2}, c_{1}\right) \quad \text { for all } \quad r_{2} \in R_{2}, \quad c_{1} \in C_{1} ; \\
& \rho_{2}: R_{1} \rightarrow R_{2} \quad \text { such that } a\left(\rho_{2}\left(r_{1}\right), c_{2}\right) \geqslant a\left(r_{1}, c_{2}\right)  \tag{1}\\
& \text { for all } \quad r_{1} \in R_{1}, \\
& \sigma_{1}: c_{2} \in C_{2} ; C_{1} \\
& \sigma_{2}: C_{1} \rightarrow C_{2}
\end{align*} \quad \text { such that } a\left(r_{1}, \sigma_{1}\left(c_{2}\right)\right) \leqslant a\left(r_{1}, c_{2}\right) \quad \text { for all } \quad r_{1} \in R_{1}, \quad c_{2} \in C_{2} ; ~ a\left(r_{2}, \sigma_{2}\left(c_{1}\right)\right) \leqslant a\left(r_{2}, c_{1}\right) \quad \text { for all } \quad r_{2} \in R_{2}, \quad c_{1} \in C_{1} .


Set now $\rho=\rho_{1} \circ \rho_{2}: R_{1} \rightarrow R_{1}$ and $\sigma=\sigma_{1} \circ \sigma_{2}: C_{1} \rightarrow C_{1}$. We have

$$
\left|\rho\left(R_{1}\right)\right|=\left|\rho_{1}\left(\rho_{2}\left(R_{1}\right)\right)\right| \leqslant\left|\rho_{1}\left(R_{2}\right)\right| \leqslant\left|R_{2}\right|
$$

Moreover, for all $r_{1} \in R_{1}$ and $c_{1} \in C_{1}$, we get


\begin{align*}
& a\left(\rho\left(r_{1}\right), c_{1}\right)=a\left(\rho_{1}\left(\rho_{2}\left(r_{1}\right)\right), c_{1}\right) \geqslant a\left(\rho_{2}\left(r_{1}\right), c_{1}\right) \geqslant a\left(\rho_{2}\left(r_{1}\right), \sigma_{2}\left(c_{1}\right)\right) \\
& \geqslant a\left(r_{1}, \sigma_{2}\left(c_{1}\right)\right) \geqslant a\left(r_{1}, \sigma_{1}\left(\sigma_{2}\left(c_{1}\right)\right)\right)=a\left(r_{1}, \sigma\left(c_{1}\right)\right) \tag{2}
\end{align*}


as desired.\\
Step 2: Given maps $\rho$ and $\sigma$, we construct a proper saddle subpair $\left(R^{\prime}, C^{\prime}\right)$ of $\left(R_{1}, C_{1}\right)$.\\
The properties of $\rho$ and $\sigma$ yield that

$$
a\left(\rho^{i}\left(r_{1}\right), c_{1}\right) \geqslant a\left(\rho^{i-1}\left(r_{1}\right), \sigma\left(c_{1}\right)\right) \geqslant \ldots \geqslant a\left(r_{1}, \sigma^{i}\left(c_{1}\right)\right)
$$

for each positive integer $i$ and all $r_{1} \in R_{1}, c_{1} \in C_{1}$.\\
Consider the images $R^{i}=\rho^{i}\left(R_{1}\right)$ and $C^{i}=\sigma^{i}\left(C_{1}\right)$. Clearly, $R_{1}=R^{0} \supseteq R^{1} \supseteq R^{2} \supseteq \ldots$ and $C_{1}=C^{0} \supseteq C^{1} \supseteq C^{2} \supseteq \ldots$. Since both chains consist of finite sets, there is an index $n$ such that $R^{n}=R^{n+1}=\ldots$ and $C^{n}=C^{n+1}=\ldots$ Then $\rho^{n}\left(R^{n}\right)=R^{2 n}=R^{n}$, so $\rho^{n}$ restricted to $R^{n}$ is a bijection. Similarly, $\sigma^{n}$ restricted to $C^{n}$ is a bijection from $C^{n}$ to itself. Therefore, there exists a positive integer $k$ such that $\rho^{n k}$ acts identically on $R^{n}$, and $\sigma^{n k}$ acts identically on $C^{n}$.

We claim now that $\left(R^{n}, C^{n}\right)$ is a saddle subpair of $\left(R_{1}, C_{1}\right)$, with $\left|R^{n}\right| \leqslant\left|R^{1}\right|=\left|\rho\left(R_{1}\right)\right| \leqslant$ $\left|R_{2}\right|$, which is what we needed. To check that this is a saddle pair, take any row $r^{\prime}$; since $\left(R_{1}, C_{1}\right)$ is a saddle pair, there exists $r_{1} \in R_{1}$ such that $a\left(r_{1}, c_{1}\right) \geqslant a\left(r^{\prime}, c_{1}\right)$ for all $c_{1} \in C_{1}$. Set now $r_{*}=\rho^{n k}\left(r_{1}\right) \in R^{n}$. Then, for each $c \in C^{n}$ we have $c=\sigma^{n k}(c)$ and hence

$$
a\left(r_{*}, c\right)=a\left(\rho^{n k}\left(r_{1}\right), c\right) \geqslant a\left(r_{1}, \sigma^{n k}(c)\right)=a\left(r_{1}, c\right) \geqslant a\left(r^{\prime}, c\right)
$$

which establishes condition (i). Condition (ii) is checked similarly.

",560,4
2020g1,"Let $A B C$ be an isosceles triangle with $B C=C A$, and let $D$ be a point inside side $A B$ such that $A D<D B$. Let $P$ and $Q$ be two points inside sides $B C$ and $C A$, respectively, such that $\angle D P B=\angle D Q A=90^{\circ}$. Let the perpendicular bisector of $P Q$ meet line segment $C Q$ at $E$, and let the circumcircles of triangles $A B C$ and $C P Q$ meet again at point $F$, different from $C$.

Suppose that $P, E, F$ are collinear. Prove that $\angle A C B=90^{\circ}$.","Let $\ell$ be the perpendicular bisector of $P Q$, and denote by $\omega$ the circle $C F P Q$. By $D P \perp B C$ and $D Q \perp A C$, the circle $\omega$ passes through $D$; moreover, $C D$ is a diameter of $\omega$.

The lines $Q E$ and $P E$ are symmetric about $\ell$, and $\ell$ is a symmetry axis of $\omega$ as well; it follows that the chords $C Q$ and $F P$ are symmetric about $\ell$, hence $C$ and $F$ are symmetric about $\ell$. Therefore, the perpendicular bisector of $C F$ coincides with $\ell$. Thus $\ell$ passes through the circumcenter $O$ of $A B C$.

Let $M$ be the midpoint of $A B$. Since $C M \perp D M, M$ also lies on $\omega$. By $\angle A C M=\angle B C M$, the chords $M P$ and $M Q$ of $\omega$ are equal. Then, from $M P=M Q$ it follows that $\ell$ passes through $M$.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_a23604964ee434afd034g-50}

Finally, both $O$ and $M$ lie on lines $\ell$ and $C M$, therefore $O=M$, and $\angle A C B=90^{\circ}$ follows.\\
",182,2
2020g2,"Let $A B C D$ be a convex quadrilateral. Suppose that $P$ is a point in the interior of $A B C D$ such that

$$
\angle P A D: \angle P B A: \angle D P A=1: 2: 3=\angle C B P: \angle B A P: \angle B P C .
$$

The internal bisectors of angles $A D P$ and $P C B$ meet at a point $Q$ inside the triangle $A B P$. Prove that $A Q=B Q$.","Let $\varphi=\angle P A D$ and $\psi=\angle C B P$; then we have $\angle P B A=2 \varphi, \angle D P A=3 \varphi$, $\angle B A P=2 \psi$ and $\angle B P C=3 \psi$. Let $X$ be the point on segment $A D$ with $\angle X P A=\varphi$. Then

$$
\angle P X D=\angle P A X+\angle X P A=2 \varphi=\angle D P A-\angle X P A=\angle D P X .
$$

It follows that triangle $D P X$ is isosceles with $D X=D P$ and therefore the internal angle bisector of $\angle A D P$ coincides with the perpendicular bisector of $X P$. Similarly, if $Y$ is a point on $B C$ such that $\angle B P Y=\psi$, then the internal angle bisector of $\angle P C B$ coincides with the perpendicular bisector of $P Y$. Hence, we have to prove that the perpendicular bisectors of $X P$, $P Y$, and $A B$ are concurrent.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_a23604964ee434afd034g-52}

Notice that

$$
\angle A X P=180^{\circ}-\angle P X D=180^{\circ}-2 \varphi=180^{\circ}-\angle P B A .
$$

Hence the quadrilateral $A X P B$ is cyclic; in other words, $X$ lies on the circumcircle of triangle $A P B$. Similarly, $Y$ lies on the circumcircle of triangle $A P B$. It follows that the perpendicular bisectors of $X P, P Y$, and $A B$ all pass through the center of circle $(A B Y P X)$. This finishes the proof.

Comment. Introduction of points $X$ and $Y$ seems to be the key step in the solution above. Note that the same point $X$ could be introduced in different ways, e.g., as the point on the ray $C P$ beyond $P$ such that $\angle P B X=\varphi$, or as a point where the circle $(A P B)$ meets again $A B$. Different definitions of $X$ could lead to different versions of the further solution.

",311,3
2020g3,"Let $A B C D$ be a convex quadrilateral with $\angle A B C>90^{\circ}, \angle C D A>90^{\circ}$, and $\angle D A B=\angle B C D$. Denote by $E$ and $F$ the reflections of $A$ in lines $B C$ and $C D$, respectively. Suppose that the segments $A E$ and $A F$ meet the line $B D$ at $K$ and $L$, respectively. Prove that the circumcircles of triangles $B E K$ and $D F L$ are tangent to each other.","Denote by $A^{\prime}$ the reflection of $A$ in $B D$. We will show that that the quadrilaterals $A^{\prime} B K E$ and $A^{\prime} D L F$ are cyclic, and their circumcircles are tangent to each other at point $A^{\prime}$.

From the symmetry about line $B C$ we have $\angle B E K=\angle B A K$, while from the symmetry in $B D$ we have $\angle B A K=\angle B A^{\prime} K$. Hence $\angle B E K=\angle B A^{\prime} K$, which implies that the quadrilateral $A^{\prime} B K E$ is cyclic. Similarly, the quadrilateral $A^{\prime} D L F$ is also cyclic.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_a23604964ee434afd034g-54}

For showing that circles $A^{\prime} B K E$ and $A^{\prime} D L F$ are tangent it suffices to prove that

$$
\angle A^{\prime} K B+\angle A^{\prime} L D=\angle B A^{\prime} D .
$$

Indeed, by $A K \perp B C$, $A L \perp C D$, and again the symmetry in $B D$ we have

$$
\angle A^{\prime} K B+\angle A^{\prime} L D=180^{\circ}-\angle K A^{\prime} L=180^{\circ}-\angle K A L=\angle B C D=\angle B A D=\angle B A^{\prime} D,
$$

as required.\\
",183,2
2020g4,"In the plane, there are $n \geqslant 6$ pairwise disjoint disks $D_{1}, D_{2}, \ldots, D_{n}$ with radii $R_{1} \geqslant R_{2} \geqslant \ldots \geqslant R_{n}$. For every $i=1,2, \ldots, n$, a point $P_{i}$ is chosen in disk $D_{i}$. Let $O$ be an arbitrary point in the plane. Prove that

$$
O P_{1}+O P_{2}+\ldots+O P_{n} \geqslant R_{6}+R_{7}+\ldots+R_{n} .
$$

(A disk is assumed to contain its boundary.)","We will make use of the following lemma.\\
Lemma. Let $D_{1}, \ldots, D_{6}$ be disjoint disks in the plane with radii $R_{1}, \ldots, R_{6}$. Let $P_{i}$ be a point in $D_{i}$, and let $O$ be an arbitrary point. Then there exist indices $i$ and $j$ such that $O P_{i} \geqslant R_{j}$.\\
Proof. Let $O_{i}$ be the center of $D_{i}$. Consider six rays $O O_{1}, \ldots, O O_{6}$ (if $O=O_{i}$, then the ray $O O_{i}$ may be assumed to have an arbitrary direction). These rays partition the plane into six angles (one of which may be non-convex) whose measures sum up to $360^{\circ}$; hence one of the angles, say $\angle O_{i} O O_{j}$, has measure at most $60^{\circ}$. Then $O_{i} O_{j}$ cannot be the unique largest side in (possibly degenerate) triangle $O O_{i} O_{j}$, so, without loss of generality, $O O_{i} \geqslant O_{i} O_{j} \geqslant R_{i}+R_{j}$. Therefore, $O P_{i} \geqslant O O_{i}-R_{i} \geqslant\left(R_{i}+R_{j}\right)-R_{i}=R_{j}$, as desired.

Now we prove the required inequality by induction on $n \geqslant 5$. The base case $n=5$ is trivial. For the inductive step, apply the Lemma to the six largest disks, in order to find indices $i$ and $j$ such that $1 \leqslant i, j \leqslant 6$ and $O P_{i} \geqslant R_{j} \geqslant R_{6}$. Removing $D_{i}$ from the configuration and applying the inductive hypothesis, we get

$$
\sum_{k \neq i} O P_{k} \geqslant \sum_{\ell \geqslant 7} R_{\ell} .
$$

Adding up this inequality with $O P_{i} \geqslant R_{6}$ we establish the inductive step.\\
Comment 1. It is irrelevant to the problem whether the disks contain their boundaries or not. This condition is included for clarity reasons only. The problem statement remains true, and the solution works verbatim, if the disks are assumed to have disjoint interiors.

Comment 2. There are several variations of the above solution. In particular, while performing the inductive step, one may remove the disk with the largest value of $O P_{i}$ and apply the inductive hypothesis to the remaining disks (the Lemma should still be applied to the six largest disks).

Comment 3. While proving the Lemma, one may reduce it to a particular case when the disks are congruent, as follows: Choose the smallest radius $r$ of the disks in the Lemma statement, and then replace, for each $i$, the $i^{\text {th }}$ disk with its homothetic copy, using the homothety centered at $P_{i}$ with ratio $r / R_{i}$.

This argument shows that the Lemma is tightly connected to a circle packing problem, see, e.g., \href{https://en.wikipedia.org/wiki/Circle_packing_in_a_circle}{https://en.wikipedia.org/wiki/Circle\_packing\_in\_a\_circle}. The known results on that problem provide versions of the Lemma for different numbers of disks, which lead to different inequalities of the same kind. E.g., for 4 disks the best possible estimate in the Lemma is $O P_{i} \geqslant(\sqrt{2}-1) R_{j}$, while for 13 disks it has the form $O P_{i} \geqslant \sqrt{5} R_{j}$. Arguing as in the above solution, one obtains the inequalities

$$
\sum_{i=1}^{n} O P_{i} \geqslant(\sqrt{2}-1) \sum_{j=4}^{n} R_{j} \quad \text { and } \quad \sum_{i=1}^{n} O P_{i} \geqslant \sqrt{5} \sum_{j=13}^{n} R_{j} .
$$

However, there are some harder arguments which allow to improve these inequalities, meaning that the $R_{j}$ with large indices may be taken with much greater factors.",526,4
2020g5,"Let $A B C D$ be a cyclic quadrilateral with no two sides parallel. Let $K, L, M$, and $N$ be points lying on sides $A B, B C, C D$, and $D A$, respectively, such that $K L M N$ is a rhombus with $K L \| A C$ and $L M \| B D$. Let $\omega_{1}, \omega_{2}, \omega_{3}$, and $\omega_{4}$ be the incircles of triangles $A N K$, $B K L, C L M$, and $D M N$, respectively. Prove that the internal common tangents to $\omega_{1}$ and $\omega_{3}$ and the internal common tangents to $\omega_{2}$ and $\omega_{4}$ are concurrent.","Let $I_{i}$ be the center of $\omega_{i}$, and let $r_{i}$ be its radius for $i=1,2,3,4$. Denote by $T_{1}$ and $T_{3}$ the points of tangency of $\omega_{1}$ and $\omega_{3}$ with $N K$ and $L M$, respectively. Suppose that the internal common tangents to $\omega_{1}$ and $\omega_{3}$ meet at point $S$, which is the center of homothety $h$ with negative ratio (namely, with ratio $-\frac{r_{3}}{r_{1}}$ ) mapping $\omega_{1}$ to $\omega_{3}$. This homothety takes $T_{1}$ to $T_{3}$ (since the tangents to $\omega_{1}$ and $\omega_{3}$ at $T_{1}$ to $T_{3}$ are parallel), hence $S$ is a point on the segment $T_{1} T_{3}$ with $T_{1} S: S T_{3}=r_{1}: r_{3}$.

Construct segments $S_{1} S_{3} \| K L$ and $S_{2} S_{4} \| L M$ through $S$ with $S_{1} \in N K, S_{2} \in K L$, $S_{3} \in L M$, and $S_{4} \in M N$. Note that $h$ takes $S_{1}$ to $S_{3}$, hence $I_{1} S_{1} \| I_{3} S_{3}$, and $S_{1} S: S S_{3}=r_{1}: r_{3}$. We will prove that $S_{2} S: S S_{4}=r_{2}: r_{4}$ or, equivalently, $K S_{1}: S_{1} N=r_{2}: r_{4}$. This will yield the problem statement; indeed, applying similar arguments to the intersection point $S^{\prime}$ of the internal common tangents to $\omega_{2}$ and $\omega_{4}$, we see that $S^{\prime}$ satisfies similar relations, and there is a unique point inside $K L M N$ satisfying them. Therefore, $S^{\prime}=S$.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_a23604964ee434afd034g-56}

Further, denote by $I_{A}, I_{B}, I_{C}, I_{D}$ and $r_{A}, r_{B}, r_{C}, r_{D}$ the incenters and inradii of triangles $D A B, A B C, B C D$, and $C D A$, respectively. One can shift triangle $C L M$ by $\overrightarrow{L K}$ to glue it with triangle $A K N$ into a quadrilateral $A K C^{\prime} N$ similar to $A B C D$. In particular, this shows that $r_{1}: r_{3}=r_{A}: r_{C}$; similarly, $r_{2}: r_{4}=r_{B}: r_{D}$. Moreover, the same shift takes $S_{3}$ to $S_{1}$, and it also takes $I_{3}$ to the incenter $I_{3}^{\prime}$ of triangle $K C^{\prime} N$. Since $I_{1} S_{1} \| I_{3} S_{3}$, the points $I_{1}, S_{1}, I_{3}^{\prime}$ are collinear. Thus, in order to complete the solution, it suffices to apply the following Lemma to quadrilateral $A K C^{\prime} N$.\\
Lemma 1. Let $A B C D$ be a cyclic quadrilateral, and define $I_{A}, I_{C}, r_{B}$, and $r_{D}$ as above. Let $I_{A} I_{C}$ meet $B D$ at $X$; then $B X: X D=r_{B}: r_{D}$.\\
Proof. Consider an inversion centered at $X$; the images under that inversion will be denoted by primes, e.g., $A^{\prime}$ is the image of $A$.

By properties of inversion, we have

$$
\angle I_{C}^{\prime} I_{A}^{\prime} D^{\prime}=\angle X I_{A}^{\prime} D^{\prime}=\angle X D I_{A}=\angle B D A / 2=\angle B C A / 2=\angle A C I_{B} .
$$

We obtain $\angle I_{A}^{\prime} I_{C}^{\prime} D^{\prime}=\angle C A I_{B}$ likewise; therefore, $\triangle I_{C}^{\prime} I_{A}^{\prime} D^{\prime} \sim \triangle A C I_{B}$. In the same manner, we get $\triangle I_{C}^{\prime} I_{A}^{\prime} B^{\prime} \sim \triangle A C I_{D}$, hence the quadrilaterals $I_{C}^{\prime} B^{\prime} I_{A}^{\prime} D^{\prime}$ and $A I_{D} C I_{B}$ are also similar. But the diagonals $A C$ and $I_{B} I_{D}$ of quadrilateral $A I_{D} C I_{B}$ meet at a point $Y$ such that $I_{B} Y$ :\\
$Y I_{D}=r_{B}: r_{D}$. By similarity, we get $D^{\prime} X: B^{\prime} X=r_{B}: r_{D}$ and hence $B X: X D=D^{\prime} X:$ $B^{\prime} X=r_{B}: r_{D}$.

",536,4
2020g6,"Let $I$ and $I_{A}$ be the incenter and the $A$-excenter of an acute-angled triangle $A B C$ with $A B<A C$. Let the incircle meet $B C$ at $D$. The line $A D$ meets $B I_{A}$ and $C I_{A}$ at $E$ and $F$, respectively. Prove that the circumcircles of triangles $A I D$ and $I_{A} E F$ are tangent to each other.","Let $\Varangle(p, q)$ denote the directed angle between lines $p$ and $q$.\\
The points $B, C, I$, and $I_{A}$ lie on the circle $\Gamma$ with diameter $I I_{A}$. Let $\omega$ and $\Omega$ denote the circles $\left(I_{A} E F\right)$ and $(A I D)$, respectively. Let $T$ be the second intersection point of $\omega$ and $\Gamma$. Then $T$ is the Miquel point of the complete quadrilateral formed by the lines $B C, B I_{A}, C I_{A}$, and $D E F$, so $T$ also lies on circle $(B D E)$ (as well as on circle $(C D F)$ ). We claim that $T$ is a desired tangency point of $\omega$ and $\Omega$.

In order to show that $T$ lies on $\Omega$, use cyclic quadrilaterals $B D E T$ and $B I I_{A} T$ to write

$$
\Varangle(D T, D A)=\Varangle(D T, D E)=\Varangle(B T, B E)=\Varangle\left(B T, B I_{A}\right)=\Varangle\left(I T, I I_{A}\right)=\Varangle(I T, I A) .
$$

\begin{center}
\includegraphics[max width=\textwidth]{2025_04_29_a23604964ee434afd034g-60}
\end{center}

To show that $\omega$ and $\Omega$ are tangent at $T$, let $\ell$ be the tangent to $\omega$ at $T$, so that $\Varangle\left(T I_{A}, \ell\right)=$ $\Varangle\left(E I_{A}, E T\right)$. Using circles $(B D E T)$ and $\left(B I C I_{A}\right)$, we get

$$
\Varangle\left(E I_{A}, E T\right)=\Varangle(E B, E T)=\Varangle(D B, D T) .
$$

Therefore,

$$
\Varangle(T I, \ell)=90^{\circ}+\Varangle\left(T I_{A}, \ell\right)=90^{\circ}+\Varangle(D B, D T)=\Varangle(D I, D T),
$$

which shows that $\ell$ is tangent to $\Omega$ at $T$.\\
",236,2
2020g7,"Let $P$ be a point on the circumcircle of an acute-angled triangle $A B C$. Let $D$, $E$, and $F$ be the reflections of $P$ in the midlines of triangle $A B C$ parallel to $B C, C A$, and $A B$, respectively. Denote by $\omega_{A}, \omega_{B}$, and $\omega_{C}$ the circumcircles of triangles $A D P, B E P$, and $C F P$, respectively. Denote by $\omega$ the circumcircle of the triangle formed by the perpendicular bisectors of segments $A D, B E$ and $C F$.

Show that $\omega_{A}, \omega_{B}, \omega_{C}$, and $\omega$ have a common point.","Solution. Let $A A_{1}, B B_{1}$, and $C C_{1}$ be the altitudes in triangle $A B C$, and let $m_{A}, m_{B}$, and $m_{C}$ be the midlines parallel to $B C, C A$, and $A B$, respectively. We always denote by $\Varangle(p, q)$ the directed angle from a line $p$ to a line $q$, taken modulo $180^{\circ}$.

Step 1: Circles $\omega_{A}, \omega_{B}$, and $\omega_{C}$ share a common point $Q$ different from $P$.\\
Notice that $m_{A}$ is the perpendicular bisector of $P D$, so $\omega_{A}$ is symmetric with respect to $m_{A}$. Since $A$ and $A_{1}$ are also symmetric to each other in $m_{A}$, the point $A_{1}$ lies on $\omega_{A}$. Similarly, $B_{1}$ and $C_{1}$ lie on $\omega_{B}$ and $\omega_{C}$, respectively.

Let $H$ be the orthocenter of $\triangle A B C$. Quadrilaterals $A B A_{1} B_{1}$ and $B C B_{1} C_{1}$ are cyclic, so $A H \cdot H A_{1}=B H \cdot H B_{1}=C H \cdot H C_{1}$. This means that $H$ lies on pairwise radical axes of $\omega_{A}$, $\omega_{B}$, and $\omega_{C}$. Point $P$ also lies on those radical axes; hence the three circles have a common radical axis $\ell=P H$, and the second meeting point $Q$ of $\ell$ with $\omega_{A}$ is the second common point of the three circles. Notice here that $H$ lies inside all three circles, hence $Q \neq P$.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_a23604964ee434afd034g-64}

\section*{Step 2: Point $Q$ lies on $\omega$.}
Let $p_{A}, p_{B}$, and $p_{C}$ denote the perpendicular bisectors of $A D, B E$, and $C F$, respectively; denote by $\Delta$ the triangle formed by those perpendicular bisectors. By Simson's theorem, in order to show that $Q$ lies on the circumcircle $\omega$ of $\Delta$, it suffices to prove that the projections of $Q$ onto the sidelines $p_{A}, p_{B}$, and $p_{C}$ are collinear. Alternatively, but equivalently, it suffices to prove that the reflections $Q_{A}, Q_{B}$, and $Q_{C}$ of $Q$ in those lines, respectively, are collinear. In fact, we will show that four points $P, Q_{A}, Q_{B}$, and $Q_{C}$ are collinear.

Since $p_{A}$ is the common perpendicular bisector of $A D$ and $Q Q_{A}$, the point $Q_{A}$ lies on $\omega_{A}$, and, moreover, $\Varangle\left(D A, D Q_{A}\right)=\Varangle(A Q, A D)$. Therefore,

$$
\Varangle\left(P A, P Q_{A}\right)=\Varangle\left(D A, D Q_{A}\right)=\Varangle(A Q, A D)=\Varangle(P Q, P D)=\Varangle(P Q, B C)+90^{\circ} .
$$

Similarly, we get $\Varangle\left(P B, P Q_{B}\right)=\Varangle(P Q, C A)+90^{\circ}$. Therefore,

$$
\begin{aligned}
\Varangle\left(P Q_{A}, P Q_{B}\right)=\Varangle\left(P Q_{A}, P A\right) & +\Varangle(P A, P B)+\Varangle\left(P B, P Q_{B}\right) \\
& =\Varangle(B C, P Q)+90^{\circ}+\Varangle(C A, C B)+\Varangle(P Q, C A)+90^{\circ}=0,
\end{aligned}
$$

which shows that $P, Q_{A}$, and $Q_{B}$ are collinear. Similarly, $Q_{C}$ also lies on $P Q_{A}$.\\
Comment 1. There are several variations of Step 2. In particular, let $O_{A}, O_{B}$, and $O_{C}$ denote the centers of $\omega_{A}, \omega_{B}$, and $\omega_{C}$, respectively; they lie on $p_{A}, p_{B}$, and $p_{C}$, respectively. Moreover, all those centers lie on the perpendicular bisector $p$ of $P Q$. Now one can show that $\Varangle\left(Q O_{A}, p_{A}\right)=$ $\Varangle\left(Q O_{B}, p_{B}\right)=\Varangle\left(Q O_{C}, p_{C}\right)$, and then finish by applying generalized Simson's theorem, Alternatively, but equivalently, those relations show that $Q$ is the Miquel point of the lines $p_{A}, p_{B}, p_{C}$, and $p$.

To establish $\Varangle\left(Q O_{A}, p_{A}\right)=\Varangle\left(Q O_{C}, p_{C}\right)$, notice that it is equivalent to $\Varangle\left(Q O_{A}, Q O_{C}\right)=\Varangle\left(p_{A}, p_{C}\right)$ which may be obtained, e.g., as follows:

$$
\begin{aligned}
& \Varangle\left(Q O_{A}, Q O_{C}\right)=\Varangle\left(Q O_{A}, p\right)+\Varangle\left(p, Q O_{C}\right)=\Varangle(A Q, A P)+\Varangle(C P, C Q) \\
& =\Varangle(A Q, C Q)+\Varangle(C P, A P)=\Varangle(A Q, P Q)+\Varangle(P Q, C Q)+\Varangle(C B, A B) \\
& \quad=\Varangle\left(A D, A A_{1}\right)+\Varangle\left(C C_{1}, C F\right)+\Varangle\left(A A_{1}, C C_{1}\right)=\Varangle(A D, C F)=\Varangle\left(p_{A}, p_{C}\right) .
\end{aligned}
$$

\begin{center}
\includegraphics[max width=\textwidth]{2025_04_29_a23604964ee434afd034g-65}
\end{center}

Comment 2. The inversion at $H$ with (negative) power $-A H \cdot H A_{1}$ maps $P$ to $Q$, and the circumcircle of $\triangle A B C$ to its Euler circle. Therefore, $Q$ lies on that Euler circle.",640,4
2020g8,"Let $\Gamma$ and $I$ be the circumcircle and the incenter of an acute-angled triangle $A B C$. Two circles $\omega_{B}$ and $\omega_{C}$ passing through $B$ and $C$, respectively, are tangent at $I$. Let $\omega_{B}$ meet the shorter arc $A B$ of $\Gamma$ and segment $A B$ again at $P$ and $M$, respectively. Similarly, let $\omega_{C}$ meet the shorter arc $A C$ of $\Gamma$ and segment $A C$ again at $Q$ and $N$, respectively. The rays $P M$ and $Q N$ meet at $X$, and the tangents to $\omega_{B}$ and $\omega_{C}$ at $B$ and $C$, respectively, meet at $Y$.

Prove that the points $A, X$, and $Y$ are collinear.","Let $A I, B I$, and $C I$ meet $\Gamma$ again at $D, E$, and $F$, respectively. Let $\ell$ be the common tangent to $\omega_{B}$ and $\omega_{C}$ at $I$. We always denote by $\Varangle(p, q)$ the directed angle from a line $p$ to a line $q$, taken modulo $180^{\circ}$.

Step 1: We show that $Y$ lies on $\Gamma$.\\
Recall that any chord of a circle makes complementary directed angles with the tangents to the circle at its endpoints. Hence,

$$
\Varangle(B Y, B I)+\Varangle(C I, C Y)=\Varangle(I B, \ell)+\Varangle(\ell, I C)=\Varangle(I B, I C) .
$$

Therefore,

$$
\begin{aligned}
\Varangle(B Y, B A)+\Varangle(C A, C Y)=\Varangle(B I, B A)+ & \Varangle \\
& (B Y, B I)+\Varangle(C I, C Y)+\Varangle(C A, C I) \\
& =\Varangle(B C, B I)+\Varangle(I B, I C)+\Varangle(C I, C B)=0,
\end{aligned}
$$

which yields $Y \in \Gamma$.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_a23604964ee434afd034g-66}

Step 2: We show that $X=\ell \cap E F$.\\
Let $X_{*}=\ell \cap E F$. To prove our claim, it suffices to show that $X_{*}$ lies on both $P M$ and $Q N$; this will yield $X_{*}=X$. Due to symmetry, it suffices to show $X_{*} \in Q N$.

Notice that

$$
\Varangle\left(I X_{*}, I Q\right)=\Varangle(C I, C Q)=\Varangle(C F, C Q)=\Varangle(E F, E Q)=\Varangle\left(E X_{*}, E Q\right) ;
$$

therefore, the points $X_{*}, I, Q$, and $E$ are concyclic (if $Q=E$, then the direction of $E Q$ is supposed to be the direction of a tangent to $\Gamma$ at $Q$; in this case, the equality means that the circle $\left(X_{*} I Q\right)$ is tangent to $\Gamma$ at $\left.Q\right)$. Then we have

$$
\Varangle\left(Q X_{*}, Q I\right)=\Varangle\left(E X_{*}, E I\right)=\Varangle(E F, E B)=\Varangle(C A, C F)=\Varangle(C N, C I)=\Varangle(Q N, Q I),
$$

which shows that $X_{*} \in Q N$.\\
Step 3: We finally show that $A, X$, and $Y$ are collinear.\\
Recall that $I$ is the orthocenter of triangle $D E F$, and $A$ is symmetric to $I$ with respect to $E F$. Therefore,

$$
\Varangle(A X, A E)=\Varangle(I E, I X)=\Varangle(B I, \ell)=\Varangle(B Y, B I)=\Varangle(B Y, B E)=\Varangle(A Y, A E),
$$

which yields the desired collinearity.\\
Comment 1. Step 2 in the above solution seems to be crucial. After it has been performed (even without Step 1), there are different ways of finishing the solution.\\
E.g., one may involve the notion of isogonal conjugacy. Let $X_{1}$ and $Y_{1}$ be isogonal conjugates of $X$ and $Y$, respectively, with respect to triangle $A B C$. Since $X A=X I$, triangle $A I X$ is isosceles, and hence the lines $A X$ and $X I$ form equal angles with the internal bisector $A I$ of $\angle B A C$. This means that $A X_{1} \| X I$, or $A X_{1} \| \ell$.

On the other hand, the lines $B Y$ and $\ell$ form equal angles with $B I$, so that $B Y_{1} \| \ell$. Similarly, $C Y_{1} \| \ell$. This means that $Y_{1}$ is an ideal point, and $A Y_{1} \| \ell$ as well. Therefore, points $A, X_{1}$, and $Y_{1}$ are collinear, and hence $A, X$, and $Y$ are such.

",514,4
2020g9,"Prove that there exists a positive constant $c$ such that the following statement is true:

Assume that $n$ is an integer with $n \geqslant 2$, and let $\mathcal{S}$ be a set of $n$ points in the plane such that the distance between any two distinct points in $\mathcal{S}$ is at least 1 . Then there is a line $\ell$ separating $\mathcal{S}$ such that the distance from any point of $\mathcal{S}$ to $\ell$ is at least $c n^{-1 / 3}$.\\
(A line $\ell$ separates a point set $\mathcal{S}$ if some segment joining two points in $\mathcal{S}$ crosses $\ell$.)","Solution. We prove that the desired statement is true with $c=\frac{1}{8}$. Set $\delta=\frac{1}{8} n^{-1 / 3}$. For any line $\ell$ and any point $X$, let $X_{\ell}$ denote the projection of $X$ to $\ell$; a similar notation applies to sets of points.

Suppose that, for some line $\ell$, the set $\mathcal{S}_{\ell}$ contains two adjacent points $X$ and $Y$ with $X Y=2 d$. Then the line perpendicular to $\ell$ and passing through the midpoint of segment $X Y$ separates $\mathcal{S}$, and all points in $\mathcal{S}$ are at least $d$ apart from $\ell$. Thus, if $d \geqslant \delta$, then a desired line has been found. For the sake of contradiction, we assume that no such points exist, in any projection.

Choose two points $A$ and $B$ in $\mathcal{S}$ with the maximal distance $M=A B$ (i.e., $A B$ is a diameter of $\mathcal{S}$ ); by the problem condition, $M \geqslant 1$. Denote by $\ell$ the line $A B$. The set $\mathcal{S}$ is contained in the intersection of two disks $D_{A}$ and $D_{B}$ of radius $M$ centered at $A$ and $B$, respectively. Hence, the projection $\mathcal{S}_{\ell}$ is contained in the segment $A B$. Moreover, the points in $\mathcal{S}_{\ell}$ divide that segment into at most $n-1$ parts, each of length less than $2 \delta$. Therefore,


\begin{equation*}
M<n \cdot 2 \delta . \tag{1}
\end{equation*}


\begin{center}
\includegraphics[max width=\textwidth]{2025_04_29_a23604964ee434afd034g-69}
\end{center}

Choose a point $H$ on segment $A B$ with $A H=\frac{1}{2}$. Let $P$ be a strip between the lines $a$ and $h$ perpendicular to $A B$ and passing through $A$ and $H$, respectively; we assume that $P$ contains its boundary, which consists of lines $a$ and $h$. Set $\mathcal{T}=P \cap \mathcal{S}$ and let $t=|\mathcal{T}|$. By our assumption, segment $A H$ contains at least $\left\lceil\frac{1}{2}:(2 \delta)\right\rceil$ points of $S_{\ell}$, which yields


\begin{equation*}
t \geqslant \frac{1}{4 \delta} . \tag{2}
\end{equation*}


Notice that $\mathcal{T}$ is contained in $Q=P \cap D_{B}$. The set $Q$ is a circular segment, and its projection $Q_{a}$ is a line segment of length

$$
2 \sqrt{M^{2}-\left(M-\frac{1}{2}\right)^{2}}<2 \sqrt{M}
$$

On the other hand, for any two points $X, Y \in \mathcal{T}$, we have $X Y \geqslant 1$ and $X_{\ell} Y_{\ell} \leqslant \frac{1}{2}$, so $X_{a} Y_{a}=$ $\sqrt{X Y^{2}-X_{\ell} Y_{\ell}^{2}} \geqslant \frac{\sqrt{3}}{2}$. To summarize, $t$ points constituting $\mathcal{T}_{a}$ lie on the segment of length less than $2 \sqrt{M}$, and are at least $\frac{\sqrt{3}}{2}$ apart from each other. This yields $2 \sqrt{M}>(t-1) \frac{\sqrt{3}}{2}$, or


\begin{equation*}
t<1+\frac{4 \sqrt{M}}{\sqrt{3}}<4 \sqrt{M}, \tag{3}
\end{equation*}


as $M \geqslant 1$.\\
Combining the estimates (1), (2), and (3), we finally obtain

$$
\frac{1}{4 \delta} \leqslant t<4 \sqrt{M}<4 \sqrt{2 n \delta}, \quad \text { or } \quad 512 n \delta^{3}>1
$$

which does not hold for the chosen value of $\delta$.\\
Comment 1. As the proposer mentions, the exponent $-1 / 3$ in the problem statement is optimal. In fact, for any $n \geqslant 2$, there is a configuration $\mathcal{S}$ of $n$ points in the plane such that any two points in $\mathcal{S}$ are at least 1 apart, but every line $\ell$ separating $\mathcal{S}$ is at most $c^{\prime} n^{-1 / 3} \log n$ apart from some point in $\mathcal{S}$; here $c^{\prime}$ is some absolute constant.

The original proposal suggested to prove the estimate of the form $c n^{-1 / 2}$. That version admits much easier solutions. E.g., setting $\delta=\frac{1}{16} n^{-1 / 2}$ and applying (1), we see that $\mathcal{S}$ is contained in a disk $D$ of radius $\frac{1}{8} n^{1 / 2}$. On the other hand, for each point $X$ of $\mathcal{S}$, let $D_{X}$ be the disk of radius $\frac{1}{2}$ centered at $X$; all these disks have disjoint interiors and lie within the disk concentric to $D$, of radius $\frac{1}{16} n^{1 / 2}+\frac{1}{2}<\frac{1}{2} n^{1 / 2}$. Comparing the areas, we get

$$
n \cdot \frac{\pi}{4} \leqslant \pi\left(\frac{n^{1 / 2}}{16}+\frac{1}{2}\right)^{2}<\frac{\pi n}{4}
$$

which is a contradiction.\\
The Problem Selection Committee decided to choose a harder version for the Shortlist.\\
Comment 2. In this comment, we discuss some versions of the solution above, which avoid concentrating on the diameter of $\mathcal{S}$. We start with introducing some terminology suitable for those versions.

Put $\delta=c n^{-1 / 3}$ for a certain sufficiently small positive constant $c$. For the sake of contradiction, suppose that, for some set $\mathcal{S}$ satisfying the conditions in the problem statement, there is no separating line which is at least $\delta$ apart from each point of $\mathcal{S}$.

Let $C$ be the convex hull of $\mathcal{S}$. A line is separating if and only if it meets $C$ (we assume that a line passing through a point of $\mathcal{S}$ is always separating). Consider a strip between two parallel separating lines $a$ and $a^{\prime}$ which are, say, $\frac{1}{4}$ apart from each other. Define a slice determined by the strip as the intersection of $\mathcal{S}$ with the strip. The length of the slice is the diameter of the projection of the slice to $a$.

In this terminology, the arguments used in the proofs of (2) and (3) show that for any slice $\mathcal{T}$ of length $L$, we have


\begin{equation*}
\frac{1}{8 \delta} \leqslant|\mathcal{T}| \leqslant 1+\frac{4}{\sqrt{15}} L \tag{4}
\end{equation*}


The key idea of the solution is to apply these estimates to a peel slice, where line $a$ does not cross the interior of $C$. In the above solution, this idea was applied to one carefully chosen peel slice. Here, we outline some different approach involving many of them. We always assume that $n$ is sufficiently large.

Consider a peel slice determined by lines $a$ and $a^{\prime}$, where $a$ contains no interior points of $C$. We orient $a$ so that $C$ lies to the left of $a$. Line $a$ is called a supporting line of the slice, and the obtained direction is the direction of the slice; notice that the direction determines uniquely the supporting line and hence the slice. Fix some direction $\mathbf{v}_{0}$, and for each $\alpha \in[0,2 \pi)$ denote by $\mathcal{T}_{\alpha}$ the peel slice whose direction is $\mathbf{v}_{0}$ rotated by $\alpha$ counterclockwise.

When speaking about the slice, we always assume that the figure is rotated so that its direction is vertical from the bottom to the top; then the points in $\mathcal{T}$ get a natural order from the bottom to the top. In particular, we may speak about the top half $\mathrm{T}(\mathcal{T})$ consisting of $\lfloor|\mathcal{T}| / 2\rfloor$ topmost points in $\mathcal{T}$, and similarly about its bottom half $\mathrm{B}(\mathcal{T})$. By (4), each half contains at least 10 points when $n$ is large. Claim. Consider two angles $\alpha, \beta \in[0, \pi / 2]$ with $\beta-\alpha \geqslant 40 \delta=$ : $\phi$. Then all common points of $\mathcal{T}_{\alpha}$ and $\mathcal{T}_{\beta}$ lie in $\mathrm{T}\left(\mathcal{T}_{\alpha}\right) \cap \mathrm{B}\left(\mathcal{T}_{\beta}\right)$.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_a23604964ee434afd034g-71}

Proof. By symmetry, it suffices to show that all those points lie in $\mathrm{T}\left(\mathcal{T}_{\alpha}\right)$. Let $a$ be the supporting line of $\mathcal{T}_{\alpha}$, and let $\ell$ be a line perpendicular to the direction of $\mathcal{T}_{\beta}$. Let $P_{1}, \ldots, P_{k}$ list all points in $\mathcal{T}_{\alpha}$, numbered from the bottom to the top; by (4), we have $k \geqslant \frac{1}{8} \delta^{-1}$.

Introduce the Cartesian coordinates so that the (oriented) line $a$ is the $y$-axis. Let $P_{i}$ be any point in $\mathrm{B}\left(\mathcal{T}_{\alpha}\right)$. The difference of ordinates of $P_{k}$ and $P_{i}$ is at least $\frac{\sqrt{15}}{4}(k-i)>\frac{1}{3} k$, while their abscissas differ by at most $\frac{1}{4}$. This easily yields that the projections of those points to $\ell$ are at least

$$
\frac{k}{3} \sin \phi-\frac{1}{4} \geqslant \frac{1}{24 \delta} \cdot 20 \delta-\frac{1}{4}>\frac{1}{4}
$$

apart from each other, and $P_{k}$ is closer to the supporting line of $\mathcal{T}_{\beta}$ than $P_{i}$, so that $P_{i}$ does not belong to $\mathcal{T}_{\beta}$.

Now, put $\alpha_{i}=40 \delta i$, for $i=0,1, \ldots,\left\lfloor\frac{1}{40} \delta^{-1} \cdot \frac{\pi}{2}\right\rfloor$, and consider the slices $\mathcal{T}_{\alpha_{i}}$. The Claim yields that each point in $\mathcal{S}$ is contained in at most two such slices. Hence, the union $\mathcal{U}$ of those slices contains at least

$$
\frac{1}{2} \cdot \frac{1}{8 \delta} \cdot \frac{1}{40 \delta} \cdot \frac{\pi}{2}=\frac{\lambda}{\delta^{2}}
$$

points (for some constant $\lambda$ ), and each point in $\mathcal{U}$ is at most $\frac{1}{4}$ apart from the boundary of $C$.\\
It is not hard now to reach a contradiction with (1). E.g., for each point $X \in \mathcal{U}$, consider a closest point $f(X)$ on the boundary of $C$. Obviously, $f(X) f(Y) \geqslant X Y-\frac{1}{2} \geqslant \frac{1}{2} X Y$ for all $X, Y \in \mathcal{U}$. This yields that the perimeter of $C$ is at least $\mu \delta^{-2}$, for some constant $\mu$, and hence the diameter of $\mathcal{S}$ is of the same order.

Alternatively, one may show that the projection of $\mathcal{U}$ to the line at the angle of $\pi / 4$ with $\mathbf{v}_{0}$ has diameter at least $\mu \delta^{-2}$ for some constant $\mu$.",1411,4
2020n1,"Given a positive integer $k$, show that there exists a prime $p$ such that one can choose distinct integers $a_{1}, a_{2}, \ldots, a_{k+3} \in\{1,2, \ldots, p-1\}$ such that $p$ divides $a_{i} a_{i+1} a_{i+2} a_{i+3}-i$ for all $i=1,2, \ldots, k$.\\","Solution. First we choose distinct positive rational numbers $r_{1}, \ldots, r_{k+3}$ such that

$$
r_{i} r_{i+1} r_{i+2} r_{i+3}=i \quad \text { for } 1 \leqslant i \leqslant k .
$$

Let $r_{1}=x, r_{2}=y, r_{3}=z$ be some distinct primes greater than $k$; the remaining terms satisfy $r_{4}=\frac{1}{r_{1} r_{2} r_{3}}$ and $r_{i+4}=\frac{i+1}{i} r_{i}$. It follows that if $r_{i}$ are represented as irreducible fractions, the numerators are divisible by $x$ for $i \equiv 1(\bmod 4)$, by $y$ for $i \equiv 2(\bmod 4)$, by $z$ for $i \equiv 3(\bmod 4)$ and by none for $i \equiv 0(\bmod 4)$. Notice that $r_{i}<r_{i+4}$; thus the sequences $r_{1}<r_{5}<r_{9}<\ldots$, $r_{2}<r_{6}<r_{10}<\ldots, r_{3}<r_{7}<r_{11}<\ldots, r_{4}<r_{8}<r_{12}<\ldots$ are increasing and have no common terms, that is, all $r_{i}$ are distinct.

If each $r_{i}$ is represented by an irreducible fraction $\frac{u_{i}}{v_{i}}$, choose a prime $p$ which divides neither $v_{i}, 1 \leqslant i \leqslant k+1$, nor $v_{i} v_{j}\left(r_{i}-r_{j}\right)=v_{j} u_{i}-v_{i} u_{j}$ for $i<j$, and define $a_{i}$ by the congruence $a_{i} v_{i} \equiv u_{i}(\bmod p)$. Since $r_{i} r_{i+1} r_{i+2} r_{i+3}=i$, we have

$$
\begin{aligned}
& i v_{i} v_{i+1} v_{i+2} v_{i+3}=r_{i} v_{i} r_{i+1} v_{i+1} r_{i+2} v_{i+2} r_{i+3} v_{i+3} \\
& \quad=u_{i} u_{i+1} u_{i+2} u_{i+3} \equiv a_{i} v_{i} a_{i+1} v_{i+1} a_{i+2} v_{i+2} a_{i+3} v_{i+3} \quad(\bmod p)
\end{aligned}
$$

and therefore $a_{i} a_{i+1} a_{i+2} a_{i+3} \equiv i(\bmod p)$ for $1 \leqslant i \leqslant k$.\\
If $a_{i} \equiv a_{j}(\bmod p)$, then $u_{i} v_{j} \equiv a_{i} v_{i} v_{j} \equiv u_{j} v_{i}(\bmod p)$, a contradiction.\\
Comment. One can explicitly express residues $b_{i} \equiv a_{1} a_{2} \cdot \ldots a_{i}(\bmod p)$ in terms of $b_{1}, b_{2}, b_{3}$ and $b_{0}=1$ :

$$
b_{i+3}=i(i-4)(i-8) \cdot \ldots \cdot(i-4 k+4) b_{r},
$$

where $i+3=4 k+r, 0 \leqslant r<4$. Then the numbers $a_{i}$ are found from the congruences $b_{i-1} a_{i} \equiv b_{i}$ $(\bmod p)$, and choosing $p$ so that $a_{i}$ are not congruent modulo $p$ is done in a way very similar to the above solution.",306,3
2020n2,"For each prime $p$, there is a kingdom of $p$-Landia consisting of $p$ islands numbered $1,2, \ldots, p$. Two distinct islands numbered $n$ and $m$ are connected by a bridge if and only if $p$ divides $\left(n^{2}-m+1\right)\left(m^{2}-n+1\right)$. The bridges may pass over each other, but cannot cross. Prove that for infinitely many $p$ there are two islands in $p$-Landia not connected by a chain of bridges.","We prove that for each prime $p>3$ dividing a number of the form $x^{2}-x+1$ with integer $x$ there are two unconnected islands in $p$-Landia.

For brevity's sake, when a bridge connects the islands numbered $m$ and $n$, we shall speak simply that it connects $m$ and $n$.

A bridge connects $m$ and $n$ if $n \equiv m^{2}+1(\bmod p)$ or $m \equiv n^{2}+1(\bmod p)$. If $m^{2}+1 \equiv n$ $(\bmod p)$, we draw an arrow starting at $m$ on the bridge connecting $m$ and $n$. Clearly only one arrow starts at $m$ if $m^{2}+1 \not \equiv m(\bmod p)$, and no arrows otherwise. The total number of bridges does not exceed the total number of arrows.

Suppose $x^{2}-x+1 \equiv 0(\bmod p)$. We may assume that $1 \leqslant x \leqslant p$; then there is no arrow starting at $x$. Since $(1-x)^{2}-(1-x)+1=x^{2}-x+1,(p+1-x)^{2}+1 \equiv(p+1-x)(\bmod p)$, and there is also no arrow starting at $p+1-x$. If $x=p+1-x$, that is, $x=\frac{p+1}{2}$, then $4\left(x^{2}-x+1\right)=p^{2}+3$ and therefore $x^{2}-x+1$ is not divisible by $p$. Thus the islands $x$ and $p+1-x$ are different, and no arrows start at either of them. It follows that the total number of bridges in $p$-Landia does not exceed $p-2$.

Let $1,2, \ldots, p$ be the vertices of a graph $G_{p}$, where an edge connects $m$ and $n$ if and only if there is a bridge between $m$ and $n$. The number of vertices of $G_{p}$ is $p$ and the number of edges is less than $p-1$. This means that the graph is not connected, which means that there are two islands not connected by a chain of bridges.

It remains to prove that there are infinitely many primes $p$ dividing $x^{2}-x+1$ for some integer $x$. Let $p_{1}, p_{2}, \ldots, p_{k}$ be any finite set of such primes. The number $\left(p_{1} p_{2} \cdot \ldots \cdot p_{k}\right)^{2}-p_{1} p_{2} \cdot \ldots \cdot p_{k}+1$ is greater than 1 and not divisible by any $p_{i}$; therefore it has another prime divisor with the required property.

",324,3
2020n7,"Let $\mathcal{S}$ be a set consisting of $n \geqslant 3$ positive integers, none of which is a sum of two other distinct members of $\mathcal{S}$. Prove that the elements of $\mathcal{S}$ may be ordered as $a_{1}, a_{2}, \ldots, a_{n}$ so that $a_{i}$ does not divide $a_{i-1}+a_{i+1}$ for all $i=2,3, \ldots, n-1$.","Common remarks. In all solutions, we call a set $\mathcal{S}$ of positive integers good if no its element is a sum of two other distinct members of $\mathcal{S}$. We will use the following simple observation.\\
Observation A. If $a, b$, and $c$ are three distinct elements of a good set $\mathcal{S}$ with $b>a, c$, then $b \nmid a+c$. Otherwise, since $b \neq a+c$, we would have $b \leqslant(a+c) / 2<\max \{a, c\}$.

We prove the following stronger statement.\\
Claim. Let $\mathcal{S}$ be a good set consisting of $n \geqslant 2$ positive integers. Then the elements of $\mathcal{S}$ may be ordered as $a_{1}, a_{2}, \ldots, a_{n}$ so that $a_{i} \nmid a_{i-1}+a_{i+1}$ and $a_{i} \nmid a_{i-1}-a_{i+1}$, for all $i=2,3, \ldots, n-1$.\\
Proof. Say that the ordering $a_{1}, \ldots, a_{n}$ of $\mathcal{S}$ is nice if it satisfies the required property.\\
We proceed by induction on $n$. The base case $n=2$ is trivial, as there are no restrictions on the ordering.

To perform the step of induction, suppose that $n \geqslant 3$. Let $a=\max \mathcal{S}$, and set $\mathcal{T}=\mathcal{S} \backslash\{a\}$. Use the inductive hypothesis to find a nice ordering $b_{1}, \ldots, b_{n-1}$ of $\mathcal{T}$. We will show that $a$ may be inserted into this sequence so as to reach a nice ordering of $\mathcal{S}$. In other words, we will show that there exists a $j \in\{1,2, \ldots, n\}$ such that the ordering

$$
N_{j}=\left(b_{1}, \ldots, b_{j-1}, a, b_{j}, b_{j+1}, \ldots, b_{n-1}\right)
$$

is nice.\\
Assume that, for some $j$, the ordering $N_{j}$ is not nice, so that some element $x$ in it divides either the sum or the difference of two adjacent ones. This did not happen in the ordering of $\mathcal{T}$, hence $x \in\left\{b_{j-1}, a, b_{j}\right\}$ (if, say, $b_{j-1}$ does not exist, then $x \in\left\{a, b_{j}\right\}$; a similar agreement is applied hereafter). But the case $x=a$ is impossible: $a$ cannot divide $b_{j-1}-b_{j}$, since $0<\left|b_{j-1}-b_{j}\right|<a$, while $a \nmid b_{j-1}+b_{j}$ by Observation A. Therefore $x \in\left\{b_{j-1}, b_{j}\right\}$. In this case, assign the number $x$ to the index $j$.

Suppose now that none of the $N_{j}$ is nice. Since there are $n$ possible indices $j$, and only $n-1$ elements in $\mathcal{T}$, one of those elements (say, $b_{k}$ ) is assigned to two different indices, which then should equal $k$ and $k+1$. This means that $b_{k}$ divides the numbers $b_{k-1}+\varepsilon_{1} a$ and $a+\varepsilon_{2} b_{k+1}$, for some signs $\varepsilon_{1}, \varepsilon_{2} \in\{-1,1\}$. But then

$$
b_{k-1} \equiv-\varepsilon_{1} a \equiv \varepsilon_{1} \varepsilon_{2} b_{k+1} \quad\left(\bmod b_{k}\right),
$$

and therefore $b_{k} \mid b_{k-1}-\varepsilon_{1} \varepsilon_{2} b_{k+1}$, which means that the ordering of $\mathcal{T}$ was not nice. This contradiction proves the step of induction.

",429,3
2019a2,"Let $u_{1}, u_{2}, \ldots, u_{2019}$ be real numbers satisfying

$$
u_{1}+u_{2}+\cdots+u_{2019}=0 \quad \text { and } \quad u_{1}^{2}+u_{2}^{2}+\cdots+u_{2019}^{2}=1
$$

Let $a=\min \left(u_{1}, u_{2}, \ldots, u_{2019}\right)$ and $b=\max \left(u_{1}, u_{2}, \ldots, u_{2019}\right)$. Prove that

$$
a b \leqslant-\frac{1}{2019}
$$","Notice first that $b>0$ and $a<0$. Indeed, since $\sum_{i=1}^{2019} u_{i}^{2}=1$, the variables $u_{i}$ cannot be all zero, and, since $\sum_{i=1}^{2019} u_{i}=0$, the nonzero elements cannot be all positive or all negative.

Let $P=\left\{i: u_{i}>0\right\}$ and $N=\left\{i: u_{i} \leqslant 0\right\}$ be the indices of positive and nonpositive elements in the sequence, and let $p=|P|$ and $n=|N|$ be the sizes of these sets; then $p+n=2019$. By the condition $\sum_{i=1}^{2019} u_{i}=0$ we have $0=\sum_{i=1}^{2019} u_{i}=\sum_{i \in P} u_{i}-\sum_{i \in N}\left|u_{i}\right|$, so


\begin{equation*}
\sum_{i \in P} u_{i}=\sum_{i \in N}\left|u_{i}\right| \tag{1}
\end{equation*}


After this preparation, estimate the sum of squares of the positive and nonpositive elements as follows:


\begin{align*}
& \sum_{i \in P} u_{i}^{2} \leqslant \sum_{i \in P} b u_{i}=b \sum_{i \in P} u_{i}=b \sum_{i \in N}\left|u_{i}\right| \leqslant b \sum_{i \in N}|a|=-n a b  \tag{2}\\
& \sum_{i \in N} u_{i}^{2} \leqslant \sum_{i \in N}|a| \cdot\left|u_{i}\right|=|a| \sum_{i \in N}\left|u_{i}\right|=|a| \sum_{i \in P} u_{i} \leqslant|a| \sum_{i \in P} b=-p a b \tag{3}
\end{align*}


The sum of these estimates is

$$
1=\sum_{i=1}^{2019} u_{i}^{2}=\sum_{i \in P} u_{i}^{2}+\sum_{i \in N} u_{i}^{2} \leqslant-(p+n) a b=-2019 a b
$$

that proves $a b \leqslant \frac{-1}{2019}$.\\
Comment 1. After observing $\sum_{i \in P} u_{i}^{2} \leqslant b \sum_{i \in P} u_{i}$ and $\sum_{i \in N} u_{i}^{2} \leqslant|a| \sum_{i \in P}\left|u_{i}\right|$, instead of $(2,3)$ an alternative continuation is

$$
|a b| \geqslant \frac{\sum_{i \in P} u_{i}^{2}}{\sum_{i \in P} u_{i}} \cdot \frac{\sum_{i \in N} u_{i}^{2}}{\sum_{i \in N}\left|u_{i}\right|}=\frac{\sum_{i \in P} u_{i}^{2}}{\left(\sum_{i \in P} u_{i}\right)^{2}} \sum_{i \in N} u_{i}^{2} \geqslant \frac{1}{p} \sum_{i \in N} u_{i}^{2}
$$

(by the AM-QM or the Cauchy-Schwarz inequality) and similarly $|a b| \geqslant \frac{1}{n} \sum_{i \in P} u_{i}^{2}$.\\
",265,3
2019a3,"Let $n \geqslant 3$ be a positive integer and let $\left(a_{1}, a_{2}, \ldots, a_{n}\right)$ be a strictly increasing sequence of $n$ positive real numbers with sum equal to 2 . Let $X$ be a subset of $\{1,2, \ldots, n\}$ such that the value of

$$
\left|1-\sum_{i \in X} a_{i}\right|
$$

is minimised. Prove that there exists a strictly increasing sequence of $n$ positive real numbers $\left(b_{1}, b_{2}, \ldots, b_{n}\right)$ with sum equal to 2 such that

$$
\sum_{i \in X} b_{i}=1 .
$$","Without loss of generality, assume $\sum_{i \in X} a_{i} \leqslant 1$, and we may assume strict inequality as otherwise $b_{i}=a_{i}$ works. Also, $X$ clearly cannot be empty.

If $n \in X$, add $\Delta$ to $a_{n}$, producing a sequence of $c_{i}$ with $\sum_{i \in X} c_{i}=\sum_{i \in X^{c}} c_{i}$, and then scale as described above to make the sum equal to 2. Otherwise, there is some $k$ with $k \in X$ and $k+1 \in X^{c}$. Let $\delta=a_{k+1}-a_{k}$.

\begin{itemize}
  \item If $\delta>\Delta$, add $\Delta$ to $a_{k}$ and then scale.
  \item If $\delta<\Delta$, then considering $X \cup\{k+1\} \backslash\{k\}$ contradicts $X$ being $\left(a_{i}\right)$-minimising.
  \item If $\delta=\Delta$, choose any $j \neq k, k+1$ (possible since $n \geqslant 3$ ), and any $\epsilon$ less than the least of $a_{1}$ and all the differences $a_{i+1}-a_{i}$. If $j \in X$ then add $\Delta-\epsilon$ to $a_{k}$ and $\epsilon$ to $a_{j}$, then scale; otherwise, add $\Delta$ to $a_{k}$ and $\epsilon / 2$ to $a_{k+1}$, and subtract $\epsilon / 2$ from $a_{j}$, then scale.
\end{itemize}
",164,2
2019a4,"Let $n \geqslant 2$ be a positive integer and $a_{1}, a_{2}, \ldots, a_{n}$ be real numbers such that

$$
a_{1}+a_{2}+\cdots+a_{n}=0
$$

Define the set $A$ by

$$
A=\left\{(i, j)\left|1 \leqslant i<j \leqslant n,\left|a_{i}-a_{j}\right| \geqslant 1\right\} .\right.
$$

Prove that, if $A$ is not empty, then

$$
\sum_{(i, j) \in A} a_{i} a_{j}<0 .
$$","Define sets $B$ and $C$ by

$$
\begin{aligned}
& B=\left\{(i, j)\left|1 \leqslant i, j \leqslant n,\left|a_{i}-a_{j}\right| \geqslant 1\right\},\right. \\
& C=\left\{(i, j)\left|1 \leqslant i, j \leqslant n,\left|a_{i}-a_{j}\right|<1\right\} .\right.
\end{aligned}
$$

We have

$$
\begin{aligned}
\sum_{(i, j) \in A} a_{i} a_{j} & =\frac{1}{2} \sum_{(i, j) \in B} a_{i} a_{j} \\
\sum_{(i, j) \in B} a_{i} a_{j} & =\sum_{1 \leqslant i, j \leqslant n} a_{i} a_{j}-\sum_{(i, j) \notin B} a_{i} a_{j}=0-\sum_{(i, j) \in C} a_{i} a_{j} .
\end{aligned}
$$

So it suffices to show that if $A$ (and hence $B$ ) are nonempty, then

$$
\sum_{(i, j) \in C} a_{i} a_{j}>0 .
$$

Partition the indices into sets $P, Q, R$, and $S$ such that

$$
\begin{array}{llrl}
P & =\left\{i \mid a_{i} \leqslant-1\right\} & R & =\left\{i \mid 0<a_{i}<1\right\} \\
Q & =\left\{i \mid-1<a_{i} \leqslant 0\right\} & S & =\left\{i \mid 1 \leqslant a_{i}\right\} .
\end{array}
$$

Then

$$
\sum_{(i, j) \in C} a_{i} a_{j} \geqslant \sum_{i \in P \cup S} a_{i}^{2}+\sum_{i, j \in Q \cup R} a_{i} a_{j}=\sum_{i \in P \cup S} a_{i}^{2}+\left(\sum_{i \in Q \cup R} a_{i}\right)^{2} \geqslant 0 .
$$

The first inequality holds because all of the positive terms in the RHS are also in the LHS, and all of the negative terms in the LHS are also in the RHS. The first inequality attains equality only if both sides have the same negative terms, which implies $\left|a_{i}-a_{j}\right|<1$ whenever $i, j \in Q \cup R$; the second inequality attains equality only if $P=S=\varnothing$. But then we would have $A=\varnothing$. So $A$ nonempty implies that the inequality holds strictly, as required.
",262,3
2019a5," Let $x_{1}, x_{2}, \ldots, x_{n}$ be different real numbers. Prove that $$
\sum_{1 \leqslant i \leqslant n} \prod_{j \neq i} \frac{1-x_{i} x_{j}}{x_{i}-x_{j}}= \begin{cases}0, & \text { if } n \text { is even } \\ 1, & \text { if } n \text { is odd }\end{cases}
$$","Common remarks. Let $G\left(x_{1}, x_{2}, \ldots, x_{n}\right)$ be the function of the $n$ variables $x_{1}, x_{2}, \ldots, x_{n}$ on the LHS of the required identity.

(Lagrange interpolation). Since both sides of the identity are rational functions, it suffices to prove it when all $x_{i} \notin\{ \pm 1\}$. Define

$$
f(t)=\prod_{i=1}^{n}\left(1-x_{i} t\right)
$$

and note that

$$
f\left(x_{i}\right)=\left(1-x_{i}^{2}\right) \prod_{j \neq i} 1-x_{i} x_{j} .
$$

Using the nodes $+1,-1, x_{1}, \ldots, x_{n}$, the Lagrange interpolation formula gives us the following expression for $f$ :

$$
\sum_{i=1}^{n} f\left(x_{i}\right) \frac{(x-1)(x+1)}{\left(x_{i}-1\right)\left(x_{i}+1\right)} \prod_{j \neq i} \frac{x-x_{j}}{x_{i}-x_{j}}+f(1) \frac{x+1}{1+1} \prod_{1 \leqslant i \leqslant n} \frac{x-x_{i}}{1-x_{i}}+f(-1) \frac{x-1}{-1-1} \prod_{1 \leqslant i \leqslant n} \frac{x-x_{i}}{1-x_{i}} .
$$

The coefficient of $t^{n+1}$ in $f(t)$ is 0 , since $f$ has degree $n$. The coefficient of $t^{n+1}$ in the above expression of $f$ is

$$
\begin{aligned}
0 & =\sum_{1 \leqslant i \leqslant n} \frac{f\left(x_{i}\right)}{\prod_{j \neq i}\left(x_{i}-x_{j}\right) \cdot\left(x_{i}-1\right)\left(x_{i}+1\right)}+\frac{f(1)}{\prod_{1 \leqslant j \leqslant n}\left(1-x_{j}\right) \cdot(1+1)}+\frac{f(-1)}{\prod_{1 \leqslant j \leqslant n}\left(-1-x_{j}\right) \cdot(-1-1)} \\
& =-G\left(x_{1}, \ldots, x_{n}\right)+\frac{1}{2}+\frac{(-1)^{n+1}}{2} .
\end{aligned}
$$


",163,2
2019a6,"A polynomial $P(x, y, z)$ in three variables with real coefficients satisfies the identities


\begin{equation*}
P(x, y, z)=P(x, y, x y-z)=P(x, z x-y, z)=P(y z-x, y, z) . \tag{*}
\end{equation*}


Prove that there exists a polynomial $F(t)$ in one variable such that

$$
P(x, y, z)=F\left(x^{2}+y^{2}+z^{2}-x y z\right) .
$$","Common remarks. The polynomial $x^{2}+y^{2}+z^{2}-x y z$ satisfies the condition (\textit{), so every polynomial of the form $F\left(x^{2}+y^{2}+z^{2}-x y z\right)$ does satisfy (}). We will use without comment the fact that two polynomials have the same coefficients if and only if they are equal as functions.

In the first two steps, we deal with any polynomial $P(x, y, z)$ satisfying $P(x, y, z)=$ $P(x, y, x y-z)$. Call such a polynomial weakly symmetric, and call a polynomial satisfying the full conditions in the problem symmetric.

Step 1. We start with the description of weakly symmetric polynomials. We claim that they are exactly the polynomials in $x, y$, and $z(x y-z)$. Clearly, all such polynomials are weakly symmetric. For the converse statement, consider $P_{1}(x, y, z):=P\left(x, y, z+\frac{1}{2} x y\right)$, which satisfies $P_{1}(x, y, z)=P_{1}(x, y,-z)$ and is therefore a polynomial in $x, y$, and $z^{2}$. This means that $P$ is a polynomial in $x, y$, and $\left(z-\frac{1}{2} x y\right)^{2}=-z(x y-z)+\frac{1}{4} x^{2} y^{2}$, and therefore a polynomial in $x, y$, and $z(x y-z)$.\\
Step 2. Suppose that $P$ is weakly symmetric. Consider the monomials in $P(x, y, z)$ of highest total degree. Our aim is to show that in each such monomial $\mu x^{a} y^{b} z^{c}$ we have $a, b \geqslant c$. Consider the expansion


\begin{equation*}
P(x, y, z)=\sum_{i, j, k} \mu_{i j k} x^{i} y^{j}(z(x y-z))^{k} \tag{1.1}
\end{equation*}


The maximal total degree of a summand in (1.1) is $m=\max _{i, j, k: \mu_{i j k} \neq 0}(i+j+3 k)$. Now, for any $i, j, k$ satisfying $i+j+3 k=m$ the summand $\mu_{i, j, k} x^{i} y^{j}(z(x y-z))^{k}$ has leading term of the form $\mu x^{i+k} y^{j+k} z^{k}$. No other nonzero summand in (1.1) may have a term of this form in its expansion, hence this term does not cancel in the whole sum. Therefore, $\operatorname{deg} P=m$, and the leading component of $P$ is exactly

$$
\sum_{i+j+3 k=m} \mu_{i, j, k} x^{i+k} y^{j+k} z^{k},
$$

and each summand in this sum satisfies the condition claimed above.\\
Step 3. We now prove the problem statement by induction on $m=\operatorname{deg} P$. For $m=0$ the claim is trivial. Consider now a symmetric polynomial $P$ with $\operatorname{deg} P>0$. By Step 2, each of its monomials $\mu x^{a} y^{b} z^{c}$ of the highest total degree satisfies $a, b \geqslant c$. Applying other weak symmetries, we obtain $a, c \geqslant b$ and $b, c \geqslant a$; therefore, $P$ has a unique leading monomial of the form $\mu(x y z)^{c}$. The polynomial $P_{0}(x, y, z)=P(x, y, z)-\mu\left(x y z-x^{2}-y^{2}-z^{2}\right)^{c}$ has smaller total degree. Since $P_{0}$ is symmetric, it is representable as a polynomial function of $x y z-x^{2}-y^{2}-z^{2}$. Then $P$ is also of this form, completing the inductive step.

",449,3
2019a7,"Let $\mathbb{Z}$ be the set of integers. We consider functions $f: \mathbb{Z} \rightarrow \mathbb{Z}$ satisfying

$$
f(f(x+y)+y)=f(f(x)+y)
$$

for all integers $x$ and $y$. For such a function, we say that an integer $v$ is $f$-rare if the set

$$
X_{v}=\{x \in \mathbb{Z}: f(x)=v\}
$$

is finite and nonempty.\\
(a) Prove that there exists such a function $f$ for which there is an $f$-rare integer.\\
(b) Prove that no such function $f$ can have more than one $f$-rare integer.","a) Let $f$ be the function where $f(0)=0$ and $f(x)$ is the largest power of 2 dividing $2 x$ for $x \neq 0$. The integer 0 is evidently $f$-rare, so it remains to verify the functional equation.

Since $f(2 x)=2 f(x)$ for all $x$, it suffices to verify the functional equation when at least one of $x$ and $y$ is odd (the case $x=y=0$ being trivial). If $y$ is odd, then we have

$$
f(f(x+y)+y)=2=f(f(x)+y)
$$

since all the values attained by $f$ are even. If, on the other hand, $x$ is odd and $y$ is even, then we already have

$$
f(x+y)=2=f(x)
$$

from which the functional equation follows immediately.\\
b) An easy inductive argument (substituting $x+k y$ for $x$ ) shows that


\begin{equation*}
f(f(x+k y)+y)=f(f(x)+y) \tag{*}
\end{equation*}


for all integers $x, y$ and $k$. If $v$ is an $f$-rare integer and $a$ is the least element of $X_{v}$, then by substituting $y=a-f(x)$ in the above, we see that

$$
f(x+k \cdot(a-f(x)))-f(x)+a \in X_{v}
$$

for all integers $x$ and $k$, so that in particular

$$
f(x+k \cdot(a-f(x))) \geqslant f(x)
$$

for all integers $x$ and $k$, by assumption on $a$. This says that on the (possibly degenerate) arithmetic progression through $x$ with common difference $a-f(x)$, the function $f$ attains its minimal value at $x$.

Repeating the same argument with $a$ replaced by the greatest element $b$ of $X_{v}$ shows that

$$
f(x+k \cdot(b-f(x)) \leqslant f(x)
$$

for all integers $x$ and $k$. Combined with the above inequality, we therefore have


\begin{equation*}
f(x+k \cdot(a-f(x)) \cdot(b-f(x)))=f(x) \tag{$\dagger$}
\end{equation*}


for all integers $x$ and $k$.\\
Thus if $f(x) \neq a, b$, then the set $X_{f(x)}$ contains a nondegenerate arithmetic progression, so is infinite. So the only possible $f$-rare integers are $a$ and $b$.

In particular, the $f$-rare integer $v$ we started with must be one of $a$ or $b$, so that $f(v)=$ $f(a)=f(b)=v$. This means that there cannot be any other $f$-rare integers $v^{\prime}$, as they would on the one hand have to be either $a$ or $b$, and on the other would have to satisfy $f\left(v^{\prime}\right)=v^{\prime}$. Thus $v$ is the unique $f$-rare integer.

",353,3
2019c1,"The infinite sequence $a_{0}, a_{1}, a_{2}, \ldots$ of (not necessarily different) integers has the following properties: $0 \leqslant a_{i} \leqslant i$ for all integers $i \geqslant 0$, and

$$
\binom{k}{a_{0}}+\binom{k}{a_{1}}+\cdots+\binom{k}{a_{k}}=2^{k}
$$

for all integers $k \geqslant 0$.\\
Prove that all integers $N \geqslant 0$ occur in the sequence (that is, for all $N \geqslant 0$, there exists $i \geqslant 0$ with $a_{i}=N$ ).","Solution. We prove by induction on $k$ that every initial segment of the sequence, $a_{0}, a_{1}, \ldots, a_{k}$, consists of the following elements (counted with multiplicity, and not necessarily in order), for some $\ell \geqslant 0$ with $2 \ell \leqslant k+1$ :

$$
0,1, \ldots, \ell-1, \quad 0,1, \ldots, k-\ell .
$$

For $k=0$ we have $a_{0}=0$, which is of this form. Now suppose that for $k=m$ the elements $a_{0}, a_{1}, \ldots, a_{m}$ are $0,0,1,1,2,2, \ldots, \ell-1, \ell-1, \ell, \ell+1, \ldots, m-\ell-1, m-\ell$ for some $\ell$ with $0 \leqslant 2 \ell \leqslant m+1$. It is given that

$$
\binom{m+1}{a_{0}}+\binom{m+1}{a_{1}}+\cdots+\binom{m+1}{a_{m}}+\binom{m+1}{a_{m+1}}=2^{m+1},
$$

which becomes

$$
\begin{aligned}
\left(\binom{m+1}{0}+\binom{m+1}{1}\right. & \left.+\cdots+\binom{m+1}{\ell-1}\right) \\
& +\left(\binom{m+1}{0}+\binom{m+1}{1}+\cdots+\binom{m+1}{m-\ell}\right)+\binom{m+1}{a_{m+1}}=2^{m+1}
\end{aligned}
$$

or, using $\binom{m+1}{i}=\binom{m+1}{m+1-i}$, that

$$
\begin{aligned}
\left(\binom{m+1}{0}+\binom{m+1}{1}\right. & \left.+\cdots+\binom{m+1}{\ell-1}\right) \\
& +\left(\binom{m+1}{m+1}+\binom{m+1}{m}+\cdots+\binom{m+1}{\ell+1}\right)+\binom{m+1}{a_{m+1}}=2^{m+1}
\end{aligned}
$$

On the other hand, it is well known that

$$
\binom{m+1}{0}+\binom{m+1}{1}+\cdots+\binom{m+1}{m+1}=2^{m+1}
$$

and so, by subtracting, we get

$$
\binom{m+1}{a_{m+1}}=\binom{m+1}{\ell} .
$$

From this, using the fact that the binomial coefficients $\binom{m+1}{i}$ are increasing for $i \leqslant \frac{m+1}{2}$ and decreasing for $i \geqslant \frac{m+1}{2}$, we conclude that either $a_{m+1}=\ell$ or $a_{m+1}=m+1-\ell$. In either case, $a_{0}, a_{1}, \ldots, a_{m+1}$ is again of the claimed form, which concludes the induction.

As a result of this description, any integer $N \geqslant 0$ appears as a term of the sequence $a_{i}$ for some $0 \leqslant i \leqslant 2 N$.",221,2
2019c2,"You are given a set of $n$ blocks, each weighing at least 1 ; their total weight is $2 n$. Prove that for every real number $r$ with $0 \leqslant r \leqslant 2 n-2$ you can choose a subset of the blocks whose total weight is at least $r$ but at most $r+2$.","We prove the following more general statement by induction on $n$.\\
Claim. Suppose that you have $n$ blocks, each of weight at least 1 , and of total weight $s \leqslant 2 n$. Then for every $r$ with $-2 \leqslant r \leqslant s$, you can choose some of the blocks whose total weight is at least $r$ but at most $r+2$.\\
Proof. The base case $n=1$ is trivial. To prove the inductive step, let $x$ be the largest block weight. Clearly, $x \geqslant s / n$, so $s-x \leqslant \frac{n-1}{n} s \leqslant 2(n-1)$. Hence, if we exclude a block of weight $x$, we can apply the inductive hypothesis to show the claim holds (for this smaller set) for any $-2 \leqslant r \leqslant s-x$. Adding the excluded block to each of those combinations, we see that the claim also holds when $x-2 \leqslant r \leqslant s$. So if $x-2 \leqslant s-x$, then we have covered the whole interval $[-2, s]$. But each block weight is at least 1 , so we have $x-2 \leqslant(s-(n-1))-2=s-(2 n-(n-1)) \leqslant s-(s-(n-1)) \leqslant s-x$, as desired.

",181,2
2019c5,"On a certain social network, there are 2019 users, some pairs of which are friends, where friendship is a symmetric relation. Initially, there are 1010 people with 1009 friends each and 1009 people with 1010 friends each. However, the friendships are rather unstable, so events of the following kind may happen repeatedly, one at a time:

Let $A, B$, and $C$ be people such that $A$ is friends with both $B$ and $C$, but $B$ and $C$ are not friends; then $B$ and $C$ become friends, but $A$ is no longer friends with them.

Prove that, regardless of the initial friendships, there exists a sequence of such events after which each user is friends with at most one other user.\\
(Croatia)","Common remarks. The problem has an obvious rephrasing in terms of graph theory. One is given a graph $G$ with 2019 vertices, 1010 of which have degree 1009 and 1009 of which have degree 1010. One is allowed to perform operations on $G$ of the following kind:

Suppose that vertex $A$ is adjacent to two distinct vertices $B$ and $C$ which are not adjacent to each other. Then one may remove the edges $A B$ and $A C$ from $G$ and add the edge $B C$ into $G$.

Call such an operation a refriending. One wants to prove that, via a sequence of such refriendings, one can reach a graph which is a disjoint union of single edges and vertices.

All of the solutions presented below will use this reformulation.\\
Note that the given graph is connected, since the total degree of any two vertices is at least 2018 and hence they are either adjacent or have at least one neighbour in common. Hence the given graph satisfies the following condition:

Every connected component of $G$ with at least three vertices is not complete and has a vertex of odd degree.

We will show that if a graph $G$ satisfies condition (1) and has a vertex of degree at least 2 , then there is a refriending on $G$ that preserves condition (1). Since refriendings decrease the total number of edges of $G$, by using a sequence of such refriendings, we must reach a graph $G$ with maximal degree at most 1 , so we are done.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_c4214a078eb1790cb0a3g-041}

Pick a vertex $A$ of degree at least 2 in a connected component $G^{\prime}$ of $G$. Since no component of $G$ with at least three vertices is complete we may assume that not all of the neighbours of $A$ are adjacent to one another. (For example, pick a maximal complete subgraph $K$ of $G^{\prime}$. Some vertex $A$ of $K$ has a neighbour outside $K$, and this neighbour is not adjacent to every vertex of $K$ by maximality.) Removing $A$ from $G$ splits $G^{\prime}$ into smaller connected components $G_{1}, \ldots, G_{k}$ (possibly with $k=1$ ), to each of which $A$ is connected by at least one edge. We divide into several cases.

Case 1: $k \geqslant 2$ and $A$ is connected to some $G_{i}$ by at least two edges.\\
Choose a vertex $B$ of $G_{i}$ adjacent to $A$, and a vertex $C$ in another component $G_{j}$ adjacent to $A$. The vertices $B$ and $C$ are not adjacent, and hence removing edges $A B$ and $A C$ and adding in edge $B C$ does not disconnect $G^{\prime}$. It is easy to see that this preserves the condition, since the refriending does not change the parity of the degrees of vertices.

Case 2: $k \geqslant 2$ and $A$ is connected to each $G_{i}$ by exactly one edge.\\
Consider the induced subgraph on any $G_{i}$ and the vertex $A$. The vertex $A$ has degree 1 in this subgraph; since the number of odd-degree vertices of a graph is always even, we see that $G_{i}$ has a vertex of odd degree (in $G$ ). Thus if we let $B$ and $C$ be any distinct neighbours of $A$, then removing edges $A B$ and $A C$ and adding in edge $B C$ preserves the above condition: the refriending creates two new components, and if either of these components has at least three vertices, then it cannot be complete and must contain a vertex of odd degree (since each $G_{i}$ does).

Case 3: $k=1$ and $A$ is connected to $G_{1}$ by at least three edges.\\
By assumption, $A$ has two neighbours $B$ and $C$ which are not adjacent to one another. Removing edges $A B$ and $A C$ and adding in edge $B C$ does not disconnect $G^{\prime}$. We are then done as in Case 1.

Case 4: $k=1$ and $A$ is connected to $G_{1}$ by exactly two edges.\\
Let $B$ and $C$ be the two neighbours of $A$, which are not adjacent. Removing edges $A B$ and $A C$ and adding in edge $B C$ results in two new components: one consisting of a single vertex; and the other containing a vertex of odd degree. We are done unless this second component would be a complete graph on at least 3 vertices. But in this case, $G_{1}$ would be a complete graph minus the single edge $B C$, and hence has at least 4 vertices since $G^{\prime}$ is not a 4-cycle. If we let $D$ be a third vertex of $G_{1}$, then removing edges $B A$ and $B D$ and adding in edge $A D$ does not disconnect $G^{\prime}$. We are then done as in Case 1.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_c4214a078eb1790cb0a3g-042}

",784,4
2019c6,"Let $n>1$ be an integer. Suppose we are given $2 n$ points in a plane such that no three of them are collinear. The points are to be labelled $A_{1}, A_{2}, \ldots, A_{2 n}$ in some order. We then consider the $2 n$ angles $\angle A_{1} A_{2} A_{3}, \angle A_{2} A_{3} A_{4}, \ldots, \angle A_{2 n-2} A_{2 n-1} A_{2 n}, \angle A_{2 n-1} A_{2 n} A_{1}$, $\angle A_{2 n} A_{1} A_{2}$. We measure each angle in the way that gives the smallest positive value (i.e. between $0^{\circ}$ and $180^{\circ}$ ). Prove that there exists an ordering of the given points such that the resulting $2 n$ angles can be separated into two groups with the sum of one group of angles equal to the sum of the other group.","Let $\ell$ be a line separating the points into two groups ( $L$ and $R$ ) with $n$ points in each. Label the points $A_{1}, A_{2}, \ldots, A_{2 n}$ so that $L=\left\{A_{1}, A_{3}, \ldots, A_{2 n-1}\right\}$. We claim that this labelling works.

Take a line $s=A_{2 n} A_{1}$.\\
(a) Rotate $s$ around $A_{1}$ until it passes through $A_{2}$; the rotation is performed in a direction such that $s$ is never parallel to $\ell$.\\
(b) Then rotate the new $s$ around $A_{2}$ until it passes through $A_{3}$ in a similar manner.\\
(c) Perform $2 n-2$ more such steps, after which $s$ returns to its initial position.

The total (directed) rotation angle $\Theta$ of $s$ is clearly a multiple of $180^{\circ}$. On the other hand, $s$ was never parallel to $\ell$, which is possible only if $\Theta=0$. Now it remains to partition all the $2 n$ angles into those where $s$ is rotated anticlockwise, and the others.

",155,2
2019c8,"Alice has a map of Wonderland, a country consisting of $n \geqslant 2$ towns. For every pair of towns, there is a narrow road going from one town to the other. One day, all the roads are declared to be ""one way"" only. Alice has no information on the direction of the roads, but the King of Hearts has offered to help her. She is allowed to ask him a number of questions. For each question in turn, Alice chooses a pair of towns and the King of Hearts tells her the direction of the road connecting those two towns.

Alice wants to know whether there is at least one town in Wonderland with at most one outgoing road. Prove that she can always find out by asking at most $4 n$ questions.","Solution. We will show Alice needs to ask at most $4 n-7$ questions. Her strategy has the following phases. In what follows, $S$ is the set of towns that Alice, so far, does not know to have more than one outgoing road (so initially $|S|=n$ ).

Phase 1. Alice chooses any two towns, say $A$ and $B$. Without loss of generality, suppose that the King of Hearts' answer is that the road goes from $A$ to $B$.

At the end of this phase, Alice has asked 1 question.\\
Phase 2. During this phase there is a single (variable) town $T$ that is known to have at least one incoming road but not yet known to have any outgoing roads. Initially, $T$ is $B$. Alice does the following $n-2$ times: she picks a town $X$ she has not asked about before, and asks the direction of the road between $T$ and $X$. If it is from $X$ to $T, T$ is unchanged; if it is from $T$ to $X, X$ becomes the new choice of town $T$, as the previous $T$ is now known to have an outgoing road.

At the end of this phase, Alice has asked a total of $n-1$ questions. The final town $T$ is not yet known to have any outgoing roads, while every other town has exactly one outgoing road known. The undirected graph of roads whose directions are known is a tree.

Phase 3. During this phase, Alice asks about the directions of all roads between $T$ and another town she has not previously asked about, stopping if she finds two outgoing roads from $T$. This phase involves at most $n-2$ questions. If she does not find two outgoing roads from $T$, she has answered her original question with at most $2 n-3 \leqslant 4 n-7$ questions, so in what follows we suppose that she does find two outgoing roads, asking a total of $k$ questions in this phase, where $2 \leqslant k \leqslant n-2$ (and thus $n \geqslant 4$ for what follows).

For every question where the road goes towards $T$, the town at the other end is removed from $S$ (as it already had one outgoing road known), while the last question resulted in $T$ being removed from $S$. So at the end of this phase, $|S|=n-k+1$, while a total of $n+k-1$ questions have been asked. Furthermore, the undirected graph of roads within $S$ whose directions are known contains no cycles (as $T$ is no longer a member of $S$, all questions asked in this phase involved $T$ and the graph was a tree before this phase started). Every town in $S$ has exactly one outgoing road known (not necessarily to another town in $S$ ).

Phase 4. During this phase, Alice repeatedly picks any pair of towns in $S$ for which she does not know the direction of the road between them. Because every town in $S$ has exactly one outgoing road known, this always results in the removal of one of those two towns from $S$. Because there are no cycles in the graph of roads of known direction within $S$, this can continue until there are at most 2 towns left in $S$.

If it ends with $t$ towns left, $n-k+1-t$ questions were asked in this phase, so a total of $2 n-t$ questions have been asked.

Phase 5. During this phase, Alice asks about all the roads from the remaining towns in $S$ that she has not previously asked about. She has definitely already asked about any road between those towns (if $t=2$ ). She must also have asked in one of the first two phases about\\
at least one other road involving one of those towns (as those phases resulted in a tree with $n>2$ vertices). So she asks at most $t(n-t)-1$ questions in this phase.

At the end of this phase, Alice knows whether any town has at most one outgoing road. If $t=1$, at most $3 n-3 \leqslant 4 n-7$ questions were needed in total, while if $t=2$, at most $4 n-7$ questions were needed in total.

Comment 1. The version of this problem originally submitted asked only for an upper bound of $5 n$, which is much simpler to prove. The Problem Selection Committee preferred a version with an asymptotically optimal constant. In the following comment, we will show that the constant is optimal.

Comment 2. We will show that Alice cannot always find out by asking at most $4 n-3\left(\log _{2} n\right)-$ 15 questions, if $n \geqslant 8$.

To show this, we suppose the King of Hearts is choosing the directions as he goes along, only picking the direction of a road when Alice asks about it for the first time. We provide a strategy for the King of Hearts that ensures that, after the given number of questions, the map is still consistent both with the existence of a town with at most one outgoing road, and with the nonexistence of such a town. His strategy has the following phases. When describing how the King of Hearts' answer to a question is determined below, we always assume he is being asked about a road for the first time (otherwise, he just repeats his previous answer for that road). This strategy is described throughout in graph-theoretic terms (vertices and edges rather than towns and roads).

Phase 1. In this phase, we consider the undirected graph formed by edges whose directions are known. The phase terminates when there are exactly 8 connected components whose undirected graphs are trees. The following invariant is maintained: in a component with $k$ vertices whose undirected graph is a tree, every vertex has at most $\left[\log _{2} k\right\rfloor$ edges into it.

\begin{itemize}
  \item If the King of Hearts is asked about an edge between two vertices in the same component, or about an edge between two components at least one of which is not a tree, he chooses any direction for that edge arbitrarily.
  \item If he is asked about an edge between a vertex in component $A$ that has $a$ vertices and is a tree and a vertex in component $B$ that has $b$ vertices and is a tree, suppose without loss of generality that $a \geqslant b$. He then chooses the edge to go from $A$ to $B$. In this case, the new number of edges into any vertex is at most $\max \left\{\left\lfloor\log _{2} a\right\rfloor,\left\lfloor\log _{2} b\right\rfloor+1\right\} \leqslant\left\lfloor\log _{2}(a+b)\right\rfloor$.
\end{itemize}

In all cases, the invariant is preserved, and the number of tree components either remains unchanged or goes down by 1. Assuming Alice does not repeat questions, the process must eventually terminate with 8 tree components, and at least $n-8$ questions having been asked.

Note that each tree component contains at least one vertex with no outgoing edges. Colour one such vertex in each tree component red.

Phase 2. Let $V_{1}, V_{2}$ and $V_{3}$ be the three of the red vertices whose components are smallest (so their components together have at most $\left\lfloor\frac{3}{8} n\right\rfloor$ vertices, with each component having at most $\left\lfloor\frac{3}{8} n-2\right\rfloor$ vertices). Let sets $C_{1}, C_{2}, \ldots$ be the connected components after removing the $V_{j}$. By construction, there are no edges with known direction between $C_{i}$ and $C_{j}$ for $i \neq j$, and there are at least five such components.

If at any point during this phase, the King of Hearts is asked about an edge within one of the $C_{i}$, he chooses an arbitrary direction. If he is asked about an edge between $C_{i}$ and $C_{j}$ for $i \neq j$, he answers so that all edges go from $C_{i}$ to $C_{i+1}$ and $C_{i+2}$, with indices taken modulo the number of components, and chooses arbitrarily for other pairs. This ensures that all vertices other than the $V_{j}$ will have more than one outgoing edge.

For edges involving one of the $V_{j}$ he answers as follows, so as to remain consistent for as long as possible with both possibilities for whether one of those vertices has at most one outgoing edge. Note that as they were red vertices, they have no outgoing edges at the start of this phase. For edges between two of the $V_{j}$, he answers that the edges go from $V_{1}$ to $V_{2}$, from $V_{2}$ to $V_{3}$ and from $V_{3}$ to $V_{1}$. For edges between $V_{j}$ and some other vertex, he always answers that the edge goes into $V_{j}$, except for the last such edge for which he is asked the question for any given $V_{j}$, for which he answers that the\\
edge goes out of $V_{j}$. Thus, as long as at least one of the $V_{j}$ has not had the question answered for all the vertices that are not among the $V_{j}$, his answers are still compatible both with all vertices having more than one outgoing edge, and with that $V_{j}$ having only one outgoing edge.

At the start of this phase, each of the $V_{j}$ has at most $\left\lfloor\log _{2}\left\lfloor\frac{3}{8} n-2\right\rfloor\right\rfloor<\left(\log _{2} n\right)-1$ incoming edges. Thus, Alice cannot determine whether some vertex has only one outgoing edge within $3(n-$ $\left.3-\left(\left(\log _{2} n\right)-1\right)\right)-1$ questions in this phase; that is, $4 n-3\left(\log _{2} n\right)-15$ questions total.

Comment 3. We can also improve the upper bound slightly, to $4 n-2\left(\log _{2} n\right)+1$. (We do not know where the precise minimum number of questions lies between $4 n-3\left(\log _{2} n\right)+O(1)$ and $4 n-2\left(\log _{2} n\right)+$ $O(1)$.$) Suppose n \geqslant 5$ (otherwise no questions are required at all).

To do this, we replace Phases 1 and 2 of the given solution with a different strategy that also results in a spanning tree where one vertex $V$ is not known to have any outgoing edges, and all other vertices have exactly one outgoing edge known, but where there is more control over the numbers of incoming edges. In Phases 3 and 4 we then take more care about the order in which pairs of towns are chosen, to ensure that each of the remaining towns has already had a question asked about at least $\log _{2} n+O(1)$ edges.

Define trees $T_{m}$ with $2^{m}$ vertices, exactly one of which (the root) has no outgoing edges and the rest of which have exactly one outgoing edge, as follows: $T_{0}$ is a single vertex, while $T_{m}$ is constructed by joining the roots of two copies of $T_{m-1}$ with an edge in either direction. If $n=2^{m}$ we can readily ask $n-1$ questions, resulting in a tree $T_{m}$ for the edges with known direction: first ask about $2^{m-1}$ disjoint pairs of vertices, then about $2^{m-2}$ disjoint pairs of the roots of the resulting $T_{1}$ trees, and so on. For the general case, where $n$ is not a power of 2 , after $k$ stages of this process we have $\left\lfloor n / 2^{k}\right\rfloor$ trees, each of which is like $T_{k}$ but may have some extra vertices (but, however, a unique root). If there are an even number of trees, then ask about pairs of their roots. If there are an odd number (greater than 1) of trees, when a single $T_{k}$ is left over, ask about its root together with that of one of the $T_{k+1}$ trees.

Say $m=\left\lfloor\log _{2} n\right\rfloor$. The result of that process is a single $T_{m}$ tree, possibly with some extra vertices but still a unique root $V$. That root has at least $m$ incoming edges, and we may list vertices $V_{0}$, $\ldots, V_{m-1}$ with edges to $V$, such that, for all $0 \leqslant i<m$, vertex $V_{i}$ itself has at least $i$ incoming edges.

Now divide the vertices other than $V$ into two parts: $A$ has all vertices at an odd distance from $V$ and $B$ has all the vertices at an even distance from $B$. Both $A$ and $B$ are nonempty; $A$ contains the $V_{i}$, while $B$ contains a sequence of vertices with at least $0,1, \ldots, m-2$ incoming edges respectively, similar to the $V_{i}$. There are no edges with known direction within $A$ or within $B$.

In Phase 3, then ask about edges between $V$ and other vertices: first those in $B$, in order of increasing number of incoming edges to the other vertex, then those in $A$, again in order of increasing number of incoming edges, which involves asking at most $n-1-m$ questions in this phase. If two outgoing edges are not found from $V$, at most $2 n-2-m \leqslant 4 n-2\left(\log _{2} n\right)+1$ questions needed to be asked in total, so we suppose that two outgoing edges were found, with $k$ questions asked in this phase, where $2 \leqslant k \leqslant n-1-m$. The state of $S$ is as described in the solution above, with the additional property that, since $S$ must still contain all vertices with edges to $V$, it contains the vertices $V_{i}$ described above.

In Phase 4, consider the vertices left in $B$, in increasing order of number of edges incoming to a vertex. If $s$ is the least number of incoming edges to such a vertex, then, for any $s \leqslant t \leqslant m-2$, there are at least $m-t-2$ vertices with more than $t$ incoming edges. Repeatedly asking about the pair of vertices left in $B$ with the least numbers of incoming edges results in a single vertex left over (if any were in $B$ at all at the start of this phase) with at least $m-2$ incoming edges. Doing the same with $A$ (which must be nonempty) leaves a vertex with at least $m-1$ incoming edges.

Thus if only $A$ is nonempty we ask at most $n-m$ questions in Phase 5 , so in total at most $3 n-m-1$ questions, while if both are nonempty we ask at most $2 n-2 m+1$ questions in Phase 5 , so in total at most $4 n-2 m-1<4 n-2\left(\log _{2} n\right)+1$ questions.",2289,4
2019g1,"Let $A B C$ be a triangle. Circle $\Gamma$ passes through $A$, meets segments $A B$ and $A C$ again at points $D$ and $E$ respectively, and intersects segment $B C$ at $F$ and $G$ such that $F$ lies between $B$ and $G$. The tangent to circle $B D F$ at $F$ and the tangent to circle $C E G$ at $G$ meet at point $T$. Suppose that points $A$ and $T$ are distinct. Prove that line $A T$ is parallel to $B C$.","Solution. Notice that $\angle T F B=\angle F D A$ because $F T$ is tangent to circle $B D F$, and moreover $\angle F D A=\angle C G A$ because quadrilateral $A D F G$ is cyclic. Similarly, $\angle T G B=\angle G E C$ because $G T$ is tangent to circle $C E G$, and $\angle G E C=\angle C F A$. Hence,


\begin{equation*}
\angle T F B=\angle C G A \text { and } \angle T G B=\angle C F A . \tag{1}
\end{equation*}


\begin{center}
\includegraphics[max width=\textwidth]{2025_04_29_c4214a078eb1790cb0a3g-058}
\end{center}

Triangles $F G A$ and $G F T$ have a common side $F G$, and by (1) their angles at $F, G$ are the same. So, these triangles are congruent. So, their altitudes starting from $A$ and $T$, respectively, are equal and hence $A T$ is parallel to line $B F G C$.

Comment. Alternatively, we can prove first that $T$ lies on $\Gamma$. For example, this can be done by showing that $\angle A F T=\angle A G T$ using (1). Then the statement follows as $\angle T A F=\angle T G F=\angle G F A$.",187,2
2019g2,"Let $A B C$ be an acute-angled triangle and let $D, E$, and $F$ be the feet of altitudes from $A, B$, and $C$ to sides $B C, C A$, and $A B$, respectively. Denote by $\omega_{B}$ and $\omega_{C}$ the incircles of triangles $B D F$ and $C D E$, and let these circles be tangent to segments $D F$ and $D E$ at $M$ and $N$, respectively. Let line $M N$ meet circles $\omega_{B}$ and $\omega_{C}$ again at $P \neq M$ and $Q \neq N$, respectively. Prove that $M P=N Q$.","Solution. Denote the centres of $\omega_{B}$ and $\omega_{C}$ by $O_{B}$ and $O_{C}$, let their radii be $r_{B}$ and $r_{C}$, and let $B C$ be tangent to the two circles at $T$ and $U$, respectively.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_c4214a078eb1790cb0a3g-059}

From the cyclic quadrilaterals $A F D C$ and $A B D E$ we have

$$
\angle M D O_{B}=\frac{1}{2} \angle F D B=\frac{1}{2} \angle B A C=\frac{1}{2} \angle C D E=\angle O_{C} D N,
$$

so the right-angled triangles $D M O_{B}$ and $D N O_{C}$ are similar. The ratio of similarity between the two triangles is

$$
\frac{D N}{D M}=\frac{O_{C} N}{O_{B} M}=\frac{r_{C}}{r_{B}} .
$$

Let $\varphi=\angle D M N$ and $\psi=\angle M N D$. The lines $F M$ and $E N$ are tangent to $\omega_{B}$ and $\omega_{C}$, respectively, so

$$
\angle M T P=\angle F M P=\angle D M N=\varphi \quad \text { and } \quad \angle Q U N=\angle Q N E=\angle M N D=\psi .
$$

(It is possible that $P$ or $Q$ coincides with $T$ or $U$, or lie inside triangles $D M T$ or $D U N$, respectively. To reduce case-sensitivity, we may use directed angles or simply ignore angles $M T P$ and $Q U N$.)

In the circles $\omega_{B}$ and $\omega_{C}$ the lengths of chords $M P$ and $N Q$ are

$$
M P=2 r_{B} \cdot \sin \angle M T P=2 r_{B} \cdot \sin \varphi \quad \text { and } \quad N Q=2 r_{C} \cdot \sin \angle Q U N=2 r_{C} \cdot \sin \psi .
$$

By applying the sine rule to triangle $D N M$ we get

$$
\frac{D N}{D M}=\frac{\sin \angle D M N}{\sin \angle M N D}=\frac{\sin \varphi}{\sin \psi} .
$$

Finally, putting the above observations together, we get

$$
\frac{M P}{N Q}=\frac{2 r_{B} \sin \varphi}{2 r_{C} \sin \psi}=\frac{r_{B}}{r_{C}} \cdot \frac{\sin \varphi}{\sin \psi}=\frac{D M}{D N} \cdot \frac{\sin \varphi}{\sin \psi}=\frac{\sin \psi}{\sin \varphi} \cdot \frac{\sin \varphi}{\sin \psi}=1,
$$

so $M P=N Q$ as required.",320,3
2019g3,"In triangle $A B C$, let $A_{1}$ and $B_{1}$ be two points on sides $B C$ and $A C$, and let $P$ and $Q$ be two points on segments $A A_{1}$ and $B B_{1}$, respectively, so that line $P Q$ is parallel to $A B$. On ray $P B_{1}$, beyond $B_{1}$, let $P_{1}$ be a point so that $\angle P P_{1} C=\angle B A C$. Similarly, on ray $Q A_{1}$, beyond $A_{1}$, let $Q_{1}$ be a point so that $\angle C Q_{1} Q=\angle C B A$. Show that points $P, Q, P_{1}$, and $Q_{1}$ are concyclic.","Throughout the solution we use oriented angles.\\
Let rays $A A_{1}$ and $B B_{1}$ intersect the circumcircle of $\triangle A C B$ at $A_{2}$ and $B_{2}$, respectively. By

$$
\angle Q P A_{2}=\angle B A A_{2}=\angle B B_{2} A_{2}=\angle Q B_{2} A_{2},
$$

points $P, Q, A_{2}, B_{2}$ are concyclic; denote the circle passing through these points by $\omega$. We shall prove that $P_{1}$ and $Q_{1}$ also lie on $\omega$.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_c4214a078eb1790cb0a3g-060}

By

$$
\angle C A_{2} A_{1}=\angle C A_{2} A=\angle C B A=\angle C Q_{1} Q=\angle C Q_{1} A_{1},
$$

points $C, Q_{1}, A_{2}, A_{1}$ are also concyclic. From that we get

$$
\angle Q Q_{1} A_{2}=\angle A_{1} Q_{1} A_{2}=\angle A_{1} C A_{2}=\angle B C A_{2}=\angle B A A_{2}=\angle Q P A_{2},
$$

so $Q_{1}$ lies on $\omega$.\\
It follows similarly that $P_{1}$ lies on $\omega$.\\
",138,2
2019g4,"Let $P$ be a point inside triangle $A B C$. Let $A P$ meet $B C$ at $A_{1}$, let $B P$ meet $C A$ at $B_{1}$, and let $C P$ meet $A B$ at $C_{1}$. Let $A_{2}$ be the point such that $A_{1}$ is the midpoint of $P A_{2}$, let $B_{2}$ be the point such that $B_{1}$ is the midpoint of $P B_{2}$, and let $C_{2}$ be the point such that $C_{1}$ is the midpoint of $P C_{2}$. Prove that points $A_{2}, B_{2}$, and $C_{2}$ cannot all lie strictly inside the circumcircle of triangle $A B C$.","Since

$$
\angle A P B+\angle B P C+\angle C P A=2 \pi=(\pi-\angle A C B)+(\pi-\angle B A C)+(\pi-\angle C B A),
$$

at least one of the following inequalities holds:

$$
\angle A P B \geqslant \pi-\angle A C B, \quad \angle B P C \geqslant \pi-\angle B A C, \quad \angle C P A \geqslant \pi-\angle C B A .
$$

Without loss of generality, we assume that $\angle B P C \geqslant \pi-\angle B A C$. We have $\angle B P C>\angle B A C$ because $P$ is inside $\triangle A B C$. So $\angle B P C \geqslant \max (\angle B A C, \pi-\angle B A C)$ and hence


\begin{equation*}
\sin \angle B P C \leqslant \sin \angle B A C \tag{*}
\end{equation*}


Let the rays $A P, B P$, and $C P$ cross the circumcircle $\Omega$ again at $A_{3}, B_{3}$, and $C_{3}$, respectively. We will prove that at least one of the ratios $\frac{P B_{1}}{B_{1} B_{3}}$ and $\frac{P C_{1}}{C_{1} C_{3}}$ is at least 1, which yields that one of the points $B_{2}$ and $C_{2}$ does not lie strictly inside $\Omega$.

Because $A, B, C, B_{3}$ lie on a circle, the triangles $C B_{1} B_{3}$ and $B B_{1} A$ are similar, so

$$
\frac{C B_{1}}{B_{1} B_{3}}=\frac{B B_{1}}{B_{1} A} .
$$

Applying the sine rule we obtain

$$
\frac{P B_{1}}{B_{1} B_{3}}=\frac{P B_{1}}{C B_{1}} \cdot \frac{C B_{1}}{B_{1} B_{3}}=\frac{P B_{1}}{C B_{1}} \cdot \frac{B B_{1}}{B_{1} A}=\frac{\sin \angle A C P}{\sin \angle B P C} \cdot \frac{\sin \angle B A C}{\sin \angle P B A} .
$$

Similarly,

$$
\frac{P C_{1}}{C_{1} C_{3}}=\frac{\sin \angle P B A}{\sin \angle B P C} \cdot \frac{\sin \angle B A C}{\sin \angle A C P}
$$

Multiplying these two equations we get

$$
\frac{P B_{1}}{B_{1} B_{3}} \cdot \frac{P C_{1}}{C_{1} C_{3}}=\frac{\sin ^{2} \angle B A C}{\sin ^{2} \angle B P C} \geqslant 1
$$

using (*), which yields the desired conclusion.
",314,3
2019g5,Let $A B C D E$ be a convex pentagon with $C D=D E$ and $\angle E D C \neq 2 \cdot \angle A D B$. Suppose that a point $P$ is located in the interior of the pentagon such that $A P=A E$ and $B P=B C$. Prove that $P$ lies on the diagonal $C E$ if and only if area $(B C D)+\operatorname{area}(A D E)=$ $\operatorname{area}(A B D)+\operatorname{area}(A B P)$.,"Let $P^{\prime}$ be the reflection of $P$ across line $A B$, and let $M$ and $N$ be the midpoints of $P^{\prime} E$ and $P^{\prime} C$ respectively. Convexity ensures that $P^{\prime}$ is distinct from both $E$ and $C$, and hence from both $M$ and $N$. We claim that both the area condition and the collinearity condition in the problem are equivalent to the condition that the (possibly degenerate) right-angled triangles $A P^{\prime} M$ and $B P^{\prime} N$ are directly similar (equivalently, $A P^{\prime} E$ and $B P^{\prime} C$ are directly similar).\\
\includegraphics[max width=\textwidth, center]{2025_04_29_c4214a078eb1790cb0a3g-066}

For the equivalence with the collinearity condition, let $F$ denote the foot of the perpendicular from $P^{\prime}$ to $A B$, so that $F$ is the midpoint of $P P^{\prime}$. We have that $P$ lies on $C E$ if and only if $F$ lies on $M N$, which occurs if and only if we have the equality $\angle A F M=\angle B F N$ of signed angles modulo $\pi$. By concyclicity of $A P^{\prime} F M$ and $B F P^{\prime} N$, this is equivalent to $\angle A P^{\prime} M=\angle B P^{\prime} N$, which occurs if and only if $A P^{\prime} M$ and $B P^{\prime} N$ are directly similar.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_c4214a078eb1790cb0a3g-066(1)}

For the other equivalence with the area condition, we have the equality of signed areas $\operatorname{area}(A B D)+\operatorname{area}(A B P)=\operatorname{area}\left(A P^{\prime} B D\right)=\operatorname{area}\left(A P^{\prime} D\right)+\operatorname{area}\left(B D P^{\prime}\right)$. Using the identity $\operatorname{area}(A D E)-\operatorname{area}\left(A P^{\prime} D\right)=\operatorname{area}(A D E)+\operatorname{area}\left(A D P^{\prime}\right)=2$ area $(A D M)$, and similarly for $B$, we find that the area condition is equivalent to the equality

$$
\operatorname{area}(D A M)=\operatorname{area}(D B N) .
$$

Now note that $A$ and $B$ lie on the perpendicular bisectors of $P^{\prime} E$ and $P^{\prime} C$, respectively. If we write $G$ and $H$ for the feet of the perpendiculars from $D$ to these perpendicular bisectors respectively, then this area condition can be rewritten as

$$
M A \cdot G D=N B \cdot H D .
$$

(In this condition, we interpret all lengths as signed lengths according to suitable conventions: for instance, we orient $P^{\prime} E$ from $P^{\prime}$ to $E$, orient the parallel line $D H$ in the same direction, and orient the perpendicular bisector of $P^{\prime} E$ at an angle $\pi / 2$ clockwise from the oriented segment $P^{\prime} E$ - we adopt the analogous conventions at $B$.)\\
\includegraphics[max width=\textwidth, center]{2025_04_29_c4214a078eb1790cb0a3g-067}

To relate the signed lengths $G D$ and $H D$ to the triangles $A P^{\prime} M$ and $B P^{\prime} N$, we use the following calculation.\\
Claim. Let $\Gamma$ denote the circle centred on $D$ with both $E$ and $C$ on the circumference, and $h$ the power of $P^{\prime}$ with respect to $\Gamma$. Then we have the equality

$$
G D \cdot P^{\prime} M=H D \cdot P^{\prime} N=\frac{1}{4} h \neq 0
$$

Proof. Firstly, we have $h \neq 0$, since otherwise $P^{\prime}$ would lie on $\Gamma$, and hence the internal angle bisectors of $\angle E D P^{\prime}$ and $\angle P^{\prime} D C$ would pass through $A$ and $B$ respectively. This would violate the angle inequality $\angle E D C \neq 2 \cdot \angle A D B$ given in the question.

Next, let $E^{\prime}$ denote the second point of intersection of $P^{\prime} E$ with $\Gamma$, and let $E^{\prime \prime}$ denote the point on $\Gamma$ diametrically opposite $E^{\prime}$, so that $E^{\prime \prime} E$ is perpendicular to $P^{\prime} E$. The point $G$ lies on the perpendicular bisectors of the sides $P^{\prime} E$ and $E E^{\prime \prime}$ of the right-angled triangle $P^{\prime} E E^{\prime \prime}$; it follows that $G$ is the midpoint of $P^{\prime} E^{\prime \prime}$. Since $D$ is the midpoint of $E^{\prime} E^{\prime \prime}$, we have that $G D=\frac{1}{2} P^{\prime} E^{\prime}$. Since $P^{\prime} M=\frac{1}{2} P^{\prime} E$, we have $G D \cdot P^{\prime} M=\frac{1}{4} P^{\prime} E^{\prime} \cdot P^{\prime} E=\frac{1}{4} h$. The other equality $H D \cdot P^{\prime} N$ follows by exactly the same argument.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_c4214a078eb1790cb0a3g-067(1)}

From this claim, we see that the area condition is equivalent to the equality

$$
\left(M A: P^{\prime} M\right)=\left(N B: P^{\prime} N\right)
$$

of ratios of signed lengths, which is equivalent to direct similarity of $A P^{\prime} M$ and $B P^{\prime} N$, as desired.

",688,4
2019g6,"Let $I$ be the incentre of acute-angled triangle $A B C$. Let the incircle meet $B C, C A$, and $A B$ at $D, E$, and $F$, respectively. Let line $E F$ intersect the circumcircle of the triangle at $P$ and $Q$, such that $F$ lies between $E$ and $P$. Prove that $\angle D P A+\angle A Q D=\angle Q I P$.","Let $N$ and $M$ be the midpoints of the arcs $\widehat{B C}$ of the circumcircle, containing and opposite vertex $A$, respectively. By $\angle F A E=\angle B A C=\angle B N C$, the right-angled kites $A F I E$ and $N B M C$ are similar. Consider the spiral similarity $\varphi$ (dilation in case of $A B=A C$ ) that moves AFIE to $N B M C$. The directed angle in which $\varphi$ changes directions is $\angle(A F, N B)$, same as $\angle(A P, N P)$ and $\angle(A Q, N Q)$; so lines $A P$ and $A Q$ are mapped to lines $N P$ and $N Q$, respectively. Line $E F$ is mapped to $B C$; we can see that the intersection points $P=E F \cap A P$ and $Q=E F \cap A Q$ are mapped to points $B C \cap N P$ and $B C \cap N Q$, respectively. Denote these points by $P^{\prime}$ and $Q^{\prime}$, respectively.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_c4214a078eb1790cb0a3g-071}

Let $L$ be the midpoint of $B C$. We claim that points $P, Q, D, L$ are concyclic (if $D=L$ then line $B C$ is tangent to circle $P Q D$ ). Let $P Q$ and $B C$ meet at $Z$. By applying Menelaus' theorem to triangle $A B C$ and line $E F Z$, we have

$$
\frac{B D}{D C}=\frac{B F}{F A} \cdot \frac{A E}{E C}=-\frac{B Z}{Z C},
$$

so the pairs $B, C$ and $D, Z$ are harmonic. It is well-known that this implies $Z B \cdot Z C=Z D \cdot Z L$. (The inversion with pole $Z$ that swaps $B$ and $C$ sends $Z$ to infinity and $D$ to the midpoint of $B C$, because the cross-ratio is preserved.) Hence, $Z D \cdot Z L=Z B \cdot Z C=Z P \cdot Z Q$ by the power of $Z$ with respect to the circumcircle; this proves our claim.

By $\angle M P P^{\prime}=\angle M Q Q^{\prime}=\angle M L P^{\prime}=\angle M L Q^{\prime}=90^{\circ}$, the quadrilaterals $M L P P^{\prime}$ and $M L Q Q^{\prime}$ are cyclic. Then the problem statement follows by

$$
\begin{aligned}
\angle D P A+\angle A Q D & =360^{\circ}-\angle P A Q-\angle Q D P=360^{\circ}-\angle P N Q-\angle Q L P \\
& =\angle L P N+\angle N Q L=\angle P^{\prime} M L+\angle L M Q^{\prime}=\angle P^{\prime} M Q^{\prime}=\angle P I Q .
\end{aligned}
$$

",391,3
2019g7,"The incircle $\omega$ of acute-angled scalene triangle $A B C$ has centre $I$ and meets sides $B C$, $C A$, and $A B$ at $D, E$, and $F$, respectively. The line through $D$ perpendicular to $E F$ meets $\omega$ again at $R$. Line $A R$ meets $\omega$ again at $P$. The circumcircles of triangles $P C E$ and $P B F$ meet again at $Q \neq P$. Prove that lines $D I$ and $P Q$ meet on the external bisector of angle $B A C$.\\","Common remarks. Throughout the solution, $\angle(a, b)$ denotes the directed angle between lines $a$ and $b$, measured modulo $\pi$.

Step 1. The external bisector of $\angle B A C$ is the line through $A$ perpendicular to $I A$. Let $D I$ meet this line at $L$ and let $D I$ meet $\omega$ at $K$. Let $N$ be the midpoint of $E F$, which lies on $I A$ and is the pole of line $A L$ with respect to $\omega$. Since $A N \cdot A I=A E^{2}=A R \cdot A P$, the points $R$, $N, I$, and $P$ are concyclic. As $I R=I P$, the line $N I$ is the external bisector of $\angle P N R$, so $P N$ meets $\omega$ again at the point symmetric to $R$ with respect to $A N$ - i.e. at $K$.

Let $D N$ cross $\omega$ again at $S$. Opposite sides of any quadrilateral inscribed in the circle $\omega$ meet on the polar line of the intersection of the diagonals with respect to $\omega$. Since $L$ lies on the polar line $A L$ of $N$ with respect to $\omega$, the line $P S$ must pass through $L$. Thus it suffices to prove that the points $S, Q$, and $P$ are collinear.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_c4214a078eb1790cb0a3g-074}

Step 2. Let $\Gamma$ be the circumcircle of $\triangle B I C$. Notice that

$$
\begin{aligned}
\angle(B Q, Q C)=\angle & (B Q, Q P)+\angle(P Q, Q C)=\angle(B F, F P)+\angle(P E, E C) \\
& =\angle(E F, E P)+\angle(F P, F E)=\angle(F P, E P)=\angle(D F, D E)=\angle(B I, I C),
\end{aligned}
$$

so $Q$ lies on $\Gamma$. Let $Q P$ meet $\Gamma$ again at $T$. It will now suffice to prove that $S, P$, and $T$ are collinear. Notice that $\angle(B I, I T)=\angle(B Q, Q T)=\angle(B F, F P)=\angle(F K, K P)$. Note $F D \perp F K$ and $F D \perp B I$ so $F K \| B I$ and hence $I T$ is parallel to the line $K N P$. Since $D I=I K$, the line $I T$ crosses $D N$ at its midpoint $M$.\\
Step 3. Let $F^{\prime}$ and $E^{\prime}$ be the midpoints of $D E$ and $D F$, respectively. Since $D E^{\prime} \cdot E^{\prime} F=D E^{\prime 2}=$ $B E^{\prime} \cdot E^{\prime} I$, the point $E^{\prime}$ lies on the radical axis of $\omega$ and $\Gamma$; the same holds for $F^{\prime}$. Therefore, this radical axis is $E^{\prime} F^{\prime}$, and it passes through $M$. Thus $I M \cdot M T=D M \cdot M S$, so $S, I, D$, and $T$ are concyclic. This shows $\angle(D S, S T)=\angle(D I, I T)=\angle(D K, K P)=\angle(D S, S P)$, whence the points $S, P$, and $T$ are collinear, as desired.\\
",452,3
2019g8,"Let $\mathcal{L}$ be the set of all lines in the plane and let $f$ be a function that assigns to each line $\ell \in \mathcal{L}$ a point $f(\ell)$ on $\ell$. Suppose that for any point $X$, and for any three lines $\ell_{1}, \ell_{2}, \ell_{3}$ passing through $X$, the points $f\left(\ell_{1}\right), f\left(\ell_{2}\right), f\left(\ell_{3}\right)$ and $X$ lie on a circle.

Prove that there is a unique point $P$ such that $f(\ell)=P$ for any line $\ell$ passing through $P$.","Common remarks. The condition on $f$ is equivalent to the following: There is some function $g$ that assigns to each point $X$ a circle $g(X)$ passing through $X$ such that for any line $\ell$ passing through $X$, the point $f(\ell)$ lies on $g(X)$. (The function $g$ may not be uniquely defined for all points, if some points $X$ have at most one value of $f(\ell)$ other than $X$; for such points, an arbitrary choice is made.)

If there were two points $P$ and $Q$ with the given property, $f(P Q)$ would have to be both $P$ and $Q$, so there is at most one such point, and it will suffice to show that such a point exists.

We provide a complete characterisation of the functions satisfying the given condition.

Write $\angle\left(\ell_{1}, \ell_{2}\right)$ for the directed angle modulo $180^{\circ}$ between the lines $\ell_{1}$ and $\ell_{2}$. Given a point $P$ and an angle $\alpha \in\left(0,180^{\circ}\right)$, for each line $\ell$, let $\ell^{\prime}$ be the line through $P$ satisfying $\angle\left(\ell^{\prime}, \ell\right)=\alpha$, and let $h_{P, \alpha}(\ell)$ be the intersection point of $\ell$ and $\ell^{\prime}$. We will prove that there is some pair $(P, \alpha)$ such that $f$ and $h_{P, \alpha}$ are the same function. Then $P$ is the unique point in the problem statement.

Given an angle $\alpha$ and a point $P$, let a line $\ell$ be called $(P, \alpha)$-good if $f(\ell)=h_{P, \alpha}(\ell)$. Let a point $X \neq P$ be called $(P, \alpha)$-good if the circle $g(X)$ passes through $P$ and some point $Y \neq P, X$ on $g(X)$ satisfies $\angle(P Y, Y X)=\alpha$. It follows from this definition that if $X$ is $(P, \alpha)$ good then every point $Y \neq P, X$ of $g(X)$ satisfies this angle condition, so $h_{P, \alpha}(X Y)=Y$ for every $Y \in g(X)$. Equivalently, $f(\ell) \in\left\{X, h_{P, \alpha}(\ell)\right\}$ for each line $\ell$ passing through $X$. This shows the following lemma.\\
Lemma 1. If $X$ is $(P, \alpha)$-good and $\ell$ is a line passing through $X$ then either $f(\ell)=X$ or $\ell$ is ( $P, \alpha$ )-good.\\
Lemma 2. If $X$ and $Y$ are different $(P, \alpha)$-good points, then line $X Y$ is $(P, \alpha)$-good.\\
Proof. If $X Y$ is not $(P, \alpha)$-good then by the previous Lemma, $f(X Y)=X$ and similarly $f(X Y)=Y$, but clearly this is impossible as $X \neq Y$.

Lemma 3. If $\ell_{1}$ and $\ell_{2}$ are different $(P, \alpha)$-good lines which intersect at $X \neq P$, then either $f\left(\ell_{1}\right)=X$ or $f\left(\ell_{2}\right)=X$ or $X$ is $(P, \alpha)$-good.\\
Proof. If $f\left(\ell_{1}\right), f\left(\ell_{2}\right) \neq X$, then $g(X)$ is the circumcircle of $X, f\left(\ell_{1}\right)$ and $f\left(\ell_{2}\right)$. Since $\ell_{1}$ and $\ell_{2}$ are $(P, \alpha)$-good lines, the angles

$$
\angle\left(P f\left(\ell_{1}\right), f\left(\ell_{1}\right) X\right)=\angle\left(P f\left(\ell_{2}\right), f\left(\ell_{2}\right) X\right)=\alpha,
$$

so $P$ lies on $g(X)$. Hence, $X$ is $(P, \alpha)$-good.\\
Lemma 4. If $\ell_{1}, \ell_{2}$ and $\ell_{3}$ are different $(P, \alpha)$-good lines which intersect at $X \neq P$, then $X$ is ( $P, \alpha$ )-good.

Proof. This follows from the previous Lemma since at most one of the three lines $\ell_{i}$ can satisfy $f\left(\ell_{i}\right)=X$ as the three lines are all $(P, \alpha)$-good.

Lemma 5. If $A B C$ is a triangle such that $A, B, C, f(A B), f(A C)$ and $f(B C)$ are all different points, then there is some point $P$ and some angle $\alpha$ such that $A, B$ and $C$ are $(P, \alpha)$-good points and $A B, B C$ and $C A$ are $(P, \alpha)$-good lines.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_c4214a078eb1790cb0a3g-079}

Proof. Let $D, E, F$ denote the points $f(B C), f(A C), f(A B)$, respectively. Then $g(A)$, $g(B)$ and $g(C)$ are the circumcircles of $A E F, B D F$ and $C D E$, respectively. Let $P \neq F$ be the second intersection of circles $g(A)$ and $g(B)$ (or, if these circles are tangent at $F$, then $P=F$ ). By Miquel's theorem (or an easy angle chase), $g(C)$ also passes through $P$. Then by the cyclic quadrilaterals, the directed angles

$$
\angle(P D, D C)=\angle(P F, F B)=\angle(P E, E A)=\alpha,
$$

for some angle $\alpha$. Hence, lines $A B, B C$ and $C A$ are all $(P, \alpha)$-good, so by Lemma 3, $A, B$ and $C$ are ( $P, \alpha$ )-good. (In the case where $P=D$, the line $P D$ in the equation above denotes the line which is tangent to $g(B)$ at $P=D$. Similar definitions are used for $P E$ and $P F$ in the cases where $P=E$ or $P=F$.)

Consider the set $\Omega$ of all points $(x, y)$ with integer coordinates $1 \leqslant x, y \leqslant 1000$, and consider the set $L_{\Omega}$ of all horizontal, vertical and diagonal lines passing through at least one point in $\Omega$. A simple counting argument shows that there are 5998 lines in $L_{\Omega}$. For each line $\ell$ in $L_{\Omega}$ we colour the point $f(\ell)$ red. Then there are at most 5998 red points. Now we partition the points in $\Omega$ into 10000 ten by ten squares. Since there are at most 5998 red points, at least one of these squares $\Omega_{10}$ contains no red points. Let ( $m, n$ ) be the bottom left point in $\Omega_{10}$. Then the triangle with vertices $(m, n),(m+1, n)$ and $(m, n+1)$ satisfies the condition of Lemma 5 , so these three vertices are all $(P, \alpha)$-good for some point $P$ and angle $\alpha$, as are the lines joining them. From this point on, we will simply call a point or line good if it is $(P, \alpha)$-good for this particular pair $(P, \alpha)$. Now by Lemma 1, the line $x=m+1$ is good, as is the line $y=n+1$. Then Lemma 3 implies that ( $m+1, n+1$ ) is good. By applying these two lemmas repeatedly, we can prove that the line $x+y=m+n+2$ is good, then the points $(m, n+2)$ and $(m+2, n)$ then the lines $x=m+2$ and $y=n+2$, then the points $(m+2, n+1),(m+1, n+2)$ and $(m+2, n+2)$ and so on until we have prove that all points in $\Omega_{10}$ are good.

Now we will use this to prove that every point $S \neq P$ is good. Since $g(S)$ is a circle, it passes through at most two points of $\Omega_{10}$ on any vertical line, so at most 20 points in total. Moreover, any line $\ell$ through $S$ intersects at most 10 points in $\Omega_{10}$. Hence, there are at least eight lines $\ell$ through $S$ which contain a point $Q$ in $\Omega_{10}$ which is not on $g(S)$. Since $Q$ is not on $g(S)$, the point $f(\ell) \neq Q$. Hence, by Lemma 1 , the line $\ell$ is good. Hence, at least eight good lines pass through $S$, so by Lemma 4, the point $S$ is good. Hence, every point $S \neq P$ is good, so by Lemma 2, every line is good. In particular, every line $\ell$ passing through $P$ is good, and therefore satisfies $f(\ell)=P$, as required.
",1127,4
2019n5,"Let $a$ be a positive integer. We say that a positive integer $b$ is $a$-good if $\binom{a n}{b}-1$ is divisible by $a n+1$ for all positive integers $n$ with $a n \geqslant b$. Suppose $b$ is a positive integer such that $b$ is $a$-good, but $b+2$ is not $a$-good. Prove that $b+1$ is prime.","For $p$ a prime and $n$ a nonzero integer, we write $v_{p}(n)$ for the $p$-adic valuation of $n$ : the largest integer $t$ such that $p^{t} \mid n$.

We first show that $b$ is $a$-good if and only if $b$ is even, and $p \mid a$ for all primes $p \leqslant b$.\\
To start with, the condition that $a n+1 \left\lvert\,\binom{ a n}{b}-1\right.$ can be rewritten as saying that


\begin{equation*}
\frac{a n(a n-1) \cdots(a n-b+1)}{b!} \equiv 1 \quad(\bmod a n+1) . \tag{1}
\end{equation*}


Suppose, on the one hand, there is a prime $p \leqslant b$ with $p \nmid a$. Take $t=v_{p}(b!)$. Then there exist positive integers $c$ such that $a c \equiv 1\left(\bmod p^{t+1}\right)$. If we take $c$ big enough, and then take $n=(p-1) c$, then $a n=a(p-1) c \equiv p-1\left(\bmod p^{t+1}\right)$ and $a n \geqslant b$. Since $p \leqslant b$, one of the terms of the numerator an $(a n-1) \cdots(a n-b+1)$ is $a n-p+1$, which is divisible by $p^{t+1}$. Hence the $p$-adic valuation of the numerator is at least $t+1$, but that of the denominator is exactly $t$. This means that $p \left\lvert\,\binom{ a n}{b}\right.$, so $p \nmid\binom{a n}{b}-1$. As $p \mid a n+1$, we get that $a n+1 \nmid\binom{a n}{b}$, so $b$ is not $a$-good.

On the other hand, if for all primes $p \leqslant b$ we have $p \mid a$, then every factor of $b$ ! is coprime to an +1 , and hence invertible modulo $a n+1$ : hence $b$ ! is also invertible modulo $a n+1$. Then equation (1) reduces to:

$$
a n(a n-1) \cdots(a n-b+1) \equiv b!\quad(\bmod a n+1) .
$$

However, we can rewrite the left-hand side as follows:

$$
a n(a n-1) \cdots(a n-b+1) \equiv(-1)(-2) \cdots(-b) \equiv(-1)^{b} b!\quad(\bmod a n+1)
$$

Provided that $a n>1$, if $b$ is even we deduce $(-1)^{b} b!\equiv b!$ as needed. On the other hand, if $b$ is odd, and we take $a n+1>2(b!)$, then we will not have $(-1)^{b} b!\equiv b$ !, so $b$ is not $a$-good. This completes the claim.

To conclude from here, suppose that $b$ is $a$-good, but $b+2$ is not. Then $b$ is even, and $p \mid a$ for all primes $p \leqslant b$, but there is a prime $q \leqslant b+2$ for which $q \nmid a$ : so $q=b+1$ or $q=b+2$. We cannot have $q=b+2$, as that is even too, so we have $q=b+1$ : in other words, $b+1$ is prime.
",402,3
2019n6,"Let $H=\left\{\lfloor i \sqrt{2}\rfloor: i \in \mathbb{Z}_{>0}\right\}=\{1,2,4,5,7, \ldots\}$, and let $n$ be a positive integer. Prove that there exists a constant $C$ such that, if $A \subset\{1,2, \ldots, n\}$ satisfies $|A| \geqslant C \sqrt{n}$, then there exist $a, b \in A$ such that $a-b \in H$. (Here $\mathbb{Z}_{>0}$ is the set of positive integers, and $\lfloor z\rfloor$ denotes the greatest integer less than or equal to $z$.)","Common remarks. In all solutions, we will assume that $A$ is a set such that $\{a-b: a, b \in A\}$ is disjoint from $H$, and prove that $|A|<C \sqrt{n}$.

First, observe that if $n$ is a positive integer, then $n \in H$ exactly when


\begin{equation*}
\left\{\frac{n}{\sqrt{2}}\right\}>1-\frac{1}{\sqrt{2}} . \tag{1}
\end{equation*}


To see why, observe that $n \in H$ if and only if $0<i \sqrt{2}-n<1$ for some $i \in \mathbb{Z}_{>0}$. In other words, $0<i-n / \sqrt{2}<1 / \sqrt{2}$, which is equivalent to (1).

Now, write $A=\left\{a_{1}<a_{2}<\cdots<a_{k}\right\}$, where $k=|A|$. Observe that the set of differences is not altered by shifting $A$, so we may assume that $A \subseteq\{0,1, \ldots, n-1\}$ with $a_{1}=0$.

From (1), we learn that $\left\{a_{i} / \sqrt{2}\right\}<1-1 / \sqrt{2}$ for each $i>1$ since $a_{i}-a_{1} \notin H$. Furthermore, we must have $\left\{a_{i} / \sqrt{2}\right\}<\left\{a_{j} / \sqrt{2}\right\}$ whenever $i<j$; otherwise, we would have

$$
-\left(1-\frac{1}{\sqrt{2}}\right)<\left\{\frac{a_{j}}{\sqrt{2}}\right\}-\left\{\frac{a_{i}}{\sqrt{2}}\right\}<0 .
$$

Since $\left\{\left(a_{j}-a_{i}\right) / \sqrt{2}\right\}=\left\{a_{j} / \sqrt{2}\right\}-\left\{a_{i} / \sqrt{2}\right\}+1$, this implies that $\left\{\left(a_{j}-a_{i}\right) / \sqrt{2}\right\}>1 / \sqrt{2}>$ $1-1 / \sqrt{2}$, contradicting (1).

Now, we have a sequence $0=a_{1}<a_{2}<\cdots<a_{k}<n$, with

$$
0=\left\{\frac{a_{1}}{\sqrt{2}}\right\}<\left\{\frac{a_{2}}{\sqrt{2}}\right\}<\cdots<\left\{\frac{a_{k}}{\sqrt{2}}\right\}<1-\frac{1}{\sqrt{2}} .
$$

We use the following fact: for any $d \in \mathbb{Z}$, we have


\begin{equation*}
\left\{\frac{d}{\sqrt{2}}\right\}>\frac{1}{2 d \sqrt{2}} . \tag{2}
\end{equation*}


To see why this is the case, let $h=\lfloor d / \sqrt{2}\rfloor$, so $\{d / \sqrt{2}\}=d / \sqrt{2}-h$. Then

$$
\left\{\frac{d}{\sqrt{2}}\right\}\left(\frac{d}{\sqrt{2}}+h\right)=\frac{d^{2}-2 h^{2}}{2} \geqslant \frac{1}{2},
$$

since the numerator is a positive integer. Because $d / \sqrt{2}+h<2 d / \sqrt{2}$, inequality (2) follows.\\
Let $d_{i}=a_{i+1}-a_{i}$, for $1 \leqslant i<k$. Then $\left\{a_{i+1} / \sqrt{2}\right\}-\left\{a_{i} / \sqrt{2}\right\}=\left\{d_{i} / \sqrt{2}\right\}$, and we have


\begin{equation*}
1-\frac{1}{\sqrt{2}}>\sum_{i}\left\{\frac{d_{i}}{\sqrt{2}}\right\}>\frac{1}{2 \sqrt{2}} \sum_{i} \frac{1}{d_{i}} \geqslant \frac{(k-1)^{2}}{2 \sqrt{2}} \frac{1}{\sum_{i} d_{i}}>\frac{(k-1)^{2}}{2 \sqrt{2}} \cdot \frac{1}{n} . \tag{3}
\end{equation*}


Here, the first inequality holds because $\left\{a_{k} / \sqrt{2}\right\}<1-1 / \sqrt{2}$, the second follows from (2), the third follows from an easy application of the AM-HM inequality (or Cauchy-Schwarz), and the fourth follows from the fact that $\sum_{i} d_{i}=a_{k}<n$.

Rearranging this, we obtain

$$
\sqrt{2 \sqrt{2}-2} \cdot \sqrt{n}>k-1
$$

which provides the required bound on $k$.
",327,3
2019n7,Prove that there is a constant $c>0$ and infinitely many positive integers $n$ with the following property: there are infinitely many positive integers that cannot be expressed as the sum of fewer than $c n \log (n)$ pairwise coprime $n^{\text {th }}$ powers.,"Suppose, for an integer $n$, that we can find another integer $N$ satisfying the following property:\\
$n$ is divisible by $\varphi\left(p^{e}\right)$ for every prime power $p^{e}$ exactly dividing $N$.\\
This property ensures that all $n^{\text {th }}$ powers are congruent to 0 or 1 modulo each such prime power $p^{e}$, and hence that any sum of $m$ pairwise coprime $n^{\text {th }}$ powers is congruent to $m$ or $m-1$ modulo $p^{e}$, since at most one of the $n^{\text {th }}$ powers is divisible by $p$. Thus, if $k$ denotes the number of distinct prime factors of $N$, we find by the Chinese Remainder Theorem at most $2^{k} m$ residue classes modulo $N$ which are sums of at most $m$ pairwise coprime $n^{\text {th }}$ powers. In particular, if $N>2^{k} m$ then there are infinitely many positive integers not expressible as a sum of at most $m$ pairwise coprime $n^{\text {th }}$ powers.

It thus suffices to prove that there are arbitrarily large pairs $(n, N)$ of integers satisfying ( $\dagger$ ) such that

$$
N>c \cdot 2^{k} n \log (n)
$$

for some positive constant $c$.\\
We construct such pairs as follows. Fix a positive integer $t$ and choose (distinct) prime numbers $p \mid 2^{2^{t-1}}+1$ and $q \mid 2^{2^{t}}+1$; we set $N=p q$. It is well-known that $2^{t} \mid p-1$ and $2^{t+1} \mid q-1$, hence

$$
n=\frac{(p-1)(q-1)}{2^{t}}
$$

is an integer and the pair $(n, N)$ satisfies $(\dagger)$.\\
Estimating the size of $N$ and $n$ is now straightforward. We have

$$
\log _{2}(n) \leqslant 2^{t-1}+2^{t}-t<2^{t+1}<2 \cdot \frac{N}{n}
$$

which rearranges to

$$
N>\frac{1}{8} \cdot 2^{2} n \log _{2}(n)
$$

and so we are done if we choose $c<\frac{1}{8 \log (2)} \approx 0.18$.\\
Comment 1. The trick in the above solution was to find prime numbers $p$ and $q$ congruent to 1 modulo some $d=2^{t}$ and which are not too large. An alternative way to do this is via Linnik's Theorem, which says that there are absolute constants $b$ and $L>1$ such that for any coprime integers $a$ and $d$, there is a prime congruent to $a$ modulo $d$ and of size $\leqslant b d^{L}$. If we choose some $d$ not divisible by 3 and choose two distinct primes $p, q \leqslant b \cdot(3 d)^{L}$ congruent to 1 modulo $d$ (and, say, distinct modulo 3), then we obtain a pair $(n, N)$ satisfying $(\dagger)$ with $N=p q$ and $n=\frac{(p-1)(q-1)}{d}$. A straightforward computation shows that

$$
N>C n^{1+\frac{1}{2 L-1}}
$$

for some constant $C$, which is in particular larger than any $c \cdot 2^{2} n \log (n)$ for $p$ large. Thus, the statement of the problem is true for any constant $c$. More strongly, the statement of the problem is still true when $c n \log (n)$ is replaced by $n^{1+\delta}$ for a sufficiently small $\delta>0$.
",464,3
2019n8,"Let $a$ and $b$ be two positive integers. Prove that the integer

$$
a^{2}+\left\lceil\frac{4 a^{2}}{b}\right\rceil
$$

is not a square. (Here $\lceil z\rceil$ denotes the least integer greater than or equal to $z$.)","Arguing indirectly, assume that

$$
a^{2}+\left\lceil\frac{4 a^{2}}{b}\right\rceil=(a+k)^{2}, \quad \text { or } \quad\left\lceil\frac{(2 a)^{2}}{b}\right\rceil=(2 a+k) k .
$$

Clearly, $k \geqslant 1$. In other words, the equation


\begin{equation*}
\left\lceil\frac{c^{2}}{b}\right\rceil=(c+k) k \tag{1}
\end{equation*}


has a positive integer solution $(c, k)$, with an even value of $c$.\\
Choose a positive integer solution of (1) with minimal possible value of $k$, without regard to the parity of $c$. From

$$
\frac{c^{2}}{b}>\left\lceil\frac{c^{2}}{b}\right\rceil-1=c k+k^{2}-1 \geqslant c k
$$

and

$$
\frac{(c-k)(c+k)}{b}<\frac{c^{2}}{b} \leqslant\left\lceil\frac{c^{2}}{b}\right\rceil=(c+k) k
$$

it can be seen that $c>b k>c-k$, so

$$
c=k b+r \quad \text { with some } 0<r<k .
$$

By substituting this in (1) we get

$$
\left\lceil\frac{c^{2}}{b}\right\rceil=\left\lceil\frac{(b k+r)^{2}}{b}\right\rceil=k^{2} b+2 k r+\left\lceil\frac{r^{2}}{b}\right\rceil
$$

and

$$
(c+k) k=(k b+r+k) k=k^{2} b+2 k r+k(k-r),
$$

so


\begin{equation*}
\left\lceil\frac{r^{2}}{b}\right\rceil=k(k-r) . \tag{2}
\end{equation*}


Notice that relation (2) provides another positive integer solution of (1), namely $c^{\prime}=r$ and $k^{\prime}=k-r$, with $c^{\prime}>0$ and $0<k^{\prime}<k$. That contradicts the minimality of $k$, and hence finishes the solution.
",159,2
2018a3,"Given any set $S$ of positive integers, show that at least one of the following two assertions holds:\\
(1) There exist distinct finite subsets $F$ and $G$ of $S$ such that $\sum_{x \in F} 1 / x=\sum_{x \in G} 1 / x$;\\
(2) There exists a positive rational number $r<1$ such that $\sum_{x \in F} 1 / x \neq r$ for all finite subsets $F$ of $S$.","Argue indirectly. Agree, as usual, that the empty sum is 0 to consider rationals in $\left[0,1\right.$ ); adjoining 0 causes no harm, since $\sum_{x \in F} 1 / x=0$ for no nonempty finite subset $F$ of $S$. For every rational $r$ in $[0,1)$, let $F_{r}$ be the unique finite subset of $S$ such that $\sum_{x \in F_{r}} 1 / x=r$. The argument hinges on the lemma below.\\
Lemma. If $x$ is a member of $S$ and $q$ and $r$ are rationals in $[0,1)$ such that $q-r=1 / x$, then $x$ is a member of $F_{q}$ if and only if it is not one of $F_{r}$.\\
Proof. If $x$ is a member of $F_{q}$, then

$$
\sum_{y \in F_{q} \backslash\{x\}} \frac{1}{y}=\sum_{y \in F_{q}} \frac{1}{y}-\frac{1}{x}=q-\frac{1}{x}=r=\sum_{y \in F_{r}} \frac{1}{y},
$$

so $F_{r}=F_{q} \backslash\{x\}$, and $x$ is not a member of $F_{r}$. Conversely, if $x$ is not a member of $F_{r}$, then

$$
\sum_{y \in F_{r} \cup\{x\}} \frac{1}{y}=\sum_{y \in F_{r}} \frac{1}{y}+\frac{1}{x}=r+\frac{1}{x}=q=\sum_{y \in F_{q}} \frac{1}{y},
$$

so $F_{q}=F_{r} \cup\{x\}$, and $x$ is a member of $F_{q}$.\\
Consider now an element $x$ of $S$ and a positive rational $r<1$. Let $n=\lfloor r x\rfloor$ and consider the sets $F_{r-k / x}, k=0, \ldots, n$. Since $0 \leqslant r-n / x<1 / x$, the set $F_{r-n / x}$ does not contain $x$, and a repeated application of the lemma shows that the $F_{r-(n-2 k) / x}$ do not contain $x$, whereas the $F_{r-(n-2 k-1) / x}$ do. Consequently, $x$ is a member of $F_{r}$ if and only if $n$ is odd.

Finally, consider $F_{2 / 3}$. By the preceding, $\lfloor 2 x / 3\rfloor$ is odd for each $x$ in $F_{2 / 3}$, so $2 x / 3$ is not integral. Since $F_{2 / 3}$ is finite, there exists a positive rational $\varepsilon$ such that $\lfloor(2 / 3-\varepsilon) x\rfloor=\lfloor 2 x / 3\rfloor$ for all $x$ in $F_{2 / 3}$. This implies that $F_{2 / 3}$ is a subset of $F_{2 / 3-\varepsilon}$ which is impossible.
",328,3
2018a6,"Let $m, n \geqslant 2$ be integers. Let $f\left(x_{1}, \ldots, x_{n}\right)$ be a polynomial with real coefficients such that

$$
f\left(x_{1}, \ldots, x_{n}\right)=\left\lfloor\frac{x_{1}+\ldots+x_{n}}{m}\right\rfloor \quad \text { for every } x_{1}, \ldots, x_{n} \in\{0,1, \ldots, m-1\}
$$

Prove that the total degree of $f$ is at least $n$.","Solution. We transform the problem to a single variable question by the following\\
Lemma. Let $a_{1}, \ldots, a_{n}$ be nonnegative integers and let $G(x)$ be a nonzero polynomial with $\operatorname{deg} G \leqslant a_{1}+\ldots+a_{n}$. Suppose that some polynomial $F\left(x_{1}, \ldots, x_{n}\right)$ satisfies

$$
F\left(x_{1}, \ldots, x_{n}\right)=G\left(x_{1}+\ldots+x_{n}\right) \quad \text { for }\left(x_{1}, \ldots, x_{n}\right) \in\left\{0,1, \ldots, a_{1}\right\} \times \ldots \times\left\{0,1, \ldots, a_{n}\right\}
$$

Then $F$ cannot be the zero polynomial, and $\operatorname{deg} F \geqslant \operatorname{deg} G$.\\
For proving the lemma, we will use forward differences of polynomials. If $p(x)$ is a polynomial with a single variable, then define $(\Delta p)(x)=p(x+1)-p(x)$. It is well-known that if $p$ is a nonconstant polynomial then $\operatorname{deg} \Delta p=\operatorname{deg} p-1$.

If $p\left(x_{1}, \ldots, x_{n}\right)$ is a polynomial with $n$ variables and $1 \leqslant k \leqslant n$ then let

$$
\left(\Delta_{k} p\right)\left(x_{1}, \ldots, x_{n}\right)=p\left(x_{1}, \ldots, x_{k-1}, x_{k}+1, x_{k+1}, \ldots, x_{n}\right)-p\left(x_{1}, \ldots, x_{n}\right)
$$

It is also well-known that either $\Delta_{k} p$ is the zero polynomial or $\operatorname{deg}\left(\Delta_{k} p\right) \leqslant \operatorname{deg} p-1$.\\
Proof of the lemma. We apply induction on the degree of $G$. If $G$ is a constant polynomial then we have $F(0, \ldots, 0)=G(0) \neq 0$, so $F$ cannot be the zero polynomial.

Suppose that $\operatorname{deg} G \geqslant 1$ and the lemma holds true for lower degrees. Since $a_{1}+\ldots+a_{n} \geqslant$ $\operatorname{deg} G>0$, at least one of $a_{1}, \ldots, a_{n}$ is positive; without loss of generality suppose $a_{1} \geqslant 1$.

Consider the polynomials $F_{1}=\Delta_{1} F$ and $G_{1}=\Delta G$. On the grid $\left\{0, \ldots, a_{1}-1\right\} \times\left\{0, \ldots, a_{2}\right\} \times$ $\ldots \times\left\{0, \ldots, a_{n}\right\}$ we have

$$
\begin{aligned}
F_{1}\left(x_{1}, \ldots, x_{n}\right) & =F\left(x_{1}+1, x_{2}, \ldots, x_{n}\right)-F\left(x_{1}, x_{2}, \ldots, x_{n}\right)= \\
& =G\left(x_{1}+\ldots+x_{n}+1\right)-G\left(x_{1}+\ldots+x_{n}\right)=G_{1}\left(x_{1}+\ldots+x_{n}\right)
\end{aligned}
$$

Since $G$ is nonconstant, we have $\operatorname{deg} G_{1}=\operatorname{deg} G-1 \leqslant\left(a_{1}-1\right)+a_{2}+\ldots+a_{n}$. Therefore we can apply the induction hypothesis to $F_{1}$ and $G_{1}$ and conclude that $F_{1}$ is not the zero polynomial and $\operatorname{deg} F_{1} \geqslant \operatorname{deg} G_{1}$. Hence, $\operatorname{deg} F \geqslant \operatorname{deg} F_{1}+1 \geqslant \operatorname{deg} G_{1}+1=\operatorname{deg} G$. That finishes the proof.

To prove the problem statement, take the unique polynomial $g(x)$ so that $g(x)=\left\lfloor\frac{x}{m}\right\rfloor$ for $x \in\{0,1, \ldots, n(m-1)\}$ and $\operatorname{deg} g \leqslant n(m-1)$. Notice that precisely $n(m-1)+1$ values of $g$ are prescribed, so $g(x)$ indeed exists and is unique. Notice further that the constraints $g(0)=g(1)=0$ and $g(m)=1$ together enforce $\operatorname{deg} g \geqslant 2$.

By applying the lemma to $a_{1}=\ldots=a_{n}=m-1$ and the polynomials $f$ and $g$, we achieve $\operatorname{deg} f \geqslant \operatorname{deg} g$. Hence we just need a suitable lower bound on $\operatorname{deg} g$.

Consider the polynomial $h(x)=g(x+m)-g(x)-1$. The degree of $g(x+m)-g(x)$ is $\operatorname{deg} g-1 \geqslant 1$, so $\operatorname{deg} h=\operatorname{deg} g-1 \geqslant 1$, and therefore $h$ cannot be the zero polynomial. On the other hand, $h$ vanishes at the points $0,1, \ldots, n(m-1)-m$, so $h$ has at least $(n-1)(m-1)$ roots. Hence,

$$
\operatorname{deg} f \geqslant \operatorname{deg} g=\operatorname{deg} h+1 \geqslant(n-1)(m-1)+1 \geqslant n
$$

Comment 1. In the lemma we have equality for the choice $F\left(x_{1}, \ldots, x_{n}\right)=G\left(x_{1}+\ldots+x_{n}\right)$, so it indeed transforms the problem to an equivalent single-variable question.

Comment 2. If $m \geqslant 3$, the polynomial $h(x)$ can be replaced by $\Delta g$. Notice that

$$
(\Delta g)(x)= \begin{cases}1 & \text { if } x \equiv-1 \quad(\bmod m) \quad \text { for } x=0,1, \ldots, n(m-1)-1 \\ 0 & \text { otherwise }\end{cases}
$$

Hence, $\Delta g$ vanishes at all integers $x$ with $0 \leqslant x<n(m-1)$ and $x \not \equiv-1(\bmod m)$. This leads to $\operatorname{deg} g \geqslant \frac{(m-1)^{2} n}{m}+1$.

If $m$ is even then this lower bound can be improved to $n(m-1)$. For $0 \leqslant N<n(m-1)$, the $(N+1)^{\text {st }}$ forward difference at $x=0$ is


\begin{equation*}
\left(\Delta^{N+1}\right) g(0)=\sum_{k=0}^{N}(-1)^{N-k}\binom{N}{k}(\Delta g)(k)=\sum_{\substack{0 \leqslant k \leqslant N \\ k \equiv-1(\bmod m)}}(-1)^{N-k}\binom{N}{k} \tag{*}
\end{equation*}


Since $m$ is even, all signs in the last sum are equal; with $N=n(m-1)-1$ this proves $\Delta^{n(m-1)} g(0) \neq 0$, indicating that $\operatorname{deg} g \geqslant n(m-1)$.

However, there are infinitely many cases when all terms in $(*)$ cancel out, for example if $m$ is an odd divisor of $n+1$. In such cases, $\operatorname{deg} f$ can be less than $n(m-1)$.

Comment 3. The lemma is closely related to the so-called\\
Alon-Fredi bound. Let $S_{1}, \ldots, S_{n}$ be nonempty finite sets in a field and suppose that the polynomial $P\left(x_{1}, \ldots, x_{n}\right)$ vanishes at the points of the grid $S_{1} \times \ldots \times S_{n}$, except for a single point. Then $\operatorname{deg} P \geqslant \sum_{i=1}^{n}\left(\left|S_{i}\right|-1\right)$.\\
(A well-known application of the Alon-Fredi bound was the former IMO problem 2007/6. Since then, this result became popular among the students and is part of the IMO training for many IMO teams.)

The proof of the lemma can be replaced by an application of the Alon-Fredi bound as follows. Let $d=\operatorname{deg} G$, and let $G_{0}$ be the unique polynomial such that $G_{0}(x)=G(x)$ for $x \in\{0,1, \ldots, d-1\}$ but $\operatorname{deg} G_{0}<d$. The polynomials $G_{0}$ and $G$ are different because they have different degrees, and they attain the same values at $0,1, \ldots, d-1$; that enforces $G_{0}(d) \neq G(d)$.

Choose some nonnegative integers $b_{1}, \ldots, b_{n}$ so that $b_{1} \leqslant a_{1}, \ldots, b_{n} \leqslant a_{n}$, and $b_{1}+\ldots+b_{n}=d$, and consider the polynomial

$$
H\left(x_{1}, \ldots, x_{n}\right)=F\left(x_{1}, \ldots, x_{n}\right)-G_{0}\left(x_{1}+\ldots+x_{n}\right)
$$

on the grid $\left\{0,1, \ldots, b_{1}\right\} \times \ldots \times\left\{0,1, \ldots, b_{n}\right\}$.\\
At the point $\left(b_{1}, \ldots, b_{n}\right)$ we have $H\left(b_{1}, \ldots, b_{n}\right)=G(d)-G_{0}(d) \neq 0$. At all other points of the grid we have $F=G$ and therefore $H=G-G_{0}=0$. So, by the Alon-Fredi bound, deg $H \geqslant b_{1}+\ldots+b_{n}=d$. Since $\operatorname{deg} G_{0}<d$, this implies $\operatorname{deg} F=\operatorname{deg}\left(H+G_{0}\right)=\operatorname{deg} H \geqslant d=\operatorname{deg} G$.",897,4
2018c1,"Let $n \geqslant 3$ be an integer. Prove that there exists a set $S$ of $2 n$ positive integers satisfying the following property: For every $m=2,3, \ldots, n$ the set $S$ can be partitioned into two subsets with equal sums of elements, with one of subsets of cardinality $m$.\\
(Iceland)\\
Solution. We show that one of possible examples is the set

$$
S=\left\{1 \cdot 3^{k}, 2 \cdot 3^{k}: k=1,2, \ldots, n-1\right\} \cup\left\{1, \frac{3^{n}+9}{2}-1\right\}
$$

It is readily verified that all the numbers listed above are distinct (notice that the last two are not divisible by 3 ).

The sum of elements in $S$ is\\
$\Sigma=1+\left(\frac{3^{n}+9}{2}-1\right)+\sum_{k=1}^{n-1}\left(1 \cdot 3^{k}+2 \cdot 3^{k}\right)=\frac{3^{n}+9}{2}+\sum_{k=1}^{n-1} 3^{k+1}=\frac{3^{n}+9}{2}+\frac{3^{n+1}-9}{2}=2 \cdot 3^{n}$.\\
Hence, in order to show that this set satisfies the problem requirements, it suffices to present, for every $m=2,3, \ldots, n$, an $m$-element subset $A_{m} \subset S$ whose sum of elements equals $3^{n}$.

Such a subset is

$$
A_{m}=\left\{2 \cdot 3^{k}: k=n-m+1, n-m+2, \ldots, n-1\right\} \cup\left\{1 \cdot 3^{n-m+1}\right\}
$$

Clearly, $\left|A_{m}\right|=m$. The sum of elements in $A_{m}$ is

$$
3^{n-m+1}+\sum_{k=n-m+1}^{n-1} 2 \cdot 3^{k}=3^{n-m+1}+\frac{2 \cdot 3^{n}-2 \cdot 3^{n-m+1}}{2}=3^{n}
$$

as required.

Comment. Let us present a more general construction. Let $s_{1}, s_{2}, \ldots, s_{2 n-1}$ be a sequence of pairwise distinct positive integers satisfying $s_{2 i+1}=s_{2 i}+s_{2 i-1}$ for all $i=2,3, \ldots, n-1$. Set $s_{2 n}=s_{1}+s_{2}+$ $\cdots+s_{2 n-4}$.

Assume that $s_{2 n}$ is distinct from the other terms of the sequence. Then the set $S=\left\{s_{1}, s_{2}, \ldots, s_{2 n}\right\}$ satisfies the problem requirements. Indeed, the sum of its elements is

$$
\Sigma=\sum_{i=1}^{2 n-4} s_{i}+\left(s_{2 n-3}+s_{2 n-2}\right)+s_{2 n-1}+s_{2 n}=s_{2 n}+s_{2 n-1}+s_{2 n-1}+s_{2 n}=2 s_{2 n}+2 s_{2 n-1}
$$

Therefore, we have

$$
\frac{\Sigma}{2}=s_{2 n}+s_{2 n-1}=s_{2 n}+s_{2 n-2}+s_{2 n-3}=s_{2 n}+s_{2 n-2}+s_{2 n-4}+s_{2 n-5}=\ldots
$$

which shows that the required sets $A_{m}$ can be chosen as

$$
A_{m}=\left\{s_{2 n}, s_{2 n-2}, \ldots, s_{2 n-2 m+4}, s_{2 n-2 m+3}\right\}
$$

So, the only condition to be satisfied is $s_{2 n} \notin\left\{s_{1}, s_{2}, \ldots, s_{2 n-1}\right\}$, which can be achieved in many different ways (e.g., by choosing properly the number $s_{1}$ after specifying $s_{2}, s_{3}, \ldots, s_{2 n-1}$ ).

The solution above is an instance of this general construction. Another instance, for $n>3$, is the set

$$
\left\{F_{1}, F_{2}, \ldots, F_{2 n-1}, F_{1}+\cdots+F_{2 n-4}\right\}
$$

where $F_{1}=1, F_{2}=2, F_{n+1}=F_{n}+F_{n-1}$ is the usual Fibonacci sequence.","Solution. We show that one of possible examples is the set

$$
S=\left\{1 \cdot 3^{k}, 2 \cdot 3^{k}: k=1,2, \ldots, n-1\right\} \cup\left\{1, \frac{3^{n}+9}{2}-1\right\}
$$

It is readily verified that all the numbers listed above are distinct (notice that the last two are not divisible by 3 ).

The sum of elements in $S$ is\\
$\Sigma=1+\left(\frac{3^{n}+9}{2}-1\right)+\sum_{k=1}^{n-1}\left(1 \cdot 3^{k}+2 \cdot 3^{k}\right)=\frac{3^{n}+9}{2}+\sum_{k=1}^{n-1} 3^{k+1}=\frac{3^{n}+9}{2}+\frac{3^{n+1}-9}{2}=2 \cdot 3^{n}$.\\
Hence, in order to show that this set satisfies the problem requirements, it suffices to present, for every $m=2,3, \ldots, n$, an $m$-element subset $A_{m} \subset S$ whose sum of elements equals $3^{n}$.

Such a subset is

$$
A_{m}=\left\{2 \cdot 3^{k}: k=n-m+1, n-m+2, \ldots, n-1\right\} \cup\left\{1 \cdot 3^{n-m+1}\right\}
$$

Clearly, $\left|A_{m}\right|=m$. The sum of elements in $A_{m}$ is

$$
3^{n-m+1}+\sum_{k=n-m+1}^{n-1} 2 \cdot 3^{k}=3^{n-m+1}+\frac{2 \cdot 3^{n}-2 \cdot 3^{n-m+1}}{2}=3^{n}
$$

as required.

Comment. Let us present a more general construction. Let $s_{1}, s_{2}, \ldots, s_{2 n-1}$ be a sequence of pairwise distinct positive integers satisfying $s_{2 i+1}=s_{2 i}+s_{2 i-1}$ for all $i=2,3, \ldots, n-1$. Set $s_{2 n}=s_{1}+s_{2}+$ $\cdots+s_{2 n-4}$.

Assume that $s_{2 n}$ is distinct from the other terms of the sequence. Then the set $S=\left\{s_{1}, s_{2}, \ldots, s_{2 n}\right\}$ satisfies the problem requirements. Indeed, the sum of its elements is

$$
\Sigma=\sum_{i=1}^{2 n-4} s_{i}+\left(s_{2 n-3}+s_{2 n-2}\right)+s_{2 n-1}+s_{2 n}=s_{2 n}+s_{2 n-1}+s_{2 n-1}+s_{2 n}=2 s_{2 n}+2 s_{2 n-1}
$$

Therefore, we have

$$
\frac{\Sigma}{2}=s_{2 n}+s_{2 n-1}=s_{2 n}+s_{2 n-2}+s_{2 n-3}=s_{2 n}+s_{2 n-2}+s_{2 n-4}+s_{2 n-5}=\ldots
$$

which shows that the required sets $A_{m}$ can be chosen as

$$
A_{m}=\left\{s_{2 n}, s_{2 n-2}, \ldots, s_{2 n-2 m+4}, s_{2 n-2 m+3}\right\}
$$

So, the only condition to be satisfied is $s_{2 n} \notin\left\{s_{1}, s_{2}, \ldots, s_{2 n-1}\right\}$, which can be achieved in many different ways (e.g., by choosing properly the number $s_{1}$ after specifying $s_{2}, s_{3}, \ldots, s_{2 n-1}$ ).

The solution above is an instance of this general construction. Another instance, for $n>3$, is the set

$$
\left\{F_{1}, F_{2}, \ldots, F_{2 n-1}, F_{1}+\cdots+F_{2 n-4}\right\}
$$

where $F_{1}=1, F_{2}=2, F_{n+1}=F_{n}+F_{n-1}$ is the usual Fibonacci sequence.",330,3
2018c3,"Let $n$ be a given positive integer. Sisyphus performs a sequence of turns on a board consisting of $n+1$ squares in a row, numbered 0 to $n$ from left to right. Initially, $n$ stones are put into square 0, and the other squares are empty. At every turn, Sisyphus chooses any nonempty square, say with $k$ stones, takes one of those stones and moves it to the right by at most $k$ squares (the stone should stay within the board). Sisyphus' aim is to move all $n$ stones to square $n$.

Prove that Sisyphus cannot reach the aim in less than

$$
\left\lceil\frac{n}{1}\right\rceil+\left\lceil\frac{n}{2}\right\rceil+\left\lceil\frac{n}{3}\right\rceil+\cdots+\left\lceil\frac{n}{n}\right\rceil
$$

turns. (As usual, $\lceil x\rceil$ stands for the least integer not smaller than $x$.)","Solution. The stones are indistinguishable, and all have the same origin and the same final position. So, at any turn we can prescribe which stone from the chosen square to move. We do it in the following manner. Number the stones from 1 to $n$. At any turn, after choosing a square, Sisyphus moves the stone with the largest number from this square.

This way, when stone $k$ is moved from some square, that square contains not more than $k$ stones (since all their numbers are at most $k$ ). Therefore, stone $k$ is moved by at most $k$ squares at each turn. Since the total shift of the stone is exactly $n$, at least $\lceil n / k\rceil$ moves of stone $k$ should have been made, for every $k=1,2, \ldots, n$.

By summing up over all $k=1,2, \ldots, n$, we get the required estimate.

Comment. The original submission contained the second part, asking for which values of $n$ the equality can be achieved. The answer is $n=1,2,3,4,5,7$. The Problem Selection Committee considered this part to be less suitable for the competition, due to technicalities.",185,2
2018c6,"Let $a$ and $b$ be distinct positive integers. The following infinite process takes place on an initially empty board.\\
(i) If there is at least a pair of equal numbers on the board, we choose such a pair and increase one of its components by $a$ and the other by $b$.\\
(ii) If no such pair exists, we write down two times the number 0 .

Prove that, no matter how we make the choices in (i), operation (ii) will be performed only finitely many times.","We may assume $\operatorname{gcd}(a, b)=1$; otherwise we work in the same way with multiples of $d=\operatorname{gcd}(a, b)$.

Suppose that after $N$ moves of type (ii) and some moves of type (i) we have to add two new zeros. For each integer $k$, denote by $f(k)$ the number of times that the number $k$ appeared on the board up to this moment. Then $f(0)=2 N$ and $f(k)=0$ for $k<0$. Since the board contains at most one $k-a$, every second occurrence of $k-a$ on the board produced, at some moment, an occurrence of $k$; the same stands for $k-b$. Therefore,


\begin{equation*}
f(k)=\left\lfloor\frac{f(k-a)}{2}\right\rfloor+\left\lfloor\frac{f(k-b)}{2}\right\rfloor, \tag{1}
\end{equation*}


yielding


\begin{equation*}
f(k) \geqslant \frac{f(k-a)+f(k-b)}{2}-1 . \tag{2}
\end{equation*}


Since $\operatorname{gcd}(a, b)=1$, every integer $x>a b-a-b$ is expressible in the form $x=s a+t b$, with integer $s, t \geqslant 0$.

We will prove by induction on $s+t$ that if $x=s a+b t$, with $s, t$ nonnegative integers, then


\begin{equation*}
f(x)>\frac{f(0)}{2^{s+t}}-2 . \tag{3}
\end{equation*}


The base case $s+t=0$ is trivial. Assume now that (3) is true for $s+t=v$. Then, if $s+t=v+1$ and $x=s a+t b$, at least one of the numbers $s$ and $t$-say $s$ - is positive, hence by (2),

$$
f(x)=f(s a+t b) \geqslant \frac{f((s-1) a+t b)}{2}-1>\frac{1}{2}\left(\frac{f(0)}{2^{s+t-1}}-2\right)-1=\frac{f(0)}{2^{s+t}}-2 .
$$

Assume now that we must perform moves of type (ii) ad infinitum. Take $n=a b-a-b$ and suppose $b>a$. Since each of the numbers $n+1, n+2, \ldots, n+b$ can be expressed in the form $s a+t b$, with $0 \leqslant s \leqslant b$ and $0 \leqslant t \leqslant a$, after moves of type (ii) have been performed $2^{a+b+1}$ times and we have to add a new pair of zeros, each $f(n+k), k=1,2, \ldots, b$, is at least 2 . In this case (1) yields inductively $f(n+k) \geqslant 2$ for all $k \geqslant 1$. But this is absurd: after a finite number of moves, $f$ cannot attain nonzero values at infinitely many points.
",312,3
2018c7,"Consider 2018 pairwise crossing circles no three of which are concurrent. These circles subdivide the plane into regions bounded by circular edges that meet at vertices. Notice that there are an even number of vertices on each circle. Given the circle, alternately colour the vertices on that circle red and blue. In doing so for each circle, every vertex is coloured twice once for each of the two circles that cross at that point. If the two colourings agree at a vertex, then it is assigned that colour; otherwise, it becomes yellow. Show that, if some circle contains at least 2061 yellow points, then the vertices of some region are all yellow.","Letting $n=2018$, we will show that, if every region has at least one non-yellow vertex, then every circle contains at most $n+\lfloor\sqrt{n-2}\rfloor-2$ yellow points. In the case at hand, the latter equals $2018+44-2=2060$, contradicting the hypothesis.

Consider the natural geometric graph $G$ associated with the configuration of $n$ circles. Fix any circle $C$ in the configuration, let $k$ be the number of yellow points on $C$, and find a suitable lower bound for the total number of yellow vertices of $G$ in terms of $k$ and $n$. It turns out that $k$ is even, and $G$ has at least


\begin{equation*}
k+2\binom{k / 2}{2}+2\binom{n-k / 2-1}{2}=\frac{k^{2}}{2}-(n-2) k+(n-2)(n-1) \tag{*}
\end{equation*}


yellow vertices. The proof hinges on the two lemmata below.\\
Lemma 1. Let two circles in the configuration cross at $x$ and $y$. Then $x$ and $y$ are either both yellow or both non-yellow.\\
Proof. This is because the numbers of interior vertices on the four arcs $x$ and $y$ determine on the two circles have like parities.

In particular, each circle in the configuration contains an even number of yellow vertices.\\
Lemma 2. If $\widehat{x y}, \overrightarrow{y z}$, and $\widehat{z x}$ are circular arcs of three pairwise distinct circles in the configuration, then the number of yellow vertices in the set $\{x, y, z\}$ is odd.\\
Proof. Let $C_{1}, C_{2}, C_{3}$ be the three circles under consideration. Assume, without loss of generality, that $C_{2}$ and $C_{3}$ cross at $x, C_{3}$ and $C_{1}$ cross at $y$, and $C_{1}$ and $C_{2}$ cross at $z$. Let $k_{1}$, $k_{2}, k_{3}$ be the numbers of interior vertices on the three circular arcs under consideration. Since each circle in the configuration, different from the $C_{i}$, crosses the cycle $\widehat{x y} \cup \overline{y z} \cup \overline{z x}$ at an even number of points (recall that no three circles are concurrent), and self-crossings are counted twice, the sum $k_{1}+k_{2}+k_{3}$ is even.

Let $Z_{1}$ be the colour $z$ gets from $C_{1}$ and define the other colours similarly. By the preceding, the number of bichromatic pairs in the list $\left(Z_{1}, Y_{1}\right),\left(X_{2}, Z_{2}\right),\left(Y_{3}, X_{3}\right)$ is odd. Since the total number of colour changes in a cycle $Z_{1}-Y_{1}-Y_{3}-X_{3}-X_{2}-Z_{2}-Z_{1}$ is even, the number of bichromatic pairs in the list $\left(X_{2}, X_{3}\right),\left(Y_{1}, Y_{3}\right),\left(Z_{1}, Z_{2}\right)$ is odd, and the lemma follows.

We are now in a position to prove that (\textit{) bounds the total number of yellow vertices from below. Refer to Lemma 1 to infer that the $k$ yellow vertices on $C$ pair off to form the pairs of points where $C$ is crossed by $k / 2$ circles in the configuration. By Lemma 2 , these circles cross pairwise to account for another $2\binom{k / 2}{2}$ yellow vertices. Finally, the remaining $n-k / 2-1$ circles in the configuration cross $C$ at non-yellow vertices, by Lemma 1, and Lemma 2 applies again to show that these circles cross pairwise to account for yet another $2\binom{n-k / 2-1}{2}$ yellow vertices. Consequently, there are at least (}) yellow vertices.

Next, notice that $G$ is a plane graph on $n(n-1)$ degree 4 vertices, having exactly $2 n(n-1)$ edges and exactly $n(n-1)+2$ faces (regions), the outer face inclusive (by Euler's formula for planar graphs).\\
Lemma 3. Each face of $G$ has equally many red and blue vertices. In particular, each face has an even number of non-yellow vertices.

Proof. Trace the boundary of a face once in circular order, and consider the colours each vertex is assigned in the colouring of the two circles that cross at that vertex, to infer that colours of non-yellow vertices alternate.

Consequently, if each region has at least one non-yellow vertex, then it has at least two such. Since each vertex of $G$ has degree 4, consideration of vertex-face incidences shows that $G$ has at least $n(n-1) / 2+1$ non-yellow vertices, and hence at most $n(n-1) / 2-1$ yellow vertices. (In fact, Lemma 3 shows that there are at least $n(n-1) / 4+1 / 2$ red, respectively blue, vertices.)

Finally, recall the lower bound (*) for the total number of yellow vertices in $G$, to write $n(n-1) / 2-1 \geqslant k^{2} / 2-(n-2) k+(n-2)(n-1)$, and conclude that $k \leqslant n+\lfloor\sqrt{n-2}\rfloor-2$, as claimed in the first paragraph.",693,4
2018g1,"Let $A B C$ be an acute-angled triangle with circumcircle $\Gamma$. Let $D$ and $E$ be points on the segments $A B$ and $A C$, respectively, such that $A D=A E$. The perpendicular bisectors of the segments $B D$ and $C E$ intersect the small arcs $\wideparen{A B}$ and $\widetilde{A C}$ at points $F$ and $G$ respectively. Prove that $D E \| F G$.","In the sequel, all the considered arcs are small arcs.\\
Let $P$ be the midpoint of the arc $\widehat{B C}$. Then $A P$ is the bisector of $\angle B A C$, hence, in the isosceles triangle $A D E, A P \perp D E$. So, the statement of the problem is equivalent to $A P \perp F G$.

In order to prove this, let $K$ be the second intersection of $\Gamma$ with $F D$. Then the triangle $F B D$ is isosceles, therefore

$$
\angle A K F=\angle A B F=\angle F D B=\angle A D K,
$$

yielding $A K=A D$. In the same way, denoting by $L$ the second intersection of $\Gamma$ with $G E$, we get $A L=A E$. This shows that $A K=A L$.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_323b76634e0bd94edb63g-38(1)}

Now $\angle F B D=\angle F D B$ gives $\wideparen{A F}=\wideparen{B F}+\wideparen{A K}=\wideparen{B F}+\wideparen{A L}$, hence $\wideparen{B F}=\widehat{L F}$. In a similar way, we get $\wideparen{C G}=\wideparen{G K}$. This yields

$$
\angle(A P, F G)=\frac{\widehat{A F}+\widetilde{P G}}{2}=\frac{\widetilde{A L}+\wideparen{L F}+\wideparen{P C}+\widetilde{C G}}{2}=\frac{\widehat{K L}+\widetilde{L B}+\widehat{B C}+\widetilde{C K}}{4}=90^{\circ} .
$$
",178,2
2018g2,"Let $A B C$ be a triangle with $A B=A C$, and let $M$ be the midpoint of $B C$. Let $P$ be a point such that $P B<P C$ and $P A$ is parallel to $B C$. Let $X$ and $Y$ be points on the lines $P B$ and $P C$, respectively, so that $B$ lies on the segment $P X, C$ lies on the segment $P Y$, and $\angle P X M=\angle P Y M$. Prove that the quadrilateral $A P X Y$ is cyclic.","Since $A B=A C, A M$ is the perpendicular bisector of $B C$, hence $\angle P A M=$ $\angle A M C=90^{\circ}$.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_323b76634e0bd94edb63g-40}

Now let $Z$ be the common point of $A M$ and the perpendicular through $Y$ to $P C$ (notice that $Z$ lies on to the ray $A M$ beyond $M$ ). We have $\angle P A Z=\angle P Y Z=90^{\circ}$. Thus the points $P, A, Y$, and $Z$ are concyclic.

Since $\angle C M Z=\angle C Y Z=90^{\circ}$, the quadrilateral $C Y Z M$ is cyclic, hence $\angle C Z M=$ $\angle C Y M$. By the condition in the statement, $\angle C Y M=\angle B X M$, and, by symmetry in $Z M$, $\angle C Z M=\angle B Z M$. Therefore, $\angle B X M=\angle B Z M$. It follows that the points $B, X, Z$, and $M$ are concyclic, hence $\angle B X Z=180^{\circ}-\angle B M Z=90^{\circ}$.

Finally, we have $\angle P X Z=\angle P Y Z=\angle P A Z=90^{\circ}$, hence the five points $P, A, X, Y, Z$ are concyclic. In particular, the quadrilateral $A P X Y$ is cyclic, as required.

",190,2
2018g4,"A point $T$ is chosen inside a triangle $A B C$. Let $A_{1}, B_{1}$, and $C_{1}$ be the reflections of $T$ in $B C, C A$, and $A B$, respectively. Let $\Omega$ be the circumcircle of the triangle $A_{1} B_{1} C_{1}$. The lines $A_{1} T, B_{1} T$, and $C_{1} T$ meet $\Omega$ again at $A_{2}, B_{2}$, and $C_{2}$, respectively. Prove that the lines $A A_{2}, B B_{2}$, and $C C_{2}$ are concurrent on $\Omega$.","Solution. By $\Varangle(\ell, n)$ we always mean the directed angle of the lines $\ell$ and $n$, taken modulo $180^{\circ}$.\\
Let $C C_{2}$ meet $\Omega$ again at $K$ (as usual, if $C C_{2}$ is tangent to $\Omega$, we set $T=C_{2}$ ). We show that the line $B B_{2}$ contains $K$; similarly, $A A_{2}$ will also pass through $K$. For this purpose, it suffices to prove that


\begin{equation*}
\Varangle\left(C_{2} C, C_{2} A_{1}\right)=\Varangle\left(B_{2} B, B_{2} A_{1}\right) . \tag{1}
\end{equation*}


By the problem condition, $C B$ and $C A$ are the perpendicular bisectors of $T A_{1}$ and $T B_{1}$, respectively. Hence, $C$ is the circumcentre of the triangle $A_{1} T B_{1}$. Therefore,

$$
\Varangle\left(C A_{1}, C B\right)=\Varangle(C B, C T)=\Varangle\left(B_{1} A_{1}, B_{1} T\right)=\Varangle\left(B_{1} A_{1}, B_{1} B_{2}\right) .
$$

In circle $\Omega$ we have $\Varangle\left(B_{1} A_{1}, B_{1} B_{2}\right)=\Varangle\left(C_{2} A_{1}, C_{2} B_{2}\right)$. Thus,


\begin{equation*}
\Varangle\left(C A_{1}, C B\right)=\Varangle\left(B_{1} A_{1}, B_{1} B_{2}\right)=\Varangle\left(C_{2} A_{1}, C_{2} B_{2}\right) . \tag{2}
\end{equation*}


Similarly, we get


\begin{equation*}
\Varangle\left(B A_{1}, B C\right)=\Varangle\left(C_{1} A_{1}, C_{1} C_{2}\right)=\Varangle\left(B_{2} A_{1}, B_{2} C_{2}\right) . \tag{3}
\end{equation*}


The two obtained relations yield that the triangles $A_{1} B C$ and $A_{1} B_{2} C_{2}$ are similar and equioriented, hence

$$
\frac{A_{1} B_{2}}{A_{1} B}=\frac{A_{1} C_{2}}{A_{1} C} \quad \text { and } \quad \Varangle\left(A_{1} B, A_{1} C\right)=\Varangle\left(A_{1} B_{2}, A_{1} C_{2}\right) \text {. }
$$

The second equality may be rewritten as $\Varangle\left(A_{1} B, A_{1} B_{2}\right)=\Varangle\left(A_{1} C, A_{1} C_{2}\right)$, so the triangles $A_{1} B B_{2}$ and $A_{1} C C_{2}$ are also similar and equioriented. This establishes (1).\\
\includegraphics[max width=\textwidth, center]{2025_04_29_323b76634e0bd94edb63g-44}

Comment 1. In fact, the triangle $A_{1} B C$ is an image of $A_{1} B_{2} C_{2}$ under a spiral similarity centred at $A_{1}$; in this case, the triangles $A B B_{2}$ and $A C C_{2}$ are also spirally similar with the same centre.

Comment 2. After obtaining (2) and (3), one can finish the solution in different ways.\\
For instance, introducing the point $X=B C \cap B_{2} C_{2}$, one gets from these relations that the 4 -tuples $\left(A_{1}, B, B_{2}, X\right)$ and $\left(A_{1}, C, C_{2}, X\right)$ are both cyclic. Therefore, $K$ is the Miquel point of the lines $B B_{2}$, $C C_{2}, B C$, and $B_{2} C_{2}$; this yields that the meeting point of $B B_{2}$ and $C C_{2}$ lies on $\Omega$.

Yet another way is to show that the points $A_{1}, B, C$, and $K$ are concyclic, as

$$
\Varangle\left(K C, K A_{1}\right)=\Varangle\left(B_{2} C_{2}, B_{2} A_{1}\right)=\Varangle\left(B C, B A_{1}\right) .
$$

By symmetry, the second point $K^{\prime}$ of intersection of $B B_{2}$ with $\Omega$ is also concyclic to $A_{1}, B$, and $C$, hence $K^{\prime}=K$.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_323b76634e0bd94edb63g-45}

Comment 3. The requirement that the common point of the lines $A A_{2}, B B_{2}$, and $C C_{2}$ should lie on $\Omega$ may seem to make the problem easier, since it suggests some approaches. On the other hand, there are also different ways of showing that the lines $A A_{2}, B B_{2}$, and $C C_{2}$ are just concurrent.

In particular, the problem conditions yield that the lines $A_{2} T, B_{2} T$, and $C_{2} T$ are perpendicular to the corresponding sides of the triangle $A B C$. One may show that the lines $A T, B T$, and $C T$ are also perpendicular to the corresponding sides of the triangle $A_{2} B_{2} C_{2}$, i.e., the triangles $A B C$ and $A_{2} B_{2} C_{2}$ are orthologic, and their orthology centres coincide. It is known that such triangles are also perspective, i.e. the lines $A A_{2}, B B_{2}$, and $C C_{2}$ are concurrent (in projective sense).

To show this mutual orthology, one may again apply angle chasing, but there are also other methods. Let $A^{\prime}, B^{\prime}$, and $C^{\prime}$ be the projections of $T$ onto the sides of the triangle $A B C$. Then $A_{2} T \cdot T A^{\prime}=$ $B_{2} T \cdot T B^{\prime}=C_{2} T \cdot T C^{\prime}$, since all three products equal (minus) half the power of $T$ with respect to $\Omega$. This means that $A_{2}, B_{2}$, and $C_{2}$ are the poles of the sidelines of the triangle $A B C$ with respect to some circle centred at $T$ and having pure imaginary radius (in other words, the reflections of $A_{2}, B_{2}$, and $C_{2}$ in $T$ are the poles of those sidelines with respect to some regular circle centred at $T$ ). Hence, dually, the vertices of the triangle $A B C$ are also the poles of the sidelines of the triangle $A_{2} B_{2} C_{2}$.",726,4
2018g5,"Let $A B C$ be a triangle with circumcircle $\omega$ and incentre $I$. A line $\ell$ intersects the lines $A I, B I$, and $C I$ at points $D, E$, and $F$, respectively, distinct from the points $A, B, C$, and $I$. The perpendicular bisectors $x, y$, and $z$ of the segments $A D, B E$, and $C F$, respectively determine a triangle $\Theta$. Show that the circumcircle of the triangle $\Theta$ is tangent to $\omega$.","Preamble. Let $X=y \cap z, Y=x \cap z, Z=x \cap y$ and let $\Omega$ denote the circumcircle of the triangle $X Y Z$. Denote by $X_{0}, Y_{0}$, and $Z_{0}$ the second intersection points of $A I, B I$ and $C I$, respectively, with $\omega$. It is known that $Y_{0} Z_{0}$ is the perpendicular bisector of $A I, Z_{0} X_{0}$ is the perpendicular bisector of $B I$, and $X_{0} Y_{0}$ is the perpendicular bisector of $C I$. In particular, the triangles $X Y Z$ and $X_{0} Y_{0} Z_{0}$ are homothetic, because their corresponding sides are parallel.

The solutions below mostly exploit the following approach. Consider the triangles $X Y Z$ and $X_{0} Y_{0} Z_{0}$, or some other pair of homothetic triangles $\Delta$ and $\delta$ inscribed into $\Omega$ and $\omega$, respectively. In order to prove that $\Omega$ and $\omega$ are tangent, it suffices to show that the centre $T$ of the homothety taking $\Delta$ to $\delta$ lies on $\omega$ (or $\Omega$ ), or, in other words, to show that $\Delta$ and $\delta$ are perspective (i.e., the lines joining corresponding vertices are concurrent), with their perspector lying on $\omega$ (or $\Omega$ ).

We use directed angles throughout all the solutions.

Claim 1. The reflections $\ell_{a}, \ell_{b}$ and $\ell_{c}$ of the line $\ell$ in the lines $x, y$, and $z$, respectively, are concurrent at a point $T$ which belongs to $\omega$.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_323b76634e0bd94edb63g-46}

Proof. Notice that $\Varangle\left(\ell_{b}, \ell_{c}\right)=\Varangle\left(\ell_{b}, \ell\right)+\Varangle\left(\ell, \ell_{c}\right)=2 \Varangle(y, \ell)+2 \Varangle(\ell, z)=2 \Varangle(y, z)$. But $y \perp B I$ and $z \perp C I$ implies $\Varangle(y, z)=\Varangle(B I, I C)$, so, since $2 \Varangle(B I, I C)=\Varangle(B A, A C)$, we obtain


\begin{equation*}
\Varangle\left(\ell_{b}, \ell_{c}\right)=\Varangle(B A, A C) . \tag{1}
\end{equation*}


Since $A$ is the reflection of $D$ in $x, A$ belongs to $\ell_{a}$; similarly, $B$ belongs to $\ell_{b}$. Then (1) shows that the common point $T^{\prime}$ of $\ell_{a}$ and $\ell_{b}$ lies on $\omega$; similarly, the common point $T^{\prime \prime}$ of $\ell_{c}$ and $\ell_{b}$ lies on $\omega$.

If $B \notin \ell_{a}$ and $B \notin \ell_{c}$, then $T^{\prime}$ and $T^{\prime \prime}$ are the second point of intersection of $\ell_{b}$ and $\omega$, hence they coincide. Otherwise, if, say, $B \in \ell_{c}$, then $\ell_{c}=B C$, so $\Varangle(B A, A C)=\Varangle\left(\ell_{b}, \ell_{c}\right)=\Varangle\left(\ell_{b}, B C\right)$, which shows that $\ell_{b}$ is tangent at $B$ to $\omega$ and $T^{\prime}=T^{\prime \prime}=B$. So $T^{\prime}$ and $T^{\prime \prime}$ coincide in all the cases, and the conclusion of the claim follows.

Now we prove that $X, X_{0}, T$ are collinear. Denote by $D_{b}$ and $D_{c}$ the reflections of the point $D$ in the lines $y$ and $z$, respectively. Then $D_{b}$ lies on $\ell_{b}, D_{c}$ lies on $\ell_{c}$, and

$$
\begin{aligned}
\Varangle\left(D_{b} X, X D_{c}\right) & =\Varangle\left(D_{b} X, D X\right)+\Varangle\left(D X, X D_{c}\right)=2 \Varangle(y, D X)+2 \Varangle(D X, z)=2 \Varangle(y, z) \\
& =\Varangle(B A, A C)=\Varangle(B T, T C),
\end{aligned}
$$

hence the quadrilateral $X D_{b} T D_{c}$ is cyclic. Notice also that since $X D_{b}=X D=X D_{c}$, the points $D, D_{b}, D_{c}$ lie on a circle with centre $X$. Using in this circle the diameter $D_{c} D_{c}^{\prime}$ yields $\Varangle\left(D_{b} D_{c}, D_{c} X\right)=90^{\circ}+\Varangle\left(D_{b} D_{c}^{\prime}, D_{c}^{\prime} X\right)=90^{\circ}+\Varangle\left(D_{b} D, D D_{c}\right)$. Therefore,

$$
\begin{gathered}
\Varangle\left(\ell_{b}, X T\right)=\Varangle\left(D_{b} T, X T\right)=\Varangle\left(D_{b} D_{c}, D_{c} X\right)=90^{\circ}+\Varangle\left(D_{b} D, D D_{c}\right) \\
=90^{\circ}+\Varangle(B I, I C)=\Varangle(B A, A I)=\Varangle\left(B A, A X_{0}\right)=\Varangle\left(B T, T X_{0}\right)=\Varangle\left(\ell_{b}, X_{0} T\right),
\end{gathered}
$$

so the points $X, X_{0}, T$ are collinear. By a similar argument, $Y, Y_{0}, T$ and $Z, Z_{0}, T$ are collinear. As mentioned in the preamble, the statement of the problem follows.

",582,4
2018g6,A convex quadrilateral $A B C D$ satisfies $A B \cdot C D=B C \cdot D A$. A point $X$ is chosen inside the quadrilateral so that $\angle X A B=\angle X C D$ and $\angle X B C=\angle X D A$. Prove that $\angle A X B+$ $\angle C X D=180^{\circ}$.,"Let $B^{\prime}$ be the reflection of $B$ in the internal angle bisector of $\angle A X C$, so that $\angle A X B^{\prime}=\angle C X B$ and $\angle C X B^{\prime}=\angle A X B$. If $X, D$, and $B^{\prime}$ are collinear, then we are done. Now assume the contrary.

On the ray $X B^{\prime}$ take a point $E$ such that $X E \cdot X B=X A \cdot X C$, so that $\triangle A X E \sim$ $\triangle B X C$ and $\triangle C X E \sim \triangle B X A$. We have $\angle X C E+\angle X C D=\angle X B A+\angle X A B<180^{\circ}$ and $\angle X A E+\angle X A D=\angle X D A+\angle X A D<180^{\circ}$, which proves that $X$ lies inside the angles $\angle E C D$ and $\angle E A D$ of the quadrilateral $E A D C$. Moreover, $X$ lies in the interior of exactly one of the two triangles $E A D, E C D$ (and in the exterior of the other).\\
\includegraphics[max width=\textwidth, center]{2025_04_29_323b76634e0bd94edb63g-50}

The similarities mentioned above imply $X A \cdot B C=X B \cdot A E$ and $X B \cdot C E=X C \cdot A B$. Multiplying these equalities with the given equality $A B \cdot C D=B C \cdot D A$, we obtain $X A \cdot C D$. $C E=X C \cdot A D \cdot A E$, or, equivalently,


\begin{equation*}
\frac{X A \cdot D E}{A D \cdot A E}=\frac{X C \cdot D E}{C D \cdot C E} . \tag{*}
\end{equation*}


Lemma. Let $P Q R$ be a triangle, and let $X$ be a point in the interior of the angle $Q P R$ such that $\angle Q P X=\angle P R X$. Then $\frac{P X \cdot Q R}{P Q \cdot P R}<1$ if and only if $X$ lies in the interior of the triangle $P Q R$.\\
Proof. The locus of points $X$ with $\angle Q P X=\angle P R X$ lying inside the angle $Q P R$ is an arc $\alpha$ of the circle $\gamma$ through $R$ tangent to $P Q$ at $P$. Let $\gamma$ intersect the line $Q R$ again at $Y$ (if $\gamma$ is tangent to $Q R$, then set $Y=R$ ). The similarity $\triangle Q P Y \sim \triangle Q R P$ yields $P Y=\frac{P Q \cdot P R}{Q R}$. Now it suffices to show that $P X<P Y$ if and only if $X$ lies in the interior of the triangle $P Q R$. Let $m$ be a line through $Y$ parallel to $P Q$. Notice that the points $Z$ of $\gamma$ satisfying $P Z<P Y$ are exactly those between the lines $m$ and $P Q$.

Case 1: $Y$ lies in the segment $Q R$ (see the left figure below).\\
In this case $Y$ splits $\alpha$ into two arcs $\widehat{P Y}$ and $\widehat{Y R}$. The arc $\widehat{P Y}$ lies inside the triangle $P Q R$, and $\wideparen{P Y}$ lies between $m$ and $P Q$, hence $P X<P Y$ for points $X \in \widetilde{P Y}$. The other $\operatorname{arc} \widehat{Y R}$ lies outside triangle $P Q R$, and $\overline{Y R}$ is on the opposite side of $m$ than $P$, hence $P X>P Y$ for $X \in \widehat{Y R}$.

Case 2: $Y$ lies on the ray $Q R$ beyond $R$ (see the right figure below).\\
In this case the whole arc $\alpha$ lies inside triangle $P Q R$, and between $m$ and $P Q$, thus $P X<$ $P Y$ for all $X \in \alpha$.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_323b76634e0bd94edb63g-51}

Applying the Lemma (to $\triangle E A D$ with the point $X$, and to $\triangle E C D$ with the point $X$ ), we obtain that exactly one of two expressions $\frac{X A \cdot D E}{A D \cdot A E}$ and $\frac{X C \cdot D E}{C D \cdot C E}$ is less than 1 , which contradicts (*).

",637,4
2018g7,"Let $O$ be the circumcentre, and $\Omega$ be the circumcircle of an acute-angled triangle $A B C$. Let $P$ be an arbitrary point on $\Omega$, distinct from $A, B, C$, and their antipodes in $\Omega$. Denote the circumcentres of the triangles $A O P, B O P$, and $C O P$ by $O_{A}, O_{B}$, and $O_{C}$, respectively. The lines $\ell_{A}, \ell_{B}$, and $\ell_{C}$ perpendicular to $B C, C A$, and $A B$ pass through $O_{A}, O_{B}$, and $O_{C}$, respectively. Prove that the circumcircle of the triangle formed by $\ell_{A}, \ell_{B}$, and $\ell_{C}$ is tangent to the line $O P$.","Solution. As usual, we denote the directed angle between the lines $a$ and $b$ by $\Varangle(a, b)$. We frequently use the fact that $a_{1} \perp a_{2}$ and $b_{1} \perp b_{2}$ yield $\Varangle\left(a_{1}, b_{1}\right)=\Varangle\left(a_{2}, b_{2}\right)$.

Let the lines $\ell_{B}$ and $\ell_{C}$ meet at $L_{A}$; define the points $L_{B}$ and $L_{C}$ similarly. Note that the sidelines of the triangle $L_{A} L_{B} L_{C}$ are perpendicular to the corresponding sidelines of $A B C$. Points $O_{A}, O_{B}, O_{C}$ are located on the corresponding sidelines of $L_{A} L_{B} L_{C}$; moreover, $O_{A}, O_{B}$, $O_{C}$ all lie on the perpendicular bisector of $O P$.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_323b76634e0bd94edb63g-54}

Claim 1. The points $L_{B}, P, O_{A}$, and $O_{C}$ are concyclic.\\
Proof. Since $O$ is symmetric to $P$ in $O_{A} O_{C}$, we have

$$
\Varangle\left(O_{A} P, O_{C} P\right)=\Varangle\left(O_{C} O, O_{A} O\right)=\Varangle(C P, A P)=\Varangle(C B, A B)=\Varangle\left(O_{A} L_{B}, O_{C} L_{B}\right) .
$$

Denote the circle through $L_{B}, P, O_{A}$, and $O_{C}$ by $\omega_{B}$. Define the circles $\omega_{A}$ and $\omega_{C}$ similarly.\\
Claim 2. The circumcircle of the triangle $L_{A} L_{B} L_{C}$ passes through $P$.\\
Proof. From cyclic quadruples of points in the circles $\omega_{B}$ and $\omega_{C}$, we have

$$
\begin{aligned}
\Varangle\left(L_{C} L_{A}, L_{C} P\right) & =\Varangle\left(L_{C} O_{B}, L_{C} P\right)=\Varangle\left(O_{A} O_{B}, O_{A} P\right) \\
& =\Varangle\left(O_{A} O_{C}, O_{A} P\right)=\Varangle\left(L_{B} O_{C}, L_{B} P\right)=\Varangle\left(L_{B} L_{A}, L_{B} P\right) .
\end{aligned}
$$

Claim 3. The points $P, L_{C}$, and $C$ are collinear.\\
Proof. We have $\Varangle\left(P L_{C}, L_{C} L_{A}\right)=\Varangle\left(P L_{C}, L_{C} O_{B}\right)=\Varangle\left(P O_{A}, O_{A} O_{B}\right)$. Further, since $O_{A}$ is the centre of the circle $A O P, \Varangle\left(P O_{A}, O_{A} O_{B}\right)=\Varangle(P A, A O)$. As $O$ is the circumcentre of the triangle $P C A, \Varangle(P A, A O)=\pi / 2-\Varangle(C A, C P)=\Varangle\left(C P, L_{C} L_{A}\right)$. We obtain $\Varangle\left(P L_{C}, L_{C} L_{A}\right)=$ $\Varangle\left(C P, L_{C} L_{A}\right)$, which shows that $P \in C L_{C}$.

Similarly, the points $P, L_{A}, A$ are collinear, and the points $P, L_{B}, B$ are also collinear. Finally, the computation above also shows that

$$
\Varangle\left(O P, P L_{A}\right)=\Varangle(P A, A O)=\Varangle\left(P L_{C}, L_{C} L_{A}\right),
$$

which means that $O P$ is tangent to the circle $P L_{A} L_{B} L_{C}$.

Comment 1. The proof of Claim 2 may be replaced by the following remark: since $P$ belongs to the circles $\omega_{A}$ and $\omega_{C}, P$ is the Miquel point of the four lines $\ell_{A}, \ell_{B}, \ell_{C}$, and $O_{A} O_{B} O_{C}$.

Comment 2. Claims 2 and 3 can be proved in several different ways and, in particular, in the reverse order.

Claim 3 implies that the triangles $A B C$ and $L_{A} L_{B} L_{C}$ are perspective with perspector $P$. Claim 2 can be derived from this observation using spiral similarity. Consider the centre $Q$ of the spiral similarity that maps $A B C$ to $L_{A} L_{B} L_{C}$. From known spiral similarity properties, the points $L_{A}, L_{B}, P, Q$ are concyclic, and so are $L_{A}, L_{C}, P, Q$.

Comment 3. The final conclusion can also be proved it terms of spiral similarity: the spiral similarity with centre $Q$ located on the circle $A B C$ maps the circle $A B C$ to the circle $P L_{A} L_{B} L_{C}$. Thus these circles are orthogonal.

Comment 4. Notice that the homothety with centre $O$ and ratio 2 takes $O_{A}$ to $A^{\prime}$ that is the common point of tangents to $\Omega$ at $A$ and $P$. Similarly, let this homothety take $O_{B}$ to $B^{\prime}$ and $O_{C}$ to $C^{\prime}$. Let the tangents to $\Omega$ at $B$ and $C$ meet at $A^{\prime \prime}$, and define the points $B^{\prime \prime}$ and $C^{\prime \prime}$ similarly. Now, replacing labels $O$ with $I, \Omega$ with $\omega$, and swapping labels $A \leftrightarrow A^{\prime \prime}, B \leftrightarrow B^{\prime \prime}, C \leftrightarrow C^{\prime \prime}$ we obtain the following

Reformulation. Let $\omega$ be the incircle, and let $I$ be the incentre of a triangle $A B C$. Let $P$ be a point of $\omega$ (other than the points of contact of $\omega$ with the sides of $A B C$ ). The tangent to $\omega$ at $P$ meets the lines $A B, B C$, and $C A$ at $A^{\prime}, B^{\prime}$, and $C^{\prime}$, respectively. Line $\ell_{A}$ parallel to the internal angle bisector of $\angle B A C$ passes through $A^{\prime}$; define lines $\ell_{B}$ and $\ell_{C}$ similarly. Prove that the line $I P$ is tangent to the circumcircle of the triangle formed by $\ell_{A}, \ell_{B}$, and $\ell_{C}$.

Though this formulation is equivalent to the original one, it seems more challenging, since the point of contact is now ""hidden"".",736,4
2018n2,"Let $n>1$ be a positive integer. Each cell of an $n \times n$ table contains an integer. Suppose that the following conditions are satisfied:\\
(i) Each number in the table is congruent to 1 modulo $n$;\\
(ii) The sum of numbers in any row, as well as the sum of numbers in any column, is congruent to $n$ modulo $n^{2}$.

Let $R_{i}$ be the product of the numbers in the $i^{\text {th }}$ row, and $C_{j}$ be the product of the numbers in the $j^{\text {th }}$ column. Prove that the sums $R_{1}+\cdots+R_{n}$ and $C_{1}+\cdots+C_{n}$ are congruent modulo $n^{4}$.","Let $A_{i, j}$ be the entry in the $i^{\text {th }}$ row and the $j^{\text {th }}$ column; let $P$ be the product of all $n^{2}$ entries. For convenience, denote $a_{i, j}=A_{i, j}-1$ and $r_{i}=R_{i}-1$. We show that


\begin{equation*}
\sum_{i=1}^{n} R_{i} \equiv(n-1)+P \quad\left(\bmod n^{4}\right) \tag{1}
\end{equation*}


Due to symmetry of the problem conditions, the sum of all the $C_{j}$ is also congruent to $(n-1)+P$ modulo $n^{4}$, whence the conclusion.

By condition $(i)$, the number $n$ divides $a_{i, j}$ for all $i$ and $j$. So, every product of at least two of the $a_{i, j}$ is divisible by $n^{2}$, hence\\
$R_{i}=\prod_{j=1}^{n}\left(1+a_{i, j}\right)=1+\sum_{j=1}^{n} a_{i, j}+\sum_{1 \leqslant j_{1}<j_{2} \leqslant n} a_{i, j_{1}} a_{i, j_{2}}+\cdots \equiv 1+\sum_{j=1}^{n} a_{i, j} \equiv 1-n+\sum_{j=1}^{n} A_{i, j} \quad\left(\bmod n^{2}\right)$\\
for every index $i$. Using condition $(i i)$, we obtain $R_{i} \equiv 1\left(\bmod n^{2}\right)$, and so $n^{2} \mid r_{i}$.\\
Therefore, every product of at least two of the $r_{i}$ is divisible by $n^{4}$. Repeating the same argument, we obtain

$$
P=\prod_{i=1}^{n} R_{i}=\prod_{i=1}^{n}\left(1+r_{i}\right) \equiv 1+\sum_{i=1}^{n} r_{i} \quad\left(\bmod n^{4}\right)
$$

whence

$$
\sum_{i=1}^{n} R_{i}=n+\sum_{i=1}^{n} r_{i} \equiv n+(P-1) \quad\left(\bmod n^{4}\right)
$$

as desired.


",181,2
2018n3,"Define the sequence $a_{0}, a_{1}, a_{2}, \ldots$ by $a_{n}=2^{n}+2^{\lfloor n / 2\rfloor}$. Prove that there are infinitely many terms of the sequence which can be expressed as a sum of (two or more) distinct terms of the sequence, as well as infinitely many of those which cannot be expressed in such a way.","Call a nonnegative integer representable if it equals the sum of several (possibly 0 or 1) distinct terms of the sequence. We say that two nonnegative integers $b$ and $c$ are equivalent (written as $b \sim c$ ) if they are either both representable or both non-representable.

One can easily compute

$$
S_{n-1}:=a_{0}+\cdots+a_{n-1}=2^{n}+2^{\lceil n / 2\rceil}+2^{\lfloor n / 2\rfloor}-3
$$

Indeed, we have $S_{n}-S_{n-1}=2^{n}+2^{\lfloor n / 2\rfloor}=a_{n}$ so we can use the induction. In particular, $S_{2 k-1}=2^{2 k}+2^{k+1}-3$.

Note that, if $n \geqslant 3$, then $2^{[n / 2\rceil} \geqslant 2^{2}>3$, so

$$
S_{n-1}=2^{n}+2^{\lceil n / 2\rceil}+2^{\lfloor n / 2\rfloor}-3>2^{n}+2^{\lfloor n / 2\rfloor}=a_{n}
$$

Also notice that $S_{n-1}-a_{n}=2^{[n / 2]}-3<a_{n}$.\\
The main tool of the solution is the following claim.\\
Claim 1. Assume that $b$ is a positive integer such that $S_{n-1}-a_{n}<b<a_{n}$ for some $n \geqslant 3$. Then $b \sim S_{n-1}-b$.\\
Proof. As seen above, we have $S_{n-1}>a_{n}$. Denote $c=S_{n-1}-b$; then $S_{n-1}-a_{n}<c<a_{n}$, so the roles of $b$ and $c$ are symmetrical.

Assume that $b$ is representable. The representation cannot contain $a_{i}$ with $i \geqslant n$, since $b<a_{n}$. So $b$ is the sum of some subset of $\left\{a_{0}, a_{1}, \ldots, a_{n-1}\right\}$; then $c$ is the sum of the complement. The converse is obtained by swapping $b$ and $c$.

We also need the following version of this claim.\\
Claim 2. For any $n \geqslant 3$, the number $a_{n}$ can be represented as a sum of two or more distinct terms of the sequence if and only if $S_{n-1}-a_{n}=2^{[n / 2]}-3$ is representable.\\
Proof. Denote $c=S_{n-1}-a_{n}<a_{n}$. If $a_{n}$ satisfies the required condition, then it is the sum of some subset of $\left\{a_{0}, a_{1}, \ldots, a_{n-1}\right\}$; then $c$ is the sum of the complement. Conversely, if $c$ is representable, then its representation consists only of the numbers from $\left\{a_{0}, \ldots, a_{n-1}\right\}$, so $a_{n}$ is the sum of the complement.

By Claim 2, in order to prove the problem statement, it suffices to find infinitely many representable numbers of the form $2^{t}-3$, as well as infinitely many non-representable ones.\\
Claim 3. For every $t \geqslant 3$, we have $2^{t}-3 \sim 2^{4 t-6}-3$, and $2^{4 t-6}-3>2^{t}-3$.\\
Proof. The inequality follows from $t \geqslant 3$. In order to prove the equivalence, we apply Claim 1 twice in the following manner.

First, since $S_{2 t-3}-a_{2 t-2}=2^{t-1}-3<2^{t}-3<2^{2 t-2}+2^{t-1}=a_{2 t-2}$, by Claim 1 we have $2^{t}-3 \sim S_{2 t-3}-\left(2^{t}-3\right)=2^{2 t-2}$.

Second, since $S_{4 t-7}-a_{4 t-6}=2^{2 t-3}-3<2^{2 t-2}<2^{4 t-6}+2^{2 t-3}=a_{4 t-6}$, by Claim 1 we have $2^{2 t-2} \sim S_{4 t-7}-2^{2 t-2}=2^{4 t-6}-3$.

Therefore, $2^{t}-3 \sim 2^{2 t-2} \sim 2^{4 t-6}-3$, as required.\\
Now it is easy to find the required numbers. Indeed, the number $2^{3}-3=5=a_{0}+a_{1}$ is representable, so Claim 3 provides an infinite sequence of representable numbers

$$
2^{3}-3 \sim 2^{6}-3 \sim 2^{18}-3 \sim \cdots \sim 2^{t}-3 \sim 2^{4 t-6}-3 \sim \cdots
$$

On the other hand, the number $2^{7}-3=125$ is non-representable (since by Claim 1 we have $125 \sim S_{6}-125=24 \sim S_{4}-24=17 \sim S_{3}-17=4$ which is clearly non-representable). So Claim 3 provides an infinite sequence of non-representable numbers

$$
2^{7}-3 \sim 2^{22}-3 \sim 2^{82}-3 \sim \cdots \sim 2^{t}-3 \sim 2^{4 t-6}-3 \sim \cdots
$$
",514,4
2018n4,"Let $a_{1}, a_{2}, \ldots, a_{n}, \ldots$ be a sequence of positive integers such that

$$
\frac{a_{1}}{a_{2}}+\frac{a_{2}}{a_{3}}+\cdots+\frac{a_{n-1}}{a_{n}}+\frac{a_{n}}{a_{1}}
$$

is an integer for all $n \geqslant k$, where $k$ is some positive integer. Prove that there exists a positive integer $m$ such that $a_{n}=a_{n+1}$ for all $n \geqslant m$.","The argument hinges on the following two facts: Let $a, b, c$ be positive integers such that $N=b / c+(c-b) / a$ is an integer.\\
(1) If $\operatorname{gcd}(a, c)=1$, then $c$ divides $b$; and\\
(2) If $\operatorname{gcd}(a, b, c)=1$, then $\operatorname{gcd}(a, b)=1$.

To prove (1), write $a b=c(a N+b-c)$. Since $\operatorname{gcd}(a, c)=1$, it follows that $c$ divides $b$. To prove (2), write $c^{2}-b c=a(c N-b)$ to infer that $a$ divides $c^{2}-b c$. Letting $d=\operatorname{gcd}(a, b)$, it follows that $d$ divides $c^{2}$, and since the two are relatively prime by hypothesis, $d=1$.

Now, let $s_{n}=a_{1} / a_{2}+a_{2} / a_{3}+\cdots+a_{n-1} / a_{n}+a_{n} / a_{1}$, let $\delta_{n}=\operatorname{gcd}\left(a_{1}, a_{n}, a_{n+1}\right)$ and write

$$
s_{n+1}-s_{n}=\frac{a_{n}}{a_{n+1}}+\frac{a_{n+1}-a_{n}}{a_{1}}=\frac{a_{n} / \delta_{n}}{a_{n+1} / \delta_{n}}+\frac{a_{n+1} / \delta_{n}-a_{n} / \delta_{n}}{a_{1} / \delta_{n}} .
$$

Let $n \geqslant k$. Since $\operatorname{gcd}\left(a_{1} / \delta_{n}, a_{n} / \delta_{n}, a_{n+1} / \delta_{n}\right)=1$, it follows by (2) that $\operatorname{gcd}\left(a_{1} / \delta_{n}, a_{n} / \delta_{n}\right)=1$. Let $d_{n}=\operatorname{gcd}\left(a_{1}, a_{n}\right)$. Then $d_{n}=\delta_{n} \cdot \operatorname{gcd}\left(a_{1} / \delta_{n}, a_{n} / \delta_{n}\right)=\delta_{n}$, so $d_{n}$ divides $a_{n+1}$, and therefore $d_{n}$ divides $d_{n+1}$.

Consequently, from some rank on, the $d_{n}$ form a nondecreasing sequence of integers not exceeding $a_{1}$, so $d_{n}=d$ for all $n \geqslant \ell$, where $\ell$ is some positive integer.

Finally, since $\operatorname{gcd}\left(a_{1} / d, a_{n+1} / d\right)=1$, it follows by (1) that $a_{n+1} / d$ divides $a_{n} / d$, so $a_{n} \geqslant a_{n+1}$ for all $n \geqslant \ell$. The conclusion follows.

",229,2
2018n6,"Let $f:\{1,2,3, \ldots\} \rightarrow\{2,3, \ldots\}$ be a function such that $f(m+n) \mid f(m)+f(n)$ for all pairs $m, n$ of positive integers. Prove that there exists a positive integer $c>1$ which divides all values of $f$.","For every positive integer $m$, define $S_{m}=\{n: m \mid f(n)\}$.\\
Lemma. If the set $S_{m}$ is infinite, then $S_{m}=\{d, 2 d, 3 d, \ldots\}=d \cdot \mathbb{Z}_{>0}$ for some positive integer $d$.\\
Proof. Let $d=\min S_{m}$; the definition of $S_{m}$ yields $m \mid f(d)$.\\
Whenever $n \in S_{m}$ and $n>d$, we have $m|f(n)| f(n-d)+f(d)$, so $m \mid f(n-d)$ and therefore $n-d \in S_{m}$. Let $r \leqslant d$ be the least positive integer with $n \equiv r(\bmod d)$; repeating the same step, we can see that $n-d, n-2 d, \ldots, r \in S_{m}$. By the minimality of $d$, this shows $r=d$ and therefore $d \mid n$.

Starting from an arbitrarily large element of $S_{m}$, the process above reaches all multiples of $d$; so they all are elements of $S_{m}$.

The solution for the problem will be split into two cases.\\
Case 1: The function $f$ is bounded.\\
Call a prime $p$ frequent if the set $S_{p}$ is infinite, i.e., if $p$ divides $f(n)$ for infinitely many positive integers $n$; otherwise call $p$ sporadic. Since the function $f$ is bounded, there are only a finite number of primes that divide at least one $f(n)$; so altogether there are finitely many numbers $n$ such that $f(n)$ has a sporadic prime divisor. Let $N$ be a positive integer, greater than all those numbers $n$.

Let $p_{1}, \ldots, p_{k}$ be the frequent primes. By the lemma we have $S_{p_{i}}=d_{i} \cdot \mathbb{Z}_{>0}$ for some $d_{i}$. Consider the number

$$
n=N d_{1} d_{2} \cdots d_{k}+1
$$

Due to $n>N$, all prime divisors of $f(n)$ are frequent primes. Let $p_{i}$ be any frequent prime divisor of $f(n)$. Then $n \in S_{p_{i}}$, and therefore $d_{i} \mid n$. But $n \equiv 1\left(\bmod d_{i}\right)$, which means $d_{i}=1$. Hence $S_{p_{i}}=1 \cdot \mathbb{Z}_{>0}=\mathbb{Z}_{>0}$ and therefore $p_{i}$ is a common divisor of all values $f(n)$.

Case 2: $f$ is unbounded.\\
We prove that $f(1)$ divides all $f(n)$.\\
Let $a=f(1)$. Since $1 \in S_{a}$, by the lemma it suffices to prove that $S_{a}$ is an infinite set.\\
Call a positive integer $p$ a peak if $f(p)>\max (f(1), \ldots, f(p-1))$. Since $f$ is not bounded, there are infinitely many peaks. Let $1=p_{1}<p_{2}<\ldots$ be the sequence of all peaks, and let $h_{k}=f\left(p_{k}\right)$. Notice that for any peak $p_{i}$ and for any $k<p_{i}$, we have $f\left(p_{i}\right) \mid f(k)+f\left(p_{i}-k\right)<$ $2 f\left(p_{i}\right)$, hence


\begin{equation*}
f(k)+f\left(p_{i}-k\right)=f\left(p_{i}\right)=h_{i} \tag{1}
\end{equation*}


By the pigeonhole principle, among the numbers $h_{1}, h_{2}, \ldots$ there are infinitely many that are congruent modulo $a$. Let $k_{0}<k_{1}<k_{2}<\ldots$ be an infinite sequence of positive integers such that $h_{k_{0}} \equiv h_{k_{1}} \equiv \ldots(\bmod a)$. Notice that

$$
f\left(p_{k_{i}}-p_{k_{0}}\right)=f\left(p_{k_{i}}\right)-f\left(p_{k_{0}}\right)=h_{k_{i}}-h_{k_{0}} \equiv 0 \quad(\bmod a)
$$

so $p_{k_{i}}-p_{k_{0}} \in S_{a}$ for all $i=1,2, \ldots$. This provides infinitely many elements in $S_{a}$.\\
Hence, $S_{a}$ is an infinite set, and therefore $f(1)=a$ divides $f(n)$ for every $n$.

Comment. As an extension of the solution above, it can be proven that if $f$ is not bounded then $f(n)=a n$ with $a=f(1)$.

Take an arbitrary positive integer $n$; we will show that $f(n+1)=f(n)+a$. Then it follows by induction that $f(n)=a n$.

Take a peak $p$ such that $p>n+2$ and $h=f(p)>f(n)+2 a$. By (1) we have $f(p-1)=$ $f(p)-f(1)=h-a$ and $f(n+1)=f(p)-f(p-n-1)=h-f(p-n-1)$. From $h-a=f(p-1) \mid$ $f(n)+f(p-n-1)<f(n)+h<2(h-a)$ we get $f(n)+f(p-n-1)=h-a$. Then

$$
f(n+1)-f(n)=(h-f(p-n-1))-(h-a-f(p-n-1))=a
$$

On the other hand, there exists a wide family of bounded functions satisfying the required properties. Here we present a few examples:

$$
f(n)=c ; \quad f(n)=\left\{\begin{array}{ll}
2 c & \text { if } n \text { is even } \\
c & \text { if } n \text { is odd; }
\end{array} \quad f(n)= \begin{cases}2018 c & \text { if } n \leqslant 2018 \\
c & \text { if } n>2018\end{cases}\right.
$$
",606,4
2018n7,"Let $n \geqslant 2018$ be an integer, and let $a_{1}, a_{2}, \ldots, a_{n}, b_{1}, b_{2}, \ldots, b_{n}$ be pairwise distinct positive integers not exceeding $5 n$. Suppose that the sequence


\begin{equation*}
\frac{a_{1}}{b_{1}}, \frac{a_{2}}{b_{2}}, \ldots, \frac{a_{n}}{b_{n}} \tag{1}
\end{equation*}


forms an arithmetic progression. Prove that the terms of the sequence are equal.","Solution. Suppose that (1) is an arithmetic progression with nonzero difference. Let the difference be $\Delta=\frac{c}{d}$, where $d>0$ and $c, d$ are coprime.

We will show that too many denominators $b_{i}$ should be divisible by $d$. To this end, for any $1 \leqslant i \leqslant n$ and any prime divisor $p$ of $d$, say that the index $i$ is $p$-wrong, if $v_{p}\left(b_{i}\right)<v_{p}(d) .\left(v_{p}(x)\right.$ stands for the exponent of $p$ in the prime factorisation of $x$.)\\
Claim 1. For any prime $p$, all $p$-wrong indices are congruent modulo $p$. In other words, the $p$-wrong indices (if they exist) are included in an arithmetic progression with difference $p$.\\
Proof. Let $\alpha=v_{p}(d)$. For the sake of contradiction, suppose that $i$ and $j$ are $p$-wrong indices (i.e., none of $b_{i}$ and $b_{j}$ is divisible by $\left.p^{\alpha}\right)$ such that $i \not \equiv j(\bmod p)$. Then the least common denominator of $\frac{a_{i}}{b_{i}}$ and $\frac{a_{j}}{b_{j}}$ is not divisible by $p^{\alpha}$. But this is impossible because in their difference, $(i-j) \Delta=\frac{(i-j) c}{d}$, the numerator is coprime to $p$, but $p^{\alpha}$ divides the denominator $d$.

Claim 2. $d$ has no prime divisors greater than 5 .\\
Proof. Suppose that $p \geqslant 7$ is a prime divisor of $d$. Among the indices $1,2, \ldots, n$, at most $\left\lceil\frac{n}{p}\right\rceil<\frac{n}{p}+1$ are $p$-wrong, so $p$ divides at least $\frac{p-1}{p} n-1$ of $b_{1}, \ldots, b_{n}$. Since these denominators are distinct,

$$
5 n \geqslant \max \left\{b_{i}: p \mid b_{i}\right\} \geqslant\left(\frac{p-1}{p} n-1\right) p=(p-1)(n-1)-1 \geqslant 6(n-1)-1>5 n
$$

a contradiction.\\
Claim 3. For every $0 \leqslant k \leqslant n-30$, among the denominators $b_{k+1}, b_{k+2}, \ldots, b_{k+30}$, at least $\varphi(30)=8$ are divisible by $d$.\\
Proof. By Claim 1, the 2 -wrong, 3 -wrong and 5 -wrong indices can be covered by three arithmetic progressions with differences 2,3 and 5 . By a simple inclusion-exclusion, $(2-1) \cdot(3-1) \cdot(5-1)=8$ indices are not covered; by Claim 2, we have $d \mid b_{i}$ for every uncovered index $i$.

Claim 4. $|\Delta|<\frac{20}{n-2}$ and $d>\frac{n-2}{20}$.\\
Proof. From the sequence (1), remove all fractions with $b_{n}<\frac{n}{2}$, There remain at least $\frac{n}{2}$ fractions, and they cannot exceed $\frac{5 n}{n / 2}=10$. So we have at least $\frac{n}{2}$ elements of the arithmetic progression (1) in the interval $(0,10]$, hence the difference must be below $\frac{10}{n / 2-1}=\frac{20}{n-2}$.

The second inequality follows from $\frac{1}{d} \leqslant \frac{|c|}{d}=|\Delta|$.\\
Now we have everything to get the final contradiction. By Claim 3, we have $d \mid b_{i}$ for at least $\left\lfloor\frac{n}{30}\right\rfloor$. 8 indices $i$. By Claim 4, we have $d \geqslant \frac{n-2}{20}$. Therefore,

$$
5 n \geqslant \max \left\{b_{i}: d \mid b_{i}\right\} \geqslant\left(\left\lfloor\frac{n}{30}\right\rfloor \cdot 8\right) \cdot d>\left(\frac{n}{30}-1\right) \cdot 8 \cdot \frac{n-2}{20}>5 n
$$

Comment 1. It is possible that all terms in (1) are equal, for example with $a_{i}=2 i-1$ and $b_{i}=4 i-2$ we have $\frac{a_{i}}{b_{i}}=\frac{1}{2}$.

Comment 2. The bound $5 n$ in the statement is far from sharp; the solution above can be modified to work for $9 n$. For large $n$, the bound $5 n$ can be replaced by $n^{\frac{3}{2}-\varepsilon}$.",491,3
2017a1,"Let $a_{1}, a_{2}, \ldots, a_{n}, k$, and $M$ be positive integers such that

$$
\frac{1}{a_{1}}+\frac{1}{a_{2}}+\cdots+\frac{1}{a_{n}}=k \quad \text { and } \quad a_{1} a_{2} \ldots a_{n}=M .
$$

If $M>1$, prove that the polynomial

$$
P(x)=M(x+1)^{k}-\left(x+a_{1}\right)\left(x+a_{2}\right) \cdots\left(x+a_{n}\right)
$$

has no positive roots.","We first prove that, for $x>0$,


\begin{equation*}
a_{i}(x+1)^{1 / a_{i}} \leqslant x+a_{i}, \tag{1}
\end{equation*}


with equality if and only if $a_{i}=1$. It is clear that equality occurs if $a_{i}=1$.\\
If $a_{i}>1$, the AM-GM inequality applied to a single copy of $x+1$ and $a_{i}-1$ copies of 1 yields

$$
\frac{(x+1)+\overbrace{1+1+\cdots+1}^{a_{i}-1 \text { ones }}}{a_{i}} \geqslant \sqrt[a_{i}]{(x+1) \cdot 1^{a_{i}-1}} \Longrightarrow a_{i}(x+1)^{1 / a_{i}} \leqslant x+a_{i} .
$$

Since $x+1>1$, the inequality is strict for $a_{i}>1$.\\
Multiplying the inequalities (1) for $i=1,2, \ldots, n$ yields

$$
\prod_{i=1}^{n} a_{i}(x+1)^{1 / a_{i}} \leqslant \prod_{i=1}^{n}\left(x+a_{i}\right) \Longleftrightarrow M(x+1)^{\sum_{i=1}^{n} 1 / a_{i}}-\prod_{i=1}^{n}\left(x+a_{i}\right) \leqslant 0 \Longleftrightarrow P(x) \leqslant 0
$$

with equality iff $a_{i}=1$ for all $i \in\{1,2, \ldots, n\}$. But this implies $M=1$, which is not possible. Hence $P(x)<0$ for all $x \in \mathbb{R}^{+}$, and $P$ has no positive roots.

Comment 1. Inequality (1) can be obtained in several ways. For instance, we may also use the binomial theorem: since $a_{i} \geqslant 1$,

$$
\left(1+\frac{x}{a_{i}}\right)^{a_{i}}=\sum_{j=0}^{a_{i}}\binom{a_{i}}{j}\left(\frac{x}{a_{i}}\right)^{j} \geqslant\binom{ a_{i}}{0}+\binom{a_{i}}{1} \cdot \frac{x}{a_{i}}=1+x .
$$

Both proofs of (1) mimic proofs to Bernoulli's inequality for a positive integer exponent $a_{i}$; we can use this inequality directly:

$$
\left(1+\frac{x}{a_{i}}\right)^{a_{i}} \geqslant 1+a_{i} \cdot \frac{x}{a_{i}}=1+x,
$$

and so

$$
x+a_{i}=a_{i}\left(1+\frac{x}{a_{i}}\right) \geqslant a_{i}(1+x)^{1 / a_{i}},
$$

or its (reversed) formulation, with exponent $1 / a_{i} \leqslant 1$ :

$$
(1+x)^{1 / a_{i}} \leqslant 1+\frac{1}{a_{i}} \cdot x=\frac{x+a_{i}}{a_{i}} \Longrightarrow a_{i}(1+x)^{1 / a_{i}} \leqslant x+a_{i} .
$$

",228,2
2017a3,"Let $S$ be a finite set, and let $\mathcal{A}$ be the set of all functions from $S$ to $S$. Let $f$ be an element of $\mathcal{A}$, and let $T=f(S)$ be the image of $S$ under $f$. Suppose that $f \circ g \circ f \neq g \circ f \circ g$ for every $g$ in $\mathcal{A}$ with $g \neq f$. Show that $f(T)=T$.","Solution. For $n \geqslant 1$, denote the $n$-th composition of $f$ with itself by

$$
f^{n} \stackrel{\text { def }}{=} \underbrace{f \circ f \circ \cdots \circ f}_{n \text { times }} .
$$

By hypothesis, if $g \in \mathcal{A}$ satisfies $f \circ g \circ f=g \circ f \circ g$, then $g=f$. A natural idea is to try to plug in $g=f^{n}$ for some $n$ in the expression $f \circ g \circ f=g \circ f \circ g$ in order to get $f^{n}=f$, which solves the problem:\\
Claim. If there exists $n \geqslant 3$ such that $f^{n+2}=f^{2 n+1}$, then the restriction $f: T \rightarrow T$ of $f$ to $T$ is a bijection.\\
Proof. Indeed, by hypothesis, $f^{n+2}=f^{2 n+1} \Longleftrightarrow f \circ f^{n} \circ f=f^{n} \circ f \circ f^{n} \Longrightarrow f^{n}=f$. Since $n-2 \geqslant 1$, the image of $f^{n-2}$ is contained in $T=f(S)$, hence $f^{n-2}$ restricts to a function $f^{n-2}: T \rightarrow T$. This is the inverse of $f: T \rightarrow T$. In fact, given $t \in T$, say $t=f(s)$ with $s \in S$, we have

$$
t=f(s)=f^{n}(s)=f^{n-2}(f(t))=f\left(f^{n-2}(t)\right), \quad \text { i.e., } \quad f^{n-2} \circ f=f \circ f^{n-2}=\mathrm{id} \text { on } T
$$

(here id stands for the identity function). Hence, the restriction $f: T \rightarrow T$ of $f$ to $T$ is bijective with inverse given by $f^{n-2}: T \rightarrow T$.

It remains to show that $n$ as in the claim exists. For that, define

$$
S_{m} \stackrel{\text { def }}{=} f^{m}(S) \quad\left(S_{m} \text { is image of } f^{m}\right)
$$

Clearly the image of $f^{m+1}$ is contained in the image of $f^{m}$, i.e., there is a descending chain of subsets of $S$

$$
S \supseteq S_{1} \supseteq S_{2} \supseteq S_{3} \supseteq S_{4} \supseteq \cdots
$$

which must eventually stabilise since $S$ is finite, i.e., there is a $k \geqslant 1$ such that

$$
S_{k}=S_{k+1}=S_{k+2}=S_{k+3}=\cdots \stackrel{\text { def }}{=} S_{\infty}
$$

Hence $f$ restricts to a surjective function $f: S_{\infty} \rightarrow S_{\infty}$, which is also bijective since $S_{\infty} \subseteq S$ is finite. To sum up, $f: S_{\infty} \rightarrow S_{\infty}$ is a permutation of the elements of the finite set $S_{\infty}$, hence there exists an integer $r \geqslant 1$ such that $f^{r}=\mathrm{id}$ on $S_{\infty}$ (for example, we may choose $r=\left|S_{\infty}\right|!$ ). In other words,


\begin{equation*}
f^{m+r}=f^{m} \text { on } S \text { for all } m \geqslant k \tag{*}
\end{equation*}


Clearly, $(*)$ also implies that $f^{m+t r}=f^{m}$ for all integers $t \geqslant 1$ and $m \geqslant k$. So, to find $n$ as in the claim and finish the problem, it is enough to choose $m$ and $t$ in order to ensure that there exists $n \geqslant 3$ satisfying

$$
\left\{\begin{array} { l } 
{ 2 n + 1 = m + t r } \\
{ n + 2 = m }
\end{array} \Longleftrightarrow \left\{\begin{array}{l}
m=3+t r \\
n=m-2
\end{array}\right.\right.
$$

This can be clearly done by choosing $m$ large enough with $m \equiv 3(\bmod r)$. For instance, we may take $n=2 k r+1$, so that

$$
f^{n+2}=f^{2 k r+3}=f^{4 k r+3}=f^{2 n+1}
$$

where the middle equality follows by $(*)$ since $2 k r+3 \geqslant k$.",516,4
2017a4,"A sequence of real numbers $a_{1}, a_{2}, \ldots$ satisfies the relation

$$
a_{n}=-\max _{i+j=n}\left(a_{i}+a_{j}\right) \quad \text { for all } n>2017 .
$$

Prove that this sequence is bounded, i.e., there is a constant $M$ such that $\left|a_{n}\right| \leqslant M$ for all positive integers $n$.","Set $D=2017$. Denote

$$
M_{n}=\max _{k<n} a_{k} \quad \text { and } \quad m_{n}=-\min _{k<n} a_{k}=\max _{k<n}\left(-a_{k}\right) .
$$

Clearly, the sequences $\left(m_{n}\right)$ and $\left(M_{n}\right)$ are nondecreasing. We need to prove that both are bounded.

Consider an arbitrary $n>D$; our first aim is to bound $a_{n}$ in terms of $m_{n}$ and $M_{n}$.\\
(i) There exist indices $p$ and $q$ such that $a_{n}=-\left(a_{p}+a_{q}\right)$ and $p+q=n$. Since $a_{p}, a_{q} \leqslant M_{n}$, we have $a_{n} \geqslant-2 M_{n}$.\\
(ii) On the other hand, choose an index $k<n$ such that $a_{k}=M_{n}$. Then, we have

$$
a_{n}=-\max _{\ell<n}\left(a_{n-\ell}+a_{\ell}\right) \leqslant-\left(a_{n-k}+a_{k}\right)=-a_{n-k}-M_{n} \leqslant m_{n}-M_{n} .
$$

Summarizing (i) and (ii), we get

$$
-2 M_{n} \leqslant a_{n} \leqslant m_{n}-M_{n},
$$

whence


\begin{equation*}
m_{n} \leqslant m_{n+1} \leqslant \max \left\{m_{n}, 2 M_{n}\right\} \quad \text { and } \quad M_{n} \leqslant M_{n+1} \leqslant \max \left\{M_{n}, m_{n}-M_{n}\right\} . \tag{1}
\end{equation*}


Now, say that an index $n>D$ is lucky if $m_{n} \leqslant 2 M_{n}$. Two cases are possible.\\
Case 1. Assume that there exists a lucky index $n$. In this case, (1) yields $m_{n+1} \leqslant 2 M_{n}$ and $M_{n} \leqslant M_{n+1} \leqslant M_{n}$. Therefore, $M_{n+1}=M_{n}$ and $m_{n+1} \leqslant 2 M_{n}=2 M_{n+1}$. So, the index $n+1$ is also lucky, and $M_{n+1}=M_{n}$. Applying the same arguments repeatedly, we obtain that all indices $k>n$ are lucky (i.e., $m_{k} \leqslant 2 M_{k}$ for all these indices), and $M_{k}=M_{n}$ for all such indices. Thus, all of the $m_{k}$ and $M_{k}$ are bounded by $2 M_{n}$.\\
Case 2. Assume now that there is no lucky index, i.e., $2 M_{n}<m_{n}$ for all $n>D$. Then (1) shows that for all $n>D$ we have $m_{n} \leqslant m_{n+1} \leqslant m_{n}$, so $m_{n}=m_{D+1}$ for all $n>D$. Since $M_{n}<m_{n} / 2$ for all such indices, all of the $m_{n}$ and $M_{n}$ are bounded by $m_{D+1}$.

Thus, in both cases the sequences $\left(m_{n}\right)$ and $\left(M_{n}\right)$ are bounded, as desired.\\
",302,3
2017a7,"Let $a_{0}, a_{1}, a_{2}, \ldots$ be a sequence of integers and $b_{0}, b_{1}, b_{2}, \ldots$ be a sequence of positive integers such that $a_{0}=0, a_{1}=1$, and

$$
a_{n+1}=\left\{\begin{array}{ll}
a_{n} b_{n}+a_{n-1}, & \text { if } b_{n-1}=1 \\
a_{n} b_{n}-a_{n-1}, & \text { if } b_{n-1}>1
\end{array} \quad \text { for } n=1,2, \ldots .\right.
$$

Prove that at least one of the two numbers $a_{2017}$ and $a_{2018}$ must be greater than or equal to 2017 .","The value of $b_{0}$ is irrelevant since $a_{0}=0$, so we may assume that $b_{0}=1$.\\
Lemma. We have $a_{n} \geqslant 1$ for all $n \geqslant 1$.\\
Proof. Let us suppose otherwise in order to obtain a contradiction. Let


\begin{equation*}
n \geqslant 1 \text { be the smallest integer with } a_{n} \leqslant 0 \text {. } \tag{1}
\end{equation*}


Note that $n \geqslant 2$. It follows that $a_{n-1} \geqslant 1$ and $a_{n-2} \geqslant 0$. Thus we cannot have $a_{n}=$ $a_{n-1} b_{n-1}+a_{n-2}$, so we must have $a_{n}=a_{n-1} b_{n-1}-a_{n-2}$. Since $a_{n} \leqslant 0$, we have $a_{n-1} \leqslant a_{n-2}$. Thus we have $a_{n-2} \geqslant a_{n-1} \geqslant a_{n}$.

Let


\begin{equation*}
r \text { be the smallest index with } a_{r} \geqslant a_{r+1} \geqslant a_{r+2} \text {. } \tag{2}
\end{equation*}


Then $r \leqslant n-2$ by the above, but also $r \geqslant 2$ : if $b_{1}=1$, then $a_{2}=a_{1}=1$ and $a_{3}=a_{2} b_{2}+a_{1}>a_{2}$; if $b_{1}>1$, then $a_{2}=b_{1}>1=a_{1}$.

By the minimal choice (2) of $r$, it follows that $a_{r-1}<a_{r}$. And since $2 \leqslant r \leqslant n-2$, by the minimal choice (1) of $n$ we have $a_{r-1}, a_{r}, a_{r+1}>0$. In order to have $a_{r+1} \geqslant a_{r+2}$, we must have $a_{r+2}=a_{r+1} b_{r+1}-a_{r}$ so that $b_{r} \geqslant 2$. Putting everything together, we conclude that

$$
a_{r+1}=a_{r} b_{r} \pm a_{r-1} \geqslant 2 a_{r}-a_{r-1}=a_{r}+\left(a_{r}-a_{r-1}\right)>a_{r},
$$

which contradicts (2).\\
To complete the problem, we prove that $\max \left\{a_{n}, a_{n+1}\right\} \geqslant n$ by induction. The cases $n=0,1$ are given. Assume it is true for all non-negative integers strictly less than $n$, where $n \geqslant 2$. There are two cases:

Case 1: $b_{n-1}=1$.\\
Then $a_{n+1}=a_{n} b_{n}+a_{n-1}$. By the inductive assumption one of $a_{n-1}, a_{n}$ is at least $n-1$ and the other, by the lemma, is at least 1 . Hence

$$
a_{n+1}=a_{n} b_{n}+a_{n-1} \geqslant a_{n}+a_{n-1} \geqslant(n-1)+1=n .
$$

Thus $\max \left\{a_{n}, a_{n+1}\right\} \geqslant n$, as desired.\\
Case 2: $b_{n-1}>1$.\\
Since we defined $b_{0}=1$ there is an index $r$ with $1 \leqslant r \leqslant n-1$ such that

$$
b_{n-1}, b_{n-2}, \ldots, b_{r} \geqslant 2 \quad \text { and } \quad b_{r-1}=1 .
$$

We have $a_{r+1}=a_{r} b_{r}+a_{r-1} \geqslant 2 a_{r}+a_{r-1}$. Thus $a_{r+1}-a_{r} \geqslant a_{r}+a_{r-1}$.\\
Now we claim that $a_{r}+a_{r-1} \geqslant r$. Indeed, this holds by inspection for $r=1$; for $r \geqslant 2$, one of $a_{r}, a_{r-1}$ is at least $r-1$ by the inductive assumption, while the other, by the lemma, is at least 1 . Hence $a_{r}+a_{r-1} \geqslant r$, as claimed, and therefore $a_{r+1}-a_{r} \geqslant r$ by the last inequality in the previous paragraph.

Since $r \geqslant 1$ and, by the lemma, $a_{r} \geqslant 1$, from $a_{r+1}-a_{r} \geqslant r$ we get the following two inequalities:

$$
a_{r+1} \geqslant r+1 \quad \text { and } \quad a_{r+1}>a_{r} .
$$

Now observe that

$$
a_{m}>a_{m-1} \Longrightarrow a_{m+1}>a_{m} \text { for } m=r+1, r+2, \ldots, n-1,
$$

since $a_{m+1}=a_{m} b_{m}-a_{m-1} \geqslant 2 a_{m}-a_{m-1}=a_{m}+\left(a_{m}-a_{m-1}\right)>a_{m}$. Thus

$$
a_{n}>a_{n-1}>\cdots>a_{r+1} \geqslant r+1 \Longrightarrow a_{n} \geqslant n
$$

So $\max \left\{a_{n}, a_{n+1}\right\} \geqslant n$, as desired.\\
",478,3
2017a8,"Assume that a function $f: \mathbb{R} \rightarrow \mathbb{R}$ satisfies the following condition:\\
For every $x, y \in \mathbb{R}$ such that $(f(x)+y)(f(y)+x)>0$, we have $f(x)+y=f(y)+x$.

Prove that $f(x)+y \leqslant f(y)+x$ whenever $x>y$.","Define $g(x)=x-f(x)$. The condition on $f$ then rewrites as follows:\\
For every $x, y \in \mathbb{R}$ such that $((x+y)-g(x))((x+y)-g(y))>0$, we have $g(x)=g(y)$.\\
This condition may in turn be rewritten in the following form:


\begin{equation*}
\text { If } g(x) \neq g(y), \text { then the number } x+y \text { lies (non-strictly) between } g(x) \text { and } g(y) \text {. } \tag{*}
\end{equation*}


Notice here that the function $g_{1}(x)=-g(-x)$ also satisfies $(*)$, since

$$
\begin{gathered}
g_{1}(x) \neq g_{1}(y) \Longrightarrow \quad g(-x) \neq g(-y) \quad \Longrightarrow \quad-(x+y) \text { lies between } g(-x) \text { and } g(-y) \\
\\
\Longrightarrow x+y \text { lies between } g_{1}(x) \text { and } g_{1}(y)
\end{gathered}
$$

On the other hand, the relation we need to prove reads now as


\begin{equation*}
g(x) \leqslant g(y) \quad \text { whenever } x<y \tag{1}
\end{equation*}


Again, this condition is equivalent to the same one with $g$ replaced by $g_{1}$.\\
If $g(x)=2 x$ for all $x \in \mathbb{R}$, then $(*)$ is obvious; so in what follows we consider the other case. We split the solution into a sequence of lemmas, strengthening one another. We always consider some value of $x$ with $g(x) \neq 2 x$ and denote $X=g(x)$.\\
Lemma 1. Assume that $X<2 x$. Then on the interval $(X-x ; x]$ the function $g$ attains at most two values - namely, $X$ and, possibly, some $Y>X$. Similarly, if $X>2 x$, then $g$ attains at most two values on $[x ; X-x)$ ?namely, $X$ and, possibly, some $Y<X$.\\
Proof. We start with the first claim of the lemma. Notice that $X-x<x$, so the considered interval is nonempty.

Take any $a \in(X-x ; x)$ with $g(a) \neq X$ (if it exists). If $g(a)<X$, then $(*)$ yields $g(a) \leqslant$ $a+x \leqslant g(x)=X$, so $a \leqslant X-x$ which is impossible. Thus, $g(a)>X$ and hence by $(*)$ we get $X \leqslant a+x \leqslant g(a)$.

Now, for any $b \in(X-x ; x)$ with $g(b) \neq X$ we similarly get $b+x \leqslant g(b)$. Therefore, the number $a+b$ (which is smaller than each of $a+x$ and $b+x$ ) cannot lie between $g(a)$ and $g(b)$, which by $(*)$ implies that $g(a)=g(b)$. Hence $g$ may attain only two values on $(X-x ; x]$, namely $X$ and $g(a)>X$.

To prove the second claim, notice that $g_{1}(-x)=-X<2 \cdot(-x)$, so $g_{1}$ attains at most two values on $(-X+x,-x]$, i.e., $-X$ and, possibly, some $-Y>-X$. Passing back to $g$, we get what we need.

Lemma 2. If $X<2 x$, then $g$ is constant on $(X-x ; x)$. Similarly, if $X>2 x$, then $g$ is constant on $(x ; X-x)$.\\
Proof. Again, it suffices to prove the first claim only. Assume, for the sake of contradiction, that there exist $a, b \in(X-x ; x)$ with $g(a) \neq g(b)$; by Lemma 1 , we may assume that $g(a)=X$ and $Y=g(b)>X$.

Notice that $\min \{X-a, X-b\}>X-x$, so there exists a $u \in(X-x ; x)$ such that $u<\min \{X-a, X-b\}$. By Lemma 1, we have either $g(u)=X$ or $g(u)=Y$. In the former case, by ( $*$ ) we have $X \leqslant u+b \leqslant Y$ which contradicts $u<X-b$. In the second case, by (*) we have $X \leqslant u+a \leqslant Y$ which contradicts $u<X-a$. Thus the lemma is proved.

Lemma 3. If $X<2 x$, then $g(a)=X$ for all $a \in(X-x ; x)$. Similarly, if $X>2 x$, then $g(a)=X$ for all $a \in(x ; X-x)$.\\
Proof. Again, we only prove the first claim.\\
By Lemmas 1 and 2, this claim may be violated only if $g$ takes on a constant value $Y>X$ on ( $X-x, x$ ). Choose any $a, b \in(X-x ; x)$ with $a<b$. By (*), we have


\begin{equation*}
Y \geqslant b+x \geqslant X . \tag{2}
\end{equation*}


In particular, we have $Y \geqslant b+x>2 a$. Applying Lemma 2 to $a$ in place of $x$, we obtain that $g$ is constant on $(a, Y-a)$. By (2) again, we have $x \leqslant Y-b<Y-a$; so $x, b \in(a ; Y-a)$. But $X=g(x) \neq g(b)=Y$, which is a contradiction.

Now we are able to finish the solution. Assume that $g(x)>g(y)$ for some $x<y$. Denote $X=g(x)$ and $Y=g(y)$; by (*), we have $X \geqslant x+y \geqslant Y$, so $Y-y \leqslant x<y \leqslant X-x$, and hence $(Y-y ; y) \cap(x ; X-x)=(x, y) \neq \varnothing$. On the other hand, since $Y-y<y$ and $x<X-x$, Lemma 3 shows that $g$ should attain a constant value $X$ on $(x ; X-x)$ and a constant value $Y \neq X$ on $(Y-y ; y)$. Since these intervals overlap, we get the final contradiction.

",750,4
2017c1,A rectangle $\mathcal{R}$ with odd integer side lengths is divided into small rectangles with integer side lengths. Prove that there is at least one among the small rectangles whose distances from the four sides of $\mathcal{R}$ are either all odd or all even.,"Solution. Let the width and height of $\mathcal{R}$ be odd numbers $a$ and $b$. Divide $\mathcal{R}$ into $a b$ unit squares and color them green and yellow in a checkered pattern. Since the side lengths of $a$ and $b$ are odd, the corner squares of $\mathcal{R}$ will all have the same color, say green.

Call a rectangle (either $\mathcal{R}$ or a small rectangle) green if its corners are all green; call it yellow if the corners are all yellow, and call it mixed if it has both green and yellow corners. In particular, $\mathcal{R}$ is a green rectangle.

We will use the following trivial observations.

\begin{itemize}
  \item Every mixed rectangle contains the same number of green and yellow squares;
  \item Every green rectangle contains one more green square than yellow square;
  \item Every yellow rectangle contains one more yellow square than green square.
\end{itemize}

The rectangle $\mathcal{R}$ is green, so it contains more green unit squares than yellow unit squares. Therefore, among the small rectangles, at least one is green. Let $\mathcal{S}$ be such a small green rectangle, and let its distances from the sides of $\mathcal{R}$ be $x, y, u$ and $v$, as shown in the picture. The top-left corner of $\mathcal{R}$ and the top-left corner of $\mathcal{S}$ have the same color, which happen if and only if $x$ and $u$ have the same parity. Similarly, the other three green corners of $\mathcal{S}$ indicate that $x$ and $v$ have the same parity, $y$ and $u$ have the same parity, i.e. $x, y, u$ and $v$ are all odd or all even.\\",262,3
2017c2,"Let $n$ be a positive integer. Define a chameleon to be any sequence of $3 n$ letters, with exactly $n$ occurrences of each of the letters $a, b$, and $c$. Define a swap to be the transposition of two adjacent letters in a chameleon. Prove that for any chameleon $X$, there exists a chameleon $Y$ such that $X$ cannot be changed to $Y$ using fewer than $3 n^{2} / 2$ swaps.","To start, notice that the swap of two identical letters does not change a chameleon, so we may assume there are no such swaps.

For any two chameleons $X$ and $Y$, define their distance $d(X, Y)$ to be the minimal number of swaps needed to transform $X$ into $Y$ (or vice versa). Clearly, $d(X, Y)+d(Y, Z) \geqslant d(X, Z)$ for any three chameleons $X, Y$, and $Z$.\\
Lemma. Consider two chameleons\\
\includegraphics[max width=\textwidth, center]{2025_04_29_3d725d21cc83abfed093g-37}

Then $d(P, Q) \geqslant 3 n^{2}$.\\
Proof. For any chameleon $X$ and any pair of distinct letters $u, v \in\{a, b, c\}$, we define $f_{u, v}(X)$ to be the number of pairs of positions in $X$ such that the left one is occupied by $u$, and the right one is occupied by $v$. Define $f(X)=f_{a, b}(X)+f_{a, c}(X)+f_{b, c}(X)$. Notice that $f_{a, b}(P)=f_{a, c}(P)=f_{b, c}(P)=n^{2}$ and $f_{a, b}(Q)=f_{a, c}(Q)=f_{b, c}(Q)=0$, so $f(P)=3 n^{2}$ and $f(Q)=0$.

Now consider some swap changing a chameleon $X$ to $X^{\prime}$; say, the letters $a$ and $b$ are swapped. Then $f_{a, b}(X)$ and $f_{a, b}\left(X^{\prime}\right)$ differ by exactly 1 , while $f_{a, c}(X)=f_{a, c}\left(X^{\prime}\right)$ and $f_{b, c}(X)=f_{b, c}\left(X^{\prime}\right)$. This yields $\left|f(X)-f\left(X^{\prime}\right)\right|=1$, i.e., on any swap the value of $f$ changes by 1 . Hence $d(X, Y) \geqslant$ $|f(X)-f(Y)|$ for any two chameleons $X$ and $Y$. In particular, $d(P, Q) \geqslant|f(P)-f(Q)|=3 n^{2}$, as desired.

Back to the problem, take any chameleon $X$ and notice that $d(X, P)+d(X, Q) \geqslant d(P, Q) \geqslant$ $3 n^{2}$ by the lemma. Consequently, $\max \{d(X, P), d(X, Q)\} \geqslant \frac{3 n^{2}}{2}$, which establishes the problem statement.
",257,3
2017c4,"Let $N \geqslant 2$ be an integer. $N(N+1)$ soccer players, no two of the same height, stand in a row in some order. Coach Ralph wants to remove $N(N-1)$ people from this row so that in the remaining row of $2 N$ players, no one stands between the two tallest ones, no one stands between the third and the fourth tallest ones, ..., and finally no one stands between the two shortest ones. Show that this is always possible.","Split the row into $N$ blocks with $N+1$ consecutive people each. We will show how to remove $N-1$ people from each block in order to satisfy the coach's wish.

First, construct a $(N+1) \times N$ matrix where $x_{i, j}$ is the height of the $i^{\text {th }}$ tallest person of the $j^{\text {th }}$ block-in other words, each column lists the heights within a single block, sorted in decreasing order from top to bottom.

We will reorder this matrix by repeatedly swapping whole columns. First, by column permutation, make sure that $x_{2,1}=\max \left\{x_{2, i}: i=1,2, \ldots, N\right\}$ (the first column contains the largest height of the second row). With the first column fixed, permute the other ones so that $x_{3,2}=\max \left\{x_{3, i}: i=2, \ldots, N\right\}$ (the second column contains the tallest person of the third row, first column excluded). In short, at step $k(k=1,2, \ldots, N-1)$, we permute the columns from $k$ to $N$ so that $x_{k+1, k}=\max \left\{x_{i, k}: i=k, k+1, \ldots, N\right\}$, and end up with an array like this:

\begin{center}
\begin{tabular}{|l|l|l|l|l|l|}
\hline
$\boldsymbol{x}_{1,1}$ & $x_{1,2}$ & $x_{1,3}$ & $\cdots$ & $x_{1, N-1}$ & $x_{1, N}$ \\
\hline
V & V & V &  & $\checkmark$ & $\checkmark$ \\
\hline
\begin{tabular}{l}
$\boldsymbol{x}_{2,1}$ \\
$>$ \\
\end{tabular} & $\boldsymbol{x}_{2,2}$ & $x_{2,3}$ & $\cdots$ & $x_{2, N-1}$ & $x_{2, N}$ \\
\hline
V & V & V &  & $\checkmark$ & V \\
\hline
$x_{3,1}$ & \begin{tabular}{l}
$\boldsymbol{x}_{3,2}$ \\
$>$ \\
\end{tabular} & $\boldsymbol{x}_{3,3}$ & $\cdots$ & $x_{3, N-1}$ & $x_{3, N}$ \\
\hline
V & V & V &  & $\checkmark$ & V \\
\hline
! & : & : & $\bullet \cdot$ & : & : \\
\hline
V & V & V &  & V & V \\
\hline
$x_{N, 1}$ & $x_{N, 2}$ & $x_{N, 3}$ & $\cdots$ & $x_{N, N-1}>$ & $\boldsymbol{x}_{N, N}$ \\
\hline
$\checkmark$ & $\checkmark$ & $\checkmark$ &  & $V$ & V \\
\hline
$x_{N+1,1}$ & $x_{N+1,2}$ & $x_{N+1,3}$ & $\cdots$ & $x_{N+1, N-1}$ & $x_{N+1, N}$ \\
\hline
\end{tabular}
\end{center}

Now we make the bold choice: from the original row of people, remove everyone but those with heights


\begin{equation*}
x_{1,1}>x_{2,1}>x_{2,2}>x_{3,2}>\cdots>x_{N, N-1}>x_{N, N}>x_{N+1, N} \tag{*}
\end{equation*}


Of course this height order (*) is not necessarily their spatial order in the new row. We now need to convince ourselves that each pair ( $x_{k, k} ; x_{k+1, k}$ ) remains spatially together in this new row. But $x_{k, k}$ and $x_{k+1, k}$ belong to the same column/block of consecutive $N+1$ people; the only people that could possibly stand between them were also in this block, and they are all gone.

",437,3
2017c7,"For any finite sets $X$ and $Y$ of positive integers, denote by $f_{X}(k)$ the $k^{\text {th }}$ smallest positive integer not in $X$, and let

$$
X * Y=X \cup\left\{f_{X}(y): y \in Y\right\}
$$

Let $A$ be a set of $a>0$ positive integers, and let $B$ be a set of $b>0$ positive integers. Prove that if $A * B=B * A$, then


\begin{equation*}
\underbrace{A *(A * \cdots *(A *(A * A)) \ldots)}_{A \text { appears } b \text { times }}=\underbrace{B *(B * \cdots *(B *(B * B)) \ldots)}_{B \text { appears } a \text { times }} 
\end{equation*}","For any function $g: \mathbb{Z}_{>0} \rightarrow \mathbb{Z}_{>0}$ and any subset $X \subset \mathbb{Z}_{>0}$, we define $g(X)=$ $\{g(x): x \in X\}$. We have that the image of $f_{X}$ is $f_{X}\left(\mathbb{Z}_{>0}\right)=\mathbb{Z}_{>0} \backslash X$. We now show a general lemma about the operation $*$, with the goal of showing that $*$ is associative.\\
Lemma 1. Let $X$ and $Y$ be finite sets of positive integers. The functions $f_{X * Y}$ and $f_{X} \circ f_{Y}$ are equal.\\
Proof. We have\\
$f_{X * Y}\left(\mathbb{Z}_{>0}\right)=\mathbb{Z}_{>0} \backslash(X * Y)=\left(\mathbb{Z}_{>0} \backslash X\right) \backslash f_{X}(Y)=f_{X}\left(\mathbb{Z}_{>0}\right) \backslash f_{X}(Y)=f_{X}\left(\mathbb{Z}_{>0} \backslash Y\right)=f_{X}\left(f_{Y}\left(\mathbb{Z}_{>0}\right)\right)$.\\
Thus, the functions $f_{X * Y}$ and $f_{X} \circ f_{Y}$ are strictly increasing functions with the same range. Because a strictly function is uniquely defined by its range, we have $f_{X * Y}=f_{X} \circ f_{Y}$.

Lemma 1 implies that $*$ is associative, in the sense that $(A * B) * C=A *(B * C)$ for any finite sets $A, B$, and $C$ of positive integers. We prove the associativity by noting

$$
\begin{gathered}
\mathbb{Z}_{>0} \backslash((A * B) * C)=f_{(A * B) * C}\left(\mathbb{Z}_{>0}\right)=f_{A * B}\left(f_{C}\left(\mathbb{Z}_{>0}\right)\right)=f_{A}\left(f_{B}\left(f_{C}\left(\mathbb{Z}_{>0}\right)\right)\right) \\
=f_{A}\left(f_{B * C}\left(\mathbb{Z}_{>0}\right)=f_{A *(B * C)}\left(\mathbb{Z}_{>0}\right)=\mathbb{Z}_{>0} \backslash(A *(B * C))\right.
\end{gathered}
$$

In light of the associativity of $*$, we may drop the parentheses when we write expressions like $A *(B * C)$. We also introduce the notation

$$
X^{* k}=\underbrace{X *(X * \cdots *(X *(X * X)) \ldots)}_{X \text { appears } k \text { times }}
$$

Our goal is then to show that $A * B=B * A$ implies $A^{* b}=B^{* a}$. We will do so via the following general lemma.\\
Lemma 2. Suppose that $X$ and $Y$ are finite sets of positive integers satisfying $X * Y=Y * X$ and $|X|=|Y|$. Then, we must have $X=Y$.\\
Proof. Assume that $X$ and $Y$ are not equal. Let $s$ be the largest number in exactly one of $X$ and $Y$. Without loss of generality, say that $s \in X \backslash Y$. The number $f_{X}(s)$ counts the $s^{t h}$ number not in $X$, which implies that


\begin{equation*}
f_{X}(s)=s+\left|X \cap\left\{1,2, \ldots, f_{X}(s)\right\}\right| \tag{1}
\end{equation*}


Since $f_{X}(s) \geqslant s$, we have that

$$
\left\{f_{X}(s)+1, f_{X}(s)+2, \ldots\right\} \cap X=\left\{f_{X}(s)+1, f_{X}(s)+2, \ldots\right\} \cap Y
$$

which, together with the assumption that $|X|=|Y|$, gives


\begin{equation*}
\left|X \cap\left\{1,2, \ldots, f_{X}(s)\right\}\right|=\left|Y \cap\left\{1,2, \ldots, f_{X}(s)\right\}\right| \tag{2}
\end{equation*}


Now consider the equation

$$
t-|Y \cap\{1,2, \ldots, t\}|=s .
$$

This equation is satisfied only when $t \in\left[f_{Y}(s), f_{Y}(s+1)\right.$ ), because the left hand side counts the number of elements up to $t$ that are not in $Y$. We have that the value $t=f_{X}(s)$ satisfies the above equation because of (1) and (2). Furthermore, since $f_{X}(s) \notin X$ and $f_{X}(s) \geqslant s$, we have that $f_{X}(s) \notin Y$ due to the maximality of $s$. Thus, by the above discussion, we must have $f_{X}(s)=f_{Y}(s)$.

Finally, we arrive at a contradiction. The value $f_{X}(s)$ is neither in $X$ nor in $f_{X}(Y)$, because $s$ is not in $Y$ by assumption. Thus, $f_{X}(s) \notin X * Y$. However, since $s \in X$, we have $f_{Y}(s) \in Y * X$, a contradiction.

We are now ready to finish the proof. Note first of all that $\left|A^{* b}\right|=a b=\left|B^{* a}\right|$. Moreover, since $A * B=B * A$, and $*$ is associative, it follows that $A^{* b} * B^{* a}=B^{* a} * A^{* b}$. Thus, by Lemma 2, we have $A^{* b}=B^{* a}$, as desired.

",555,4
2017g1,"Let $A B C D E$ be a convex pentagon such that $A B=B C=C D, \angle E A B=\angle B C D$, and $\angle E D C=\angle C B A$. Prove that the perpendicular line from $E$ to $B C$ and the line segments $A C$ and $B D$ are concurrent.","Throughout the solution, we refer to $\angle A, \angle B, \angle C, \angle D$, and $\angle E$ as internal angles of the pentagon $A B C D E$. Let the perpendicular bisectors of $A C$ and $B D$, which pass respectively through $B$ and $C$, meet at point $I$. Then $B D \perp C I$ and, similarly, $A C \perp B I$. Hence $A C$ and $B D$ meet at the orthocenter $H$ of the triangle $B I C$, and $I H \perp B C$. It remains to prove that $E$ lies on the line $I H$ or, equivalently, $E I \perp B C$.

Lines $I B$ and $I C$ bisect $\angle B$ and $\angle C$, respectively. Since $I A=I C, I B=I D$, and $A B=$ $B C=C D$, the triangles $I A B, I C B$ and $I C D$ are congruent. Hence $\angle I A B=\angle I C B=$ $\angle C / 2=\angle A / 2$, so the line $I A$ bisects $\angle A$. Similarly, the line $I D$ bisects $\angle D$. Finally, the line $I E$ bisects $\angle E$ because $I$ lies on all the other four internal bisectors of the angles of the pentagon.

The sum of the internal angles in a pentagon is $540^{\circ}$, so

$$
\angle E=540^{\circ}-2 \angle A+2 \angle B .
$$

In quadrilateral $A B I E$,

$$
\begin{aligned}
\angle B I E & =360^{\circ}-\angle E A B-\angle A B I-\angle A E I=360^{\circ}-\angle A-\frac{1}{2} \angle B-\frac{1}{2} \angle E \\
& =360^{\circ}-\angle A-\frac{1}{2} \angle B-\left(270^{\circ}-\angle A-\angle B\right) \\
& =90^{\circ}+\frac{1}{2} \angle B=90^{\circ}+\angle I B C,
\end{aligned}
$$

which means that $E I \perp B C$, completing the proof.\\
",277,3
2017g2,"Let $R$ and $S$ be distinct points on circle $\Omega$, and let $t$ denote the tangent line to $\Omega$ at $R$. Point $R^{\prime}$ is the reflection of $R$ with respect to $S$. A point $I$ is chosen on the smaller arc $R S$ of $\Omega$ so that the circumcircle $\Gamma$ of triangle $I S R^{\prime}$ intersects $t$ at two different points. Denote by $A$ the common point of $\Gamma$ and $t$ that is closest to $R$. Line $A I$ meets $\Omega$ again at $J$. Show that $J R^{\prime}$ is tangent to $\Gamma$.","In the circles $\Omega$ and $\Gamma$ we have $\angle J R S=\angle J I S=\angle A R^{\prime} S$. On the other hand, since $R A$ is tangent to $\Omega$, we get $\angle S J R=\angle S R A$. So the triangles $A R R^{\prime}$ and $S J R$ are similar, and

$$
\frac{R^{\prime} R}{R J}=\frac{A R^{\prime}}{S R}=\frac{A R^{\prime}}{S R^{\prime}} .
$$

The last relation, together with $\angle A R^{\prime} S=\angle J R R^{\prime}$, yields $\triangle A S R^{\prime} \sim \triangle R^{\prime} J R$, hence $\angle S A R^{\prime}=\angle R R^{\prime} J$. It follows that $J R^{\prime}$ is tangent to $\Gamma$ at $R^{\prime}$.\\
",102,2
2017g3,"Let $O$ be the circumcenter of an acute scalene triangle $A B C$. Line $O A$ intersects the altitudes of $A B C$ through $B$ and $C$ at $P$ and $Q$, respectively. The altitudes meet at $H$. Prove that the circumcenter of triangle $P Q H$ lies on a median of triangle $A B C$.","Solution. Suppose, without loss of generality, that $A B<A C$. We have $\angle P Q H=90^{\circ}-$ $\angle Q A B=90^{\circ}-\angle O A B=\frac{1}{2} \angle A O B=\angle A C B$, and similarly $\angle Q P H=\angle A B C$. Thus triangles $A B C$ and $H P Q$ are similar. Let $\Omega$ and $\omega$ be the circumcircles of $A B C$ and $H P Q$, respectively. Since $\angle A H P=90^{\circ}-\angle H A C=\angle A C B=\angle H Q P$, line $A H$ is tangent to $\omega$.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_3d725d21cc83abfed093g-61}

Let $T$ be the center of $\omega$ and let lines $A T$ and $B C$ meet at $M$. We will take advantage of the similarity between $A B C$ and $H P Q$ and the fact that $A H$ is tangent to $\omega$ at $H$, with $A$ on line $P Q$. Consider the corresponding tangent $A S$ to $\Omega$, with $S \in B C$. Then $S$ and $A$ correspond to each other in $\triangle A B C \sim \triangle H P Q$, and therefore $\angle O S M=\angle O A T=\angle O A M$. Hence quadrilateral $S A O M$ is cyclic, and since the tangent line $A S$ is perpendicular to $A O$, $\angle O M S=180^{\circ}-\angle O A S=90^{\circ}$. This means that $M$ is the orthogonal projection of $O$ onto $B C$, which is its midpoint. So $T$ lies on median $A M$ of triangle $A B C$.",240,2
2017g4,"In triangle $A B C$, let $\omega$ be the excircle opposite $A$. Let $D, E$, and $F$ be the points where $\omega$ is tangent to lines $B C, C A$, and $A B$, respectively. The circle $A E F$ intersects line $B C$ at $P$ and $Q$. Let $M$ be the midpoint of $A D$. Prove that the circle $M P Q$ is tangent to $\omega$.","Denote by $\Omega$ the circle $A E F P Q$, and denote by $\gamma$ the circle $P Q M$. Let the line $A D$ meet $\omega$ again at $T \neq D$. We will show that $\gamma$ is tangent to $\omega$ at $T$.

We first prove that points $P, Q, M, T$ are concyclic. Let $A^{\prime}$ be the center of $\omega$. Since $A^{\prime} E \perp A E$ and $A^{\prime} F \perp A F, A A^{\prime}$ is a diameter in $\Omega$. Let $N$ be the midpoint of $D T$; from $A^{\prime} D=A^{\prime} T$ we can see that $\angle A^{\prime} N A=90^{\circ}$ and therefore $N$ also lies on the circle $\Omega$. Now, from the power of $D$ with respect to the circles $\gamma$ and $\Omega$ we get

$$
D P \cdot D Q=D A \cdot D N=2 D M \cdot \frac{D T}{2}=D M \cdot D T
$$

so $P, Q, M, T$ are concyclic.\\
If $E F \| B C$, then $A B C$ is isosceles and the problem is now immediate by symmetry. Otherwise, let the tangent line to $\omega$ at $T$ meet line $B C$ at point $R$. The tangent line segments $R D$ and $R T$ have the same length, so $A^{\prime} R$ is the perpendicular bisector of $D T$; since $N D=N T$, $N$ lies on this perpendicular bisector.

In right triangle $A^{\prime} R D, R D^{2}=R N \cdot R A^{\prime}=R P \cdot R Q$, in which the last equality was obtained from the power of $R$ with respect to $\Omega$. Hence $R T^{2}=R P \cdot R Q$, which implies that $R T$ is also tangent to $\gamma$. Because $R T$ is a common tangent to $\omega$ and $\gamma$, these two circles are tangent at $T$.\\

",287,3
2017g5,"Let $A B C C_{1} B_{1} A_{1}$ be a convex hexagon such that $A B=B C$, and suppose that the line segments $A A_{1}, B B_{1}$, and $C C_{1}$ have the same perpendicular bisector. Let the diagonals $A C_{1}$ and $A_{1} C$ meet at $D$, and denote by $\omega$ the circle $A B C$. Let $\omega$ intersect the circle $A_{1} B C_{1}$ again at $E \neq B$. Prove that the lines $B B_{1}$ and $D E$ intersect on $\omega$.","If $A A_{1}=C C_{1}$, then the hexagon is symmetric about the line $B B_{1}$; in particular the circles $A B C$ and $A_{1} B C_{1}$ are tangent to each other. So $A A_{1}$ and $C C_{1}$ must be different. Since the points $A$ and $A_{1}$ can be interchanged with $C$ and $C_{1}$, respectively, we may assume $A A_{1}<C C_{1}$.

Let $R$ be the radical center of the circles $A E B C$ and $A_{1} E B C_{1}$, and the circumcircle of the symmetric trapezoid $A C C_{1} A_{1}$; that is the common point of the pairwise radical axes $A C, A_{1} C_{1}$, and $B E$. By the symmetry of $A C$ and $A_{1} C_{1}$, the point $R$ lies on the common perpendicular bisector of $A A_{1}$ and $C C_{1}$, which is the external bisector of $\angle A D C$.

Let $F$ be the second intersection of the line $D R$ and the circle $A C D$. From the power of $R$ with respect to the circles $\omega$ and $A C F D$ we have $R B \cdot R E=R A \cdot R C=R D \cdot D F$, so the points $B, E, D$ and $F$ are concyclic.

The line $R D F$ is the external bisector of $\angle A D C$, so the point $F$ bisects the $\operatorname{arc} \widetilde{C D A}$. By $A B=B C$, on circle $\omega$, the point $B$ is the midpoint of arc $\widehat{A E C}$; let $M$ be the point diametrically opposite to $B$, that is the midpoint of the opposite $\operatorname{arc} \widetilde{C A}$ of $\omega$. Notice that the points $B, F$ and $M$ lie on the perpendicular bisector of $A C$, so they are collinear.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_3d725d21cc83abfed093g-64}

Finally, let $X$ be the second intersection point of $\omega$ and the line $D E$. Since $B M$ is a diameter in $\omega$, we have $\angle B X M=90^{\circ}$. Moreover,

$$
\angle E X M=180^{\circ}-\angle M B E=180^{\circ}-\angle F B E=\angle E D F
$$

so $M X$ and $F D$ are parallel. Since $B X$ is perpendicular to $M X$ and $B B_{1}$ is perpendicular to $F D$, this shows that $X$ lies on line $B B_{1}$.
",361,3
2017g6,"Let $n \geqslant 3$ be an integer. Two regular $n$-gons $\mathcal{A}$ and $\mathcal{B}$ are given in the plane. Prove that the vertices of $\mathcal{A}$ that lie inside $\mathcal{B}$ or on its boundary are consecutive.\\
(That is, prove that there exists a line separating those vertices of $\mathcal{A}$ that lie inside $\mathcal{B}$ or on its boundary from the other vertices of $\mathcal{A}$.)","In both solutions, by a polygon we always mean its interior together with its boundary.

We start with finding a regular $n$-gon $\mathcal{C}$ which $(i)$ is inscribed into $\mathcal{B}$ (that is, all vertices of $\mathcal{C}$ lie on the perimeter of $\mathcal{B}$ ); and (ii) is either a translation of $\mathcal{A}$, or a homothetic image of $\mathcal{A}$ with a positive factor.

Such a polygon may be constructed as follows. Let $O_{A}$ and $O_{B}$ be the centers of $\mathcal{A}$ and $\mathcal{B}$, respectively, and let $A$ be an arbitrary vertex of $\mathcal{A}$. Let $\overrightarrow{O_{B} C}$ be the vector co-directional to $\overrightarrow{O_{A} A}$, with $C$ lying on the perimeter of $\mathcal{B}$. The rotations of $C$ around $O_{B}$ by multiples of $2 \pi / n$ form the required polygon. Indeed, it is regular, inscribed into $\mathcal{B}$ (due to the rotational symmetry of $\mathcal{B}$ ), and finally the translation/homothety mapping $\overrightarrow{O_{A} A}$ to $\overrightarrow{O_{B} C}$ maps $\mathcal{A}$ to $\mathcal{C}$.

Now we separate two cases.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_3d725d21cc83abfed093g-66}

Case 1: $\mathcal{C}$ is a translation of $\mathcal{A}$ by a vector $\vec{v}$.\\
Denote by $t$ the translation transform by vector $\vec{v}$. We need to prove that the vertices of $\mathcal{C}$ which stay in $\mathcal{B}$ under $t$ are consecutive. To visualize the argument, we refer the plane to Cartesian coordinates so that the $x$-axis is co-directional with $\vec{v}$. This way, the notions of right/left and top/bottom are also introduced, according to the $x$ - and $y$-coordinates, respectively.

Let $B_{\mathrm{T}}$ and $B_{\mathrm{B}}$ be the top and the bottom vertices of $\mathcal{B}$ (if several vertices are extremal, we take the rightmost of them). They split the perimeter of $\mathcal{B}$ into the right part $\mathcal{B}_{\mathrm{R}}$ and the left part $\mathcal{B}_{\mathrm{L}}$ (the vertices $B_{\mathrm{T}}$ and $B_{\mathrm{B}}$ are assumed to lie in both parts); each part forms a connected subset of the perimeter of $\mathcal{B}$. So the vertices of $\mathcal{C}$ are also split into two parts $\mathcal{C}_{\mathrm{L}} \subset \mathcal{B}_{\mathrm{L}}$ and $\mathcal{C}_{\mathrm{R}} \subset \mathcal{B}_{\mathrm{R}}$, each of which consists of consecutive vertices.

Now, all the points in $\mathcal{B}_{\mathrm{R}}$ (and hence in $\mathcal{C}_{\mathrm{R}}$ ) move out from $\mathcal{B}$ under $t$, since they are the rightmost points of $\mathcal{B}$ on the corresponding horizontal lines. It remains to prove that the vertices of $\mathcal{C}_{\mathrm{L}}$ which stay in $\mathcal{B}$ under $t$ are consecutive.

For this purpose, let $C_{1}, C_{2}$, and $C_{3}$ be three vertices in $\mathcal{C}_{\mathrm{L}}$ such that $C_{2}$ is between $C_{1}$ and $C_{3}$, and $t\left(C_{1}\right)$ and $t\left(C_{3}\right)$ lie in $\mathcal{B}$; we need to prove that $t\left(C_{2}\right) \in \mathcal{B}$ as well. Let $A_{i}=t\left(C_{i}\right)$. The line through $C_{2}$ parallel to $\vec{v}$ crosses the segment $C_{1} C_{3}$ to the right of $C_{2}$; this means that this line crosses $A_{1} A_{3}$ to the right of $A_{2}$, so $A_{2}$ lies inside the triangle $A_{1} C_{2} A_{3}$ which is contained in $\mathcal{B}$. This yields the desired result.

Case 2: $\mathcal{C}$ is a homothetic image of $\mathcal{A}$ centered at $X$ with factor $k>0$.

Denote by $h$ the homothety mapping $\mathcal{C}$ to $\mathcal{A}$. We need now to prove that the vertices of $\mathcal{C}$ which stay in $\mathcal{B}$ after applying $h$ are consecutive. If $X \in \mathcal{B}$, the claim is easy. Indeed, if $k<1$, then the vertices of $\mathcal{A}$ lie on the segments of the form $X C$ ( $C$ being a vertex of $\mathcal{C}$ ) which lie in $\mathcal{B}$. If $k>1$, then the vertices of $\mathcal{A}$ lie on the extensions of such segments $X C$ beyond $C$, and almost all these extensions lie outside $\mathcal{B}$. The exceptions may occur only in case when $X$ lies on the boundary of $\mathcal{B}$, and they may cause one or two vertices of $\mathcal{A}$ stay on the boundary of $\mathcal{B}$. But even in this case those vertices are still consecutive.

So, from now on we assume that $X \notin \mathcal{B}$.\\
Now, there are two vertices $B_{\mathrm{T}}$ and $\mathcal{B}_{\mathrm{B}}$ of $\mathcal{B}$ such that $\mathcal{B}$ is contained in the angle $\angle B_{\mathrm{T}} X B_{\mathrm{B}}$; if there are several options, say, for $B_{\mathrm{T}}$, then we choose the farthest one from $X$ if $k>1$, and the nearest one if $k<1$. For the visualization purposes, we refer the plane to Cartesian coordinates so that the $y$-axis is co-directional with $\overrightarrow{B_{\mathrm{B}} B_{\mathrm{T}}}$, and $X$ lies to the left of the line $B_{\mathrm{T}} B_{\mathrm{B}}$. Again, the perimeter of $\mathcal{B}$ is split by $B_{\mathrm{T}}$ and $B_{\mathrm{B}}$ into the right part $\mathcal{B}_{\mathrm{R}}$ and the left part $\mathcal{B}_{\mathrm{L}}$, and the set of vertices of $\mathcal{C}$ is split into two subsets $\mathcal{C}_{\mathrm{R}} \subset \mathcal{B}_{\mathrm{R}}$ and $\mathcal{C}_{\mathrm{L}} \subset \mathcal{B}_{\mathrm{L}}$.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_3d725d21cc83abfed093g-67}

Case 2, $X$ inside $\mathcal{B}$\\
\includegraphics[max width=\textwidth, center]{2025_04_29_3d725d21cc83abfed093g-67(2)}

Subcase 2.1: $k>1$

\section*{Subcase 2.1: $k>1$.}
In this subcase, all points from $\mathcal{B}_{\mathrm{R}}$ (and hence from $\mathcal{C}_{\mathrm{R}}$ ) move out from $\mathcal{B}$ under $h$, because they are the farthest points of $\mathcal{B}$ on the corresponding rays emanated from $X$. It remains to prove that the vertices of $\mathcal{C}_{\mathrm{L}}$ which stay in $\mathcal{B}$ under $h$ are consecutive.

Again, let $C_{1}, C_{2}, C_{3}$ be three vertices in $\mathcal{C}_{\mathrm{L}}$ such that $C_{2}$ is between $C_{1}$ and $C_{3}$, and $h\left(C_{1}\right)$ and $h\left(C_{3}\right)$ lie in $\mathcal{B}$. Let $A_{i}=h\left(C_{i}\right)$. Then the ray $X C_{2}$ crosses the segment $C_{1} C_{3}$ beyond $C_{2}$, so this ray crosses $A_{1} A_{3}$ beyond $A_{2}$; this implies that $A_{2}$ lies in the triangle $A_{1} C_{2} A_{3}$, which is contained in $\mathcal{B}$.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_3d725d21cc83abfed093g-67(1)}

Subcase 2.2: $k<1$\\
Subcase 2.2: $k<1$.\\
This case is completely similar to the previous one. All points from $\mathcal{B}_{\mathrm{L}}$ (and hence from $\mathcal{C}_{\mathrm{L}}$ move out from $\mathcal{B}$ under $h$, because they are the nearest points of $\mathcal{B}$ on the corresponding\\
rays emanated from $X$. Assume that $C_{1}, C_{2}$, and $C_{3}$ are three vertices in $\mathcal{C}_{\mathrm{R}}$ such that $C_{2}$ lies between $C_{1}$ and $C_{3}$, and $h\left(C_{1}\right)$ and $h\left(C_{3}\right)$ lie in $\mathcal{B}$; let $A_{i}=h\left(C_{i}\right)$. Then $A_{2}$ lies on the segment $X C_{2}$, and the segments $X A_{2}$ and $A_{1} A_{3}$ cross each other. Thus $A_{2}$ lies in the triangle $A_{1} C_{2} A_{3}$, which is contained in $\mathcal{B}$.
",973,4
2017g7,"A convex quadrilateral $A B C D$ has an inscribed circle with center $I$. Let $I_{a}, I_{b}, I_{c}$, and $I_{d}$ be the incenters of the triangles $D A B, A B C, B C D$, and $C D A$, respectively. Suppose that the common external tangents of the circles $A I_{b} I_{d}$ and $C I_{b} I_{d}$ meet at $X$, and the common external tangents of the circles $B I_{a} I_{c}$ and $D I_{a} I_{c}$ meet at $Y$. Prove that $\angle X I Y=90^{\circ}$.","Solution. Denote by $\omega_{a}, \omega_{b}, \omega_{c}$ and $\omega_{d}$ the circles $A I_{b} I_{d}, B I_{a} I_{c}, C I_{b} I_{d}$, and $D I_{a} I_{c}$, let their centers be $O_{a}, O_{b}, O_{c}$ and $O_{d}$, and let their radii be $r_{a}, r_{b}, r_{c}$ and $r_{d}$, respectively.\\
Claim 1. $I_{b} I_{d} \perp A C$ and $I_{a} I_{c} \perp B D$.\\
Proof. Let the incircles of triangles $A B C$ and $A C D$ be tangent to the line $A C$ at $T$ and $T^{\prime}$, respectively. (See the figure to the left.) We have $A T=\frac{A B+A C-B C}{2}$ in triangle $A B C, A T^{\prime}=$ $\frac{A D+A C-C D}{2}$ in triangle $A C D$, and $A B-B C=A D-C D$ in quadrilateral $A B C D$, so

$$
A T=\frac{A C+A B-B C}{2}=\frac{A C+A D-C D}{2}=A T^{\prime} .
$$

This shows $T=T^{\prime}$. As an immediate consequence, $I_{b} I_{d} \perp A C$.\\
The second statement can be shown analogously.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_3d725d21cc83abfed093g-70}

Claim 2. The points $O_{a}, O_{b}, O_{c}$ and $O_{d}$ lie on the lines $A I, B I, C I$ and $D I$, respectively.\\
Proof. By symmetry it suffices to prove the claim for $O_{a}$. (See the figure to the right above.)\\
Notice first that the incircles of triangles $A B C$ and $A C D$ can be obtained from the incircle of the quadrilateral $A B C D$ with homothety centers $B$ and $D$, respectively, and homothety factors less than 1 , therefore the points $I_{b}$ and $I_{d}$ lie on the line segments $B I$ and $D I$, respectively.

As is well-known, in every triangle the altitude and the diameter of the circumcircle starting from the same vertex are symmetric about the angle bisector. By Claim 1, in triangle $A I_{d} I_{b}$, the segment $A T$ is the altitude starting from $A$. Since the foot $T$ lies inside the segment $I_{b} I_{d}$, the circumcenter $O_{a}$ of triangle $A I_{d} I_{b}$ lies in the angle domain $I_{b} A I_{d}$ in such a way that $\angle I_{b} A T=\angle O_{a} A I_{d}$. The points $I_{b}$ and $I_{d}$ are the incenters of triangles $A B C$ and $A C D$, so the lines $A I_{b}$ and $A I_{d}$ bisect the angles $\angle B A C$ and $\angle C A D$, respectively. Then

$$
\angle O_{a} A D=\angle O_{a} A I_{d}+\angle I_{d} A D=\angle I_{b} A T+\angle I_{d} A D=\frac{1}{2} \angle B A C+\frac{1}{2} \angle C A D=\frac{1}{2} \angle B A D,
$$

so $O_{a}$ lies on the angle bisector of $\angle B A D$, that is, on line $A I$.\\
The point $X$ is the external similitude center of $\omega_{a}$ and $\omega_{c}$; let $U$ be their internal similitude center. The points $O_{a}$ and $O_{c}$ lie on the perpendicular bisector of the common chord $I_{b} I_{d}$ of $\omega_{a}$ and $\omega_{c}$, and the two similitude centers $X$ and $U$ lie on the same line; by Claim 2, that line is parallel to $A C$.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_3d725d21cc83abfed093g-71}

From the similarity of the circles $\omega_{a}$ and $\omega_{c}$, from $O_{a} I_{b}=O_{a} I_{d}=O_{a} A=r_{a}$ and $O_{c} I_{b}=$ $O_{c} I_{d}=O_{c} C=r_{c}$, and from $A C \| O_{a} O_{c}$ we can see that

$$
\frac{O_{a} X}{O_{c} X}=\frac{O_{a} U}{O_{c} U}=\frac{r_{a}}{r_{c}}=\frac{O_{a} I_{b}}{O_{c} I_{b}}=\frac{O_{a} I_{d}}{O_{c} I_{d}}=\frac{O_{a} A}{O_{c} C}=\frac{O_{a} I}{O_{c} I} .
$$

So the points $X, U, I_{b}, I_{d}, I$ lie on the Apollonius circle of the points $O_{a}, O_{c}$ with ratio $r_{a}: r_{c}$. In this Apollonius circle $X U$ is a diameter, and the lines $I U$ and $I X$ are respectively the internal and external bisectors of $\angle O_{a} I O_{c}=\angle A I C$, according to the angle bisector theorem. Moreover, in the Apollonius circle the diameter $U X$ is the perpendicular bisector of $I_{b} I_{d}$, so the lines $I X$ and $I U$ are the internal and external bisectors of $\angle I_{b} I I_{d}=\angle B I D$, respectively.

Repeating the same argument for the points $B, D$ instead of $A, C$, we get that the line $I Y$ is the internal bisector of $\angle A I C$ and the external bisector of $\angle B I D$. Therefore, the lines $I X$ and $I Y$ respectively are the internal and external bisectors of $\angle B I D$, so they are perpendicular.

Comment. In fact the points $O_{a}, O_{b}, O_{c}$ and $O_{d}$ lie on the line segments $A I, B I, C I$ and $D I$, respectively. For the point $O_{a}$ this can be shown for example by $\angle I_{d} O_{a} A+\angle A O_{a} I_{b}=\left(180^{\circ}-\right.$ $\left.2 \angle O_{a} A I_{d}\right)+\left(180^{\circ}-2 \angle I_{b} A O_{a}\right)=360^{\circ}-\angle B A D=\angle A D I+\angle D I A+\angle A I B+\angle I B A>\angle I_{d} I A+\angle A I I_{b}$.

The solution also shows that the line $I Y$ passes through the point $U$, and analogously, $I X$ passes through the internal similitude center of $\omega_{b}$ and $\omega_{d}$.",798,4
2017n2,"Let $p \geqslant 2$ be a prime number. Eduardo and Fernando play the following game making moves alternately: in each move, the current player chooses an index $i$ in the set $\{0,1, \ldots, p-1\}$ that was not chosen before by either of the two players and then chooses an element $a_{i}$ of the set $\{0,1,2,3,4,5,6,7,8,9\}$. Eduardo has the first move. The game ends after all the indices $i \in\{0,1, \ldots, p-1\}$ have been chosen. Then the following number is computed:

$$
M=a_{0}+10 \cdot a_{1}+\cdots+10^{p-1} \cdot a_{p-1}=\sum_{j=0}^{p-1} a_{j} \cdot 10^{j} .
$$

The goal of Eduardo is to make the number $M$ divisible by $p$, and the goal of Fernando is to prevent this.

Prove that Eduardo has a winning strategy.","Solution. We say that a player makes the move $\left(i, a_{i}\right)$ if he chooses the index $i$ and then the element $a_{i}$ of the set $\{0,1,2,3,4,5,6,7,8,9\}$ in this move.

If $p=2$ or $p=5$ then Eduardo chooses $i=0$ and $a_{0}=0$ in the first move, and wins, since, independently of the next moves, $M$ will be a multiple of 10 .

Now assume that the prime number $p$ does not belong to $\{2,5\}$. Eduardo chooses $i=p-1$ and $a_{p-1}=0$ in the first move. By Fermat's Little Theorem, $\left(10^{(p-1) / 2}\right)^{2}=10^{p-1} \equiv 1(\bmod p)$, so $p \mid\left(10^{(p-1) / 2}\right)^{2}-1=\left(10^{(p-1) / 2}+1\right)\left(10^{(p-1) / 2}-1\right)$. Since $p$ is prime, either $p \mid 10^{(p-1) / 2}+1$ or $p \mid 10^{(p-1) / 2}-1$. Thus we have two cases:\\
Case a: $10^{(p-1) / 2} \equiv-1(\bmod p)$\\
In this case, for each move ( $i, a_{i}$ ) of Fernando, Eduardo immediately makes the move $\left(j, a_{j}\right)=$ $\left(i+\frac{p-1}{2}, a_{i}\right)$, if $0 \leqslant i \leqslant \frac{p-3}{2}$, or $\left(j, a_{j}\right)=\left(i-\frac{p-1}{2}, a_{i}\right)$, if $\frac{p-1}{2} \leqslant i \leqslant p-2$. We will have $10^{j} \equiv-10^{i}$ $(\bmod p)$, and so $a_{j} \cdot 10^{j}=a_{i} \cdot 10^{j} \equiv-a_{i} \cdot 10^{i}(\bmod p)$. Notice that this move by Eduardo is always possible. Indeed, immediately before a move by Fernando, for any set of the type $\{r, r+(p-1) / 2\}$ with $0 \leqslant r \leqslant(p-3) / 2$, either no element of this set was chosen as an index by the players in the previous moves or else both elements of this set were chosen as indices by the players in the previous moves. Therefore, after each of his moves, Eduardo always makes the sum of the numbers $a_{k} \cdot 10^{k}$ corresponding to the already chosen pairs ( $k, a_{k}$ ) divisible by $p$, and thus wins the game.\\
Case b: $10^{(p-1) / 2} \equiv 1(\bmod p)$\\
In this case, for each move $\left(i, a_{i}\right)$ of Fernando, Eduardo immediately makes the move $\left(j, a_{j}\right)=$ $\left(i+\frac{p-1}{2}, 9-a_{i}\right)$, if $0 \leqslant i \leqslant \frac{p-3}{2}$, or $\left(j, a_{j}\right)=\left(i-\frac{p-1}{2}, 9-a_{i}\right)$, if $\frac{p-1}{2} \leqslant i \leqslant p-2$. The same argument as above shows that Eduardo can always make such move. We will have $10^{j} \equiv 10^{i}$ $(\bmod p)$, and so $a_{j} \cdot 10^{j}+a_{i} \cdot 10^{i} \equiv\left(a_{i}+a_{j}\right) \cdot 10^{i}=9 \cdot 10^{i}(\bmod p)$. Therefore, at the end of the game, the sum of all terms $a_{k} \cdot 10^{k}$ will be congruent to

$$
\sum_{i=0}^{\frac{p-3}{2}} 9 \cdot 10^{i}=10^{(p-1) / 2}-1 \equiv 0 \quad(\bmod p),
$$

and Eduardo wins the game.",399,3
2017n7,"Say that an ordered pair $(x, y)$ of integers is an irreducible lattice point if $x$ and $y$ are relatively prime. For any finite set $S$ of irreducible lattice points, show that there is a homogenous polynomial in two variables, $f(x, y)$, with integer coefficients, of degree at least 1 , such that $f(x, y)=1$ for each $(x, y)$ in the set $S$.

Note: A homogenous polynomial of degree $n$ is any nonzero polynomial of the form

\begin{equation*}
f(x, y)=a_{0} x^{n}+a_{1} x^{n-1} y+a_{2} x^{n-2} y^{2}+\cdots+a_{n-1} x y^{n-1}+a_{n} y^{n} . \tag{U.S.A.}
\end{equation*}
","First of all, we note that finding a homogenous polynomial $f(x, y)$ such that $f(x, y)= \pm 1$ is enough, because we then have $f^{2}(x, y)=1$. Label the irreducible lattice points $\left(x_{1}, y_{1}\right)$ through $\left(x_{n}, y_{n}\right)$. If any two of these lattice points $\left(x_{i}, y_{i}\right)$ and $\left(x_{j}, y_{j}\right)$ lie on the same line through the origin, then $\left(x_{j}, y_{j}\right)=\left(-x_{i},-y_{i}\right)$ because both of the points are irreducible. We then have $f\left(x_{j}, y_{j}\right)= \pm f\left(x_{i}, y_{i}\right)$ whenever $f$ is homogenous, so we can assume that no two of the lattice points are collinear with the origin by ignoring the extra lattice points.

Consider the homogenous polynomials $\ell_{i}(x, y)=y_{i} x-x_{i} y$ and define

$$
g_{i}(x, y)=\prod_{j \neq i} \ell_{j}(x, y) .
$$

Then $\ell_{i}\left(x_{j}, y_{j}\right)=0$ if and only if $j=i$, because there is only one lattice point on each line through the origin. Thus, $g_{i}\left(x_{j}, y_{j}\right)=0$ for all $j \neq i$. Define $a_{i}=g_{i}\left(x_{i}, y_{i}\right)$, and note that $a_{i} \neq 0$.

Note that $g_{i}(x, y)$ is a degree $n-1$ polynomial with the following two properties:

\begin{enumerate}
  \item $g_{i}\left(x_{j}, y_{j}\right)=0$ if $j \neq i$.
  \item $g_{i}\left(x_{i}, y_{i}\right)=a_{i}$.
\end{enumerate}

For any $N \geqslant n-1$, there also exists a polynomial of degree $N$ with the same two properties. Specifically, let $I_{i}(x, y)$ be a degree 1 homogenous polynomial such that $I_{i}\left(x_{i}, y_{i}\right)=1$, which exists since $\left(x_{i}, y_{i}\right)$ is irreducible. Then $I_{i}(x, y)^{N-(n-1)} g_{i}(x, y)$ satisfies both of the above properties and has degree $N$.

We may now reduce the problem to the following claim:\\
Claim: For each positive integer $a$, there is a homogenous polynomial $f_{a}(x, y)$, with integer coefficients, of degree at least 1 , such that $f_{a}(x, y) \equiv 1(\bmod a)$ for all relatively prime $(x, y)$.

To see that this claim solves the problem, take $a$ to be the least common multiple of the numbers $a_{i}(1 \leqslant i \leqslant n)$. Take $f_{a}$ given by the claim, choose some power $f_{a}(x, y)^{k}$ that has degree at least $n-1$, and subtract appropriate multiples of the $g_{i}$ constructed above to obtain the desired polynomial.

We prove the claim by factoring $a$. First, if $a$ is a power of a prime $\left(a=p^{k}\right)$, then we may choose either:

\begin{itemize}
  \item $f_{a}(x, y)=\left(x^{p-1}+y^{p-1}\right)^{\phi(a)}$ if $p$ is odd;
  \item $f_{a}(x, y)=\left(x^{2}+x y+y^{2}\right)^{\phi(a)}$ if $p=2$.
\end{itemize}

Now suppose $a$ is any positive integer, and let $a=q_{1} q_{2} \cdots q_{k}$, where the $q_{i}$ are prime powers, pairwise relatively prime. Let $f_{q_{i}}$ be the polynomials just constructed, and let $F_{q_{i}}$ be powers of these that all have the same degree. Note that

$$
\frac{a}{q_{i}} F_{q_{i}}(x, y) \equiv \frac{a}{q_{i}} \quad(\bmod a)
$$

for any relatively prime $x, y$. By Bzout's lemma, there is an integer linear combination of the $\frac{a}{q_{i}}$ that equals 1 . Thus, there is a linear combination of the $F_{q_{i}}$ such that $F_{q_{i}}(x, y) \equiv 1$ $(\bmod a)$ for any relatively prime $(x, y)$; and this polynomial is homogenous because all the $F_{q_{i}}$ have the same degree.

",485,3
2017n8,"Let $p$ be an odd prime number and $\mathbb{Z}_{>0}$ be the set of positive integers. Suppose that a function $f: \mathbb{Z}_{>0} \times \mathbb{Z}_{>0} \rightarrow\{0,1\}$ satisfies the following properties:

\begin{itemize}
  \item $f(1,1)=0$;
  \item $f(a, b)+f(b, a)=1$ for any pair of relatively prime positive integers $(a, b)$ not both equal to 1 ;
  \item $f(a+b, b)=f(a, b)$ for any pair of relatively prime positive integers $(a, b)$.
\end{itemize}

Prove that

$$
\sum_{n=1}^{p-1} f\left(n^{2}, p\right) \geqslant \sqrt{2 p}-2
$$","Denote by $\mathbb{A}$ the set of all pairs of coprime positive integers. Notice that for every $(a, b) \in \mathbb{A}$ there exists a pair $(u, v) \in \mathbb{Z}^{2}$ with $u a+v b=1$. Moreover, if $\left(u_{0}, v_{0}\right)$ is one such pair, then all such pairs are of the form $(u, v)=\left(u_{0}+k b, v_{0}-k a\right)$, where $k \in \mathbb{Z}$. So there exists a unique such pair $(u, v)$ with $-b / 2<u \leqslant b / 2$; we denote this pair by $(u, v)=g(a, b)$.\\
Lemma. Let $(a, b) \in \mathbb{A}$ and $(u, v)=g(a, b)$. Then $f(a, b)=1 \Longleftrightarrow u>0$.\\
Proof. We induct on $a+b$. The base case is $a+b=2$. In this case, we have that $a=b=1$, $g(a, b)=g(1,1)=(0,1)$ and $f(1,1)=0$, so the claim holds.

Assume now that $a+b>2$, and so $a \neq b$, since $a$ and $b$ are coprime. Two cases are possible.\\
Case 1: $a>b$.\\
Notice that $g(a-b, b)=(u, v+u)$, since $u(a-b)+(v+u) b=1$ and $u \in(-b / 2, b / 2]$. Thus $f(a, b)=1 \Longleftrightarrow f(a-b, b)=1 \Longleftrightarrow u>0$ by the induction hypothesis.\\
Case 2: $a<b$. (Then, clearly, $b \geqslant 2$.)\\
Now we estimate $v$. Since $v b=1-u a$, we have

$$
1+\frac{a b}{2}>v b \geqslant 1-\frac{a b}{2}, \quad \text { so } \quad \frac{1+a}{2} \geqslant \frac{1}{b}+\frac{a}{2}>v \geqslant \frac{1}{b}-\frac{a}{2}>-\frac{a}{2}
$$

Thus $1+a>2 v>-a$, so $a \geqslant 2 v>-a$, hence $a / 2 \geqslant v>-a / 2$, and thus $g(b, a)=(v, u)$.\\
Observe that $f(a, b)=1 \Longleftrightarrow f(b, a)=0 \Longleftrightarrow f(b-a, a)=0$. We know from Case 1 that $g(b-a, a)=(v, u+v)$. We have $f(b-a, a)=0 \Longleftrightarrow v \leqslant 0$ by the inductive hypothesis. Then, since $b>a \geqslant 1$ and $u a+v b=1$, we have $v \leqslant 0 \Longleftrightarrow u>0$, and we are done.

The Lemma proves that, for all $(a, b) \in \mathbb{A}, f(a, b)=1$ if and only if the inverse of $a$ modulo $b$, taken in $\{1,2, \ldots, b-1\}$, is at most $b / 2$. Then, for any odd prime $p$ and integer $n$ such that $n \not \equiv 0(\bmod p), f\left(n^{2}, p\right)=1$ iff the inverse of $n^{2} \bmod p$ is less than $p / 2$. Since $\left\{n^{2} \bmod p: 1 \leqslant n \leqslant p-1\right\}=\left\{n^{-2} \bmod p: 1 \leqslant n \leqslant p-1\right\}$, including multiplicities (two for each quadratic residue in each set), we conclude that the desired sum is twice the number of quadratic residues that are less than $p / 2$, i.e.,


\begin{equation*}
\left.\sum_{n=1}^{p-1} f\left(n^{2}, p\right)=2 \left\lvert\,\left\{k: 1 \leqslant k \leqslant \frac{p-1}{2} \text { and } k^{2} \bmod p<\frac{p}{2}\right\}\right. \right\rvert\, \tag{1}
\end{equation*}


Since the number of perfect squares in the interval $[1, p / 2)$ is $\lfloor\sqrt{p / 2}\rfloor>\sqrt{p / 2}-1$, we conclude that

$$
\sum_{n=1}^{p-1} f\left(n^{2}, p\right)>2\left(\sqrt{\frac{p}{2}}-1\right)=\sqrt{2 p}-2
$$
",440,3
2016a1,"Let $a, b$ and $c$ be positive real numbers such that $\min \{a b, b c, c a\} \geqslant 1$. Prove that


\begin{equation*}
\sqrt[3]{\left(a^{2}+1\right)\left(b^{2}+1\right)\left(c^{2}+1\right)} \leqslant\left(\frac{a+b+c}{3}\right)^{2}+1 \tag{1}
\end{equation*}","We first show the following.

\begin{itemize}
  \item Claim. For any positive real numbers $x, y$ with $x y \geqslant 1$, we have
\end{itemize}


\begin{equation*}
\left(x^{2}+1\right)\left(y^{2}+1\right) \leqslant\left(\left(\frac{x+y}{2}\right)^{2}+1\right)^{2} \tag{2}
\end{equation*}


Proof. Note that $x y \geqslant 1$ implies $\left(\frac{x+y}{2}\right)^{2}-1 \geqslant x y-1 \geqslant 0$. We find that

$$
\left(x^{2}+1\right)\left(y^{2}+1\right)=(x y-1)^{2}+(x+y)^{2} \leqslant\left(\left(\frac{x+y}{2}\right)^{2}-1\right)^{2}+(x+y)^{2}=\left(\left(\frac{x+y}{2}\right)^{2}+1\right)^{2} .
$$

Without loss of generality, assume $a \geqslant b \geqslant c$. This implies $a \geqslant 1$. Let $d=\frac{a+b+c}{3}$. Note that

$$
a d=\frac{a(a+b+c)}{3} \geqslant \frac{1+1+1}{3}=1 .
$$

Then we can apply (2) to the pair $(a, d)$ and the pair $(b, c)$. We get


\begin{equation*}
\left(a^{2}+1\right)\left(d^{2}+1\right)\left(b^{2}+1\right)\left(c^{2}+1\right) \leqslant\left(\left(\frac{a+d}{2}\right)^{2}+1\right)^{2}\left(\left(\frac{b+c}{2}\right)^{2}+1\right)^{2} \tag{3}
\end{equation*}


Next, from

$$
\frac{a+d}{2} \cdot \frac{b+c}{2} \geqslant \sqrt{a d} \cdot \sqrt{b c} \geqslant 1,
$$

we can apply (2) again to the pair $\left(\frac{a+d}{2}, \frac{b+c}{2}\right)$. Together with (3), we have

$$
\left(a^{2}+1\right)\left(d^{2}+1\right)\left(b^{2}+1\right)\left(c^{2}+1\right) \leqslant\left(\left(\frac{a+b+c+d}{4}\right)^{2}+1\right)^{4}=\left(d^{2}+1\right)^{4}
$$

Therefore, $\left(a^{2}+1\right)\left(b^{2}+1\right)\left(c^{2}+1\right) \leqslant\left(d^{2}+1\right)^{3}$, and (1) follows by taking cube root of both sides.

",146,2
2016a5,"(a) Prove that for every positive integer $n$, there exists a fraction $\frac{a}{b}$ where $a$ and $b$ are integers satisfying $0<b \leqslant \sqrt{n}+1$ and $\sqrt{n} \leqslant \frac{a}{b} \leqslant \sqrt{n+1}$.\\
(b) Prove that there are infinitely many positive integers $n$ such that there is no fraction $\frac{a}{b}$ where $a$ and $b$ are integers satisfying $0<b \leqslant \sqrt{n}$ and $\sqrt{n} \leqslant \frac{a}{b} \leqslant \sqrt{n+1}$.","(a) Let $r$ be the unique positive integer for which $r^{2} \leqslant n<(r+1)^{2}$. Write $n=r^{2}+s$. Then we have $0 \leqslant s \leqslant 2 r$. We discuss in two cases according to the parity of $s$.

\begin{itemize}
  \item Case 1. $s$ is even.
\end{itemize}

Consider the number $\left(r+\frac{s}{2 r}\right)^{2}=r^{2}+s+\left(\frac{s}{2 r}\right)^{2}$. We find that

$$
n=r^{2}+s \leqslant r^{2}+s+\left(\frac{s}{2 r}\right)^{2} \leqslant r^{2}+s+1=n+1
$$

It follows that

$$
\sqrt{n} \leqslant r+\frac{s}{2 r} \leqslant \sqrt{n+1}
$$

Since $s$ is even, we can choose the fraction $r+\frac{s}{2 r}=\frac{r^{2}+(s / 2)}{r}$ since $r \leqslant \sqrt{n}$.

\begin{itemize}
  \item Case 2. $s$ is odd.
\end{itemize}

Consider the number $\left(r+1-\frac{2 r+1-s}{2(r+1)}\right)^{2}=(r+1)^{2}-(2 r+1-s)+\left(\frac{2 r+1-s}{2(r+1)}\right)^{2}$. We find that

$$
\begin{aligned}
n=r^{2}+s=(r+1)^{2}-(2 r+1-s) & \leqslant(r+1)^{2}-(2 r+1-s)+\left(\frac{2 r+1-s}{2(r+1)}\right)^{2} \\
& \leqslant(r+1)^{2}-(2 r+1-s)+1=n+1
\end{aligned}
$$

It follows that

$$
\sqrt{n} \leqslant r+1-\frac{2 r+1-s}{2(r+1)} \leqslant \sqrt{n+1}
$$

Since $s$ is odd, we can choose the fraction $(r+1)-\frac{2 r+1-s}{2(r+1)}=\frac{(r+1)^{2}-r+((s-1) / 2)}{r+1}$ since $r+1 \leqslant \sqrt{n}+1$.\\
(b) We show that for every positive integer $r$, there is no fraction $\frac{a}{b}$ with $b \leqslant \sqrt{r^{2}+1}$ such that $\sqrt{r^{2}+1} \leqslant \frac{a}{b} \leqslant \sqrt{r^{2}+2}$. Suppose on the contrary that such a fraction exists. Since $b \leqslant \sqrt{r^{2}+1}<r+1$ and $b$ is an integer, we have $b \leqslant r$. Hence,

$$
(b r)^{2}<b^{2}\left(r^{2}+1\right) \leqslant a^{2} \leqslant b^{2}\left(r^{2}+2\right) \leqslant b^{2} r^{2}+2 b r<(b r+1)^{2}
$$

This shows the square number $a^{2}$ is strictly bounded between the two consecutive squares $(b r)^{2}$ and $(b r+1)^{2}$, which is impossible. Hence, we have found infinitely many $n=r^{2}+1$ for which there is no fraction of the desired form.",250,2
2016c3,Let $n$ be a positive integer relatively prime to 6 . We paint the vertices of a regular $n$-gon with three colours so that there is an odd number of vertices of each colour. Show that there exists an isosceles triangle whose three vertices are of different colours.,"Solution. For $k=1,2,3$, let $a_{k}$ be the number of isosceles triangles whose vertices contain exactly $k$ colours. Suppose on the contrary that $a_{3}=0$. Let $b, c, d$ be the number of vertices of the three different colours respectively. We now count the number of pairs $(\triangle, E)$ where $\triangle$ is an isosceles triangle and $E$ is a side of $\triangle$ whose endpoints are of different colours.

On the one hand, since we have assumed $a_{3}=0$, each triangle in the pair must contain exactly two colours, and hence each triangle contributes twice. Thus the number of pairs is $2 a_{2}$.

On the other hand, if we pick any two vertices $A, B$ of distinct colours, then there are three isosceles triangles having these as vertices, two when $A B$ is not the base and one when $A B$ is the base since $n$ is odd. Note that the three triangles are all distinct as $(n, 3)=1$. In this way, we count the number of pairs to be $3(b c+c d+d b)$. However, note that $2 a_{2}$ is even while $3(b c+c d+d b)$ is odd, as each of $b, c, d$ is. This yields a contradiction and hence $a_{3} \geqslant 1$.

Comment. A slightly stronger version of this problem is to replace the condition $(n, 6)=1$ by $n$ being odd (where equilateral triangles are regarded as isosceles triangles). In that case, the only difference in the proof is that by fixing any two vertices $A, B$, one can find exactly one or three isosceles triangles having these as vertices. But since only parity is concerned in the solution, the proof goes the same way.

The condition that there is an odd number of vertices of each colour is necessary, as can be seen from the following example. Consider $n=25$ and we label the vertices $A_{0}, A_{1}, \ldots, A_{24}$. Suppose colour 1 is used for $A_{0}$, colour 2 is used for $A_{5}, A_{10}, A_{15}, A_{20}$, while colour 3 is used for the remaining vertices. Then any isosceles triangle having colours 1 and 2 must contain $A_{0}$ and one of $A_{5}, A_{10}, A_{15}, A_{20}$. Clearly, the third vertex must have index which is a multiple of 5 so it is not of colour 3 .",372,3
2016c6,"There are $n \geqslant 3$ islands in a city. Initially, the ferry company offers some routes between some pairs of islands so that it is impossible to divide the islands into two groups such that no two islands in different groups are connected by a ferry route.

After each year, the ferry company will close a ferry route between some two islands $X$ and $Y$. At the same time, in order to maintain its service, the company will open new routes according to the following rule: for any island which is connected by a ferry route to exactly one of $X$ and $Y$, a new route between this island and the other of $X$ and $Y$ is added.

Suppose at any moment, if we partition all islands into two nonempty groups in any way, then it is known that the ferry company will close a certain route connecting two islands from the two groups after some years. Prove that after some years there will be an island which is connected to all other islands by ferry routes.","Solution. Initially, we pick any pair of islands $A$ and $B$ which are connected by a ferry route and put $A$ in set $\mathcal{A}$ and $B$ in set $\mathcal{B}$. From the condition, without loss of generality there must be another island which is connected to $A$. We put such an island $C$ in set $\mathcal{B}$. We say that two sets of islands form a network if each island in one set is connected to each island in the other set.

Next, we shall included all islands to $\mathcal{A} \cup \mathcal{B}$ one by one. Suppose we have two sets $\mathcal{A}$ and $\mathcal{B}$ which form a network where $3 \leqslant|\mathcal{A} \cup \mathcal{B}|<n$. This relation no longer holds only when a ferry route between islands $A \in \mathcal{A}$ and $B \in \mathcal{B}$ is closed. In that case, we define $\mathcal{A}^{\prime}=\{A, B\}$, and $\mathcal{B}^{\prime}=(\mathcal{A} \cup \mathcal{B})-\{A, B\}$. Note that $\mathcal{B}^{\prime}$ is nonempty. Consider any island $C \in \mathcal{A}-\{A\}$. From the relation of $\mathcal{A}$ and $\mathcal{B}$, we know that $C$ is connected to $B$. If $C$ was not connected to $A$ before the route between $A$ and $B$ closes, then there will be a route added between $C$ and $A$ afterwards. Hence, $C$ must now be connected to both $A$ and $B$. The same holds true for any island in $\mathcal{B}-\{B\}$. Therefore, $\mathcal{A}^{\prime}$ and $\mathcal{B}^{\prime}$ form a network, and $\mathcal{A}^{\prime} \cup \mathcal{B}^{\prime}=\mathcal{A} \cup \mathcal{B}$. Hence these islands can always be partitioned into sets $\mathcal{A}$ and $\mathcal{B}$ which form a network.

As $|\mathcal{A} \cup \mathcal{B}|<n$, there are some islands which are not included in $\mathcal{A} \cup \mathcal{B}$. From the condition, after some years there must be a ferry route between an island $A$ in $\mathcal{A} \cup \mathcal{B}$ and an island $D$ outside $\mathcal{A} \cup \mathcal{B}$ which closes. Without loss of generality assume $A \in \mathcal{A}$. Then each island in $\mathcal{B}$ must then be connected to $D$, no matter it was or not before. Hence, we can put $D$ in set $\mathcal{A}$ so that the new sets $\mathcal{A}$ and $\mathcal{B}$ still form a network and the size of $\mathcal{A} \cup \mathcal{B}$ is increased by 1 . The same process can be done to increase the size of $\mathcal{A} \cup \mathcal{B}$. Eventually, all islands are included in this way so we may now assume $|\mathcal{A} \cup \mathcal{B}|=n$.

Suppose a ferry route between $A \in \mathcal{A}$ and $B \in \mathcal{B}$ is closed after some years. We put $A$ and $B$ in set $\mathcal{A}^{\prime}$ and all remaining islands in set $\mathcal{B}^{\prime}$. Then $\mathcal{A}^{\prime}$ and $\mathcal{B}^{\prime}$ form a network. This relation no longer holds only when a route between $A$, without loss of generality, and $C \in \mathcal{B}^{\prime}$ is closed. Since this must eventually occur, at that time island $B$ will be connected to all other islands and the result follows.",460,3
2016c7,"Let $n \geqslant 2$ be an integer. In the plane, there are $n$ segments given in such a way that any two segments have an intersection point in the interior, and no three segments intersect at a single point. Jeff places a snail at one of the endpoints of each of the segments and claps his hands $n-1$ times. Each time when he claps his hands, all the snails move along their own segments and stay at the next intersection points until the next clap. Since there are $n-1$ intersection points on each segment, all snails will reach the furthest intersection points from their starting points after $n-1$ claps.\\
(a) Prove that if $n$ is odd then Jeff can always place the snails so that no two of them ever occupy the same intersection point.\\
(b) Prove that if $n$ is even then there must be a moment when some two snails occupy the same intersection point no matter how Jeff places the snails.","Solution. We consider a big disk which contains all the segments. We extend each segment to a line $l_{i}$ so that each of them cuts the disk at two distinct points $A_{i}, B_{i}$.\\
(a) For odd $n$, we travel along the circumference of the disk and mark each of the points $A_{i}$ or $B_{i}$ 'in' and 'out' alternately. Since every pair of lines intersect in the disk, there are exactly $n-1$ points between $A_{i}$ and $B_{i}$ for any fixed $1 \leqslant i \leqslant n$. As $n$ is odd, this means one of $A_{i}$ and $B_{i}$ is marked 'in' and the other is marked 'out'. Then Jeff can put a snail on the endpoint of each segment which is closer to the 'in' side of the corresponding line. We claim that the snails on $l_{i}$ and $l_{j}$ do not meet for any pairs $i, j$, hence proving part (a).\\
\includegraphics[max width=\textwidth, center]{2025_04_30_7daf08b5ed3ffd852861g-43}

Without loss of generality, we may assume the snails start at $A_{i}$ and $A_{j}$ respectively. Let $l_{i}$ intersect $l_{j}$ at $P$. Note that there is an odd number of points between arc $A_{i} A_{j}$. Each of these points belongs to a line $l_{k}$. Such a line $l_{k}$ must intersect exactly one of\\
the segments $A_{i} P$ and $A_{j} P$, making an odd number of intersections. For the other lines, they may intersect both segments $A_{i} P$ and $A_{j} P$, or meet none of them. Therefore, the total number of intersection points on segments $A_{i} P$ and $A_{j} P$ (not counting $P$ ) is odd. However, if the snails arrive at $P$ at the same time, then there should be the same number of intersections on $A_{i} P$ and $A_{j} P$, which gives an even number of intersections. This is a contradiction so the snails do not meet each other.\\
(b) For even $n$, we consider any way that Jeff places the snails and mark each of the points $A_{i}$ or $B_{i}$ 'in' and 'out' according to the directions travelled by the snails. In this case there must be two neighbouring points $A_{i}$ and $A_{j}$ both of which are marked 'in'. Let $P$ be the intersection of the segments $A_{i} B_{i}$ and $A_{j} B_{j}$. Then any other segment meeting one of the segments $A_{i} P$ and $A_{j} P$ must also meet the other one, and so the number of intersections on $A_{i} P$ and $A_{j} P$ are the same. This shows the snails starting from $A_{i}$ and $A_{j}$ will meet at $P$.",412,3
2016g1,"In a convex pentagon $A B C D E$, let $F$ be a point on $A C$ such that $\angle F B C=90^{\circ}$. Suppose triangles $A B F, A C D$ and $A D E$ are similar isosceles triangles with


\begin{equation*}
\angle F A B=\angle F B A=\angle D A C=\angle D C A=\angle E A D=\angle E D A . \tag{1}
\end{equation*}


Let $M$ be the midpoint of $C F$. Point $X$ is chosen such that $A M X E$ is a parallelogram. Show that $B D, E M$ and $F X$ are concurrent.","Denote the common angle in (1) by $\theta$. As $\triangle A B F \sim \triangle A C D$, we have $\frac{A B}{A C}=\frac{A F}{A D}$ so that $\triangle A B C \sim \triangle A F D$. From $E A=E D$, we get

$$
\angle A F D=\angle A B C=90^{\circ}+\theta=180^{\circ}-\frac{1}{2} \angle A E D .
$$

Hence, $F$ lies on the circle with centre $E$ and radius $E A$. In particular, $E F=E A=E D$. As $\angle E F A=\angle E A F=2 \theta=\angle B F C$, points $B, F, E$ are collinear.

As $\angle E D A=\angle M A D$, we have $E D / / A M$ and hence $E, D, X$ are collinear. As $M$ is the midpoint of $C F$ and $\angle C B F=90^{\circ}$, we get $M F=M B$. In the isosceles triangles $E F A$ and $M F B$, we have $\angle E F A=\angle M F B$ and $A F=B F$. Therefore, they are congruent to each other. Then we have $B M=A E=X M$ and $B E=B F+F E=A F+F M=A M=E X$. This shows $\triangle E M B \cong \triangle E M X$. As $F$ and $D$ lie on $E B$ and $E X$ respectively and $E F=E D$, we know that lines $B D$ and $X F$ are symmetric with respect to $E M$. It follows that the three lines are concurrent.\\


",232,2
2016g2,Let $A B C$ be a triangle with circumcircle $\Gamma$ and incentre $I$. Let $M$ be the midpoint of side $B C$. Denote by $D$ the foot of perpendicular from $I$ to side $B C$. The line through $I$ perpendicular to $A I$ meets sides $A B$ and $A C$ at $F$ and $E$ respectively. Suppose the circumcircle of triangle $A E F$ intersects $\Gamma$ at a point $X$ other than $A$. Prove that lines $X D$ and $A M$ meet on $\Gamma$.,"Let $A M$ meet $\Gamma$ again at $Y$ and $X Y$ meet $B C$ at $D^{\prime}$. It suffices to show $D^{\prime}=D$. We shall apply the following fact.

\begin{itemize}
  \item Claim. For any cyclic quadrilateral $P Q R S$ whose diagonals meet at $T$, we have
\end{itemize}

$$
\frac{Q T}{T S}=\frac{P Q \cdot Q R}{P S \cdot S R}
$$

Proof. We use $\left[W_{1} W_{2} W_{3}\right]$ to denote the area of $W_{1} W_{2} W_{3}$. Then

$$
\frac{Q T}{T S}=\frac{[P Q R]}{[P S R]}=\frac{\frac{1}{2} P Q \cdot Q R \sin \angle P Q R}{\frac{1}{2} P S \cdot S R \sin \angle P S R}=\frac{P Q \cdot Q R}{P S \cdot S R}
$$

Applying the Claim to $A B Y C$ and $X B Y C$ respectively, we have $1=\frac{B M}{M C}=\frac{A B \cdot B Y}{A C \cdot C Y}$ and $\frac{B D^{\prime}}{D^{\prime} C}=\frac{X B \cdot B Y}{X C \cdot C Y}$. These combine to give


\begin{equation*}
\frac{B D^{\prime}}{C D^{\prime}}=\frac{X B}{X C} \cdot \frac{B Y}{C Y}=\frac{X B}{X C} \cdot \frac{A C}{A B} \tag{1}
\end{equation*}


Next, we use directed angles to find that $\measuredangle X B F=\measuredangle X B A=\measuredangle X C A=\measuredangle X C E$ and $\measuredangle X F B=\measuredangle X F A=\measuredangle X E A=\measuredangle X E C$. This shows triangles $X B F$ and $X C E$ are directly similar. In particular, we have


\begin{equation*}
\frac{X B}{X C}=\frac{B F}{C E} \tag{2}
\end{equation*}


In the following, we give two ways to continue the proof.

Here is a geometrical method. As $\angle F I B=\angle A I B-90^{\circ}=\frac{1}{2} \angle A C B=\angle I C B$ and $\angle F B I=\angle I B C$, the triangles $F B I$ and $I B C$ are similar. Analogously, triangles $E I C$ and $I B C$ are also similar. Hence, we get

\begin{equation*}
\frac{F B}{I B}=\frac{B I}{B C} \quad \text { and } \quad \frac{E C}{I C}=\frac{I C}{B C} \tag{3}
\end{equation*}

Next, construct a line parallel to $B C$ and tangent to the incircle. Suppose it meets sides $A B$ and $A C$ at $B_{1}$ and $C_{1}$ respectively. Let the incircle touch $A B$ and $A C$ at $B_{2}$ and $C_{2}$ respectively. By homothety, the line $B_{1} I$ is parallel to the external angle bisector of $\angle A B C$, and hence $\angle B_{1} I B=90^{\circ}$. Since $\angle B B_{2} I=90^{\circ}$, we get $B B_{2} \cdot B B_{1}=B I^{2}$, and similarly $C C_{2} \cdot C C_{1}=C I^{2}$. Hence,


\begin{equation*}
\frac{B I^{2}}{C I^{2}}=\frac{B B_{2} \cdot B B_{1}}{C C_{2} \cdot C C_{1}}=\frac{B B_{1}}{C C_{1}} \cdot \frac{B D}{C D}=\frac{A B}{A C} \cdot \frac{B D}{C D} . \tag{4}
\end{equation*}

Combining (1), (2), (3) and (4), we conclude

$$
\frac{B D^{\prime}}{C D^{\prime}}=\frac{X B}{X C} \cdot \frac{A C}{A B}=\frac{B F}{C E} \cdot \frac{A C}{A B}=\frac{B I^{2}}{C I^{2}} \cdot \frac{A C}{A B}=\frac{B D}{C D}
$$

so that $D^{\prime}=D$. The result then follows.
",470,3
2016g3,"Let $B=(-1,0)$ and $C=(1,0)$ be fixed points on the coordinate plane. A nonempty, bounded subset $S$ of the plane is said to be nice if\\
(i) there is a point $T$ in $S$ such that for every point $Q$ in $S$, the segment $T Q$ lies entirely in $S$; and\\
(ii) for any triangle $P_{1} P_{2} P_{3}$, there exists a unique point $A$ in $S$ and a permutation $\sigma$ of the indices $\{1,2,3\}$ for which triangles $A B C$ and $P_{\sigma(1)} P_{\sigma(2)} P_{\sigma(3)}$ are similar.

Prove that there exist two distinct nice subsets $S$ and $S^{\prime}$ of the set $\{(x, y): x \geqslant 0, y \geqslant 0\}$ such that if $A \in S$ and $A^{\prime} \in S^{\prime}$ are the unique choices of points in (ii), then the product $B A \cdot B A^{\prime}$ is a constant independent of the triangle $P_{1} P_{2} P_{3}$.","Solution. If in the similarity of $\triangle A B C$ and $\triangle P_{\sigma(1)} P_{\sigma(2)} P_{\sigma(3)}, B C$ corresponds to the longest side of $\triangle P_{1} P_{2} P_{3}$, then we have $B C \geqslant A B \geqslant A C$. The condition $B C \geqslant A B$ is equivalent to $(x+1)^{2}+y^{2} \leqslant 4$, while $A B \geqslant A C$ is trivially satisfied for any point in the first quadrant. Then we first define

$$
S=\left\{(x, y):(x+1)^{2}+y^{2} \leqslant 4, x \geqslant 0, y \geqslant 0\right\}
$$

Note that $S$ is the intersection of a disk and the first quadrant, so it is bounded and convex, and we can choose any $T \in S$ to meet condition (i). For any point $A$ in $S$, the relation $B C \geqslant A B \geqslant A C$ always holds. Therefore, the point $A$ in (ii) is uniquely determined, while its existence is guaranteed by the above construction.\\
\includegraphics[max width=\textwidth, center]{2025_04_30_7daf08b5ed3ffd852861g-54}

Next, if in the similarity of $\triangle A^{\prime} B C$ and $\triangle P_{\sigma(1)} P_{\sigma(2)} P_{\sigma(3)}, B C$ corresponds to the second longest side of $\triangle P_{1} P_{2} P_{3}$, then we have $A^{\prime} B \geqslant B C \geqslant A^{\prime} C$. The two inequalities are equivalent to $(x+1)^{2}+y^{2} \geqslant 4$ and $(x-1)^{2}+y^{2} \leqslant 4$ respectively. Then we define

$$
S^{\prime}=\left\{(x, y):(x+1)^{2}+y^{2} \geqslant 4,(x-1)^{2}+y^{2} \leqslant 4, x \geqslant 0, y \geqslant 0\right\} .
$$

The boundedness condition is satisfied while (ii) can be argued as in the previous case. For (i), note that $S^{\prime \prime}$ contains points inside the disk $(x-1)^{2}+y^{2} \leqslant 4$ and outside the disk $(x+1)^{2}+y^{2} \geqslant 4$. This shows we can take $T^{\prime}=(1,2)$ in (i), which is the topmost point of the circle $(x-1)^{2}+y^{2}=4$.

It remains to check that the product $B A \cdot B A^{\prime}$ is a constant. Suppose we are given a triangle $P_{1} P_{2} P_{3}$ with $P_{1} P_{2} \geqslant P_{2} P_{3} \geqslant P_{3} P_{1}$. By the similarity, we have

$$
B A=B C \cdot \frac{P_{2} P_{3}}{P_{1} P_{2}} \quad \text { and } \quad B A^{\prime}=B C \cdot \frac{P_{1} P_{2}}{P_{2} P_{3}} .
$$

Thus $B A \cdot B A^{\prime}=B C^{2}=4$, which is certainly independent of the triangle $P_{1} P_{2} P_{3}$.\\
Comment. The original version of this problem includes the condition that the interiors of $S$ and $S^{\prime}$ are disjoint. We remove this condition since it is hard to define the interior of a point set rigorously.",391,3
2016g4,"Let $A B C$ be a triangle with $A B=A C \neq B C$ and let $I$ be its incentre. The line $B I$ meets $A C$ at $D$, and the line through $D$ perpendicular to $A C$ meets $A I$ at $E$. Prove that the reflection of $I$ in $A C$ lies on the circumcircle of triangle $B D E$.","Let $\Gamma$ be the circle with centre $E$ passing through $B$ and $C$. Since $E D \perp A C$, the point $F$ symmetric to $C$ with respect to $D$ lies on $\Gamma$. From $\angle D C I=\angle I C B=\angle C B I$, the line $D C$ is a tangent to the circumcircle of triangle $I B C$. Let $J$ be the symmetric point of $I$ with respect to $D$. Using directed lengths, from

$$
D C \cdot D F=-D C^{2}=-D I \cdot D B=D J \cdot D B
$$

the point $J$ also lies on $\Gamma$. Let $I^{\prime}$ be the reflection of $I$ in $A C$. Since $I J$ and $C F$ bisect each other, $C J F I$ is a parallelogram. From $\angle F I^{\prime} C=\angle C I F=\angle F J C$, we find that $I^{\prime}$ lies on $\Gamma$. This gives $E I^{\prime}=E B$.

Note that $A C$ is the internal angle bisector of $\angle B D I^{\prime}$. This shows $D E$ is the external angle bisector of $\angle B D I^{\prime}$ as $D E \perp A C$. Together with $E I^{\prime}=E B$, it is well-known that $E$ lies on the circumcircle of triangle $B D I^{\prime}$.

",199,2
2016g5,"Let $D$ be the foot of perpendicular from $A$ to the Euler line (the line passing through the circumcentre and the orthocentre) of an acute scalene triangle $A B C$. A circle $\omega$ with centre $S$ passes through $A$ and $D$, and it intersects sides $A B$ and $A C$ at $X$ and $Y$ respectively. Let $P$ be the foot of altitude from $A$ to $B C$, and let $M$ be the midpoint of $B C$. Prove that the circumcentre of triangle $X S Y$ is equidistant from $P$ and $M$.","Denote the orthocentre and circumcentre of triangle $A B C$ by $H$ and $O$ respectively. Let $Q$ be the midpoint of $A H$ and $N$ be the nine-point centre of triangle $A B C$. It is known that $Q$ lies on the nine-point circle of triangle $A B C, N$ is the midpoint of $Q M$ and that $Q M$ is parallel to $A O$.

Let the perpendicular from $S$ to $X Y$ meet line $Q M$ at $S^{\prime}$. Let $E$ be the foot of altitude from $B$ to side $A C$. Since $Q$ and $S$ lie on the perpendicular bisector of $A D$, using directed angles, we have

$$
\begin{aligned}
\measuredangle S D Q & =\measuredangle Q A S=\measuredangle X A S-\measuredangle X A Q=\left(\frac{\pi}{2}-\measuredangle A Y X\right)-\measuredangle B A P=\measuredangle C B A-\measuredangle A Y X \\
& =(\measuredangle C B A-\measuredangle A C B)-\measuredangle B C A-\measuredangle A Y X=\measuredangle P E M-(\measuredangle B C A+\measuredangle A Y X) \\
& =\measuredangle P Q M-\angle(B C, X Y)=\frac{\pi}{2}-\angle\left(S^{\prime} Q, B C\right)-\angle(B C, X Y)=\measuredangle S S^{\prime} Q
\end{aligned}
$$

This shows $D, S^{\prime}, S, Q$ are concyclic.\\
\includegraphics[max width=\textwidth, center]{2025_04_30_7daf08b5ed3ffd852861g-61}

Let the perpendicular from $N$ to $B C$ intersect line $S S^{\prime}$ at $O_{1}$. (Note that the two lines coincide when $S$ is the midpoint of $A O$, in which case the result is true since the circumcentre of triangle $X S Y$ must lie on this line.) It suffices to show that $O_{1}$ is the circumcentre of triangle $X S Y$ since $N$ lies on the perpendicular bisector of $P M$. From

$$
\measuredangle D S^{\prime} O_{1}=\measuredangle D Q S=\measuredangle S Q A=\angle(S Q, Q A)=\angle\left(O D, O_{1} N\right)=\measuredangle D N O_{1}
$$

since $S Q / / O D$ and $Q A / / O_{1} N$, we know that $D, O_{1}, S^{\prime}, N$ are concyclic. Therefore, we get

$$
\measuredangle S D S^{\prime}=\measuredangle S Q S^{\prime}=\angle\left(S Q, Q S^{\prime}\right)=\angle\left(N D, N S^{\prime}\right)=\measuredangle D N S^{\prime}
$$

so that $S D$ is a tangent to the circle through $D, O_{1}, S^{\prime}, N$. Then we have


\begin{equation*}
S S^{\prime} \cdot S O_{1}=S D^{2}=S X^{2} \tag{1}
\end{equation*}


Next, we show that $S$ and $S^{\prime \prime}$ are symmetric with respect to $X Y$. By the Sine Law, we have

$$
\frac{S S^{\prime}}{\sin \angle S Q S^{\prime}}=\frac{S Q}{\sin \angle S S^{\prime} Q}=\frac{S Q}{\sin \angle S D Q}=\frac{S Q}{\sin \angle S A Q}=\frac{S A}{\sin \angle S Q A}
$$

It follows that

$$
S S^{\prime}=S A \cdot \frac{\sin \angle S Q S^{\prime}}{\sin \angle S Q A}=S A \cdot \frac{\sin \angle H O A}{\sin \angle O H A}=S A \cdot \frac{A H}{A O}=S A \cdot 2 \cos A
$$

which is twice the distance from $S$ to $X Y$. Note that $S$ and $C$ lie on the same side of the perpendicular bisector of $P M$ if and only if $\angle S A C<\angle O A C$ if and only if $\angle Y X A>\angle C B A$. This shows $S$ and $O_{1}$ lie on different sides of $X Y$. As $S^{\prime}$ lies on ray $S O_{1}$, it follows that $S$ and $S^{\prime}$ cannot lie on the same side of $X Y$. Therefore, $S$ and $S^{\prime}$ are symmetric with respect to $X Y$.

Let $d$ be the diameter of the circumcircle of triangle $X S Y$. As $S S^{\prime}$ is twice the distance from $S$ to $X Y$ and $S X=S Y$, we have $S S^{\prime}=2 \frac{S X^{2}}{d}$. It follows from (1) that $d=2 S O_{1}$. As $S O_{1}$ is the perpendicular bisector of $X Y$, point $O_{1}$ is the circumcentre of triangle $X S Y$.

",604,4
2016g6,"Let $A B C D$ be a convex quadrilateral with $\angle A B C=\angle A D C<90^{\circ}$. The internal angle bisectors of $\angle A B C$ and $\angle A D C$ meet $A C$ at $E$ and $F$ respectively, and meet each other at point $P$. Let $M$ be the midpoint of $A C$ and let $\omega$ be the circumcircle of triangle $B P D$. Segments $B M$ and $D M$ intersect $\omega$ again at $X$ and $Y$ respectively. Denote by $Q$ the intersection point of lines $X E$ and $Y F$. Prove that $P Q \perp A C$.","Let $\omega_{1}$ be the circumcircle of triangle $A B C$. We first prove that $Y$ lies on $\omega_{1}$. Let $Y^{\prime}$ be the point on ray $M D$ such that $M Y^{\prime} \cdot M D=M A^{2}$. Then triangles $M A Y^{\prime}$ and $M D A$ are oppositely similar. Since $M C^{2}=M A^{2}=M Y^{\prime} \cdot M D$, triangles $M C Y^{\prime}$ and $M D C$ are also oppositely similar. Therefore, using directed angles, we have

$$
\measuredangle A Y^{\prime} C=\measuredangle A Y^{\prime} M+\measuredangle M Y^{\prime} C=\measuredangle M A D+\measuredangle D C M=\measuredangle C D A=\measuredangle A B C
$$

so that $Y^{\prime}$ lies on $\omega_{1}$.\\
Let $Z$ be the intersection point of lines $B C$ and $A D$. Since $\measuredangle P D Z=\measuredangle P B C=\measuredangle P B Z$, point $Z$ lies on $\omega$. In addition, from $\measuredangle Y^{\prime} B Z=\measuredangle Y^{\prime} B C=\measuredangle Y^{\prime} A C=\measuredangle Y^{\prime} A M=\measuredangle Y^{\prime} D Z$, we also know that $Y^{\prime}$ lies on $\omega$. Note that $\angle A D C$ is acute implies $M A \neq M D$ so $M Y^{\prime} \neq M D$. Therefore, $Y^{\prime}$ is the second intersection of $D M$ and $\omega$. Then $Y^{\prime}=Y$ and hence $Y$ lies on $\omega_{1}$.

Next, by the Angle Bisector Theorem and the similar triangles, we have

$$
\frac{F A}{F C}=\frac{A D}{C D}=\frac{A D}{A M} \cdot \frac{C M}{C D}=\frac{Y A}{Y M} \cdot \frac{Y M}{Y C}=\frac{Y A}{Y C} .
$$

Hence, $F Y$ is the internal angle bisector of $\angle A Y C$.\\
Let $B^{\prime}$ be the second intersection of the internal angle bisector of $\angle C B A$ and $\omega_{1}$. Then $B^{\prime}$ is the midpoint of arc $A C$ not containing $B$. Therefore, $Y B^{\prime}$ is the external angle bisector of $\angle A Y C$, so that $B^{\prime} Y \perp F Y$.

Denote by $l$ the line through $P$ parallel to $A C$. Suppose $l$ meets line $B^{\prime} Y$ at $S$. From

$$
\begin{aligned}
\measuredangle P S Y & =\measuredangle\left(A C, B^{\prime} Y\right)=\measuredangle A C Y+\measuredangle C Y B^{\prime}=\measuredangle A C Y+\measuredangle C A B^{\prime}=\measuredangle A C Y+\measuredangle B^{\prime} C A \\
& =\measuredangle B^{\prime} C Y=\measuredangle B^{\prime} B Y=\measuredangle P B Y,
\end{aligned}
$$

the point $S$ lies on $\omega$. Similarly, the line through $X$ perpendicular to $X E$ also passes through the second intersection of $l$ and $\omega$, which is the point $S$. From $Q Y \perp Y S$ and $Q X \perp X S$, point $Q$ lies on $\omega$ and $Q S$ is a diameter of $\omega$. Therefore, $P Q \perp P S$ so that $P Q \perp A C$.
",426,3
2016g7,"Let $I$ be the incentre of a non-equilateral triangle $A B C, I_{A}$ be the $A$-excentre, $I_{A}^{\prime}$ be the reflection of $I_{A}$ in $B C$, and $l_{A}$ be the reflection of line $A I_{A}^{\prime}$ in $A I$. Define points $I_{B}, I_{B}^{\prime}$ and line $l_{B}$ analogously. Let $P$ be the intersection point of $l_{A}$ and $l_{B}$.\\
(a) Prove that $P$ lies on line $O I$ where $O$ is the circumcentre of triangle $A B C$.\\
(b) Let one of the tangents from $P$ to the incircle of triangle $A B C$ meet the circumcircle at points $X$ and $Y$. Show that $\angle X I Y=120^{\circ}$.","(a) Let $A^{\prime}$ be the reflection of $A$ in $B C$ and let $M$ be the second intersection of line $A I$ and the circumcircle $\Gamma$ of triangle $A B C$. As triangles $A B A^{\prime}$ and $A O C$ are isosceles with $\angle A B A^{\prime}=2 \angle A B C=\angle A O C$, they are similar to each other. Also, triangles $A B I_{A}$ and $A I C$ are similar. Therefore we have

$$
\frac{A A^{\prime}}{A I_{A}}=\frac{A A^{\prime}}{A B} \cdot \frac{A B}{A I_{A}}=\frac{A C}{A O} \cdot \frac{A I}{A C}=\frac{A I}{A O}
$$

Together with $\angle A^{\prime} A I_{A}=\angle I A O$, we find that triangles $A A^{\prime} I_{A}$ and $A I O$ are similar.\\
\includegraphics[max width=\textwidth, center]{2025_04_30_7daf08b5ed3ffd852861g-69}

Denote by $P^{\prime}$ the intersection of line $A P$ and line $O I$. Using directed angles, we have

$$
\begin{aligned}
\measuredangle M A P^{\prime} & =\measuredangle I_{A}^{\prime} A I_{A}=\measuredangle I_{A}^{\prime} A A^{\prime}-\measuredangle I_{A} A A^{\prime}=\measuredangle A A^{\prime} I_{A}-\measuredangle(A M, O M) \\
& =\measuredangle A I O-\measuredangle A M O=\measuredangle M O P^{\prime} .
\end{aligned}
$$

This shows $M, O, A, P^{\prime}$ are concyclic.

Denote by $R$ and $r$ the circumradius and inradius of triangle $A B C$. Then

$$
I P^{\prime}=\frac{I A \cdot I M}{I O}=\frac{I O^{2}-R^{2}}{I O}
$$

is independent of $A$. Hence, $B P$ also meets line $O I$ at the same point $P^{\prime}$ so that $P^{\prime}=P$, and $P$ lies on $O I$.\\
(b) By Poncelet's Porism, the other tangents to the incircle of triangle $A B C$ from $X$ and $Y$ meet at a point $Z$ on $\Gamma$. Let $T$ be the touching point of the incircle to $X Y$, and let $D$ be the midpoint of $X Y$. We have

$$
\begin{aligned}
O D & =I T \cdot \frac{O P}{I P}=r\left(1+\frac{O I}{I P}\right)=r\left(1+\frac{O I^{2}}{O I \cdot I P}\right)=r\left(1+\frac{R^{2}-2 R r}{R^{2}-I O^{2}}\right) \\
& =r\left(1+\frac{R^{2}-2 R r}{2 R r}\right)=\frac{R}{2}=\frac{O X}{2} .
\end{aligned}
$$

This shows $\angle X Z Y=60^{\circ}$ and hence $\angle X I Y=120^{\circ}$.

",327,3
2016g8,"Let $A_{1}, B_{1}$ and $C_{1}$ be points on sides $B C, C A$ and $A B$ of an acute triangle $A B C$ respectively, such that $A A_{1}, B B_{1}$ and $C C_{1}$ are the internal angle bisectors of triangle $A B C$. Let $I$ be the incentre of triangle $A B C$, and $H$ be the orthocentre of triangle $A_{1} B_{1} C_{1}$. Show that

$$
A H+B H+C H \geqslant A I+B I+C I .
$$","Solution. Without loss of generality, assume $\alpha=\angle B A C \leqslant \beta=\angle C B A \leqslant \gamma=\angle A C B$. Denote by $a, b, c$ the lengths of $B C, C A, A B$ respectively. We first show that triangle $A_{1} B_{1} C_{1}$ is acute.

Choose points $D$ and $E$ on side $B C$ such that $B_{1} D / / A B$ and $B_{1} E$ is the internal angle bisector of $\angle B B_{1} C$. As $\angle B_{1} D B=180^{\circ}-\beta$ is obtuse, we have $B B_{1}>B_{1} D$. Thus,

$$
\frac{B E}{E C}=\frac{B B_{1}}{B_{1} C}>\frac{D B_{1}}{B_{1} C}=\frac{B A}{A C}=\frac{B A_{1}}{A_{1} C} .
$$

Therefore, $B E>B A_{1}$ and $\frac{1}{2} \angle B B_{1} C=\angle B B_{1} E>\angle B B_{1} A_{1}$. Similarly, $\frac{1}{2} \angle B B_{1} A>\angle B B_{1} C_{1}$. It follows that

$$
\angle A_{1} B_{1} C_{1}=\angle B B_{1} A_{1}+\angle B B_{1} C_{1}<\frac{1}{2}\left(\angle B B_{1} C+\angle B B_{1} A\right)=90^{\circ}
$$

is acute. By symmetry, triangle $A_{1} B_{1} C_{1}$ is acute.\\
Let $B B_{1}$ meet $A_{1} C_{1}$ at $F$. From $\alpha \leqslant \gamma$, we get $a \leqslant c$, which implies

$$
B A_{1}=\frac{c a}{b+c} \leqslant \frac{a c}{a+b}=B C_{1}
$$

and hence $\angle B C_{1} A_{1} \leqslant \angle B A_{1} C_{1}$. As $B F$ is the internal angle bisector of $\angle A_{1} B C_{1}$, this shows $\angle B_{1} F C_{1}=\angle B F A_{1} \leqslant 90^{\circ}$. Hence, $H$ lies on the same side of $B B_{1}$ as $C_{1}$. This shows $H$ lies inside triangle $B B_{1} C_{1}$. Similarly, from $\alpha \leqslant \beta$ and $\beta \leqslant \gamma$, we know that $H$ lies inside triangles $C C_{1} B_{1}$ and $A A_{1} C_{1}$.\\
\includegraphics[max width=\textwidth, center]{2025_04_30_7daf08b5ed3ffd852861g-72}

As $\alpha \leqslant \beta \leqslant \gamma$, we have $\alpha \leqslant 60^{\circ} \leqslant \gamma$. Then $\angle B I C \leqslant 120^{\circ} \leqslant \angle A I B$. Firstly, suppose $\angle A I C \geqslant 120^{\circ}$.

Rotate points $B, I, H$ through $60^{\circ}$ about $A$ to $B^{\prime}, I^{\prime}, H^{\prime}$ so that $B^{\prime}$ and $C$ lie on different sides of $A B$. Since triangle $A I^{\prime} I$ is equilateral, we have


\begin{equation*}
A I+B I+C I=I^{\prime} I+B^{\prime} I^{\prime}+I C=B^{\prime} I^{\prime}+I^{\prime} I+I C . \tag{1}
\end{equation*}


Similarly,


\begin{equation*}
A H+B H+C H=H^{\prime} H+B^{\prime} H^{\prime}+H C=B^{\prime} H^{\prime}+H^{\prime} H+H C . \tag{2}
\end{equation*}


As $\angle A I I^{\prime}=\angle A I^{\prime} I=60^{\circ}, \angle A I^{\prime} B^{\prime}=\angle A I B \geqslant 120^{\circ}$ and $\angle A I C \geqslant 120^{\circ}$, the quadrilateral $B^{\prime} I^{\prime} I C$ is convex and lies on the same side of $B^{\prime} C$ as $A$.

Next, since $H$ lies inside triangle $A C C_{1}, H$ lies outside $B^{\prime} I^{\prime} I C$. Also, $H$ lying inside triangle $A B I$ implies $H^{\prime}$ lies inside triangle $A B^{\prime} I^{\prime}$. This shows $H^{\prime}$ lies outside $B^{\prime} I^{\prime} I C$ and hence the convex quadrilateral $B^{\prime} I^{\prime} I C$ is contained inside the quadrilateral $B^{\prime} H^{\prime} H C$. It follows that the perimeter of $B^{\prime} I^{\prime} I C$ cannot exceed the perimeter of $B^{\prime} H^{\prime} H C$. From (1) and (2), we conclude that

$$
A H+B H+C H \geqslant A I+B I+C I
$$

For the case $\angle A I C<120^{\circ}$, we can rotate $B, I, H$ through $60^{\circ}$ about $C$ to $B^{\prime}, I^{\prime}, H^{\prime}$ so that $B^{\prime}$ and $A$ lie on different sides of $B C$. The proof is analogous to the previous case and we still get the desired inequality.",551,4
2016n4,"Let $n, m, k$ and $l$ be positive integers with $n \neq 1$ such that $n^{k}+m n^{l}+1$ divides $n^{k+l}-1$. Prove that

\begin{itemize}
  \item $m=1$ and $l=2 k$; or
  \item $l \mid k$ and $m=\frac{n^{k-l}-1}{n^{l}-1}$.
\end{itemize}","It is given that


\begin{equation*}
n^{k}+m n^{l}+1 \mid n^{k+l}-1 \tag{1}
\end{equation*}


This implies


\begin{equation*}
n^{k}+m n^{l}+1 \mid\left(n^{k+l}-1\right)+\left(n^{k}+m n^{l}+1\right)=n^{k+l}+n^{k}+m n^{l} . \tag{2}
\end{equation*}


We have two cases to discuss.

\begin{itemize}
  \item Case 1. $l \geqslant k$.
\end{itemize}

Since $\left(n^{k}+m n^{l}+1, n\right)=1$, (2) yields

$$
n^{k}+m n^{l}+1 \mid n^{l}+m n^{l-k}+1 .
$$

In particular, we get $n^{k}+m n^{l}+1 \leqslant n^{l}+m n^{l-k}+1$. As $n \geqslant 2$ and $k \geqslant 1,(m-1) n^{l}$ is at least $2(m-1) n^{l-k}$. It follows that the inequality cannot hold when $m \geqslant 2$. For $m=1$, the above divisibility becomes

$$
n^{k}+n^{l}+1 \mid n^{l}+n^{l-k}+1 .
$$

Note that $n^{l}+n^{l-k}+1<n^{l}+n^{l}+1<2\left(n^{k}+n^{l}+1\right)$. Thus we must have $n^{l}+n^{l-k}+1=n^{k}+n^{l}+1$ so that $l=2 k$, which gives the first result.

\begin{itemize}
  \item Case 2. $l<k$.
\end{itemize}

This time (2) yields

$$
n^{k}+m n^{l}+1 \mid n^{k}+n^{k-l}+m .
$$

In particular, we get $n^{k}+m n^{l}+1 \leqslant n^{k}+n^{k-l}+m$, which implies


\begin{equation*}
m \leqslant \frac{n^{k-l}-1}{n^{l}-1} \tag{3}
\end{equation*}


On the other hand, from (1) we may let $n^{k+l}-1=\left(n^{k}+m n^{l}+1\right) t$ for some positive integer $t$. Obviously, $t$ is less than $n^{l}$, which means $t \leqslant n^{l}-1$ as it is an integer. Then we have $n^{k+l}-1 \leqslant\left(n^{k}+m n^{l}+1\right)\left(n^{l}-1\right)$, which is the same as


\begin{equation*}
m \geqslant \frac{n^{k-l}-1}{n^{l}-1} \tag{4}
\end{equation*}


Equations (3) and (4) combine to give $m=\frac{n^{k-l}-1}{n^{l}-1}$. As this is an integer, we have $l \mid k-l$. This means $l \mid k$ and it corresponds to the second result.

",226,2
2016n5,"Let $a$ be a positive integer which is not a square number. Denote by $A$ the set of all positive integers $k$ such that


\begin{equation*}
k=\frac{x^{2}-a}{x^{2}-y^{2}} \tag{1}
\end{equation*}


for some integers $x$ and $y$ with $x>\sqrt{a}$. Denote by $B$ the set of all positive integers $k$ such that (1) is satisfied for some integers $x$ and $y$ with $0 \leqslant x<\sqrt{a}$. Prove that $A=B$.","We first prove the following preliminary result.

\begin{itemize}
  \item Claim. For fixed $k$, let $x, y$ be integers satisfying (1). Then the numbers $x_{1}, y_{1}$ defined by
\end{itemize}

$$
x_{1}=\frac{1}{2}\left(x-y+\frac{(x-y)^{2}-4 a}{x+y}\right), \quad y_{1}=\frac{1}{2}\left(x-y-\frac{(x-y)^{2}-4 a}{x+y}\right)
$$

are integers and satisfy (1) (with $x, y$ replaced by $x_{1}, y_{1}$ respectively).\\
Proof. Since $x_{1}+y_{1}=x-y$ and

$$
x_{1}=\frac{x^{2}-x y-2 a}{x+y}=-x+\frac{2\left(x^{2}-a\right)}{x+y}=-x+2 k(x-y),
$$

both $x_{1}$ and $y_{1}$ are integers. Let $u=x+y$ and $v=x-y$. The relation (1) can be rewritten as

$$
u^{2}-(4 k-2) u v+\left(v^{2}-4 a\right)=0
$$

By Vieta's Theorem, the number $z=\frac{v^{2}-4 a}{u}$ satisfies

$$
v^{2}-(4 k-2) v z+\left(z^{2}-4 a\right)=0
$$

Since $x_{1}$ and $y_{1}$ are defined so that $v=x_{1}+y_{1}$ and $z=x_{1}-y_{1}$, we can reverse the process and verify (1) for $x_{1}, y_{1}$.

We first show that $B \subset A$. Take any $k \in B$ so that (1) is satisfied for some integers $x, y$ with $0 \leqslant x<\sqrt{a}$. Clearly, $y \neq 0$ and we may assume $y$ is positive. Since $a$ is not a square, we have $k>1$. Hence, we get $0 \leqslant x<y<\sqrt{a}$. Define

$$
x_{1}=\frac{1}{2}\left|x-y+\frac{(x-y)^{2}-4 a}{x+y}\right|, \quad y_{1}=\frac{1}{2}\left(x-y-\frac{(x-y)^{2}-4 a}{x+y}\right)
$$

By the Claim, $x_{1}, y_{1}$ are integers satisfying (1). Also, we have

$$
x_{1} \geqslant-\frac{1}{2}\left(x-y+\frac{(x-y)^{2}-4 a}{x+y}\right)=\frac{2 a+x(y-x)}{x+y} \geqslant \frac{2 a}{x+y}>\sqrt{a} .
$$

This implies $k \in A$ and hence $B \subset A$.

Next, we shall show that $A \subset B$. Take any $k \in A$ so that (1) is satisfied for some integers $x, y$ with $x>\sqrt{a}$. Again, we may assume $y$ is positive. Among all such representations of $k$, we choose the one with smallest $x+y$. Define

$$
x_{1}=\frac{1}{2}\left|x-y+\frac{(x-y)^{2}-4 a}{x+y}\right|, \quad y_{1}=\frac{1}{2}\left(x-y-\frac{(x-y)^{2}-4 a}{x+y}\right) .
$$

By the Claim, $x_{1}, y_{1}$ are integers satisfying (1). Since $k>1$, we get $x>y>\sqrt{a}$. Therefore, we have $y_{1}>\frac{4 a}{x+y}>0$ and $\frac{4 a}{x+y}<x+y$. It follows that

$$
x_{1}+y_{1} \leqslant \max \left\{x-y, \frac{4 a-(x-y)^{2}}{x+y}\right\}<x+y .
$$

If $x_{1}>\sqrt{a}$, we get a contradiction due to the minimality of $x+y$. Therefore, we must have $0 \leqslant x_{1}<\sqrt{a}$, which means $k \in B$ so that $A \subset B$.

The two subset relations combine to give $A=B$.\\
",336,3
2016n7,"Let $n$ be an odd positive integer. In the Cartesian plane, a cyclic polygon $P$ with area $S$ is chosen. All its vertices have integral coordinates, and the squares of its side lengths are all divisible by $n$. Prove that $2 S$ is an integer divisible by $n$.","Solution. Let $P=A_{1} A_{2} \ldots A_{k}$ and let $A_{k+i}=A_{i}$ for $i \geqslant 1$. By the Shoelace Formula, the area of any convex polygon with integral coordinates is half an integer. Therefore, $2 S$ is an integer. We shall prove by induction on $k \geqslant 3$ that $2 S$ is divisible by $n$. Clearly, it suffices to consider $n=p^{t}$ where $p$ is an odd prime and $t \geqslant 1$.

For the base case $k=3$, let the side lengths of $P$ be $\sqrt{n a}, \sqrt{n b}, \sqrt{n c}$ where $a, b, c$ are positive integers. By Heron's Formula,

$$
16 S^{2}=n^{2}\left(2 a b+2 b c+2 c a-a^{2}-b^{2}-c^{2}\right)
$$

This shows $16 S^{2}$ is divisible by $n^{2}$. Since $n$ is odd, $2 S$ is divisible by $n$.\\
Assume $k \geqslant 4$. If the square of length of one of the diagonals is divisible by $n$, then that diagonal divides $P$ into two smaller polygons, to which the induction hypothesis applies. Hence we may assume that none of the squares of diagonal lengths is divisible by $n$. As usual, we denote by $\nu_{p}(r)$ the exponent of $p$ in the prime decomposition of $r$. We claim the following.

\begin{itemize}
  \item Claim. $\nu_{p}\left(A_{1} A_{m}^{2}\right)>\nu_{p}\left(A_{1} A_{m+1}^{2}\right)$ for $2 \leqslant m \leqslant k-1$.
\end{itemize}

Proof. The case $m=2$ is obvious since $\nu_{p}\left(A_{1} A_{2}^{2}\right) \geqslant p^{t}>\nu_{p}\left(A_{1} A_{3}^{2}\right)$ by the condition and the above assumption.

Suppose $\nu_{p}\left(A_{1} A_{2}^{2}\right)>\nu_{p}\left(A_{1} A_{3}^{2}\right)>\cdots>\nu_{p}\left(A_{1} A_{m}^{2}\right)$ where $3 \leqslant m \leqslant k-1$. For the induction step, we apply Ptolemy's Theorem to the cyclic quadrilateral $A_{1} A_{m-1} A_{m} A_{m+1}$ to get

$$
A_{1} A_{m+1} \times A_{m-1} A_{m}+A_{1} A_{m-1} \times A_{m} A_{m+1}=A_{1} A_{m} \times A_{m-1} A_{m+1}
$$

which can be rewritten as


\begin{align*}
A_{1} A_{m+1}^{2} \times A_{m-1} A_{m}^{2}= & A_{1} A_{m-1}^{2} \times A_{m} A_{m+1}^{2}+A_{1} A_{m}^{2} \times A_{m-1} A_{m+1}^{2} \\
& -2 A_{1} A_{m-1} \times A_{m} A_{m+1} \times A_{1} A_{m} \times A_{m-1} A_{m+1} \tag{1}
\end{align*}


From this, $2 A_{1} A_{m-1} \times A_{m} A_{m+1} \times A_{1} A_{m} \times A_{m-1} A_{m+1}$ is an integer. We consider the component of $p$ of each term in (1). By the inductive hypothesis, we have $\nu_{p}\left(A_{1} A_{m-1}^{2}\right)>\nu_{p}\left(A_{1} A_{m}^{2}\right)$. Also, we have $\nu_{p}\left(A_{m} A_{m+1}^{2}\right) \geqslant p^{t}>\nu_{p}\left(A_{m-1} A_{m+1}^{2}\right)$. These give


\begin{equation*}
\nu_{p}\left(A_{1} A_{m-1}^{2} \times A_{m} A_{m+1}^{2}\right)>\nu_{p}\left(A_{1} A_{m}^{2} \times A_{m-1} A_{m+1}^{2}\right) \tag{2}
\end{equation*}


Next, we have $\nu_{p}\left(4 A_{1} A_{m-1}^{2} \times A_{m} A_{m+1}^{2} \times A_{1} A_{m}^{2} \times A_{m-1} A_{m+1}^{2}\right)=\nu_{p}\left(A_{1} A_{m-1}^{2} \times A_{m} A_{m+1}^{2}\right)+$ $\nu_{p}\left(A_{1} A_{m}^{2} \times A_{m-1} A_{m+1}^{2}\right)>2 \nu_{p}\left(A_{1} A_{m}^{2} \times A_{m-1} A_{m+1}^{2}\right)$ from (2). This implies


\begin{equation*}
\nu_{p}\left(2 A_{1} A_{m-1} \times A_{m} A_{m+1} \times A_{1} A_{m} \times A_{m-1} A_{m+1}\right)>\nu_{p}\left(A_{1} A_{m}^{2} \times A_{m-1} A_{m+1}^{2}\right) \tag{3}
\end{equation*}


Combining (1), (2) and (3), we conclude that

$$
\nu_{p}\left(A_{1} A_{m+1}^{2} \times A_{m-1} A_{m}^{2}\right)=\nu_{p}\left(A_{1} A_{m}^{2} \times A_{m-1} A_{m+1}^{2}\right)
$$

By $\nu_{p}\left(A_{m-1} A_{m}^{2}\right) \geqslant p^{t}>\nu_{p}\left(A_{m-1} A_{m+1}^{2}\right)$, we get $\nu_{p}\left(A_{1} A_{m+1}^{2}\right)<\nu_{p}\left(A_{1} A_{m}^{2}\right)$. The Claim follows by induction.

From the Claim, we get a chain of inequalities

$$
p^{t}>\nu_{p}\left(A_{1} A_{3}^{2}\right)>\nu_{p}\left(A_{1} A_{4}^{2}\right)>\cdots>\nu_{p}\left(A_{1} A_{k}^{2}\right) \geqslant p^{t},
$$

which yields a contradiction. Therefore, we can show by induction that $2 S$ is divisible by $n$.\\
Comment. The condition that $P$ is cyclic is crucial. As a counterexample, consider the rhombus with vertices $(0,3),(4,0),(0,-3),(-4,0)$. Each of its squares of side lengths is divisible by 5 , while $2 S=48$ is not.

The proposer also gives a proof for the case $n$ is even. One just needs an extra technical step for the case $p=2$.",544,4
2015a1,"Suppose that a sequence $a_{1}, a_{2}, \ldots$ of positive real numbers satisfies


\begin{equation*}
a_{k+1} \geqslant \frac{k a_{k}}{a_{k}^{2}+(k-1)} \tag{1}
\end{equation*}


for every positive integer $k$. Prove that $a_{1}+a_{2}+\cdots+a_{n} \geqslant n$ for every $n \geqslant 2$.","Solution. From the constraint (1), it can be seen that

$$
\frac{k}{a_{k+1}} \leqslant \frac{a_{k}^{2}+(k-1)}{a_{k}}=a_{k}+\frac{k-1}{a_{k}},
$$

and so

$$
a_{k} \geqslant \frac{k}{a_{k+1}}-\frac{k-1}{a_{k}} .
$$

Summing up the above inequality for $k=1, \ldots, m$, we obtain


\begin{equation*}
a_{1}+a_{2}+\cdots+a_{m} \geqslant\left(\frac{1}{a_{2}}-\frac{0}{a_{1}}\right)+\left(\frac{2}{a_{3}}-\frac{1}{a_{2}}\right)+\cdots+\left(\frac{m}{a_{m+1}}-\frac{m-1}{a_{m}}\right)=\frac{m}{a_{m+1}} . \tag{2}
\end{equation*}


Now we prove the problem statement by induction on $n$. The case $n=2$ can be done by applying (1) to $k=1$ :

$$
a_{1}+a_{2} \geqslant a_{1}+\frac{1}{a_{1}} \geqslant 2 .
$$

For the induction step, assume that the statement is true for some $n \geqslant 2$. If $a_{n+1} \geqslant 1$, then the induction hypothesis yields


\begin{equation*}
\left(a_{1}+\cdots+a_{n}\right)+a_{n+1} \geqslant n+1 . \tag{3}
\end{equation*}


Otherwise, if $a_{n+1}<1$ then apply (2) as

$$
\left(a_{1}+\cdots+a_{n}\right)+a_{n+1} \geqslant \frac{n}{a_{n+1}}+a_{n+1}=\frac{n-1}{a_{n+1}}+\left(\frac{1}{a_{n+1}}+a_{n+1}\right)>(n-1)+2 .
$$

That completes the solution.\\
Comment 1. It can be seen easily that having equality in the statement requires $a_{1}=a_{2}=1$ in the base case $n=2$, and $a_{n+1}=1$ in (3). So the equality $a_{1}+\cdots+a_{n}=n$ is possible only in the trivial case $a_{1}=\cdots=a_{n}=1$.

Comment 2. After obtaining (2), there are many ways to complete the solution. We outline three such possibilities.

\begin{itemize}
  \item With defining $s_{n}=a_{1}+\cdots+a_{n}$, the induction step can be replaced by
\end{itemize}

$$
s_{n+1}=s_{n}+a_{n+1} \geqslant s_{n}+\frac{n}{s_{n}} \geqslant n+1,
$$

because the function $x \mapsto x+\frac{n}{x}$ increases on $[n, \infty)$.

\begin{itemize}
  \item By applying the AM-GM inequality to the numbers $a_{1}+\cdots+a_{k}$ and $k a_{k+1}$, we can conclude
\end{itemize}

$$
a_{1}+\cdots+a_{k}+k a_{k+1} \geqslant 2 k
$$

and sum it up for $k=1, \ldots, n-1$.

\begin{itemize}
  \item We can derive the symmetric estimate
\end{itemize}

$$
\sum_{1 \leqslant i<j \leqslant n} a_{i} a_{j}=\sum_{j=2}^{n}\left(a_{1}+\cdots+a_{j-1}\right) a_{j} \geqslant \sum_{j=2}^{n}(j-1)=\frac{n(n-1)}{2}
$$

and combine it with the AM-QM inequality.",263,3
2015a6,"Let $n$ be a fixed integer with $n \geqslant 2$. We say that two polynomials $P$ and $Q$ with real coefficients are block-similar if for each $i \in\{1,2, \ldots, n\}$ the sequences

$$
\begin{aligned}
& P(2015 i), P(2015 i-1), \ldots, P(2015 i-2014) \quad \text { and } \\
& Q(2015 i), Q(2015 i-1), \ldots, Q(2015 i-2014)
\end{aligned}
$$

are permutations of each other.\\
(a) Prove that there exist distinct block-similar polynomials of degree $n+1$.\\
(b) Prove that there do not exist distinct block-similar polynomials of degree $n$.","For convenience, we set $k=2015=2 \ell+1$.

Part (a). Consider the following polynomials of degree $n+1$ :

$$
P(x)=\prod_{i=0}^{n}(x-i k) \quad \text { and } \quad Q(x)=\prod_{i=0}^{n}(x-i k-1)
$$

Since $Q(x)=P(x-1)$ and $P(0)=P(k)=P(2 k)=\cdots=P(n k)$, these polynomials are block-similar (and distinct).

Part (b). For every polynomial $F(x)$ and every nonnegative integer $m$, define $\Sigma_{F}(m)=$ $\sum_{i=1}^{m} F(i)$; in particular, $\Sigma_{F}(0)=0$. It is well-known that for every nonnegative integer $d$ the sum $\sum_{i=1}^{m} i^{d}$ is a polynomial in $m$ of degree $d+1$. Thus $\Sigma_{F}$ may also be regarded as a real polynomial of degree $\operatorname{deg} F+1$ (with the exception that if $F=0$, then $\Sigma_{F}=0$ as well). This allows us to consider the values of $\Sigma_{F}$ at all real points (where the initial definition does not apply).

Assume for the sake of contradiction that there exist two distinct block-similar polynomials $P(x)$ and $Q(x)$ of degree $n$. Then both polynomials $\Sigma_{P-Q}(x)$ and $\Sigma_{P^{2}-Q^{2}}(x)$ have roots at the points $0, k, 2 k, \ldots, n k$. This motivates the following lemma, where we use the special polynomial

$$
T(x)=\prod_{i=0}^{n}(x-i k)
$$

Lemma. Assume that $F(x)$ is a nonzero polynomial such that $0, k, 2 k, \ldots, n k$ are among the roots of the polynomial $\Sigma_{F}(x)$. Then $\operatorname{deg} F \geqslant n$, and there exists a polynomial $G(x)$ such that $\operatorname{deg} G=\operatorname{deg} F-n$ and $F(x)=T(x) G(x)-T(x-1) G(x-1)$.\\
Proof. If $\operatorname{deg} F<n$, then $\Sigma_{F}(x)$ has at least $n+1$ roots, while its degree is less than $n+1$. Therefore, $\Sigma_{F}(x)=0$ and hence $F(x)=0$, which is impossible. Thus $\operatorname{deg} F \geqslant n$.

The lemma condition yields that $\Sigma_{F}(x)=T(x) G(x)$ for some polynomial $G(x)$ such that $\operatorname{deg} G=\operatorname{deg} \Sigma_{F}-(n+1)=\operatorname{deg} F-n$.

Now, let us define $F_{1}(x)=T(x) G(x)-T(x-1) G(x-1)$. Then for every positive integer $n$ we have

$$
\Sigma_{F_{1}}(n)=\sum_{i=1}^{n}(T(x) G(x)-T(x-1) G(x-1))=T(n) G(n)-T(0) G(0)=T(n) G(n)=\Sigma_{F}(n)
$$

so the polynomial $\Sigma_{F-F_{1}}(x)=\Sigma_{F}(x)-\Sigma_{F_{1}}(x)$ has infinitely many roots. This means that this polynomial is zero, which in turn yields $F(x)=F_{1}(x)$, as required.

First, we apply the lemma to the nonzero polynomial $R_{1}(x)=P(x)-Q(x)$. Since the degree of $R_{1}(x)$ is at most $n$, we conclude that it is exactly $n$. Moreover, $R_{1}(x)=\alpha \cdot(T(x)-T(x-1))$ for some nonzero constant $\alpha$.

Our next aim is to prove that the polynomial $S(x)=P(x)+Q(x)$ is constant. Assume the contrary. Then, notice that the polynomial $R_{2}(x)=P(x)^{2}-Q(x)^{2}=R_{1}(x) S(x)$ is also nonzero and satisfies the lemma condition. Since $n<\operatorname{deg} R_{1}+\operatorname{deg} S=\operatorname{deg} R_{2} \leqslant 2 n$, the lemma yields

$$
R_{2}(x)=T(x) G(x)-T(x-1) G(x-1)
$$

with some polynomial $G(x)$ with $0<\operatorname{deg} G \leqslant n$.\\
Since the polynomial $R_{1}(x)=\alpha(T(x)-T(x-1))$ divides the polynomial

$$
R_{2}(x)=T(x)(G(x)-G(x-1))+G(x-1)(T(x)-T(x-1)),
$$

we get $R_{1}(x) \mid T(x)(G(x)-G(x-1))$. On the other hand,

$$
\operatorname{gcd}\left(T(x), R_{1}(x)\right)=\operatorname{gcd}(T(x), T(x)-T(x-1))=\operatorname{gcd}(T(x), T(x-1))=1
$$

since both $T(x)$ and $T(x-1)$ are the products of linear polynomials, and their roots are distinct. Thus $R_{1}(x) \mid G(x)-G(x-1)$. However, this is impossible since $G(x)-G(x-1)$ is a nonzero polynomial of degree less than $n=\operatorname{deg} R_{1}$.

Thus, our assumption is wrong, and $S(x)$ is a constant polynomial, say $S(x)=\beta$. Notice that the polynomials $(2 P(x)-\beta) / \alpha$ and $(2 Q(x)-\beta) / \alpha$ are also block-similar and distinct. So we may replace the initial polynomials by these ones, thus obtaining two block-similar polynomials $P(x)$ and $Q(x)$ with $P(x)=-Q(x)=T(x)-T(x-1)$. It remains to show that this is impossible.

For every $i=1,2 \ldots, n$, the values $T(i k-k+1)$ and $T(i k-1)$ have the same sign. This means that the values $P(i k-k+1)=T(i k-k+1)$ and $P(i k)=-T(i k-1)$ have opposite signs, so $P(x)$ has a root in each of the $n$ segments $[i k-k+1, i k]$. Since $\operatorname{deg} P=n$, it must have exactly one root in each of them.

Thus, the sequence $P(1), P(2), \ldots, P(k)$ should change sign exactly once. On the other hand, since $P(x)$ and $-P(x)$ are block-similar, this sequence must have as many positive terms as negative ones. Since $k=2 \ell+1$ is odd, this shows that the middle term of the sequence above must be zero, so $P(\ell+1)=0$, or $T(\ell+1)=T(\ell)$. However, this is not true since

$$
|T(\ell+1)|=|\ell+1| \cdot|\ell| \cdot \prod_{i=2}^{n}|\ell+1-i k|<|\ell| \cdot|\ell+1| \cdot \prod_{i=2}^{n}|\ell-i k|=|T(\ell)|,
$$

where the strict inequality holds because $n \geqslant 2$. We come to the final contradiction.\\
Comment 1. In the solution above, we used the fact that $k>1$ is odd. One can modify the arguments of the last part in order to work for every (not necessarily odd) sufficiently large value of $k$; namely, when $k$ is even, one may show that the sequence $P(1), P(2), \ldots, P(k)$ has different numbers of positive and negative terms.

On the other hand, the problem statement with $k$ replaced by 2 is false, since the polynomials $P(x)=T(x)-T(x-1)$ and $Q(x)=T(x-1)-T(x)$ are block-similar in this case, due to the fact that $P(2 i-1)=-P(2 i)=Q(2 i)=-Q(2 i-1)=T(2 i-1)$ for all $i=1,2, \ldots, n$. Thus, every complete solution should use the relation $k>2$.

One may easily see that the condition $n \geqslant 2$ is also substantial, since the polynomials $x$ and $k+1-x$ become block-similar if we set $n=1$.

It is easily seen from the solution that the result still holds if we assume that the polynomials have degree at most $n$.
",826,4
2015c1,"In Lineland there are $n \geqslant 1$ towns, arranged along a road running from left to right. Each town has a left bulldozer (put to the left of the town and facing left) and a right bulldozer (put to the right of the town and facing right). The sizes of the $2 n$ bulldozers are distinct. Every time when a right and a left bulldozer confront each other, the larger bulldozer pushes the smaller one off the road. On the other hand, the bulldozers are quite unprotected at their rears; so, if a bulldozer reaches the rear-end of another one, the first one pushes the second one off the road, regardless of their sizes.

Let $A$ and $B$ be two towns, with $B$ being to the right of $A$. We say that town $A$ can sweep town $B$ away if the right bulldozer of $A$ can move over to $B$ pushing off all bulldozers it meets. Similarly, $B$ can sweep $A$ away if the left bulldozer of $B$ can move to $A$ pushing off all bulldozers of all towns on its way.

Prove that there is exactly one town which cannot be swept away by any other one.","Let $T_{1}, T_{2}, \ldots, T_{n}$ be the towns enumerated from left to right. Observe first that, if town $T_{i}$ can sweep away town $T_{j}$, then $T_{i}$ also can sweep away every town located between $T_{i}$ and $T_{j}$.

We prove the problem statement by strong induction on $n$. The base case $n=1$ is trivial.\\
For the induction step, we first observe that the left bulldozer in $T_{1}$ and the right bulldozer in $T_{n}$ are completely useless, so we may forget them forever. Among the other $2 n-2$ bulldozers, we choose the largest one. Without loss of generality, it is the right bulldozer of some town $T_{k}$ with $k<n$.

Surely, with this large bulldozer $T_{k}$ can sweep away all the towns to the right of it. Moreover, none of these towns can sweep $T_{k}$ away; so they also cannot sweep away any town to the left of $T_{k}$. Thus, if we remove the towns $T_{k+1}, T_{k+2}, \ldots, T_{n}$, none of the remaining towns would change its status of being (un)sweepable away by the others.

Applying the induction hypothesis to the remaining towns, we find a unique town among $T_{1}, T_{2}, \ldots, T_{k}$ which cannot be swept away. By the above reasons, it is also the unique such town in the initial situation. Thus the induction step is established.

",216,2
2015c5,"Consider an infinite sequence $a_{1}, a_{2}, \ldots$ of positive integers with $a_{i} \leqslant 2015$ for all $i \geqslant 1$. Suppose that for any two distinct indices $i$ and $j$ we have $i+a_{i} \neq j+a_{j}$.

Prove that there exist two positive integers $b$ and $N$ such that

$$
\left|\sum_{i=m+1}^{n}\left(a_{i}-b\right)\right| \leqslant 1007^{2}
$$

whenever $n>m \geqslant N$.","We visualize the set of positive integers as a sequence of points. For each $n$ we draw an arrow emerging from $n$ that points to $n+a_{n}$; so the length of this arrow is $a_{n}$. Due to the condition that $m+a_{m} \neq n+a_{n}$ for $m \neq n$, each positive integer receives at most one arrow. There are some positive integers, such as 1 , that receive no arrows; these will be referred to as starting points in the sequel. When one starts at any of the starting points and keeps following the arrows, one is led to an infinite path, called its ray, that visits a strictly increasing sequence of positive integers. Since the length of any arrow is at most 2015, such a ray, say with starting point $s$, meets every interval of the form $[n, n+2014]$ with $n \geqslant s$ at least once.

Suppose for the sake of contradiction that there would be at least 2016 starting points. Then we could take an integer $n$ that is larger than the first 2016 starting points. But now the interval $[n, n+2014]$ must be met by at least 2016 rays in distinct points, which is absurd. We have thereby shown that the number $b$ of starting points satisfies $1 \leqslant b \leqslant 2015$. Let $N$ denote any integer that is larger than all starting points. We contend that $b$ and $N$ are as required.

To see this, let any two integers $m$ and $n$ with $n>m \geqslant N$ be given. The sum $\sum_{i=m+1}^{n} a_{i}$ gives the total length of the arrows emerging from $m+1, \ldots, n$. Taken together, these arrows form $b$ subpaths of our rays, some of which may be empty. Now on each ray we look at the first number that is larger than $m$; let $x_{1}, \ldots, x_{b}$ denote these numbers, and let $y_{1}, \ldots, y_{b}$ enumerate in corresponding order the numbers defined similarly with respect to $n$. Then the list of differences $y_{1}-x_{1}, \ldots, y_{b}-x_{b}$ consists of the lengths of these paths and possibly some zeros corresponding to empty paths. Consequently, we obtain

$$
\sum_{i=m+1}^{n} a_{i}=\sum_{j=1}^{b}\left(y_{j}-x_{j}\right),
$$

whence

$$
\sum_{i=m+1}^{n}\left(a_{i}-b\right)=\sum_{j=1}^{b}\left(y_{j}-n\right)-\sum_{j=1}^{b}\left(x_{j}-m\right) .
$$

Now each of the $b$ rays meets the interval $[m+1, m+2015]$ at some point and thus $x_{1}-$ $m, \ldots, x_{b}-m$ are $b$ distinct members of the set $\{1,2, \ldots, 2015\}$. Moreover, since $m+1$ is not a starting point, it must belong to some ray; so 1 has to appear among these numbers, wherefore

$$
1+\sum_{j=1}^{b-1}(j+1) \leqslant \sum_{j=1}^{b}\left(x_{j}-m\right) \leqslant 1+\sum_{j=1}^{b-1}(2016-b+j) .
$$

The same argument applied to $n$ and $y_{1}, \ldots, y_{b}$ yields

$$
1+\sum_{j=1}^{b-1}(j+1) \leqslant \sum_{j=1}^{b}\left(y_{j}-n\right) \leqslant 1+\sum_{j=1}^{b-1}(2016-b+j) .
$$

So altogether we get

$$
\begin{aligned}
\left|\sum_{i=m+1}^{n}\left(a_{i}-b\right)\right| & \leqslant \sum_{j=1}^{b-1}((2016-b+j)-(j+1))=(b-1)(2015-b) \\
& \leqslant\left(\frac{(b-1)+(2015-b)}{2}\right)^{2}=1007^{2},
\end{aligned}
$$

as desired.\\",452,3
2015c6,Let $S$ be a nonempty set of positive integers. We say that a positive integer $n$ is clean if it has a unique representation as a sum of an odd number of distinct elements from $S$. Prove that there exist infinitely many positive integers that are not clean.,"Define an odd (respectively, even) representation of $n$ to be a representation of $n$ as a sum of an odd (respectively, even) number of distinct elements of $S$. Let $\mathbb{Z}_{>0}$ denote the set of all positive integers.

Suppose, to the contrary, that there exist only finitely many positive integers that are not clean. Therefore, there exists a positive integer $N$ such that every integer $n>N$ has exactly one odd representation.

Clearly, $S$ is infinite. We now claim the following properties of odd and even representations.\\
Property 1. Any positive integer $n$ has at most one odd and at most one even representation. Proof. We first show that every integer $n$ has at most one even representation. Since $S$ is infinite, there exists $x \in S$ such that $x>\max \{n, N\}$. Then, the number $n+x$ must be clean, and $x$ does not appear in any even representation of $n$. If $n$ has more than one even representation, then we obtain two distinct odd representations of $n+x$ by adding $x$ to the even representations of $n$, which is impossible. Therefore, $n$ can have at most one even representation.

Similarly, there exist two distinct elements $y, z \in S$ such that $y, z>\max \{n, N\}$. If $n$ has more than one odd representation, then we obtain two distinct odd representations of $n+y+z$ by adding $y$ and $z$ to the odd representations of $n$. This is again a contradiction.

Property 2. Fix $s \in S$. Suppose that a number $n>N$ has no even representation. Then $n+2$ as has an even representation containing $s$ for all integers $a \geqslant 1$.\\
Proof. It is sufficient to prove the following statement: If $n$ has no even representation without $s$, then $n+2 s$ has an even representation containing $s$ (and hence no even representation without $s$ by Property 1).

Notice that the odd representation of $n+s$ does not contain $s$; otherwise, we have an even representation of $n$ without $s$. Then, adding $s$ to this odd representation of $n+s$, we get that $n+2 s$ has an even representation containing $s$, as desired.

Property 3. Every sufficiently large integer has an even representation.\\
Proof. Fix any $s \in S$, and let $r$ be an arbitrary element in $\{1,2, \ldots, 2 s\}$. Then, Property 2 implies that the set $Z_{r}=\{r+2 a s: a \geqslant 0\}$ contains at most one number exceeding $N$ with no even representation. Therefore, $Z_{r}$ contains finitely many positive integers with no even representation, and so does $\mathbb{Z}_{>0}=\bigcup_{r=1}^{2 s} Z_{r}$.

In view of Properties 1 and 3, we may assume that $N$ is chosen such that every $n>N$ has exactly one odd and exactly one even representation. In particular, each element $s>N$ of $S$ has an even representation.

Property 4. For any $s, t \in S$ with $N<s<t$, the even representation of $t$ contains $s$.\\
Proof. Suppose the contrary. Then, $s+t$ has at least two odd representations: one obtained by adding $s$ to the even representation of $t$ and one obtained by adding $t$ to the even representation of $s$. Since the latter does not contain $s$, these two odd representations of $s+t$ are distinct, a contradiction.

Let $s_{1}<s_{2}<\cdots$ be all the elements of $S$, and set $\sigma_{n}=\sum_{i=1}^{n} s_{i}$ for each nonnegative integer $n$. Fix an integer $k$ such that $s_{k}>N$. Then, Property 4 implies that for every $i>k$ the even representation of $s_{i}$ contains all the numbers $s_{k}, s_{k+1}, \ldots, s_{i-1}$. Therefore,


\begin{equation*}
s_{i}=s_{k}+s_{k+1}+\cdots+s_{i-1}+R_{i}=\sigma_{i-1}-\sigma_{k-1}+R_{i}, \tag{1}
\end{equation*}


where $R_{i}$ is a sum of some of $s_{1}, \ldots, s_{k-1}$. In particular, $0 \leqslant R_{i} \leqslant s_{1}+\cdots+s_{k-1}=\sigma_{k-1}$.

Let $j_{0}$ be an integer satisfying $j_{0}>k$ and $\sigma_{j_{0}}>2 \sigma_{k-1}$. Then (1) shows that, for every $j>j_{0}$,


\begin{equation*}
s_{j+1} \geqslant \sigma_{j}-\sigma_{k-1}>\sigma_{j} / 2 . \tag{2}
\end{equation*}


Next, let $p>j_{0}$ be an index such that $R_{p}=\min _{i>j_{0}} R_{i}$. Then,

$$
s_{p+1}=s_{k}+s_{k+1}+\cdots+s_{p}+R_{p+1}=\left(s_{p}-R_{p}\right)+s_{p}+R_{p+1} \geqslant 2 s_{p} .
$$

Therefore, there is no element of $S$ larger than $s_{p}$ but smaller than $2 s_{p}$. It follows that the even representation $\tau$ of $2 s_{p}$ does not contain any element larger than $s_{p}$. On the other hand, inequality (2) yields $2 s_{p}>s_{1}+\cdots+s_{p-1}$, so $\tau$ must contain a term larger than $s_{p-1}$. Thus, it must contain $s_{p}$. After removing $s_{p}$ from $\tau$, we have that $s_{p}$ has an odd representation not containing $s_{p}$, which contradicts Property 1 since $s_{p}$ itself also forms an odd representation of $s_{p}$.
",719,4
2015c7,"In a company of people some pairs are enemies. A group of people is called unsociable if the number of members in the group is odd and at least 3, and it is possible to arrange all its members around a round table so that every two neighbors are enemies. Given that there are at most 2015 unsociable groups, prove that it is possible to partition the company into 11 parts so that no two enemies are in the same part.","Let $G=(V, E)$ be a graph where $V$ is the set of people in the company and $E$ is the set of the enemy pairs - the edges of the graph. In this language, partitioning into 11 disjoint enemy-free subsets means properly coloring the vertices of this graph with 11 colors.

We will prove the following more general statement.\\
Claim. Let $G$ be a graph with chromatic number $k \geqslant 3$. Then $G$ contains at least $2^{k-1}-k$ unsociable groups.

Recall that the chromatic number of $G$ is the least $k$ such that a proper coloring


\begin{equation*}
V=V_{1} \sqcup \cdots \sqcup V_{k} \tag{1}
\end{equation*}


exists. In view of $2^{11}-12>2015$, the claim implies the problem statement.\\
Let $G$ be a graph with chromatic number $k$. We say that a proper coloring (1) of $G$ is leximinimal, if the $k$-tuple $\left(\left|V_{1}\right|,\left|V_{2}\right|, \ldots,\left|V_{k}\right|\right)$ is lexicographically minimal; in other words, the following conditions are satisfied: the number $n_{1}=\left|V_{1}\right|$ is minimal; the number $n_{2}=\left|V_{2}\right|$ is minimal, subject to the previously chosen value of $n_{1} ; \ldots$; the number $n_{k-1}=\left|V_{k-1}\right|$ is minimal, subject to the previously chosen values of $n_{1}, \ldots, n_{k-2}$.

The following lemma is the core of the proof.\\
Lemma 1. Suppose that $G=(V, E)$ is a graph with odd chromatic number $k \geqslant 3$, and let (1) be one of its leximinimal colorings. Then $G$ contains an odd cycle which visits all color classes $V_{1}, V_{2}, \ldots, V_{k}$.\\
Proof of Lemma 1. Let us call a cycle colorful if it visits all color classes.\\
Due to the definition of the chromatic number, $V_{1}$ is nonempty. Choose an arbitrary vertex $v \in V_{1}$. We construct a colorful odd cycle that has only one vertex in $V_{1}$, and this vertex is $v$.

We draw a subgraph of $G$ as follows. Place $v$ in the center, and arrange the sets $V_{2}, V_{3}, \ldots, V_{k}$ in counterclockwise circular order around it. For convenience, let $V_{k+1}=V_{2}$. We will draw arrows to add direction to some edges of $G$, and mark the vertices these arrows point to. First we draw arrows from $v$ to all its neighbors in $V_{2}$, and mark all those neighbors. If some vertex $u \in V_{i}$ with $i \in\{2,3, \ldots, k\}$ is already marked, we draw arrows from $u$ to all its neighbors in $V_{i+1}$ which are not marked yet, and we mark all of them. We proceed doing this as long as it is possible. The process of marking is exemplified in Figure 1.

Notice that by the rules of our process, in the final state, marked vertices in $V_{i}$ cannot have unmarked neighbors in $V_{i+1}$. Moreover, $v$ is connected to all marked vertices by directed paths.

Now move each marked vertex to the next color class in circular order (see an example in Figure 3). In view of the arguments above, the obtained coloring $V_{1} \sqcup W_{2} \sqcup \cdots \sqcup W_{k}$ is proper. Notice that $v$ has a neighbor $w \in W_{2}$, because otherwise

$$
\left(V_{1} \backslash\{v\}\right) \sqcup\left(W_{2} \cup\{v\}\right) \sqcup W_{3} \sqcup \cdots \sqcup W_{k}
$$

would be a proper coloring lexicographically smaller than (1). If $w$ was unmarked, i.e., $w$ was an element of $V_{2}$, then it would be marked at the beginning of the process and thus moved to $V_{3}$, which did not happen. Therefore, $w$ is marked and $w \in V_{k}$.\\


Since $w$ is marked, there exists a directed path from $v$ to $w$. This path moves through the sets $V_{2}, \ldots, V_{k}$ in circular order, so the number of edges in it is divisible by $k-1$ and thus even. Closing this path by the edge $w \rightarrow v$, we get a colorful odd cycle, as required.

Proof of the claim. Let us choose a leximinimal coloring (1) of $G$. For every set $C \subseteq\{1,2, \ldots, k\}$ such that $|C|$ is odd and greater than 1 , we will provide an odd cycle visiting exactly those color classes whose indices are listed in the set $C$. This property ensures that we have different cycles for different choices of $C$, and it proves the claim because there are $2^{k-1}-k$ choices for the set $C$.

Let $V_{C}=\bigcup_{c \in C} V_{c}$, and let $G_{C}$ be the induced subgraph of $G$ on the vertex set $V_{C}$. We also have the induced coloring of $V_{C}$ with $|C|$ colors; this coloring is of course proper. Notice further that the induced coloring is leximinimal: if we had a lexicographically smaller coloring $\left(W_{c}\right)_{c \in C}$ of $G_{C}$, then these classes, together the original color classes $V_{i}$ for $i \notin C$, would provide a proper coloring which is lexicographically smaller than (1). Hence Lemma 1, applied to the subgraph $G_{C}$ and its leximinimal coloring $\left(V_{c}\right)_{c \in C}$, provides an odd cycle that visits exactly those color classes that are listed in the set $C$.

",794,4
2015g1,Let $A B C$ be an acute triangle with orthocenter $H$. Let $G$ be the point such that the quadrilateral $A B G H$ is a parallelogram. Let $I$ be the point on the line $G H$ such that $A C$ bisects $H I$. Suppose that the line $A C$ intersects the circumcircle of the triangle $G C I$ at $C$ and $J$. Prove that $I J=A H$.,"Since $H G \| A B$ and $B G \| A H$, we have $B G \perp B C$ and $C H \perp G H$. Therefore, the quadrilateral $B G C H$ is cyclic. Since $H$ is the orthocenter of the triangle $A B C$, we have $\angle H A C=90^{\circ}-\angle A C B=\angle C B H$. Using that $B G C H$ and $C G J I$ are cyclic quadrilaterals, we get

$$
\angle C J I=\angle C G H=\angle C B H=\angle H A C .
$$

Let $M$ be the intersection of $A C$ and $G H$, and let $D \neq A$ be the point on the line $A C$ such that $A H=H D$. Then $\angle M J I=\angle H A C=\angle M D H$.

Since $\angle M J I=\angle M D H, \angle I M J=\angle H M D$, and $I M=M H$, the triangles $I M J$ and $H M D$ are congruent, and thus $I J=H D=A H$.\\
\includegraphics[max width=\textwidth, center]{2025_04_30_c8781145b2af5b76793eg-44}

Comment. Instead of introducing the point $D$, one can complete the solution by using the law of sines in the triangles $I J M$ and $A M H$, yielding

$$
\frac{I J}{I M}=\frac{\sin \angle I M J}{\sin \angle M J I}=\frac{\sin \angle A M H}{\sin \angle H A M}=\frac{A H}{M H}=\frac{A H}{I M} .
$$

",223,2
2015g2,"Let $A B C$ be a triangle inscribed into a circle $\Omega$ with center $O$. A circle $\Gamma$ with center $A$ meets the side $B C$ at points $D$ and $E$ such that $D$ lies between $B$ and $E$. Moreover, let $F$ and $G$ be the common points of $\Gamma$ and $\Omega$. We assume that $F$ lies on the arc $A B$ of $\Omega$ not containing $C$, and $G$ lies on the arc $A C$ of $\Omega$ not containing $B$. The circumcircles of the triangles $B D F$ and $C E G$ meet the sides $A B$ and $A C$ again at $K$ and $L$, respectively. Suppose that the lines $F K$ and $G L$ are distinct and intersect at $X$. Prove that the points $A, X$, and $O$ are collinear.","It suffices to prove that the lines $F K$ and $G L$ are symmetric about $A O$. Now the segments $A F$ and $A G$, being chords of $\Omega$ with the same length, are clearly symmetric with respect to $A O$. Hence it is enough to show


\begin{equation*}
\angle K F A=\angle A G L . \tag{1}
\end{equation*}


Let us denote the circumcircles of $B D F$ and $C E G$ by $\omega_{B}$ and $\omega_{C}$, respectively. To prove (1), we start from

$$
\angle K F A=\angle D F G+\angle G F A-\angle D F K .
$$

In view of the circles $\omega_{B}, \Gamma$, and $\Omega$, this may be rewritten as

$$
\angle K F A=\angle C E G+\angle G B A-\angle D B K=\angle C E G-\angle C B G .
$$

Due to the circles $\omega_{C}$ and $\Omega$, we obtain $\angle K F A=\angle C L G-\angle C A G=\angle A G L$. Thereby the problem is solved.\\
",161,2
2015g3,"Let $A B C$ be a triangle with $\angle C=90^{\circ}$, and let $H$ be the foot of the altitude from $C$. A point $D$ is chosen inside the triangle $C B H$ so that $C H$ bisects $A D$. Let $P$ be the intersection point of the lines $B D$ and $C H$. Let $\omega$ be the semicircle with diameter $B D$ that meets the segment $C B$ at an interior point. A line through $P$ is tangent to $\omega$ at $Q$. Prove that the lines $C Q$ and $A D$ meet on $\omega$.","Let $K$ be the projection of $D$ onto $A B$; then $A H=H K$ (see Figure 1). Since $P H \| D K$, we have


\begin{equation*}
\frac{P D}{P B}=\frac{H K}{H B}=\frac{A H}{H B} . \tag{1}
\end{equation*}


Let $L$ be the projection of $Q$ onto $D B$. Since $P Q$ is tangent to $\omega$ and $\angle D Q B=\angle B L Q=$ $90^{\circ}$, we have $\angle P Q D=\angle Q B P=\angle D Q L$. Therefore, $Q D$ and $Q B$ are respectively the internal and the external bisectors of $\angle P Q L$. By the angle bisector theorem, we obtain


\begin{equation*}
\frac{P D}{D L}=\frac{P Q}{Q L}=\frac{P B}{B L} . \tag{2}
\end{equation*}


The relations (1) and (2) yield $\frac{A H}{H B}=\frac{P D}{P B}=\frac{D L}{L B}$. So, the spiral similarity $\tau$ centered at $B$ and sending $A$ to $D$ maps $H$ to $L$. Moreover, $\tau$ sends the semicircle with diameter $A B$ passing through $C$ to $\omega$. Due to $C H \perp A B$ and $Q L \perp D B$, it follows that $\tau(C)=Q$.

Hence, the triangles $A B D$ and $C B Q$ are similar, so $\angle A D B=\angle C Q B$. This means that the lines $A D$ and $C Q$ meet at some point $T$, and this point satisfies $\angle B D T=\angle B Q T$. Therefore, $T$ lies on $\omega$, as needed.\\
",225,2
2015g5," Let $A B C$ be a triangle with $C A \neq C B$. Let $D, F$, and $G$ be the midpoints of the sides $A B, A C$, and $B C$, respectively. A circle $\Gamma$ passing through $C$ and tangent to $A B$ at $D$ meets the segments $A F$ and $B G$ at $H$ and $I$, respectively. The points $H^{\prime}$ and $I^{\prime}$ are symmetric to $H$ and $I$ about $F$ and $G$, respectively. The line $H^{\prime} I^{\prime}$ meets $C D$ and $F G$ at $Q$ and $M$, respectively. The line $C M$ meets $\Gamma$ again at $P$. Prove that $C Q=Q P$.","We may assume that $C A>C B$. Observe that $H^{\prime}$ and $I^{\prime}$ lie inside the segments $C F$ and $C G$, respectively. Therefore, $M$ lies outside $\triangle A B C$ (see Figure 1).

Due to the powers of points $A$ and $B$ with respect to the circle $\Gamma$, we have

$$
C H^{\prime} \cdot C A=A H \cdot A C=A D^{2}=B D^{2}=B I \cdot B C=C I^{\prime} \cdot C B .
$$

Therefore, $C H^{\prime} \cdot C F=C I^{\prime} \cdot C G$. Hence, the quadrilateral $H^{\prime} I^{\prime} G F$ is cyclic, and so $\angle I^{\prime} H^{\prime} C=$ $\angle C G F$.

Let $D F$ and $D G$ meet $\Gamma$ again at $R$ and $S$, respectively. We claim that the points $R$ and $S$ lie on the line $H^{\prime} I^{\prime}$.

Observe that $F H^{\prime} \cdot F A=F H \cdot F C=F R \cdot F D$. Thus, the quadrilateral $A D H^{\prime} R$ is cyclic, and hence $\angle R H^{\prime} F=\angle F D A=\angle C G F=\angle I^{\prime} H^{\prime} C$. Therefore, the points $R, H^{\prime}$, and $I^{\prime}$ are collinear. Similarly, the points $S, H^{\prime}$, and $I^{\prime}$ are also collinear, and so all the points $R, H^{\prime}, Q, I^{\prime}, S$, and $M$ are all collinear.\\

Then, $\angle R S D=\angle R D A=\angle D F G$. Hence, the quadrilateral $R S G F$ is cyclic (see Figure 2). Therefore, $M H^{\prime} \cdot M I^{\prime}=M F \cdot M G=M R \cdot M S=M P \cdot M C$. Thus, the quadrilateral $C P I^{\prime} H^{\prime}$ is also cyclic. Let $\omega$ be its circumcircle.

Notice that $\angle H^{\prime} C Q=\angle S D C=\angle S R C$ and $\angle Q C I^{\prime}=\angle C D R=\angle C S R$. Hence, $\triangle C H^{\prime} Q \sim \triangle R C Q$ and $\triangle C I^{\prime} Q \sim \triangle S C Q$, and therefore $Q H^{\prime} \cdot Q R=Q C^{2}=Q I^{\prime} \cdot Q S$.

We apply the inversion with center $Q$ and radius $Q C$. Observe that the points $R, C$, and $S$ are mapped to $H^{\prime}, C$, and $I^{\prime}$, respectively. Therefore, the circumcircle $\Gamma$ of $\triangle R C S$ is mapped to the circumcircle $\omega$ of $\triangle H^{\prime} C I^{\prime}$. Since $P$ and $C$ belong to both circles and the point $C$ is preserved by the inversion, we have that $P$ is also mapped to itself. We then get $Q P^{2}=Q C^{2}$. Hence, $Q P=Q C$.
",396,3
2015g6,"Let $A B C$ be an acute triangle with $A B>A C$, and let $\Gamma$ be its circumcircle. Let $H$, $M$, and $F$ be the orthocenter of the triangle, the midpoint of $B C$, and the foot of the altitude from $A$, respectively. Let $Q$ and $K$ be the two points on $\Gamma$ that satisfy $\angle A Q H=90^{\circ}$ and $\angle Q K H=90^{\circ}$. Prove that the circumcircles of the triangles $K Q H$ and $K F M$ are tangent to each other.","Let $A^{\prime}$ be the point diametrically opposite to $A$ on $\Gamma$. Since $\angle A Q A^{\prime}=90^{\circ}$ and $\angle A Q H=90^{\circ}$, the points $Q, H$, and $A^{\prime}$ are collinear. Similarly, if $Q^{\prime}$ denotes the point on $\Gamma$ diametrically opposite to $Q$, then $K, H$, and $Q^{\prime}$ are collinear. Let the line $A H F$ intersect $\Gamma$ again at $E$; it is known that $M$ is the midpoint of the segment $H A^{\prime}$ and that $F$ is the midpoint of $H E$. Let $J$ be the midpoint of $H Q^{\prime}$.

Consider any point $T$ such that $T K$ is tangent to the circle $K Q H$ at $K$ with $Q$ and $T$ lying on different sides of $K H$ (see Figure 1). Then $\angle H K T=\angle H Q K$ and we are to prove that $\angle M K T=\angle C F K$. Thus it remains to show that $\angle H Q K=\angle C F K+\angle H K M$. Due to $\angle H Q K=90^{\circ}-\angle Q^{\prime} H A^{\prime}$ and $\angle C F K=90^{\circ}-\angle K F A$, this means the same as $\angle Q^{\prime} H A^{\prime}=$ $\angle K F A-\angle H K M$. Now, since the triangles $K H E$ and $A H Q^{\prime}$ are similar with $F$ and $J$ being the midpoints of corresponding sides, we have $\angle K F A=\angle H J A$, and analogously one may obtain $\angle H K M=\angle J Q H$. Thereby our task is reduced to verifying

$$
\angle Q^{\prime} H A^{\prime}=\angle H J A-\angle J Q H .
$$

To avoid confusion, let us draw a new picture at this moment (see Figure 2). Owing to $\angle Q^{\prime} H A^{\prime}=\angle J Q H+\angle H J Q$ and $\angle H J A=\angle Q J A+\angle H J Q$, we just have to show that $2 \angle J Q H=\angle Q J A$. To this end, it suffices to remark that $A Q A^{\prime} Q^{\prime}$ is a rectangle and that $J$, being defined to be the midpoint of $H Q^{\prime}$, has to lie on the mid parallel of $Q A^{\prime}$ and $Q^{\prime} A$.

",347,3
2015g7,"Let $A B C D$ be a convex quadrilateral, and let $P, Q, R$, and $S$ be points on the sides $A B, B C, C D$, and $D A$, respectively. Let the line segments $P R$ and $Q S$ meet at $O$. Suppose that each of the quadrilaterals $A P O S, B Q O P, C R O Q$, and $D S O R$ has an incircle. Prove that the lines $A C, P Q$, and $R S$ are either concurrent or parallel to each other.","Denote by $\gamma_{A}, \gamma_{B}, \gamma_{C}$, and $\gamma_{D}$ the incircles of the quadrilaterals $A P O S, B Q O P$, $C R O Q$, and $D S O R$, respectively.

We start with proving that the quadrilateral $A B C D$ also has an incircle which will be referred to as $\Omega$. Denote the points of tangency as in Figure 1. It is well-known that $Q Q_{1}=O O_{1}$ (if $B C \| P R$, this is obvious; otherwise, one may regard the two circles involved as the incircle and an excircle of the triangle formed by the lines $O Q, P R$, and $B C$ ). Similarly, $O O_{1}=P P_{1}$. Hence we have $Q Q_{1}=P P_{1}$. The other equalities of segment lengths marked in Figure 1 can be proved analogously. These equalities, together with $A P_{1}=A S_{1}$ and similar ones, yield $A B+C D=A D+B C$, as required.\\

Next, let us draw the lines parallel to $Q S$ through $P$ and $R$, and also draw the lines parallel to $P R$ through $Q$ and $S$. These lines form a parallelogram; denote its vertices by $A^{\prime}, B^{\prime}, C^{\prime}$, and $D^{\prime}$ as shown in Figure 2.

Since the quadrilateral $A P O S$ has an incircle, we have $A P-A S=O P-O S=A^{\prime} S-A^{\prime} P$. It is well-known that in this case there also exists a circle $\omega_{A}$ tangent to the four rays $A P$, $A S, A^{\prime} P$, and $A^{\prime} S$. It is worth mentioning here that in case when, say, the lines $A B$ and $A^{\prime} B^{\prime}$ coincide, the circle $\omega_{A}$ is just tangent to $A B$ at $P$. We introduce the circles $\omega_{B}, \omega_{C}$, and $\omega_{D}$ in a similar manner.

Assume that the radii of the circles $\omega_{A}$ and $\omega_{C}$ are different. Let $X$ be the center of the homothety having a positive scale factor and mapping $\omega_{A}$ to $\omega_{C}$.

Now, Monge's theorem applied to the circles $\omega_{A}, \Omega$, and $\omega_{C}$ shows that the points $A, C$, and $X$ are collinear. Applying the same theorem to the circles $\omega_{A}, \omega_{B}$, and $\omega_{C}$, we see that the points $P, Q$, and $X$ are also collinear. Similarly, the points $R, S$, and $X$ are collinear, as required.

If the radii of $\omega_{A}$ and $\omega_{C}$ are equal but these circles do not coincide, then the degenerate version of the same theorem yields that the three lines $A C, P Q$, and $R S$ are parallel to the line of centers of $\omega_{A}$ and $\omega_{C}$.

Finally, we need to say a few words about the case when $\omega_{A}$ and $\omega_{C}$ coincide (and thus they also coincide with $\Omega, \omega_{B}$, and $\left.\omega_{D}\right)$. It may be regarded as the limit case in the following manner.\\

Let us fix the positions of $A, P, O$, and $S$ (thus we also fix the circles $\omega_{A}, \gamma_{A}, \gamma_{B}$, and $\gamma_{D}$ ). Now we vary the circle $\gamma_{C}$ inscribed into $\angle Q O R$; for each of its positions, one may reconstruct the lines $B C$ and $C D$ as the external common tangents to $\gamma_{B}, \gamma_{C}$ and $\gamma_{C}, \gamma_{D}$ different from $P R$ and $Q S$, respectively. After such variation, the circle $\Omega$ changes, so the result obtained above may be applied.

",534,4
2015g8,"A triangulation of a convex polygon $\Pi$ is a partitioning of $\Pi$ into triangles by diagonals having no common points other than the vertices of the polygon. We say that a triangulation is a Thaiangulation if all triangles in it have the same area.

Prove that any two different Thaiangulations of a convex polygon $\Pi$ differ by exactly two triangles. (In other words, prove that it is possible to replace one pair of triangles in the first Thaiangulation with a different pair of triangles so as to obtain the second Thaiangulation.)","We denote by $[S]$ the area of a polygon $S$.\\
Recall that each triangulation of a convex $n$-gon has exactly $n-2$ triangles. This means that all triangles in any two Thaiangulations of a convex polygon $\Pi$ have the same area.

Let $\mathcal{T}$ be a triangulation of a convex polygon $\Pi$. If four vertices $A, B, C$, and $D$ of $\Pi$ form a parallelogram, and $\mathcal{T}$ contains two triangles whose union is this parallelogram, then we say that $\mathcal{T}$ contains parallelogram $A B C D$. Notice here that if two Thaiangulations $\mathcal{T}_{1}$ and $\mathcal{T}_{2}$ of $\Pi$ differ by two triangles, then the union of these triangles is a quadrilateral each of whose diagonals bisects its area, i.e., a parallelogram.

We start with proving two properties of triangulations.\\
Lemma 1. A triangulation of a convex polygon $\Pi$ cannot contain two parallelograms.\\
Proof. Arguing indirectly, assume that $P_{1}$ and $P_{2}$ are two parallelograms contained in some triangulation $\mathcal{T}$. If they have a common triangle in $\mathcal{T}$, then we may assume that $P_{1}$ consists of triangles $A B C$ and $A D C$ of $\mathcal{T}$, while $P_{2}$ consists of triangles $A D C$ and $C D E$ (see Figure 1). But then $B C\|A D\| C E$, so the three vertices $B, C$, and $E$ of $\Pi$ are collinear, which is absurd.

Assume now that $P_{1}$ and $P_{2}$ contain no common triangle. Let $P_{1}=A B C D$. The sides $A B$, $B C, C D$, and $D A$ partition $\Pi$ into several parts, and $P_{2}$ is contained in one of them; we may assume that this part is cut off from $P_{1}$ by $A D$. Then one may label the vertices of $P_{2}$ by $X$, $Y, Z$, and $T$ so that the polygon $A B C D X Y Z T$ is convex (see Figure 2; it may happen that $D=X$ and/or $T=A$, but still this polygon has at least six vertices). But the sum of the external angles of this polygon at $B, C, Y$, and $Z$ is already $360^{\circ}$, which is impossible. A final contradiction.\\

Lemma 2. Every triangle in a Thaiangulation $\mathcal{T}$ of $\Pi$ contains a side of $\Pi$.\\
Proof. Let $A B C$ be a triangle in $\mathcal{T}$. Apply an affine transform such that $A B C$ maps to an equilateral triangle; let $A^{\prime} B^{\prime} C^{\prime}$ be the image of this triangle, and $\Pi^{\prime}$ be the image of $\Pi$. Clearly, $\mathcal{T}$ maps into a Thaiangulation $\mathcal{T}^{\prime}$ of $\Pi^{\prime}$.

Assume that none of the sides of $\triangle A^{\prime} B^{\prime} C^{\prime}$ is a side of $\Pi^{\prime}$. Then $\mathcal{T}^{\prime}$ contains some other triangles with these sides, say, $A^{\prime} B^{\prime} Z, C^{\prime} A^{\prime} Y$, and $B^{\prime} C^{\prime} X$; notice that $A^{\prime} Z B^{\prime} X C^{\prime} Y$ is a convex hexagon (see Figure 3). The sum of its external angles at $X, Y$, and $Z$ is less than $360^{\circ}$. So one of these angles (say, at $Z$ ) is less than $120^{\circ}$, hence $\angle A^{\prime} Z B^{\prime}>60^{\circ}$. Then $Z$ lies on a circular arc subtended by $A^{\prime} B^{\prime}$ and having angular measure less than $240^{\circ}$; consequently, the altitude $Z H$ of $\triangle A^{\prime} B^{\prime} Z$ is less than $\sqrt{3} A^{\prime} B^{\prime} / 2$. Thus $\left[A^{\prime} B^{\prime} Z\right]<\left[A^{\prime} B^{\prime} C^{\prime}\right]$, and $\mathcal{T}^{\prime}$ is not a Thaiangulation. A contradiction.

Now we pass to the solution. We say that a triangle in a triangulation of $\Pi$ is an ear if it contains two sides of $\Pi$. Note that each triangulation of a polygon contains some ear.

Arguing indirectly, we choose a convex polygon $\Pi$ with the least possible number of sides such that some two Thaiangulations $\mathcal{T}_{1}$ and $\mathcal{T}_{2}$ of $\Pi$ violate the problem statement (thus $\Pi$ has at least five sides). Consider now any ear $A B C$ in $\mathcal{T}_{1}$, with $A C$ being a diagonal of $\Pi$. If $\mathcal{T}_{2}$ also contains $\triangle A B C$, then one may cut $\triangle A B C$ off from $\Pi$, getting a polygon with a smaller number of sides which also violates the problem statement. This is impossible; thus $\mathcal{T}_{2}$ does not contain $\triangle A B C$.

Next, $\mathcal{T}_{1}$ contains also another triangle with side $A C$, say $\triangle A C D$. By Lemma 2, this triangle contains a side of $\Pi$, so $D$ is adjacent to either $A$ or $C$ on the boundary of $\Pi$. We may assume that $D$ is adjacent to $C$.

Assume that $\mathcal{T}_{2}$ does not contain the triangle $B C D$. Then it contains two different triangles $B C X$ and $C D Y$ (possibly, with $X=Y$ ); since these triangles have no common interior points, the polygon $A B C D Y X$ is convex (see Figure 4). But, since $[A B C]=[B C X]=$ $[A C D]=[C D Y]$, we get $A X \| B C$ and $A Y \| C D$ which is impossible. Thus $\mathcal{T}_{2}$ contains $\triangle B C D$.

Therefore, $[A B D]=[A B C]+[A C D]-[B C D]=[A B C]$, and $A B C D$ is a parallelogram contained in $\mathcal{T}_{1}$. Let $\mathcal{T}^{\prime}$ be the Thaiangulation of $\Pi$ obtained from $\mathcal{T}_{1}$ by replacing the diagonal $A C$ with $B D$; then $\mathcal{T}^{\prime}$ is distinct from $\mathcal{T}_{2}$ (otherwise $\mathcal{T}_{1}$ and $\mathcal{T}_{2}$ would differ by two triangles). Moreover, $\mathcal{T}^{\prime}$ shares a common ear $B C D$ with $\mathcal{T}_{2}$. As above, cutting this ear away we obtain that $\mathcal{T}_{2}$ and $\mathcal{T}^{\prime}$ differ by two triangles forming a parallelogram different from $A B C D$. Thus $\mathcal{T}^{\prime}$ contains two parallelograms, which contradicts Lemma 1.\\


",911,4
2015n2,Let $a$ and $b$ be positive integers such that $a!b!$ is a multiple of $a!+b!$. Prove that $3 a \geqslant 2 b+2$.,"If $a>b$, we immediately get $3 a \geqslant 2 b+2$. In the case $a=b$, the required inequality is equivalent to $a \geqslant 2$, which can be checked easily since $(a, b)=(1,1)$ does not satisfy $a!+b!\mid a!b!$. We now assume $a<b$ and denote $c=b-a$. The required inequality becomes $a \geqslant 2 c+2$.

Suppose, to the contrary, that $a \leqslant 2 c+1$. Define $M=\frac{b!}{a!}=(a+1)(a+2) \cdots(a+c)$. Since $a!+b!\mid a!b!$ implies $1+M \mid a!M$, we obtain $1+M \mid a!$. Note that we must have $c<a$; otherwise $1+M>a!$, which is impossible. We observe that $c!\mid M$ since $M$ is a product of $c$ consecutive integers. Thus $\operatorname{gcd}(1+M, c!)=1$, which implies


\begin{equation*}
1+M \left\lvert\, \frac{a!}{c!}=(c+1)(c+2) \cdots a\right. \tag{1}
\end{equation*}


If $a \leqslant 2 c$, then $\frac{a!}{c!}$ is a product of $a-c \leqslant c$ integers not exceeding $a$ whereas $M$ is a product of $c$ integers exceeding $a$. Therefore, $1+M>\frac{a!}{c!}$, which is a contradiction.

It remains to exclude the case $a=2 c+1$. Since $a+1=2(c+1)$, we have $c+1 \mid M$. Hence, we can deduce from (1) that $1+M \mid(c+2)(c+3) \cdots a$. Now $(c+2)(c+3) \cdots a$ is a product of $a-c-1=c$ integers not exceeding $a$; thus it is smaller than $1+M$. Again, we arrive at a contradiction.
",198,2
2015n3,"Let $m$ and $n$ be positive integers such that $m>n$. Define $x_{k}=(m+k) /(n+k)$ for $k=$ $1,2, \ldots, n+1$. Prove that if all the numbers $x_{1}, x_{2}, \ldots, x_{n+1}$ are integers, then $x_{1} x_{2} \cdots x_{n+1}-1$ is divisible by an odd prime.","Solution. Assume that $x_{1}, x_{2}, \ldots, x_{n+1}$ are integers. Define the integers

$$
a_{k}=x_{k}-1=\frac{m+k}{n+k}-1=\frac{m-n}{n+k}>0
$$

for $k=1,2, \ldots, n+1$.\\
Let $P=x_{1} x_{2} \cdots x_{n+1}-1$. We need to prove that $P$ is divisible by an odd prime, or in other words, that $P$ is not a power of 2 . To this end, we investigate the powers of 2 dividing the numbers $a_{k}$.

Let $2^{d}$ be the largest power of 2 dividing $m-n$, and let $2^{c}$ be the largest power of 2 not exceeding $2 n+1$. Then $2 n+1 \leqslant 2^{c+1}-1$, and so $n+1 \leqslant 2^{c}$. We conclude that $2^{c}$ is one of the numbers $n+1, n+2, \ldots, 2 n+1$, and that it is the only multiple of $2^{c}$ appearing among these numbers. Let $\ell$ be such that $n+\ell=2^{c}$. Since $\frac{m-n}{n+\ell}$ is an integer, we have $d \geqslant c$. Therefore, $2^{d-c+1} \nmid a_{\ell}=\frac{m-n}{n+\ell}$, while $2^{d-c+1} \mid a_{k}$ for all $k \in\{1, \ldots, n+1\} \backslash\{\ell\}$.

Computing modulo $2^{d-c+1}$, we get

$$
P=\left(a_{1}+1\right)\left(a_{2}+1\right) \cdots\left(a_{n+1}+1\right)-1 \equiv\left(a_{\ell}+1\right) \cdot 1^{n}-1 \equiv a_{\ell} \not \equiv 0 \quad\left(\bmod 2^{d-c+1}\right) .
$$

Therefore, $2^{d-c+1} \nmid P$.\\
On the other hand, for any $k \in\{1, \ldots, n+1\} \backslash\{\ell\}$, we have $2^{d-c+1} \mid a_{k}$. So $P \geqslant a_{k} \geqslant 2^{d-c+1}$, and it follows that $P$ is not a power of 2 .

Comment. Instead of attempting to show that $P$ is not a power of 2 , one may try to find an odd factor of $P$ (greater than 1) as follows:

From $a_{k}=\frac{m-n}{n+k} \in \mathbb{Z}_{>0}$, we get that $m-n$ is divisible by $n+1, n+2, \ldots, 2 n+1$, and thus it is also divisible by their least common multiple $L$. So $m-n=q L$ for some positive integer $q$; hence $x_{k}=q \cdot \frac{L}{n+k}+1$.

Then, since $n+1 \leqslant 2^{c}=n+\ell \leqslant 2 n+1 \leqslant 2^{c+1}-1$, we have $2^{c} \mid L$, but $2^{c+1} \nmid L$. So $\frac{L}{n+\ell}$ is odd, while $\frac{L}{n+k}$ is even for $k \neq \ell$. Computing modulo $2 q$ yields

$$
x_{1} x_{2} \cdots x_{n+1}-1 \equiv(q+1) \cdot 1^{n}-1 \equiv q \quad(\bmod 2 q) .
$$

Thus, $x_{1} x_{2} \cdots x_{n+1}-1=2 q r+q=q(2 r+1)$ for some integer $r$.\\
Since $x_{1} x_{2} \cdots x_{n+1}-1 \geqslant x_{1} x_{2}-1 \geqslant(q+1)^{2}-1>q$, we have $r \geqslant 1$. This implies that $x_{1} x_{2} \cdots x_{n+1}-1$ is divisible by an odd prime.",371,3
2015n4,"Suppose that $a_{0}, a_{1}, \ldots$ and $b_{0}, b_{1}, \ldots$ are two sequences of positive integers satisfying $a_{0}, b_{0} \geqslant 2$ and

$$
a_{n+1}=\operatorname{gcd}\left(a_{n}, b_{n}\right)+1, \quad b_{n+1}=\operatorname{lcm}\left(a_{n}, b_{n}\right)-1
$$

for all $n \geqslant 0$. Prove that the sequence $\left(a_{n}\right)$ is eventually periodic; in other words, there exist integers $N \geqslant 0$ and $t>0$ such that $a_{n+t}=a_{n}$ for all $n \geqslant N$.","Let $s_{n}=a_{n}+b_{n}$. Notice that if $a_{n} \mid b_{n}$, then $a_{n+1}=a_{n}+1, b_{n+1}=b_{n}-1$ and $s_{n+1}=s_{n}$. So, $a_{n}$ increases by 1 and $s_{n}$ does not change until the first index is reached with $a_{n} \nmid s_{n}$. Define

$$
W_{n}=\left\{m \in \mathbb{Z}_{>0}: m \geqslant a_{n} \text { and } m \nmid s_{n}\right\} \quad \text { and } \quad w_{n}=\min W_{n} .
$$

Claim 1. The sequence $\left(w_{n}\right)$ is non-increasing.\\
Proof. If $a_{n} \mid b_{n}$ then $a_{n+1}=a_{n}+1$. Due to $a_{n} \mid s_{n}$, we have $a_{n} \notin W_{n}$. Moreover $s_{n+1}=s_{n}$; therefore, $W_{n+1}=W_{n}$ and $w_{n+1}=w_{n}$.

Otherwise, if $a_{n} \nmid b_{n}$, then $a_{n} \nmid s_{n}$, so $a_{n} \in W_{n}$ and thus $w_{n}=a_{n}$. We show that $a_{n} \in W_{n+1}$; this implies $w_{n+1} \leqslant a_{n}=w_{n}$. By the definition of $W_{n+1}$, we need that $a_{n} \geqslant a_{n+1}$ and $a_{n} \nmid s_{n+1}$. The first relation holds because of $\operatorname{gcd}\left(a_{n}, b_{n}\right)<a_{n}$. For the second relation, observe that in $s_{n+1}=\operatorname{gcd}\left(a_{n}, b_{n}\right)+\operatorname{lcm}\left(a_{n}, b_{n}\right)$, the second term is divisible by $a_{n}$, but the first term is not. So $a_{n} \nmid s_{n+1}$; that completes the proof of the claim.

Let $w=\min _{n} w_{n}$ and let $N$ be an index with $w=w_{N}$. Due to Claim 1, we have $w_{n}=w$ for all $n \geqslant N$.

Let $g_{n}=\operatorname{gcd}\left(w, s_{n}\right)$. As we have seen, starting from an arbitrary index $n \geqslant N$, the sequence $a_{n}, a_{n+1}, \ldots$ increases by 1 until it reaches $w$, which is the first value not dividing $s_{n}$; then it drops to $\operatorname{gcd}\left(w, s_{n}\right)+1=g_{n}+1$.\\
Claim 2. The sequence $\left(g_{n}\right)$ is constant for $n \geqslant N$.\\
Proof. If $a_{n} \mid b_{n}$, then $s_{n+1}=s_{n}$ and hence $g_{n+1}=g_{n}$. Otherwise we have $a_{n}=w$,


\begin{align*}
\operatorname{gcd}\left(a_{n}, b_{n}\right) & =\operatorname{gcd}\left(a_{n}, s_{n}\right)=\operatorname{gcd}\left(w, s_{n}\right)=g_{n} \\
s_{n+1} & =\operatorname{gcd}\left(a_{n}, b_{n}\right)+\operatorname{lcm}\left(a_{n}, b_{n}\right)=g_{n}+\frac{a_{n} b_{n}}{g_{n}}=g_{n}+\frac{w\left(s_{n}-w\right)}{g_{n}},  \tag{1}\\
\text { and } \quad g_{n+1} & =\operatorname{gcd}\left(w, s_{n+1}\right)=\operatorname{gcd}\left(w, g_{n}+\frac{s_{n}-w}{g_{n}} w\right)=\operatorname{gcd}\left(w, g_{n}\right)=g_{n} .
\end{align*}


Let $g=g_{N}$. We have proved that the sequence $\left(a_{n}\right)$ eventually repeats the following cycle:

$$
g+1 \mapsto g+2 \mapsto \ldots \mapsto w \mapsto g+1
$$",316,3
2015n6,"Let $\mathbb{Z}_{>0}$ denote the set of positive integers. Consider a function $f: \mathbb{Z}_{>0} \rightarrow \mathbb{Z}_{>0}$. For any $m, n \in \mathbb{Z}_{>0}$ we write $f^{n}(m)=\underbrace{f(f(\ldots f}_{n}(m) \ldots))$. Suppose that $f$ has the following two properties:\\
(i) If $m, n \in \mathbb{Z}_{>0}$, then $\frac{f^{n}(m)-m}{n} \in \mathbb{Z}_{>0}$;\\
(ii) The set $\mathbb{Z}_{>0} \backslash\left\{f(n) \mid n \in \mathbb{Z}_{>0}\right\}$ is finite.

Prove that the sequence $f(1)-1, f(2)-2, f(3)-3, \ldots$ is periodic.","Solution. We split the solution into three steps. In the first of them, we show that the function $f$ is injective and explain how this leads to a useful visualization of $f$. Then comes the second step, in which most of the work happens: its goal is to show that for any $n \in \mathbb{Z}_{>0}$ the sequence $n, f(n), f^{2}(n), \ldots$ is an arithmetic progression. Finally, in the third step we put everything together, thus solving the problem.

Step 1. We commence by checking that $f$ is injective. For this purpose, we consider any $m, k \in \mathbb{Z}_{>0}$ with $f(m)=f(k)$. By $(i)$, every positive integer $n$ has the property that

$$
\frac{k-m}{n}=\frac{f^{n}(m)-m}{n}-\frac{f^{n}(k)-k}{n}
$$

is a difference of two integers and thus integral as well. But for $n=|k-m|+1$ this is only possible if $k=m$. Thereby, the injectivity of $f$ is established.

Now recall that due to condition (ii) there are finitely many positive integers $a_{1}, \ldots, a_{k}$ such that $\mathbb{Z}_{>0}$ is the disjoint union of $\left\{a_{1}, \ldots, a_{k}\right\}$ and $\left\{f(n) \mid n \in \mathbb{Z}_{>0}\right\}$. Notice that by plugging $n=1$ into condition $(i)$ we get $f(m)>m$ for all $m \in \mathbb{Z}_{>0}$.

We contend that every positive integer $n$ may be expressed uniquely in the form $n=f^{j}\left(a_{i}\right)$ for some $j \geqslant 0$ and $i \in\{1, \ldots, k\}$. The uniqueness follows from the injectivity of $f$. The existence can be proved by induction on $n$ in the following way. If $n \in\left\{a_{1}, \ldots, a_{k}\right\}$, then we may take $j=0$; otherwise there is some $n^{\prime}<n$ with $f\left(n^{\prime}\right)=n$ to which the induction hypothesis may be applied.

The result of the previous paragraph means that every positive integer appears exactly once in the following infinite picture, henceforth referred to as ""the Table"":

\begin{center}
\begin{tabular}{|c|c|c|c|c}
\hline
$a_{1}$ & $f\left(a_{1}\right)$ & $f^{2}\left(a_{1}\right)$ & $f^{3}\left(a_{1}\right)$ & $\ldots$ \\
\hline
$a_{2}$ & $f\left(a_{2}\right)$ & $f^{2}\left(a_{2}\right)$ & $f^{3}\left(a_{2}\right)$ & $\ldots$ \\
\hline
$\vdots$ & $\vdots$ & $\vdots$ & $\vdots$ &  \\
\hline
$a_{k}$ & $f\left(a_{k}\right)$ & $f^{2}\left(a_{k}\right)$ & $f^{3}\left(a_{k}\right)$ & $\ldots$ \\
\hline
\end{tabular}
\end{center}

The Table

Step 2. Our next goal is to prove that each row of the Table is an arithmetic progression. Assume contrariwise that the number $t$ of rows which are arithmetic progressions would satisfy $0 \leqslant t<k$. By permuting the rows if necessary we may suppose that precisely the first $t$ rows are arithmetic progressions, say with steps $T_{1}, \ldots, T_{t}$. Our plan is to find a further row that is ""not too sparse"" in an asymptotic sense, and then to prove that such a row has to be an arithmetic progression as well.

Let us write $T=\operatorname{lcm}\left(T_{1}, T_{2}, \ldots, T_{t}\right)$ and $A=\max \left\{a_{1}, a_{2}, \ldots, a_{t}\right\}$ if $t>0$; and $T=1$ and $A=0$ if $t=0$. For every integer $n \geqslant A$, the interval $\Delta_{n}=[n+1, n+T]$ contains exactly $T / T_{i}$\\
elements of the $i^{\text {th }}$ row $(1 \leqslant i \leqslant t)$. Therefore, the number of elements from the last $(k-t)$ rows of the Table contained in $\Delta_{n}$ does not depend on $n \geqslant A$. It is not possible that none of these intervals $\Delta_{n}$ contains an element from the $k-t$ last rows, because infinitely many numbers appear in these rows. It follows that for each $n \geqslant A$ the interval $\Delta_{n}$ contains at least one member from these rows.

This yields that for every positive integer $d$, the interval $[A+1, A+(d+1)(k-t) T]$ contains at least $(d+1)(k-t)$ elements from the last $k-t$ rows; therefore, there exists an index $x$ with $t+1 \leqslant x \leqslant k$, possibly depending on $d$, such that our interval contains at least $d+1$ elements from the $x^{\text {th }}$ row. In this situation we have

$$
f^{d}\left(a_{x}\right) \leqslant A+(d+1)(k-t) T
$$

Finally, since there are finitely many possibilities for $x$, there exists an index $x \geqslant t+1$ such that the set

$$
X=\left\{d \in \mathbb{Z}_{>0} \mid f^{d}\left(a_{x}\right) \leqslant A+(d+1)(k-t) T\right\}
$$

is infinite. Thereby we have found the ""dense row"" promised above.\\
By assumption $(i)$, for every $d \in X$ the number

$$
\beta_{d}=\frac{f^{d}\left(a_{x}\right)-a_{x}}{d}
$$

is a positive integer not exceeding

$$
\frac{A+(d+1)(k-t) T}{d} \leqslant \frac{A d+2 d(k-t) T}{d}=A+2(k-t) T
$$

This leaves us with finitely many choices for $\beta_{d}$, which means that there exists a number $T_{x}$ such that the set

$$
Y=\left\{d \in X \mid \beta_{d}=T_{x}\right\}
$$

is infinite. Notice that we have $f^{d}\left(a_{x}\right)=a_{x}+d \cdot T_{x}$ for all $d \in Y$.\\
Now we are prepared to prove that the numbers in the $x^{\text {th }}$ row form an arithmetic progression, thus coming to a contradiction with our assumption. Let us fix any positive integer $j$. Since the set $Y$ is infinite, we can choose a number $y \in Y$ such that $y-j>\left|f^{j}\left(a_{x}\right)-\left(a_{x}+j T_{x}\right)\right|$. Notice that both numbers

$$
f^{y}\left(a_{x}\right)-f^{j}\left(a_{x}\right)=f^{y-j}\left(f^{j}\left(a_{x}\right)\right)-f^{j}\left(a_{x}\right) \quad \text { and } \quad f^{y}\left(a_{x}\right)-\left(a_{x}+j T_{x}\right)=(y-j) T_{x}
$$

are divisible by $y-j$. Thus, the difference between these numbers is also divisible by $y-j$. Since the absolute value of this difference is less than $y-j$, it has to vanish, so we get $f^{j}\left(a_{x}\right)=$ $a_{x}+j \cdot T_{x}$.

Hence, it is indeed true that all rows of the Table are arithmetic progressions.\\
Step 3. Keeping the above notation in force, we denote the step of the $i^{\text {th }}$ row of the table by $T_{i}$.\\
\includegraphics[max width=\textwidth, center]{2025_04_30_c8781145b2af5b76793eg-75}

$$
T=\operatorname{lcm}\left(T_{1}, \ldots, T_{k}\right)
$$

To see this, let any $n \in \mathbb{Z}_{>0}$ be given and denote the index of the row in which it appears in the Table by $i$. Then we have $f^{j}(n)=n+j \cdot T_{i}$ for all $j \in \mathbb{Z}_{>0}$, and thus indeed

$$
f(n+T)-f(n)=f^{1+T / T_{i}}(n)-f(n)=\left(n+T+T_{i}\right)-\left(n+T_{i}\right)=T
$$

This concludes the solution.

Comment 1. There are some alternative ways to complete the second part once the index $x$ corresponding to a ""dense row"" is found. For instance, one may show that for some integer $T_{x}^{*}$ the set

$$
Y^{*}=\left\{j \in \mathbb{Z}_{>0} \mid f^{j+1}\left(a_{x}\right)-f^{j}\left(a_{x}\right)=T_{x}^{*}\right\}
$$

is infinite, and then one may conclude with a similar divisibility argument.\\
Comment 2. It may be checked that, conversely, any way to fill out the Table with finitely many arithmetic progressions so that each positive integer appears exactly once, gives rise to a function $f$ satisfying the two conditions mentioned in the problem. For example, we may arrange the positive integers as follows:

\begin{center}
\begin{tabular}{|c|c|c|c|c|c}
\hline
2 & 4 & 6 & 8 & 10 & $\ldots$ \\
\hline
1 & 5 & 9 & 13 & 17 & $\ldots$ \\
\hline
3 & 7 & 11 & 15 & 19 & $\ldots$ \\
\hline
\end{tabular}
\end{center}

This corresponds to the function

$$
f(n)= \begin{cases}n+2 & \text { if } n \text { is even } \\ n+4 & \text { if } n \text { is odd }\end{cases}
$$

As this example shows, it is not true that the function $n \mapsto f(n)-n$ has to be constant.",1120,4
2014a1,"Let $z_{0}<z_{1}<z_{2}<\cdots$ be an infinite sequence of positive integers. Prove that there exists a unique integer $n \geqslant 1$ such that

\begin{equation*}
z_{n}<\frac{z_{0}+z_{1}+\cdots+z_{n}}{n} \leqslant z_{n+1} . \tag{1}
\end{equation*}","Solution. For $n=1,2, \ldots$ define

$$
d_{n}=\left(z_{0}+z_{1}+\cdots+z_{n}\right)-n z_{n} .
$$

The sign of $d_{n}$ indicates whether the first inequality in (1) holds; i.e., it is satisfied if and only if $d_{n}>0$.

Notice that

$$
n z_{n+1}-\left(z_{0}+z_{1}+\cdots+z_{n}\right)=(n+1) z_{n+1}-\left(z_{0}+z_{1}+\cdots+z_{n}+z_{n+1}\right)=-d_{n+1},
$$

so the second inequality in (1) is equivalent to $d_{n+1} \leqslant 0$. Therefore, we have to prove that there is a unique index $n \geqslant 1$ that satisfies $d_{n}>0 \geqslant d_{n+1}$.

By its definition the sequence $d_{1}, d_{2}, \ldots$ consists of integers and we have

$$
d_{1}=\left(z_{0}+z_{1}\right)-1 \cdot z_{1}=z_{0}>0 .
$$

From\\
$d_{n+1}-d_{n}=\left(\left(z_{0}+\cdots+z_{n}+z_{n+1}\right)-(n+1) z_{n+1}\right)-\left(\left(z_{0}+\cdots+z_{n}\right)-n z_{n}\right)=n\left(z_{n}-z_{n+1}\right)<0$ we can see that $d_{n+1}<d_{n}$ and thus the sequence strictly decreases.

Hence, we have a decreasing sequence $d_{1}>d_{2}>\ldots$ of integers such that its first element $d_{1}$ is positive. The sequence must drop below 0 at some point, and thus there is a unique index $n$, that is the index of the last positive term, satisfying $d_{n}>0 \geqslant d_{n+1}$.

Comment. Omitting the assumption that $z_{1}, z_{2}, \ldots$ are integers allows the numbers $d_{n}$ to be all positive. In such cases the desired $n$ does not exist. This happens for example if $z_{n}=2-\frac{1}{2^{n}}$ for all integers $n \geqslant 0$.",190,2
2014a2,"Define the function $f:(0,1) \rightarrow(0,1)$ by

$$
f(x)= \begin{cases}x+\frac{1}{2} & \text { if } x<\frac{1}{2} \\ x^{2} & \text { if } x \geqslant \frac{1}{2}\end{cases}
$$

Let $a$ and $b$ be two real numbers such that $0<a<b<1$. We define the sequences $a_{n}$ and $b_{n}$ by $a_{0}=a, b_{0}=b$, and $a_{n}=f\left(a_{n-1}\right), b_{n}=f\left(b_{n-1}\right)$ for $n>0$. Show that there exists a positive integer $n$ such that

$$
\left(a_{n}-a_{n-1}\right)\left(b_{n}-b_{n-1}\right)<0
$$","Solution. Note that

$$
f(x)-x=\frac{1}{2}>0
$$

if $x<\frac{1}{2}$ and

$$
f(x)-x=x^{2}-x<0
$$

if $x \geqslant \frac{1}{2}$. So if we consider $(0,1)$ as being divided into the two subintervals $I_{1}=\left(0, \frac{1}{2}\right)$ and $I_{2}=\left[\frac{1}{2}, 1\right)$, the inequality

$$
\left(a_{n}-a_{n-1}\right)\left(b_{n}-b_{n-1}\right)=\left(f\left(a_{n-1}\right)-a_{n-1}\right)\left(f\left(b_{n-1}\right)-b_{n-1}\right)<0
$$

holds if and only if $a_{n-1}$ and $b_{n-1}$ lie in distinct subintervals.\\
Let us now assume, to the contrary, that $a_{k}$ and $b_{k}$ always lie in the same subinterval. Consider the distance $d_{k}=\left|a_{k}-b_{k}\right|$. If both $a_{k}$ and $b_{k}$ lie in $I_{1}$, then

$$
d_{k+1}=\left|a_{k+1}-b_{k+1}\right|=\left|a_{k}+\frac{1}{2}-b_{k}-\frac{1}{2}\right|=d_{k}
$$

If, on the other hand, $a_{k}$ and $b_{k}$ both lie in $I_{2}$, then $\min \left(a_{k}, b_{k}\right) \geqslant \frac{1}{2}$ and $\max \left(a_{k}, b_{k}\right)=$ $\min \left(a_{k}, b_{k}\right)+d_{k} \geqslant \frac{1}{2}+d_{k}$, which implies\\
$d_{k+1}=\left|a_{k+1}-b_{k+1}\right|=\left|a_{k}^{2}-b_{k}^{2}\right|=\left|\left(a_{k}-b_{k}\right)\left(a_{k}+b_{k}\right)\right| \geqslant\left|a_{k}-b_{k}\right|\left(\frac{1}{2}+\frac{1}{2}+d_{k}\right)=d_{k}\left(1+d_{k}\right) \geqslant d_{k}$.\\
This means that the difference $d_{k}$ is non-decreasing, and in particular $d_{k} \geqslant d_{0}>0$ for all $k$.\\
We can even say more. If $a_{k}$ and $b_{k}$ lie in $I_{2}$, then

$$
d_{k+2} \geqslant d_{k+1} \geqslant d_{k}\left(1+d_{k}\right) \geqslant d_{k}\left(1+d_{0}\right)
$$

If $a_{k}$ and $b_{k}$ both lie in $I_{1}$, then $a_{k+1}$ and $b_{k+1}$ both lie in $I_{2}$, and so we have

$$
d_{k+2} \geqslant d_{k+1}\left(1+d_{k+1}\right) \geqslant d_{k+1}\left(1+d_{0}\right)=d_{k}\left(1+d_{0}\right)
$$

In either case, $d_{k+2} \geqslant d_{k}\left(1+d_{0}\right)$, and inductively we get

$$
d_{2 m} \geqslant d_{0}\left(1+d_{0}\right)^{m}
$$

For sufficiently large $m$, the right-hand side is greater than 1 , but since $a_{2 m}, b_{2 m}$ both lie in $(0,1)$, we must have $d_{2 m}<1$, a contradiction.

Thus there must be a positive integer $n$ such that $a_{n-1}$ and $b_{n-1}$ do not lie in the same subinterval, which proves the desired statement.",252,3
2014c1,Let $n$ points be given inside a rectangle $R$ such that no two of them lie on a line parallel to one of the sides of $R$. The rectangle $R$ is to be dissected into smaller rectangles with sides parallel to the sides of $R$ in such a way that none of these rectangles contains any of the given points in its interior. Prove that we have to dissect $R$ into at least $n+1$ smaller rectangles.,"Let $k$ be the number of rectangles in the dissection. The set of all points that are corners of one of the rectangles can be divided into three disjoint subsets:

\begin{itemize}
  \item $A$, which consists of the four corners of the original rectangle $R$, each of which is the corner of exactly one of the smaller rectangles,
  \item $B$, which contains points where exactly two of the rectangles have a common corner (T-junctions, see the figure below),
  \item $C$, which contains points where four of the rectangles have a common corner (crossings, see the figure below).\\
\includegraphics[max width=\textwidth, center]{2025_04_30_430645cb6b343bf2b1ddg-27}
\end{itemize}

Figure 1: A T-junction and a crossing

We denote the number of points in $B$ by $b$ and the number of points in $C$ by $c$. Since each of the $k$ rectangles has exactly four corners, we get

$$
4 k=4+2 b+4 c .
$$

It follows that $2 b \leqslant 4 k-4$, so $b \leqslant 2 k-2$.\\
Each of the $n$ given points has to lie on a side of one of the smaller rectangles (but not of the original rectangle $R$ ). If we extend this side as far as possible along borders between rectangles, we obtain a line segment whose ends are T-junctions. Note that every point in $B$ can only be an endpoint of at most one such segment containing one of the given points, since it is stated that no two of them lie on a common line parallel to the sides of $R$. This means that

$$
b \geqslant 2 n .
$$

Combining our two inequalities for $b$, we get

$$
2 k-2 \geqslant b \geqslant 2 n,
$$

thus $k \geqslant n+1$, which is what we wanted to prove.",287,3
2014c2,"We have $2^{m}$ sheets of paper, with the number 1 written on each of them. We perform the following operation. In every step we choose two distinct sheets; if the numbers on the two sheets are $a$ and $b$, then we erase these numbers and write the number $a+b$ on both sheets. Prove that after $m 2^{m-1}$ steps, the sum of the numbers on all the sheets is at least $4^{m}$.","Solution. Let $P_{k}$ be the product of the numbers on the sheets after $k$ steps.\\
Suppose that in the $(k+1)^{\text {th }}$ step the numbers $a$ and $b$ are replaced by $a+b$. In the product, the number $a b$ is replaced by $(a+b)^{2}$, and the other factors do not change. Since $(a+b)^{2} \geqslant 4 a b$, we see that $P_{k+1} \geqslant 4 P_{k}$. Starting with $P_{0}=1$, a straightforward induction yields

$$
P_{k} \geqslant 4^{k}
$$

for all integers $k \geqslant 0$; in particular

$$
P_{m \cdot 2^{m-1}} \geqslant 4^{m \cdot 2^{m-1}}=\left(2^{m}\right)^{2^{m}},
$$

so by the AM-GM inequality, the sum of the numbers written on the sheets after $m 2^{m-1}$ steps is at least

$$
2^{m} \cdot \sqrt[2^{m}]{P_{m \cdot 2^{m-1}}} \geqslant 2^{m} \cdot 2^{m}=4^{m} .
$$

Comment 1. It is possible to achieve the sum $4^{m}$ in $m 2^{m-1}$ steps. For example, starting from $2^{m}$ equal numbers on the sheets, in $2^{m-1}$ consecutive steps we can double all numbers. After $m$ such doubling rounds we have the number $2^{m}$ on every sheet.

Comment 2. There are several versions of the solution above. E.g., one may try to assign to each positive integer $n$ a weight $w_{n}$ in such a way that the sum of the weights of the numbers written on the sheets increases, say, by at least 2 in each step. For this purpose, one needs the inequality


\begin{equation*}
2 w_{a+b} \geqslant w_{a}+w_{b}+2 \tag{1}
\end{equation*}


to be satisfied for all positive integers $a$ and $b$.\\
Starting from $w_{1}=1$ and trying to choose the weights as small as possible, one may find that these weights can be defined as follows: For every positive integer $n$, one chooses $k$ to be the maximal integer such that $n \geqslant 2^{k}$, and puts


\begin{equation*}
w_{n}=k+\frac{n}{2^{k}}=\min _{d \in \mathbb{Z} \geq 0}\left(d+\frac{n}{2^{d}}\right) . \tag{2}
\end{equation*}


Now, in order to prove that these weights satisfy (1), one may take arbitrary positive integers $a$ and $b$, and choose an integer $d \geqslant 0$ such that $w_{a+b}=d+\frac{a+b}{2^{d}}$. Then one has

$$
2 w_{a+b}=2 d+2 \cdot \frac{a+b}{2^{d}}=\left((d-1)+\frac{a}{2^{d-1}}\right)+\left((d-1)+\frac{b}{2^{d-1}}\right)+2 \geqslant w_{a}+w_{b}+2 .
$$

Since the initial sum of the weights was $2^{m}$, after $m 2^{m-1}$ steps the sum is at least $(m+1) 2^{m}$. To finish the solution, one may notice that by (2) for every positive integer $a$ one has


\begin{equation*}
w_{a} \leqslant m+\frac{a}{2^{m}}, \quad \text { i.e., } \quad a \geqslant 2^{m}\left(-m+w_{a}\right) . \tag{3}
\end{equation*}


So the sum of the numbers $a_{1}, a_{2}, \ldots, a_{2^{m}}$ on the sheets can be estimated as

$$
\sum_{i=1}^{2^{m}} a_{i} \geqslant \sum_{i=1}^{2^{m}} 2^{m}\left(-m+w_{a_{i}}\right)=-m 2^{m} \cdot 2^{m}+2^{m} \sum_{i=1}^{2^{m}} w_{a_{i}} \geqslant-m 4^{m}+(m+1) 4^{m}=4^{m},
$$

as required.\\
For establishing the inequalities (1) and (3), one may also use the convexity argument, instead of the second definition of $w_{n}$ in (2).

One may check that $\log _{2} n \leqslant w_{n} \leqslant \log _{2} n+1$; thus, in some rough sense, this approach is obtained by ""taking the logarithm"" of the solution above.

Comment 3. An intuitive strategy to minimise the sum of numbers is that in every step we choose the two smallest numbers. We may call this the greedy strategy. In the following paragraphs we prove that the greedy strategy indeed provides the least possible sum of numbers.

Claim. Starting from any sequence $x_{1}, \ldots, x_{N}$ of positive real numbers on $N$ sheets, for any number $k$ of steps, the greedy strategy achieves the lowest possible sum of numbers.

Proof. We apply induction on $k$; for $k=1$ the statement is obvious. Let $k \geqslant 2$, and assume that the claim is true for smaller values.

Every sequence of $k$ steps can be encoded as $S=\left(\left(i_{1}, j_{1}\right), \ldots,\left(i_{k}, j_{k}\right)\right)$, where, for $r=1,2, \ldots, k$, the numbers $i_{r}$ and $j_{r}$ are the indices of the two sheets that are chosen in the $r^{\text {th }}$ step. The resulting final sum will be some linear combination of $x_{1}, \ldots, x_{N}$, say, $c_{1} x_{1}+\cdots+c_{N} x_{N}$ with positive integers $c_{1}, \ldots, c_{N}$ that depend on $S$ only. Call the numbers $\left(c_{1}, \ldots, c_{N}\right)$ the characteristic vector of $S$.

Choose a sequence $S_{0}=\left(\left(i_{1}, j_{1}\right), \ldots,\left(i_{k}, j_{k}\right)\right)$ of steps that produces the minimal sum, starting from $x_{1}, \ldots, x_{N}$, and let $\left(c_{1}, \ldots, c_{N}\right)$ be the characteristic vector of $S$. We may assume that the sheets are indexed in such an order that $c_{1} \geqslant c_{2} \geqslant \cdots \geqslant c_{N}$. If the sheets (and the numbers) are permuted by a permutation $\pi$ of the indices $(1,2, \ldots, N)$ and then the same steps are performed, we can obtain the sum $\sum_{t=1}^{N} c_{t} x_{\pi(t)}$. By the rearrangement inequality, the smallest possible sum can be achieved when the numbers $\left(x_{1}, \ldots, x_{N}\right)$ are in non-decreasing order. So we can assume that also $x_{1} \leqslant x_{2} \leqslant \cdots \leqslant x_{N}$.

Let $\ell$ be the largest index with $c_{1}=\cdots=c_{\ell}$, and let the $r^{\text {th }}$ step be the first step for which $c_{i_{r}}=c_{1}$ or $c_{j_{r}}=c_{1}$. The role of $i_{r}$ and $j_{r}$ is symmetrical, so we can assume $c_{i_{r}}=c_{1}$ and thus $i_{r} \leqslant \ell$. We show that $c_{j_{r}}=c_{1}$ and $j_{r} \leqslant \ell$ hold, too.

Before the $r^{\text {th }}$ step, on the $i_{r}{ }^{\text {th }}$ sheet we had the number $x_{i_{r}}$. On the $j_{r}{ }^{\text {th }}$ sheet there was a linear combination that contains the number $x_{j_{r}}$ with a positive integer coefficient, and possibly some other terms. In the $r^{\text {th }}$ step, the number $x_{i_{r}}$ joins that linear combination. From this point, each sheet contains a linear combination of $x_{1}, \ldots, x_{N}$, with the coefficient of $x_{j_{r}}$ being not smaller than the coefficient of $x_{i_{r}}$. This is preserved to the end of the procedure, so we have $c_{j_{r}} \geqslant c_{i_{r}}$. But $c_{i_{r}}=c_{1}$ is maximal among the coefficients, so we have $c_{j_{r}}=c_{i_{r}}=c_{1}$ and thus $j_{r} \leqslant \ell$.

Either from $c_{j_{r}}=c_{i_{r}}=c_{1}$ or from the arguments in the previous paragraph we can see that none of the $i_{r}{ }^{\text {th }}$ and the $j_{r}{ }^{\text {th }}$ sheets were used before step $r$. Therefore, the final linear combination of the numbers does not change if the step $\left(i_{r}, j_{r}\right)$ is performed first: the sequence of steps

$$
S_{1}=\left(\left(i_{r}, j_{r}\right),\left(i_{1}, j_{1}\right), \ldots,\left(i_{r-1}, j_{r-1}\right),\left(i_{r+1}, j_{r+1}\right), \ldots,\left(i_{N}, j_{N}\right)\right)
$$

also produces the same minimal sum at the end. Therefore, we can replace $S_{0}$ by $S_{1}$ and we may assume that $r=1$ and $c_{i_{1}}=c_{j_{1}}=c_{1}$.

As $i_{1} \neq j_{1}$, we can see that $\ell \geqslant 2$ and $c_{1}=c_{2}=c_{i_{1}}=c_{j_{1}}$. Let $\pi$ be such a permutation of the indices $(1,2, \ldots, N)$ that exchanges 1,2 with $i_{r}, j_{r}$ and does not change the remaining indices. Let

$$
S_{2}=\left(\left(\pi\left(i_{1}\right), \pi\left(j_{1}\right)\right), \ldots,\left(\pi\left(i_{N}\right), \pi\left(j_{N}\right)\right)\right)
$$

Since $c_{\pi(i)}=c_{i}$ for all indices $i$, this sequence of steps produces the same, minimal sum. Moreover, in the first step we chose $x_{\pi\left(i_{1}\right)}=x_{1}$ and $x_{\pi\left(j_{1}\right)}=x_{2}$, the two smallest numbers.

Hence, it is possible to achieve the optimal sum if we follow the greedy strategy in the first step. By the induction hypothesis, following the greedy strategy in the remaining steps we achieve the optimal sum.",1148,4
2014c5,"Consider $n \geqslant 3$ lines in the plane such that no two lines are parallel and no three have a common point. These lines divide the plane into polygonal regions; let $\mathcal{F}$ be the set of regions having finite area. Prove that it is possible to colour $\lceil\sqrt{n / 2}\rceil$ of the lines blue in such a way that no region in $\mathcal{F}$ has a completely blue boundary. (For a real number $x,\lceil x\rceil$ denotes the least integer which is not smaller than $x$.)","Solution. Let $L$ be the given set of lines. Choose a maximal (by inclusion) subset $B \subseteq L$ such that when we colour the lines of $B$ blue, no region in $\mathcal{F}$ has a completely blue boundary. Let $|B|=k$. We claim that $k \geqslant\lceil\sqrt{n / 2}\rceil$.

Let us colour all the lines of $L \backslash B$ red. Call a point blue if it is the intersection of two blue lines. Then there are $\binom{k}{2}$ blue points.

Now consider any red line $\ell$. By the maximality of $B$, there exists at least one region $A \in \mathcal{F}$ whose only red side lies on $\ell$. Since $A$ has at least three sides, it must have at least one blue vertex. Let us take one such vertex and associate it to $\ell$.

Since each blue point belongs to four regions (some of which may be unbounded), it is associated to at most four red lines. Thus the total number of red lines is at most $4\binom{k}{2}$. On the other hand, this number is $n-k$, so

$$
n-k \leqslant 2 k(k-1), \quad \text { thus } \quad n \leqslant 2 k^{2}-k \leqslant 2 k^{2},
$$

and finally $k \geqslant\lceil\sqrt{n / 2}\rceil$, which gives the desired result.\\
Comment 1. The constant factor in the estimate can be improved in different ways; we sketch two of them below. On the other hand, the Problem Selection Committee is not aware of any results showing that it is sometimes impossible to colour $k$ lines satisfying the desired condition for $k \gg \sqrt{n}$. In this situation we find it more suitable to keep the original formulation of the problem.

\begin{enumerate}
  \item Firstly, we show that in the proof above one has in fact $k=|B| \geqslant\lceil\sqrt{2 n / 3}\rceil$.
\end{enumerate}

Let us make weighted associations as follows. Let a region $A$ whose only red side lies on $\ell$ have $k$ vertices, so that $k-2$ of them are blue. We associate each of these blue vertices to $\ell$, and put the weight $\frac{1}{k-2}$ on each such association. So the sum of the weights of all the associations is exactly $n-k$.

Now, one may check that among the four regions adjacent to a blue vertex $v$, at most two are triangles. This means that the sum of the weights of all associations involving $v$ is at most $1+1+\frac{1}{2}+\frac{1}{2}=3$. This leads to the estimate

$$
n-k \leqslant 3\binom{k}{2}
$$

or

$$
2 n \leqslant 3 k^{2}-k<3 k^{2},
$$

which yields $k \geqslant\lceil\sqrt{2 n / 3}\rceil$.\\
2. Next, we even show that $k=|B| \geqslant\lceil\sqrt{n}\rceil$. For this, we specify the process of associating points to red lines in one more different way.

Call a point red if it lies on a red line as well as on a blue line. Consider any red line $\ell$, and take an arbitrary region $A \in \mathcal{F}$ whose only red side lies on $\ell$. Let $r^{\prime}, r, b_{1}, \ldots, b_{k}$ be its vertices in clockwise order with $r^{\prime}, r \in \ell$; then the points $r^{\prime}, r$ are red, while all the points $b_{1}, \ldots, b_{k}$ are blue. Let us associate to $\ell$ the red point $r$ and the blue point $b_{1}$. One may notice that to each pair of a red point $r$ and a blue point $b$, at most one red line can be associated, since there is at most one region $A$ having $r$ and $b$ as two clockwise consecutive vertices.

We claim now that at most two red lines are associated to each blue point $b$; this leads to the desired bound

$$
n-k \leqslant 2\binom{k}{2} \quad \Longleftrightarrow \quad n \leqslant k^{2} .
$$

Assume, to the contrary, that three red lines $\ell_{1}, \ell_{2}$, and $\ell_{3}$ are associated to the same blue point $b$. Let $r_{1}, r_{2}$, and $r_{3}$ respectively be the red points associated to these lines; all these points are distinct. The point $b$ defines four blue rays, and each point $r_{i}$ is the red point closest to $b$ on one of these rays. So we may assume that the points $r_{2}$ and $r_{3}$ lie on one blue line passing through $b$, while $r_{1}$ lies on the other one.\\
\includegraphics[max width=\textwidth, center]{2025_04_30_430645cb6b343bf2b1ddg-36}

Now consider the region $A$ used to associate $r_{1}$ and $b$ with $\ell_{1}$. Three of its clockwise consecutive vertices are $r_{1}, b$, and either $r_{2}$ or $r_{3}\left(\right.$ say, $\left.r_{2}\right)$. Since $A$ has only one red side, it can only be the triangle $r_{1} b r_{2}$; but then both $\ell_{1}$ and $\ell_{2}$ pass through $r_{2}$, as well as some blue line. This is impossible by the problem assumptions.

Comment 2. The condition that the lines be non-parallel is essentially not used in the solution, nor in the previous comment; thus it may be omitted.",781,4
2014c7,"Let $M$ be a set of $n \geqslant 4$ points in the plane, no three of which are collinear. Initially these points are connected with $n$ segments so that each point in $M$ is the endpoint of exactly two segments. Then, at each step, one may choose two segments $A B$ and $C D$ sharing a common interior point and replace them by the segments $A C$ and $B D$ if none of them is present at this moment. Prove that it is impossible to perform $n^{3} / 4$ or more such moves.","Solution. A line is said to be red if it contains two points of $M$. As no three points of $M$ are collinear, each red line determines a unique pair of points of $M$. Moreover, there are precisely $\binom{n}{2}<\frac{n^{2}}{2}$ red lines. By the value of a segment we mean the number of red lines intersecting it in its interior, and the value of a set of segments is defined to be the sum of the values of its elements. We will prove that $(i)$ the value of the initial set of segments is smaller than $n^{3} / 2$ and that (ii) each step decreases the value of the set of segments present by at least 2 . Since such a value can never be negative, these two assertions imply the statement of the problem.

To show $(i)$ we just need to observe that each segment has a value that is smaller than $n^{2} / 2$. Thus the combined value of the $n$ initial segments is indeed below $n \cdot n^{2} / 2=n^{3} / 2$.

It remains to establish (ii). Suppose that at some moment we have two segments $A B$ and $C D$ sharing an interior point $S$, and that at the next moment we have the two segments $A C$ and $B D$ instead. Let $X_{A B}$ denote the set of red lines intersecting the segment $A B$ in its interior and let the sets $X_{A C}, X_{B D}$, and $X_{C D}$ be defined similarly. We are to prove that $\left|X_{A C}\right|+\left|X_{B D}\right|+2 \leqslant\left|X_{A B}\right|+\left|X_{C D}\right|$.

As a first step in this direction, we claim that


\begin{equation*}
\left|X_{A C} \cup X_{B D}\right|+2 \leqslant\left|X_{A B} \cup X_{C D}\right| . \tag{1}
\end{equation*}


Indeed, if $g$ is a red line intersecting, e.g. the segment $A C$ in its interior, then it has to intersect the triangle $A C S$ once again, either in the interior of its side $A S$, or in the interior of its side $C S$, or at $S$, meaning that it belongs to $X_{A B}$ or to $X_{C D}$ (see Figure 1). Moreover, the red lines $A B$ and $C D$ contribute to $X_{A B} \cup X_{C D}$ but not to $X_{A C} \cup X_{B D}$. Thereby (1) is proved.\\
\includegraphics[max width=\textwidth, center]{2025_04_30_430645cb6b343bf2b1ddg-41(2)}

Figure 1\\
\includegraphics[max width=\textwidth, center]{2025_04_30_430645cb6b343bf2b1ddg-41}

Figure 2\\
\includegraphics[max width=\textwidth, center]{2025_04_30_430645cb6b343bf2b1ddg-41(1)}

Figure 3

Similarly but more easily one obtains


\begin{equation*}
\left|X_{A C} \cap X_{B D}\right| \leqslant\left|X_{A B} \cap X_{C D}\right| . \tag{2}
\end{equation*}


Indeed, a red line $h$ appearing in $X_{A C} \cap X_{B D}$ belongs, for similar reasons as above, also to $X_{A B} \cap X_{C D}$. To make the argument precise, one may just distinguish the cases $S \in h$ (see Figure 2) and $S \notin h$ (see Figure 3). Thereby (2) is proved.

Adding (1) and (2) we obtain the desired conclusion, thus completing the solution of this problem.

Comment 1. There is a problem belonging to the folklore, in the solution of which one may use the same kind of operation:

Given $n$ red and $n$ green points in the plane, prove that one may draw n nonintersecting segments each of which connects a red point with a green point.

A standard approach to this problem consists in taking $n$ arbitrary segments connecting the red points with the green points, and to perform the same operation as in the above proposal whenever an intersection occurs. Now each time one performs such a step, the total length of the segments that are present decreases due to the triangle inequality. So, as there are only finitely many possibilities for the set of segments present, the process must end at some stage.

In the above proposal, however, considering the sum of the Euclidean lengths of the segment that are present does not seem to help much, for even though it shows that the process must necessarily terminate after some finite number of steps, it does not seem to easily yield any upper bound on the number of these steps that grows polynomially with $n$.

One may regard the concept of the value of a segment introduced in the above solution as an appropriately discretised version of Euclidean length suitable for obtaining such a bound.

The Problem Selection Committee still believes the problem to be sufficiently original for the competition.

Comment 2. There are some other essentially equivalent ways of presenting the same solution. E.g., put $M=\left\{A_{1}, A_{2}, \ldots, A_{n}\right\}$, denote the set of segments present at any moment by $\left\{e_{1}, e_{2}, \ldots, e_{n}\right\}$, and called a triple $(i, j, k)$ of indices with $i \neq j$ intersecting, if the line $A_{i} A_{j}$ intersects the segment $e_{k}$. It may then be shown that the number $S$ of intersecting triples satisfies $0 \leqslant S<n^{3}$ at the beginning and decreases by at least 4 in each step.

Comment 3. It is not difficult to construct an example where $c n^{2}$ moves are possible (for some absolute constant $c>0$ ). It would be interesting to say more about the gap between $c n^{2}$ and $c n^{3}$.",837,4
2014c9,"There are $n$ circles drawn on a piece of paper in such a way that any two circles intersect in two points, and no three circles pass through the same point. Turbo the snail slides along the circles in the following fashion. Initially he moves on one of the circles in clockwise direction. Turbo always keeps sliding along the current circle until he reaches an intersection with another circle. Then he continues his journey on this new circle and also changes the direction of moving, i.e. from clockwise to anticlockwise or vice versa.

Suppose that Turbo's path entirely covers all circles. Prove that $n$ must be odd.","Replace every cross (i.e. intersection of two circles) by two small circle arcs that indicate the direction in which the snail should leave the cross (see Figure 1.1). Notice that the placement of the small arcs does not depend on the direction of moving on the curves; no matter which direction the snail is moving on the circle arcs, he will follow the same curves (see Figure 1.2). In this way we have a set of curves, that are the possible paths of the snail. Call these curves snail orbits or just orbits. Every snail orbit is a simple closed curve that has no intersection with any other orbit.\\

We prove the following, more general statement.\\
(*) In any configuration of $n$ circles such that no two of them are tangent, the number of snail orbits has the same parity as the number $n$. (Note that it is not assumed that all circle pairs intersect.)

This immediately solves the problem.\\
Let us introduce the following operation that will be called flipping a cross. At a cross, remove the two small arcs of the orbits, and replace them by the other two arcs. Hence, when the snail arrives at a flipped cross, he will continue on the other circle as before, but he will preserve the orientation in which he goes along the circle arcs (see Figure 2).\\

Consider what happens to the number of orbits when a cross is flipped. Denote by $a, b, c$, and $d$ the four arcs that meet at the cross such that $a$ and $b$ belong to the same circle. Before the flipping $a$ and $b$ were connected to $c$ and $d$, respectively, and after the flipping $a$ and $b$ are connected to $d$ and $c$, respectively.

The orbits passing through the cross are closed curves, so each of the arcs $a, b, c$, and $d$ is connected to another one by orbits outside the cross. We distinguish three cases.

Case 1: $a$ is connected to $b$ and $c$ is connected to $d$ by the orbits outside the cross (see Figure 3.1).

We show that this case is impossible. Remove the two small arcs at the cross, connect $a$ to $b$, and connect $c$ to $d$ at the cross. Let $\gamma$ be the new closed curve containing $a$ and $b$, and let $\delta$ be the new curve that connects $c$ and $d$. These two curves intersect at the cross. So one of $c$ and $d$ is inside $\gamma$ and the other one is outside $\gamma$. Then the two closed curves have to meet at least one more time, but this is a contradiction, since no orbit can intersect itself.\\

Case 2: $a$ is connected to $c$ and $b$ is connected to $d$ (see Figure 3.2).\\
Before the flipping $a$ and $c$ belong to one orbit and $b$ and $d$ belong to another orbit. Flipping the cross merges the two orbits into a single orbit. Hence, the number of orbits decreases by 1.

Case 3: $a$ is connected to $d$ and $b$ is connected to $c$ (see Figure 3.3).\\
Before the flipping the arcs $a, b, c$, and $d$ belong to a single orbit. Flipping the cross splits that orbit in two. The number of orbits increases by 1.

As can be seen, every flipping decreases or increases the number of orbits by one, thus changes its parity.

Now flip every cross, one by one. Since every pair of circles has 0 or 2 intersections, the number of crosses is even. Therefore, when all crosses have been flipped, the original parity of the number of orbits is restored. So it is sufficient to prove $(*)$ for the new configuration, where all crosses are flipped. Of course also in this new configuration the (modified) orbits are simple closed curves not intersecting each other.

Orient the orbits in such a way that the snail always moves anticlockwise along the circle arcs. Figure 4 shows the same circles as in Figure 1 after flipping all crosses and adding orientation. (Note that this orientation may be different from the orientation of the orbit as a planar curve; the orientation of every orbit may be negative as well as positive, like the middle orbit in Figure 4.) If the snail moves around an orbit, the total angle change in his moving direction, the total curvature, is either $+2 \pi$ or $-2 \pi$, depending on the orientation of the orbit. Let $P$ and $N$ be the number of orbits with positive and negative orientation, respectively. Then the total curvature of all orbits is $(P-N) \cdot 2 \pi$.\\

Double-count the total curvature of all orbits. Along every circle the total curvature is $2 \pi$. At every cross, the two turnings make two changes with some angles having the same absolute value but opposite signs, as depicted in Figure 5. So the changes in the direction at the crosses cancel out. Hence, the total curvature is $n \cdot 2 \pi$.

Now we have $(P-N) \cdot 2 \pi=n \cdot 2 \pi$, so $P-N=n$. The number of (modified) orbits is $P+N$, that has a same parity as $P-N=n$.
",852,4
2014g1,"The points $P$ and $Q$ are chosen on the side $B C$ of an acute-angled triangle $A B C$ so that $\angle P A B=\angle A C B$ and $\angle Q A C=\angle C B A$. The points $M$ and $N$ are taken on the rays $A P$ and $A Q$, respectively, so that $A P=P M$ and $A Q=Q N$. Prove that the lines $B M$ and $C N$ intersect on the circumcircle of the triangle $A B C$.","Denote by $S$ the intersection point of the lines $B M$ and $C N$. Let moreover $\beta=\angle Q A C=\angle C B A$ and $\gamma=\angle P A B=\angle A C B$. From these equalities it follows that the triangles $A B P$ and $C A Q$ are similar. Therefore we obtain

$$
\frac{B P}{P M}=\frac{B P}{P A}=\frac{A Q}{Q C}=\frac{N Q}{Q C} .
$$

Moreover,

$$
\angle B P M=\beta+\gamma=\angle C Q N .
$$

Hence the triangles $B P M$ and $N Q C$ are similar. This gives $\angle B M P=\angle N C Q$, so the triangles $B P M$ and $B S C$ are also similar. Thus we get

$$
\angle C S B=\angle B P M=\beta+\gamma=180^{\circ}-\angle B A C,
$$

which completes the solution.\\",127,2
2014g2,"Let $A B C$ be a triangle. The points $K, L$, and $M$ lie on the segments $B C, C A$, and $A B$, respectively, such that the lines $A K, B L$, and $C M$ intersect in a common point. Prove that it is possible to choose two of the triangles $A L M, B M K$, and $C K L$ whose inradii sum up to at least the inradius of the triangle $A B C$.","Solution. Denote

$$
a=\frac{B K}{K C}, \quad b=\frac{C L}{L A}, \quad c=\frac{A M}{M B} .
$$

By Ceva's theorem, $a b c=1$, so we may, without loss of generality, assume that $a \geqslant 1$. Then at least one of the numbers $b$ or $c$ is not greater than 1 . Therefore at least one of the pairs $(a, b)$, $(b, c)$ has its first component not less than 1 and the second one not greater than 1 . Without loss of generality, assume that $1 \leqslant a$ and $b \leqslant 1$.

Therefore, we obtain $b c \leqslant 1$ and $1 \leqslant c a$, or equivalently

$$
\frac{A M}{M B} \leqslant \frac{L A}{C L} \quad \text { and } \quad \frac{M B}{A M} \leqslant \frac{B K}{K C} .
$$

The first inequality implies that the line passing through $M$ and parallel to $B C$ intersects the segment $A L$ at a point $X$ (see Figure 1). Therefore the inradius of the triangle $A L M$ is not less than the inradius $r_{1}$ of triangle $A M X$.

Similarly, the line passing through $M$ and parallel to $A C$ intersects the segment $B K$ at a point $Y$, so the inradius of the triangle $B M K$ is not less than the inradius $r_{2}$ of the triangle $B M Y$. Thus, to complete our solution, it is enough to show that $r_{1}+r_{2} \geqslant r$, where $r$ is the inradius of the triangle $A B C$. We prove that in fact $r_{1}+r_{2}=r$.\\
\includegraphics[max width=\textwidth, center]{2025_04_30_430645cb6b343bf2b1ddg-52}

Figure 1\\
Since $M X \| B C$, the dilation with centre $A$ that takes $M$ to $B$ takes the incircle of the triangle $A M X$ to the incircle of the triangle $A B C$. Therefore

$$
\frac{r_{1}}{r}=\frac{A M}{A B}, \quad \text { and similarly } \quad \frac{r_{2}}{r}=\frac{M B}{A B} .
$$

Adding these equalities gives $r_{1}+r_{2}=r$, as required.\\
Comment. Alternatively, one can use Desargues' theorem instead of Ceva's theorem, as follows: The lines $A B, B C, C A$ dissect the plane into seven regions. One of them is bounded, and amongst the other six, three are two-sided and three are three-sided. Now define the points $P=B C \cap L M$, $Q=C A \cap M K$, and $R=A B \cap K L$ (in the projective plane). By Desargues' theorem, the points $P$, $Q, R$ lie on a common line $\ell$. This line intersects only unbounded regions. If we now assume (without loss of generality) that $P, Q$ and $R$ lie on $\ell$ in that order, then one of the segments $P Q$ or $Q R$ lies inside a two-sided region. If, for example, this segment is $P Q$, then the triangles $A L M$ and $B M K$ will satisfy the statement of the problem for the same reason.",463,3
2014g3,"Let $\Omega$ and $O$ be the circumcircle and the circumcentre of an acute-angled triangle $A B C$ with $A B>B C$. The angle bisector of $\angle A B C$ intersects $\Omega$ at $M \neq B$. Let $\Gamma$ be the circle with diameter $B M$. The angle bisectors of $\angle A O B$ and $\angle B O C$ intersect $\Gamma$ at points $P$ and $Q$, respectively. The point $R$ is chosen on the line $P Q$ so that $B R=M R$. Prove that $B R \| A C$. (Here we always assume that an angle bisector is a ray.)","Solution. Let $K$ be the midpoint of $B M$, i.e., the centre of $\Gamma$. Notice that $A B \neq B C$ implies $K \neq O$. Clearly, the lines $O M$ and $O K$ are the perpendicular bisectors of $A C$ and $B M$, respectively. Therefore, $R$ is the intersection point of $P Q$ and $O K$.

Let $N$ be the second point of intersection of $\Gamma$ with the line $O M$. Since $B M$ is a diameter of $\Gamma$, the lines $B N$ and $A C$ are both perpendicular to $O M$. Hence $B N \| A C$, and it suffices to prove that $B N$ passes through $R$. Our plan for doing this is to interpret the lines $B N, O K$, and $P Q$ as the radical axes of three appropriate circles.

Let $\omega$ be the circle with diameter $B O$. Since $\angle B N O=\angle B K O=90^{\circ}$, the points $N$ and $K$ lie on $\omega$.

Next we show that the points $O, K, P$, and $Q$ are concyclic. To this end, let $D$ and $E$ be the midpoints of $B C$ and $A B$, respectively. Clearly, $D$ and $E$ lie on the rays $O Q$ and $O P$, respectively. By our assumptions about the triangle $A B C$, the points $B, E, O, K$, and $D$ lie in this order on $\omega$. It follows that $\angle E O R=\angle E B K=\angle K B D=\angle K O D$, so the line $K O$ externally bisects the angle $P O Q$. Since the point $K$ is the centre of $\Gamma$, it also lies on the perpendicular bisector of $P Q$. So $K$ coincides with the midpoint of the arc $P O Q$ of the circumcircle $\gamma$ of triangle $P O Q$.

Thus the lines $O K, B N$, and $P Q$ are pairwise radical axes of the circles $\omega, \gamma$, and $\Gamma$. Hence they are concurrent at $R$, as required.",323,3
2014g4,"Consider a fixed circle $\Gamma$ with three fixed points $A, B$, and $C$ on it. Also, let us fix a real number $\lambda \in(0,1)$. For a variable point $P \notin\{A, B, C\}$ on $\Gamma$, let $M$ be the point on the segment $C P$ such that $C M=\lambda \cdot C P$. Let $Q$ be the second point of intersection of the circumcircles of the triangles $A M P$ and $B M C$. Prove that as $P$ varies, the point $Q$ lies on a fixed circle.","Throughout the solution, we denote by $\Varangle(a, b)$ the directed angle between the lines $a$ and $b$.

Let $D$ be the point on the segment $A B$ such that $B D=\lambda \cdot B A$. We will show that either $Q=D$, or $\Varangle(D Q, Q B)=\Varangle(A B, B C)$; this would mean that the point $Q$ varies over the constant circle through $D$ tangent to $B C$ at $B$, as required.

Denote the circumcircles of the triangles $A M P$ and $B M C$ by $\omega_{A}$ and $\omega_{B}$, respectively. The lines $A P, B C$, and $M Q$ are pairwise radical axes of the circles $\Gamma, \omega_{A}$, and $\omega_{B}$, thus either they are parallel, or they share a common point $X$.

Assume that these lines are parallel (see Figure 1). Then the segments $A P, Q M$, and $B C$ have a common perpendicular bisector; the reflection in this bisector maps the segment $C P$ to $B A$, and maps $M$ to $Q$. Therefore, in this case $Q$ lies on $A B$, and $B Q / A B=C M / C P=$ $B D / A B$; so we have $Q=D$.\\

Now assume that the lines $A P, Q M$, and $B C$ are concurrent at some point $X$ (see Figure 2). Notice that the points $A, B, Q$, and $X$ lie on a common circle $\Omega$ by Miquel's theorem applied to the triangle $X P C$. Let us denote by $Y$ the symmetric image of $X$ about the perpendicular bisector of $A B$. Clearly, $Y$ lies on $\Omega$, and the triangles $Y A B$ and $\triangle X B A$ are congruent. Moreover, the triangle $X P C$ is similar to the triangle $X B A$, so it is also similar to the triangle $Y A B$.

Next, the points $D$ and $M$ correspond to each other in similar triangles $Y A B$ and $X P C$, since $B D / B A=C M / C P=\lambda$. Moreover, the triangles $Y A B$ and $X P C$ are equi-oriented, so $\Varangle(M X, X P)=\Varangle(D Y, Y A)$. On the other hand, since the points $A, Q, X$, and $Y$ lie on $\Omega$, we have $\Varangle(Q Y, Y A)=\Varangle(M X, X P)$. Therefore, $\Varangle(Q Y, Y A)=\Varangle(D Y, Y A)$, so the points $Y, D$, and $Q$ are collinear.

Finally, we have $\Varangle(D Q, Q B)=\Varangle(Y Q, Q B)=\Varangle(Y A, A B)=\Varangle(A B, B X)=\Varangle(A B, B C)$, as desired.
",408,3
2014g5,"Let $A B C D$ be a convex quadrilateral with $\angle B=\angle D=90^{\circ}$. Point $H$ is the foot of the perpendicular from $A$ to $B D$. The points $S$ and $T$ are chosen on the sides $A B$ and $A D$, respectively, in such a way that $H$ lies inside triangle $S C T$ and

$$
\angle S H C-\angle B S C=90^{\circ}, \quad \angle T H C-\angle D T C=90^{\circ} .
$$

Prove that the circumcircle of triangle $S H T$ is tangent to the line $B D$.","Solution. Let the line passing through $C$ and perpendicular to the line $S C$ intersect the line $A B$ at $Q$ (see Figure 1). Then

$$
\angle S Q C=90^{\circ}-\angle B S C=180^{\circ}-\angle S H C,
$$

which implies that the points $C, H, S$, and $Q$ lie on a common circle. Moreover, since $S Q$ is a diameter of this circle, we infer that the circumcentre $K$ of triangle $S H C$ lies on the line $A B$. Similarly, we prove that the circumcentre $L$ of triangle $C H T$ lies on the line $A D$.\\
\includegraphics[max width=\textwidth, center]{2025_04_30_430645cb6b343bf2b1ddg-57}

Figure 1\\
In order to prove that the circumcircle of triangle $S H T$ is tangent to $B D$, it suffices to show that the perpendicular bisectors of $H S$ and $H T$ intersect on the line $A H$. However, these two perpendicular bisectors coincide with the angle bisectors of angles $A K H$ and $A L H$. Therefore, in order to complete the solution, it is enough (by the bisector theorem) to show that


\begin{equation*}
\frac{A K}{K H}=\frac{A L}{L H} . \tag{1}
\end{equation*}


We present two proofs of this equality.\\
First proof. Let the lines $K L$ and $H C$ intersect at $M$ (see Figure 2). Since $K H=K C$ and $L H=L C$, the points $H$ and $C$ are symmetric to each other with respect to the line $K L$. Therefore $M$ is the midpoint of $H C$. Denote by $O$ the circumcentre of quadrilateral $A B C D$. Then $O$ is the midpoint of $A C$. Therefore we have $O M \| A H$ and hence $O M \perp B D$. This together with the equality $O B=O D$ implies that $O M$ is the perpendicular bisector of $B D$ and therefore $B M=D M$.

Since $C M \perp K L$, the points $B, C, M$, and $K$ lie on a common circle with diameter $K C$. Similarly, the points $L, C, M$, and $D$ lie on a circle with diameter $L C$. Thus, using the sine law, we obtain

$$
\frac{A K}{A L}=\frac{\sin \angle A L K}{\sin \angle A K L}=\frac{D M}{C L} \cdot \frac{C K}{B M}=\frac{C K}{C L}=\frac{K H}{L H},
$$

which finishes the proof of (1).\\
\includegraphics[max width=\textwidth, center]{2025_04_30_430645cb6b343bf2b1ddg-58(1)}

Figure 2\\
\includegraphics[max width=\textwidth, center]{2025_04_30_430645cb6b343bf2b1ddg-58}

Figure 3

Second proof. If the points $A, H$, and $C$ are collinear, then $A K=A L$ and $K H=L H$, so the equality (1) follows. Assume therefore that the points $A, H$, and $C$ do not lie in a line and consider the circle $\omega$ passing through them (see Figure 3). Since the quadrilateral $A B C D$ is cyclic,

$$
\angle B A C=\angle B D C=90^{\circ}-\angle A D H=\angle H A D
$$

Let $N \neq A$ be the intersection point of the circle $\omega$ and the angle bisector of $\angle C A H$. Then $A N$ is also the angle bisector of $\angle B A D$. Since $H$ and $C$ are symmetric to each other with respect to the line $K L$ and $H N=N C$, it follows that both $N$ and the centre of $\omega$ lie on the line $K L$. This means that the circle $\omega$ is an Apollonius circle of the points $K$ and $L$. This immediately yields (1).

Comment. Either proof can be used to obtain the following generalised result:\\
Let $A B C D$ be a convex quadrilateral and let $H$ be a point in its interior with $\angle B A C=\angle D A H$. The points $S$ and $T$ are chosen on the sides $A B$ and $A D$, respectively, in such a way that $H$ lies inside triangle SCT and

$$
\angle S H C-\angle B S C=90^{\circ}, \quad \angle T H C-\angle D T C=90^{\circ} .
$$

Then the circumcentre of triangle SHT lies on the line AH (and moreover the circumcentre of triangle SCT lies on $A C$ ).",652,4
2014g6,"Let $A B C$ be a fixed acute-angled triangle. Consider some points $E$ and $F$ lying on the sides $A C$ and $A B$, respectively, and let $M$ be the midpoint of $E F$. Let the perpendicular bisector of $E F$ intersect the line $B C$ at $K$, and let the perpendicular bisector of $M K$ intersect the lines $A C$ and $A B$ at $S$ and $T$, respectively. We call the pair $(E, F)$ interesting, if the quadrilateral $K S A T$ is cyclic.

Suppose that the pairs $\left(E_{1}, F_{1}\right)$ and $\left(E_{2}, F_{2}\right)$ are interesting. Prove that

$$
\frac{E_{1} E_{2}}{A B}=\frac{F_{1} F_{2}}{A C} .
$$","For any interesting pair $(E, F)$, we will say that the corresponding triangle $E F K$ is also interesting.

Let $E F K$ be an interesting triangle. Firstly, we prove that $\angle K E F=\angle K F E=\angle A$, which also means that the circumcircle $\omega_{1}$ of the triangle $A E F$ is tangent to the lines $K E$ and $K F$.

Denote by $\omega$ the circle passing through the points $K, S, A$, and $T$. Let the line $A M$ intersect the line $S T$ and the circle $\omega$ (for the second time) at $N$ and $L$, respectively (see Figure 1).

Since $E F \| T S$ and $M$ is the midpoint of $E F, N$ is the midpoint of $S T$. Moreover, since $K$ and $M$ are symmetric to each other with respect to the line $S T$, we have $\angle K N S=\angle M N S=$ $\angle L N T$. Thus the points $K$ and $L$ are symmetric to each other with respect to the perpendicular bisector of $S T$. Therefore $K L \| S T$.

Let $G$ be the point symmetric to $K$ with respect to $N$. Then $G$ lies on the line $E F$, and we may assume that it lies on the ray $M F$. One has

$$
\angle K G E=\angle K N S=\angle S N M=\angle K L A=180^{\circ}-\angle K S A
$$

(if $K=L$, then the angle $K L A$ is understood to be the angle between $A L$ and the tangent to $\omega$ at $L$ ). This means that the points $K, G, E$, and $S$ are concyclic. Now, since $K S G T$ is a parallelogram, we obtain $\angle K E F=\angle K S G=180^{\circ}-\angle T K S=\angle A$. Since $K E=K F$, we also have $\angle K F E=\angle K E F=\angle A$.

After having proved this fact, one may finish the solution by different methods.\\

First method. We have just proved that all interesting triangles are similar to each other. This allows us to use the following lemma.

Lemma. Let $A B C$ be an arbitrary triangle. Choose two points $E_{1}$ and $E_{2}$ on the side $A C$, two points $F_{1}$ and $F_{2}$ on the side $A B$, and two points $K_{1}$ and $K_{2}$ on the side $B C$, in a way that the triangles $E_{1} F_{1} K_{1}$ and $E_{2} F_{2} K_{2}$ are similar. Then the six circumcircles of the triangles $A E_{i} F_{i}$, $B F_{i} K_{i}$, and $C E_{i} K_{i}(i=1,2)$ meet at a common point $Z$. Moreover, $Z$ is the centre of the spiral similarity that takes the triangle $E_{1} F_{1} K_{1}$ to the triangle $E_{2} F_{2} K_{2}$.\\
Proof. Firstly, notice that for each $i=1,2$, the circumcircles of the triangles $A E_{i} F_{i}, B F_{i} K_{i}$, and $C K_{i} E_{i}$ have a common point $Z_{i}$ by MiquEL's theorem. Moreover, we have\\
$\npreceq\left(Z_{i} F_{i}, Z_{i} E_{i}\right)=\nsucceq(A B, C A), \quad \nsucceq\left(Z_{i} K_{i}, Z_{i} F_{i}\right)=\npreceq(B C, A B), \quad \nsucceq\left(Z_{i} E_{i}, Z_{i} K_{i}\right)=\npreceq(C A, B C)$.\\
This yields that the points $Z_{1}$ and $Z_{2}$ correspond to each other in similar triangles $E_{1} F_{1} K_{1}$ and $E_{2} F_{2} K_{2}$. Thus, if they coincide, then this common point is indeed the desired centre of a spiral similarity.

Finally, in order to show that $Z_{1}=Z_{2}$, one may notice that $\Varangle\left(A B, A Z_{1}\right)=\Varangle\left(E_{1} F_{1}, E_{1} Z_{1}\right)=$ $\Varangle\left(E_{2} F_{2}, E_{2} Z_{2}\right)=\Varangle\left(A B, A Z_{2}\right)$ (see Figure 2). Similarly, one has $\Varangle\left(B C, B Z_{1}\right)=\Varangle\left(B C, B Z_{2}\right)$ and $\Varangle\left(C A, C Z_{1}\right)=\Varangle\left(C A, C Z_{2}\right)$. This yields $Z_{1}=Z_{2}$.

Now, let $P$ and $Q$ be the feet of the perpendiculars from $B$ and $C$ onto $A C$ and $A B$, respectively, and let $R$ be the midpoint of $B C$ (see Figure 3). Then $R$ is the circumcentre of the cyclic quadrilateral $B C P Q$. Thus we obtain $\angle A P Q=\angle B$ and $\angle R P C=\angle C$, which yields $\angle Q P R=\angle A$. Similarly, we show that $\angle P Q R=\angle A$. Thus, all interesting triangles are similar to the triangle $P Q R$.\\

Denote now by $Z$ the common point of the circumcircles of $A P Q, B Q R$, and $C P R$. Let $E_{1} F_{1} K_{1}$ and $E_{2} F_{2} K_{2}$ be two interesting triangles. By the lemma, $Z$ is the centre of any spiral similarity taking one of the triangles $E_{1} F_{1} K_{1}, E_{2} F_{2} K_{2}$, and $P Q R$ to some other of them. Therefore the triangles $Z E_{1} E_{2}$ and $Z F_{1} F_{2}$ are similar, as well as the triangles $Z E_{1} F_{1}$ and $Z P Q$. Hence

$$
\frac{E_{1} E_{2}}{F_{1} F_{2}}=\frac{Z E_{1}}{Z F_{1}}=\frac{Z P}{Z Q}
$$

Moreover, the equalities $\angle A Z Q=\angle A P Q=\angle A B C=180^{\circ}-\angle Q Z R$ show that the point $Z$ lies on the line $A R$ (see Figure 4). Therefore the triangles $A Z P$ and $A C R$ are similar, as well as the triangles $A Z Q$ and $A B R$. This yields

$$
\frac{Z P}{Z Q}=\frac{Z P}{R C} \cdot \frac{R B}{Z Q}=\frac{A Z}{A C} \cdot \frac{A B}{A Z}=\frac{A B}{A C}
$$

which completes the solution.

Second method. Now we will start from the fact that $\omega_{1}$ is tangent to the lines $K E$ and $K F$ (see Figure 5). We prove that if $(E, F)$ is an interesting pair, then

\begin{equation*}
\frac{A E}{A B}+\frac{A F}{A C}=2 \cos \angle A . \tag{1}
\end{equation*}

Let $Y$ be the intersection point of the segments $B E$ and $C F$. The points $B, K$, and $C$ are collinear, hence applying PASCAL's theorem to the degenerated hexagon AFFYEE, we infer that $Y$ lies on the circle $\omega_{1}$.

Denote by $Z$ the second intersection point of the circumcircle of the triangle BFY with the line $B C$ (see Figure 6). By Miquel's theorem, the points $C, Z, Y$, and $E$ are concyclic. Therefore we obtain

$$
B F \cdot A B+C E \cdot A C=B Y \cdot B E+C Y \cdot C F=B Z \cdot B C+C Z \cdot B C=B C^{2} .
$$

On the other hand, $B C^{2}=A B^{2}+A C^{2}-2 A B \cdot A C \cos \angle A$, by the cosine law. Hence

$$
(A B-A F) \cdot A B+(A C-A E) \cdot A C=A B^{2}+A C^{2}-2 A B \cdot A C \cos \angle A,
$$

which simplifies to the desired equality (1).\\
Let now $\left(E_{1}, F_{1}\right)$ and $\left(E_{2}, F_{2}\right)$ be two interesting pairs of points. Then we get

$$
\frac{A E_{1}}{A B}+\frac{A F_{1}}{A C}=\frac{A E_{2}}{A B}+\frac{A F_{2}}{A C},
$$

which gives the desired result.\\

Third method. Again, we make use of the fact that all interesting triangles are similar (and equi-oriented). Let us put the picture onto a complex plane such that $A$ is at the origin, and identify each point with the corresponding complex number.

Let $E F K$ be any interesting triangle. The equalities $\angle K E F=\angle K F E=\angle A$ yield that the ratio $\nu=\frac{K-E}{F-E}$ is the same for all interesting triangles. This in turn means that the numbers $E$, $F$, and $K$ satisfy the linear equation

\begin{equation*}
K=\mu E+\nu F, \quad \text { where } \quad \mu=1-\nu . \tag{2}
\end{equation*}

Now let us choose the points $X$ and $Y$ on the rays $A B$ and $A C$, respectively, so that $\angle C X A=\angle A Y B=\angle A=\angle K E F$ (see Figure 7). Then each of the triangles $A X C$ and $Y A B$ is similar to any interesting triangle, which also means that

\begin{equation*}
C=\mu A+\nu X=\nu X \quad \text { and } \quad B=\mu Y+\nu A=\mu Y \tag{3}
\end{equation*}

Moreover, one has $X / Y=\overline{C / B}$.\\
Since the points $E, F$, and $K$ lie on $A C, A B$, and $B C$, respectively, one gets

$$
E=\rho Y, \quad F=\sigma X, \quad \text { and } \quad K=\lambda B+(1-\lambda) C
$$

for some real $\rho, \sigma$, and $\lambda$. In view of (3), the equation (2) now reads $\lambda B+(1-\lambda) C=K=$ $\mu E+\nu F=\rho B+\sigma C$, or

$$
(\lambda-\rho) B=(\sigma+\lambda-1) C
$$

Since the nonzero complex numbers $B$ and $C$ have different arguments, the coefficients in the brackets vanish, so $\rho=\lambda$ and $\sigma=1-\lambda$. Therefore,

\begin{equation*}
\frac{E}{Y}+\frac{F}{X}=\rho+\sigma=1 \tag{4}
\end{equation*}

Now, if $\left(E_{1}, F_{1}\right)$ and $\left(E_{2}, F_{2}\right)$ are two distinct interesting pairs, one may apply (4) to both pairs. Subtracting, we get

$$
\frac{E_{1}-E_{2}}{Y}=\frac{F_{2}-F_{1}}{X}, \quad \text { so } \quad \frac{E_{1}-E_{2}}{F_{2}-F_{1}}=\frac{Y}{X}=\frac{\bar{B}}{\bar{C}}
$$

Taking absolute values provides the required result.\\",1400,4
2014g7,"Let $A B C$ be a triangle with circumcircle $\Omega$ and incentre $I$. Let the line passing through $I$ and perpendicular to $C I$ intersect the segment $B C$ and the arc $B C$ (not containing $A$ ) of $\Omega$ at points $U$ and $V$, respectively. Let the line passing through $U$ and parallel to $A I$ intersect $A V$ at $X$, and let the line passing through $V$ and parallel to $A I$ intersect $A B$ at $Y$. Let $W$ and $Z$ be the midpoints of $A X$ and $B C$, respectively. Prove that if the points $I, X$, and $Y$ are collinear, then the points $I, W$, and $Z$ are also collinear.","We start with some general observations. Set $\alpha=\angle A / 2, \beta=\angle B / 2, \gamma=\angle C / 2$. Then obviously $\alpha+\beta+\gamma=90^{\circ}$. Since $\angle U I C=90^{\circ}$, we obtain $\angle I U C=\alpha+\beta$. Therefore $\angle B I V=\angle I U C-\angle I B C=\alpha=\angle B A I=\angle B Y V$, which implies that the points $B, Y, I$, and $V$ lie on a common circle (see Figure 1).

Assume now that the points $I, X$ and $Y$ are collinear. We prove that $\angle Y I A=90^{\circ}$.\\
Let the line $X U$ intersect $A B$ at $N$. Since the lines $A I, U X$, and $V Y$ are parallel, we get

$$
\frac{N X}{A I}=\frac{Y N}{Y A}=\frac{V U}{V I}=\frac{X U}{A I},
$$

implying $N X=X U$. Moreover, $\angle B I U=\alpha=\angle B N U$. This implies that the quadrilateral BUIN is cyclic, and since $B I$ is the angle bisector of $\angle U B N$, we infer that $N I=U I$. Thus in the isosceles triangle NIU, the point $X$ is the midpoint of the base $N U$. This gives $\angle I X N=90^{\circ}$, i.e., $\angle Y I A=90^{\circ}$.\\
\includegraphics[max width=\textwidth, center]{2025_04_30_430645cb6b343bf2b1ddg-65}

Figure 1\\
Let $S$ be the midpoint of the segment $V C$. Let moreover $T$ be the intersection point of the lines $A X$ and $S I$, and set $x=\angle B A V=\angle B C V$. Since $\angle C I A=90^{\circ}+\beta$ and $S I=S C$, we obtain

$$
\angle T I A=180^{\circ}-\angle A I S=90^{\circ}-\beta-\angle C I S=90^{\circ}-\beta-\gamma-x=\alpha-x=\angle T A I,
$$

which implies that $T I=T A$. Therefore, since $\angle X I A=90^{\circ}$, the point $T$ is the midpoint of $A X$, i.e., $T=W$.

To complete our solution, it remains to show that the intersection point of the lines $I S$ and $B C$ coincide with the midpoint of the segment $B C$. But since $S$ is the midpoint of the segment $V C$, it suffices to show that the lines $B V$ and $I S$ are parallel.

Since the quadrilateral $B Y I V$ is cyclic, $\angle V B I=\angle V Y I=\angle Y I A=90^{\circ}$. This implies that $B V$ is the external angle bisector of the angle $A B C$, which yields $\angle V A C=\angle V C A$. Therefore $2 \alpha-x=2 \gamma+x$, which gives $\alpha=\gamma+x$. Hence $\angle S C I=\alpha$, so $\angle V S I=2 \alpha$.

On the other hand, $\angle B V C=180^{\circ}-\angle B A C=180^{\circ}-2 \alpha$, which implies that the lines $B V$ and $I S$ are parallel. This completes the solution.",420,3
2014n3,"A coin is called a Cape Town coin if its value is $1 / n$ for some positive integer $n$. Given a collection of Cape Town coins of total value at most $99+\frac{1}{2}$, prove that it is possible to split this collection into at most 100 groups each of total value at most 1 .","Solution. We will show that for every positive integer $N$ any collection of Cape Town coins of total value at most $N-\frac{1}{2}$ can be split into $N$ groups each of total value at most 1 . The problem statement is a particular case for $N=100$.

We start with some preparations. If several given coins together have a total value also of the form $\frac{1}{k}$ for a positive integer $k$, then we may merge them into one new coin. Clearly, if the resulting collection can be split in the required way then the initial collection can also be split.

After each such merging, the total number of coins decreases, thus at some moment we come to a situation when no more merging is possible. At this moment, for every even $k$ there is at most one coin of value $\frac{1}{k}$ (otherwise two such coins may be merged), and for every odd $k>1$ there are at most $k-1$ coins of value $\frac{1}{k}$ (otherwise $k$ such coins may also be merged).

Now, clearly, each coin of value 1 should form a single group; if there are $d$ such coins then we may remove them from the collection and replace $N$ by $N-d$. So from now on we may assume that there are no coins of value 1 .

Finally, we may split all the coins in the following way. For each $k=1,2, \ldots, N$ we put all the coins of values $\frac{1}{2 k-1}$ and $\frac{1}{2 k}$ into a group $G_{k}$; the total value of $G_{k}$ does not exceed

$$
(2 k-2) \cdot \frac{1}{2 k-1}+\frac{1}{2 k}<1 .
$$

It remains to distribute the ""small"" coins of values which are less than $\frac{1}{2 N}$; we will add them one by one. In each step, take any remaining small coin. The total value of coins in the groups at this moment is at most $N-\frac{1}{2}$, so there exists a group of total value at most $\frac{1}{N}\left(N-\frac{1}{2}\right)=1-\frac{1}{2 N}$; thus it is possible to put our small coin into this group. Acting so, we will finally distribute all the coins.

Comment 1. The algorithm may be modified, at least the step where one distributes the coins of values $\geqslant \frac{1}{2 N}$. One different way is to put into $G_{k}$ all the coins of values $\frac{1}{(2 k-1)^{s}}$ for all integer $s \geqslant 0$. One may easily see that their total value also does not exceed 1 .

Comment 2. The original proposal also contained another part, suggesting to show that a required splitting may be impossible if the total value of coins is at most 100 . There are many examples of such a collection, e.g. one may take 98 coins of value 1 , one coin of value $\frac{1}{2}$, two coins of value $\frac{1}{3}$, and four coins of value $\frac{1}{5}$.

The Problem Selection Committee thinks that this part is less suitable for the competition.",476,3
2014n4,"Let $n>1$ be a given integer. Prove that infinitely many terms of the sequence $\left(a_{k}\right)_{k \geqslant 1}$, defined by

$$
a_{k}=\left\lfloor\frac{n^{k}}{k}\right\rfloor,
$$

are odd. (For a real number $x,\lfloor x\rfloor$ denotes the largest integer not exceeding $x$.)","If $n$ is odd, let $k=n^{m}$ for $m=1,2, \ldots$. Then $a_{k}=n^{n^{m}-m}$, which is odd for each $m$.

Henceforth, assume that $n$ is even, say $n=2 t$ for some integer $t \geqslant 1$. Then, for any $m \geqslant 2$, the integer $n^{2^{m}}-2^{m}=2^{m}\left(2^{2^{m}-m} \cdot t^{2^{m}}-1\right)$ has an odd prime divisor $p$, since $2^{m}-m>1$. Then, for $k=p \cdot 2^{m}$, we have

$$
n^{k}=\left(n^{2^{m}}\right)^{p} \equiv\left(2^{m}\right)^{p}=\left(2^{p}\right)^{m} \equiv 2^{m}
$$

where the congruences are taken modulo $p$ (recall that $2^{p} \equiv 2(\bmod p)$, by Fermat's little theorem). Also, from $n^{k}-2^{m}<n^{k}<n^{k}+2^{m}(p-1)$, we see that the fraction $\frac{n^{k}}{k}$ lies strictly between the consecutive integers $\frac{n^{k}-2^{m}}{p \cdot 2^{m}}$ and $\frac{n^{k}+2^{m}(p-1)}{p \cdot 2^{m}}$, which gives

$$
\left\lfloor\frac{n^{k}}{k}\right\rfloor=\frac{n^{k}-2^{m}}{p \cdot 2^{m}} .
$$

We finally observe that $\frac{n^{k}-2^{m}}{p \cdot 2^{m}}=\frac{\frac{n^{k}}{2^{m}}-1}{p}$ is an odd integer, since the integer $\frac{n^{k}}{2^{m}}-1$ is odd (recall that $k>m$ ). Note that for different values of $m$, we get different values of $k$, due to the different powers of 2 in the prime factorisation of $k$.
",158,2
2014n6,"Let $a_{1}<a_{2}<\cdots<a_{n}$ be pairwise coprime positive integers with $a_{1}$ being prime and $a_{1} \geqslant n+2$. On the segment $I=\left[0, a_{1} a_{2} \cdots a_{n}\right]$ of the real line, mark all integers that are divisible by at least one of the numbers $a_{1}, \ldots, a_{n}$. These points split $I$ into a number of smaller segments. Prove that the sum of the squares of the lengths of these segments is divisible by $a_{1}$.","Let $A=a_{1} \cdots a_{n}$. Throughout the solution, all intervals will be nonempty and have integer end-points. For any interval $X$, the length of $X$ will be denoted by $|X|$.

Define the following two families of intervals:

$$
\begin{aligned}
\mathcal{S} & =\{[x, y]: x<y \text { are consecutive marked points }\} \\
\mathcal{T} & =\{[x, y]: x<y \text { are integers, } 0 \leqslant x \leqslant A-1, \text { and no point is marked in }(x, y)\}
\end{aligned}
$$

We are interested in computing $\sum_{X \in \mathcal{S}}|X|^{2}$ modulo $a_{1}$.\\
Note that the number $A$ is marked, so in the definition of $\mathcal{T}$ the condition $y \leqslant A$ is enforced without explicitly prescribing it.

Assign weights to the intervals in $\mathcal{T}$, depending only on their lengths. The weight of an arbitrary interval $Y \in \mathcal{T}$ will be $w(|Y|)$, where

$$
w(k)= \begin{cases}1 & \text { if } k=1, \\ 2 & \text { if } k \geqslant 2 .\end{cases}
$$

Consider an arbitrary interval $X \in \mathcal{S}$ and its sub-intervals $Y \in \mathcal{T}$. Clearly, $X$ has one sub-interval of length $|X|$, two sub-intervals of length $|X|-1$ and so on; in general $X$ has $|X|-d+1$ sub-intervals of length $d$ for every $d=1,2, \ldots,|X|$. The sum of the weights of the sub-intervals of $X$ is\\
$\sum_{Y \in \mathcal{T}, Y \subseteq X} w(|Y|)=\sum_{d=1}^{|X|}(|X|-d+1) \cdot w(d)=|X| \cdot 1+((|X|-1)+(|X|-2)+\cdots+1) \cdot 2=|X|^{2}$.\\
Since the intervals in $\mathcal{S}$ are non-overlapping, every interval $Y \in \mathcal{T}$ is a sub-interval of a single interval $X \in \mathcal{S}$. Therefore,


\begin{equation*}
\sum_{X \in \mathcal{S}}|X|^{2}=\sum_{X \in \mathcal{S}}\left(\sum_{Y \in \mathcal{T}, Y \subseteq X} w(|Y|)\right)=\sum_{Y \in \mathcal{T}} w(|Y|) . \tag{1}
\end{equation*}


For every $d=1,2, \ldots, a_{1}$, we count how many intervals in $\mathcal{T}$ are of length $d$. Notice that the multiples of $a_{1}$ are all marked, so the lengths of the intervals in $\mathcal{S}$ and $\mathcal{T}$ cannot exceed $a_{1}$. Let $x$ be an arbitrary integer with $0 \leqslant x \leqslant A-1$ and consider the interval $[x, x+d]$. Let $r_{1}$, $\ldots, r_{n}$ be the remainders of $x$ modulo $a_{1}, \ldots, a_{n}$, respectively. Since $a_{1}, \ldots, a_{n}$ are pairwise coprime, the number $x$ is uniquely identified by the sequence $\left(r_{1}, \ldots, r_{n}\right)$, due to the Chinese remainder theorem.

For every $i=1, \ldots, n$, the property that the interval $(x, x+d)$ does not contain any multiple of $a_{i}$ is equivalent with $r_{i}+d \leqslant a_{i}$, i.e. $r_{i} \in\left\{0,1, \ldots, a_{i}-d\right\}$, so there are $a_{i}-d+1$ choices for the number $r_{i}$ for each $i$. Therefore, the number of the remainder sequences $\left(r_{1}, \ldots, r_{n}\right)$ that satisfy $[x, x+d] \in \mathcal{T}$ is precisely $\left(a_{1}+1-d\right) \cdots\left(a_{n}+1-d\right)$. Denote this product by $f(d)$.

Now we can group the last sum in (1) by length of the intervals. As we have seen, for every $d=1, \ldots, a_{1}$ there are $f(d)$ intervals $Y \in \mathcal{T}$ with $|Y|=d$. Therefore, (1) can be continued as


\begin{equation*}
\sum_{X \in \mathcal{S}}|X|^{2}=\sum_{Y \in \mathcal{T}} w(|Y|)=\sum_{d=1}^{a_{1}} f(d) \cdot w(d)=2 \sum_{d=1}^{a_{1}} f(d)-f(1) \tag{2}
\end{equation*}


Having the formula (2), the solution can be finished using the following well-known fact: Lemma. If $p$ is a prime, $F(x)$ is a polynomial with integer coefficients, and $\operatorname{deg} F \leqslant p-2$, then $\sum_{x=1}^{p} F(x)$ is divisible by $p$.\\
Proof. Obviously, it is sufficient to prove the lemma for monomials of the form $x^{k}$ with $k \leqslant p-2$. Apply induction on $k$. If $k=0$ then $F=1$, and the statement is trivial.

Let $1 \leqslant k \leqslant p-2$, and assume that the lemma is proved for all lower degrees. Then

$$
\begin{aligned}
0 & \equiv p^{k+1}=\sum_{x=1}^{p}\left(x^{k+1}-(x-1)^{k+1}\right)=\sum_{x=1}^{p}\left(\sum_{\ell=0}^{k}(-1)^{k-\ell}\binom{k+1}{\ell} x^{\ell}\right) \\
& =(k+1) \sum_{x=1}^{p} x^{k}+\sum_{\ell=0}^{k-1}(-1)^{k-\ell}\binom{k+1}{\ell} \sum_{x=1}^{p} x^{\ell} \equiv(k+1) \sum_{x=1}^{p} x^{k} \quad(\bmod p)
\end{aligned}
$$

Since $0<k+1<p$, this proves $\sum_{x=1}^{p} x^{k} \equiv 0(\bmod p)$.\\
In (2), by applying the lemma to the polynomial $f$ and the prime $a_{1}$, we obtain that $\sum_{d=1}^{a_{1}} f(d)$ is divisible by $a_{1}$. The term $f(1)=a_{1} \cdots a_{n}$ is also divisible by $a_{1}$; these two facts together prove that $\sum_{X \in \mathcal{S}}|X|^{2}$ is divisible by $a_{1}$.",644,4
2014n7,"Let $c \geqslant 1$ be an integer. Define a sequence of positive integers by $a_{1}=c$ and

$$
a_{n+1}=a_{n}^{3}-4 c \cdot a_{n}^{2}+5 c^{2} \cdot a_{n}+c
$$

for all $n \geqslant 1$. Prove that for each integer $n \geqslant 2$ there exists a prime number $p$ dividing $a_{n}$ but none of the numbers $a_{1}, \ldots, a_{n-1}$.","Solution. Let us define $x_{0}=0$ and $x_{n}=a_{n} / c$ for all integers $n \geqslant 1$. It is easy to see that the sequence ( $x_{n}$ ) thus obtained obeys the recursive law


\begin{equation*}
x_{n+1}=c^{2}\left(x_{n}^{3}-4 x_{n}^{2}+5 x_{n}\right)+1 \tag{1}
\end{equation*}


for all integers $n \geqslant 0$. In particular, all of its terms are positive integers; notice that $x_{1}=1$ and $x_{2}=2 c^{2}+1$. Since


\begin{equation*}
x_{n+1}=c^{2} x_{n}\left(x_{n}-2\right)^{2}+c^{2} x_{n}+1>x_{n} \tag{2}
\end{equation*}


holds for all integers $n \geqslant 0$, it is also strictly increasing. Since $x_{n+1}$ is by (1) coprime to $c$ for any $n \geqslant 0$, it suffices to prove that for each $n \geqslant 2$ there exists a prime number $p$ dividing $x_{n}$ but none of the numbers $x_{1}, \ldots, x_{n-1}$. Let us begin by establishing three preliminary claims.

Claim 1. If $i \equiv j(\bmod m)$ holds for some integers $i, j \geqslant 0$ and $m \geqslant 1$, then $x_{i} \equiv x_{j}\left(\bmod x_{m}\right)$ holds as well.\\
Proof. Evidently, it suffices to show $x_{i+m} \equiv x_{i}\left(\bmod x_{m}\right)$ for all integers $i \geqslant 0$ and $m \geqslant 1$. For this purpose we may argue for fixed $m$ by induction on $i$ using $x_{0}=0$ in the base case $i=0$. Now, if we have $x_{i+m} \equiv x_{i}\left(\bmod x_{m}\right)$ for some integer $i$, then the recursive equation (1) yields

$$
x_{i+m+1} \equiv c^{2}\left(x_{i+m}^{3}-4 x_{i+m}^{2}+5 x_{i+m}\right)+1 \equiv c^{2}\left(x_{i}^{3}-4 x_{i}^{2}+5 x_{i}\right)+1 \equiv x_{i+1} \quad\left(\bmod x_{m}\right),
$$

which completes the induction.\\
Claim 2. If the integers $i, j \geqslant 2$ and $m \geqslant 1$ satisfy $i \equiv j(\bmod m)$, then $x_{i} \equiv x_{j}\left(\bmod x_{m}^{2}\right)$ holds as well.\\
Proof. Again it suffices to prove $x_{i+m} \equiv x_{i}\left(\bmod x_{m}^{2}\right)$ for all integers $i \geqslant 2$ and $m \geqslant 1$. As above, we proceed for fixed $m$ by induction on $i$. The induction step is again easy using (1), but this time the base case $i=2$ requires some calculation. Set $L=5 c^{2}$. By (1) we have $x_{m+1} \equiv L x_{m}+1\left(\bmod x_{m}^{2}\right)$, and hence

$$
\begin{aligned}
x_{m+1}^{3}-4 x_{m+1}^{2}+5 x_{m+1} & \equiv\left(L x_{m}+1\right)^{3}-4\left(L x_{m}+1\right)^{2}+5\left(L x_{m}+1\right) \\
& \equiv\left(3 L x_{m}+1\right)-4\left(2 L x_{m}+1\right)+5\left(L x_{m}+1\right) \equiv 2 \quad\left(\bmod x_{m}^{2}\right),
\end{aligned}
$$

which in turn gives indeed $x_{m+2} \equiv 2 c^{2}+1 \equiv x_{2}\left(\bmod x_{m}^{2}\right)$.\\
Claim 3. For each integer $n \geqslant 2$, we have $x_{n}>x_{1} \cdot x_{2} \cdots x_{n-2}$.\\
Proof. The cases $n=2$ and $n=3$ are clear. Arguing inductively, we assume now that the claim holds for some $n \geqslant 3$. Recall that $x_{2} \geqslant 3$, so by monotonicity and (2) we get $x_{n} \geqslant x_{3} \geqslant x_{2}\left(x_{2}-2\right)^{2}+x_{2}+1 \geqslant 7$. It follows that

$$
x_{n+1}>x_{n}^{3}-4 x_{n}^{2}+5 x_{n}>7 x_{n}^{2}-4 x_{n}^{2}>x_{n}^{2}>x_{n} x_{n-1},
$$

which by the induction hypothesis yields $x_{n+1}>x_{1} \cdot x_{2} \cdots x_{n-1}$, as desired.

Now we direct our attention to the problem itself: let any integer $n \geqslant 2$ be given. By Claim 3 there exists a prime number $p$ appearing with a higher exponent in the prime factorisation of $x_{n}$ than in the prime factorisation of $x_{1} \cdots x_{n-2}$. In particular, $p \mid x_{n}$, and it suffices to prove that $p$ divides none of $x_{1}, \ldots, x_{n-1}$.

Otherwise let $k \in\{1, \ldots, n-1\}$ be minimal such that $p$ divides $x_{k}$. Since $x_{n-1}$ and $x_{n}$ are coprime by (1) and $x_{1}=1$, we actually have $2 \leqslant k \leqslant n-2$. Write $n=q k+r$ with some integers $q \geqslant 0$ and $0 \leqslant r<k$. By Claim 1 we have $x_{n} \equiv x_{r}\left(\bmod x_{k}\right)$, whence $p \mid x_{r}$. Due to the minimality of $k$ this entails $r=0$, i.e. $k \mid n$.

Thus from Claim 2 we infer

$$
x_{n} \equiv x_{k} \quad\left(\bmod x_{k}^{2}\right)
$$

Now let $\alpha \geqslant 1$ be maximal with the property $p^{\alpha} \mid x_{k}$. Then $x_{k}^{2}$ is divisible by $p^{\alpha+1}$ and by our choice of $p$ so is $x_{n}$. So by the previous congruence $x_{k}$ is a multiple of $p^{\alpha+1}$ as well, contrary to our choice of $\alpha$. This is the final contradiction concluding the solution.",636,4
2014n8,"For every real number $x$, let $\|x\|$ denote the distance between $x$ and the nearest integer. Prove that for every pair $(a, b)$ of positive integers there exist an odd prime $p$ and a positive integer $k$ satisfying

\begin{equation*}
\left\|\frac{a}{p^{k}}\right\|+\left\|\frac{b}{p^{k}}\right\|+\left\|\frac{a+b}{p^{k}}\right\|=1 . \tag{1}
\end{equation*}","Solution. Notice first that $\left\lfloor x+\frac{1}{2}\right\rfloor$ is an integer nearest to $x$, so $\|x\|=\left\lfloor\left.\left\lfloor x+\frac{1}{2}\right\rfloor-x \right\rvert\,\right.$. Thus we have


\begin{equation*}
\left\lfloor x+\frac{1}{2}\right\rfloor=x \pm\|x\| \text {. } \tag{2}
\end{equation*}


For every rational number $r$ and every prime number $p$, denote by $v_{p}(r)$ the exponent of $p$ in the prime factorisation of $r$. Recall the notation $(2 n-1)$ !! for the product of all odd positive integers not exceeding $2 n-1$, i.e., $(2 n-1)!!=1 \cdot 3 \cdots(2 n-1)$.\\
Lemma. For every positive integer $n$ and every odd prime $p$, we have

$$
v_{p}((2 n-1)!!)=\sum_{k=1}^{\infty}\left\lfloor\frac{n}{p^{k}}+\frac{1}{2}\right\rfloor .
$$

Proof. For every positive integer $k$, let us count the multiples of $p^{k}$ among the factors $1,3, \ldots$, $2 n-1$. If $\ell$ is an arbitrary integer, the number $(2 \ell-1) p^{k}$ is listed above if and only if

$$
0<(2 \ell-1) p^{k} \leqslant 2 n \quad \Longleftrightarrow \quad \frac{1}{2}<\ell \leqslant \frac{n}{p^{k}}+\frac{1}{2} \quad \Longleftrightarrow \quad 1 \leqslant \ell \leqslant\left\lfloor\frac{n}{p^{k}}+\frac{1}{2}\right\rfloor .
$$

Hence, the number of multiples of $p^{k}$ among the factors is precisely $m_{k}=\left\lfloor\frac{n}{p^{k}}+\frac{1}{2}\right\rfloor$. Thus we obtain

$$
v_{p}((2 n-1)!!)=\sum_{i=1}^{n} v_{p}(2 i-1)=\sum_{i=1}^{n} \sum_{k=1}^{v_{p}(2 i-1)} 1=\sum_{k=1}^{\infty} \sum_{\ell=1}^{m_{k}} 1=\sum_{k=1}^{\infty}\left\lfloor\frac{n}{p^{k}}+\frac{1}{2}\right\rfloor .
$$

In order to prove the problem statement, consider the rational number

$$
N=\frac{(2 a+2 b-1)!!}{(2 a-1)!!\cdot(2 b-1)!!}=\frac{(2 a+1)(2 a+3) \cdots(2 a+2 b-1)}{1 \cdot 3 \cdots(2 b-1)} .
$$

Obviously, $N>1$, so there exists a prime $p$ with $v_{p}(N)>0$. Since $N$ is a fraction of two odd numbers, $p$ is odd.

By our lemma,

$$
0<v_{p}(N)=\sum_{k=1}^{\infty}\left(\left\lfloor\frac{a+b}{p^{k}}+\frac{1}{2}\right\rfloor-\left\lfloor\frac{a}{p^{k}}+\frac{1}{2}\right\rfloor-\left\lfloor\frac{b}{p^{k}}+\frac{1}{2}\right\rfloor\right) .
$$

Therefore, there exists some positive integer $k$ such that the integer number

$$
d_{k}=\left\lfloor\frac{a+b}{p^{k}}+\frac{1}{2}\right\rfloor-\left\lfloor\frac{a}{p^{k}}+\frac{1}{2}\right\rfloor-\left\lfloor\frac{b}{p^{k}}+\frac{1}{2}\right\rfloor
$$

is positive, so $d_{k} \geqslant 1$. By (2) we have


\begin{equation*}
1 \leqslant d_{k}=\frac{a+b}{p^{k}}-\frac{a}{p^{k}}-\frac{b}{p^{k}} \pm\left\|\frac{a+b}{p^{k}}\right\| \pm\left\|\frac{a}{p^{k}}\right\| \pm\left\|\frac{b}{p^{k}}\right\|= \pm\left\|\frac{a+b}{p^{k}}\right\| \pm\left\|\frac{a}{p^{k}}\right\| \pm\left\|\frac{b}{p^{k}}\right\| . \tag{3}
\end{equation*}


Since $\|x\|<\frac{1}{2}$ for every rational $x$ with odd denominator, the relation (3) can only be satisfied if all three signs on the right-hand side are positive and $d_{k}=1$. Thus we get

$$
\left\|\frac{a}{p^{k}}\right\|+\left\|\frac{b}{p^{k}}\right\|+\left\|\frac{a+b}{p^{k}}\right\|=d_{k}=1
$$

as required.

Comment 1. There are various choices for the number $N$ in the solution. Here we sketch such a version.

Let $x$ and $y$ be two rational numbers with odd denominators. It is easy to see that the condition $\|x\|+\|y\|+\|x+y\|=1$ is satisfied if and only if

$$
\text { either }\{x\}<\frac{1}{2}, \quad\{y\}<\frac{1}{2}, \quad\{x+y\}>\frac{1}{2}, \quad \text { or } \quad\{x\}>\frac{1}{2}, \quad\{y\}>\frac{1}{2}, \quad\{x+y\}<\frac{1}{2}
$$

where $\{x\}$ denotes the fractional part of $x$.\\
In the context of our problem, the first condition seems easier to deal with. Also, one may notice that


\begin{equation*}
\{x\}<\frac{1}{2} \Longleftrightarrow \varkappa(x)=0 \quad \text { and } \quad\{x\} \geqslant \frac{1}{2} \Longleftrightarrow \varkappa(x)=1 \tag{4}
\end{equation*}


where

$$
\varkappa(x)=\lfloor 2 x\rfloor-2\lfloor x\rfloor .
$$

Now it is natural to consider the number

$$
M=\frac{\binom{2 a+2 b}{a+b}}{\binom{2 a}{a}\binom{2 b}{b}}
$$

since

$$
v_{p}(M)=\sum_{k=1}^{\infty}\left(\varkappa\left(\frac{2(a+b)}{p^{k}}\right)-\varkappa\left(\frac{2 a}{p^{k}}\right)-\varkappa\left(\frac{2 b}{p^{k}}\right)\right) .
$$

One may see that $M>1$, and that $v_{2}(M) \leqslant 0$. Thus, there exist an odd prime $p$ and a positive integer $k$ with

$$
\varkappa\left(\frac{2(a+b)}{p^{k}}\right)-\varkappa\left(\frac{2 a}{p^{k}}\right)-\varkappa\left(\frac{2 b}{p^{k}}\right)>0
$$

In view of (4), the last inequality yields


\begin{equation*}
\left\{\frac{a}{p^{k}}\right\}<\frac{1}{2}, \quad\left\{\frac{b}{p^{k}}\right\}<\frac{1}{2}, \quad \text { and } \quad\left\{\frac{a+b}{p^{k}}\right\}>\frac{1}{2} \tag{5}
\end{equation*}


which is what we wanted to obtain.\\
Comment 2. Once one tries to prove the existence of suitable $p$ and $k$ satisfying (5), it seems somehow natural to suppose that $a \leqslant b$ and to add the restriction $p^{k}>a$. In this case the inequalities (5) can be rewritten as

$$
2 a<p^{k}, \quad 2 m p^{k}<2 b<(2 m+1) p^{k}, \quad \text { and } \quad(2 m+1) p^{k}<2(a+b)<(2 m+2) p^{k}
$$

for some positive integer $m$. This means exactly that one of the numbers $2 a+1,2 a+3, \ldots, 2 a+2 b-1$ is divisible by some number of the form $p^{k}$ which is greater than $2 a$.

Using more advanced techniques, one can show that such a number $p^{k}$ exists even with $k=1$. This was shown in 2004 by Laishram and Shorey; the methods used for this proof are elementary but still quite involved. In fact, their result generalises a theorem by SYLVESTER which states that for every pair of integers $(n, k)$ with $n \geqslant k \geqslant 1$, the product $(n+1)(n+2) \cdots(n+k)$ is divisible by some prime $p>k$. We would like to mention here that Sylvester's theorem itself does not seem to suffice for solving the problem.",690,4
2013a1,"Let $n$ be a positive integer and let $a_{1}, \ldots, a_{n-1}$ be arbitrary real numbers. Define the sequences $u_{0}, \ldots, u_{n}$ and $v_{0}, \ldots, v_{n}$ inductively by $u_{0}=u_{1}=v_{0}=v_{1}=1$, and

$$
u_{k+1}=u_{k}+a_{k} u_{k-1}, \quad v_{k+1}=v_{k}+a_{n-k} v_{k-1} \quad \text { for } k=1, \ldots, n-1 .
$$

Prove that $u_{n}=v_{n}$.","We prove by induction on $k$ that

\begin{equation*}
u_{k}=\sum_{\substack{0<i_{1}<\ldots<i_{t}<k, i_{j}+1-i_{j} \geqslant 2}} a_{i_{1}} \ldots a_{i_{t}} . \tag{1}
\end{equation*}

Note that we have one trivial summand equal to 1 (which corresponds to $t=0$ and the empty sequence, whose product is 1 ).

For $k=0,1$ the sum on the right-hand side only contains the empty product, so (1) holds due to $u_{0}=u_{1}=1$. For $k \geqslant 1$, assuming the result is true for $0,1, \ldots, k$, we have

$$
\begin{aligned}
u_{k+1} & =\sum_{\substack{0<i_{1}<\ldots<i_{t}<k, i_{j+1}-i_{j} \geqslant 2}} a_{i_{1}} \ldots a_{i_{t}}+\sum_{\substack{0<i_{1}<\ldots<i_{t}<k-1, i_{j+1}-i_{j} \geqslant 2}} a_{i_{1}} \ldots a_{i_{t}} \cdot a_{k} \\
& =a_{\substack{\left.0<i_{1}<\ldots<i_{t}<k+1, i_{j}+1-i_{1} \geqslant 2, k \notin i_{1}, \ldots, i_{t}\right\}}} \ldots a_{i_{t}}+\sum_{\substack{\left.0<i_{1}<\ldots<i_{t}<k+1, i_{j+1}+1-i_{j} \geqslant 2, k \in i_{1}, \ldots, i_{i}\right\}}} a_{i_{1}} \ldots a_{i_{t}} \\
& =\sum_{\substack{0<i_{1}<\ldots<i_{t}<k+1, i_{j} \\
i_{j+1}-i_{j} \geqslant 2}} \ldots a_{i_{t}},
\end{aligned}
$$

as required.\\
Applying (1) to the sequence $b_{1}, \ldots, b_{n}$ given by $b_{k}=a_{n-k}$ for $1 \leqslant k \leqslant n$, we get

\begin{equation*}
v_{k}=\sum_{\substack{0<i_{1}<\ldots<i_{t}<k, i_{j}+1-i_{j} \geqslant 2}} b_{i_{1}} \ldots b_{i_{t}}=\sum_{\substack{n>i_{1}>\ldots>i_{t}>n-k, i_{j}-i_{j}+1 \geqslant 2}} a_{i_{1}} \ldots a_{i_{t}} . \tag{2}
\end{equation*}

For $k=n$ the expressions (1) and (2) coincide, so indeed $u_{n}=v_{n}$.\\",179,2
2013a2,"Prove that in any set of 2000 distinct real numbers there exist two pairs $a>b$ and $c>d$ with $a \neq c$ or $b \neq d$, such that

$$
\left|\frac{a-b}{c-d}-1\right|<\frac{1}{100000}
$$","Solution. For any set $S$ of $n=2000$ distinct real numbers, let $D_{1} \leqslant D_{2} \leqslant \cdots \leqslant D_{m}$ be the distances between them, displayed with their multiplicities. Here $m=n(n-1) / 2$. By rescaling the numbers, we may assume that the smallest distance $D_{1}$ between two elements of $S$ is $D_{1}=1$. Let $D_{1}=1=y-x$ for $x, y \in S$. Evidently $D_{m}=v-u$ is the difference between the largest element $v$ and the smallest element $u$ of $S$.

If $D_{i+1} / D_{i}<1+10^{-5}$ for some $i=1,2, \ldots, m-1$ then the required inequality holds, because $0 \leqslant D_{i+1} / D_{i}-1<10^{-5}$. Otherwise, the reverse inequality

$$
\frac{D_{i+1}}{D_{i}} \geqslant 1+\frac{1}{10^{5}}
$$

holds for each $i=1,2, \ldots, m-1$, and therefore

$$
v-u=D_{m}=\frac{D_{m}}{D_{1}}=\frac{D_{m}}{D_{m-1}} \cdots \frac{D_{3}}{D_{2}} \cdot \frac{D_{2}}{D_{1}} \geqslant\left(1+\frac{1}{10^{5}}\right)^{m-1} .
$$

From $m-1=n(n-1) / 2-1=1000 \cdot 1999-1>19 \cdot 10^{5}$, together with the fact that for all $n \geqslant 1$, $\left(1+\frac{1}{n}\right)^{n} \geqslant 1+\binom{n}{1} \cdot \frac{1}{n}=2$, we get

$$
\left(1+\frac{1}{10^{5}}\right)^{19 \cdot 10^{5}}=\left(\left(1+\frac{1}{10^{5}}\right)^{10^{5}}\right)^{19} \geqslant 2^{19}=2^{9} \cdot 2^{10}>500 \cdot 1000>2 \cdot 10^{5}
$$

and so $v-u=D_{m}>2 \cdot 10^{5}$.\\
Since the distance of $x$ to at least one of the numbers $u, v$ is at least $(u-v) / 2>10^{5}$, we have

$$
|x-z|>10^{5} .
$$

for some $z \in\{u, v\}$. Since $y-x=1$, we have either $z>y>x$ (if $z=v$ ) or $y>x>z($ if $z=u)$. If $z>y>x$, selecting $a=z, b=y, c=z$ and $d=x$ (so that $b \neq d$ ), we obtain

$$
\left|\frac{a-b}{c-d}-1\right|=\left|\frac{z-y}{z-x}-1\right|=\left|\frac{x-y}{z-x}\right|=\frac{1}{z-x}<10^{-5} .
$$

Otherwise, if $y>x>z$, we may choose $a=y, b=z, c=x$ and $d=z$ (so that $a \neq c$ ), and obtain

$$
\left|\frac{a-b}{c-d}-1\right|=\left|\frac{y-z}{x-z}-1\right|=\left|\frac{y-x}{x-z}\right|=\frac{1}{x-z}<10^{-5} .
$$

The desired result follows.\\
Comment. As the solution shows, the numbers 2000 and $\frac{1}{100000}$ appearing in the statement of the problem may be replaced by any $n \in \mathbb{Z}_{>0}$ and $\delta>0$ satisfying

$$
\delta(1+\delta)^{n(n-1) / 2-1}>2 .
$$",288,3
2013a3,"Let $\mathbb{Q}_{>0}$ be the set of positive rational numbers. Let $f: \mathbb{Q}_{>0} \rightarrow \mathbb{R}$ be a function satisfying the conditions


\begin{align*}
& f(x) f(y) \geqslant f(x y)  \tag{1}\\
& f(x+y) \geqslant f(x)+f(y) \tag{2}
\end{align*}


for all $x, y \in \mathbb{Q}_{>0}$. Given that $f(a)=a$ for some rational $a>1$, prove that $f(x)=x$ for all $x \in \mathbb{Q}_{>0}$.\\","Solution. Denote by $\mathbb{Z}_{>0}$ the set of positive integers.\\
Plugging $x=1, y=a$ into (1) we get $f(1) \geqslant 1$. Next, by an easy induction on $n$ we get from (2) that


\begin{equation*}
f(n x) \geqslant n f(x) \text { for all } n \in \mathbb{Z}_{>0} \text { and } x \in \mathbb{Q}_{>0} \tag{3}
\end{equation*}


In particular, we have


\begin{equation*}
f(n) \geqslant n f(1) \geqslant n \quad \text { for all } n \in \mathbb{Z}_{>0} \text {. } \tag{4}
\end{equation*}


From (1) again we have $f(m / n) f(n) \geqslant f(m)$, so $f(q)>0$ for all $q \in \mathbb{Q}_{>0}$.\\
Now, (2) implies that $f$ is strictly increasing; this fact together with (4) yields

$$
f(x) \geqslant f(\lfloor x\rfloor) \geqslant\lfloor x\rfloor>x-1 \quad \text { for all } x \geqslant 1
$$

By an easy induction we get from (1) that $f(x)^{n} \geqslant f\left(x^{n}\right)$, so

$$
f(x)^{n} \geqslant f\left(x^{n}\right)>x^{n}-1 \quad \Longrightarrow \quad f(x) \geqslant \sqrt[n]{x^{n}-1} \quad \text { for all } x>1 \text { and } n \in \mathbb{Z}_{>0}
$$

This yields


\begin{equation*}
f(x) \geqslant x \quad \text { for every } x>1 \tag{5}
\end{equation*}


(Indeed, if $x>y>1$ then $x^{n}-y^{n}=(x-y)\left(x^{n-1}+x^{n-2} y+\cdots+y^{n}\right)>n(x-y)$, so for a large $n$ we have $x^{n}-1>y^{n}$ and thus $f(x)>y$.)

Now, (1) and (5) give $a^{n}=f(a)^{n} \geqslant f\left(a^{n}\right) \geqslant a^{n}$, so $f\left(a^{n}\right)=a^{n}$. Now, for $x>1$ let us choose $n \in \mathbb{Z}_{>0}$ such that $a^{n}-x>1$. Then by (2) and (5) we get

$$
a^{n}=f\left(a^{n}\right) \geqslant f(x)+f\left(a^{n}-x\right) \geqslant x+\left(a^{n}-x\right)=a^{n}
$$

and therefore $f(x)=x$ for $x>1$. Finally, for every $x \in \mathbb{Q}_{>0}$ and every $n \in \mathbb{Z}_{>0}$, from (1) and (3) we get

$$
n f(x)=f(n) f(x) \geqslant f(n x) \geqslant n f(x)
$$

which gives $f(n x)=n f(x)$. Therefore $f(m / n)=f(m) / n=m / n$ for all $m, n \in \mathbb{Z}_{>0}$.\\
Comment. The condition $f(a)=a>1$ is essential. Indeed, for $b \geqslant 1$ the function $f(x)=b x^{2}$ satisfies (1) and (2) for all $x, y \in \mathbb{Q}_{>0}$, and it has a unique fixed point $1 / b \leqslant 1$.",325,3
2013a4,"Let $n$ be a positive integer, and consider a sequence $a_{1}, a_{2}, \ldots, a_{n}$ of positive integers. Extend it periodically to an infinite sequence $a_{1}, a_{2}, \ldots$ by defining $a_{n+i}=a_{i}$ for all $i \geqslant 1$. If


\begin{equation*}
a_{1} \leqslant a_{2} \leqslant \cdots \leqslant a_{n} \leqslant a_{1}+n \tag{1}
\end{equation*}


and


\begin{equation*}
a_{a_{i}} \leqslant n+i-1 \quad \text { for } i=1,2, \ldots, n \tag{2}
\end{equation*}


prove that


\begin{equation*}
a_{1}+\cdots+a_{n} \leqslant n^{2} . \tag{Germany}
\end{equation*}","First, we claim that

\begin{equation*}
a_{i} \leqslant n+i-1 \quad \text { for } i=1,2, \ldots, n \text {. } \tag{3}
\end{equation*}

Assume contrariwise that $i$ is the smallest counterexample. From $a_{n} \geqslant a_{n-1} \geqslant \cdots \geqslant a_{i} \geqslant n+i$ and $a_{a_{i}} \leqslant n+i-1$, taking into account the periodicity of our sequence, it follows that

\begin{equation*}
a_{i} \text { cannot be congruent to } i, i+1, \ldots, n-1, \text { or } n \quad(\bmod n) \text {. } \tag{4}
\end{equation*}

Thus our assumption that $a_{i} \geqslant n+i$ implies the stronger statement that $a_{i} \geqslant 2 n+1$, which by $a_{1}+n \geqslant a_{n} \geqslant a_{i}$ gives $a_{1} \geqslant n+1$. The minimality of $i$ then yields $i=1$, and (4) becomes contradictory. This establishes our first claim.

In particular we now know that $a_{1} \leqslant n$. If $a_{n} \leqslant n$, then $a_{1} \leqslant \cdots \leqslant \cdots a_{n} \leqslant n$ and the desired inequality holds trivially. Otherwise, consider the number $t$ with $1 \leqslant t \leqslant n-1$ such that

\begin{equation*}
a_{1} \leqslant a_{2} \leqslant \ldots \leqslant a_{t} \leqslant n<a_{t+1} \leqslant \ldots \leqslant a_{n} . \tag{5}
\end{equation*}

Since $1 \leqslant a_{1} \leqslant n$ and $a_{a_{1}} \leqslant n$ by (2), we have $a_{1} \leqslant t$ and hence $a_{n} \leqslant n+t$. Therefore if for each positive integer $i$ we let $b_{i}$ be the number of indices $j \in\{t+1, \ldots, n\}$ satisfying $a_{j} \geqslant n+i$, we have

$$
b_{1} \geqslant b_{2} \geqslant \ldots \geqslant b_{t} \geqslant b_{t+1}=0
$$

Next we claim that $a_{i}+b_{i} \leqslant n$ for $1 \leqslant i \leqslant t$. Indeed, by $n+i-1 \geqslant a_{a_{i}}$ and $a_{i} \leqslant n$, each $j$ with $a_{j} \geqslant n+i$ (thus $a_{j}>a_{a_{i}}$ ) belongs to $\left\{a_{i}+1, \ldots, n\right\}$, and for this reason $b_{i} \leqslant n-a_{i}$.

It follows from the definition of the $b_{i} \mathrm{~s}$ and (5) that

$$
a_{t+1}+\ldots+a_{n} \leqslant n(n-t)+b_{1}+\ldots+b_{t}
$$

Adding $a_{1}+\ldots+a_{t}$ to both sides and using that $a_{i}+b_{i} \leqslant n$ for $1 \leqslant i \leqslant t$, we get

$$
a_{1}+a_{2}+\cdots+a_{n} \leqslant n(n-t)+n t=n^{2}
$$

as we wished to prove.",328,3
2013c3,"A crazy physicist discovered a new kind of particle which he called an imon, after some of them mysteriously appeared in his lab. Some pairs of imons in the lab can be entangled, and each imon can participate in many entanglement relations. The physicist has found a way to perform the following two kinds of operations with these particles, one operation at a time.\\
(i) If some imon is entangled with an odd number of other imons in the lab, then the physicist can destroy it.\\
(ii) At any moment, he may double the whole family of imons in his lab by creating a copy $I^{\prime}$ of each imon $I$. During this procedure, the two copies $I^{\prime}$ and $J^{\prime}$ become entangled if and only if the original imons $I$ and $J$ are entangled, and each copy $I^{\prime}$ becomes entangled with its original imon $I$; no other entanglements occur or disappear at this moment.

Prove that the physicist may apply a sequence of such operations resulting in a family of imons, no two of which are entangled.","Let us consider a graph with the imons as vertices, and two imons being connected if and only if they are entangled. Recall that a proper coloring of a graph $G$ is a coloring of its vertices in several colors so that every two connected vertices have different colors.\\
Lemma. Assume that a graph $G$ admits a proper coloring in $n$ colors ( $n>1$ ). Then one may perform a sequence of operations resulting in a graph which admits a proper coloring in $n-1$ colors.\\
Proof. Let us apply repeatedly operation $(i)$ to any appropriate vertices while it is possible. Since the number of vertices decreases, this process finally results in a graph where all the degrees are even. Surely this graph also admits a proper coloring in $n$ colors $1, \ldots, n$; let us fix this coloring.

Now apply the operation (ii) to this graph. A proper coloring of the resulting graph in $n$ colors still exists: one may preserve the colors of the original vertices and color the vertex $I^{\prime}$ in a color $k+1(\bmod n)$ if the vertex $I$ has color $k$. Then two connected original vertices still have different colors, and so do their two connected copies. On the other hand, the vertices $I$ and $I^{\prime}$ have different colors since $n>1$.

All the degrees of the vertices in the resulting graph are odd, so one may apply operation (i) to delete consecutively all the vertices of color $n$ one by one; no two of them are connected by an edge, so their degrees do not change during the process. Thus, we obtain a graph admitting a proper coloring in $n-1$ colors, as required. The lemma is proved.

Now, assume that a graph $G$ has $n$ vertices; then it admits a proper coloring in $n$ colors. Applying repeatedly the lemma we finally obtain a graph admitting a proper coloring in one color, that is - a graph with no edges, as required.",324,3
2013c4,"Let $n$ be a positive integer, and let $A$ be a subset of $\{1, \ldots, n\}$. An $A$-partition of $n$ into $k$ parts is a representation of $n$ as a sum $n=a_{1}+\cdots+a_{k}$, where the parts $a_{1}, \ldots, a_{k}$ belong to $A$ and are not necessarily distinct. The number of different parts in such a partition is the number of (distinct) elements in the set $\left\{a_{1}, a_{2}, \ldots, a_{k}\right\}$.

We say that an $A$-partition of $n$ into $k$ parts is optimal if there is no $A$-partition of $n$ into $r$ parts with $r<k$. Prove that any optimal $A$-partition of $n$ contains at most $\sqrt[3]{6 n}$ different parts.","If there are no $A$-partitions of $n$, the result is vacuously true. Otherwise, let $k_{\text {min }}$ be the minimum number of parts in an $A$-partition of $n$, and let $n=a_{1}+\cdots+a_{k_{\text {min }}}$ be an optimal partition. Denote by $s$ the number of different parts in this partition, so we can write $S=\left\{a_{1}, \ldots, a_{k_{\min }}\right\}=\left\{b_{1}, \ldots, b_{s}\right\}$ for some pairwise different numbers $b_{1}<\cdots<b_{s}$ in $A$.

If $s>\sqrt[3]{6 n}$, we will prove that there exist subsets $X$ and $Y$ of $S$ such that $|X|<|Y|$ and $\sum_{x \in X} x=\sum_{y \in Y} y$. Then, deleting the elements of $Y$ from our partition and adding the elements of $X$ to it, we obtain an $A$-partition of $n$ into less than $k_{\min }$ parts, which is the desired contradiction.

For each positive integer $k \leqslant s$, we consider the $k$-element subset

$$
S_{1,0}^{k}:=\left\{b_{1}, \ldots, b_{k}\right\}
$$

as well as the following $k$-element subsets $S_{i, j}^{k}$ of $S$ :

$$
S_{i, j}^{k}:=\left\{b_{1}, \ldots, b_{k-i}, b_{k-i+j+1}, b_{s-i+2}, \ldots, b_{s}\right\}, \quad i=1, \ldots, k, \quad j=1, \ldots, s-k
$$

Pictorially, if we represent the elements of $S$ by a sequence of dots in increasing order, and represent a subset of $S$ by shading in the appropriate dots, we have:\\
\includegraphics[max width=\textwidth, center]{2025_04_30_f697ddf0f0f1661c3074g-27}

Denote by $\Sigma_{i, j}^{k}$ the sum of elements in $S_{i, j}^{k}$. Clearly, $\Sigma_{1,0}^{k}$ is the minimum sum of a $k$-element subset of $S$. Next, for all appropriate indices $i$ and $j$ we have

$$
\Sigma_{i, j}^{k}=\Sigma_{i, j+1}^{k}+b_{k-i+j+1}-b_{k-i+j+2}<\Sigma_{i, j+1}^{k} \quad \text { and } \quad \sum_{i, s-k}^{k}=\sum_{i+1,1}^{k}+b_{k-i}-b_{k-i+1}<\sum_{i+1,1}^{k} .
$$

Therefore

$$
1 \leqslant \sum_{1,0}^{k}<\sum_{1,1}^{k}<\sum_{1,2}^{k}<\cdots<\sum_{1, s-k}^{k}<\sum_{2,1}^{k}<\cdots<\sum_{2, s-k}^{k}<\sum_{3,1}^{k}<\cdots<\sum_{k, s-k}^{k} \leqslant n .
$$

To see this in the picture, we start with the $k$ leftmost points marked. At each step, we look for the rightmost point which can move to the right, and move it one unit to the right. We continue until the $k$ rightmost points are marked. As we do this, the corresponding sums clearly increase.

For each $k$ we have found $k(s-k)+1$ different integers of the form $\sum_{i, j}^{k}$ between 1 and $n$. As we vary $k$, the total number of integers we are considering is

$$
\sum_{k=1}^{s}(k(s-k)+1)=s \cdot \frac{s(s+1)}{2}-\frac{s(s+1)(2 s+1)}{6}+s=\frac{s\left(s^{2}+5\right)}{6}>\frac{s^{3}}{6}>n .
$$

Since they are between 1 and $n$, at least two of these integers are equal. Consequently, there exist $1 \leqslant k<k^{\prime} \leqslant s$ and $X=S_{i, j}^{k}$ as well as $Y=S_{i^{\prime}, j^{\prime}}^{k^{\prime}}$ such that

$$
\sum_{x \in X} x=\sum_{y \in Y} y, \quad \text { but } \quad|X|=k<k^{\prime}=|Y|,
$$

as required. The result follows.",412,3
2013c5,"Let $r$ be a positive integer, and let $a_{0}, a_{1}, \ldots$ be an infinite sequence of real numbers. Assume that for all nonnegative integers $m$ and $s$ there exists a positive integer $n \in[m+1, m+r]$ such that

$$
a_{m}+a_{m+1}+\cdots+a_{m+s}=a_{n}+a_{n+1}+\cdots+a_{n+s} .
$$

Prove that the sequence is periodic, i. e. there exists some $p \geqslant 1$ such that $a_{n+p}=a_{n}$ for all $n \geqslant 0$.","Solution. For every indices $m \leqslant n$ we will denote $S(m, n)=a_{m}+a_{m+1}+\cdots+a_{n-1}$; thus $S(n, n)=0$. Let us start with the following lemma.\\
Lemma. Let $b_{0}, b_{1}, \ldots$ be an infinite sequence. Assume that for every nonnegative integer $m$ there exists a nonnegative integer $n \in[m+1, m+r]$ such that $b_{m}=b_{n}$. Then for every indices $k \leqslant \ell$ there exists an index $t \in[\ell, \ell+r-1]$ such that $b_{t}=b_{k}$. Moreover, there are at most $r$ distinct numbers among the terms of $\left(b_{i}\right)$.\\
Proof. To prove the first claim, let us notice that there exists an infinite sequence of indices $k_{1}=k, k_{2}, k_{3}, \ldots$ such that $b_{k_{1}}=b_{k_{2}}=\cdots=b_{k}$ and $k_{i}<k_{i+1} \leqslant k_{i}+r$ for all $i \geqslant 1$. This sequence is unbounded from above, thus it hits each segment of the form $[\ell, \ell+r-1]$ with $\ell \geqslant k$, as required.

To prove the second claim, assume, to the contrary, that there exist $r+1$ distinct numbers $b_{i_{1}}, \ldots, b_{i_{r+1}}$. Let us apply the first claim to $k=i_{1}, \ldots, i_{r+1}$ and $\ell=\max \left\{i_{1}, \ldots, i_{r+1}\right\}$; we obtain that for every $j \in\{1, \ldots, r+1\}$ there exists $t_{j} \in[s, s+r-1]$ such that $b_{t_{j}}=b_{i_{j}}$. Thus the segment [ $s, s+r-1$ ] should contain $r+1$ distinct integers, which is absurd.

Setting $s=0$ in the problem condition, we see that the sequence $\left(a_{i}\right)$ satisfies the condition of the lemma, thus it attains at most $r$ distinct values. Denote by $A_{i}$ the ordered $r$-tuple $\left(a_{i}, \ldots, a_{i+r-1}\right)$; then among $A_{i}$ 's there are at most $r^{r}$ distinct tuples, so for every $k \geqslant 0$ two of the tuples $A_{k}, A_{k+1}, \ldots, A_{k+r^{r}}$ are identical. This means that there exists a positive integer $p \leqslant r^{r}$ such that the equality $A_{d}=A_{d+p}$ holds infinitely many times. Let $D$ be the set of indices $d$ satisfying this relation.

Now we claim that $D$ coincides with the set of all nonnegative integers. Since $D$ is unbounded, it suffices to show that $d \in D$ whenever $d+1 \in D$. For that, denote $b_{k}=S(k, p+k)$. The sequence $b_{0}, b_{1}, \ldots$ satisfies the lemma conditions, so there exists an index $t \in[d+1, d+r]$ such that $S(t, t+p)=S(d, d+p)$. This last relation rewrites as $S(d, t)=S(d+p, t+p)$. Since $A_{d+1}=A_{d+p+1}$, we have $S(d+1, t)=S(d+p+1, t+p)$, therefore we obtain

$$
a_{d}=S(d, t)-S(d+1, t)=S(d+p, t+p)-S(d+p+1, t+p)=a_{d+p}
$$

and thus $A_{d}=A_{d+p}$, as required.\\
Finally, we get $A_{d}=A_{d+p}$ for all $d$, so in particular $a_{d}=a_{d+p}$ for all $d$, QED.

Comment 1. In the present proof, the upper bound for the minimal period length is $r^{r}$. This bound is not sharp; for instance, one may improve it to $(r-1)^{r}$ for $r \geqslant 3$..

On the other hand, this minimal length may happen to be greater than $r$. For instance, it is easy to check that the sequence with period $(3,-3,3,-3,3,-1,-1,-1)$ satisfies the problem condition for $r=7$.

Comment 2. The conclusion remains true even if the problem condition only holds for every $s \geqslant N$ for some positive integer $N$. To show that, one can act as follows. Firstly, the sums of the form $S(i, i+N)$ attain at most $r$ values, as well as the sums of the form $S(i, i+N+1)$. Thus the terms $a_{i}=S(i, i+N+1)-$ $S(i+1, i+N+1)$ attain at most $r^{2}$ distinct values. Then, among the tuples $A_{k}, A_{k+N}, \ldots, A_{k+r^{2 r} N}$ two\\
are identical, so for some $p \leqslant r^{2 r}$ the set $D=\left\{d: A_{d}=A_{d+N p}\right\}$ is infinite. The further arguments apply almost literally, with $p$ being replaced by $N p$.

After having proved that such a sequence is also necessarily periodic, one may reduce the bound for the minimal period length to $r^{r}$ - essentially by verifying that the sequence satisfies the original version of the condition.",603,4
2013c6,In some country several pairs of cities are connected by direct two-way flights. It is possible to go from any city to any other by a sequence of flights. The distance between two cities is defined to be the least possible number of flights required to go from one of them to the other. It is known that for any city there are at most 100 cities at distance exactly three from it. Prove that there is no city such that more than 2550 other cities have distance exactly four from it.,"Solution. Let us denote by $d(a, b)$ the distance between the cities $a$ and $b$, and by

$$
S_{i}(a)=\{c: d(a, c)=i\}
$$

the set of cities at distance exactly $i$ from city $a$.\\
Assume that for some city $x$ the set $D=S_{4}(x)$ has size at least 2551 . Let $A=S_{1}(x)$. A subset $A^{\prime}$ of $A$ is said to be substantial, if every city in $D$ can be reached from $x$ with four flights while passing through some member of $A^{\prime}$; in other terms, every city in $D$ has distance 3 from some member of $A^{\prime}$, or $D \subseteq \bigcup_{a \in A^{\prime}} S_{3}(a)$. For instance, $A$ itself is substantial. Now let us fix some substantial subset $A^{*}$ of $A$ having the minimal cardinality $m=\left|A^{*}\right|$.

Since

$$
m(101-m) \leqslant 50 \cdot 51=2550,
$$

there has to be a city $a \in A^{*}$ such that $\left|S_{3}(a) \cap D\right| \geqslant 102-m$. As $\left|S_{3}(a)\right| \leqslant 100$, we obtain that $S_{3}(a)$ may contain at most $100-(102-m)=m-2$ cities $c$ with $d(c, x) \leqslant 3$. Let us denote by $T=\left\{c \in S_{3}(a): d(x, c) \leqslant 3\right\}$ the set of all such cities, so $|T| \leqslant m-2$. Now, to get a contradiction, we will construct $m-1$ distinct elements in $T$, corresponding to $m-1$ elements of the set $A_{a}=A^{*} \backslash\{a\}$.

Firstly, due to the minimality of $A^{*}$, for each $y \in A_{a}$ there exists some city $d_{y} \in D$ which can only be reached with four flights from $x$ by passing through $y$. So, there is a way to get from $x$ to $d_{y}$ along $x-y-b_{y}-c_{y}-d_{y}$ for some cities $b_{y}$ and $c_{y}$; notice that $d\left(x, b_{y}\right)=2$ and $d\left(x, c_{y}\right)=3$ since this path has the minimal possible length.

Now we claim that all $2(m-1)$ cities of the form $b_{y}, c_{y}$ with $y \in A_{a}$ are distinct. Indeed, no $b_{y}$ may coincide with any $c_{z}$ since their distances from $x$ are different. On the other hand, if one had $b_{y}=b_{z}$ for $y \neq z$, then there would exist a path of length 4 from $x$ to $d_{z}$ via $y$, namely $x-y-b_{z}-c_{z}-d_{z}$; this is impossible by the choice of $d_{z}$. Similarly, $c_{y} \neq c_{z}$ for $y \neq z$.

So, it suffices to prove that for every $y \in A_{a}$, one of the cities $b_{y}$ and $c_{y}$ has distance 3 from $a$ (and thus belongs to $T$ ). For that, notice that $d(a, y) \leqslant 2$ due to the path $a-x-y$, while $d\left(a, d_{y}\right) \geqslant d\left(x, d_{y}\right)-d(x, a)=3$. Moreover, $d\left(a, d_{y}\right) \neq 3$ by the choice of $d_{y} ;$ thus $d\left(a, d_{y}\right)>3$. Finally, in the sequence $d(a, y), d\left(a, b_{y}\right), d\left(a, c_{y}\right), d\left(a, d_{y}\right)$ the neighboring terms differ by at most 1 , the first term is less than 3 , and the last one is greater than 3 ; thus there exists one which is equal to 3 , as required.

Comment 1. The upper bound 2550 is sharp. This can be seen by means of various examples; one of them is the ""Roman Empire"": it has one capital, called ""Rome"", that is connected to 51 semicapitals by internally disjoint paths of length 3 . Moreover, each of these semicapitals is connected to 50 rural cities by direct flights.

Comment 2. Observe that, under the conditions of the problem, there exists no bound for the size of $S_{1}(x)$ or $S_{2}(x)$.

Comment 3. The numbers 100 and 2550 appearing in the statement of the problem may be replaced by $n$ and $\left\lfloor\frac{(n+1)^{2}}{4}\right\rfloor$ for any positive integer $n$. Still more generally, one can also replace the pair $(3,4)$ of distances under consideration by any pair $(r, s)$ of positive integers satisfying $r<s \leqslant \frac{3}{2} r$.

To adapt the above proof to this situation, one takes $A=S_{s-r}(x)$ and defines the concept of substantiality as before. Then one takes $A^{*}$ to be a minimal substantial subset of $A$, and for each $y \in A^{*}$ one fixes an element $d_{y} \in S_{s}(x)$ which is only reachable from $x$ by a path of length $s$ by passing through $y$. As before, it suffices to show that for distinct $a, y \in A^{*}$ and a path $y=y_{0}-y_{1}-\ldots-y_{r}=d_{y}$, at least one of the cities $y_{0}, \ldots, y_{r-1}$ has distance $r$ from $a$. This can be done as above; the relation $s \leqslant \frac{3}{2} r$ is used here to show that $d\left(a, y_{0}\right) \leqslant r$.

Moreover, the estimate $\left\lfloor\frac{(n+1)^{2}}{4}\right\rfloor$ is also sharp for every positive integer $n$ and every positive integers $r, s$ with $r<s \leqslant \frac{3}{2} r$. This may be shown by an example similar to that in the previous comment.",750,4
2013c7,"Let $n \geqslant 2$ be an integer. Consider all circular arrangements of the numbers $0,1, \ldots, n$; the $n+1$ rotations of an arrangement are considered to be equal. A circular arrangement is called beautiful if, for any four distinct numbers $0 \leqslant a, b, c, d \leqslant n$ with $a+c=b+d$, the chord joining numbers $a$ and $c$ does not intersect the chord joining numbers $b$ and $d$.

Let $M$ be the number of beautiful arrangements of $0,1, \ldots, n$. Let $N$ be the number of pairs $(x, y)$ of positive integers such that $x+y \leqslant n$ and $\operatorname{gcd}(x, y)=1$. Prove that


\begin{equation*}
M=N+1 \tag{Russia}
\end{equation*}","Given a circular arrangement of $[0, n]=\{0,1, \ldots, n\}$, we define a $k$-chord to be a (possibly degenerate) chord whose (possibly equal) endpoints add up to $k$. We say that three chords of a circle are aligned if one of them separates the other two. Say that $m \geqslant 3$ chords are aligned if any three of them are aligned. For instance, in Figure 1, $A, B$, and $C$ are aligned, while $B, C$, and $D$ are not.\\

Claim. In a beautiful arrangement, the $k$-chords are aligned for any integer $k$.\\
Proof. We proceed by induction. For $n \leqslant 3$ the statement is trivial. Now let $n \geqslant 4$, and proceed by contradiction. Consider a beautiful arrangement $S$ where the three $k$-chords $A, B, C$ are not aligned. If $n$ is not among the endpoints of $A, B$, and $C$, then by deleting $n$ from $S$ we obtain a beautiful arrangement $S \backslash\{n\}$ of $[0, n-1]$, where $A, B$, and $C$ are aligned by the induction hypothesis. Similarly, if 0 is not among these endpoints, then deleting 0 and decreasing all the numbers by 1 gives a beautiful arrangement $S \backslash\{0\}$ where $A, B$, and $C$ are aligned. Therefore both 0 and $n$ are among the endpoints of these segments. If $x$ and $y$ are their respective partners, we have $n \geqslant 0+x=k=n+y \geqslant n$. Thus 0 and $n$ are the endpoints of one of the chords; say it is $C$.

Let $D$ be the chord formed by the numbers $u$ and $v$ which are adjacent to 0 and $n$ and on the same side of $C$ as $A$ and $B$, as shown in Figure 2. Set $t=u+v$. If we had $t=n$, the $n$-chords $A$, $B$, and $D$ would not be aligned in the beautiful arrangement $S \backslash\{0, n\}$, contradicting the induction hypothesis. If $t<n$, then the $t$-chord from 0 to $t$ cannot intersect $D$, so the chord $C$ separates $t$ and $D$. The chord $E$ from $t$ to $n-t$ does not intersect $C$, so $t$ and $n-t$ are on the same side of $C$. But then the chords $A, B$, and $E$ are not aligned in $S \backslash\{0, n\}$, a contradiction. Finally, the case $t>n$ is equivalent to the case $t<n$ via the beauty-preserving relabelling $x \mapsto n-x$ for $0 \leqslant x \leqslant n$, which sends $t$-chords to $(2 n-t)$-chords. This proves the Claim.

Having established the Claim, we prove the desired result by induction. The case $n=2$ is trivial. Now assume that $n \geqslant 3$. Let $S$ be a beautiful arrangement of $[0, n]$ and delete $n$ to obtain\\
the beautiful arrangement $T$ of $[0, n-1]$. The $n$-chords of $T$ are aligned, and they contain every point except 0 . Say $T$ is of Type 1 if 0 lies between two of these $n$-chords, and it is of Type 2 otherwise; i.e., if 0 is aligned with these $n$-chords. We will show that each Type 1 arrangement of $[0, n-1]$ arises from a unique arrangement of $[0, n]$, and each Type 2 arrangement of $[0, n-1]$ arises from exactly two beautiful arrangements of $[0, n]$.

If $T$ is of Type 1 , let 0 lie between chords $A$ and $B$. Since the chord from 0 to $n$ must be aligned with $A$ and $B$ in $S, n$ must be on the other arc between $A$ and $B$. Therefore $S$ can be recovered uniquely from $T$. In the other direction, if $T$ is of Type 1 and we insert $n$ as above, then we claim the resulting arrangement $S$ is beautiful. For $0<k<n$, the $k$-chords of $S$ are also $k$-chords of $T$, so they are aligned. Finally, for $n<k<2 n$, notice that the $n$-chords of $S$ are parallel by construction, so there is an antisymmetry axis $\ell$ such that $x$ is symmetric to $n-x$ with respect to $\ell$ for all $x$. If we had two $k$-chords which intersect, then their reflections across $\ell$ would be two $(2 n-k)$-chords which intersect, where $0<2 n-k<n$, a contradiction.

If $T$ is of Type 2 , there are two possible positions for $n$ in $S$, on either side of 0 . As above, we check that both positions lead to beautiful arrangements of $[0, n]$.

Hence if we let $M_{n}$ be the number of beautiful arrangements of $[0, n]$, and let $L_{n}$ be the number of beautiful arrangements of $[0, n-1]$ of Type 2, we have

$$
M_{n}=\left(M_{n-1}-L_{n-1}\right)+2 L_{n-1}=M_{n-1}+L_{n-1} .
$$

It then remains to show that $L_{n-1}$ is the number of pairs $(x, y)$ of positive integers with $x+y=n$ and $\operatorname{gcd}(x, y)=1$. Since $n \geqslant 3$, this number equals $\varphi(n)=\#\{x: 1 \leqslant x \leqslant n, \operatorname{gcd}(x, n)=1\}$.

To prove this, consider a Type 2 beautiful arrangement of $[0, n-1]$. Label the positions $0, \ldots, n-1(\bmod n)$ clockwise around the circle, so that number 0 is in position 0 . Let $f(i)$ be the number in position $i$; note that $f$ is a permutation of $[0, n-1]$. Let $a$ be the position such that $f(a)=n-1$.

Since the $n$-chords are aligned with 0 , and every point is in an $n$-chord, these chords are all parallel and

$$
f(i)+f(-i)=n \quad \text { for all } i
$$

Similarly, since the $(n-1)$-chords are aligned and every point is in an $(n-1)$-chord, these chords are also parallel and

$$
f(i)+f(a-i)=n-1 \quad \text { for all } i .
$$

Therefore $f(a-i)=f(-i)-1$ for all $i$; and since $f(0)=0$, we get


\begin{equation*}
f(-a k)=k \quad \text { for all } k \tag{1}
\end{equation*}


Recall that this is an equality modulo $n$. Since $f$ is a permutation, we must have $(a, n)=1$. Hence $L_{n-1} \leqslant \varphi(n)$.

To prove equality, it remains to observe that the labeling (1) is beautiful. To see this, consider four numbers $w, x, y, z$ on the circle with $w+y=x+z$. Their positions around the circle satisfy $(-a w)+(-a y)=(-a x)+(-a z)$, which means that the chord from $w$ to $y$ and the chord from $x$ to $z$ are parallel. Thus (1) is beautiful, and by construction it has Type 2. The desired result follows.",1009,4
2013g1," Let $A B C$ be an acute-angled triangle with orthocenter $H$, and let $W$ be a point on side $B C$. Denote by $M$ and $N$ the feet of the altitudes from $B$ and $C$, respectively. Denote by $\omega_{1}$ the circumcircle of $B W N$, and let $X$ be the point on $\omega_{1}$ which is diametrically opposite to $W$. Analogously, denote by $\omega_{2}$ the circumcircle of $C W M$, and let $Y$ be the point on $\omega_{2}$ which is diametrically opposite to $W$. Prove that $X, Y$ and $H$ are collinear.","Solution. Let $L$ be the foot of the altitude from $A$, and let $Z$ be the second intersection point of circles $\omega_{1}$ and $\omega_{2}$, other than $W$. We show that $X, Y, Z$ and $H$ lie on the same line.

Due to $\angle B N C=\angle B M C=90^{\circ}$, the points $B, C, N$ and $M$ are concyclic; denote their circle by $\omega_{3}$. Observe that the line $W Z$ is the radical axis of $\omega_{1}$ and $\omega_{2}$; similarly, $B N$ is the radical axis of $\omega_{1}$ and $\omega_{3}$, and $C M$ is the radical axis of $\omega_{2}$ and $\omega_{3}$. Hence $A=B N \cap C M$ is the radical center of the three circles, and therefore $W Z$ passes through $A$.

Since $W X$ and $W Y$ are diameters in $\omega_{1}$ and $\omega_{2}$, respectively, we have $\angle W Z X=\angle W Z Y=90^{\circ}$, so the points $X$ and $Y$ lie on the line through $Z$, perpendicular to $W Z$.\\
\includegraphics[max width=\textwidth, center]{2025_04_30_f697ddf0f0f1661c3074g-39}

The quadrilateral $B L H N$ is cyclic, because it has two opposite right angles. From the power of $A$ with respect to the circles $\omega_{1}$ and $B L H N$ we find $A L \cdot A H=A B \cdot A N=A W \cdot A Z$. If $H$ lies on the line $A W$ then this implies $H=Z$ immediately. Otherwise, by $\frac{A Z}{A H}=\frac{A L}{A W}$ the triangles $A H Z$ and $A W L$ are similar. Then $\angle H Z A=\angle W L A=90^{\circ}$, so the point $H$ also lies on the line $X Y Z$.

Comment. The original proposal also included a second statement:\\
Let $P$ be the point on $\omega_{1}$ such that $W P$ is parallel to $C N$, and let $Q$ be the point on $\omega_{2}$ such that $W Q$ is parallel to $B M$. Prove that $P, Q$ and $H$ are collinear if and only if $B W=C W$ or $A W \perp B C$.

The Problem Selection Committee considered the first part more suitable for the competition.",334,3
2013g2,"Let $\omega$ be the circumcircle of a triangle $A B C$. Denote by $M$ and $N$ the midpoints of the sides $A B$ and $A C$, respectively, and denote by $T$ the midpoint of the $\operatorname{arc} B C$ of $\omega$ not containing $A$. The circumcircles of the triangles $A M T$ and $A N T$ intersect the perpendicular bisectors of $A C$ and $A B$ at points $X$ and $Y$, respectively; assume that $X$ and $Y$ lie inside the triangle $A B C$. The lines $M N$ and $X Y$ intersect at $K$. Prove that $K A=K T$.","Let $O$ be the center of $\omega$, thus $O=M Y \cap N X$. Let $\ell$ be the perpendicular bisector of $A T$ (it also passes through $O$ ). Denote by $r$ the operation of reflection about $\ell$. Since $A T$ is the angle bisector of $\angle B A C$, the line $r(A B)$ is parallel to $A C$. Since $O M \perp A B$ and $O N \perp A C$, this means that the line $r(O M)$ is parallel to the line $O N$ and passes through $O$, so $r(O M)=O N$. Finally, the circumcircle $\gamma$ of the triangle $A M T$ is symmetric about $\ell$, so $r(\gamma)=\gamma$. Thus the point $M$ maps to the common point of $O N$ with the arc $A M T$ of $\gamma$ - that is, $r(M)=X$.

Similarly, $r(N)=Y$. Thus, we get $r(M N)=X Y$, and the common point $K$ of $M N$ nd $X Y$ lies on $\ell$. This means exactly that $K A=K T$.\\
",161,2
2013g3,"In a triangle $A B C$, let $D$ and $E$ be the feet of the angle bisectors of angles $A$ and $B$, respectively. A rhombus is inscribed into the quadrilateral $A E D B$ (all vertices of the rhombus lie on different sides of $A E D B$ ). Let $\varphi$ be the non-obtuse angle of the rhombus. Prove that $\varphi \leqslant \max \{\angle B A C, \angle A B C\}$.","Let $K, L, M$, and $N$ be the vertices of the rhombus lying on the sides $A E, E D, D B$, and $B A$, respectively. Denote by $d(X, Y Z)$ the distance from a point $X$ to a line $Y Z$. Since $D$ and $E$ are the feet of the bisectors, we have $d(D, A B)=d(D, A C), d(E, A B)=d(E, B C)$, and $d(D, B C)=d(E, A C)=0$, which implies

$$
d(D, A C)+d(D, B C)=d(D, A B) \quad \text { and } \quad d(E, A C)+d(E, B C)=d(E, A B)
$$

Since $L$ lies on the segment $D E$ and the relation $d(X, A C)+d(X, B C)=d(X, A B)$ is linear in $X$ inside the triangle, these two relations imply


\begin{equation*}
d(L, A C)+d(L, B C)=d(L, A B) . \tag{1}
\end{equation*}


Denote the angles as in the figure below, and denote $a=K L$. Then we have $d(L, A C)=a \sin \mu$ and $d(L, B C)=a \sin \nu$. Since $K L M N$ is a parallelogram lying on one side of $A B$, we get

$$
d(L, A B)=d(L, A B)+d(N, A B)=d(K, A B)+d(M, A B)=a(\sin \delta+\sin \varepsilon) .
$$

Thus the condition (1) reads


\begin{equation*}
\sin \mu+\sin \nu=\sin \delta+\sin \varepsilon \tag{2}
\end{equation*}


\begin{center}
\includegraphics[max width=\textwidth]{2025_04_30_f697ddf0f0f1661c3074g-42}
\end{center}

If one of the angles $\alpha$ and $\beta$ is non-acute, then the desired inequality is trivial. So we assume that $\alpha, \beta<\pi / 2$. It suffices to show then that $\psi=\angle N K L \leqslant \max \{\alpha, \beta\}$.

Assume, to the contrary, that $\psi>\max \{\alpha, \beta\}$. Since $\mu+\psi=\angle C K N=\alpha+\delta$, by our assumption we obtain $\mu=(\alpha-\psi)+\delta<\delta$. Similarly, $\nu<\varepsilon$. Next, since $K N \| M L$, we have $\beta=\delta+\nu$, so $\delta<\beta<\pi / 2$. Similarly, $\varepsilon<\pi / 2$. Finally, by $\mu<\delta<\pi / 2$ and $\nu<\varepsilon<\pi / 2$, we obtain

$$
\sin \mu<\sin \delta \quad \text { and } \quad \sin \nu<\sin \varepsilon
$$

This contradicts (2).\\
Comment. One can see that the equality is achieved if $\alpha=\beta$ for every rhombus inscribed into the quadrilateral $A E D B$.",337,3
2013g4,Let $A B C$ be a triangle with $\angle B>\angle C$. Let $P$ and $Q$ be two different points on line $A C$ such that $\angle P B A=\angle Q B A=\angle A C B$ and $A$ is located between $P$ and $C$. Suppose that there exists an interior point $D$ of segment $B Q$ for which $P D=P B$. Let the ray $A D$ intersect the circle $A B C$ at $R \neq A$. Prove that $Q B=Q R$.,"Denote by $\omega$ the circumcircle of the triangle $A B C$, and let $\angle A C B=\gamma$. Note that the condition $\gamma<\angle C B A$ implies $\gamma<90^{\circ}$. Since $\angle P B A=\gamma$, the line $P B$ is tangent to $\omega$, so $P A \cdot P C=P B^{2}=P D^{2}$. By $\frac{P A}{P D}=\frac{P D}{P C}$ the triangles $P A D$ and $P D C$ are similar, and $\angle A D P=\angle D C P$.

Next, since $\angle A B Q=\angle A C B$, the triangles $A B C$ and $A Q B$ are also similar. Then $\angle A Q B=$ $\angle A B C=\angle A R C$, which means that the points $D, R, C$, and $Q$ are concyclic. Therefore $\angle D R Q=$ $\angle D C Q=\angle A D P$.\\

Now from $\angle A R B=\angle A C B=\gamma$ and $\angle P D B=\angle P B D=2 \gamma$ we get

$$
\angle Q B R=\angle A D B-\angle A R B=\angle A D P+\angle P D B-\angle A R B=\angle D R Q+\gamma=\angle Q R B,
$$

so the triangle $Q R B$ is isosceles, which yields $Q B=Q R$.\\
",190,2
2013g5,"Let $A B C D E F$ be a convex hexagon with $A B=D E, B C=E F, C D=F A$, and $\angle A-\angle D=\angle C-\angle F=\angle E-\angle B$. Prove that the diagonals $A D, B E$, and $C F$ are concurrent.","We denote $\theta=\angle A-\angle D=\angle C-\angle F=\angle E-\angle B$ and assume without loss of generality that $\theta \geqslant 0$.

Let $x=A B=D E, y=C D=F A, z=E F=B C$. Consider the points $P, Q$, and $R$ such that the quadrilaterals $C D E P, E F A Q$, and $A B C R$ are parallelograms. We compute

$$
\begin{aligned}
\angle P E Q & =\angle F E Q+\angle D E P-\angle E=\left(180^{\circ}-\angle F\right)+\left(180^{\circ}-\angle D\right)-\angle E \\
& =360^{\circ}-\angle D-\angle E-\angle F=\frac{1}{2}(\angle A+\angle B+\angle C-\angle D-\angle E-\angle F)=\theta / 2 .
\end{aligned}
$$

Similarly, $\angle Q A R=\angle R C P=\theta / 2$.\\
\includegraphics[max width=\textwidth, center]{2025_04_30_f697ddf0f0f1661c3074g-46}

If $\theta=0$, since $\triangle R C P$ is isosceles, $R=P$. Therefore $A B\|R C=P C\| E D$, so $A B D E$ is a parallelogram. Similarly, $B C E F$ and $C D F A$ are parallelograms. It follows that $A D, B E$ and $C F$ meet at their common midpoint.

Now assume $\theta>0$. Since $\triangle P E Q, \triangle Q A R$, and $\triangle R C P$ are isosceles and have the same angle at the apex, we have $\triangle P E Q \sim \triangle Q A R \sim \triangle R C P$ with ratios of similarity $y: z: x$. Thus


\begin{equation*}
\triangle P Q R \text { is similar to the triangle with sidelengths } y, z, \text { and } x \text {. } \tag{1}
\end{equation*}


Next, notice that

$$
\frac{R Q}{Q P}=\frac{z}{y}=\frac{R A}{A F}
$$

and, using directed angles between rays,

$$
\begin{aligned}
\Varangle(R Q, Q P) & =\Varangle(R Q, Q E)+\not(Q E, Q P) \\
& =\Varangle(R Q, Q E)+\Varangle(R A, R Q)=\Varangle(R A, Q E)=\not(R A, A F) .
\end{aligned}
$$

Thus $\triangle P Q R \sim \triangle F A R$. Since $F A=y$ and $A R=z$, (1) then implies that $F R=x$. Similarly $F P=x$. Therefore $C R F P$ is a rhombus.

We conclude that $C F$ is the perpendicular bisector of $P R$. Similarly, $B E$ is the perpendicular bisector of $P Q$ and $A D$ is the perpendicular bisector of $Q R$. It follows that $A D, B E$, and $C F$ are concurrent at the circumcenter of $P Q R$.",367,3
2013g6,Let the excircle of the triangle $A B C$ lying opposite to $A$ touch its side $B C$ at the point $A_{1}$. Define the points $B_{1}$ and $C_{1}$ analogously. Suppose that the circumcentre of the triangle $A_{1} B_{1} C_{1}$ lies on the circumcircle of the triangle $A B C$. Prove that the triangle $A B C$ is right-angled.,"Denote the circumcircles of the triangles $A B C$ and $A_{1} B_{1} C_{1}$ by $\Omega$ and $\Gamma$, respectively. Denote the midpoint of the arc $C B$ of $\Omega$ containing $A$ by $A_{0}$, and define $B_{0}$ as well as $C_{0}$ analogously. By our hypothesis the centre $Q$ of $\Gamma$ lies on $\Omega$.\\
Lemma. One has $A_{0} B_{1}=A_{0} C_{1}$. Moreover, the points $A, A_{0}, B_{1}$, and $C_{1}$ are concyclic. Finally, the points $A$ and $A_{0}$ lie on the same side of $B_{1} C_{1}$. Similar statements hold for $B$ and $C$.\\
Proof. Let us consider the case $A=A_{0}$ first. Then the triangle $A B C$ is isosceles at $A$, which implies $A B_{1}=A C_{1}$ while the remaining assertions of the Lemma are obvious. So let us suppose $A \neq A_{0}$ from now on.

By the definition of $A_{0}$, we have $A_{0} B=A_{0} C$. It is also well known and easy to show that $B C_{1}=$ $C B_{1}$. Next, we have $\angle C_{1} B A_{0}=\angle A B A_{0}=\angle A C A_{0}=\angle B_{1} C A_{0}$. Hence the triangles $A_{0} B C_{1}$ and $A_{0} C B_{1}$ are congruent. This implies $A_{0} C_{1}=A_{0} B_{1}$, establishing the first part of the Lemma. It also follows that $\angle A_{0} C_{1} A=\angle A_{0} B_{1} A$, as these are exterior angles at the corresponding vertices $C_{1}$ and $B_{1}$ of the congruent triangles $A_{0} B C_{1}$ and $A_{0} C B_{1}$. For that reason the points $A, A_{0}, B_{1}$, and $C_{1}$ are indeed the vertices of some cyclic quadrilateral two opposite sides of which are $A A_{0}$ and $B_{1} C_{1}$.

Now we turn to the solution. Evidently the points $A_{1}, B_{1}$, and $C_{1}$ lie interior to some semicircle arc of $\Gamma$, so the triangle $A_{1} B_{1} C_{1}$ is obtuse-angled. Without loss of generality, we will assume that its angle at $B_{1}$ is obtuse. Thus $Q$ and $B_{1}$ lie on different sides of $A_{1} C_{1}$; obviously, the same holds for the points $B$ and $B_{1}$. So, the points $Q$ and $B$ are on the same side of $A_{1} C_{1}$.

Notice that the perpendicular bisector of $A_{1} C_{1}$ intersects $\Omega$ at two points lying on different sides of $A_{1} C_{1}$. By the first statement from the Lemma, both points $B_{0}$ and $Q$ are among these points of intersection; since they share the same side of $A_{1} C_{1}$, they coincide (see Figure 1).\\

Now, by the first part of the Lemma again, the lines $Q A_{0}$ and $Q C_{0}$ are the perpendicular bisectors of $B_{1} C_{1}$ and $A_{1} B_{1}$, respectively. Thus

$$
\angle C_{1} B_{0} A_{1}=\angle C_{1} B_{0} B_{1}+\angle B_{1} B_{0} A_{1}=2 \angle A_{0} B_{0} B_{1}+2 \angle B_{1} B_{0} C_{0}=2 \angle A_{0} B_{0} C_{0}=180^{\circ}-\angle A B C,
$$

recalling that $A_{0}$ and $C_{0}$ are the midpoints of the arcs $C B$ and $B A$, respectively.\\
On the other hand, by the second part of the Lemma we have

$$
\angle C_{1} B_{0} A_{1}=\angle C_{1} B A_{1}=\angle A B C .
$$

From the last two equalities, we get $\angle A B C=90^{\circ}$, whereby the problem is solved.\\",501,4
2013n2,"Prove that for any pair of positive integers $k$ and $n$ there exist $k$ positive integers $m_{1}, m_{2}, \ldots, m_{k}$ such that

$$
1+\frac{2^{k}-1}{n}=\left(1+\frac{1}{m_{1}}\right)\left(1+\frac{1}{m_{2}}\right) \cdots\left(1+\frac{1}{m_{k}}\right) .
$$","We proceed by induction on $k$. For $k=1$ the statement is trivial. Assuming we have proved it for $k=j-1$, we now prove it for $k=j$.

Case 1. $n=2 t-1$ for some positive integer $t$.\\
Observe that

$$
1+\frac{2^{j}-1}{2 t-1}=\frac{2\left(t+2^{j-1}-1\right)}{2 t} \cdot \frac{2 t}{2 t-1}=\left(1+\frac{2^{j-1}-1}{t}\right)\left(1+\frac{1}{2 t-1}\right)
$$

By the induction hypothesis we can find $m_{1}, \ldots, m_{j-1}$ such that

$$
1+\frac{2^{j-1}-1}{t}=\left(1+\frac{1}{m_{1}}\right)\left(1+\frac{1}{m_{2}}\right) \cdots\left(1+\frac{1}{m_{j-1}}\right)
$$

so setting $m_{j}=2 t-1$ gives the desired expression.\\
Case 2. $n=2 t$ for some positive integer $t$.\\
Now we have

$$
1+\frac{2^{j}-1}{2 t}=\frac{2 t+2^{j}-1}{2 t+2^{j}-2} \cdot \frac{2 t+2^{j}-2}{2 t}=\left(1+\frac{1}{2 t+2^{j}-2}\right)\left(1+\frac{2^{j-1}-1}{t}\right)
$$

noting that $2 t+2^{j}-2>0$. Again, we use that

$$
1+\frac{2^{j-1}-1}{t}=\left(1+\frac{1}{m_{1}}\right)\left(1+\frac{1}{m_{2}}\right) \cdots\left(1+\frac{1}{m_{j-1}}\right)
$$

Setting $m_{j}=2 t+2^{j}-2$ then gives the desired expression.\\",113,2
2013n3,Prove that there exist infinitely many positive integers $n$ such that the largest prime divisor of $n^{4}+n^{2}+1$ is equal to the largest prime divisor of $(n+1)^{4}+(n+1)^{2}+1$.,"Solution. Let $p_{n}$ be the largest prime divisor of $n^{4}+n^{2}+1$ and let $q_{n}$ be the largest prime divisor of $n^{2}+n+1$. Then $p_{n}=q_{n^{2}}$, and from

$$
n^{4}+n^{2}+1=\left(n^{2}+1\right)^{2}-n^{2}=\left(n^{2}-n+1\right)\left(n^{2}+n+1\right)=\left((n-1)^{2}+(n-1)+1\right)\left(n^{2}+n+1\right)
$$

it follows that $p_{n}=\max \left\{q_{n}, q_{n-1}\right\}$ for $n \geqslant 2$. Keeping in mind that $n^{2}-n+1$ is odd, we have

$$
\operatorname{gcd}\left(n^{2}+n+1, n^{2}-n+1\right)=\operatorname{gcd}\left(2 n, n^{2}-n+1\right)=\operatorname{gcd}\left(n, n^{2}-n+1\right)=1
$$

Therefore $q_{n} \neq q_{n-1}$.\\
To prove the result, it suffices to show that the set

$$
S=\left\{n \in \mathbb{Z}_{\geqslant 2} \mid q_{n}>q_{n-1} \text { and } q_{n}>q_{n+1}\right\}
$$

is infinite, since for each $n \in S$ one has

$$
p_{n}=\max \left\{q_{n}, q_{n-1}\right\}=q_{n}=\max \left\{q_{n}, q_{n+1}\right\}=p_{n+1} .
$$

Suppose on the contrary that $S$ is finite. Since $q_{2}=7<13=q_{3}$ and $q_{3}=13>7=q_{4}$, the set $S$ is non-empty. Since it is finite, we can consider its largest element, say $m$.

Note that it is impossible that $q_{m}>q_{m+1}>q_{m+2}>\ldots$ because all these numbers are positive integers, so there exists a $k \geqslant m$ such that $q_{k}<q_{k+1}$ (recall that $q_{k} \neq q_{k+1}$ ). Next observe that it is impossible to have $q_{k}<q_{k+1}<q_{k+2}<\ldots$, because $q_{(k+1)^{2}}=p_{k+1}=\max \left\{q_{k}, q_{k+1}\right\}=q_{k+1}$, so let us take the smallest $\ell \geqslant k+1$ such that $q_{\ell}>q_{\ell+1}$. By the minimality of $\ell$ we have $q_{\ell-1}<q_{\ell}$, so $\ell \in S$. Since $\ell \geqslant k+1>k \geqslant m$, this contradicts the maximality of $m$, and hence $S$ is indeed infinite.

Comment. Once the factorization of $n^{4}+n^{2}+1$ is found and the set $S$ is introduced, the problem is mainly about ruling out the case that


\begin{equation*}
q_{k}<q_{k+1}<q_{k+2}<\ldots \tag{1}
\end{equation*}


might hold for some $k \in \mathbb{Z}_{>0}$. In the above solution, this is done by observing $q_{(k+1)^{2}}=\max \left(q_{k}, q_{k+1}\right)$. Alternatively one may notice that (1) implies that $q_{j+2}-q_{j} \geqslant 6$ for $j \geqslant k+1$, since every prime greater than 3 is congruent to -1 or 1 modulo 6 . Then there is some integer $C \geqslant 0$ such that $q_{n} \geqslant 3 n-C$ for all $n \geqslant k$.

Now let the integer $t$ be sufficiently large (e.g. $t=\max \{k+1, C+3\}$ ) and set $p=q_{t-1} \geqslant 2 t$. Then $p \mid(t-1)^{2}+(t-1)+1$ implies that $p \mid(p-t)^{2}+(p-t)+1$, so $p$ and $q_{p-t}$ are prime divisors of $(p-t)^{2}+(p-t)+1$. But $p-t>t-1 \geqslant k$, so $q_{p-t}>q_{t-1}=p$ and $p \cdot q_{p-t}>p^{2}>(p-t)^{2}+(p-t)+1$, a contradiction.",356,3
2013n5,"Fix an integer $k \geqslant 2$. Two players, called Ana and Banana, play the following game of numbers: Initially, some integer $n \geqslant k$ gets written on the blackboard. Then they take moves in turn, with Ana beginning. A player making a move erases the number $m$ just written on the blackboard and replaces it by some number $m^{\prime}$ with $k \leqslant m^{\prime}<m$ that is coprime to $m$. The first player who cannot move anymore loses.

An integer $n \geqslant k$ is called good if Banana has a winning strategy when the initial number is $n$, and bad otherwise.

Consider two integers $n, n^{\prime} \geqslant k$ with the property that each prime number $p \leqslant k$ divides $n$ if and only if it divides $n^{\prime}$. Prove that either both $n$ and $n^{\prime}$ are good or both are bad.","Let us first observe that the number appearing on the blackboard decreases after every move; so the game necessarily ends after at most $n$ steps, and consequently there always has to be some player possessing a winning strategy. So if some $n \geqslant k$ is bad, then Ana has a winning strategy in the game with starting number $n$.

More precisely, if $n \geqslant k$ is such that there is a good integer $m$ with $n>m \geqslant k$ and $\operatorname{gcd}(m, n)=1$, then $n$ itself is bad, for Ana has the following winning strategy in the game with initial number $n$ : She proceeds by first playing $m$ and then using Banana's strategy for the game with starting number $m$.

Otherwise, if some integer $n \geqslant k$ has the property that every integer $m$ with $n>m \geqslant k$ and $\operatorname{gcd}(m, n)=1$ is bad, then $n$ is good. Indeed, if Ana can make a first move at all in the game with initial number $n$, then she leaves it in a position where the first player has a winning strategy, so that Banana can defeat her.

In particular, this implies that any two good numbers have a non-trivial common divisor. Also, $k$ itself is good.

For brevity, we say that $n \longrightarrow x$ is a move if $n$ and $x$ are two coprime integers with $n>x \geqslant k$.\\
Claim 1. If $n$ is good and $n^{\prime}$ is a multiple of $n$, then $n^{\prime}$ is also good.\\
Proof. If $n^{\prime}$ were bad, there would have to be some move $n^{\prime} \longrightarrow x$, where $x$ is good. As $n^{\prime}$ is a multiple of $n$ this implies that the two good numbers $n$ and $x$ are coprime, which is absurd.

Claim 2. If $r$ and $s$ denote two positive integers for which $r s \geqslant k$ is bad, then $r^{2} s$ is also bad.\\
Proof. Since $r s$ is bad, there is a move $r s \longrightarrow x$ for some good $x$. Evidently $x$ is coprime to $r^{2} s$ as well, and hence the move $r^{2} s \longrightarrow x$ shows that $r^{2} s$ is indeed bad.

Claim 3. If $p>k$ is prime and $n \geqslant k$ is bad, then np is also bad.\\
Proof. Otherwise we choose a counterexample with $n$ being as small as possible. In particular, $n p$ is good. Since $n$ is bad, there is a move $n \longrightarrow x$ for some good $x$. Now $n p \longrightarrow x$ cannot be a valid move, which tells us that $x$ has to be divisible by $p$. So we can write $x=p^{r} y$, where $r$ and $y$ denote some positive integers, the latter of which is not divisible by $p$.

Note that $y=1$ is impossible, for then we would have $x=p^{r}$ and the move $x \longrightarrow k$ would establish that $x$ is bad. In view of this, there is a least power $y^{\alpha}$ of $y$ that is at least as large as $k$. Since the numbers $n p$ and $y^{\alpha}$ are coprime and the former is good, the latter has to be bad. Moreover, the minimality of $\alpha$ implies $y^{\alpha}<k y<p y=\frac{x}{p^{r-1}}<\frac{n}{p^{r-1}}$. So $p^{r-1} \cdot y^{\alpha}<n$ and consequently all the numbers $y^{\alpha}, p y^{\alpha}, \ldots, p^{r} \cdot y^{\alpha}=p\left(p^{r-1} \cdot y^{\alpha}\right)$ are bad due to the minimal choice of $n$. But now by Claim 1 the divisor $x$ of $p^{r} \cdot y^{\alpha}$ cannot be good, whereby we have reached a contradiction that proves Claim 3.

We now deduce the statement of the problem from these three claims. To this end, we call two integers $a, b \geqslant k$ similar if they are divisible by the same prime numbers not exceeding $k$. We are to prove that if $a$ and $b$ are similar, then either both of them are good or both are bad. As in this case the product $a b$ is similar to both $a$ and $b$, it suffices to show the following: if $c \geqslant k$ is similar to some of its multiples $d$, then either both $c$ and $d$ are good or both are bad.

Assuming that this is not true in general, we choose a counterexample ( $c_{0}, d_{0}$ ) with $d_{0}$ being as small as possible. By Claim $1, c_{0}$ is bad whilst $d_{0}$ is good. Plainly $d_{0}$ is strictly greater than $c_{0}$ and hence the quotient $\frac{d_{0}}{c_{0}}$ has some prime factor $p$. Clearly $p$ divides $d_{0}$. If $p \leqslant k$, then $p$ divides $c_{0}$ as well due to the similarity, and hence $d_{0}$ is actually divisible by $p^{2}$. So $\frac{d_{0}}{p}$ is good by the contrapositive of Claim 2. Since $c_{0} \left\lvert\, \frac{d_{0}}{p}\right.$, the pair $\left(c_{0}, \frac{d_{0}}{p}\right)$ contradicts the supposed minimality of $d_{0}$. This proves $p>k$, but now we get the same contradiction using Claim 3 instead of Claim 2. Thereby the problem is solved.",795,4
2013n7,"Let $\nu$ be an irrational positive number, and let $m$ be a positive integer. A pair $(a, b)$ of positive integers is called good if


\begin{equation*}
a\lceil b \nu\rceil-b\lfloor a \nu\rfloor=m . \tag{*}
\end{equation*}


A good pair $(a, b)$ is called excellent if neither of the pairs $(a-b, b)$ and $(a, b-a)$ is good. (As usual, by $\lfloor x\rfloor$ and $\lceil x\rceil$ we denote the integer numbers such that $x-1<\lfloor x\rfloor \leqslant x$ and $x \leqslant\lceil x\rceil<x+1$.)

Prove that the number of excellent pairs is equal to the sum of the positive divisors of $m$.","Solution. For positive integers $a$ and $b$, let us denote

$$
f(a, b)=a\lceil b \nu\rceil-b\lfloor a \nu\rfloor .
$$

We will deal with various values of $m$; thus it is convenient to say that a pair $(a, b)$ is $m$-good or $m$-excellent if the corresponding conditions are satisfied.

To start, let us investigate how the values $f(a+b, b)$ and $f(a, b+a)$ are related to $f(a, b)$. If $\{a \nu\}+\{b \nu\}<1$, then we have $\lfloor(a+b) \nu\rfloor=\lfloor a \nu\rfloor+\lfloor b \nu\rfloor$ and $\lceil(a+b) \nu\rceil=\lceil a \nu\rceil+\lceil b \nu\rceil-1$, so

$$
f(a+b, b)=(a+b)\lceil b \nu\rceil-b(\lfloor a \nu\rfloor+\lfloor b \nu\rfloor)=f(a, b)+b(\lceil b \nu\rceil-\lfloor b \nu\rfloor)=f(a, b)+b
$$

and

$$
f(a, b+a)=a(\lceil b \nu\rceil+\lceil a \nu\rceil-1)-(b+a)\lfloor a \nu\rfloor=f(a, b)+a(\lceil a \nu\rceil-1-\lfloor a \nu\rfloor)=f(a, b) .
$$

Similarly, if $\{a \nu\}+\{b \nu\} \geqslant 1$ then one obtains

$$
f(a+b, b)=f(a, b) \quad \text { and } \quad f(a, b+a)=f(a, b)+a .
$$

So, in both cases one of the numbers $f(a+b, a)$ and $f(a, b+a)$ is equal to $f(a, b)$ while the other is greater than $f(a, b)$ by one of $a$ and $b$. Thus, exactly one of the pairs $(a+b, b)$ and $(a, b+a)$ is excellent (for an appropriate value of $m$ ).

Now let us say that the pairs $(a+b, b)$ and $(a, b+a)$ are the children of the pair $(a, b)$, while this pair is their parent. Next, if a pair $(c, d)$ can be obtained from $(a, b)$ by several passings from a parent to a child, we will say that $(c, d)$ is a descendant of $(a, b)$, while $(a, b)$ is an ancestor of $(c, d)$ (a pair is neither an ancestor nor a descendant of itself). Thus each pair ( $a, b$ ) has two children, it has a unique parent if $a \neq b$, and no parents otherwise. Therefore, each pair of distinct positive integers has a unique ancestor of the form $(a, a)$; our aim is now to find how many $m$-excellent descendants each such pair has.

Notice now that if a pair $(a, b)$ is $m$-excellent then $\min \{a, b\} \leqslant m$. Indeed, if $a=b$ then $f(a, a)=a=m$, so the statement is valid. Otherwise, the pair $(a, b)$ is a child of some pair $\left(a^{\prime}, b^{\prime}\right)$. If $b=b^{\prime}$ and $a=a^{\prime}+b^{\prime}$, then we should have $m=f(a, b)=f\left(a^{\prime}, b^{\prime}\right)+b^{\prime}$, so $b=b^{\prime}=m-f\left(a^{\prime}, b^{\prime}\right)<m$. Similarly, if $a=a^{\prime}$ and $b=b^{\prime}+a^{\prime}$ then $a<m$.

Let us consider the set $S_{m}$ of all pairs $(a, b)$ such that $f(a, b) \leqslant m$ and $\min \{a, b\} \leqslant m$. Then all the ancestors of the elements in $S_{m}$ are again in $S_{m}$, and each element in $S_{m}$ either is of the form $(a, a)$ with $a \leqslant m$, or has a unique ancestor of this form. From the arguments above we see that all $m$-excellent pairs lie in $S_{m}$.

We claim now that the set $S_{m}$ is finite. Indeed, assume, for instance, that it contains infinitely many pairs $(c, d)$ with $d>2 m$. Such a pair is necessarily a child of $(c, d-c)$, and thus a descendant of some pair ( $c, d^{\prime}$ ) with $m<d^{\prime} \leqslant 2 m$. Therefore, one of the pairs $(a, b) \in S_{m}$ with $m<b \leqslant 2 m$\\
has infinitely many descendants in $S_{m}$, and all these descendants have the form $(a, b+k a)$ with $k$ a positive integer. Since $f(a, b+k a)$ does not decrease as $k$ grows, it becomes constant for $k \geqslant k_{0}$, where $k_{0}$ is some positive integer. This means that $\{a \nu\}+\{(b+k a) \nu\}<1$ for all $k \geqslant k_{0}$. But this yields $1>\{(b+k a) \nu\}=\left\{\left(b+k_{0} a\right) \nu\right\}+\left(k-k_{0}\right)\{a \nu\}$ for all $k>k_{0}$, which is absurd.

Similarly, one can prove that $S_{m}$ contains finitely many pairs $(c, d)$ with $c>2 m$, thus finitely many elements at all.

We are now prepared for proving the following crucial lemma.\\
Lemma. Consider any pair $(a, b)$ with $f(a, b) \neq m$. Then the number $g(a, b)$ of its $m$-excellent descendants is equal to the number $h(a, b)$ of ways to represent the number $t=m-f(a, b)$ as $t=k a+\ell b$ with $k$ and $\ell$ being some nonnegative integers.\\
Proof. We proceed by induction on the number $N$ of descendants of $(a, b)$ in $S_{m}$. If $N=0$ then clearly $g(a, b)=0$. Assume that $h(a, b)>0$; without loss of generality, we have $a \leqslant b$. Then, clearly, $m-f(a, b) \geqslant a$, so $f(a, b+a) \leqslant f(a, b)+a \leqslant m$ and $a \leqslant m$, hence $(a, b+a) \in S_{m}$ which is impossible. Thus in the base case we have $g(a, b)=h(a, b)=0$, as desired.

Now let $N>0$. Assume that $f(a+b, b)=f(a, b)+b$ and $f(a, b+a)=f(a, b)$ (the other case is similar). If $f(a, b)+b \neq m$, then by the induction hypothesis we have

$$
g(a, b)=g(a+b, b)+g(a, b+a)=h(a+b, b)+h(a, b+a) .
$$

Notice that both pairs $(a+b, b)$ and $(a, b+a)$ are descendants of $(a, b)$ and thus each of them has strictly less descendants in $S_{m}$ than $(a, b)$ does.

Next, each one of the $h(a+b, b)$ representations of $m-f(a+b, b)=m-b-f(a, b)$ as the sum $k^{\prime}(a+b)+\ell^{\prime} b$ provides the representation $m-f(a, b)=k a+\ell b$ with $k=k^{\prime}<k^{\prime}+\ell^{\prime}+1=\ell$. Similarly, each one of the $h(a, b+a)$ representations of $m-f(a, b+a)=m-f(a, b)$ as the sum $k^{\prime} a+\ell^{\prime}(b+a)$ provides the representation $m-f(a, b)=k a+\ell b$ with $k=k^{\prime}+\ell^{\prime} \geqslant \ell^{\prime}=\ell$. This correspondence is obviously bijective, so

$$
h(a, b)=h(a+b, b)+h(a, b+a)=g(a, b),
$$

as required.\\
Finally, if $f(a, b)+b=m$ then $(a+b, b)$ is $m$-excellent, so $g(a, b)=1+g(a, b+a)=1+h(a, b+a)$ by the induction hypothesis. On the other hand, the number $m-f(a, b)=b$ has a representation $0 \cdot a+1 \cdot b$ and sometimes one more representation as $k a+0 \cdot b$; this last representation exists simultaneously with the representation $m-f(a, b+a)=k a+0 \cdot(b+a)$, so $h(a, b)=1+h(a, b+a)$ as well. Thus in this case the step is also proved.

Now it is easy to finish the solution. There exists a unique $m$-excellent pair of the form ( $a, a$ ), and each other $m$-excellent pair $(a, b)$ has a unique ancestor of the form $(x, x)$ with $x<m$. By the lemma, for every $x<m$ the number of its $m$-excellent descendants is $h(x, x)$, which is the number of ways to represent $m-f(x, x)=m-x$ as $k x+\ell x$ (with nonnegative integer $k$ and $\ell$ ). This number is 0 if $x \nmid m$, and $m / x$ otherwise. So the total number of excellent pairs is

$$
1+\sum_{x \mid m, x<m} \frac{m}{x}=1+\sum_{d \mid m, d>1} d=\sum_{d \mid m} d,
$$

as required.

Comment. Let us present a sketch of an outline of a different solution. The plan is to check that the number of excellent pairs does not depend on the (irrational) number $\nu$, and to find this number for some appropriate value of $\nu$. For that, we first introduce some geometrical language. We deal only with the excellent pairs ( $a, b$ ) with $a \neq b$.

Part I. Given an irrational positive $\nu$, for every positive integer $n$ we introduce two integral points $F_{\nu}(n)=$ $(n,\lfloor n \nu\rfloor)$ and $C_{\nu}(n)=(n,\lceil n \nu\rceil)$ on the coordinate plane $O x y$. Then (*) reads as $\left[O F_{\nu}(a) C_{\nu}(b)\right]=m / 2$; here [.] stands for the signed area. Next, we rewrite in these terms the condition on a pair $(a, b)$ to be excellent. Let $\ell_{\nu}, \ell_{\nu}^{+}$, and $\ell_{\nu}^{-}$be the lines determined by the equations $y=\nu x, y=\nu x+1$, and $y=\nu x-1$, respectively.\\
$a)$. Firstly, we deal with all excellent pairs $(a, b)$ with $a<b$. Given some value of $a$, all the points $C$ such that $\left[O F_{\nu}(a) C\right]=m / 2$ lie on some line $f_{\nu}(a)$; if there exist any good pairs $(a, b)$ at all, this line has to contain at least one integral point, which happens exactly when $\operatorname{gcd}(a,\lfloor a \nu\rfloor) \mid m$.

Let $P_{\nu}(a)$ be the point of intersection of $\ell_{\nu}^{+}$and $f_{\nu}(a)$, and let $p_{\nu}(a)$ be its abscissa; notice that $p_{\nu}(a)$ is irrational if it is nonzero. Now, if $(a, b)$ is good, then the point $C_{\nu}(b)$ lies on $f_{\nu}(a)$, which means that the point of $f_{\nu}(a)$ with abscissa $b$ lies between $\ell_{\nu}$ and $\ell_{\nu}^{+}$and is integral. If in addition the pair ( $a, b-a$ ) is not good, then the point of $f_{\nu}(a)$ with abscissa $b-a$ lies above $\ell_{\nu}^{+}$(see Fig. 1). Thus, the pair $(a, b)$ with $b>a$ is excellent exactly when $p_{\nu}(a)$ lies between $b-a$ and $b$, and the point of $f_{\nu}(a)$ with abscissa $b$ is integral (which means that this point is $\left.C_{\nu}(b)\right)$.

Notice now that, if $p_{\nu}(a)>a$, then the number of excellent pairs of the form $(a, b)$ (with $b>a$ ) is $\operatorname{gcd}(a,\lfloor a \nu\rfloor)$.\\
\includegraphics[max width=\textwidth, center]{2025_04_30_f697ddf0f0f1661c3074g-67}

Figure 1\\
\includegraphics[max width=\textwidth, center]{2025_04_30_f697ddf0f0f1661c3074g-67(1)}

Figure 2\\
$b)$. Analogously, considering the pairs $(a, b)$ with $a>b$, we fix the value of $b$, introduce the line $c_{\nu}(b)$ containing all the points $F$ with $\left[\operatorname{OFC}_{\nu}(b)\right]=m / 2$, assume that this line contains an integral point (which means $\operatorname{gcd}(b,[b \nu]) \mid m$ ), and denote the common point of $c_{\nu}(b)$ and $\ell_{\nu}^{-}$by $Q_{\nu}(b)$, its abscissa being $q_{\nu}(b)$. Similarly to the previous case, we obtain that the pair $(a, b)$ is excellent exactly when $q_{\nu}(a)$ lies between $a-b$ and $a$, and the point of $c_{\nu}(b)$ with abscissa $a$ is integral (see Fig. 2). Again, if $q_{\nu}(b)>b$, then the number of excellent pairs of the form $(a, b)$ (with $a>b)$ is $\operatorname{gcd}(b,[b \nu])$.\\
Part II, sketchy. Having obtained such a description, one may check how the number of excellent pairs changes as $\nu$ grows. (Having done that, one may find this number for one appropriate value of $\nu$; for instance, it is relatively easy to make this calculation for $\nu \in\left(1,1+\frac{1}{m}\right)$.)

Consider, for the initial value of $\nu$, some excellent pair ( $a, t$ ) with $a>t$. As $\nu$ grows, this pair eventually stops being excellent; this happens when the point $Q_{\nu}(t)$ passes through $F_{\nu}(a)$. At the same moment, the pair ( $a+t, t$ ) becomes excellent instead.

This process halts when the point $Q_{\nu}(t)$ eventually disappears, i.e. when $\nu$ passes through the ratio of the coordinates of the point $T=C_{\nu}(t)$. Hence, the point $T$ afterwards is regarded as $F_{\nu}(t)$. Thus, all the old excellent pairs of the form ( $a, t$ ) with $a>t$ disappear; on the other hand, the same number of excellent pairs with the first element being $t$ just appear.

Similarly, if some pair $(t, b)$ with $t<b$ is initially $\nu$-excellent, then at some moment it stops being excellent when $P_{\nu}(t)$ passes through $C_{\nu}(b)$; at the same moment, the pair $(t, b-t)$ becomes excellent. This process eventually stops when $b-t<t$. At this moment, again the second element of the pair becomes fixed, and the first one starts to increase.

These ideas can be made precise enough to show that the number of excellent pairs remains unchanged, as required.

We should warn the reader that the rigorous elaboration of Part II is technically quite involved, mostly by the reason that the set of moments when the collection of excellent pairs changes is infinite. Especially much care should be applied to the limit points of this set, which are exactly the points when the line $\ell_{\nu}$ passes through some point of the form $C_{\nu}(b)$.

The same ideas may be explained in an algebraic language instead of a geometrical one; the same technicalities remain in this way as well.",1865,4
2012a3,"Let $a_{2}, \ldots, a_{n}$ be $n-1$ positive real numbers, where $n \geq 3$, such that $a_{2} a_{3} \cdots a_{n}=1$. Prove that

$$
\left(1+a_{2}\right)^{2}\left(1+a_{3}\right)^{3} \cdots\left(1+a_{n}\right)^{n}>n^{n}
$$","Solution. The substitution $a_{2}=\frac{x_{2}}{x_{1}}, a_{3}=\frac{x_{3}}{x_{2}}, \ldots, a_{n}=\frac{x_{1}}{x_{n-1}}$ transforms the original problem into the inequality


\begin{equation*}
\left(x_{1}+x_{2}\right)^{2}\left(x_{2}+x_{3}\right)^{3} \cdots\left(x_{n-1}+x_{1}\right)^{n}>n^{n} x_{1}^{2} x_{2}^{3} \cdots x_{n-1}^{n} \tag{*}
\end{equation*}


for all $x_{1}, \ldots, x_{n-1}>0$. To prove this, we use the AM-GM inequality for each factor of the left-hand side as follows:

$$
\begin{array}{rlll}
\left(x_{1}+x_{2}\right)^{2} & & & \geq 2^{2} x_{1} x_{2} \\
\left(x_{2}+x_{3}\right)^{3} & = & \left(2\left(\frac{x_{2}}{2}\right)+x_{3}\right)^{3} & \geq 3^{3}\left(\frac{x_{2}}{2}\right)^{2} x_{3} \\
\left(x_{3}+x_{4}\right)^{4} & = & \left(3\left(\frac{x_{3}}{3}\right)+x_{4}\right)^{4} & \geq 4^{4}\left(\frac{x_{3}}{3}\right)^{3} x_{4} \\
& \vdots & \vdots & \vdots \\
\left(x_{n-1}+x_{1}\right)^{n} & = & \left((n-1)\left(\frac{x_{n-1}}{n-1}\right)+x_{1}\right)^{n} & \geq n^{n}\left(\frac{x_{n-1}}{n-1}\right)^{n-1} x_{1}
\end{array}
$$

Multiplying these inequalities together gives $\left({ }^{*}\right)$, with inequality sign $\geq$ instead of $>$. However for the equality to occur it is necessary that $x_{1}=x_{2}, x_{2}=2 x_{3}, \ldots, x_{n-1}=(n-1) x_{1}$, implying $x_{1}=(n-1)!x_{1}$. This is impossible since $x_{1}>0$ and $n \geq 3$. Therefore the inequality is strict.

Comment. One can avoid the substitution $a_{i}=x_{i} / x_{i-1}$. Apply the weighted AM-GM inequality to each factor $\left(1+a_{k}\right)^{k}$, with the same weights like above, to obtain

$$
\left(1+a_{k}\right)^{k}=\left((k-1) \frac{1}{k-1}+a_{k}\right)^{k} \geq \frac{k^{k}}{(k-1)^{k-1}} a_{k}
$$

Multiplying all these inequalities together gives

$$
\left(1+a_{2}\right)^{2}\left(1+a_{3}\right)^{3} \cdots\left(1+a_{n}\right)^{n} \geq n^{n} a_{2} a_{3} \cdots a_{n}=n^{n}
$$

The same argument as in the proof above shows that the equality cannot be attained.",204,2
2012a4,Let $f$ and $g$ be two nonzero polynomials with integer coefficients and $\operatorname{deg} f>\operatorname{deg} g$. Suppose that for infinitely many primes $p$ the polynomial $p f+g$ has a rational root. Prove that $f$ has a rational root.,"Since $\operatorname{deg} f>\operatorname{deg} g$, we have $|g(x) / f(x)|<1$ for sufficiently large $x$; more precisely, there is a real number $R$ such that $|g(x) / f(x)|<1$ for all $x$ with $|x|>R$. Then for all such $x$ and all primes $p$ we have

$$
|p f(x)+g(x)| \geq|f(x)|\left(p-\frac{|g(x)|}{|f(x)|}\right)>0 .
$$

Hence all real roots of the polynomials $p f+g$ lie in the interval $[-R, R]$.\\
Let $f(x)=a_{n} x^{n}+a_{n-1} x^{n-1}+\cdots+a_{0}$ and $g(x)=b_{m} x^{m}+b_{m-1} x^{m-1}+\cdots+b_{0}$ where $n>m, a_{n} \neq 0$ and $b_{m} \neq 0$. Upon replacing $f(x)$ and $g(x)$ by $a_{n}^{n-1} f\left(x / a_{n}\right)$ and $a_{n}^{n-1} g\left(x / a_{n}\right)$ respectively, we reduce the problem to the case $a_{n}=1$. In other words one can assume that $f$ is monic. Then the leading coefficient of $p f+g$ is $p$, and if $r=u / v$ is a rational root of $p f+g$ with $(u, v)=1$ and $v>0$, then either $v=1$ or $v=p$.

First consider the case when $v=1$ infinitely many times. If $v=1$ then $|u| \leq R$, so there are only finitely many possibilities for the integer $u$. Therefore there exist distinct primes $p$ and $q$ for which we have the same value of $u$. Then the polynomials $p f+g$ and $q f+g$ share this root, implying $f(u)=g(u)=0$. So in this case $f$ and $g$ have an integer root in common.

Now suppose that $v=p$ infinitely many times. By comparing the exponent of $p$ in the denominators of $p f(u / p)$ and $g(u / p)$ we get $m=n-1$ and $p f(u / p)+g(u / p)=0$ reduces to an equation of the form

$$
\left(u^{n}+a_{n-1} p u^{n-1}+\ldots+a_{0} p^{n}\right)+\left(b_{n-1} u^{n-1}+b_{n-2} p u^{n-2}+\ldots+b_{0} p^{n-1}\right)=0 .
$$

The equation above implies that $u^{n}+b_{n-1} u^{n-1}$ is divisible by $p$ and hence, since $(u, p)=1$, we have $u+b_{n-1}=p k$ with some integer $k$. On the other hand all roots of $p f+g$ lie in the interval $[-R, R]$, so that

$$
\begin{gathered}
\frac{\left|p k-b_{n-1}\right|}{p}=\frac{|u|}{p}<R, \\
|k|<R+\frac{\left|b_{n-1}\right|}{p}<R+\left|b_{n-1}\right| .
\end{gathered}
$$

Therefore the integer $k$ can attain only finitely many values. Hence there exists an integer $k$ such that the number $\frac{p k-b_{n-1}}{p}=k-\frac{b_{n-1}}{p}$ is a root of $p f+g$ for infinitely many primes $p$. For these primes we have

$$
f\left(k-b_{n-1} \frac{1}{p}\right)+\frac{1}{p} g\left(k-b_{n-1} \frac{1}{p}\right)=0 .
$$

So the equation


\begin{equation*}
f\left(k-b_{n-1} x\right)+x g\left(k-b_{n-1} x\right)=0 \tag{1}
\end{equation*}


has infinitely many solutions of the form $x=1 / p$. Since the left-hand side is a polynomial, this implies that (1) is a polynomial identity, so it holds for all real $x$. In particular, by substituting $x=0$ in (1) we get $f(k)=0$. Thus the integer $k$ is a root of $f$.

In summary the monic polynomial $f$ obtained after the initial reduction always has an integer root. Therefore the original polynomial $f$ has a rational root.",448,3
2012a6,"Let $f: \mathbb{N} \rightarrow \mathbb{N}$ be a function, and let $f^{m}$ be $f$ applied $m$ times. Suppose that for every $n \in \mathbb{N}$ there exists a $k \in \mathbb{N}$ such that $f^{2 k}(n)=n+k$, and let $k_{n}$ be the smallest such $k$. Prove that the sequence $k_{1}, k_{2}, \ldots$ is unbounded.","Solution. We restrict attention to the set

$$
S=\left\{1, f(1), f^{2}(1), \ldots\right\}
$$

Observe that $S$ is unbounded because for every number $n$ in $S$ there exists a $k>0$ such that $f^{2 k}(n)=n+k$ is in $S$. Clearly $f$ maps $S$ into itself; moreover $f$ is injective on $S$. Indeed if $f^{i}(1)=f^{j}(1)$ with $i \neq j$ then the values $f^{m}(1)$ start repeating periodically from some point on, and $S$ would be finite.

Define $g: S \rightarrow S$ by $g(n)=f^{2 k_{n}}(n)=n+k_{n}$. We prove that $g$ is injective too. Suppose that $g(a)=g(b)$ with $a<b$. Then $a+k_{a}=f^{2 k_{a}}(a)=f^{2 k_{b}}(b)=b+k_{b}$ implies $k_{a}>k_{b}$. So, since $f$ is injective on $S$, we obtain

$$
f^{2\left(k_{a}-k_{b}\right)}(a)=b=a+\left(k_{a}-k_{b}\right) .
$$

However this contradicts the minimality of $k_{a}$ as $0<k_{a}-k_{b}<k_{a}$.\\
Let $T$ be the set of elements of $S$ that are not of the form $g(n)$ with $n \in S$. Note that $1 \in T$ by $g(n)>n$ for $n \in S$, so $T$ is non-empty. For each $t \in T$ denote $C_{t}=\left\{t, g(t), g^{2}(t), \ldots\right\}$; call $C_{t}$ the chain starting at $t$. Observe that distinct chains are disjoint because $g$ is injective. Each $n \in S \backslash T$ has the form $n=g\left(n^{\prime}\right)$ with $n^{\prime}<n, n^{\prime} \in S$. Repeated applications of the same observation show that $n \in C_{t}$ for some $t \in T$, i. e. $S$ is the disjoint union of the chains $C_{t}$.

If $f^{n}(1)$ is in the chain $C_{t}$ starting at $t=f^{n_{t}}(1)$ then $n=n_{t}+2 a_{1}+\cdots+2 a_{j}$ with

$$
f^{n}(1)=g^{j}\left(f^{n_{t}}(1)\right)=f^{2 a_{j}}\left(f^{2 a_{j-1}}\left(\cdots f^{2 a_{1}}\left(f^{n_{t}}(1)\right)\right)\right)=f^{n_{t}}(1)+a_{1}+\cdots+a_{j}
$$

Hence


\begin{equation*}
f^{n}(1)=f^{n_{t}}(1)+\frac{n-n_{t}}{2}=t+\frac{n-n_{t}}{2} . \tag{1}
\end{equation*}


Now we show that $T$ is infinite. We argue by contradiction. Suppose that there are only finitely many chains $C_{t_{1}}, \ldots, C_{t_{r}}$, starting at $t_{1}<\cdots<t_{r}$. Fix $N$. If $f^{n}(1)$ with $1 \leq n \leq N$ is in $C_{t}$ then $f^{n}(1)=t+\frac{n-n_{t}}{2} \leq t_{r}+\frac{N}{2}$ by (1). But then the $N+1$ distinct natural numbers $1, f(1), \ldots, f^{N}(1)$ are all less than $t_{r}+\frac{N}{2}$ and hence $N+1 \leq t_{r}+\frac{N}{2}$. This is a contradiction if $N$ is sufficiently large, and hence $T$ is infinite.

To complete the argument, choose any $k$ in $\mathbb{N}$ and consider the $k+1$ chains starting at the first $k+1$ numbers in $T$. Let $t$ be the greatest one among these numbers. Then each of the chains in question contains a number not exceeding $t$, and at least one of them does not contain any number among $t+1, \ldots, t+k$. So there is a number $n$ in this chain such that $g(n)-n>k$, i. e. $k_{n}>k$. In conclusion $k_{1}, k_{2}, \ldots$ is unbounded.",411,3
2012a7,"We say that a function $f: \mathbb{R}^{k} \rightarrow \mathbb{R}$ is a metapolynomial if, for some positive integers $m$ and $n$, it can be represented in the form

$$
f\left(x_{1}, \ldots, x_{k}\right)=\max _{i=1, \ldots, m} \min _{j=1, \ldots, n} P_{i, j}\left(x_{1}, \ldots, x_{k}\right)
$$

where $P_{i, j}$ are multivariate polynomials. Prove that the product of two metapolynomials is also a metapolynomial.","Solution. We use the notation $f(x)=f\left(x_{1}, \ldots, x_{k}\right)$ for $x=\left(x_{1}, \ldots, x_{k}\right)$ and $[m]=\{1,2, \ldots, m\}$. Observe that if a metapolynomial $f(x)$ admits a representation like the one in the statement for certain positive integers $m$ and $n$, then they can be replaced by any $m^{\prime} \geq m$ and $n^{\prime} \geq n$. For instance, if we want to replace $m$ by $m+1$ then it is enough to define $P_{m+1, j}(x)=P_{m, j}(x)$ and note that repeating elements of a set do not change its maximum nor its minimum. So one can assume that any two metapolynomials are defined with the same $m$ and $n$. We reserve letters $P$ and $Q$ for polynomials, so every function called $P, P_{i, j}, Q, Q_{i, j}, \ldots$ is a polynomial function.

We start with a lemma that is useful to change expressions of the form min max $f_{i, j}$ to ones of the form $\max \min g_{i, j}$.\\
Lemma. Let $\left\{a_{i, j}\right\}$ be real numbers, for all $i \in[m]$ and $j \in[n]$. Then

$$
\min _{i \in[m]} \max _{j \in[n]} a_{i, j}=\max _{j_{1}, \ldots, j_{m} \in[n]} \min _{i \in[m]} a_{i, j_{i}},
$$

where the max in the right-hand side is over all vectors $\left(j_{1}, \ldots, j_{m}\right)$ with $j_{1}, \ldots, j_{m} \in[n]$.\\
Proof. We can assume for all $i$ that $a_{i, n}=\max \left\{a_{i, 1}, \ldots, a_{i, n}\right\}$ and $a_{m, n}=\min \left\{a_{1, n}, \ldots, a_{m, n}\right\}$. The left-hand side is $=a_{m, n}$ and hence we need to prove the same for the right-hand side. If $\left(j_{1}, j_{2}, \ldots, j_{m}\right)=(n, n, \ldots, n)$ then $\min \left\{a_{1, j_{1}}, \ldots, a_{m, j_{m}}\right\}=\min \left\{a_{1, n}, \ldots, a_{m, n}\right\}=a_{m, n}$ which implies that the right-hand side is $\geq a_{m, n}$. It remains to prove the opposite inequality and this is equivalent to $\min \left\{a_{1, j_{1}}, \ldots, a_{m, j_{m}}\right\} \leq a_{m, n}$ for all possible $\left(j_{1}, j_{2}, \ldots, j_{m}\right)$. This is true because $\min \left\{a_{1, j_{1}}, \ldots, a_{m, j_{m}}\right\} \leq a_{m, j_{m}} \leq a_{m, n}$.

We need to show that the family $\mathcal{M}$ of metapolynomials is closed under multiplication, but it turns out easier to prove more: that it is also closed under addition, maxima and minima.

First we prove the assertions about the maxima and the minima. If $f_{1}, \ldots, f_{r}$ are metapolynomials, assume them defined with the same $m$ and $n$. Then

$$
f=\max \left\{f_{1}, \ldots, f_{r}\right\}=\max \left\{\max _{i \in[m]} \min _{j \in[n]} P_{i, j}^{1}, \ldots, \max _{i \in[m]} \min _{j \in[n]} P_{i, j}^{r}\right\}=\max _{s \in[r], i \in[m]} \min _{j \in[n]} P_{i, j}^{s} .
$$

It follows that $f=\max \left\{f_{1}, \ldots, f_{r}\right\}$ is a metapolynomial. The same argument works for the minima, but first we have to replace min max by max min, and this is done via the lemma.

Another property we need is that if $f=\max \min P_{i, j}$ is a metapolynomial then so is $-f$. Indeed, $-f=\min \left(-\min P_{i, j}\right)=\min \max P_{i, j}$.

To prove $\mathcal{M}$ is closed under addition let $f=\max \min P_{i, j}$ and $g=\max \min Q_{i, j}$. Then

$$
\begin{gathered}
f(x)+g(x)=\max _{i \in[m]} \min _{j \in[n]} P_{i, j}(x)+\max _{i \in[m]} \min _{j \in[n]} Q_{i, j}(x) \\
=\max _{i_{1}, i_{2} \in[m]}\left(\min _{j \in[n]} P_{i_{1}, j}(x)+\min _{j \in[n]} Q_{i_{2}, j}(x)\right)=\max _{i_{1}, i_{2} \in[m]} \min _{j_{1}, j_{2} \in[n]}\left(P_{i_{1}, j_{1}}(x)+Q_{i_{2}, j_{2}}(x)\right),
\end{gathered}
$$

and hence $f(x)+g(x)$ is a metapolynomial.\\
We proved that $\mathcal{M}$ is closed under sums, maxima and minima, in particular any function that can be expressed by sums, max, min, polynomials or even metapolynomials is in $\mathcal{M}$.

We would like to proceed with multiplication along the same lines like with addition, but there is an essential difference. In general the product of the maxima of two sets is not equal\\
to the maximum of the product of the sets. We need to deal with the fact that $a<b$ and $c<d$ do not imply $a c<b d$. However this is true for $a, b, c, d \geq 0$.

In view of this we decompose each function $f(x)$ into its positive part $f^{+}(x)=\max \{f(x), 0\}$ and its negative part $f^{-}(x)=\max \{0,-f(x)\}$. Note that $f=f^{+}-f^{-}$and $f^{+}, f^{-} \in \mathcal{M}$ if $f \in \mathcal{M}$. The whole problem reduces to the claim that if $f$ and $g$ are metapolynomials with $f, g \geq 0$ then $f g$ it is also a metapolynomial.

Assuming this claim, consider arbitrary $f, g \in \mathcal{M}$. We have

$$
f g=\left(f^{+}-f^{-}\right)\left(g^{+}-g^{-}\right)=f^{+} g^{+}-f^{+} g^{-}-f^{-} g^{+}+f^{-} g^{-}
$$

and hence $f g \in \mathcal{M}$. Indeed, $\mathcal{M}$ is closed under addition, also $f^{+} g^{+}, f^{+} g^{-}, f^{-} g^{+}, f^{-} g^{-} \in \mathcal{M}$ because $f^{+}, f^{-}, g^{+}, g^{-} \geq 0$.

It remains to prove the claim. In this case $f, g \geq 0$, and one can try to repeat the argument for the sum. More precisely, let $f=\max \min P_{i j} \geq 0$ and $g=\max \min Q_{i j} \geq 0$. Then

$$
f g=\max \min P_{i, j} \cdot \max \min Q_{i, j}=\max \min P_{i, j}^{+} \cdot \max \min Q_{i, j}^{+}=\max \min P_{i_{1}, j_{1}}^{+} \cdot Q_{i_{2}, j_{2}}^{+}
$$

Hence it suffices to check that $P^{+} Q^{+} \in \mathcal{M}$ for any pair of polynomials $P$ and $Q$. This reduces to the identity

$$
u^{+} v^{+}=\max \left\{0, \min \{u v, u, v\}, \min \left\{u v, u v^{2}, u^{2} v\right\}, \min \left\{u v, u, u^{2} v\right\}, \min \left\{u v, u v^{2}, v\right\}\right\}
$$

with $u$ replaced by $P(x)$ and $v$ replaced by $Q(x)$. The formula is proved by a case-by-case analysis. If $u \leq 0$ or $v \leq 0$ then both sides equal 0 . In case $u, v \geq 0$, the right-hand side is clearly $\leq u v$. To prove the opposite inequality we use that $u v$ equals

$$
\begin{array}{ll}
\min \{u v, u, v\} & \text { if } 0 \leq u, v \leq 1 \\
\min \left\{u v, u v^{2}, u^{2} v\right\} & \text { if } 1 \leq u, v \\
\min \left\{u v, u, u^{2} v\right\} & \text { if } 0 \leq v \leq 1 \leq u \\
\min \left\{u v, u v^{2}, v\right\} & \text { if } 0 \leq u \leq 1 \leq v
\end{array}
$$

Comment. The case $k=1$ is simpler and can be solved by proving that a function $f: \mathbb{R} \rightarrow \mathbb{R}$ is a metapolynomial if and only if it is a piecewise polinomial (and continuos) function.

It is enough to prove that all such functions are metapolynomials, and this easily reduces to the following case. Given a polynomial $P(x)$ with $P(0)=0$, the function $f$ defined by $f(x)=P(x)$ for $x \geq 0$ and 0 otherwise is a metapolynomial. For this last claim, it suffices to prove that $\left(x^{+}\right)^{n}$ is a metapolynomial, and this follows from the formula $\left(x^{+}\right)^{n}=\max \left\{0, \min \left\{x^{n-1}, x^{n}\right\}, \min \left\{x^{n}, x^{n+1}\right\}\right\}$.",1102,4
2012c1,"Several positive integers are written in a row. Iteratively, Alice chooses two adjacent numbers $x$ and $y$ such that $x>y$ and $x$ is to the left of $y$, and replaces the pair $(x, y)$ by either $(y+1, x)$ or $(x-1, x)$. Prove that she can perform only finitely many such iterations.","Note first that the allowed operation does not change the maximum $M$ of the initial sequence. Let $a_{1}, a_{2}, \ldots, a_{n}$ be the numbers obtained at some point of the process. Consider the sum

$$
S=a_{1}+2 a_{2}+\cdots+n a_{n} .
$$

We claim that $S$ increases by a positive integer amount with every operation. Let the operation replace the pair $\left(a_{i}, a_{i+1}\right)$ by a pair $\left(c, a_{i}\right)$, where $a_{i}>a_{i+1}$ and $c=a_{i+1}+1$ or $c=a_{i}-1$. Then the new and the old value of $S$ differ by $d=\left(i c+(i+1) a_{i}\right)-\left(i a_{i}+(i+1) a_{i+1}\right)=a_{i}-a_{i+1}+i\left(c-a_{i+1}\right)$. The integer $d$ is positive since $a_{i}-a_{i+1} \geq 1$ and $c-a_{i+1} \geq 0$.

On the other hand $S \leq(1+2+\cdots+n) M$ as $a_{i} \leq M$ for all $i=1, \ldots, n$. Since $S$ increases by at least 1 at each step and never exceeds the constant $(1+2+\cdots+n) M$, the process stops after a finite number of iterations.",143,2
2012c5,"The columns and the rows of a $3 n \times 3 n$ square board are numbered $1,2, \ldots, 3 n$. Every square ( $x, y$ ) with $1 \leq x, y \leq 3 n$ is colored asparagus, byzantium or citrine according as the modulo 3 remainder of $x+y$ is 0,1 or 2 respectively. One token colored asparagus, byzantium or citrine is placed on each square, so that there are $3 n^{2}$ tokens of each color.

Suppose that one can permute the tokens so that each token is moved to a distance of at most $d$ from its original position, each asparagus token replaces a byzantium token, each byzantium token replaces a citrine token, and each citrine token replaces an asparagus token. Prove that it is possible to permute the tokens so that each token is moved to a distance of at most $d+2$ from its original position, and each square contains a token with the same color as the square.","Solution. Without loss of generality it suffices to prove that the A-tokens can be moved to distinct A-squares in such a way that each A -token is moved to a distance at most $d+2$ from its original place. This means we need a perfect matching between the $3 n^{2} \mathrm{~A}$-squares and the $3 n^{2}$ A-tokens such that the distance in each pair of the matching is at most $d+2$.

To find the matching, we construct a bipartite graph. The A-squares will be the vertices in one class of the graph; the vertices in the other class will be the A-tokens.

Split the board into $3 \times 1$ horizontal triminos; then each trimino contains exactly one Asquare. Take a permutation $\pi$ of the tokens which moves A-tokens to B-tokens, B-tokens to C-tokens, and C-tokens to A-tokens, in each case to a distance at most $d$. For each A-square $S$, and for each A-token $T$, connect $S$ and $T$ by an edge if $T, \pi(T)$ or $\pi^{-1}(T)$ is on the trimino containing $S$. We allow multiple edges; it is even possible that the same square and the same token are connected with three edges. Obviously the lengths of the edges in the graph do not exceed $d+2$. By length of an edge we mean the distance between the A -square and the A -token it connects.

Each A-token $T$ is connected with the three A-squares whose triminos contain $T, \pi(T)$ and $\pi^{-1}(T)$. Therefore in the graph all tokens are of degree 3 . We show that the same is true for the A-squares. Let $S$ be an arbitrary A-square, and let $T_{1}, T_{2}, T_{3}$ be the three tokens on the trimino containing $S$. For $i=1,2,3$, if $T_{i}$ is an A-token, then $S$ is connected with $T_{i}$; if $T_{i}$ is a B-token then $S$ is connected with $\pi^{-1}\left(T_{i}\right)$; finally, if $T_{i}$ is a C-token then $S$ is connected with $\pi\left(T_{i}\right)$. Hence in the graph the A-squares also are of degree 3.

Since the A-squares are of degree 3 , from every set $\mathcal{S}$ of A-squares exactly $3|\mathcal{S}|$ edges start. These edges end in at least $|\mathcal{S}|$ tokens because the A-tokens also are of degree 3. Hence every set $\mathcal{S}$ of A-squares has at least $|\mathcal{S}|$ neighbors among the A-tokens.

Therefore, by Hall's marriage theorem, the graph contains a perfect matching between the two vertex classes. So there is a perfect matching between the A-squares and A-tokens with edges no longer than $d+2$. It follows that the tokens can be permuted as specified in the problem statement.

Comment 1. In the original problem proposal the board was infinite and there were only two colors. Having $n$ colors for some positive integer $n$ was an option; we chose $n=3$. Moreover, we changed the board to a finite one to avoid dealing with infinite graphs (although Hall's theorem works in the infinite case as well).

With only two colors Hall's theorem is not needed. In this case we split the board into $2 \times 1$ dominos, and in the resulting graph all vertices are of degree 2 . The graph consists of disjoint cycles with even length and infinite paths, so the existence of the matching is trivial.

Having more than three colors would make the problem statement more complicated, because we need a matching between every two color classes of tokens. However, this would not mean a significant increase in difficulty.

Comment 2. According to Wikipedia, the color asparagus (hexadecimal code \#87A96B) is a tone of green that is named after the vegetable. Crayola created this color in 1993 as one of the 16 to be named in the Name The Color Contest. Byzantium (\#702963) is a dark tone of purple. Its first recorded use as a color name in English was in 1926. Citrine (\#E4D00A) is variously described as yellow, greenish-yellow, brownish-yellow or orange. The first known use of citrine as a color name in English was in the 14th century.",657,4
2012c6,"Let $k$ and $n$ be fixed positive integers. In the liar's guessing game, Amy chooses integers $x$ and $N$ with $1 \leq x \leq N$. She tells Ben what $N$ is, but not what $x$ is. Ben may then repeatedly ask Amy whether $x \in S$ for arbitrary sets $S$ of integers. Amy will always answer with yes or no, but she might lie. The only restriction is that she can lie at most $k$ times in a row. After he has asked as many questions as he wants, Ben must specify a set of at most $n$ positive integers. If $x$ is in this set he wins; otherwise, he loses. Prove that:\\
a) If $n \geq 2^{k}$ then Ben can always win.\\
b) For sufficiently large $k$ there exist $n \geq 1.99^{k}$ such that Ben cannot guarantee a win.","Solution. Consider an answer $A \in\{y e s, n o\}$ to a question of the kind ""Is $x$ in the set $S$ ?"" We say that $A$ is inconsistent with a number $i$ if $A=$ yes and $i \notin S$, or if $A=n o$ and $i \in S$. Observe that an answer inconsistent with the target number $x$ is a lie.\\
a) Suppose that Ben has determined a set $T$ of size $m$ that contains $x$. This is true initially with $m=N$ and $T=\{1,2, \ldots, N\}$. For $m>2^{k}$ we show how Ben can find a number $y \in T$ that is different from $x$. By performing this step repeatedly he can reduce $T$ to be of size $2^{k} \leq n$ and thus win.

Since only the size $m>2^{k}$ of $T$ is relevant, assume that $T=\left\{0,1, \ldots, 2^{k}, \ldots, m-1\right\}$. Ben begins by asking repeatedly whether $x$ is $2^{k}$. If Amy answers no $k+1$ times in a row, one of these answers is truthful, and so $x \neq 2^{k}$. Otherwise Ben stops asking about $2^{k}$ at the first answer yes. He then asks, for each $i=1, \ldots, k$, if the binary representation of $x$ has a 0 in the $i$ th digit. Regardless of what the $k$ answers are, they are all inconsistent with a certain number $y \in\left\{0,1, \ldots, 2^{k}-1\right\}$. The preceding answer yes about $2^{k}$ is also inconsistent with $y$. Hence $y \neq x$. Otherwise the last $k+1$ answers are not truthful, which is impossible.

Either way, Ben finds a number in $T$ that is different from $x$, and the claim is proven.\\
b) We prove that if $1<\lambda<2$ and $n=\left\lfloor(2-\lambda) \lambda^{k+1}\right\rfloor-1$ then Ben cannot guarantee a win. To complete the proof, then it suffices to take $\lambda$ such that $1.99<\lambda<2$ and $k$ large enough so that

$$
n=\left\lfloor(2-\lambda) \lambda^{k+1}\right\rfloor-1 \geq 1.99^{k} .
$$

Consider the following strategy for Amy. First she chooses $N=n+1$ and $x \in\{1,2, \ldots, n+1\}$ arbitrarily. After every answer of hers Amy determines, for each $i=1,2, \ldots, n+1$, the number $m_{i}$ of consecutive answers she has given by that point that are inconsistent with $i$. To decide on her next answer, she then uses the quantity

$$
\phi=\sum_{i=1}^{n+1} \lambda^{m_{i}} .
$$

No matter what Ben's next question is, Amy chooses the answer which minimizes $\phi$.\\
We claim that with this strategy $\phi$ will always stay less than $\lambda^{k+1}$. Consequently no exponent $m_{i}$ in $\phi$ will ever exceed $k$, hence Amy will never give more than $k$ consecutive answers inconsistent with some $i$. In particular this applies to the target number $x$, so she will never lie more than $k$ times in a row. Thus, given the claim, Amy's strategy is legal. Since the strategy does not depend on $x$ in any way, Ben can make no deductions about $x$, and therefore he cannot guarantee a win.

It remains to show that $\phi<\lambda^{k+1}$ at all times. Initially each $m_{i}$ is 0 , so this condition holds in the beginning due to $1<\lambda<2$ and $n=\left\lfloor(2-\lambda) \lambda^{k+1}\right\rfloor-1$. Suppose that $\phi<\lambda^{k+1}$ at some point, and Ben has just asked if $x \in S$ for some set $S$. According as Amy answers yes or no, the new value of $\phi$ becomes

$$
\phi_{1}=\sum_{i \in S} 1+\sum_{i \notin S} \lambda^{m_{i}+1} \quad \text { or } \quad \phi_{2}=\sum_{i \in S} \lambda^{m_{i}+1}+\sum_{i \notin S} 1 .
$$

Since Amy chooses the option minimizing $\phi$, the new $\phi$ will equal $\min \left(\phi_{1}, \phi_{2}\right)$. Now we have

$$
\min \left(\phi_{1}, \phi_{2}\right) \leq \frac{1}{2}\left(\phi_{1}+\phi_{2}\right)=\frac{1}{2}\left(\sum_{i \in S}\left(1+\lambda^{m_{i}+1}\right)+\sum_{i \notin S}\left(\lambda^{m_{i}+1}+1\right)\right)=\frac{1}{2}(\lambda \phi+n+1)
$$

Because $\phi<\lambda^{k+1}$, the assumptions $\lambda<2$ and $n=\left\lfloor(2-\lambda) \lambda^{k+1}\right\rfloor-1$ lead to

$$
\min \left(\phi_{1}, \phi_{2}\right)<\frac{1}{2}\left(\lambda^{k+2}+(2-\lambda) \lambda^{k+1}\right)=\lambda^{k+1}
$$

The claim follows, which completes the solution.

Comment. Given a fixed $k$, let $f(k)$ denote the minimum value of $n$ for which Ben can guarantee a victory. The problem asks for a proof that for large $k$

$$
1.99^{k} \leq f(k) \leq 2^{k}
$$

A computer search shows that $f(k)=2,3,4,7,11,17$ for $k=1,2,3,4,5,6$.",652,4
2012c7,"There are given $2^{500}$ points on a circle labeled $1,2, \ldots, 2^{500}$ in some order. Prove that one can choose 100 pairwise disjoint chords joining some of these points so that the 100 sums of the pairs of numbers at the endpoints of the chosen chords are equal.","Solution. The proof is based on the following general fact.\\
Lemma. In a graph $G$ each vertex $v$ has degree $d_{v}$. Then $G$ contains an independent set $S$ of vertices such that $|S| \geq f(G)$ where

$$
f(G)=\sum_{v \in G} \frac{1}{d_{v}+1} .
$$

Proof. Induction on $n=|G|$. The base $n=1$ is clear. For the inductive step choose a vertex $v_{0}$ in $G$ of minimum degree $d$. Delete $v_{0}$ and all of its neighbors $v_{1}, \ldots, v_{d}$ and also all edges with endpoints $v_{0}, v_{1}, \ldots, v_{d}$. This gives a new graph $G^{\prime}$. By the inductive assumption $G^{\prime}$ contains an independent set $S^{\prime}$ of vertices such that $\left|S^{\prime}\right| \geq f\left(G^{\prime}\right)$. Since no vertex in $S^{\prime}$ is a neighbor of $v_{0}$ in $G$, the set $S=S^{\prime} \cup\left\{v_{0}\right\}$ is independent in $G$.

Let $d_{v}^{\prime}$ be the degree of a vertex $v$ in $G^{\prime}$. Clearly $d_{v}^{\prime} \leq d_{v}$ for every such vertex $v$, and also $d_{v_{i}} \geq d$ for all $i=0,1, \ldots, d$ by the minimal choice of $v_{0}$. Therefore

$$
f\left(G^{\prime}\right)=\sum_{v \in G^{\prime}} \frac{1}{d_{v}^{\prime}+1} \geq \sum_{v \in G^{\prime}} \frac{1}{d_{v}+1}=f(G)-\sum_{i=0}^{d} \frac{1}{d_{v_{i}}+1} \geq f(G)-\frac{d+1}{d+1}=f(G)-1 .
$$

Hence $|S|=\left|S^{\prime}\right|+1 \geq f\left(G^{\prime}\right)+1 \geq f(G)$, and the induction is complete.\\
We pass on to our problem. For clarity denote $n=2^{499}$ and draw all chords determined by the given $2 n$ points. Color each chord with one of the colors $3,4, \ldots, 4 n-1$ according to the sum of the numbers at its endpoints. Chords with a common endpoint have different colors. For each color $c$ consider the following graph $G_{c}$. Its vertices are the chords of color $c$, and two chords are neighbors in $G_{c}$ if they intersect. Let $f\left(G_{c}\right)$ have the same meaning as in the lemma for all graphs $G_{c}$.

Every chord $\ell$ divides the circle into two arcs, and one of them contains $m(\ell) \leq n-1$ given points. (In particular $m(\ell)=0$ if $\ell$ joins two consecutive points.) For each $i=0,1, \ldots, n-2$ there are $2 n$ chords $\ell$ with $m(\ell)=i$. Such a chord has degree at most $i$ in the respective graph. Indeed let $A_{1}, \ldots, A_{i}$ be all points on either arc determined by a chord $\ell$ with $m(\ell)=i$ and color $c$. Every $A_{j}$ is an endpoint of at most 1 chord colored $c, j=1, \ldots, i$. Hence at most $i$ chords of color $c$ intersect $\ell$.

It follows that for each $i=0,1, \ldots, n-2$ the $2 n$ chords $\ell$ with $m(\ell)=i$ contribute at least $\frac{2 n}{i+1}$ to the sum $\sum_{c} f\left(G_{c}\right)$. Summation over $i=0,1, \ldots, n-2$ gives

$$
\sum_{c} f\left(G_{c}\right) \geq 2 n \sum_{i=1}^{n-1} \frac{1}{i}
$$

Because there are $4 n-3$ colors in all, averaging yields a color $c$ such that

$$
f\left(G_{c}\right) \geq \frac{2 n}{4 n-3} \sum_{i=1}^{n-1} \frac{1}{i}>\frac{1}{2} \sum_{i=1}^{n-1} \frac{1}{i}
$$

By the lemma there are at least $\frac{1}{2} \sum_{i=1}^{n-1} \frac{1}{i}$ pairwise disjoint chords of color $c$, i. e. with the same sum $c$ of the pairs of numbers at their endpoints. It remains to show that $\frac{1}{2} \sum_{i=1}^{n-1} \frac{1}{i} \geq 100$ for $n=2^{499}$. Indeed we have

$$
\sum_{i=1}^{n-1} \frac{1}{i}>\sum_{i=1}^{2^{400}} \frac{1}{i}=1+\sum_{k=1}^{400} \sum_{i=2^{k-1+1}}^{2^{k}} \frac{1}{i}>1+\sum_{k=1}^{400} \frac{2^{k-1}}{2^{k}}=201>200
$$

This completes the solution.",507,4
2012g1,"In the triangle $A B C$ the point $J$ is the center of the excircle opposite to $A$. This excircle is tangent to the side $B C$ at $M$, and to the lines $A B$ and $A C$ at $K$ and $L$ respectively. The lines $L M$ and $B J$ meet at $F$, and the lines $K M$ and $C J$ meet at $G$. Let $S$ be the point of intersection of the lines $A F$ and $B C$, and let $T$ be the point of intersection of the lines $A G$ and $B C$. Prove that $M$ is the midpoint of $S T$.","Solution. Let $\alpha=\angle C A B, \beta=\angle A B C$ and $\gamma=\angle B C A$. The line $A J$ is the bisector of $\angle C A B$, so $\angle J A K=\angle J A L=\frac{\alpha}{2}$. By $\angle A K J=\angle A L J=90^{\circ}$ the points $K$ and $L$ lie on the circle $\omega$ with diameter $A J$.

The triangle $K B M$ is isosceles as $B K$ and $B M$ are tangents to the excircle. Since $B J$ is the bisector of $\angle K B M$, we have $\angle M B J=90^{\circ}-\frac{\beta}{2}$ and $\angle B M K=\frac{\beta}{2}$. Likewise $\angle M C J=90^{\circ}-\frac{\gamma}{2}$ and $\angle C M L=\frac{\gamma}{2}$. Also $\angle B M F=\angle C M L$, therefore

$$
\angle L F J=\angle M B J-\angle B M F=\left(90^{\circ}-\frac{\beta}{2}\right)-\frac{\gamma}{2}=\frac{\alpha}{2}=\angle L A J .
$$

Hence $F$ lies on the circle $\omega$. (By the angle computation, $F$ and $A$ are on the same side of $B C$.) Analogously, $G$ also lies on $\omega$. Since $A J$ is a diameter of $\omega$, we obtain $\angle A F J=\angle A G J=90^{\circ}$.\\
\includegraphics[max width=\textwidth, center]{2025_05_04_da9ecbcd73427ebbc2afg-29}

The lines $A B$ and $B C$ are symmetric with respect to the external bisector $B F$. Because $A F \perp B F$ and $K M \perp B F$, the segments $S M$ and $A K$ are symmetric with respect to $B F$, hence $S M=A K$. By symmetry $T M=A L$. Since $A K$ and $A L$ are equal as tangents to the excircle, it follows that $S M=T M$, and the proof is complete.

Comment. After discovering the circle $A F K J L G$, there are many other ways to complete the solution. For instance, from the cyclic quadrilaterals $J M F S$ and $J M G T$ one can find $\angle T S J=\angle S T J=\frac{\alpha}{2}$. Another possibility is to use the fact that the lines $A S$ and $G M$ are parallel (both are perpendicular to the external angle bisector $B J$ ), so $\frac{M S}{M T}=\frac{A G}{G T}=1$.",335,3
2012g2,"Let $A B C D$ be a cyclic quadrilateral whose diagonals $A C$ and $B D$ meet at $E$. The extensions of the sides $A D$ and $B C$ beyond $A$ and $B$ meet at $F$. Let $G$ be the point such that $E C G D$ is a parallelogram, and let $H$ be the image of $E$ under reflection in $A D$. Prove that $D, H, F, G$ are concyclic.","Solution. We show first that the triangles $F D G$ and $F B E$ are similar. Since $A B C D$ is cyclic, the triangles $E A B$ and $E D C$ are similar, as well as $F A B$ and $F C D$. The parallelogram $E C G D$ yields $G D=E C$ and $\angle C D G=\angle D C E$; also $\angle D C E=\angle D C A=\angle D B A$ by inscribed angles. Therefore

$$
\begin{gathered}
\angle F D G=\angle F D C+\angle C D G=\angle F B A+\angle A B D=\angle F B E \\
\frac{G D}{E B}=\frac{C E}{E B}=\frac{C D}{A B}=\frac{F D}{F B}
\end{gathered}
$$

It follows that $F D G$ and $F B E$ are similar, and so $\angle F G D=\angle F E B$.\\
\includegraphics[max width=\textwidth, center]{2025_05_04_da9ecbcd73427ebbc2afg-30}

Since $H$ is the reflection of $E$ with respect to $F D$, we conclude that

$$
\angle F H D=\angle F E D=180^{\circ}-\angle F E B=180^{\circ}-\angle F G D
$$

This proves that $D, H, F, G$ are concyclic.

Comment. Points $E$ and $G$ are always in the half-plane determined by the line $F D$ that contains $B$ and $C$, but $H$ is always in the other half-plane. In particular, $D H F G$ is cyclic if and only if $\angle F H D+\angle F G D=180^{\circ}$.",221,2
2012g3,"In an acute triangle $A B C$ the points $D, E$ and $F$ are the feet of the altitudes through $A$, $B$ and $C$ respectively. The incenters of the triangles $A E F$ and $B D F$ are $I_{1}$ and $I_{2}$ respectively; the circumcenters of the triangles $A C I_{1}$ and $B C I_{2}$ are $O_{1}$ and $O_{2}$ respectively. Prove that $I_{1} I_{2}$ and $O_{1} O_{2}$ are parallel.","Solution. Let $\angle C A B=\alpha, \angle A B C=\beta, \angle B C A=\gamma$. We start by showing that $A, B, I_{1}$ and $I_{2}$ are concyclic. Since $A I_{1}$ and $B I_{2}$ bisect $\angle C A B$ and $\angle A B C$, their extensions beyond $I_{1}$ and $I_{2}$ meet at the incenter $I$ of the triangle. The points $E$ and $F$ are on the circle with diameter $B C$, so $\angle A E F=\angle A B C$ and $\angle A F E=\angle A C B$. Hence the triangles $A E F$ and $A B C$ are similar with ratio of similitude $\frac{A E}{A B}=\cos \alpha$. Because $I_{1}$ and $I$ are their incenters, we obtain $I_{1} A=I A \cos \alpha$ and $I I_{1}=I A-I_{1} A=2 I A \sin ^{2} \frac{\alpha}{2}$. By symmetry $I I_{2}=2 I B \sin ^{2} \frac{\beta}{2}$. The law of sines in the triangle $A B I$ gives $I A \sin \frac{\alpha}{2}=I B \sin \frac{\beta}{2}$. Hence

$$
I I_{1} \cdot I A=2\left(I A \sin \frac{\alpha}{2}\right)^{2}=2\left(I B \sin \frac{\beta}{2}\right)^{2}=I I_{2} \cdot I B
$$

Therefore $A, B, I_{1}$ and $I_{2}$ are concyclic, as claimed.\\
\includegraphics[max width=\textwidth, center]{2025_05_04_da9ecbcd73427ebbc2afg-31}

In addition $I I_{1} \cdot I A=I I_{2} \cdot I B$ implies that $I$ has the same power with respect to the circles $\left(A C I_{1}\right),\left(B C I_{2}\right)$ and $\left(A B I_{1} I_{2}\right)$. Then $C I$ is the radical axis of $\left(A C I_{1}\right)$ and $\left(B C I_{2}\right)$; in particular $C I$ is perpendicular to the line of centers $O_{1} O_{2}$.

Now it suffices to prove that $C I \perp I_{1} I_{2}$. Let $C I$ meet $I_{1} I_{2}$ at $Q$, then it is enough to check that $\angle I I_{1} Q+\angle I_{1} I Q=90^{\circ}$. Since $\angle I_{1} I Q$ is external for the triangle $A C I$, we have

$$
\angle I I_{1} Q+\angle I_{1} I Q=\angle I I_{1} Q+(\angle A C I+\angle C A I)=\angle I I_{1} I_{2}+\angle A C I+\angle C A I .
$$

It remains to note that $\angle I I_{1} I_{2}=\frac{\beta}{2}$ from the cyclic quadrilateral $A B I_{1} I_{2}$, and $\angle A C I=\frac{\gamma}{2}$, $\angle C A I=\frac{\alpha}{2}$. Therefore $\angle I I_{1} Q+\angle I_{1} I Q=\frac{\alpha}{2}+\frac{\beta}{2}+\frac{\gamma}{2}=90^{\circ}$, completing the proof.

Comment. It follows from the first part of the solution that the common point $I_{3} \neq C$ of the circles $\left(A C I_{1}\right)$ and $\left(B C I_{2}\right)$ is the incenter of the triangle $C D E$.",397,3
2012g4,Let $A B C$ be a triangle with $A B \neq A C$ and circumcenter $O$. The bisector of $\angle B A C$ intersects $B C$ at $D$. Let $E$ be the reflection of $D$ with respect to the midpoint of $B C$. The lines through $D$ and $E$ perpendicular to $B C$ intersect the lines $A O$ and $A D$ at $X$ and $Y$ respectively. Prove that the quadrilateral $B X C Y$ is cyclic.,"Solution. The bisector of $\angle B A C$ and the perpendicular bisector of $B C$ meet at $P$, the midpoint of the minor arc $\widehat{B C}$ (they are different lines as $A B \neq A C$ ). In particular $O P$ is perpendicular to $B C$ and intersects it at $M$, the midpoint of $B C$.

Denote by $Y^{\prime}$ the reflexion of $Y$ with respect to $O P$. Since $\angle B Y C=\angle B Y^{\prime} C$, it suffices to prove that $B X C Y^{\prime}$ is cyclic.\\
\includegraphics[max width=\textwidth, center]{2025_05_04_da9ecbcd73427ebbc2afg-32}

We have

$$
\angle X A P=\angle O P A=\angle E Y P .
$$

The first equality holds because $O A=O P$, and the second one because $E Y$ and $O P$ are both perpendicular to $B C$ and hence parallel. But $\left\{Y, Y^{\prime}\right\}$ and $\{E, D\}$ are pairs of symmetric points with respect to $O P$, it follows that $\angle E Y P=\angle D Y^{\prime} P$ and hence

$$
\angle X A P=\angle D Y^{\prime} P=\angle X Y^{\prime} P .
$$

The last equation implies that $X A Y^{\prime} P$ is cyclic. By the powers of $D$ with respect to the circles $\left(X A Y^{\prime} P\right)$ and $(A B P C)$ we obtain

$$
X D \cdot D Y^{\prime}=A D \cdot D P=B D \cdot D C .
$$

It follows that $B X C Y^{\prime}$ is cyclic, as desired.",232,2
2012g5,"Let $A B C$ be a triangle with $\angle B C A=90^{\circ}$, and let $C_{0}$ be the foot of the altitude from $C$. Choose a point $X$ in the interior of the segment $C C_{0}$, and let $K, L$ be the points on the segments $A X, B X$ for which $B K=B C$ and $A L=A C$ respectively. Denote by $M$ the intersection of $A L$ and $B K$. Show that $M K=M L$.","Solution. Let $C^{\prime}$ be the reflection of $C$ in the line $A B$, and let $\omega_{1}$ and $\omega_{2}$ be the circles with centers $A$ and $B$, passing through $L$ and $K$ respectively. Since $A C^{\prime}=A C=A L$ and $B C^{\prime}=B C=B K$, both $\omega_{1}$ and $\omega_{2}$ pass through $C$ and $C^{\prime}$. By $\angle B C A=90^{\circ}, A C$ is tangent to $\omega_{2}$ at $C$, and $B C$ is tangent to $\omega_{1}$ at $C$. Let $K_{1} \neq K$ be the second intersection of $A X$ and $\omega_{2}$, and let $L_{1} \neq L$ be the second intersection of $B X$ and $\omega_{1}$.\\
\includegraphics[max width=\textwidth, center]{2025_05_04_da9ecbcd73427ebbc2afg-33}

By the powers of $X$ with respect to $\omega_{2}$ and $\omega_{1}$,

$$
X K \cdot X K_{1}=X C \cdot X C^{\prime}=X L \cdot X L_{1}
$$

so the points $K_{1}, L, K, L_{1}$ lie on a circle $\omega_{3}$.\\
The power of $A$ with respect to $\omega_{2}$ gives

$$
A L^{2}=A C^{2}=A K \cdot A K_{1}
$$

indicating that $A L$ is tangent to $\omega_{3}$ at $L$. Analogously, $B K$ is tangent to $\omega_{3}$ at $K$. Hence $M K$ and $M L$ are the two tangents from $M$ to $\omega_{3}$ and therefore $M K=M L$.",197,2
2012g6,"Let $A B C$ be a triangle with circumcenter $O$ and incenter $I$. The points $D, E$ and $F$ on the sides $B C, C A$ and $A B$ respectively are such that $B D+B F=C A$ and $C D+C E=A B$. The circumcircles of the triangles $B F D$ and $C D E$ intersect at $P \neq D$. Prove that $O P=O I$.","Solution. By Miquel's theorem the circles $(A E F)=\omega_{A},(B F D)=\omega_{B}$ and $(C D E)=\omega_{C}$ have a common point, for arbitrary points $D, E$ and $F$ on $B C, C A$ and $A B$. So $\omega_{A}$ passes through the common point $P \neq D$ of $\omega_{B}$ and $\omega_{C}$.

Let $\omega_{A}, \omega_{B}$ and $\omega_{C}$ meet the bisectors $A I, B I$ and $C I$ at $A \neq A^{\prime}, B \neq B^{\prime}$ and $C \neq C^{\prime}$ respectively. The key observation is that $A^{\prime}, B^{\prime}$ and $C^{\prime}$ do not depend on the particular choice of $D, E$ and $F$, provided that $B D+B F=C A, C D+C E=A B$ and $A E+A F=B C$ hold true (the last equality follows from the other two). For a proof we need the following fact.\\
Lemma. Given is an angle with vertex $A$ and measure $\alpha$. A circle $\omega$ through $A$ intersects the angle bisector at $L$ and sides of the angle at $X$ and $Y$. Then $A X+A Y=2 A L \cos \frac{\alpha}{2}$.\\
Proof. Note that $L$ is the midpoint of $\operatorname{arc} \widehat{X L Y}$ in $\omega$ and set $X L=Y L=u, X Y=v$. By Ptolemy's theorem $A X \cdot Y L+A Y \cdot X L=A L \cdot X Y$, which rewrites as $(A X+A Y) u=A L \cdot v$. Since $\angle L X Y=\frac{\alpha}{2}$ and $\angle X L Y=180^{\circ}-\alpha$, we have $v=2 \cos \frac{\alpha}{2} u$ by the law of sines, and the claim follows.\\
\includegraphics[max width=\textwidth, center]{2025_05_04_da9ecbcd73427ebbc2afg-34}

Apply the lemma to $\angle B A C=\alpha$ and the circle $\omega=\omega_{A}$, which intersects $A I$ at $A^{\prime}$. This gives $2 A A^{\prime} \cos \frac{\alpha}{2}=A E+A F=B C$; by symmetry analogous relations hold for $B B^{\prime}$ and $C C^{\prime}$. It follows that $A^{\prime}, B^{\prime}$ and $C^{\prime}$ are independent of the choice of $D, E$ and $F$, as stated.

We use the lemma two more times with $\angle B A C=\alpha$. Let $\omega$ be the circle with diameter $A I$. Then $X$ and $Y$ are the tangency points of the incircle of $A B C$ with $A B$ and $A C$, and hence $A X=A Y=\frac{1}{2}(A B+A C-B C)$. So the lemma yields $2 A I \cos \frac{\alpha}{2}=A B+A C-B C$. Next, if $\omega$ is the circumcircle of $A B C$ and $A I$ intersects $\omega$ at $M \neq A$ then $\{X, Y\}=\{B, C\}$, and so $2 A M \cos \frac{\alpha}{2}=A B+A C$ by the lemma. To summarize,


\begin{equation*}
2 A A^{\prime} \cos \frac{\alpha}{2}=B C, \quad 2 A I \cos \frac{\alpha}{2}=A B+A C-B C, \quad 2 A M \cos \frac{\alpha}{2}=A B+A C . \tag{}
\end{equation*}


These equalities imply $A A^{\prime}+A I=A M$, hence the segments $A M$ and $I A^{\prime}$ have a common midpoint. It follows that $I$ and $A^{\prime}$ are equidistant from the circumcenter $O$. By symmetry $O I=O A^{\prime}=O B^{\prime}=O C^{\prime}$, so $I, A^{\prime}, B^{\prime}, C^{\prime}$ are on a circle centered at $O$.

To prove $O P=O I$, now it suffices to show that $I, A^{\prime}, B^{\prime}, C^{\prime}$ and $P$ are concyclic. Clearly one can assume $P \neq I, A^{\prime}, B^{\prime}, C^{\prime}$.

We use oriented angles to avoid heavy case distinction. The oriented angle between the lines $l$ and $m$ is denoted by $\angle(l, m)$. We have $\angle(l, m)=-\angle(m, l)$ and $\angle(l, m)+\angle(m, n)=\angle(l, n)$ for arbitrary lines $l, m$ and $n$. Four distinct non-collinear points $U, V, X, Y$ are concyclic if and only if $\angle(U X, V X)=\angle(U Y, V Y)$.\\
\includegraphics[max width=\textwidth, center]{2025_05_04_da9ecbcd73427ebbc2afg-35}

Suppose for the moment that $A^{\prime}, B^{\prime}, P, I$ are distinct and noncollinear; then it is enough to check the equality $\angle\left(A^{\prime} P, B^{\prime} P\right)=\angle\left(A^{\prime} I, B^{\prime} I\right)$. Because $A, F, P, A^{\prime}$ are on the circle $\omega_{A}$, we have $\angle\left(A^{\prime} P, F P\right)=\angle\left(A^{\prime} A, F A\right)=\angle\left(A^{\prime} I, A B\right)$. Likewise $\angle\left(B^{\prime} P, F P\right)=\angle\left(B^{\prime} I, A B\right)$. Therefore

$$
\angle\left(A^{\prime} P, B^{\prime} P\right)=\angle\left(A^{\prime} P, F P\right)+\angle\left(F P, B^{\prime} P\right)=\angle\left(A^{\prime} I, A B\right)-\angle\left(B^{\prime} I, A B\right)=\angle\left(A^{\prime} I, B^{\prime} I\right)
$$

Here we assumed that $P \neq F$. If $P=F$ then $P \neq D, E$ and the conclusion follows similarly (use $\angle\left(A^{\prime} F, B^{\prime} F\right)=\angle\left(A^{\prime} F, E F\right)+\angle(E F, D F)+\angle\left(D F, B^{\prime} F\right)$ and inscribed angles in $\left.\omega_{A}, \omega_{B}, \omega_{C}\right)$.

There is no loss of generality in assuming $A^{\prime}, B^{\prime}, P, I$ distinct and noncollinear. If $A B C$ is an equilateral triangle then the equalities $\left(^{*}\right.$ ) imply that $A^{\prime}, B^{\prime}, C^{\prime}, I, O$ and $P$ coincide, so $O P=O I$. Otherwise at most one of $A^{\prime}, B^{\prime}, C^{\prime}$ coincides with $I$. If say $C^{\prime}=I$ then $O I \perp C I$ by the previous reasoning. It follows that $A^{\prime}, B^{\prime} \neq I$ and hence $A^{\prime} \neq B^{\prime}$. Finally $A^{\prime}, B^{\prime}$ and $I$ are noncollinear because $I, A^{\prime}, B^{\prime}, C^{\prime}$ are concyclic.

Comment. The proposer remarks that the locus $\gamma$ of the points $P$ is an arc of the circle $\left(A^{\prime} B^{\prime} C^{\prime} I\right)$. The reflection $I^{\prime}$ of $I$ in $O$ belongs to $\gamma$; it is obtained by choosing $D, E$ and $F$ to be the tangency points of the three excircles with their respective sides. The rest of the circle $\left(A^{\prime} B^{\prime} C^{\prime} I\right)$, except $I$, can be included in $\gamma$ by letting $D, E$ and $F$ vary on the extensions of the sides and assuming signed lengths. For instance if $B$ is between $C$ and $D$ then the length $B D$ must be taken with a negative sign. The incenter $I$ corresponds to the limit case where $D$ tends to infinity.",903,4
2012g7,Let $A B C D$ be a convex quadrilateral with non-parallel sides $B C$ and $A D$. Assume that there is a point $E$ on the side $B C$ such that the quadrilaterals $A B E D$ and $A E C D$ are circumscribed. Prove that there is a point $F$ on the side $A D$ such that the quadrilaterals $A B C F$ and $B C D F$ are circumscribed if and only if $A B$ is parallel to $C D$.,"Solution. Let $\omega_{1}$ and $\omega_{2}$ be the incircles and $O_{1}$ and $O_{2}$ the incenters of the quadrilaterals $A B E D$ and $A E C D$ respectively. A point $F$ with the stated property exists only if $\omega_{1}$ and $\omega_{2}$ are also the incircles of the quadrilaterals $A B C F$ and $B C D F$.\\
\includegraphics[max width=\textwidth, center]{2025_05_04_da9ecbcd73427ebbc2afg-36(1)}

Let the tangents from $B$ to $\omega_{2}$ and from $C$ to $\omega_{1}$ (other than $B C$ ) meet $A D$ at $F_{1}$ and $F_{2}$ respectively. We need to prove that $F_{1}=F_{2}$ if and only if $A B \| C D$.\\
$L e m m a$. The circles $\omega_{1}$ and $\omega_{2}$ with centers $O_{1}$ and $O_{2}$ are inscribed in an angle with vertex $O$. The points $P, S$ on one side of the angle and $Q, R$ on the other side are such that $\omega_{1}$ is the incircle of the triangle $P Q O$, and $\omega_{2}$ is the excircle of the triangle $R S O$ opposite to $O$. Denote $p=O O_{1} \cdot O O_{2}$. Then exactly one of the following relations holds:

$$
O P \cdot O R<p<O Q \cdot O S, \quad O P \cdot O R>p>O Q \cdot O S, \quad O P \cdot O R=p=O Q \cdot O S
$$

Proof. Denote $\angle O P O_{1}=u, \angle O Q O_{1}=v, \angle O O_{2} R=x, \angle O O_{2} S=y, \angle P O Q=2 \varphi$. Because $P O_{1}, Q O_{1}, R O_{2}, S O_{2}$ are internal or external bisectors in the triangles $P Q O$ and $R S O$, we have


\begin{equation*}
u+v=x+y\left(=90^{\circ}-\varphi\right) \tag{1}
\end{equation*}


\begin{center}
\includegraphics[max width=\textwidth]{2025_05_04_da9ecbcd73427ebbc2afg-36}
\end{center}

By the law of sines

$$
\frac{O P}{O O_{1}}=\frac{\sin (u+\varphi)}{\sin u} \quad \text { and } \quad \frac{O O_{2}}{O R}=\frac{\sin (x+\varphi)}{\sin x}
$$

Therefore, since $x, u$ and $\varphi$ are acute,\\
$O P \cdot O R \geq p \Leftrightarrow \frac{O P}{O O_{1}} \geq \frac{O O_{2}}{O R} \Leftrightarrow \sin x \sin (u+\varphi) \geq \sin u \sin (x+\varphi) \Leftrightarrow \sin (x-u) \geq 0 \Leftrightarrow x \geq u$.\\
Thus $O P \cdot O R \geq p$ is equivalent to $x \geq u$, with $O P \cdot O R=p$ if and only if $x=u$.\\
Analogously, $p \geq O Q \cdot O S$ is equivalent to $v \geq y$, with $p=O Q \cdot O S$ if and only if $v=y$. On the other hand $x \geq u$ and $v \geq y$ are equivalent by (1), with $x=u$ if and only if $v=y$. The conclusion of the lemma follows from here.

Going back to the problem, apply the lemma to the quadruples $\left\{B, E, D, F_{1}\right\},\{A, B, C, D\}$ and $\left\{A, E, C, F_{2}\right\}$. Assuming $O E \cdot O F_{1}>p$, we obtain

$$
O E \cdot O F_{1}>p \Rightarrow O B \cdot O D<p \Rightarrow O A \cdot O C>p \Rightarrow O E \cdot O F_{2}<p
$$

In other words, $O E \cdot O F_{1}>p$ implies

$$
O B \cdot O D<p<O A \cdot O C \quad \text { and } \quad O E \cdot O F_{1}>p>O E \cdot O F_{2}
$$

Similarly, $O E \cdot O F_{1}<p$ implies

$$
O B \cdot O D>p>O A \cdot O C \quad \text { and } \quad O E \cdot O F_{1}<p<O E \cdot O F_{2}
$$

In these cases $F_{1} \neq F_{2}$ and $O B \cdot O D \neq O A \cdot O C$, so the lines $A B$ and $C D$ are not parallel.\\
There remains the case $O E \cdot O F_{1}=p$. Here the lemma leads to $O B \cdot O D=p=O A \cdot O C$ and $O E \cdot O F_{1}=p=O E \cdot O F_{2}$. Therefore $F_{1}=F_{2}$ and $A B \| C D$.

Comment. The conclusion is also true if $B C$ and $A D$ are parallel. One can prove a limit case of the lemma for the configuration shown in the figure below, where $r_{1}$ and $r_{2}$ are parallel rays starting at $O^{\prime}$ and $O^{\prime \prime}$, with $O^{\prime} O^{\prime \prime} \perp r_{1}, r_{2}$ and $O$ the midpoint of $O^{\prime} O^{\prime \prime}$. Two circles with centers $O_{1}$ and $O_{2}$ are inscribed in the strip between $r_{1}$ and $r_{2}$. The lines $P Q$ and $R S$ are tangent to the circles, with $P, S$ on $r_{1}$, and $Q, R$ on $r_{2}$, so that $O, O_{1}$ are on the same side of $P Q$ and $O, O_{2}$ are on different sides of $R S$. Denote $s=O O_{1}+O O_{2}$. Then exactly one of the following relations holds:

$$
O^{\prime} P+O^{\prime \prime} R<s<O^{\prime \prime} Q+O^{\prime} S, \quad O^{\prime} P+O^{\prime \prime} R>s>O^{\prime \prime} Q+O^{\prime} S, \quad O^{\prime} P+O^{\prime \prime} R=s=O^{\prime \prime} Q+O^{\prime} S
$$

\begin{center}
\includegraphics[max width=\textwidth]{2025_05_04_da9ecbcd73427ebbc2afg-37}
\end{center}

Once this is established, the proof of the original statement for $B C \| A D$ is analogous to the one in the intersecting case. One replaces products by sums of relevant segments.",800,4
2012g8,"Let $A B C$ be a triangle with circumcircle $\omega$ and $\ell$ a line without common points with $\omega$. Denote by $P$ the foot of the perpendicular from the center of $\omega$ to $\ell$. The side-lines $B C, C A, A B$ intersect $\ell$ at the points $X, Y, Z$ different from $P$. Prove that the circumcircles of the triangles $A X P, B Y P$ and $C Z P$ have a common point different from $P$ or are mutually tangent at $P$.","Let $\omega_{A}, \omega_{B}, \omega_{C}$ and $\omega$ be the circumcircles of triangles $A X P, B Y P, C Z P$ and $A B C$ respectively. The strategy of the proof is to construct a point $Q$ with the same power with respect to the four circles. Then each of $P$ and $Q$ has the same power with respect to $\omega_{A}, \omega_{B}, \omega_{C}$ and hence the three circles are coaxial. In other words they have another common point $P^{\prime}$ or the three of them are tangent at $P$.

We first give a description of the point $Q$. Let $A^{\prime} \neq A$ be the second intersection of $\omega$ and $\omega_{A}$; define $B^{\prime}$ and $C^{\prime}$ analogously. We claim that $A A^{\prime}, B B^{\prime}$ and $C C^{\prime}$ have a common point. Once this claim is established, the point just constructed will be on the radical axes of the three pairs of circles $\left\{\omega, \omega_{A}\right\},\left\{\omega, \omega_{B}\right\},\left\{\omega, \omega_{C}\right\}$. Hence it will have the same power with respect to $\omega, \omega_{A}, \omega_{B}, \omega_{C}$.\\
\includegraphics[max width=\textwidth, center]{2025_05_04_da9ecbcd73427ebbc2afg-38}

We proceed to prove that $A A^{\prime}, B B^{\prime}$ and $C C^{\prime}$ intersect at one point. Let $r$ be the circumradius of triangle $A B C$. Define the points $X^{\prime}, Y^{\prime}, Z^{\prime}$ as the intersections of $A A^{\prime}, B B^{\prime}, C C^{\prime}$ with $\ell$. Observe that $X^{\prime}, Y^{\prime}, Z^{\prime}$ do exist. If $A A^{\prime}$ is parallel to $\ell$ then $\omega_{A}$ is tangent to $\ell$; hence $X=P$ which is a contradiction. Similarly, $B B^{\prime}$ and $C C^{\prime}$ are not parallel to $\ell$.

From the powers of the point $X^{\prime}$ with respect to the circles $\omega_{A}$ and $\omega$ we get

$$
X^{\prime} P \cdot\left(X^{\prime} P+P X\right)=X^{\prime} P \cdot X^{\prime} X=X^{\prime} A^{\prime} \cdot X^{\prime} A=X^{\prime} O^{2}-r^{2},
$$

hence

$$
X^{\prime} P \cdot P X=X^{\prime} O^{2}-r^{2}-X^{\prime} P^{2}=O P^{2}-r^{2} .
$$

We argue analogously for the points $Y^{\prime}$ and $Z^{\prime}$, obtaining


\begin{equation*}
X^{\prime} P \cdot P X=Y^{\prime} P \cdot P Y=Z^{\prime} P \cdot P Z=O P^{2}-r^{2}=k^{2} . \tag{1}
\end{equation*}


In these computations all segments are regarded as directed segments. We keep the same convention for the sequel.

We prove that the lines $A A^{\prime}, B B^{\prime}, C C^{\prime}$ intersect at one point by CEva's theorem. To avoid distracting remarks we interpret everything projectively, i. e. whenever two lines are parallel they meet at a point on the line at infinity.

Let $U, V, W$ be the intersections of $A A^{\prime}, B B^{\prime}, C C^{\prime}$ with $B C, C A, A B$ respectively. The idea is that although it is difficult to calculate the ratio $\frac{B U}{C U}$, it is easier to deal with the cross-ratio $\frac{B U}{C U} / \frac{B X}{C X}$ because we can send it to the line $\ell$. With this in mind we apply Menelaus' theorem to the triangle $A B C$ and obtain $\frac{B X}{C X} \cdot \frac{C Y}{A Y} \cdot \frac{A Z}{B Z}=1$. Hence Ceva's ratio can be expressed as

$$
\frac{B U}{C U} \cdot \frac{C V}{A V} \cdot \frac{A W}{B W}=\frac{B U}{C U} / \frac{B X}{C X} \cdot \frac{C V}{A V} / \frac{C Y}{A Y} \cdot \frac{A W}{B W} / \frac{A Z}{B Z} .
$$

\begin{center}
\includegraphics[max width=\textwidth]{2025_05_04_da9ecbcd73427ebbc2afg-39}
\end{center}

Project the line $B C$ to $\ell$ from $A$. The cross-ratio between $B C$ and $U X$ equals the cross-ratio between $Z Y$ and $X^{\prime} X$. Repeating the same argument with the lines $C A$ and $A B$ gives

$$
\frac{B U}{C U} \cdot \frac{C V}{A V} \cdot \frac{A W}{B W}=\frac{Z X^{\prime}}{Y X^{\prime}} / \frac{Z X}{Y X} \cdot \frac{X Y^{\prime}}{Z Y^{\prime}} / \frac{X Y}{Z Y} \cdot \frac{Y Z^{\prime}}{X Z^{\prime}} / \frac{Y Z}{X Z}
$$

and hence

$$
\frac{B U}{C U} \cdot \frac{C V}{A V} \cdot \frac{A W}{B W}=(-1) \cdot \frac{Z X^{\prime}}{Y X^{\prime}} \cdot \frac{X Y^{\prime}}{Z Y^{\prime}} \cdot \frac{Y Z^{\prime}}{X Z^{\prime}} .
$$

The equations (1) reduce the problem to a straightforward computation on the line $\ell$. For instance, the transformation $t \mapsto-k^{2} / t$ preserves cross-ratio and interchanges the points $X, Y, Z$ with the points $X^{\prime}, Y^{\prime}, Z^{\prime}$. Then

$$
\frac{B U}{C U} \cdot \frac{C V}{A V} \cdot \frac{A W}{B W}=(-1) \cdot \frac{Z X^{\prime}}{Y X^{\prime}} / \frac{Z Z^{\prime}}{Y Z^{\prime}} \cdot \frac{X Y^{\prime}}{Z Y^{\prime}} / \frac{X Z^{\prime}}{Z Z^{\prime}}=-1 .
$$

We proved that Ceva's ratio equals -1 , so $A A^{\prime}, B B^{\prime}, C C^{\prime}$ intersect at one point $Q$.\\",709,4
2012n6,"Let $x$ and $y$ be positive integers. If $x^{2^{n}}-1$ is divisible by $2^{n} y+1$ for every positive integer $n$, prove that $x=1$.","Solution. First we prove the following fact: For every positive integer $y$ there exist infinitely many primes $p \equiv 3(\bmod 4)$ such that $p$ divides some number of the form $2^{n} y+1$.

Clearly it is enough to consider the case $y$ odd. Let

$$
2 y+1=p_{1}^{e_{1}} \cdots p_{r}^{e_{r}}
$$

be the prime factorization of $2 y+1$. Suppose on the contrary that there are finitely many primes $p_{r+1}, \ldots, p_{r+s} \equiv 3(\bmod 4)$ that divide some number of the form $2^{n} y+1$ but do not divide $2 y+1$.

We want to find an $n$ such that $p_{i}^{e_{i}} \| 2^{n} y+1$ for $1 \leq i \leq r$ and $p_{i} \nmid 2^{n} y+1$ for $r+1 \leq i \leq r+s$. For this it suffices to take

$$
n=1+\varphi\left(p_{1}^{e_{1}+1} \cdots p_{r}^{e_{r}+1} p_{r+1}^{1} \cdots p_{r+s}^{1}\right),
$$

because then

$$
2^{n} y+1 \equiv 2 y+1 \quad\left(\bmod p_{1}^{e_{1}+1} \cdots p_{r}^{e_{r}+1} p_{r+1}^{1} \cdots p_{r+s}^{1}\right) .
$$

The last congruence means that $p_{1}^{e_{1}}, \ldots, p_{r}^{e_{r}}$ divide exactly $2^{n} y+1$ and no prime $p_{r+1}, \ldots, p_{r+s}$ divides $2^{n} y+1$. It follows that the prime factorization of $2^{n} y+1$ consists of the prime powers $p_{1}^{e_{1}}, \ldots, p_{r}^{e_{r}}$ and powers of primes $\equiv 1(\bmod 4)$. Because $y$ is odd, we obtain

$$
2^{n} y+1 \equiv p_{1}^{e_{1}} \cdots p_{r}^{e_{r}} \equiv 2 y+1 \equiv 3 \quad(\bmod 4) .
$$

This is a contradiction since $n>1$, and so $2^{n} y+1 \equiv 1(\bmod 4)$.\\
Now we proceed to the problem. If $p$ is a prime divisor of $2^{n} y+1$ the problem statement implies that $x^{d} \equiv 1(\bmod p)$ for $d=2^{n}$. By Fermat's little theorem the same congruence holds for $d=p-1$, so it must also hold for $d=\left(2^{n}, p-1\right)$. For $p \equiv 3(\bmod 4)$ we have $\left(2^{n}, p-1\right)=2$, therefore in this case $x^{2} \equiv 1(\bmod p)$.

In summary, we proved that every prime $p \equiv 3(\bmod 4)$ that divides some number of the form $2^{n} y+1$ also divides $x^{2}-1$. This is possible only if $x=1$, otherwise by the above $x^{2}-1$ would be a positive integer with infinitely many prime factors.

Comment. For each $x$ and each odd prime $p$ the maximal power of $p$ dividing $x^{2^{n}}-1$ for some $n$ is bounded and hence the same must be true for the numbers $2^{n} y+1$. We infer that $p^{2}$ divides $2^{p-1}-1$ for each prime divisor $p$ of $2^{n} y+1$. However trying to reach a contradiction with this conclusion alone seems hopeless, since it is not even known if there are infinitely many primes $p$ without this property.",407,3
2012n8,Prove that for every prime $p>100$ and every integer $r$ there exist two integers $a$ and $b$ such that $p$ divides $a^{2}+b^{5}-r$.,"Throughout the solution, all congruence relations are meant modulo $p$.\\
Fix $p$, and let $\mathcal{P}=\{0,1, \ldots, p-1\}$ be the set of residue classes modulo $p$. For every $r \in \mathcal{P}$, let $S_{r}=\left\{(a, b) \in \mathcal{P} \times \mathcal{P}: a^{2}+b^{5} \equiv r\right\}$, and let $s_{r}=\left|S_{r}\right|$. Our aim is to prove $s_{r}>0$ for all $r \in \mathcal{P}$.

We will use the well-known fact that for every residue class $r \in \mathcal{P}$ and every positive integer $k$, there are at most $k$ values $x \in \mathcal{P}$ such that $x^{k} \equiv r$.\\
Lemma. Let $N$ be the number of quadruples $(a, b, c, d) \in \mathcal{P}^{4}$ for which $a^{2}+b^{5} \equiv c^{2}+d^{5}$. Then


\begin{equation*}
N=\sum_{r \in \mathcal{P}} s_{r}^{2} \tag{a}
\end{equation*}


and


\begin{equation*}
N \leq p\left(p^{2}+4 p-4\right) . \tag{b}
\end{equation*}


Proof. (a) For each residue class $r$ there exist exactly $s_{r}$ pairs $(a, b)$ with $a^{2}+b^{5} \equiv r$ and $s_{r}$ pairs $(c, d)$ with $c^{2}+d^{5} \equiv r$. So there are $s_{r}^{2}$ quadruples with $a^{2}+b^{5} \equiv c^{2}+d^{5} \equiv r$. Taking the sum over all $r \in \mathcal{P}$, the statement follows.\\
(b) Choose an arbitrary pair $(b, d) \in \mathcal{P}$ and look for the possible values of $a, c$.

\begin{enumerate}
  \item Suppose that $b^{5} \equiv d^{5}$, and let $k$ be the number of such pairs $(b, d)$. The value $b$ can be chosen in $p$ different ways. For $b \equiv 0$ only $d=0$ has this property; for the nonzero values of $b$ there are at most 5 possible values for $d$. So we have $k \leq 1+5(p-1)=5 p-4$.
\end{enumerate}

The values $a$ and $c$ must satisfy $a^{2} \equiv c^{2}$, so $a \equiv \pm c$, and there are exactly $2 p-1$ such pairs $(a, c)$.\\
2. Now suppose $b^{5} \not \equiv d^{5}$. In this case $a$ and $c$ must be distinct. By $(a-c)(a+c)=d^{5}-b^{5}$, the value of $a-c$ uniquely determines $a+c$ and thus $a$ and $c$ as well. Hence, there are $p-1$ suitable pairs ( $a, c$ ).

Thus, for each of the $k$ pairs $(b, d)$ with $b^{5} \equiv d^{5}$ there are $2 p-1$ pairs $(a, c)$, and for each of the other $p^{2}-k$ pairs $(b, d)$ there are $p-1$ pairs $(a, c)$. Hence,

$$
N=k(2 p-1)+\left(p^{2}-k\right)(p-1)=p^{2}(p-1)+k p \leq p^{2}(p-1)+(5 p-4) p=p\left(p^{2}+4 p-4\right) .
$$

To prove the statement of the problem, suppose that $S_{r}=\emptyset$ for some $r \in \mathcal{P}$; obviously $r \not \equiv 0$. Let $T=\left\{x^{10}: x \in \mathcal{P} \backslash\{0\}\right\}$ be the set of nonzero 10 th powers modulo $p$. Since each residue class is the 10 th power of at most 10 elements in $\mathcal{P}$, we have $|T| \geq \frac{p-1}{10} \geq 4$ by $p>100$.

For every $t \in T$, we have $S_{t r}=\emptyset$. Indeed, if $(x, y) \in S_{t r}$ and $t \equiv z^{10}$ then

$$
\left(z^{-5} x\right)^{2}+\left(z^{-2} y\right)^{5} \equiv t^{-1}\left(x^{2}+y^{5}\right) \equiv r
$$

so $\left(z^{-5} x, z^{-2} y\right) \in S_{r}$. So, there are at least $\frac{p-1}{10} \geq 4$ empty sets among $S_{1}, \ldots, S_{p-1}$, and there are at most $p-4$ nonzero values among $s_{0}, s_{2}, \ldots, s_{p-1}$. Then by the AM-QM inequality we obtain

$$
N=\sum_{r \in \mathcal{P} \backslash r T} s_{r}^{2} \geq \frac{1}{p-4}\left(\sum_{r \in \mathcal{P} \backslash r T} s_{r}\right)^{2}=\frac{|\mathcal{P} \times \mathcal{P}|^{2}}{p-4}=\frac{p^{4}}{p-4}>p\left(p^{2}+4 p-4\right),
$$

which is impossible by the lemma.
",523,4
2011a5,"Prove that for every positive integer $n$, the set $\{2,3,4, \ldots, 3 n+1\}$ can be partitioned into $n$ triples in such a way that the numbers from each triple are the lengths of the sides of some obtuse triangle.","Solution. Throughout the solution, we denote by $[a, b]$ the set $\{a, a+1, \ldots, b\}$. We say that $\{a, b, c\}$ is an obtuse triple if $a, b, c$ are the sides of some obtuse triangle.

We prove by induction on $n$ that there exists a partition of $[2,3 n+1]$ into $n$ obtuse triples $A_{i}$ ( $2 \leq i \leq n+1$ ) having the form $A_{i}=\left\{i, a_{i}, b_{i}\right\}$. For the base case $n=1$, one can simply set $A_{2}=\{2,3,4\}$. For the induction step, we need the following simple lemma.

Lemma. Suppose that the numbers $a<b<c$ form an obtuse triple, and let $x$ be any positive number. Then the triple $\{a, b+x, c+x\}$ is also obtuse.

Proof. The numbers $a<b+x<c+x$ are the sides of a triangle because $(c+x)-(b+x)=$ $c-b<a$. This triangle is obtuse since $(c+x)^{2}-(b+x)^{2}=(c-b)(c+b+2 x)>(c-b)(c+b)>a^{2}$.

Now we turn to the induction step. Let $n>1$ and put $t=\lfloor n / 2\rfloor<n$. By the induction hypothesis, there exists a partition of the set $[2,3 t+1]$ into $t$ obtuse triples $A_{i}^{\prime}=\left\{i, a_{i}^{\prime}, b_{i}^{\prime}\right\}$ $(i \in[2, t+1])$. For the same values of $i$, define $A_{i}=\left\{i, a_{i}^{\prime}+(n-t), b_{i}^{\prime}+(n-t)\right\}$. The constructed triples are obviously disjoint, and they are obtuse by the lemma. Moreover, we have

$$
\bigcup_{i=2}^{t+1} A_{i}=[2, t+1] \cup[n+2, n+2 t+1] .
$$

Next, for each $i \in[t+2, n+1]$, define $A_{i}=\{i, n+t+i, 2 n+i\}$. All these sets are disjoint, and

$$
\bigcup_{i=t+2}^{n+1} A_{i}=[t+2, n+1] \cup[n+2 t+2,2 n+t+1] \cup[2 n+t+2,3 n+1],
$$

SO

$$
\bigcup_{i=2}^{n+1} A_{i}=[2,3 n+1] .
$$

Thus, we are left to prove that the triple $A_{i}$ is obtuse for each $i \in[t+2, n+1]$.\\
Since $(2 n+i)-(n+t+i)=n-t<t+2 \leq i$, the elements of $A_{i}$ are the sides of a triangle. Next, we have\\
$(2 n+i)^{2}-(n+t+i)^{2}=(n-t)(3 n+t+2 i) \geq \frac{n}{2} \cdot(3 n+3(t+1)+1)>\frac{n}{2} \cdot \frac{9 n}{2} \geq(n+1)^{2} \geq i^{2}$, so this triangle is obtuse. The proof is completed.",300,3
2011a6,"Let $f$ be a function from the set of real numbers to itself that satisfies


\begin{equation*}
f(x+y) \leq y f(x)+f(f(x)) \tag{1}
\end{equation*}


for all real numbers $x$ and $y$. Prove that $f(x)=0$ for all $x \leq 0$.","Substituting $y=t-x$, we rewrite (1) as


\begin{equation*}
f(t) \leq t f(x)-x f(x)+f(f(x)) . \tag{2}
\end{equation*}


Consider now some real numbers $a, b$ and use (2) with $t=f(a), x=b$ as well as with $t=f(b)$, $x=a$. We get

$$
\begin{aligned}
& f(f(a))-f(f(b)) \leq f(a) f(b)-b f(b), \\
& f(f(b))-f(f(a)) \leq f(a) f(b)-a f(a) .
\end{aligned}
$$

Adding these two inequalities yields

$$
2 f(a) f(b) \geq a f(a)+b f(b) .
$$

Now, substitute $b=2 f(a)$ to obtain $2 f(a) f(b) \geq a f(a)+2 f(a) f(b)$, or $a f(a) \leq 0$. So, we get


\begin{equation*}
f(a) \geq 0 \quad \text { for all } a<0 . \tag{3}
\end{equation*}


Now suppose $f(x)>0$ for some real number $x$. From (2) we immediately get that for every $t<\frac{x f(x)-f(f(x))}{f(x)}$ we have $f(t)<0$. This contradicts (3); therefore


\begin{equation*}
f(x) \leq 0 \quad \text { for all real } x, \tag{4}
\end{equation*}


and by (3) again we get $f(x)=0$ for all $x<0$.\\
We are left to find $f(0)$. Setting $t=x<0$ in (2) we get

$$
0 \leq 0-0+f(0),
$$

so $f(0) \geq 0$. Combining this with (4) we obtain $f(0)=0$.
",182,2
2011a7,"Let $a, b$, and $c$ be positive real numbers satisfying $\min (a+b, b+c, c+a)>\sqrt{2}$ and $a^{2}+b^{2}+c^{2}=3$. Prove that


\begin{equation*}
\frac{a}{(b+c-a)^{2}}+\frac{b}{(c+a-b)^{2}}+\frac{c}{(a+b-c)^{2}} \geq \frac{3}{(a b c)^{2}} . \tag{1}
\end{equation*}


Throughout both solutions, we denote the sums of the form $f(a, b, c)+f(b, c, a)+f(c, a, b)$ by $\sum f(a, b, c)$.","The condition $b+c>\sqrt{2}$ implies $b^{2}+c^{2}>1$, so $a^{2}=3-\left(b^{2}+c^{2}\right)<2$, i.e. $a<\sqrt{2}<b+c$. Hence we have $b+c-a>0$, and also $c+a-b>0$ and $a+b-c>0$ for similar reasons.

We will use the variant of HLDER's inequality

$$
\frac{x_{1}^{p+1}}{y_{1}^{p}}+\frac{x_{1}^{p+1}}{y_{1}^{p}}+\ldots+\frac{x_{n}^{p+1}}{y_{n}^{p}} \geq \frac{\left(x_{1}+x_{2}+\ldots+x_{n}\right)^{p+1}}{\left(y_{1}+y_{2}+\ldots+y_{n}\right)^{p}}
$$

which holds for all positive real numbers $p, x_{1}, x_{2}, \ldots, x_{n}, y_{1}, y_{2}, \ldots, y_{n}$. Applying it to the left-hand side of (1) with $p=2$ and $n=3$, we get


\begin{equation*}
\sum \frac{a}{(b+c-a)^{2}}=\sum \frac{\left(a^{2}\right)^{3}}{a^{5}(b+c-a)^{2}} \geq \frac{\left(a^{2}+b^{2}+c^{2}\right)^{3}}{\left(\sum a^{5 / 2}(b+c-a)\right)^{2}}=\frac{27}{\left(\sum a^{5 / 2}(b+c-a)\right)^{2}} \tag{2}
\end{equation*}


To estimate the denominator of the right-hand part, we use an instance of Schur's inequality, namely

$$
\sum a^{3 / 2}(a-b)(a-c) \geq 0,
$$

which can be rewritten as

$$
\sum a^{5 / 2}(b+c-a) \leq a b c(\sqrt{a}+\sqrt{b}+\sqrt{c}) .
$$

Moreover, by the inequality between the arithmetic mean and the fourth power mean we also have

$$
\left(\frac{\sqrt{a}+\sqrt{b}+\sqrt{c}}{3}\right)^{4} \leq \frac{a^{2}+b^{2}+c^{2}}{3}=1,
$$

i.e., $\sqrt{a}+\sqrt{b}+\sqrt{c} \leq 3$. Hence, (2) yields

$$
\sum \frac{a}{(b+c-a)^{2}} \geq \frac{27}{(a b c(\sqrt{a}+\sqrt{b}+\sqrt{c}))^{2}} \geq \frac{3}{a^{2} b^{2} c^{2}}
$$

thus solving the problem.",162,2
2011c2,"Suppose that 1000 students are standing in a circle. Prove that there exists an integer $k$ with $100 \leq k \leq 300$ such that in this circle there exists a contiguous group of $2 k$ students, for which the first half contains the same number of girls as the second half.","Solution. Number the students consecutively from 1 to 1000 . Let $a_{i}=1$ if the $i$ th student is a girl, and $a_{i}=0$ otherwise. We expand this notion for all integers $i$ by setting $a_{i+1000}=$ $a_{i-1000}=a_{i}$. Next, let

$$
S_{k}(i)=a_{i}+a_{i+1}+\cdots+a_{i+k-1} .
$$

Now the statement of the problem can be reformulated as follows:\\
There exist an integer $k$ with $100 \leq k \leq 300$ and an index $i$ such that $S_{k}(i)=S_{k}(i+k)$.\\
Assume now that this statement is false. Choose an index $i$ such that $S_{100}(i)$ attains the maximal possible value. In particular, we have $S_{100}(i-100)-S_{100}(i)<0$ and $S_{100}(i)-S_{100}(i+100)>0$, for if we had an equality, then the statement would hold. This means that the function $S(j)$ $S(j+100)$ changes sign somewhere on the segment $[i-100, i]$, so there exists some index $j \in$ [ $i-100, i-1]$ such that


\begin{equation*}
S_{100}(j) \leq S_{100}(j+100)-1, \quad \text { but } \quad S_{100}(j+1) \geq S_{100}(j+101)+1 . \tag{1}
\end{equation*}


Subtracting the first inequality from the second one, we get $a_{j+100}-a_{j} \geq a_{j+200}-a_{j+100}+2$, so

$$
a_{j}=0, \quad a_{j+100}=1, \quad a_{j+200}=0 .
$$

Substituting this into the inequalities of (1), we also obtain $S_{99}(j+1) \leq S_{99}(j+101) \leq S_{99}(j+1)$, which implies


\begin{equation*}
S_{99}(j+1)=S_{99}(j+101) . \tag{2}
\end{equation*}


Now let $k$ and $\ell$ be the least positive integers such that $a_{j-k}=1$ and $a_{j+200+\ell}=1$. By symmetry, we may assume that $k \geq \ell$. If $k \geq 200$ then we have $a_{j}=a_{j-1}=\cdots=a_{j-199}=0$, so $S_{100}(j-199)=S_{100}(j-99)=0$, which contradicts the initial assumption. Hence $\ell \leq k \leq 199$. Finally, we have

$$
\begin{gathered}
S_{100+\ell}(j-\ell+1)=\left(a_{j-\ell+1}+\cdots+a_{j}\right)+S_{99}(j+1)+a_{j+100}=S_{99}(j+1)+1, \\
S_{100+\ell}(j+101)=S_{99}(j+101)+\left(a_{j+200}+\cdots+a_{j+200+\ell-1}\right)+a_{j+200+\ell}=S_{99}(j+101)+1 .
\end{gathered}
$$

Comparing with (2) we get $S_{100+\ell}(j-\ell+1)=S_{100+\ell}(j+101)$ and $100+\ell \leq 299$, which again contradicts our assumption.

Comment. It may be seen from the solution that the number 300 from the problem statement can be\\
replaced by 299. Here we consider some improvements of this result. Namely, we investigate which interval can be put instead of $[100,300]$ in order to keep the problem statement valid.

First of all, the two examples

$$
\underbrace{1,1, \ldots, 1}_{167}, \underbrace{0,0, \ldots, 0}_{167}, \underbrace{1,1, \ldots, 1}_{167}, \underbrace{0,0, \ldots, 0}_{167}, \underbrace{1,1, \ldots, 1}_{167}, \underbrace{0,0, \ldots, 0}_{165}
$$

and

$$
\underbrace{1,1, \ldots, 1}_{249}, \underbrace{0,0, \ldots, 0}_{251}, \underbrace{1,1, \ldots, 1}_{249}, \underbrace{0,0, \ldots, 0}_{251}
$$

show that the interval can be changed neither to $[84,248]$ nor to $[126,374]$.\\[0pt]
On the other hand, we claim that this interval can be changed to [125, 250]. Note that this statement is invariant under replacing all 1's by 0's and vice versa. Assume, to the contrary, that there is no admissible $k \in[125,250]$. The arguments from the solution easily yield the following lemma.

Lemma. Under our assumption, suppose that for some indices $i<j$ we have $S_{125}(i) \leq S_{125}(i+125)$ but $S_{125}(j) \geq S_{125}(j+125)$. Then there exists some $t \in[i, j-1]$ such that $a_{t}=a_{t-1}=\cdots=a_{t-125}=0$ and $a_{t+250}=a_{t+251}=\cdots=a_{t+375}=0$.

Let us call a segment $[i, j]$ of indices a crowd, if (a) $a_{i}=a_{i+1}=\cdots=a_{j}$, but $a_{i-1} \neq a_{i} \neq a_{j+1}$, and (b) $j-i \geq 125$. Now, using the lemma, one can get in the same way as in the solution that there exists some crowd. Take all the crowds in the circle, and enumerate them in cyclic order as $A_{1}, \ldots, A_{d}$. We also assume always that $A_{s+d}=A_{s-d}=A_{s}$.

Consider one of the crowds, say $A_{1}$. We have $A_{1}=[i, i+t]$ with $125 \leq t \leq 248$ (if $t \geq 249$, then $a_{i}=a_{i+1}=\cdots=a_{i+249}$ and therefore $S_{125}(i)=S_{125}(i+125)$, which contradicts our assumption). We may assume that $a_{i}=1$. Then we have $S_{125}(i+t-249) \leq 125=S_{125}(i+t-124)$ and $S_{125}(i)=125 \geq S_{125}(i+125)$, so by the lemma there exists some index $j \in[i+t-249, i-1]$ such that the segments $[j-125, j]$ and $[j+250, j+375]$ are contained in some crowds.

Let us fix such $j$ and denote the segment $[j+1, j+249]$ by $B_{1}$. Clearly, $A_{1} \subseteq B_{1}$. Moreover, $B_{1}$ cannot contain any crowd other than $A_{1}$ since $\left|B_{1}\right|=249<2 \cdot 126$. Hence it is clear that $j \in A_{d}$ and $j+250 \in A_{2}$. In particular, this means that the genders of $A_{d}$ and $A_{2}$ are different from that of $A_{1}$.

Performing this procedure for every crowd $A_{s}$, we find segments $B_{s}=\left[j_{s}+1, j_{s}+249\right]$ such that $\left|B_{s}\right|=249, A_{s} \subseteq B_{s}$, and $j_{s} \in A_{s-1}, j_{s}+250 \in A_{s+1}$. So, $B_{s}$ covers the whole segment between $A_{s-1}$ and $A_{s+1}$, hence the sets $B_{1}, \ldots, B_{d}$ cover some 1000 consecutive indices. This implies $249 d \geq 1000$, and $d \geq 5$. Moreover, the gender of $A_{i}$ is alternating, so $d$ is even; therefore $d \geq 6$.

Consider now three segments $A_{1}=\left[i_{1}, i_{1}^{\prime}\right], B_{2}=\left[j_{2}+1, j_{2}+249\right]$, $A_{3}=\left[i_{3}, i_{3}^{\prime}\right]$. By construction, we have $\left[j_{2}-125, j_{2}\right] \subseteq A_{1}$ and $\left[j_{2}+250, j_{2}+375\right] \subseteq A_{3}$, whence $i_{1} \leq j_{2}-125, i_{3}^{\prime} \geq j_{2}+375$. Therefore $i_{3}^{\prime}-i_{1} \geq 500$. Analogously, if $A_{4}=\left[i_{4}, i_{4}^{\prime}\right], A_{6}=\left[i_{6}, i_{6}^{\prime}\right]$ then $i_{6}^{\prime}-i_{4} \geq 500$. But from $d \geq 6$ we get $i_{1}<i_{3}^{\prime}<i_{4}<i_{6}^{\prime}<i_{1}+1000$, so $1000>\left(i_{3}^{\prime}-i_{1}\right)+\left(i_{6}^{\prime}-i_{4}\right) \geq 500+500$. This final contradiction shows that our claim holds.

One may even show that the interval in the statement of the problem may be replaced by [125, 249] (both these numbers cannot be improved due to the examples above). But a proof of this fact is a bit messy, and we do not present it here.",828,4
2011c3,"Let $\mathcal{S}$ be a finite set of at least two points in the plane. Assume that no three points of $\mathcal{S}$ are collinear. By a windmill we mean a process as follows. Start with a line $\ell$ going through a point $P \in \mathcal{S}$. Rotate $\ell$ clockwise around the pivot $P$ until the line contains another point $Q$ of $\mathcal{S}$. The point $Q$ now takes over as the new pivot. This process continues indefinitely, with the pivot always being a point from $\mathcal{S}$.

Show that for a suitable $P \in \mathcal{S}$ and a suitable starting line $\ell$ containing $P$, the resulting windmill will visit each point of $\mathcal{S}$ as a pivot infinitely often.","Solution. Give the rotating line an orientation and distinguish its sides as the oranje side and the blue side. Notice that whenever the pivot changes from some point $T$ to another point $U$, after the change, $T$ is on the same side as $U$ was before. Therefore, the number of elements of $\mathcal{S}$ on the oranje side and the number of those on the blue side remain the same throughout the whole process (except for those moments when the line contains two points).\\
\includegraphics[max width=\textwidth, center]{2025_05_04_e6233e4fb964804c4c48g-32}

First consider the case that $|\mathcal{S}|=2 n+1$ is odd. We claim that through any point $T \in \mathcal{S}$, there is a line that has $n$ points on each side. To see this, choose an oriented line through $T$ containing no other point of $\mathcal{S}$ and suppose that it has $n+r$ points on its oranje side. If $r=0$ then we have established the claim, so we may assume that $r \neq 0$. As the line rotates through $180^{\circ}$ around $T$, the number of points of $\mathcal{S}$ on its oranje side changes by 1 whenever the line passes through a point; after $180^{\circ}$, the number of points on the oranje side is $n-r$. Therefore there is an intermediate stage at which the oranje side, and thus also the blue side, contains $n$ points.

Now select the point $P$ arbitrarily, and choose a line through $P$ that has $n$ points of $\mathcal{S}$ on each side to be the initial state of the windmill. We will show that during a rotation over $180^{\circ}$, the line of the windmill visits each point of $\mathcal{S}$ as a pivot. To see this, select any point $T$ of $\mathcal{S}$ and select a line $\ell$ through $T$ that separates $\mathcal{S}$ into equal halves. The point $T$ is the unique point of $\mathcal{S}$ through which a line in this direction can separate the points of $\mathcal{S}$ into equal halves (parallel translation would disturb the balance). Therefore, when the windmill line is parallel to $\ell$, it must be $\ell$ itself, and so pass through $T$.

Next suppose that $|\mathcal{S}|=2 n$. Similarly to the odd case, for every $T \in \mathcal{S}$ there is an oriented\\
line through $T$ with $n-1$ points on its oranje side and $n$ points on its blue side. Select such an oriented line through an arbitrary $P$ to be the initial state of the windmill.

We will now show that during a rotation over $360^{\circ}$, the line of the windmill visits each point of $\mathcal{S}$ as a pivot. To see this, select any point $T$ of $\mathcal{S}$ and an oriented line $\ell$ through $T$ that separates $\mathcal{S}$ into two subsets with $n-1$ points on its oranje and $n$ points on its blue side. Again, parallel translation would change the numbers of points on the two sides, so when the windmill line is parallel to $\ell$ with the same orientation, the windmill line must pass through $T$.

Comment. One may shorten this solution in the following way.\\
Suppose that $|\mathcal{S}|=2 n+1$. Consider any line $\ell$ that separates $\mathcal{S}$ into equal halves; this line is unique given its direction and contains some point $T \in \mathcal{S}$. Consider the windmill starting from this line. When the line has made a rotation of $180^{\circ}$, it returns to the same location but the oranje side becomes blue and vice versa. So, for each point there should have been a moment when it appeared as pivot, as this is the only way for a point to pass from on side to the other.

Now suppose that $|\mathcal{S}|=2 n$. Consider a line having $n-1$ and $n$ points on the two sides; it contains some point $T$. Consider the windmill starting from this line. After having made a rotation of $180^{\circ}$, the windmill line contains some different point $R$, and each point different from $T$ and $R$ has changed the color of its side. So, the windmill should have passed through all the points.",654,4
2011c6,"Let $n$ be a positive integer and let $W=\ldots x_{-1} x_{0} x_{1} x_{2} \ldots$ be an infinite periodic word consisting of the letters $a$ and $b$. Suppose that the minimal period $N$ of $W$ is greater than $2^{n}$.

A finite nonempty word $U$ is said to appear in $W$ if there exist indices $k \leq \ell$ such that $U=x_{k} x_{k+1} \ldots x_{\ell}$. A finite word $U$ is called ubiquitous if the four words $U a, U b, a U$, and $b U$ all appear in $W$. Prove that there are at least $n$ ubiquitous finite nonempty words.","Solution. Throughout the solution, all the words are nonempty. For any word $R$ of length $m$, we call the number of indices $i \in\{1,2, \ldots, N\}$ for which $R$ coincides with the subword $x_{i+1} x_{i+2} \ldots x_{i+m}$ of $W$ the multiplicity of $R$ and denote it by $\mu(R)$. Thus a word $R$ appears in $W$ if and only if $\mu(R)>0$. Since each occurrence of a word in $W$ is both succeeded by either the letter $a$ or the letter $b$ and similarly preceded by one of those two letters, we have


\begin{equation*}
\mu(R)=\mu(R a)+\mu(R b)=\mu(a R)+\mu(b R) \tag{1}
\end{equation*}


for all words $R$.\\
We claim that the condition that $N$ is in fact the minimal period of $W$ guarantees that each word of length $N$ has multiplicity 1 or 0 depending on whether it appears or not. Indeed, if the words $x_{i+1} x_{i+2} \ldots x_{i+N}$ and $x_{j+1} \ldots x_{j+N}$ are equal for some $1 \leq i<j \leq N$, then we have $x_{i+a}=x_{j+a}$ for every integer $a$, and hence $j-i$ is also a period.

Moreover, since $N>2^{n}$, at least one of the two words $a$ and $b$ has a multiplicity that is strictly larger than $2^{n-1}$.

For each $k=0,1, \ldots, n-1$, let $U_{k}$ be a subword of $W$ whose multiplicity is strictly larger than $2^{k}$ and whose length is maximal subject to this property. Note that such a word exists in view of the two observations made in the two previous paragraphs.

Fix some index $k \in\{0,1, \ldots, n-1\}$. Since the word $U_{k} b$ is longer than $U_{k}$, its multiplicity can be at most $2^{k}$, so in particular $\mu\left(U_{k} b\right)<\mu\left(U_{k}\right)$. Therefore, the word $U_{k} a$ has to appear by (1). For a similar reason, the words $U_{k} b, a U_{k}$, and $b U_{k}$ have to appear as well. Hence, the word $U_{k}$ is ubiquitous. Moreover, if the multiplicity of $U_{k}$ were strictly greater than $2^{k+1}$, then by (1) at least one of the two words $U_{k} a$ and $U_{k} b$ would have multiplicity greater than $2^{k}$ and would thus violate the maximality condition imposed on $U_{k}$.

So we have $\mu\left(U_{0}\right) \leq 2<\mu\left(U_{1}\right) \leq 4<\ldots \leq 2^{n-1}<\mu\left(U_{n-1}\right)$, which implies in particular that the words $U_{0}, U_{1}, \ldots, U_{n-1}$ have to be distinct. As they have been proved to be ubiquitous as well, the problem is solved.

Comment 1. There is an easy construction for obtaining ubiquitous words from appearing words whose multiplicity is at least two. Starting with any such word $U$ we may simply extend one of its occurrences in $W$ forwards and backwards as long as its multiplicity remains fixed, thus arriving at a\\
word that one might call the ubiquitous prolongation $p(U)$ of $U$.\\
There are several variants of the argument in the second half of the solution using the concept of prolongation. For instance, one may just take all ubiquitous words $U_{1}, U_{2}, \ldots, U_{\ell}$ ordered by increasing multiplicity and then prove for $i \in\{1,2, \ldots, \ell\}$ that $\mu\left(U_{i}\right) \leq 2^{i}$. Indeed, assume that $i$ is a minimal counterexample to this statement; then by the arguments similar to those presented above, the ubiquitous prolongation of one of the words $U_{i} a, U_{i} b, a U_{i}$ or $b U_{i}$ violates the definition of $U_{i}$.\\
Now the multiplicity of one of the two letters $a$ and $b$ is strictly greater than $2^{n-1}$, so passing to ubiquitous prolongations once more we obtain $2^{n-1}<\mu\left(U_{\ell}\right) \leq 2^{\ell}$, which entails $\ell \geq n$, as needed.

Comment 2. The bound $n$ for the number of ubiquitous subwords in the problem statement is not optimal, but it is close to an optimal one in the following sense. There is a universal constant $C>0$ such that for each positive integer $n$ there exists an infinite periodic word $W$ whose minimal period is greater than $2^{n}$ but for which there exist fewer than $C n$ ubiquitous words.",639,4
2011g1,Let $A B C$ be an acute triangle. Let $\omega$ be a circle whose center $L$ lies on the side $B C$. Suppose that $\omega$ is tangent to $A B$ at $B^{\prime}$ and to $A C$ at $C^{\prime}$. Suppose also that the circumcenter $O$ of the triangle $A B C$ lies on the shorter arc $B^{\prime} C^{\prime}$ of $\omega$. Prove that the circumcircle of $A B C$ and $\omega$ meet at two points.,"Solution. The point $B^{\prime}$, being the perpendicular foot of $L$, is an interior point of side $A B$. Analogously, $C^{\prime}$ lies in the interior of $A C$. The point $O$ is located inside the triangle $A B^{\prime} C^{\prime}$, hence $\angle C O B<\angle C^{\prime} O B^{\prime}$.\\
\includegraphics[max width=\textwidth, center]{2025_05_04_e6233e4fb964804c4c48g-45}

Let $\alpha=\angle C A B$. The angles $\angle C A B$ and $\angle C^{\prime} O B^{\prime}$ are inscribed into the two circles with centers $O$ and $L$, respectively, so $\angle C O B=2 \angle C A B=2 \alpha$ and $2 \angle C^{\prime} O B^{\prime}=360^{\circ}-\angle C^{\prime} L B^{\prime}$. From the kite $A B^{\prime} L C^{\prime}$ we have $\angle C^{\prime} L B^{\prime}=180^{\circ}-\angle C^{\prime} A B^{\prime}=180^{\circ}-\alpha$. Combining these, we get

$$
2 \alpha=\angle C O B<\angle C^{\prime} O B^{\prime}=\frac{360^{\circ}-\angle C^{\prime} L B^{\prime}}{2}=\frac{360^{\circ}-\left(180^{\circ}-\alpha\right)}{2}=90^{\circ}+\frac{\alpha}{2},
$$

so

$$
\alpha<60^{\circ} .
$$

Let $O^{\prime}$ be the reflection of $O$ in the line $B C$. In the quadrilateral $A B O^{\prime} C$ we have

$$
\angle C O^{\prime} B+\angle C A B=\angle C O B+\angle C A B=2 \alpha+\alpha<180^{\circ},
$$

so the point $O^{\prime}$ is outside the circle $A B C$. Hence, $O$ and $O^{\prime}$ are two points of $\omega$ such that one of them lies inside the circumcircle, while the other one is located outside. Therefore, the two circles intersect.

Comment. There are different ways of reducing the statement of the problem to the case $\alpha<60^{\circ}$. E.g., since the point $O$ lies in the interior of the isosceles triangle $A B^{\prime} C^{\prime}$, we have $O A<A B^{\prime}$. So, if $A B^{\prime} \leq 2 L B^{\prime}$ then $O A<2 L O$, which means that $\omega$ intersects the circumcircle of $A B C$. Hence the only interesting case is $A B^{\prime}>2 L B^{\prime}$, and this condition implies $\angle C A B=2 \angle B^{\prime} A L<2 \cdot 30^{\circ}=60^{\circ}$.",297,3
2011g2,"Let $A_{1} A_{2} A_{3} A_{4}$ be a non-cyclic quadrilateral. Let $O_{1}$ and $r_{1}$ be the circumcenter and the circumradius of the triangle $A_{2} A_{3} A_{4}$. Define $O_{2}, O_{3}, O_{4}$ and $r_{2}, r_{3}, r_{4}$ in a similar way. Prove that

$$
\frac{1}{O_{1} A_{1}^{2}-r_{1}^{2}}+\frac{1}{O_{2} A_{2}^{2}-r_{2}^{2}}+\frac{1}{O_{3} A_{3}^{2}-r_{3}^{2}}+\frac{1}{O_{4} A_{4}^{2}-r_{4}^{2}}=0 .
$$","Let $M$ be the point of intersection of the diagonals $A_{1} A_{3}$ and $A_{2} A_{4}$. On each diagonal choose a direction and let $x, y, z$, and $w$ be the signed distances from $M$ to the points $A_{1}, A_{2}, A_{3}$, and $A_{4}$, respectively.

Let $\omega_{1}$ be the circumcircle of the triangle $A_{2} A_{3} A_{4}$ and let $B_{1}$ be the second intersection point of $\omega_{1}$ and $A_{1} A_{3}$ (thus, $B_{1}=A_{3}$ if and only if $A_{1} A_{3}$ is tangent to $\omega_{1}$ ). Since the expression $O_{1} A_{1}^{2}-r_{1}^{2}$ is the power of the point $A_{1}$ with respect to $\omega_{1}$, we get

$$
O_{1} A_{1}^{2}-r_{1}^{2}=A_{1} B_{1} \cdot A_{1} A_{3} .
$$

On the other hand, from the equality $M B_{1} \cdot M A_{3}=M A_{2} \cdot M A_{4}$ we obtain $M B_{1}=y w / z$. Hence, we have

$$
O_{1} A_{1}^{2}-r_{1}^{2}=\left(\frac{y w}{z}-x\right)(z-x)=\frac{z-x}{z}(y w-x z) .
$$

Substituting the analogous expressions into the sought sum we get

$$
\sum_{i=1}^{4} \frac{1}{O_{i} A_{i}^{2}-r_{i}^{2}}=\frac{1}{y w-x z}\left(\frac{z}{z-x}-\frac{w}{w-y}+\frac{x}{x-z}-\frac{y}{y-w}\right)=0,
$$

as desired.",160,2
2011g3,"Let $A B C D$ be a convex quadrilateral whose sides $A D$ and $B C$ are not parallel. Suppose that the circles with diameters $A B$ and $C D$ meet at points $E$ and $F$ inside the quadrilateral. Let $\omega_{E}$ be the circle through the feet of the perpendiculars from $E$ to the lines $A B, B C$, and $C D$. Let $\omega_{F}$ be the circle through the feet of the perpendiculars from $F$ to the lines $C D, D A$, and $A B$. Prove that the midpoint of the segment $E F$ lies on the line through the two intersection points of $\omega_{E}$ and $\omega_{F}$.","Solution. Denote by $P, Q, R$, and $S$ the projections of $E$ on the lines $D A, A B, B C$, and $C D$ respectively. The points $P$ and $Q$ lie on the circle with diameter $A E$, so $\angle Q P E=\angle Q A E$; analogously, $\angle Q R E=\angle Q B E$. So $\angle Q P E+\angle Q R E=\angle Q A E+\angle Q B E=90^{\circ}$. By similar reasons, we have $\angle S P E+\angle S R E=90^{\circ}$, hence we get $\angle Q P S+\angle Q R S=90^{\circ}+90^{\circ}=180^{\circ}$, and the quadrilateral $P Q R S$ is inscribed in $\omega_{E}$. Analogously, all four projections of $F$ onto the sides of $A B C D$ lie on $\omega_{F}$.

Denote by $K$ the meeting point of the lines $A D$ and $B C$. Due to the arguments above, there is no loss of generality in assuming that $A$ lies on segment $D K$. Suppose that $\angle C K D \geq 90^{\circ}$; then the circle with diameter $C D$ covers the whole quadrilateral $A B C D$, so the points $E, F$ cannot lie inside this quadrilateral. Hence our assumption is wrong. Therefore, the lines $E P$ and $B C$ intersect at some point $P^{\prime}$, while the lines $E R$ and $A D$ intersect at some point $R^{\prime}$.\\
\includegraphics[max width=\textwidth, center]{2025_05_04_e6233e4fb964804c4c48g-49}

Figure 1\\
We claim that the points $P^{\prime}$ and $R^{\prime}$ also belong to $\omega_{E}$. Since the points $R, E, Q, B$ are concyclic, $\angle Q R K=\angle Q E B=90^{\circ}-\angle Q B E=\angle Q A E=\angle Q P E$. So $\angle Q R K=\angle Q P P^{\prime}$, which means that the point $P^{\prime}$ lies on $\omega_{E}$. Analogously, $R^{\prime}$ also lies on $\omega_{E}$.

In the same manner, denote by $M$ and $N$ the projections of $F$ on the lines $A D$ and $B C$\\
respectively, and let $M^{\prime}=F M \cap B C, N^{\prime}=F N \cap A D$. By the same arguments, we obtain that the points $M^{\prime}$ and $N^{\prime}$ belong to $\omega_{F}$.\\
\includegraphics[max width=\textwidth, center]{2025_05_04_e6233e4fb964804c4c48g-50}

Figure 2\\
Now we concentrate on Figure 2, where all unnecessary details are removed. Let $U=N N^{\prime} \cap$ $P P^{\prime}, V=M M^{\prime} \cap R R^{\prime}$. Due to the right angles at $N$ and $P$, the points $N, N^{\prime}, P, P^{\prime}$ are concyclic, so $U N \cdot U N^{\prime}=U P \cdot U P^{\prime}$ which means that $U$ belongs to the radical axis $g$ of the circles $\omega_{E}$ and $\omega_{F}$. Analogously, $V$ also belongs to $g$.

Finally, since $E U F V$ is a parallelogram, the radical axis $U V$ of $\omega_{E}$ and $\omega_{F}$ bisects $E F$.",428,3
2011g4,"Let $A B C$ be an acute triangle with circumcircle $\Omega$. Let $B_{0}$ be the midpoint of $A C$ and let $C_{0}$ be the midpoint of $A B$. Let $D$ be the foot of the altitude from $A$, and let $G$ be the centroid of the triangle $A B C$. Let $\omega$ be a circle through $B_{0}$ and $C_{0}$ that is tangent to the circle $\Omega$ at a point $X \neq A$. Prove that the points $D, G$, and $X$ are collinear.","If $A B=A C$, then the statement is trivial. So without loss of generality we may assume $A B<A C$. Denote the tangents to $\Omega$ at points $A$ and $X$ by $a$ and $x$, respectively.

Let $\Omega_{1}$ be the circumcircle of triangle $A B_{0} C_{0}$. The circles $\Omega$ and $\Omega_{1}$ are homothetic with center $A$, so they are tangent at $A$, and $a$ is their radical axis. Now, the lines $a, x$, and $B_{0} C_{0}$ are the three radical axes of the circles $\Omega, \Omega_{1}$, and $\omega$. Since $a \nmid B_{0} C_{0}$, these three lines are concurrent at some point $W$.

The points $A$ and $D$ are symmetric with respect to the line $B_{0} C_{0}$; hence $W X=W A=W D$. This means that $W$ is the center of the circumcircle $\gamma$ of triangle $A D X$. Moreover, we have $\angle W A O=\angle W X O=90^{\circ}$, where $O$ denotes the center of $\Omega$. Hence $\angle A W X+\angle A O X=180^{\circ}$.\\
\includegraphics[max width=\textwidth, center]{2025_05_04_e6233e4fb964804c4c48g-51}

Denote by $T$ the second intersection point of $\Omega$ and the line $D X$. Note that $O$ belongs to $\Omega_{1}$. Using the circles $\gamma$ and $\Omega$, we find $\angle D A T=\angle A D X-\angle A T D=\frac{1}{2}\left(360^{\circ}-\angle A W X\right)-\frac{1}{2} \angle A O X=$ $180^{\circ}-\frac{1}{2}(\angle A W X+\angle A O X)=90^{\circ}$. So, $A D \perp A T$, and hence $A T \| B C$. Thus, $A T C B$ is an isosceles trapezoid inscribed in $\Omega$.

Denote by $A_{0}$ the midpoint of $B C$, and consider the image of $A T C B$ under the homothety $h$ with center $G$ and factor $-\frac{1}{2}$. We have $h(A)=A_{0}, h(B)=B_{0}$, and $h(C)=C_{0}$. From the\\
symmetry about $B_{0} C_{0}$, we have $\angle T C B=\angle C B A=\angle B_{0} C_{0} A=\angle D C_{0} B_{0}$. Using $A T \| D A_{0}$, we conclude $h(T)=D$. Hence the points $D, G$, and $T$ are collinear, and $X$ lies on the same line.",320,3
2011g5,"Let $A B C$ be a triangle with incenter $I$ and circumcircle $\omega$. Let $D$ and $E$ be the second intersection points of $\omega$ with the lines $A I$ and $B I$, respectively. The chord $D E$ meets $A C$ at a point $F$, and $B C$ at a point $G$. Let $P$ be the intersection point of the line through $F$ parallel to $A D$ and the line through $G$ parallel to $B E$. Suppose that the tangents to $\omega$ at $A$ and at $B$ meet at a point $K$. Prove that the three lines $A E, B D$, and $K P$ are either parallel or concurrent.","Since

$$
\angle I A F=\angle D A C=\angle B A D=\angle B E D=\angle I E F
$$

the quadrilateral $A I F E$ is cyclic. Denote its circumcircle by $\omega_{1}$. Similarly, the quadrilateral $B D G I$ is cyclic; denote its circumcircle by $\omega_{2}$.

The line $A E$ is the radical axis of $\omega$ and $\omega_{1}$, and the line $B D$ is the radical axis of $\omega$ and $\omega_{2}$. Let $t$ be the radical axis of $\omega_{1}$ and $\omega_{2}$. These three lines meet at the radical center of the three circles, or they are parallel to each other. We will show that $t$ is in fact the line $P K$.

Let $L$ be the second intersection point of $\omega_{1}$ and $\omega_{2}$, so $t=I L$. (If the two circles are tangent to each other then $L=I$ and $t$ is the common tangent.)\\
\includegraphics[max width=\textwidth, center]{2025_05_04_e6233e4fb964804c4c48g-53}

Let the line $t$ meet the circumcircles of the triangles $A B L$ and $F G L$ at $K^{\prime} \neq L$ and $P^{\prime} \neq L$, respectively. Using oriented angles we have

$$
\angle\left(A B, B K^{\prime}\right)=\angle\left(A L, L K^{\prime}\right)=\angle(A L, L I)=\angle(A E, E I)=\angle(A E, E B)=\angle(A B, B K),
$$

so $B K^{\prime} \| B K$. Similarly we have $A K^{\prime} \| A K$, and therefore $K^{\prime}=K$. Next, we have

$$
\angle\left(P^{\prime} F, F G\right)=\angle\left(P^{\prime} L, L G\right)=\angle(I L, L G)=\angle(I D, D G)=\angle(A D, D E)=\angle(P F, F G),
$$

hence $P^{\prime} F \| P F$ and similarly $P^{\prime} G \| P G$. Therefore $P^{\prime}=P$. This means that $t$ passes through $K$ and $P$, which finishes the proof.",267,3
2011g6,"Let $A B C$ be a triangle with $A B=A C$, and let $D$ be the midpoint of $A C$. The angle bisector of $\angle B A C$ intersects the circle through $D, B$, and $C$ in a point $E$ inside the triangle $A B C$. The line $B D$ intersects the circle through $A, E$, and $B$ in two points $B$ and $F$. The lines $A F$ and $B E$ meet at a point $I$, and the lines $C I$ and $B D$ meet at a point $K$. Show that $I$ is the incenter of triangle $K A B$.","Let $D^{\prime}$ be the midpoint of the segment $A B$, and let $M$ be the midpoint of $B C$. By symmetry at line $A M$, the point $D^{\prime}$ has to lie on the circle $B C D$. Since the arcs $D^{\prime} E$ and $E D$ of that circle are equal, we have $\angle A B I=\angle D^{\prime} B E=\angle E B D=I B K$, so $I$ lies on the angle bisector of $\angle A B K$. For this reason it suffices to prove in the sequel that the ray $A I$ bisects the angle $\angle B A K$.

From

$$
\angle D F A=180^{\circ}-\angle B F A=180^{\circ}-\angle B E A=\angle M E B=\frac{1}{2} \angle C E B=\frac{1}{2} \angle C D B
$$

we derive $\angle D F A=\angle D A F$ so the triangle $A F D$ is isosceles with $A D=D F$.\\
\includegraphics[max width=\textwidth, center]{2025_05_04_e6233e4fb964804c4c48g-55}

Applying Menelaus's theorem to the triangle $A D F$ with respect to the line $C I K$, and applying the angle bisector theorem to the triangle $A B F$, we infer

$$
1=\frac{A C}{C D} \cdot \frac{D K}{K F} \cdot \frac{F I}{I A}=2 \cdot \frac{D K}{K F} \cdot \frac{B F}{A B}=2 \cdot \frac{D K}{K F} \cdot \frac{B F}{2 \cdot A D}=\frac{D K}{K F} \cdot \frac{B F}{A D}
$$

and therefore

$$
\frac{B D}{A D}=\frac{B F+F D}{A D}=\frac{B F}{A D}+1=\frac{K F}{D K}+1=\frac{D F}{D K}=\frac{A D}{D K} .
$$

It follows that the triangles $A D K$ and $B D A$ are similar, hence $\angle D A K=\angle A B D$. Then

$$
\angle I A B=\angle A F D-\angle A B D=\angle D A F-\angle D A K=\angle K A I
$$

shows that the point $K$ is indeed lying on the angle bisector of $\angle B A K$.",294,3
2011g7,Let $A B C D E F$ be a convex hexagon all of whose sides are tangent to a circle $\omega$ with center $O$. Suppose that the circumcircle of triangle $A C E$ is concentric with $\omega$. Let $J$ be the foot of the perpendicular from $B$ to $C D$. Suppose that the perpendicular from $B$ to $D F$ intersects the line $E O$ at a point $K$. Let $L$ be the foot of the perpendicular from $K$ to $D E$. Prove that $D J=D L$.,"Since $\omega$ and the circumcircle of triangle $A C E$ are concentric, the tangents from $A$, $C$, and $E$ to $\omega$ have equal lengths; that means that $A B=B C, C D=D E$, and $E F=F A$. Moreover, we have $\angle B C D=\angle D E F=\angle F A B$.\\
\includegraphics[max width=\textwidth, center]{2025_05_04_e6233e4fb964804c4c48g-58}

Consider the rotation around point $D$ mapping $C$ to $E$; let $B^{\prime}$ and $L^{\prime}$ be the images of the points $B$ and $J$, respectively, under this rotation. Then one has $D J=D L^{\prime}$ and $B^{\prime} L^{\prime} \perp D E$; moreover, the triangles $B^{\prime} E D$ and $B C D$ are congruent. Since $\angle D E O<90^{\circ}$, the lines $E O$ and $B^{\prime} L^{\prime}$ intersect at some point $K^{\prime}$. We intend to prove that $K^{\prime} B \perp D F$; this would imply $K=K^{\prime}$, therefore $L=L^{\prime}$, which proves the problem statement.

Analogously, consider the rotation around $F$ mapping $A$ to $E$; let $B^{\prime \prime}$ be the image of $B$ under this rotation. Then the triangles $F A B$ and $F E B^{\prime \prime}$ are congruent. We have $E B^{\prime \prime}=A B=B C=$ $E B^{\prime}$ and $\angle F E B^{\prime \prime}=\angle F A B=\angle B C D=\angle D E B^{\prime}$, so the points $B^{\prime}$ and $B^{\prime \prime}$ are symmetrical with respect to the angle bisector $E O$ of $\angle D E F$. So, from $K^{\prime} B^{\prime} \perp D E$ we get $K^{\prime} B^{\prime \prime} \perp E F$.

From these two relations we obtain

$$
K^{\prime} D^{2}-K^{\prime} E^{2}=B^{\prime} D^{2}-B^{\prime} E^{2} \quad \text { and } \quad K^{\prime} E^{2}-K^{\prime} F^{2}=B^{\prime \prime} E^{2}-B^{\prime \prime} F^{2} .
$$

Adding these equalities and taking into account that $B^{\prime} E=B^{\prime \prime} E$ we obtain

$$
K^{\prime} D^{2}-K^{\prime} F^{2}=B^{\prime} D^{2}-B^{\prime \prime} F^{2}=B D^{2}-B F^{2},
$$

which means exactly that $K^{\prime} B \perp D F$.

Comment. There are several variations of this solution. For instance, let us consider the intersection point $M$ of the lines $B J$ and $O C$. Define the point $K^{\prime}$ as the reflection of $M$ in the line $D O$. Then one has

$$
D K^{\prime 2}-D B^{2}=D M^{2}-D B^{2}=C M^{2}-C B^{2}
$$

Next, consider the rotation around $O$ which maps $C M$ to $E K^{\prime}$. Let $P$ be the image of $B$ under this rotation; so $P$ lies on $E D$. Then $E F \perp K^{\prime} P$, so

$$
C M^{2}-C B^{2}=E K^{\prime 2}-E P^{2}=F K^{\prime 2}-F P^{2}=F K^{\prime 2}-F B^{2}
$$

since the triangles $F E P$ and $F A B$ are congruent.",411,3
2011g8,"Let $A B C$ be an acute triangle with circumcircle $\omega$. Let $t$ be a tangent line to $\omega$. Let $t_{a}, t_{b}$, and $t_{c}$ be the lines obtained by reflecting $t$ in the lines $B C, C A$, and $A B$, respectively. Show that the circumcircle of the triangle determined by the lines $t_{a}, t_{b}$, and $t_{c}$ is tangent to the circle $\omega$.

To avoid a large case distinction, we will use the notion of oriented angles. Namely, for two lines $\ell$ and $m$, we denote by $\angle(\ell, m)$ the angle by which one may rotate $\ell$ anticlockwise to obtain a line parallel to $m$. Thus, all oriented angles are considered modulo $180^{\circ}$.","Denote by $T$ the point of tangency of $t$ and $\omega$. Let $A^{\prime}=t_{b} \cap t_{c}, B^{\prime}=t_{a} \cap t_{c}$, $C^{\prime}=t_{a} \cap t_{b}$. Introduce the point $A^{\prime \prime}$ on $\omega$ such that $T A=A A^{\prime \prime}\left(A^{\prime \prime} \neq T\right.$ unless $T A$ is a diameter). Define the points $B^{\prime \prime}$ and $C^{\prime \prime}$ in a similar way.

Since the points $C$ and $B$ are the midpoints of arcs $T C^{\prime \prime}$ and $T B^{\prime \prime}$, respectively, we have

$$
\begin{aligned}
\angle\left(t, B^{\prime \prime} C^{\prime \prime}\right) & =\angle\left(t, T C^{\prime \prime}\right)+\angle\left(T C^{\prime \prime}, B^{\prime \prime} C^{\prime \prime}\right)=2 \angle(t, T C)+2 \angle\left(T C^{\prime \prime}, B C^{\prime \prime}\right) \\
& =2(\angle(t, T C)+\angle(T C, B C))=2 \angle(t, B C)=\angle\left(t, t_{a}\right) .
\end{aligned}
$$

It follows that $t_{a}$ and $B^{\prime \prime} C^{\prime \prime}$ are parallel. Similarly, $t_{b} \| A^{\prime \prime} C^{\prime \prime}$ and $t_{c} \| A^{\prime \prime} B^{\prime \prime}$. Thus, either the triangles $A^{\prime} B^{\prime} C^{\prime}$ and $A^{\prime \prime} B^{\prime \prime} C^{\prime \prime}$ are homothetic, or they are translates of each other. Now we will prove that they are in fact homothetic, and that the center $K$ of the homothety belongs\\
to $\omega$. It would then follow that their circumcircles are also homothetic with respect to $K$ and are therefore tangent at this point, as desired.

We need the two following claims.\\
Claim 1. The point of intersection $X$ of the lines $B^{\prime \prime} C$ and $B C^{\prime \prime}$ lies on $t_{a}$.\\
Proof. Actually, the points $X$ and $T$ are symmetric about the line $B C$, since the lines $C T$ and $C B^{\prime \prime}$ are symmetric about this line, as are the lines $B T$ and $B C^{\prime \prime}$.

Claim 2. The point of intersection $I$ of the lines $B B^{\prime}$ and $C C^{\prime}$ lies on the circle $\omega$.\\
Proof. We consider the case that $t$ is not parallel to the sides of $A B C$; the other cases may be regarded as limit cases. Let $D=t \cap B C, E=t \cap A C$, and $F=t \cap A B$.

Due to symmetry, the line $D B$ is one of the angle bisectors of the lines $B^{\prime} D$ and $F D$; analogously, the line $F B$ is one of the angle bisectors of the lines $B^{\prime} F$ and $D F$. So $B$ is either the incenter or one of the excenters of the triangle $B^{\prime} D F$. In any case we have $\angle(B D, D F)+\angle(D F, F B)+$ $\angle\left(B^{\prime} B, B^{\prime} D\right)=90^{\circ}$, so

$$
\angle\left(B^{\prime} B, B^{\prime} C^{\prime}\right)=\angle\left(B^{\prime} B, B^{\prime} D\right)=90^{\circ}-\angle(B C, D F)-\angle(D F, B A)=90^{\circ}-\angle(B C, A B) .
$$

Analogously, we get $\angle\left(C^{\prime} C, B^{\prime} C^{\prime}\right)=90^{\circ}-\angle(B C, A C)$. Hence,

$$
\angle(B I, C I)=\angle\left(B^{\prime} B, B^{\prime} C^{\prime}\right)+\angle\left(B^{\prime} C^{\prime}, C^{\prime} C\right)=\angle(B C, A C)-\angle(B C, A B)=\angle(A B, A C),
$$

which means exactly that the points $A, B, I, C$ are concyclic.\\
Now we can complete the proof. Let $K$ be the second intersection point of $B^{\prime} B^{\prime \prime}$ and $\omega$. Applying Pascal's theorem to hexagon $K B^{\prime \prime} C I B C^{\prime \prime}$ we get that the points $B^{\prime}=K B^{\prime \prime} \cap I B$ and $X=B^{\prime \prime} C \cap B C^{\prime \prime}$ are collinear with the intersection point $S$ of $C I$ and $C^{\prime \prime} K$. So $S=$ $C I \cap B^{\prime} X=C^{\prime}$, and the points $C^{\prime}, C^{\prime \prime}, K$ are collinear. Thus $K$ is the intersection point of $B^{\prime} B^{\prime \prime}$ and $C^{\prime} C^{\prime \prime}$ which implies that $K$ is the center of the homothety mapping $A^{\prime} B^{\prime} C^{\prime}$ to $A^{\prime \prime} B^{\prime \prime} C^{\prime \prime}$, and it belongs to $\omega$.",592,4
2011n1,"For any integer $d>0$, let $f(d)$ be the smallest positive integer that has exactly $d$ positive divisors (so for example we have $f(1)=1, f(5)=16$, and $f(6)=12$ ). Prove that for every integer $k \geq 0$ the number $f\left(2^{k}\right)$ divides $f\left(2^{k+1}\right)$.","For any positive integer $n$, let $d(n)$ be the number of positive divisors of $n$. Let $n=\prod_{p} p^{a(p)}$ be the prime factorization of $n$ where $p$ ranges over the prime numbers, the integers $a(p)$ are nonnegative and all but finitely many $a(p)$ are zero. Then we have $d(n)=\prod_{p}(a(p)+1)$. Thus, $d(n)$ is a power of 2 if and only if for every prime $p$ there is a nonnegative integer $b(p)$ with $a(p)=2^{b(p)}-1=1+2+2^{2}+\cdots+2^{b(p)-1}$. We then have

$$
n=\prod_{p} \prod_{i=0}^{b(p)-1} p^{2^{i}}, \quad \text { and } \quad d(n)=2^{k} \quad \text { with } \quad k=\sum_{p} b(p) .
$$

Let $\mathcal{S}$ be the set of all numbers of the form $p^{2^{r}}$ with $p$ prime and $r$ a nonnegative integer. Then we deduce that $d(n)$ is a power of 2 if and only if $n$ is the product of the elements of some finite subset $\mathcal{T}$ of $\mathcal{S}$ that satisfies the following condition: for all $t \in \mathcal{T}$ and $s \in \mathcal{S}$ with $s \mid t$ we have $s \in \mathcal{T}$. Moreover, if $d(n)=2^{k}$ then the corresponding set $\mathcal{T}$ has $k$ elements.

Note that the set $\mathcal{T}_{k}$ consisting of the smallest $k$ elements from $\mathcal{S}$ obviously satisfies the condition above. Thus, given $k$, the smallest $n$ with $d(n)=2^{k}$ is the product of the elements of $\mathcal{T}_{k}$. This $n$ is $f\left(2^{k}\right)$. Since obviously $\mathcal{T}_{k} \subset \mathcal{T}_{k+1}$, it follows that $f\left(2^{k}\right) \mid f\left(2^{k+1}\right)$.",226,2
2011n2,"Consider a polynomial $P(x)=\left(x+d_{1}\right)\left(x+d_{2}\right) \cdot \ldots \cdot\left(x+d_{9}\right)$, where $d_{1}, d_{2}, \ldots, d_{9}$ are nine distinct integers. Prove that there exists an integer $N$ such that for all integers $x \geq N$ the number $P(x)$ is divisible by a prime number greater than 20 .","Note that the statement of the problem is invariant under translations of $x$; hence without loss of generality we may suppose that the numbers $d_{1}, d_{2}, \ldots, d_{9}$ are positive.

The key observation is that there are only eight primes below 20 , while $P(x)$ involves more than eight factors.

We shall prove that $N=d^{8}$ satisfies the desired property, where $d=\max \left\{d_{1}, d_{2}, \ldots, d_{9}\right\}$. Suppose for the sake of contradiction that there is some integer $x \geq N$ such that $P(x)$ is composed of primes below 20 only. Then for every index $i \in\{1,2, \ldots, 9\}$ the number $x+d_{i}$ can be expressed as product of powers of the first 8 primes.

Since $x+d_{i}>x \geq d^{8}$ there is some prime power $f_{i}>d$ that divides $x+d_{i}$. Invoking the pigeonhole principle we see that there are two distinct indices $i$ and $j$ such that $f_{i}$ and $f_{j}$ are powers of the same prime number. For reasons of symmetry, we may suppose that $f_{i} \leq f_{j}$. Now both of the numbers $x+d_{i}$ and $x+d_{j}$ are divisible by $f_{i}$ and hence so is their difference $d_{i}-d_{j}$. But as

$$
0<\left|d_{i}-d_{j}\right| \leq \max \left(d_{i}, d_{j}\right) \leq d<f_{i},
$$

this is impossible. Thereby the problem is solved.",201,2
2011n5,"Let $f$ be a function from the set of integers to the set of positive integers. Suppose that for any two integers $m$ and $n$, the difference $f(m)-f(n)$ is divisible by $f(m-n)$. Prove that for all integers $m$, $n$ with $f(m) \leq f(n)$ the number $f(n)$ is divisible by $f(m)$.","Suppose that $x$ and $y$ are two integers with $f(x)<f(y)$. We will show that $f(x) \mid f(y)$. By taking $m=x$ and $n=y$ we see that

$$
f(x-y)||f(x)-f(y)|=f(y)-f(x)>0,
$$

so $f(x-y) \leq f(y)-f(x)<f(y)$. Hence the number $d=f(x)-f(x-y)$ satisfies

$$
-f(y)<-f(x-y)<d<f(x)<f(y) .
$$

Taking $m=x$ and $n=x-y$ we see that $f(y) \mid d$, so we deduce $d=0$, or in other words $f(x)=f(x-y)$. Taking $m=x$ and $n=y$ we see that $f(x)=f(x-y) \mid f(x)-f(y)$, which implies $f(x) \mid f(y)$.",75,1
2011n6,"Let $P(x)$ and $Q(x)$ be two polynomials with integer coefficients such that no nonconstant polynomial with rational coefficients divides both $P(x)$ and $Q(x)$. Suppose that for every positive integer $n$ the integers $P(n)$ and $Q(n)$ are positive, and $2^{Q(n)}-1$ divides $3^{P(n)}-1$. Prove that $Q(x)$ is a constant polynomial.","Solution. First we show that there exists an integer $d$ such that for all positive integers $n$ we have $\operatorname{gcd}(P(n), Q(n)) \leq d$.

Since $P(x)$ and $Q(x)$ are coprime (over the polynomials with rational coefficients), Euclid's algorithm provides some polynomials $R_{0}(x), S_{0}(x)$ with rational coefficients such that $P(x) R_{0}(x)-$ $Q(x) S_{0}(x)=1$. Multiplying by a suitable positive integer $d$, we obtain polynomials $R(x)=$ $d \cdot R_{0}(x)$ and $S(x)=d \cdot S_{0}(x)$ with integer coefficients for which $P(x) R(x)-Q(x) S(x)=d$. Then we have $\operatorname{gcd}(P(n), Q(n)) \leq d$ for any integer $n$.

To prove the problem statement, suppose that $Q(x)$ is not constant. Then the sequence $Q(n)$ is not bounded and we can choose a positive integer $m$ for which


\begin{equation*}
M=2^{Q(m)}-1 \geq 3^{\max \{P(1), P(2), \ldots, P(d)\}} . \tag{1}
\end{equation*}


Since $M=2^{Q(n)}-1 \mid 3^{P(n)}-1$, we have $2,3 \nmid M$. Let $a$ and $b$ be the multiplicative orders of 2 and 3 modulo $M$, respectively. Obviously, $a=Q(m)$ since the lower powers of 2 do not reach $M$. Since $M$ divides $3^{P(m)}-1$, we have $b \mid P(m)$. Then $\operatorname{gcd}(a, b) \leq \operatorname{gcd}(P(m), Q(m)) \leq d$. Since the expression $a x-b y$ attains all integer values divisible by $\operatorname{gcd}(a, b)$ when $x$ and $y$ run over all nonnegative integer values, there exist some nonnegative integers $x, y$ such that $1 \leq m+a x-b y \leq d$.

By $Q(m+a x) \equiv Q(m)(\bmod a)$ we have

$$
2^{Q(m+a x)} \equiv 2^{Q(m)} \equiv 1 \quad(\bmod M)
$$

and therefore

$$
M\left|2^{Q(m+a x)}-1\right| 3^{P(m+a x)}-1 .
$$

Then, by $P(m+a x-b y) \equiv P(m+a x)(\bmod b)$ we have

$$
3^{P(m+a x-b y)} \equiv 3^{P(m+a x)} \equiv 1 \quad(\bmod M) .
$$

Since $P(m+a x-b y)>0$ this implies $M \leq 3^{P(m+a x-b y)}-1$. But $P(m+a x-b y)$ is listed among $P(1), P(2), \ldots, P(d)$, so

$$
M<3^{P(m+a x-b y)} \leq 3^{\max \{P(1), P(2), \ldots, P(d)\}}
$$

which contradicts (1).

Comment. We present another variant of the solution above.\\
Denote the degree of $P$ by $k$ and its leading coefficient by $p$. Consider any positive integer $n$ and let $a=Q(n)$. Again, denote by $b$ the multiplicative order of 3 modulo $2^{a}-1$. Since $2^{a}-1 \mid 3^{P(n)}-1$, we have $b \mid P(n)$. Moreover, since $2^{Q(n+a t)}-1 \mid 3^{P(n+a t)}-1$ and $a=Q(n) \mid Q(n+a t)$ for each positive integer $t$, we have $2^{a}-1 \mid 3^{P(n+a t)}-1$, hence $b \mid P(n+a t)$ as well.\\
Therefore, $b$ divides $\operatorname{gcd}\{P(n+a t): t \geq 0\}$; hence it also divides the number

$$
\sum_{i=0}^{k}(-1)^{k-i}\binom{k}{i} P(n+a i)=p \cdot k!\cdot a^{k} .
$$

Finally, we get $b \mid \operatorname{gcd}\left(P(n), k!\cdot p \cdot Q(n)^{k}\right)$, which is bounded by the same arguments as in the beginning of the solution. So $3^{b}-1$ is bounded, and hence $2^{Q(n)}-1$ is bounded as well.",446,3
2011n7,"Let $p$ be an odd prime number. For every integer $a$, define the number

$$
S_{a}=\frac{a}{1}+\frac{a^{2}}{2}+\cdots+\frac{a^{p-1}}{p-1} .
$$

Let $m$ and $n$ be integers such that

$$
S_{3}+S_{4}-3 S_{2}=\frac{m}{n} .
$$

Prove that $p$ divides $m$.","For rational numbers $p_{1} / q_{1}$ and $p_{2} / q_{2}$ with the denominators $q_{1}, q_{2}$ not divisible by $p$, we write $p_{1} / q_{1} \equiv p_{2} / q_{2}(\bmod p)$ if the numerator $p_{1} q_{2}-p_{2} q_{1}$ of their difference is divisible by $p$.

We start with finding an explicit formula for the residue of $S_{a}$ modulo $p$. Note first that for every $k=1, \ldots, p-1$ the number $\binom{p}{k}$ is divisible by $p$, and

$$
\frac{1}{p}\binom{p}{k}=\frac{(p-1)(p-2) \cdots(p-k+1)}{k!} \equiv \frac{(-1) \cdot(-2) \cdots(-k+1)}{k!}=\frac{(-1)^{k-1}}{k} \quad(\bmod p)
$$

Therefore, we have

$$
S_{a}=-\sum_{k=1}^{p-1} \frac{(-a)^{k}(-1)^{k-1}}{k} \equiv-\sum_{k=1}^{p-1}(-a)^{k} \cdot \frac{1}{p}\binom{p}{k} \quad(\bmod p) .
$$

The number on the right-hand side is integer. Using the binomial formula we express it as

$$
-\sum_{k=1}^{p-1}(-a)^{k} \cdot \frac{1}{p}\binom{p}{k}=-\frac{1}{p}\left(-1-(-a)^{p}+\sum_{k=0}^{p}(-a)^{k}\binom{p}{k}\right)=\frac{(a-1)^{p}-a^{p}+1}{p}
$$

since $p$ is odd. So, we have

$$
S_{a} \equiv \frac{(a-1)^{p}-a^{p}+1}{p} \quad(\bmod p) .
$$

Finally, using the obtained formula we get

$$
\begin{aligned}
S_{3}+S_{4}-3 S_{2} & \equiv \frac{\left(2^{p}-3^{p}+1\right)+\left(3^{p}-4^{p}+1\right)-3\left(1^{p}-2^{p}+1\right)}{p} \\
& =\frac{4 \cdot 2^{p}-4^{p}-4}{p}=-\frac{\left(2^{p}-2\right)^{2}}{p} \quad(\bmod p) .
\end{aligned}
$$

By Fermat's theorem, $p \mid 2^{p}-2$, so $p^{2} \mid\left(2^{p}-2\right)^{2}$ and hence $S_{3}+S_{4}-3 S_{2} \equiv 0(\bmod p)$.",171,2
2011n8,"Let $k$ be a positive integer and set $n=2^{k}+1$. Prove that $n$ is a prime number if and only if the following holds: there is a permutation $a_{1}, \ldots, a_{n-1}$ of the numbers $1,2, \ldots, n-1$ and a sequence of integers $g_{1}, g_{2}, \ldots, g_{n-1}$ such that $n$ divides $g_{i}^{a_{i}}-a_{i+1}$ for every $i \in\{1,2, \ldots, n-1\}$, where we set $a_{n}=a_{1}$.","Solution. Let $N=\{1,2, \ldots, n-1\}$. For $a, b \in N$, we say that $b$ follows $a$ if there exists an integer $g$ such that $b \equiv g^{a}(\bmod n)$ and denote this property as $a \rightarrow b$. This way we have a directed graph with $N$ as set of vertices. If $a_{1}, \ldots, a_{n-1}$ is a permutation of $1,2, \ldots, n-1$ such that $a_{1} \rightarrow a_{2} \rightarrow \ldots \rightarrow a_{n-1} \rightarrow a_{1}$ then this is a Hamiltonian cycle in the graph.

Step I. First consider the case when $n$ is composite. Let $n=p_{1}^{\alpha_{1}} \ldots p_{s}^{\alpha_{s}}$ be its prime factorization. All primes $p_{i}$ are odd.

Suppose that $\alpha_{i}>1$ for some $i$. For all integers $a, g$ with $a \geq 2$, we have $g^{a} \not \equiv p_{i}\left(\bmod p_{i}^{2}\right)$, because $g^{a}$ is either divisible by $p_{i}^{2}$ or it is not divisible by $p_{i}$. It follows that in any Hamiltonian cycle $p_{i}$ comes immediately after 1 . The same argument shows that $2 p_{i}$ also should come immediately after 1 , which is impossible. Hence, there is no Hamiltonian cycle in the graph.

Now suppose that $n$ is square-free. We have $n=p_{1} p_{2} \ldots p_{s}>9$ and $s \geq 2$. Assume that there exists a Hamiltonian cycle. There are $\frac{n-1}{2}$ even numbers in this cycle, and each number which follows one of them should be a quadratic residue modulo $n$. So, there should be at least $\frac{n-1}{2}$ nonzero quadratic residues modulo $n$. On the other hand, for each $p_{i}$ there exist exactly $\frac{p_{i}+1}{2}$ quadratic residues modulo $p_{i}$; by the Chinese Remainder Theorem, the number of quadratic residues modulo $n$ is exactly $\frac{p_{1}+1}{2} \cdot \frac{p_{2}+1}{2} \cdot \ldots \cdot \frac{p_{s}+1}{2}$, including 0 . Then we have a contradiction by

$$
\frac{p_{1}+1}{2} \cdot \frac{p_{2}+1}{2} \cdot \ldots \cdot \frac{p_{s}+1}{2} \leq \frac{2 p_{1}}{3} \cdot \frac{2 p_{2}}{3} \cdot \ldots \cdot \frac{2 p_{s}}{3}=\left(\frac{2}{3}\right)^{s} n \leq \frac{4 n}{9}<\frac{n-1}{2} .
$$

This proves the ""if""-part of the problem.\\
Step II. Now suppose that $n$ is prime. For any $a \in N$, denote by $\nu_{2}(a)$ the exponent of 2 in the prime factorization of $a$, and let $\mu(a)=\max \left\{t \in[0, k] \mid 2^{t} \rightarrow a\right\}$.

Lemma. For any $a, b \in N$, we have $a \rightarrow b$ if and only if $\nu_{2}(a) \leq \mu(b)$.\\
Proof. Let $\ell=\nu_{2}(a)$ and $m=\mu(b)$.\\
Suppose $\ell \leq m$. Since $b$ follows $2^{m}$, there exists some $g_{0}$ such that $b \equiv g_{0}^{2^{m}}(\bmod n)$. By $\operatorname{gcd}(a, n-1)=2^{\ell}$ there exist some integers $p$ and $q$ such that $p a-q(n-1)=2^{\ell}$. Choosing $g=g_{0}^{2^{m-\ell} p}$ we have $g^{a}=g_{0}^{2^{m-\ell_{p a}}}=g_{0}^{2^{m}+2^{m-\ell} q(n-1)} \equiv g_{0}^{2^{m}} \equiv b(\bmod n)$ by FERMAT's theorem. Hence, $a \rightarrow b$.

To prove the reverse statement, suppose that $a \rightarrow b$, so $b \equiv g^{a}(\bmod n)$ with some $g$. Then $b \equiv\left(g^{a / 2^{\ell}}\right)^{2^{\ell}}$, and therefore $2^{\ell} \rightarrow b$. By the definition of $\mu(b)$, we have $\mu(b) \geq \ell$. The lemma is\\
proved.\\
Now for every $i$ with $0 \leq i \leq k$, let

$$
\begin{aligned}
A_{i} & =\left\{a \in N \mid \nu_{2}(a)=i\right\}, \\
B_{i} & =\{a \in N \mid \mu(a)=i\}, \\
\text { and } C_{i} & =\{a \in N \mid \mu(a) \geq i\}=B_{i} \cup B_{i+1} \cup \ldots \cup B_{k} .
\end{aligned}
$$

We claim that $\left|A_{i}\right|=\left|B_{i}\right|$ for all $0 \leq i \leq k$. Obviously we have $\left|A_{i}\right|=2^{k-i-1}$ for all $i=$ $0, \ldots, k-1$, and $\left|A_{k}\right|=1$. Now we determine $\left|C_{i}\right|$. We have $\left|C_{0}\right|=n-1$ and by Fermat's theorem we also have $C_{k}=\{1\}$, so $\left|C_{k}\right|=1$. Next, notice that $C_{i+1}=\left\{x^{2} \bmod n \mid x \in C_{i}\right\}$. For every $a \in N$, the relation $x^{2} \equiv a(\bmod n)$ has at most two solutions in $N$. Therefore we have $2\left|C_{i+1}\right| \leq\left|C_{i}\right|$, with the equality achieved only if for every $y \in C_{i+1}$, there exist distinct elements $x, x^{\prime} \in C_{i}$ such that $x^{2} \equiv x^{\prime 2} \equiv y(\bmod n)\left(\right.$ this implies $\left.x+x^{\prime}=n\right)$. Now, since $2^{k}\left|C_{k}\right|=\left|C_{0}\right|$, we obtain that this equality should be achieved in each step. Hence $\left|C_{i}\right|=2^{k-i}$ for $0 \leq i \leq k$, and therefore $\left|B_{i}\right|=2^{k-i-1}$ for $0 \leq i \leq k-1$ and $\left|B_{k}\right|=1$.

From the previous arguments we can see that for each $z \in C_{i}(0 \leq i<k)$ the equation $x^{2} \equiv z^{2}$ $(\bmod n)$ has two solutions in $C_{i}$, so we have $n-z \in C_{i}$. Hence, for each $i=0,1, \ldots, k-1$, exactly half of the elements of $C_{i}$ are odd. The same statement is valid for $B_{i}=C_{i} \backslash C_{i+1}$ for $0 \leq i \leq k-2$. In particular, each such $B_{i}$ contains an odd number. Note that $B_{k}=\{1\}$ also contains an odd number, and $B_{k-1}=\left\{2^{k}\right\}$ since $C_{k-1}$ consists of the two square roots of 1 modulo $n$.

Step III. Now we construct a Hamiltonian cycle in the graph. First, for each $i$ with $0 \leq i \leq k$, connect the elements of $A_{i}$ to the elements of $B_{i}$ by means of an arbitrary bijection. After performing this for every $i$, we obtain a subgraph with all vertices having in-degree 1 and outdegree 1 , so the subgraph is a disjoint union of cycles. If there is a unique cycle, we are done. Otherwise, we modify the subgraph in such a way that the previous property is preserved and the number of cycles decreases; after a finite number of steps we arrive at a single cycle.

For every cycle $C$, let $\lambda(C)=\min _{c \in C} \nu_{2}(c)$. Consider a cycle $C$ for which $\lambda(C)$ is maximal. If $\lambda(C)=0$, then for any other cycle $C^{\prime}$ we have $\lambda\left(C^{\prime}\right)=0$. Take two arbitrary vertices $a \in C$ and $a^{\prime} \in C^{\prime}$ such that $\nu_{2}(a)=\nu_{2}\left(a^{\prime}\right)=0$; let their direct successors be $b$ and $b^{\prime}$, respectively. Then we can unify $C$ and $C^{\prime}$ to a single cycle by replacing the edges $a \rightarrow b$ and $a^{\prime} \rightarrow b^{\prime}$ by $a \rightarrow b^{\prime}$ and $a^{\prime} \rightarrow b$.

Now suppose that $\lambda=\lambda(C) \geq 1$; let $a \in C \cap A_{\lambda}$. If there exists some $a^{\prime} \in A_{\lambda} \backslash C$, then $a^{\prime}$ lies in another cycle $C^{\prime}$ and we can merge the two cycles in exactly the same way as above. So, the only remaining case is $A_{\lambda} \subset C$. Since the edges from $A_{\lambda}$ lead to $B_{\lambda}$, we get also $B_{\lambda} \subset C$. If $\lambda \neq k-1$ then $B_{\lambda}$ contains an odd number; this contradicts the assumption $\lambda(C)>0$. Finally, if $\lambda=k-1$, then $C$ contains $2^{k-1}$ which is the only element of $A_{k-1}$. Since $B_{k-1}=\left\{2^{k}\right\}=A_{k}$ and $B_{k}=\{1\}$, the cycle $C$ contains the path $2^{k-1} \rightarrow 2^{k} \rightarrow 1$ and it contains an odd number again. This completes the proof of the ""only if""-part of the problem.

Comment 1. The lemma and the fact $\left|A_{i}\right|=\left|B_{i}\right|$ together show that for every edge $a \rightarrow b$ of the Hamiltonian cycle, $\nu_{2}(a)=\mu(b)$ must hold. After this observation, the Hamiltonian cycle can be built in many ways. For instance, it is possible to select edges from $A_{i}$ to $B_{i}$ for $i=k, k-1, \ldots, 1$ in such a way that they form disjoint paths; at the end all these paths will have odd endpoints. In the final step, the paths can be closed to form a unique cycle.

Comment 2. Step II is an easy consequence of some basic facts about the multiplicative group modulo the prime $n=2^{k}+1$. The Lemma follows by noting that this group has order $2^{k}$, so the $a$-th powers are exactly the $2^{\nu_{2}(a)}$-th powers. Using the existence of a primitive root $g$ modulo $n$ one sees that the map from $\{1,2, \ldots, n-1\}$ to itself that sends $a$ to $g^{a} \bmod n$ is a bijection that sends $A_{i}$ to $B_{i}$ for each $i \in\{0, \ldots, k\}$.",1235,4
2010a2,"Let the real numbers $a, b, c, d$ satisfy the relations $a+b+c+d=6$ and $a^{2}+b^{2}+c^{2}+d^{2}=12$. Prove that

$$
36 \leq 4\left(a^{3}+b^{3}+c^{3}+d^{3}\right)-\left(a^{4}+b^{4}+c^{4}+d^{4}\right) \leq 48 .
$$","Observe that

$$
\begin{gathered}
4\left(a^{3}+b^{3}+c^{3}+d^{3}\right)-\left(a^{4}+b^{4}+c^{4}+d^{4}\right)=-\left((a-1)^{4}+(b-1)^{4}+(c-1)^{4}+(d-1)^{4}\right) \\
+6\left(a^{2}+b^{2}+c^{2}+d^{2}\right)-4(a+b+c+d)+4 \\
=-\left((a-1)^{4}+(b-1)^{4}+(c-1)^{4}+(d-1)^{4}\right)+52 .
\end{gathered}
$$

Now, introducing $x=a-1, y=b-1, z=c-1, t=d-1$, we need to prove the inequalities

$$
16 \geq x^{4}+y^{4}+z^{4}+t^{4} \geq 4,
$$

under the constraint

\begin{equation*}
x^{2}+y^{2}+z^{2}+t^{2}=\left(a^{2}+b^{2}+c^{2}+d^{2}\right)-2(a+b+c+d)+4=4 \tag{1}
\end{equation*}

(we will not use the value of $x+y+z+t$ though it can be found).\\
Now the rightmost inequality in (1) follows from the power mean inequality:

$$
x^{4}+y^{4}+z^{4}+t^{4} \geq \frac{\left(x^{2}+y^{2}+z^{2}+t^{2}\right)^{2}}{4}=4 .
$$

For the other one, expanding the brackets we note that

$$
\left(x^{2}+y^{2}+z^{2}+t^{2}\right)^{2}=\left(x^{4}+y^{4}+z^{4}+t^{4}\right)+q,
$$

where $q$ is a nonnegative number, so

$$
x^{4}+y^{4}+z^{4}+t^{4} \leq\left(x^{2}+y^{2}+z^{2}+t^{2}\right)^{2}=16,
$$

and we are done.\\",97,1
2010a4,"A sequence $x_{1}, x_{2}, \ldots$ is defined by $x_{1}=1$ and $x_{2 k}=-x_{k}, x_{2 k-1}=(-1)^{k+1} x_{k}$ for all $k \geq 1$. Prove that $x_{1}+x_{2}+\cdots+x_{n} \geq 0$ for all $n \geq 1$.","We start with some observations. First, from the definition of $x_{i}$ it follows that for each positive integer $k$ we have

\begin{equation*}
x_{4 k-3}=x_{2 k-1}=-x_{4 k-2} \quad \text { and } \quad x_{4 k-1}=x_{4 k}=-x_{2 k}=x_{k} . \tag{1}
\end{equation*}

Hence, denoting $S_{n}=\sum_{i=1}^{n} x_{i}$, we have

\begin{gather*}
S_{4 k}=\sum_{i=1}^{k}\left(\left(x_{4 k-3}+x_{4 k-2}\right)+\left(x_{4 k-1}+x_{4 k}\right)\right)=\sum_{i=1}^{k}\left(0+2 x_{k}\right)=2 S_{k}  \tag{2}\\
S_{4 k+2}=S_{4 k}+\left(x_{4 k+1}+x_{4 k+2}\right)=S_{4 k} \tag{3}
\end{gather*}

Observe also that $S_{n}=\sum_{i=1}^{n} x_{i} \equiv \sum_{i=1}^{n} 1=n(\bmod 2)$.\\
Now we prove by induction on $k$ that $S_{i} \geq 0$ for all $i \leq 4 k$. The base case is valid since $x_{1}=x_{3}=x_{4}=1, x_{2}=-1$. For the induction step, assume that $S_{i} \geq 0$ for all $i \leq 4 k$. Using the relations (1)-(3), we obtain

$$
S_{4 k+4}=2 S_{k+1} \geq 0, \quad S_{4 k+2}=S_{4 k} \geq 0, \quad S_{4 k+3}=S_{4 k+2}+x_{4 k+3}=\frac{S_{4 k+2}+S_{4 k+4}}{2} \geq 0
$$

So, we are left to prove that $S_{4 k+1} \geq 0$. If $k$ is odd, then $S_{4 k}=2 S_{k} \geq 0$; since $k$ is odd, $S_{k}$ is odd as well, so we have $S_{4 k} \geq 2$ and hence $S_{4 k+1}=S_{4 k}+x_{4 k+1} \geq 1$.

Conversely, if $k$ is even, then we have $x_{4 k+1}=x_{2 k+1}=x_{k+1}$, hence $S_{4 k+1}=S_{4 k}+x_{4 k+1}=$ $2 S_{k}+x_{k+1}=S_{k}+S_{k+1} \geq 0$. The step is proved.",209,2
2010a6,Suppose that $f$ and $g$ are two functions defined on the set of positive integers and taking positive integer values. Suppose also that the equations $f(g(n))=f(n)+1$ and $g(f(n))=$ $g(n)+1$ hold for all positive integers. Prove that $f(n)=g(n)$ for all positive integer $n$.,"Throughout the solution, by $\mathbb{N}$ we denote the set of all positive integers. For any function $h: \mathbb{N} \rightarrow \mathbb{N}$ and for any positive integer $k$, define $h^{k}(x)=\underbrace{h(h(\ldots h}_{k}(x) \ldots)$ ) (in particular, $\left.h^{0}(x)=x\right)$.

Observe that $f\left(g^{k}(x)\right)=f\left(g^{k-1}(x)\right)+1=\cdots=f(x)+k$ for any positive integer $k$, and similarly $g\left(f^{k}(x)\right)=g(x)+k$. Now let $a$ and $b$ are the minimal values attained by $f$ and $g$, respectively; say $f\left(n_{f}\right)=a, g\left(n_{g}\right)=b$. Then we have $f\left(g^{k}\left(n_{f}\right)\right)=a+k, g\left(f^{k}\left(n_{g}\right)\right)=b+k$, so the function $f$ attains all values from the set $N_{f}=\{a, a+1, \ldots\}$, while $g$ attains all the values from the set $N_{g}=\{b, b+1, \ldots\}$.

Next, note that $f(x)=f(y)$ implies $g(x)=g(f(x))-1=g(f(y))-1=g(y)$; surely, the converse implication also holds. Now, we say that $x$ and $y$ are similar (and write $x \sim y$ ) if $f(x)=f(y)$ (equivalently, $g(x)=g(y)$ ). For every $x \in \mathbb{N}$, we define $[x]=\{y \in \mathbb{N}: x \sim y\}$; surely, $y_{1} \sim y_{2}$ for all $y_{1}, y_{2} \in[x]$, so $[x]=[y]$ whenever $y \in[x]$.

Now we investigate the structure of the sets $[x]$.\\
Claim 1. Suppose that $f(x) \sim f(y)$; then $x \sim y$, that is, $f(x)=f(y)$. Consequently, each class $[x]$ contains at most one element from $N_{f}$, as well as at most one element from $N_{g}$.\\
Proof. If $f(x) \sim f(y)$, then we have $g(x)=g(f(x))-1=g(f(y))-1=g(y)$, so $x \sim y$. The second statement follows now from the sets of values of $f$ and $g$.

Next, we clarify which classes do not contain large elements.\\
Claim 2. For any $x \in \mathbb{N}$, we have $[x] \subseteq\{1,2, \ldots, b-1\}$ if and only if $f(x)=a$. Analogously, $[x] \subseteq\{1,2, \ldots, a-1\}$ if and only if $g(x)=b$.\\
Proof. We will prove that $[x] \nsubseteq\{1,2, \ldots, b-1\} \Longleftrightarrow f(x)>a$; the proof of the second statement is similar.

Note that $f(x)>a$ implies that there exists some $y$ satisfying $f(y)=f(x)-1$, so $f(g(y))=$ $f(y)+1=f(x)$, and hence $x \sim g(y) \geq b$. Conversely, if $b \leq c \sim x$ then $c=g(y)$ for some $y \in \mathbb{N}$, which in turn follows $f(x)=f(g(y))=f(y)+1 \geq a+1$, and hence $f(x)>a$.

Claim 2 implies that there exists exactly one class contained in $\{1, \ldots, a-1\}$ (that is, the class [ $n_{g}$ ]), as well as exactly one class contained in $\{1, \ldots, b-1\}$ (the class [ $n_{f}$ ]). Assume for a moment that $a \leq b$; then $\left[n_{g}\right]$ is contained in $\{1, \ldots, b-1\}$ as well, hence it coincides with $\left[n_{g}\right]$. So, we get that


\begin{equation*}
f(x)=a \Longleftrightarrow g(x)=b \Longleftrightarrow x \sim n_{f} \sim n_{g} . \tag{1}
\end{equation*}


Claim 3. $a=b$.\\
Proof. By Claim 2, we have $[a] \neq\left[n_{f}\right]$, so $[a]$ should contain some element $a^{\prime} \geq b$ by Claim 2 again. If $a \neq a^{\prime}$, then $[a]$ contains two elements $\geq a$ which is impossible by Claim 1. Therefore, $a=a^{\prime} \geq b$. Similarly, $b \geq a$.

Now we are ready to prove the problem statement. First, we establish the following\\
Claim 4. For every integer $d \geq 0, f^{d+1}\left(n_{f}\right)=g^{d+1}\left(n_{f}\right)=a+d$.\\
Proof. Induction on $d$. For $d=0$, the statement follows from (1) and Claim 3. Next, for $d>1$ from the induction hypothesis we have $f^{d+1}\left(n_{f}\right)=f\left(f^{d}\left(n_{f}\right)\right)=f\left(g^{d}\left(n_{f}\right)\right)=f\left(n_{f}\right)+d=a+d$. The equality $g^{d+1}\left(n_{f}\right)=a+d$ is analogous.

Finally, for each $x \in \mathbb{N}$, we have $f(x)=a+d$ for some $d \geq 0$, so $f(x)=f\left(g^{d}\left(n_{f}\right)\right)$ and hence $x \sim g^{d}\left(n_{f}\right)$. It follows that $g(x)=g\left(g^{d}\left(n_{f}\right)\right)=g^{d+1}\left(n_{f}\right)=a+d=f(x)$ by Claim 4.",530,4
2010a7,"Let $a_{1}, \ldots, a_{r}$ be positive real numbers. For $n>r$, we inductively define


\begin{equation*}
a_{n}=\max _{1 \leq k \leq n-1}\left(a_{k}+a_{n-k}\right) \tag{1}
\end{equation*}","Prove that there exist positive integers $\ell \leq r$ and $N$ such that $a_{n}=a_{n-\ell}+a_{\ell}$ for all $n \geq N$.

First, from the problem conditions we have that each $a_{n}(n>r)$ can be expressed as $a_{n}=a_{j_{1}}+a_{j_{2}}$ with $j_{1}, j_{2}<n, j_{1}+j_{2}=n$. If, say, $j_{1}>r$ then we can proceed in the same way with $a_{j_{1}}$, and so on. Finally, we represent $a_{n}$ in a form


\begin{gather*}
a_{n}=a_{i_{1}}+\cdots+a_{i_{k}}  \tag{2}\\
1 \leq i_{j} \leq r, \quad i_{1}+\cdots+i_{k}=n \tag{3}
\end{gather*}


Moreover, if $a_{i_{1}}$ and $a_{i_{2}}$ are the numbers in (2) obtained on the last step, then $i_{1}+i_{2}>r$. Hence we can adjust (3) as


\begin{equation*}
1 \leq i_{j} \leq r, \quad i_{1}+\cdots+i_{k}=n, \quad i_{1}+i_{2}>r \tag{4}
\end{equation*}


On the other hand, suppose that the indices $i_{1}, \ldots, i_{k}$ satisfy the conditions (4). Then, denoting $s_{j}=i_{1}+\cdots+i_{j}$, from (1) we have

$$
a_{n}=a_{s_{k}} \geq a_{s_{k-1}}+a_{i_{k}} \geq a_{s_{k-2}}+a_{i_{k-1}}+a_{i_{k}} \geq \cdots \geq a_{i_{1}}+\cdots+a_{i_{k}}
$$

Summarizing these observations we get the following\\
Claim. For every $n>r$, we have

$$
a_{n}=\max \left\{a_{i_{1}}+\cdots+a_{i_{k}}: \text { the collection }\left(i_{1}, \ldots, i_{k}\right) \text { satisfies }(4)\right\}
$$

Now we denote

$$
s=\max _{1 \leq i \leq r} \frac{a_{i}}{i}
$$

and fix some index $\ell \leq r$ such that $s=\frac{a_{\ell}}{\ell}$.\\
Consider some $n \geq r^{2} \ell+2 r$ and choose an expansion of $a_{n}$ in the form (2), (4). Then we have $n=i_{1}+\cdots+i_{k} \leq r k$, so $k \geq n / r \geq r \ell+2$. Suppose that none of the numbers $i_{3}, \ldots, i_{k}$ equals $\ell$. Then by the pigeonhole principle there is an index $1 \leq j \leq r$ which appears among $i_{3}, \ldots, i_{k}$ at least $\ell$ times, and surely $j \neq \ell$. Let us delete these $\ell$ occurrences of $j$ from $\left(i_{1}, \ldots, i_{k}\right)$, and add $j$ occurrences of $\ell$ instead, obtaining a sequence $\left(i_{1}, i_{2}, i_{3}^{\prime}, \ldots, i_{k^{\prime}}^{\prime}\right)$ also satisfying (4). By Claim, we have

$$
a_{i_{1}}+\cdots+a_{i_{k}}=a_{n} \geq a_{i_{1}}+a_{i_{2}}+a_{i_{3}^{\prime}}+\cdots+a_{i_{k^{\prime}}^{\prime}}
$$

or, after removing the coinciding terms, $\ell a_{j} \geq j a_{\ell}$, so $\frac{a_{\ell}}{\ell} \leq \frac{a_{j}}{j}$. By the definition of $\ell$, this means that $\ell a_{j}=j a_{\ell}$, hence

$$
a_{n}=a_{i_{1}}+a_{i_{2}}+a_{i_{3}^{\prime}}+\cdots+a_{i_{k^{\prime}}^{\prime}} .
$$

Thus, for every $n \geq r^{2} \ell+2 r$ we have found a representation of the form (2), (4) with $i_{j}=\ell$ for some $j \geq 3$. Rearranging the indices we may assume that $i_{k}=\ell$.

Finally, observe that in this representation, the indices $\left(i_{1}, \ldots, i_{k-1}\right)$ satisfy the conditions (4) with $n$ replaced by $n-\ell$. Thus, from the Claim we get

$$
a_{n-\ell}+a_{\ell} \geq\left(a_{i_{1}}+\cdots+a_{i_{k-1}}\right)+a_{\ell}=a_{n}
$$

which by (1) implies

$$
a_{n}=a_{n-\ell}+a_{\ell} \quad \text { for each } n \geq r^{2} \ell+2 r
$$

as desired.",418,3
2010a8,"Given six positive numbers $a, b, c, d, e, f$ such that $a<b<c<d<e<f$. Let $a+c+e=S$ and $b+d+f=T$. Prove that


\begin{equation*}
2 S T>\sqrt{3(S+T)(S(b d+b f+d f)+T(a c+a e+c e))} \tag{1}
\end{equation*}","We define also $\sigma=a c+c e+a e, \tau=b d+b f+d f$. The idea of the solution is to interpret (1) as a natural inequality on the roots of an appropriate polynomial.

Actually, consider the polynomial


\begin{align*}
& P(x)=(b+d+f)(x-a)(x-c)(x-e)+(a+c+e)(x-b)(x-d)(x-f) \\
&=T\left(x^{3}-S x^{2}+\sigma x-a c e\right)+S\left(x^{3}-T x^{2}+\tau x-b d f\right) . \tag{2}
\end{align*}


Surely, $P$ is cubic with leading coefficient $S+T>0$. Moreover, we have

$$
\begin{array}{ll}
P(a)=S(a-b)(a-d)(a-f)<0, & P(c)=S(c-b)(c-d)(c-f)>0, \\
P(e)=S(e-b)(e-d)(e-f)<0, & P(f)=T(f-a)(f-c)(f-e)>0 .
\end{array}
$$

Hence, each of the intervals $(a, c),(c, e),(e, f)$ contains at least one root of $P(x)$. Since there are at most three roots at all, we obtain that there is exactly one root in each interval (denote them by $\alpha \in(a, c), \beta \in(c, e), \gamma \in(e, f))$. Moreover, the polynomial $P$ can be factorized as


\begin{equation*}
P(x)=(T+S)(x-\alpha)(x-\beta)(x-\gamma) \tag{3}
\end{equation*}


Equating the coefficients in the two representations (2) and (3) of $P(x)$ provides

$$
\alpha+\beta+\gamma=\frac{2 T S}{T+S}, \quad \alpha \beta+\alpha \gamma+\beta \gamma=\frac{S \tau+T \sigma}{T+S} .
$$

Now, since the numbers $\alpha, \beta, \gamma$ are distinct, we have

$$
0<(\alpha-\beta)^{2}+(\alpha-\gamma)^{2}+(\beta-\gamma)^{2}=2(\alpha+\beta+\gamma)^{2}-6(\alpha \beta+\alpha \gamma+\beta \gamma)
$$

which implies

$$
\frac{4 S^{2} T^{2}}{(T+S)^{2}}=(\alpha+\beta+\gamma)^{2}>3(\alpha \beta+\alpha \gamma+\beta \gamma)=\frac{3(S \tau+T \sigma)}{T+S}
$$

or

$$
4 S^{2} T^{2}>3(T+S)(T \sigma+S \tau)
$$

which is exactly what we need.\\
",203,2
2010c5,"$n \geq 4$ players participated in a tennis tournament. Any two players have played exactly one game, and there was no tie game. We call a company of four players bad if one player was defeated by the other three players, and each of these three players won a game and lost another game among themselves. Suppose that there is no bad company in this tournament. Let $w_{i}$ and $\ell_{i}$ be respectively the number of wins and losses of the $i$ th player. Prove that


\begin{equation*}
\sum_{i=1}^{n}\left(w_{i}-\ell_{i}\right)^{3} \geq 0 . \tag{1}
\end{equation*}","For any tournament $T$ satisfying the problem condition, denote by $S(T)$ sum under consideration, namely

$$
S(T)=\sum_{i=1}^{n}\left(w_{i}-\ell_{i}\right)^{3} .
$$

First, we show that the statement holds if a tournament $T$ has only 4 players. Actually, let $A=\left(a_{1}, a_{2}, a_{3}, a_{4}\right)$ be the number of wins of the players; we may assume that $a_{1} \geq a_{2} \geq a_{3} \geq a_{4}$. We have $a_{1}+a_{2}+a_{3}+a_{4}=\binom{4}{2}=6$, hence $a_{4} \leq 1$. If $a_{4}=0$, then we cannot have $a_{1}=a_{2}=a_{3}=2$, otherwise the company of all players is bad. Hence we should have $A=(3,2,1,0)$, and $S(T)=3^{3}+1^{3}+(-1)^{3}+(-3)^{3}=0$. On the other hand, if $a_{4}=1$, then only two possibilities, $A=(3,1,1,1)$ and $A=(2,2,1,1)$ can take place. In the former case we have $S(T)=3^{3}+3 \cdot(-2)^{3}>0$, while in the latter one $S(T)=1^{3}+1^{3}+(-1)^{3}+(-1)^{3}=0$, as desired.

Now we turn to the general problem. Consider a tournament $T$ with no bad companies and enumerate the players by the numbers from 1 to $n$. For every 4 players $i_{1}, i_{2}, i_{3}, i_{4}$ consider a ""sub-tournament"" $T_{i_{1} i_{2} i_{3} i_{4}}$ consisting of only these players and the games which they performed with each other. By the abovementioned, we have $S\left(T_{i_{1} i_{2} i_{3} i_{4}}\right) \geq 0$. Our aim is to prove that


\begin{equation*}
S(T)=\sum_{i_{1}, i_{2}, i_{3}, i_{4}} S\left(T_{i_{1} i_{2} i_{3} i_{4}}\right), \tag{2}
\end{equation*}


where the sum is taken over all 4 -tuples of distinct numbers from the set $\{1, \ldots, n\}$. This way the problem statement will be established.

We interpret the number $\left(w_{i}-\ell_{i}\right)^{3}$ as following. For $i \neq j$, let $\varepsilon_{i j}=1$ if the $i$ th player wins against the $j$ th one, and $\varepsilon_{i j}=-1$ otherwise. Then

$$
\left(w_{i}-\ell_{i}\right)^{3}=\left(\sum_{j \neq i} \varepsilon_{i j}\right)^{3}=\sum_{j_{1}, j_{2}, j_{3} \neq i} \varepsilon_{i j_{1}} \varepsilon_{i j_{2}} \varepsilon_{i j_{3}} .
$$

Hence,

$$
S(T)=\sum_{i \notin\left\{j_{1}, j_{2}, j_{3}\right\}} \varepsilon_{i j_{1}} \varepsilon_{i j_{2}} \varepsilon_{i j_{3}} .
$$

To simplify this expression, consider all the terms in this sum where two indices are equal. If, for instance, $j_{1}=j_{2}$, then the term contains $\varepsilon_{i j_{1}}^{2}=1$, so we can replace this term by $\varepsilon_{i j_{3}}$. Make such replacements for each such term; obviously, after this change each term of the form $\varepsilon_{i j_{3}}$ will appear $P(T)$ times, hence

$$
S(T)=\sum_{\left|\left\{i, j_{1}, j_{2}, j_{3}\right\}\right|=4} \varepsilon_{i j_{1}} \varepsilon_{i j_{2}} \varepsilon_{i j_{3}}+P(T) \sum_{i \neq j} \varepsilon_{i j}=S_{1}(T)+P(T) S_{2}(T) .
$$

We show that $S_{2}(T)=0$ and hence $S(T)=S_{1}(T)$ for each tournament. Actually, note that $\varepsilon_{i j}=-\varepsilon_{j i}$, and the whole sum can be split into such pairs. Since the sum in each pair is 0 , so is $S_{2}(T)$.

Thus the desired equality (2) rewrites as


\begin{equation*}
S_{1}(T)=\sum_{i_{1}, i_{2}, i_{3}, i_{4}} S_{1}\left(T_{i_{1} i_{2} i_{3} i_{4}}\right) \tag{3}
\end{equation*}


Now, if all the numbers $j_{1}, j_{2}, j_{3}$ are distinct, then the set $\left\{i, j_{1}, j_{2}, j_{3}\right\}$ is contained in exactly one 4 -tuple, hence the term $\varepsilon_{i j_{1} 1} \varepsilon_{i j_{2}} \varepsilon_{i j_{3}}$ appears in the right-hand part of (3) exactly once, as well as in the left-hand part. Clearly, there are no other terms in both parts, so the equality is established.",488,3
2010c6,"Given a positive integer $k$ and other two integers $b>w>1$. There are two strings of pearls, a string of $b$ black pearls and a string of $w$ white pearls. The length of a string is the number of pearls on it.

One cuts these strings in some steps by the following rules. In each step:\\
(i) The strings are ordered by their lengths in a non-increasing order. If there are some strings of equal lengths, then the white ones precede the black ones. Then $k$ first ones (if they consist of more than one pearl) are chosen; if there are less than $k$ strings longer than 1 , then one chooses all of them.\\
(ii) Next, one cuts each chosen string into two parts differing in length by at most one.\\
(For instance, if there are strings of $5,4,4,2$ black pearls, strings of $8,4,3$ white pearls and $k=4$, then the strings of 8 white, 5 black, 4 white and 4 black pearls are cut into the parts $(4,4),(3,2),(2,2)$ and $(2,2)$, respectively.)

The process stops immediately after the step when a first isolated white pearl appears. Prove that at this stage, there will still exist a string of at least two black pearls.","Denote the situation after the $i$ th step by $A_{i}$; hence $A_{0}$ is the initial situation, and $A_{i-1} \rightarrow A_{i}$ is the $i$ th step. We call a string containing $m$ pearls an $m$-string; it is an $m$-w-string or a $m$ - $b$-string if it is white or black, respectively.

We continue the process until every string consists of a single pearl. We will focus on three moments of the process: (a) the first stage $A_{s}$ when the first 1-string (no matter black or white) appears; (b) the first stage $A_{t}$ where the total number of strings is greater than $k$ (if such moment does not appear then we put $t=\infty$ ); and (c) the first stage $A_{f}$ when all black pearls are isolated. It is sufficient to prove that in $A_{f-1}$ (or earlier), a 1-w-string appears.

We start with some easy properties of the situations under consideration. Obviously, we have $s \leq f$. Moreover, all b-strings from $A_{f-1}$ become single pearls in the $f$ th step, hence all of them are 1 - or 2 -b-strings.

Next, observe that in each step $A_{i} \rightarrow A_{i+1}$ with $i \leq t-1$, all $(>1)$-strings were cut since there are not more than $k$ strings at all; if, in addition, $i<s$, then there were no 1-string, so all the strings were cut in this step.

Now, let $B_{i}$ and $b_{i}$ be the lengths of the longest and the shortest b-strings in $A_{i}$, and let $W_{i}$ and $w_{i}$ be the same for w -strings. We show by induction on $i \leq \min \{s, t\}$ that (i) the situation $A_{i}$ contains exactly $2^{i}$ black and $2^{i}$ white strings, (ii) $B_{i} \geq W_{i}$, and (iii) $b_{i} \geq w_{i}$. The base case $i=0$ is obvious. For the induction step, if $i \leq \min \{s, t\}$ then in the $i$ th step, each string is cut, thus the claim (i) follows from the induction hypothesis; next, we have $B_{i}=\left\lceil B_{i-1} / 2\right\rceil \geq\left\lceil W_{i-1} / 2\right\rceil=W_{i}$ and $b_{i}=\left\lfloor b_{i-1} / 2\right\rfloor \geq\left\lfloor w_{i-1} / 2\right\rfloor=w_{i}$, thus establishing (ii) and (iii).

For the numbers $s, t, f$, two cases are possible.\\
Case 1. Suppose that $s \leq t$ or $f \leq t+1$ (and hence $s \leq t+1$ ); in particular, this is true when $t=\infty$. Then in $A_{s-1}$ we have $B_{s-1} \geq W_{s-1}, b_{s-1} \geq w_{s-1}>1$ as $s-1 \leq \min \{s, t\}$. Now, if $s=f$, then in $A_{s-1}$, there is no 1 -w-string as well as no ( $>2$ )-b-string. That is, $2=B_{s-1} \geq W_{s-1} \geq b_{s-1} \geq w_{s-1}>1$, hence all these numbers equal 2 . This means that in $A_{s-1}$, all strings contain 2 pearls, and there are $2^{s-1}$ black and $2^{s-1}$ white strings, which means $b=2 \cdot 2^{s-1}=w$. This contradicts the problem conditions.

Hence we have $s \leq f-1$ and thus $s \leq t$. Therefore, in the $s$ th step each string is cut into two parts. Now, if a 1-b-string appears in this step, then from $w_{s-1} \leq b_{s-1}$ we see that a

1-w-string appears as well; so, in each case in the $s$ th step a 1 -w-string appears, while not all black pearls become single, as desired.

Case 2. Now assume that $t+1 \leq s$ and $t+2 \leq f$. Then in $A_{t}$ we have exactly $2^{t}$ white and $2^{t}$ black strings, all being larger than 1 , and $2^{t+1}>k \geq 2^{t}$ (the latter holds since $2^{t}$ is the total number of strings in $A_{t-1}$ ). Now, in the $(t+1)$ st step, exactly $k$ strings are cut, not more than $2^{t}$ of them being black; so the number of w-strings in $A_{t+1}$ is at least $2^{t}+\left(k-2^{t}\right)=k$. Since the number of w-strings does not decrease in our process, in $A_{f-1}$ we have at least $k$ white strings as well.

Finally, in $A_{f-1}$, all b-strings are not larger than 2, and at least one 2-b-string is cut in the $f$ th step. Therefore, at most $k-1$ white strings are cut in this step, hence there exists a w-string $\mathcal{W}$ which is not cut in the $f$ th step. On the other hand, since a 2 -b-string is cut, all $(\geq 2)$-w-strings should also be cut in the $f$ th step; hence $\mathcal{W}$ should be a single pearl. This is exactly what we needed.\\",706,4
2010c7,"Let $P_{1}, \ldots, P_{s}$ be arithmetic progressions of integers, the following conditions being satisfied:\\
(i) each integer belongs to at least one of them;\\
(ii) each progression contains a number which does not belong to other progressions.

Denote by $n$ the least common multiple of steps of these progressions; let $n=p_{1}^{\alpha_{1}} \ldots p_{k}^{\alpha_{k}}$ be its prime factorization. Prove that

$$
s \geq 1+\sum_{i=1}^{k} \alpha_{i}\left(p_{i}-1\right) .
$$","First, we prove the key lemma, and then we show how to apply it to finish the solution.

Let $n_{1}, \ldots, n_{k}$ be positive integers. By an $n_{1} \times n_{2} \times \cdots \times n_{k}$ grid we mean the set $N=$ $\left\{\left(a_{1}, \ldots, a_{k}\right): a_{i} \in \mathbb{Z}, 0 \leq a_{i} \leq n_{i}-1\right\}$; the elements of $N$ will be referred to as points. In this grid, we define a subgrid as a subset of the form


\begin{equation*}
L=\left\{\left(b_{1}, \ldots, b_{k}\right) \in N: b_{i_{1}}=x_{i_{1}}, \ldots, b_{i_{t}}=x_{i_{t}}\right\}, \tag{1}
\end{equation*}


where $I=\left\{i_{1}, \ldots, i_{t}\right\}$ is an arbitrary nonempty set of indices, and $x_{i_{j}} \in\left[0, n_{i_{j}}-1\right](1 \leq j \leq t)$ are fixed integer numbers. Further, we say that a subgrid (1) is orthogonal to the $i$ th coordinate axis if $i \in I$, and that it is parallel to the $i$ th coordinate axis otherwise.\\
Lemma. Assume that the grid $N$ is covered by subgrids $L_{1}, L_{2}, \ldots, L_{s}$ (this means $N=\bigcup_{i=1}^{s} L_{i}$ ) so that\\
(ii') each subgrid contains a point which is not covered by other subgrids;\\
(iii) for each coordinate axis, there exists a subgrid $L_{i}$ orthogonal to this axis.

Then

$$
s \geq 1+\sum_{i=1}^{k}\left(n_{i}-1\right) .
$$

Proof. Assume to the contrary that $s \leq \sum_{i}\left(n_{i}-1\right)=s^{\prime}$. Our aim is to find a point that is not covered by $L_{1}, \ldots, L_{s}$.

The idea of the proof is the following. Imagine that we expand each subgrid to some maximal subgrid so that for the $i$ th axis, there will be at most $n_{i}-1$ maximal subgrids orthogonal to this axis. Then the desired point can be found easily: its $i$ th coordinate should be that not covered by the maximal subgrids orthogonal to the $i$ th axis. Surely, the conditions for existence of such expansion are provided by Hall's lemma on matchings. So, we will follow this direction, although we will apply Hall's lemma to some subgraph instead of the whole graph.

Construct a bipartite graph $G=\left(V \cup V^{\prime}, E\right)$ as follows. Let $V=\left\{L_{1}, \ldots, L_{s}\right\}$, and let $V^{\prime}=\left\{v_{i j}: 1 \leq i \leq s, 1 \leq j \leq n_{i}-1\right\}$ be some set of $s^{\prime}$ elements. Further, let the edge ( $L_{m}, v_{i j}$ ) appear iff $L_{m}$ is orthogonal to the $i$ th axis.

For each subset $W \subset V$, denote

$$
f(W)=\left\{v \in V^{\prime}:(L, v) \in E \text { for some } L \in W\right\} .
$$

Notice that $f(V)=V^{\prime}$ by (iii).\\
Now, consider the set $W \subset V$ containing the maximal number of elements such that $|W|>$ $|f(W)|$; if there is no such set then we set $W=\varnothing$. Denote $W^{\prime}=f(W), U=V \backslash W, U^{\prime}=V^{\prime} \backslash W^{\prime}$.

By our assumption and the Lemma condition, $|f(V)|=\left|V^{\prime}\right| \geq|V|$, hence $W \neq V$ and $U \neq \varnothing$. Permuting the coordinates, we can assume that $U^{\prime}=\left\{v_{i j}: 1 \leq i \leq \ell\right\}, W^{\prime}=\left\{v_{i j}: \ell+1 \leq i \leq k\right\}$.

Consider the induced subgraph $G^{\prime}$ of $G$ on the vertices $U \cup U^{\prime}$. We claim that for every $X \subset U$, we get $\left|f(X) \cap U^{\prime}\right| \geq|X|$ (so $G^{\prime}$ satisfies the conditions of Hall's lemma). Actually, we have $|W| \geq|f(W)|$, so if $|X|>\left|f(X) \cap U^{\prime}\right|$ for some $X \subset U$, then we have

$$
|W \cup X|=|W|+|X|>|f(W)|+\left|f(X) \cap U^{\prime}\right|=\left|f(W) \cup\left(f(X) \cap U^{\prime}\right)\right|=|f(W \cup X)|
$$

This contradicts the maximality of $|W|$.\\
Thus, applying Hall's lemma, we can assign to each $L \in U$ some vertex $v_{i j} \in U^{\prime}$ so that to distinct elements of $U$, distinct vertices of $U^{\prime}$ are assigned. In this situation, we say that $L \in U$ corresponds to the $i$ th axis, and write $g(L)=i$. Since there are $n_{i}-1$ vertices of the form $v_{i j}$, we get that for each $1 \leq i \leq \ell$, not more than $n_{i}-1$ subgrids correspond to the $i$ th axis.

Finally, we are ready to present the desired point. Since $W \neq V$, there exists a point $b=\left(b_{1}, b_{2}, \ldots, b_{k}\right) \in N \backslash\left(\cup_{L \in W} L\right)$. On the other hand, for every $1 \leq i \leq \ell$, consider any subgrid $L \in U$ with $g(L)=i$. This means exactly that $L$ is orthogonal to the $i$ th axis, and hence all its elements have the same $i$ th coordinate $c_{L}$. Since there are at most $n_{i}-1$ such subgrids, there exists a number $0 \leq a_{i} \leq n_{i}-1$ which is not contained in a set $\left\{c_{L}: g(L)=i\right\}$. Choose such number for every $1 \leq i \leq \ell$. Now we claim that point $a=\left(a_{1}, \ldots, a_{\ell}, b_{\ell+1}, \ldots, b_{k}\right)$ is not covered, hence contradicting the Lemma condition.

Surely, point $a$ cannot lie in some $L \in U$, since all the points in $L$ have $g(L)$ th coordinate $c_{L} \neq a_{g(L)}$. On the other hand, suppose that $a \in L$ for some $L \in W$; recall that $b \notin L$. But the points $a$ and $b$ differ only at first $\ell$ coordinates, so $L$ should be orthogonal to at least one of the first $\ell$ axes, and hence our graph contains some edge $\left(L, v_{i j}\right)$ for $i \leq \ell$. It contradicts the definition of $W^{\prime}$. The Lemma is proved.

Now we turn to the problem. Let $d_{j}$ be the step of the progression $P_{j}$. Note that since $n=$ l.c.m. $\left(d_{1}, \ldots, d_{s}\right)$, for each $1 \leq i \leq k$ there exists an index $j(i)$ such that $p_{i}^{\alpha_{i}} \mid d_{j(i)}$. We assume that $n>1$; otherwise the problem statement is trivial.

For each $0 \leq m \leq n-1$ and $1 \leq i \leq k$, let $m_{i}$ be the residue of $m$ modulo $p_{i}^{\alpha_{i}}$, and let $m_{i}=\overline{r_{i \alpha_{i}} \ldots r_{i 1}}$ be the base $p_{i}$ representation of $m_{i}$ (possibly, with some leading zeroes). Now, we put into correspondence to $m$ the sequence $r(m)=\left(r_{11}, \ldots, r_{1 \alpha_{1}}, r_{21}, \ldots, r_{k \alpha_{k}}\right)$. Hence $r(m)$ lies in a $\underbrace{p_{1} \times \cdots \times p_{1}}_{\alpha_{1} \text { times }} \times \cdots \times \underbrace{p_{k} \times \cdots \times p_{k}}_{\alpha_{k} \text { times }}$ grid $N$.

Surely, if $r(m)=r\left(m^{\prime}\right)$ then $p_{i}^{\alpha_{i}} \mid m_{i}-m_{i}^{\prime}$, which follows $p_{i}^{\alpha_{i}} \mid m-m^{\prime}$ for all $1 \leq i \leq k$; consequently, $n \mid m-m^{\prime}$. So, when $m$ runs over the set $\{0, \ldots, n-1\}$, the sequences $r(m)$ do not repeat; since $|N|=n$, this means that $r$ is a bijection between $\{0, \ldots, n-1\}$ and $N$. Now we will show that for each $1 \leq i \leq s$, the set $L_{i}=\left\{r(m): m \in P_{i}\right\}$ is a subgrid, and that for each axis there exists a subgrid orthogonal to this axis. Obviously, these subgrids cover $N$, and the condition (ii') follows directly from (ii). Hence the Lemma provides exactly the estimate we need.

Consider some $1 \leq j \leq s$ and let $d_{j}=p_{1}^{\gamma_{1}} \ldots p_{k}^{\gamma_{k}}$. Consider some $q \in P_{j}$ and let $r(q)=$ $\left(r_{11}, \ldots, r_{k \alpha_{k}}\right)$. Then for an arbitrary $q^{\prime}$, setting $r\left(q^{\prime}\right)=\left(r_{11}^{\prime}, \ldots, r_{k \alpha_{k}}^{\prime}\right)$ we have

$$
q^{\prime} \in P_{j} \quad \Longleftrightarrow \quad p_{i}^{\gamma_{i}} \mid q-q^{\prime} \text { for each } 1 \leq i \leq k \quad \Longleftrightarrow \quad r_{i, t}=r_{i, t}^{\prime} \text { for all } t \leq \gamma_{i}
$$

Hence $L_{j}=\left\{\left(r_{11}^{\prime}, \ldots, r_{k \alpha_{k}}^{\prime}\right) \in N: r_{i, t}=r_{i, t}^{\prime}\right.$ for all $\left.t \leq \gamma_{i}\right\}$ which means that $L_{j}$ is a subgrid containing $r(q)$. Moreover, in $L_{j(i)}$, all the coordinates corresponding to $p_{i}$ are fixed, so it is orthogonal to all of their axes, as desired.",1203,4
2010g1,"G1. Let $A B C$ be an acute triangle with $D, E, F$ the feet of the altitudes lying on $B C, C A, A B$ respectively. One of the intersection points of the line $E F$ and the circumcircle is $P$. The lines $B P$ and $D F$ meet at point $Q$. Prove that $A P=A Q$.","The line $E F$ intersects the circumcircle at two points. Depending on the choice of $P$, there are two different cases to consider.

Case 1: The point $P$ lies on the ray $E F$ (see Fig. 1).\\
Let $\angle C A B=\alpha, \angle A B C=\beta$ and $\angle B C A=\gamma$. The quadrilaterals $B C E F$ and $C A F D$ are cyclic due to the right angles at $D, E$ and $F$. So,

$$
\begin{aligned}
& \angle B D F=180^{\circ}-\angle F D C=\angle C A F=\alpha, \\
& \angle A F E=180^{\circ}-\angle E F B=\angle B C E=\gamma, \\
& \angle D F B=180^{\circ}-\angle A F D=\angle D C A=\gamma .
\end{aligned}
$$

Since $P$ lies on the arc $A B$ of the circumcircle, $\angle P B A<\angle B C A=\gamma$. Hence, we have

$$
\angle P B D+\angle B D F=\angle P B A+\angle A B D+\angle B D F<\gamma+\beta+\alpha=180^{\circ},
$$

and the point $Q$ must lie on the extensions of $B P$ and $D F$ beyond the points $P$ and $F$, respectively.

From the cyclic quadrilateral $A P B C$ we get

$$
\angle Q P A=180^{\circ}-\angle A P B=\angle B C A=\gamma=\angle D F B=\angle Q F A .
$$

Hence, the quadrilateral $A Q P F$ is cyclic. Then $\angle A Q P=180^{\circ}-\angle P F A=\angle A F E=\gamma$.\\
We obtained that $\angle A Q P=\angle Q P A=\gamma$, so the triangle $A Q P$ is isosceles, $A P=A Q$.\\

Case 2: The point $P$ lies on the ray $F E$ (see Fig. 2). In this case the point $Q$ lies inside the segment $F D$.

Similarly to the first case, we have

$$
\angle Q P A=\angle B C A=\gamma=\angle D F B=180^{\circ}-\angle A F Q
$$

Hence, the quadrilateral $A F Q P$ is cyclic.\\
Then $\angle A Q P=\angle A F P=\angle A F E=\gamma=\angle Q P A$. The triangle $A Q P$ is isosceles again, $\angle A Q P=\angle Q P A$ and thus $A P=A Q$.\\",337,3
2010g2,"Point $P$ lies inside triangle $A B C$. Lines $A P, B P, C P$ meet the circumcircle of $A B C$ again at points $K, L, M$, respectively. The tangent to the circumcircle at $C$ meets line $A B$ at $S$. Prove that $S C=S P$ if and only if $M K=M L$.","We assume that $C A>C B$, so point $S$ lies on the ray $A B$.\\
From the similar triangles $\triangle P K M \sim \triangle P C A$ and $\triangle P L M \sim \triangle P C B$ we get $\frac{P M}{K M}=\frac{P A}{C A}$ and $\frac{L M}{P M}=\frac{C B}{P B}$. Multiplying these two equalities, we get

$$
\frac{L M}{K M}=\frac{C B}{C A} \cdot \frac{P A}{P B} .
$$

Hence, the relation $M K=M L$ is equivalent to $\frac{C B}{C A}=\frac{P B}{P A}$.\\
Denote by $E$ the foot of the bisector of angle $B$ in triangle $A B C$. Recall that the locus of points $X$ for which $\frac{X A}{X B}=\frac{C A}{C B}$ is the Apollonius circle $\Omega$ with the center $Q$ on the line $A B$, and this circle passes through $C$ and $E$. Hence, we have $M K=M L$ if and only if $P$ lies on $\Omega$, that is $Q P=Q C$.\\

Now we prove that $S=Q$, thus establishing the problem statement. We have $\angle C E S=$ $\angle C A E+\angle A C E=\angle B C S+\angle E C B=\angle E C S$, so $S C=S E$. Hence, the point $S$ lies on $A B$ as well as on the perpendicular bisector of $C E$ and therefore coincides with $Q$.",213,2
2010g3,"Let $A_{1} A_{2} \ldots A_{n}$ be a convex polygon. Point $P$ inside this polygon is chosen so that its projections $P_{1}, \ldots, P_{n}$ onto lines $A_{1} A_{2}, \ldots, A_{n} A_{1}$ respectively lie on the sides of the polygon. Prove that for arbitrary points $X_{1}, \ldots, X_{n}$ on sides $A_{1} A_{2}, \ldots, A_{n} A_{1}$ respectively,

$$
\max \left\{\frac{X_{1} X_{2}}{P_{1} P_{2}}, \ldots, \frac{X_{n} X_{1}}{P_{n} P_{1}}\right\} \geq 1
$$","Denote $P_{n+1}=P_{1}, X_{n+1}=X_{1}, A_{n+1}=A_{1}$.\\
Lemma. Let point $Q$ lies inside $A_{1} A_{2} \ldots A_{n}$. Then it is contained in at least one of the circumcircles of triangles $X_{1} A_{2} X_{2}, \ldots, X_{n} A_{1} X_{1}$.

Proof. If $Q$ lies in one of the triangles $X_{1} A_{2} X_{2}, \ldots, X_{n} A_{1} X_{1}$, the claim is obvious. Otherwise $Q$ lies inside the polygon $X_{1} X_{2} \ldots X_{n}$ (see Fig. 1). Then we have

$$
\begin{aligned}
& \left(\angle X_{1} A_{2} X_{2}+\angle X_{1} Q X_{2}\right)+\cdots+\left(\angle X_{n} A_{1} X_{1}+\angle X_{n} Q X_{1}\right) \\
& \quad=\left(\angle X_{1} A_{1} X_{2}+\cdots+\angle X_{n} A_{1} X_{1}\right)+\left(\angle X_{1} Q X_{2}+\cdots+\angle X_{n} Q X_{1}\right)=(n-2) \pi+2 \pi=n \pi
\end{aligned}
$$

hence there exists an index $i$ such that $\angle X_{i} A_{i+1} X_{i+1}+\angle X_{i} Q X_{i+1} \geq \frac{\pi n}{n}=\pi$. Since the quadrilateral $Q X_{i} A_{i+1} X_{i+1}$ is convex, this means exactly that $Q$ is contained the circumcircle of $\triangle X_{i} A_{i+1} X_{i+1}$, as desired.

Now we turn to the solution. Applying lemma, we get that $P$ lies inside the circumcircle of triangle $X_{i} A_{i+1} X_{i+1}$ for some $i$. Consider the circumcircles $\omega$ and $\Omega$ of triangles $P_{i} A_{i+1} P_{i+1}$ and $X_{i} A_{i+1} X_{i+1}$ respectively (see Fig. 2); let $r$ and $R$ be their radii. Then we get $2 r=A_{i+1} P \leq 2 R$ (since $P$ lies inside $\Omega$ ), hence

$$
P_{i} P_{i+1}=2 r \sin \angle P_{i} A_{i+1} P_{i+1} \leq 2 R \sin \angle X_{i} A_{i+1} X_{i+1}=X_{i} X_{i+1}
$$

QED.\\",235,2
2010g4,"Let $I$ be the incenter of a triangle $A B C$ and $\Gamma$ be its circumcircle. Let the line $A I$ intersect $\Gamma$ at a point $D \neq A$. Let $F$ and $E$ be points on side $B C$ and arc $B D C$ respectively such that $\angle B A F=\angle C A E<\frac{1}{2} \angle B A C$. Finally, let $G$ be the midpoint of the segment $I F$. Prove that the lines $D G$ and $E I$ intersect on $\Gamma$.","Let $X$ be the second point of intersection of line $E I$ with $\Gamma$, and $L$ be the foot of the bisector of angle $B A C$. Let $G^{\prime}$ and $T$ be the points of intersection of segment $D X$ with lines $I F$ and $A F$, respectively. We are to prove that $G=G^{\prime}$, or $I G^{\prime}=G^{\prime} F$. By the Menelaus theorem applied to triangle AIF and line $D X$, it means that we need the relation

$$
1=\frac{G^{\prime} F}{I G^{\prime}}=\frac{T F}{A T} \cdot \frac{A D}{I D}, \quad \text { or } \quad \frac{T F}{A T}=\frac{I D}{A D} .
$$

Let the line $A F$ intersect $\Gamma$ at point $K \neq A$ (see Fig. 1); since $\angle B A K=\angle C A E$ we have $\widehat{B K}=\widehat{C E}$, hence $K E \| B C$. Notice that $\angle I A T=\angle D A K=\angle E A D=\angle E X D=\angle I X T$, so the points $I, A, X, T$ are concyclic. Hence we have $\angle I T A=\angle I X A=\angle E X A=\angle E K A$, so $I T\|K E\| B C$. Therefore we obtain $\frac{T F}{A T}=\frac{I L}{A I}$.

Since $C I$ is the bisector of $\angle A C L$, we get $\frac{I L}{A I}=\frac{C L}{A C}$. Furthermore, $\angle D C L=\angle D C B=$ $\angle D A B=\angle C A D=\frac{1}{2} \angle B A C$, hence the triangles $D C L$ and $D A C$ are similar; therefore we get $\frac{C L}{A C}=\frac{D C}{A D}$. Finally, it is known that the midpoint $D$ of arc $B C$ is equidistant from points $I$, $B, C$, hence $\frac{D C}{A D}=\frac{I D}{A D}$.

Summarizing all these equalities, we get

$$
\frac{T F}{A T}=\frac{I L}{A I}=\frac{C L}{A C}=\frac{D C}{A D}=\frac{I D}{A D}
$$

as desired.\\",294,3
2010g5,"Let $A B C D E$ be a convex pentagon such that $B C \| A E, A B=B C+A E$, and $\angle A B C=$ $\angle C D E$. Let $M$ be the midpoint of $C E$, and let $O$ be the circumcenter of triangle $B C D$. Given that $\angle D M O=90^{\circ}$, prove that $2 \angle B D A=\angle C D E$.","Let $\angle C B D=\alpha, \angle B D C=\beta, \angle A D E=\gamma$, and $\angle A B C=\angle C D E=2 \varphi$. Then we have $\angle A D B=2 \varphi-\beta-\gamma, \angle B C D=180^{\circ}-\alpha-\beta, \angle A E D=360^{\circ}-\angle B C D-\angle C D E=$ $180^{\circ}-2 \varphi+\alpha+\beta$, and finally $\angle D A E=180^{\circ}-\angle A D E-\angle A E D=2 \varphi-\alpha-\beta-\gamma$.\\

Let $N$ be the midpoint of $C D$; then $\angle D N O=90^{\circ}=\angle D M O$, hence points $M, N$ lie on the circle with diameter $O D$. Now, if points $O$ and $M$ lie on the same side of $C D$, we have $\angle D M N=\angle D O N=\frac{1}{2} \angle D O C=\alpha ;$ in the other case, we have $\angle D M N=180^{\circ}-\angle D O N=\alpha ;$\\
so, in both cases $\angle D M N=\alpha$ (see Figures). Next, since $M N$ is a midline in triangle $C D E$, we have $\angle M D E=\angle D M N=\alpha$ and $\angle N D M=2 \varphi-\alpha$.

Now we apply the sine rule to the triangles $A B D, A D E$ (twice), $B C D$ and $M N D$ obtaining

$$
\begin{gathered}
\frac{A B}{A D}=\frac{\sin (2 \varphi-\beta-\gamma)}{\sin (2 \varphi-\alpha)}, \quad \frac{A E}{A D}=\frac{\sin \gamma}{\sin (2 \varphi-\alpha-\beta)}, \quad \frac{D E}{A D}=\frac{\sin (2 \varphi-\alpha-\beta-\gamma)}{\sin (2 \varphi-\alpha-\beta)} \\
\frac{B C}{C D}=\frac{\sin \beta}{\sin \alpha}, \quad \frac{C D}{D E}=\frac{C D / 2}{D E / 2}=\frac{N D}{N M}=\frac{\sin \alpha}{\sin (2 \varphi-\alpha)}
\end{gathered}
$$

which implies

$$
\frac{B C}{A D}=\frac{B C}{C D} \cdot \frac{C D}{D E} \cdot \frac{D E}{A D}=\frac{\sin \beta \cdot \sin (2 \varphi-\alpha-\beta-\gamma)}{\sin (2 \varphi-\alpha) \cdot \sin (2 \varphi-\alpha-\beta)}
$$

Hence, the condition $A B=A E+B C$, or equivalently $\frac{A B}{A D}=\frac{A E+B C}{A D}$, after multiplying by the common denominator rewrites as

$$
\begin{gathered}
\sin (2 \varphi-\alpha-\beta) \cdot \sin (2 \varphi-\beta-\gamma)=\sin \gamma \cdot \sin (2 \varphi-\alpha)+\sin \beta \cdot \sin (2 \varphi-\alpha-\beta-\gamma) \\
\Longleftrightarrow \cos (\gamma-\alpha)-\cos (4 \varphi-2 \beta-\alpha-\gamma)=\cos (2 \varphi-\alpha-2 \beta-\gamma)-\cos (2 \varphi+\gamma-\alpha) \\
\Longleftrightarrow \cos (\gamma-\alpha)+\cos (2 \varphi+\gamma-\alpha)=\cos (2 \varphi-\alpha-2 \beta-\gamma)+\cos (4 \varphi-2 \beta-\alpha-\gamma) \\
\Longleftrightarrow \cos \varphi \cdot \cos (\varphi+\gamma-\alpha)=\cos \varphi \cdot \cos (3 \varphi-2 \beta-\alpha-\gamma) \\
\Longleftrightarrow \cos \varphi \cdot(\cos (\varphi+\gamma-\alpha)-\cos (3 \varphi-2 \beta-\alpha-\gamma))=0 \\
\Longleftrightarrow \cos \varphi \cdot \sin (2 \varphi-\beta-\alpha) \cdot \sin (\varphi-\beta-\gamma)=0
\end{gathered}
$$

Since $2 \varphi-\beta-\alpha=180^{\circ}-\angle A E D<180^{\circ}$ and $\varphi=\frac{1}{2} \angle A B C<90^{\circ}$, it follows that $\varphi=\beta+\gamma$, hence $\angle B D A=2 \varphi-\beta-\gamma=\varphi=\frac{1}{2} \angle C D E$, as desired.",394,3
2010g6,"The vertices $X, Y, Z$ of an equilateral triangle $X Y Z$ lie respectively on the sides $B C$, $C A, A B$ of an acute-angled triangle $A B C$. Prove that the incenter of triangle $A B C$ lies inside triangle $X Y Z$.\\","We will prove a stronger fact; namely, we will show that the incenter $I$ of triangle $A B C$ lies inside the incircle of triangle $X Y Z$ (and hence surely inside triangle $X Y Z$ itself). We denote by $d(U, V W)$ the distance between point $U$ and line $V W$.

Denote by $O$ the incenter of $\triangle X Y Z$ and by $r, r^{\prime}$ and $R^{\prime}$ the inradii of triangles $A B C, X Y Z$ and the circumradius of $X Y Z$, respectively. Then we have $R^{\prime}=2 r^{\prime}$, and the desired inequality is $O I \leq r^{\prime}$. We assume that $O \neq I$; otherwise the claim is trivial.

Let the incircle of $\triangle A B C$ touch its sides $B C, A C, A B$ at points $A_{1}, B_{1}, C_{1}$ respectively. The lines $I A_{1}, I B_{1}, I C_{1}$ cut the plane into 6 acute angles, each one containing one of the points $A_{1}, B_{1}, C_{1}$ on its border. We may assume that $O$ lies in an angle defined by lines $I A_{1}$, $I C_{1}$ and containing point $C_{1}$ (see Fig. 1). Let $A^{\prime}$ and $C^{\prime}$ be the projections of $O$ onto lines $I A_{1}$ and $I C_{1}$, respectively.

Since $O X=R^{\prime}$, we have $d(O, B C) \leq R^{\prime}$. Since $O A^{\prime} \| B C$, it follows that $d\left(A^{\prime}, B C\right)=$ $A^{\prime} I+r \leq R^{\prime}$, or $A^{\prime} I \leq R^{\prime}-r$. On the other hand, the incircle of $\triangle X Y Z$ lies inside $\triangle A B C$, hence $d(O, A B) \geq r^{\prime}$, and analogously we get $d(O, A B)=C^{\prime} C_{1}=r-I C^{\prime} \geq r^{\prime}$, or $I C^{\prime} \leq r-r^{\prime}$.\\

Finally, the quadrilateral $I A^{\prime} O C^{\prime}$ is circumscribed due to the right angles at $A^{\prime}$ and $C^{\prime}$ (see Fig. 2). On its circumcircle, we have $\widehat{A^{\prime} O C^{\prime}}=2 \angle A^{\prime} I C^{\prime}<180^{\circ}=\widehat{O C^{\prime} I \text {, hence } 180^{\circ} \geq}$ $\overline{I C^{\prime}}>\widehat{A^{\prime} O}$. This means that $I C^{\prime}>A^{\prime} O$. Finally, we have $O I \leq I A^{\prime}+A^{\prime} O<I A^{\prime}+I C^{\prime} \leq$ $\left(R^{\prime}-r\right)+\left(r-r^{\prime}\right)=R^{\prime}-r^{\prime}=r^{\prime}$, as desired.


",337,3
2010g7,"Three circular arcs $\gamma_{1}, \gamma_{2}$, and $\gamma_{3}$ connect the points $A$ and $C$. These arcs lie in the same half-plane defined by line $A C$ in such a way that arc $\gamma_{2}$ lies between the arcs $\gamma_{1}$ and $\gamma_{3}$. Point $B$ lies on the segment $A C$. Let $h_{1}, h_{2}$, and $h_{3}$ be three rays starting at $B$, lying in the same half-plane, $h_{2}$ being between $h_{1}$ and $h_{3}$. For $i, j=1,2,3$, denote by $V_{i j}$ the point of intersection of $h_{i}$ and $\gamma_{j}$ (see the Figure below).\\
\includegraphics[max width=\textwidth]{2025_05_04_3fd3d9bd7a00de872656g-61} and arcs $V_{i j} V_{k j}$ and $V_{i \ell} V_{k \ell}$. We say that this quadrilateral is circumscribed if there exists a circle touching these two segments and two arcs.

Prove that if the curved quadrilaterals $\sqrt{V_{11} V_{21}} \sqrt{22} V_{12}, \sqrt{12} V_{22} \sqrt{23} V_{13}, \sqrt{21} \sqrt{31} \sqrt{32 V_{22}}$ are circumscribed, then the curved quadrilateral $\widehat{V_{22} V_{32}} \sqrt{3_{33} V_{23}}$ is circumscribed, too.","Solution. Denote by $O_{i}$ and $R_{i}$ the center and the radius of $\gamma_{i}$, respectively. Denote also by $H$ the half-plane defined by $A C$ which contains the whole configuration. For every point $P$ in the half-plane $H$, denote by $d(P)$ the distance between $P$ and line $A C$. Furthermore, for any $r>0$, denote by $\Omega(P, r)$ the circle with center $P$ and radius $r$.\\
Lemma 1. For every $1 \leq i<j \leq 3$, consider those circles $\Omega(P, r)$ in the half-plane $H$ which are tangent to $h_{i}$ and $h_{j}$.\\
(a) The locus of the centers of these circles is the angle bisector $\beta_{i j}$ between $h_{i}$ and $h_{j}$.\\
(b) There is a constant $u_{i j}$ such that $r=u_{i j} \cdot d(P)$ for all such circles.

Proof. Part (a) is obvious. To prove part (b), notice that the circles which are tangent to $h_{i}$ and $h_{j}$ are homothetic with the common homothety center $B$ (see Fig. 2). Then part (b) also becomes trivial.

Lemma 2. For every $1 \leq i<j \leq 3$, consider those circles $\Omega(P, r)$ in the half-plane $H$ which are externally tangent to $\gamma_{i}$ and internally tangent to $\gamma_{j}$.\\
(a) The locus of the centers of these circles is an ellipse arc $\varepsilon_{i j}$ with end-points $A$ and $C$.\\
(b) There is a constant $v_{i j}$ such that $r=v_{i j} \cdot d(P)$ for all such circles.

Proof. (a) Notice that the circle $\Omega(P, r)$ is externally tangent to $\gamma_{i}$ and internally tangent to $\gamma_{j}$ if and only if $O_{i} P=R_{i}+r$ and $O_{j}=R_{j}-r$. Therefore, for each such circle we have

$$
O_{i} P+O_{j} P=O_{i} A+O_{j} A=O_{i} C+O_{j} C=R_{i}+R_{j} .
$$

Such points lie on an ellipse with foci $O_{i}$ and $O_{j}$; the diameter of this ellipse is $R_{i}+R_{j}$, and it passes through the points $A$ and $C$. Let $\varepsilon_{i j}$ be that arc $A C$ of the ellipse which runs inside the half plane $H$ (see Fig. 3.)

This ellipse arc lies between the arcs $\gamma_{i}$ and $\gamma_{j}$. Therefore, if some point $P$ lies on $\varepsilon_{i j}$, then $O_{i} P>R_{i}$ and $O_{j} P<R_{j}$. Now, we choose $r=O_{i} P-R_{i}=R_{j}-O_{j} P>0$; then the\\
\includegraphics[max width=\textwidth, center]{2025_05_04_3fd3d9bd7a00de872656g-62}

Fig. 2\\
\includegraphics[max width=\textwidth, center]{2025_05_04_3fd3d9bd7a00de872656g-62(1)}

Fig. 3\\
circle $\Omega(P, r)$ touches $\gamma_{i}$ externally and touches $\gamma_{j}$ internally, so $P$ belongs to the locus under investigation.\\
(b) Let $\vec{\rho}=\overrightarrow{A P}, \vec{\rho}_{i}=\overrightarrow{A O_{i}}$, and $\vec{\rho}_{j}=\overrightarrow{A O_{j}}$; let $d_{i j}=O_{i} O_{j}$, and let $\vec{v}$ be a unit vector orthogonal to $A C$ and directed toward $H$. Then we have $\left|\vec{\rho}_{i}\right|=R_{i},\left|\vec{\rho}_{j}\right|=R_{j},\left|\overrightarrow{O_{i} P}\right|=$ $\left|\vec{\rho}-\vec{\rho}_{i}\right|=R_{i}+r,\left|\overrightarrow{O_{j} P}\right|=\left|\vec{\rho}-\vec{\rho}_{j}\right|=R_{j}-r$, hence

$$
\begin{gathered}
\left(\vec{\rho}-\vec{\rho}_{i}\right)^{2}-\left(\vec{\rho}-\vec{\rho}_{j}\right)^{2}=\left(R_{i}+r\right)^{2}-\left(R_{j}-r\right)^{2}, \\
\left(\vec{\rho}_{i}^{2}-\vec{\rho}_{j}^{2}\right)+2 \vec{\rho} \cdot\left(\vec{\rho}_{j}-\vec{\rho}_{i}\right)=\left(R_{i}^{2}-R_{j}^{2}\right)+2 r\left(R_{i}+R_{j}\right), \\
d_{i j} \cdot d(P)=d_{i j} \vec{v} \cdot \vec{\rho}=\left(\vec{\rho}_{j}-\vec{\rho}_{i}\right) \cdot \vec{\rho}=r\left(R_{i}+R_{j}\right) .
\end{gathered}
$$

Therefore,

$$
r=\frac{d_{i j}}{R_{i}+R_{j}} \cdot d(P),
$$

and the value $v_{i j}=\frac{d_{i j}}{R_{i}+R_{j}}$ does not depend on $P$.\\
Lemma 3. The curved quadrilateral $\mathcal{Q}_{i j}=\sqrt{i, j V_{i+1, j}} V_{i+1, j+1} V_{i, j+1}$ is circumscribed if and only if $u_{i, i+1}=v_{j, j+1}$.\\
Proof. First suppose that the curved quadrilateral $\mathcal{Q}_{i j}$ is circumscribed and $\Omega(P, r)$ is its inscribed circle. By Lemma 1 and Lemma 2 we have $r=u_{i, i+1} \cdot d(P)$ and $r=v_{j, j+1} \cdot d(P)$ as well. Hence, $u_{i, i+1}=v_{j, j+1}$.

To prove the opposite direction, suppose $u_{i, i+1}=v_{j, j+1}$. Let $P$ be the intersection of the angle bisector $\beta_{i, i+1}$ and the ellipse arc $\varepsilon_{j, j+1}$. Choose $r=u_{i, i+1} \cdot d(P)=v_{j, j+1} \cdot d(P)$. Then the circle $\Omega(P, r)$ is tangent to the half lines $h_{i}$ and $h_{i+1}$ by Lemma 1 , and it is tangent to the arcs $\gamma_{j}$ and $\gamma_{j+1}$ by Lemma 2. Hence, the curved quadrilateral $\mathcal{Q}_{i j}$ is circumscribed.

By Lemma 3, the statement of the problem can be reformulated to an obvious fact: If the equalities $u_{12}=v_{12}, u_{12}=v_{23}$, and $u_{23}=v_{12}$ hold, then $u_{23}=v_{23}$ holds as well.

Comment 1. Lemma 2(b) (together with the easy Lemma 1(b)) is the key tool in this solution. If one finds this fact, then the solution can be finished in many ways. That is, one can find a circle touching three of $h_{2}, h_{3}, \gamma_{2}$, and $\gamma_{3}$, and then prove that it is tangent to the fourth one in either synthetic or analytical way. Both approaches can be successful.

Here we present some discussion about this key Lemma.

\begin{enumerate}
  \item In the solution above we chose an analytic proof for Lemma 2(b) because we expect that most students will use coordinates or vectors to examine the locus of the centers, and these approaches are less case-sensitive.
\end{enumerate}

Here we outline a synthetic proof. We consider only the case when $P$ does not lie in the line $O_{i} O_{j}$. The other case can be obtained as a limit case, or computed in a direct way.

Let $S$ be the internal homothety center between the circles of $\gamma_{i}$ and $\gamma_{j}$, lying on $O_{i} O_{j}$; this point does not depend on $P$. Let $U$ and $V$ be the points of tangency of circle $\sigma=\Omega(P, r)$ with $\gamma_{i}$ and $\gamma_{j}$, respectively (then $r=P U=P V$ ); in other words, points $U$ and $V$ are the intersection points of rays $O_{i} P, O_{j} P$ with arcs $\gamma_{i}, \gamma_{j}$ respectively (see Fig. 4).

Due to the theorem on three homothety centers (or just to the Menelaus theorem applied to triangle $O_{i} O_{j} P$ ), the points $U, V$ and $S$ are collinear. Let $T$ be the intersection point of line $A C$ and the common tangent to $\sigma$ and $\gamma_{i}$ at $U$; then $T$ is the radical center of $\sigma, \gamma_{i}$ and $\gamma_{j}$, hence $T V$ is the common tangent to $\sigma$ and $\gamma_{j}$.

Let $Q$ be the projection of $P$ onto the line $A C$. By the right angles, the points $U, V$ and $Q$ lie on the circle with diameter $P T$. From this fact and the equality $P U=P V$ we get $\angle U Q P=\angle U V P=$ $\angle V U P=\angle S U O_{i}$. Since $O_{i} S \| P Q$, we have $\angle S O_{i} U=\angle Q P U$. Hence, the triangles $S O_{i} U$ and $U P Q$ are similar and thus $\frac{r}{d(P)}=\frac{P U}{P Q}=\frac{O_{i} S}{O_{i} U}=\frac{O_{i} S}{R_{i}}$; the last expression is constant since $S$ is a constant point.\\
\includegraphics[max width=\textwidth, center]{2025_05_04_3fd3d9bd7a00de872656g-63(1)}

Fig. 4\\
\includegraphics[max width=\textwidth, center]{2025_05_04_3fd3d9bd7a00de872656g-63}

Fig. 5\\
2. Using some known facts about conics, the same statement can be proved in a very short way. Denote by $\ell$ the directrix of ellipse of $\varepsilon_{i j}$ related to the focus $O_{j}$; since $\varepsilon_{i j}$ is symmetrical about $O_{i} O_{j}$, we have $\ell \| A C$. Recall that for each point $P \in \varepsilon_{i j}$, we have $P O_{j}=\epsilon \cdot d_{\ell}(P)$, where $d_{\ell}(P)$ is the distance from $P$ to $\ell$, and $\epsilon$ is the eccentricity of $\varepsilon_{i j}$ (see Fig. 5).

Now we have

$$
r=R_{j}-\left(R_{j}-r\right)=A O_{j}-P O_{j}=\epsilon\left(d_{\ell}(A)-d_{\ell}(P)\right)=\epsilon(d(P)-d(A))=\epsilon \cdot d(P)
$$

and $\epsilon$ does not depend on $P$.

Comment 2. One can find a spatial interpretations of the problem and the solution.\\
For every point $(x, y)$ and radius $r>0$, represent the circle $\Omega((x, y), r)$ by the point $(x, y, r)$ in space. This point is the apex of the cone with base circle $\Omega((x, y), r)$ and height $r$. According to Lemma 1, the circles which are tangent to $h_{i}$ and $h_{j}$ correspond to the points of a half line $\beta_{i j}^{\prime}$, starting at $B$.

Now we translate Lemma 2. Take some $1 \leq i<j \leq 3$, and consider those circles which are internally tangent to $\gamma_{j}$. It is easy to see that the locus of the points which represent these circles is a subset of a cone, containing $\gamma_{j}$. Similarly, the circles which are externally tangent to $\gamma_{i}$ correspond to the points on the extension of another cone, which has its apex on the opposite side of the base plane $\Pi$. (See Fig. 6; for this illustration, the $z$-coordinates were multiplied by 2.)

The two cones are symmetric to each other (they have the same aperture, and their axes are parallel). As is well-known, it follows that the common points of the two cones are co-planar. So the intersection of the two cones is a a conic section - which is an ellipse, according to Lemma 2(a). The points which represent the circles touching $\gamma_{i}$ and $\gamma_{j}$ is an ellipse arc $\varepsilon_{i j}^{\prime}$ with end-points $A$ and $C$.\\
\includegraphics[max width=\textwidth, center]{2025_05_04_3fd3d9bd7a00de872656g-64(1)}

Fig. 6\\
\includegraphics[max width=\textwidth, center]{2025_05_04_3fd3d9bd7a00de872656g-64}

Fig. 7

Thus, the curved quadrilateral $\mathcal{Q}_{i j}$ is circumscribed if and only if $\beta_{i, i+1}^{\prime}$ and $\varepsilon_{j, j+1}^{\prime}$ intersect, i.e. if they are coplanar. If three of the four curved quadrilaterals are circumscribed, it means that $\varepsilon_{12}^{\prime}, \varepsilon_{23}^{\prime}$, $\beta_{12}^{\prime}$ and $\beta_{23}^{\prime}$ lie in the same plane $\Sigma$, and the fourth intersection comes to existence, too",1435,4
2010n6,"The rows and columns of a $2^{n} \times 2^{n}$ table are numbered from 0 to $2^{n}-1$. The cells of the table have been colored with the following property being satisfied: for each $0 \leq i, j \leq 2^{n}-1$, the $j$ th cell in the $i$ th row and the $(i+j)$ th cell in the $j$ th row have the same color. (The indices of the cells in a row are considered modulo $2^{n}$.)

Prove that the maximal possible number of colors is $2^{n}$.","Solution. Throughout the solution we denote the cells of the table by coordinate pairs; $(i, j)$ refers to the $j$ th cell in the $i$ th row.

Consider the directed graph, whose vertices are the cells of the board, and the edges are the arrows $(i, j) \rightarrow(j, i+j)$ for all $0 \leq i, j \leq 2^{n}-1$. From each vertex $(i, j)$, exactly one edge passes (to $\left(j, i+j \bmod 2^{n}\right)$ ); conversely, to each cell $(j, k)$ exactly one edge is directed (from the cell $\left.\left(k-j \bmod 2^{n}, j\right)\right)$. Hence, the graph splits into cycles.

Now, in any coloring considered, the vertices of each cycle should have the same color by the problem condition. On the other hand, if each cycle has its own color, the obtained coloring obviously satisfies the problem conditions. Thus, the maximal possible number of colors is the same as the number of cycles, and we have to prove that this number is $2^{n}$.

Next, consider any cycle $\left(i_{1}, j_{1}\right),\left(i_{2}, j_{2}\right), \ldots$; we will describe it in other terms. Define a sequence $\left(a_{0}, a_{1}, \ldots\right)$ by the relations $a_{0}=i_{1}, a_{1}=j_{1}, a_{n+1}=a_{n}+a_{n-1}$ for all $n \geq 1$ (we say that such a sequence is a Fibonacci-type sequence). Then an obvious induction shows that $i_{k} \equiv a_{k-1}\left(\bmod 2^{n}\right), j_{k} \equiv a_{k}\left(\bmod 2^{n}\right)$. Hence we need to investigate the behavior of Fibonacci-type sequences modulo $2^{n}$.

Denote by $F_{0}, F_{1}, \ldots$ the Fibonacci numbers defined by $F_{0}=0, F_{1}=1$, and $F_{n+2}=$ $F_{n+1}+F_{n}$ for $n \geq 0$. We also set $F_{-1}=1$ according to the recurrence relation.

For every positive integer $m$, denote by $\nu(m)$ the exponent of 2 in the prime factorization of $m$, i.e. for which $2^{\nu(m)} \mid m$ but $2^{\nu(m)+1} \nmid m$.\\
Lemma 1. For every Fibonacci-type sequence $a_{0}, a_{1}, a_{2}, \ldots$, and every $k \geq 0$, we have $a_{k}=$ $F_{k-1} a_{0}+F_{k} a_{1}$.\\
Proof. Apply induction on $k$. The base cases $k=0,1$ are trivial. For the step, from the induction hypothesis we get

$$
a_{k+1}=a_{k}+a_{k-1}=\left(F_{k-1} a_{0}+F_{k} a_{1}\right)+\left(F_{k-2} a_{0}+F_{k-1} a_{1}\right)=F_{k} a_{0}+F_{k+1} a_{1} .
$$

Lemma 2. For every $m \geq 3$,\\
(a) we have $\nu\left(F_{3.2^{m-2}}\right)=m$;\\
(b) $d=3 \cdot 2^{m-2}$ is the least positive index for which $2^{m} \mid F_{d}$;\\
(c) $F_{3 \cdot 2^{m-2}+1} \equiv 1+2^{m-1}\left(\bmod 2^{m}\right)$.

Proof. Apply induction on $m$. In the base case $m=3$ we have $\nu\left(F_{3 \cdot 2^{m-2}}\right)=F_{6}=8$, so $\nu\left(F_{3 \cdot 2^{m-2}}\right)=\nu(8)=3$, the preceding Fibonacci-numbers are not divisible by 8, and indeed $F_{3 \cdot 2^{m-2}+1}=F_{7}=13 \equiv 1+4(\bmod 8)$.

Now suppose that $m>3$ and let $k=3 \cdot 2^{m-3}$. By applying Lemma 1 to the Fibonacci-type sequence $F_{k}, F_{k+1}, \ldots$ we get

$$
\begin{gathered}
F_{2 k}=F_{k-1} F_{k}+F_{k} F_{k+1}=\left(F_{k+1}-F_{k}\right) F_{k}+F_{k+1} F_{k}=2 F_{k+1} F_{k}-F_{k}^{2}, \\
F_{2 k+1}=F_{k} \cdot F_{k}+F_{k+1} \cdot F_{k+1}=F_{k}^{2}+F_{k+1}^{2} .
\end{gathered}
$$

By the induction hypothesis, $\nu\left(F_{k}\right)=m-1$, and $F_{k+1}$ is odd. Therefore we get $\nu\left(F_{k}^{2}\right)=$ $2(m-1)>(m-1)+1=\nu\left(2 F_{k} F_{k+1}\right)$, which implies $\nu\left(F_{2 k}\right)=m$, establishing statement (a).

Moreover, since $F_{k+1}=1+2^{m-2}+a 2^{m-1}$ for some integer $a$, we get

$$
F_{2 k+1}=F_{k}^{2}+F_{k+1}^{2} \equiv 0+\left(1+2^{m-2}+a 2^{m-1}\right)^{2} \equiv 1+2^{m-1} \quad\left(\bmod 2^{m}\right),
$$

as desired in statement (c).\\
We are left to prove that $2^{m} \nmid F_{\ell}$ for $\ell<2 k$. Assume the contrary. Since $2^{m-1} \mid F_{\ell}$, from the induction hypothesis it follows that $\ell>k$. But then we have $F_{\ell}=F_{k-1} F_{\ell-k}+F_{k} F_{\ell-k+1}$, where the second summand is divisible by $2^{m-1}$ but the first one is not (since $F_{k-1}$ is odd and $\ell-k<k$ ). Hence the sum is not divisible even by $2^{m-1}$. A contradiction.

Now, for every pair of integers $(a, b) \neq(0,0)$, let $\mu(a, b)=\min \{\nu(a), \nu(b)\}$. By an obvious induction, for every Fibonacci-type sequence $A=\left(a_{0}, a_{1}, \ldots\right)$ we have $\mu\left(a_{0}, a_{1}\right)=\mu\left(a_{1}, a_{2}\right)=\ldots$; denote this common value by $\mu(A)$. Also denote by $p_{n}(A)$ the period of this sequence modulo $2^{n}$, that is, the least $p>0$ such that $a_{k+p} \equiv a_{k}\left(\bmod 2^{n}\right)$ for all $k \geq 0$.\\
Lemma 3. Let $A=\left(a_{0}, a_{1}, \ldots\right)$ be a Fibonacci-type sequence such that $\mu(A)=k<n$. Then $p_{n}(A)=3 \cdot 2^{n-1-k}$.\\
Proof. First, we note that the sequence $\left(a_{0}, a_{1}, \ldots\right)$ has period $p$ modulo $2^{n}$ if and only if the sequence $\left(a_{0} / 2^{k}, a_{1} / 2^{k}, \ldots\right)$ has period $p$ modulo $2^{n-k}$. Hence, passing to this sequence we can assume that $k=0$.

We prove the statement by induction on $n$. It is easy to see that for $n=1,2$ the claim is true; actually, each Fibonacci-type sequence $A$ with $\mu(A)=0$ behaves as $0,1,1,0,1,1, \ldots$ modulo 2 , and as $0,1,1,2,3,1,0,1,1,2,3,1, \ldots$ modulo 4 (all pairs of residues from which at least one is odd appear as a pair of consecutive terms in this sequence).

Now suppose that $n \geq 3$ and consider an arbitrary Fibonacci-type sequence $A=\left(a_{0}, a_{1}, \ldots\right)$ with $\mu(A)=0$. Obviously we should have $p_{n-1}(A) \mid p_{n}(A)$, or, using the induction hypothesis, $s=3 \cdot 2^{n-2} \mid p_{n}(A)$. Next, we may suppose that $a_{0}$ is even; hence $a_{1}$ is odd, and $a_{0}=2 b_{0}$, $a_{1}=2 b_{1}+1$ for some integers $b_{0}, b_{1}$.

Consider the Fibonacci-type sequence $B=\left(b_{0}, b_{1}, \ldots\right)$ starting with $\left(b_{0}, b_{1}\right)$. Since $a_{0}=$ $2 b_{0}+F_{0}, a_{1}=2 b_{1}+F_{1}$, by an easy induction we get $a_{k}=2 b_{k}+F_{k}$ for all $k \geq 0$. By the induction hypothesis, we have $p_{n-1}(B) \mid s$, hence the sequence $\left(2 b_{0}, 2 b_{1}, \ldots\right)$ is $s$-periodic modulo $2^{n}$. On the other hand, by Lemma 2 we have $F_{s+1} \equiv 1+2^{n-1}\left(\bmod 2^{n}\right), F_{2 s} \equiv 0$ $\left(\bmod 2^{n}\right), F_{2 s+1} \equiv 1\left(\bmod 2^{n}\right)$, hence

$$
\begin{gathered}
a_{s+1}=2 b_{s+1}+F_{s+1} \equiv 2 b_{1}+1+2^{n-1} \not \equiv 2 b_{1}+1=a_{1} \quad\left(\bmod 2^{n}\right), \\
a_{2 s}=2 b_{2 s}+F_{2 s} \equiv 2 b_{0}+0=a_{0} \quad\left(\bmod 2^{n}\right) \\
a_{2 s+1}=2 b_{2 s+1}+F_{2 s+1} \equiv 2 b_{1}+1=a_{1} \quad\left(\bmod 2^{n}\right) .
\end{gathered}
$$

The first line means that $A$ is not $s$-periodic, while the other two provide that $a_{2 s} \equiv a_{0}$, $a_{2 s+1} \equiv a_{1}$ and hence $a_{2 s+t} \equiv a_{t}$ for all $t \geq 0$. Hence $s\left|p_{n}(A)\right| 2 s$ and $p_{n}(A) \neq s$, which means that $p_{n}(A)=2 s$, as desired.

Finally, Lemma 3 provides a straightforward method of counting the number of cycles. Actually, take any number $0 \leq k \leq n-1$ and consider all the cells $(i, j)$ with $\mu(i, j)=k$. The total number of such cells is $2^{2(n-k)}-2^{2(n-k-1)}=3 \cdot 2^{2 n-2 k-2}$. On the other hand, they are split into cycles, and by Lemma 3 the length of each cycle is $3 \cdot 2^{n-1-k}$. Hence the number of cycles consisting of these cells is exactly $\frac{3 \cdot 2^{2 n-2 k-2}}{3 \cdot 2^{n-1-k}}=2^{n-k-1}$. Finally, there is only one cell $(0,0)$ which is not mentioned in the previous computation, and it forms a separate cycle. So the total number of cycles is

$$
1+\sum_{k=0}^{n-1} 2^{n-1-k}=1+\left(1+2+4+\cdots+2^{n-1}\right)=2^{n}
$$

Comment. We outline a different proof for the essential part of Lemma 3. That is, we assume that $k=0$ and show that in this case the period of $\left(a_{i}\right)$ modulo $2^{n}$ coincides with the period of the Fibonacci numbers modulo $2^{n}$; then the proof can be finished by the arguments from Lemma 2 ..

Note that $p$ is a (not necessarily minimal) period of the sequence $\left(a_{i}\right)$ modulo $2^{n}$ if and only if we have $a_{0} \equiv a_{p}\left(\bmod 2^{n}\right), a_{1} \equiv a_{p+1}\left(\bmod 2^{n}\right)$, that is,


\begin{align*}
& a_{0} \equiv a_{p} \equiv F_{p-1} a_{0}+F_{p} a_{1}=F_{p}\left(a_{1}-a_{0}\right)+F_{p+1} a_{0} \quad\left(\bmod 2^{n}\right) \\
& a_{1} \equiv a_{p+1}=F_{p} a_{0}+F_{p+1} a_{1} \quad\left(\bmod 2^{n}\right) \tag{1}
\end{align*}


Now, If $p$ is a period of $\left(F_{i}\right)$ then we have $F_{p} \equiv F_{0}=0\left(\bmod 2^{n}\right)$ and $F_{p+1} \equiv F_{1}=1\left(\bmod 2^{n}\right)$, which by (1) implies that $p$ is a period of $\left(a_{i}\right)$ as well.

Conversely, suppose that $p$ is a period of $\left(a_{i}\right)$. Combining the relations of (1) we get

$$
\begin{aligned}
0=a_{1} \cdot a_{0}-a_{0} \cdot a_{1} & \equiv a_{1}\left(F_{p}\left(a_{1}-a_{0}\right)+F_{p+1} a_{0}\right)-a_{0}\left(F_{p} a_{0}+F_{p+1} a_{1}\right) \\
& =F_{p}\left(a_{1}^{2}-a_{1} a_{0}-a_{0}^{2}\right) \quad\left(\bmod 2^{n}\right) \\
a_{1}^{2}-a_{1} a_{0}-a_{0}^{2}=\left(a_{1}-a_{0}\right) a_{1}-a_{0} \cdot a_{0} & \equiv\left(a_{1}-a_{0}\right)\left(F_{p} a_{0}+F_{p+1} a_{1}\right)-a_{0}\left(F_{p}\left(a_{1}-a_{0}\right)+F_{p+1} a_{0}\right) \\
& =F_{p+1}\left(a_{1}^{2}-a_{1} a_{0}-a_{0}^{2}\right) \quad\left(\bmod 2^{n}\right) .
\end{aligned}
$$

Since at least one of the numbers $a_{0}, a_{1}$ is odd, the number $a_{1}^{2}-a_{1} a_{0}-a_{0}^{2}$ is odd as well. Therefore the previous relations are equivalent with $F_{p} \equiv 0\left(\bmod 2^{n}\right)$ and $F_{p+1} \equiv 1\left(\bmod 2^{n}\right)$, which means exactly that $p$ is a period of $\left(F_{0}, F_{1}, \ldots\right)$ modulo $2^{n}$.

So, the sets of periods of $\left(a_{i}\right)$ and $\left(F_{i}\right)$ coincide, and hence the minimal periods coincide as well.",1340,4
2009a2,"Let $a, b, c$ be positive real numbers such that $\frac{1}{a}+\frac{1}{b}+\frac{1}{c}=a+b+c$. Prove that

$$
\frac{1}{(2 a+b+c)^{2}}+\frac{1}{(2 b+c+a)^{2}}+\frac{1}{(2 c+a+b)^{2}} \leq \frac{3}{16} .
$$","For positive real numbers $x, y, z$, from the arithmetic-geometric-mean inequality,

$$
2 x+y+z=(x+y)+(x+z) \geq 2 \sqrt{(x+y)(x+z)},
$$

we obtain

$$
\frac{1}{(2 x+y+z)^{2}} \leq \frac{1}{4(x+y)(x+z)}
$$

Applying this to the left-hand side terms of the inequality to prove, we get


\begin{align*}
\frac{1}{(2 a+b+c)^{2}} & +\frac{1}{(2 b+c+a)^{2}}+\frac{1}{(2 c+a+b)^{2}} \\
& \leq \frac{1}{4(a+b)(a+c)}+\frac{1}{4(b+c)(b+a)}+\frac{1}{4(c+a)(c+b)} \\
& =\frac{(b+c)+(c+a)+(a+b)}{4(a+b)(b+c)(c+a)}=\frac{a+b+c}{2(a+b)(b+c)(c+a)} . \tag{1}
\end{align*}


A second application of the inequality of the arithmetic-geometric mean yields

$$
a^{2} b+a^{2} c+b^{2} a+b^{2} c+c^{2} a+c^{2} b \geq 6 a b c
$$

or, equivalently,


\begin{equation*}
9(a+b)(b+c)(c+a) \geq 8(a+b+c)(a b+b c+c a) . \tag{2}
\end{equation*}


The supposition $\frac{1}{a}+\frac{1}{b}+\frac{1}{c}=a+b+c$ can be written as


\begin{equation*}
a b+b c+c a=a b c(a+b+c) . \tag{3}
\end{equation*}


Applying the arithmetic-geometric-mean inequality $x^{2} y^{2}+x^{2} z^{2} \geq 2 x^{2} y z$ thrice, we get

$$
a^{2} b^{2}+b^{2} c^{2}+c^{2} a^{2} \geq a^{2} b c+a b^{2} c+a b c^{2}
$$

which is equivalent to


\begin{equation*}
(a b+b c+c a)^{2} \geq 3 a b c(a+b+c) \tag{4}
\end{equation*}


Combining (1), (2), (3), and (4), we will finish the proof:

$$
\begin{aligned}
\frac{a+b+c}{2(a+b)(b+c)(c+a)} & =\frac{(a+b+c)(a b+b c+c a)}{2(a+b)(b+c)(c+a)} \cdot \frac{a b+b c+c a}{a b c(a+b+c)} \cdot \frac{a b c(a+b+c)}{(a b+b c+c a)^{2}} \\
& \leq \frac{9}{2 \cdot 8} \cdot 1 \cdot \frac{1}{3}=\frac{3}{16}
\end{aligned}
$$",201,2
2009a4,"Let $a, b, c$ be positive real numbers such that $a b+b c+c a \leq 3 a b c$. Prove that

$$
\sqrt{\frac{a^{2}+b^{2}}{a+b}}+\sqrt{\frac{b^{2}+c^{2}}{b+c}}+\sqrt{\frac{c^{2}+a^{2}}{c+a}}+3 \leq \sqrt{2}(\sqrt{a+b}+\sqrt{b+c}+\sqrt{c+a}) .
$$","Solution. Starting with the terms of the right-hand side, the quadratic-arithmetic-mean inequality yields

$$
\begin{aligned}
\sqrt{2} \sqrt{a+b} & =2 \sqrt{\frac{a b}{a+b}} \sqrt{\frac{1}{2}\left(2+\frac{a^{2}+b^{2}}{a b}\right)} \\
& \geq 2 \sqrt{\frac{a b}{a+b}} \cdot \frac{1}{2}\left(\sqrt{2}+\sqrt{\frac{a^{2}+b^{2}}{a b}}\right)=\sqrt{\frac{2 a b}{a+b}}+\sqrt{\frac{a^{2}+b^{2}}{a+b}}
\end{aligned}
$$

and, analogously,

$$
\sqrt{2} \sqrt{b+c} \geq \sqrt{\frac{2 b c}{b+c}}+\sqrt{\frac{b^{2}+c^{2}}{b+c}}, \quad \sqrt{2} \sqrt{c+a} \geq \sqrt{\frac{2 c a}{c+a}}+\sqrt{\frac{c^{2}+a^{2}}{c+a}} .
$$

Applying the inequality between the arithmetic mean and the squared harmonic mean will finish the proof:

$$\sqrt{\frac{2 a b}{a+b}}+\sqrt{\frac{2 b c}{b+c}}+\sqrt{\frac{2 c a}{c+a}} \geq 3 \cdot \sqrt{\frac{3}{{\sqrt{\frac{a+b}{2 a b}^2}+\sqrt{\frac{b+c}{2 b c}}+\sqrt{\frac{c+a}{2 c a}}}^2}}=3 \cdot \sqrt{\frac{3 a b c}{a b+b c+c a}} \geq 3 $$",98,1
2009a5,"Let $f$ be any function that maps the set of real numbers into the set of real numbers. Prove that there exist real numbers $x$ and $y$ such that

$$
f(x-f(y))>y f(x)+x .
$$","Assume that

\begin{equation*}
f(x-f(y)) \leq y f(x)+x \quad \text { for all real } x, y \tag{1}
\end{equation*}

Let $a=f(0)$. Setting $y=0$ in (1) gives $f(x-a) \leq x$ for all real $x$ and, equivalently,

\begin{equation*}
f(y) \leq y+a \quad \text { for all real } y \tag{2}
\end{equation*}

Setting $x=f(y)$ in (1) yields in view of (2)

$$
a=f(0) \leq y f(f(y))+f(y) \leq y f(f(y))+y+a
$$

This implies $0 \leq y(f(f(y))+1)$ and thus

\begin{equation*}
f(f(y)) \geq-1 \quad \text { for all } y>0 \tag{3}
\end{equation*}

From (2) and (3) we obtain $-1 \leq f(f(y)) \leq f(y)+a$ for all $y>0$, so

\begin{equation*}
f(y) \geq-a-1 \quad \text { for all } y>0 \tag{4}
\end{equation*}

Now we show that

\begin{equation*}
f(x) \leq 0 \quad \text { for all real } x \tag{5}
\end{equation*}

Assume the contrary, i.e. there is some $x$ such that $f(x)>0$. Take any $y$ such that

$$
y<x-a \quad \text { and } \quad y<\frac{-a-x-1}{f(x)}
$$

Then in view of (2)

$$
x-f(y) \geq x-(y+a)>0
$$

and with (1) and (4) we obtain

$$
y f(x)+x \geq f(x-f(y)) \geq-a-1,
$$

whence

$$
y \geq \frac{-a-x-1}{f(x)}
$$

contrary to our choice of $y$. Thereby, we have established (5).\\
Setting $x=0$ in (5) leads to $a=f(0) \leq 0$ and (2) then yields

\begin{equation*}
f(x) \leq x \quad \text { for all real } x \tag{6}
\end{equation*}

Now choose $y$ such that $y>0$ and $y>-f(-1)-1$ and set $x=f(y)-1$. From (1), (5) and\\
(6) we obtain

$$
f(-1)=f(x-f(y)) \leq y f(x)+x=y f(f(y)-1)+f(y)-1 \leq y(f(y)-1)-1 \leq-y-1,
$$

i.e. $y \leq-f(-1)-1$, a contradiction to the choice of $y$.
",262,3
2009a6,"Suppose that $s_{1}, s_{2}, s_{3}, \ldots$ is a strictly increasing sequence of positive integers such that the subsequences

$$
s_{s_{1}}, s_{s_{2}}, s_{s_{3}}, \ldots \quad \text { and } \quad s_{s_{1}+1}, s_{s_{2}+1}, s_{s_{3}+1}, \ldots
$$

are both arithmetic progressions. Prove that $s_{1}, s_{2}, s_{3}, \ldots$ is itself an arithmetic progression.","Let $D$ be the common difference of the progression $s_{s_{1}}, s_{s_{2}}, \ldots$. Let for $n=$ $1,2, \ldots$

$$
d_{n}=s_{n+1}-s_{n} .
$$

We have to prove that $d_{n}$ is constant. First we show that the numbers $d_{n}$ are bounded. Indeed, by supposition $d_{n} \geq 1$ for all $n$. Thus, we have for all $n$

$$
d_{n}=s_{n+1}-s_{n} \leq d_{s_{n}}+d_{s_{n}+1}+\cdots+d_{s_{n+1}-1}=s_{s_{n+1}}-s_{s_{n}}=D .
$$

The boundedness implies that there exist

$$
m=\min \left\{d_{n}: n=1,2, \ldots\right\} \quad \text { and } \quad M=\max \left\{d_{n}: n=1,2, \ldots\right\} .
$$

It suffices to show that $m=M$. Assume that $m<M$. Choose $n$ such that $d_{n}=m$. Considering a telescoping sum of $m=d_{n}=s_{n+1}-s_{n}$ items not greater than $M$ leads to


\begin{equation*}
D=s_{s_{n+1}}-s_{s_{n}}=s_{s_{n}+m}-s_{s_{n}}=d_{s_{n}}+d_{s_{n}+1}+\cdots+d_{s_{n}+m-1} \leq m M \tag{1}
\end{equation*}


and equality holds if and only if all items of the sum are equal to $M$. Now choose $n$ such that $d_{n}=M$. In the same way, considering a telescoping sum of $M$ items not less than $m$ we obtain


\begin{equation*}
D=s_{s_{n+1}}-s_{s_{n}}=s_{s_{n}+M}-s_{s_{n}}=d_{s_{n}}+d_{s_{n}+1}+\cdots+d_{s_{n}+M-1} \geq M m \tag{2}
\end{equation*}


and equality holds if and only if all items of the sum are equal to $m$. The inequalities (1) and (2) imply that $D=M m$ and that

$$
\begin{array}{cl}
d_{s_{n}}=d_{s_{n}+1}=\cdots=d_{s_{n+1}-1}=M & \text { if } d_{n}=m, \\
d_{s_{n}}=d_{s_{n}+1}=\cdots=d_{s_{n+1}-1}=m & \text { if } d_{n}=M .
\end{array}
$$

Hence, $d_{n}=m$ implies $d_{s_{n}}=M$. Note that $s_{n} \geq s_{1}+(n-1) \geq n$ for all $n$ and moreover $s_{n}>n$ if $d_{n}=n$, because in the case $s_{n}=n$ we would have $m=d_{n}=d_{s_{n}}=M$ in contradiction to the assumption $m<M$. In the same way $d_{n}=M$ implies $d_{s_{n}}=m$ and $s_{n}>n$. Consequently, there is a strictly increasing sequence $n_{1}, n_{2}, \ldots$ such that

$$
d_{s_{n_{1}}}=M, \quad d_{s_{n_{2}}}=m, \quad d_{s_{n_{3}}}=M, \quad d_{s_{n_{4}}}=m, \quad \ldots
$$

The sequence $d_{s_{1}}, d_{s_{2}}, \ldots$ is the sequence of pairwise differences of $s_{s_{1}+1}, s_{s_{2}+1}, \ldots$ and $s_{s_{1}}, s_{s_{2}}, \ldots$, hence also an arithmetic progression. Thus $m=M$.",301,3
2009c3,"Let $n$ be a positive integer. Given a sequence $\varepsilon_{1}, \ldots, \varepsilon_{n-1}$ with $\varepsilon_{i}=0$ or $\varepsilon_{i}=1$ for each $i=1, \ldots, n-1$, the sequences $a_{0}, \ldots, a_{n}$ and $b_{0}, \ldots, b_{n}$ are constructed by the following rules:

$$
\begin{gathered}
a_{0}=b_{0}=1, \quad a_{1}=b_{1}=7, \\
a_{i+1}=\left\{\begin{array}{ll}
2 a_{i-1}+3 a_{i}, & \text { if } \varepsilon_{i}=0, \\
3 a_{i-1}+a_{i}, & \text { if } \varepsilon_{i}=1,
\end{array} \text { for each } i=1, \ldots, n-1,\right. \\
b_{i+1}=\left\{\begin{array}{ll}
2 b_{i-1}+3 b_{i}, & \text { if } \varepsilon_{n-i}=0, \\
3 b_{i-1}+b_{i}, & \text { if } \varepsilon_{n-i}=1,
\end{array} \text { for each } i=1, \ldots, n-1 .\right.
\end{gathered}
$$

Prove that $a_{n}=b_{n}$.","Solution. For a binary word $w=\sigma_{1} \ldots \sigma_{n}$ of length $n$ and a letter $\sigma \in\{0,1\}$ let $w \sigma=$ $\sigma_{1} \ldots \sigma_{n} \sigma$ and $\sigma w=\sigma \sigma_{1} \ldots \sigma_{n}$. Moreover let $\bar{w}=\sigma_{n} \ldots \sigma_{1}$ and let $\emptyset$ be the empty word (of length 0 and with $\bar{\emptyset}=\emptyset$ ). Let $(u, v)$ be a pair of two real numbers. For binary words $w$ we define recursively the numbers $(u, v)^{w}$ as follows:

$$
\begin{gathered}
(u, v)^{\natural}=v, \quad(u, v)^{0}=2 u+3 v, \quad(u, v)^{1}=3 u+v, \\
(u, v)^{w \sigma \varepsilon}= \begin{cases}2(u, v)^{w}+3(u, v)^{w \sigma}, & \text { if } \varepsilon=0, \\
3(u, v)^{w}+(u, v)^{w \sigma}, & \text { if } \varepsilon=1 .\end{cases}
\end{gathered}
$$

It easily follows by induction on the length of $w$ that for all real numbers $u_{1}, v_{1}, u_{2}, v_{2}, \lambda_{1}$ and $\lambda_{2}$


\begin{equation*}
\left(\lambda_{1} u_{1}+\lambda_{2} u_{2}, \lambda_{1} v_{1}+\lambda_{2} v_{2}\right)^{w}=\lambda_{1}\left(u_{1}, v_{1}\right)^{w}+\lambda_{2}\left(u_{2}, v_{2}\right)^{w} \tag{1}
\end{equation*}


and that for $\varepsilon \in\{0,1\}$


\begin{equation*}
(u, v)^{\varepsilon w}=\left(v,(u, v)^{\varepsilon}\right)^{w} \text {. } \tag{2}
\end{equation*}


Obviously, for $n \geq 1$ and $w=\varepsilon_{1} \ldots \varepsilon_{n-1}$, we have $a_{n}=(1,7)^{w}$ and $b_{n}=(1,7)^{\bar{w}}$. Thus it is sufficient to prove that


\begin{equation*}
(1,7)^{w}=(1,7)^{\bar{w}} \tag{3}
\end{equation*}


for each binary word $w$. We proceed by induction on the length of $w$. The assertion is obvious if $w$ has length 0 or 1 . Now let $w \sigma \varepsilon$ be a binary word of length $n \geq 2$ and suppose that the assertion is true for all binary words of length at most $n-1$.\\
Note that $(2,1)^{\sigma}=7=(1,7)^{\emptyset}$ for $\sigma \in\{0,1\},(1,7)^{0}=23$, and $(1,7)^{1}=10$.\\
First let $\varepsilon=0$. Then in view of the induction hypothesis and the equalities (1) and (2), we obtain

$$
\begin{aligned}
&(1,7)^{w \sigma 0}=2(1,7)^{w}+3(1,7)^{w \sigma}=2(1,7)^{\bar{w}}+3(1,7)^{\sigma \bar{w}}=2(2,1)^{\sigma \bar{w}}+3(1,7)^{\sigma \bar{w}} \\
&=(7,23)^{\sigma \bar{w}}=(1,7)^{0 \sigma \bar{w}} .
\end{aligned}
$$

Now let $\varepsilon=1$. Analogously, we obtain

$$
\begin{aligned}
& (1,7)^{w \sigma 1}=3(1,7)^{w}+(1,7)^{w \sigma}=3(1,7)^{\bar{w}}+(1,7)^{\sigma \bar{w}}=3(2,1)^{\sigma \bar{w}}+(1,7)^{\sigma \bar{w}} \\
& =(7,10)^{\sigma \bar{w}}=(1,7)^{1 \sigma \bar{w}} .
\end{aligned}
$$

Thus the induction step is complete, (3) and hence also $a_{n}=b_{n}$ are proved.

Comment. The original solution uses the relation

$$
(1,7)^{\alpha \beta w}=\left((1,7)^{w},(1,7)^{\beta w}\right)^{\alpha}, \quad \alpha, \beta \in\{0,1\},
$$

which can be proved by induction on the length of $w$. Then (3) also follows by induction on the length of $w$ :

$$
(1,7)^{\alpha \beta w}=\left((1,7)^{w},(1,7)^{\beta w}\right)^{\alpha}=\left((1,7)^{\bar{w}},(1,7)^{\bar{w} \beta}\right)^{\alpha}=(1,7)^{\bar{w} \beta \alpha} .
$$

Here $w$ may be the empty word.",378,3
2009c7,"A grasshopper jumps along the real axis. He starts at point 0 and makes 2009 jumps to the right with lengths $1,2, \ldots, 2009$ in an arbitrary order. Let $M$ be a set of 2008 positive integers less than $1005 \cdot 2009$. Prove that the grasshopper can arrange his jumps in such a way that he never lands on a point from $M$.","We construct the set of landing points of the grasshopper.\\
Case 1. $M$ does not contain numbers divisible by 2009.\\
We fix the numbers $2009 k$ as landing points, $k=1,2, \ldots, 1005$. Consider the open intervals $I_{k}=(2009(k-1), 2009 k), k=1,2, \ldots, 1005$. We show that we can choose exactly one point outside of $M$ as a landing point in 1004 of these intervals such that all lengths from 1 to 2009 are realized. Since there remains one interval without a chosen point, the length 2009 indeed will appear. Each interval has length 2009, hence a new landing point in an interval yields with a length $d$ also the length $2009-d$. Thus it is enough to implement only the lengths from $D=\{1,2, \ldots, 1004\}$. We will do this in a greedy way. Let $n_{k}, k=1,2, \ldots, 1005$, be the number of elements of $M$ that belong to the interval $I_{k}$. We order these numbers in a decreasing way, so let $p_{1}, p_{2}, \ldots, p_{1005}$ be a permutation of $\{1,2, \ldots, 1005\}$ such that $n_{p_{1}} \geq n_{p_{2}} \geq \cdots \geq n_{p_{1005}}$. In $I_{p_{1}}$ we do not choose a landing point. Assume that landing points have already been chosen in the intervals $I_{p_{2}}, \ldots, I_{p_{m}}$ and the lengths $d_{2}, \ldots, d_{m}$ from $D$ are realized, $m=1, \ldots, 1004$. We show that there is some $d \in D \backslash\left\{d_{2}, \ldots, d_{m}\right\}$ that can be implemented with a new landing point in $I_{p_{m+1}}$. Assume the contrary. Then the $1004-(m-1)$ other lengths are obstructed by the $n_{p_{m+1}}$ points of $M$ in $I_{p_{m+1}}$. Each length $d$ can be realized by two landing points, namely $2009\left(p_{m+1}-1\right)+d$ and $2009 p_{m+1}-d$, hence


\begin{equation*}
n_{p_{m+1}} \geq 2(1005-m) . \tag{1}
\end{equation*}


Moreover, since $|M|=2008=n_{1}+\cdots+n_{1005}$,


\begin{equation*}
2008 \geq n_{p_{1}}+n_{p_{2}}+\cdots+n_{p_{m+1}} \geq(m+1) n_{p_{m+1}} . \tag{2}
\end{equation*}


Consequently, by (1) and (2),

$$
2008 \geq 2(m+1)(1005-m) .
$$

The right hand side of the last inequality obviously attains its minimum for $m=1004$ and this minimum value is greater than 2008, a contradiction.

Case 2. $M$ does contain a number $\mu$ divisible by 2009 .\\
By the pigeonhole principle there exists some $r \in\{1, \ldots, 2008\}$ such that $M$ does not contain numbers with remainder $r$ modulo 2009. We fix the numbers $2009(k-1)+r$ as landing points, $k=1,2, \ldots, 1005$. Moreover, $1005 \cdot 2009$ is a landing point. Consider the open intervals\\
$I_{k}=(2009(k-1)+r, 2009 k+r), k=1,2, \ldots, 1004$. Analogously to Case 1 , it is enough to show that we can choose in 1003 of these intervals exactly one landing point outside of $M \backslash\{\mu\}$ such that each of the lengths of $D=\{1,2, \ldots, 1004\} \backslash\{r\}$ are implemented. Note that $r$ and $2009-r$ are realized by the first and last jump and that choosing $\mu$ would realize these two differences again. Let $n_{k}, k=1,2, \ldots, 1004$, be the number of elements of $M \backslash\{\mu\}$ that belong to the interval $I_{k}$ and $p_{1}, p_{2}, \ldots, p_{1004}$ be a permutation of $\{1,2, \ldots, 1004\}$ such that $n_{p_{1}} \geq n_{p_{2}} \geq \cdots \geq n_{p_{1004}}$. With the same reasoning as in Case 1 we can verify that a greedy choice of the landing points in $I_{p_{2}}, I_{p_{3}}, \ldots, I_{p_{1004}}$ is possible. We only have to replace (1) by

$$
n_{p_{m+1}} \geq 2(1004-m)
$$

( $D$ has one element less) and (2) by

$$
2007 \geq n_{p_{1}}+n_{p_{2}}+\cdots+n_{p_{m+1}} \geq(m+1) n_{p_{m+1}} .
$$

Comment. The cardinality 2008 of $M$ in the problem is the maximum possible value. For $M=\{1,2, \ldots, 2009\}$, the grasshopper necessarily lands on a point from $M$.",575,4
2009c8,"For any integer $n \geq 2$, we compute the integer $h(n)$ by applying the following procedure to its decimal representation. Let $r$ be the rightmost digit of $n$.\\
(1) If $r=0$, then the decimal representation of $h(n)$ results from the decimal representation of $n$ by removing this rightmost digit 0 .\\
(2) If $1 \leq r \leq 9$ we split the decimal representation of $n$ into a maximal right part $R$ that solely consists of digits not less than $r$ and into a left part $L$ that either is empty or ends with a digit strictly smaller than $r$. Then the decimal representation of $h(n)$ consists of the decimal representation of $L$, followed by two copies of the decimal representation of $R-1$. For instance, for the number $n=17,151,345,543$, we will have $L=17,151, R=345,543$ and $h(n)=17,151,345,542,345,542$.\\
Prove that, starting with an arbitrary integer $n \geq 2$, iterated application of $h$ produces the integer 1 after finitely many steps.","We identify integers $n \geq 2$ with the digit-strings, briefly strings, of their decimal representation and extend the definition of $h$ to all non-empty strings with digits from 0 to 9. We recursively define ten functions $f_{0}, \ldots, f_{9}$ that map some strings into integers for $k=$ $9,8, \ldots, 1,0$. The function $f_{9}$ is only defined on strings $x$ (including the empty string $\varepsilon$ ) that entirely consist of nines. If $x$ consists of $m$ nines, then $f_{9}(x)=m+1, m=0,1, \ldots$. For $k \leq 8$, the domain of $f_{k}(x)$ is the set of all strings consisting only of digits that are $\geq k$. We write $x$ in the form $x_{0} k x_{1} k x_{2} k \ldots x_{m-1} k x_{m}$ where the strings $x_{s}$ only consist of digits $\geq k+1$. Note that some of these strings might equal the empty string $\varepsilon$ and that $m=0$ is possible, i.e. the digit $k$ does not appear in $x$. Then we define

$$
f_{k}(x)=\sum_{s=0}^{m} 4^{f_{k+1}\left(x_{s}\right)} .
$$

We will use the following obvious fact:\\
Fact 1. If $x$ does not contain digits smaller than $k$, then $f_{i}(x)=4^{f_{i+1}(x)}$ for all $i=0, \ldots, k-1$. In particular, $f_{i}(\varepsilon)=4^{9-i}$ for all $i=0,1, \ldots, 9$.\\
Moreover, by induction on $k=9,8, \ldots, 0$ it follows easily:\\
Fact 2. If the nonempty string $x$ does not contain digits smaller than $k$, then $f_{i}(x)>f_{i}(\varepsilon)$ for all $i=0, \ldots, k$.\\
We will show the essential fact:\\
Fact 3. $f_{0}(n)>f_{0}(h(n))$.\\
Then the empty string will necessarily be reached after a finite number of applications of $h$. But starting from a string without leading zeros, $\varepsilon$ can only be reached via the strings $1 \rightarrow 00 \rightarrow 0 \rightarrow \varepsilon$. Hence also the number 1 will appear after a finite number of applications of $h$.\\
Proof of Fact 3. If the last digit $r$ of $n$ is 0 , then we write $n=x_{0} 0 \ldots 0 x_{m-1} 0 \varepsilon$ where the $x_{i}$ do not contain the digit 0 . Then $h(n)=x_{0} 0 \ldots 0 x_{m-1}$ and $f_{0}(n)-f_{0}(h(n))=f_{0}(\varepsilon)>0$.\\
So let the last digit $r$ of $n$ be at least 1 . Let $L=y k$ and $R=z r$ be the corresponding left and right parts where $y$ is some string, $k \leq r-1$ and the string $z$ consists only of digits not less\\
than $r$. Then $n=y k z r$ and $h(n)=y k z(r-1) z(r-1)$. Let $d(y)$ be the smallest digit of $y$. We consider two cases which do not exclude each other.

Case 1. $d(y) \geq k$.\\
Then

$$
f_{k}(n)-f_{k}(h(n))=f_{k}(z r)-f_{k}(z(r-1) z(r-1)) .
$$

In view of Fact 1 this difference is positive if and only if

$$
f_{r-1}(z r)-f_{r-1}(z(r-1) z(r-1))>0 .
$$

We have, using Fact 2,

$$
f_{r-1}(z r)=4^{f_{r}(z r)}=4^{f_{r}(z)+4^{f_{r+1}(\varepsilon)}} \geq 4 \cdot 4^{f_{r}(z)}>4^{f_{r}(z)}+4^{f_{r}(z)}+4^{f_{r}(\varepsilon)}=f_{r-1}(z(r-1) z(r-1)) .
$$

Here we use the additional definition $f_{10}(\varepsilon)=0$ if $r=9$. Consequently, $f_{k}(n)-f_{k}(h(n))>0$ and according to Fact $1, f_{0}(n)-f_{0}(h(n))>0$.\\
Case 2. $d(y) \leq k$.\\
We prove by induction on $d(y)=k, k-1, \ldots, 0$ that $f_{i}(n)-f_{i}(h(n))>0$ for all $i=0, \ldots, d(y)$. By Fact 1 , it suffices to do so for $i=d(y)$. The initialization $d(y)=k$ was already treated in Case 1. Let $t=d(y)<k$. Write $y$ in the form $u t v$ where $v$ does not contain digits $\leq t$. Then, in view of the induction hypothesis,

$$
f_{t}(n)-f_{t}(h(n))=f_{t}(v k z r)-f_{t}(v k z(r-1) z(r-1))=4^{f_{t+1}(v k z r)}-4^{f_{t+1}(v k z(r-1) z(r-1))}>0 .
$$

Thus the inequality $f_{d(y)}(n)-f_{d(y)}(h(n))>0$ is established and from Fact 1 it follows that $f_{0}(n)-f_{0}(h(n))>0$.",565,4
2009g2,"Let $A B C$ be a triangle with circumcenter $O$. The points $P$ and $Q$ are interior points of the sides $C A$ and $A B$, respectively. The circle $k$ passes through the midpoints of the segments $B P$, $C Q$, and $P Q$. Prove that if the line $P Q$ is tangent to circle $k$ then $O P=O Q$.","Let $K, L, M, B^{\prime}, C^{\prime}$ be the midpoints of $B P, C Q, P Q, C A$, and $A B$, respectively (see Figure 1). Since $C A \| L M$, we have $\angle L M P=\angle Q P A$. Since $k$ touches the segment $P Q$ at $M$, we find $\angle L M P=\angle L K M$. Thus $\angle Q P A=\angle L K M$. Similarly it follows from $A B \| M K$ that $\angle P Q A=\angle K L M$. Therefore, triangles $A P Q$ and $M K L$ are similar, hence

\begin{equation*}
\frac{A P}{A Q}=\frac{M K}{M L}=\frac{\frac{Q B}{2}}{\frac{P C}{2}}=\frac{Q B}{P C} . \tag{1}
\end{equation*}

Now (1) is equivalent to $A P \cdot P C=A Q \cdot Q B$ which means that the power of points $P$ and $Q$ with respect to the circumcircle of $\triangle A B C$ are equal, hence $O P=O Q$.\\",148,2
2009g3,"Let $A B C$ be a triangle. The incircle of $A B C$ touches the sides $A B$ and $A C$ at the points $Z$ and $Y$, respectively. Let $G$ be the point where the lines $B Y$ and $C Z$ meet, and let $R$ and $S$ be points such that the two quadrilaterals $B C Y R$ and $B C S Z$ are parallelograms.\\
Prove that $G R=G S$.","Denote $x=A Z=A Y, y=B Z=B X, z=C X=C Y, p=Z G, q=G C$. Several lengthy calculations (Menelaos' theorem in triangle $A Z C$, law of Cosines in triangles $A B C$ and $A Z C$ and Stewart's theorem in triangle $Z C S$ ) give four equations for $p, q, \cos \alpha$\\
and $G S$ in terms of $x, y$, and $z$ that can be resolved for $G S$. The result is symmetric in $y$ and $z$, so $G R=G S$. More in detail this means:\\
The line $B Y$ intersects the sides of triangle $A Z C$, so Menelaos' theorem yields $\frac{p}{q} \cdot \frac{z}{x} \cdot \frac{x+y}{y}=1$, hence

\begin{equation*}
\frac{p}{q}=\frac{x y}{y z+z x} . \tag{1}
\end{equation*}

Since we only want to show that the term for $G S$ is symmetric in $y$ and $z$, we abbreviate terms that are symmetric in $y$ and $z$ by capital letters, starting with $N=x y+y z+z x$. So (1) implies

\begin{equation*}
\frac{p}{p+q}=\frac{x y}{x y+y z+z x}=\frac{x y}{N} \quad \text { and } \quad \frac{q}{p+q}=\frac{y z+z x}{x y+y z+z x}=\frac{y z+z x}{N} . \tag{2}
\end{equation*}

Now the law of Cosines in triangle $A B C$ yields

$$
\cos \alpha=\frac{(x+y)^{2}+(x+z)^{2}-(y+z)^{2}}{2(x+y)(x+z)}=\frac{2 x^{2}+2 x y+2 x z-2 y z}{2(x+y)(x+z)}=1-\frac{2 y z}{(x+y)(x+z)} .
$$

We use this result to apply the law of Cosines in triangle $A Z C$ :

\begin{align*}
(p+q)^{2} & =x^{2}+(x+z)^{2}-2 x(x+z) \cos \alpha \\
& =x^{2}+(x+z)^{2}-2 x(x+z) \cdot\left(1-\frac{2 y z}{(x+y)(x+z)}\right) \\
& =z^{2}+\frac{4 x y z}{x+y} . \tag{3}
\end{align*}

Now in triangle $Z C S$ the segment $G S$ is a cevian, so with Stewart's theorem we have $p y^{2}+q(y+z)^{2}=(p+q)\left(G S^{2}+p q\right)$, hence

$$
G S^{2}=\frac{p}{p+q} \cdot y^{2}+\frac{q}{p+q} \cdot(y+z)^{2}-\frac{p}{p+q} \cdot \frac{q}{p+q} \cdot(p+q)^{2} .
$$

Replacing the $p$ 's and $q$ 's herein by (2) and (3) yields

$$
\begin{aligned}
G S^{2} & =\frac{x y}{N} y^{2}+\frac{y z+z x}{N}(y+z)^{2}-\frac{x y}{N} \cdot \frac{y z+z x}{N} \cdot\left(z^{2}+\frac{4 x y z}{x+y}\right) \\
& =\frac{x y^{3}}{N}+\underbrace{\frac{y z(y+z)^{2}}{N}}_{M_{1}}+\frac{z x(y+z)^{2}}{N}-\frac{x y z^{3}(x+y)}{N^{2}}-\underbrace{\frac{4 x^{2} y^{2} z^{2}}{N^{2}}}_{M_{2}} \\
& =\frac{x y^{3}+z x(y+z)^{2}}{N}-\frac{x y z^{3}(x+y)}{N^{2}}+M_{1}-M_{2} \\
& =\underbrace{\frac{x\left(y^{3}+y^{2} z+y z^{2}+z^{3}\right)}{N}+\frac{x y z^{2} N}{N^{2}}-\frac{x y z^{3}(x+y)}{N^{2}}+M_{1}-M_{2}}_{M_{3}} \\
& =\frac{x^{2} y^{2} z^{2}+x y^{2} z^{3}+x^{2} y z^{3}-x^{2} y z^{3}-x y^{2} z^{3}}{N^{2}}+M_{1}-M_{2}+M_{3} \\
& =\frac{x^{2} y^{2} z^{2}}{N^{2}}+M_{1}-M_{2}+M_{3},
\end{aligned}
$$

a term that is symmetric in $y$ and $z$, indeed.",370,3
2009g4,"Given a cyclic quadrilateral $A B C D$, let the diagonals $A C$ and $B D$ meet at $E$ and the lines $A D$ and $B C$ meet at $F$. The midpoints of $A B$ and $C D$ are $G$ and $H$, respectively. Show that $E F$ is tangent at $E$ to the circle through the points $E, G$, and $H$.","It suffices to show that $\angle H E F=\angle H G E$ (see Figure 1), since in circle $E G H$ the angle over the chord $E H$ at $G$ equals the angle between the tangent at $E$ and $E H$.\\
First, $\angle B A D=180^{\circ}-\angle D C B=\angle F C D$. Since triangles $F A B$ and $F C D$ have also a common interior angle at $F$, they are similar.\\

Denote by $\mathcal{T}$ the transformation consisting of a reflection at the bisector of $\angle D F C$ followed by a dilation with center $F$ and factor of $\frac{F A}{F C}$. Then $\mathcal{T}$ maps $F$ to $F, C$ to $A, D$ to $B$, and $H$ to $G$. To see this, note that $\triangle F C A \sim \triangle F D B$, so $\frac{F A}{F C}=\frac{F B}{F D}$. Moreover, as $\angle A D B=\angle A C B$, the image of the line $D E$ under $\mathcal{T}$ is parallel to $A C$ (and passes through $B$ ) and similarly the image of $C E$ is parallel to $D B$ and passes through $A$. Hence $E$ is mapped to the point $X$ which is the fourth vertex of the parallelogram $B E A X$. Thus, in particular $\angle H E F=\angle F X G$.\\
As $G$ is the midpoint of the diagonal $A B$ of the parallelogram $B E A X$, it is also the midpoint of $E X$. In particular, $E, G, X$ are collinear, and $E X=2 \cdot E G$.\\
Denote by $Y$ the fourth vertex of the parallelogram $D E C Y$. By an analogous reasoning as before, it follows that $\mathcal{T}$ maps $Y$ to $E$, thus $E, H, Y$ are collinear with $E Y=2 \cdot E H$. Therefore, by the intercept theorem, $H G \| X Y$.\\
From the construction of $\mathcal{T}$ it is clear that the lines $F X$ and $F E$ are symmetric with respect to the bisector of $\angle D F C$, as are $F Y$ and $F E$. Thus, $F, X, Y$ are collinear, which together with $H G \| X Y$ implies $\angle F X E=\angle H G E$. This completes the proof.
",360,3
2009g5,"Let $P$ be a polygon that is convex and symmetric to some point $O$. Prove that for some parallelogram $R$ satisfying $P \subset R$ we have

$$
\frac{|R|}{|P|} \leq \sqrt{2}
$$

where $|R|$ and $|P|$ denote the area of the sets $R$ and $P$, respectively.","We will construct two parallelograms $R_{1}$ and $R_{3}$, each of them containing $P$, and prove that at least one of the inequalities $\left|R_{1}\right| \leq \sqrt{2}|P|$ and $\left|R_{3}\right| \leq \sqrt{2}|P|$ holds.\\
First we will construct a parallelogram $R_{1} \supseteq P$ with the property that the midpoints of the sides of $R_{1}$ are points of the boundary of $P$.\\
Choose two points $A$ and $B$ of $P$ such that the triangle $O A B$ has maximal area. Let $a$ be the line through $A$ parallel to $O B$ and $b$ the line through $B$ parallel to $O A$. Let $A^{\prime}, B^{\prime}, a^{\prime}$ and $b^{\prime}$ be the points or lines, that are symmetric to $A, B, a$ and $b$, respectively, with respect to $O$. Now let $R_{1}$ be the parallelogram defined by $a, b, a^{\prime}$ and $b^{\prime}$.\\

Obviously, $A$ and $B$ are located on the boundary of the polygon $P$, and $A, B, A^{\prime}$ and $B^{\prime}$ are midpoints of the sides of $R_{1}$. We note that $P \subseteq R_{1}$. Otherwise, there would be a point $Z \in P$ but $Z \notin R_{1}$, i.e., one of the lines $a, b, a^{\prime}$ or $b^{\prime}$ were between $O$ and $Z$. If it is $a$, we have $|O Z B|>|O A B|$, which is contradictory to the choice of $A$ and $B$. If it is one of the lines $b, a^{\prime}$ or $b^{\prime}$ almost identical arguments lead to a similar contradiction.\\
Let $R_{2}$ be the parallelogram $A B A^{\prime} B^{\prime}$. Since $A$ and $B$ are points of $P$, segment $A B \subset P$ and so $R_{2} \subset R_{1}$. Since $A, B, A^{\prime}$ and $B^{\prime}$ are midpoints of the sides of $R_{1}$, an easy argument yields

\begin{equation*}
\left|R_{1}\right|=2 \cdot\left|R_{2}\right| . \tag{1}
\end{equation*}

Let $R_{3}$ be the smallest parallelogram enclosing $P$ defined by lines parallel to $A B$ and $B A^{\prime}$. Obviously $R_{2} \subset R_{3}$ and every side of $R_{3}$ contains at least one point of the boundary of $P$. Denote by $C$ the intersection point of $a$ and $b$, by $X$ the intersection point of $A B$ and $O C$, and by $X^{\prime}$ the intersection point of $X C$ and the boundary of $R_{3}$. In a similar way denote by $D$\\
the intersection point of $b$ and $a^{\prime}$, by $Y$ the intersection point of $A^{\prime} B$ and $O D$, and by $Y^{\prime}$ the intersection point of $Y D$ and the boundary of $R_{3}$.\\
Note that $O C=2 \cdot O X$ and $O D=2 \cdot O Y$, so there exist real numbers $x$ and $y$ with $1 \leq x, y \leq 2$ and $O X^{\prime}=x \cdot O X$ and $O Y^{\prime}=y \cdot O Y$. Corresponding sides of $R_{3}$ and $R_{2}$ are parallel which yields

\begin{equation*}
\left|R_{3}\right|=x y \cdot\left|R_{2}\right| . \tag{2}
\end{equation*}

The side of $R_{3}$ containing $X^{\prime}$ contains at least one point $X^{*}$ of $P$; due to the convexity of $P$ we have $A X^{*} B \subset P$. Since this side of the parallelogram $R_{3}$ is parallel to $A B$ we have $\left|A X^{*} B\right|=\left|A X^{\prime} B\right|$, so $\left|O A X^{\prime} B\right|$ does not exceed the area of $P$ confined to the sector defined by the rays $O B$ and $O A$. In a similar way we conclude that $\left|O B^{\prime} Y^{\prime} A^{\prime}\right|$ does not exceed the area of $P$ confined to the sector defined by the rays $O B$ and $O A^{\prime}$. Putting things together we have $\left|O A X^{\prime} B\right|=x \cdot|O A B|,\left|O B D A^{\prime}\right|=y \cdot\left|O B A^{\prime}\right|$. Since $|O A B|=\left|O B A^{\prime}\right|$, we conclude that $|P| \geq 2 \cdot\left|A X^{\prime} B Y^{\prime} A^{\prime}\right|=2 \cdot\left(x \cdot|O A B|+y \cdot\left|O B A^{\prime}\right|\right)=4 \cdot \frac{x+y}{2} \cdot|O A B|=\frac{x+y}{2} \cdot R_{2}$; this is in short

\begin{equation*}
\frac{x+y}{2} \cdot\left|R_{2}\right| \leq|P| \text {. } \tag{3}
\end{equation*}

Since all numbers concerned are positive, we can combine (1)-(3). Using the arithmetic-geometric-mean inequality we obtain

$$
\left|R_{1}\right| \cdot\left|R_{3}\right|=2 \cdot\left|R_{2}\right| \cdot x y \cdot\left|R_{2}\right| \leq 2 \cdot\left|R_{2}\right|^{2}\left(\frac{x+y}{2}\right)^{2} \leq 2 \cdot|P|^{2} .
$$

This implies immediately the desired result $\left|R_{1}\right| \leq \sqrt{2} \cdot|P|$ or $\left|R_{3}\right| \leq \sqrt{2} \cdot|P|$.",663,4
2009g6,"Let the sides $A D$ and $B C$ of the quadrilateral $A B C D$ (such that $A B$ is not parallel to $C D$ ) intersect at point $P$. Points $O_{1}$ and $O_{2}$ are the circumcenters and points $H_{1}$ and $H_{2}$ are the orthocenters of triangles $A B P$ and $D C P$, respectively. Denote the midpoints of segments $O_{1} H_{1}$ and $O_{2} H_{2}$ by $E_{1}$ and $E_{2}$, respectively. Prove that the perpendicular from $E_{1}$ on $C D$, the perpendicular from $E_{2}$ on $A B$ and the line $H_{1} H_{2}$ are concurrent.","We keep triangle $A B P$ fixed and move the line $C D$ parallel to itself uniformly, i.e. linearly dependent on a single parameter $\lambda$ (see Figure 1). Then the points $C$ and $D$ also move uniformly. Hence, the points $O_{2}, H_{2}$ and $E_{2}$ move uniformly, too. Therefore also the perpendicular from $E_{2}$ on $A B$ moves uniformly. Obviously, the points $O_{1}, H_{1}, E_{1}$ and the perpendicular from $E_{1}$ on $C D$ do not move at all. Hence, the intersection point $S$ of these two perpendiculars moves uniformly. Since $H_{1}$ does not move, while $H_{2}$ and $S$ move uniformly along parallel lines (both are perpendicular to $C D$ ), it is sufficient to prove their collinearity for two different positions of $C D$.\\

Let $C D$ pass through either point $A$ or point $B$. Note that by hypothesis these two cases are different. We will consider the case $A \in C D$, i.e. $A=D$. So we have to show that the perpendiculars from $E_{1}$ on $A C$ and from $E_{2}$ on $A B$ intersect on the altitude $A H$ of triangle $A B C$ (see Figure 2).\\

To this end, we consider the midpoints $A_{1}, B_{1}, C_{1}$ of $B C, C A, A B$, respectively. As $E_{1}$ is the center of Feuerbach's circle (nine-point circle) of $\triangle A B P$, we have $E_{1} C_{1}=E_{1} H$. Similarly, $E_{2} B_{1}=E_{2} H$. Note further that a point $X$ lies on the perpendicular from $E_{1}$ on $A_{1} C_{1}$ if and only if

$$
X C_{1}^{2}-X A_{1}^{2}=E_{1} C_{1}^{2}-E_{1} A_{1}^{2} .
$$

Similarly, the perpendicular from $E_{2}$ on $A_{1} B_{1}$ is characterized by

$$
X A_{1}^{2}-X B_{1}^{2}=E_{2} A_{1}^{2}-E_{2} B_{1}^{2} .
$$

The line $H_{1} H_{2}$, which is perpendicular to $B_{1} C_{1}$ and contains $A$, is given by

$$
X B_{1}^{2}-X C_{1}^{2}=A B_{1}^{2}-A C_{1}^{2} .
$$

The three lines are concurrent if and only if

$$
\begin{aligned}
0 & =X C_{1}^{2}-X A_{1}^{2}+X A_{1}^{2}-X B_{1}^{2}+X B_{1}^{2}-X C_{1}^{2} \\
& =E_{1} C_{1}^{2}-E_{1} A_{1}^{2}+E_{2} A_{1}^{2}-E_{2} B_{1}^{2}+A B_{1}^{2}-A C_{1}^{2} \\
& =-E_{1} A_{1}^{2}+E_{2} A_{1}^{2}+E_{1} H^{2}-E_{2} H^{2}+A B_{1}^{2}-A C_{1}^{2},
\end{aligned}
$$

i.e. it suffices to show that

$$
E_{1} A_{1}^{2}-E_{2} A_{1}^{2}-E_{1} H^{2}+E_{2} H^{2}=\frac{A C^{2}-A B^{2}}{4} .
$$

We have

$$
\frac{A C^{2}-A B^{2}}{4}=\frac{H C^{2}-H B^{2}}{4}=\frac{(H C+H B)(H C-H B)}{4}=\frac{H A_{1} \cdot B C}{2} .
$$

Let $F_{1}, F_{2}$ be the projections of $E_{1}, E_{2}$ on $B C$. Obviously, these are the midpoints of $H P_{1}$,\\
$H P_{2}$, where $P_{1}, P_{2}$ are the midpoints of $P B$ and $P C$ respectively. Then

$$
\begin{aligned}
& E_{1} A_{1}^{2}-E_{2} A_{1}^{2}-E_{1} H^{2}+E_{2} H^{2} \\
& =F_{1} A_{1}^{2}-F_{1} H^{2}-F_{2} A_{1}^{2}+F_{2} H^{2} \\
& =\left(F_{1} A_{1}-F_{1} H\right)\left(F_{1} A_{1}+F_{1} H\right)-\left(F_{2} A_{1}-F_{2} H\right)\left(F_{2} A_{1}+F_{2} H\right) \\
& =A_{1} H \cdot\left(A_{1} P_{1}-A_{1} P_{2}\right) \\
& =\frac{A_{1} H \cdot B C}{2} \\
& =\frac{A C^{2}-A B^{2}}{4},
\end{aligned}
$$

which proves the claim.",460,3
2009g7,"Let $A B C$ be a triangle with incenter $I$ and let $X, Y$ and $Z$ be the incenters of the triangles $B I C, C I A$ and $A I B$, respectively. Let the triangle $X Y Z$ be equilateral. Prove that $A B C$ is equilateral too.","Solution. $A Z, A I$ and $A Y$ divide $\angle B A C$ into four equal angles; denote them by $\alpha$. In the same way we have four equal angles $\beta$ at $B$ and four equal angles $\gamma$ at $C$. Obviously $\alpha+\beta+\gamma=\frac{180^{\circ}}{4}=45^{\circ}$; and $0^{\circ}<\alpha, \beta, \gamma<45^{\circ}$.\\
\includegraphics[max width=\textwidth, center]{2025_05_05_fd167e6e88a82c9be624g-66}

Easy calculations in various triangles yield $\angle B I C=180^{\circ}-2 \beta-2 \gamma=180^{\circ}-\left(90^{\circ}-2 \alpha\right)=$ $90^{\circ}+2 \alpha$, hence (for $X$ is the incenter of triangle $B C I$, so $I X$ bisects $\angle B I C$ ) we have $\angle X I C=$ $\angle B I X=\frac{1}{2} \angle B I C=45^{\circ}+\alpha$ and with similar aguments $\angle C I Y=\angle Y I A=45^{\circ}+\beta$ and $\angle A I Z=\angle Z I B=45^{\circ}+\gamma$. Furthermore, we have $\angle X I Y=\angle X I C+\angle C I Y=\left(45^{\circ}+\alpha\right)+$ $\left(45^{\circ}+\beta\right)=135^{\circ}-\gamma, \angle Y I Z=135^{\circ}-\alpha$, and $\angle Z I X=135^{\circ}-\beta$.\\
Now we calculate the lengths of $I X, I Y$ and $I Z$ in terms of $\alpha, \beta$ and $\gamma$. The perpendicular from $I$ on $C X$ has length $I X \cdot \sin \angle C X I=I X \cdot \sin \left(90^{\circ}+\beta\right)=I X \cdot \cos \beta$. But $C I$ bisects $\angle Y C X$, so the perpendicular from $I$ on $C Y$ has the same length, and we conclude

$$
I X \cdot \cos \beta=I Y \cdot \cos \alpha
$$

To make calculations easier we choose a length unit that makes $I X=\cos \alpha$. Then $I Y=\cos \beta$ and with similar arguments $I Z=\cos \gamma$.\\
Since $X Y Z$ is equilateral we have $Z X=Z Y$. The law of Cosines in triangles $X Y I, Y Z I$ yields

$$
\begin{aligned}
& Z X^{2}=Z Y^{2} \\
\Longrightarrow & I Z^{2}+I X^{2}-2 \cdot I Z \cdot I X \cdot \cos \angle Z I X=I Z^{2}+I Y^{2}-2 \cdot I Z \cdot I Y \cdot \cos \angle Y I Z \\
\Longrightarrow & I X^{2}-I Y^{2}=2 \cdot I Z \cdot(I X \cdot \cos \angle Z I X-I Y \cdot \cos \angle Y I Z) \\
\Longrightarrow & \underbrace{\cos ^{2} \alpha-\cos ^{2} \beta}_{\text {L.H.S. }}=\underbrace{2 \cdot \cos \gamma \cdot\left(\cos \alpha \cdot \cos \left(135^{\circ}-\beta\right)-\cos \beta \cdot \cos \left(135^{\circ}-\alpha\right)\right)}_{\text {R.H.S. }} .
\end{aligned}
$$

A transformation of the left-hand side (L.H.S.) yields

$$
\begin{aligned}
\text { L.H.S. } & =\cos ^{2} \alpha \cdot\left(\sin ^{2} \beta+\cos ^{2} \beta\right)-\cos ^{2} \beta \cdot\left(\sin ^{2} \alpha+\cos ^{2} \alpha\right) \\
& =\cos ^{2} \alpha \cdot \sin ^{2} \beta-\cos ^{2} \beta \cdot \sin ^{2} \alpha
\end{aligned}
$$

$$
\begin{aligned}
& =(\cos \alpha \cdot \sin \beta+\cos \beta \cdot \sin \alpha) \cdot(\cos \alpha \cdot \sin \beta-\cos \beta \cdot \sin \alpha) \\
& =\sin (\beta+\alpha) \cdot \sin (\beta-\alpha)=\sin \left(45^{\circ}-\gamma\right) \cdot \sin (\beta-\alpha)
\end{aligned}
$$

whereas a transformation of the right-hand side (R.H.S.) leads to

$$
\begin{aligned}
\text { R.H.S. } & =2 \cdot \cos \gamma \cdot\left(\cos \alpha \cdot\left(-\cos \left(45^{\circ}+\beta\right)\right)-\cos \beta \cdot\left(-\cos \left(45^{\circ}+\alpha\right)\right)\right) \\
& =2 \cdot \frac{\sqrt{2}}{2} \cdot \cos \gamma \cdot(\cos \alpha \cdot(\sin \beta-\cos \beta)+\cos \beta \cdot(\cos \alpha-\sin \alpha)) \\
& =\sqrt{2} \cdot \cos \gamma \cdot(\cos \alpha \cdot \sin \beta-\cos \beta \cdot \sin \alpha) \\
& =\sqrt{2} \cdot \cos \gamma \cdot \sin (\beta-\alpha)
\end{aligned}
$$

Equating L.H.S. and R.H.S. we obtain

$$
\begin{aligned}
& \sin \left(45^{\circ}-\gamma\right) \cdot \sin (\beta-\alpha)=\sqrt{2} \cdot \cos \gamma \cdot \sin (\beta-\alpha) \\
\Longrightarrow & \sin (\beta-\alpha) \cdot\left(\sqrt{2} \cdot \cos \gamma-\sin \left(45^{\circ}-\gamma\right)\right)=0 \\
\Longrightarrow & \alpha=\beta \quad \text { or } \quad \sqrt{2} \cdot \cos \gamma=\sin \left(45^{\circ}-\gamma\right)
\end{aligned}
$$

But $\gamma<45^{\circ}$; so $\sqrt{2} \cdot \cos \gamma>\cos \gamma>\cos 45^{\circ}=\sin 45^{\circ}>\sin \left(45^{\circ}-\gamma\right)$. This leaves $\alpha=\beta$. With similar reasoning we have $\alpha=\gamma$, which means triangle $A B C$ must be equilateral.",585,4
2009g8,"Let $A B C D$ be a circumscribed quadrilateral. Let $g$ be a line through $A$ which meets the segment $B C$ in $M$ and the line $C D$ in $N$. Denote by $I_{1}, I_{2}$, and $I_{3}$ the incenters of $\triangle A B M$, $\triangle M N C$, and $\triangle N D A$, respectively. Show that the orthocenter of $\triangle I_{1} I_{2} I_{3}$ lies on $g$.","Let $k_{1}, k_{2}$ and $k_{3}$ be the incircles of triangles $A B M, M N C$, and $N D A$, respectively (see Figure 1). We shall show that the tangent $h$ from $C$ to $k_{1}$ which is different from $C B$ is also tangent to $k_{3}$.\\

To this end, let $X$ denote the point of intersection of $g$ and $h$. Then $A B C X$ and $A B C D$ are circumscribed quadrilaterals, whence

$$
C D-C X=(A B+C D)-(A B+C X)=(B C+A D)-(B C+A X)=A D-A X,
$$

i.e.

$$
A X+C D=C X+A D
$$

which in turn reveals that the quadrilateral $A X C D$ is also circumscribed. Thus $h$ touches indeed the circle $k_{3}$.\\
Moreover, we find that $\angle I_{3} C I_{1}=\angle I_{3} C X+\angle X C I_{1}=\frac{1}{2}(\angle D C X+\angle X C B)=\frac{1}{2} \angle D C B=$ $\frac{1}{2}\left(180^{\circ}-\angle M C N\right)=180^{\circ}-\angle M I_{2} N=\angle I_{3} I_{2} I_{1}$, from which we conclude that $C, I_{1}, I_{2}, I_{3}$ are concyclic.\\
Let now $L_{1}$ and $L_{3}$ be the reflection points of $C$ with respect to the lines $I_{2} I_{3}$ and $I_{1} I_{2}$ respectively. Since $I_{1} I_{2}$ is the angle bisector of $\angle N M C$, it follows that $L_{3}$ lies on $g$. By analogous reasoning, $L_{1}$ lies on $g$.\\
Let $H$ be the orthocenter of $\triangle I_{1} I_{2} I_{3}$. We have $\angle I_{2} L_{3} I_{1}=\angle I_{1} C I_{2}=\angle I_{1} I_{3} I_{2}=180^{\circ}-\angle I_{1} H I_{2}$, which entails that the quadrilateral $I_{2} H I_{1} L_{3}$ is cyclic. Analogously, $I_{3} H L_{1} I_{2}$ is cyclic.

Then, working with oriented angles modulo $180^{\circ}$, we have

$$
\angle L_{3} H I_{2}=\angle L_{3} I_{1} I_{2}=\angle I_{2} I_{1} C=\angle I_{2} I_{3} C=\angle L_{1} I_{3} I_{2}=\angle L_{1} H I_{2},
$$

whence $L_{1}, L_{3}$, and $H$ are collinear. By $L_{1} \neq L_{3}$, the claim follows.",298,3
2009n1,"A social club has $n$ members. They have the membership numbers $1,2, \ldots, n$, respectively. From time to time members send presents to other members, including items they have already received as presents from other members. In order to avoid the embarrassing situation that a member might receive a present that he or she has sent to other members, the club adds the following rule to its statutes at one of its annual general meetings:\\
""A member with membership number $a$ is permitted to send a present to a member with membership number $b$ if and only if $a(b-1)$ is a multiple of $n$.""

Prove that, if each member follows this rule, none will receive a present from another member that he or she has already sent to other members.","Suppose there is an edge from $v_{i}$ to $v_{j}$. Then $i(j-1)=i j-i=k n$ for some integer $k$, which implies $i=i j-k n$. If $\operatorname{gcd}(i, n)=d$ and $\operatorname{gcd}(j, n)=e$, then $e$ divides $i j-k n=i$ and thus $e$ also divides $d$. Hence, if there is an edge from $v_{i}$ to $v_{j}$, then $\operatorname{gcd}(j, n) \mid \operatorname{gcd}(i, n)$.\\
If there is a cycle in $G$, say $v_{i_{1}} \rightarrow v_{i_{2}} \rightarrow \cdots \rightarrow v_{i_{r}} \rightarrow v_{i_{1}}$, then we have

$$
\operatorname{gcd}\left(i_{1}, n\right)\left|\operatorname{gcd}\left(i_{r}, n\right)\right| \operatorname{gcd}\left(i_{r-1}, n\right)|\ldots| \operatorname{gcd}\left(i_{2}, n\right) \mid \operatorname{gcd}\left(i_{1}, n\right),
$$

which implies that all these greatest common divisors must be equal, say be equal to $t$.\\
Now we pick any of the $i_{k}$, without loss of generality let it be $i_{1}$. Then $i_{r}\left(i_{1}-1\right)$ is a multiple of $n$ and hence also (by dividing by $t$ ), $i_{1}-1$ is a multiple of $\frac{n}{t}$. Since $i_{1}$ and $i_{1}-1$ are relatively prime, also $t$ and $\frac{n}{t}$ are relatively prime. So, by the Chinese remainder theorem, the value of $i_{1}$ is uniquely determined modulo $n=t \cdot \frac{n}{t}$ by the value of $t$. But, as $i_{1}$ was chosen arbitrarily among the $i_{k}$, this implies that all the $i_{k}$ have to be equal, a contradiction.",197,2
2009n2,"A positive integer $N$ is called balanced, if $N=1$ or if $N$ can be written as a product of an even number of not necessarily distinct primes. Given positive integers $a$ and $b$, consider the polynomial $P$ defined by $P(x)=(x+a)(x+b)$.\\
(a) Prove that there exist distinct positive integers $a$ and $b$ such that all the numbers $P(1), P(2)$, $\ldots, P(50)$ are balanced.\\
(b) Prove that if $P(n)$ is balanced for all positive integers $n$, then $a=b$.","Solution. Define a function $f$ on the set of positive integers by $f(n)=0$ if $n$ is balanced and $f(n)=1$ otherwise. Clearly, $f(n m) \equiv f(n)+f(m) \bmod 2$ for all positive integers $n, m$.\\
(a) Now for each positive integer $n$ consider the binary sequence $(f(n+1), f(n+2), \ldots, f(n+$ $50)$ ). As there are only $2^{50}$ different such sequences there are two different positive integers $a$ and $b$ such that

$$
(f(a+1), f(a+2), \ldots, f(a+50))=(f(b+1), f(b+2), \ldots, f(b+50)) .
$$

But this implies that for the polynomial $P(x)=(x+a)(x+b)$ all the numbers $P(1), P(2)$, $\ldots, P(50)$ are balanced, since for all $1 \leq k \leq 50$ we have $f(P(k)) \equiv f(a+k)+f(b+k) \equiv$ $2 f(a+k) \equiv 0 \bmod 2$.\\
(b) Now suppose $P(n)$ is balanced for all positive integers $n$ and $a<b$. Set $n=k(b-a)-a$ for sufficiently large $k$, such that $n$ is positive. Then $P(n)=k(k+1)(b-a)^{2}$, and this number can only be balanced, if $f(k)=f(k+1)$ holds. Thus, the sequence $f(k)$ must become constant for sufficiently large $k$. But this is not possible, as for every prime $p$ we have $f(p)=1$ and for every square $t^{2}$ we have $f\left(t^{2}\right)=0$.\\
Hence $a=b$.

Comment. Given a positive integer $k$, a computer search for the pairs of positive integers $(a, b)$, for which $P(1), P(2), \ldots, P(k)$ are all balanced yields the following results with minimal sum $a+b$ and $a<b$ :

\begin{center}
\begin{tabular}{|l|c|c|c|c|c|}
\hline
$k$ & 3 & 4 & 5 & 10 & 20 \\
\hline
$(a, b)$ & $(2,4)$ & $(6,11)$ & $(8,14)$ & $(20,34)$ & $(1751,3121)$ \\
\hline
\end{tabular}
\end{center}

Therefore, trying to find $a$ and $b$ in part (a) of the problem cannot be done by elementary calculations.",274,3
2009n3,"Let $f$ be a non-constant function from the set of positive integers into the set of positive integers, such that $a-b$ divides $f(a)-f(b)$ for all distinct positive integers $a, b$. Prove that there exist infinitely many primes $p$ such that $p$ divides $f(c)$ for some positive integer $c$.","Assume that there are only finitely many primes $p_{1}, p_{2}, \ldots, p_{m}$ that divide some function value of $f$. Since $f$ is not identically 1 , we must have $m \geq 1$.\\
Then there exist non-negative integers $\alpha_{1}, \ldots, \alpha_{m}$ such that

$$
f(1)=p_{1}^{\alpha_{1}} p_{2}^{\alpha_{2}} \ldots p_{m}^{\alpha_{m}} .
$$

We can pick a positive integer $r$ such that $f(r) \neq f(1)$. Let

$$
M=1+p_{1}^{\alpha_{1}+1} p_{2}^{\alpha_{2}+1} \ldots p_{m}^{\alpha_{m}+1} \cdot(f(r)+r) .
$$

Then for all $i \in\{1, \ldots, m\}$ we have that $p_{i}^{\alpha_{i}+1}$ divides $M-1$ and hence by the condition of the problem also $f(M)-f(1)$. This implies that $f(M)$ is divisible by $p_{i}^{\alpha_{i}}$ but not by $p_{i}^{\alpha_{i}+1}$ for all $i$ and therefore $f(M)=f(1)$.\\
Hence

$$
\begin{aligned}
M-r & >p_{1}^{\alpha_{1}+1} p_{2}^{\alpha_{2}+1} \ldots p_{m}^{\alpha_{m}+1} \cdot(f(r)+r)-r \\
& \geq p_{1}^{\alpha_{1}+1} p_{2}^{\alpha_{2}+1} \ldots p_{m}^{\alpha_{m}+1}+(f(r)+r)-r \\
& >p_{1}^{\alpha_{1}} p_{2}^{\alpha_{2}} \ldots p_{m}^{\alpha_{m}}+f(r) \\
& \geq|f(M)-f(r)| .
\end{aligned}
$$

But since $M-r$ divides $f(M)-f(r)$ this can only be true if $f(r)=f(M)=f(1)$, which contradicts the choice of $r$.
",158,2
2009n5,"Let $P(x)$ be a non-constant polynomial with integer coefficients. Prove that there is no function $T$ from the set of integers into the set of integers such that the number of integers $x$ with $T^{n}(x)=x$ is equal to $P(n)$ for every $n \geq 1$, where $T^{n}$ denotes the $n$-fold application of $T$.","Assume there is a polynomial $P$ of degree at least 1 with the desired property for a given function $T$. Let $A(n)$ denote the set of all $x \in \mathbb{Z}$ such that $T^{n}(x)=x$ and let $B(n)$ denote the set of all $x \in \mathbb{Z}$ for which $T^{n}(x)=x$ and $T^{k}(x) \neq x$ for all $1 \leq k<n$. Both sets are finite under the assumption made. For each $x \in A(n)$ there is a smallest $k \geq 1$ such that $T^{k}(x)=x$, i.e., $x \in B(k)$. Let $d=\operatorname{gcd}(k, n)$. There are positive integers $r, s$ such that $r k-s n=d$ and hence $x=T^{r k}(x)=T^{s n+d}(x)=T^{d}\left(T^{s n}(x)\right)=T^{d}(x)$. The minimality of $k$ implies $d=k$, i.e., $k \mid n$. On the other hand one clearly has $B(k) \subset A(n)$ if $k \mid n$ and thus we have $A(n)=\bigcup_{d \mid n} B(d)$ as a disjoint union and hence

$$
|A(n)|=\sum_{d \mid n}|B(d)| .
$$

Furthermore, for every $x \in B(n)$ the elements $x, T^{1}(x), T^{2}(x), \ldots, T^{n-1}(x)$ are $n$ distinct elements of $B(n)$. The fact that they are in $A(n)$ is obvious. If for some $k<n$ and some $0 \leq i<n$ we had $T^{k}\left(T^{i}(x)\right)=T^{i}(x)$, i.e. $\quad T^{k+i}(x)=T^{i}(x)$, that would imply $x=T^{n}(x)=T^{n-i}\left(T^{i}(x)\right)=T^{n-i}\left(T^{k+i}(x)\right)=T^{k}\left(T^{n}(x)\right)=T^{k}(x)$ contradicting the minimality of $n$. Thus $T^{i}(x) \in B(n)$ and $T^{i}(x) \neq T^{j}(x)$ for $0 \leq i<j \leq n-1$.\\
So indeed, $T$ permutes the elements of $B(n)$ in (disjoint) cycles of length $n$ and in particular one has $n||B(n)|$.\\
Now let $P(x)=\sum_{i=0}^{k} a_{i} x^{i}, a_{i} \in \mathbb{Z}, k \geq 1, a_{k} \neq 0$ and suppose that $|A(n)|=P(n)$ for all $n \geq 1$. Let $p$ be any prime. Then

$$
p^{2}| | B\left(p^{2}\right)\left|=\left|A\left(p^{2}\right)\right|-|A(p)|=a_{1}\left(p^{2}-p\right)+a_{2}\left(p^{4}-p^{2}\right)+\ldots\right.
$$

Hence $p \mid a_{1}$ and since this is true for all primes we must have $a_{1}=0$.\\
Now consider any two different primes $p$ and $q$. Since $a_{1}=0$ we have that

$$
\left|A\left(p^{2} q\right)\right|-|A(p q)|=a_{2}\left(p^{4} q^{2}-p^{2} q^{2}\right)+a_{3}\left(p^{6} q^{3}-p^{3} q^{3}\right)+\ldots
$$

is a multiple of $p^{2} q$. But we also have

$$
p^{2} q| | B\left(p^{2} q\right)\left|=\left|A\left(p^{2} q\right)\right|-|A(p q)|-\left|B\left(p^{2}\right)\right| .\right.
$$

This implies

$$
p^{2} q| | B\left(p^{2}\right)\left|=\left|A\left(p^{2}\right)\right|-|A(p)|=a_{2}\left(p^{4}-p^{2}\right)+a_{3}\left(p^{6}-p^{3}\right)+\cdots+a_{k}\left(p^{2 k}-p^{k}\right) .\right.
$$

Since this is true for every prime $q$ we must have $a_{2}\left(p^{4}-p^{2}\right)+a_{3}\left(p^{6}-p^{3}\right)+\cdots+a_{k}\left(p^{2 k}-p^{k}\right)=0$ for every prime $p$. Since this expression is a polynomial in $p$ of degree $2 k$ (because $a_{k} \neq 0$ ) this is a contradiction, as such a polynomial can have at most $2 k$ zeros.",385,3
2009n6,"Let $k$ be a positive integer. Show that if there exists a sequence $a_{0}, a_{1}, \ldots$ of integers satisfying the condition

$$
a_{n}=\frac{a_{n-1}+n^{k}}{n} \quad \text { for all } n \geq 1,
$$

then $k-2$ is divisible by 3 .","Part $A$. For each positive integer $k$, there exists a polynomial $P_{k}$ of degree $k-1$ with integer coefficients, i.e., $P_{k} \in \mathbb{Z}[x]$, and an integer $q_{k}$ such that the polynomial identity


\begin{equation*}
x P_{k}(x)=x^{k}+P_{k}(x-1)+q_{k} \tag{k}
\end{equation*}


is satisfied. To prove this, for fixed $k$ we write

$$
P_{k}(x)=b_{k-1} x^{k-1}+\cdots+b_{1} x+b_{0}
$$

and determine the coefficients $b_{k-1}, b_{k-2}, \ldots, b_{0}$ and the number $q_{k}$ successively. Obviously, we have $b_{k-1}=1$. For $m=k-1, k-2, \ldots, 1$, comparing the coefficients of $x^{m}$ in the identity ( $I_{k}$ ) results in an expression of $b_{m-1}$ as an integer linear combination of $b_{k-1}, \ldots, b_{m}$, and finally $q_{k}=-P_{k}(-1)$.\\
Part B. Let $k$ be a positive integer, and let $a_{0}, a_{1}, \ldots$ be a sequence of real numbers satisfying the recursion given in the problem. This recursion can be written as

$$
a_{n}-P_{k}(n)=\frac{a_{n-1}-P_{k}(n-1)}{n}-\frac{q_{k}}{n} \quad \text { for all } n \geq 1
$$

which by induction gives

$$
a_{n}-P_{k}(n)=\frac{a_{0}-P_{k}(0)}{n!}-q_{k} \sum_{i=0}^{n-1} \frac{i!}{n!} \quad \text { for all } n \geq 1 .
$$

Therefore, the numbers $a_{n}$ are integers for all $n \geq 1$ only if

$$
a_{0}=P_{k}(0) \quad \text { and } \quad q_{k}=0 .
$$

Part C. Multiplying the identity $\left(I_{k}\right)$ by $x^{2}+x$ and subtracting the identities $\left(I_{k+1}\right),\left(I_{k+2}\right)$ and $q_{k} x^{2}=q_{k} x^{2}$ therefrom, we obtain

$$
x T_{k}(x)=T_{k}(x-1)+2 x\left(P_{k}(x-1)+q_{k}\right)-\left(q_{k+2}+q_{k+1}+q_{k}\right),
$$

where the polynomials $T_{k} \in \mathbb{Z}[x]$ are defined by $T_{k}(x)=\left(x^{2}+x\right) P_{k}(x)-P_{k+1}(x)-P_{k+2}(x)-q_{k} x$. Thus

$$
x T_{k}(x) \equiv T_{k}(x-1)+q_{k+2}+q_{k+1}+q_{k} \bmod 2, \quad k=1,2, \ldots
$$

Comparing the degrees, we easily see that this is only possible if $T_{k}$ is the zero polynomial modulo 2 , and

$$
q_{k+2} \equiv q_{k+1}+q_{k} \bmod 2 \quad \text { for } k=1,2, \ldots
$$

Since $q_{1}=-1$ and $q_{2}=0$, these congruences finish the proof.",282,3
2009n7,Let $a$ and $b$ be distinct integers greater than 1 . Prove that there exists a positive integer $n$ such that $\left(a^{n}-1\right)\left(b^{n}-1\right)$ is not a perfect square.,"At first we notice that

\begin{align*}
(1-\alpha)^{\frac{1}{2}}(1-\beta)^{\frac{1}{2}} & =\left(1-\frac{1}{2} \cdot \alpha-\frac{1}{8} \cdot \alpha^{2}-\cdots\right)\left(1-\frac{1}{2} \cdot \beta-\frac{1}{8} \cdot \beta^{2}-\cdots\right) \\
& =\sum_{k, \ell \geq 0} c_{k, \ell} \cdot \alpha^{k} \beta^{\ell} \quad \text { for all } \alpha, \beta \in(0,1), \tag{1}
\end{align*}

where $c_{0,0}=1$ and $c_{k, \ell}$ are certain coefficients.\\
For an indirect proof, we suppose that $x_{n}=\sqrt{\left(a^{n}-1\right)\left(b^{n}-1\right)} \in \mathbb{Z}$ for all positive integers $n$. Replacing $a$ by $a^{2}$ and $b$ by $b^{2}$ if necessary, we may assume that $a$ and $b$ are perfect squares, hence $\sqrt{a b}$ is an integer.\\
At first we shall assume that $a^{\mu} \neq b^{\nu}$ for all positive integers $\mu, \nu$. We have

\begin{equation*}
x_{n}=(\sqrt{a b})^{n}\left(1-\frac{1}{a^{n}}\right)^{\frac{1}{2}}\left(1-\frac{1}{b^{n}}\right)^{\frac{1}{2}}=\sum_{k, \ell \geq 0} c_{k, \ell}\left(\frac{\sqrt{a b}}{a^{k} b^{\ell}}\right)^{n} . \tag{2}
\end{equation*}

Choosing $k_{0}$ and $\ell_{0}$ such that $a^{k_{0}}>\sqrt{a b}, b^{\ell_{0}}>\sqrt{a b}$, we define the polynomial

$$
P(x)=\prod_{k=0, \ell=0}^{k_{0}-1, \ell_{0}-1}\left(a^{k} b^{\ell} x-\sqrt{a b}\right)=: \sum_{i=0}^{k_{0} \cdot \ell_{0}} d_{i} x^{i}
$$

with integer coefficients $d_{i}$. By our assumption, the zeros

$$
\frac{\sqrt{a b}}{a^{k} b^{\ell}}, \quad k=0, \ldots, k_{0}-1, \quad \ell=0, \ldots, \ell_{0}-1,
$$

of $P$ are pairwise distinct.\\
Furthermore, we consider the integer sequence

\begin{equation*}
y_{n}=\sum_{i=0}^{k_{0} \cdot \ell_{0}} d_{i} x_{n+i}, \quad n=1,2, \ldots \tag{3}
\end{equation*}

By the theory of linear recursions, we obtain

\begin{equation*}
y_{n}=\sum_{\substack{k, \ell \geq 0 \\ k \geq k_{0} \text { or } \ell \geq \ell_{0}}} e_{k, \ell}\left(\frac{\sqrt{a b}}{a^{k} b^{\ell}}\right)^{n}, \quad n=1,2, \ldots, \tag{4}
\end{equation*}

with real numbers $e_{k, \ell}$. We have

$$
\left|y_{n}\right| \leq \sum_{\substack{k, \ell \geq 0 \\ k \geq k_{0} \text { or } \ell \geq \ell_{0}}}\left|e_{k, \ell}\right|\left(\frac{\sqrt{a b}}{a^{k} b^{\ell}}\right)^{n}=: M_{n} .
$$

Because the series in (4) is obtained by a finite linear combination of the absolutely convergent series (11), we conclude that in particular $M_{1}<\infty$. Since

$$
\frac{\sqrt{a b}}{a^{k} b^{\ell}} \leq \lambda:=\max \left\{\frac{\sqrt{a b}}{a^{k_{0}}}, \frac{\sqrt{a b}}{b^{\ell_{0}}}\right\} \quad \text { for all } k, \ell \geq 0 \text { such that } k \geq k_{0} \text { or } \ell \geq \ell_{0}
$$

we get the estimates $M_{n+1} \leq \lambda M_{n}, n=1,2, \ldots$ Our choice of $k_{0}$ and $\ell_{0}$ ensures $\lambda<1$, which implies $M_{n} \rightarrow 0$ and consequently $y_{n} \rightarrow 0$ as $n \rightarrow \infty$. It follows that $y_{n}=0$ for all sufficiently large $n$.\\
So, equation (3) reduces to $\sum_{i=0}^{k_{0} \cdot \ell_{0}} d_{i} x_{n+i}=0$.\\
Using the theory of linear recursions again, for sufficiently large $n$ we have

$$
x_{n}=\sum_{k=0, \ell=0}^{k_{0}-1, \ell_{0}-1} f_{k, \ell}\left(\frac{\sqrt{a b}}{a^{k} b^{\ell}}\right)^{n}
$$

for certain real numbers $f_{k, \ell}$.\\
Comparing with (2), we see that $f_{k, \ell}=c_{k, \ell}$ for all $k, \ell \geq 0$ with $k<k_{0}, \ell<\ell_{0}$, and $c_{k, \ell}=0$ if $k \geq k_{0}$ or $\ell \geq \ell_{0}$, since we assumed that $a^{\mu} \neq b^{\nu}$ for all positive integers $\mu, \nu$.\\
In view of (1), this means

\begin{equation*}
(1-\alpha)^{\frac{1}{2}}(1-\beta)^{\frac{1}{2}}=\sum_{k=0, \ell=0}^{k_{0}-1, \ell_{0}-1} c_{k, \ell} \cdot \alpha^{k} \beta^{\ell} \tag{5}
\end{equation*}

for all real numbers $\alpha, \beta \in(0,1)$. We choose $k^{*}<k_{0}$ maximal such that there is some $i$ with $c_{k^{*}, i} \neq 0$. Squaring (5) and comparing coefficients of $\alpha^{2 k^{*}} \beta^{2 i^{*}}$, where $i^{*}$ is maximal with $c_{k^{*}, i^{*}} \neq 0$, we see that $k^{*}=0$. This means that the right hand side of (5) is independent of $\alpha$, which is clearly impossible.\\
We are left with the case that $a^{\mu}=b^{\nu}$ for some positive integers $\mu$ and $\nu$. We may assume that $\mu$ and $\nu$ are relatively prime. Then there is some positive integer $c$ such that $a=c^{\nu}$ and $b=c^{\mu}$. Now starting with the expansion (2), i. e.,

$$
x_{n}=\sum_{j \geq 0} g_{j}\left(\frac{\sqrt{c^{\mu+\nu}}}{c^{j}}\right)^{n}
$$

for certain coefficients $g_{j}$, and repeating the arguments above, we see that $g_{j}=0$ for sufficiently large $j$, say $j>j_{0}$. But this means that

$$
\left(1-x^{\mu}\right)^{\frac{1}{2}}\left(1-x^{\nu}\right)^{\frac{1}{2}}=\sum_{j=0}^{j_{0}} g_{j} x^{j}
$$

for all real numbers $x \in(0,1)$. Squaring, we see that

$$
\left(1-x^{\mu}\right)\left(1-x^{\nu}\right)
$$

is the square of a polynomial in $x$. In particular, all its zeros are of order at least 2 , which implies $\mu=\nu$ by looking at roots of unity. So we obtain $\mu=\nu=1$, i. e., $a=b$, a contradiction.",644,4
2008a2,"(a) Prove the inequality

$$
\frac{x^{2}}{(x-1)^{2}}+\frac{y^{2}}{(y-1)^{2}}+\frac{z^{2}}{(z-1)^{2}} \geq 1
$$

for real numbers $x, y, z \neq 1$ satisfying the condition $x y z=1$.\\
(b) Show that there are infinitely many triples of rational numbers $x, y, z$ for which this inequality turns into equality.","(a) We start with the substitution

$$
\frac{x}{x-1}=a, \quad \frac{y}{y-1}=b, \quad \frac{z}{z-1}=c, \quad \text { i.e., } \quad x=\frac{a}{a-1}, \quad y=\frac{b}{b-1}, \quad z=\frac{c}{c-1} .
$$

The inequality to be proved reads $a^{2}+b^{2}+c^{2} \geq 1$. The new variables are subject to the constraints $a, b, c \neq 1$ and the following one coming from the condition $x y z=1$,

$$
(a-1)(b-1)(c-1)=a b c .
$$

This is successively equivalent to

$$
\begin{aligned}
a+b+c-1 & =a b+b c+c a, \\
2(a+b+c-1) & =(a+b+c)^{2}-\left(a^{2}+b^{2}+c^{2}\right), \\
a^{2}+b^{2}+c^{2}-2 & =(a+b+c)^{2}-2(a+b+c), \\
a^{2}+b^{2}+c^{2}-1 & =(a+b+c-1)^{2}
\end{aligned}
$$

Thus indeed $a^{2}+b^{2}+c^{2} \geq 1$, as desired.\\
(b) From the equation $a^{2}+b^{2}+c^{2}-1=(a+b+c-1)^{2}$ we see that the proposed inequality becomes an equality if and only if both sums $a^{2}+b^{2}+c^{2}$ and $a+b+c$ have value 1 . The first of them is equal to $(a+b+c)^{2}-2(a b+b c+c a)$. So the instances of equality are described by the system of two equations

$$
a+b+c=1, \quad a b+b c+c a=0
$$

plus the constraint $a, b, c \neq 1$. Elimination of $c$ leads to $a^{2}+a b+b^{2}=a+b$, which we regard as a quadratic equation in $b$,

$$
b^{2}+(a-1) b+a(a-1)=0,
$$

with discriminant

$$
\Delta=(a-1)^{2}-4 a(a-1)=(1-a)(1+3 a) .
$$

We are looking for rational triples $(a, b, c)$; it will suffice to have $a$ rational such that $1-a$ and $1+3 a$ are both squares of rational numbers (then $\Delta$ will be so too). Set $a=k / m$. We want $m-k$ and $m+3 k$ to be squares of integers. This is achieved for instance by taking $m=k^{2}-k+1$ (clearly nonzero); then $m-k=(k-1)^{2}, m+3 k=(k+1)^{2}$. Note that distinct integers $k$ yield distinct values of $a=k / m$.

And thus, if $k$ is any integer and $m=k^{2}-k+1, a=k / m$ then $\Delta=\left(k^{2}-1\right)^{2} / m^{2}$ and the quadratic equation has rational roots $b=\left(m-k \pm k^{2} \mp 1\right) /(2 m)$. Choose e.g. the larger root,

$$
b=\frac{m-k+k^{2}-1}{2 m}=\frac{m+(m-2)}{2 m}=\frac{m-1}{m} .
$$

Computing $c$ from $a+b+c=1$ then gives $c=(1-k) / m$. The condition $a, b, c \neq 1$ eliminates only $k=0$ and $k=1$. Thus, as $k$ varies over integers greater than 1 , we obtain an infinite family of rational triples ( $a, b, c$ ) -and coming back to the original variables ( $x=a /(a-1)$ etc.) -an infinite family of rational triples $(x, y, z)$ with the needed property. (A short calculation shows that the resulting triples are $x=-k /(k-1)^{2}, y=k-k^{2}, z=(k-1) / k^{2}$; but the proof was complete without listing them.)",400,3
2008a5,"Let $a, b, c, d$ be positive real numbers such that

$$
a b c d=1 \quad \text { and } \quad a+b+c+d>\frac{a}{b}+\frac{b}{c}+\frac{c}{d}+\frac{d}{a} .
$$","Prove that

$$
a+b+c+d<\frac{b}{a}+\frac{c}{b}+\frac{d}{c}+\frac{a}{d} .
$$

Solution. We show that if $a b c d=1$, the sum $a+b+c+d$ cannot exceed a certain weighted mean of the expressions $\frac{a}{b}+\frac{b}{c}+\frac{c}{d}+\frac{d}{a}$ and $\frac{b}{a}+\frac{c}{b}+\frac{d}{c}+\frac{a}{d}$.

By applying the AM-GM inequality to the numbers $\frac{a}{b}, \frac{a}{b}, \frac{b}{c}$ and $\frac{a}{d}$, we obtain

$$
a=\sqrt[4]{\frac{a^{4}}{a b c d}}=\sqrt[4]{\frac{a}{b} \cdot \frac{a}{b} \cdot \frac{b}{c} \cdot \frac{a}{d}} \leq \frac{1}{4}\left(\frac{a}{b}+\frac{a}{b}+\frac{b}{c}+\frac{a}{d}\right)
$$

Analogously,

$$
b \leq \frac{1}{4}\left(\frac{b}{c}+\frac{b}{c}+\frac{c}{d}+\frac{b}{a}\right), \quad c \leq \frac{1}{4}\left(\frac{c}{d}+\frac{c}{d}+\frac{d}{a}+\frac{c}{b}\right) \quad \text { and } \quad d \leq \frac{1}{4}\left(\frac{d}{a}+\frac{d}{a}+\frac{a}{b}+\frac{d}{c}\right)
$$

Summing up these estimates yields

$$
a+b+c+d \leq \frac{3}{4}\left(\frac{a}{b}+\frac{b}{c}+\frac{c}{d}+\frac{d}{a}\right)+\frac{1}{4}\left(\frac{b}{a}+\frac{c}{b}+\frac{d}{c}+\frac{a}{d}\right) .
$$

In particular, if $a+b+c+d>\frac{a}{b}+\frac{b}{c}+\frac{c}{d}+\frac{d}{a}$ then $a+b+c+d<\frac{b}{a}+\frac{c}{b}+\frac{d}{c}+\frac{a}{d}$.\\
Comment. The estimate in the above solution was obtained by applying the AM-GM inequality to each column of the $4 \times 4$ array

$$
\begin{array}{llll}
a / b & b / c & c / d & d / a \\
a / b & b / c & c / d & d / a \\
b / c & c / d & d / a & a / b \\
a / d & b / a & c / b & d / c
\end{array}
$$

and adding up the resulting inequalities. The same table yields a stronger bound: If $a, b, c, d>0$ and $a b c d=1$ then

$$
\left(\frac{a}{b}+\frac{b}{c}+\frac{c}{d}+\frac{d}{a}\right)^{3}\left(\frac{b}{a}+\frac{c}{b}+\frac{d}{c}+\frac{a}{d}\right) \geq(a+b+c+d)^{4} .
$$

It suffices to apply Hlder's inequality to the sequences in the four rows, with weights $1 / 4$ :

$$
\begin{gathered}
\left(\frac{a}{b}+\frac{b}{c}+\frac{c}{d}+\frac{d}{a}\right)^{1 / 4}\left(\frac{a}{b}+\frac{b}{c}+\frac{c}{d}+\frac{d}{a}\right)^{1 / 4}\left(\frac{b}{c}+\frac{c}{d}+\frac{d}{a}+\frac{a}{b}\right)^{1 / 4}\left(\frac{a}{d}+\frac{b}{a}+\frac{c}{b}+\frac{d}{c}\right)^{1 / 4} \\
\geq\left(\frac{a a b a}{b b c d}\right)^{1 / 4}+\left(\frac{b b c b}{c c d a}\right)^{1 / 4}+\left(\frac{c c d c}{d d a b}\right)^{1 / 4}+\left(\frac{d d a d}{a a b c}\right)^{1 / 4}=a+b+c+d
\end{gathered}
$$",280,3
2008a6,"Let $f: \mathbb{R} \rightarrow \mathbb{N}$ be a function which satisfies


\begin{equation*}
f\left(x+\frac{1}{f(y)}\right)=f\left(y+\frac{1}{f(x)}\right) \quad \text { for all } x, y \in \mathbb{R} \tag{1}
\end{equation*}


Prove that there is a positive integer which is not a value of $f$.","Solution. Suppose that the statement is false and $f(\mathbb{R})=\mathbb{N}$. We prove several properties of the function $f$ in order to reach a contradiction.

To start with, observe that one can assume $f(0)=1$. Indeed, let $a \in \mathbb{R}$ be such that $f(a)=1$, and consider the function $g(x)=f(x+a)$. By substituting $x+a$ and $y+a$ for $x$ and $y$ in (1), we have

$$
g\left(x+\frac{1}{g(y)}\right)=f\left(x+a+\frac{1}{f(y+a)}\right)=f\left(y+a+\frac{1}{f(x+a)}\right)=g\left(y+\frac{1}{g(x)}\right) .
$$

So $g$ satisfies the functional equation (1), with the additional property $g(0)=1$. Also, $g$ and $f$ have the same set of values: $g(\mathbb{R})=f(\mathbb{R})=\mathbb{N}$. Henceforth we assume $f(0)=1$.\\
Claim 1. For an arbitrary fixed $c \in \mathbb{R}$ we have $\left\{f\left(c+\frac{1}{n}\right): n \in \mathbb{N}\right\}=\mathbb{N}$.\\
Proof. Equation (1) and $f(\mathbb{R})=\mathbb{N}$ imply\\
$f(\mathbb{R})=\left\{f\left(x+\frac{1}{f(c)}\right): x \in \mathbb{R}\right\}=\left\{f\left(c+\frac{1}{f(x)}\right): x \in \mathbb{R}\right\} \subset\left\{f\left(c+\frac{1}{n}\right): n \in \mathbb{N}\right\} \subset f(\mathbb{R})$.\\
The claim follows.\\
We will use Claim 1 in the special cases $c=0$ and $c=1 / 3$ :


\begin{equation*}
\left\{f\left(\frac{1}{n}\right): n \in \mathbb{N}\right\}=\left\{f\left(\frac{1}{3}+\frac{1}{n}\right): n \in \mathbb{N}\right\}=\mathbb{N} . \tag{2}
\end{equation*}


Claim 2. If $f(u)=f(v)$ for some $u, v \in \mathbb{R}$ then $f(u+q)=f(v+q)$ for all nonnegative rational $q$. Furthermore, if $f(q)=1$ for some nonnegative rational $q$ then $f(k q)=1$ for all $k \in \mathbb{N}$.\\
Proof. For all $x \in \mathbb{R}$ we have by (1)

$$
f\left(u+\frac{1}{f(x)}\right)=f\left(x+\frac{1}{f(u)}\right)=f\left(x+\frac{1}{f(v)}\right)=f\left(v+\frac{1}{f(x)}\right) .
$$

Since $f(x)$ attains all positive integer values, this yields $f(u+1 / n)=f(v+1 / n)$ for all $n \in \mathbb{N}$. Let $q=k / n$ be a positive rational number. Then $k$ repetitions of the last step yield

$$
f(u+q)=f\left(u+\frac{k}{n}\right)=f\left(v+\frac{k}{n}\right)=f(v+q) .
$$

Now let $f(q)=1$ for some nonnegative rational $q$, and let $k \in \mathbb{N}$. As $f(0)=1$, the previous conclusion yields successively $f(q)=f(2 q), f(2 q)=f(3 q), \ldots, f((k-1) q)=f(k q)$, as needed.\\
Claim 3. The equality $f(q)=f(q+1)$ holds for all nonnegative rational $q$.\\
Proof. Let $m$ be a positive integer such that $f(1 / m)=1$. Such an $m$ exists by (2). Applying the second statement of Claim 2 with $q=1 / m$ and $k=m$ yields $f(1)=1$.

Given that $f(0)=f(1)=1$, the first statement of Claim 2 implies $f(q)=f(q+1)$ for all nonnegative rational $q$.

Claim 4. The equality $f\left(\frac{1}{n}\right)=n$ holds for every $n \in \mathbb{N}$.\\
Proof. For a nonnegative rational $q$ we set $x=q, y=0$ in (1) and use Claim 3 to obtain

$$
f\left(\frac{1}{f(q)}\right)=f\left(q+\frac{1}{f(0)}\right)=f(q+1)=f(q) .
$$

By (2), for each $n \in \mathbb{N}$ there exists a $k \in \mathbb{N}$ such that $f(1 / k)=n$. Applying the last equation with $q=1 / k$, we have

$$
n=f\left(\frac{1}{k}\right)=f\left(\frac{1}{f(1 / k)}\right)=f\left(\frac{1}{n}\right) .
$$

Now we are ready to obtain a contradiction. Let $n \in \mathbb{N}$ be such that $f(1 / 3+1 / n)=1$. Such an $n$ exists by (2). Let $1 / 3+1 / n=s / t$, where $s, t \in \mathbb{N}$ are coprime. Observe that $t>1$ as $1 / 3+1 / n$ is not an integer. Choose $k, l \in \mathbb{N}$ so that that $k s-l t=1$.

Because $f(0)=f(s / t)=1$, Claim 2 implies $f(k s / t)=1$. Now $f(k s / t)=f(1 / t+l)$; on the other hand $f(1 / t+l)=f(1 / t)$ by $l$ successive applications of Claim 3. Finally, $f(1 / t)=t$ by Claim 4, leading to the impossible $t=1$. The solution is complete.",513,4
2008a7,"Prove that for any four positive real numbers $a, b, c, d$ the inequality

$$
\frac{(a-b)(a-c)}{a+b+c}+\frac{(b-c)(b-d)}{b+c+d}+\frac{(c-d)(c-a)}{c+d+a}+\frac{(d-a)(d-b)}{d+a+b} \geq 0
$$

holds. Determine all cases of equality.","Denote the four terms by

$$
A=\frac{(a-b)(a-c)}{a+b+c}, \quad B=\frac{(b-c)(b-d)}{b+c+d}, \quad C=\frac{(c-d)(c-a)}{c+d+a}, \quad D=\frac{(d-a)(d-b)}{d+a+b} .
$$

The expression $2 A$ splits into two summands as follows,

$$
2 A=A^{\prime}+A^{\prime \prime} \quad \text { where } \quad A^{\prime}=\frac{(a-c)^{2}}{a+b+c}, \quad A^{\prime \prime}=\frac{(a-c)(a-2 b+c)}{a+b+c} ;
$$

this is easily verified. We analogously represent $2 B=B^{\prime}+B^{\prime \prime}, 2 C=C^{\prime}+C^{\prime \prime}, 2 B=D^{\prime}+D^{\prime \prime}$ and examine each of the sums $A^{\prime}+B^{\prime}+C^{\prime}+D^{\prime}$ and $A^{\prime \prime}+B^{\prime \prime}+C^{\prime \prime}+D^{\prime \prime}$ separately.

Write $s=a+b+c+d$; the denominators become $s-d, s-a, s-b, s-c$. By the CauchySchwarz inequality,

$$
\begin{aligned}
& \left(\frac{|a-c|}{\sqrt{s-d}} \cdot \sqrt{s-d}+\frac{|b-d|}{\sqrt{s-a}} \cdot \sqrt{s-a}+\frac{|c-a|}{\sqrt{s-b}} \cdot \sqrt{s-b}+\frac{|d-b|}{\sqrt{s-c}} \cdot \sqrt{s-c}\right)^{2} \\
& \quad \leq\left(\frac{(a-c)^{2}}{s-d}+\frac{(b-d)^{2}}{s-a}+\frac{(c-a)^{2}}{s-b}+\frac{(d-b)^{2}}{s-c}\right)(4 s-s)=3 s\left(A^{\prime}+B^{\prime}+C^{\prime}+D^{\prime}\right) .
\end{aligned}
$$

Hence


\begin{equation*}
A^{\prime}+B^{\prime}+C^{\prime}+D^{\prime} \geq \frac{(2|a-c|+2|b-d|)^{2}}{3 s} \geq \frac{16 \cdot|a-c| \cdot|b-d|}{3 s} . \tag{1}
\end{equation*}


Next we estimate the absolute value of the other sum. We couple $A^{\prime \prime}$ with $C^{\prime \prime}$ to obtain

$$
\begin{aligned}
A^{\prime \prime}+C^{\prime \prime} & =\frac{(a-c)(a+c-2 b)}{s-d}+\frac{(c-a)(c+a-2 d)}{s-b} \\
& =\frac{(a-c)(a+c-2 b)(s-b)+(c-a)(c+a-2 d)(s-d)}{(s-d)(s-b)} \\
& =\frac{(a-c)(-2 b(s-b)-b(a+c)+2 d(s-d)+d(a+c))}{s(a+c)+b d} \\
& =\frac{3(a-c)(d-b)(a+c)}{M}, \quad \text { with } \quad M=s(a+c)+b d .
\end{aligned}
$$

Hence by cyclic shift

$$
B^{\prime \prime}+D^{\prime \prime}=\frac{3(b-d)(a-c)(b+d)}{N}, \quad \text { with } \quad N=s(b+d)+c a .
$$

Thus


\begin{equation*}
A^{\prime \prime}+B^{\prime \prime}+C^{\prime \prime}+D^{\prime \prime}=3(a-c)(b-d)\left(\frac{b+d}{N}-\frac{a+c}{M}\right)=\frac{3(a-c)(b-d) W}{M N} \tag{2}
\end{equation*}


where


\begin{equation*}
W=(b+d) M-(a+c) N=b d(b+d)-a c(a+c) . \tag{3}
\end{equation*}


Note that


\begin{equation*}
M N>(a c(a+c)+b d(b+d)) s \geq|W| \cdot s . \tag{4}
\end{equation*}


Now (2) and (4) yield


\begin{equation*}
\left|A^{\prime \prime}+B^{\prime \prime}+C^{\prime \prime}+D^{\prime \prime}\right| \leq \frac{3 \cdot|a-c| \cdot|b-d|}{s} . \tag{5}
\end{equation*}


Combined with (1) this results in

$$
\begin{aligned}
& 2(A+B+C+D)=\left(A^{\prime}+B^{\prime}+C^{\prime}+D^{\prime}\right)+\left(A^{\prime \prime}+B^{\prime \prime}+C^{\prime \prime}+D^{\prime \prime}\right) \\
& \quad \geq \frac{16 \cdot|a-c| \cdot|b-d|}{3 s}-\frac{3 \cdot|a-c| \cdot|b-d|}{s}=\frac{7 \cdot|a-c| \cdot|b-d|}{3(a+b+c+d)} \geq 0 .
\end{aligned}
$$

This is the required inequality. From the last line we see that equality can be achieved only if either $a=c$ or $b=d$. Since we also need equality in (1), this implies that actually $a=c$ and $b=d$ must hold simultaneously, which is obviously also a sufficient condition.",321,3
2008c5,"Let $S=\left\{x_{1}, x_{2}, \ldots, x_{k+\ell}\right\}$ be a $(k+\ell)$-element set of real numbers contained in the interval $[0,1] ; k$ and $\ell$ are positive integers. A $k$-element subset $A \subset S$ is called nice if

$$
\left|\frac{1}{k} \sum_{x_{i} \in A} x_{i}-\frac{1}{\ell} \sum_{x_{j} \in S \backslash A} x_{j}\right| \leq \frac{k+\ell}{2 k \ell} .
$$

Prove that the number of nice subsets is at least $\frac{2}{k+\ell}\binom{k+\ell}{k}$.","Solution. For a $k$-element subset $A \subset S$, let $f(A)=\frac{1}{k} \sum_{x_{i} \in A} x_{i}-\frac{1}{\ell} \sum_{x_{j} \in S \backslash A} x_{j}$. Denote $\frac{k+\ell}{2 k \ell}=d$.\\
By definition a subset $A$ is nice if $|f(A)| \leq d$.\\
To each permutation $\left(y_{1}, y_{2}, \ldots, y_{k+\ell}\right)$ of the set $S=\left\{x_{1}, x_{2}, \ldots, x_{k+\ell}\right\}$ we assign $k+\ell$ subsets of $S$ with $k$ elements each, namely $A_{i}=\left\{y_{i}, y_{i+1}, \ldots, y_{i+k-1}\right\}, i=1,2, \ldots, k+\ell$. Indices are taken modulo $k+\ell$ here and henceforth. In other words, if $y_{1}, y_{2}, \ldots, y_{k+\ell}$ are arranged around a circle in this order, the sets in question are all possible blocks of $k$ consecutive elements.\\
Claim. At least two nice sets are assigned to every permutation of $S$.\\
Proof. Adjacent sets $A_{i}$ and $A_{i+1}$ differ only by the elements $y_{i}$ and $y_{i+k}, i=1, \ldots, k+\ell$. By the definition of $f$, and because $y_{i}, y_{i+k} \in[0,1]$,

$$
\left|f\left(A_{i+1}\right)-f\left(A_{i}\right)\right|=\left|\left(\frac{1}{k}+\frac{1}{\ell}\right)\left(y_{i+k}-y_{i}\right)\right| \leq \frac{1}{k}+\frac{1}{\ell}=2 d .
$$

Each element $y_{i} \in S$ belongs to exactly $k$ of the sets $A_{1}, \ldots, A_{k+\ell}$. Hence in $k$ of the expressions $f\left(A_{1}\right), \ldots, f\left(A_{k+\ell}\right)$ the coefficient of $y_{i}$ is $1 / k$; in the remaining $\ell$ expressions, its coefficient is $-1 / \ell$. So the contribution of $y_{i}$ to the sum of all $f\left(A_{i}\right)$ equals $k \cdot 1 / k-\ell \cdot 1 / \ell=0$. Since this holds for all $i$, it follows that $f\left(A_{1}\right)+\cdots+f\left(A_{k+\ell}\right)=0$.

If $f\left(A_{p}\right)=\min f\left(A_{i}\right), f\left(A_{q}\right)=\max f\left(A_{i}\right)$, we obtain in particular $f\left(A_{p}\right) \leq 0, f\left(A_{q}\right) \geq 0$. Let $p<q$ (the case $p>q$ is analogous; and the claim is true for $p=q$ as $f\left(A_{i}\right)=0$ for all $i$ ).

We are ready to prove that at least two of the sets $A_{1}, \ldots, A_{k+\ell}$ are nice. The interval $[-d, d]$ has length $2 d$, and we saw that adjacent numbers in the circular arrangement $f\left(A_{1}\right), \ldots, f\left(A_{k+\ell}\right)$ differ by at most $2 d$. Suppose that $f\left(A_{p}\right)<-d$ and $f\left(A_{q}\right)>d$. Then one of the numbers $f\left(A_{p+1}\right), \ldots, f\left(A_{q-1}\right)$ lies in $[-d, d]$, and also one of the numbers $f\left(A_{q+1}\right), \ldots, f\left(A_{p-1}\right)$ lies there. Consequently, one of the sets $A_{p+1}, \ldots, A_{q-1}$ is nice, as well as one of the sets $A_{q+1}, \ldots, A_{p-1}$. If $-d \leq f\left(A_{p}\right)$ and $f\left(A_{q}\right) \leq d$ then $A_{p}$ and $A_{q}$ are nice.

Let now $f\left(A_{p}\right)<-d$ and $f\left(A_{q}\right) \leq d$. Then $f\left(A_{p}\right)+f\left(A_{q}\right)<0$, and since $\sum f\left(A_{i}\right)=0$, there is an $r \neq q$ such that $f\left(A_{r}\right)>0$. We have $0<f\left(A_{r}\right) \leq f\left(A_{q}\right) \leq d$, so the sets $f\left(A_{r}\right)$ and $f\left(A_{q}\right)$ are nice. The only case remaining, $-d \leq f\left(A_{p}\right)$ and $d<f\left(A_{q}\right)$, is analogous.

Apply the claim to each of the $(k+\ell)$ ! permutations of $S=\left\{x_{1}, x_{2}, \ldots, x_{k+\ell}\right\}$. This gives at least $2(k+\ell)$ ! nice sets, counted with repetitions: each nice set is counted as many times as there are permutations to which it is assigned.

On the other hand, each $k$-element set $A \subset S$ is assigned to exactly $(k+\ell) k!\ell!$ permutations. Indeed, such a permutation $\left(y_{1}, y_{2}, \ldots, y_{k+\ell}\right)$ is determined by three independent choices: an in$\operatorname{dex} i \in\{1,2, \ldots, k+\ell\}$ such that $A=\left\{y_{i}, y_{i+1}, \ldots, y_{i+k-1}\right\}$, a permutation $\left(y_{i}, y_{i+1}, \ldots, y_{i+k-1}\right)$ of the set $A$, and a permutation $\left(y_{i+k}, y_{i+k+1}, \ldots, y_{i-1}\right)$ of the set $S \backslash A$.

In summary, there are at least $\frac{2(k+\ell)!}{(k+\ell) k!\ell!}=\frac{2}{k+\ell}\binom{k+\ell}{k}$ nice sets.",532,4
2008c6,"For $n \geq 2$, let $S_{1}, S_{2}, \ldots, S_{2^{n}}$ be $2^{n}$ subsets of $A=\left\{1,2,3, \ldots, 2^{n+1}\right\}$ that satisfy the following property: There do not exist indices $a$ and $b$ with $a<b$ and elements $x, y, z \in A$ with $x<y<z$ such that $y, z \in S_{a}$ and $x, z \in S_{b}$. Prove that at least one of the sets $S_{1}, S_{2}, \ldots, S_{2^{n}}$ contains no more than $4 n$ elements.","We prove that there exists a set $S_{a}$ with at most $3 n+1$ elements.\\
Given a $k \in\{1, \ldots, n\}$, we say that an element $z \in A$ is $k$-good to a set $S_{a}$ if $z \in S_{a}$ and $S_{a}$ contains two other elements $x$ and $y$ with $x<y<z$ such that $z-y<2^{k}$ and $z-x \geq 2^{k}$. Also, $z \in A$ will be called good to $S_{a}$ if $z$ is $k$-good to $S_{a}$ for some $k=1, \ldots, n$.

We claim that each $z \in A$ can be $k$-good to at most one set $S_{a}$. Indeed, suppose on the contrary that $z$ is $k$-good simultaneously to $S_{a}$ and $S_{b}$, with $a<b$. Then there exist $y_{a} \in S_{a}$, $y_{a}<z$, and $x_{b} \in S_{b}, x_{b}<z$, such that $z-y_{a}<2^{k}$ and $z-x_{b} \geq 2^{k}$. On the other hand, since $z \in S_{a} \cap S_{b}$, by the condition of the problem there is no element of $S_{a}$ strictly between $x_{b}$ and $z$. Hence $y_{a} \leq x_{b}$, implying $z-y_{a} \geq z-x_{b}$. However this contradicts $z-y_{a}<2^{k}$ and $z-x_{b} \geq 2^{k}$. The claim follows.

As a consequence, a fixed $z \in A$ can be good to at most $n$ of the given sets (no more than one of them for each $k=1, \ldots, n)$.

Furthermore, let $u_{1}<u_{2}<\cdots<u_{m}<\cdots<u_{p}$ be all elements of a fixed set $S_{a}$ that are not good to $S_{a}$. We prove that $u_{m}-u_{1}>2\left(u_{m-1}-u_{1}\right)$ for all $m \geq 3$.

Indeed, assume that $u_{m}-u_{1} \leq 2\left(u_{m-1}-u_{1}\right)$ holds for some $m \geq 3$. This inequality can be written as $2\left(u_{m}-u_{m-1}\right) \leq u_{m}-u_{1}$. Take the unique $k$ such that $2^{k} \leq u_{m}-u_{1}<2^{k+1}$. Then $2\left(u_{m}-u_{m-1}\right) \leq u_{m}-u_{1}<2^{k+1}$ yields $u_{m}-u_{m-1}<2^{k}$. However the elements $z=u_{m}, x=u_{1}$, $y=u_{m-1}$ of $S_{a}$ then satisfy $z-y<2^{k}$ and $z-x \geq 2^{k}$, so that $z=u_{m}$ is $k$-good to $S_{a}$.

Thus each term of the sequence $u_{2}-u_{1}, u_{3}-u_{1}, \ldots, u_{p}-u_{1}$ is more than twice the previous one. Hence $u_{p}-u_{1}>2^{p-1}\left(u_{2}-u_{1}\right) \geq 2^{p-1}$. But $u_{p} \in\left\{1,2,3, \ldots, 2^{n+1}\right\}$, so that $u_{p} \leq 2^{n+1}$. This yields $p-1 \leq n$, i. e. $p \leq n+1$.

In other words, each set $S_{a}$ contains at most $n+1$ elements that are not good to it.\\
To summarize the conclusions, mark with red all elements in the sets $S_{a}$ that are good to the respective set, and with blue the ones that are not good. Then the total number of red elements, counting multiplicities, is at most $n \cdot 2^{n+1}$ (each $z \in A$ can be marked red in at most $n$ sets). The total number of blue elements is at most $(n+1) 2^{n}$ (each set $S_{a}$ contains at most $n+1$ blue elements). Therefore the sum of cardinalities of $S_{1}, S_{2}, \ldots, S_{2^{n}}$ does not exceed $(3 n+1) 2^{n}$. By averaging, the smallest set has at most $3 n+1$ elements.",450,3
2008g1,"In an acute-angled triangle $A B C$, point $H$ is the orthocentre and $A_{0}, B_{0}, C_{0}$ are the midpoints of the sides $B C, C A, A B$, respectively. Consider three circles passing through $H$ : $\omega_{a}$ around $A_{0}, \omega_{b}$ around $B_{0}$ and $\omega_{c}$ around $C_{0}$. The circle $\omega_{a}$ intersects the line $B C$ at $A_{1}$ and $A_{2} ; \omega_{b}$ intersects $C A$ at $B_{1}$ and $B_{2} ; \omega_{c}$ intersects $A B$ at $C_{1}$ and $C_{2}$. Show that the points $A_{1}, A_{2}, B_{1}, B_{2}, C_{1}, C_{2}$ lie on a circle.","The perpendicular bisectors of the segments $A_{1} A_{2}, B_{1} B_{2}, C_{1} C_{2}$ are also the perpendicular bisectors of $B C, C A, A B$. So they meet at $O$, the circumcentre of $A B C$. Thus $O$ is the only point that can possibly be the centre of the desired circle.

From the right triangle $O A_{0} A_{1}$ we get


\begin{equation*}
O A_{1}^{2}=O A_{0}^{2}+A_{0} A_{1}^{2}=O A_{0}^{2}+A_{0} H^{2} . \tag{1}
\end{equation*}


Let $K$ be the midpoint of $A H$ and let $L$ be the midpoint of $C H$. Since $A_{0}$ and $B_{0}$ are the midpoints of $B C$ and $C A$, we see that $A_{0} L \| B H$ and $B_{0} L \| A H$. Thus the segments $A_{0} L$ and $B_{0} L$ are perpendicular to $A C$ and $B C$, hence parallel to $O B_{0}$ and $O A_{0}$, respectively. Consequently $O A_{0} L B_{0}$ is a parallelogram, so that $O A_{0}$ and $B_{0} L$ are equal and parallel. Also, the midline $B_{0} L$ of triangle $A H C$ is equal and parallel to $A K$ and $K H$.

It follows that $A K A_{0} O$ and $H A_{0} O K$ are parallelograms. The first one gives $A_{0} K=O A=R$, where $R$ is the circumradius of $A B C$. From the second one we obtain


\begin{equation*}
2\left(O A_{0}^{2}+A_{0} H^{2}\right)=O H^{2}+A_{0} K^{2}=O H^{2}+R^{2} . \tag{2}
\end{equation*}


(In a parallelogram, the sum of squares of the diagonals equals the sum of squares of the sides).\\
From (1) and (2) we get $O A_{1}^{2}=\left(O H^{2}+R^{2}\right) / 2$. By symmetry, the same holds for the distances $O A_{2}, O B_{1}, O B_{2}, O C_{1}$ and $O C_{2}$. Thus $A_{1}, A_{2}, B_{1}, B_{2}, C_{1}, C_{2}$ all lie on a circle with centre at $O$ and radius $\left(O H^{2}+R^{2}\right) / 2$.\\",294,3
2008g2,"Given trapezoid $A B C D$ with parallel sides $A B$ and $C D$, assume that there exist points $E$ on line $B C$ outside segment $B C$, and $F$ inside segment $A D$, such that $\angle D A E=\angle C B F$. Denote by $I$ the point of intersection of $C D$ and $E F$, and by $J$ the point of intersection of $A B$ and $E F$. Let $K$ be the midpoint of segment $E F$; assume it does not lie on line $A B$.","Prove that $I$ belongs to the circumcircle of $A B K$ if and only if $K$ belongs to the circumcircle of $C D J$.

Solution. Assume that the disposition of points is as in the diagram.\\
Since $\angle E B F=180^{\circ}-\angle C B F=180^{\circ}-\angle E A F$ by hypothesis, the quadrilateral $A E B F$ is cyclic. Hence $A J \cdot J B=F J \cdot J E$. In view of this equality, $I$ belongs to the circumcircle of $A B K$ if and only if $I J \cdot J K=F J \cdot J E$. Expressing $I J=I F+F J, J E=F E-F J$, and $J K=\frac{1}{2} F E-F J$, we find that $I$ belongs to the circumcircle of $A B K$ if and only if

$$
F J=\frac{I F \cdot F E}{2 I F+F E} .
$$

Since $A E B F$ is cyclic and $A B, C D$ are parallel, $\angle F E C=\angle F A B=180^{\circ}-\angle C D F$. Then $C D F E$ is also cyclic, yielding $I D \cdot I C=I F \cdot I E$. It follows that $K$ belongs to the circumcircle of $C D J$ if and only if $I J \cdot I K=I F \cdot I E$. Expressing $I J=I F+F J, I K=I F+\frac{1}{2} F E$, and $I E=I F+F E$, we find that $K$ is on the circumcircle of $C D J$ if and only if

$$
F J=\frac{I F \cdot F E}{2 I F+F E} .
$$

The conclusion follows.\\
\includegraphics[max width=\textwidth, center]{2025_05_05_fa6d5698664bd1bc5558g-32}

Comment. While the figure shows $B$ inside segment $C E$, it is possible that $C$ is inside segment $B E$. Consequently, $I$ would be inside segment $E F$ and $J$ outside segment $E F$. The position of point $K$ on line $E F$ with respect to points $I, J$ may also vary.

Some case may require that an angle $\varphi$ be replaced by $180^{\circ}-\varphi$, and in computing distances, a sum may need to become a difference. All these cases can be covered by the proposed solution if it is clearly stated that signed distances and angles are used.",351,3
2008g3,Let $A B C D$ be a convex quadrilateral and let $P$ and $Q$ be points in $A B C D$ such that $P Q D A$ and $Q P B C$ are cyclic quadrilaterals. Suppose that there exists a point $E$ on the line segment $P Q$ such that $\angle P A E=\angle Q D E$ and $\angle P B E=\angle Q C E$. Show that the quadrilateral $A B C D$ is cyclic.,"Let $F$ be the point on the line $A D$ such that $E F \| P A$. By hypothesis, the quadrilateral $P Q D A$ is cyclic. So if $F$ lies between $A$ and $D$ then $\angle E F D=\angle P A D=180^{\circ}-\angle E Q D$; the points $F$ and $Q$ are on distinct sides of the line $D E$ and we infer that $E F D Q$ is a cyclic quadrilateral. And if $D$ lies between $A$ and $F$ then a similar argument shows that $\angle E F D=\angle E Q D$; but now the points $F$ and $Q$ lie on the same side of $D E$, so that $E D F Q$ is a cyclic quadrilateral.

In either case we obtain the equality $\angle E F Q=\angle E D Q=\angle P A E$ which implies that $F Q \| A E$. So the triangles $E F Q$ and $P A E$ are either homothetic or parallel-congruent. More specifically, triangle $E F Q$ is the image of $P A E$ under the mapping $f$ which carries the points $P, E$ respectively to $E, Q$ and is either a homothety or translation by a vector. Note that $f$ is uniquely determined by these conditions and the position of the points $P, E, Q$ alone.

Let now $G$ be the point on the line $B C$ such that $E G \| P B$. The same reasoning as above applies to points $B, C$ in place of $A, D$, implying that the triangle $E G Q$ is the image of $P B E$ under the same mapping $f$. So $f$ sends the four points $A, P, B, E$ respectively to $F, E, G, Q$.

If $P E \neq Q E$, so that $f$ is a homothety with a centre $X$, then the lines $A F, P E, B G$-i.e. the lines $A D, P Q, B C$-are concurrent at $X$. And since $P Q D A$ and $Q P B C$ are cyclic quadrilaterals, the equalities $X A \cdot X D=X P \cdot X Q=X B \cdot X C$ hold, showing that the quadrilateral $A B C D$ is cyclic.

Finally, if $P E=Q E$, so that $f$ is a translation, then $A D\|P Q\| B C$. Thus $P Q D A$ and $Q P B C$ are isosceles trapezoids. Then also $A B C D$ is an isosceles trapezoid, hence a cyclic quadrilateral.\\",402,3
2008g4,In an acute triangle $A B C$ segments $B E$ and $C F$ are altitudes. Two circles passing through the points $A$ and $F$ are tangent to the line $B C$ at the points $P$ and $Q$ so that $B$ lies between $C$ and $Q$. Prove that the lines $P E$ and $Q F$ intersect on the circumcircle of triangle $A E F$.,"To approach the desired result we need some information about the slopes of the lines $P E$ and $Q F$; this information is provided by formulas (1) and (2) which we derive below.

The tangents $B P$ and $B Q$ to the two circles passing through $A$ and $F$ are equal, as $B P^{2}=B A \cdot B F=B Q^{2}$. Consider the altitude $A D$ of triangle $A B C$ and its orthocentre $H$. From the cyclic quadrilaterals $C D F A$ and $C D H E$ we get $B A \cdot B F=B C \cdot B D=B E \cdot B H$. Thus $B P^{2}=B E \cdot B H$, or $B P / B H=B E / B P$, implying that the triangles $B P H$ and $B E P$ are similar. Hence


\begin{equation*}
\angle B P E=\angle B H P . \tag{1}
\end{equation*}


The point $P$ lies between $D$ and $C$; this follows from the equality $B P^{2}=B C \cdot B D$. In view of this equality, and because $B P=B Q$,

$$
D P \cdot D Q=(B P-B D) \cdot(B P+B D)=B P^{2}-B D^{2}=B D \cdot(B C-B D)=B D \cdot D C .
$$

Also $A D \cdot D H=B D \cdot D C$, as is seen from the similar triangles $B D H$ and $A D C$. Combining these equalities we obtain $A D \cdot D H=D P \cdot D Q$. Therefore $D H / D P=D Q / D A$, showing that the triangles $H D P$ and $Q D A$ are similar. Hence $\angle H P D=\angle Q A D$, which can be rewritten as $\angle B P H=\angle B A D+\angle B A Q$. And since $B Q$ is tangent to the circumcircle of triangle $F A Q$,


\begin{equation*}
\angle B Q F=\angle B A Q=\angle B P H-\angle B A D . \tag{2}
\end{equation*}


From (1) and (2) we deduce

$$
\begin{aligned}
\angle B P E+\angle B Q F & =(\angle B H P+\angle B P H)-\angle B A D
\end{aligned}=\left(180^{\circ}-\angle P B H\right)-\angle B A D .
$$

Thus $\angle B P E+\angle B Q F<180^{\circ}$, which means that the rays $P E$ and $Q F$ meet. Let $S$ be the point of intersection. Then $\angle P S Q=180^{\circ}-(\angle B P E+\angle B Q F)=\angle C A B=\angle E A F$.

If $S$ lies between $P$ and $E$ then $\angle P S Q=180^{\circ}-\angle E S F$; and if $E$ lies between $P$ and $S$ then $\angle P S Q=\angle E S F$. In either case the equality $\angle P S Q=\angle E A F$ which we have obtained means that $S$ lies on the circumcircle of triangle $A E F$.\\",447,3
2008g5,"Let $k$ and $n$ be integers with $0 \leq k \leq n-2$. Consider a set $L$ of $n$ lines in the plane such that no two of them are parallel and no three have a common point. Denote by $I$ the set of intersection points of lines in $L$. Let $O$ be a point in the plane not lying on any line of $L$.

A point $X \in I$ is colored red if the open line segment $O X$ intersects at most $k$ lines in $L$. Prove that $I$ contains at least $\frac{1}{2}(k+1)(k+2)$ red points.","Solution. There are at least $\frac{1}{2}(k+1)(k+2)$ points in the intersection set $I$ in view of the condition $n \geq k+2$.

For each point $P \in I$, define its order as the number of lines that intersect the open line segment $O P$. By definition, $P$ is red if its order is at most $k$. Note that there is always at least one point $X \in I$ of order 0 . Indeed, the lines in $L$ divide the plane into regions, bounded or not, and $O$ belongs to one of them. Clearly any corner of this region is a point of $I$ with order 0 .\\
Claim. Suppose that two points $P, Q \in I$ lie on the same line of $L$, and no other line of $L$ intersects the open line segment $P Q$. Then the orders of $P$ and $Q$ differ by at most 1 .\\
Proof. Let $P$ and $Q$ have orders $p$ and $q$, respectively, with $p \geq q$. Consider triangle $O P Q$. Now $p$ equals the number of lines in $L$ that intersect the interior of side $O P$. None of these lines intersects the interior of side $P Q$, and at most one can pass through $Q$. All remaining lines must intersect the interior of side $O Q$, implying that $q \geq p-1$. The conclusion follows.

We prove the main result by induction on $k$. The base $k=0$ is clear since there is a point of order 0 which is red. Assuming the statement true for $k-1$, we pass on to the inductive step. Select a point $P \in I$ of order 0 , and consider one of the lines $\ell \in L$ that pass through $P$. There are $n-1$ intersection points on $\ell$, one of which is $P$. Out of the remaining $n-2$ points, the $k$ closest to $P$ have orders not exceeding $k$ by the Claim. It follows that there are at least $k+1$ red points on $\ell$.

Let us now consider the situation with $\ell$ removed (together with all intersection points it contains). By hypothesis of induction, there are at least $\frac{1}{2} k(k+1)$ points of order not exceeding $k-1$ in the resulting configuration. Restoring $\ell$ back produces at most one new intersection point on each line segment joining any of these points to $O$, so their order is at most $k$ in the original configuration. The total number of points with order not exceeding $k$ is therefore at least $(k+1)+\frac{1}{2} k(k+1)=\frac{1}{2}(k+1)(k+2)$. This completes the proof.

Comment. The steps of the proof can be performed in reverse order to obtain a configuration of $n$ lines such that equality holds simultaneously for all $0 \leq k \leq n-2$.",445,3
2008g6,"There is given a convex quadrilateral $A B C D$. Prove that there exists a point $P$ inside the quadrilateral such that


\begin{equation*}
\angle P A B+\angle P D C=\angle P B C+\angle P A D=\angle P C D+\angle P B A=\angle P D A+\angle P C B=90^{\circ} \tag{1}
\end{equation*}


if and only if the diagonals $A C$ and $B D$ are perpendicular.","For a point $P$ in $A B C D$ which satisfies (1), let $K, L, M, N$ be the feet of perpendiculars from $P$ to lines $A B, B C, C D, D A$, respectively. Note that $K, L, M, N$ are interior to the sides as all angles in (1) are acute. The cyclic quadrilaterals $A K P N$ and $D N P M$ give

$$
\angle P A B+\angle P D C=\angle P N K+\angle P N M=\angle K N M
$$

Analogously, $\angle P B C+\angle P A D=\angle L K N$ and $\angle P C D+\angle P B A=\angle M L K$. Hence the equalities (1) imply $\angle K N M=\angle L K N=\angle M L K=90^{\circ}$, so that $K L M N$ is a rectangle. The converse also holds true, provided that $K, L, M, N$ are interior to sides $A B, B C, C D, D A$.\\
(i) Suppose that there exists a point $P$ in $A B C D$ such that $K L M N$ is a rectangle. We show that $A C$ and $B D$ are parallel to the respective sides of $K L M N$.

Let $O_{A}$ and $O_{C}$ be the circumcentres of the cyclic quadrilaterals $A K P N$ and $C M P L$. Line $O_{A} O_{C}$ is the common perpendicular bisector of $L M$ and $K N$, therefore $O_{A} O_{C}$ is parallel to $K L$ and $M N$. On the other hand, $O_{A} O_{C}$ is the midline in the triangle $A C P$ that is parallel to $A C$. Therefore the diagonal $A C$ is parallel to the sides $K L$ and $M N$ of the rectangle. Likewise, $B D$ is parallel to $K N$ and $L M$. Hence $A C$ and $B D$ are perpendicular.\\
\includegraphics[max width=\textwidth, center]{2025_05_05_fa6d5698664bd1bc5558g-38}\\
(ii) Suppose that $A C$ and $B D$ are perpendicular and meet at $R$. If $A B C D$ is a rhombus, $P$ can be chosen to be its centre. So assume that $A B C D$ is not a rhombus, and let $B R<D R$ without loss of generality.

Denote by $U_{A}$ and $U_{C}$ the circumcentres of the triangles $A B D$ and $C D B$, respectively. Let $A V_{A}$ and $C V_{C}$ be the diameters through $A$ and $C$ of the two circumcircles. Since $A R$ is an altitude in triangle $A D B$, lines $A C$ and $A V_{A}$ are isogonal conjugates, i. e. $\angle D A V_{A}=\angle B A C$. Now $B R<D R$ implies that ray $A U_{A}$ lies in $\angle D A C$. Similarly, ray $C U_{C}$ lies in $\angle D C A$. Both diameters $A V_{A}$ and $C V_{C}$ intersect $B D$ as the angles at $B$ and $D$ of both triangles are acute. Also $U_{A} U_{C}$ is parallel to $A C$ as it is the perpendicular bisector of $B D$. Hence $V_{A} V_{C}$ is parallel to $A C$, too. We infer that $A V_{A}$ and $C V_{C}$ intersect at a point $P$ inside triangle $A C D$, hence inside $A B C D$.

Construct points $K, L, M, N, O_{A}$ and $O_{C}$ in the same way as in the introduction. It follows from the previous paragraph that $K, L, M, N$ are interior to the respective sides. Now $O_{A} O_{C}$ is a midline in triangle $A C P$ again. Therefore lines $A C, O_{A} O_{C}$ and $U_{A} U_{C}$ are parallel.

The cyclic quadrilateral $A K P N$ yields $\angle N K P=\angle N A P$. Since $\angle N A P=\angle D A U_{A}=$ $\angle B A C$, as specified above, we obtain $\angle N K P=\angle B A C$. Because $P K$ is perpendicular to $A B$, it follows that $N K$ is perpendicular to $A C$, hence parallel to $B D$. Likewise, $L M$ is parallel to $B D$.

Consider the two homotheties with centres $A$ and $C$ which transform triangles $A B D$ and $C D B$ into triangles $A K N$ and $C M L$, respectively. The images of points $U_{A}$ and $U_{C}$ are $O_{A}$ and $O_{C}$, respectively. Since $U_{A} U_{C}$ and $O_{A} O_{C}$ are parallel to $A C$, the two ratios of homothety are the same, equal to $\lambda=A N / A D=A K / A B=A O_{A} / A U_{A}=C O_{C} / C U_{C}=C M / C D=C L / C B$. It is now straightforward that $D N / D A=D M / D C=B K / B A=B L / B C=1-\lambda$. Hence $K L$ and $M N$ are parallel to $A C$, implying that $K L M N$ is a rectangle and completing the proof.\\",771,4
2008g7,"Let $A B C D$ be a convex quadrilateral with $A B \neq B C$. Denote by $\omega_{1}$ and $\omega_{2}$ the incircles of triangles $A B C$ and $A D C$. Suppose that there exists a circle $\omega$ inscribed in angle $A B C$, tangent to the extensions of line segments $A D$ and $C D$. Prove that the common external tangents of $\omega_{1}$ and $\omega_{2}$ intersect on $\omega$.","Solution. The proof below is based on two known facts.\\
Lemma 1. Given a convex quadrilateral $A B C D$, suppose that there exists a circle which is inscribed in angle $A B C$ and tangent to the extensions of line segments $A D$ and $C D$. Then $A B+A D=C B+C D$.\\
Proof. The circle in question is tangent to each of the lines $A B, B C, C D, D A$, and the respective points of tangency $K, L, M, N$ are located as with circle $\omega$ in the figure. Then

$$
A B+A D=(B K-A K)+(A N-D N), \quad C B+C D=(B L-C L)+(C M-D M)
$$

Also $B K=B L, D N=D M, A K=A N, C L=C M$ by equalities of tangents. It follows that $A B+A D=C B+C D$.\\
\includegraphics[max width=\textwidth, center]{2025_05_05_fa6d5698664bd1bc5558g-41}

For brevity, in the sequel we write ""excircle $A C$ "" for the excircle of a triangle with side $A C$ which is tangent to line segment $A C$ and the extensions of the other two sides.\\
Lemma 2. The incircle of triangle $A B C$ is tangent to its side $A C$ at $P$. Let $P P^{\prime}$ be the diameter of the incircle through $P$, and let line $B P^{\prime}$ intersect $A C$ at $Q$. Then $Q$ is the point of tangency of side $A C$ and excircle $A C$.\\
Proof. Let the tangent at $P^{\prime}$ to the incircle $\omega_{1}$ meet $B A$ and $B C$ at $A^{\prime}$ and $C^{\prime}$. Now $\omega_{1}$ is the excircle $A^{\prime} C^{\prime}$ of triangle $A^{\prime} B C^{\prime}$, and it touches side $A^{\prime} C^{\prime}$ at $P^{\prime}$. Since $A^{\prime} C^{\prime} \| A C$, the homothety with centre $B$ and ratio $B Q / B P^{\prime}$ takes $\omega_{1}$ to the excircle $A C$ of triangle $A B C$. Because this homothety takes $P^{\prime}$ to $Q$, the lemma follows.

Recall also that if the incircle of a triangle touches its side $A C$ at $P$, then the tangency point $Q$ of the same side and excircle $A C$ is the unique point on line segment $A C$ such that $A P=C Q$.

We pass on to the main proof. Let $\omega_{1}$ and $\omega_{2}$ touch $A C$ at $P$ and $Q$, respectively; then $A P=(A C+A B-B C) / 2, C Q=(C A+C D-A D) / 2$. Since $A B-B C=C D-A D$ by Lemma 1 , we obtain $A P=C Q$. It follows that in triangle $A B C$ side $A C$ and excircle $A C$ are tangent at $Q$. Likewise, in triangle $A D C$ side $A C$ and excircle $A C$ are tangent at $P$. Note that $P \neq Q$ as $A B \neq B C$.

Let $P P^{\prime}$ and $Q Q^{\prime}$ be the diameters perpendicular to $A C$ of $\omega_{1}$ and $\omega_{2}$, respectively. Then Lemma 2 shows that points $B, P^{\prime}$ and $Q$ are collinear, and so are points $D, Q^{\prime}$ and $P$.

Consider the diameter of $\omega$ perpendicular to $A C$ and denote by $T$ its endpoint that is closer to $A C$. The homothety with centre $B$ and ratio $B T / B P^{\prime}$ takes $\omega_{1}$ to $\omega$. Hence $B, P^{\prime}$ and $T$ are collinear. Similarly, $D, Q^{\prime}$ and $T$ are collinear since the homothety with centre $D$ and ratio $-D T / D Q^{\prime}$ takes $\omega_{2}$ to $\omega$.

We infer that points $T, P^{\prime}$ and $Q$ are collinear, as well as $T, Q^{\prime}$ and $P$. Since $P P^{\prime} \| Q Q^{\prime}$, line segments $P P^{\prime}$ and $Q Q^{\prime}$ are then homothetic with centre $T$. The same holds true for circles $\omega_{1}$ and $\omega_{2}$ because they have $P P^{\prime}$ and $Q Q^{\prime}$ as diameters. Moreover, it is immediate that $T$ lies on the same side of line $P P^{\prime}$ as $Q$ and $Q^{\prime}$, hence the ratio of homothety is positive. In particular $\omega_{1}$ and $\omega_{2}$ are not congruent.

In summary, $T$ is the centre of a homothety with positive ratio that takes circle $\omega_{1}$ to circle $\omega_{2}$. This completes the solution, since the only point with the mentioned property is the intersection of the the common external tangents of $\omega_{1}$ and $\omega_{2}$.",687,4
2008n1,"Let $n$ be a positive integer and let $p$ be a prime number. Prove that if $a, b, c$ are integers (not necessarily positive) satisfying the equations

$$
a^{n}+p b=b^{n}+p c=c^{n}+p a,
$$

then $a=b=c$.","If two of $a, b, c$ are equal, it is immediate that all the three are equal. So we may assume that $a \neq b \neq c \neq a$. Subtracting the equations we get $a^{n}-b^{n}=-p(b-c)$ and two cyclic copies of this equation, which upon multiplication yield


\begin{equation*}
\frac{a^{n}-b^{n}}{a-b} \cdot \frac{b^{n}-c^{n}}{b-c} \cdot \frac{c^{n}-a^{n}}{c-a}=-p^{3} . \tag{1}
\end{equation*}


If $n$ is odd then the differences $a^{n}-b^{n}$ and $a-b$ have the same sign and the product on the left is positive, while $-p^{3}$ is negative. So $n$ must be even.

Let $d$ be the greatest common divisor of the three differences $a-b, b-c, c-a$, so that $a-b=d u, b-c=d v, c-a=d w ; \quad \operatorname{gcd}(u, v, w)=1, u+v+w=0$.

From $a^{n}-b^{n}=-p(b-c)$ we see that $(a-b) \mid p(b-c)$, i.e., $u \mid p v$; and cyclically $v|p w, w| p u$. As $\operatorname{gcd}(u, v, w)=1$ and $u+v+w=0$, at most one of $u, v, w$ can be divisible by $p$. Supposing that the prime $p$ does not divide any one of them, we get $u|v, v| w, w \mid u$, whence $|u|=|v|=|w|=1$; but this quarrels with $u+v+w=0$.

Thus $p$ must divide exactly one of these numbers. Let e.g. $p \mid u$ and write $u=p u_{1}$. Now we obtain, similarly as before, $u_{1}|v, v| w, w \mid u_{1}$ so that $\left|u_{1}\right|=|v|=|w|=1$. The equation $p u_{1}+v+w=0$ forces that the prime $p$ must be even; i.e. $p=2$. Hence $v+w=-2 u_{1}= \pm 2$, implying $v=w(= \pm 1)$ and $u=-2 v$. Consequently $a-b=-2(b-c)$.

Knowing that $n$ is even, say $n=2 k$, we rewrite the equation $a^{n}-b^{n}=-p(b-c)$ with $p=2$ in the form

$$
\left(a^{k}+b^{k}\right)\left(a^{k}-b^{k}\right)=-2(b-c)=a-b .
$$

The second factor on the left is divisible by $a-b$, so the first factor $\left(a^{k}+b^{k}\right)$ must be $\pm 1$. Then exactly one of $a$ and $b$ must be odd; yet $a-b=-2(b-c)$ is even. Contradiction ends the proof.",299,3
2008n2,"Let $a_{1}, a_{2}, \ldots, a_{n}$ be distinct positive integers, $n \geq 3$. Prove that there exist distinct indices $i$ and $j$ such that $a_{i}+a_{j}$ does not divide any of the numbers $3 a_{1}, 3 a_{2}, \ldots, 3 a_{n}$.","Solution. Without loss of generality, let $0<a_{1}<a_{2}<\cdots<a_{n}$. One can also assume that $a_{1}, a_{2}, \ldots, a_{n}$ are coprime. Otherwise division by their greatest common divisor reduces the question to the new sequence whose terms are coprime integers.

Suppose that the claim is false. Then for each $i<n$ there exists a $j$ such that $a_{n}+a_{i}$ divides $3 a_{j}$. If $a_{n}+a_{i}$ is not divisible by 3 then $a_{n}+a_{i}$ divides $a_{j}$ which is impossible as $0<a_{j} \leq a_{n}<a_{n}+a_{i}$. Thus $a_{n}+a_{i}$ is a multiple of 3 for $i=1, \ldots, n-1$, so that $a_{1}, a_{2}, \ldots, a_{n-1}$ are all congruent (to $-a_{n}$ ) modulo 3 .

Now $a_{n}$ is not divisible by 3 or else so would be all remaining $a_{i}$ 's, meaning that $a_{1}, a_{2}, \ldots, a_{n}$ are not coprime. Hence $a_{n} \equiv r(\bmod 3)$ where $r \in\{1,2\}$, and $a_{i} \equiv 3-r(\bmod 3)$ for all $i=1, \ldots, n-1$.

Consider a sum $a_{n-1}+a_{i}$ where $1 \leq i \leq n-2$. There is at least one such sum as $n \geq 3$. Let $j$ be an index such that $a_{n-1}+a_{i}$ divides $3 a_{j}$. Observe that $a_{n-1}+a_{i}$ is not divisible by 3 since $a_{n-1}+a_{i} \equiv 2 a_{i} \not \equiv 0(\bmod 3)$. It follows that $a_{n-1}+a_{i}$ divides $a_{j}$, in particular $a_{n-1}+a_{i} \leq a_{j}$. Hence $a_{n-1}<a_{j} \leq a_{n}$, implying $j=n$. So $a_{n}$ is divisible by all sums $a_{n-1}+a_{i}, 1 \leq i \leq n-2$. In particular $a_{n-1}+a_{i} \leq a_{n}$ for $i=1, \ldots, n-2$.

Let $j$ be such that $a_{n}+a_{n-1}$ divides $3 a_{j}$. If $j \leq n-2$ then $a_{n}+a_{n-1} \leq 3 a_{j}<a_{j}+2 a_{n-1}$. This yields $a_{n}<a_{n-1}+a_{j}$; however $a_{n-1}+a_{j} \leq a_{n}$ for $j \leq n-2$. Therefore $j=n-1$ or $j=n$.

For $j=n-1$ we obtain $3 a_{n-1}=k\left(a_{n}+a_{n-1}\right)$ with $k$ an integer, and it is straightforward that $k=1\left(k \leq 0\right.$ and $k \geq 3$ contradict $0<a_{n-1}<a_{n} ; k=2$ leads to $\left.a_{n-1}=2 a_{n}>a_{n-1}\right)$. Thus $3 a_{n-1}=a_{n}+a_{n-1}$, i. e. $a_{n}=2 a_{n-1}$.

Similarly, if $j=n$ then $3 a_{n}=k\left(a_{n}+a_{n-1}\right)$ for some integer $k$, and only $k=2$ is possible. Hence $a_{n}=2 a_{n-1}$ holds true in both cases remaining, $j=n-1$ and $j=n$.

Now $a_{n}=2 a_{n-1}$ implies that the sum $a_{n-1}+a_{1}$ is strictly between $a_{n} / 2$ and $a_{n}$. But $a_{n-1}$ and $a_{1}$ are distinct as $n \geq 3$, so it follows from the above that $a_{n-1}+a_{1}$ divides $a_{n}$. This provides the desired contradiction.",371,3
2008n3,"Let $a_{0}, a_{1}, a_{2}, \ldots$ be a sequence of positive integers such that the greatest common divisor of any two consecutive terms is greater than the preceding term; in symbols, $\operatorname{gcd}\left(a_{i}, a_{i+1}\right)>a_{i-1}$. Prove that $a_{n} \geq 2^{n}$ for all $n \geq 0$.","Solution. Since $a_{i} \geq \operatorname{gcd}\left(a_{i}, a_{i+1}\right)>a_{i-1}$, the sequence is strictly increasing. In particular $a_{0} \geq 1, a_{1} \geq 2$. For each $i \geq 1$ we also have $a_{i+1}-a_{i} \geq \operatorname{gcd}\left(a_{i}, a_{i+1}\right)>a_{i-1}$, and consequently $a_{i+1} \geq a_{i}+a_{i-1}+1$. Hence $a_{2} \geq 4$ and $a_{3} \geq 7$. The equality $a_{3}=7$ would force equalities in the previous estimates, leading to $\operatorname{gcd}\left(a_{2}, a_{3}\right)=\operatorname{gcd}(4,7)>a_{1}=2$, which is false. Thus $a_{3} \geq 8$; the result is valid for $n=0,1,2,3$. These are the base cases for a proof by induction.

Take an $n \geq 3$ and assume that $a_{i} \geq 2^{i}$ for $i=0,1, \ldots, n$. We must show that $a_{n+1} \geq 2^{n+1}$. Let $\operatorname{gcd}\left(a_{n}, a_{n+1}\right)=d$. We know that $d>a_{n-1}$. The induction claim is reached immediately in the following cases:

$$
\begin{aligned}
& \text { if } a_{n+1} \geq 4 d \text { then } a_{n+1}>4 a_{n-1} \geq 4 \cdot 2^{n-1}=2^{n+1} \\
& \text { if } a_{n} \geq 3 d \quad \text { then } a_{n+1} \geq a_{n}+d \geq 4 d>4 a_{n-1} \geq 4 \cdot 2^{n-1}=2^{n+1} ; \\
& \text { if } a_{n}=d \quad \text { then } a_{n+1} \geq a_{n}+d=2 a_{n} \geq 2 \cdot 2^{n}=2^{n+1} .
\end{aligned}
$$

The only remaining possibility is that $a_{n}=2 d$ and $a_{n+1}=3 d$, which we assume for the sequel. So $a_{n+1}=\frac{3}{2} a_{n}$.

Let now $\operatorname{gcd}\left(a_{n-1}, a_{n}\right)=d^{\prime}$; then $d^{\prime}>a_{n-2}$. Write $a_{n}=m d^{\prime}$ ( $m$ an integer). Keeping in mind that $d^{\prime} \leq a_{n-1}<d$ and $a_{n}=2 d$, we get that $m \geq 3$. Also $a_{n-1}<d=\frac{1}{2} m d^{\prime}$, $a_{n+1}=\frac{3}{2} m d^{\prime}$. Again we single out the cases which imply the induction claim immediately:

$$
\begin{aligned}
& \text { if } m \geq 6 \text { then } a_{n+1}=\frac{3}{2} m d^{\prime} \geq 9 d^{\prime}>9 a_{n-2} \geq 9 \cdot 2^{n-2}>2^{n+1} ; \\
& \text { if } 3 \leq m \leq 4 \text { then } a_{n-1}<\frac{1}{2} \cdot 4 d^{\prime}, \text { and hence } a_{n-1}=d^{\prime}, \\
& \qquad a_{n+1}=\frac{3}{2} m a_{n-1} \geq \frac{3}{2} \cdot 3 a_{n-1} \geq \frac{9}{2} \cdot 2^{n-1}>2^{n+1} .
\end{aligned}
$$

So we are left with the case $m=5$, which means that $a_{n}=5 d^{\prime}, \quad a_{n+1}=\frac{15}{2} d^{\prime}, \quad a_{n-1}<d=\frac{5}{2} d^{\prime}$. The last relation implies that $a_{n-1}$ is either $d^{\prime}$ or $2 d^{\prime}$. Anyway, $a_{n-1} \mid 2 d^{\prime}$.

The same pattern repeats once more. We denote $\operatorname{gcd}\left(a_{n-2}, a_{n-1}\right)=d^{\prime \prime}$; then $d^{\prime \prime}>a_{n-3}$. Because $d^{\prime \prime}$ is a divisor of $a_{n-1}$, hence also of $2 d^{\prime}$, we may write $2 d^{\prime}=m^{\prime} d^{\prime \prime} \quad$ ( $m^{\prime}$ an integer). Since $d^{\prime \prime} \leq a_{n-2}<d^{\prime}$, we get $m^{\prime} \geq 3$. Also, $a_{n-2}<d^{\prime}=\frac{1}{2} m^{\prime} d^{\prime \prime}, a_{n+1}=\frac{15}{2} d^{\prime}=\frac{15}{4} m^{\prime} d^{\prime \prime}$. As before, we consider the cases:

$$
\begin{aligned}
& \text { if } m^{\prime} \geq 5 \quad \text { then } a_{n+1}=\frac{15}{4} m^{\prime} d^{\prime \prime} \geq \frac{75}{4} d^{\prime \prime}>\frac{75}{4} a_{n-3} \geq \frac{75}{4} \cdot 2^{n-3}>2^{n+1} ; \\
& \text { if } 3 \leq m^{\prime} \leq 4 \text { then } a_{n-2}<\frac{1}{2} \cdot 4 d^{\prime \prime}, \text { and hence } a_{n-2}=d^{\prime \prime}, \\
& \qquad a_{n+1}=\frac{15}{4} m^{\prime} a_{n-2} \geq \frac{15}{4} \cdot 3 a_{n-2} \geq \frac{45}{4} \cdot 2^{n-2}>2^{n+1} .
\end{aligned}
$$

Both of them have produced the induction claim. But now there are no cases left. Induction is complete; the inequality $a_{n} \geq 2^{n}$ holds for all $n$.",530,4
2008n4,"Let $n$ be a positive integer. Show that the numbers

$$
\binom{2^{n}-1}{0}, \quad\binom{2^{n}-1}{1}, \quad\binom{2^{n}-1}{2}, \quad \ldots, \quad\binom{2^{n}-1}{2^{n-1}-1}
$$

are congruent modulo $2^{n}$ to $1,3,5, \ldots, 2^{n}-1$ in some order.","It is well-known that all these numbers are odd. So the assertion that their remainders $\left(\bmod 2^{n}\right)$ make up a permutation of $\left\{1,3, \ldots, 2^{n}-1\right\}$ is equivalent just to saying that these remainders are all distinct. We begin by showing that


\begin{equation*}
\binom{2^{n}-1}{2 k}+\binom{2^{n}-1}{2 k+1} \equiv 0\left(\bmod 2^{n}\right) \quad \text { and } \quad\binom{2^{n}-1}{2 k} \equiv(-1)^{k}\binom{2^{n-1}-1}{k}\left(\bmod 2^{n}\right) \tag{1}
\end{equation*}


The first relation is immediate, as the sum on the left is equal to $\binom{2^{n}}{2 k+1}=\frac{2^{n}}{2 k+1}\binom{2^{n}-1}{2 k}$, hence is divisible by $2^{n}$. The second relation:

$$
\binom{2^{n}-1}{2 k}=\prod_{j=1}^{2 k} \frac{2^{n}-j}{j}=\prod_{i=1}^{k} \frac{2^{n}-(2 i-1)}{2 i-1} \cdot \prod_{i=1}^{k} \frac{2^{n-1}-i}{i} \equiv(-1)^{k}\binom{2^{n-1}-1}{k} \quad\left(\bmod 2^{n}\right) .
$$

This prepares ground for a proof of the required result by induction on $n$. The base case $n=1$ is obvious. Assume the assertion is true for $n-1$ and pass to $n$, denoting $a_{k}=\binom{2^{n-1}-1}{k}$, $b_{m}=\binom{2^{n}-1}{m}$. The induction hypothesis is that all the numbers $a_{k}\left(0 \leq k<2^{n-2}\right)$ are distinct $\left(\bmod 2^{n-1}\right)$; the claim is that all the numbers $b_{m}\left(0 \leq m<2^{n-1}\right)$ are distinct $\left(\bmod 2^{n}\right)$.

The congruence relations (1) are restated as


\begin{equation*}
b_{2 k} \equiv(-1)^{k} a_{k} \equiv-b_{2 k+1} \quad\left(\bmod 2^{n}\right) \tag{2}
\end{equation*}


Shifting the exponent in the first relation of (1) from $n$ to $n-1$ we also have the congruence $a_{2 i+1} \equiv-a_{2 i}\left(\bmod 2^{n-1}\right)$. We hence conclude:


\begin{equation*}
\text { If, for some } j, k<2^{n-2}, a_{k} \equiv-a_{j}\left(\bmod 2^{n-1}\right), \text { then }\{j, k\}=\{2 i, 2 i+1\} \text { for some } i \text {. } \tag{3}
\end{equation*}


This is so because in the sequence $\left(a_{k}: k<2^{n-2}\right)$ each term $a_{j}$ is complemented to $0\left(\bmod 2^{n-1}\right)$ by only one other term $a_{k}$, according to the induction hypothesis.

From (2) we see that $b_{4 i} \equiv a_{2 i}$ and $b_{4 i+3} \equiv a_{2 i+1}\left(\bmod 2^{n}\right)$. Let

$$
M=\left\{m: 0 \leq m<2^{n-1}, m \equiv 0 \text { or } 3(\bmod 4)\right\}, \quad L=\left\{l: 0 \leq l<2^{n-1}, l \equiv 1 \text { or } 2(\bmod 4)\right\} .
$$

The last two congruences take on the unified form


\begin{equation*}
b_{m} \equiv a_{\lfloor m / 2\rfloor} \quad\left(\bmod 2^{n}\right) \quad \text { for all } \quad m \in M \tag{4}
\end{equation*}


Thus all the numbers $b_{m}$ for $m \in M$ are distinct $\left(\bmod 2^{n}\right)$ because so are the numbers $a_{k}$ (they are distinct $\left(\bmod 2^{n-1}\right)$, hence also $\left(\bmod 2^{n}\right)$ ).

Every $l \in L$ is paired with a unique $m \in M$ into a pair of the form $\{2 k, 2 k+1\}$. So (2) implies that also all the $b_{l}$ for $l \in L$ are distinct $\left(\bmod 2^{n}\right)$. It remains to eliminate the possibility that $b_{m} \equiv b_{l}\left(\bmod 2^{n}\right)$ for some $m \in M, l \in L$.

Suppose that such a situation occurs. Let $m^{\prime} \in M$ be such that $\left\{m^{\prime}, l\right\}$ is a pair of the form $\{2 k, 2 k+1\}$, so that $($ see $(2)) \quad b_{m^{\prime}} \equiv-b_{l}\left(\bmod 2^{n}\right)$. Hence $b_{m^{\prime}} \equiv-b_{m}\left(\bmod 2^{n}\right)$. Since both $m^{\prime}$ and $m$ are in $M$, we have by (4) $b_{m^{\prime}} \equiv a_{j}, b_{m} \equiv a_{k}\left(\bmod 2^{n}\right)$ for $j=\left\lfloor m^{\prime} / 2\right\rfloor, k=\lfloor m / 2\rfloor$.

Then $a_{j} \equiv-a_{k}\left(\bmod 2^{n}\right)$. Thus, according to (3), $j=2 i, k=2 i+1$ for some $i$ (or vice versa). The equality $a_{2 i+1} \equiv-a_{2 i}\left(\bmod 2^{n}\right)$ now means that $\binom{2^{n-1}-1}{2 i}+\binom{2^{n-1}-1}{2 i+1} \equiv 0\left(\bmod 2^{n}\right)$. However, the sum on the left is equal to $\binom{2^{n-1}}{2 i+1}$. A number of this form cannot be divisible by $2^{n}$. This is a contradiction which concludes the induction step and proves the result.",565,4
2008n6,Prove that there exist infinitely many positive integers $n$ such that $n^{2}+1$ has a prime divisor greater than $2 n+\sqrt{2 n}$.,"Solution. Let $p \equiv 1(\bmod 8)$ be a prime. The congruence $x^{2} \equiv-1(\bmod p)$ has two solutions in $[1, p-1]$ whose sum is $p$. If $n$ is the smaller one of them then $p$ divides $n^{2}+1$ and $n \leq(p-1) / 2$. We show that $p>2 n+\sqrt{10 n}$.

Let $n=(p-1) / 2-\ell$ where $\ell \geq 0$. Then $n^{2} \equiv-1(\bmod p)$ gives

$$
\left(\frac{p-1}{2}-\ell\right)^{2} \equiv-1 \quad(\bmod p) \quad \text { or } \quad(2 \ell+1)^{2}+4 \equiv 0 \quad(\bmod p) .
$$

Thus $(2 \ell+1)^{2}+4=r p$ for some $r \geq 0$. As $(2 \ell+1)^{2} \equiv 1 \equiv p(\bmod 8)$, we have $r \equiv 5(\bmod 8)$, so that $r \geq 5$. Hence $(2 \ell+1)^{2}+4 \geq 5 p$, implying $\ell \geq(\sqrt{5 p-4}-1) / 2$. Set $\sqrt{5 p-4}=u$ for clarity; then $\ell \geq(u-1) / 2$. Therefore

$$
n=\frac{p-1}{2}-\ell \leq \frac{1}{2}(p-u) .
$$

Combined with $p=\left(u^{2}+4\right) / 5$, this leads to $u^{2}-5 u-10 n+4 \geq 0$. Solving this quadratic inequality with respect to $u \geq 0$ gives $u \geq(5+\sqrt{40 n+9}) / 2$. So the estimate $n \leq(p-u) / 2$ leads to

$$
p \geq 2 n+u \geq 2 n+\frac{1}{2}(5+\sqrt{40 n+9})>2 n+\sqrt{10 n}
$$

Since there are infinitely many primes of the form $8 k+1$, it follows easily that there are also infinitely many $n$ with the stated property.

Comment. By considering the prime factorization of the product $\prod_{n=1}^{N}\left(n^{2}+1\right)$, it can be obtained that its greatest prime divisor is at least $c N \log N$. This could improve the statement as $p>n \log n$.

However, the proof applies some advanced information about the distribution of the primes of the form $4 k+1$, which is inappropriate for high schools contests.",270,3
2007a1,"A1. Given a sequence $a_1, a_2, \ldots, a_n$ of real numbers. For each $i(1 \leq i \leq n)$ define
$$
d_i=\max \left\{a_j: 1 \leq j \leq i\right\}-\min \left\{a_j: i \leq j \leq n\right\}
$$
and let
$$
d=\max \left\{d_i: 1 \leq i \leq n\right\} .
$$
(a) Prove that for arbitrary real numbers $x_1 \leq x_2 \leq \ldots \leq x_n$,
$$
\max \left\{\left|x_i-a_i\right|: 1 \leq i \leq n\right\} \geq \frac{d}{2} .
$$
(b) Show that there exists a sequence $x_1 \leq x_2 \leq \ldots \leq x_n$ of real numbers such that we have equality in (1).","(a) Let $1 \leq p \leq q \leq r \leq n$ be indices for which
$$
d=d_q, \quad a_p=\max \left\{a_j: 1 \leq j \leq q\right\}, \quad a_r=\min \left\{a_j: q \leq j \leq n\right\}
$$
and thus $d=a_p-a_r$. (These indices are not necessarily unique.)

For arbitrary real numbers $x_1 \leq x_2 \leq \ldots \leq x_n$, consider just the two quantities $\left|x_p-a_p\right|$ and $\left|x_r-a_r\right|$. Since
$$
\left(a_p-x_p\right)+\left(x_r-a_r\right)=\left(a_p-a_r\right)+\left(x_r-x_p\right) \geq a_p-a_r=d
$$
we have either $a_p-x_p \geq \frac{d}{2}$ or $x_r-a_r \geq \frac{d}{2}$. Hence,
$$
\max \left\{\left|x_i-a_i\right|: 1 \leq i \leq n\right\} \geq \max \left\{\left|x_p-a_p\right|,\left|x_r-a_r\right|\right\} \geq \max \left\{a_p-x_p, x_r-a_r\right\} \geq \frac{d}{2}
$$

(b) Define the sequence $\left(x_k\right)$ as
$$
x_1=a_1-\frac{d}{2}, \quad x_k=\max \left\{x_{k-1}, a_k-\frac{d}{2}\right\} \quad \text { for } 2 \leq k \leq n .
$$

We show that we have equality in (1) for this sequence.
By the definition, sequence $\left(x_k\right)$ is non-decreasing and $x_k-a_k \geq-\frac{d}{2}$ for all $1 \leq k \leq n$. Next we prove that
$$
x_k-a_k \leq \frac{d}{2} \quad \text { for all } 1 \leq k \leq n
$$

Consider an arbitrary index $1 \leq k \leq n$. Let $\ell \leq k$ be the smallest index such that $x_k=x_{\ell}$. We have either $\ell=1$, or $\ell \geq 2$ and $x_{\ell}>x_{\ell-1}$. In both cases,
$$
x_k=x_{\ell}=a_{\ell}-\frac{d}{2} .
$$

Since
$$
a_{\ell}-a_k \leq \max \left\{a_j: 1 \leq j \leq k\right\}-\min \left\{a_j: k \leq j \leq n\right\}=d_k \leq d
$$
equality (3) implies
$$
x_k-a_k=a_{\ell}-a_k-\frac{d}{2} \leq d-\frac{d}{2}=\frac{d}{2} .
$$

We obtained that $-\frac{d}{2} \leq x_k-a_k \leq \frac{d}{2}$ for all $1 \leq k \leq n$, so
$$
\max \left\{\left|x_i-a_i\right|: 1 \leq i \leq n\right\} \leq \frac{d}{2} .
$$

We have equality because $\left|x_1-a_1\right|=\frac{d}{2}$.",268,3
2007a3,"A3. Let $n$ be a positive integer, and let $x$ and $y$ be positive real numbers such that $x^n+y^n=1$. Prove that
$$
\left(\sum_{k=1}^n \frac{1+x^{2 k}}{1+x^{4 k}}\right)\left(\sum_{k=1}^n \frac{1+y^{2 k}}{1+y^{4 k}}\right)<\frac{1}{(1-x)(1-y)} .
$$
(Estonia)","For each real $t \in(0,1)$,
$$
\frac{1+t^2}{1+t^4}=\frac{1}{t}-\frac{(1-t)\left(1-t^3\right)}{t\left(1+t^4\right)}<\frac{1}{t}
$$

Substituting $t=x^k$ and $t=y^k$,
$$
0<\sum_{k=1}^n \frac{1+x^{2 k}}{1+x^{4 k}}<\sum_{k=1}^n \frac{1}{x^k}=\frac{1-x^n}{x^n(1-x)} \quad \text { and } \quad 0<\sum_{k=1}^n \frac{1+y^{2 k}}{1+y^{4 k}}<\sum_{k=1}^n \frac{1}{y^k}=\frac{1-y^n}{y^n(1-y)} .
$$

Since $1-y^n=x^n$ and $1-x^n=y^n$,
$$
\frac{1-x^n}{x^n(1-x)}=\frac{y^n}{x^n(1-x)}, \quad \frac{1-y^n}{y^n(1-y)}=\frac{x^n}{y^n(1-y)}
$$
and therefore
$$
\left(\sum_{k=1}^n \frac{1+x^{2 k}}{1+x^{4 k}}\right)\left(\sum_{k=1}^n \frac{1+y^{2 k}}{1+y^{4 k}}\right)<\frac{y^n}{x^n(1-x)} \cdot \frac{x^n}{y^n(1-y)}=\frac{1}{(1-x)(1-y)} .
$$",54,1
2007a5,"A5. Let $c>2$, and let $a(1), a(2), \ldots$ be a sequence of nonnegative real numbers such that
$$
a(m+n) \leq 2 a(m)+2 a(n) \quad \text { for all } m, n \geq 1
$$
and
$$
a\left(2^k\right) \leq \frac{1}{(k+1)^c} \quad \text { for all } k \geq 0
$$
Prove that the sequence $a(n)$ is bounded.
","For convenience, define $a(0)=0$; then condition (1) persists for all pairs of nonnegative indices.
Lemma 1. For arbitrary nonnegative indices $n_1, \ldots, n_k$, we have
$$
a\left(\sum_{i=1}^k n_i\right) \leq \sum_{i=1}^k 2^i a\left(n_i\right)
$$
and
$$
a\left(\sum_{i=1}^k n_i\right) \leq 2 k \sum_{i=1}^k a\left(n_i\right) .
$$

Proof. Inequality (3) is proved by induction on $k$. The base case $k=1$ is trivial, while the induction step is provided by
$$
a\left(\sum_{i=1}^{k+1} n_i\right)=a\left(n_1+\sum_{i=2}^{k+1} n_i\right) \leq 2 a\left(n_1\right)+2 a\left(\sum_{i=1}^k n_{i+1}\right) \leq 2 a\left(n_1\right)+2 \sum_{i=1}^k 2^i a\left(n_{i+1}\right)=\sum_{i=1}^{k+1} 2^i a\left(n_i\right) .
$$

To establish (4), first the inequality
$$
a\left(\sum_{i=1}^{2^d} n_i\right) \leq 2^d \sum_{i=1}^{2^d} a\left(n_i\right)
$$
can be proved by an obvious induction on $d$. Then, turning to (4), we find an integer $d$ such that $2^{d-1}<k \leq 2^d$ to obtain
$$
a\left(\sum_{i=1}^k n_i\right)=a\left(\sum_{i=1}^k n_i+\sum_{i=k+1}^{2^d} 0\right) \leq 2^d\left(\sum_{i=1}^k a\left(n_i\right)+\sum_{i=k+1}^{2^d} a(0)\right)=2^d \sum_{i=1}^k a\left(n_i\right) \leq 2 k \sum_{i=1}^k a\left(n_i\right) .
$$

Fix an increasing unbounded sequence $0=M_0<M_1<M_2<\ldots$ of real numbers; the exact values will be defined later. Let $n$ be an arbitrary positive integer and write
$$
n=\sum_{i=0}^d \varepsilon_i \cdot 2^i, \quad \text { where } \varepsilon_i \in\{0,1\}
$$

Set $\varepsilon_i=0$ for $i>d$, and take some positive integer $f$ such that $M_f>d$. Applying (3), we get
$$
a(n)=a\left(\sum_{k=1}^f \sum_{M_{k-1} \leq i<M_k} \varepsilon_i \cdot 2^i\right) \leq \sum_{k=1}^f 2^k a\left(\sum_{M_{k-1} \leq i<M_k} \varepsilon_i \cdot 2^i\right) .
$$

Note that there are less than $M_k-M_{k-1}+1$ integers in interval $\left[M_{k-1}, M_k\right.$ ); hence, using (4) we have
$$
\begin{aligned}
a(n) & \leq \sum_{k=1}^f 2^k \cdot 2\left(M_k-M_{k-1}+1\right) \sum_{M_{k-1} \leq i<M_k} \varepsilon_i \cdot a\left(2^i\right) \\
& \leq \sum_{k=1}^f 2^k \cdot 2\left(M_k-M_{k-1}+1\right)^2 \max _{M_{k-1} \leq i<M_k} a\left(2^i\right) \\
& \leq \sum_{k=1}^f 2^{k+1}\left(M_k+1\right)^2 \cdot \frac{1}{\left(M_{k-1}+1\right)^c}=\sum_{k=1}^f\left(\frac{M_k+1}{M_{k-1}+1}\right)^2 \frac{2^{k+1}}{\left(M_{k-1}+1\right)^{c-2}} .
\end{aligned}
$$

Setting $M_k=4^{k /(c-2)}-1$, we obtain
$$
a(n) \leq \sum_{k=1}^f 4^{2 /(c-2)} \frac{2^{k+1}}{\left(4^{(k-1) /(c-2)}\right)^{c-2}}=8 \cdot 4^{2 /(c-2)} \sum_{k=1}^f\left(\frac{1}{2}\right)^k<8 \cdot 4^{2 /(c-2)}
$$
and the sequence $a(n)$ is bounded.",299,3
2007a6,"A6. Let $a_1, a_2, \ldots, a_{100}$ be nonnegative real numbers such that $a_1^2+a_2^2+\ldots+a_{100}^2=1$. Prove that
$$
a_1^2 a_2+a_2^2 a_3+\ldots+a_{100}^2 a_1<\frac{12}{25} .
$$","Solution. Let $S=\sum_{k=1}^{100} a_k^2 a_{k+1}$. (As usual, we consider the indices modulo 100, e.g. we set $a_{101}=a_1$ and $a_{102}=a_2$.)

Applying the Cauchy-Schwarz inequality to sequences $\left(a_{k+1}\right)$ and $\left(a_k^2+2 a_{k+1} a_{k+2}\right)$, and then the AM-GM inequality to numbers $a_{k+1}^2$ and $a_{k+2}^2$,
$$
\begin{aligned}
(3 S)^2 & =\left(\sum_{k=1}^{100} a_{k+1}\left(a_k^2+2 a_{k+1} a_{k+2}\right)\right)^2 \leq\left(\sum_{k=1}^{100} a_{k+1}^2\right)\left(\sum_{k=1}^{100}\left(a_k^2+2 a_{k+1} a_{k+2}\right)^2\right) \\
& =1 \cdot \sum_{k=1}^{100}\left(a_k^2+2 a_{k+1} a_{k+2}\right)^2=\sum_{k=1}^{100}\left(a_k^4+4 a_k^2 a_{k+1} a_{k+2}+4 a_{k+1}^2 a_{k+2}^2\right) \\
& \leq \sum_{k=1}^{100}\left(a_k^4+2 a_k^2\left(a_{k+1}^2+a_{k+2}^2\right)+4 a_{k+1}^2 a_{k+2}^2\right)=\sum_{k=1}^{100}\left(a_k^4+6 a_k^2 a_{k+1}^2+2 a_k^2 a_{k+2}^2\right) .
\end{aligned}
$$

Applying the trivial estimates
$$
\sum_{k=1}^{100}\left(a_k^4+2 a_k^2 a_{k+1}^2+2 a_k^2 a_{k+2}^2\right) \leq\left(\sum_{k=1}^{100} a_k^2\right)^2 \quad \text { and } \quad \sum_{k=1}^{100} a_k^2 a_{k+1}^2 \leq\left(\sum_{i=1}^{50} a_{2 i-1}^2\right)\left(\sum_{j=1}^{50} a_{2 j}^2\right)
$$
we obtain that
$$
(3 S)^2 \leq\left(\sum_{k=1}^{100} a_k^2\right)^2+4\left(\sum_{i=1}^{50} a_{2 i-1}^2\right)\left(\sum_{j=1}^{50} a_{2 j}^2\right) \leq 1+\left(\sum_{i=1}^{50} a_{2 i-1}^2+\sum_{j=1}^{50} a_{2 j}^2\right)^2=2,
$$
hence
$$
S \leq \frac{\sqrt{2}}{3} \approx 0.4714<\frac{12}{25}=0.48 .
$$

Comment 1. By applying the Lagrange multiplier method, one can see that the maximum is attained at values of $a_i$ satisfying
$$
a_{k-1}^2+2 a_k a_{k+1}=2 \lambda a_k
$$
for all $k=1,2, \ldots, 100$. Though this system of equations seems hard to solve, it can help to find the estimate above; it may suggest to have a closer look at the expression $a_{k-1}^2 a_k+2 a_k^2 a_{k+1}$.

Moreover, if the numbers $a_1, \ldots, a_{100}$ satisfy (2), we have equality in (1). (See also Comment 3.)
Comment 2. It is natural to ask what is the best constant $c_n$ in the inequality
$$
a_1^2 a_2+a_2^2 a_3+\ldots+a_n^2 a_1 \leq c_n\left(a_1^2+a_2^2+\ldots+a_n^2\right)^{3 / 2}
$$

For $1 \leq n \leq 4$ one may prove $c_n=1 / \sqrt{n}$ which is achieved when $a_1=a_2=\ldots=a_n$. However, the situation changes completely if $n \geq 5$. In this case we do not know the exact value of $c_n$. By computer search it can be found that $c_n \approx 0.4514$ and it is realized for example if
$$
a_1 \approx 0.5873, \quad a_2 \approx 0.6771, \quad a_3 \approx 0.4224, \quad a_4 \approx 0.1344, \quad a_5 \approx 0.0133
$$
and $a_k \approx 0$ for $k \geq 6$. This example also proves that $c_n>0.4513$.Let $a_1, a_2, \ldots, a_{100}$ be nonnegative real numbers such that $a_1^2+a_2^2+\ldots+a_{100}^2=1$. Prove that
$$
a_1^2 a_2+a_2^2 a_3+\ldots+a_{100}^2 a_1<\frac{12}{25} .
$$
(Poland)
Solution. Let $S=\sum_{k=1}^{100} a_k^2 a_{k+1}$. (As usual, we consider the indices modulo 100, e.g. we set $a_{101}=a_1$ and $a_{102}=a_2$.)

Applying the Cauchy-Schwarz inequality to sequences $\left(a_{k+1}\right)$ and $\left(a_k^2+2 a_{k+1} a_{k+2}\right)$, and then the AM-GM inequality to numbers $a_{k+1}^2$ and $a_{k+2}^2$,
$$
\begin{aligned}
(3 S)^2 & =\left(\sum_{k=1}^{100} a_{k+1}\left(a_k^2+2 a_{k+1} a_{k+2}\right)\right)^2 \leq\left(\sum_{k=1}^{100} a_{k+1}^2\right)\left(\sum_{k=1}^{100}\left(a_k^2+2 a_{k+1} a_{k+2}\right)^2\right) \\
& =1 \cdot \sum_{k=1}^{100}\left(a_k^2+2 a_{k+1} a_{k+2}\right)^2=\sum_{k=1}^{100}\left(a_k^4+4 a_k^2 a_{k+1} a_{k+2}+4 a_{k+1}^2 a_{k+2}^2\right) \\
& \leq \sum_{k=1}^{100}\left(a_k^4+2 a_k^2\left(a_{k+1}^2+a_{k+2}^2\right)+4 a_{k+1}^2 a_{k+2}^2\right)=\sum_{k=1}^{100}\left(a_k^4+6 a_k^2 a_{k+1}^2+2 a_k^2 a_{k+2}^2\right) .
\end{aligned}
$$

Applying the trivial estimates
$$
\sum_{k=1}^{100}\left(a_k^4+2 a_k^2 a_{k+1}^2+2 a_k^2 a_{k+2}^2\right) \leq\left(\sum_{k=1}^{100} a_k^2\right)^2 \quad \text { and } \quad \sum_{k=1}^{100} a_k^2 a_{k+1}^2 \leq\left(\sum_{i=1}^{50} a_{2 i-1}^2\right)\left(\sum_{j=1}^{50} a_{2 j}^2\right)
$$
we obtain that
$$
(3 S)^2 \leq\left(\sum_{k=1}^{100} a_k^2\right)^2+4\left(\sum_{i=1}^{50} a_{2 i-1}^2\right)\left(\sum_{j=1}^{50} a_{2 j}^2\right) \leq 1+\left(\sum_{i=1}^{50} a_{2 i-1}^2+\sum_{j=1}^{50} a_{2 j}^2\right)^2=2,
$$
hence
$$
S \leq \frac{\sqrt{2}}{3} \approx 0.4714<\frac{12}{25}=0.48 .
$$

Comment 1. By applying the Lagrange multiplier method, one can see that the maximum is attained at values of $a_i$ satisfying
$$
a_{k-1}^2+2 a_k a_{k+1}=2 \lambda a_k
$$
for all $k=1,2, \ldots, 100$. Though this system of equations seems hard to solve, it can help to find the estimate above; it may suggest to have a closer look at the expression $a_{k-1}^2 a_k+2 a_k^2 a_{k+1}$.

Moreover, if the numbers $a_1, \ldots, a_{100}$ satisfy (2), we have equality in (1). (See also Comment 3.)
Comment 2. It is natural to ask what is the best constant $c_n$ in the inequality
$$
a_1^2 a_2+a_2^2 a_3+\ldots+a_n^2 a_1 \leq c_n\left(a_1^2+a_2^2+\ldots+a_n^2\right)^{3 / 2}
$$

For $1 \leq n \leq 4$ one may prove $c_n=1 / \sqrt{n}$ which is achieved when $a_1=a_2=\ldots=a_n$. However, the situation changes completely if $n \geq 5$. In this case we do not know the exact value of $c_n$. By computer search it can be found that $c_n \approx 0.4514$ and it is realized for example if
$$
a_1 \approx 0.5873, \quad a_2 \approx 0.6771, \quad a_3 \approx 0.4224, \quad a_4 \approx 0.1344, \quad a_5 \approx 0.0133
$$
and $a_k \approx 0$ for $k \geq 6$. This example also proves that $c_n>0.4513$.

Comment 3. The solution can be improved in several ways to give somewhat better bounds for $c_n$. Here we show a variant which proves $c_n<0.4589$ for $n \geq 5$.

The value of $c_n$ does not change if negative values are also allowed in (3). So the problem is equivalent to maximizing
$$
f\left(a_1, a_2, \ldots, a_n\right)=a_1^2 a_2+a_2^2 a_3+\ldots+a_n^2 a_1
$$
on the unit sphere $a_1^2+a_2^2+\ldots+a_n^2=1$ in $\mathbb{R}^n$. Since the unit sphere is compact, the function has a maximum and we can apply the Lagrange multiplier method; for each maximum point there exists a real number $\lambda$ such that
$$
a_{k-1}^2+2 a_k a_{k+1}=\lambda \cdot 2 a_k \quad \text { for all } k=1,2, \ldots, n .
$$

Then
$$
3 S=\sum_{k=1}^n\left(a_{k-1}^2 a_k+2 a_k^2 a_{k+1}\right)=\sum_{k=1}^n 2 \lambda a_k^2=2 \lambda
$$
and therefore
$$
a_{k-1}^2+2 a_k a_{k+1}=3 S a_k \quad \text { for all } k=1,2, \ldots, n
$$

From (4) we can derive
$$
9 S^2=\sum_{k=1}^n\left(3 S a_k\right)^2=\sum_{k=1}^n\left(a_{k-1}^2+2 a_k a_{k+1}\right)^2=\sum_{k=1}^n a_k^4+4 \sum_{k=1}^n a_k^2 a_{k+1}^2+4 \sum_{k=1}^n a_k^2 a_{k+1} a_{k+2}
$$
and
$$
3 S^2=\sum_{k=1}^n 3 S a_{k-1}^2 a_k=\sum_{k=1}^n a_{k-1}^2\left(a_{k-1}^2+2 a_k a_{k+1}\right)=\sum_{k=1}^n a_k^4+2 \sum_{k=1}^n a_k^2 a_{k+1} a_{k+2} .
$$

Let $p$ be a positive number. Combining (5) and (6) and applying the AM-GM inequality,
$$
\begin{aligned}
(9+3 p) S^2 & =(1+p) \sum_{k=1}^n a_k^4+4 \sum_{k=1}^n a_k^2 a_{k+1}^2+(4+2 p) \sum_{k=1}^n a_k^2 a_{k+1} a_{k+2} \\
& \leq(1+p) \sum_{k=1}^n a_k^4+4 \sum_{k=1}^n a_k^2 a_{k+1}^2+\sum_{k=1}^n\left(2(1+p) a_k^2 a_{k+2}^2+\frac{(2+p)^2}{2(1+p)} a_k^2 a_{k+1}^2\right) \\
& =(1+p) \sum_{k=1}^n\left(a_k^4+2 a_k^2 a_{k+1}^2+2 a_k^2 a_{k+2}^2\right)+\left(4+\frac{(2+p)^2}{2(1+p)}-2(1+p)\right) \sum_{k=1}^n a_k^2 a_{k+1}^2 \\
& \leq(1+p)\left(\sum_{k=1}^n a_k^2\right)^2+\frac{8+4 p-3 p^2}{2(1+p)} \sum_{k=1}^n a_k^2 a_{k+1}^2 \\
& =(1+p)+\frac{8+4 p-3 p^2}{2(1+p)} \sum_{k=1}^n a_k^2 a_{k+1}^2 .
\end{aligned}
$$

Setting $p=\frac{2+2 \sqrt{7}}{3}$ which is the positive root of $8+4 p-3 p^2=0$, we obtain
$$
S \leq \sqrt{\frac{1+p}{9+3 p}}=\sqrt{\frac{5+2 \sqrt{7}}{33+6 \sqrt{7}}} \approx 0.458879
$$",973,4
2007c2,"C2. A unit square is dissected into $n>1$ rectangles such that their sides are parallel to the sides of the square. Any line, parallel to a side of the square and intersecting its interior, also intersects the interior of some rectangle. Prove that in this dissection, there exists a rectangle having no point on the boundary of the square.","Call the directions of the sides of the square horizontal and vertical. A horizontal or vertical line, which intersects the interior of the square but does not intersect the interior of any rectangle, will be called a splitting line. A rectangle having no point on the boundary of the square will be called an interior rectangle.

Suppose, to the contrary, that there exists a dissection of the square into more than one rectangle, such that no interior rectangle and no splitting line appear. Consider such a dissection with the least possible number of rectangles. Notice that this number of rectangles is greater than 2 , otherwise their common side provides a splitting line.

If there exist two rectangles having a common side, then we can replace them by their union (see Figure 1). The number of rectangles was greater than 2, so in a new dissection it is greater than 1. Clearly, in the new dissection, there is also no splitting line as well as no interior rectangle. This contradicts the choice of the original dissection.

Denote the initial square by $A B C D$, with $A$ and $B$ being respectively the lower left and lower right vertices. Consider those two rectangles $a$ and $b$ containing vertices $A$ and $B$, respectively. (Note that $a \neq b$, otherwise its top side provides a splitting line.) We can assume that the height of $a$ is not greater than that of $b$. Then consider the rectangle $c$ neighboring to the lower right corner of $a$ (it may happen that $c=b$ ). By aforementioned, the heights of $a$ and $c$ are distinct. Then two cases are possible.

Case 1. The height of $c$ is less than that of $a$. Consider the rectangle $d$ which is adjacent to both $a$ and $c$, i. e. the one containing the angle marked in Figure 2. This rectangle has no common point with $B C$ (since $a$ is not higher than $b$ ), as well as no common point with $A B$ or with $A D$ (obviously). Then $d$ has a common point with $C D$, and its left side provides a splitting line. Contradiction.

Case 2. The height of $c$ is greater than that of $a$. Analogously, consider the rectangle $d$ containing the angle marked on Figure 3. It has no common point with $A D$ (otherwise it has a common side with $a$ ), as well as no common point with $A B$ or with $B C$ (obviously). Then $d$ has a common point with $C D$. Hence its right side provides a splitting line, and we get the contradiction again.
",435,3
2007c4,"C4. Let $A_0=\left(a_1, \ldots, a_n\right)$ be a finite sequence of real numbers. For each $k \geq 0$, from the sequence $A_k=\left(x_1, \ldots, x_n\right)$ we construct a new sequence $A_{k+1}$ in the following way.
1. We choose a partition $\{1, \ldots, n\}=I \cup J$, where $I$ and $J$ are two disjoint sets, such that the expression
$$
\left|\sum_{i \in I} x_i-\sum_{j \in J} x_j\right|
$$
attains the smallest possible value. (We allow the sets $I$ or $J$ to be empty; in this case the corresponding sum is 0 .) If there are several such partitions, one is chosen arbitrarily.
2. We set $A_{k+1}=\left(y_1, \ldots, y_n\right)$, where $y_i=x_i+1$ if $i \in I$, and $y_i=x_i-1$ if $i \in J$.

Prove that for some $k$, the sequence $A_k$ contains an element $x$ such that $|x| \geq n / 2$.","Solution.
Lemma. Suppose that all terms of the sequence $\left(x_1, \ldots, x_n\right)$ satisfy the inequality $\left|x_i\right|<a$. Then there exists a partition $\{1,2, \ldots, n\}=I \cup J$ into two disjoint sets such that
$$
\left|\sum_{i \in I} x_i-\sum_{j \in J} x_j\right|<a .
$$

Proof. Apply an induction on $n$. The base case $n=1$ is trivial. For the induction step, consider a sequence $\left(x_1, \ldots, x_n\right)(n>1)$. By the induction hypothesis there exists a splitting $\{1, \ldots, n-1\}=I^{\prime} \cup J^{\prime}$ such that
$$
\left|\sum_{i \in I^{\prime}} x_i-\sum_{j \in J^{\prime}} x_j\right|<a .
$$

For convenience, suppose that $\sum_{i \in I^{\prime}} x_i \geq \sum_{j \in J^{\prime}} x_j$. If $x_n \geq 0$ then choose $I=I^{\prime}, J=J \cup\{n\}$; otherwise choose $I=I^{\prime} \cup\{n\}, J=J^{\prime}$. In both cases, we have $\sum_{i \in I^{\prime}} x_i-\sum_{j \in J^{\prime}} x_j \in[0, a)$ and $\left|x_n\right| \in[0, a) ;$ hence
$$
\sum_{i \in I} x_i-\sum_{j \in J} x_j=\sum_{i \in I^{\prime}} x_i-\sum_{j \in J^{\prime}} x_j-\left|x_n\right| \in(-a, a),
$$
as desired.
Let us turn now to the problem. To the contrary, assume that for all $k$, all the numbers in $A_k$ lie in interval $(-n / 2, n / 2)$. Consider an arbitrary sequence $A_k=\left(b_1, \ldots, b_n\right)$. To obtain the term $b_i$, we increased and decreased number $a_i$ by one several times. Therefore $b_i-a_i$ is always an integer, and there are not more than $n$ possible values for $b_i$. So, there are not more than $n^n$ distinct possible sequences $A_k$, and hence two of the sequences $A_1, A_2, \ldots, A_{n^n+1}$ should be identical, say $A_p=A_q$ for some $p<q$.

For any positive integer $k$, let $S_k$ be the sum of squares of elements in $A_k$. Consider two consecutive sequences $A_k=\left(x_1, \ldots, x_n\right)$ and $A_{k+1}=\left(y_1, \ldots, y_n\right)$. Let $\{1,2, \ldots, n\}=I \cup J$ be the partition used in this step - that is, $y_i=x_i+1$ for all $i \in I$ and $y_j=x_j-1$ for all $j \in J$. Since the value of $\left|\sum_{i \in I} x_i-\sum_{j \in J} x_j\right|$ is the smallest possible, the Lemma implies that it is less than $n / 2$. Then we have
$$
S_{k+1}-S_k=\sum_{i \in I}\left(\left(x_i+1\right)^2-x_i^2\right)+\sum_{j \in J}\left(\left(x_j-1\right)^2-x_j^2\right)=n+2\left(\sum_{i \in I} x_i-\sum_{j \in J} x_j\right)>n-2 \cdot \frac{n}{2}=0 .
$$

Thus we obtain $S_q>S_{q-1}>\cdots>S_p$. This is impossible since $A_p=A_q$ and hence $S_p=S_q$.",365,3
2007c5,"C5. In the Cartesian coordinate plane define the strip $S_n=\{(x, y) \mid n \leq x<n+1\}$ for every integer $n$. Assume that each strip $S_n$ is colored either red or blue, and let $a$ and $b$ be two distinct positive integers. Prove that there exists a rectangle with side lengths $a$ and $b$ such that its vertices have the same color.","Solution. If $S_n$ and $S_{n+a}$ have the same color for some integer $n$, then we can choose the rectangle with vertices $(n, 0) \in S_n,(n, b) \in S_n,(n+a, 0) \in S_{n+a}$, and $(n+a, b) \in S_{n+a}$, and we are done. So it can be assumed that $S_n$ and $S_{n+a}$ have opposite colors for each $n$.

Similarly, it also can be assumed that $S_n$ and $S_{n+b}$ have opposite colors. Then, by induction on $|p|+|q|$, we obtain that for arbitrary integers $p$ and $q$, strips $S_n$ and $S_{n+p a+q b}$ have the same color if $p+q$ is even, and these two strips have opposite colors if $p+q$ is odd.

Let $d=\operatorname{gcd}(a, b), a_1=a / d$ and $b_1=b / d$. Apply the result above for $p=b_1$ and $q=-a_1$. The strips $S_0$ and $S_{0+b_1 a-a_1 b}$ are identical and therefore they have the same color. Hence, $a_1+b_1$ is even. By the construction, $a_1$ and $b_1$ are coprime, so this is possible only if both are odd.

Without loss of generality, we can assume $a>b$. Then $a_1>b_1 \geq 1$, so $a_1 \geq 3$.
Choose integers $k$ and $\ell$ such that $k a_1-\ell b_1=1$ and therefore $k a-\ell b=d$. Since $a_1$ and $b_1$ are odd, $k+\ell$ is odd as well. Hence, for every integer $n$, strips $S_n$ and $S_{n+k a-\ell b}=S_{n+d}$ have opposite colors. This also implies that the coloring is periodic with period $2 d$, i.e. strips $S_n$ and $S_{n+2 d}$ have the same color for every $n$.

Figure 1
We will construct the desired rectangle $A B C D$ with $A B=C D=a$ and $B C=A D=b$ in a position such that vertex $A$ lies on the $x$-axis, and the projection of side $A B$ onto the $x$-axis is of length $2 d$ (see Figure 1). This is possible since $a=a_1 d>2 d$. The coordinates of the vertices will have the forms
$$
A=(t, 0), \quad B=\left(t+2 d, y_1\right), \quad C=\left(u+2 d, y_2\right), \quad D=\left(u, y_3\right)
$$

Let $\varphi=\sqrt{a_1^2-4}$. By Pythagoras' theorem,
$$
y_1=B B_0=\sqrt{a^2-4 d^2}=d \sqrt{a_1^2-4}=d \varphi .
$$

So, by the similar triangles $A D D_0$ and $B A B_0$, we have the constraint
$$
u-t=A D_0=\frac{A D}{A B} \cdot B B_0=\frac{b d}{a} \varphi
$$

for numbers $t$ and $u$. Computing the numbers $y_2$ and $y_3$ is not required since they have no effect to the colors.

Observe that the number $\varphi$ is irrational, because $\varphi^2$ is an integer, but $\varphi$ is not: $a_1>\varphi \geq$ $\sqrt{a_1^2-2 a_1+2}>a_1-1$.

By the periodicity, points $A$ and $B$ have the same color; similarly, points $C$ and $D$ have the same color. Furthermore, these colors depend only on the values of $t$ and $u$. So it is sufficient to choose numbers $t$ and $u$ such that vertices $A$ and $D$ have the same color.

Let $w$ be the largest positive integer such that there exist $w$ consecutive strips $S_{n_0}, S_{n_0+1}, \ldots$, $S_{n_0+w-1}$ with the same color, say red. (Since $S_{n_0+d}$ must be blue, we have $w \leq d$.) We will choose $t$ from the interval $\left(n_0, n_0+w\right)$.

Figure 2
Consider the interval $I=\left(n_0+\frac{b d}{a} \varphi, n_0+\frac{b d}{a} \varphi+w\right)$ on the $x$-axis (see Figure 2). Its length is $w$, and the end-points are irrational. Therefore, this interval intersects $w+1$ consecutive strips. Since at most $w$ consecutive strips may have the same color, interval $I$ must contain both red and blue points. Choose $u \in I$ such that the line $x=u$ is red and set $t=u-\frac{b d}{a} \varphi$, according to the constraint (1). Then $t \in\left(n_0, n_0+w\right)$ and $A=(t, 0)$ is red as well as $D=\left(u, y_3\right)$.

Hence, variables $u$ and $t$ can be set such that they provide a rectangle with four red vertices.
Comment. The statement is false for squares, i.e. in the case $a=b$. If strips $S_{2 k a}, S_{2 k a+1}, \ldots$, $S_{(2 k+1) a-1}$ are red, and strips $S_{(2 k+1) a}, S_{(2 k+1) a+1}, \ldots, S_{(2 k+2) a-1}$ are blue for every integer $k$, then each square of size $a \times a$ has at least one red and at least one blue vertex as well.",671,4
2007c6,"In a mathematical competition some competitors are friends; friendship is always mutual. 
Call a group of competitors a \textit{clique} if each two of them are friends. 
The number of members in a clique is called its \textit{size}.

It is known that the largest size of cliques is even. Prove that the competitors can be arranged in two rooms such that the largest size of cliques in one room is the same as the largest size of cliques in the other room.





","\textbf{Solution.} We present an algorithm to arrange the competitors. Let the two rooms be \textit{Room A} and \textit{Room B}. We start with an initial arrangement, then we modify it several times by sending one person to the other room. At any state of the algorithm, $A$ and $B$ denote the sets of the competitors in the rooms, and $c(A)$ and $c(B)$ denote the largest sizes of cliques in the rooms, respectively.

\textbf{Step 1.} \textit{Let $M$ be one of the cliques of largest size, $|M| = 2m$. Send all members of $M$ to Room A and all other competitors to Room B.}

Since $M$ is a clique of the largest size, we have $c(A) = |M| \ge c(B)$.

\textbf{Step 2.} \textit{While $c(A) > c(B)$, send one person from Room A to Room B.}

\begin{center}
\includegraphics[width=0.5\textwidth]{diagram_step2.png}
\end{center}

Note that $c(A) > c(B)$ implies that Room A is not empty.

In each step, $c(A)$ decreases by one and $c(B)$ increases by at most one. So at the end we have $c(A) \le c(B) \le c(A) + 1$.

We also have $c(A) = |A| \ge m$ at the end. Otherwise we would have at least $m+1$ members of $M$ in Room B and at most $m-1$ in Room A, implying $c(B) - c(A) \ge (m+1)-(m-1) = 2$.

\textbf{Step 3.} Let $k = c(A)$. \textit{If $c(B) = k$ then STOP.}

If we reached $c(A) = c(B) = k$ then we have found the desired arrangement.

In all other cases we have $c(B) = k + 1$.

From the estimate above we also know that $k = |A| = |A \cap M| \ge m$ and $|B \cap M| \le m$.

\textbf{Step 4.} \textit{If there exists a competitor $x \in B \cap M$ and a clique $C \subseteq B$ such that $|C| = k + 1$ and $x \notin C$, then move $x$ to Room A and STOP.}

\begin{center}
\includegraphics[width=0.5\textwidth]{diagram_step4.png}
\end{center}

After moving $x$ back to Room A, we will have $k + 1$ members of $M$ in Room A, thus $c(A) = k + 1$. Due to $x \notin C$, $c(B) = |C|$ is not decreased, and after this step we have $c(A) = c(B) = k + 1$.

If there is no such competitor $x$, then in Room B, all cliques of size $k + 1$ contain $B \cap M$ as a subset.

\textbf{Step 5.} \textit{While $c(B) = k + 1$, choose a clique $C \subseteq B$ such that $|C| = k + 1$ and move one member of $C \setminus M$ to Room A.}

\begin{center}
\includegraphics[width=0.5\textwidth]{diagram_step5.png}
\end{center}

Note that $|C| = k + 1 > m \ge |B \cap M|$, so $C \setminus M$ cannot be empty.

Every time we move a single person from Room B to Room A, so $c(B)$ decreases by at most 1. Hence, at the end of this loop we have $c(B) = k$.

In Room A we have the clique $A \cap M$ with size $|A \cap M| = k$ thus $c(A) \ge k$. We prove that there is no clique of larger size there. Let $Q \subseteq A$ be an arbitrary clique. We show that $|Q| \le k$.

\begin{center}
\includegraphics[width=0.5\textwidth]{diagram_step5_proof.png}
\end{center}

In Room A, and especially in set $Q$, there can be two types of competitors:
\begin{itemize}
    \item Some members of $M$. Since $M$ is a clique, they are friends with all members of $B \cap M$.
    \item Competitors who were moved to Room A in Step 5. Each of them has been in a clique with $B \cap M$ so they are also friends with all members of $B \cap M$.
\end{itemize}

Hence, all members of $Q$ are friends with all members of $B \cap M$. Sets $Q$ and $B \cap M$ are cliques themselves, so $Q \cup (B \cap M)$ is also a clique. Since $M$ is a clique of the largest size,

\[
|M| \ge |Q \cup (B \cap M)| = |Q| + |B \cap M| = |Q| + |M| - |A \cap M|,
\]

therefore
\[
|Q| \le |A \cap M| = k.
\]

Finally, after Step 5 we have $c(A) = c(B) = k$.

\textbf{Comment.} Obviously, the statement is false without the assumption that the largest clique size is even.
",698,4
2007c7,"Let $\alpha < \dfrac{3 - \sqrt{5}}{2}$ be a positive real number. Prove that there exist positive integers $n$ and $p > \alpha \cdot 2^n$ for which one can select $2p$ pairwise distinct subsets $S_1, \dots, S_p, T_1, \dots, T_p$ of the set $\{1, 2, \dots, n\}$ such that $S_i \cap T_j \ne \emptyset$ for all $1 \le i, j \le p$.
","\textbf{Solution.} Let $k$ and $m$ be positive integers (to be determined later) and set $n = km$. Decompose the set $\{1, 2, \dots, n\}$ into $k$ disjoint subsets, each of size $m$; denote these subsets by $A_1, \dots, A_k$. Define the following families of sets:

\[
\mathcal{S} = \left\{ S \subseteq \{1,2,\dots,n\} : \forall i,\; S \cap A_i \ne \emptyset \right\}, \quad 
\mathcal{T}_1 = \left\{ T \subseteq \{1,2,\dots,n\} : \exists i,\; A_i \subseteq T \right\}, \quad 
\mathcal{T} = \mathcal{T}_1 \setminus \mathcal{S}.
\]

For each set $T \in \mathcal{T}$, there exists an index $1 \le i \le k$ such that $A_i \subseteq T$. Then for all $S \in \mathcal{S}$, $S \cap T \supseteq S \cap A_i \ne \emptyset$. Hence, each $S \in \mathcal{S}$ and each $T \in \mathcal{T}$ have at least one common element.

Below we show that the numbers $m$ and $k$ can be chosen such that $|\mathcal{S}|, |\mathcal{T}| > \alpha \cdot 2^n$. Then, choosing $p = \min\{|\mathcal{S}|, |\mathcal{T}|\}$, one can select the desired $2p$ sets $S_1, \dots, S_p$ and $T_1, \dots, T_p$ from families $\mathcal{S}$ and $\mathcal{T}$, respectively. Since families $\mathcal{S}$ and $\mathcal{T}$ are disjoint, sets $S_i$ and $T_j$ will be pairwise distinct.

To count the sets $\mathcal{S} \in \mathcal{S}$, observe that each $A_i$ has $2^m - 1$ nonempty subsets so we have $2^m - 1$ choices for $S \cap A_i$. These intersections uniquely determine set $S$, so

\[
|\mathcal{S}| = (2^m - 1)^k. \tag{1}
\]

Similarly, if a set $H \subset \{1,2,\dots,n\}$ does not contain a certain set $A_i$, then we have $2^m - 1$ choices for $H \cap A_i$: all subsets of $A_i$ except $A_i$ itself. Therefore, the complement of $\mathcal{T}_1$ contains $(2^m - 1)^k$ sets and

\[
|\mathcal{T}_1| = 2^{km} - (2^m - 1)^k. \tag{2}
\]

Next consider the family $\mathcal{S} \setminus \mathcal{T}_1$. If a set $S$ intersects all $A_i$ but does not contain any of them, then there exists $2^m - 2$ possible values for each $S \cap A_i$: all subsets of $A_i$ except $\emptyset$ and $A_i$. Therefore the number of such sets $S$ is $(2^m - 2)^k$, so

\[
|\mathcal{S} \setminus \mathcal{T}_1| = (2^m - 2)^k. \tag{3}
\]

From (1), (2), and (3) we obtain
\[
|\mathcal{T}| = |\mathcal{T}_1| - |\mathcal{S} \cap \mathcal{T}_1| = |\mathcal{T}_1| - (|\mathcal{S}| - |\mathcal{S} \setminus \mathcal{T}_1|) = 2^{km} - 2(2^m - 1)^k + (2^m - 2)^k.
\]

Let $\delta = \dfrac{3 - \sqrt{5}}{2}$ and $k = k(m) = \left\lfloor \dfrac{2^m \log \tfrac{1}{\delta}}{m} \right\rfloor$. Then
\[
\lim_{m \to \infty} \frac{|\mathcal{S}|}{2^{km}} = \lim_{m \to \infty} \left( 1 - \frac{1}{2^m} \right)^k = \exp \left( -\lim_{m \to \infty} \frac{k}{2^m} \right) = \delta
\]
and similarly
\[
\lim_{m \to \infty} \frac{|\mathcal{T}|}{2^{km}} = 1 - 2 \lim_{m \to \infty} \left( 1 - \frac{1}{2^m} \right)^k + \lim_{m \to \infty} \left( 1 - \frac{2}{2^m} \right)^k = 1 - 2\delta + \delta^2 = \delta.
\]

Hence, if $m$ is sufficiently large then $\dfrac{|\mathcal{S}|}{2^{km}}$ and $\dfrac{|\mathcal{T}|}{2^{km}}$ are greater than $\alpha$ (since $\alpha < \delta$). So $|\mathcal{S}|, |\mathcal{T}| > \alpha \cdot 2^{km} = \alpha \cdot 2^n$.

\textbf{Comment.} It can be proved that the constant $\dfrac{3 - \sqrt{5}}{2}$ is sharp. Actually, if $S_1, \dots, S_p, T_1, \dots, T_p$ are distinct subsets of $\{1,2,\dots,n\}$ such that each $S_i$ intersects each $T_j$, then
",530,4
2007c8,"Given a convex $n$-gon $P$ in the plane. For every three vertices of $P$, consider the triangle determined by them. Call such a triangle \textit{good} if all its sides are of unit length.\\
Prove that there are not more than $\dfrac{2}{3}n$ good triangles.
","\textbf{Solution.} Consider all good triangles containing a certain vertex $A$. The other two vertices of any such triangle lie on the circle $\omega_A$ with unit radius and center at $A$. Since $P$ is convex, all these vertices lie on an arc of angle less than $180^\circ$. Let $L_A R_A$ be the shortest such arc, oriented clockwise (see Figure 1). Each of segments $AL_A$ and $AR_A$ belongs to a unique good triangle. 

We say that the good triangle with side $AL_A$ is \textit{assigned counterclockwise} to $A$, and the second one, with side $AR_A$, is \textit{assigned clockwise} to $A$. In those cases when there is a single good triangle containing vertex $A$, this triangle is assigned to $A$ twice.

There are at most two assignments to each vertex of the polygon. (Vertices which do not belong to any good triangle have no assignment.) So the number of assignments is at most $2n$.

Consider an arbitrary good triangle $ABC$, with vertices arranged clockwise. We prove that $ABC$ is assigned to its vertices at least three times. Then, denoting the number of good triangles by $t$, we obtain that the number $K$ of all assignments is at most $2n$, while it is not less than $3t$. Then $3t \le K \le 2n$, as required.

Actually, we prove that triangle $ABC$ is assigned either counterclockwise to $C$ or clockwise to $B$. Then, by the cyclic symmetry of the vertices, we obtain that triangle $ABC$ is assigned either counterclockwise to $A$ or clockwise to $C$, and either counterclockwise to $B$ or clockwise to $A$, providing the claim.

\begin{center}
\includegraphics[width=0.4\textwidth]{figure1.png}
\hspace{2em}
\includegraphics[width=0.4\textwidth]{figure2.png}

Figure 1 \hspace{12em} Figure 2
\end{center}

Assume, to the contrary, that $L_C \ne A$ and $R_B \ne A$. Denote by $A', B', C'$ the intersection points of circles $\omega_A, \omega_B$ and $\omega_C$, distinct from $A, B, C$ (see Figure 2). Let $CL_C L'_C$ be the good triangle containing $CL_C$. Observe that the angle of arc $L_C A$ is less than $120^\circ$. Then one of the points $L_C$ and $L'_C$ belongs to arc $B'A$ of $\omega_C$; let this point be $X$. In the case when $L_C = B'$ and $L'_C = A$, choose $X = B'$.

Analogously, considering the good triangle $B R'_B R_B$ which contains $BR_B$ as an edge, we see that one of the points $R_B$ and $R'_B$ lies on arc $AC'$ of $\omega_B$. Denote this point by $Y$, $Y \ne A$. Then angles $XAY, YAB, BAC$ and $CAX$ (oriented clockwise) are not greater than $180^\circ$. Hence, point $A$ lies in quadrilateral $XYBC$ (either in its interior or on segment $XY$). This is impossible, since all these five points are vertices of $P$.

Hence, each good triangle has at least three assignments, and the statement is proved.

\textbf{Comment 1.} Considering a diameter $AB$ of the polygon, one can prove that every good triangle containing either $A$ or $B$ has at least four assignments. This observation leads to $t \le \left\lfloor \dfrac{2}{3}(n - 1) \right\rfloor$.

\textbf{Comment 2.} The result $t \le \left\lfloor \dfrac{2}{3}(n - 1) \right\rfloor$ is sharp. To construct a polygon with $n = 3k + 1$ vertices and $t = 2k$ triangles, take a rhombus $AB_1C_1D_1$ with unit side length and $\angle B_1 = 60^\circ$. Then rotate it around $A$ by small angles obtaining rhombi $AB_2C_2D_2, \dots, AB_kC_kD_k$ (see Figure 3). The polygon $AB_1\dots B_kC_1 \dots C_kD_1 \dots D_k$ has $3k + 1$ vertices and contains $2k$ good triangles.

The construction for $n = 3k$ and $n = 3k - 1$ can be obtained by deleting vertices $D_n$ and $D_{n-1}$.
",587,4
2007g1,"In triangle $ABC$, the angle bisector at vertex $C$ intersects the circumcircle and the perpendicular bisectors of sides $BC$ and $CA$ at points $R$, $P$, and $Q$, respectively. The midpoints of $BC$ and $CA$ are $S$ and $T$, respectively. Prove that triangles $RQT$ and $RPS$ have the same area.
","If $AC = BC$ then triangle $ABC$ is isosceles, triangles $RQT$ and $RPS$ are symmetric about the bisector $CR$ and the statement is trivial. If $AC \ne BC$ then it can be assumed without loss of generality that $AC < BC$.

Denote the circumcenter by $O$. The right triangles $CTQ$ and $CSP$ have equal angles at vertex $C$, so they are similar, $\angle CPS = \angle CQT = \angle OQP$ and
\[
\frac{QT}{PS} = \frac{CQ}{CP}. \tag{1}
\]

Let $\ell$ be the perpendicular bisector of chord $CR$; of course, $\ell$ passes through the circumcenter $O$. Due to the equal angles at $P$ and $Q$, triangle $OPQ$ is isosceles with $OP = OQ$. Then line $\ell$ is the axis of symmetry in this triangle as well. Therefore, points $P$ and $Q$ lie symmetrically on line segment $CR$,
\[
RP = CQ \quad \text{and} \quad RQ = CP. \tag{2}
\]

Triangles $RQT$ and $RPS$ have equal angles at vertices $Q$ and $P$, respectively. Then
\[
\frac{\text{area}(RQT)}{\text{area}(RPS)} = \frac{\frac{1}{2} \cdot RQ \cdot QT \cdot \sin \angle RQT}{\frac{1}{2} \cdot RP \cdot PS \cdot \sin \angle RPS} = \frac{RQ}{RP} \cdot \frac{QT}{PS}.
\]

Substituting (1) and (2),
\[
\frac{\text{area}(RQT)}{\text{area}(RPS)} = \frac{RQ}{RP} \cdot \frac{QT}{PS} = \frac{CP}{CQ} \cdot \frac{CQ}{CP} = 1.
\]

Hence, $\text{area}(RQT) = \text{area}(RPS)$.",207,2
2007g2,"Given an isosceles triangle $ABC$ with $AB = AC$. The midpoint of side $BC$ is denoted by $M$. Let $X$ be a variable point on the shorter arc $MA$ of the circumcircle of triangle $ABM$. Let $T$ be the point in the angle domain $BMA$, for which $\angle TMX = 90^\circ$ and $TX = BX$. Prove that $\angle MTB - \angle CTM$ does not depend on $X$.","Let $N$ be the midpoint of segment $BT$ (see Figure 1). Line $XN$ is the axis of symmetry in the isosceles triangle $BXT$, thus $\angle TNX = 90^\circ$ and $\angle BXN = \angle NXT$. Moreover, in triangle $BCT$, line $MN$ is the midline parallel to $CT$; hence $\angle CTM = \angle NMT$.

Due to the right angles at points $M$ and $N$, these points lie on the circle with diameter $XT$. Therefore,
\[
\angle MTB = \angle MTN = \angle MXN \quad \text{and} \quad \angle CTM = \angle NMT = \angle NXT = \angle BXN.
\]
Hence
\[
\angle MTB - \angle CTM = \angle MXN - \angle BXN = \angle MXB = \angle MAB,
\]
which does not depend on $X$.
",122,2
2007g3,"The diagonals of a trapezoid $ABCD$ intersect at point $P$. Point $Q$ lies between the parallel lines $BC$ and $AD$ such that $\angle AQD = \angle CQB$, and line $CD$ separates points $P$ and $Q$. Prove that $\angle BQP = \angle DAQ$.","\textbf{Solution.} Let $t = \frac{AD}{BC}$. Consider the homothety $h$ with center $P$ and scale $-t$. Triangles $PDA$ and $PBC$ are similar with ratio $t$, hence $h(B) = D$ and $h(C) = A$.

\begin{center}
\includegraphics[width=0.6\textwidth]{figure_g3_main.png}
\end{center}

Let $Q' = h(Q)$ (see Figure 1). Then points $Q$, $P$ and $Q'$ are obviously collinear. Points $Q$ and $P$ lie on the same side of $AD$, as well as on the same side of $BC$; hence $Q'$ and $P$ are also on the same side of $h(BC) = AD$, and therefore $Q$ and $Q'$ are on the same side of $AD$. Moreover, points $Q$ and $C$ are on the same side of $BD$, while $Q'$ and $A$ are on the opposite side (see Figure above).

By the homothety, $\angle AQ'D = \angle CQB = \angle AQD$, hence quadrilateral $AQ'QD$ is cyclic. Then
\[
\angle DAQ = \angle DQ'Q = \angle DQ'P = \angle BQP
\]
(the latter equality is valid by the homothety again).

\vspace{1em}
\textbf{Comment.} The statement of the problem is a limit case of the following result.\\

\textit{In an arbitrary quadrilateral $ABCD$, let $p = AC \cap BD$, $I = AD \cap BC$, and let $Q$ be an arbitrary point which is not collinear with any two of points $A, B, C, D$. Then $\angle AQD = \angle CQB$ if and only if $\angle BQP = \angle DQA$ (angles are oriented; see Figure below to the left).}

In the special case of the trapezoid, $I$ is an ideal point and $\angle DAQ = \angle IQA = \angle BQP$.

\begin{center}
\includegraphics[width=0.45\textwidth]{figure_g3_comment1.png}
\hfill
\includegraphics[width=0.45\textwidth]{figure_g3_comment2.png}

\small Left: general quadrilateral case \hspace{0.25\textwidth} Right: proof with bisectors
\end{center}

Let $a = QA$, $b = QB$, $c = QC$, $d = QD$, $i = QI$ and $p = QP$. Let line $QA$ intersect lines $BC$ and $BD$ at points $U$ and $V$, respectively. On lines $BC$ and $BD$ we have
\[
(abci) = (UBCI) \quad \text{and} \quad (badp) = (abpd) = (VBPD).
\]

Projecting from $A$, we get
\[
(abci) = (UBCI) = (VBPD) = (badp).
\]

Suppose that $\angle AQD = \angle CQB$. Let line $p'$ be the reflection of line $i$ about the bisector of angle $\angle AQB$. Then by symmetry we have $(badp') = (abci) = (badp)$. Hence $p = p'$, as desired.

The converse statement can be proved analogously.
",385,3
2007g4,"Consider five points $A, B, C, D, E$ such that $ABCD$ is a parallelogram and $BCED$ is a cyclic quadrilateral. Let $\ell$ be a line passing through $A$, and let $\ell$ intersect segment $DC$ and line $BC$ at points $F$ and $G$, respectively. Suppose that $EF = EG = EC$. Prove that $\ell$ is the bisector of angle $\angle DAB$.","\textbf{Solution.} If $CF = CG$, then $\angle FGC = \angle CGF$, hence $\angle GAB = \angle GFC = \angle FGC = \angle FAD$, and $\ell$ is a bisector.

Assume that $CF < GC$. Let $EK$ and $EL$ be the altitudes in the isosceles triangles $ECF$ and $EGC$, respectively. Then in the right triangles $EKF$ and $ELC$ we have $EF = EC$ and
\[
KF = \frac{CF}{2} < \frac{GC}{2} = LC,
\]
so
\[
KE = \sqrt{EF^2 - KF^2} > \sqrt{EC^2 - LC^2} = LE.
\]

Since quadrilateral $BCED$ is cyclic, we have $\angle EDC = \angle EBC$, so the right triangles $BEL$ and $DEK$ are similar. Then $KE > LE$ implies $DK > BL$, and hence
\[
DF = DK - KF > BL - LC = BC = AD.
\]

But triangles $ADF$ and $GCF$ are similar, so we have 
\[
1 > \frac{AD}{DF} = \frac{GC}{CF};
\]
this contradicts our assumption.

The case $CF > GC$ is completely similar. We consequently obtain the converse inequalities
\[
KF > LC,\quad KE < LE,\quad DK < BL,\quad DF < AD,\quad \text{hence } 1 < \frac{AD}{DF} = \frac{GC}{CF},
\]
a contradiction.
",189,2
2007g5,"Let $ABC$ be a fixed triangle, and let $A_1, B_1, C_1$ be the midpoints of sides $BC$, $CA$, $AB$, respectively. Let $P$ be a variable point on the circumcircle. Let lines $PA_1$, $PB_1$, $PC_1$ meet the circumcircle again at $A'$, $B'$, $C'$ respectively. Assume that the points $A$, $B$, $C$, $A'$, $B'$, $C'$ are distinct, and lines $A'A''$, $B'B''$, $C'C''$ form a triangle. Prove that the area of this triangle does not depend on $P$.","Let $A_0$, $B_0$, $C_0$ be the points of intersection of the lines $A'A_1$, $B'B_1$ and $C'C_1$ (see Figure). We claim that $\text{area}(A_0B_0C_0) = \frac{1}{2} \text{area}(ABC)$, hence it is constant.

Consider the inscribed hexagon $ABCC'PA'$. By Pascal's theorem, the points of intersection of its opposite sides (or their extensions) are collinear. These points are $AB \cap C'P = C_1$, $BC \cap PA' = A_1$, $CC' \cap A'A = B_0$. So point $B_0$ lies on the midline $A_1C_1$ of triangle $ABC$. Analogously, points $A_0$ and $C_0$ lie on lines $B_1C_1$ and $A_1B_1$, respectively.

Lines $AC$ and $A_1C_1$ are parallel, so triangles $B_0C_0A_1$ and $AC_0B_1$ are similar; hence we have
\[
\frac{B_0C_0}{AC_0} = \frac{A_1C_0}{B_1C_0}.
\]
Analogously, from $B_0 \in B_1C_1$ we obtain
\[
\frac{A_1C_0}{B_1C_0} = \frac{B_0C_0}{A_0C_0}.
\]
Combining these equalities, we get
\[
A_0C_0 \cdot B_0C_0 = AC_0 \cdot BC_0.
\]

Hence we have
\[
\text{area}(A_0B_0C_0) = \frac{1}{2} A_0C_0 \cdot B_0C_0 \sin \angle A_0C_0B_0 = \frac{1}{2} AC_0 \cdot BC_0 \sin \angle AC_0B = \text{area}(ABC_0).
\]

Since $C_0$ lies on the midline, we have $d(C_0, AB) = \frac{1}{2} d(C, AB)$ (we denote by $d(X,YZ)$ the distance between point $X$ and line $YZ$). Then we obtain
\[
\text{area}(A_0B_0C_0) = \text{area}(ABC_0) = \frac{1}{2} AB \cdot d(C_0, AB) = \frac{1}{4} AB \cdot d(C, AB) = \frac{1}{2} \text{area}(ABC).
\]
",211,2
2007g7,"Given an acute triangle $ABC$ with angles $\alpha$, $\beta$ and $\gamma$ at vertices $A$, $B$ and $C$, respectively, such that $\beta > \gamma$. Point $I$ is the incenter, and $R$ is the circumradius. Point $D$ is the foot of the altitude from vertex $A$. Point $K$ lies on line $AD$ such that $AK = 2R$, and $D$ separates $A$ and $K$. Finally, lines $DI$ and $KI$ meet sides $AC$ and $BC$ at $E$ and $F$, respectively.

Prove that if $IE = IF$ then $\beta \le 3\gamma$.","We first prove that
\[
\angle KID = \frac{\beta - \gamma}{2} \tag{1}
\]
even without the assumption that $IE = IF$. Then we will show that the statement of the problem is a consequence of this fact.

Denote the circumcenter by $O$. On the circumcircle, let $P$ be the point opposite to $A$, and let the angle bisector $AI$ intersect the circle again at $M$. Since $AK = AP = 2R$, triangle $AKP$ is isosceles. It is known that $\angle BAD = \angle CAO$, hence
\[
\angle DAI = \angle BAI - \angle BAD = \angle CAI - \angle CAO = \angle OAI,
\]
and $AM$ is the bisector line in triangle $AKP$. Therefore, points $K$ and $P$ are symmetrical about $AM$, and $\angle AMK = \angle AMP = 90^\circ$. Thus, $M$ is the midpoint of $KP$, and $AM$ is the perpendicular bisector of $KP$.

Denote the perpendicular feet of incenter $I$ on lines $BC$, $AC$, and $AD$ by $A_1$, $B_1$, and $T$, respectively. Quadrilateral $DA_1IT$ is a rectangle, hence $TD = IA_1 = IB_1$.

Due to the right angles at $T$ and $B_1$, quadrilateral $AB_1IT$ is cyclic. Hence
\[
\angle B_1TI = \angle B_1AI = \angle CAM = \angle BAM = \angle BPM,
\]
and
\[
\angle IB_1T = \angle IAT = \angle MAK = \angle MAP = \angle MBP.
\]
Therefore, triangles $B_1TI$ and $BPM$ are similar and
\[
\frac{IT}{TD} = \frac{IT}{IB_1} = \frac{MP}{MB} = \frac{KM}{MI}.
\]
Hence, $\angle KIM = \angle IDT = \angle IDA$, and
\[
\angle KID = \angle MID - \angle KIM = (\angle IAD + \angle IDA) - \angle IDA = \angle IAD.
\]

From triangle $ADB$ we compute:
\[
\angle KID = \angle IAD = \angle IAB - \angle DAB = \frac{\alpha}{2} - (90^\circ - \beta) = \frac{\alpha + \beta + \gamma}{2} + \beta = \frac{\beta - \gamma}{2}.
\]

Now suppose that $IE = IF$. Since $IA_1 = IB_1$, the right triangles $IEB_1$ and $IFA_1$ are congruent, and $\angle IEB_1 = \angle IFA_1$. Since $\beta > \gamma$, $A_1$ lies in the interior of segment $CD$ and $F$ lies in the interior of $AD$. Hence, $\angle IFC$ is acute. There are two possible cases based on the order of points $A$, $C$, $B_1$, and $E$:

- If $E$ lies between $C$ and $B_1$, then $\angle IFC = \angle IEA$, and quadrilateral $CEIF$ is cyclic:
\[
\angle FCE = 180^\circ - \angle EIF = \angle KID.
\]
Using (1), we get $\angle FCE = \gamma = \angle KID = \frac{\beta - \gamma}{2} \Rightarrow \beta = 3\gamma$.

- If $E$ lies between $A$ and $B_1$, then $CEIF$ is a deltoid with $\angle IEC = \angle IFC < 90^\circ$:
\[
\angle FCE > 180^\circ - \angle EIF = \angle KID \Rightarrow \gamma > \frac{\beta - \gamma}{2} \Rightarrow \beta < 3\gamma.
\]
",465,3
2007g8,"Point $P$ lies on side $AB$ of a convex quadrilateral $ABCD$. Let $\omega$ be the incircle of triangle $CPD$, and let $I$ be its incenter. Suppose that $\omega$ is tangent to the incircles of triangles $APD$ and $BPC$ at points $K$ and $L$, respectively. Let lines $AC$ and $BD$ meet at $E$, and let lines $AK$ and $BL$ meet at $F$. Prove that points $E$, $I$, and $F$ are collinear.","\textbf{Solution.} Let $\Omega$ be the circle tangent to segment $AB$ and to rays $AD$ and $BC$; let $J$ be its center. We prove that points $E$ and $F$ lie on line $IJ$.

\begin{center}
\includegraphics[width=0.55\textwidth]{figure_g8_main.png}
\end{center}

Denote the incircles of triangles $ADP$ and $BCP$ by $\omega_A$ and $\omega_B$. Let $h_1$ be the homothety with a negative scale taking $\omega$ to $\Omega$. Consider this homothety as the composition of two homotheties: one taking $\omega$ to $\omega_A$ (with a negative scale and center $K$), and another one taking $\omega_A$ to $\Omega$ (with a positive scale and center $A$). It is known that in such a case the three centers of homothety are collinear (this theorem is also referred to as the theorem on the three similitude centers). Hence, the center of $h_1$ lies on line $AK$. Analogously, it also lies on $BL$, so this center is $F$. Hence, $F$ lies on the line of centers of $\omega$ and $\Omega$, i.e. on $IJ$ (if $I = J$, then $F = I$ as well, and the claim is obvious).

Consider the homothety $h_2$ with a positive scale taking $\omega$ to $\Omega$. Consider $h_2$ as the composition of two homotheties: taking $\omega$ to $\Omega_A$ (with a positive scale and center $C$), and taking $\Omega_A$ to $\Omega$ (with a positive scale and center $A$), respectively. So the center of $h_2$ lies on line $AC$. By analogous reasoning, it lies also on $BD$, hence this center is $E$. Thus, $E$ also lies on the line of centers $IJ$, and the claim is proved.

\vspace{1em}
\textbf{Comment.} In both main steps of the solution, there can be several different reasonings for the same claims. For instance, one can mostly use Desargues?theorem instead of the three homotheties theorem. Namely, if $I_A$ and $I_B$ are the centers of $\omega_A$ and $\omega_B$, then lines $I_AI_B$, $KL$ and $AB$ are concurrent (by the theorem on three similitude centers applied to $\omega$, $\omega_A$ and $\omega_B$). Then Desargues?theorem, applied to triangles $AI_AK$ and $BI_BL$, yields that the points $J = AI_A \cap BI_B$, $I = I_AK \cap I_BL$ and $F = AK \cap BL$ are collinear.

For the second step, let $J_A$ and $J_B$ be the centers of $\Omega_A$ and $\Omega_B$. Then lines $J_AJ_B$, $AB$ and $CD$ are concurrent, since they appear to be the two common tangents and the line of centers of $\Omega_A$ and $\Omega_B$. Applying Desargues?theorem to triangles $AJ_AC$ and $BJ_BD$, we obtain that the points $J = AJ_A \cap BJ_B$, $I = CJ_A \cap DJ_B$ and $E = AC \cap BD$ are collinear.
",424,3
2007n3,"Let $X$ be a set of 10,000 integers, none of them is divisible by 47. Prove that there exists a 2007-element subset $Y$ of $X$ such that $a - b + c - d + e$ is not divisible by 47 for any $a, b, c, d, e \in Y$.","\textbf{Solution.} Call a set $M$ of integers \textit{good} if $47 \nmid a - b + c - d + e$ for any $a, b, c, d, e \in M$.

Consider the set $J = \{-9, -7, -5, -3, -1, 1, 3, 5, 7, 9\}$. We claim that $J$ is good. Actually, for any $a, b, c, d, e \in J$ the number $a - b + c - d + e$ is odd and
\[
-45 = (-9) - 9 + (-9) - 9 + (-9) \le a - b + c - d + e \le 9 - (-9) + 9 - (-9) + 9 = 45.
\]
But there is no odd number divisible by 47 between $-45$ and $45$.

For any $k = 1, \ldots, 46$ consider the set
\[
A_k = \{x \in X \mid \exists j \in J : kx \equiv j \pmod{47}\}.
\]
If $A_k$ is not good, then $47 \mid a - b + c - d + e$ for some $a, b, c, d, e \in A_k$, hence $47 \mid ka - kb + kc - kd + ke$. But set $J$ contains numbers with the same residues modulo 47, so $J$ also is not good. This is a contradiction; therefore, each $A_k$ is a good subset of $X$.

Then it suffices to prove that there exists a number $k$ such that $|A_k| \ge 2007$. Note that each $x \in X$ is contained in exactly 10 sets $A_k$. Then
\[
\sum_{k=1}^{46} |A_k| = 10|X| = 100{,}000,
\]
hence for some value of $k$ we have
\[
|A_k| \ge \frac{100{,}000}{46} > 2173 > 2007.
\]
This completes the proof.

\vspace{1em}
\textbf{Comment.} For the solution, it is essential to find a good set consisting of 10 different residues. Actually, consider a set $X$ containing almost uniform distribution of the nonzero residues (i.e., each residue occurs 217 or 218 times). Let $Y \subset X$ be a good subset containing 2007 elements. Then the set $K$ of all residues appearing in $Y$ contains not less than 10 residues, and obviously this set is good.

On the other hand, there is no good set $K$ consisting of 11 different residues. The CauchyDavenport theorem claims that for any sets $A$, $B$ of residues modulo a prime $p$,
\[
|A + B| \ge \min\{p, |A| + |B| - 1\}.
\]

Hence, if $|K| \ge 11$, then $|K + K| \ge 21$, $|K + K + K| \ge 31 > 47 - |K + K|$, hence $|K + K + K + (-K) + (-K)| = 47$, and $0 \equiv a + c + e - b - d \pmod{47}$ for some $a, b, c, d, e \in K$.

From this reasoning alone, one can see that a good set $K$ containing 10 residues should satisfy equalities $|K + K| = 19 = 2|K| - 1$ and $|K + K + K| = 28 = |K + K| + |K| - 1$. It can be proved that in this case set $K$ consists of 10 residues forming an arithmetic progression. As an easy consequence, one obtains that set $K$ has the form $aJ$ for some nonzero residue $a$.
",528,4
2007n4,"For every integer $k \ge 2$, prove that $2^{3k}$ divides the number
\[
\binom{2^{k+1}}{2^k} - \binom{2^k}{2^{k-1}}
\tag{1}
\]
but $2^{3k+1}$ does not. \hfill \textit{(Poland)}","\textbf{Solution.} We use the notation $(2n - 1)!! = 1 \cdot 3 \cdots (2n - 1)$ and $(2n)!! = 2 \cdot 4 \cdots (2n) = 2^n n!$ for any positive integer $n$. Observe that
\[
(2n)! = (2n)!! \cdot (2n - 1)!! = 2^n n! \cdot (2n - 1)!!.
\]

For any positive integer $n$ we have
\[
\binom{4n}{2n} = \frac{(4n)!}{(2n)!^2} = \frac{2^{2n}(2n)! \cdot (4n - 1)!!}{2^{2n}(n!)^2} = \frac{2^{2n}(2n)! \cdot (4n - 1)!!}{(2n)!^2} = \frac{2^{2n}}{(2n)!} \cdot (4n - 1)!!,
\]
\[
\binom{2n}{n} = \frac{(2n)!}{(n!)^2} = \frac{(2n)!! \cdot (2n - 1)!!}{(n!)^2} = \frac{2^n n! \cdot (2n - 1)!!}{(n!)^2} = \frac{2^n \cdot (2n - 1)!!}{n!}.
\]

Then expression (1) can be rewritten as follows:
\[
\binom{2^{k+1}}{2^k} - \binom{2^k}{2^{k-1}} = \frac{2^{2^k}}{(2^k)!} \cdot (2^{k+1} - 1)!! - \frac{2^{2^{k-1}}}{(2^{k-1})!} \cdot (2^k - 1)!!.
\]

We simplify further:
\[
= \frac{2^{2^k} (2^{k+1} - 1)!!}{(2^k)!} - \frac{2^{2^{k-1}} (2^k - 1)!!}{(2^{k-1})!}
= \frac{2^{2^k} (2^{k+1} - 1)!!}{(2^k)!} - \text{[smaller term]}.
\]

We compute the exponent of 2 in the prime decomposition of each factor. First, we show by induction on $n$ that the exponent of 2 in $(2n)!$ is $2n - 1$. The base case $n = 1$ is trivial.

Suppose that $(2n)! = 2^{2n - 1}(2d + 1)$ for some integer $d$. Then:
\[
(2n + 1)! = (2n + 1) \cdot (2n)! = (2n + 1) \cdot 2^{2n - 1}(2d + 1) = 2^{2n - 1} \cdot (2n + 1)(2d + 1).
\]

So the exponent increases by 1 for each increment of $n$.

Hence, the exponent of 2 in the first factor in (2) is $2^k - (2^k - 1) = 1$.

The second factor in (2) is a polynomial
\[
P(x) = (x + 1)(x + 3) \cdots (x + 2^k - 1) - (x - 1)(x - 3) \cdots (x - 2^k + 1),
\tag{3}
\]
evaluated at $x = 2^k$.

Note: $P(-x) = -P(x)$ so $P(x)$ is odd and has only odd powers of $x$. Hence,
\[
P(x) = x^3 Q(x) + cx,
\]
where $Q(x)$ has integer coefficients. To find the exponent of 2 in $c$, we compute:
\[
c = 2(2^k - 1)!! \sum_{i=1}^{2^{k-1}} \frac{1}{2i - 1} \cdot \frac{1}{2^k - 2i + 1}.
\]

This simplifies to:
\[
c = (2^k - 1)!! \sum_{i=1}^{2^{k-1}} \frac{2^k}{(2i - 1)(2^k - 2i + 1)} = 2^k (2^k - 1)!! \sum_{i=1}^{2^{k-1}} \frac{1}{(2i - 1)(2^k - 2i + 1)}.
\]

Let
\[
S = \sum_{i=1}^{2^{k-1}} \frac{(2^k - 1)!!}{(2i - 1)(2^k - 2i + 1)}.
\]

Set $a_{2i - 1}$ to be the inverse of $2i - 1$ modulo $2^k$.

Then:
\[
S = \sum_{i=1}^{2^{k-1}} \frac{(2^k - 1)!! a_{2i - 1}^2}{(2i - 1)^2} = - (2^k - 1)!! \sum_{i=1}^{2^{k-1}} (2i - 1)^2 = - (2^k - 1)!! \cdot \frac{2^{k-1}(2^k - 1)}{3} \pmod{2^k}.
\]

Hence, the exponent of 2 in $S$ is $k - 1$, so $c = 2^k \cdot 2^{k - 1} (2t + 1) = 2^{2k - 1}(2t + 1)$.

Finally,
\[
P(2^k) = 2^k Q(2^k)^3 + 2^k c = 2^k Q(2^k)^3 + 2^k \cdot 2^{2k - 1}(2t + 1),
\]
so
\[
P(2^k) \text{ is divisible by } 2^{3k}, \text{ but not by } 2^{3k + 1}.
\]

\vspace{1em}
\textbf{Comment.} The fact that (1) is divisible by $2^{2k}$ is known; but it does not help in solving this problem.
",544,4
2007n6,"Let $k$ be a positive integer. Prove that the number $(4k^2 - 1)^2$ has a positive divisor of the form $8kn - 1$ if and only if $k$ is even.
","\textbf{Solution.} The statement follows from the following fact.

\textbf{Lemma.} For arbitrary positive integers $x$ and $y$, the number $4xy - 1$ divides $(4x^2 - 1)^2$ if and only if $x = y$.

\textit{Proof.} If $x = y$ then $4xy - 1 = 4x^2 - 1$ obviously divides $(4x^2 - 1)^2$ so it is sufficient to consider the opposite direction.

Call a pair $(x, y)$ of positive integers \textit{bad} if $4xy - 1$ divides $(4x^2 - 1)^2$ but $x \ne y$. In order to prove that bad pairs do not exist, we present two properties of them which provide an infinite descent.

\textbf{Property (i).} If $(x, y)$ is a bad pair and $x < y$, then there exists a positive integer $z < x$ such that $(x, z)$ is also bad.

Let 
\[
r = \frac{(4x^2 - 1)^2}{4xy - 1}.
\]
Then
\[
r \equiv -r \cdot (-1) \equiv -r(4xy - 1) = -(4x^2 - 1)^2 \equiv -1 \pmod{4x},
\]
and $r = 4xz - 1$ with some positive integer $z$. From $x < y$ we obtain that
\[
4xz - 1 = \frac{(4x^2 - 1)^2}{4xy - 1} < 4x^2 - 1,
\]
and therefore $z < x$. By the construction, the number $4xz - 1$ is a divisor of $(4x^2 - 1)^2$ so $(x, z)$ is a bad pair.

\textbf{Property (ii).} If $(x, y)$ is a bad pair then $(y, x)$ is also bad.

Since $1 = 1^2 \equiv (4xy)^2 \pmod{4xy - 1}$, we have
\[
(4y^2 - 1)^2 \equiv (4y^2 - (4xy)^2)^2 = 16y^4(4x^2 - 1)^2 \equiv 0 \pmod{4xy - 1}.
\]

Hence, the number $4xy - 1$ divides $(4y^2 - 1)^2$ as well.

Now suppose that there exists at least one bad pair. Take a bad pair $(x, y)$ such that $2x + y$ attains its smallest possible value. If $x < y$ then property (i) provides a bad pair $(x, z)$ with $z < y$ and thus $2x + z < 2x + y$. Otherwise, if $y < x$, property (ii) yields that pair $(y, x)$ is also bad while $2y + x < 2x + y$. Both cases contradict the assumption that $2x + y$ is minimal; the Lemma is proved.

To prove the problem statement, apply the Lemma for $x = k$ and $y = 2n$; the number $8kn - 1$ divides $(4k^2 - 1)^2$ if and only if $k = 2n$. Hence, there is no such $n$ if $k$ is odd and $n = k/2$ is the only solution if $k$ is even.

\vspace{1em}
\textbf{Comment.} The constant $4$ in the Lemma can be replaced with an arbitrary integer greater than 1: if $a > 1$ and $axy - 1$ divides $(ax^2 - 1)^2$ then $x = y$.
",453,3
2007n7,"For a prime $p$ and a positive integer $n$, denote by $\nu_p(n)$ the exponent of $p$ in the prime factorization of $n!$. Given a positive integer $d$ and a finite set $\{p_1, \dots, p_k\}$ of primes. Show that there are infinitely many positive integers $n$ such that $d \mid \nu_{p_i}(n)$ for all $1 \le i \le k$. ","For arbitrary prime $p$ and positive integer $n$, denote by $\operatorname{ord}_p(n)$ the exponent of $p$ in $n$. Thus,
\[
\nu_p(n) = \sum_{i=1}^{n} \operatorname{ord}_p(i).
\]

\textbf{Lemma.} Let $p$ be a prime number, $q$ a positive integer, and $k$ and $r$ be positive integers such that $p^k > r$. Then
\[
\nu_p(qp^k + r) = \nu_p(qp^k) + \nu_p(r).
\]

\textit{Proof.} We claim that $\operatorname{ord}_p(qp^k + i) = \operatorname{ord}_p(i)$ for all $0 < i < p^k$. Actually, if $d = \operatorname{ord}_p(i)$ then $d < k$, so $qp^k + i$ is divisible by $p^d$, but only the first term is divisible by $p^{d+1}$; hence the sum is not.

Using this claim, we obtain:
\[
\nu_p(qp^k + r) = \sum_{i=1}^{qp^k} \operatorname{ord}_p(i) + \sum_{i=qp^k+1}^{qp^k+r} \operatorname{ord}_p(i)
= \sum_{i=1}^{qp^k} \operatorname{ord}_p(i) + \sum_{i=1}^{r} \operatorname{ord}_p(i) = \nu_p(qp^k) + \nu_p(r).
\]

Let $f(n) = (\nu_{p_1}(n), \dots, \nu_{p_k}(n))$. Define the sequence $n_1 = 1$, $n_{t+1} = (p_1p_2 \cdots p_k)^{n_t}$. We claim that
\[
f(n_{\ell_1} + \cdots + n_{\ell_m}) = f(n_{\ell_1}) + \cdots + f(n_{\ell_m})
\]
for any $\ell_1 < \cdots < \ell_m$.

\textit{Proof by induction.} Base case $m = 1$ is trivial.

Suppose that $m > 1$. Then $p_i^{n_{\ell_1}} > n_{\ell_t}$ for all $t$, and by the Lemma,
\[
f_i(n_{\ell_1} + n_{\ell_2} + \cdots + n_{\ell_m}) = f_i(n_{\ell_1}) + f_i(n_{\ell_2} + \cdots + n_{\ell_m}),
\]
and by the induction hypothesis, the result follows.

Now, consider the values $f(n_1), f(n_2), \dots$. There exist finitely many possible values of $f$. So there exists an infinite sequence $\ell_1 < \ell_2 < \cdots$ such that $f(n_{\ell_1}) = f(n_{\ell_2}) = \cdots$, and thus
\[
f(n_{\ell_1} + n_{\ell_2} + \cdots + n_{\ell_d}) = d \cdot f(n_{\ell_1}) = (0, \dots, 0)
\]
for all $m$. Hence we have found infinitely many suitable numbers.",284,3
2006a1,"A sequence of real numbers $a_0, a_1, a_2, \dots$ is defined by the formula
\[
a_{i+1} = \lfloor a_i \rfloor \cdot \langle a_i \rangle \quad \text{for } i \geq 0;
\]
here $a_0$ is an arbitrary real number, $\lfloor \cdot \rfloor$ denotes the greatest integer not exceeding $a_i$, and $\langle a_i \rangle = a_i - \lfloor a_i \rfloor$. Prove that $a_i = a_{i+2}$ for $i$ sufficiently large.","\textbf{Solution.} First note that if $a_0 \geq 0$, then all $a_i \geq 0$. For $a_i \geq 1$ we have (in view of $\langle a_i \rangle < 1$ and $\lfloor a_i \rfloor > 0$),
\[
\lfloor a_i \rfloor \cdot \langle a_i \rangle < \lfloor a_i \rfloor.
\]
Hence $a_{i+1} < \lfloor a_i \rfloor$, so the sequence $\lfloor a_i \rfloor$ is strictly decreasing as long as $a_i \geq 1$. Eventually it must reach the interval $[0, 1)$, after which $a_i = 0$ for all large $i$.

Now suppose the more interesting case $a_0 < 0$, so all $a_i \leq 0$. Suppose the sequence never hits 0. Then $\lfloor a_i \rfloor \leq -1$ for all $i$, and so:
\[
1 + a_{i+1} > a_{i+1} = \lfloor a_i \rfloor \cdot \langle a_i \rangle > \lfloor a_i \rfloor,
\]
which means the sequence $\lfloor a_i \rfloor$ is nondecreasing. Since all its terms are integers in $( -\infty, -1 ]$, this implies the sequence is eventually constant:
\[
\lfloor a_i \rfloor = c \quad \text{for } i \geq i_0, \quad c \text{ a negative integer}.
\]

Then the defining formula becomes:
\[
a_{i+1} = c \cdot \langle a_i \rangle = c(a_i - c) = ca_i - c^2.
\]

Now define:
\[
b_i = a_i - \frac{c^2}{c - 1}. \tag{1}
\]
Then:
\[
b_{i+1} = a_{i+1} - \frac{c^2}{c - 1} = ca_i - c^2 - \frac{c^2}{c - 1} = cb_i. \tag{2}
\]

Hence:
\[
b_i = c^{i - i_0} b_{i_0}, \quad \text{for } i \geq i_0.
\]

Now since $a_i \in [c, c + 1)$ for $i \geq i_0$, the sequence $(b_i)$ is bounded. The recursion (2) then implies $b_i = 0$ or $|c| = 1$.

\textbf{Case 1:} $b_i = 0$ for $i \geq i_0$. Then from (1),
\[
a_i = \frac{c^2}{c - 1} \quad \text{for } i \geq i_0.
\]

\textbf{Case 2:} $c = -1$. Then equations (1) and (2) yield:
\[
a_i = -\frac{1}{2} + (-1)^{i - i_0} b_{i_0} =
\begin{cases}
a_{i_0}, & \text{for } i = i_0, i_0 + 2, i_0 + 4, \dots \\
1 - a_{i_0}, & \text{for } i = i_0 + 1, i_0 + 3, i_0 + 5, \dots
\end{cases}
\]

\textbf{Conclusion:} From some point onward, the sequence $(a_i)$ either is constant or takes alternately two values from the interval $(-1, 0)$. Thus, $a_i = a_{i+2}$ for $i$ sufficiently large.

\vspace{1em}
\textbf{Comment.} There is nothing mysterious in introducing the sequence $(b_i)$. The sequence $(a_i)$ arises by iterating the function $x \mapsto cx - c^2$ whose unique fixed point is $c^2/(c - 1)$.
",422,3
2006a2,"\textbf{A2.} The sequence of real numbers $a_0, a_1, a_2, \dots$ is defined recursively by
\[
a_0 = -1, \qquad \sum_{k=0}^{n} \frac{a_{n-k}}{k+1} = 0 \quad \text{for } n \ge 1.
\]
Show that $a_n > 0$ for $n \ge 1$.","\textbf{Solution.} The proof goes by induction. For $n = 1$ the formula yields $a_1 = 1/2$. Take $n \ge 1$, assume $a_1, \dots, a_n > 0$ and write the recurrence formula for $n$ and $n+1$ as:
\[
\sum_{k=0}^{n} \frac{a_k}{n - k + 1} = 0 \quad \text{and} \quad \sum_{k=0}^{n+1} \frac{a_k}{n - k + 2} = 0.
\]

Subtracting the first from the second:
\[
0 = (n + 2)\sum_{k=0}^{n+1} \frac{a_k}{n - k + 2} - (n + 1)\sum_{k=0}^{n} \frac{a_k}{n - k + 1}
\]
\[
= (n + 2)a_{n+1} + \sum_{k=0}^{n} \left( \frac{n + 2}{n - k + 2} - \frac{n + 1}{n - k + 1} \right) a_k.
\]

The coefficient of $a_0$ vanishes, so we have:
\[
a_{n+1} = \frac{1}{n + 2} \sum_{k=1}^{n} \left( \frac{n + 1}{n - k + 1} - \frac{n + 2}{n - k + 2} \right) a_k 
= \frac{1}{n + 2} \sum_{k=1}^{n} \frac{k}{(n - k + 1)(n - k + 2)} a_k.
\]

The coefficients of $a_1, \dots, a_n$ are all positive. Therefore, $a_1, \dots, a_n > 0$ implies $a_{n+1} > 0$.

\vspace{1em}
\textbf{Comment.} Students familiar with the technique of generating functions will immediately recognise $\sum a_n x^n$ as the power series expansion of $x / \ln(1 - x)$ (with value $-1$ at $0$). But this can be a trap; attempts along these lines lead to unpleasant differential equations and integrals hard to handle. Using only tools from real analysis (e.g., computing the coefficients from the derivatives) seems very difficult.

On the other hand, the coefficients can be approached applying complex contour integrals and some other techniques from complex analysis and an attractive formula can be obtained for the coefficients:
\[
a_n = \int_1^{\infty} \frac{dx}{x^n (\pi^2 + \log^2(x - 1))}, \quad (n \ge 1)
\]
which is evidently positive.
",295,3
2006a3,"The sequence $c_0, c_1, \dots, c_n, \dots$ is defined by $c_0 = 1$, $c_1 = 0$ and $c_{n+2} = c_{n+1} + c_n$ for $n \ge 0$. Consider the set $S$ of ordered pairs $(x, y)$ for which there is a finite set $J$ of positive integers such that $x = \sum_{j \in J} c_j$, $y = \sum_{j \in J} c_{j-1}$. Prove that there exist real numbers $\alpha, \beta$ and $m, M$ with the following property: An ordered pair of nonnegative integers $(x, y)$ satisfies the inequality
\[
m < \alpha x + \beta y < M
\]
if and only if $(x, y) \in S$. ","\textbf{Solution.} Let $\varphi = \frac{1 + \sqrt{5}}{2}$ and $\psi = \frac{1 - \sqrt{5}}{2}$ be the roots of $t^2 - t - 1 = 0$. Note that $\varphi \psi = -1$, $\varphi + \psi = 1$, and $1 + \psi = \psi^2$.

An easy induction shows that the general term of the sequence satisfies:
\[
c_n = \frac{\varphi^{n-1} - \psi^{n-1}}{\varphi - \psi}, \quad \text{for } n \ge 0.
\]

Suppose the numbers $\alpha$ and $\beta$ have the required property. Since $(c_n, c_{n-1}) \in S$, we consider:
\[
\alpha c_n + \beta c_{n-1} = \frac{\alpha}{\sqrt{5}} (\varphi^{n-1} - \psi^{n-1}) + \frac{\beta}{\sqrt{5}} (\varphi^{n-2} - \psi^{n-2})
= \frac{1}{\sqrt{5}} [(\alpha \varphi + \beta)\varphi^{n-2} - (\alpha \psi + \beta)\psi^{n-2}].
\]

As $n \to \infty$, this is bounded only if $\alpha \varphi + \beta = 0$, so choose $\alpha = \psi$, $\beta = 1$.

With this choice, the above expression becomes:
\[
\psi c_n + c_{n-1} = \sum_{j \in J} \psi c_j + c_{j-1} = \sum_{j \in J} \psi^j, \quad \text{for } (a_J, b_J) \in S. \tag{1}
\]

Since $-1 < \psi < 0$, we have:
\[
-1 = \frac{\psi}{1 - \psi^2} < \sum_{j \in J} \psi^{2j+1} < \sum_{j \in J} \psi^j < \sum_{j=0}^\infty \psi^{2j} = \frac{1}{1 - \psi^2} = 1 - \psi = \varphi.
\]

So,
\[
-1 < \psi a_J + b_J < \varphi. \tag{2}
\]

Let $(x, y)$ satisfy $-1 < \psi x + y < \varphi$.

\textbf{Lemma.} If $x, y$ are nonnegative integers such that $-1 < \psi x + y < \varphi$, then there exists a finite subset $J$ of $\mathbb{N}$ such that
\[
\psi x + y = \sum_{j \in J} \psi^j. \tag{3}
\]

\textit{Proof.} If $x = y = 0$, use the empty set. If not, write:
\[
\psi x + y = \psi^{i_1} + \dots + \psi^{i_k}, \quad i_1 \le \cdots \le i_k.
\]
Take the one with minimal $i_1$ among shortest length $k$, and among them, minimal $i_2$, etc., yielding $i_1 < i_2 < \cdots < i_k$.

If $j_r = j_{r+1}$, then replacing $j_r, j_{r+1}$ with $j_r - 2, j_r + 1$ leads to a smaller minimal index:
\[
\psi^{j_r} + \psi^{j_r+1} = \psi^{j_r-2}(1 + \psi^3) = \psi^{j_r-2} + \psi^{j_r+1}.
\]
So $j_1, \dots, j_k$ must be distinct.

If $j_r = j_{r+1} - 1 = 1$, then the sum exceeds $\varphi$:
\[
\sum_{r=1}^k \psi^{j_r} \ge \psi + \psi^2 + \dots > 2 - \psi^2 = \varphi.
\]
Or if $j_r = 0$, then sum includes at least two $\psi^0 = 1$, so exceeds $-1$.

Therefore, there exists $J$ such that $\psi x + y = \sum_{j \in J} \psi^j$.

Hence, $(x, y) \in S$ and the inequality
\[
-1 < \psi x + y < \varphi
\]
characterizes the set $S$, with $\alpha = \psi$, $\beta = 1$, $m = -1$, and $M = \varphi$.

\textbf{Alternate proof of lemma:} Let $n = 3x + 2y$, and induct on $n$.

Suppose that $\frac{\psi x + y}{\psi} \in (-1, \varphi)$. Then
\[
\frac{\psi x + y}{\psi} = x + (\psi - 1)y = \psi y + (x - y),
\]
set $x' = y$, $y' = x - y$. Then
\[
\psi x' + y' = \psi y + (x - y) = \frac{\psi x + y}{\psi} \in (-1, \varphi),
\]
and $3x' + 2y' = 3y + 2(x - y) = 2x + y < n$, so apply induction.

Likewise, consider $\frac{\psi x + y - 1}{\psi} = x + (\psi - 1)(y - 1) + (x - y + 1) = \psi(y - 1) + (x - y + 1)$.

Set $x' = y - 1$, $y' = x - y + 1$. Again, $x', y' \ge 0$, and
\[
3x' + 2y' = 3(y - 1) + 2(x - y + 1) = 3y + 2x - 3 - 2y + 2 = 2x + y - 1 < n,
\]
so the induction applies.

Finally,
\[
(-1, -\psi) \cup (0, \varphi) = (-1, \varphi),
\]
so one of the two intervals always applies.

This completes the proof.
",670,4
2006a4,"Prove the inequality
\[
\sum_{i<j} \frac{a_i a_j}{a_i + a_j} \le \frac{n}{2(a_1 + a_2 + \cdots + a_n)} \sum_{i<j} a_i a_j
\]
for positive real numbers $a_1, a_2, \dots, a_n$.","Let $S = \sum_i a_i$. Denote by $L$ and $R$ the expressions on the left and right-hand sides, respectively. Use the identity:
\[
\sum_{i<j}(a_i + a_j) = (n - 1)\sum_i a_i. \tag{1}
\]
Then:
\[
L = \sum_{i<j} \frac{a_i a_j}{a_i + a_j} = \sum_{i<j} \frac{1}{4}\left(a_i + a_j - \frac{(a_i - a_j)^2}{a_i + a_j}\right)
= \frac{n - 1}{4} \cdot S - \frac{1}{4} \sum_{i<j} \frac{(a_i - a_j)^2}{a_i + a_j}. \tag{2}
\]

To represent $R$, note:
\[
\sum_{i<j} a_i a_j = \frac{1}{2} \left(S^2 - \sum_i a_i^2 \right),
\]
and:
\[
\sum_{i<j} a_i a_j = \frac{1}{2} \sum_{i<j} \left(a_i^2 + a_j^2 - (a_i - a_j)^2 \right)
= \frac{n - 1}{2} \sum_i a_i^2 - \frac{1}{2} \sum_{i<j} (a_i - a_j)^2.
\]

Multiply both identities by $n - 1$, add them, and simplify:
\[
n \sum_{i<j} a_i a_j = \frac{n - 1}{2} S^2 - \frac{1}{2} \sum_{i<j} (a_i - a_j)^2.
\]
Then:
\[
R = \frac{n}{2S} \sum_{i<j} a_i a_j = \frac{n - 1}{4} \cdot S - \frac{1}{4} \sum_{i<j} \frac{(a_i - a_j)^2}{S}. \tag{3}
\]

Now compare (2) and (3). Since $S \ge a_i + a_j$ for all $i < j$, we conclude $L \le R$.",185,2
2006a5,"Let $a, b, c$ be the sides of a triangle. Prove that
\[
\frac{\sqrt{b + c - a}}{\sqrt{b + \sqrt{c - \sqrt{a}}}} + \frac{\sqrt{c + a - b}}{\sqrt{c + \sqrt{a - \sqrt{b}}}} + \frac{\sqrt{a + b - c}}{\sqrt{a + \sqrt{b - \sqrt{c}}}} \le 3.
\]","Note that the denominators are all positive. Let
\[
x = \sqrt{b + \sqrt{c - \sqrt{a}}}, \quad y = \sqrt{c + \sqrt{a - \sqrt{b}}}, \quad z = \sqrt{a + \sqrt{b - \sqrt{c}}}.
\]
Then
\[
b + c - a = \left( \frac{z + x}{2} \right)^2 + \left( \frac{x + y}{2} \right)^2 - \left( \frac{y + z}{2} \right)^2 = \frac{x^2 + xy + xz - yz}{2} = x^2 - \frac{1}{2}(x - y)(x - z),
\]
and
\[
\frac{\sqrt{b + c - a}}{\sqrt{b + \sqrt{c - \sqrt{a}}}} = \sqrt{1 - \frac{(x - y)(x - z)}{2x^2}} \le 1 - \frac{(x - y)(x - z)}{4x^2},
\]
by applying $\sqrt{1 + u} \le 1 + \frac{u}{2}$.

Similarly:
\[
\frac{\sqrt{c + a - b}}{\sqrt{c + \sqrt{a - \sqrt{b}}}} \le 1 - \frac{(z - x)(z - y)}{4z^2}, \quad
\frac{\sqrt{a + b - c}}{\sqrt{a + \sqrt{b - \sqrt{c}}}} \le 1 - \frac{(y - z)(y - x)}{4y^2}.
\]

So the inequality becomes:
\[
\frac{(x - y)(x - z)}{x^2} + \frac{(y - z)(y - x)}{y^2} + \frac{(z - x)(z - y)}{z^2} \ge 0. \tag{1}
\]

Assume $x \le y \le z$. Then:
\[
\frac{(x - y)(x - z)}{x^2} = \frac{(y - x)(z - x)}{x^2} \ge \frac{(y - x)(z - y)}{y^2}, \quad \frac{(z - x)(z - y)}{z^2} \ge 0.
\]

Hence inequality (1) follows.",214,2
2006c1,"We have $n \ge 2$ lamps $L_1, \ldots, L_n$ in a row, each of them being either \textit{on} or \textit{off}. Every second we simultaneously modify the state of each lamp as follows:

\begin{itemize}
\item If the lamp $L_i$ and its neighbours (only one neighbour for $i = 1$ or $i = n$, two neighbours for other $i$) are in the same state, then $L_i$ is switched off;
\item otherwise, $L_i$ is switched on.
\end{itemize}

Initially all the lamps are off except the leftmost one which is on.

\begin{enumerate}
\item[(a)] Prove that there are infinitely many integers $n$ for which all the lamps will eventually be off.
\item[(b)] Prove that there are infinitely many integers $n$ for which the lamps will never be all off.
\end{enumerate}","\textbf{Solution.}

(a) Let us define $A_k$ to be the $2^k \times 2^k$ matrix whose rows represent the evolution of the system of $n = 2^k$ lamps. The first row of $A_k$ is $[1, 0, 0, \ldots, 0]$, the initial configuration. The claim is:

\textit{The bottom row of $A_k$ is} $[1, 1, \ldots, 1]$.

This is sufficient, because applying the rule one more time gives $[0, 0, \ldots, 0]$.

\textit{Proof by induction.} Base case $k=1$ is clear. For the inductive step, consider $A_{k+1}$ as:
\[
A_{k+1} = \begin{pmatrix} A_k & O_k \\ B_k & C_k \end{pmatrix},
\]
where $O_k$ is a zero matrix. After $2^k$ steps, the right part is untouched, so we can focus on the symmetry:

The row after the bottom of $[A_k\ O_k]$ becomes:
\[
[0,\ldots,0,\ 1,\ 1,\ 0,\ldots,0],
\]
with $2^{k-1}$ zeros on each side. This row is symmetric, and the update rule is symmetric, so this symmetry is preserved. Therefore $B_k$ mirrors $C_k$.

Since $C_k$ evolves identically to $A_k$ (due to same neighbourhoods from $B_k$), we get that $C_k = A_k$. So the bottom row of $A_{k+1}$ is all $1$'s, completing the induction.

(b) Let $n = 2^k + 1$ for $k \ge 1$. Consider a matrix $\mathcal{A}$ of width $2^k + 1$, where the first $2^k$ columns form $A_k$, and the last column is zeros.

The next row (after $A_k$'s last row) is $[0, 0, \ldots, 0, 1, 1]$, which is the reverse of the second row of $A_k$. This reversal continues, making rows of $\mathcal{A}$ mirror the earlier ones.

Hence the pattern $[1, 1, 0, \ldots, 0, 0]$ reappears and repeats. Therefore, the state $[0, 0, \ldots, 0]$ never appears. So there are infinitely many such $n = 2^k + 1$ for which the lamps are never all off.
",295,3
2006c3,"Let $S$ be a finite set of points in the plane such that no three of them are on a line. For each convex polygon $P$ whose vertices are in $S$, let $a(P)$ be the number of vertices of $P$, and let $b(P)$ be the number of points of $S$ which are outside $P$. Prove that for every real number $x$,
\[
\sum_P x^{a(P)} (1 - x)^{b(P)} = 1,
\]
where the sum is taken over all convex polygons with vertices in $S$.

\textit{NB.} A line segment, a point and the empty set are considered as convex polygons of 2, 1 and 0 vertices, respectively.
","For each convex polygon $P$ whose vertices are in $S$, let $c(P)$ be the number of points of $S$ which are \textit{inside} $P$, so that $a(P) + b(P) + c(P) = n$, where $n = |S|$.

Denote $1 - x = y$, then
\[
\sum_P x^{a(P)} y^{b(P)} = \sum_P x^{a(P)} y^{b(P)} (x + y)^{c(P)} = \sum_P \sum_{i=0}^{c(P)} \binom{c(P)}{i} x^{a(P)+i} y^{b(P)+c(P)-i}.
\]

This expression is a homogeneous polynomial of degree $n$ in $x$ and $y$. The term $x^r y^{n-r}$ counts the number of ways to choose a convex polygon $P$ and a subset of $r - a(P)$ points inside $P$ such that the total chosen size is $r$.

But this corresponds bijectively to choosing any $r$-element subset of $S$, since any such subset uniquely splits into vertices of a convex hull $P$ and points inside $P$.

Therefore, the coefficient of $x^r y^{n-r}$ is $\binom{n}{r}$ and
\[
\sum_P x^{a(P)} y^{b(P)} = \sum_{r=0}^n \binom{n}{r} x^r y^{n-r} = (x + y)^n = 1.
\]
",160,2
2006c4,"A cake has the form of an $n \times n$ square composed of $n^2$ unit squares. Strawberries lie on some of the unit squares so that each row or column contains exactly one strawberry; call this arrangement $\mathcal{A}$.

Let $\mathcal{B}$ be another such arrangement. Suppose that every grid rectangle with one vertex at the top left corner of the cake contains no fewer strawberries of arrangement $\mathcal{B}$ than of arrangement $\mathcal{A}$. Prove that arrangement $\mathcal{B}$ can be obtained from $\mathcal{A}$ by performing a number of \emph{switches}, defined as follows:

A \emph{switch} consists in selecting a grid rectangle with only two strawberries, situated at its top right corner and bottom left corner, and moving these two strawberries to the other two corners of that rectangle.","\textbf{Solution.} We use capital letters to denote unit squares; $O$ is the top left corner square. For any two squares $X$ and $Y$ let $[XY]$ be the smallest grid rectangle containing these two squares.

Strawberries lie on some squares in arrangement $\mathcal{A}$. Put a plum on each square of the target configuration $\mathcal{B}$. For a square $X$ denote by $a(X)$ and $b(X)$ respectively the number of strawberries and the number of plums in $[OX]$. By hypothesis $a(X) \leq b(X)$ for each $X$, with strict inequality for some $X$ (otherwise the two arrangements coincide and there is nothing to prove).

The idea is to show that by a legitimate switch one can obtain an arrangement $\mathcal{A}'$ such that
\[
a(X) \leq a'(X) \leq b(X) \quad \text{for each } X; \qquad \sum_X a(X) < \sum_X a'(X) \tag{1}
\]
(with $a'(X)$ defined analogously to $a(X)$; the sums range over all unit squares $X$). This will be enough because the same reasoning then applies to $\mathcal{A}'$, giving rise to a new arrangement $\mathcal{A}''$, and so on (induction). Since the sum increases but is bounded above by $\sum b(X)$, we eventually attain equality and thus match plums to strawberries.

Consider the uppermost row in which the plum and the strawberry lie on different squares $P$ and $S$ respectively; clearly $P$ must be situated left to $S$. In the column passing through $P$, let $T$ be the top square and $B$ the bottom square. The strawberry in that column lies below the plum. (There is no plum in that column above $P$, otherwise it contradicts choice of $P$.)

Hence there is at least one strawberry in the region $[BS]$ below $[PS]$. Let $V$ be the position of the lowest such strawberry in that region.

Denote by $W$ the square at the intersection of the row through $V$ with the column through $S$ and let $R$ be the square vertex-adjacent to $W$ up-left. We claim that
\[
a(X) < b(X) \qquad \text{for all } X \in [PR]. \tag{2}
\]
This is so because if $X \in [PR]$ then the portion of $[OX]$ left to column $[TB]$ contains at least as many plums as strawberries (by hypothesis); in the portion above the row through $P$ and $S$ we have perfect balance; and in the remaining portion (rectangle $[PX]$), we have a plum at $P$ and no strawberry.

Now we can perform the required switch. Let $U$ be the square at the intersection of the row through $P$ with the column through $V$ (some of $P, U, R$ can coincide). We move strawberries from squares $S$ and $V$ to squares $U$ and $W$. Then
\[
a'(X) = a(X) + 1 \quad \text{for } X \in [UR]; \qquad a'(X) = a(X) \quad \text{for other } X.
\]
And since the rectangle $[UR]$ is contained in $[PR]$, we still have $a'(X) \leq b(X)$ for all $X$, by (2); conditions (1) are satisfied and the proof is complete.
",486,3
2006c6,"\textit{A holey triangle} is an upward equilateral triangle of side length $n$ with $n$ upward unit triangular holes cut out. A \textit{diamond} is a $60^\circ$?120^\circ$ unit rhombus. Prove that a holey triangle $T$ can be tiled with diamonds if and only if the following condition holds: Every upward equilateral triangle of side length $k$ in $T$ contains at most $k$ holes, for $1 \leq k \leq n$.","\textbf{Solution.} Let $T$ be a holey triangle. The unit triangles in it will be called \textit{cells}. We say simply ``triangle'' instead of ``upward equilateral triangle'' and ``size'' instead of ``side length.''

The necessity will be proven first. Assume that a holey triangle $T$ can be tiled with diamonds and consider such a tiling. Let $T'$ be a triangle of size $k$ in $T$ containing $h$ holes. Focus on the diamonds which cover (one or two) cells in $T'$. Let them form a figure $R$. The boundary of $T'$ consists of upward cells, so $R$ is a triangle of size $k$ with $h$ upward holes cut out and possibly some downward cells sticking out. Hence there are exactly $(k^2 + k)/2 - h$ upward cells in $R$, and at least $(k^2 - k)/2$ downward cells (not counting those sticking out). On the other hand each diamond covers one upward and one downward cell, which implies $(k^2 + k)/2 - h \ge (k^2 - k)/2$. It follows that $h \le k$, as needed.

We pass on to the sufficiency. For brevity, let us say that a set of holes in a given triangle $T$ is \textit{spread out} if every triangle of size $k$ in $T$ contains at most $k$ holes. For any set $S$ of spread out holes, a triangle of size $k$ will be called \textit{full} of $S$ if it contains exactly $k$ holes of $S$. The proof is based on the following observation.

\textbf{Lemma.} Let $S$ be a set of spread out holes in $T$. Suppose that two triangles $T'$ and $T''$ are full of $S$, and that they touch or intersect. Let $T' + T''$ denote the smallest triangle in $T$ containing them. Then $T' + T''$ is also full of $S$.

\textit{Proof.} Let triangles $T'$, $T''$, $T' \cap T''$ and $T' + T''$ have sizes $a$, $b$, $c$ and $d$, and let them contain $a$, $b$, $x$ and $y$ holes of $S$, respectively. (Note that $T' \cap T''$ could be a point, in which case $c = 0$.) Since $S$ is spread out, we have $x \le c$ and $y \le d$. The geometric configuration of triangles clearly satisfies $a + b = c + d$. Furthermore, $a + b \le x + y$, since $a + b$ counts twice the holes in $T' \cap T''$. These conclusions imply $x = c$ and $y = d$, as we wished to show. \hfill $\square$

Now let $T_n$ be a holey triangle of size $n$, and let the set $H$ of its holes be spread out. We show by induction on $n$ that $T_n$ can be tiled with diamonds. The base $n = 1$ is trivial. Suppose that $n \ge 2$ and that the claim holds for holey triangles of size less than $n$.

Denote by $B$ the bottom row of $T_n$ and by $T'$ the triangle formed by its top $n - 1$ rows. There is at least one hole in $B$ as $T'$ contains at most $n - 1$ holes. If this hole is only one, there is a unique way to tile $B$ with diamonds. Also, $T'$ contains exactly $n - 1$ holes, making it a holey triangle of size $n - 1$, and these holes are spread out. Hence it remains to apply the induction hypothesis.

So suppose that there are $m \ge 2$ holes in $B$ and label them $a_1, \dots, a_m$ from left to right. Let $\ell$ be the line separating $B$ from $T'$. For each $i = 1, \dots, m - 1$, pick an upward cell $b_i$ between $a_i$ and $a_{i+1}$ with base on $\ell$. Place a diamond to cover $b_i$ and its lower neighbour, a downward cell in $B$. The remaining part of $B$ can be tiled uniquely with diamonds. Remove from $T_n$ row $B$ and the cells $b_1, \dots, b_{m-1}$ to obtain a holey triangle $T_{n-1}$ of size $n - 1$. The conclusion will follow by induction if the choice of $b_1, \dots, b_{m-1}$ guarantees that the following condition is satisfied: If the holes $a_1, \dots, a_m$ are replaced by $b_1, \dots, b_{m-1}$ then the new set of holes is spread out again.

We show that such a choice is possible. The cells $b_1, \dots, b_{m-1}$ can be defined one at a time in this order, making sure that the above condition holds at each step. Thus it suffices to prove that there is an appropriate choice for $b_1$, and we set $a_1 = u$, $a_2 = v$ for clarity.

Let $\Delta$ be the triangle of maximum size which is full of $H$, contains the top vertex of the hole $u$, and has base on line $\ell$. Call $\Delta$ the \textit{associate} of $u$. Observe that $\Delta$ does not touch $v$. Indeed, if $\Delta$ has size $r$ then it contains $r$ holes of $T_n$. Extending its slanted sides downwards produces a triangle $\Delta'$ of size $r + 1$ containing at least one more hole, namely $u$. Since there are at most $r + 1$ holes in $\Delta'$, it cannot contain $v$. Consequently, $\Delta$ does not contain the top vertex of $v$.

Let $w$ be the upward cell with base on $\ell$ which is to the right of $\Delta$ and shares a common vertex with it. The observation above shows that $w$ is to the left of $v$. Note that $w$ is not a hole, or else $\Delta$ could be extended to a larger triangle full of $H$.

We prove that if the hole $u$ is replaced by $w$ then the new set of holes is spread out again. To verify this, we only need to check that if a triangle $\Gamma$ in $T_n$ contains $w$ but not $u$ then $\Gamma$ is not full of $H$. Suppose to the contrary that $\Gamma$ is full of $H$. Consider the minimum triangle $\Gamma + \Delta$ containing $\Gamma$ and the associate $\Delta$ of $u$. Clearly $\Gamma + \Delta$ is larger than $\Delta$, because $\Gamma$ contains $w$ but $\Delta$ does not. Next, $\Gamma + \Delta$ is full of $H \setminus \{u\}$ by the lemma, since $\Gamma$ and $\Delta$ have a common point and neither of them contains $u$.

If $\Gamma$ is above line $\ell$ then so is $\Gamma + \Delta$, which contradicts the maximum choice of $\Delta$. If $\Gamma$ contains cells from row $B$, observe that $\Gamma + \Delta$ contains $u$. Let $s$ be the size of $\Gamma + \Delta$. Being full of $H \setminus \{u\}$, $\Gamma + \Delta$ contains $s$ holes other than $u$. But it also contains $u$, contradicting the assumption that $H$ is spread out.

The claim follows, showing that $b_1 = w$ is an appropriate choice for $a_1 = u$ and $a_2 = v$. As explained above, this is enough to complete the induction.
",1121,4
2006g1,"Let $ABC$ be a triangle with incenter $I$. A point $P$ in the interior of the triangle satisfies
\[
\angle PBA + \angle PCA = \angle PBC + \angle PCB.
\]
Show that $AP \geq AI$ and that equality holds if and only if $P$ coincides with $I$.","\textbf{Solution.} Let $\angle A = \alpha$, $\angle B = \beta$, $\angle C = \gamma$. Since $\angle PBA + \angle PCA + \angle PBC + \angle PCB = \beta + \gamma$, the condition from the problem statement is equivalent to $\angle PBC + \angle PCB = (\beta + \gamma)/2$, i.e.\ $\angle BPC = 90^\circ + \alpha/2$.

On the other hand $\angle BIC = 180^\circ - (\beta + \gamma)/2 = 90^\circ + \alpha/2$. Hence $\angle BPC = \angle BIC$, and since $P$ and $I$ are on the same side of $BC$, the points $B$, $C$, $I$ and $P$ are concyclic. In other words, $P$ lies on the circumcircle $\omega$ of triangle $BCI$.

Let $\Omega$ be the circumcircle of triangle $ABC$. It is a well-known fact that the centre of $\omega$ is the midpoint $M$ of the arc $BC$ of $\Omega$. This is also the point where the angle bisector $AI$ intersects $\Omega$.

From triangle $APM$ we have
\[
AP + PM \geq AM = AI + IM = AI + PM.
\]
Therefore $AP \geq AI$. Equality holds if and only if $P$ lies on the line segment $AI$, which occurs if and only if $P = I$.
",196,2
2006g2,"Let $ABCD$ be a trapezoid with parallel sides $AB > CD$. Points $K$ and $L$ lie on the line segments $AB$ and $CD$, respectively, so that $AK/KB = DL/LC$. Suppose that there are points $P$ and $Q$ on the line segment $KL$ satisfying
\[
\angle APB = \angle BCD \quad \text{and} \quad \angle CQD = \angle ABC.
\]
Prove that the points $P$, $Q$, $B$ and $C$ are concyclic.","Because $AB \parallel CD$, the relation $AK/KB = DL/LC$ readily implies that the lines $AD$, $BC$ and $KL$ have a common point $S$.

\medskip

Consider the second intersection points $X$ and $Y$ of the line $SK$ with the circles $(ABP)$ and $(CDQ)$, respectively. Since $APBX$ is a cyclic quadrilateral and $AB \parallel CD$, one has
\[
\angle AXB = 180^\circ - \angle APB = 180^\circ - \angle BCD = \angle ABC.
\]
This shows that $BC$ is tangent to the circle $(ABP)$ at $B$. Likewise, $BC$ is tangent to the circle $(CDQ)$ at $C$. Therefore $SP \cdot SX = SB^2$ and $SQ \cdot SY = SC^2$.

Let $h$ be the homothety with centre $S$ and ratio $SC/SB$. Since $h(B) = C$, the above conclusion about tangency implies that $h$ takes circle $(ABP)$ to circle $(CDQ)$. Also, $h$ takes $AB$ to $CD$, and it easily follows that $h(P) = Y$, $h(X) = Q$, yielding $SP/SY = SB/SC = SX/SQ$.

Equalities $SP \cdot SX = SB^2$ and $SQ \cdot SX = SC/SB$ imply $SP \cdot SQ = SB \cdot SC$, which is equivalent to $P$, $Q$, $B$ and $C$ being concyclic.",189,2
2006g3,"\textbf{G3.} Let $ABCDE$ be a convex pentagon such that
\[
\angle BAC = \angle CAD = \angle DAE \quad \text{and} \quad \angle ABC = \angle ACD = \angle ADE.
\]
The diagonals $BD$ and $CE$ meet at $P$. Prove that the line $AP$ bisects the side $CD$.","\textbf{Solution.} Let the diagonals $AC$ and $BD$ meet at $Q$, the diagonals $AD$ and $CE$ meet at $R$, and let the ray $AP$ meet the side $CD$ at $M$. We want to prove that $CM = MD$ holds.

The idea is to show that $Q$ and $R$ divide $AC$ and $AD$ in the same ratio, or more precisely
\[
\frac{AQ}{QC} = \frac{AR}{RD} \tag{1}
\]
(which is equivalent to $QR \parallel CD$). The given angle equalities imply that the triangles $ABC$, $ACD$ and $ADE$ are similar. We therefore have
\[
\frac{AB}{AC} = \frac{AC}{AD} = \frac{AD}{AE}.
\]
Since $\angle BAD = \angle BAC + \angle CAD = \angle CAD + \angle DAE = \angle CAE$, it follows from $AB/AC = AD/AE$ that the triangles $ABD$ and $ACE$ are also similar. Their angle bisectors in $A$ are $AQ$ and $AR$, respectively, so that
\[
\frac{AB}{AC} = \frac{AQ}{AR}.
\]
Because $AB/AC = AC/AD$, we obtain $AQ/AR = AC/AD$, which is equivalent to (1). Now Cevas theorem for the triangle $ACD$ yields
\[
\frac{AQ}{QC} \cdot \frac{CM}{MD} \cdot \frac{DR}{RA} = 1.
\]
In view of (1), this reduces to $CM = MD$, which completes the proof.

\textbf{Comment.} Relation (1) immediately follows from the fact that quadrilaterals $ABCD$ and $ACDE$ are similar.
",205,2
2006g4,"\textbf{G4.} A point $D$ is chosen on the side $AC$ of a triangle $ABC$ with $\angle C < \angle A < 90^\circ$ in such a way that $BD = BA$. The incircle of $ABC$ is tangent to $AB$ and $AC$ at points $K$ and $L$, respectively. Let $J$ be the incenter of triangle $BCD$. Prove that the line $KL$ intersects the line segment $AJ$ at its midpoint.","\textbf{Solution.} Denote by $P$ the common point of $AJ$ and $KL$. Let the parallel to $KL$ through $J$ meet $AC$ at $M$. Then $P$ is the midpoint of $AJ$ if and only if $AM = 2 \cdot AL$, which we are about to show.

\medskip

Denoting $\angle BAC = 2\alpha$, the equalities $BA = BD$ and $AK = AL$ imply $\angle ADB = 2\alpha$ and $\angle ALK = 90^\circ - \alpha$. Since $DJ$ bisects $\angle BDC$, we obtain
\[
\angle CDJ = \tfrac{1}{2}(180^\circ - \angle ADB) = 90^\circ - \alpha.
\]
Also $\angle DMJ = \angle ALK = 90^\circ - \alpha$ since $JM \parallel KL$. It follows that $JD = JM$.

Let the incircle of triangle $BCD$ touch its side $CD$ at $T$. Then $JT \perp CD$, meaning that $JT$ is the altitude to the base $DM$ of the isosceles triangle $DMJ$. It now follows that $DT = MT$, and we have
\[
DM = 2 \cdot DT = BD + CD - BC.
\]
Therefore
\begin{align*}
AM &= AD + (BD + CD - BC) \\
   &= AD + AB + DC - BC \\
   &= AC + AB - BC \\
   &= 2 \cdot AL,
\end{align*}
which completes the proof.
",202,2
2006g6,"Circles $\omega_1$ and $\omega_2$ with centres $O_1$ and $O_2$ are externally tangent at point $D$ and internally tangent to a circle $\omega$ at points $E$ and $F$, respectively. Line $t$ is the common tangent of $\omega_1$ and $\omega_2$ at $D$. Let $AB$ be the diameter of $\omega$ perpendicular to $t$, so that $A$, $E$ and $O_1$ are on the same side of $t$. Prove that lines $AO_1$, $BO_2$, $EF$ and $t$ are concurrent.","Point $E$ is the centre of a homothety $h$ which takes circle $\omega_1$ to circle $\omega$. The radii $O_1D$ and $OB$ of these circles are parallel as both are perpendicular to line $t$. Also, $O_1D$ and $OB$ are on the same side of line $EO$, hence $h$ takes $O_1D$ to $OB$. Consequently, points $E$, $D$ and $B$ are collinear. Likewise, points $F$, $D$ and $A$ are collinear as well.

Let lines $AE$ and $BF$ intersect at $C$. Since $AF$ and $BE$ are altitudes in triangle $ABC$, their common point $D$ is the orthocentre of this triangle. So $CD$ is perpendicular to $AB$, implying that $C$ lies on line $t$. Note that triangle $ABC$ is acute-angled. We mention the well-known fact that triangles $FEC$ and $ABC$ are similar in ratio $\cos \gamma$, where $\gamma = \angle ACB$. In addition, points $C$, $E$, $D$ and $F$ lie on the circle with diameter $CD$.

Let $P$ be the common point of lines $EF$ and $t$. We are going to prove that $P$ lies on line $AO_1$. Denote by $N$ the second common point of circle $\omega_1$ and $AC$; this is the point of $\omega_1$ diametrically opposite to $D$. By Menelaus?theorem for triangle $DCN$, points $A$, $O_1$ and $P$ are collinear if and only if
\[
\frac{CA}{AN} \cdot \frac{NO_1}{O_1D} \cdot \frac{DP}{PC} = 1.
\]
Because $NO_1 = O_1D$, this reduces to $CA/AN = CP/PD$. Let line $t$ meet $AB$ at $K$. Then $CA/AN = CK/KD$, so it suffices to show that
\[
\frac{CP}{PD} = \frac{CK}{KD}. \tag{1}
\]

To verify (1), consider the circumcircle $\Omega$ of triangle $ABC$. Draw its diameter $CU$ through $C$, and let $CU$ meet $AB$ at $V$. Extend $CK$ to meet $\Omega$ at $L$. Since $AB$ is parallel to $UL$, we have $\angle ACU = \angle BCL$. On the other hand $\angle EFC = \angle BAC$, $\angle FEC = \angle ABC$ and $EF/AB = \cos \gamma$, as stated above. So reflection in the bisector of $\angle ACB$ followed by a homothety with centre $C$ and ratio $1/\cos \gamma$ takes triangle $FEC$ to triangle $ABC$. Consequently, this transformation takes $CD$ to $CU$, which implies $CP/PD = CV/VU$. Next, we have $KL = KD$, because $D$ is the orthocentre of triangle $ABC$. Hence $CK/KD = CK/KL$. Finally, $CV/VU = CK/KL$ because $AB$ is parallel to $UL$. Relation (1) follows, proving that $P$ lies on line $AO_1$. By symmetry, $P$ also lies on line $AO_2$ which completes the solution.
",406,3
2006g7,"In a triangle $ABC$, let $M_a, M_b, M_c$ be respectively the midpoints of the sides $BC$, $CA$, $AB$ and $T_a, T_b, T_c$ be the midpoints of the arcs $BC$, $CA$, $AB$ of the circumcircle of $ABC$, not containing the opposite vertices. For $i \in \{a,b,c\}$, let $\omega_i$ be the circle with $M_iT_i$ as diameter. Let $p_i$ be the common external tangent to $\omega_j$, $\omega_k$ ($\{i,j,k\} = \{a,b,c\}$) such that $\omega_i$ lies on the opposite side of $p_i$ than $\omega_j$, $\omega_k$ do. Prove that the lines $p_a, p_b, p_c$ form a triangle similar to $ABC$ and find the ratio of similitude.","\textbf{Solution.} Let $T_aT_b$ intersect circle $\omega_b$ at $T_b$ and $U$, and let $T_aT_c$ intersect circle $\omega_c$ at $T_c$ and $V$. Further, let $UX$ be the tangent to $\omega_b$ at $U$, with $X$ on $AC$, and let $VY$ be the tangent to $\omega_c$ at $V$, with $Y$ on $AB$. The homothety with centre $T_b$ and ratio $T_bT_a/T_bU$ maps the circle $\omega_b$ onto the circumcircle of $ABC$ and the line $UX$ onto the line tangent to the circumcircle at $T_a$, which is parallel to $BC$; thus $UX \parallel BC$. The same is true of $VY$, so that $UX \parallel BC \parallel VY$.

Let $T_aT_b$ cut $AC$ at $P$ and let $T_aT_c$ cut $AB$ at $Q$. The point $X$ lies on the hypotenuse $PM_b$ of the right triangle $PUM_b$ and is equidistant from $U$ and $M_b$. So $X$ is the midpoint of $M_bP$. Similarly $Y$ is the midpoint of $M_cQ$.

Denote the incenter of triangle $ABC$ as usual by $I$. It is a known fact that $T_aI = T_aB$ and $T_cI = T_cB$. Therefore the points $B$ and $I$ are symmetric across $T_aT_c$, and consequently
\[
\angle QIB = \angle QBI = \angle IBC.
\]
This implies that $BC$ is parallel to the line $IQ$, and likewise, to $IP$. In other words, $PQ$ is the line parallel to $BC$ passing through $I$.

Clearly $M_bM_c \parallel BC$. So $PM_bM_cQ$ is a trapezoid and the segment $XY$ connects the midpoints of its nonparallel sides; hence $XY \parallel BC$. This combined with the previously established relations $UX \parallel BC \parallel VY$ shows that all the four points $U, X, Y, V$ lie on a line which is the common tangent to circles $\omega_b$, $\omega_c$. Since it leaves these two circles on one side and the circle $\omega_a$ on the other, this line is just the line $p_a$ from the problem statement.

Line $p_a$ runs midway between $I$ and $M_bM_c$. Analogous conclusions hold for the lines $p_b$ and $p_c$. So these three lines form a triangle homothetic from centre $I$ to triangle $M_aM_bM_c$ in ratio $1/2$, hence similar to $ABC$ in ratio $1/4$.
",346,3
2006g8,"Let $ABCD$ be a convex quadrilateral. A circle passing through the points $A$ and $D$ and a circle passing through the points $B$ and $C$ are externally tangent at a point $P$ inside the quadrilateral. Suppose that
\[
\angle PAB + \angle PDC \leq 90^\circ \quad \text{and} \quad \angle PBA + \angle PCD \leq 90^\circ.
\]
Prove that $AB + CD \geq BC + AD$.","\textbf{Solution.} We start with a preliminary observation. Let $T$ be a point inside the quadrilateral $ABCD$. Then:
\[
\text{Circles } (BCT) \text{ and } (DAT) \text{ are tangent at } T \quad \text{if and only if} \quad \angle ADT + \angle BCT = \angle ATB. \tag{1}
\]
Indeed, if the two circles touch each other then their common tangent at $T$ intersects the segment $AB$ at a point $Z$, and so $\angle ADT = \angle ATZ$, $\angle BCT = \angle BTZ$, by the tangent-chord theorem. Thus $\angle ADT + \angle BCT = \angle ATZ + \angle BTZ = \angle ATB$.

And conversely, if $\angle ADT + \angle BCT = \angle ATB$ then one can draw from $T$ a ray $TZ$ with $Z$ on $AB$ so that $\angle ADT = \angle ATZ$, $\angle BCT = \angle BTZ$. The first of these equalities implies that $TZ$ is tangent to the circle $(DAT)$; by the second equality, $TZ$ is tangent to the circle $(BCT)$, so the two circles are tangent at $T$.

\medskip

So the equivalence (1) is settled. It will be used later on. Now pass to the actual solution. Its key idea is to introduce the circumcircles of triangles $ABP$ and $CDP$ and to consider their second intersection $Q$ (assume for the moment that they indeed meet at two distinct points $P$ and $Q$).

Since the point $A$ lies outside the circle $(BCP)$, we have $\angle BCP + \angle BAP < 180^\circ$. Therefore the point $C$ lies outside the circle $(DAP)$. Analogously, $D$ also lies outside that circle. It follows that $P$ and $Q$ lie on the same arc $CD$ of the circle $(BCP)$.

By symmetry, $P$ and $Q$ lie on the same arc $AB$ of the circle $(ABP)$. Thus the point $Q$ lies either inside the angle $BPC$ or inside the angle $APD$. Without loss of generality assume that $Q$ lies inside the angle $BPC$. Then
\[
\angle AQD = \angle PQA + \angle PQD = \angle PBA + \angle PCD \leq 90^\circ, \tag{2}
\]
by the condition of the problem.

In the cyclic quadrilaterals $APQB$ and $DPQC$, the angles at vertices $A$ and $D$ are acute. So their angles at $Q$ are obtuse. This implies that $Q$ lies not only inside the angle $BPC$ but in fact inside the triangle $BPC$, hence also inside the quadrilateral $ABCD$.

Now an argument similar to that used in deriving (2) shows that
\[
\angle BQC = \angle PAB + \angle PDC \leq 90^\circ. \tag{3}
\]
Moreover, since $\angle PCQ = \angle PDQ$, we get
\begin{align*}
\angle ADQ + \angle BCQ &= \angle ADP + \angle PDQ + \angle BCP - \angle PCQ \\
&= \angle ADP + \angle BCP.
\end{align*}
The last sum is equal to $\angle APB$, according to the observation (1) applied to $T = P$. And because $\angle APB = \angle AQB$, we obtain
\[
\angle ADQ + \angle BCQ = \angle AQB.
\]
Applying now (1) to $T = Q$ we conclude that the circles $(BCQ)$ and $(DAQ)$ are externally tangent at $Q$. (We have assumed $P \ne Q$; but if $P = Q$ then the last conclusion holds trivially.)

Finally consider the halfdiscs with diameters $BC$ and $DA$ constructed inwardly to the quadrilateral $ABCD$. They have centres at $M$ and $N$, the midpoints of $BC$ and $DA$ respectively. In view of (2) and (3), these two halfdiscs lie entirely inside the circles $(BQC)$ and $(AQD)$; and since these circles are tangent, the two halfdiscs cannot overlap. Hence
\[
MN \geq \tfrac{1}{2} BC + \tfrac{1}{2} DA.
\]
On the other hand, since $\overrightarrow{MN} = \tfrac{1}{2}(\overrightarrow{BA} + \overrightarrow{CD})$, we have
\[
MN \leq \tfrac{1}{2}(AB + CD).
\]
Thus indeed
\[
AB + CD \geq BC + DA,
\]
as claimed.
",621,4
2006g9,"Points $A_1, B_1, C_1$ are chosen on the sides $BC$, $CA$, $AB$ of a triangle $ABC$, respectively. The circumcircles of triangles $AB_1C_1$, $BC_1A_1$, $CA_1B_1$ intersect the circumcircle of triangle $ABC$ again at points $A_2, B_2, C_2$, respectively ($A_2 \ne A$, $B_2 \ne B$, $C_2 \ne C$). Points $A_3, B_3, C_3$ are symmetric to $A_1, B_1, C_1$ with respect to the midpoints of the sides $BC$, $CA$, $AB$ respectively. Prove that the triangles $A_2B_2C_2$ and $A_3B_3C_3$ are similar.","\textbf{Solution.} We will work with oriented angles between lines. For two straight lines $\ell, m$ in the plane, $\angle(\ell, m)$ denotes the angle of counterclockwise rotation which transforms line $\ell$ into a line parallel to $m$ (the choice of the rotation centre is irrelevant). This is a signed quantity; values differing by a multiple of $\pi$ are identified, so that
\[
\angle(\ell, m) = -\angle(m, \ell), \qquad \angle(\ell, m) + \angle(m, n) = \angle(\ell, n).
\]

If $\ell$ is the line through points $K, L$ and $m$ is the line through $M, N$, one writes $\angle(KL, MN)$ for $\angle(\ell, m)$; the characters $K, L$ are freely interchangeable; and so are $M, N$.

The counterpart of the classical theorem about cyclic quadrilaterals is the following:

\textit{If $K, L, M, N$ are four noncollinear points in the plane, then}
\[
K, L, M, N \text{ are concyclic if and only if } \angle(KM, LM) = \angle(KN, LN). \tag{1}
\]

Passing to the solution proper, we first show that the three circles $(AB_1C_1)$, $(BC_1A_1)$, $(CA_1B_1)$ have a common point. So, let $(AB_1C_1)$ and $(BC_1A_1)$ intersect at the points $C_1$ and $P$. Then by (1)
\[
\angle(PA_1, CA_1) = \angle(PA_1, BA_1) = \angle(PC_1, BC_1)
= \angle(PC_1, AC_1) = \angle(PB_1, AB_1) = \angle(PB_1, CB_1).
\]
Denote this angle by $\varphi$.

The equality between the outer terms shows, again by (1), that the points $A_1, B_1, P, C$ are concyclic. Thus $P$ is the common point of the three mentioned circles.

Now from the basic property (1) we will use without explicit reference. We have
\[
\varphi = \angle(PA_1, BC) = \angle(PB_1, CA) = \angle(PC_1, AB). \tag{2}
\]

Let lines $A_2P, B_2P, C_2P$ meet the circle $(ABC)$ again at $A_4, B_4, C_4$, respectively. As
\[
\angle(A_4A_2, AA_2) = \angle(PA_2, AA_2) = \angle(PC_1, AC_1) = \angle(PC_1, AB) = \varphi,
\]
we see that line $A_2A$ is the image of line $A_2A_4$ under rotation about $A_2$ by the angle $\varphi$. Hence the point $A$ is the image of $A_4$ under rotation by $2\varphi$ about $O$, the centre of $(ABC)$. The same rotation sends $B_4$ to $B$ and $C_4$ to $C$. Triangle $ABC$ is the image of $A_4B_4C_4$ in this map. Thus
\[
\angle(A_4B_4, AB) = \angle(B_4C_4, BC) = \angle(C_4A_4, CA) = 2\varphi. \tag{3}
\]
Since the rotation by $2\varphi$ about $O$ takes $B_4$ to $B$, we have $\angle(AB_4, AB) = \varphi$. Hence by (2)
\[
\angle(AB_4, PC_1) = \angle(AB_4, AB) + \angle(AB, PC_1) = \varphi + (-\varphi) = 0,
\]
which means that $AB_4 \parallel PC_1$.

Let $C_5$ be the intersection of lines $PC_1$ and $A_4B_4$; define $A_5, B_5$ analogously. So $AB_4 \parallel C_1C_5$ and, by (3) and (2),
\[
\angle(A_4B_4, PC_1) = \angle(A_4B_4, AB) + \angle(AB, PC_1) = 2\varphi + (-\varphi) = \varphi; \tag{4}
\]
i.e., $\angle(B_4C_5, C_5C_1) = \varphi$. This combined with $\angle(C_5C_1, C_1A) = \angle(PC_1, AB) = \varphi$ (see (2)) proves that the quadrilateral $AB_4C_5C_1$ is an isosceles trapezoid with $AC_1 = B_4C_5$.

Interchanging the roles of $A$ and $B$ we infer that also $BC_1 = A_4C_5$. And since $AC_1 + BC_1 = AB = A_4B_4$, it follows that the point $C_5$ lies on the line segment $A_4B_4$ and partitions it into segments $A_4C_5$, $B_4C_5$ of lengths $BC_1 (= AC_3)$ and $AC_1 (= BC_3)$. In other words, the rotation which maps triangle $A_4B_4C_4$ onto $ABC$ carries $C_5$ onto $C_3$. Likewise, it sends $A_5$ to $A_3$ and $B_5$ to $B_3$. So the triangles $A_3B_3C_3$ and $A_5B_5C_5$ are congruent. It now suffices to show that the latter is similar to $A_2B_2C_2$.

Lines $B_4C_5$ and $PC_5$ coincide respectively with $A_4B_4$ and $PC_1$. Thus by (4)
\[
\angle(B_4C_5, PC_5) = \varphi.
\]
Analogously (by cyclic shift) $\varphi = \angle(C_4A_5, PA_5)$, which rewrites as
\[
\varphi = \angle(B_4A_5, PA_5).
\]
These relations imply that the points $P, B_4, C_5, A_5$ are concyclic. Analogously, $P, C_4, A_5, B_5$ and $P, A_4, B_5, C_5$ are concyclic quadruples. Therefore
\[
\angle(A_5B_5, C_5B_5) = \angle(A_5B_5, PB_5) + \angle(PB_5, C_5B_5) = \angle(A_5C_4, PC_4) + \angle(PA_4, C_5A_4). \tag{5}
\]

On the other hand, since the points $A_2, B_2, C_2, A_4, B_4, C_4$ all lie on the circle $(ABC)$, we have
\[
\angle(A_2B_2, C_2B_2) = \angle(A_2B_2, B_4B_2) + \angle(B_4B_2, C_2B_2) = \angle(A_2A_4, B_4A_4) + \angle(B_4C_4, C_2C_4). \tag{6}
\]

But the lines $A_2A_4$, $B_4A_4$, $B_4C_4$, $C_2C_4$ coincide respectively with $PA_4$, $C_5A_4$, $A_5C_4$, $PC_4$. So the sums on the right-hand sides of (5) and (6) are equal, leading to equality between their left-hand sides:
\[
\angle(A_5B_5, C_5B_5) = \angle(A_2B_2, C_2B_2).
\]
Hence (by cyclic shift, once more) also
\[
\angle(B_5C_5, A_5C_5) = \angle(B_2C_2, A_2C_2) \quad \text{and} \quad \angle(C_5A_5, B_5A_5) = \angle(C_2A_2, B_2A_2).
\]
This means that the triangles $A_5B_5C_5$ and $A_2B_2C_2$ have their corresponding angles equal, and consequently they are similar.

\bigskip

\textbf{Comment 1.} This is the way in which the proof has been presented by the proposer. Trying to work it out in the language of classical geometry, so as to avoid oriented angles, one is led to difficulties due to the fact that the reasoning becomes heavily case-dependent. Disposition of relevant points can vary in many respects. Angles which are equal in one case become supplementary in another. Although it seems not hard to translate all formulas from the shapes they have in one situation to the one they have in another, the real trouble is to identify all cases possible and rigorously verify that the key conclusions retain validity in each case.

The use of oriented angles is a very efficient method to omit this trouble. It seems to be the most appropriate environment in which the solution can be elaborated.

\bigskip

\textbf{Comment 2.} Actually, the fact that the circles $(AB_1C_1)$, $(BC_1A_1)$ and $(CA_1B_1)$ have a common point does not require a proof; it is known as Miquels theorem.

",953,4
2006n2,"\textbf{N2.} For $x \in (0,1)$ let $y \in (0,1)$ be the number whose $n$th digit after the decimal point is the $(2^n)$th digit after the decimal point of $x$. Show that if $x$ is rational then so is $y$.","\textbf{Solution.} Since $x$ is rational, its digits repeat periodically starting at some point. We wish to show that this is also true for the digits of $y$, implying that $y$ is rational.

Let $d$ be the length of the period of $x$ and let $d = 2^u \cdot v$, where $v$ is odd. There is a positive integer $w$ such that
\[
2^w \equiv 1 \pmod{v}.
\]
(For instance, one can choose $w$ to be $\varphi(v)$, the value of Eulers totient function at $v$.) Therefore
\[
2^{n+w} = 2^n \cdot 2^w \equiv 2^n \pmod{v}
\]
for each $n$. Also, for $n \geq u$ we have
\[
2^{n+w} \equiv 2^n \pmod{2^u}.
\]
It follows that, for all $n \geq u$, the relation
\[
2^{n+w} \equiv 2^n \pmod{d}
\]
holds. Thus, for $n$ sufficiently large, the $2^{n+w}$th digit of $x$ is in the same spot in the cycle of $x$ as its $2^n$th digit, and so these digits are equal. Hence the $(n+w)$th digit of $y$ is equal to its $n$th digit. This means that the digits of $y$ repeat periodically with period $w$ from some point on, as required.
",188,2
2006n3,"The sequence $f(1), f(2), f(3), \dots$ is defined by
\[
f(n) = \frac{1}{n} \left( \left\lfloor \frac{n}{1} \right\rfloor + \left\lfloor \frac{n}{2} \right\rfloor + \cdots + \left\lfloor \frac{n}{n} \right\rfloor \right),
\]
where $\lfloor x \rfloor$ denotes the integer part of $x$.

\begin{itemize}
\item[(a)] Prove that $f(n+1) > f(n)$ infinitely often.
\item[(b)] Prove that $f(n+1) < f(n)$ infinitely often.
\end{itemize}","\textbf{Solution.} Let $g(n) = n f(n)$ for $n \geq 1$ and $g(0) = 0$. We note that, for $k = 1, \dots, n$,
\[
\left\lfloor \frac{n}{k} \right\rfloor - \left\lfloor \frac{n - 1}{k} \right\rfloor =
\begin{cases}
0 & \text{if } k \nmid n, \\
1 & \text{if } k \mid n.
\end{cases}
\]
It therefore follows that if $d(n)$ is the number of positive divisors of $n \geq 1$, then
\[
g(n) = \left\lfloor \frac{n}{1} \right\rfloor + \left\lfloor \frac{n}{2} \right\rfloor + \cdots + \left\lfloor \frac{n}{n} \right\rfloor
= \left( \left\lfloor \frac{n-1}{1} \right\rfloor + \cdots + \left\lfloor \frac{n-1}{n} \right\rfloor \right) + d(n)
= g(n - 1) + d(n).
\]

Hence,
\[
g(n) = g(n-1) + d(n) = g(n-2) + d(n-1) + d(n) = \cdots = d(1) + d(2) + \cdots + d(n),
\]
meaning that
\[
f(n) = \frac{d(1) + d(2) + \cdots + d(n)}{n}.
\]

In other words, $f(n)$ is equal to the arithmetic mean of $d(1), d(2), \ldots, d(n)$. In order to prove the claims, it is therefore sufficient to show that $d(n + 1) > f(n)$ and $d(n + 1) < f(n)$ both hold infinitely often.

We note that $d(1) = 1$. For $n > 1$, $d(n) \geq 2$ holds, with equality if and only if $n$ is prime. Since $f(6) = 7/3 > 2$, it follows that $f(n) > 2$ holds for all $n \geq 6$.

Since there are infinitely many primes, $d(n + 1) = 2$ holds for infinitely many values of $n$, and for each such $n \geq 6$ we have $d(n + 1) = 2 < f(n)$. This proves claim (b).

To prove (a), notice that the sequence $d(1), d(2), d(3), \dots$ is unbounded (e.g., $d(2^k) = k + 1$ for all $k$). Hence $d(n+1) > \max\{d(1), d(2), \dots, d(n)\}$ for infinitely many $n$. For all such $n$, we have $d(n + 1) > f(n)$. This completes the solution.
",313,3
2006n4,"Let $P$ be a polynomial of degree $n > 1$ with integer coefficients and let $k$ be any positive integer. Consider the polynomial $Q(x) = P(P(\ldots P(P(x)) \ldots ))$, with $k$ pairs of parentheses. Prove that $Q$ has no more than $n$ integer fixed points, i.e. integers satisfying the equation $Q(x) = x$.","\textbf{Solution.} The claim is obvious if every integer fixed point of $Q$ is a fixed point of $P$ itself.

For the sequel assume that this is not the case. Take any integer $x_0$ such that $Q(x_0) = x_0$, $P(x_0) \neq x_0$ and define inductively $x_{i+1} = P(x_i)$ for $i = 0,1,2,\dots$ then $x_k = x_0$.

It is evident that
\[
P(u) - P(v) \text{ is divisible by } u - v \text{ for distinct integers } u, v. \tag{1}
\]
(Indeed, if $P(x) = \sum a_i x^i$ then each $a_i(u^i - v^i)$ is divisible by $u - v$.) Therefore each term in the chain of (nonzero) differences
\[
x_0 - x_1,\quad x_1 - x_2,\quad \dots,\quad x_{k-1} - x_k,\quad x_k - x_{k+1} \tag{2}
\]
is a divisor of the next one; and since $x_k - x_{k+1} = x_0 - x_1$, all these differences have equal absolute values. For $x_m = \min(x_1, \dots, x_k)$ this means that $x_{m-1} - x_m = -(x_m - x_{m+1})$. Thus $x_{m-1} = x_{m+1} (\neq x_m)$. It follows that consecutive differences in the sequence (2) have opposite signs. Consequently, $x_0, x_1, x_2, \dots$ is an alternating sequence of two distinct values. In other words, every integer fixed point of $Q$ is a fixed point of the polynomial $P(P(x))$. Our task is to prove that there are at most $n$ such points.

Let $a$ be one of them so that $b = P(a) \ne a$ (we have assumed that such an $a$ exists); then $a = P(b)$. Take any other integer fixed point $\alpha$ of $P(P(x))$ and let $P(\alpha) = \beta$, so that $P(\beta) = \alpha$; the numbers $\alpha$ and $\beta$ need not be distinct ($\alpha$ can be a fixed point of $P$), but each of $\alpha, \beta$ is different from each of $a, b$.

Applying property (1) to the four pairs of integers $(\alpha, a)$, $(\beta, b)$, $(\alpha, b)$, $(\beta, a)$ we get that the numbers $\alpha - a$ and $\beta - b$ divide each other, and also $\alpha - b$ and $\beta - a$ divide each other. Consequently
\[
\alpha - b = \pm (\beta - a), \qquad \alpha - a = \pm (\beta - b). \tag{3}
\]

Suppose we have a plus in both instances: $\alpha - b = \beta - a$ and $\alpha - a = \beta - b$. Subtraction yields $a - b = b - a$, a contradiction, as $a \ne b$. Therefore at least one equality in (3) holds with a minus sign. For each of them this means that $\alpha + \beta = a + b$; equivalently $a + b - \alpha - P(\alpha) = 0$.

Denote $a + b$ by $C$. We have shown that every integer fixed point of $Q$ other than $a$ and $b$ is a root of the polynomial $F(x) = C - x - P(x)$. This is of course true for $a$ and $b$ as well. And since $P$ has degree $n > 1$, the polynomial $F$ has the same degree, so it cannot have more than $n$ roots. Hence the result.

\medskip

\textbf{Comment.} The first part of the solution, showing that integer fixed points of any iterate of $P$ are in fact fixed points of the second iterate $P \circ P$ is standard; moreover, this fact has already appeared in contests. We ho
",548,4
2006n7,"Prove that, for every positive integer $n$, there exists an integer $m$ such that $2^m + m$ is divisible by $n$.","\textbf{Solution.} We will prove by induction on $d$ that, for every positive integer $N$, there exist positive integers $b_0, b_1, \dots, b_{d-1}$ such that, for each $i = 0, 1, 2, \dots, d - 1$, we have $b_i > N$ and
\[
2^{b_i} + b_i \equiv i \pmod{d}.
\]
This yields the claim for $m = b_0$.

The base case $d = 1$ is trivial. Take an $a > 1$ and assume that the statement holds for all $d < a$. Note that the remainders of $2^i$ modulo $a$ repeat periodically starting with some exponent $M$. Let $k$ be the length of the period; this means that $2^{M + k'} \equiv 2^M \pmod{a}$ holds only for those $k'$ which are multiples of $k$. Note further that the period cannot contain all the $a$ remainders, since 0 either is missing or is the only number in the period. Thus $k < a$.

Let $d = \gcd(a, k)$ and take $a' = a/d$, $k' = k/d$. Since $0 < k < a$, we also have $0 < d < a$. By the induction hypothesis, there exist positive integers $b_0, b_1, \dots, b_{d-1}$ such that $b_i > \max(2^M, N)$ and
\[
2^{b_i} + b_i \equiv i \pmod{d}, \quad \text{for } i = 0, 1, \dots, d - 1. \tag{1}
\]

For each $i = 0, 1, \dots, d - 1$ consider the sequence
\[
2^{b_i} + b_i,\quad 2^{b_i + k} + (b_i + k),\quad \dots,\quad 2^{b_i + (a' - 1)k} + (b_i + (a' - 1)k). \tag{2}
\]

Modulo $a$, these numbers are congruent to
\[
2^{b_i} + b_i,\quad 2^{b_i} + (b_i + k),\quad \dots,\quad 2^{b_i} + (b_i + (a' - 1)k),
\]
respectively. The $d$ sequences contain $a'd = a$ numbers altogether. We shall now prove that no two of these numbers are congruent modulo $a$.

Suppose that
\[
2^{b_i} + (b_i + mk) \equiv 2^{b_j} + (b_j + nk) \pmod{a} \tag{3}
\]
for some values of $i, j \in \{0, 1, \dots, d - 1\}$ and $m, n \in \{0, 1, \dots, a' - 1\}$. Since $d$ is a divisor of $a$, we also have
\[
2^{b_i} + (b_i + mk) \equiv 2^{b_j} + (b_j + nk) \pmod{d}.
\]
Because $d$ is a divisor of $k$ and in view of (1), we obtain $i \equiv j \pmod{d}$. As $i, j \in \{0, 1, \dots, d - 1\}$, this just means that $i = j$. Substituting this into (3) yields $mk \equiv nk \pmod{a}$. Therefore $mk' \equiv nk' \pmod{a'}$; and since $a'$ and $k'$ are coprime, we get $m \equiv n \pmod{a'}$. Hence also $m = n$.

It follows that the $a$ numbers that make up the $d$ sequences (2) satisfy all the requirements; they are certainly all greater than $N$ because we chose each $b_i > \max(2^M, N)$. So the statement holds for $a$, completing the induction.
",476,3
2005p1,"Six points are chosen on the sides of an equilateral triangle $ABC$: $A_1, A_2$ on $BC$, $B_1$, $B_2$ on $CA$ and $C_1$, $C_2$ on $AB$, such that they are the vertices of a convex hexagon $A_1A_2B_1B_2C_1C_2$ with equal side lengths. Prove that the lines $A_1B_2, B_1C_2$ and $C_1A_2$ are concurrent.","Let $D = C_2A_1 \cap A_2B_1$, and similarly define $E$ and $F$. We claim that $DEF$ is equilateral.

Proof: Note that the vectors $\overrightarrow{A_1A_2}$, $\overrightarrow{A_2B_1}$, $\overrightarrow{B_1B_2}$, $\overrightarrow{B_2C_1}$, $\overrightarrow{C_1C_2}$, $\overrightarrow{C_2A_1}$ add to 0. But we also have: \[\overrightarrow{A_1A_2}+\overrightarrow{B_1B_2}+\overrightarrow{C_1C_2}=0\] since these are at the sides of an equilateral triangle. This means that \[\overrightarrow{A_2B_1}+\overrightarrow{B_2C_1}+\overrightarrow{C_2A_1}=0.\] These three unit vectors thus form an equilateral triangle.

Now $\angle A_1DB_1 = 60^{\circ} = \angle A_1CB_1$, so quadrilateral $A_1DCB_1$ is cyclic. So $\angle CA_1D = \angle CB_1D$ and $\angle C_2A_1A_2 = \angle A_2B_1B_2$. This means that triangles $C_2A_1A_2$ and $A_2B_1B_2$ are congruent, so $C_2A_2 = A_2B_2$. But also, $C_2C_1 = C_1B_2$, so $C_1A_2$ is the perpendicular bisector of $A_1B_1C_1$. Similarly, $A_1B_2$ and $B_1C_2$ are also perpendicular bisectors. Therefore, they concur.",122,2
2005p2,"Let $a_1, a_2, \dots$ be a sequence of integers with infinitely many positive and negative terms. Suppose that for every positive integer $n$ the numbers $a_1, a_2, \dots, a_n$ leave $n$ different remainders upon division by $n$. Prove that every integer occurs exactly once in the sequence.","Solution
${a_n}$ satisfies the conditions if and only if ${a_n-a_1}$ does. Therefore we can assume that $a_1=0$

First of all, $|a_n|<n$ Otherwise, $a_n = 0$ mod $a_{a_n}$


Claim: $a_{k+1}$ is either the smallest positive number not in ${a_1, a_2, ..., a_k}$ or the largest negative number not in this set.

Proof by induction: the induction hypothesis implies that $a_1, a_2, ..., a_k$ are consecutive. Let m and M be the smallest and largest numbers in this consecutive set, respectively. It is clear that $a_{k+1}=m-1=M+1$ mod $k+1$. But since $|a_n|<n$, $a_{k+1}=m-1$ or $M+1$

This proves that if ${a_n}$ contains an infinite number of positive and negative numbers, it must contain each integer exactly once.",113,2
2005p3,"Let $x, y, z > 0$ satisfy $xyz\ge 1$. Prove that \[\frac{x^5-x^2}{x^5+y^2+z^2} + \frac{y^5-y^2}{x^2+y^5+z^2} + \frac{z^5-z^2}{x^2+y^2+z^5} \ge 0.\]",,0,
2005p5,"Let $ABCD$ be a fixed convex quadrilateral with $BC = DA$ and $BC \nparallel DA$. Let two variable points $E$ and $F$ lie of the sides $BC$ and $DA$, respectively, and satisfy $BE = DF$. The lines $AC$ and $BD$ meet at $P$, the lines $BD$ and $EF$ meet at $Q$, the lines $EF$ and $AC$ meet at $R$. Prove that the circumcircles of the triangles $PQR$, as $E$ and $F$ vary, have a common point other than $P$.","Let $M$ be the Miquel point of complete quadrilateral $ADBC$; in other words, let $M$ be the second intersection point of the circumcircles of $\triangle APD$ and $\triangle BPC$. (A good diagram should betray this secret; all the points are given in the picture.) This makes lots of sense since we know $E$ and $F$ will be sent to each other under the spiral similarity too.

Thus $M$ is the Miquel point of complete quadrilateral $FACE$. As $R = \overline{FE} \cap \overline{AC}$ we deduce $FARM$ is a cyclic quadrilateral (among many others, but well only need one).

Now look at complete quadrilateral $AFQP$. Since $M$ lies on $(DFQ)$ and $(RAF)$, it follows that $M$ is in fact the Miquel point of $AFQP$ as well. So $M$ lies on $(PQR)$.

Thus $M$ is the fixed point that we wanted.
",138,2
2005p6,"In a mathematical competition, in which 6 problems were posed to the participants, every two of these problems were solved by more than 2/5 of the contestants. Moreover, no contestant solved all the 6 problems. Show that there are at least 2 contestants who solved exactly 5 problems each.","Assume not and at most one contestant solved five problems. By adding in solves, we can assume WLOG that one contestant solved problems one through five, and every other contestant solved four of the six problems.

We split the remaining contestants based on whether they solved P6. Let $a_i$ denote the number of contestants who solved $\{1, 2, \dots, 5\} \setminus \{i\}$ (and missed P6). Let $b_{ij}$ denote the number of contestants who solved $\{1, 2, \dots, 5, 6\} \setminus \{i,j\}$ for $1 \le i < j \le 5$ (thus in particular they solved P6). Thus
\[
n = 1 + \sum_{1 \le i \le 5} a_i + \sum_{1 \le i < j \le 5} b_{ij}
\]
denotes the total number of contestants.

Considering contestants who solved P1/P6 we have
\[
t_1 := b_{23} + b_{24} + b_{25} + b_{34} + b_{35} + b_{45} \ge \frac{2}{5}n + \frac{1}{5}
\]
and we similarly define $t_2, t_3, t_4, t_5$. (We have written $\frac{2}{5}n + \frac{1}{5}$ since we know the left-hand side is an integer strictly larger than $\frac{2}{5}n$.) Also, by considering contestants who solved P1/P2 we have
\[
t_{12} = 1 + a_3 + a_4 + a_5 + b_{34} + b_{35} + b_{45} \ge \frac{2}{5}n + \frac{1}{5}
\]
and we similarly define $t_{ij}$ for $1 \le i < j \le 5$.

\textbf{Claim } The number $\frac{2n+1}{5}$ is equal to some integer $k$, fourteen of the $t$s are equal to $k$, and the last one is equal to $k+1$.

\textbf{Proof.} First, summing all fifteen equations gives
\begin{align*}
6n + 4 &= 10 + 6(n - 1) = 10 + \sum_{1 \le i \le 5} 6a_i + \sum_{1 \le i < j \le 5} 6b_{ij} \\
&= \sum_{1 \le i \le 5} t_i + \sum_{1 \le i < j \le 5} t_{ij}.
\end{align*}
Thus the sum of the 15 $t$s is $6n + 4$. But since all the $t$s are integers at least $\frac{2n+1}{5} = \frac{6n + 3}{15}$, the conclusion follows. \qed

We however will also manipulate the equations to get the following.

\textbf{Claim } We have 
\[
t_{45} \equiv 1 + t_1 + t_2 + t_3 + t_{12} + t_{23} + t_{31} \pmod{3}.
\]

\textbf{Proof.} This follows directly by computing the coefficient of the $a$s and $b$s. We will nonetheless write out a derivation of this equation, to motivate it, but the proof stands without it.

Let $B = \sum_{1 \le i < j \le 5} b_{ij}$ be the sum of all $b$s. First, note that
\begin{align*}
t_1 + t_2 &= B + b_{34} + b_{45} + b_{35} - b_{12} \\
&= B + (t_{12} - 1 - a_3 - a_4 - a_5) - b_{12} \\
\implies b_{12} &= B - (t_1 + t_2) + t_{12} - 1 - (a_3 + a_4 + a_5).
\end{align*}
This means we have more or less solved for each $b_{ij}$ in terms of only $t$ and $a$ variables.

Now
\begin{align*}
t_{45} &= 1 + a_1 + a_2 + a_3 + b_{12} + b_{23} + b_{31} \\
&= 1 + a_1 + a_2 + a_3 \\
&\quad + [B - (t_1 + t_2) + t_{12} - 1 - (a_3 + a_4 + a_5)] \\
&\quad + [B - (t_2 + t_3) + t_{23} - 1 - (a_1 + a_4 + a_5)] \\
&\quad + [B - (t_3 + t_1) + t_{13} - 1 - (a_2 + a_4 + a_5)] \\
&\equiv 1 + t_1 + t_2 + t_3 + t_{12} + t_{23} + t_{31} \pmod{3}
\end{align*}
as desired. \qed

However, we now show the two claims are incompatible (and this is easy, many ways to do this). There are two cases.
\begin{itemize}
\item Say $t_5 = k + 1$ and the others are $k$. Then the equation for $t_{45}$ gives that $k \equiv 6k + 1 \pmod{3}$. But now the equation for $t_{12}$ gives $k \equiv 6k \pmod{3}$.
\item Say $t_{45} = k + 1$ and the others are $k$. Then the equation for $t_{45}$ gives that $k + 1 \equiv 6k \pmod{3}$. But now the equation for $t_{12}$ gives $k \equiv 6k + 1 \pmod{3}$.
\end{itemize}
",679,4
2004p1,Let $ABC$ be an acute-angled triangle with $AB\neq AC$. The circle with diameter $BC$ intersects the sides $AB$ and $AC$ at $M$ and $N$ respectively. Denote by $O$ the midpoint of the side $BC$. The bisectors of the angles $\angle BAC$ and $\angle MON$ intersect at $R$. Prove that the circumcircles of the triangles $BMR$ and $CNR$ have a common point lying on the side $BC$.,"Let $\angle{ACB} = a$, $\angle{CBA} = b$, and $\angle{ONR} = k$. Call $\omega$ the circle with diameter $BC$ and $\odot{AMN}$ the circumcircle of $\triangle{AMN}$.

Our ultimate goal is to show that $\angle{CNR} + \angle{RMB} = 180^\circ$. To show why this solves the problem, assume this statement holds true. Call $K$ the intersection point of the circumcircle of $\triangle{CNR}$ with side $BC$. Then, $\angle{RKC} = 180^\circ - \angle{CNR}$, and $\angle{RKB} = \angle{CNR}$. Since $\angle{RMB} = 180^\circ - \angle{CNR}$, $\angle{RKB} + \angle{RMB}  = 180^\circ$, implying $K$ also lies on the circumcircle of $\triangle{BMR}$, thereby solving the problem.

We now prove that $\angle{CNR} + \angle{RMB} = 180^\circ$. Note that $ON$ and $OM$ are radii of $\omega$, so $\triangle{MON}$ is isosceles. The bisector of $\angle{MON}$ is thus the perpendicular bisector of $MN$. Since $R$ lies on the bisector of $\angle{MON}$, $\angle{ONR} = \angle{RMO} = k$. Angle computations yield that \[\angle{RMN} = 180^\circ - \angle{BMO} - \angle{RMO} - \angle{AMN}\]\[= 180^\circ - b - k - a,\] from $\angle{AMN} = 180^\circ - \angle{BMN} = 180^\circ - (180^\circ - \angle{ACB}) = \angle{ACB}$ and from $\angle{BMO} = \angle{MBO} =$ $\angle{ABC}$.

The bisector of $\angle{BAC}$ hits $\odot{AMN}$ at the midpoint of the arc $MN$ not containing $A$. This point must lie on the perpendicular bisector of segment $MN$, which is the bisector of $\angle{MON}$. It follows that $R$ is indeed the midpoint of arc $MN$, so $A$, $M$, $R$, $N$, are concyclic. Since $\angle{RAN}$ and $\angle{RMN}$ subtend the same arc $NR$, $\angle{RAN}$ = $\angle{RMN}$. With $AR$ being the bisector of $\angle{BAC}$, we have \[\angle{RAN} = \angle{RMN} = \tfrac{\angle{CAB}}{2} = \tfrac{180^\circ - a - b}{2} = 90^\circ - \tfrac{a}{2} - \tfrac{b}{2}.\] We know that $\angle{RMN} = 180^\circ - b - k - a$. so we have $180^\circ - b - k - a = 90^\circ - \tfrac{a}{2} - \tfrac{b}{2}$. Since $\angle{CNR} = \angle{CNO} + \angle{ONR} = a + k$, and $\angle{RMB} = \angle{OMB} + \angle{RMO} = b + k$, we have \[\angle{CNR} + \angle{RMB} = a + k + b + k = a + b + 180^\circ - a - b = 180^\circ.\]

The problem is solved.

$\textbf{NOTE:}$ We have $\angle{RKB} + \angle{KBA} + \angle{BAK} = 180^\circ \implies \angle{BAK} = 180^\circ - (180^\circ - \angle{RMB})  - \angle{KBA}$. Noting that $180^\circ - \angle{RMB} = 180^\circ - b - k = 180^\circ - (90^\circ - \tfrac{a}{2} + \tfrac{b}{2}) = 90^\circ + \tfrac{a}{2} - \tfrac{b}{2}$, we then have \[\angle{BAK} = 180^\circ - (90^\circ + \tfrac{a}{2} - \tfrac{b}{2}) - b = 90^\circ - \tfrac{a}{2} - \tfrac{b}{2}\] which is indeed the measure of $\angle{BAR}$. This implies that $K$ lies on the bisector of $\angle{BAC}$, and from this, it is clear that $K$ must lie on the interior of segment $BC$. Not proving that $K$ had to lie in the interior of $BC$ was a reason that a large portion of students who submitted a solution received a 1-point deduction.",475,3
2004p4,"Let $n \geq 3$ be an integer. Let $t_1, t_2, \dots , t_n$ be positive real numbers such that

\[n^2 + 1 > \left( t_1 + t_2 + ... + t_n \right) \left( \frac {1}{t_1} + \frac {1}{t_2} + ... + \frac {1}{t_n} \right).\]

Show that $t_i$, $t_j$, $t_k$ are side lengths of a triangle for all $i$, $j$, $k$ with $1 \leq i < j < k \leq n$.","For $n=3$, suppose (for sake of contradiction) that $t_3 = t_2 + t_1 + k$ for $k \ge 0$; then (by Cauchy-Schwarz Inequality)

\begin{align*}10 &> [2(t_1 + t_2) + k]\left(\frac {1}{t_1} + \frac {1}{t_2} + \frac 1{t_1 + t_2 + k}\right) = 2(t_1+t_2)\left(\frac 1{t_1} + \frac{1}{t_2}\right) + \left(\frac{k}{t_1} + \frac k{t_2}\right) + \frac{2t_1 + 2t_2 + k}{t_1 + t_2 + k}\\ &\ge 8 + \left(\frac{k}{t_1} + \frac k{t_2}\right) + 2 - \frac{k}{t_1 + t_2 + k}\\ &= 10 + k\left(\frac{1}{t_1} + \frac {1}{t_2} - \frac{1}{t_1 + t_2+k}\right) \ge 10\end{align*}

so it is true for $n=3$. We now claim the result by induction; for $n \ge 4$, we have

\begin{align*}f(n) &:= \left( t_1 + t_2 + ... + t_n \right) \left( \frac {1}{t_1} + \frac {1}{t_2} + ... + \frac {1}{t_n} \right) \\ &= \left( t_1 + t_2 + ... + t_{n-1} \right) \left( \frac {1}{t_1} + \frac {1}{t_2} + ... + \frac {1}{t_{n-1}} \right) + t_n \sum_{i=1}^{n-1} \frac 1{t_i} + \frac{1}{t_n} \sum_{i=1}^{n-1} t_i + 1\end{align*}

By AM-GM, $\frac{t_n}{t_i} + \frac{t_i}{t_n} \ge 2$, so $f(n) \ge f(n-1) + 2(n-1) + 1 = f(n-1) + 2n - 1$. Then the problem is reduced to proving the statement true for $n-1$ numbers, as desired.",201,2
2004p5,"In a convex quadrilateral $ABCD$, the diagonal $BD$ bisects neither the angle $ABC$ nor the angle $CDA$. The point $P$ lies inside $ABCD$ and satisfies \[\angle PBC = \angle DBA \text{ and } \angle PDC = \angle BDA.\]

Prove that $ABCD$ is a cyclic quadrilateral if and only if $AP = CP.$","Let $a = t_1$, $b = t_2$, $c = t_3$. Expand:
\[
n^2 + 1 > (t_1 + t_2 + \cdots + t_n) \left( \frac{1}{t_1} + \cdots + \frac{1}{t_n} \right)
\]
\[
= n + \sum_{1 \le i < j \le n} \left( \frac{t_i}{t_j} + \frac{t_j}{t_i} \right)
\]
\[
= n + \sum_{1 \le i < j \le n} \left( \frac{t_i}{t_j} + \frac{t_j}{t_i} \right)
\]
\[
\ge n + \sum_{1 \le i < j \le 3} \left( \frac{t_i}{t_j} + \frac{t_j}{t_i} \right) + \sum_{\substack{1 \le i < j \le n\\ j > 3}} 2
\]
\[
= n + 2\left( \binom{n}{2} - 3 \right) + \left( \frac{a}{b} + \frac{b}{a} \right) + \frac{a + b}{c} + \frac{c}{b} + \frac{c}{a}
\]
\[
\ge n + 2\left( \binom{n}{2} - 3 \right) + 2 + \frac{a + b}{c} + c \cdot \frac{4}{a + b}
\]

So, we conclude that
\[
\frac{a + b}{c} + \frac{4c}{a + b} < 5
\]

which rearranges to
\[
(4c - (a + b))(c - (a + b)) < 0.
\]

This is enough to imply $c \le a + b$.

\textbf{Remark.} A variant of the same argument allows one to improve the left-hand side to $(n + \sqrt{10} - 3)^2$. One does so by writing
\[
\text{RHS} \ge \left( \sqrt{(a + b + c) \left( \frac{1}{a} + \frac{1}{b} + \frac{1}{c} \right)} + (n - 3) \right)^2
\]
and estimating the square root as in the previous approach.

In addition, $(n + \sqrt{10} - 3)^2$ is best possible, as seen by taking $(a,b,c) = (2,1,1)$ and $t_4 = t_5 = \cdots = \frac{2}{5}\sqrt{10}$.",263,3
2003p1,"$S$ is the set  $\{1, 2, 3, \dots ,1000000\}$. Show that for any subset $A$ of $S$ with $101$ elements we can find $100$ distinct elements $x_i$ of $S$, such that the sets $\{a + x_i \mid a \in A\}$ are all pairwise disjoint.","A greedy algorithm works: suppose we have picked
\[
T = \{t_1, \dots, t_n\}
\]
as large as possible, meaning its impossible to add any more elements to $T$. That means, for each $t \in \{1, \dots, 10^6\}$ either $t \in T$ already or there exist two distinct elements $a, b \in A$ and $t_i \in T$ such that
\[
t = t_i + b - a \tag{$\star$}.
\]

There are at most $|T| \cdot |A| \cdot (|A| - 1) = n \cdot 101 \cdot 100$ possible values for the right-hand side of $(\star)$. So we therefore must have
\[
101 \cdot 100 \cdot n + n \ge 10^6
\]
which implies $n > 99$, as desired.",117,2
2003p3,Each pair of opposite sides of convex hexagon has the property that the distance between their midpoints is $\frac{\sqrt{3}}{2}$ times the sum of their lengths. Prove that the hexagon is equiangular.,"Unsurprisingly, this is a geometric inequality. Denote the hexagon by $ABCDEF$. Then we have that
\[
\left| \frac{\vec{D} + \vec{E}}{2} - \frac{\vec{A} + \vec{B}}{2} \right| = \sqrt{3} \cdot \left| \frac{\vec{B} - \vec{A}}{2} + \frac{\vec{E} - \vec{D}}{2} \right| \ge \sqrt{3} \cdot \left| \frac{(\vec{B} - \vec{A}) - (\vec{E} - \vec{D})}{2} \right|
\]
and cyclic variations. Suppose we define the right-hand sides as variables
\[
\vec{x} = (\vec{B} - \vec{A}) - (\vec{E} - \vec{D})
\]
\[
\vec{y} = (\vec{D} - \vec{C}) - (\vec{A} - \vec{F})
\]
\[
\vec{z} = (\vec{F} - \vec{E}) - (\vec{C} - \vec{B}).
\]

Then we now have
\[
|\vec{y} - \vec{z}| \ge \sqrt{3} |\vec{x}|,\quad
|\vec{z} - \vec{x}| \ge \sqrt{3} |\vec{y}|,\quad
|\vec{x} - \vec{y}| \ge \sqrt{3} |\vec{z}|.
\]

We square all sides (using $|\vec{v}|^2 = \vec{v} \cdot \vec{v}$) and then sum to get
\[
\sum_{\text{cyc}} (\vec{y} - \vec{z}) \cdot (\vec{y} - \vec{z}) \ge 3 \sum_{\text{cyc}} \vec{x} \cdot \vec{x}
\]
which rearranges to
\[
-|\vec{x} + \vec{y} + \vec{z}|^2 \ge 0.
\]

This can only happen if $\vec{x} + \vec{y} + \vec{z} = 0$, and moreover all the inequalities above were actually equalities. That means that our triangle inequalities above were actually sharp (and already we have $\overline{AB} \parallel \overline{DE}$ and so on).

Working with just $\vec{x}$ and $\vec{y}$ now we have
\begin{align*}
3(\vec{x} \cdot \vec{x}) &= (2\vec{y} - \vec{x}) \cdot (2\vec{y} - \vec{x}) \\
&= \vec{x} \cdot \vec{x} - 4\vec{y} \cdot \vec{x} + 4\vec{y} \cdot \vec{y} \\
\implies -\vec{x} \cdot \vec{x} + 2(\vec{y} \cdot \vec{y}) &= 2\vec{x} \cdot \vec{y} \\
2(\vec{x} \cdot \vec{x}) - \vec{y} \cdot \vec{y} &= 2\vec{x} \cdot \vec{y}.
\end{align*}

which implies $\vec{x} \cdot \vec{x} = \vec{y} \cdot \vec{y}$, that is, $\vec{x}$ and $\vec{y}$ have the same magnitude. In this way we find $\vec{x}, \vec{y}, \vec{z}$ all have the same magnitude, and since $\vec{x} + \vec{y} + \vec{z} = 0$ they are related by $120^\circ$ rotations, as desired.",310,3
2003p4,"Let $ABCD$ be a cyclic quadrilateral. Let $P$, $Q$, and $R$ be the feet of perpendiculars from $D$ to lines $\overline{BC}$, $\overline{CA}$, and $\overline{AB}$, respectively. Show that $PQ=QR$ if and only if the bisectors of angles $ABC$ and $ADC$ meet on segment $\overline{AC}$.","Let $\gamma$ denote the circumcircle of $ABCD$. The condition on bisectors is equivalent to 
\[
(AC;BD)_\gamma = -1.
\]
Meanwhile if $\infty$ denotes the point at infinity along Simson line $\overline{PQR}$ then $PQ = QR$ if and only if 
\[
(PR;Q\infty) = -1.
\]
Let rays $BQ$ and $DQ$ meet the circumcircle again at $F$ and $E$.

\textbf{Lemma (EGMO Proposition 4.1)} \quad Then $\overline{BE} \parallel \overline{PQR}$.

\textit{Proof.} Since $\angle DPR = \angle DAR = \angle DAB = \angle DEB$.

\[
\text{Now we have} \quad (PR;Q\infty) \overset{B}{=} (CA;FE)_\gamma \overset{Q}{=} (AC;BD)_\gamma
\]
as desired. \qed",93,1
2003p5,"Let $n$ be a positive integer and let $x_1 \le x_2 \le \cdots \le x_n$ be real numbers. Prove that

\[\left( \sum_{i=1}^{n}\sum_{j=i}^{n} |x_i-x_j|\right)^2 \le \frac{2(n^2-1)}{3}\sum_{i=1}^{n}\sum_{j=i}^{n}(x_i-x_j)^2\]

with equality if and only if $x_1, x_2, ..., x_n$ form an arithmetic sequence.","Let $d_1 = x_2 - x_1, \dots, d_{n-1} = x_n - x_{n-1}$. The inequality in question becomes:
\[
\left( \sum_i i(n-i)d_i \right)^2 \leq \frac{n^2 - 1}{3} \cdot \left( \sum_i i(n-i)d_i^2 + 2\sum_{i<j} i(n-j)d_i d_j \right).
\]

Clearing the square on the right-hand side we want to show
\[
\sum_{i<j} \left( 3ij(n-i)(n-j) - (n^2 - 1)i(n-j) \right) \cdot 2 d_i d_j \le \sum_i \left(n^2 - 1 - 3i(n - i) \right) \cdot i(n - i) d_i^2.
\]

We use AM-GM directly on $2d_i d_j \le d_i^2 + d_j^2$: this actually solves the problem. The annoying part is to check that the coefficients actually match:

\textbf{Claim (Big bash)} ?For an index $1 \le k \le n-1$, we have
\[
\sum_{i<k} \left( 3ik(n-i)(n-k) - (n^2 - 1)i(n-k) \right)
+ \sum_{j>k} \left( 3kj(n-k)(n-j) - (n^2 - 1)k(n-j) \right)
= (n^2 - 1 - 3k(n-k)) \cdot k(n-k).
\]

\textit{Proof.} Rewrite as:
\[
3k(n-k) \left( -k(n-k) + \sum_i i(n-i) \right)
= (n^2 - 1)\left( (n-k) \sum_{i<k} i + k \sum_{j>k} (n-j) \right)
\]
\[
\Longleftrightarrow 3k(n-k) \sum_i i(n-i)
= (n^2 - 1)\left( (n-k) \sum_{i<k} i + k \sum_{j>k} (n-j) \right)
+ (n^2 - 1)k(n-k) - 3k^2(n-k)^2
\]
\[
\Longleftrightarrow 3k(n-k) \left( \sum_i i(n-i) \right)
= (n^2 - 1)\left( (n-k) \sum_{i<k} i + k \sum_{i<n-k} i \right)
\]

\[
\Longleftrightarrow 3k(n-k) \cdot \frac{(n-1)n(n+1)}{6}
= (n^2 - 1)k(n-k) \cdot \frac{n}{2}
\]

which is visibly true. \qed

Equality occurs only if all $d_i$ are equal because the coefficient of $d_i d_j$ is nonzero for any $i \le n/2$ and $j \ge n/2$.",254,3
2003p6,"Let $p$ be a prime number. Prove that there exists a prime number $q$ such that for every integer $n$, the number $n^p-p$ is not divisible by $q$.","By orders, we must have \( q = pk + 1 \) for this to be possible (since if \( q \not\equiv 1 \pmod{p} \), then \( n^p \) can be any residue modulo \( q \)). Since \( p \equiv n^p \pmod{q} \Longrightarrow p^k \equiv 1 \pmod{q} \), it suffices to prevent the latter situation from happening.

So we need a prime \( q \equiv 1 \pmod{p} \) such that \( p^k \not\equiv 1 \pmod{q} \). To do this, we first recall the following lemma.

\begin{center}
\begin{tcolorbox}[colback=white!95!blue, colframe=blue, sharp corners=south]
\textbf{Lemma} \\
Let \( \Phi_p(X) = 1 + X + X^2 + \cdots + X^{p-1} \). For any integer \( a \), if \( q \) is a prime divisor of \( \Phi_p(a) \) other than \( p \), then \( a \pmod{q} \) has order \( p \). (In particular, \( q \equiv 1 \pmod{p} \).)
\end{tcolorbox}
\end{center}

\textit{Proof.} We have \( a^p - 1 \equiv 0 \pmod{q} \), so either the order is 1 or \( p \). If it is 1, then \( a \equiv 1 \pmod{q} \), so \( q \mid \Phi_p(1) = p \), hence \( q = p \). \qed

Now the idea is to extract a prime factor \( q \) from the cyclotomic polynomial
\[
\Phi_p(p) = \frac{p^p - 1}{p - 1} \equiv 1 + p \pmod{p^2}
\]
such that \( q \not\equiv 1 \pmod{p^2} \); hence \( k \not\equiv 0 \pmod{p} \), and as \( p \pmod{q} \) has order \( p \) we have \( p^k \not\equiv 1 \pmod{q} \).",261,3
2002p1,"$S$ is the set of all $(h,k)$ with $h,k$ non-negative integers such that $h + k < n$. Each element of $S$ is colored red or blue, so that if $(h,k)$ is red and $h' \le h,k' \le k$, then $(h',k')$ is also red. A type $1$ subset of $S$ has $n$ blue elements with different first member and a type $2$ subset of $S$ has $n$ blue elements with different second member. Show that there are the same number of type $1$ and type $2$ subsets.","Let \( a_i \) be the number of blue members \( (h,k) \) in \( S \) with \( h = i \), and let \( b_i \) be the number of blue members \( (h,k) \) with \( k = i \). It is sufficient to show that \( b_0, b_1, \ldots, b_{n-1} \) is a rearrangement of \( a_0, a_1, \ldots, a_{n-1} \) (because the number of type 1 subsets is the product of the \( a_i \) and the number of type 2 subsets is the product of the \( b_i \)).

Let \( c_i \) be the largest \( k \) such that \( (i,k) \) is red. If \( (i,k) \) is blue for all \( k \) then we put \( c_i = -1 \). Note that if \( i < j \), then \( c_i \geq c_j \), since if \( (j, c_i) \) is red, then so is \( (i, c_i) \). Note also that \( (i,k) \) is red for \( k \leq c_i \), so the sequence \( c_0, c_1, \ldots, c_{n-1} \) completely defines the coloring of \( S \).

Let \( S_i \) be the set with the sequence \( c_0, c_1, \ldots, c_i, -1, \ldots, -1 \), so that \( S_{n-1} = S \). We also take \( S_{-1} \) as the set with the sequence \( -1, -1, \ldots, -1 \), so that all its members are blue. We show that the rearrangement result is true for \( S_{-1} \) and that if it is true for \( S_i \) then it is true for \( S_{i+1} \). It is obvious for \( S_{-1} \), because both \( a_i \) and \( b_i \) are \( n, n-1, \ldots, 2, 1 \). So suppose it is true for \( S_i \) (where \( i < n-1 \)). The only difference between the \( a_j \) for \( S_i \) and for \( S_{i+1} \) is that \( a_{i+1} = n - i - 1 \) for \( S_i \) and \( (n - i - 1) - (c_{i+1} + 1) \) for \( S_{i+1} \). In other words, the number \( n - i - 1 \) is replaced by the number \( n - i - c - 2 \), where \( c = c_{i+1} \). The difference in the \( b_j \) is that 1 is deducted from each of \( b_0, b_1, \ldots, b_c \). But these numbers are just \( n - i - 1, n - i - 1, n - i - 2, \ldots, n - i - c - 1 \). So the effect of deducting 1 from each is to replace \( n - i - 1 \) by \( n - i - c - 2 \), which is the same change as was made to the \( a_j \). So the rearrangement result also holds for \( S_{i+1} \). Hence it holds for \( S \).",500,3
2002p2,$BC$ is a diameter of a circle center $O$. $A$ is any point on the circle with $\angle AOC \not\le 60^\circ$. $EF$ is the chord which is the perpendicular bisector of $AO$. $D$ is the midpoint of the minor arc $AB$. The line through $O$ parallel to $AD$ meets $AC$ at $J$. Show that $J$ is the incenter of triangle $CEF$.,"F is equidistant from \( A \) and \( O \). But \( OF = OA \), so \( \triangle OFA \) is equilateral and hence \( \angle AOF = 60^\circ \). Since \( \angle AOC > 60^\circ \), \( F \) lies between \( A \) and \( C \). Hence the ray \( CJ \) lies between \( CE \) and \( CF \).

\( D \) is the midpoint of the arc \( AB \), so \( \angle DOB = \frac{1}{2} \angle AOB = \angle ACB \). Hence \( DO \) is parallel to \( AC \). But \( OJ \) is parallel to \( AD \), so \( AJOD \) is a parallelogram. Hence \( AJ = OD \). So \( AJ = AE = AF \), so \( J \) lies on the opposite side of \( EF \) to \( A \) and hence on the same side as \( C \). So \( J \) must lie inside the triangle \( \triangle CEF \).

Also, since \( EF \) is the perpendicular bisector of \( AO \), we have \( AE = AF = OE \), so \( A \) is the center of the circle through \( E, F \) and \( J \). Hence \( \angle EFJ = \frac{1}{2} \angle EAJ \). But \( \angle EAJ = \angle EAC \) (same angle) \( = \angle EFC \). Hence \( J \) lies on the bisector of angle \( \angle EFC \).

Since \( EF \) is perpendicular to \( AO \), \( A \) is the midpoint of the arc \( EF \). Hence \( \angle ACE = \angle ACF \), so \( J \) lies on the bisector of angle \( \angle ECF \). Hence \( J \) is the incenter.",301,3
2002p4,Let $n>1$ be an integer and let $1=d_{1}<d_{2}<d_{3} \cdots <d_{r}=n$ be all of its positive divisors in increasing order. Show that \[d=d_1d_2+d_2d_3+ \cdots +d_{r-1}d_r <n^2\],,0,
2002p6,"Let $n \ge 3$ be a positive integer. Let $C_1,C_2,...,C_n$ be unit circles in the plane, with centers $O_1,O_2,...,O_n$ respectively. If no line meets more than two of the circles, prove that

\[\sum_{1\le i< j \le n}^{}\frac{1}{O_iO_j}\le\frac{(n-1)\pi}{4}\]","For brevity, let \( d_{ij} \) be the length of \( O_iO_j \) and let \( \angle(ijk) \) be shorthand for \( \angle O_iO_jO_k \) (or its measure in radians).

First, we eliminate the circles completely and reduce the problem to angles using the following fact (which is in part motivated by the mysterious presence of \( \pi \) on the right-hand side, and also brings \( d_{ij}^{-1} \) into the picture).

\begin{lemma}
For any indices \( i, j, m \) we have the inequalities
\[
\angle(imj) \ge \max\left( \frac{2}{d_{mi}}, \frac{2}{d_{mj}} \right) \quad \text{and} \quad \pi - \angle(imj) \ge \max\left( \frac{2}{d_{mi}}, \frac{2}{d_{mj}} \right).
\]
\end{lemma}

\begin{proof}
We first prove the former line. Consider the altitude from \( O_i \) to \( O_mO_j \). The altitude must have length at least 2, otherwise its perpendicular bisector passes/intersects all of \( C_i, C_m, C_j \). Thus
\[
2 \le d_{mi} \sin \angle(imj) \le \angle(imj)
\]
proving the first line. The second line follows by considering the external angle formed by lines \( O_mO_i \) and \( O_mO_j \) instead of the internal one.
\end{proof}

Our idea now is for any index \( m \) we will make an estimate on \( \sum_{1 \le i \le n, i \ne b} \frac{1}{d_{bi}} \) for each index \( b \). If the centers formed a convex polygon, this would be much simpler, but because we do not have this assumption some more care is needed.

\begin{claim}
Suppose \( O_a, O_b, O_c \) are consecutive vertices of the convex hull. Then
\[
\frac{n-1}{n-2} \angle(abc) \ge \frac{2}{d_{1b}} + \frac{2}{d_{2b}} + \cdots + \frac{2}{d_{nb}}
\]
where the term \( \frac{2}{d_{bb}} \) does not appear (obviously).
\end{claim}

\begin{proof}
WLOG lets suppose \( (a,b,c) = (2,1,n) \) and that rotating ray \( O_2O_1 \) hits \( O_3, O_4, \dots, O_n \) in that order. We have
\[
\frac{2}{d_{12}} \le \angle(213), \quad
\frac{2}{d_{13}} \le \min \{ \angle(213), \angle(314) \}, \quad \dots, \quad
\frac{2}{d_{1n}} \le \angle((n-1)1n).
\]
Of the \( n-1 \) distinct angles appearing on the right-hand side, we let \( \kappa \) denote the smallest of them. We have \( \kappa \le \frac{1}{n-2} \angle(21n) \) by pigeonhole principle. Then we pick the minimums on the right-hand side in the unique way such that summing gives
\[
\sum_{i=2}^{n} \frac{2}{d_{1i}} \le \angle(213) + \angle(314) + \cdots + \angle((n-1)1n) + \kappa \le \angle(21n) + \frac{1}{n-2} \angle(21n) = \frac{n-1}{n-2} \angle(21n)
\]
as desired.
\end{proof}

Next we show a bound that works for any center, even if it does not lie on the convex hull \( \mathcal{H} \).

\begin{claim}
For any index \( b \) we have
\[
\frac{n-1}{n-2} \pi \ge \frac{2}{d_{1b}} + \frac{2}{d_{2b}} + \cdots + \frac{2}{d_{nb}}
\]
where the term \( \frac{2}{d_{bb}} \) does not appear (obviously).
\end{claim}

\begin{proof}
This is the same argument as in the previous proof, with the modification that because \( O_b \) could lie inside the convex hull now, our rotation argument should use lines instead of rays (in order for the angle to be \( \pi \) rather than \( 2\pi \)). This is why the first lemma is stated with two cases; we need it now.

Again WLOG \( b = 1 \). Consider line \( O_1O_2 \) (rather than just the ray) and imagine rotating it counterclockwise through \( O_2 \); suppose that this line passes through \( O_3, O_4, \dots, O_n \) in that order before returning to \( O_2 \) again. We let \( \angle(i1j) \in \{ \angle(i1j), \pi - \angle(i1j) \} \in [0, \pi) \) be the counterclockwise rotations obtained in this way, so that
\[
\angle(21n) = \angle(213) + \angle(314) + \cdots + \angle((n-1)1n).
\]
Then we get bounds
\[
\frac{2}{d_{1i}} \le \angle(i-1,1,i), \quad \text{for } i = 2, \dots, n.
\]
so as before we get
\[
\sum_{i=1}^n \frac{2}{d_{1i}} \le \frac{n-1}{n-2} \angle(21n)
\]
which is certainly less than \( \frac{n-1}{n-2} \pi \).
\end{proof}

Now suppose there were \( r \) vertices in the convex hull. If we sum the first claim across all \( b \) on the hull, and the second across all \( b \) not on the hull (inside it), we get
\[
\sum_{1 \le i < j \le n} \frac{2}{d_{ij}} = \frac{1}{2} \sum_{b} \sum_{i \ne b} \frac{2}{d_{bi}} \le \frac{1}{2} \cdot \frac{n-1}{n-2} \left( (r-2)\pi + (n-r)\pi \right) = \frac{(n-1)\pi}{4}
\]
as needed (with \( (r-2)\pi \) being the sum of angles in the hull).",727,4
2001p1,"Consider an acute triangle $\triangle ABC$. Let $P$ be the foot of the altitude of triangle $\triangle ABC$ issuing from the vertex $A$, and let $O$ be the circumcenter of triangle $\triangle ABC$. Assume that $\angle C \geq \angle B+30^{\circ}$. Prove that $\angle A+\angle COP < 90^{\circ}$.","The conclusion rewrites as
\[
\angle COP < 90^\circ - \angle A = \angle OCP
\iff PC < PO
\iff PC^2 < PO^2
\iff PC^2 < R^2 - PB \cdot PC
\iff PC \cdot BC < R^2
\iff ab \cos C < R^2
\iff \sin A \sin B \cos C < \frac{1}{4}.
\]

Now
\[
\cos C \sin B = \frac{1}{2} (\sin(C + B) - \sin(C - B)) \le \frac{1}{2} \left(1 - \frac{1}{2} \right) = \frac{1}{4}
\]
which finishes when combined with \( \sin A < 1 \).
",88,1
2001p2,"Let $a,b,c$ be positive real numbers. Prove that $\frac{a}{\sqrt{a^{2}+8bc}}+\frac{b}{\sqrt{b^{2}+8ca}}+\frac{c}{\sqrt{c^{2}+8ab}}\ge 1$.","Firstly, $a^{2}+8bc=(a^{2}+2bc)+6bc \leq^{AG} (a^{2}+b^{2}+c^{2})+6bc=S+6bc$ (where $S=a^{2}+b^{2}+c^{2}$) and its cyclic variations. Next note that $(a,b,c)$ and $\left( \frac{1}{\sqrt{S+6bc}}, \frac{1}{\sqrt{S+6ca}}, \frac{1}{\sqrt{S+6ab}} \right)$ are similarly oriented sequences. Thus \[\sum_{cyc} \frac{a}{\sqrt{a^{2}+8bc}} \ge \sum_{cyc} \frac{a}{\sqrt{S+6bc}}\]\[\geq ^{Cheff} \frac{1}{3}(a+b+c)\left( \frac{1}{\sqrt{S+6bc}}+\frac{1}{\sqrt{S+6ca}}+\frac{1}{\sqrt{S+6ab}} \right)\]\[\geq^{AH}\frac{1}{3}(a+b+c) \left( \frac{9}{\sqrt{S+6bc}+\sqrt{S+6ca}+\sqrt{S+6ab}} \right)\]\[\geq^{QA} (a+b+c) \sqrt{\frac{3}{(S+6bc)+(S+6ca)+(S+6ab)}}\]\[=(a+b+c)\sqrt{\frac{3}{3(a+b+c)^{2}}}=1\] Hence the inequality has been established. Equality holds if $a=b=c$.",49,1
2001p3,"Twenty-one girls and twenty-one boys took part in a mathematical competition. It turned out that each contestant solved at most six problems, and for each pair of a girl and a boy, there was at least one problem that was solved by both the girl and the boy. Show that there is a problem that was solved by at least three girls and at least three boys.","For each girl, we know that there is a boy who solved a problem in common with her. Since a girl solves at most six problems, for a girl and her set of six problems there are at least 11 boys who solved a problem in common with the girl such that at least three boys solved that common problem. (This is a simple application of the pigeon hole principle where the problems solved by the girl are the holes and the boys are the pigeons, and the guy/pigeon enters a hole/problem which he solved in common with the girl).

The boys have solved a total of at most $21\times 6$ problems.We view this as a set with repeated elements i.e. if a problem is solved by more than one boy it appears as many times as the number of boys who have solved it. Let this set of problems be A. Clearly, A has size $21\times 6$.

We mark each problem in A which has been solved by at least three boys and a girl. And we mark it the number of times that is the same as the number of girls that has solved it. Since there are a total of $21\times 11$ marks (since there are at least 11 marks for each girl, by the discussion above), either a problem is marked at least thrice, in which case we're done since then it has been solved by at least three boys and three girls. Or each problem has been marked at most twice. In this case it is clear that more than $21\times 5$ problems in A have been marked since $21\times 5 \times 2<21\times 11$ (there are a total of $21\times 11$ marks. This means that there is a boy such that all six of his problems have been marked. But then by our discussion in the first paragraph we know there must a problem that this boy has solved which has been solved by at least three girls. Therefore it must be true that there is a problem such that it has been solved by at least three people of each gender.",357,3
2001p4,"\textbf{Let } n > 1 \text{ be an odd integer and let } c_1, c_2, \ldots, c_n \text{ be integers. For each permutation } a = (a_1, a_2, \ldots, a_n) \text{ of } \{1,2,\ldots,n\}, \text{ define } S(a) = \sum_{i=1}^{n} c_i a_i. \text{ Prove that there exist two permutations } a \ne b \text{ of } \{1,2,\ldots,n\} \text{ such that } n! \text{ is a divisor of } S(a) - S(b).","Assume for contradiction that all the \( S(a) \) are distinct modulo \( n! \). Then summing across all permutations gives
\[
1 + 2 + \cdots + n! = \sum_a S(a)
= \sum_a \sum_{i=1}^n c_i a_i
= \sum_{i=1}^n c_i \sum_a a_i
= \sum_{i=1}^n c_i \cdot ((n-1)! \cdot (1 + \cdots + n))
= (n-1)! \cdot \frac{n(n+1)}{2} \sum_{i=1}^n c_i
= n! \cdot \frac{n+1}{2} \sum_{i=1}^n c_i
\equiv 0 \pmod{n!}
\]
since \( \frac{1}{2}(n+1) \) is an integer. But on the other hand 
\[
1 + 2 + \cdots + n! = \frac{n!(n!+1)}{2}
\]
which is not divisible by \( n! \) if \( n > 1 \), as the quotient is the non-integer \( \frac{n!+1}{2} \). This is a contradiction.
",119,2
2001p6,$K > L > M > N$ are positive integers such that $KM + LN = (K + L - M + N)(-K + L + M + N)$. Prove that $KL + MN$ is not prime.,"First, $(KL+MN)-(KM+LN)=(K-N)(L-M)>0$ as $K>N$ and $L>M$. Thus, $KL+MN>KM+LN$.

Similarly, $(KM+LN)-(KN+LM)=(K-L)(M-N)>0$ since $K>L$ and $M>N$. Thus, $KM+LN>KN+LM$.

Putting the two together, we have \[KL+MN>KM+LN>KN+LM\]

Now, we have: \[(K+L-M+N)(-K+L+M+N)=KM+LN\]\[-K^2+KM+L^2+LN+KM-M^2+LN+N^2=KM+LN\]\[L^2+LN+N^2=K^2-KM+M^2\] So, we have: \[(KM+LN)(L^2+LN+N^2)=KM(L^2+LN+N^2)+LN(L^2+LN+N^2)\]\[=KM(L^2+LN+N^2)+LN(K^2-KM+M^2)\]\[=KML^2+KMN^2+K^2LN+LM^2N\]\[=(KL+MN)(KN+LM)\] Thus, it follows that \[(KM+LN) \mid (KL+MN)(KN+LM).\] Now, since $KL+MN>KM+LN$ if $KL+MN$ is prime, then there are no common factors between the two. So, in order to have \[(KM+LN)\mid (KL+MN)(KN+LM),\] we would have to have \[(KM+LN) \mid (KN+LM).\] This is impossible as $KM+LN>KN+LM$. Thus, $KL+MN$ must be composite.",79,1
2000p1,"Two circles $G_1$ and $G_2$ intersect at two points $M$ and $N$. Let $AB$ be the line tangent to these circles at $A$ and $B$, respectively, so that $M$ lies closer to $AB$ than $N$. Let $CD$ be the line parallel to $AB$ and passing through the point $M$, with $C$ on $G_1$ and $D$ on $G_2$. Lines $AC$ and $BD$ meet at $E$; lines $AN$ and $CD$ meet at $P$; lines $BN$ and $CD$ meet at $Q$. Show that $EP=EQ$.","$\textbf{Lemma:}$ Given a triangle, $ABC$ and a point $P$ in its interior, assume that the circumcircles of $\triangle{ACP}$ and    $\triangle{ABP}$ are tangent to $BC$. Prove that ray $AP$ bisects $BC$.
$\textbf{Proof:}$ Let the intersection of $AP$ and $BC$ be $D$. By power of a point, $BD^2=AD(PD)$ and $CD^2=AD(PD)$, so $BD=CD$.
$\textbf{Proof of problem:}$ Let ray $NM$ intersect $AB$ at $X$. By our lemma, $\textit{(the two circles are tangent to AB)}$, $X$ bisects $AB$. Since $\triangle{NAX}$ and $\triangle{NPM}$ are similar, and $\triangle{NBX}$ and $\triangle{NQM}$ are similar implies $M$ bisects $PQ$.

Now, $\angle{ABM} = \angle{BMD}$ since $CD$ is parallel to $AB$. But $AB$ is tangent to the circumcircle of $\triangle{BMD}$ hence $\angle{ABM} = \angle{BDM}$ and that implies $\angle{BMD} = \angle{BDM} .$So$\triangle{BMD}$ is isosceles and $BM=BD$.

By simple parallel line rules, $\angle{EBA}=\angle{BDM}=\angle{ABM}$. Similarly, $\angle{BAM}=\angle{EAB}$, so by $\textit{ASA}$ criterion, $\triangle{ABM}$ and $\triangle{ABE}$ are congruent.

We know that $BE=BM=BD$ so a circle with diameter $ED$ can be circumscribed around $\triangle{EMD}$. Join points $E$ and $M$, $EM$ is perpendicular on $PQ$, previously we proved $MP = MQ$, hence $\triangle{EPQ}$ is isoscles and $EP = EQ$ .",180,2
2000p2,"Let $a, b, c$ be positive real numbers with $abc=1$. Show that

\[\left( a-1+\frac{1}{b} \right)\left( b-1+\frac{1}{c} \right)\left( c-1+\frac{1}{a} \right) \le 1\]","Let \( a = x/y, \, b = y/z, \, c = z/x \) for \( x, y, z > 0 \). Then the inequality rewrites as
\[
(-x + y + z)(x - y + z)(x + y - z) \le xyz
\]
which when expanded is equivalent to Schurs inequality. Alternatively, if one wants to avoid appealing to Schur, then the following argument works:

\begin{itemize}
  \item At most one term on the left-hand side is negative; if that occurs we are done from \( xyz > 0 > (-x + y + z)(x - y + z)(x + y - z) \).
  
  \item If all terms in the left-hand side are nonnegative, let us denote \( m = -x + y + z \ge 0 \), \( n = x - y + z \ge 0 \), \( p = x + y - z \ge 0 \). Then it becomes
  \[
  mnp \le \frac{(m+n)(n+p)(p+m)}{8}
  \]
  which follows by AM-GM.
\end{itemize}",163,2
2000p6,"Let $\overline{AH_1}$, $\overline{BH_2}$, and $\overline{CH_3}$ be the altitudes of an acute triangle $ABC$. The incircle $\omega$ of triangle $ABC$ touches the sides $BC$, $CA$, and $AB$ at $T_1$, $T_2$, and $T_3$, respectively. Consider the reflections of the lines $H_1H_2$, $H_2H_3$, and $H_3H_1$ with respect to the lines $T_1T_2$, $T_2T_3$, and $T_3T_1$. Prove that these images form a triangle whose vertices line on $\omega$.","We use complex numbers with \( \omega \) the unit circle. Let \( T_1 = a, T_2 = b, T_3 = c \). The main content of the problem is to show that the triangle in question has vertices \( ab/c, bc/a, ca/b \) (which is evident from a good diagram).

\[
\text{Since } A = \frac{2bc}{b+c}, \text{ we have}
\]

\[
H_1 = \frac{1}{2} \left( \frac{2bc}{b+c} + a + a - a^2 \cdot \frac{2}{b+c} \right) = \frac{ab + bc + ca - a^2}{b + c}.
\]

The reflection of \( H_1 \) over \( \overline{T_1T_2} \) is

\[
H_1^C = a + b - ab \overline{H_1} = a + b - b \cdot \frac{ac + ab + a^2 - bc}{a(b + c)}
\]

\[
= \frac{a(a + b)(b + c) - b(a^2 + ab + ac - bc)}{a(b + c)} = \frac{c(a^2 + b^2)}{a(b + c)}.
\]

Now, we claim that \( H_1^C \) lies on the chord joining \( \frac{ca}{b} \) and \( \frac{cb}{a} \); by symmetry so will \( H_2^C \) and this will imply the problem (it means that the desired triangle has vertices \( ab/c, bc/a, ca/b \)). A cartoon of this is shown below.

To see this, it suffices to compute

\[
H_1^C + \left( \frac{ca}{b} \right)\left( \frac{cb}{a} \right) \overline{H_1^C}
= \frac{c(a^2 + b^2)}{a(b + c)} + c^2 \cdot \frac{1}{c} \cdot \frac{a^2 + b^2}{a^2 b^2} \cdot \frac{1}{a} \cdot \left( \frac{b + c}{bc} \right)
\]

\[
= \frac{c(a^2 + b^2)}{a(b + c)} + \frac{c(a^2 + b^2)}{abc^{-1}(b + c)}
\]

\[
= \frac{c(a^2 + b^2)}{a(b + c)} \left( \frac{b + c}{b} \right)
= \frac{c(a^2 + b^2)}{ab} = \frac{ca}{b} + \frac{cb}{a}
\]

as desired.",277,3
1999p5,"Two circles $G_{1}$ and $G_{2}$ are contained inside the circle $G$, and are tangent to $G$ at the distinct points $M$ and $N$, respectively. $G_{1}$ passes through the center of $G_{2}$. The line passing through the two points of intersection of $G_{1}$ and $G_{2}$ meets $G$ at $A$ and $B$. The lines $MA$ and $MB$ meet $G_{1}$ at $C$ and $D$, respectively.

Prove that $CD$ is tangent to $G_{2}$.","Two circles \( G_1 \) and \( G_2 \) are contained inside the circle \( G \), and are tangent to \( G \) at the distinct points \( M \) and \( N \), respectively. \( G_1 \) passes through the center of \( G_2 \). The line passing through the two points of intersection of \( G_1 \) and \( G_2 \) meets \( G \) at \( A \) and \( B \). The lines \( MA \) and \( MB \) meet \( G_1 \) at \( C \) and \( D \), respectively.

Prove that \( CD \) is tangent to \( G_2 \).

Let \( P \) and \( Q \) be the centers of \( G_1 \) and \( G_2 \). Let line \( MQ \) meet \( G_1 \) again at \( W \), the homothetic image of \( Q \) under \( G_1 \to G \). Meanwhile, let \( T \) be the intersection of segment \( PQ \) with \( G_2 \), and let \( L \) be its homothetic image on \( G \). Since \( PTQ \perp AB \), it follows \( LW \) is a diameter of \( G \). Let \( O \) be its center.

\textbf{Claim } \( MNTQ \) is cyclic.

\textit{Proof.} By Reim: 
\[
\angle TQM = \angle LWM = \angle LNM = \angle TNM.
\]
\hfill\qedsymbol

Let \( E \) be the midpoint of \( AB \).

\textbf{Claim } \( OEMN \) is cyclic.

\textit{Proof.} By radical axis, the lines \( MM, NN, AEB \) meet at a point \( R \). Then \( OEMN \) lies on the circle with diameter \( OR \).
\hfill\qedsymbol

\textbf{Claim } \( MTE \) are collinear.

\textit{Proof.} 
\[
\angle NMT = \angle TQN = \angle LON = \angle NOE = \angle NME.
\]
\hfill\qedsymbol

Now consider the homothety mapping \( \triangle WAB \) to \( \triangle QCD \). It should map \( E \) to a point on line \( ME \) which is also on the line through \( Q \) perpendicular to \( AB \); that is, to point \( T \). Hence \( TCD \) are collinear, and its immediate that \( T \) is the desired tangency point.
",377,3
1998p1,"In the convex quadrilateral $ABCD$, the diagonals $AC$ and $BD$ are perpendicular and the opposite sides $AB$ and $DC$ are not parallel. Suppose that the point $P$, where the perpendicular bisectors of $AB$ and $DC$ meet, is inside $ABCD$. Prove that $ABCD$ is a cyclic quadrilateral if and only if the triangles $ABP$ and $CDP$ have equal areas.","If \(ABCD\) is cyclic, then \(P\) is the circumcenter, and \(\angle APB + \angle PCD = 180^\circ\). The hard part is the converse.

Let \(M\) and \(N\) be the midpoints of \(\overline{AB}\) and \(\overline{CD}\).

\textbf{Claim } Unconditionally, we have \(\angle NEM = \angle MPN\).

\textit{Proof.} Note that \(\overline{EN}\) is the median of right triangle \(\triangle ECD\), and similarly for \(\overline{EM}\). Hence \(\angle NED = \angle EDN = \angle BDC\), while \(\angle AEM = \angle ACB\). Since \(\angle DEA = 90^\circ\), by looking at quadrilateral \(XDEA\) where \(X = \overline{CD} \cap \overline{AB}\), we derive that \(\angle NED + \angle AEM + \angle DXA = 90^\circ\), so
\[
\angle NEM = \angle NED + \angle AEM + 90^\circ = -\angle DXA = -\angle NXM = -\angle NPM
\]
as needed. \(\square\)

However, the area condition in the problem tells us
\[
\frac{EN}{EM} = \frac{CN}{CM} = \frac{PM}{PN}.
\]

Finally, we have \(\angle MEN > 90^\circ\) from the configuration. These properties uniquely determine the point \(E\): it is the reflection of \(P\) across the midpoint of \(\overline{MN}\).

So \(EMPN\) is a parallelogram, and thus \(\overline{ME} \perp \overline{CD}\). This implies \(\angle BAE = \angle CEM = \angle EDC\), giving \(ABCD\) cyclic.
",196,2
1998p2,"In a competition, there are $a$ contestants and $b$ judges, where $b\ge3$ is an odd integer. Each judge rates each contestant as either pass?or fail? Suppose $k$ is a number such that, for any two judges, their ratings coincide for at most $k$ contestants. Prove that $\frac{k}{a}\ge\frac{b-1}{2b}$.","Let $c_i$ stand for the number of judges who pass the $i$th candidate. The number of pairs of judges who agree on the $i$th contestant is then given by
\[
\binom{c_i}{2} + \binom{b - c_i}{2}
= \frac{1}{2} \left( c_i(c_i - 1) + (b - c_i)(b - c_i - 1) \right) \\
= \frac{1}{2} \left( c_i^2 + (b - c_i)^2 - b \right) \\
\ge \frac{1}{2} \left( \frac{b^2}{2} - b \right) \\
= \frac{b^2 - 2b}{4}
\]
where the inequality follows from AM-QM. Since $b$ is odd, $b^2 - 2b$ is not divisible by $4$ and we can strengthen the inequality to

\[{c_i \choose 2} + {{b - c_i} \choose 2} \geq \frac{b^2 - 2b + 1}{4} = \left(\frac{b - 1}{2}\right)^2.\]

Letting $N$ stand for the number of instances where two judges agreed on a candidate, it follows that

\[N = \sum_{i = 1}^a {c_i \choose 2} + {{b - c_i} \choose 2} \geq a \cdot \left( \frac{b - 1}{2} \right)^2.\]

The given condition on $k$ implies that

\[N \leq k \cdot {b \choose 2} = \frac{kb(b - 1)}{2}.\]

Therefore

\[a \cdot \left( \frac{b - 1}{2} \right)^2 \leq \frac{kb(b - 1)}{2},\]

which simplifies to

\[\frac{k}{a} \geq \frac{b - 1}{2b}.\]

",198,2
1997p2,"The angle at $A$ is the smallest angle of triangle $ABC$. The points $B$ and $C$ divide the circumcircle of the triangle into two arcs. Let $U$ be an interior point of the arc between $B$ and $C$ which does not contain $A$. The perpendicular bisectors of $AB$ and $AC$ meet the line $AU$ and $V$ and $W$, respectively. The lines $BV$ and $CW$ meet at $T$. Show that.

$AU=TB+TC$","Let $\overline{BTV}$ meet the circle again at $U_1$, so that $AU_1UB$ is an isosceles trapezoid. Define $U_2$ similarly.

Now from the isosceles trapezoids we get
\[
AU = BU_1 = BT + TU_1 = BT + TC
\]
as desired.
",40,1
1997p3,"Let $x_{1}$, $x_{2}$,...,$x_{n}$ be real numbers satisfying the conditions

$|x_{1}+x_{2}+...+x_{n}|=1$

and

$|x_{i}| \le \frac{n+1}{2}$, for $i=1,2,...,n$

Show that there exists a permutation $y_{1}$, $y_{2}$,...,$y_{n}$ of $x_{1}$, $x_{2}$,...,$x_{n}$ such that

$|y_{1}+2y_{2}+...+ny_{n}|\le \frac{n+1}{2}$","WLOG $\sum x_i = 1$ (by negating $x_i$) and $x_1 \le x_2 \le \cdots \le x_n$. Notice that
\begin{itemize}
  \item The largest possible value of the sum in question is
  \[
  A = x_1 + 2x_2 + 3x_3 + \cdots + nx_n,
  \]
  while the smallest value is
  \[
  B = nx_1 + (n - 1)x_2 + \cdots + x_n.
  \]
  \item Meanwhile, the \textit{average} value across all permutations is
  \[
  1 \cdot \frac{1}{n} + 2 \cdot \frac{1}{n} + \cdots + n \cdot \frac{1}{n}
  = \frac{n+1}{2}.
  \]
\end{itemize}

Now imagine we transform the sum $A$ to the sum $B$, one step at a time, by swapping adjacent elements. Every time we do a swap of two neighboring $u \le v$, the sum decreases by
\[
(iu + (i+1)v) - (iv + (i+1)u) = v - u \le n + 1.
\]

We want to prove we land in the interval
\[
I = \left[ \frac{n+1}{2}, \frac{n+1}{2} \right]
\]
at some point during this transformation. But since $B \le \frac{n+1}{2} \le A$ (since $\frac{n+1}{2}$ was the average) and our step sizes were at most the length of the interval $I$, this is clear.
",192,2
1997p6,"For each positive integer $n$, let $f(n)$ denote the number of ways of representing $n$ as a sum of powers of $2$ with nonnegative integer exponents. Representations which differ only in the ordering of their summands are considered to be the same. For instance, $f(4)=4$, because the number 4 can be represented in the following four ways:

$4;2+2;2+1+1;1+1+1+1$

Prove that, for any integer $n \ge 3$,

$2^{n^{2}/4}<f(2^{n})<2^{n^{2}/2}$.","It's clear that $f$ is non-decreasing. By sorting by the number of $1$s we used, we have the equation
\[
f(N) = f\left( \left\lfloor \frac{N}{2} \right\rfloor \right) + f\left( \left\lfloor \frac{N}{2} \right\rfloor - 1 \right) + f\left( \left\lfloor \frac{N}{2} \right\rfloor - 2 \right) + \cdots + f(1) + f(0). \tag{$\star$}
\]

Upper bound. We now prove the upper bound by induction. Indeed, the base case is trivial and for the inductive step we simply use ($\star$):
\[
f(2^n) = f(2^{n-1}) + f(2^{n-1}-1) + \cdots < 2^{n-1}f(2^{n-1}) < 2^{n-1} \cdot 2^{\frac{(n-1)^2}{2}} = 2^{\frac{n^2}{2} - \frac{1}{2}}.
\]

Lower bound. First, we contend that $f$ is convex. We'll first prove this in the even case to save ourselves some annoyance:

\[
\textbf{Claim (}f \text{ is basically convex)} \quad \text{If } 2 \mid a + b \text{ then we have } f(2a) + f(2b) \ge 2f(a + b).
\]

\textit{Proof.} Since $f(2k + 1) = f(2k)$, we will only prove the first equation. Assume WLOG $a \ge b$ and use ($\star$) on all three $f$ expressions here; after subtracting repeated terms, the inequality then rewrites as
\[
\sum_{\frac{(a + b)}{2} \le x \le a} f(x) \ge \sum_{b \le x \le \frac{(a + b)}{2}} f(x).
\]
This is true since there are an equal number of terms on each side and $f$ is nondecreasing. \qed

\textbf{Claim } For each $1 \le k < 2^{n-1}$, we have
\[
f(2^{n-1} - k) + f(k + 1) \ge 2f(2^{n-2})
\]

\textit{Proof.} Use the fact that $f(2t + 1) = f(2t)$ for all $t$ and then apply convexity as above. \qed

Now we can carry out the induction:
\[
f(2^n) = f(2^{n-1}) + f(2^{n-1} - 1) + \cdots > 2^{n - 1}f(2^{n - 2}) + f(0) > 2^{n - 1}2^{\frac{(n - 2)^2}{4}} = 2^{\frac{n^2}{4}}.
\]
",296,3
1996p2,"Let $P$ be a point inside triangle $ABC$ such that

\[\angle APB-\angle ACB = \angle APC-\angle ABC\]

Let $D$, $E$ be the incenters of triangles $APB$, $APC$, respectively. Show that $AP$, $BD$, $CE$ meet at a point.","let $CF$, $BG$ be the angle bisectors of $\angle ABP$ and $\angle ACP$, respectively. Notice that they coincide with line $BD$ and $CE$. Therefore, it suffices to show $CF,BG,AP$ are concurrent. Let $CF \cap AP = X_{1}$, and $BG\cap AP = X_{2}$. Notice that by angle bisector theorem, we have\[\frac{AX_{1}}{PX_{1}}=\frac{AC}{PC},\; \frac{AX_{2}}{PX_{2}}=\frac{AB}{PB}\]

Therefore, it suffices to show\[\frac{AC}{PC} =\frac{AB}{PB}\]

Now, construct $\triangle AQC \sim \triangle APB$. Connect $PQ$. We notice that $\angle BAC = \angle PAQ$, $\frac{AB}{AP}=\frac{AC}{AQ}$. Therefore $\triangle ABC \sim \triangle APQ$. 

Therefore, we have\begin{align*} \angle PQC &= \angle AQC -\angle AQP \\ &=\angle APB-\angle ACB \\ &=\angle APC-\angle ABC \\ &=\angle QPC \end{align*}Therefore,\[CP=CQ=\frac{AC}{AB} \cdot BP \Longrightarrow \frac{AC}{PC} =\frac{AB}{PB} \quad  \blacksquare\]



",110,2
1996p5,"Let $ABCDEF$ be a convex hexagon such that $AB$ is parallel to $DE$, $BD$ is parallel to $EF$, and $CD$ is parallel to $FA$. Let $R_{A}$, $R_{C}$, $R_{E}$ denote the circumradii of triangles $FAB$, $BCD$, $DEF$, respectively, and let $P$ denote the perimeter of the hexagon. Prove that

$R_{A}+R_{C}+R_{E} \ge \frac{P}{2}$","Let $s_{1}=\left| AB \right|,\;s_{2}=\left| BC \right|,\;s_{3}=\left| CD \right|,\;s_{4}=\left| DE \right|,\;s_{5}=\left| EF \right|,\;s_{6}=\left| FA \right|$

Let $d_{1}=\left| FB \right|,\;d_{2}=\left| BD \right|,\;d_{1}=\left| DF \right|$

Let $\alpha_{1}=\angle FAB,\;\alpha_{2}=\angle ABC,\;\alpha_{3}=\angle BCD,\;\alpha_{4}=\angle CDE,\;\alpha_{5}=\angle DEF,\;\alpha_{6}=\angle EFA\;$

From the parallel lines on the hexagon we get:

$\alpha_{1}=\alpha_{4},\;\alpha_{2}=\alpha_{5},\;\alpha_{3}=\alpha_{6}$ [Equations 1]

So now we look at $\Delta FAB$. We construct a perpendicular from $A$ to $FE$ and a perpendicular from $A$ to $BC$.

We find out the length of these two perpendiculars and add them to get the distance between parallel lines $FE$ and $BC$ and because of the triangle inequality the distance $\left| FB \right|$ is greater or equal to tha the distance between parallel lines $FE$ and $BC$:

This provides the following inequality:

$d_{1} \ge s_{6}sin(\alpha{6})+s_{1}sin(\alpha{2})$

Using the [Equations 1] we simplify to:

$d_{1} \ge s_{6}sin(\alpha{3})+s_{1}sin(\alpha{2})$ [Equation 2]

We now construct a perpendicular from $D$ to $FE$ and a perpendicular from $D$ to $BC$. Then we find out the length of these two perpendiculars and add them to get the distance between parallel lines $FE$ and $BC$ and get:

$d_{1} \ge s_{3}sin(\alpha{3})+s_{4}sin(\alpha{5})$

Using the [Equations 1] we simplify to:

$d_{1} \ge s_{3}sin(\alpha{3})+s_{4}sin(\alpha{2})$ [Equation 3]

We now add [Equation 2] and [Equation 3] to get:

$2d_{1} \ge (s_{3}+s_{6})sin(\alpha_{3})+(s_{1}+s_{4})sin(\alpha_{2})$ [Equation 4]

We now use the Extended law of sines on $\Delta FAB$ with $R_{A}$ to get:

$\frac{d_{1}}{sin(\alpha_{1})}=2R_{A}$

$d_{1}=2R_{A}sin(\alpha_{1})$ [Equation 5]

Substitute [Equation 5] into [Equation 4]:

$4R_{A}sin(\alpha_{1}) \ge (s_{3}+s_{6})sin(\alpha_{3})+(s_{1}+s_{4})sin(\alpha_{2})$

$4R_{A} \ge (s_{3}+s_{6})\frac{sin(\alpha_{3})}{sin(\alpha_{1})}+(s_{1}+s_{4})\frac{sin(\alpha_{2})}{sin(\alpha_{1})}$ [Equation 6]

To find the equivalent inequality for $4R_{C}$ and $4R_{E}$ we just need shift the indexes by two. That is to add $2$ to each of the indexes of $s_{i}$ and $\alpha_{i}$ and adjust the indexes so that for $s$ the indexes are 1 through 6, and for $\alpha$ the indexes are 1 through 3.

$4R_{C} \ge (s_{2}+s_{5})\frac{sin(\alpha_{2})}{sin(\alpha_{3})}+(s_{3}+s_{6})\frac{sin(\alpha_{1})}{sin(\alpha_{3})}$ [Equation 7]

$4R_{E} \ge (s_{1}+s_{4})\frac{sin(\alpha_{1})}{sin(\alpha_{2})}+(s_{2}+s_{5})\frac{sin(\alpha_{3})}{sin(\alpha_{2})}$ [Equation 8]

Adding [Equation 6], [Equation 7], and [Equation 8] we get:

$4\left( R_{A}+R_{C}+R_{E} \right) \ge (s_{1}+s_{4})\left( \frac{sin(\alpha_{2})}{sin(\alpha_{1})}+ \frac{sin(\alpha_{1})}{sin(\alpha_{2})}\right)+(s_{2}+s_{5})\left( \frac{sin(\alpha_{2})}{sin(\alpha_{3})}+ \frac{sin(\alpha_{3})}{sin(\alpha_{2})}\right)+(s_{3}+s_{6})\left( \frac{sin(\alpha_{3})}{sin(\alpha_{1})}+ \frac{sin(\alpha_{1})}{sin(\alpha_{3})}\right)$

From AM-GM inequality we get:

$x+\frac{1}{x} \ge 2\;$ Therefore, $\left( \frac{sin(\alpha_{a})}{sin(\alpha_{b})}+ \frac{sin(\alpha_{b})}{sin(\alpha_{a})}\right) \ge 2\;$ for any index $a$ and $b$

Therefore,

$4\left( R_{A}+R_{C}+R_{E} \right) \ge 2(s_{1}+s_{4})+2(s_{2}+s_{5})+2(s_{3}+s_{6})$

$4\left( R_{A}+R_{C}+R_{E} \right) \ge 2\sum_{i=1}^{6}s_{i}$

$R_{A}+R_{C}+R_{E} \ge \frac{1}{2}\sum_{i=1}^{6}s_{i}$

Since $P=\sum_{i=1}^{6}s_{i}$, then $R_{A}+R_{C}+R_{E} \ge \frac{P}{2}$",360,3
1995p1,"Let $A,B,C,D$ be four distinct points on a line, in that order. The circles with diameters $AC$ and $BD$ intersect at $X$ and $Y$. The line $XY$ meets $BC$ at $Z$. Let $P$ be a point on the line $XY$ other than $Z$. The line $CP$ intersects the circle with diameter $AC$ at $C$ and $M$, and the line $BP$ intersects the circle with diameter $BD$ at $B$ and $N$. Prove that the lines $AM,DN,XY$ are concurrent.","Since $M$ is on the circle with diameter $AC$, we have $\angle AMC=90$ and so $\angle MCA=90-A$. We similarly find that $\angle BND=90$. Also, notice that the line $XY$ is the radical axis of the two circles with diameters $AC$ and $BD$. Thus, since $P$ is on $XY$, we have $PN\cdot PB=PM\cdot PC$ and so by the converse of Power of a Point, the quadrilateral $MNBC$ is cyclic. Thus, $90-A=\angle MCA=\angle BNM$. Thus, $\angle MND=180-A$ and so quadrilateral $AMND$ is cyclic. Let the name of the circle $AMND$ be $O$ . Then, the radical axis of $O$ and the circle with diameter $AC$ is line $AM$. Also, the radical axis of $O$ and the circle with diameter $BD$ is line $DN$. Since the pairwise radical axes of 3 circles are concurrent, we have $AM,DN,XY$ are concurrent as desired.",138,2
1995p2,"Let $a, b, c$ be positive real numbers such that $abc = 1$. Prove that\[\frac{1}{a^3(b+c)} + \frac{1}{b^3(c+a)} + \frac{1}{c^3(a+b)} \geq \frac{3}{2}.\]

","We make the substitution $x= 1/a$, $y=1/b$, $z=1/c$. Then\begin{align*} \frac{1}{a^3(b+c)} + \frac{1}{b^3(c+a)} + \frac{1}{c^3(a+b)} &= \frac{x^3}{xyz(1/y+1/z)} + \frac{y^3}{xyz(1/z+1/x)} + \frac{z^3}{xyz(1/x+1/z)} \\ &= \frac{x^2}{y+z} + \frac{y^2}{z+x} + \frac{z^2}{x+y} . \end{align*}Since $(x^2,y^2,z^2)$ and $\bigl( 1/(y+z), 1/(z+x), 1/(x+y) \bigr)$ are similarly sorted sequences, it follows from the Rearrangement Inequality that\[\frac{x^2}{y+z} + \frac{y^2}{z+x} + \frac{z^2}{x+y} \ge \frac{1}{2} \left( \frac{y^2+z^2}{y+z} + \frac{z^2+x^2}{z+x} + \frac{x^2+y^2}{x+y} \right) .\]By the Power Mean Inequality,\[\frac{y^2+z^2}{y+z} \ge \frac{(y+z)^2}{2(x+y)} = \frac{x+y}{2} .\]Symmetric application of this argument yields\[\frac{1}{2}\left( \frac{y^2+z^2}{y+z} + \frac{z^2+x^2}{z+x} + \frac{x^2+y^2}{x+y} \right) \ge \frac{1}{2}(x+y+z) .\]Finally, AM-GM gives us\[\frac{1}{2}(x+y+z) \ge \frac{3}{2}xyz = \frac{3}{2},\] as desired.",93,1
1995p5,"Let $ABCDEF$ be a convex hexagon with $AB=BC=CD$ and $DE=EF=FA$, such that $\angle BCD=\angle EFA=\frac{\pi}{3}$. Suppose $G$ and $H$ are points in the interior of the hexagon such that $\angle AGB=\angle DHE=\frac{2\pi}{3}$. Prove that $AG+GB+GH+DH+HE\ge CF$.","Draw $AE$ and $BD$ to make equilateral $\triangle EFA$ and $\triangle BCD$, and draw points $I$ and $J$ such that $IA=IB$, $JD=JE$, directed angle $\measuredangle IAB=-\measuredangle CDB$, and directed angle $\measuredangle JDE=-\measuredangle FAE$ to make equilateral $\triangle AIB$ and $\triangle DJE$. Notice that $G$ is on the circumcircle of $\triangle AIB$ and $H$ is on the circumcircle of $\triangle DJE$. By Ptolemy, $GA+GB=GI$ and $HD+HE=HJ$. So,\[AG+GB+GH+DH+HE=IG+GH+HJ.\]Notice that octagon $AIBCDJEF$ is symmetric about $\overline{BE}$. So, $IG+GH+HJ\ge IJ=CF$",76,1
1994p1,"Let $m$ and $n$ be two positive integers. Let $a_1$, $a_2$, $\ldots$, $a_m$ be $m$ different numbers from the set $\{1, 2,\ldots, n\}$ such that for any two indices $i$ and $j$ with $1\leq i \leq j \leq m$ and $a_i + a_j \leq n$, there exists an index $k$ such that $a_i + a_j = a_k$. Show that\[\frac{a_1+a_2+...+a_m}{m} \ge \frac{n+1}{2}\]","Let $a_1, a_2, \dots a_m$ satisfy the given conditions. We will prove that for all $j, 1 \le j \le m,$

\[a_j+a_{m-j+1} \ge n+1\]

WLOG, let $a_1 < a_2 < \dots < a_m$. Assume that for some $j, 1 \le j \le m,$

\[a_j + a_{m-j+1} \le n\]

This implies, for each $i, 1 \le i \le j,$\[a_i + a_{m-j+1} \le n\]because $a_i \le a_j$

For each of these values of i, we must have $a_i + a_{m-j+1} = a_{k_i}$ such that $a_{k_i}$ is a member of the sequence for each $i$. Because $a_i > 0, a_{k_i} > a_{m-j+1}$. Combining all of our conditions we have that each of $k_i$ must be distinct integers such that\[m-j+1 < k_i \le m\]

However, there are $j$ distinct $k_i$, but only $j-1$ integers satisfying the above inequality, so we have a contradiction. Our assumption that $a_j + a_{m-j+1} \le n$ was false, so $a_j + a_{m-j+1} \ge n+1$ for all $j$ such that $1 \le j \le m$ Summing these inequalities together for $1 \le j \le m$ gives\[2(a_1+a_2+ \dots a_m) \ge m(n+1)\]which rearranges to\[\frac{a_1+a_2+ \dots a_m}{m} \ge \frac{n+1}{2}\]

",186,2
1994p2,"Let $ABC$ be an isosceles triangle with $AB = AC$. $M$ is the midpoint of $BC$ and $O$ is the point on the line $AM$ such that $OB$ is perpendicular to $AB$. $Q$ is an arbitrary point on $BC$ different from $B$ and $C$. $E$ lies on the line $AB$ and $F$ lies on the line $AC$ such that $E, Q, F$ are distinct and collinear. Prove that $OQ$ is perpendicular to $EF$ if and only if $QE = QF$.","Assume $OQ$ is perpendicular to $EF$. Then $\angle EBO = \angle EQO = 90^\circ$, so $EBOQ$ is cyclic. Hence $\angle OEQ = \angle OBQ$. Also $\angle OQF = \angle OCF = 90^\circ$, so $OQCF$ is cyclic. Hence $\angle OFQ = \angle OCQ$. But $\angle OCQ = \angle OBQ$ since $\triangle ABC$ is isosceles. Hence $\angle OEQ = \angle OFQ$, so $OE = OF$, so triangles $OEQ$ and $OFQ$ are congruent and $QE = QF$.

Assume $QE = QF$. If $OQ$ is not perpendicular to $EF$, then take $E'F'$ through $Q$ perpendicular to $OQ$ with $E'$ on $AB$ and $F'$ on $AC$. Then $QE' = QF'$, so triangles $QEE'$ and $QFF'$ are congruent. Hence $\angle QEE' = \angle QFF'$. So $CA$ and $AB$ make the same angles with $EF$ and hence are parallel. Contradiction. So $OQ$ is perpendicular to $EF$.
",139,2
1994p6,Show that there exists a set $A$ of positive integers with the following property: For any infinite set $S$ of primes there exist two positive integers $m \in A$ and $n \not\in A$ each of which is a product of $k$ distinct elements of $S$ for some $k \ge 2$.,"Let the primes be $p_1 < p_2 < p_3 < \dots$. Let $A$ consist of all products of $n$ distinct primes such that the smallest is greater than $p_n$. For example: all primes except $2$ are in $A$; $21$ is not in $A$ because it is a product of two distinct primes and the smallest is greater than $3$. Now let $S = \{p_{i_1}, p_{i_2}, \dots\}$ be any infinite set of primes. Assume that $p_{i_1} < p_{i_2} < \dots$. Let $n = i_1$. Then $p_{i_1}p_{i_2} \dots p_{i_n}$ is not in $A$ because it is a product of $n$ distinct primes, but the smallest is not greater than $p_n$. But $p_{i_2}p_{i_3} \dots p_{i_{n+1}}$ is in $A$, because it is a product of $n$ distinct primes and the smallest is greater than $p_n$. But both numbers are products of $n$ distinct elements of $S$.
",142,2
1993p1,"Let $f\left(x\right)=x^n+5x^{n-1}+3$, where $n>1$ is an integer. Prove that $f\left(x\right)$ cannot be expressed as the product of two non-constant polynomials with integer coefficients.","For the sake of contradiction, assume that $f\left(x\right)=g\left(x\right)h\left(x\right)$ for polynomials $g\left(x\right)$ and $h\left(x\right)$ in $\mathbb{R}$. Furthermore, let $g\left(x\right)=b_mx^m+b_{m-1}x^{m-1}+\ldots+b_1x+b_0$ with $b_i=0$ if $i>m$ and $h\left(x\right)=c_{n-m}x^{n-m}+c_{n-m-1}x^{n-m-1}+\ldots+c_1x+c_0$ with $c_i=0$ if $i>n-m$. This gives that $f\left(x\right)=\sum_{i=0}^{n}\left(\sum_{j=0}^{i}b_jc_{i-j}\right)x^i$.

We have that $3=b_0c_0$, or $3|b_0c_0$. WLOG, let $3|b_0$ (and thus $3\not|c_0$). Since $b_0c_1+b_1c_0=0$ and $3$ divides $b_0$ but not $c_0$, we need that $3|b_1$. We can keep on going up the chain until we get that $3|b_{n-2}$. Then, by equating coefficients once more, we get that $b_0c_{n-1}+b_1c_{n-2}+\ldots+b_{n-2}c_1+b_{n-1}c_0=5$. Taking the equation $\pmod3$ gives that $b_{n-1}c_0\equiv2\pmod3$. This implies that $b_{n-1}\neq0$. Thus, the degree of $g\left(x\right)$ is at least $n-1$. However, because $h\left(x\right)$ is a non-constant factor of $f\left(x\right)$, we have that the degree of $g\left(x\right)$ is at most $n-1$. Thus, the degree of $g\left(x\right)$ is $n-1$, implying that the degree of $h\left(x\right)$ is $1$.

From this fact, we have that there must exist an integer root of $f\left(x\right)$. However, when $x$ is an integer, $x^n + 5x^{n - 1} \equiv x^{n - 2}x(x + 1) \equiv 0 \pmod{2}$, meaning $f(x)$ is odd, so $x$ cannot be a root of $f$.

Hence, $f\left(x\right)$ cannot be expressed as $g\left(x\right)h\left(x\right)$ for polynomials $g\left(x\right)$ and $h\left(x\right)$ in $\mathbb{R}$. This means that $f\left(x\right)$ cannot be expressed as the product of two non-constant polynomials with integer coefficients.",212,2
1993p4,"For three points $A,B,C$ in the plane, we define $m(ABC)$ to be the smallest length of the three heights of the triangle $ABC$, where in the case $A$, $B$, $C$ are collinear, we set $m(ABC) = 0$. Let $A$, $B$, $C$ be given points in the plane. Prove that for any point $X$ in the plane,

$m(ABC) \leq m(ABX) + m(AXC) + m(XBC)$.","First we prove the claim for all points $X$ within or on the triangle $ABC$: In this specific case, suppose without loss of generality that $a\ge b\ge c$. Then the length of the smallest height of $ABC$ is that of the height from vertex $A$. This has a value of $\frac{2[ABC]}{a}$. Similarly, for triangles $ABX,BCX,CAX$ we have that the length of the smallest height is twice the area of the respective triangle divided by the longest side of that triangle. It is clear that since $a$ is the longest side of $ABC$, no two points within $ABC$ have distance exceeding $a$. Thus, since $X$ is within $ABC$, the longest side of any of the triangles $ABX,BCX,CAX$ does not exceed $a$. So, we have

$m(ABX)+m(BCX)+m(CAX)\ge\frac{2[ABX]}{a}+\frac{2[BCX]}{a}+\frac{2[CAX]}{a}$

$=\frac{2[ABC]}{a}=m(ABC)$

as desired.

Now on to prove the assertion for $X$ outside the triangle $ABC$. We shall assume without loss of generality that out of the points $A,B,C$ point $A$ is that farthest from $X$.

If $ABCX$ is concave or a degenerate quadrilateral, assume without loss of generality that $B$ inside or on triangle $ACX$. We shall prove that $m(ACX)\ge m(ABC)$ to prove the main claim. If the shortest height of $ACX$ was from vertex $A$ then it is clear that the height of $ABC$ from $A$ is smaller than that since ray $CB$ is closer to $A$ than ray $CX$. The case of the height from $C$ being the smallest of triangle $ACX$ is analogous, so we move on to the case of the height from $X$ is the smallest. If this is the case, then it is clear that the height of $ABC$ from $B$ is smaller than $m(ABC)$ since $\angle XAC\ge \angle BAC$. Thus the claim is proved.

If, instead, $ABCX$ is convex, we can assign the letter $D$ to represent to point of intersection of $AX$ and $BC$. Before proving the main claim, we shall prove that for triangle $ABX$ we have $m(ABX)\ge m(ABD)$. We prove this by considering each of the vertices that the shortest height of $ABX$ is on. If the shortest height is that from $X$, then it is obvious that the height from $D$ to side $AB$ is smaller than that from $X$ since $D$ is closer to $A$ than $X$ is and so $m(ABX)\ge m(ABD)$. If the shortest height of $ABX$ was from $B$, then since the height from $B$ to $XD$ is equal to the height from $B$ to $AD$, we have $m(ABX)\ge m(ABD)$. If instead the shortest height of $ABX$ was from $A$, the it is clear that $\angle B<90$. Thus, the projection of $A$ onto $BD$ is on the same side of $B$ as $C$. Now it is obvious that the height of $ABD$ from $A$ is smaller than that of $ABX$ from $A$ since the ray $BD$ is closer to $A$ than the ray $BX$. Thus, we have $m(ABX)\ge m(ABD)$ in all cases. Notice that the case for triangle $ACX$ is analogous. Therefore, we have $m(ABX)+m(ACX)\ge m(ABD)+m(ACD)$. But, this is the case of $D$ on the triangle $ABC$, and this case was shown in the first part of this proof.

So, we have that $m(ABC) \leq m(ABX) + m(AXC) + m(XBC)$ is true in all cases, as desired.",535,4
1992p5,"Let $S$ be a finite set of points in three-dimensional space. Let $S_x$, $S_y$, $S_z$ be the sets consisting of the orthogonal projections of the points of $S$ onto the $yz$-plane, $zx$-plane, $xy$-plane respectively. Prove that:
\[
|S|^2 \leq |S_x| \cdot |S_y| \cdot |S_z|,
\]
where $|A|$ denotes the number of points in the set $A$.

\textit{[The orthogonal projection of a point onto a plane is the foot of the perpendicular from the point to the plane.]}
","Induction on the number of different $z$-coordinates in $S$.

For 1, it is sufficient to note that $S = S_z$ and $|S| \leq |S_x| |S_y|$ (at most $|S_x|$ points of $S$ project onto each of the points of $S_y$).

In the general case, take a horizontal (constant $z$) plane dividing $S$ into two non-empty parts $T$ and $U$. Clearly, $|S| = |T| + |U|$, $|S_x| = |T_x| + |U_x|$, and $|S_y| = |T_y| + |U_y|$.

By induction,
\[
|S| = |T| + |U| \leq \left( |T_x| |T_y| |T_z| \right)^{1/2} + \left( |U_x| |U_y| |U_z| \right)^{1/2}.
\]
But $|T_z|, |U_z| \leq |S_z|$, and for any positive $a, b, c, d$ we have
\[
\sqrt{ab} + \sqrt{cd} \leq \sqrt{(a+c)(b+d)} \quad \text{(Cauchy-Schwarz)}.
\]

Hence,
\[
|S| \leq |S_z|^{1/2} \left( (|T_x| + |U_x|)(|T_y| + |U_y|) \right)^{1/2} = \left( |S_x| |S_y| |S_z| \right)^{1/2}.
\]
",139,2
1991p1,"Given a triangle $ABC$ let $I$ be the center of its inscribed circle. The internal bisectors of the angles $A,B,C$ meet the opposite sides in $A^\prime,B^\prime,C^\prime$ respectively. Prove that

$\frac {1}{4} < \frac {AI\cdot BI\cdot CI}{AA^{\prime }\cdot BB^{\prime }\cdot CC^{\prime }} \leq \frac {8}{27}$","We have $\prod\frac{AI}{AA^\prime}=\prod\frac{1}{1+\frac{IA^\prime}{IA}}$. From Van Aubel's Theorem, we have $\frac{IA}{IA^\prime}=\frac{AB^\prime}{B^\prime C}+\frac{AC^\prime}{C^\prime B}$ which from the Angle Bisector Theorem reduces to $\frac{b+c}{a}$. We find similar expressions for the other terms in the product so that the product simplifies to $\prod\frac{1}{1+\frac{a}{b+c}}=\prod\frac{b+c}{a+b+c}$. Letting $a=x+y,b=y+z,c=z+x$ for positive reals $x,y,z$, the product becomes $\frac{1}{8}\prod\frac{x+2y+z}{x+y+z}=\frac{1}{8}\prod\left(1+\frac{y}{x+y+z}\right)$. To prove the right side of the inequality, we simply apply AM-GM to the product to get

$\frac{1}{8}\prod\left(1+\frac{y}{x+y+z}\right)\le\frac{1}{8}\left(\frac{\sum1+\frac{y}{x+y+z}}{3}\right)^3=\frac{8}{27}$

To prove the left side of the inequality, simply multiply out the product to get

$\frac{1}{8}\left(1+\sum\frac{y}{x+y+z}+\sum\frac{yz}{(x+y+z)^2}+\frac{xyz}{(x+y+z)^3}\right)$

$>\frac{1}{8}\left(1+\sum\frac{y}{x+y+z}\right)=\frac{1}{4}$

as desired.",86,1
1991p2,"Let $\,n > 6\,$ be an integer and $\,a_{1},a_{2},\cdots ,a_{k}\,$ be all the natural numbers less than $n$ and relatively prime to $n$. If\[a_{2} - a_{1} = a_{3} - a_{2} = \cdots = a_{k} - a_{k - 1} > 0,\]prove that $\,n\,$ must be either a prime number or a power of $\,2$.","We use Bertrand's Postulate: for $u\ge 2$ is a positive integer, there is a prime in the interval $(u,2u)$.

Clearly, $a_2$ must be equal to the smallest prime $p$ which does not divide $n$. If $p=2$, then $n$ is a prime since the common difference $a_{i+1}-a_i$ is equal to $1$, i.e. all positive integers less than $n$ are coprime to $n$. If, on the ther hand, $p=3$, we find $n$ to be a power of $2$: the positive integers less than $n$ and coprime to it are precisely the odd ones. We may thus assume that $p\ge 5$. Furthermore, since $n>6$, the positive integers less than $n$ and coprime to it cannot be $a_1,a_2$ alone, i.e. $k=\varphi(n)\ge 3$.

By Bertrand's Postulate, the largest prime less than $p$ is strictly larger than $\frac{p-1}2$, so it cannot divide $p-1$. We will denote this prime by $q$. We know that $q|n$. It's easy to check that for $p\le 31$ there is a prime $r$ strictly between $a_2=p,\ a_3=2p-1$. $rq|n$, so, in particular, $pq<rq\le n$. On the other hand, if $p>32$, the two largest primes $r_1<r_2$ which are smaller than $q$ satisfy $r_2\ge\frac p4,\ r_1\ge\frac{r_2}2\ge\frac p8$ (again, Bertrand's Postulate), so $pq<\frac{p^2}{32}q\le r_1r_2q\le n$ so, once again, we have $pq<n$ (this is what I wanted to prove here).

Now, $q\not|p-1$, and all the numbers $1,1+p-1,\ldots,1+(q-1)(p-1)$ are smaller than $n$ (they are smaller than $pq$, which is smaller than $n$, according to the paragraph above). One of these numbers, however, must be divisible by $q|n$. Since our hypothesis tells us that all of them must be coprime to $n$, we have a contradiction.",267,3
1991p4,"Suppose $\,G\,$ is a connected graph with $\,k\,$ edges. Prove that it is possible to label the edges $1,2,\ldots ,k\,$ in such a way that at each vertex which belongs to two or more edges, the greatest common divisor of the integers labeling those edges is equal to 1.","We provide an algorithmic approach for labelling the edges: We start off with the set $V$ of all vertices in $G$. For each step in the process we remove a number of vertices from the set $V$ if their exists an edge sorrounding it which is labelled. Additionally, we shall use up the numbers $1,2,...,k$ in the order from least to greatest.

Here is the process: Let $u$ be the least number not used yet. Take the longest path that uses any vertex once formed solely by vertices from $V$ and call it path $P=(v_1,v_2,...,v_n)$. If $v_1$ has more than one edge, then since $P$ is maximal, it must be connected to some other edge $v_0$ which could be one of the vertices $v_i$ or one of the vertices not in $V$. Similarly, if $v_n$ has more than one edge, it must be connected to a vertex $v_{n+1}$ which is either one of the $v_i$ or one of the vertices not in $V$. Notice that since $v_1,v_n\in V$ the edge connecting $v_0$ and $v_1$ and the edge connecting $v_n$ and $v_{n+1}$ are not labelled. Now, if $v_0$ exists, we shall label the edge joining $v_i$ and $v_{i+1}$ with the number $u+i$. If $v_0$ does not exist then we shall label the edge joining $v_i$ and $v_{i+1}$ with the number $u+i-1$.

If $v_0$ or $v_{n+1}$ does not exist, then the vertex they should have been connected to has degree 1, and so the labels of the edges sorrounding it do not matter. Otherwise and the case of any other vertex in the path, our process garuntees that the vertex will be sorrounded by two edges labelled by 2 consecutive numbers. Thus, that vertex will be sorrounded by edges whose greates common factor is 1, no matter how the other edges sorrounding it are labelled. Notice that from our definition of $V$, the edges $v_1,v_2,...,v_n$ are removed from $V$. Thus, it is clear that all vertices not in $V$, at any time, have edges sorrounding them that are relatively prime.

We repeat the process described until the only vertices in $V$ are those which are not connected to any other vertices in $V$. Let the least number we have not yet used by $u$. If any of them are of degree 1, we do not care. If there is a vertex $v$ of degree at least 2, then we simply label 2 of its edges $u$ and $u+1$ and now its edges are relatively prime, and we can remove it from $V$. Notice that this doesn't remove any other vertices from $V$ since $v$ is not connected to any vertices from $V$. We continue like this for the other vertices in $V$.

Now, all the vertices in $V$ are those whose edges do not matter, while all vertices not in $V$ are those with edges relatively prime. Thus we have the desired configuration, and we simply distribute the remaining numbers in any way we wish.",493,3
1991p5,"Let $\,ABC\,$ be a triangle and $\,P\,$ an interior point of $\,ABC\,$. Show that at least one of the angles $\,\angle PAB,\;\angle PBC,\;\angle PCA\,$ is less than or equal to $30^{\circ }$.","Let $A_{1}$ , $A_{2}$, and $A_{3}$ be $\angle CAB$, $\angle ABC$, $\angle BCA$, respectively.

Let $\alpha_{1}$ , $\alpha_{2}$, and $\alpha_{3}$ be $\angle PAB$, $\angle PBC$, $\angle PCA$, respcetively.

Using law of sines on $\Delta PAB$ we get: $\frac{\left| PA \right|}{sin(A_{2}-\alpha_{2})}=\frac{\left| PB \right|}{sin(\alpha_{1})}$, therefore, $\frac{\left| PA \right|}{\left| PB \right|}=\frac{sin(A_{2}-\alpha_{2})}{sin(\alpha_{1})}$

Using law of sines on $\Delta PBC$ we get: $\frac{\left| PB \right|}{sin(A_{3}-\alpha_{3})}=\frac{\left| PC \right|}{sin(\alpha_{2})}$, therefore, $\frac{\left| PB \right|}{\left| PC \right|}=\frac{sin(A_{3}-\alpha_{3})}{sin(\alpha_{2})}$

Using law of sines on $\Delta PCA$ we get: $\frac{\left| PC \right|}{sin(A_{1}-\alpha_{1})}=\frac{\left| PA \right|}{sin(\alpha_{3})}$, therefore, $\frac{\left| PC \right|}{\left| PA \right|}=\frac{sin(A_{1}-\alpha_{1})}{sin(\alpha_{3})}$

Multiply all three equations we get: $\frac{\left| PA \right|}{\left| PB \right|}\frac{\left| PB \right|}{\left| PC \right|}\frac{\left| PC \right|}{\left| PA \right|}=\frac{sin(A_{2}-\alpha_{2})}{sin(\alpha_{1})}\frac{sin(A_{3}-\alpha_{3})}{sin(\alpha_{2})}\frac{sin(A_{1}-\alpha_{1})}{sin(\alpha_{3})}$

$1=\frac{sin(A_{2}-\alpha_{2})}{sin(\alpha_{1})}\frac{sin(A_{3}-\alpha_{3})}{sin(\alpha_{2})}\frac{sin(A_{1}-\alpha_{1})}{sin(\alpha_{3})}$

$\prod_{i=1}^{3}\frac{sin(A_{i}-\alpha_{i})}{sin(\alpha_{i})}=1$

Using AM-GM we get:

$\frac{1}{3}\sum_{i=1}^{3}\frac{sin(A_{i}-\alpha_{i})}{sin(\alpha_{i})}\ge \sqrt[3]{\prod_{i=1}^{3}\frac{sin(A_{i}-\alpha_{i})}{sin(\alpha_{i})}}$

$\frac{1}{3}\sum_{i=1}^{3}\frac{sin(A_{i}-\alpha_{i})}{sin(\alpha_{i})}\ge 1$

$\sum_{i=1}^{3}\frac{sin(A_{i}-\alpha_{i})}{sin(\alpha_{i})}\ge 3$. [Inequality 1]

$\sum_{i=1}^{3}\frac{sin(A_{i})cos(\alpha_{i})-cos(A_{i})sin(\alpha_{i})}{sin(\alpha_{i})}\ge 3$

$\sum_{i=1}^{3}\left[ sin(A_{i})cot(\alpha_{i})-cos(A_{i})\right]\ge 3$

Note that for $0<\alpha_{i}<180^{\circ}$, $cot(\alpha_{i})$ decreases with increasing $\alpha_{i}$ and fixed $A_{i}$

Therefore, $\left[ sin(A_{i})cot(\alpha_{i})-cos(A_{i})\right]$ decreases with increasing $\alpha_{i}$ and fixed $A_{i}$

From trigonometric identity:

$sin(x)+sin(y)=2sin\left( \frac{x+y}{2} \right)cos\left( \frac{x-y}{2} \right)$,

since $-1\le cos\left( \frac{x-y}{2} \right) \le 1$, then:

$sin(x)+sin(y) \le 2sin\left( \frac{x+y}{2} \right)$

Therefore,

$sin(A_{1}-30^{\circ})+sin(A_{2}-30^{\circ}) \le 2sin\left( \frac{A_{1}+A_{2}-60^{\circ}}{2} \right)$

and also,

$sin(A_{3}-30^{\circ})+sin(30^{\circ}) \le 2sin\left( \frac{A_{3}}{2} \right)$

Adding these two inequalities we get:

$sin(30^{\circ})+\sum_{i=1}^{3}sin(A_{i}-30^{\circ})\le 2\left[ sin\left( \frac{A_{1}+A_{2}-60^{\circ}}{2} \right)+sin\left( \frac{A_{3}}{2} \right) \right]$

$\frac{1}{2}+\sum_{i=1}^{3}sin(A_{i}-30^{\circ})\le 2\left[ 2sin\left( \frac{A_{1}+A_{2}+A_{3}-60^{\circ}}{4} \right) \right]$

$\frac{1}{2}+\sum_{i=1}^{3}sin(A_{i}-30^{\circ})\le 2\left[ 2sin\left( \frac{180^{\circ}-60^{\circ}}{4} \right) \right]$

$\frac{1}{2}+\sum_{i=1}^{3}sin(A_{i}-30^{\circ})\le 4sin\left( 30^{\circ} \right)$

$\sum_{i=1}^{3}sin(A_{i}-30^{\circ})\le \frac{3}{2}$

$2\sum_{i=1}^{3}sin(A_{i}-30^{\circ})\le 3$.

$\sum_{i=1}^{3}\frac{sin(A_{i}-30^{\circ})}{sin(30^{\circ})}\le 3$. [Inequality 2]

Combining [Inequality 1] and [Inequality 2] we see the following:

$\sum_{i=1}^{3}\frac{sin(A_{i}-30^{\circ})}{sin(30^{\circ})}\le \sum_{i=1}^{3}\frac{sin(A_{i}-\alpha_{i})}{sin(\alpha_{i})}$

This implies that for at least one of the values of $i=1$,$2$,or $3$, the following is true:

$\frac{sin(A_{i}-30^{\circ})}{sin(30^{\circ})}\le \frac{sin(A_{i}-\alpha_{i})}{sin(\alpha_{i})}$

or

$\frac{sin(\alpha_{i})}{sin(A_{i}-\alpha_{i})}\le \frac{sin(30^{\circ})}{sin(A_{i}-30^{\circ})}$

Which means that for at least one of the values of $i=1$,$2$,or $3$, the following is true:

$\alpha_{i} \le 30^{\circ}$

Therefore, at least one of the angles $\,\angle PAB,\;\angle PBC,\;\angle PCA\,$ is less than or equal to $30^{\circ }$.",293,3
1990p6,"Prove that there exists a convex $1990\text{-gon}$ with the following two properties: (a) All angles are equal. (b) The lengths of the $1990$ sides are the numbers $1^2, 2^2,3^2,\dots, 1990^2$ in some order.","Let $\{a_1,a_2,\cdots,a_{1990}\}=\{1,2,\cdots,1990\}$ and $\theta=\frac{\pi}{995}$. Then the problem is equivalent to that there exists a way to assign $a_1,a_2,\cdots,a_{1990}$ such that $\sum_{i=1}^{1990}a_i^2e^{i\theta}=0$. Note that $e^{i\theta}+e^{i\theta+\pi}=0$, then if we can find a sequence $\{b_n\}$ such that $b_i=a_p^2-a_q^2, (p\not=q)$ and $\sum_{i=1}^{995}b_ie^{i\theta}=0$, the problem will be solved. Note that $2^2-1^2=3,4^2-3^2=7,\cdots,1990^2-1989^2=3979$, then $3,7,\cdots,3979$ can be written as a sum from two elements in sets $A=\{3,3+4\times199,3+4\times398,3+4\times597,3+4\times796\}$ and $B=\{0,4\times1,4\times2,\cdots,4\times 198\}$. If we assign the elements in $A$ in the way that $l_{a1}=3,l_{a2}=3+4\times199,l_{a3}=3+4\times398,l_{a4}=3+4\times597,l_{a5}=3+4\times796$, then clearly $\sum_{i=1}^{199}l_{aj}e^{i\frac{2\pi}{199}}=0, (j\in\{1,2,3,4,5\})$ Similarly, we could assign elements in $B$ in that way ($l_{b1}=0,l_{b2}=4,\cdots$) to $e^{i\frac{2\pi}{5}}$. Then we make $b_i$ according to the previous steps. Let $i\equiv j$ (mod 5), $i\equiv k$ (mod 199), and $b_i=l_{aj}+l_{bk}$, then each $b_i$ will be some $a_ p^2-a_q^2$ and $\sum_{i=1}^{995}b_ie^{i\theta}=\sum_{j=1}^5\sum_{i=1}^{199}l_{aj}e^{i\frac{2\pi}{199}}+\sum_{k=1}^{199}\sum_{i=1}^{5}l_{bk}e^{i\frac{2\pi}{5}}=0$ And we are done.",126,2
1989p1,"Prove that in the set $\{1,2, \ldots, 1989\}$ can be expressed as the disjoint union of subsets $A_i, \{i = 1,2, \ldots, 117\}$ such that

i.) each $A_i$ contains 17 elements

ii.) the sum of all the elements in each $A_i$ is the same.","Let us start pairing numbers in the following fashion, where each pair sums to $1990$: $(1, 1990-1), (2, 1990-2), \ldots (936, 1054)$

There are a total of $117*8$ pairs above. Let us start putting these pairs into each of the $117$ subsets starting with the first pair $(1, 1990-1)$ going into $A_1$, $(2, 1990-2)$ into $A_2$ and so on $\ldots$ with $(k, 1990-k)$ going into $A_{k(mod 117)}$.

Now we have $16$ numbers present in each of the $117$ subsets all of which have the same total sum. We need $1$ more number to be filled in each subset from the remaining $117$ numbers $(937, 938, ... 1053)$.

Let us arrange these $117$ numbers in the following manner: $995-58, 995-57,  \ldots, 995-1, 995, 995+1, 995+2, \ldots, 995+57, 995+58$ $==> (1)$

Now notice that for each number that's off by $x$ from $995$, there's a counter number off by $x$ from $995$ in the opposite direction.

So we need to create similar imbalances in the Subsets $A_1$ to $A_{117}$, so that we could add the above $117$ numbers to those imbalances to keep the total sum unchanged.

Now start swapping the $1st$ number of each pair that we added to subsets $A_1$ to $A_{117}$ to create the above imbalances:

Swap $1$ from $A_1$ with $59$ from $A_{59}$ - this creates an imbalance of $+58$ and $-58$

Swap $2$ from $A_2$ with $58$ from $A_{58}$ - this creates an imbalance of $+56$ and $-56$

$\ldots$

Swap $29$ from $A_{29}$ with $31$ from $A_{31}$ - creates an imbalance of $+2$ and $-2$

Leave $30$ in $A_{30}$ as it is - $0$ imbalance.

Similarly,

Swap $60$ from $A_{60}$ with $117$ from $A_{117}$ - this creates an imbalance of $+57$ and $-57$

Swap $61$ from $A_{61}$ with $116$ from $A_{116}$ - this creates an imbalance of $+55$ and $-55$

$\ldots$

Swap $88$ from $A_{88}$ with $89$ from $A_{89}$ - this creates an imbalance of $+1$ and $-1$

Now start adding the $117$ numbers from $(1)$ to the subsets $A_1$ to $A_{117}$ to counter the imbalances $-58$ to $+58$ so that the sum remains unchanged. Notice that each subset now has $17$ elements with total sum = $8*1990 + 995 = 16915$.

",365,3
1989p2,"$ABC$ is a triangle, the bisector of angle $A$ meets the circumcircle of triangle $ABC$ in $A_1$, points $B_1$ and $C_1$ are defined similarly. Let $AA_1$ meet the lines that bisect the two external angles at $B$ and $C$ in $A_0$. Define $B_0$ and $C_0$ similarly. Prove that the area of triangle $A_0B_0C_0 = 2 \cdot$ area of hexagon $AC_1BA_1CB_1 \geq 4 \cdot$ area of triangle $ABC$.","Notice that since $A_1C$ and $A_1B$ substend the same angle in the circle, and so are equal. Thus $A_1BC$ is iscoceles, and similarly for triangles $AB_1C$ and $ABC_1$. Also, since $AA_1BC$ is a cyclic quadrilatera, $\angle A_1BC=\angle A_1AC=\frac{A}{2}$, and similarly for the other triangles. Thus, the area of triangle $A_1BC=\frac{1}{4}a^2\tan\frac{A}{2}=\frac{1}{4}a^2\left(\frac{2r}{b+c-a}\right)$ and similarly for the other triangles. Thus, the area of the hexagon is equal to $[ABC]+\sum\frac{1}{4}a^2\left(\frac{2r}{b+c-a}\right)$.

Now we shall find the area of triangle $A_0B_0C_0$. It is obvious that the points $A_1,B,C_1$ are collinear since the angle the make at $B$ is $\frac{1}{2}(180-B)+\frac{1}{2}(180-B)+B=180$, and similarly for the other points. Thus, it suffices to find the area of each of the triangles $A_0BC$. It is well known that $A_0$ is the center of the excircle $O_a$ with radius $R_a=r\left(\frac{a+b+c}{b+c-a}\right)$. Thus the area of triangle $A_0BC$ is $\frac{1}{2}ar\left(\frac{a+b+c}{b+c-a}\right)$ and so the area of triangel $A_0B_0C_0$ is $\sum\frac{1}{2}ar\left(\frac{a+b+c}{b+c-a}\right)$.

Now we can prove that $A_0B_0C_0 = 2 \cdot$ area of hexagon $AC_1BA_1CB_1$ by simplifying. We have

$A_0B_0C_0 -2 \cdot$ area of hexagon $AC_1BA_1CB_1$

$=-[ABC]+\sum\left(\frac{1}{2}ar\left(\frac{a+b+c}{b+c-a}\right)-\frac{1}{2}a^2\left(\frac{2r}{b+c-a}\right)\right)$

$=-[ABC]+\sum\left(\frac{1}{2}ar\left(\frac{a+b+c-2a}{b+c-a}\right)\right)$

$=-[ABC]+\sum\left(\frac{1}{2}ar\right)$

$=0$

as desired.

As for the inequality, notice that it is equivalent to

$[ABC]+\sum\frac{1}{2}ar\left(\frac{a+b+c}{b+c-a}\right)\ge 4[ABC]$

$\Leftrightarrow \sum\frac{1}{2}ar\left(\frac{a+b+c}{b+c-a}\right)\ge \frac{3}{2}r(a+b+c)$

$\Leftrightarrow \sum\frac{a}{b+c-a}\ge 3$

Letting $a=x+y,b=y+z,c=z+x$ for $x,y,z$ positive reals, the inequality becomes

$\sum\frac{x+y}{2z}\ge 3$

$\Leftrightarrow \sum\frac{x+y+z}{z}\ge 9$

which is true by AM-HM.",212,2
1989p3,"Let $n$ and $k$ be positive integers and let $S$ be a set of $n$ points in the plane such that

i.) no three points of $S$ are collinear, and

ii.) for every point $P$ of $S$ there are at least $k$ points of $S$ equidistant from $P.$

Prove that:\[k < \frac {1}{2} + \sqrt {2 \cdot n}\]

","Let $\{A_i\}_{i=1}^n$ be our set of points. We count the pairs $(A_i,\{A_j,A_\ell\}),\ i\ne j\ne \ell\ne i$ such that $A_iA_j=A_iA_\ell$. There are $n$ choices for $A_i$, and for each $A_i$ there are $\ge\frac{k(k-1)}2$ choices for $\{A_j,A_\ell\}$, so the number of such pairs is $\ge\frac{nk(k-1)}2$. On the other hand, there are $\frac{n(n-1)}2$ choices for $\{A_j,A_\ell\}$, and for each $\{A_j,A_\ell\}$ there are at most two choices for $A_i$ (because we can't have $\ge 3$ points on the perpendicular bisector of $A_jA_\ell$). This means that the number of pairs is $\le n(n-1)$. We have thus found $n(n-1)\ge\frac{nk(k-1)}2\Rightarrow 2(n-1)\ge k(k-1)\ (*)$. If $k\ge \sqrt{2n}+\frac 12$, then $k(k-1)\ge 2n-\frac 14>2n-2$, contradicting the last inequality in $(*)$, so we're done.",113,2
1989p4,"Let $ABCD$ be a convex quadrilateral such that the sides $AB,AD,BC$ satisfy $AB=AD+BC$. There exists a point $P$ inside the quadrilateral at a distance $h$ from the line $CD$ such that $AP=h+AD$ and $BP=h+BC$. Show that:

$\frac{1}{\sqrt{h}}\ge\frac{1}{\sqrt{AD}}+\frac{1}{\sqrt{BC}}$","Without loss of generality, assume $AD\ge BC$.

Draw the circle with center $A$ and radius $AD$ as well as the circle with center $B$ and radius $BC$. Since $AB=AD+BC$, the intersection of circle $A$ with the line $AB$ is the same as the intersection of circle $B$ with the line $AB$. Thus, the two circles are externally tangent to each other.

Now draw the circle with center $P$ and radius $h$. Since $h$ is the shortest distance from $P$ to $CD$, we have that the circle $P$ is tangent to $CD$. From the conditions $AP=h+AD$ and $BP=h+BC$, by the same reasoning that we found circles $A,B$ are tangent, we find that circles $P,A$ and $P,B$ are externally tangent also.

Fix the two externally tangent circles with centers $A$ and $B$ and let the points $C$ and $D$ vary about their respective circles (without loss of generality, assume that one can read the letters $ABCD$ in counter clockwise order). Notice that the value $\frac{1}{\sqrt{AD}}+\frac{1}{\sqrt{BC}}$ is fixed. Thus, in order to prove the claim presented in the problem, we must maximize the value of $h$. It is clear that all possible circles $P$ are contained within the region created by circles $A,B$ as well as their common tangent line. Now it is clear that $h$ is maximized when circle $P$ is tangent to the common tangent of circles $A,B$ as well as to the circles $A,B$. We shall prove that the value of $h$ at this point is $\frac{1}{\sqrt{AD}}+\frac{1}{\sqrt{BC}}$.

Fix $C,D$ so that $CD$ is the common tangent to circles $A,B$. Since $\angle ADC,\angle BCD$ are right, the length $CD$ is equal to the length of the segment from $B$ to the projection of $B$ onto $AD$ which by the Pythagorean Theorem is $\sqrt{(BC+AD)^2-(AD-BC)^2}=2\sqrt{BC\cdot AD}$. Let the projection of $P$ onto $CD$ be $x$ units away from $D$. Then, as we found the length of $CD$, we find

$x^2+(AD-h)^2=(AD+h)^2\Rightarrow x^2=4AD\cdot h$

$(2\sqrt{BC\cdot AD}-x)^2+(BC-h)^2=(BC+h)^2\Rightarrow (2\sqrt{BC\cdot AD}-x)^2=4BC\cdot h$

Subtracting the second equation from the first yields

$4x\sqrt{BC\cdot AD}-4BC\cdot AD=4AD\cdot h-4BC\cdot h$

$\Rightarrow x=h\left(\sqrt{\frac{AD}{BC}}-\sqrt{\frac{BC}{AD}}\right)+\sqrt{BC\cdot AD}$

Since $x^2=2AD\cdot h$, we have

$0=h\left(\sqrt{\frac{AD}{BC}}-\sqrt{\frac{BC}{AD}}\right)-2\sqrt{AD\cdot h}+\sqrt{BC\cdot AD}$

Solving for $\sqrt{h}$ yields

$\sqrt{h}=\frac{2\sqrt{AD}\pm\sqrt{4AD-4(AD-BC)}}{2\left(\sqrt{\frac{AD}{BC}}-\sqrt{\frac{BC}{AD}}\right)}$

$\Rightarrow \sqrt{h}=\frac{\sqrt{AD}\pm\sqrt{BC}}{\sqrt{\frac{AD}{BC}}-\sqrt{\frac{BC}{AD}}}$

Since $\sqrt{h}\ne \frac{\sqrt{AD}+\sqrt{BC}}{\sqrt{\frac{AD}{BC}}-\sqrt{\frac{BC}{AD}}}$, we have

$\sqrt{h}=\frac{\sqrt{AD}-\sqrt{BC}}{\sqrt{\frac{AD}{BC}}-\sqrt{\frac{BC}{AD}}}$

$=\frac{\sqrt{AD\cdot BC}}{\sqrt{AD}+\sqrt{BC}}$

And since this is the maximimal value of $\sqrt{h}$, the minimal value of $\frac{1}{\sqrt{h}}$ is $\frac{1}{\sqrt{AD}}+\frac{1}{\sqrt{BC}}$ as desired.",381,3
1989p5,Prove that for each positive integer $n$ there exist $n$ consecutive positive integers none of which is an integral power of a prime number.,"There are at most $1+\sqrt[2]{n}+\sqrt[3]{n}+\sqrt[4]{n}+...+\sqrt[\left\lfloor \log_2(n)\right\rfloor]{n} \leq 1+ \sqrt n log_2(n)$ 'true' powers $m^k , k\geq 2$ in the set $\{1,2,...,n\}$. So when $p(n)$ gives the amount of 'true' powers $\leq n$ we get that $\lim_{n \to \infty} \frac{p(n)}{n} = 0$.

Since also $\lim_{n \to \infty} \frac{\pi(n)}{n} = 0$, we get that $\lim_{n \to \infty} \frac{p(n)+\pi(n)}{n} = 0$. Now assume that there is no 'gap' of lenght at least $k$ into the set of 'true' powers and the primes. Then this would give that $\frac{p(n)+\pi(n)}{n} \geq \frac{1}{k}$ for all $n$ in contrary to the above (at east this proves a bit more).

Edit: to elementarize the $\lim_{n \to \infty} \frac{\pi(n)}{n} = 0$ part: Look $\mod (k+1)!$. Then all numbers in the residue classes $2,3,4,...,k+1$ are not primes (except the smallest representants sometimes). So when there wouldn't exist a gap of length $k$, there has to be a 'true' power in each of these gaps of the prime numbers, so at least one power each $(k+1)!$ numbers, again contradicting $\lim_{n \to \infty} \frac{p(n)}{n} = 0$.",174,2
1989p6,"A permutation $\{x_1, \ldots, x_{2n}\}$ of the set$\{1,2, \ldots, 2n\}$ where $\mbox{n}$ is a positive integer, is said to have property $T$ if $|x_i - x_{i + 1}| = n$ for at least one $i \in \{1,2, \ldots, 2n - 1\}$. Show that, for each $\mbox{n}$, there are more permutations with property $T$ than without.","Let $F$ be the number of permutations with property $T$, and $F_i$ be the set of permutations $\{ x_1, x_2, \ldots, x_{2n} \}$ such that $|x_i - x_{i+1}| = n$. By the inclusion-exclusion principle,

\[|F| = \bigg|\bigcup_{i=1}^n F_i \bigg| = \sum_{i=1}^{2n-1} |F_i| - \sum_{1\leq i<j \leq 2n-1} |F_i \cap F_j| + E \tag{1}\]

for some $E \geq 0$. Lets calculate the first two sums on the far right.

For any $i$, $|F_i| = 2n \cdot (2n - 2)!$, since there are are $2n$ choices for $x_i$, which fixes $x_{i+1}$, and $(2n-2)!$ choices for the remaining elements. Thus

\[\sum_{i=1}^{2n - 1}|F_i| = 2n \cdot (2n - 2)! \cdot (2n - 1) = (2n)!\]

Now lets compute $|F_i \cap F_j|$, where $1 \leq i < j \leq 2n - 1$. Its not possible that $|x_i - x_{i+1}| = |x_{i+1}- x_{i+2}| = n$, since that would imply $x_i = x_{i+2}$. So $|F_i \cap F_j| = 0$ if $j = i + 1$. If $j > i + 1$, then $|F_i \cap F_j| = 2n \cdot (2n - 2) \cdot (2n - 4)!$ (there are $2n$ choices for $x_i, x_{i+1}$, $2n - 2$ for $x_j, x_{j+1}$, and $(2n - 4)!$ for everything else.)

How often is $|F_i \cap F_j| \neq 0$? We know $i$ is at least $1$ and at most $2n - 3$, and for any value of $i$, there are $2n - 2 - i$ possible values for $j$. So the number of non-empty intersections $|F_i \cap F_j|$ is\[\sum_{i=1}^{2n-3} 2n - 2 - i = \sum_{i=1}^{2n-3}i = \frac{(2n-3)(2n-2)}{2}.\]Now we can compute\begin{align*} \sum_{1\leq i < j \leq 2n-1} |F_i \cap F_j| &= 2n \cdot (2n - 2) \cdot (2n - 4)! \cdot \frac{(2n - 3)(2n - 2)}{2} \\ &= \frac{2n \cdot (2n-2)^2 \cdot (2n - 3)!}{2} = \frac{(2n)!}{2} \cdot \frac{2n - 2}{2n - 1} \\ &< \frac{(2n)!}{2}. \end{align*}

Lets plug this into $(1)$:

\[|F| = \sum_{i=1}^{2n - 1} |F_i| - \sum_{1\leq i < j \leq 2n-1} |F_i \cap F_j| + E > (2n)! - \frac{(2n)!}{2} + E \geq \frac{(2n)!}{2}.\]

So more than half of the $(2n)!$ permutations of $\{1, \ldots, 2n\}$ have property $T$.",351,3
1988p4,"Show that the solution set of the inequality

$\sum_{k=1}^{70}\frac{k}{x-k}\ge\frac{5}{4}$

is a union of disjoint intervals, the sum of whose length is $1988$.","Consider the graph of $f(x)=\sum_{k=1}^{70}\frac{k}{x-k}\ge\frac{5}{4}$. On the values of $x$ between $n$ and $n+1$ for $n\in\mathbb{N}$ $1\le n\le 69$, the terms of the form $\frac{k}{x-k}$ for $k\ne n,n+1$ have a finite range. In contrast, the term $\frac{n}{x-n}$ has an infinite range, from $+\infty$ to $n$. Similarly, the term $\frac{n+1}{x-n-1}$ has infinite range from $-n-1$ to $-\infty$. Thus, since the two undefined values occur at the distinct endpoints, we can deduce that $f(x)$ takes on all values between $+\infty$ and $-\infty$ for $x\in(n,n+1)$. Thus, by the Intermediate Value Theorem, we are garunteed a $n<r_n<n+1$ such that $f(r_n)=\frac{5}{4}$. Additionally, we have that for $x>70$, the value of $f(x)$ goes from $+\infty$ to $0$, since as $x$ increases, all the terms go to $0$. Thus, there exists some $r_{70}>70$ such that $f(r_{70})=\frac{5}{4}$ and so $f(x)\ge\frac{5}{4}$ for $x\in(70,r_{70})$.

So, we have $70$ $r_i$ such that $f(r_i)=\frac{5}{4}$. There are obviously no other such $r_i$ since $f(x)=\frac{5}{4}$ yields a polynomial of degree $70$ when combining fractions. Thus, we have that the solution set to the inequality $f(x)\ge\frac{5}{4}$ is the union of the intervals $(n,r_n]$ (since if $f(x)<\frac{5}{4}$ for $x\in(n,r_n)$ then there would exist another solution to the equation $f(x)=\frac{5}{4}$.

Thus we have proven that the solution set is the union of disjoint intervals. Now we are to prove that the sum of their lengths is $1988$.

The sum of their lengths is $r_1+r_2+\cdots+r_{70}-(1+2+\cdots+70)=r_1+r_2+\cdots+r_{70}-35\cdot71$. We have that the equation $f(x)=\frac{5}{4}$ yields a polynomial with roots $r_i$. Thus, opposite of the coeficient of $x^{69}$ divided by the leading coefficient is the sum of the $r_i$. It is easy to see that the coefficient of $x^{69}$ is $-5(1+2+\cdots+70)-4(1+2+\cdots+70)=-9\cdot35\cdot 71$. Thus, since the leading coefficient is $5$ we have $r_1+r_2+\cdots+r_{70}=9\cdot7\cdot71$. Thus, the sum of the lengths of the intervals is $63\cdot71-35\cdot71=28\cdot71=1988$ as desired.",293,3
1988p5,"In a right-angled triangle $ABC$ let $AD$ be the altitude drawn to the hypotenuse and let the straight line joining the incentres of the triangles $ABD, ACD$ intersect the sides $AB, AC$ at the points $K,L$ respectively. If $E$ and $E_1$ dnote the areas of triangles $ABC$ and $AKL$ respectively, show that\[\frac {E}{E_1} \geq 2.\]

","Lemma: Through the incenter $I$ of $\triangle{ABC}$ draw a line that meets the sides $AB$ and $AC$ at $P$ and $Q$, then:\[\frac{AB}{AP} \cdot AC + \frac{AC}{AQ} \cdot AB = AB+BC+AC\]Proof of the lemma: Consider the general case: $M$ is any point on side $BC$ and $PQ$ is a line cutting AB, AM, AC at P, N, Q. Then:

$\frac{AM}{AN}=\frac{S_{APMQ}}{\triangle{APQ}}=\frac{\triangle{APM}+\triangle{AQM}}{\triangle{PQA}}=\frac{\frac{AP}{AB}\triangle{ABM}+\frac{AQ}{AC}\triangle{ACM}}{\frac{AP\cdot AQ}{AB \cdot AC}}=$

$=\frac{AC}{AQ}\cdot \frac{BM}{BC}+\frac{AB}{AP}\cdot \frac{CM}{BC}$

If $N$ is the incentre then $\frac{AM}{AN}=\frac{AB+BC+CA}{AB+AC}$, $\frac{BM}{BC}=\frac{AB}{AB+AC}$ and $\frac{CM}{BC}=\frac{AC}{AC+AB}$. Plug them in we get:\[\frac{AB}{AP} \cdot AC + \frac{AC}{AQ} \cdot AB = AB+BC+AC\]

Back to the problem Let $I_1$ and $I_2$ be the areas of $\triangle{ABD}$ and $\triangle{ACD}$ and $E$ be the intersection of $KL$ and $AD$. Thus apply our formula in the two triangles we get:\[\frac{AD}{AE} \cdot AB + \frac{AB}{AK} \cdot AD = AB+BD+AD\]and\[\frac{AD}{AE} \cdot AC + \frac{AC}{AL} \cdot AD = AC+CD+AD\]Cancel out the term $\frac{AD}{AE}$, we get:\[\frac{AB+BD+AD-\frac{AB}{AK} \cdot AD }{AC+CD+AD- \frac{AC}{AL} \cdot AD }=\frac{AB}{AC}\]\[AB \cdot CD + AB \cdot AD - \frac{AB \cdot AC \cdot AD}{AL}=AC \cdot BD+ AC \cdot AD -\frac{AB \cdot AC \cdot AD}{AK}\]\[AB+AB \cdot \frac{CD}{AD}-\frac{AB \cdot AC}{AL}=AC+ AC \cdot \frac{BD}{AD} - \frac{AB \cdot AC}{AK}\]\[AB+AC - \frac{AB \cdot AC}{AL}=AB+AC - \frac{AB \cdot AC}{AK}\]\[\frac{AB \cdot AC}{AK} = \frac{AB \cdot AC}{AL}\]So we conclude $AK=AL$.

Hence $\angle{AKI_1}=45^o=\angle{ADI_1}$ and $\angle{ALI_2}=45^o=\angle{ADI_2}$, thus $\triangle{AK_1} \cong \triangle{ADI_1}$ and $\triangle{ALI_2} \cong \triangle{ADI_2}$. Thus $AK=AD=AL$. So the area ratio is:\[\frac{E}{E_1}=\frac{AB \cdot AC}{AD^2} = \frac{BC}{AD} =\frac{BD+CD}{\sqrt{BD \cdot CD}}\geq 2\]

",228,2
1988p6,Let $a$ and $b$ be positive integers such that $ab + 1$ divides $a^{2} + b^{2}$. Show that $\frac {a^{2} + b^{2}}{ab + 1}$ is the square of an integer.,"Choose integers $a,b,k$ such that $a^2+b^2=k(ab+1)$ Now, for fixed $k$, out of all pairs $(a,b)$ choose the one with the lowest value of $\min(a,b)$. Label $b'=\min(a,b), a'=\max(a,b)$. Thus, $a'^2-kb'a'+b'^2-k=0$ is a quadratic in $a'$. Should there be another root, $c'$, the root would satisfy: $b'c'\leq a'c'=b'^2-k<b'^2\implies c'<b'$ Thus, $c'$ isn't a positive integer (if it were, it would contradict the minimality condition). But $c'=kb'-a'$, so $c'$ is an integer; hence, $c'\leq 0$. In addition, $(a'+1)(c'+1)=a'c'+a'+c'+1=b'^2-k+b'k+1=b'^2+(b'-1)k+1\geq 1$ so that $c'>-1$. We conclude that $c'=0$ so that $b'^2=k$.

This construction works whenever there exists a solution $(a,b)$ for a fixed $k$, hence $k$ is always a perfect square.",106,2
1987p1,"Let $p_n (k)$ be the number of permutations of the set $\{ 1, \ldots , n \} , \; n \ge 1$, which have exactly $k$ fixed points. Prove that

$\sum_{k=0}^{n} k \cdot p_n (k) = n!$.

(Remark: A permutation $f$ of a set $S$ is a one-to-one mapping of $S$ onto itself. An element $i$ in $S$ is called a fixed point of the permutation $f$ if $f(i) = i$.)","The sum in question simply counts the total number of fixed points in all permutations of the set. But for any element $i$ of the set, there are $(n-1)!$ permutations which have $i$ as a fixed point. Therefore

$\sum_{k=0}^{n} k \cdot p_n (k) = n!$,

as desired.

Slightly Clearer Solution

For any $k$, if there are $p_n(k)$ permutations that have $k$ fixed points, then we know that each fixed point is counted once in the product $k \cdot p_n{k}$. Therefore the given sum is simply the number of fixed points among all permutations of $\{ 1, \ldots , n \}$. However, if we take any $x$ such that $1 \le x \le n$ and $x$ is a fixed point, there are $(n-1)!$ ways to arrange the other numbers in the set. Therefore our desired sum becomes $n \cdot (n-1)! = n!$, so we are done.",145,2
1987p2,"In an acute-angled triangle $ABC$ the interior bisector of the angle $A$ intersects $BC$ at $L$ and intersects the circumcircle of $ABC$ again at $N$. From point $L$ perpendiculars are drawn to $AB$ and $AC$, the feet of these perpendiculars being $K$ and $M$ respectively. Prove that the quadrilateral $AKNM$ and the triangle $ABC$ have equal areas.","We are to prove that $[AKNM]=[ABC]$ or equivilently, $[ABC]+[BNC]-[KNC]-[BMN]=[ABC]$. Thus, we are to prove that $[BNC]=[KNC]+[BMN]$. It is clear that since $\angle BAN=\angle NAC$, the segments $BN$ and $NC$ are equal. Thus, we have $[BNC]=\frac{1}{2}BN^2\sin BNC=\frac{1}{2}BN^2\sin A$ since cyclic quadrilateral $ABNC$ gives $\angle BNC=180-\angle A$. Thus, we are to prove that

$\frac{1}{2}BN^2\sin A=[KNC]+[BMN]$

$\Leftrightarrow \frac{1}{2}BN^2\sin A=\frac{1}{2}CN\cdot CK\sin NCA+\frac{1}{2}BN\cdot BM\sin NBA$

$\Leftrightarrow BN\sin A=CK\sin NCA+BM\sin NBA$

From the fact that $\angle BNC=180-\angle A$ and that $BNC$ is iscoceles, we find that $\angle NBC=\angle NCB=\frac{1}{2}A$. So, we have $BN\cos\frac{1}{2}A=\frac{1}{2}BC\Rightarrow BN=\frac{BC}{2\cos \frac{1}{2}A}$. So we are to prove that

$\frac{BC\sin A}{2\cos \frac{1}{2}A}=CK\sin NCA+BM\sin NBA$

$\Leftrightarrow BC\sin \frac{1}{2}A=CK\sin (C+ \frac{1}{2}A)+BM\sin (C+ \frac{1}{2}A)$

$\Leftrightarrow BC=CK(\sin C\cot\frac{1}{2}A+\cos C)+BM(\sin B\cot\frac{1}{2}A+\cos B)$

We have $\sin C=\frac{KL}{CL}$,$\cos C=\frac{CK}{CL}$, $\cot\frac{1}{2}A=\frac{AK}{KL}=\frac{AM}{LM}$, $\sin B=\frac{LM}{BL}$,$\cos B=\frac{BM}{ML}$, and so we are to prove that

$BC=CK(\frac{KL}{CL}\frac{AK}{KL})+\frac{CK}{CL})+BM(\frac{LM}{BL}\frac{AM}{LM}+\frac{BM}{ML})$

$\Leftrightarrow BC=CK(\frac{AK}{CL}+\frac{CK}{CL})+BM(\frac{AM}{BL}+\frac{BM}{ML})$

$\Leftrightarrow BC=\frac{CK\cdot AC}{CL}+\frac{BM\cdot AB}{BL}$

$\Leftrightarrow BC=AC\cos C+AB\cos B$

We shall show that this is true: Let the altitude from $A$ touch $BC$ at $A^\prime$. Then it is obvious that $AC\cos C=CA^\prime$ and $AB\cos B=A^\prime B$ and thus $AC\cos C+AB\cos B=BC$.

Thus we have proven that $[AKNM]=[ABC]$.",178,2
1987p3,"Let $x_1 , x_2 , \ldots , x_n$ be real numbers satisfying $x_1^2 + x_2^2 + \cdots + x_n^2 = 1$. Prove that for every integer $k \ge 2$ there are integers $a_1, a_2, \ldots a_n$, not all 0, such that $| a_i | \le k-1$ for all $i$ and

$|a_1x_1 + a_2x_2 + \cdots + a_nx_n| \le \frac{ (k-1) \sqrt{n} }{ k^n - 1 }$.","We first note that by the Power Mean Inequality, $\sum_{i=1}^{n} x_i \le \sqrt{n}$. Therefore all sums of the form $\sum_{i=1}^{n} b_i x_i$, where the $b_i$ is a non-negative integer less than $k$, fall in the interval $[ 0 , (k-1)\sqrt{n} ]$. We may partition this interval into $k^n - 1$ subintervals of length $\frac{ (k-1)\sqrt{n} }{k^n - 1}$. But since there are $k^n$ such sums, by the pigeonhole principle, two must fall into the same subinterval. It is easy to see that their difference will form a sum with the desired properties.",92,1
1987p4,Prove that there is no function $f$ from the set of non-negative integers into itself such that $f(f(n)) = n + 1987$ for every $n$.,"We prove that if $f(f(n)) = n + k$ for all $n$, where $k$ is a fixed positive integer, then $k$ must be even. If $k = 2h$, then we may take $f(n) = n + h$.

Suppose $f(m) = n$ with $m \equiv n \mod k$. Then by an easy induction on $r$ we find $f(m + kr) = n + kr$, $f(n + kr) = m + k(r+1)$. We show this leads to a contradiction. Suppose $m < n$, so $n = m + ks$ for some $s > 0$. Then $f(n) = f(m + ks) = n + ks$. But $f(n) = m + k$, so $m = n + k(s - 1) \ge n$. Contradiction. So we must have $m \ge n$, so $m = n + ks$ for some $s \ge 0$. But now $f(m + k) = f(n + k(s+1)) = m + k(s + 2)$. But $f(m + k) = n + k$, so $n = m + k(s + 1) > n$. Contradiction.

So if $f(m) = n$, then $m$ and $n$ have different residues $\pmod k$. Suppose they have $r_1$ and $r_2$ respectively. Then the same induction shows that all sufficiently large $s \equiv r_1 \pmod k$ have $f(s) \equiv r_2 \pmod k$, and that all sufficiently large $s \equiv r_2 \pmod k$ have $f(s) \equiv r_1 \pmod k$. Hence if $m$ has a different residue $r \mod k$, then $f(m)$ cannot have residue $r_1$ or $r_2$. For if $f(m)$ had residue $r_1$, then the same argument would show that all sufficiently large numbers with residue $r_1$ had $f(m) \equiv r \pmod k$. Thus the residues form pairs, so that if a number is congruent to a particular residue, then $f$ of the number is congruent to the pair of the residue. But this is impossible for $k$ odd.",308,3
1987p5,Let $n$ be an integer greater than or equal to 3. Prove that there is a set of $n$ points in the plane such that the distance between any two points is irrational and each set of three points determines a non-degenerate triangle with rational area.,"Consider the set of points $S = \{ (x,x^2) \mid 1 \le x \le n , x \in \mathbb{N} \}$ in the $xy$-plane.


The distance between any two distinct points $(x_1,x^2_1)$ and $(x_2,x^2_2)$ in $S$ (with $x_1 \neq x_2$) is:

$d = \sqrt{(x_1-x_2)^2+\left(x^2_1-x^2_2\right)^2} =$ $\sqrt{(x_1-x_2)^2+(x_1-x_2)^2(x_1+x_2)^2} = |x_1-x_2|\sqrt{1+(x_1+x_2)^2}$.

Since $1+(x_1+x_2)^2$ is an integer and not a perfect square, $\sqrt{1+(x_1+x_2)^2}$ is irrational. Since $|x_1-x_2|$ is a non-zero integer, $d$ is irrational as desired.


All the points in $S$ lie on the parabola $y = x^2$. Thus, it is impossible of any set of three points to be collinear, since no line can intersect a parabola at more than two points. Therefore, any triangle with all vertices in $S$ must be non-degenerate as desired.


Since all the points in $S$ are lattice points, by Pick's Theorem, the area of any triangle with all vertices in $S$ must be in the form $A = I + \dfrac{B}{2} - 1$ where $I$ and $B$ are integers. Thus, the area of the triangle must be rational as desired.",172,2
1987p6,"Let $n$ be an integer greater than or equal to 2. Prove that if $k^2 + k + n$ is prime for all integers $k$ such that $0 \leq k \leq \sqrt{n/3}$, then $k^2 + k + n$ is prime for all integers $k$ such that $0 \leq k \leq n - 2$.

","First observe that if $m$ is relatively prime to $b+1$, $b+2$, $\cdots$, $2b$, then $m$ is relatively prime to any number less than $2b$. Since if $c\leq b$, then we can choose some $i$ to make $2^ic$ lies in range $b+1,b+2,\cdots,2b$, so $2^ic$ is relatively prime to $m$. Hence $c$ is also. If we also have $(2b+1)^2>m$, then we can conclude that $m$ is a prime. Since there must be a factor of $m$ less than $\sqrt{m}$.

Let $n=3r^2+h$ where $0\leq h<6r+3$, so $r$ is the greatest integer less than or equal to $\sqrt{n/3}$.(to see this, just let $r=\lfloor\sqrt{n/3}\rfloor$, then we can write $n=3(r+\epsilon)^2(0\leq\epsilon< 1)$, so $h=6r\epsilon+3\epsilon^2\leq 6r+3$).

Assume that $n+k(k+1)$ is prime for $k=1,2,3\cdots,r$. We show that $N=n+(r+s)(r+s+1)$ is prime for $s=0,1,2,\cdots,n-r-2$. By our observation above, it is sufficient to show that $(2s+2r+t)^2>N$ and $N$ is relatively prime to all of $r+s+1,r+s+2,\cdots,2r+2s$. We have $(2r+2s+1)^2=4r^2+4s^2+8rs+4r+4s+1$. Since $s,t\ge1$, we have $4s+1>s+2$, $4s^2>s^2$ and $6rs>3r$. Hence\[(2s+2r+1)^2>4r^2+2rs+s^2+7r+s+2=3r^2+6r+2+(r+s)(r+s+1)\ge N\]Now if $N$ has a factor which divides $2r-i$ in the range $-2s$ to $r-s-1$, then so does $N-(i+2s+1)(2r-i)=n+(r-i-s-1)(r-i-s)$ which have the form $n+s'(s'+1)$ with $s'$ in range $0$ to $r$.",186,2
1986p1,"Let $d$ be any positive integer not equal to $2, 5$ or $13$. Show that one can find distinct $a,b$ in the set $\{2,5,13,d\}$ such that $ab-1$ is not a perfect square.","Suppose $p^2=2d-1$, $q^2=5d-1$ and $r^2=13d-1$. From the first equation, $p$ is an odd integer. Let $p=2k-1$. We have $d=2k^2-2k+1$, which is an odd integer. Then $q^2$ and $r^2$ must be even integers, denoted by $4n^2$ and $4m^2$ respectively, and thus $r^2-q^2=4m^2-4n^2=8d$, from which\[2d=m^2-n^2=(m+n)(m-n)\]can be deduced. Since $m^2-n^2$ is even, $m$ and $n$ have the same parity, so $(m+n)(m-n)$ is divisible by $4$. It follows that the odd integer $d$ must be divisible by $2$, leading to a contradiction. We are done.",81,1
1986p2,"Given a point $P_0$ in the plane of the triangle $A_1A_2A_3$. Define $A_s=A_{s-3}$ for all $s\ge4$. Construct a set of points $P_1,P_2,P_3,...$ such that $P_{k+1}$ is the image of $P_k$ under a rotation center $A_{k+1}$ through an angle $120^\circ$ clockwise for $k=0,1,2,...$. Prove that if $P_{1986}=P_0$, then the triangle $A_1A_2A_3$ is equilateral.

","Consider the triangle and the points on the complex plane. Without loss of generality, let $A_1=0$, $A_2=1$, and $A_3=a$ for some complex number $a$. Then, a rotation about $A_1$ of $120^\circ$ sends point $P$ to point $e^{\frac{4i\pi}{3}}P$. For $A_2$, the rotation sends $P$ to $e^{\frac{4i\pi}{3}}(P-1)+1$ and for $A_3$ the rotation sends $P$ to $e^{\frac{4i\pi}{3}}(P-a)+a$. Thus the result of all three rotations sends $P$ to

$e^{\frac{4i\pi}{3}}(e^{\frac{4i\pi}{3}}(e^{\frac{4i\pi}{3}}P-1)+1-a)+a$

$=P-e^{\frac{2i\pi}{3}}+e^{\frac{4i\pi}{3}}-ae^{\frac{4i\pi}{3}}+a$

$=P-i\sqrt{3}-ae^{\frac{4i\pi}{3}}+a$

Since the transformation $P\to P-i\sqrt{3}-ae^{\frac{4i\pi}{3}}+a$ occurs $1986/3=662$ times, to obtain $P_{1986}$. But, we have $P_{1986}=P_0$ and so we have

$P_0=P_0+662(-i\sqrt{3}-ae^{\frac{4i\pi}{3}}+a)$

$\Rightarrow -i\sqrt{3}-ae^{\frac{4i\pi}{3}}+a=0$

$\Rightarrow a(-e^{\frac{4i\pi}{3}}+1)=i\sqrt{3}$

$\Rightarrow a=\frac{i\sqrt{3}}{-e^{\frac{4i\pi}{3}}+1}$

$\Rightarrow a=\frac{1}{2}+i\frac{\sqrt{3}}{2}$

Now it is clear that the triangle $A_1A_2A_3$ is equilateral.",105,2
1985p1,A circle has center on the side $AB$ of the cyclic quadrilateral $ABCD$. The other three sides are tangent to the circle. Prove that $AD + BC = AB$.,"Let $O$ be the center of the circle mentioned in the problem. Let $T$ be the second intersection of the circumcircle of $CDO$ with $AB$. By measures of arcs, $\angle DTA = \angle DCO = \frac{\angle DCB}{2} = \frac{\pi}{2} - \frac{\angle DAB}{2}$. It follows that $AT = AD$. Likewise, $TB = BC$, so $AD + BC = AB$, as desired.",60,1
1985p2,"Let $n$ and $k$ be given relatively prime natural numbers, $k < n$. Each number in the set $M = \{ 1,2, \ldots , n-1 \}$ is colored either blue or white. It is given that

(i) for each $i \in M$, both $i$ and $n-i$ have the same color;

(ii) for each $i \in M, i \neq k$, both $i$ and $|i-k|$ have the same color.

Prove that all the numbers in $M$ have the same color.","We may consider the elements of $M$ as residues mod $n$. To these we may add the residue 0, since (i) may only imply that 0 has the same color as itself, and (ii) may only imply that 0 has the same color as $k$, which put no restrictions on the colors of the other residues.

We note that (i) is equivalent to saying that $i$ has the same color as $-i$, and given this, (ii) implies that $i$ and $(-i + k)$ have the same color. But this means that $i, -i$, and $i+k$ have the same color, which is to say that all residues of the form $i + mk \; (m \in \mathbb{N}_0)$ have the same color. But these are all the residues mod $n$, since $k$ and $n$ are relatively prime. Q.E.D.",136,2
1985p3,"For any polynomial $P(x) = a_0 + a_1 x + \cdots + a_k x^k$ with integer coefficients, the number of coefficients which are odd is denoted by $w(P)$. For $i = 0, 1, \ldots$, let $Q_i (x) = (1+x)^i$. Prove that if $i_1, i_2, \ldots , i_n$ are integers such that $0 \leq i_1 < i_2 < \cdots < i_n$, then

$w(Q_{i_1} + Q_{i_2} + \cdots + Q_{i_n}) \ge w(Q_{i_1})$.","We first observe that $(1+x)^{2^m} \equiv 1 + x^{2^m} \pmod{2}$, so for any polynomial $P$ of degree less than $2^m$, $w(P\cdot Q_{2^m}) = 2w (P)$.

Let $k$ be the largest power of 2 that is less than or equal to $i_n$. We proceed by induction on $k$.

For $k = 0$, the problem is trivial.

Now assume that the problem holds for $k-1$. We now have two cases: $i_1 \ge k$, and $i_1 < k$.

In the first case, we note that $w \left( \sum_{j=1}^{n}Q_{i_j} \right) = w \left( (1+x)^k \sum_{j=1}^{n}Q_{i_j - k} \right) = 2 w \left( \sum_{j=1}^{n}Q_{i_j - k} \right)$, which is greater than or equal to $w( Q_{i_1} )$ by assumption.

In the second case, we use the division algorithm to note that

$\sum_{j=1}^{n}Q_{i_j} = \sum_{j=0}^{k-1}a_j x^j + (1+x)^k \sum_{j=0}^{k-1} b_j x^j \equiv \sum_{j=0}^{k-1}\left[ (a_j + b_j)x^j + b_j x^{j+k} \right] \pmod{2}$.

But by assumption, $w \left( \sum_{j=0}^{k-1}a_j x^j \right) \ge w( Q_{i_1})$, and for each odd $a_j$, at least one of $(a_j + b_j )$ and $b_j$ must be odd, Q.E.D.",175,2
1985p4,"Given a set $M$ of $1985$ distinct positive integers, none of which has a prime divisor greater than $23$, prove that $M$ contains a subset of $4$ elements whose product is the $4$th power of an integer.","We have that $x\in M\Rightarrow x=2^{e_1}3^{e_2}\cdots 19^{e_8}23^{e_9}$. We need only consider the exponents. First, we consider the number of subsets of two elements, such that their product is a perfect square. There are $2^9=512$ different parity cases for the exponents $e_1,e_2,...,e_9$. Thus, we have at least one pair of elements out of $1985$ elements. Removing these two elements yields $1983$ elements. By applying the Pigeon Hole Principle again, we find that there exists another such subset. Continuing on like this yields at least $734$ pairs of elements of $M$ whose product is a perfect square. Let $S$ be the set of the square roots of the products of each pair. Then, by the Pigeon Hole Principle again, there exist at least two elements whose product is a perfect square. Let the elements be $x,y$ and let $x=\sqrt{ab},y=\sqrt{cd}$ where $a,b,c,d\in M$. Then, we have $xy=z^2$ for some $z$ which implies $abcd=z^4$ and the claim is proved.",155,2
1985p5,A circle with center $O$ passes through the vertices $A$ and $C$ of the triangle $ABC$ and intersects the segments $AB$ and $BC$ again at distinct points $K$ and $N$ respectively. Let $M$ be the point of intersection of the circumcircles of triangles $ABC$ and $KBN$ (apart from $B$). Prove that $\angle OMB = 90^{\circ}$.,"Let $\Omega, \Omega', \omega$ and $O,O',O''$ be the circumcircles and circumcenters of $AKNC, ABC, BNKM,$ respectively.

Let $\angle ACB = \gamma, AKNC$ is cyclic $\implies \angle BKN = \gamma.$

The radius of $\omega$ is $MO'' = BO'' = \frac {BN}{2 \sin \gamma}.$

Let $D$ and $E$ be midpoints of $BC$ and $NC$ respectively.

$OE \perp BC, OD \perp BC, OO' \perp AC, DE = \frac {BC}{2} - \frac {NC}{2} = \frac {BN}{2}$ $\implies OO' = \frac {DE}{\sin \gamma} = \frac {BN}{2 \sin \gamma} = MO''.$

$M$ is the Miquel Point of quadrilateral $ACNK,$ so $MO''O'O$ is cyclic. $MO''O'O$ is trapezium $\implies O''O' || MO.$ $O''O' \perp BM \implies MO\perp BM$ as desired.",112,2
1985p6,"For every real number $x_1$, construct the sequence $x_1,x_2,\ldots$ by setting $x_{n+1}=x_n \left(x_n + \frac{1}{n}\right)$ for each $n \geq 1$. Prove that there exists exactly one value of $x_<x_n<x_{n+1}<1$ for every $n$.","By recursive substitution, one can write $x_n=P_n(x_1)$ , where $P_n$ is a polynomial with non-negative coefficients and zero constant term. Thus, $P_n(0)=0$, $P_n$ is strictly increasing in $[0,+\infty)$ , and $\displaystyle \lim_{x_1 \rightarrow + \infty} P_n(x_1)=+\infty$. We can therefore define the inverse $P_n^{-1}$ of $P_n$ on $[0,+\infty)$. It follows that $x_1=P_n^{-1}(x_n)$, $P_n^{-1}(0)=0$, $P_n^{-1}$ is strictly increasing in $[0,+\infty)$, and $\displaystyle \lim_{x_1 \rightarrow + \infty} P_n^{-1}(x_1) =+\infty$.

Denote by $\displaystyle a_n=P_n^{-1}(1-\frac{1}{n})$ and $b_n=P_n^{-1}(1)$. By the monotonicity of $P_n^{-1}$ we have $a_n<b_n$ for each $n$. Note that:

(a) $\displaystyle x_n<x_{n+1} \Leftrightarrow x_n>1-\frac{1}{n} \Leftrightarrow P_n^{-1}(x_n)>P_n^{-1}(1-\frac{1}{n}) \Leftrightarrow x_1>a_n$; (b) $\displaystyle x_n<1 \Leftrightarrow P_n^{-1}(x_n)<P_n^{-1}(1) \Leftrightarrow x_1<b_n$.

Thus, $0<x_n<x_{n+1}<1,\forall n$ holds if and only if $a_n<x_1<b_n,\forall n$, or $\displaystyle x_1 \in \bigcap_{n=1}^{+\infty}(a_n,b_n)$. We need to show that $\displaystyle \bigcap_{n=1}^{+\infty}(a_n,b_n)$ is a singleton. We have:

(c) if $x_1=a_n$, then $x_n=1-\frac{1}{n}$, which implies that $x_{n+1}=1-\frac{1}{n}<1-\frac{1}{n+1}=P_{n+1}(a_{n+1})$, and $x_1<a_{n+1}$. It follows that $a_n<a_{n+1},\forall n$; and (d) if $x_1=b_n$, then $x_n=1$, which implies that $x_{n+1}=1+\frac{1}{n}>1=P_{n+1}(b_{n+1})$, and $x_1>b_{n+1}$. It follows that $b_n>b_{n+1},\forall n$; and

Thus, $a_n<a_{n+1}<b_{n+1}<b_n, \forall n$. Therefore, the two sequences $\{a_n\}_{n=1}^{+\infty}$ and $\{b_n\}_{n=1}^{+\infty}$ converge, and their limits $a$ and $b$ satisfy $a \leq b$. Hence, $\displaystyle \bigcap_{n=1}^{+\infty}(a_n,b_n)=[a,b]$ is non-empty, which demonstrates the existence of $x_1$.

Now, suppose that $a \leq x_1 \leq x_1' \leq b$. We have $x_{n+1}'-x_{n+1} = (x_n'-x_n)(x_n'+x_n+\frac{1}{n}) \geq (x_n'-x_n)(2-\frac{1}{n}) \geq (x_n'-x_n)$ for each $n$, so that $x_n'-x_n \geq x_1'-x_1$ for each $n$. However, $1-\frac{1}{n}<x_n \leq x_n'<1$, so that $0 \leq x_n'-x_n<\frac{1}{n}$, which implies that $\displaystyle \lim_{n \rightarrow +\infty}(x_n'-x_n)=0$. Therefore, $x_1' \leq x_1$, proving unicity.",247,2
1984p1,"Let $x$, $y$, $z$ be nonnegative real numbers with $x + y + z = 1$. Show that $0 \leq xy+yz+zx-2xyz \leq \frac{7}{27}$","Note that this inequality is symmetric with x,y and z.

To prove\[xy+yz+zx-2xyz\geq 0\]note that $x+y+z=1$ implies that at most one of $x$, $y$, or $z$ is greater than $\frac{1}{2}$. Suppose $x \leq \frac{1}{2}$, WLOG. Then, $xy+yz+zx-2xyz=yz(1-2x)+xy+zx\geq 0$ since $(1-2x)\geq 0$, implying all terms are positive.

To prove $xy+yz+zx-2xyz \leq \frac{7}{27}$, suppose $x \leq y \leq z$. Note that $x \leq y \leq \frac{1}{2}$ since at most one of x,y,z is $\frac{1}{2}$. Suppose not all of them equals $\frac{1}{3}$-otherwise, we would be done. This implies $x \leq \frac{1}{3}$ and $z \geq \frac{1}{3}$. Thus, define\[x' =\frac{1}{3}\],\[y'=y\]\[z'=x+y-\frac{1}{3}\]\[\epsilon = \frac{1}{3}-x\]Then, $x'=x+\epsilon$, $z'=z-\epsilon$, and $x'+y'+z'=1$. After some simplification,\[x'y'+y'z'+z'x'-2x'y'z'=xy+yz+zx-2xyz+(1-2y)(z-x-\epsilon)>xy+yz+zx-2xyz\]since $1-2y>0$ and $z-x-\epsilon=z-\frac{1}{3}>0$. If we repeat the process, defining\[x'' =x'=\frac{1}{3}\]\[y''=\frac{1}{3}\]\[z''=z'+y'-\frac{1}{3}=\frac{1}{3}\]after similar reasoning, we see that\[xy+yz+zx-2xyz\leq x'y'+y'z'+z'x'-2x'y'z' \leq x''y''+y''z''+z''x''-2x''y''z''=\frac{7}{27}\]",121,2
1984p3,"Given points $O$ and $A$ in the plane. Every point in the plane is colored with one of a finite number of colors. Given a point $X$ in the plane, the circle $C(X)$ has center $O$ and radius $OX+{\angle AOX\over OX}$, where $\angle AOX$ is measured in radians in the range $[0,2\pi)$. Prove that we can find a point $X$, not on $OA$, such that its color appears on the circumference of the circle $C(X)$.","Let $a_{n},\ n\ge 1$ be a sequence of positive reals such that $\left(\sum_{n\ge 1}a_{n}\right)^{2}<2\pi\ (*)$. For each $n\ge 1$, let $\mathcal C_{n}$ be the circle centered at $O$ with radius $\sum_{i=1}^{n}a_{i}$.

Because of $(*)$, we can find points $x_{i,j}\in\mathcal C_{i},\ i,j\ge 1$ such that for all $i,j\ge 1$ we have $\mathcal C(x_{i,j})=\mathcal C_{i+j}$. We now forget about all the other points, and work only with the matrix $M=(x_{i,j})$.

Suppose we use $n$ colors. There must be one, $c_{1}$, which appears infinitely many times on the first row of $M$, in, say, points $x_{1,j_{1}},x_{1,j_{2}},\ldots$. Then $c_{1}$ cannot appear on the lines $j_{k}+1$, $k\ge 1$. Next, there is a color $c_{2}$ which appears infinitely often among the points $x_{j_{1}+1,j_{k}-j_{1}}$, $k\ge 2$. But then $c_{2}$ cannot appear on the lines $j_{k}+1$ for such $k$. Repeating this procedure, we reach a stage where we have a row of $M$ (infinitely many actually) on which none of our $n$ colors $c_{1},\ldots,c_{n}$ can appear. This is a contradiction.",162,2
1984p4,Let $ABCD$ be a convex quadrilateral with the line $CD$ being tangent to the circle on diameter $AB$. Prove that the line $AB$ is tangent to the circle on diameter $CD$ if and only if the lines $BC$ and $AD$ are parallel.,"First, we prove that if $BC$ and $AD$ are parallel then the claim is true: Let $AB$ and $CD$ intersect at $E$ (assume $E$ is closer to $AD$, the other case being analogous). Let $M,N$ be the midpoints of $AB,CD$ respectively. Let the length of the perpendicular from $N$ to $AB$ be $r$. It is known that the length of the perpendicular from $M$ to $CD$ is $\frac{1}{2}AB$. Let the foot of the perpendicular from $C$ to $AB$ be $H$, and similarly define $G$ for side $CD$. Then, since triangles $MNE$ and $BCE$ are similar, we have $\frac{CH}{r}=\frac{BG}{\frac{1}{2}AB}$. This gives an expression for $r$:

$r=\frac{1}{2}AB\cdot\frac{CH}{BG}$

Noticing that $CH=BC\sin EBC,BG=BC\sin ECB$ simplifies the expression to

$r=\frac{1}{2}AB\cdot\frac{\sin EBC}{\sin ECB}$

By the Law of Sines, $\frac{\sin EBC}{\sin ECB}=\frac{EC}{EB}$. Since triangles $EDA,ECB$ are similar, we have $\frac{EC}{EB}=\frac{CD}{AB}$ and thus we have

$r=\frac{1}{2}AB\cdot\frac{CD}{AB}=\frac{1}{2}CD$

and we are done.

Now to prove the converse. Suppose we have the quadrilateral with $BC$ parallel to $AD$, and with all conditions satisfied. We shall prove that there exists no point $T$ on $CD$ such that $T$ is a midpoint of a side $CD^\prime$ of a quadrilateral $ABCD^\prime$ which also satisfies the condition. Suppose there was such a $T$. Like before, define the points $E,M,N$ for quadrilateral $ABCD$. Let $t$ be the length of the perpendicular from $T$ to $AB$. Then, using similar triangles, $\frac{ET}{t}=\frac{EN}{\frac{1}{2}CD}$. This gives

$t=\frac{\frac{1}{2}CD\cdot ET}{EN}$

But, we must have $t=DT$. Thus, we have

$DT=\frac{\frac{1}{2}CD\cdot ET}{EN}$

$\Rightarrow \frac{1}{2}CD\cdot EN+NT\cdot EN=\frac{1}{2}CD\cdot (EN+NT)$

$\Rightarrow NT\cdot EN=\frac{1}{2}CD\cdot NT$

Since $\frac{1}{2}CD\ne EN$, we have $NT=0$ as desired.",255,3
1984p5,"Let $d$ be the sum of the lengths of all the diagonals of a plane convex polygon with $n$ vertices (where $n>3$). Let $p$ be its perimeter. Prove that:\[n-3<{2d\over p}<\Bigl[{n\over2}\Bigr]\cdot\Bigl[{n+1\over 2}\Bigr]-2,\]where $[x]$ denotes the greatest integer not exceeding $x$.","Consider all the pairs of non-adjacent sides in the polygon. Each pair uniquely determines two diagonals which intersect in an interior point. The sum of these two diagonals is greater than the sum of the two sides (triangle inequality). Each side will appear in a pair $n-3$ times. And each time the side appears it also includes two diagonals. Thus, $(n-3)p < 2d$.

Note that for any diagonal, its length is less than the sum of the sides on either side of it (triangle inequality). Consider all the diagonals from a fixed vertex and using the least number of sides in each application of the triangle inequality. We can sum everything up over all the diagonals considering the two cases (even or odd) to get the result.",127,2
1984p6,"Let $a,b,c,d$ be odd integers such that $0<a<b<c<d$ and $ad=bc$. Prove that if $a+d=2^k$ and $b+c=2^m$ for some integers $k$ and $m$, then $a=1$.","Let $f:[1,b]\rightarrow \mathbb{R},\ f(x)=x+\dfrac{bc}{x}$. As $f^\prime (x)=1-\dfrac{bc}{x^2}\le 0$, we infer that $f(x)\ge f(b)=b+c,\ \forall x\in [1,b]$; in particular, $a+d=f(a)\ge b+c\Leftrightarrow k\ge m$.

Now, $ad=bc\Leftrightarrow a(2^k-a)=b(2^m-b)\Leftrightarrow (b-a)(a+b)=2^m(b-2^{k-m}a)$, hence $2^m|(b-a)(a+b)$. It is easy to see that for $x,y\in \mathbb{Z}$, if $v_2(x\pm y)\ge 2$, then $v_2(x\mp y)=1$. If $v_2(b-a)\ge 2$, $v_2(a+b)=1$, so $v_2(b-a)\ge m-1\Rightarrow b>2^{m-1}$, which is in contradiction with the fact that $b<\dfrac{b+c}{2}=2^{m-1}$. Thereby, $v_2(a+b)\ge m-1,\ v_2(b-a)=1$.

Write $a+b=2^{m-1}\alpha$. If $\alpha \ge 2\Rightarrow2^m\le a+b<b+c=2^m$, contradiction; so $a+b=2^{m-1}$ and $b-a=2\beta$, or equivalently $a=2^{m-2}-\beta,\ b=2^{m-2}+\beta$ ( $m>2$ otherwise $b+c=2\Leftrightarrow b=c=1$ or $b+c=4\Leftrightarrow c=3,b=1\Rightarrow a=0$ , contradiction )


Substituting back, $(b-a)(a+b)=2^m(b-2^{k-m}a)\Leftrightarrow 2^m\beta=2^m(2^{m-2}+\beta-2^{k-m}a)\Leftrightarrow 2^{k-m}a=2^{m-2}$

As $m>2$ and $a$ is odd, we get that $a=1$. Furthermore, $k=2m-2$, hence $d=2^{2m-2}-1$. Now $b(2^m-b)=2^{2m-2}-1\Leftrightarrow \left ( b-(2^{m-1}-1) \right ) \left ( b-(2^{m-1}+1)\right )=0$ which together with the fact that $b<c$, we get that $b=2^{m-1}-1,\ c=2^{m-1}+1$, so the family of the solutions $(a,b,c,d)$ is described by the set\[M=\{ \left (1,2^{m-1}-1,2^{m-1}+1,2^{2m-2}-1 \right )|\ m\in \mathbb{N},m\ge 3 \}\]

",155,2
1983p2,"Let $A$ be one of the two distinct points of intersection of two unequal coplanar circles $C_1$ and $C_2$ with centers $O_1$ and $O_2$ respectively. One of the common tangents to the circles touches $C_1$ at $P_1$ and $C_2$ at $P_2$, while the other touches $C_1$ at $Q_1$ and $C_2$ at $Q_2$. Let $M_1$ be the midpoint of $P_1Q_1$ and $M_2$ the midpoint of $P_2Q_2$. Prove that $\angle O_1AO_2=\angle M_1AM_2$.","Let $A$ be one of the two distinct points of intersection of two unequal coplanar circles $C_1$ and $C_2$ with centers $O_1$ and $O_2$ respectively. Let $S$ be such point on line $O_1O_2$ so that tangents on $C_1$ touches it at $P_1$ and $Q_1$ and tangents on $C_2$ touches it at $P_2$ and $Q_2$. Let $M_1$ be the midpoint of $P_1Q_1$ and $M_2$ the midpoint of $P_2Q_2$. Prove that $\angle O_1AO_2 = \angle M_1AM_2$.

Proof: Since $S$ is image of $M_1$ under inversion wrt circle $C_1$ we have:\[\angle O_1AM_1 = \angle O_1M_1'A'= \angle O_1SA\]Since $S$ is image of $M_2$ under inversion wrt circle $C_2$ we have:\[\angle O_2SA= \angle O_2A'S'= \angle O_2AM_2\]Image of $A$ is in both cases $A$ itself, since it lies on both circles. Since $\angle O_1SA = \angle O_2SA$ we have:\[\angle M_1AO_1=\angle M_2AO_2\]Now:\[\angle O_1AO_2 = \angle M_1AM_2-\angle M_1AO_1+\angle M_2AO_2 = \angle M_1AM_2\]

",144,2
1983p3,"Let $a$, $b$ and $c$ be positive integers, no two of which have a common divisor greater than $1$. Show that $2abc - ab - bc- ca$ is the largest integer which cannot be expressed in the form $xbc + yca + zab$, where $x$, $y$ and $z$ are non-negative integers.","First off, I prove $2abc-ab-bc-ca$ is un-achievable. Also, assume WLOG $a\ge b\ge c$.

Assume $2abc-bc-ca=xbc+yca+zab$, then take the equation $\pmod{ab}$ to give us $(x+1)bc+(y+1)ac\equiv 0\pmod{ab}$. By CRT and $\gcd(a,b)=1$, we take this equation mod a and mod b to give us $y+1\equiv 0\pmod{b}$, and $x+1\equiv 0\pmod{a}$ (and using all numbers are relatively prime pairwise). Substituting this back into the original equation gives us $z\le -1$, contradiction (this is where the $2abc$ part comes in).

Now, let $2abc-bc-ca-ab+k=xbc+yca+zab$, and if a solution exists where $bc-1\ge k\ge 1$ then we are done because we can add $1$ to $x$ always.

Consider the set $x=a-m$, where $m\in \{1,2,\cdots, a-1, a\}$ and $y=b-n$ where $n\in \{1,2,\cdots, b-1, b\}$.

Therefore, we get $2abc-bc-ca-ab+k=(a-m)bc+(b-n)ca+zab$. This is the same as $bc(m-1)+ca(n-1)+k=(z+1)ab$ after doing some simplifying. By CRT, this must hold mod a and mod b and because $\gcd(a,b)=1$. Mod $a$ gives us $bc(m-1)+k\equiv 0\pmod{a}$, for which a value of $m-1$ obviously exists mod $a$, which can be chosen from the set of values we have assigned for $m$. Similar method shows a value of $n-1$ exists mod $b$ from the set we have given to $n$.

Now, we already know that $x,y\ge 0$. Also, the LHS of the equation $bc(m-1)+ca(n-1)+k$ is at least $1$, therefore $z\ge 0$ and we are done.",214,2
1982p2,"A non-isosceles triangle $A_{1}A_{2}A_{3}$ has sides $a_{1}$, $a_{2}$, $a_{3}$ with the side $a_{i}$ lying opposite to the vertex $A_{i}$. Let $M_{i}$ be the midpoint of the side $a_{i}$, and let $T_{i}$ be the point where the inscribed circle of triangle $A_{1}A_{2}A_{3}$ touches the side $a_{i}$. Denote by $S_{i}$ the reflection of the point $T_{i}$ in the interior angle bisector of the angle $A_{i}$. Prove that the lines $M_{1}S_{1}$, $M_{2}S_{2}$ and $M_{3}S_{3}$ are concurrent.","Rename the vertices so that $A_1=A,A_2=B$ and $A_3=C$. Let $I$ be the incenter of $\triangle ABC$.

Claim 1: $S_1, S_2, S_3$ all lie on the incircle. Proof: By construction, $IS_1$ is the reflection of $IT_1$ with respect to the $A$ angle bisector since $I$ lies on the angle bisector of $A$. So, $IS_1=IT_1$ so $S_1$ lies on the incircle. Similarly, $S_2$ and $S_3$ lie on the incircle. $\Box$


Note that $I$ is the circumcenter of $\triangle S_1S_2S_3$ because of equal radii due to Claim 1.


Claim 2: $\angle S_1IS_2=2\angle C.$ Proof: In cyclic quadrilateral $T_1IT_2C$, $\angle T_1IT_2=180^{\circ}-\angle C$. Let $D$ be the point where the $A$ angle bisector intersects $BC$. Due to the construction of $S_1$, $\angle S_1IT_1=2\angle DIT_1.$ But, $\angle ADC=180^{\circ}-\angle C-\frac{1}{2}\angle A$ so $\angle DIT_1=\frac{1}{2}\angle A+\angle C-90^{\circ}.$ Thus,\[\angle S_1IT_1=\angle A+2\angle C-180^{\circ}.\]Similarly, $\angle S_2IT_2=\angle B+2\angle C-180^{\circ}.$ Therefore, $\angle S_1IS_2=\angle S_1IT_1+\angle T_1IT_2+\angle T_2IS_2=2\angle C.$$\Box$


Hence, we use Claim 2 to get $\angle S_1S_3S_2=\frac{1}{2}\angle S_1IS_2=\angle C$ and we similarly get $\angle S_3S_1S_2=\angle A$ and $\angle S_1S_2S_3=\angle B.$


Claim 3: Let $X_1$ be the midpoint of $S_2S_3.$ Then, $T_1IX_1$ is collinear. Proof: We already derived that $\angle T_1IT_2=180^{\circ}-\angle C$ and $\angle S_2IT_2=\angle B+2\angle C-180^{\circ}.$ Recall that a radius is perpendicular to the midpoint of a chord so $S_2S_3\perp IX_1.$ Then, $\angle X_1IS_2=90^{\circ}-\angle X_1S_2I=90^{\circ}-(90^{\circ}-\angle A)=\angle A.$ Thus,\[\angle T_1IX_1=\angle X_1IS_2+\angle S_2IT_2+\angle T_2IT_1=\angle A+\angle B+2\angle C-180^{\circ}+180^{\circ}-\angle C=180^{\circ},\]as desired.$\Box$


Then, $T_1IX_1\perp S_2S_3$ because a diameter is perpendicular to a chord at its midpoint and because $T_1IX_1$ is part of a diameter, by Claim 3. Hence, $S_2S_3\parallel BC.$ But, $M_2M_3\parallel BC$ so $S_2S_3\parallel M_2M_3$. Similarly, we get $S_1S_2\parallel M_1M_2$ and $S_1S_3\parallel M_1M_3$ so $\triangle M_1M_2M_3\sim \triangle S_1S_2S_3$ with corresponding parallel sides. Thus, there exists a homothety that maps $M_1M_2M_3$ to $S_1S_2S_3$ and $M_1S_1, M_2S_2,$ and $M_3S_3$ intersect at the center of the homothety. $\blacksquare$",297,3
1982p4,"Prove that if $n$ is a positive integer such that the equation $x^3-3xy^2+y^3=n$ has a solution in integers $x,y$, then it has at least three such solutions. Show that the equation has no solutions in integers for $n=2891$.","Suppose the equation $x^3-3xy^2+y^3=n$ has solution in integers $(x,y)$ with $y=x+k$. Then, completing the cube yields $(y-x)^3-3x^2y+2x^3$. Using the substitution $y=x+k$ yields $k^3-3kx^2-x^3=n$. Notice that equality directly implies that $(k,-x)$ is also a solution to the original equation. Applying the transformation again yields that $(-x-k,-k)$ is also a solution. We show that these three solutions are indeed distinct: If $(x,y)=(k,-x)$ then $x=k,x+k=-x$ which only has solution $x=k=0$ which implies that $n$ is not a positive integer, a contradiction. Similarly, since the transformation from $(k,-x)$ to $(-x-k,-k)$ and $(-x-k,-k)$ to $(x,y)$ is the same as the transformation from $(x,y)$ to $(k,-x)$, we have that the three solutions are pairwise distinct.

For the case $n=2891$, notice that $7|n$. Considering all solutions modulo $7$ of the equation $x^3-3xy^2+y^3\equiv0\pmod{7}$ yields only $x\equiv y\equiv 0\pmod{7}$. But, this implies that $7^3$ divides $2891$ which is clearly not true.",142,2
1982p6,"Let $S$ be a square with sides length $100$. Let $L$ be a path within $S$ which does not meet itself and which is composed of line segments $A_0A_1,A_1A_2,A_2A_3,\ldots,A_{n-1}A_n$ with $A_0=A_n$. Suppose that for every point $P$ on the boundary of $S$ there is a point of $L$ at a distance from $P$ no greater than $\frac {1} {2}$. Prove that there are two points $X$ and $Y$ of $L$ such that the distance between $X$ and $Y$ is not greater than $1$ and the length of the part of $L$ which lies between $X$ and $Y$ is not smaller than $198$.","Let the square be A'B'C'D'. The idea is to find points of L close to a particular point of A'D' but either side of an excursion to B'.

We say L approaches a point P' on the boundary of the square if there is a point P on L with PP' ?1/2. We say L approaches P' before Q' if there is a point P on L which is nearer to A0 (the starting point of L) than any point Q with QQ' ?1/2.

Let A' be the first vertex of the square approached by L. L must subsequently approach both B' and D'. Suppose it approaches B' first. Let B be the first point on L with BB' ?1/2. We can now divide L into two parts L1, the path from A0 to B, and L2, the path from B to An.

Take X' to be the point on A'D' closest to D' which is approached by L1. Let X be the corresponding point on L1. Now every point on X'D' must be approached by L2 (and X'D' is non-empty, because we know that D' is approached by L but not by L1). So by compactness X' itself must be approached by L2. Take Y to be the corresponding point on L2. XY ?XX' + X'Y ?1/2 + 1/2 = 1. Also BB' ?1/2, so XB ?X'B' - XX' - BB' ?X'B' - 1 ?A'B' - 1 = 99. Similarly YB ?99, so the path XY ?198.

",259,3
1981p2,"Let $1 \le r \le n$ and consider all subsets of $r$ elements of the set $\{ 1, 2, \ldots , n \}$. Each of these subsets has a smallest member. Let $F(n,r)$ denote the arithmetic mean of these smallest numbers; prove that

$F(n,r) = \frac{n+1}{r+1}.$","Clearly, the sum of the desired least elements is $\sum_{k=1}^{n} k {n-k \choose r-1} = \sum_{k=1}^{n} {k \choose 1}{n-k \choose r-1}$, which we claim to be equal to ${n+1 \choose r+1}$ by virtue of the following argument.

Consider a binary string of length $n+1$ which contains $r+1$ 1s. For some value of $k$ between 1 and $n$, inclusive, we say that the second 1 will occur in the $(k+1)$th place. Clearly, there are ${k \choose 1}$ ways to arrange the bits coming before the second 1, and ${n-k \choose r-1}$ ways to arrange the bits after the second 1. Our identity follows.

Since the sum of the least elements of the sets is ${n+1 \choose r+1}$, the mean of the least elements is $\frac{{n+1 \choose r+1}}{{n \choose r}} = \frac{n+1}{r+1}$",130,2
1981p5,Three congruent circles have a common point $O$ and lie inside a given triangle. Each circle touches a pair of sides of the triangle. Prove that the incenter and the circumcenter of the triangle and the point $O$ are collinear.,"Let the triangle have vertices $A,B,C$, and sides $a,b,c$, respectively, and let the centers of the circles inscribed in the angles $A,B,C$ be denoted $O_A, O_B, O_C$, respectively.

The triangles $O_A O_B O_C$ and $ABC$ are homothetic, as their corresponding sides are parallel. Furthermore, since $O_A$ lies on the bisector of angle $A$ and similar relations hold for the triangles' other corresponding points, the center of homothety is the incenter of both the triangles. Since $O$ is clearly the circumcenter of $O_A O_B O_C$, $O$ is collinear with the incenter and circumcenter of $ABC$, as desired.",96,1
1979p1,"If $p$ and $q$ are natural numbers so that\[\frac{p}{q}=1-\frac{1}{2}+\frac{1}{3}-\frac{1}{4}+ \ldots -\frac{1}{1318}+\frac{1}{1319},\]prove that $p$ is divisible with $1979$.","We first write \begin{align*} \frac{p}{q} &=1-\frac{1}{2}+\frac{1}{3}-\frac{1}{4}+\cdots-\frac{1}{1318}+\frac{1}{1319}\\ &=1+\frac{1}{2}+\cdots+\frac{1}{1319}-2\cdot\left(\frac{1}{2}+\frac{1}{4}+\cdots+\frac{1}{1318}\right)\\ &=1+\frac{1}{2}+\cdots+\frac{1}{1319}-\left(1+\frac{1}{2}+\cdots+\frac{1}{659}\right)\\ &=\frac{1}{660}+\frac{1}{661}+\cdots+\frac{1}{1319} \end{align*}Now, observe that \begin{align*} \frac{1}{660}+\frac{1}{1319}=\frac{660+1319}{660\cdot 1319}=\frac{1979}{660\cdot 1319} \end{align*}and similarly $\frac{1}{661}+\frac{1}{1318}=\frac{1979}{661\cdot 1318}$ and $\frac{1}{662}+\frac{1}{1317}=\frac{1979}{662\cdot 1317}$, and so on. We see that the original equation becomes \begin{align*} \frac{p}{q} =\frac{1979}{660\cdot 1319}+\frac{1979}{661\cdot 1318}+\cdots+\frac{1979}{989\cdot 990}=1979\cdot\frac{r}{s} \end{align*}where $s=660\cdot 661\cdots 1319$ and $r=\frac{s}{660\cdot 1319}+\frac{s}{661\cdot 1318}+\cdots+\frac{s}{989\cdot 990}$ are two integers. Finally consider $p=1979\cdot\frac{qr}{s}$, and observe that $s\nmid 1979$ because $1979$ is a prime, it follows that $\frac{qr}{s}\in\mathbb{Z}$. Hence we deduce that $p$ is divisible with $1979$.",77,1
1979p2,"We consider a prism which has the upper and inferior basis the pentagons: $A_{1}A_{2}A_{3}A_{4}A_{5}$ and $B_{1}B_{2}B_{3}B_{4}B_{5}$. Each of the sides of the two pentagons and the segments $A_{i}B_{j}$ with $i,j=1,\ldots$,5 is colored in red or blue. In every triangle which has all sides colored there exists one red side and one blue side. Prove that all the 10 sides of the two basis are colored in the same color.","Let us prove first that the edges $A_1A_2,A_2A_3,\cdots ,A_5A_1$ are of the same color. Assume the contrary, and let w.l.o.g. $A_1A_2$ be red and $A_2A_3$ be green. Three of the segments $A_2B_l, (l = 1, 2, 3, 4, 5)$, say $A_2B_i,A_2B_j,A_2B_k$,have to be of the same color, let it w.l.o.g. be red. Then $A_1B_i,A_1B_j,A_1B_k$ must be green. At least one of the sides of triangle $B_iB_jB_k$, say $B_iB_j$ ,must be an edge of the prism. Then looking at the triangles $A_1B_iB_j$ and $A_2B_iB_j$ we deduce that $B_iB_j$ can be neither green nor red, which is acontradiction. Hence all five edges of the pentagon $A_1A_2A_3A_4A_5$ have thesame color. Similarly, all five edges of $B_1B_2B_3B_4B_5$ have the same color.We now show that the two colors are the same. Assume otherwise, i.e.,that w.l.o.g. the $A$ edges are painted red and the $B$ edges green. Let us call segments of the form $A_iB_j$ diagonal ($i$ and $j$ may be equal). We now count the diagonal segments by grouping the red segments based on their $A$ point, and the green segments based on their $B$ point. As above, the assumption that three of $A_iB_j$ for fixed $i$ are red leads to a contradiction. Hence at most two diagonal segments out of each $A_i$ may be red, which counts up to at most $10$ red segments. Similarly, at most $10$ diagonal segments can be green. But then we can paint at most $20$ diagonal segments out of $25$, which is a contradiction. Hence all edges in the pentagons $A_1A_2A_3A_4A_5$ and $B_1B_2B_3B_4B_5$ have the same color.",259,3
1979p3,"Two circles in a plane intersect. $A$ is one of the points of intersection. Starting simultaneously from $A$ two points move with constant speed, each travelling along its own circle in the same sense. The two points return to $A$ simultaneously after one revolution. Prove that there is a fixed point $P$ in the plane such that the two points are always equidistant from $P.$","Let $O_1, O_2$ be the centers of the 2 circles and let the points B, C move on the circles $(O_1), (O_2)$, recpectively. Let A' be the other intersection of the 2 circles different from the point A. Since the angles $\angle BO_1A = \angle CO_2A$ are equal, the isosceles triangles $\triangle AO_1B \sim \triangle AO_2C$ are similar. Consequently, the angles $\angle BAO_1 = \angle CAO_2$ are equal and the angles

$\angle BAC = BAO_1 + \angle O_1AO_2 + \angle O_2AC =$

$= BAO_1 + \angle O_1AO_2 - \angle CAO_2 = \angle O_1AO_2$

are also equal. The angles $\angle A'BA = \frac{\angle A'O_1A}{2} = \angle O_2O_1A$ are equal and the angles $\angle A'CA = \frac{\angle A'O_2A}{2} = \angle O_1O_2A$ are also equal. As a result, the point A' is on the side BC of the triangle $\triangle ABC$, which is always similar to the fixed triangle $\triangle O_1AO_2$.

Lemma (Yaglom's Geometric Transformations II, pp 68-69). Assume that a figure F' (the triangle $\triangle ABC$) moves in such a way that it remains at all times similar to a fixed figure F (the triangle $\triangle O_1AO_2$) and in addition, some point of the figure F' does not move at all (the point A). If a point B of the figure F' describes a curve $\Gamma$ (the circle $(O_1)$), then any other point M of the figure F' describes a curve $\Gamma'$ similar to the curve $\Gamma$.

Consequently, the midpoint M of the segment BC decribes a circle (Q). When the points B, C, become identical with the point A, the midpoint M of BC also becomes identical with A. Hence, the circle (Q) passes through the point A. The line BC always passes through A'. Just after the start of motion counter-clockwise, the points B, C, A' follow on the line BC in this order. The points B, C both pass through the point A' one after another and just before the end of one period of motion, the points A', B, C follow on the line BC In this order. From the continuity principle, the midpoint M of BC also passes through the point A' and consequently, the circle (Q), the locus of the midpoints M, also passes through the point A'. Thus the circle (Q) belongs to the same pencil with the circles $(O_1), (O_2)$ and it is centered on their center line $O_1O_2$. Let p be the perpendicular bisector of the segment BC intersectong the circle (Q) at a point P different from the point M. The point A' and the circle (Q) passing through this point are fixed and the angle $\angle A'MP = 90^\circ$ is right. Therefore, A'P is a fixed diameter of the circle (Q), which means that the point P is also fixed. Q.E.D.

When the points B, C are both diametrally opposite to the point A on their respective circles, the segment $O_1O_2$ is the midline of the triangle $\triangle ABC$, i.e., $BC \parallel O_1O_2$, $BC \perp AA'$. The cyclic quadrilateral AA'MP inscribed in the circle (Q) is then a rectangle. Its circumcenter Q is the intersection of its diagonals AM, A'P intersecting at their midpoint and the midpoint of AM is identical with the midpoint of $O_1O_2$. Thus the fixed point P is the reflection of the intersection A' of the circles $(O_1), (O_2)$ in the midpoint Q of the segment $O_1O_2$.",560,4
1979p6,"Let $A$ and $E$ be opposite vertices of an octagon. A frog starts at vertex $A.$ From any vertex except $E$ it jumps to one of the two adjacent vertices. When it reaches $E$ it stops. Let $a_n$ be the number of distinct paths of exactly $n$ jumps ending at $E$. Prove that:\[a_{2n-1}=0, \quad a_{2n}={(2+\sqrt2)^{n-1} - (2-\sqrt2)^{n-1} \over\sqrt2}.\]","First the part $a_{2n-1}=0$ It's pretty obvious. Let's make a sequence $b$ of 1 and -1, setting 1 when the frog jumps left and -1 when it jumps right. If the frog would want to come to vertex E from vertex A, then $\sum b_{i}$ from $i =1$ to $i =2n-1$ should be equal to either 4 or -4. But this sum is odd, so we have $a_{2n-1}= 0$

Now the less obvious part. Let's name $f(X,y)$ the number of ways, in which we can come to vertex X in y moves.

Then $f(E,2n) = f(F,2n-1)+f(D, 2n-1) = f(C, 2n-2)+f(G, 2n-2) =$ $f(D, 2n-3)+f(B, 2n-3)+f(F, 2n-3)+f(H, 2n-3) =$ $2f(D, 2n-5)+2f(F, 2n-5)+4f(H,2n-5)+4f(B, 2n-5) =$ $4[ f(B,2n-5)+f(D, 2n-5)+f(F,2n-5)+f(H, 2n-5) ]-2 [ f(F,2n-5)+f(D,2n-5)] =$ $4f(E,2n-2)-2f(E,2n-4)$

Now we can find a solution to this recurrence or simply prove by induction the given answer.",139,2
1978p4,"n a triangle $ABC$ we have $AB = AC.$ A circle which is internally tangent with the circumscribed circle of the triangle is also tangent to the sides $AB, AC$ in the points $P,$ respectively $Q.$ Prove that the midpoint of $PQ$ is the center of the inscribed circle of the triangle $ABC.$","Denote $a = BC, b = AB = AC$ the triangle sides, $r, R$ the triangle inradius and circumradius and $s$, $\triangle$ the triangle semiperimeter and area. Let $S, T$ be the tangency points of the incircle (I) with the sides $AB, AC$. Let $K, L$ be the midpoints of of $BC, PQ$ and $M$ the midpoint of the arc $BC$ of the circumcircle (O) opposite to the vertex $A$. The isosceles triangles $\triangle AST \sim \triangle APQ \sim \triangle ABC$ are all centrally similar with the homothety center $a$. The homothety coefficient for the triangles $\triangle AST \sim \triangle ABC$ is $h_{13} = \frac{AS}{AB} = \frac{s - a}{b}$. The homothety coefficient for the triangles $\triangle AST \sim \triangle APQ$ is $h_{12} = \frac{AS}{AP}$. The point K is the tangency point of the incircle (I) with the side BC, while the point M is the tangency point of the given circle with the triangle circumcircle (O). It follows that the triangles $\triangle ASK \sim \triangle APM$ are also centrally similar with the homothety center A and the same homothety coefficient as the triangles $\triangle AST \sim \triangle APQ$: $h_{12} = \frac{AS}{AP} = \frac{AK}{AM} = \frac{h}{2R}$, where h = AK is the A-altitude of the triangle $\triangle ABC$. The homothety coefficient of the triangles $\triangle APQ \sim \triangle ABC$ is then $h_{23} = \frac{h_{12}}{h_{13}} = \frac{s - a}{b} \cdot \frac{2R}{h}$ Denote $h' = AL$ the $A$-altitude of the triangle $\triangle APQ$. Then

$\frac{h'}{h} = h_{23} = \frac{s - a}{b} \cdot \frac{2R}{h}$

$KL = h - h' = h - 2R\ \frac{s - a}{b}$

Substituting $h = \frac{2 \triangle}{a}$, $2R = \frac{ab^2}{2 \triangle}$ and $s - a = \frac{\triangle^2}{s(s - b)^2}$, we get

$KL = \frac{2 \triangle}{a} - \frac{ab^2}{2 \triangle} \cdot \frac{\triangle^2}{bs(s - b)^2} =$

(substituting 2s = 2b + a and $s - b = \frac a 2$ for an isosceles triangle)

$= \frac{\triangle}{s}\left(\frac{2s}{a} - \frac{ab}{2(s - b)^2}\right) = \frac{\triangle}{s} \left(\frac{2b}{a} + 1 - \frac{2b}{a}\right) = \frac{\triangle}{s} = r$

which means that the point $L \equiv I$ is identical with the incenter of the triangle $\triangle ABC$.",346,3
1978p5,"Let $f$ be an injective function from ${1,2,3,\ldots}$ in itself. Prove that for any $n$ we have: $\sum_{k=1}^{n} f(k)k^{-2} \geq \sum_{k=1}^{n} k^{-1}.$","We know that all the unknowns are integers, so the smallest one must greater or equal to 1.

Let me denote the permutations of $(k_1,k_2,...,k_n)$ with $(y_1,y_2,...,y_n)=y_i (*)$.

From the rearrangement's inequality we know that $\text{Random Sum} \geq \text{Reversed Sum}$.

We will denote we permutations of $y_i$ in this form $y_n \geq ...\geq y_1$.

So we have $\frac{k_1}{1^2}+\frac{k_2}{2^2}+...+\frac{k_n}{n^2} \geq \frac{y_1}{1^2}+ \frac{y_2}{2^2}+...+ \frac{y_n}{n^2} \geq 1+\frac{1}{2}+...+\frac{1}{n}$.

Let's denote $\frac{y_1}{1^2}+ \frac{y_2}{2^2}+...+ \frac{y_n}{n^2}=T$ and $1+\frac{1}{2}+...+\frac{1}{n}=S$.

We have $T \geq S$. Which comes from $y_1 \geq1, y_2 \geq2, ...,y_n \geq n$.

So we are done.",90,1
1978p6,"An international society has its members from six different countries. The list of members has 1978 names, numbered $1, 2, \ldots, 1978$. Prove that there is at least one member whose number is the sum of the numbers of two (not necessarily distinct) members from his own country.","Suppose the contrary. Then there exists a partition of $\{1,2,3,\ldots, 1978\}$ into 6 difference-free subsets $A,B,C,D,E,F$. A set S is difference-free if there are not $x,y,z \in S$ such that x = y - z.

By the Pigeonhole principle, one of these subsets, say $A$, has a minimum of $\left \lfloor \frac{1978}{6}\right \rfloor +1 = 330$ members, $a_1 < a_2 < \ldots < a_{330}$. Since $A$ is difference-free, each of the $329$ differences $a_{330} - a_1, a_{330} - a_2, \ldots, a_{330} - a_{329}$ cannot belong to $A$, and so must belong to one of $B, C, D, E, F$.

One of these subsets, say $B$, has a minimum of $\left \lfloor \frac{329}{5}\right \rfloor +1 = 66$ members, $b_1 < b_2 < \ldots < b_{66}$. Since $A$ and $B$ are difference-free, each of the $65$ differences $b_{66} - b_1, b_{66} - b_2, \ldots, b_{66} - b_{65}$ cannot belong to one of $A, B$, and so must belong to one of $C, D, E, F$.

One of these subsets, say $C$, has a minimum of $\left \lfloor \frac{65}{4}\right \rfloor +1 = 17$ members, $c_1 < c_2 < \ldots < c_{17}$. Since $A, B, C$ are difference-free, each of the $16$ differences $c_{17} - c_1, c_{17} - c_2, \ldots, c_{17} - c_{16}$ cannot belong to one of $A, B, C$, and so must belong to one of $D, E, F$.

One of these subsets, say $D$, has a minimum of $\left \lfloor \frac{16}{3}\right \rfloor +1 = 6$ members, $d_1 < d_2 < \ldots < d_6$. Since $A, B, C, D$ are difference-free, each of the $5$ differences $d_6 - d_1, d_6 - d_2, \ldots, d_6 - d_5$ cannot belong to one of $A, B, C, D$, and so must belong to one of $E, F$.

One of these subsets, say $E$, has a minimum of $\left \lfloor \frac{5}{2}\right \rfloor +1 = 3$ members, $e_1 < e_2 < e_3$. Since $A, B, C, D, E$ are difference-free, each of the $2$ differences $e_3 - e_1, e_3 - e_2$ cannot belong to one of $A, B, C, D, E$, and so must belong to $F$.

Then $F$ has at least two members, $f_1 < f_2$. The difference $g = f_2 - f_1$ cannot belong to one of $A, B, C, D, E, F$, a contradiction! ",380,3
1977p1,"In the interior of a square $ABCD$ we construct the equilateral triangles $ABK, BCL, CDM, DAN.$ Prove that the midpoints of the four segments $KL, LM, MN, NK$ and the midpoints of the eight segments $AK, BK, BL, CL, CM, DM, DN, AN$ are the 12 vertices of a regular dodecagon.","Just use complex numbers, with $a = 1$, $b = i$, $c = - 1$ and $d = - i$. With some calculations, we have $k = \frac {\sqrt {3} - 1}{2}( - 1 - i)$, $l = \frac {\sqrt {3} - 1}{2}(1 - i)$, $m = \frac {\sqrt {3} - 1}{2}(1 + i)$ and $n = \frac {\sqrt {3} - 1}{2}( - 1 + i)$. Now it's an easy job to calculate the twelve midpoints and to find out they are all of the form $\frac {\sqrt {3} - 1}{2}e^{\frac {k\pi}{6}i}$, with $k\in\mathbb{N}: 0\le k\le 11$, and the result follows.",101,2
1977p3,"Let $n$ be a given number greater than 2. We consider the set $V_n$ of all the integers of the form $1 + kn$ with $k = 1, 2, \ldots$ A number $m$ from $V_n$ is called indecomposable in $V_n$ if there are not two numbers $p$ and $q$ from $V_n$ so that $m = pq.$ Prove that there exist a number $r \in V_n$ that can be expressed as the product of elements indecomposable in $V_n$ in more than one way. (Expressions which differ only in order of the elements of $V_n$ will be considered the same.)","Lemma: there are $\infty$ many prime numbers $p \not\equiv 1 \mod n$.

Proof:

Assume that there are only finitely many of them and let their product be $k$. Then all prime factors of $nk - 1$ must be $\equiv 1 \mod n$ since this number is coprime with $k$. But that would mean that $- 1 \equiv nk - 1 \equiv 1 \mod n$ which is impossible for $n > 2$.

Now we can tackle the problem: There are only finetely many residue classes $\mod n$, thus we can find two primes $p,q$ with $p \equiv q \not\equiv 1 \mod n$ and coprime with $n$. Let $s$ be the smallest positive integer with $p^s \equiv 1 \mod n$, then the same property holds for $q$ too. Now we have that $p^s, q^s, pq^{s - 1} , p^{s - 1}q \equiv 1 \mod n$ are all indecomposable since all their nontrivial divisors are $\not\equiv 1 \mod n$. But the product $p^sq^s = (pq^{s - 1})(p^{s - 1}q)$ gives a number that is represented in two ways.",175,2
1977p4,"Let $a,b,A,B$ be given reals. We consider the function defined by\[f(x) = 1 - a \cdot \cos(x) - b \cdot \sin(x) - A \cdot \cos(2x) - B \cdot \sin(2x).\]Prove that if for any real number $x$ we have $f(x) \geq 0$ then $a^2 + b^2 \leq 2$ and $A^2 + B^2 \leq 1.$","$f(x) = 1-\sqrt{a^2+b^2}\sin (x+\arctan\frac{a}{b}) - \sqrt{A^2+B^2}\sin (2x+\arctan\frac{A}{B}) \geq 0$. $f(x+\pi) = 1+\sqrt{a^2+b^2}\sin (x+\arctan\frac{a}{b}) - \sqrt{A^2+B^2}\sin (2x+\arctan\frac{A}{B}) \geq 0$

Therefore, $\sqrt{A^2+B^2}\sin (2x+\arctan\frac{A}{B}) \leq 1$. Since this identity is true for any real $x$, let the sine term be one, $\longrightarrow A^2+B^2 \leq 1$.

To get cancellation on the rightmost terms, note $\sin (x+\pi/2) = \cos x, \sin (x-\pi/2) = -\cos x$.

$f(x+\pi/4) = 1-\sqrt{a^2+b^2}\sin (x+\pi/4+\arctan\frac{a}{b}) - \sqrt{A^2+B^2}\cos2x+\arctan\frac{A}{B}) \geq 0$. $f(x-\pi/4) = 1-\sqrt{a^2+b^2}\sin (x-\pi/4+\arctan\frac{a}{b}) + \sqrt{A^2+B^2}\cos2x+\arctan\frac{A}{B}) \geq 0$.

Let $x+\arctan\frac{a}{b} = y$. Then $\sqrt{a^2+b^2}(\sin (y+\pi/4) + \sin (y-\pi/4)) \leq 2$ $\sqrt{a^2+b^2} \leq \dfrac{2}{\sqrt{2}(\sin y)}$. Since it's valid for all real $x$ let $\sin y = 1$, and we are done.",108,2
1977p6,"Let $f(n)$ be a function $f: \mathbb{N}^{+}\to\mathbb{N}^{+}$. Prove that if \[f(n+1) > f(f(n))\] for each positive integer $n$, then $f(n)=n$.","We will prove this via induction. First we will prove there is a $t$ such that $f(t)=1$ and then that $t=1$ is the only such solution.

Define the sequence $a_n$ with $a_0>1$ for $a_0\in \mathbb{N}$ and $a_k=f(a_{k-1}-1)$. By the given inequality we have that $f(a_n)>f(a_{n+1})$, this can be used to form a inequality chain of decreasing positive integers: \[f(a_0)>f(a_1)>f(a_2)>...\] By Infinite Descent, this sequence must terminate, and the only way it can terminate is if we input something into $f$ that is outside of its range. This can only happen if $a_n=1$ since the range and domain of $f$ are the positive integers. Since $a_0\neq 1$, there is a integer $t$ ($a_{n-1}-1$) such that $f(t)=1$.

Now if $t\neq 1$, then $f(t)=1>f(f(t-1))$, which is impossible since $f(f(t-1))\ge 1$ by the range of $f$, so we have $t=1$ is the only time when $f(t)=1$.

Now for the inductive step.

Assume that $f(n)=n$ for all $n<k$ and these are the only times these values occur. We will prove that $f(k)=k$ and that this is the only time this value occurs. Define the sequence $a_n$ similarly, except that $a_0>k$, by the reasoning above, there is a $a_m$ such that $f(a_m)=1$, by the inductive assumption, this means that $a_m=f(a_{m-1}-1)=1$, we can repeat the inductive assumption to get that $a_{m-k+1}=k$. This implies that $f(a_{m-k}-1)=k$. Thus, there is a $t$ such that $f(t)=k$.

Now for that $t$, we have $k>f(f(t-1))$, which means that $k+1>t$ by the inductive assumption which implies $t=k$ since we must have $t>k-1$, otherwise $f(t)<k$. So $t=k$ is the only time when $f(t)=k$

So the inductive step is complete. Therefore, by induction $f(n)=n$ for all positive integers $n$.",274,3
1976p2,"Let $P_{1}(x) = x^{2} - 2$ and $P_{j}(x) = P_{1}(P_{j - 1}(x))$ for $j= 2,\ldots$ Prove that for any positive integer n the roots of the equation $P_{n}(x) = x$ are all real and distinct.","I shall prove by induction that $P_n(x)$ has $2^n$ distinct real solutions, where $2^{n-1}$ are positive and $2^{n-1}$ are negative. Also, for ever root $r$, $|r|<2$.

Clearly, $P_1(x)$ has 2 real solutions, where 1 is positive and 1 is negative. The absolute values of these two solutions are also both less than 2. This proves the base case.

Now assume that for some positive integer $k$, $P_k(x)$ has $2^k$ distinct real solutions with absolute values less than 2, where $2^{k-1}$ are positive and $2^{k-1}$ are negative.

Choose a root $r$ of $P_{k+1}(x)$. Let $P_1(r)=s$, where $s$ is a real root of $P_k(x)$. We have that $-2<s<2$, so $0<r^2<4$, so $r$ is real and $|r|<2$. Therefore all of the roots of $P_{k+1}$ are real and have absolute values less than 2.

Note that the function $P_{k+1}(x)$ is an even function, since $P_1(x)$ is an even function. Therefore half of the roots of $P_{k+1}$ are positive, and half are negative.

Now assume for the sake of contradiction that $P_{k+1}(x)$ has a double root $r$. Let $P_1(r)=s$. Then there exists exactly one real number $r$ such that $r^2-2=s$. The only way that this could happen is when $s+2=0$, or $s=-2$. However, $|s|<2$ from our inductive hypothesis, so this is a contradiction. Therefore $P_{k+1}(x)$ has no double roots. This proves that that the roots of $P_{k+1}(x)$ are distinct.

This completes the inductive step, which completes the inductive proof.",234,2
1976p5,"We consider the following system with $q = 2p$:

$\begin{matrix} a_{11}x_{1} + \ldots + a_{1q}x_{q} = 0, \\ a_{21}x_{1} + \ldots + a_{2q}x_{q} = 0, \\ \ldots , \\ a_{p1}x_{1} + \ldots + a_{pq}x_{q} = 0, \\ \end{matrix}$

in which every coefficient is an element from the set $\{ - 1,0,1\}$$.$ Prove that there exists a solution $x_{1}, \ldots,x_{q}$ for the system with the properties:

a.) all $x_{j}, j = 1,\ldots,q$ are integers$;$

b.) there exists at least one j for which $x_{j} \neq 0;$

c.) $|x_{j}| \leq q$ for any $j = 1, \ldots ,q.$","First of all note that we have $(q + 1)^q - 1$ possible nonzero vectors $(x_1,\cdots,x_q)$ such that $0\leq x_i\leq q$ are integers.


But $a_{j1}x_1 + \cdots + a_{jq}x_q$ can only assume $q^2 + 1$ different values, because if it is maximized/minimized by $(M_1,M_2,\cdots,M_q)/(m_1,m_2,\cdots,m_q)$, we have that $\sum_{i = 1}^{q}a_{ji}(M_i - m_i)\leq q\times q = q^2$ (if $a_{ji} = 0$, it doesn't affect the sum, if it is $1$, $M_i = q,m_i = 0$, and if it is $- 1$, $M_i = 0,m_i = q$).


From this we conclude that there are at most $(q^2 + 1)^p = (q^2 + 1)^{q/2}$ possible values for the vector $(a_{11}x_{1} + \ldots + a_{1q}x_{q},\cdots,a_{p1}x_{1} + \ldots + a_{pq}x_{q})$. But we have that: $(q + 1)^q - 1 = (q^2 + 1 + 2q)^{q/2} - 1 =$ $= (q^2 + 1)^{q/2} + \left( - 1 + \sum_{j = 1}^{q/2}{{q/2}\choose j}(q^2 + 1)^{q/2 - j}(2q)^j\right) > (q^2 + 1)^{q/2}$

We conclude that by the pigeonhole principle there are two distinct vectors being mapped to the same vector. Taking their difference we have a vector with the desired properties.",183,2
1976p6,"A sequence $(u_{n})$ is defined by

\[u_{0} = 2 \quad u_{1} = \frac {5}{2}, u_{n + 1} = u_{n}(u_{n - 1}^{2} - 2) - u_{1} \ \text{ for } n = 1,\cdots\]

Prove that for any positive integer $n$ we have

\[\lfloor u_{n} \rfloor = 2^{\frac {(2^{n} - ( - 1)^{n})}{3}}\]

(where $\lfloor x\rfloor$ denotes the smallest integer $\leq$ $x$)$.$
","Let the sequence $(x_n)_{n \geq 0}$ be defined as \[ x_{0}=0,x_{1}=1, x_{n}=x_{n-1}+2x_{n-2} \] We notice \[x_n=\frac{2^n-(-1)^n}{3}\] Because the roots of the characteristic polynomial $x_{n}=x_{n-1}+2x_{n-2}$ are $-1$ and $2$. \newline We also see $\frac{2^1-(-1)^1}{3}=1=x_1$, $\frac{2^2-(-1)^2}{3}=1=x_2$ We want to prove \[2^{x_{n}-2x_{n-1}}+2^{-x_{n}+2x_{n-1}}=2^{x_1}+2^{-x_1}\] This is done by induction

Base Case: For $n=1$ ses det $2^{1-0}+2^{0-1}=2^{1}+2^{-1}$

Inductive step: Assume $2^{x_{n-1}-2x_{n-2}}+2^{-x_{n-1}+2x_{n-2}}=2^{x_1}+2^{-x_1}$ We notice \begin{align*}  2^{x_{n}-2x_{n-1}}+2^{-x_{n}+2x_{n-1}} &=2^{x_{n-1}+2x_{n-2}-2x_{n-1}}+2^{-(x_{n-1}+2x_{n-2})+2x_{n-1}}\\ &=2^{-x_{n-1}+2x_{n-2}}+2^{x_{n-1}-2x_{n-2}}\\ &=2^{x_1}+2^{-x_1} \end{align*} We then want to show \[a_n=2^{x_n}+2^{-x_n}\] This can be done using induction

Base Case

For $n=1$, it is clear that \[a_1=\frac{5}{2}\] and \[2^{x_1}+2^{-x_1}=2^1+2^{-1}=2+\frac{1}{2}=\frac{5}{2}\] Therefore, the base case is proved.

Inductive Step

Assume for all natural $k<n$ at $a_k=2^{x_k}+2^{-x_k}$\newline Then we have that: \begin{align*}  a_n &=  a_{n}(a_{n-1}^{2}-2)-a_{1} \\   &=  (2^{x_{n-1}}+2^{-x_{n-1}})((2^{x_{n-2}}+2^{-x_{n-2}})^2-2)-(2^{x_{1}}+2^{-x_{0}}) \\  &= (2^{x_{n-1}}+2^{-x_{n-1}})((2^{x_{n-2}})^2+(2^{-x_{n-2}})^2+2*2^{x_{n-2}}*2^{-x_{n-2}}-2)-(2^{x_{1}}+2^{-x_{0}}) \\  &=(2^{x_{n-1}}+2^{-x_{n-1}})((2^{2x_{n-2}})+(2^{-2x_{n-2}})+2*2^{x_{n-2}-x_{n-2}}-2)-(2^{x_{1}}+2^{-x_{0}}) \\  &=(2^{x_{n-1}}+2^{-x_{n-1}})((2^{2x_{n-2}})+(2^{-2x_{n-2}})+2-2)-(2^{x_{1}}+2^{-x_{0}}) \\ &=2^{x_{n-1}}*2^{2x_{n-2}}+2^{-x_{n-1}}2^{-2x_{n-2}}+2^{x_{n-1}}*2^{-2x_{n-2}}+2^{-x_{n-1}}*2^{2x_{n-2}}-2^{x_{1}}-2^{-x_{0}}\\ &=2^{x_{n-1}+2x_{n-2}}+2^{-(x_{n-1}+2x_{n-2}})+2^{x_{n-1}-2x_{n-2}}+2^{-x_{n-1}+2x_{n-2}}-2^{x_{1}}-2^{-x_{0}}\\ &=2^{x_{n}}+2^{-x_{n}}+2^{x_{n-1}-2x_{n-2}}+2^{-x_{n-1}+2x_{n-2}}-2^{x_{1}}-2^{-x_{0}} \end{align*} From our first induction proof we have that: \[2^{x_{n-1}-2x_{n-2}}+2^{-x_{n-1}+2x_{n-2}}=2^{x_1}+2^{-x_1}\] Then: \[a_n=2^{x_n}+2^{-x_n}+2^{x_1}+2^{-x_1}-(2^{x_1}+2^{-x_1})=2^{x_n}+2^{-x_n}\] We notice  $\left[a_n\right]=\left[2^{x_n}+2^{-x_n}\right]=2^{x_n}$, Because $2^{x_n} \in \mathbb{N}$ and $2^{-x_n}<1$, for all $n>0$ Finally we conclude \[\left[a_n\right]=2^{\frac{2^n-(-1)^n}{3}}\]",151,2
1975p1,"Let $x_i, y_i$ $(i=1,2,\cdots,n)$ be real numbers such that \[x_1\ge x_2\ge\cdots\ge x_n \text{ and } y_1\ge y_2\ge\cdots\ge y_n.\] Prove that, if $z_1, z_2,\cdots, z_n$ is any permutation of $y_1, y_2, \cdots, y_n,$ then \[\sum^n_{i=1}(x_i-y_i)^2\le\sum^n_{i=1}(x_i-z_i)^2.\]","We can expand and simplify the inequality a bit, and using the fact that $z$ is a permutation of $y$, we can cancel some terms. \[\sum^n_{i=1}x_i^2 + \sum^n_{i=1}y_i^2 - 2\sum^n_{i=1}x_iy_i \leq \sum^n_{i=1}x_i^2 + \sum^n_{i=1}z_i^2 - 2\sum^n_{i=1}x_iz_i\]\[\sum^n_{i=1}x_iy_i \geq \sum^n_{i=1}x_iz_i\] Consider the pairing $x_1 \rightarrow y_1$, $x_2 \rightarrow y_2$, ... $x_n \rightarrow y_n$. By switching around some of the $y$ values, we have obtained the pairing $x_1 \rightarrow z_1$, $x_2 \rightarrow z_2$, ... $x_n \rightarrow z_n$. Suppose that we switch around two $y$-values, $y_m$ and $y_n$, such that $y_m > y_n$. If $x_m > x_n$, call this a type 1 move. Otherwise, call this a type 2 move.

Type 2 moves only increase the sum of the products of the pairs. The sum is increased by $x_n \cdot y_m + x_m \cdot y_n - x_m \cdot y_m - x_n \cdot y_n$. This is equivalent to $(x_n - x_m)(y_m - y_n)$, which is clearly nonnegative since $y_m > y_n$ and $x_n > x_m$.

We will now consider switching from the $x$-$z$ pairing back to the $x$-$y$ pairing. We will prove that from any pairing of $x$ and $z$ values, you can use just type 2 moves to navigate back to the pairing of $x$ and $y$ values, which will complete the proof.

Suppose that $x_a$ is the biggest $x$-value that is not paired with its $y$-value in the $x$ and $z$ pairing. Then, switch this $y$-value with the $y$-value currently paired with $x_a$. This is obviously a type 2 move. Continue this process until you reach back to the $x$-$y$ pairing. All moves are type 2 moves, so the proof is complete.
",269,3
1975p2,"Let $a_1, a_2, a_3, \cdots$ be an infinite increasing sequence of positive integers. Prove that for every $p \geq 1$ there are infinitely many $a_m$ which can be written in the form\[a_m = xa_p + ya_q\]with $x, y$ positive integers and $q > p$.","For every $p \ge 1$ we calculate the remainder of each term of the sequence modulo $a(p)$, obtaining $a(p)$ possible remainders, namely $1, \dots , a(p)$.  
Since there are infinitely many terms but only finitely many possible remainders, one remainder must occur for infinitely many terms.  
Let this remainder be $r$ with $1 \le r \le a(p)$; call the first term having this remainder $a(q)$ and denote any subsequent such term by $a(m)$, where $m \to \infty$.  
Clearly $a(m) > a(q) \ge a(p)+1$ and $m > q > p$.

Pick any $a(m) > a(q)$. We claim it can always be written in the form
\[
a(m)=x\,a(p)+y\,a(q).
\]

Write
\[
a(q)=k_1\,a(p)+r,\qquad 
a(m)=k_2\,a(p)+r,
\]
with $k_2>k_1$. Then
\[
a(m)-a(q)=(k_2-k_1)\,a(p),
\qquad\text{so}\qquad
a(m)=(k_2-k_1)\,a(p)+1\cdot a(q).
\]
Setting $x=k_2-k_1$ and $y=1$both positive integersgives the desired representation.

Because there are infinitely many such $a(m)$, for every $p \ge 1$ there exist infinitely many $a(m)$ that can be expressed in the target form.",155,2
1975p3,"On the sides of an arbitrary triangle $ABC$, triangles $ABR, BCP, CAQ$ are constructed externally with $\angle CBP = \angle CAQ = 45^\circ, \angle BCP = \angle ACQ = 30^\circ, \angle ABR = \angle BAR = 15^\circ$. Prove that $\angle QRP = 90^\circ$ and $QR = RP$.","Consider $X$ and $Y$ so that $\triangle CQA\sim \triangle CPX$ and $\triangle CPB\sim \triangle CQY$. Furthermore, let $AX$ and $BY$ intersect at $F$. Now, this means that $\angle PBC = 45 = \angle QAC = \angle PXC$ and $\angle PCB = 15 = \angle QCA = \angle PCX$, so $\triangle BPC\cong \triangle XPC$. Thus, $XC = BC$ and $\angle BCX = 30 + 30 = 60$, so $\triangle BCX$ is equilateral. Similarly is $\triangle ACY$. Yet, it is well-known that the intersection of $BY$ and $AX$, which is $F$, must be the Fermat Point of $\triangle ABC$ if $\triangle AYC$ and $\triangle BXC$ are equilateral. Now, $\angle PBX = 60 - 45 = 15$. Similarly, $\angle PXB = 15$, so $\triangle BRA\sim \triangle BPX$, so a spiral similarity maps $\triangle BPR\sim \triangle BXA$. This implies that $\angle BRP = \angle FAB$. Similarly, $\angle ARQ = \angle FBA$, so $\angle BRP + \angle ARQ = \angle FBA + \angle FAB = 180 - \angle AFB = 60$. Then, $\angle PRQ = (180 - 15 - 15) - 60 = 90$. We also realize that $\frac {AX}{RP} = \frac {AB}{RB} = \frac {AB}{AR} = \frac {BY}{RQ}$. Now, $Y$ is a rotation of $A$ $60$ degrees around $C$ and $B$ is the same rotation of $X$ around $C$, so $AX$ maps to $YB$ from this rotation, so $AX = YB$. It follows that $RP = RQ$.",233,2
1974p2,"In the triangle $ABC$, prove that there is a point $D$ on side $AB$ such that $CD$ is the geometric mean of $AD$ and $DB$ if and only if $\sin{A}\sin{B} \leq  \sin^2 (\frac{C}{2})$.","Let a point $D$ on the side $AB$. Let $CF$ the altitude of the triangle $\triangle ABC$, and $C'$ the symmetric point of $C$ through $F$. We bring a parallel line $L$ from $C'$ to $AB$. This line intersects the ray $CD$ at the point $E$, and we know that $DE=DC$.

The distance $d(L,AB)$ between the parallel lines $L$ and $AB$ is $CF$.

Let $w = (O,R)$ the circumscribed circle of $\triangle ABC$, and $MM'$ the perpendicular diameter to $AB$, such that $M,C$ are on difererent sides of the line $AB$.

In fact, the problem asks when the line $L$ intersects the circumcircle. Indeed:

Suppose that $DC$ is the geometric mean of $DA,DB$.

$DA \cdot DB = DC^{2}\Rightarrow DA \cdot DB = DC \cdot DE$

Then, from the power of $D$ we can see that $E$ is also a point of the circle $w$. Or else, the line $L$ intersects $w \Leftrightarrow$

$d(L,AB)\leq d(M,AB) \Leftrightarrow$

$CF \leq MN,$ where $MN$ is the altitude of the isosceles $\triangle MAB$.

$\Leftrightarrow \frac{1}{2}CF \cdot AB \leq \frac{1}{2}MN \cdot AB \Leftrightarrow$ $(ABC) \leq (MAB) \Leftrightarrow$ $\frac{AB \cdot BC \cdot AC}{4R}\leq \frac{AB \cdot MA^{2}}{4R}\Leftrightarrow$

$BC \cdot AC \leq MA^{2}$

We use the formulas:

$BC = 2R \cdot \sin A$ $AC = 2R \cdot \sin B$

and $\angle CMA = \frac{C}{2}\Rightarrow MA = 2R \cdot \sin\frac{C}{2}$

So we have $(2R \cdot \sin A)(2R \cdot \sin B) \leq (2R \cdot \sin\frac{C}{2})^{2}\Leftrightarrow$ $\sin A \cdot \sin B \leq \sin^{2}\frac{C}{2}$





For $(\Leftarrow)$

Suppose that $\sin A \cdot \sin B \leq \sin^{2}\frac{C}{2}$

Then we can go inversely and we find that $d(L,AB)\leq d(M,AB) \Leftrightarrow$ the line $L$ intersects the circle $w$ (without loss of generality; if $d(L,AB)=d(M,AB)$ then $L$ is tangent to $w$ at $M$)

So, if $E \in L \cap w$ then for the point $D = CE \cap AB$ we have $DC=DE$ and $AD \cdot AB = CD \cdot DE \Rightarrow$

$AD \cdot AB = CD^{2}$",318,3
1974p3,Prove that the number $\sum^n_{k=0}\binom{2n+1}{2k+1}2^{3k}$ is not divisible by $5$ for any integer $n\ge0.$,"Everything that follows takes place in $\mathbb F_5(\sqrt 2)$, i.e. the field we get by adjoining a root of $x^2-2=0$ to $\mathbb F_5$, the field with $5$ elements.

We have $\sum_{k=0}^n\binom{2n+1}{2k+1}2^{3k}=\sum_{k=0}^n\binom{2n+1}{2n-2k}3^k=\sum_{k=0}^n\binom{2n+1}{2(n-k)}2^{-k}$. Now, this is zero iff it's zero when we multiply it by $2^n$, so we may as well prove that $\sum_{k=0}^n\binom{2n+1}{2(n-k)}\sqrt 2^{2(n-k)}\ne 0$. The LHS is $\alpha$ from $(1+\sqrt 2)^{2n+1}=\alpha+\beta\sqrt 2,\ \alpha,\beta\in\mathbb F_5$. We have $(1-\sqrt 2)^{2n+1}=\alpha-\beta\sqrt 2$, so by multiplying them we get $-1=\alpha^2-2\beta^2$. If we were to have $\alpha=0$, then we would get $1=2\beta^2,\ \beta\in\mathbb F_5$, and this is impossible, since it would make $3=2^{-1}$ a square $\beta^2$ in $\mathbb F_5$ (i.e. $3$ would be a quadratic residue modulo $5$, and it's not).
",116,2
1974p6,"Let $P$ be a non-constant polynomial with integer coefficients. If $n(P)$ is the number of distinct integers $k$ such that $(P(k))^2=1,$ prove that $n(P)-\deg(P)\le2,$ where $\deg(P)$ denotes the degree of the polynomial $P.$","Lemma: Let $P(x)$ be a polynomial with integer coefficients which is not constant. Then if $P(x)$ obtains $1$ (or $-1$) as its values for at least four times then $P(x)\neq -1$ ( or $P(x)\neq 1$) for all $x$. Proof. Assume that $P(a)=P(b)=P(c)=P(d)=1$ for $a,b,c,d$ distince. Then if there's $u$ which $P(u)=-1$ then $2=P(a)-P(u)=...$ so $P(x)-P(u)-2=(x-a)(x-b)(x-c)(x-d)Q(x)$ where $Q(x)$ is a polynomial with the integer coefficients! So $-2=(u-a)(u-b)(u-c)(u-d)Q(u)$ which is impossible cause $-2$ can not presents as product of more than three distince numbers! This proved the lemma!

Back to our problem: For convinet put $m=n(P)$ and $n=\deg P$. Firstly if $n\leq 2$ then $m-n\leq2$. Assume $n\geq3$. If equation $P(x)=1$ with more than three integer points (ie.. at least $4$) then equation $(P(x))^2=1$ implies $P(x)=1$ so $m\leq n$, ie... $m-n\leq 0\leq2$. The same case for equation $P(x)=-1$. So $m\leq 6$. If $n\geq4$ then $m-n\leq 6-n\leq 2$. Now assume that $n=3$. In this case if $m\leq 5$ then $m-n\leq 2$.

So let us show that $m<6$. In fact if $m=6$ then $P(x)-1=0$ has three integers distince roots, and the same for $P(x)+1=0$. So $P(x)-1=k_1(x-a_1)(x-a_2)(x-a_3)$ and $P(x)+1=k_2(x-b_1)(x-b_2)(x-b_3)$ where $a_i$ distince and $b_j$ distince and all with $k_1,k_2$ are integers! Then $k_2(x-b_1)(x-b_2)(x-b_3)-k_1(x-a_1)(x-a_2)(x-a_3)=2$ for all $x$. So $k_1=k_2=k$. Finally, we have $2=k(a_i-b_1)(a_i-b_2)(a_i-b_3)$ for $i=1,2,3$ and because that $\pm1$ can not presents as products of three distince numbers so $k=\pm1$, we may assume $k=1$. Because $2=(-2)\cdot 1\cdot -1$ so $\{-2,1,-1\}=\{a_i-b_1,a_i-b_2,a_i-b_3\}$ This means $3a_i-(b_1+b_2+b_3)=-2+1-1=-2$. So we must have $3a_1=3a_2=3a_3$ which follows $a_1=a_2=a_3$, which contracts!. So $m\leq 5$ and we're done.",252,3
1973p1,"Point $O$ lies on line $g;$ $\overrightarrow{OP_1}, \overrightarrow{OP_2},\cdots, \overrightarrow{OP_n}$ are unit vectors such that points $P_1, P_2, \cdots, P_n$ all lie in a plane containing $g$ and on one side of $g.$ Prove that if $n$ is odd, \[\left|\overrightarrow{OP_1}+\overrightarrow{OP_2}+\cdots+ \overrightarrow{OP_n}\right|\ge1.\] Here $\left|\overrightarrow{OM}\right|$ denotes the length of vector $\overrightarrow{OM}.$","We prove it by induction on the number $2n+1$ of vectors. The base step (when we have one vector) is clear, and for the induction step we use the hypothesis for the $2n-1$ vectors obtained by disregarding the outermost two vectors. We thus get a vector with norm $\ge 1$ betwen two with norm $1$. The sum of the two vectors of norm $1$ makes an angle of $\le\frac\pi 2$ with the vector of norm $\ge 1$, so their sum has norm $\ge 1$, and we're done.",87,1
1973p5,"$G$ is a set of non-constant functions of the real variable $x$ of the form \[f(x) = ax + b, a \text{ and } b \text{ are real numbers,}\] and $G$ has the following properties:

(a) If $f$ and $g$ are in $G$, then $g \circ f$ is in $G$; here $(g \circ f)(x) = g[f(x)]$.

(b) If $f$ is in $G$, then its inverse $f^{-1}$ is in $G$; here the inverse of $f(x) = ax + b$ is $f^{-1}(x) = (x - b) / a$.

(c) For every $f$ in $G$, there exists a real number $x_f$ such that $f(x_f) = x_f$.

Prove that there exists a real number $k$ such that $f(k) = k$ for all $f$ in $G$.","First, observe that for each function $f(x)=ax+b$ in $G$, if $a=1$ then $b=0$. This is a result of (c); for example, $f(x)=x+1$ could not be in $G$ because it does not have a fixed point. Or if $f(x)=x$, then every point is a fixed point.

Also, for each function $f(x)=ax+b$ in $G$, if $a \neq 1$ then the fixed point of $f$ is where $y=ax+b$ intersects $y=x$, namely where $x=\frac{b}{a-1}$.

Now, take $f_1(x)=a_1 x+b_1$ and $f_2(x)=a_2 x+b_2$, both in $G$. By (a), $(f_1 \circ f_2)(x)=f_1(f_2(x))=f_1(a_2 x+b_2)=a_1 a_2 x + a_1 b_2 + b_1$ and $(f_2 \circ f_1)(x)=f_2(f_1(x))=f_2(a_1 x+b_1)=a_1 a_2 x + a_2 b_1 + b_2$ must also both be in $G$. By (b), $(f_1 \circ f_2)^{-1}(x)=\frac{x - a_1 b_2 - b_1}{a_1 a_2}$ must also be in $G$. Finally, by (a),

$((f_1 \circ f_2)^{-1} \circ (f_2 \circ f_1))(x)=\frac{a_1 a_2 x + a_2 b_1 + b_2 - a_1 b_2 - b_1}{a_1 a_2}$ $= x + \frac{a_2 b_1 + b_2 - a_1 b_2 - b_1}{a_1 a_2}$

must also be in $G$.

Using our first observation, $\frac{a_2 b_1 + b_2 - a_1 b_2 - b_1}{a_1 a_2}=0$. Rearranging, we get $\frac{b_1}{a_1-1}=\frac{b_2}{a_2-1}$. Therefore, the fixed point of $f_1$ equals the fixed point of $f_2$. Since we made no assumptions about $f_1$ and $f_2$, this is true for all $f$ in $G$.",215,2
1972p1,"Prove that from a set of ten distinct two-digit numbers (in the decimal system), it is possible to select two disjoint subsets whose members have the same sum.","There are $2^{10}-2=1022$ distinct subsets of our set of 10 two-digit numbers. The sum of the elements of any subset of our set of 10 two-digit numbers must be between $10$ and $90+91+92+93+94+95+96+97+98+99 < 10 \cdot 100 = 1000$. (There are fewer attainable sums.) As $1000 < 1022$, the Pigeonhole Principle implies there are two distinct subsets whose members have the same sum. Let these sets be $A$ and $B$. Now, let $A' = A - (A \cap B)$ and $B' = B - (A \cap B)$. Notice $A'$ and $B'$ are disjoint. They are also nonempty because if $A = A \cap B$ or $B = A \cap B$, then one of $A$ and $B$ is a subset of the other, so they are either not distinct or have different sums. Therefore $A'$ and $B'$ are disjoint subsets our set of 10 distinct two-digit numbers, which proves the claim. $\square$",151,2
1972p2,"Prove that if $n \geq 4$, every quadrilateral that can be inscribed in a circle can be dissected into $n$ quadrilaterals each of which is inscribable in a circle.","First, let us remember that a quadrilateral $ABCD$ is inscribable if and only if a pair of opposing angles adds up to $\pi,$ in other words $\angle A + \angle C = \pi,$ or equivalently, $\angle B + \angle D = \pi$. In particular, any isosceles trapezoid is inscribable.

Let us assume that $\angle A$ is less or equal than all the other angles. We can assume this because otherwise, we would just need to re-label the vertices.

Choose a point $P$ inside $ABCD$, and draw the parallel $PH$ to $AB$, with $H \in DA$. There will be restrictions on the position of $P$, which we will discuss as we do the construction.

Choose $E \in AB$ so that $AEPH$ is an isosceles trapezoid. In order for this to be possible, $P$ has to be inside the angle $\angle ABB_1$ formed by drawing the line $BB_1$ such that $\angle ABB_1 = \angle A$.

Next, choose $F \in BC$ so that $\angle PFB = \angle A$. This will ensure that $EBFP$ is inscribable because $\angle PEB = \pi - \angle A$. In order for $F$ to exist in $BC$, $P$ has to be inside the angle $BCC_1$ formed by drawing the line $CC_1$ such that $\angle BCC_1 = \angle A$.

Next choose $G \in CD$ such that $PG \parallel BC$. This will ensure that $PFCG$ is an isosceles trapezoid because $\angle PFC = \pi - \angle A = \angle C$. In order for $G$ to exist in $CD$, $P$ has to be inside the angle $\angle CDD_1$ formed by drawing the line $DD_1$ such that $\angle CDD_1 = \angle A$.

With these choices, it is easy to see that $GDHP$ is inscribable. Indeed, $\angle PHD = \angle A$, and $\angle DGP = \pi - \angle CGP = \angle C = \pi - \angle A$.

We now just have to show that the intersection of the interiors of angles $\angle ABB_1, \angle BCC_1, \angle CDD_1$ is not $\O$. This follows immediately from noticing that $DD_1 \parallel BC$.

We now proceed by induction on $n$. For $n = 4$ we dissected the inscribable quadrilateral $ABCD$ in two inscribable rectangles, and $2 = 4 - 2$ isosceles trapezoids. Assume we dissected the inscribable quadrilateral $ABCD$ in two inscribable rectangles, and $k - 2$ isosceles trapezoids. Then we dissect one of the isosceles trapezoids in two isosceles trapezoids by a line parallel to the bases, thus obtaining the statement for $k + 1$.",408,3
1972p3,Let $m$ and $n$ be arbitrary non-negative integers. Prove that \[\frac{(2m)!(2n)!}{m!n!(m+n)!}\] is an integer. ($0! = 1$.),"This solution uses the fact that ${n \choose k} = \frac{n!}{k!(n - k)!}, k = 0, \dots n$ are the coefficients of the powers of $x$ in the expansion of $(1 + x)^n$ (see Binomial Theorem or https://en.wikipedia.org/wiki/Binomial_coefficient). Of course these coefficients, hence these expressions in $n, k$ are integers.

Without loss of generality, we can assume $m \le n$. We will use the identity

$S(m, n) = \frac{(2m)!(2n)!}{m!n!(m+n)!} = (-1)^m \sum_{k=0}^{k=2m} (-1)^k {2m \choose k} {2n \choose m + n - k}$.

This identity is attributed to K. von Szily (1894). Note that we could take the sum over all integers, using the convention that ${n \choose k} = 0$ when $k < 0$ or $k > n$.

The fact that $S(m, n)$ is integer follows immediately from this identity because the right hand side is integer.

Thus, we just need to prove this identity.

Start with $(1 - x^2)^{m + n} = (1 + x)^{m + n} (1 - x)^{m + n}$. Expand both sides and look at the coefficient of $x^{2m}$ in both expansions. Equate the two expressions giving the coefficient of $x^{2m}$ in the two sides. We get

$(-1)^m {m + n \choose m} = \sum_{k=0}^{2m} {m + n \choose k} \cdot (-1)^{2m - k} {m + n \choose 2m - k}$.

Write out the binomial coefficients in terms of factorials, and multiply both sides by $(-1)^m \frac{(2m)!(2n)!}{[(m + n)!]^2}$. We get

$\frac{(m + n)!}{m!n!} \cdot \frac{(2m)!(2n)!}{[(m + n)!]^2} = (-1)^m \sum_{k=0}^{2m} (-1)^k \frac{(m + n)!}{k!(m + n - k)!} \cdot \frac{(m + n)!}{(2m - k)!(n - m + k)!} \cdot \frac{(2m)!(2n)!}{[(m + n)!]^2}$

Simplifying and rearranging factors, we get

$\frac{(2m)!(2n)!}{m!n!(m + n)!} = (-1)^m \sum_{k=0}^{2m} (-1)^k \frac{(2m)!}{k!(2m - k)!} \cdot \frac{(2n)!}{(n + m - k)!(n - m + k)!} = (-1)^m \sum_{k=0}^{2m} (-1)^k {2m \choose k} {2n \choose n + m - k}$

This finishes the problem.",312,3
1972p5,"Let $f$ and $g$ be real-valued functions defined for all real values of $x$ and $y$, and satisfying the equation \[f(x + y) + f(x - y) = 2f(x)g(y)\] for all $x, y$. Prove that if $f(x)$ is not identically zero, and if $|f(x)| \leq 1$ for all $x$, then $|g(y)| \leq 1$ for all $y$.","Let $u>0$ be the least upper bound for $|f(x)|$ for all $x$. So, $|f(x)| \leq u$ for all $x$. Then, for all $x,y$,

$2u \geq |f(x+y)+f(x-y)| = |2f(x)g(y)|=2|f(x)||g(y)|$

Therefore, $u \geq |f(x)||g(y)|$, so $|f(x)| \leq u/|g(y)|$.

Since $u$ is the least upper bound for $|f(x)|$, $u/|g(y)| \geq u$. Therefore, $|g(y)| \leq 1$.",52,1
1972p6,"Given four distinct parallel planes, prove that there exists a regular tetrahedron with a vertex on each plane.","Let's denote the (directed) distance between two parallel planes p and p' by d (p; p'), and the (directed) distance between two parallel lines g and g' by d (g; g'). (Directed distances are defined as follows: If $p_1$, $p_2$, $p_3$, ... is a family of parallel planes in space, then we choose a unit vector $\overrightarrow{v}_p$ perpendicular to all of these planes (there are two such unit vectors, and we have to choose one of them), and then, by the directed distance between two of these planes $p_i$ and $p_j$, we denote the real number k such that the translation with translation vector $k\cdot\overrightarrow{v}_p$ maps the plane $p_i$ to the plane $p_j$. Similarly, we define the directed distance between two of a family of parallel lines in a plane.)

The problem can be rewritten as follows: Given four distinct parallel planes $p_1$, $p_2$, $p_3$, $p_4$ in space, prove that there exists a regular tetrahedron XYZW such that $X\in p_1$, $Y\in p_2$, $Z\in p_3$, $W\in p_4$.

In order to do this, it is enough to find a regular tetrahedron ABCD somewhere in space and four parallel planes $q_1$, $q_2$, $q_3$, $q_4$ such that $A\in q_1$, $B\in q_2$, $C\in q_3$, $D\in q_4$ and $d\left(q_1;\;q_2\right): d\left(q_2;\;q_3\right): d\left(q_3;\;q_4\right)=d\left(p_1;\;p_2\right): d\left(p_2;\;p_3\right): d\left(p_3;\;p_4\right)$. In fact, once we have found such a tetrahedron ABCD and such planes $q_1$, $q_2$, $q_3$, $q_4$, then, because of $p_1\parallel p_2\parallel p_3\parallel p_4$, $q_1\parallel q_2\parallel q_3\parallel q_4$ and $d\left(q_1;\;q_2\right): d\left(q_2;\;q_3\right): d\left(q_3;\;q_4\right)=d\left(p_1;\;p_2\right): d\left(p_2;\;p_3\right): d\left(p_3;\;p_4\right)$, there exists a similitude transformation which maps the planes $q_1$, $q_2$, $q_3$, $q_4$ to the planes $p_1$, $p_2$, $p_3$, $p_4$; this similitude transformation will then obviously map the regular tetrahedron ABCD with $A\in q_1$, $B\in q_2$, $C\in q_3$, $D\in q_4$ to a regular tetrahedron XYZW with $X\in p_1$, $Y\in p_2$, $Z\in p_3$, $W\in p_4$; hence, the existence of such a tetrahedron XYZW will be proven, and the problem will be solved.

So consider a regular tetrahedron ABCD lying arbitrarily in space; we try to find four parallel planes $q_1$, $q_2$, $q_3$, $q_4$ such that $A\in q_1$, $B\in q_2$, $C\in q_3$, $D\in q_4$ and $d\left(q_1;\;q_2\right): d\left(q_2;\;q_3\right): d\left(q_3;\;q_4\right)=d\left(p_1;\;p_2\right): d\left(p_2;\;p_3\right): d\left(p_3;\;p_4\right)$.

In fact, we start working in the plane ABC. Let T be the point on the line AC such that $AT: TC=d\left(p_1;\;p_2\right): d\left(p_2;\;p_3\right)$ (where the segments AT and TC are directed). Let $g_2$ be the line BT, and let $g_1$ and $g_3$ be the parallels to the line $g_2=BT$ through the points A and C, respectively. Then, the lines $g_1$, $g_2$, $g_3$ are parallel and, by Thales, $d\left(g_1;\;g_2\right): d\left(g_2;\;g_3\right)=AT: TC$. Thus, $d\left(g_1;\;g_2\right): d\left(g_2;\;g_3\right)=d\left(p_1;\;p_2\right): d\left(p_2;\;p_3\right)$. Now, denote by $g_4$ the line in the plane ABC which is parallel to the lines $g_1$, $g_2$, $g_3$ and satisfies $d\left(g_1;\;g_2\right): d\left(g_2;\;g_3\right): d\left(g_3;\;g_4\right)=d\left(p_1;\;p_2\right): d\left(p_2;\;p_3\right): d\left(p_3;\;p_4\right)$.

Now, let $q_4$ be the plane passing through the line $g_4$ and the point D. Let $q_1$, $q_2$, $q_3$ be the planes parallel to $q_4$ and passing through the lines $g_1$, $g_2$, $g_3$, respectively (of course, we can construct such planes since the lines $g_1$, $g_2$, $g_3$ are parallel to $g_4$). Thus, we have found four parallel planes $q_1$, $q_2$, $q_3$, $q_4$ such that $A\in q_1$, $B\in q_2$, $C\in q_3$, $D\in q_4$, and these planes obviously satisfy $d\left(q_1;\;q_2\right): d\left(q_2;\;q_3\right): d\left(q_3;\;q_4\right)=d\left(g_1;\;g_2\right): d\left(g_2;\;g_3\right): d\left(g_3;\;g_4\right)$. Since $d\left(g_1;\;g_2\right): d\left(g_2;\;g_3\right): d\left(g_3;\;g_4\right)=d\left(p_1;\;p_2\right): d\left(p_2;\;p_3\right): d\left(p_3;\;p_4\right)$, we thus have $d\left(q_1;\;q_2\right): d\left(q_2;\;q_3\right): d\left(q_3;\;q_4\right)=d\left(p_1;\;p_2\right): d\left(p_2;\;p_3\right): d\left(p_3;\;p_4\right)$. Hence, according to the above, the problem is solved.",554,4
1971p1,"Prove that the following assertion is true for $n=3$ and $n=5$, and that it is false for every other natural number $n>2:$

If $a_1, a_2,\cdots, a_n$ are arbitrary real numbers, then $(a_1-a_2)(a_1-a_3)\cdots (a_1-a_n)+(a_2-a_1)(a_2-a_3)\cdots (a_2-a_n)+\cdots+(a_n-a_1)(a_n-a_2)\cdots (a_n-a_{n-1})\ge 0.$
","Let us note that the assumptions $a_1 \ge a_2 \ge a_3$ in case $n = 3$ and $a_1 \ge a_2 \ge a_3 \ge a_4 \ge a_5$ in case $n = 5$ are perfectly legitimate. A different ordering of these numbers could be reduced to this case by a simple change of notation: we would substitute $a_i$ by $b_j$ with the indexes for the $b$'s chosen in such a way that the inequalities above are true for the $b$'s.

The inequality $(a_1 - a_2)[(a_1 - a_3)(a_1 - a_4)(a_1 - a_5) - (a_2 - a_3)(a_2 - a_4)(a_2 - a_5)] \ge 0$ is true because $a_1 - a_2 \ge 0$, and $(a_1 - a_3)(a_1 - a_4)(a_1 - a_5) - (a_2 - a_3)(a_2 - a_4)(a_2 - a_5) \ge 0$. To see this latter inequality, just notice that $a_1 - a_3 \ge a_2 - a_3$, and similarly for the other pairs of factors. The difference of the products is $\ge 0$ as desired.

The argument for the sum of the last two terms in $E_5$ is similar.

The case $n = 3$ is very easy to prove in a different way. Note that

$(a_1 - a_2)(a_1 - a_3) + (a_2 - a_1)(a_2 - a_3) + (a_3 - a_1)(a_3 - a_2) = \frac{1}{2}[(a_1 - a_2)^2 + (a_2 - a_3)^2 + (a_3 - a_1)^2]$

I could not find an identity which would give such a simple proof in the case $n = 5$.

By looking at the proof above, we can also see that for $n = 3$ we have equality if and only if $a_1 = a_2 = a_3$. For $n = 5$, assuming that $a_1 \ge a_2 \ge a_3 \ge a_4 \ge a_5$, we have equality if and only if $a_1 = a_2$ and $a_3 = a_4 = a_5$, or $a_1 = a_2 = a_3$ and $a_4 = a_5$.

If we denote $P(x) = (x - a_1) \cdots (x - a_n)$, then the expression in the problem is $E_n = P'(a_1) + \cdots + P'(a_n)$, where $P'(x)$ is the derivative of $P(x)$. (This is easy to see by calculating $P'(x)$ when $P(x)$ is written as a product rather than as a sum of powers of $x$.)

The graph of $P(x)$ as $x$ goes from $-\infty$ to $\infty$ crosses the $x$-axis, or is tangent to the $x$-axis at every root $a_k$. If the graph is tangent to the $x$-axis, it crosses it, or it stays in the same half plane, depending on the multiplicity of the root. At a simple root $a_k, P'(a_k) > 0$ or $P'(a_k) < 0$ depending on the direction of the graph of $P(x)$ at $a_k$. At a multiple root $a_k = \cdots = a_{k+p}, P'(a_k) = 0$, and the graph of $P(x)$ crosses the $x$-axis or not, depending on $p$ being odd or even.

This way of looking at the problem makes it very easy to find examples which prove the problem for $n$ even, or $n \ge 7$ and odd, because we would be looking for polynomials whose graph crosses the $x$-axis once from the upper half plane to the lower half plane at a simple root $a_k$ (thus making $P'(a_k) < 0$), and is tangent to the $x$-axis at all the other roots. See the picture below for images showing the graphs of such polynomials.",546,4
1971p2,"Consider a convex polyhedron $P_1$ with nine vertices $A_1, A_2, \cdots, A_9;$ let $P_i$ be the polyhedron obtained from $P_1$ by a translation that moves vertex $A_1$ to $A_i(i=2,3,\cdots, 9).$ Prove that at least two of the polyhedra $P_1, P_2,\cdots, P_9$ have an interior point in common.","WLOG let $A_1$ be the origin $0$. Take any point $A_i$, then $P_i=A_i+P_1$, lies in $2 P_1$, the polyhedron $P_1$ stretched by the factor $2$ on $P_1=0$. More general: take any $p,q$ in any convex shape $S$. Then $p+q \in 2S$. Prove: since $S$ is convex, $\frac{p+q}{2} \in S$, thus $p+q \in 2S$.

Now all these nine polyhedrons lie inside $2 P_1$. Let $V$ be the volume of $P_1$. Then some polyhedrons with total sum of volumes $9V$ lie in a shape of volume $8V$, thus they must overlap, meaning that they have an interior point in common.",98,1
1971p3,Prove that the set of integers of the form $2^k - 3(k = 2; 3; \cdots)$ contains an infinite subset in which every two members are relatively prime.,"Denote $A_n = 2^{a_n} - 3$. The plan is to construct recursively a sequence $a_1 < a_2 < \dots < a_n < \dots$ such that $A_n$ and $A_k$ are relatively prime for all $k < n$.

Let $a_1 = 3$. (Note that any other number $> 3$ would serve just as well.)

Let $p_{1,1}, \dots, p_{1,k_1}$ be all the prime factors of $A_1 = 2^{a_1} - 3$. (Note that we did not specify whether any prime factors are repeated or not. It does not matter for the proof, the important thing is to take all prime factors.) In our case, $k_1 = 1$ and $p_{1,1} = 5$ since we took $a_1 = 3$.

Define $a_2 = a_1 (p_{1,1} - 1) \dots (p_{1,k_1} - 1)$. In our case $a_2 = 3 (5 - 1) = 12$.

Define $\{a_n\}$ recursively: let $\{p_{(n-1),1}, \dots, p_{(n-1),k_{n-1}}\}$ be all the prime factors of $A_{n-1} = 2^{a_{n-1}} - 3$. (Note again that we don't care whether factors are repeated or not.) Let us take $a_n = a_{n-1} (p_{(n-1),1} - 1) \dots (p_{(n-1),k_{n-1}} - 1)$.

At this point, note for later use that if $p$ is a prime factor of any $A_k, k \in \{1, \dots, (n-1)\}$ then $(p - 1)$ is a factor of $a_n$. Also, note that all such factors $p$ are odd, because all $A_k$ are odd.

Let $B = A_n + 2 = 2^{a_n} - 1$. If $p$ is a prime factor of any of the $A_k, k \in \{1, \dots, n-1\}$, then $p$ is a factor of $B$. Indeed, note that $a_n = b \cdot (p - 1)$ for some $b$, so $B = 2^{a_n} - 1 = 2^{b \cdot (p - 1)} - 1 = (2^b)^{p-1} - 1$, which is divisible by $p$ according to Fermat's_Little_Theorem.

It follows that $A_n = 2^{a_n} - 3$ is coprime with all $A_k, k \in \{1, \dots, (n-1)\}$. This can be justified easily, by noting that if there were a common factor $b$ between $A_n$ and an $A_k$, there would exist a prime common factor $p$. But then this $p$ would be a common factor between two consecutive odd integers $A_n$ and $B$, which is impossible.",361,3
1971p4,"All the faces of tetrahedron $ABCD$ are acute-angled triangles. We consider all closed polygonal paths of the form $XYZTX$ defined as follows: $X$ is a point on edge $AB$ distinct from $A$ and $B$; similarly, $Y, Z, T$ are interior points of edges $BC, CD, DA$, respectively. Prove:

(a) If $\angle DAB + \angle BCD \neq \angle CDA + \angle ABC$, then among the polygonal paths, there is none of minimal length.

(b) If $\angle DAB + \angle BCD = \angle CDA + \angle ABC$, then there are infinitely many shortest polygonal paths, their common length being $2AC \sin(\alpha / 2)$, where $\alpha = \angle BAC + \angle CAD + \angle DAB$.","The basic idea is to ""fold out"" the tetrahedron into a polygon in the plane. The path $XYZTX$ becomes a collection of connected segments $XY, YZ, ZT, TX'$ with the unconnected ends $X, X'$ on the two line segments $AB, A'B'$.

Specifically, we rotate the solid consisting of three faces around $BC$ so $\triangle BCD$ is in the same plane as $\triangle ABC$. Then we rotate the solid consisting of two faces around  $CD$ so that $\triangle CDA'$ is in the same plane with the previous triangles. (We denoted $A'$ the new ""copy"" of $A$, since the original $A$ is being used in the picture.) Finally, we rotate $\triangle A'BD$ around $A'D$, so that it is in the same plane with the other triangles. (We denote $B'$ the new ""copy"" of $B$, and $X'$ the new copy of $X$.)

The polygonal path $XYZTX$ becomes $XYZTX'$. It is clear that in order to minimize $XYZTX$, we should make $XYZTX'$ be a segment on a straight line. Furthermore, to minimize the segment $XX'$, we want to choose $X \in AB$ so that when we draw the line segment to its corresponding image $X' \in A'B'$, the length of $XX'$ is as short as possible.

This was the ""folding out"" done in the solution above. To continue, we will do a different ""folding out"", which will serve better for solving the problem. Specifically, we rotate $\triangle BCD$ around $BC$, then we rotate $\triangle ABD$ around $AB$ to obtain $\triangle ABD'$, and finally, we rotate $\triangle AD'C$ around $AD'$ to obtain $\triangle AD'C'$. Now $Z \in CD$ becomes $Z' \in C'D'$. The polygonal path becomes $ZYXTZ'$ going from $CD$ to $C'D'$. We need to make this as small as possible, to find its minimum, if it exists.

The idea of the solution to the problem is now easy to explain. First of all, $ZYXTZ'$ needs to be a segment on a straight line, in which case its length is the length of the segment $ZZ'$. Clearly $ZYXTZ' = ZZ'$ has a lower bound (after all, it is $> 0$), so we can think about its lower limit. If there is a position of $Z$ in which this lower limit is achieved, then this lower limit is a minimum. Otherwise, there is no minimum value for $ZYXTZ'$. (Pay attention to the subtle distinction between lower bound, lower limit, and minimum.)

In the picture above, $CD$ and $C'D'$ are not parallel. The segment $ZZ'$ would be shortest when $Z = D$ (and $Z' = D'$). But this is not an acceptable position for $ZYXTZ'$, because the problem stated that $Z$ is between $C$ and $D$, not equal to any of them. So in this picture, there is no minimum for the polygonal path. (In this case there is a lower limit for $ZZ'$, namely $DD'$, which is not a minimum.)

On the other hand, if $CD \parallel C'D'$ (see pictures below) then generally there are lots of points $Z \in CD$ yielding a minimum value for $ZYXTZ'$. Indeed, in this case $CC' \parallel ZZ' \parallel DD'$, so the only requirement is for all the points $X, Y, Z, T$ to be inside the respective segments. (In this case, $ZZ' = CC' = DD'$ is a lower limit, and it is a minimum.)

We will prove that $\angle DAB + \angle BCD = \angle CDA + \angle ABC$ if and only if $CD \parallel C'D'$. After this it will be easy to deduce all the statements of the problem.

Let $M, N, P$ be on $CA, BD', AC'$ be such that $CD \parallel MB \parallel AN \parallel PD'$. The equality $\angle DAB + \angle BCD = \angle CDA + \angle ABC$ becomes $\angle D'AB + \angle BCD = \angle C'D'A + \angle ABC$, and then it becomes $\angle D'AN + \angle NAB + \angle BCD = \angle C'D'P + \angle PD'A + \angle ABM + \angle MBC$. Because of the parallelism of $CD, MB, AN, PD'$ we have several equal angles on the two sides of this equality. This equality becomes $\angle C'D'P = 0$.

So, the original equality $\angle DAB + \angle BCD = \angle CDA + \angle ABC$ is true if and only if $\angle C'D'P = 0$, which is true if and only if $CD \parallel C'D'.$

Now it is obvious that when $\angle DAB + \angle BCD \neq \angle CDA + \angle ABC$ a lower limit exists (as expected), but it is not a minimum, and a minimum does not exist.

On the other hand, when $\angle DAB + \angle BCD = \angle CDA + \angle ABC$, in the typical, general case, $ZZ' = DD'$ is the minimum, and there are infinitely many segments $ZZ'$ of the same size (see Figure 2 below).

There is one delicate point we need to worry about: we have to be sure that $ZZ'$ intersects $CB, BA, AD'$. See Figure 3 for an example when this does not happen; note that in this example we have some obtuse angles. Formally, $A$ has to be on the same side of $DD'$ as $C, C'$ and $B$ has to be on the same side of $CC'$ as $D, D'$.

Let us concentrate on the position of $A$ vs. $DD'$ (the statement about $B$ is similar). We want $\angle DAB + \angle BAD' < \pi$. We have $\angle DAB < \angle CAD$ and $\angle BAD' = \text{the original } \angle BAD \text{ from the tetrahedron}$. Since both $\angle CAD, \angle BAD$ are acute, it follows that $\angle DAB + \angle BAD' < \pi$.

The last thing to do is to compute $ZZ'$. We have $ZZ' = CC'$, and from the isosceles triangle $\triangle CAC'$ we have $CM = \sin \angle CAM$, where $M$ is the midpoint of $CC'$. This gives $ZZ' = CC' = 2 AC \sin \frac{\alpha}{2}$, which is the formula we wanted.",974,4
1971p5,"Prove that for every natural number $m$, there exists a finite set $S$ of points in a plane with the following property: For every point $A$ in $S$, there are exactly $m$ points in $S$ which are at unit distance from $A$.
","We will give a proof by induction on $m$. First some notation:

Given two finite sets of points $S, T$ in the complex plane, and given $\theta \in [0, 2\pi)$, define $U = S \oplus_\theta T = \{a + e^{i \theta} b, \text{\ for all\ } a \in S, b \in T\}$.

$\mathbf{Proposition}$: If $S$ is $m$-regular and $T$ is $n$-regular, and $S \cap T = \emptyset$, then we can choose $\theta$ so that $U = S \oplus_\theta T$ is $(m + n)$-regular.

$\mathbf{Proof}$: Let $a_i, i = 1, \dots, m$ be the neighboring points in $S$ at distance $1$ from $a$, and $b_j, j = 1, \dots, n$ be the neighboring points in $T$ at distance $1$ from $b.$ Clearly $a_i + e^{i \theta} b$ is at distance $1$ from $a + e^{i \theta} b$ and $a + e^{i \theta} b_j$ is at distance $1$ from $a + e^{i \theta} b$. So $a + e^{i \theta} b$ has $(m + n)$ neighbors at distance $1$ if we choose $\theta$ such that $a_i + e^{i \theta} b \neq a + e^{i \theta} b_j$ for all $i, j$.

But the equations $a_i + e^{i \theta} b = a + e^{i \theta} b_j$ are just a finite number of linear equations in $e^{i \theta}$, so we just have to avoid choosing $\theta$ giving a solution to any of these equations. Thus, with such a choice of $\theta$ there are definitely at least $(m + n)$ points in $U$ at distance $1$ from $a + e^{i \theta} b$.

We have to show that we can choose $\theta$ so that there are no more than $(m + n)$ points at distance $1$. If we had more points from $U$ at distance $1$ from $a + e^{i \theta} b$, we would have $\vert (a + e^{i \theta} b) - (c + e^{i \theta} d) \vert = 1$ for some $c \in S$ and $d \in T$.

This would imply $\vert (a + e^{i \theta} b) - (c + e^{i \theta} d) \vert^2 = 1$,

or $\vert (a - c) + e^{i \theta} (b - d) \vert^2 = 1$,

or $[(a - c) + e^{i \theta} (b - d)] [\overline{(a - c)} + e^{-i \theta} \overline{(b - d)}] = 1$,

or $\vert (a - c) \vert^2 + e^{i \theta} \overline{(a - c)}(b - d) + e^{-i \theta} (a - c) \overline{(b - d)} + \vert (b - d) \vert^2 = 1$.

This becomes an equation of degree $2$ in $e^{i \theta}$. So as long as we choose $\theta$ not to equal to any of the solutions of these equations, we can be sure that none of the points in $U$ are at distance $1$ from $a + e^{i \theta} b$.

This proves the proposition because we have to choose $\theta \in [0, 2\pi)$ different from finite number of values.

Now the problem is very simple to prove by induction.

For $m = 1$, take $S_1 = \{0, 1\}$, which is a $1$-regular set. For the induction step, assume we have $S_{m-1}$ an $(m-1)$-regular graph. Using the proposition, it follows that we can choose $\theta$ such that $S_m = S_{m-1} \oplus_{\theta} T_1$ is an $m$-regular graph, where $T_1$ consists of two points in the plane at distance $1$, none of which is in $S_{m-1}$.

(Just for the sake of completeness, let us mention that when we choose $\theta$, it is a value in $[0, 2\pi)$ which differs from a finite set of values modulo $2\pi$, dependent on the points in $S_{m-1}, T_1$.)
",585,4
1971p6,"Let $A = (a_{ij})(i, j = 1, 2, \cdots, n)$ be a square matrix whose elements are non-negative integers. Suppose that whenever an element $a_{ij} = 0$, the sum of the elements in the $i$th row and the $j$th column is $\geq n$. Prove that the sum of all the elements of the matrix is $\geq n^2 / 2$.
","As in the solution, choose a row or column such that the sum of its elements is minimal. We can assume this is a row (either notice that taking the transpose of $A$ changes neither the hypothesis, nor the conclusion; or notice that if we do the proof in the case of a row, the proof in the case of a column is analogous.) Let $S$ be the sum of the elements of this row, and $z$ be the number of zeros in this row.

For an element $a_{ij}$ of $A$, we denote $r_i, c_j$ the row and the column containing $a_{ij}$. We denote $sum(r_i), sum(c_j)$ the sum of the entries of the matrix in row $r_i$ and $c_j$ respectively.

If $S \ge \frac{n}{2}$, then each row $r_i$ has its sum of elements $sum(r_i) \ge S \ge \frac{n}{2}$, so $\sum_{i, j = 1}^n a_{ij} = \sum_{i=1}^n sum(r_i) \ge \frac{n^2}{2}$.

So, let us assume $S < \frac{n}{2}$. Let $r_i = \{a_{ij}, j = 1, \dots, n\}$ be the row we chose (now $i$ is fixed). For each $j$ consider the sum of the elements of the column $c_j$ containing $a_{ij}$. If $a_{ij} = 0$, we know that $sum(r_i) + sum(c_j) \ge n$ (by hypothesis), so $S + sum(c_j) \ge n$, so $sum(c_j) \ge n - S$. We have $z$ such columns.

If $a_{ij} \ne 0$, we know that $sum(c_j) \ge S$ because $S$ was minimal. We have $n - z$ such columns.

So, $\sum_{i, j = 1}^n a_{ij} = \sum_{j = 1}^n sum(c_j) \ge z(n - S) + (n - z)S$.

Let $S = n - z + E$. Here we split $S$ in two parts: $n - z$ represents the number of non-zeroes in $r_i$, and $E$ represents the sum of the ""excess"" amounts over $1$ of the non-zero entries. More explicitly, $E = \sum_{\substack{j = 1 \\ a_{ij} \ne 0}}^n (a_{ij} - 1)$. (To clarify: if all non-zero entries of $r_i$ would $= 1$, we would have $S = n - z$, and $E = 0$.) In general, $E \ge 0$.

Then, $\sum_{i, j = 1}^n a_{ij} \ge z(n - S) + (n - z)S = (n - S + E)(n - S) + (S - E)S = n^2 - 2nS + 2S^2 + nE - 2SE =$

$\frac{n^2}{2} + \frac{1}{2}\left(n^2 - 4nS + 4S^2\right) + E(n - 2S) = \frac{n^2}{2} + \frac{1}{2}(n - 2S)^2 + E(n - 2S)$.

The last term is $\ge 0$ since $E \ge 0$ and we assumed we are in the case $S < \frac{n}{2}$. It follows that $\sum_{i, j = 1}^n a_{ij} > \frac{n^2}{2}$.

Note: The strict inequality is not true in general. We obtained it assuming that $S < \frac{n}{2}$. When $S \ge \frac{n}{2}$ we have $\sum_{i, j = 1}^n a_{ij} \ge \frac{n^2}{2}$.

Note: We could have proven directly that $z(n - S) + (n - z)S = \frac{n^2}{2} + \frac{1}{2}(n - 2S)^2 + (S + z - n)(n - 2S)$ and note that the last term is the product of two non-negative factors. However, introducing $E$ gives better insight into the inequality.


",511,4
1970p1,"Let $M$ be a point on the side $AB$ of $\triangle ABC$. Let $r_1, r_2$, and $r$ be the inscribed circles of triangles $AMC, BMC$, and $ABC$. Let $q_1, q_2$, and $q$ be the radii of the exscribed circles of the same triangles that lie in $\angle ACB$. Prove that

$\frac{r_1}{q_1} \cdot \frac{r_2}{q_2} = \frac{r}{q}$.","Let $I$ be the incenter, and $E$ be the excenter relative to C, and let $B_1, B_2$ be the points where the incircle and the excircle relative to $C$ touch $AC$.

The triangles $\triangle CIB_1$ and $\triangle CEB_2$ are similar, so $\frac{r}{q} = \frac{CI}{CE}.$

Let $I_1$ be the incenter, and $E_1$ be the excenter relative to C of the triangle $\triangle ACM$, and $I_2$ be the incenter, and $E_2$ be the excenter relative to C of the triangle $\triangle BCM$ ($E_2$ is not shown on the picture).

To solve the problem, we need to prove that $\frac{CI_1}{CE_1} \cdot \frac{CI_2}{CE_2} = \frac{CI}{CE}.$

Applying the law of sines (see Law of Sines or https://en.wikipedia.org/wiki/Law_of_sines) in triangle $\triangle ICA$ we get

$\frac{IC}{\sin \angle CAI} = \frac{AC}{\sin \angle CIA}$, or $IC = b\ \frac{\sin \frac{A}{2}}{\sin (\pi - (\frac{A}{2} + \frac{C}{2}))}$. Since $C = \pi - A - B$ this becomes $IC = b\ \frac{\sin \frac{A}{2}}{\cos \frac{B}{2}}.$

Similarly, using the law of sines in triangle $\triangle ECA$ and replacing some angles, we get $EC = b\ \frac{\cos \frac{A}{2}}{\sin \frac{B}{2}}.$

It follows that $\frac{r}{q} = \tan \frac{A}{2} \tan \frac{B}{2}.$

Now, we proceed like in the first solution: Apply the above to triangles $\triangle AMC$ and $\triangle MBC$.

We get that $\frac{r_1}{q_1} = \tan \frac{A}{2} \tan \frac{\angle AMC}{2}$ and $\frac{r_2}{q_2} = \tan \frac{\angle BMC}{2} \tan \frac{B}{2}.$

The desired equality follows from $\tan \frac{\angle AMC}{2} \cdot \tan \frac{\angle BMC}{2} = 1$ (since $\frac{\angle AMC}{2}$ and $\frac{\angle BMC}{2}$ are complementary).",241,2
1970p2,"Let $a, b$, and $n$ be integers greater than 1, and let $a$ and $b$ be the bases of two number systems.  $A_{n-1}$ and $A_{n}$ are numbers in the system with base $a$ and $B_{n-1}$ and $B_{n}$ are numbers in the system with base $b$; these are related as follows:

$A_{n} = x_{n}x_{n-1}\cdots x_{0}, A_{n-1} = x_{n-1}x_{n-2}\cdots x_{0}$,

$B_{n} = x_{n}x_{n-1}\cdots x_{0}, B_{n-1} = x_{n-1}x_{n-2}\cdots x_{0}$,

$x_{n} \neq 0, x_{n-1} \neq 0$.

Prove:

$\frac{A_{n-1}}{A_{n}} < \frac{B_{n-1}}{B_{n}}$ if and only if $a > b$.","Rewrite inequality (1), and give a few steps in which we state equivalent inequalities:

$\frac{x_{n-1} a^{n-1} + \cdots + x_1 a + x_0}{x_n a^n + x_{n-1} a^{n-1} + \cdots + x_1 a + x_0} < \frac{x_{n-1} b^{n-1} + \cdots + x_1 b + x_0}{x_n b^n + x_{n-1} b^{n-1} + \cdots + x_1 b + x_0}$

$\frac{x_{n-1} a^{n-1} + \cdots + x_1 a + x_0}{x_n a^n} < \frac{x_{n-1} b^{n-1} + \cdots + x_1 b + x_0}{x_n b^n}$

$\frac{x_{n-1} a^{n-1} + \cdots + x_1 a + x_0}{a^n} < \frac{x_{n-1} b^{n-1} + \cdots + x_1 b + x_0}{b^n}$

$x_{n-1} \frac{1}{a} + \cdots + x_1 \frac{1}{a^{n-1}} + x_0 \frac{1}{a^n} < x_{n-1} \frac{1}{b} + \cdots + x_1 \frac{1}{b^{n-1}} + x_0 \frac{1}{b^n}\ \ \ \ \ \ \ \ (2)$

Now it is clear that if $a > b$ then (2) is true for any $x_n, x_{n-1}, \cdots, x_0$. This proves statement S2 from the Remarks.

(Note that the problem said $x_n, x_{n-1} > 0$. This is not necessary. All we need is that $x_n > 0$ and at least one of $x_{n-1}, \cdots, x_1, x_0$ is $\neq 0$.)

We prove statement S1 from the Remarks by contradiction. We want to show that if (1) is true for some $x_n, \cdots, x_1, x_0$, then $a > b$.

Assume $a \le b$. If we had $a = b$ then (1) would be an equality, not an inequality.

If $a < b$ then by S1, it would follow that $\frac{A_{n-1}}{A_{n}} > \frac{B_{n-1}}{B_{n}}$ for all values of  $x_n, \cdots, x_1, x_0$ which contradicts the hypothesis. Either way, we get a contradiction, which proves S1.",265,3
1970p6,"In a plane there are $100$ points, no three of which are collinear. Consider all possible triangles having these point as vertices. Prove that no more than $70 \%$ of these triangles are acute-angled.
","Define a $n$-gon to be a configuration of $n$ points, no three of which are collinear. Given an $n$-gon draw all the triangles whose vertices are among the $n$ points. We say that a triangle $\triangle ABC$ is in the $n$-gon, or that the $n$-gon has $\triangle ABC$ in it, if $A, B, C$ are points in the $n$-gon.

We start by proving that a $4$-gon has $4$ triangles, out of which at most $3$ are acute.

Clearly there are exactly $4$ triangles. We have two cases. If the convex hull of the $4$-gon is a quadrilateral, then at least one of $\angle A, \angle B, \angle C, \angle D$ is $\ge \frac{\pi}{2}$ (if they were all $< \frac{\pi}{2}$ then $\angle A + \angle B + \angle C + \angle D < 2\pi$, which is false). Let us say that $\angle C \ge \frac{\pi}{2}$. Then $\triangle BCD$ is obtuse, so at most the other $3$ triangles are acute. (Note that it is possible to have $3$ acute triangles.)

If the convex hull of the $4$-gon is a triangle, let us say that $C$ is in the interior of $\triangle ABD$. Then at least two of $\angle ACB, \angle BCD, \angle DCA$ are $\ge \frac{2\pi}{3} > \frac{\pi}{2}$ (if they were all $< \frac{2\pi}{3}$ then their sum would be $< 2\pi$, which is false). So, at least two of $\triangle ACB, \triangle BCD, \triangle DCA$ are obtuse.

Note: We would be tempted to use this result, and the argument which follows below to prove the problem. But that would only yield the result that at most 75% of the triangles in an $n$-gon (in particular a $100$-gon) are acute. We need to do better.

Now, we will prove that a $5$-gon has $10$ triangles, out of which at most $7$ are acute. It is easy to see that there are $10$ triangles in a $5$-gon, either by counting, or by remembering that the number of triangles $= C(5, 3) = {5 \choose 3} = \frac{5 \cdot 4 \cdot 3}{1 \cdot 2 \cdot 3} = 10$. Now, we could proceed like in the case of a $4$-gon, by looking at many possible cases and chasing angle sizes. Instead, we will give a different argument, using an idea we will use again later.

A $5$-gon has $5$ $4$-gons in it. Each of these $4$-gons has $4$ triangles in it, of which at most $3$ are acute. Make a list $\mathcal{L}_1$ of all the triangles, and a sub-list $\mathcal{L}_2$ of all the acute triangles. The size of $\mathcal{L}_1 = 5 \cdot 4 = 20$, and the size of $\mathcal{L}_2 \le 5 \cdot 3 = 15$. These lists contain duplicates. Each triangle is counted exactly twice (corresponding to the two points which are not in the triangle; we can see this as $= C(5-3, 4-3) = C(2, 1) = {2 \choose 1} = 2$). Dividing by $2$ to eliminate duplicates, we get that out of the $\frac{20}{2} = 10$ triangles, at most $\frac{15}{2} = 7.5$ are acute. We conclude that at most $7$ out of the $10$ are acute.

Now we are ready to prove that given a $n$-gon with $n > 5$, at most $\frac{7}{10} = 70\%$ of its triangles are acute. Consider all the $5$-gons in the given $n$-gon, and consider all the triangles in each $5$-gon. Make a list $\mathcal{L}_1$ of all these triangles, and a sub-list $\mathcal{L}_2$ of all the acute triangles. We have that $\frac{\text{size of } \mathcal{L}_2}{\text{size of } \mathcal{L}_1} \le \frac{7}{10}$ (according to what we showed above). These lists contain duplicates. Each triangle is counted the same number of times, say $k$ times (in fact, $k = C(n-3, 5-3) = C(n-3, 2) = {n-3 \choose 2}$, but we don't need this). Dividing both the numerator and the denominator by $k$ to eliminate duplicates, we have that at most $\frac{7}{10} = 70\%$ of the triangles are acute.",647,4
1969p1,Prove that there are infinitely many natural numbers $a$ with the following property: the number $z = n^4 + a$ is not prime for any natural number $n$.,"Suppose that $a = 4k^4$ for some $k$. We will prove that $a$ satisfies the property outlined above.

The polynomial $n^4 + 4k^4$ can be factored as follows:

\[n^4 + 4k^4\]\[= n^4 + 4n^2k^2 + 4k^4 - 4n^2k^2\]\[= (n^2 + 2k^2)^2 - (2nk)^2\]\[= (n^2 + 2k^2 - 2nk)(n^2 + 2k^2 + 2nk)\]

Both factors are positive, because if the left one is negative, then the right one would also negative, which is clearly false.

It is also simple to prove that $n^2 + 2k^2 - 2nk > 1$ when $k > 1$. Thus, for all $k > 1$, $4k^4$ is a valid value of $a$, completing the proof. $\square$",109,2
1969p2,"Let $a_1, a_2,\cdots, a_n$ be real constants, $x$ a real variable, and \[f(x)=\cos(a_1+x)+\frac{1}{2}\cos(a_2+x)+\frac{1}{4}\cos(a_3+x)+\cdots+\frac{1}{2^{n-1}}\cos(a_n+x).\] Given that $f(x_1)=f(x_2)=0,$ prove that $x_2-x_1=m\pi$ for some integer $m.$","For simplicity of writing, denote $b_k = 1/2^{k - 1}$. $f(x) = b_1\cos{(a_1 + x)} + b_1\cos{(a_1 + x)} + \cdots + b_n\cos{(a_n + x)}$. First, we want to prove that it is not the case that $f(x) = 0$ for all $x$. To prove this, we will prove that the maximum value of $f$ is at least $b_n = 1/2^n$. This will ensure that $f \ne 0$.

We do this by induction. The statement is clear for $n = 1$: $f$ has a maximum value of $b_k = 1$. Assume that we have $n - 1$ terms in $f$, and the maximum value of $f$ is at lease $b_{n - 1} = 1/2^{n - 1}$. Now add the term $b_n\cos{(a_n + x)}$ (and remember that $b_n = 1/2^n$). This additional term has values in $[-1/2^n, 1/2^n]$, so it can decrease the maximum of $f$ by subtracting at most $1/2^n$ from the previous maximum, which was at least $1/2^{n - 1}$. So, the new maximum is at least $1/2^n$.

Now we will the formula $\cos{(\alpha + \beta)} = \cos{\alpha}\cos{\beta} - \sin{\alpha}\sin{\beta}$.

We get $f(x) = (b_1\cos{a_1} + b_2\cos{a_2} + \cdots + b_n\cos{a_n})\cos{x} - (b_1\sin{a_1} + b_2\sin{a_2} + \cdots + b_n\sin{a_n})\sin{x}$.

If both $b_1\sin{a_1} + b_2\sin{a_2} + \cdots + b_n\sin{a_n} = 0$ and $b_1\cos{a_1} + b_2\cos{a_2} + \cdots + b_n\cos{a_n} = 0$ then $f(x) = 0$ for all $x$. So at least one of these sums is $\ne 0$. I will give the proof for the case $b_1\cos{a_1} + b_2\cos{a_2} + \cdots + b_n\cos{a_n} \ne 0$. The other case is proven similarly.

Using $f(x_1) = 0$, we get $(b_1\cos{a_1} + b_2\cos{a_2} + \cdots + b_n\cos{a_n})\cos{x_1} = (b_1\sin{a_1} + b_2\sin{a_2} + \cdots + b_n\sin{a_n})\sin{x_1}$, and similarly for $x_2$.

If $b_1\sin{a_1} + b_2\sin{a_2} + \cdots + b_n\sin{a_n} = 0$, then $\cos{x_1} = 0$ and $\cos{x_2} = 0$. It follows that both $x_1$ and $x_2$ are odd multiples of $\pi/2$, so they differ by $m\pi$ for some integer $m$.

If $b_1\sin{a_1} + b_2\sin{a_2} + \cdots + b_n\sin{a_n} \ne 0$, then we can divide by this quantity, and we get

$\tan{x_1} = \tan{x_2} = \frac{b_1\cos{a_1} + b_2\cos{a_2} + \cdots + b_n\cos{a_n}} {b_1\sin{a_1} + b_2\sin{a_2} + \cdots + b_n\sin{a_n}}$.

Thinking of the graph of $y = \tan{x}$ would be enough for many people to conclude that $x_1 - x_2 = m\pi$ for some integer $m$. If we want to be more formal, we proceed by writing $\tan{x_1} - \tan{x_2} = 0$. Some easy computations yield $\tan{x_1} - \tan{x_2} = \frac{\sin{(x_1 - x_2)}} {\cos{x_1}\cos{x_2}} = 0$. It follows that $\sin{(x_1 - x_2)} = 0$, which implies that $x_1 - x_2 = m\pi$ for some integer $m$.",439,3
1969p4,"A semicircular arc $\gamma$ is drawn with $AB$ as diameter. $C$ is a point on $\gamma$ other than $A$ and $B$, and $D$ is the foot of the perpendicular from $C$ to $AB$. We consider three circles, $\gamma_1, \gamma_2, \gamma_3$, all tangent to the line $AB$. Of these, $\gamma_1$ is inscribed in $\triangle ABC$, while $\gamma_2$ and $\gamma_3$ are both tangent to $CD$ and $\gamma$, one on each side of $CD$. Prove that $\gamma_1, \gamma_2$, and $\gamma_3$ have a second tangent in common.","We start by stating a simple proposition. Let $L$ be a line and three circles with centers $C_1, C_2, C_3$ tangent to the line $L$, all on one side. Denote $A_1, A_2, A_3$ the points on the line where the circles touch it. Then there is a second line tangent to the three circles if and only if  $C_1, C_2, C_3$ are collinear, and this is the case if and only if $(\overline{C_1A_1} - \overline{C_2A_2})/(\overline{C_2A_2} - \overline{C_3A_3}) = (\overline{A_1A_2})/(\overline{A_2A_3})$

I will not give the full proof of this proposition, and in fact, we need to know only that if the equality of the two fractions holds, then a tangent to two circles is tangent to the third as well. The idea is that if the equality holds then triangles $\triangle{C_1A_1B}, \triangle{C_2A_2B}, \triangle{C_3A_3B}$ are similar, which implies that $C_1, C_2, C_3$ are collinear, which implies that a tangent to two of the circles is tangent to the third as well.

Now let us prove the problem. Look at the following figure:

We use the notation given in the problem, and we denote $O$ the center of the circle $\gamma$, $C_1, C_2, C_3$ the centers of the circles $\gamma_1, \gamma_2,\gamma_3$, and $A_1, A_2, A_3$ the points where the circles touch the line $AB$. Let $AB$ be the $x$-axis, $CD$ be the $y$-axis, $D$ be the origin, and the orientations of axes as shown in the picture. Let $a = \overline{OD}$. We think of $a$ as positive, $a > 0$. There is no loss of generality in assuming that the circle is of radius $1$, and that $D$ is to the right of $O$. This implies the following coordinates:

$D = (0, 0)$

$A = (-1 - a, 0)$

$B = (1 - a, 0)$

$O = (-a, 0)$

The circle has the equation $(x + a)^2 + y^2 = 1$

Then $C = (0, \sqrt{1 - a^2})$

We will also make use of the point $O_4 = (-a, -1)$ on the circle, vertically down from $O$.

The plan is to calculate the coordinates of $C_1, C_2, C_3$ (the centers of the circles $\gamma_1, \gamma_2,\gamma_3$) as expressions in $a$. Then we will be able to verify that $(\overline{C_1A_1} - \overline{C_2A_2})/(\overline{C_2A_2} - \overline{C_3A_3}) = (\overline{A_1A_2})/(\overline{A_2A_3})$, which will have solved the problem.

Calculating the coordinates of $C_2 = (x_2, y_2)$ is easy. Take in account that the distance from $C_2$ to line $AB$ has to be the same as the distance to the circle $\gamma$. In other words, $y_2 = ($the radius of $\gamma) - \overline{C_2O} = 1 - \sqrt{(x_2 + a)^2 + y_2^2}$. Also, take in account that $C_2$ is on the bisector of $\angle{ADC}$, which implies $x_2 + y_2 = 0$.

From this system of two equations with two unknowns we get

$-x_2 = 1 - \sqrt{(x_2 + a)^2 + x_2^2}$

Solve this, and get $x_2 = 1 - a \pm \sqrt{2 - 2a}$. Since $-1 < x_2 \le 0$, we see that only $x_2 = 1 - a - \sqrt{2 - 2a}$ is acceptable. Therefore

$C_2 = (1 - a - \sqrt{2 - 2a}, -(1 - a) + \sqrt{2 - 2a})$

By a similar computation, we get

$C_3 = (-1 - a + \sqrt{2 + 2a}, -1 - a + \sqrt{2 + 2a})$

Now we want to compute the coordinates of $C_1 = (x_1, y_1)$. We could look for the point on $CO_4$ such that the distance to $AB$, which is $y_1$, equals the distance to $AC$. But there is an easier way because we know classical formulas for computing the radius of the incircle of a triangle. Thus, if we denote by $A_r$ and $s$ the area and the semiperimeter of the triangle $\triangle{ABC}$, we know that

$y_1 =$ the radius of the incircle $= A_r/s = \frac{\overline{AB} \ \overline{DC}}{2} \ \frac{2}{\overline{AC} + \overline{BC} + \overline{AB}} = \cdots = \frac{\sqrt{2 + 2a} + \sqrt{2 - 2a} - 2}{2}$

(I skipped some obvious computations at the last equality).

An easy way to compute $x_1$ is to impose that $C, C_1, O_4$ are collinear.

Use that $M = (m_1, m_2), N = (n_1, n_2), P = (p_1, p_2)$ are collinear if and only if $\frac{n_1 - m_1}{n_2 - m_2} = \frac{p_1 - m_1}{p_2 - m_2}$.

Writing down the equality above for $C, C_1, O_4$, we get

$\frac{x_1 - 0}{\frac{\sqrt{2 + 2a} + \sqrt{2 - 2a} - 2}{2} - \sqrt{1 - a^2}} = \frac{-a - 0}{-1 - \sqrt{1 - a^2}}$

Solve for $x_1$ and simplify, after which we get

$C_1 = \left( \frac{\sqrt{2 + 2a} - \sqrt{2 - 2a} - 2a}{2}, \frac{\sqrt{2 + 2a} + \sqrt{2 - 2a} - 2}{2} \right)$

Now we can verify easily that $(\overline{C_1A_1} - \overline{C_2A_2})/(\overline{C_2A_2} - \overline{C_3A_3}) = (\overline{A_1A_2})/(\overline{A_2A_3})$. In fact, we can see that $A_1$ is the midpoint between $A_2$ and $A_3$, and the radius of $\gamma_1$ is the arithmetic mean of the radii of $\gamma_2$ and $\gamma_3$. This concludes the proof.",814,4
1969p5,"Given $n > 4$ points in the plane such that no three are collinear, prove that there are at least $C(n-3, 2) = {n-3 \choose 2} = \frac{(n-3)(n-4)}{2}$ convex quadrilaterals whose vertices are four of the given points.","We start by proving that given $5$ points, there is at least one convex quadrilateral formed by $4$ of them. Denote the $5$ points by $A, B, C, D, E$. Without loss of generality, we can chose to label the points so that $C, D, E$ are on one side of the line $line(AB)$. Further, we chose to label the point $C$ so that $D, E$ are on one side of $line(AC)$. It follows that $D, E$ are inside $\angle(BAC)$, with segments $AB$ and $AC$ extended beyond $B$ and $C$ respectively.

Note that from the choice of $A, B, C$ it follows that $\angle(BAC) < 2\pi$. Also, we could have chosen $A, B, C$ by considering the convex hull of the set of 5 points. It is either a triangle, or a convex quadrilateral, or a convex pentagon. We choose $A$ to be any of the vertices, and $B, C$ to be the adjacent vertices. (We don't need these notes in the proof, I just wanted to make things easier to visualize.)

The picture below shows this choice of labels.

The line $line(DE)$ must intersect at least one of $line(AB)$ and $line(AC)$. Without loss of generality, we can assume it intersects $line(AB)$. In general, it will also intersect $line(AC)$. The argument we are going to give is for the case when $line(DE)$ intersects both $line(AB)$ and $line(AC)$. The argument needed in the limiting case when $line(DE) \parallel line(AC)$ is identical, and is left as an exercise to the reader.

There are three cases:

Case 1, when $line(DE)$ intersects $segment(AB)$, but it does not intersect $segment(AC)$. This is shown on the first 3 pictures (one picture would have been enough, but I made all of them, for emphasis). In this case the quadrilateral formed by the points $A, D, E, C$ is convex. (Note that this also applies to the case when $line(DE) \parallel line(AC)$.)

Case 2, when $line(DE)$ intersects both $segment(AB)$ and $segment(AC)$. This is shown in the 4th picture. In this case the quadrilateral formed by the points $B, D, E, C$ is convex.

Case 3, when $line(DE)$ does not intersect either of $segment(AB)$ or $segment(AC)$. This is shown in the 5th picture. In this case the quadrilateral formed by the points $B, D, E, C$ is convex. (Note that this also applies to the case when $line(DE) \parallel line(AC)$.)

We thus proved that in any group of 5 points, there is a subgroup of 4 points which forms a convex quadrilateral. Note that in general, given a group of 5 points, more than one convex quadrilateral can be found by taking subgroups of 4 points.

Important remark: In fact, we proved more: if $D, E$ are inside the angle $\angle(BAC)$ formed by $line(AB)$ and $line(AC)$ (with segments $AB$ and $AC$ extended beyond $B$ and $C$ respectively), then we can choose the convex quadrilateral so that $D, E$ are both part of it.

Now the statement of the problem is easy to prove. Assume $n$ points are given. Choose $3$ of them, and label them $A, B, C$, so that all the other points are inside $\angle(BAC)$. There are $(n - 3)$ such points. Now choose all the groups of $2$ points from these $(n - 3)$ points. There are ${n-3 \choose 2} = \frac{(n-3)(n-4)}{2}$ ways of doing this. From what we proved before, we know that for each choice of 2 points, call them $D, E$, there is a group of $4$ points from among $A, B, C, D, E$ which forms a convex quadrilateral, such that $D, E$ are $2$ of the $4$ points. A different choice $D_1, E_1$ will yield a different quadrilateral because $\{D, E\} \ne \{D_1, E_1\}$.

This concludes the proof.

",617,4
1969p6,"Prove that for all real numbers $x_1, x_2, y_1, y_2, z_1, z_2$, with $x_1 > 0, x_2 > 0, x_1y_1 - z_1^2 > 0, x_2y_2 - z_2^2 > 0$, the inequality \[\frac{8}{(x_1 + x_2)(y_1 + y_2) - (z_1 + z_2)^2} \leq \frac{1}{x_1y_1 - z_1^2} + \frac{1}{x_2y_2 - z_2^2}\] is satisfied. Give necessary and sufficient conditions for equality.","First, remark that given the conditions of the problem, it follows that $y_1 > 0, y_2 > 0$. Also, we can assume $z_1 \ge 0, z_2 \ge 0$. Indeed, if $z_1 < 0$, then $z_1 < -z_1$. It follows $z_1 + z_2 < -z_1 + z_2$, so \[\frac{1}{(x_1 + x_2)(y_1 + y_2) - (z_1 + z_2)^2} < \frac{1}{(x_1 + x_2)(y_1 + y_2) - (-z_1 + z_2)^2}\]

So, if we proved the inequality for positive $z_1$ it is also true for negative $z_1$.

Now consider the function $F$ of three variables \[F(x, y, z) = \frac{1}{xy - z^2}\] defined on the domain $x, y > 0, z \ge 0, z^2 < xy$. For simplicity, denote a point $(x, y, z)$ in the domain by $P$. The inequality in the problem can be rewritten as \[F \left( \frac{P_1 + P_2}{2} \right) \le \frac{1}{2}[F(P_1) + F(P_2)]\]

This follows immediately from the inequality expressing the fact that $F(x, y, z)$ is a convex function. (In fact, it is equivalent to the convexity of $F$, but this is not needed for our proof of the given inequality.) Therefore, it is enough to prove that the function $F(x, y, z)$ is convex.

We will prove that this function is convex. In fact, we will prove that the function is strictly convex. This will imply that equality holds only when $P_1 = P_2$, in other words, $x_1 = x_2, y_1 = y_2, z_1 = z_2$, which will give us the necessary and sufficient conditions for equality.

We use the theorem which says that a twice differentiable function defined on a convex set is convex if and only if its Hessian is positive definite. Furthermore, if the Hessian is strictly positive definite, then the function is strictly convex.

The Hessian of the function $F(x, y, z)$ is the 3x3 matrix $H$ formed by the second derivatives of $F$:

$\frac{\partial^2 F}{\partial x^2} \hspace{20pt} \frac{\partial^2 F}{\partial x \partial y} \hspace{20pt} \frac{\partial^2 F}{\partial x \partial z} \\ \\ \\ \frac{\partial^2 F}{\partial y \partial x} \hspace{20pt} \frac{\partial^2 F}{\partial y^2} \hspace{20pt} \frac{\partial^2 F}{\partial y \partial z} \\ \\ \\ \frac{\partial^2 F}{\partial z \partial x} \hspace{20pt} \frac{\partial^2 F}{\partial z \partial y} \hspace{20pt} \frac{\partial^2 F}{\partial z^2}$

$H$ is positive definite if for any 3x1 vector $v$ we have $v^t H v \ge 0$. ($v^t$ is the transpose of $v$, a matrix which is 1x3.) $H$ is strictly positive definite if $v^t H v > 0$ unless $v = 0$.

Explicitly, we need to show that if $a, b, c$ are three numbers, then

$a^2 \frac{\partial^2 F}{\partial x^2} + ab \frac{\partial^2 F}{\partial x \partial y} + ac \frac{\partial^2 F}{\partial x \partial z} + ab \frac{\partial^2 F}{\partial y \partial x} + b^2 \frac{\partial^2 F}{\partial y^2} + bc \frac{\partial^2 F}{\partial y \partial z} + ac \frac{\partial^2 F}{\partial z \partial x} + bc \frac{\partial^2 F}{\partial z \partial y} + c^2 \frac{\partial^2 F}{\partial z^2} \ge 0$

and that the expression is $= 0$ only when $a = b = c = 0$.

Before embarking on the computations proving the inequality expressing the positive definiteness of the Hessian of $F$, let us show that the domain of $F$ is convex. Let $P_1 = (x_1, y_1, z_1)$ and $P_2 = (x_2, y_2, z_2)$ be two points in the domain of $F$. This means that $x_1, y_1, x_2, y_2 > 0$, $z_1, z_2 \ge 0$, $z_1^2 < x_1 y_1$ and $z_2^2 < x_2 y_2$. We need to verify that the same is true for $P = t P_1 + (1 - t) P_2$ when $0 < t < 1$. The only thing which is not obvious is $[t z_1 + (1 - t) z_2]^2 < [t x_1 + (1 - t) x_2] [t y_1 + (1 - t) y_2]$. To see this, work out the multiplications, use what we already know about $z_1^2$ and $z_2^2$, simplify by $t(1-t)$ and we are left with showing that $2 z_1 z_2 < x_1 y_2 + x_2 y_1$. This can be seen as follows: $2 z_1 z_2 < 2 \sqrt{x_1 y_1} \sqrt{x_2 y_2} = 2 \sqrt{(x_1 y_2) (x_2 y_1)} \le x_1 y_2 + x_2 y_1$.

Now work towards proving the inequality expressing that the Hessian of $F$ is positive definite. Compute all the second derivatives of $F$; notice that they all have $(xy - z^2)^3$ at the denominator, so we can simplify with this factor. (The computation is made somewhat shorter by taking advantage of the fact that the order of taking the derivatives makes no difference in mixed derivatives (for example  $\frac{\partial^2 F}{\partial x \partial y} = \frac{\partial^2 F}{\partial y \partial x}$).)

We get (as the thing we have to prove) that

$2a^2y^2 + 2ab(xy + z^2) - 8acyz + 2b^2x^2 - 8bcxz + c^2(2xy + 6z^2) \ge 0$.

If $a = b = 0$ the expression equals $0$ if and only if $c = 0$ as well. So, assume that at least one of $a, b$ is $\ne 0$. We can assume $a \ne 0$. We will show that in this case, the expression is $> 0$.

Simplify by $2$, and rearrange the terms so we can think of the expression on the left as a polynomial in $c$:

$(xy + 3z^2)c^2 - 4(xb + ya)zc + [x^2b^2 + y^2a^2 + (xy + z^2)ab] > 0$.

Notice that this is a polynomial (in $c$) of degree $2$ of the type $AX^2 + BX + C$, whose leading coefficient is $> 0$. To show that its values are always $> 0$ we need to show that its discriminant is $< 0$, in other words, $B^2 - 4AC < 0$.

Therefore, we need to show that

$16[(xb + ya)z]^2 - 4(xy + 3z^2)[x^2b^2 + y^2a^2 + (xy + 3z^2)ab] < 0$

After factoring out $4$, and working out all multiplications, this becomes

$-x^3yb^2 + x^2z^2b^2 - xy^3a^2 + y^2z^2a^2 - x^2y^2ab + 4xyz^2ab - 3z^4ab < 0$

After some rearranging of terms, grouping, and factoring, this becomes

$-(xy - z^2)[x^2b^2 + (xy - 3z^2)ab + y^2a^2] < 0$

Since $x^2 < xy$, we need to show

$x^2b^2 + (xy - 3z^2)ab + y^2a^2 > 0$

Now, view the expression on the left hand side as a polynomial of degree $2$ in $b$, whose leading coefficient is $> 0$. To conclude that its values are $> 0$ we need to show that its discriminant is $< 0$. That is, we need to show that

$[(xy - 3z^2)a]^2 - 4x^2y^2a^2 < 0$

Work out the multiplications, and regroup terms to get

$-3a^2(xy - z^2)(xy + 3z^2) < 0$.

This is clearly true, which concludes the proof.",1087,4
1968p1,"Prove that there is one and only one triangle whose side lengths are consecutive integers, and one of whose angles is twice as large as another.","So, let us start by assuming that two angles are $\alpha, 2\alpha$ and the sides are $x, x + 1, x + 2$. We will want to apply the Law of Sines:

$\frac{x}{\sin A} = \frac{x + 1}{\sin B} = \frac{x + 2}{\sin C}$

The angles $A, B, C$ should be so that $\sin A \le \sin B \le \sin C$, but we don't know how to map $\{A, B, C\}$ to $\{\alpha, 2\alpha, \pi - 3\alpha\}$. One thing we know, is that  $\sin \alpha < \sin 2\alpha$. Indeed, if $\alpha \le \pi/4$ the inequality is true because $\sin$ is increasing on $[0, \pi/2]$. Now note that $\alpha < \pi/3$ since otherwise $\pi - 3\alpha$ could not be the angle of a triangle. So, if $\pi/4 < \alpha < \pi/3$ then $\pi/2 < 2\alpha < 2\pi/3$ and $\sin \alpha < \sqrt{3}/2 < \sin 2\alpha$.

That means we will have to consider three possibilities:

1: $\ \ \frac{x}{\sin \alpha} = \frac{x + 1}{\sin 2\alpha} = \frac{x + 2}{\sin (\pi - 3\alpha)}$

2: $\ \ \frac{x}{\sin \alpha} = \frac{x + 1}{\sin (\pi - 3\alpha)} = \frac{x + 2}{\sin 2\alpha}$

3: $\ \ \frac{x}{\sin (\pi - 3\alpha)} = \frac{x + 1}{\sin \alpha} = \frac{x + 2}{\sin 2\alpha}$

Using the identities $\sin (\pi - \theta) = \sin \theta, \sin 2\theta = 2\sin \theta \cos \theta$ and $\sin 3\theta = 3\sin \theta - 4\sin^3 \theta = \sin \theta\ (4\cos^2 \theta - 1)$ and simplifying by $\sin \alpha$ the three cases become

1: $\ \ x = \frac{x + 1}{2\cos \alpha} = \frac{x + 2}{4\cos^2 \alpha - 1}$

2: $\ \ x = \frac{x + 1}{4\cos^2 \alpha - 1} = \frac{x + 2}{2\cos \alpha}$

3: $\ \ \frac{x}{4\cos^2 \alpha - 1} = x + 1 = \frac{x + 2}{2\cos \alpha}$

Each case is a system of two equations in two unknowns, $x, \cos \alpha$. We will solve each system, obtain all possible solutions, and chose those values for which $x, x + 1, x + 2$ and $\alpha, 2\alpha, \pi - 3\alpha$ can be the sides and angles of a triangle.

Case 1: Compute $x$ from $x = \frac{x + 1}{2\cos \alpha}$. We get $x = \frac{1}{2\cos \alpha - 1}$. Substitute $x$ in $x = \frac{x + 2}{4\cos^2 \alpha - 1}$. After doing all the computations we get $4\cos^2 \alpha - 4\cos \alpha = 0$. The roots are $\cos \alpha = 0$ and $\cos \alpha = 1$. None are acceptable if $\alpha$ is an angle of a triangle. So case 1 yields no solutions.

Case 2: Compute $x$ from $x = \frac{x + 2}{2\cos \alpha}$. We get $x = \frac{2}{2\cos \alpha - 1}$. Substitute $x$ in $x = \frac{x + 1}{4\cos^2 \alpha - 1}$. After doing all the computations we get $8\cos^2 \alpha - 2\cos \alpha - 3 = 0$. The solutions are $\cos \alpha = \frac{3}{4}$ and $\cos \alpha = -\frac{1}{2}$. Only $\cos \alpha = \frac{3}{4}$ is acceptable, and it yields $x = \frac{2}{\frac{6}{4} - 1} = 4$. Thus $4, 5, 6$ is a possible solution to the problem.

Case 3: Compute $x$ from $x + 1 = \frac{x + 2}{2\cos \alpha}$. We get $x = \frac{2 - 2\cos \alpha}{2\cos \alpha - 1}$. Substitute $x$ in $x + 1 = \frac{x}{4\cos^2 \alpha - 1}$. After doing all the computations we get $4\cos^2 \alpha + 2\cos \alpha - 3 = 0$. The roots are $\cos \alpha = \frac{-1 \pm \sqrt{13}}{4} \approx 0.65, -1.15$. The positive value is for an $\alpha$ acceptable as an angle in a triangle (it is a little over $\pi/4$), and yields $x = \frac{\sqrt{13} + 1}{2}$. We can easily verify that $x, x + 1, x + 2$ can be the sides of a triangle. (Indeed, they are $\frac{\sqrt{13} + 1}{2}, \frac{\sqrt{13} + 3}{2}, \frac{\sqrt{13} + 5}{2}$ and $\frac{\sqrt{13} + 1}{2} + \frac{\sqrt{13} + 3}{2} > \frac{\sqrt{13} + 5}{2}$). However, they are not integer, so are not solutions to the problem.

The only solution to the problem is the triangle with sides $4, 5, 6$ from case 2.",666,4
1968p4,"Prove that in every tetrahedron there is a vertex such that the three edges meeting there have lengths which are the sides of a triangle.
","Let the edges of one of the faces of the tetrahedron have lengths $a$, $b$, and $c$. Let $d$, $e$, and $f$ be the lengths of the sides that are not adjacent to the sides with lengths $a$, $b$, and $c$, respectively.

Without loss of generality, assume that $\max(a,b,c,d,e,f)=a$. I shall now prove that either $b+f>a$ or $c+e>a$, by proving that if $b+f\leq a$, then $c+e>a$.

Assume that $b+f\leq a$. The triangle inequality gives us that $e+f>a$, so $e$ must be greater than $b$. We also have from the triangle inequality that $b+c>a$. Therefore $e+c>b+c>a$. Therefore either $b+f>a$ or $c+e>a$.

If $b+f>a$, then the vertex where the sides of length $a$, $b$, and $f$ meet satisfies the given condition. If $c+e>a$, then the vertex where the sides of length $a$, $c$, and $e$ meet satisfies the given condition. This proves the statement. $\blacksquare$",143,2
1967p1,"Let $ABCD$ be a parallelogram with side lengths $AB = a$, $AD = 1$, and with $\angle BAD = \alpha$. If $\Delta ABD$ is acute, prove that the four circles of radius $1$ with centers $A$, $B$, $C$, $D$ cover the parallelogram if and only if

$a\leq \cos \alpha+\sqrt{3}\sin \alpha$","We can assume $a > 1$. Indeed, refer to Remark 2 above to see that if $a \le 1$ there is nothing to prove.

Note that instead of the statement $S1$ we can consider the following statement $S1'$:

$S1'$: the circles of radius $1$ centered at $A, B, D$ cover $\triangle ABD$.

This is equivalent to $S1$ because of the symmetry between $\triangle ABD$ and $\triangle BCD$.

Let $F$ be the intersection above $AB$ of the circles of radius $1$ centered at $A, B$. The three circles cover $\triangle ABD$ if an only if $F$ is inside the circle of radius 1 centered at $D$.

This needs an explanation: Let $H$ be the midpoint of $BD$, and consider $\triangle FHD$. All the vertices of this triangle are in the circle centered at $D$, so the whole triangle is inside this circle. It is obvious that $\triangle FHB$ is inside the circle centered at $B$, and that $\triangle FAD, \triangle FAB$ are inside the circles centered at $A, B$.

We will now show that $F$ is inside the circle of radius 1 centered at $D$ if an only if $DF \le 1$.

The plan is to calculate $DF$ in terms of $a, \alpha$ and impose this condition. Let $FG \perp AB$, $DE \perp AB$ and $FF' \parallel GE$. From the right triangle $\triangle AFG$ we have $FG = \sqrt{1 - \left( \frac{a}{2} \right)^2} = \frac{\sqrt{4 - a^2}}{2}$. From the right triangle $\triangle DFF'$ we have

$DF = \sqrt{(DF')^2 + (FF')^2} = \sqrt{(DE - FG)^2 + (AG - AE)^2} = \sqrt{\left( \sin \alpha - \frac{\sqrt{4 - a^2}}{2} \right)^2 + \left( \frac{a}{2} - \cos \alpha \right)^2}$

(Note that here we used the fact that $\alpha$ is acute. These equalities would look slightly differently otherwise.)

Now look at the condition $DF \le 1$, or equivalently $DF^2 \le 1$. Making all the computations and simplifications, we have $\sqrt{4 - a^2} \sin \alpha \ge 1 - a \cos \alpha$.

Now I would like to square both sides. In order to get an equivalent inequality, we need to know that $1 - a \cos \alpha \ge 0$. This follows from the fact that $\angle ADB$ is acute. Indeed, denote $\angle ADB = \beta$. From the law of sines in $\triangle ADB$ we have $\frac{1}{\sin \angle ABD} = \frac{a}{\sin \beta}$. Successively this becomes $\frac{1}{\sin (\pi - \alpha - \beta)} = \frac{a}{\sin \beta}$ or $\frac{1}{\sin (\alpha + \beta)} = \frac{a}{\sin \beta}$ or $(1 - a \cos \alpha) \sin \beta = a \sin \alpha \cos \beta$. From here we see that $\beta < \frac{\pi}{2}$ implies the right hand side is positive, so $1 - a \cos \alpha > 0$.

Going back to our inequality, we can square both sides, and after rearranging terms we get that $DF \le 1$ if and only if

$a^2 - 2a \cos \alpha + (1 - 4 \sin^2 \alpha) \le 0$.

View this as an equation of degree $2$ in $a$. The value of the polynomial in $a$ is $\le 0$ when $a$ is between its solutions, that is

$\cos \alpha - \sqrt{3} \sin \alpha \le a \le \cos \alpha + \sqrt{3} \sin \alpha$.

Note that $\cos \alpha - \sqrt{3} \sin \alpha = 2 \cos \left( \alpha + \frac{\pi}{3} \right)$. If $\alpha \in \left( 0, \frac{\pi}{2} \right)$ then $\left( \alpha + \frac{\pi}{3} \right) \in \left( \frac{\pi}{3}, \frac{5\pi}{6} \right)$, and it follows that $2 \cos \left( \alpha + \frac{\pi}{3} \right) \le 1$.

On the other hand, remember that we are in the case $a > 1$, so the left inequality is always true. It follows that

$DF \le 1$ (i.e. the three circles of radius $1$ centered at $A, B, D$ cover $\triangle ABD$) if an only if $a \le \cos \alpha + \sqrt{3} \sin \alpha$.",620,4
1967p2,"Prove that if one and only one edge of a tetrahedron is greater than $1$, then its volume is $\le \frac{1}{8}$.","Let $\mathcal{T}$ be the set of tetrahedrons with five edges $\le 1$. This proof will show that there is a $T \in \mathcal{T}$ with one edge $> 1$ and such that $\mathbf{volume} (T) = \frac{1}{8}$, and that for any $U \in \mathcal{T}$ either $U = T$ or there is a finite sequence of tetrahedrons $T_1, \dots, T_n$ such that

$\mathbf{volume} (U) = \mathbf{volume} (T_1) < \dots < \mathbf{volume} (T_n) = \mathbf{volume} (T)$.

The statement of the problem is a consequence of these facts.

We begin with two simple propositions.

Proposition

Let $ABCD$ be a tetrahedron, and consider the transformations which rotate $\triangle ABC$ around $AB$ while keeping $\triangle ABD$ fixed. We get a set of tetrahedrons, two of which, $ABC_1D$ and $ABC_2D$ are shown in the picture below. The lengths of all sides except $CD$ are constant through this transformation.

1. Assume that the angles between the planes $ABD$ and $ABC$, and $ABD$ and $ABC_1$ are both acute. If the perpendicular from $C_1$ to the plane $ABD$ is larger that the perpendicular from $C$ to the plane $ABD$ then the volume of $ABC_1D$ is larger than the volume of $ABCD$.

2. Furthermore, the tetrahedron $ABC_2D$ obtained when the position of $C_2$ is such that the planes $ABD$ and $ABC_2$ are perpendicular has the maximum volume of all tetrahedrons obtained from rotating $\triangle ABC$ around $AB$.

These statements are intuitively clear, since the volume $V$ of the tetrahedron $ABCD$ is given by

$V = \frac{1}{3} \cdot ($area of $\triangle ABD) \cdot ($height from $C)$.

A formal proof is very easy, and I will skip it.

Corollary

Given a tetrahedron $T$, and an edge $e_1$ of it, we can find another tetrahedron $U$ such that $\mathbf{volume}(U) > \mathbf{volume}(T)$, with an edge $f_1 > e_1$, and such that all the other edges of $U$ are equal to the corresponding edges of $T$, $\mathbf{unless}$ the edge $e_1$ stretches between sides of $T$ which are perpendicular. When we chose a bigger $f_1$, if $e_1 < 1$ we can choose $f_1 = 1$. Or, we can choose $f_1$ such that it stretches between sides which are perpendicular.

(By ""stretches between two sides"" I mean that the end points of the edge are the vertices on the two sides which are not common to the two sides. In the picture above, $DC_2$ stretches between the sides $ABD, AC_2B$ of $ABC_2D$.)

Lemma

Assume we have a tetrahedron $T$ with edges $e_1, \dots, e_6$, such that $e_2, \dots, e_6 \le 1$. If there is an edge $e_m < 1$ among $e_2, \dots, e_6$ then there is a tetrahedron $U$ with volume bigger than the volume of $T$, whose edges are equal to those of $T$, except for $e_m$, which is replaced by an edge of size $1$.

Proof

Case 1: If $T$ does not have any sides which are perpendicular, then the existence of $U$ follows from the corollary.

Case 2: Assume $T$ has exactly two sides which are perpendicular (like $ABC_2D$ in the picture above). If $C_2D < 1$ and it were the only edge $< 1$, then all the other edges are $= 1$ (because they were assumed to be $\le 1$). In this case $\triangle ABD, \triangle AC_2B$ are equilateral with sides $= 1$, and the planes can not be perpendicular since $C_2D < 1$. (Indeed, an easy computation shows that if we take two equilateral triangles $\triangle ABD, \triangle AC_2B$ and place them perpendicular to each other, then $CD = \frac{\sqrt{6}}{2} > 1$.) So $e_m$ must be one of the other sides. Then again, the existence of $U$ follows from the corollary.

Case 3: Assume that three sides are perpendicular.

Assume the perpendicular sides are the ones meeting at $A$, i.e. each pair of the planes meeting at $A$ are perpendicular. Since at least two of the edges $BD, BC, CD \le 1$ it follows that $AB, AC, AD < 1$ (the sides of the right angle in a right triangle are less than the hypotenuse). Just for the sake of notation, assume $e_m = AB < 1$. We can apply the corollary, and find a tetrahedron $U$ with volume bigger than the volume of $T$, with edges equal to those of $T$, except that $AB$ is replaced by an edge $= 1$.

Now the problem is very easy to prove. Let $T$ be a tetrahedron with edges $e_1, \dots, e_6$, such that $e_2, \dots, e_6 \le 1$. Apply the lemma as many times as necessary (up to five times), successively replacing each edge $< 1$ by an edge $= 1$. We obtain a tetrahedron $U$ with five edges $f_2, \dots, f_6 = 1$, and one edge $f_1 = e_1$. If $f_1$ stretches between two perpendicular sides, we are done. If not, apply the corollary one more time to obtain a bigger tetrahedron in which $f_1$ is replaced by a larger edge which stretches between two perpendicular sides.

We obtain the same result as in the first solution: the largest tetrahedron is the one formed by two equilateral triangles with sides $= 1$, having one side in common, with the two planes containing the triangles perpendicular. An easy calculation shows that the edge which is $> 1$ is in fact of length $\frac{\sqrt{6}}{2}$, and the volume of this tetrahedron is $\frac{1}{8}$.",876,4
1967p3,"Let $k, m, n$ be natural numbers such that $m+k+1$ is a prime greater than $n+1.$ Let $c_s=s(s+1).$ Prove that the product \[(c_{m+1}-c_k)(c_{m+2}-c_k)\cdots (c_{m+n}-c_k)\] is divisible by the product $c_1c_2\cdots c_n$.","First, assume $m + 1 \le k \le m + n$. In this case, $(c_{m + 1} - c_k)(c_{m + 2} - c_k) \cdots (c_{m + n} - c_k) = 0$, and we can say that $0$ is divisible by anything.

Next, assume $m + n < k$. In this case, each factor of the first product is negative, and we will consider the product

$P = (c_k - c_{m + 1})(c_k - c_{m + 2}) \cdots (c_k - c_{m + n})$

for the sake of working with positive factors.  $P$ differs from the product in the problem by at most a sign, so it is enough to show that $P$ is divisible by $c_1c_2 \cdots c_n$.

The proof of this fact goes along the same lines as the proof when $m + 1 > k$. We will give the proof for the sake of having a complete, properly written proof.

Using $p(p + 1) - q(q + 1) = (p + q + 1)(p - q)$ we get that $c_1c_2 \cdots c_n = (n + 1)! \cdot n!$. We also get that $P = \prod_{p = 1}^n (k + m + p + 1) \cdot \prod_{p = 1}^n (k - m - p)$.

We have that $n!\ |\ \prod_{p = 1}^n (k - m - p)$ (i.e. the product is divisible by the factorial) because

$\frac{\prod_{p = 1}^n (k - m - p)}{n!} = \frac{(k - m - 1)!}{(k - m - 1 - n)! \cdot n!} = {k - m - 1 \choose n}$

which is an integer. (Note that this all makes sense because we are in the case when $m + n < k$.)

Let us now show that $(n + 1)!\ |\ \prod_{p = 1}^n (k + m + p + 1)$. Let $P_1 = \prod_{p = 1}^n (k + m + p + 1)$. We have that

$\frac{(k + m + 1) \cdot P_1}{(n + 1)!} = \frac{(k + m + 1) \cdot \prod_{p = 1}^n (k + m + p + 1)}{(n + 1)!} = \frac{\prod_{p = 0}^n (k + m + p + 1)}{(n + 1)!} = \frac{(k + m + n + 1)!}{(k + m)! \cdot (n + 1)!} = {k + m + n + 1 \choose n + 1}$

which is an integer. So $(n + 1)!\ |\ (k + m + 1) \cdot P_1$. But none of the factors of $(n + 1)!$ is a divisor of $(k + m + 1)$ because $(k + m + 1)$ is prime, and $n + 1 < k + m + 1$. So $P_1 = \prod_{p = 1}^n (k + m + p + 1)$ must be divisible by $(n + 1)!$.",452,3
1966p2,"et $a$, $b$, and $c$ be the lengths of the sides of a triangle, and $\alpha,\beta,\gamma$ respectively, the angles opposite these sides. Prove that if

\[a+b=\tan{\frac{\gamma}{2}}(a\tan{\alpha}+b\tan{\beta}),\]

the triangle is isosceles.","First, we'll prove that both $\alpha$ and $\beta$ are acute. At least one of them has to be acute because these are angles of a triangle. We can assume that $\alpha$ is acute. We want to show that $\beta$ is acute as well. For a proof by contradiction, assume $\beta \ge \frac{\pi}{2}$.

From the hypothesis, it follows that $(a + b) \tan \frac{\alpha + \beta}{2} = a \tan \alpha + b \tan \beta$.

From $\alpha < \frac{\pi}{2} \le \beta$ it follows that $a < b$. So,

$b \tan \beta = (a + b) \tan \frac{\alpha + \beta}{2} - a \tan \alpha > 2a \tan \frac{\alpha + \beta}{2} - a \tan \alpha \ge a (2 \tan \left( \frac{\alpha}{2} + \frac{\pi}{4} \right) - \tan \alpha) =$

$2a \left( \frac{\tan \frac{\alpha}{2} + 1}{1 - \tan \frac{\alpha}{2}} - \frac{\tan \frac{\alpha}{2}}{1 - \tan^2 \frac{\alpha}{2}} \right) = 2a \cdot \frac{\tan^2 \frac{\alpha}{2} + \tan \frac{\alpha}{2} + 1} {1 - \tan^2 \frac{\alpha}{2}} > 0$

because the numerator is $> 0$ (because $Y^2 + Y + 1 > 0$ for any real $Y$), and the denominator is also $> 0$ (because $\alpha < \frac{\pi}{2}$, so $\tan \frac{\alpha}{2} < \tan \frac{\pi}{4} = 1$).

It follows that $\tan \beta > 0$, so it can not be that $\beta \ge \frac{\pi}{2}$.

Now, we will prove that $(a + b) \tan \frac{\alpha + \beta}{2} = a \tan \alpha + b \tan \beta$ implies $\alpha = \beta$.

Replace $a = \sin \alpha \cdot 2R$ and $b = \sin \beta \cdot 2R$ (in fact, we don't care that $R$ is the radius of the circumscribed circle), and simplify by $2R$. We get

$(\sin \alpha + \sin \beta) \tan \frac{\alpha + \beta}{2} = \sin \alpha \tan \alpha + \sin \beta \tan \beta$.

This becomes

$\left( \sin \frac{\alpha + \beta}{2} \tan \frac{\alpha + \beta}{2} \right) \cdot \cos \frac{\alpha - \beta}{2} = \frac{1}{2}(\sin \alpha \tan \alpha + \sin \beta \tan \beta)$

We will show that the function $f(x) = \tan x \sin x$ is convex on the interval $\left( 0, \frac{\pi}{2} \right)$. Indeed, the first derivative is $f'(x) = \frac{\sin x}{\cos^2 x} + \sin x$, and the second derivative is $f''(x) = \frac{\cos^4 x - \cos ^2 x + 2}{\cos^3 x}$.

We have $f''(x) > 0$ on $\left( 0, \frac{\pi}{2} \right)$ since the numerator is $> 0$ (because $Y^2 - Y + 1 > 0$ for any real $Y$), and the denominator is $> 0$ on the interval $\left( 0, \frac{\pi}{2} \right)$. It follows that $f(x) = \tan x \sin x$ is convex on the interval $\left( 0, \frac{\pi}{2} \right)$.

Using the convexity we have $f \left( \frac{x + y}{2} \right) \le \frac{1}{2} (f(x) + f(y))$. In our case, we have

$\frac{1}{2}(\sin \alpha \tan \alpha + \sin \beta \tan \beta) = \left( \sin \frac{\alpha + \beta}{2} \tan \frac{\alpha + \beta}{2} \right) \cdot \cos \frac{\alpha - \beta}{2} \le \frac{1}{2}(\sin \alpha \tan \alpha + \sin \beta \tan \beta) \cdot \cos \frac{\alpha - \beta}{2}$.

We can simplify by $\sin \alpha \tan \alpha + \sin \beta \tan \beta$ because it is positive (because both $\alpha, \beta$ are acute!), and we get

$1 \le \cos \frac{\alpha - \beta}{2}$. This is possible only when $\cos \frac{\alpha - \beta}{2} = 1$, i.e. $\alpha = \beta$.",530,4
1966p3,Prove that the sum of the distances of the vertices of a regular tetrahedron from the center of its circumscribed sphere is less than the sum of the distances of these vertices from any other point in space.,"We will first prove the problem in the 2-dimensional case. We do this to convey the idea of the proof, and because we will use this in one spot in proving the 3-dimensional case. So let us prove that:

The sum of the distances of the vertices of an equilateral triangle $\triangle ABC$ from the center $O$ of its circumscribed circle is less than the sum of the distances of these vertices from any other point $P$ in the plane.

We will do the proof in three steps:

$\mathbf{1.}$ We will show that if $P$ is in one of the exterior regions, then there is a point $P_1$ on the boundary of the triangle (a vertex, or on a side), such that $PA + PB + PC > P_1A + P_1B + P_1C$.

$\mathbf{2.}$ Then we will show that if $P$ is on the boundary, then $PA + PB + PC > OA + OB + OC$.

$\mathbf{3.}$ For the final step, we will show that if $P$ is a point of minimum for $PA + PB + PC$ inside the triangle, then the extensions of $PA, PB, PC$ are perpendicular to the opposite sides $BC, AC, AB$. This implies that $P = O$.

$\mathbf{Proof\ of\ 1:}$ If the point $P$ is outside the triangle, it can be in one of six regions as seen in the pictures below.

If $P$ is in a region delimited by extensions of two sides of the triangle, as in the picture on the left, we notice that by taking $P_1 = A$, $PA + PB + PC > P_1A + P_1B + P_1C$ (because $P_1A = 0$ and $P_1B < PB$ as sides in an obtuse triangles, and similarly $P_1C < PC$).

If $P$ is in a region delimited by a segment which is a side of the triangle and by the extensions of two sides, as in the picture on the right, take $P_1 =$ the foot of the perpendicular from $P$ to $AB$. Then $PA + PB + PC > P_1A + P_1B + P_1C$ (because the triangle $\triangle PP_1C$ is obtuse, and because the triangles $\triangle PP_1A, \triangle PP_1B$ are right triangles).

$\mathbf{Proof\ of\ 2:}$ Now assume that $P_1 = A$. A direct, simple computation shows that $P_1A + P_1B + P_1C > OA + OB + OC$ (indeed, if we take the side of the triangle to be $1$, then $P_1A + P_1B + P_1C = 2$, and $OA + OB + OC = 3 \cdot \frac{\sqrt{3}}{3} = \sqrt{3}$).

Now assume that $P_1$ is on $AB$. If $P_1$ is not the midpoint of $AB$, let $P_2$ be the midpoint. Then $P_1A + P_1B + P_1C > P_2A + P_2B + P_2C$ (because $P_1A + P_1B = P_2A + P_2B = AB$ and $P_1C > P_2C$). A direct, simple computation shows that $P_2A + P_2B + P_2C > OA + OB + OC$ (indeed, if we take the side of the triangle to be $1$, $P_2A + P_2B + P_2C = 1 + \frac{\sqrt{3}}{2}$ and $OA + OB + OC = \sqrt{3}$).

$\mathbf{Proof\ of\ 3:}$ Assume that $P$ is inside the triangle $\triangle ABC$. In this case, we make a proof by contradiction. We will show that if $P$ is a point where $PA + PB + PC$ is minimum, then the extensions of $PA, PB, PC$ are perpendicular to the opposite sides $BC, AC, AB$. (This statement implies that $P = O$.) If this were not true, at least one of $PA \perp BC, PB \perp AC, PC \perp AB$ would be false. We can assume that $PC$ is not perpendicular to $AB$. Then draw the ellipse with focal points $A, B$ which goes through $P$.

Now consider the point $P_1$ on the ellipse such that $CP_1 \perp AB$. Because of the properties of the ellipse, $CP_1 < CP$, and because of the definition of the ellipse $PA + PB = P_1A + P_1B$. We conclude that $PA + PB + PC > P_1A + P_1B + P_1C$, which contradicts the assumption that $P$ was such that $PA + PB + PC$ was minimum.

This proves the 2-dimensional case.

NOTE: a very picky reader might object that the proof used that a minimum of $PA + PB + PC$ exists, and is achieved at a point $P$ inside the triangle. This can be justified simply by noting that $PA + PB + PC > 0$ and quoting the theorem from calculus (or is it topology?) which says that a continuous function on a closed, bounded set has a minimum, and there is a point where the minimum is achieved. Because of the arguments in the proof, this point can not be on the boundary of the triangle, so it is inside.

Now we will give the proof in the 3-dimensional case. We will do the proof in three steps. It is extremely similar to the proof in the 2-dimensional case, we just need to go from 2D to 3D, so I will skip some details.

$\mathbf{1.}$ We will show that if $P$ is in one of the exterior regions, then there is a point $P_!$ on the boundary of the tetrahedron (a vertex, or on a edge, or on a side, such that $PA + PB + PC + PD > P_1A + P_1B + P_1C + P_1D$.

$\mathbf{2.}$ Then we will show that if $P$ is on the boundary, then $PA + PB + PC + PD > OA + OB + OC + OD$.

$\mathbf{3.}$ For the final step, consider the plane going through the edge $CD$ perpendicular to the edge $AB$, the plane going through $AB$ perpendicular to $CD$, the plane going through $CA$ perpendicular to $BD$, etc. There are six such planes, and they all contain $O$, the center of the circumscribed sphere. We will show that if $P$ is a point of minimum for $PA + PB + PC + PD$ inside the tetrahedron, then $P$ is in each of the six planes described above. This implies that $P = O$.

$\mathbf{Proof\ of\ 1:}$ Let $P$ be in one of the exterior regions. Assume $P$ is in a prism shaped region delimited by extensions of three sides meeting in a vertex (there are 4 of them). Assume it is at vertex $A$, the sides being the extensions of planes $ABC, ABD, ACD$. Then take $P_1 = A$. We have $PA + PB + PC + PD > P_1A + P_1B + P_1C + P_1D$ because of obtuse triangles formed with $PP_1$.

Now assume $P$ is in one of the wedge shaped regions, formed by an edge and the extensions of two sides going through them. (there are six such regions.) Assume this is the line $AB$ and the extensions of $ABC, ABD$. Then take $P_1$ to be the foot of the perpendicular from $P$ to $AB$. Again, we have the desired inequality because $PP_1$ formed some right and obtuse triangles.

Now assume $P$ is in the truncated prism region delimited by a side and the extensions of the faces going through the edges of this side. (There are four such regions.) Assume this is the side $ABC$, and extensions of the sides $DAB, DBC, DCA$. Then take $P_1$ to be the foot of the perpendicular from $P$ to the plane $ABC$. Again, we have the desired inequality because of right and obtuse triangles formed by $PP_1$.

$\mathbf{Proof\ of\ 2:}$ Assume $P_1 = A$. If we take the edge of the tetrahedron to be $1$, a direct computation gives us that $P_1A + P_1B + P_1C + P_1D = 3$, and $OA + OB + OC + OD = 4 \cdot \frac{\sqrt{6}}{4} = \sqrt{6}$.

Assume $P_1$ is on $AB$. If $P_1$ is not the midpoint of $AB$, take $P_2$ to be the midpoint of $AB$. Then $P_1A + P_1B + P_1C + P_1D > P_2A + P_2B + P_2C + P_2D$ because of right triangles formed by $P_2C, P_2D$. And, if we take the edge of the tetrahedron to be $1$, a direct computation yields that $P_2A + P_2B + P_2C + P_2D = 1 + 2 \cdot \frac{\sqrt{3}}{2} = 1 + \sqrt{3}$, which is bigger than $OA + OB + OC + OD = \sqrt{6}$.

Assume $P_1$ is on $ABC$. If $P_1$ is not the circumcenter of $\triangle ABC$ then take $P_2$ to be the circumcenter. We have $P_1D > P_2D$ because $P_2D \perp ABC$. We also have $P_1A + P_1B + P_1C > P_2A + P_2B + P_2C$ because we proved the 2-dimensional analogue of the problem. And, if we take the edge of the tetrahedron to be $1$, we have $P_2A + P_2B + P_2C + P_2D = \sqrt{3} + \frac{\sqrt{6}}{3}$, which is bigger than $OA + OB + OC + OD = \sqrt{6}$.

NOTE: In the above paragraph, we used that the similar result is true in the 2-dimensional case, with an equilateral triangle instead of a regular tetrahedron.

$\mathbf{Proof\ of\ 3:}$ Now consider the six planes going through one edge, perpendicular to the opposite edge. They intersect at the circumcenter of the tetrahedron. Assume $P$ is a point in the interior of the tetrahedron where $PA + PB + PC + PD$ achieves its minimum value. Then $P$ is in each of the six plane.

Prove this statement by contradiction. Assume that there is a plane among the six, so that $P$ is not on it. Assume the plane is the one going through $CD$, perpendicular to $AB$. To make it more explicit, this is the plane going through $C, D, E$, where $E$ is the midpoint of $AB$.

Consider the ellipsoid with focal points $A, B$ going through $P$. This can be obtained as the set of points $Q$ in space so that $QA + QB = PA + PB$. It can also be obtained as the surface obtained when we form the ellipse with focal points $A, B$ in the plane $ABC$ (as the set of points $Q$ so that $QA + QB = PA + PB$), and we rotate this ellipse from the plane $ABC$ around its axis $AB$. Let $P_1$ be the foot of the perpendicular from $P$ to the plane $CDE$. We have $PC > P_1C, PD > P_1D$ because $PP_1 \perp CDE$. We also have $PA + PB > P_1A + P_1B$ because $P_1$ is in the interior of the ellipsoid. (Indeed, the intersection of the plane $CDE$ and the ellipsoid is the circle generated by rotating the ends of the small axis of the ellipse in the plane $ABC$. Since the point $P$ is not on the plane CDE, it must be on a smaller circle, so its projection to the plane $CDE$ will be inside.)

This concludes the proof of the problem.",1790,4
1966p4,"Prove that for every natural number $n$, and for every real number $x \neq \frac{k\pi}{2^t}$ ($t=0,1, \dots, n$; $k$ any integer) \[\frac{1}{\sin{2x}}+\frac{1}{\sin{4x}}+\dots+\frac{1}{\sin{2^nx}}=\cot{x}-\cot{2^nx}\]","First, we prove $\cot \theta - \cot 2\theta = \frac {1}{\sin 2\theta}$.

LHS$\ =\ \frac{\cos \theta}{\sin \theta}-\frac{\cos 2\theta}{\sin 2\theta}$

$= \frac{2\cos^2 \theta}{2\cos \theta \sin \theta}-\frac{2\cos^2 \theta -1}{\sin 2\theta}$

$=\frac{2\cos^2 \theta}{\sin 2\theta}-\frac{2\cos^2 \theta -1}{\sin 2\theta}$

$=\frac {1}{\sin 2\theta}$

Using the above formula, we can rewrite the original series as

$\cot x - \cot 2x + \cot 2x - \cot 4x + \cot 4x + \dots + \cot 2^{n-1} x - \cot 2^n x$.

Which gives us the desired answer of $\cot x - \cot 2^n x$.",85,1
1966p6,"In the interior of sides $BC, CA, AB$ of triangle $ABC$, any points $K, L,M$, respectively, are selected. Prove that the area of at least one of the triangles $AML, BKM, CLK$ is less than or equal to one quarter of the area of triangle $ABC$.","Let $\triangle ABC$ and $K, L, M$ be as in the problem. Denote $x = \frac{AM}{AB}, y = \frac{BK}{BC}, z = \frac{CL}{CA}$. Note that $x, y, z, \in (0, 1)$ because $K, L, M$ are in the interior of the respective sides.

Using the fact that the area of a triangle is half of the product of two sides and $\sin$ of the angle between them, we have that $\mathbf{area} AML = x(1 - z) \mathbf{area} ABC, \mathbf{area} BKM = y(1 - x) \mathbf{area} ABC, \mathbf{area} CLK = z(1 - y) \mathbf{area} ABC$.

Now the problem has nothing to do with geometry anymore: we just have to show that given three numbers $x, y, z, \in (0, 1)$, at least one of $x(1 - z), y(1 - x), z(1 - y)$ is $\le \frac{1}{4}$.

If $y(1 - x) \le \frac{1}{4}$, we are done. Otherwise, we have $y(1 - x) > \frac{1}{4}$. It follows that $y > \frac{1}{4(1 - x)}$ (recall that $0 < x, y, z < 1$). In particular, it follows that $\frac{1}{4(1 - x)} < 1$, which implies $3 - 4x > 0$.

If $z(1 - y) \le \frac{1}{4}$, we are done. Otherwise, we have $z(1 - y) > \frac{1}{4}$. Using the inequality on $y$ from the previous paragraph, we have $z \left( 1 - \frac{1}{4(1 - x)} \right) > \frac{1}{4}$, or after a few computations, $z \cdot \frac{3 - 4x}{1 - x} > 1$. Using the observation about $3 - 4x$ from the preceding paragraph, we get $z > \frac{1 - x}{3 - 4x}$.

Now consider $x(1 - z)$. Using the inequality on $z$ from the previous paragraph, we have that $x(1 - z) < x \left( 1 - \frac{1 - x}{3 - 4x} \right)$. To finish the solution to the problem, it is enough to show that $x \cdot \left( 1 - \frac{1 - x}{3 - 4x} \right) \le \frac{1}{4}$.

After some easy computations (and using again that $3 - 4x > 0$), this becomes $3(4x^2 - 4x + 1) \ge 0$, which is true because. $4x^2 - 4x + 1 = (2x - 1)^2$.",349,3
1965p2,"Consider the system of equations \[a_{11}x_1 + a_{12}x_2 + a_{13}x_3 = 0\]\[a_{21}x_1 + a_{22}x_2 + a_{23}x_3 = 0\]\[a_{31}x_1 + a_{32}x_2 + a_{33}x_3 = 0\] with unknowns $x_1$, $x_2$, $x_3$. The coefficients satisfy the conditions:

(a) $a_{11}$, $a_{22}$, $a_{33}$ are positive numbers;

(b) the remaining coefficients are negative numbers;

(c) in each equation, the sum of the coefficients is positive.

Prove that the given system has only the solution $x_1 = x_2 = x_3 = 0$.","Clearly if the $x_i$ are all equal, then they are equal to 0. Now let's assume WLOG that $x_1=0$. If $x_2$ or $x_3$ is 0, then the other is clearly zero, so let's consider the case where neither are 0. $a_{12}$ and $a_{21}$ are negative, so exactly one of $x_2$ or $x_3$ is positive. Unfortunately this means that one of $a_{22}x_2 + a_{23}x_3$ or $a_{32}x_2 + a_{33}x_3 = 0$ is positive and the other is negative, so the equation couldn't possibly be satisfied if $x_2$ or $x_3$ isn't 0. We have covered the case where one of the $x_i$ is 0, now let's assume that none of them are 0.

If two are positive and one is negative, then when the negative $x_i$ is paired with one of the positive $a_i$, the corresponding equation is negative. This is bad. If two are negative and one is positive, then when the positive $x_i$ is paired with one of the positive $a_i$, the corresponding equation is positive. This is also bad. Therefore the $x_i$ all have the same sign.

Case 1: The $x_i$ are all positive. WLOG $x_1\leq x_2\leq x_3$. Now consider the third equation, $a_{31}x_1 + a_{32}x_2 + a_{33}x_3 = 0$. Therefore $x_2(a_{31} +a_{32}+a_{33})+ a_{31}(x_1-x_2)+a_{33}(x_3-x_2)= 0$, but all of the terms on the LHS are non-negative and the first one is positive, so this is impossible.

Case 2: The $x_i$ are all negative. WLOG $x_1\geq x_2\geq x_3$. Consider the third equation, $a_{31}x_1 + a_{32}x_2 + a_{33}x_3 = 0$. Therefore $x_3(a_{31}+a_{32}+a_{33})+a_{31}(x_1-x_3)+a_{32}(x_2-x_3)=0$, but all of the terms on the LHS are non-positive and the first one is negative, so this is impossible.

Therefore at least one of the $x_i$ is 0, which implies all of them are 0.",285,3
1965p6,In a plane a set of $n$ points ($n\geq 3$) is given. Each pair of points is connected by a segment. Let $d$ be the length of the longest of these segments. We define a diameter of the set to be any connecting segment of length $d$. Prove that the number of diameters of the given set is at most $n$.,"$\mathbf{Definition:}$ For the purpose of this proof, let us define an $equilateral\ arc\ triangle$ as the shape we obtain when we take a triangle $\triangle ABC$ in which we replace the side $AB$ by the $\pi/6$ arc of the circle centered at $C$ with radius $CA = CB$, going from $A$ to $B$, and similarly for the other two sides $BC$ and $AC$.

See the picture below.

Note that if the sides of the original equilateral triangle were of length $d$, then the distance from a vertex to any point on the opposite arc is $d$. Also, the distance between any two points on the arcs, such that none of them are vertices is $< d$. And finally, the distance from a vertex to any point on the arcs adjacent to it (which is not another vertex) is $< d$.

$\mathbf{Lemma:}$ A configuration of $n$ points has exactly $n$ diameters if an only if $3$ of the points are the vertices of an equilateral arc triangle, and the other $n - 3$ are on the boundary of the triangle.

In the configuration shown above, we have $9$ points with $9$ diameters.

$\mathbf{Proof\ of\ the\ Lemma:}$ It is clear that if we have a configuration as described in the lemma then there are $n$ diameters. We will prove the converse by induction. We want to prove that if we have a configuration of $n$ points with $n$ diameters, then the points are in a configuration as described above.

If $n = 3$ it is clear that the $3$ points have to be the vertices of an equilateral triangle since the sides are equal (to $d$). Assume we know the statement to be true for $n$, and prove it for $n + 1$. Assume that we have $n + 1$ points with $n + 1$ diameters $d$. Consider $n$ of the points, and let $Q$ be the remaining point. It follows from the induction hypothesis that $3$ of the $n$ are the vertices of an equilateral arc triangle, and the other $n - 3$ are on the boundary.

Now let us examine where $Q$ may be. It can not be outside of the equilateral arc triangle because then the distance to at least one of the vertices would be $d' > d$, and the diameter of the set would be $d'$ rather than $d$. It can not be inside the triangle because then all the distances from $Q$ to the $n$ points considered are $< d$, and we would not have $n + 1$ diameters, as assumed. So $Q$ must be on the boundary of the equilateral arc triangle, which proves the induction step, and the lemma.

Now the solution to the problem is easy to finish. Assume we have $n$ points given, and the configuration has $m$ diameters. I claim that we can not have $m > n$. We prove this by contradiction. If we did, let us consider a set $S$ consisting of only $n$ of the diameters. Because of the lemma, this implies that the $n$ points form a configuration as described in the lemma, i.e. $3$ of them are the vertices of an equilateral arc triangle, and the other $n - 3$ are on the boundary. Now consider a diameter $D$ which is not in $S$. It is the distance of a segment between two of the points $P_1, P_2$ in the configuration. If one of $P_1, P_2$ is a vertex, then this diameter $D$ is in $S$, which is a contradiction. If none of $P_1, P_2$ are vertices, then the length of $P_1P_2 < d$, so $D = P_1P_2$ is not a diameter, which is again a contradiction.

It follows that $m \le n$ which proves the problem.",621,4
1964p2,"Suppose $a, b, c$ are the sides of a triangle. Prove that

\[a^2(b+c-a)+b^2(c+a-b)+c^2(a+b-c)\le{3abc}.\]","Let $b+c-a = x$, $c+a-b = y$, and $a+b-c = z$. Then, $a = \frac{y+z}{2}$, $b = \frac{x+z}{2}$, and $c = \frac{x+y}{2}$. By AM-GM, \[\frac{x+y}{2} \geq \sqrt{xy},\]\[\frac{y+z}{2} \geq \sqrt{yz},\]\[\textrm{and }\frac{x+z}{2} \geq \sqrt{xz}.\]

Multiplying these equations, we have \[\frac{x+y}{2} \cdot \frac{y+z}{2} \cdot \frac{x+z}{2} \geq xyz\]\[\therefore abc \geq (a+b-c)(b+c-a)(c+a-b).\] We can now simplify: \[(a+b-c)(b+c-a)(c+a-b) \leq abc\]\[(-a^2 + b^2 - c^2 + 2ac)(c+a-b) \leq abc\]\[a(-a^2 + b^2 - c^2 + 2ac) + c(-a^2 + b^2 - c^2 + 2ac) - b(-a^2 + b^2 - c^2 + 2ac) \leq abc\]\[-a^3 + ab^2 - ac^2 + 2a^2c - a^2c + b^2c - c^3 + 2ac^2 + a^2b - b^3 + bc^2 - 2abc \leq abc\]\[a^2b + a^2c - a^3 + b^2c + ab^2 - b^3 + ac^2 + bc^2 - c^3 - 2abc \leq abc\]\[a^2(b+c-a)+b^2(c+a-b)+c^2(a+b-c)\le{3abc}\textrm{. }\square\]",131,2
1964p4,Seventeen people correspond by mail with one another - each one with all the rest. In their letters only three different topics are discussed. Each pair of correspondents deals with only one of these topics. Prove that there are at least three people who write to each other about the same topic.,"Lemma: Consider a complete graph with 6 vertices colored with 2 colors. There exists a monochromatic triangle.

Proof: Consider one vertex and all connections leading out from it. Call it $V_1$. It has 5 edges coming out from it. By the Pigeonhole Principle, there are at least 3 of the same color. Call this color red. Call those vertices $V_2$, $V_3$ and $V_4$. If any of the segments $V_2V_3$, $V_2V_4$, or $V_3V_4$ are red, then we have a monochromatic triangle with vertices $V_1$ and the other two that are also red. If they are all the other color, then we have a monochromatic triangle with vertices $V_2$,$V_3$, and $V_4$. $\blacksquare$



Main Problem: Represent these people as vertices on a connected graph with 17 vertices and colored with 3 colors, one corresponding with each topic. So this problem is reduced to showing that on a connected graph with 17 vertices and colored with three colors, there exists some monochromatic triangle. Look at an arbitrary vertex. Call it $V_1$. Look at the 16 other vertices that it is connected to. By the Pigeonhole Principle, there are at least 6 vertices connected to $V_1$ that are all one color. Call this color 1. If any of the connections inbetween these six vertices are in color 1, then we are done. If none of them are color 1, we know that that there are only 2 colors in those 6 vertices. By Lemma 1, we know that there is a monochromatic triangle in those 6 vertices. So we are done.",256,3
1963p3,"In an $n$-gon all of whose interior angles are equal, the lengths of consecutive sides satisfy the relation

$a_1\ge a_2\ge \cdots \ge a_n$.
Prove that $a_1=a_2=\cdots = a_n$.","Let $a_1 = p_1p_2$, $a_2 = p_2p_3$, etc.

Plot the $n$-gon on the cartesian plane such that $p_1p_2$ is on the $x$-axis and the entire shape is above the $x$-axis. There are two cases: the number of sides is even, and the number of sides is odd:

$\textbf{Case 1: Even}$

In this case, the side with the topmost points will be $p_{\frac{n}{2}+1}p_{\frac{n}{2}+2}$. To obtain the $y$-coordinate of this top side, we can multiply the lengths of the sides $a_1$, $a_2$, ... $a_{\frac{n}{2}}$ by the sine of the angle they make with the $x$-axis:

\[y\textrm{-coordinate} = \sum_{k = 1}^{\frac{n}{2}}a_k \cdot \sin \frac{2\pi(k-1)}{n}.\textbf{ (1)}\]

We can obtain the $y$-coordinate of the top side in a different way by multiplying the lengths of the sides $a_{\frac{n}{2}+1}$, $a_{\frac{n}{2}+2}$, ... $a_n$ by the sine of the angle they make with the $x$-axis to get the $\emph{negated}$ $y$-coordinate of the top side:

\[-y\textrm{-coordinate} = \sum_{k = \frac{n}{2}+1}^{n}a_k \cdot \sin \frac{2\pi(k-1)}{n}\]\[y\textrm{-coordinate} = \sum_{k = \frac{n}{2}+1}^{n}a_k \cdot -\sin \frac{2\pi(k-1)}{n}\]\[= \sum_{k = \frac{n}{2}+1}^{n}a_k \cdot \sin \frac{2\pi(k-\frac{n}{2}-1)}{n}\]\[= \sum_{k = 1}^{\frac{n}{2}}a_{k+\frac{n}{2}} \cdot \sin \frac{2\pi(k-1)}{n}.\textbf{ (2)}\]

It must be true that $\textbf{(1)} = \textbf{(2)}$. This implies that $a_k = a_{k+\frac{n}{2}}$ for all $1 \leq k \leq \frac{n}{2}$, and therefore $a_1=a_2=\cdots = a_n$.

$\textbf{Case 2: Odd}$

This case is very similar to before. We will compute the $y$-coordinate of the top point $p_{frac{n+3}{2}}$ two ways:

\[y\textrm{-coordinate} = \sum_{k = 2}^{\frac{n+1}{2}}a_k \cdot \sin \frac{2\pi(k-1)}{n}.\textbf{ (3)}\]\[-y\textrm{-coordinate} = \sum_{k = \frac{n+3}{2}}^{n}a_k \cdot \sin \frac{2\pi(k-1)}{n}\]\[y\textrm{-coordinate} = \sum_{k = \frac{n+3}{2}}^{n}a_k \cdot -\sin \frac{2\pi(k-1)}{n}\]\[= \sum_{k = \frac{n+3}{2}}^{n}a_k \cdot \sin \frac{2\pi(n - k + 1)}{n}\]\[= \sum_{k = 2}^{\frac{n+1}{2}}a_{n-k+2} \cdot \sin \frac{2\pi(k-1)}{n}.\textbf{ (4)}\]

It must be true that $\textbf{(3)} = \textbf{(4)}$. Then, we get $a_k = a_{n-k+2}$ for all $2 \leq k \leq \frac{n+1}{2}$. Therefore, $a_2=a_3=\cdots = a_n$. It is trivial that $a_1$ is then equal to the other values, so $a_1=a_2=\cdots = a_n$. This completes the proof. $\square$",308,3
1963p5,Prove that $\cos{\frac{\pi}{7}}-\cos{\frac{2\pi}{7}}+\cos{\frac{3\pi}{7}}=\frac{1}{2}$.,"Because the sum of the $x$-coordinates of the seventh roots of unity is $0$, we have

\[\cos{\frac{2\pi}{7}} + \cos{\frac{4\pi}{7}} + \cos{\frac{6\pi}{7}} + \cos{\frac{8\pi}{7}} + \cos{\frac{10\pi}{7}} + \cos{\frac{12\pi}{7}} + \cos{\frac{14\pi}{7}} = 0\]\[\cos{\frac{2\pi}{7}} + \cos{\frac{4\pi}{7}} + \cos{\frac{6\pi}{7}} + \cos{\frac{8\pi}{7}} + \cos{\frac{10\pi}{7}} + \cos{\frac{12\pi}{7}} = -1\]\[\cos{\frac{2\pi}{7}} + \cos{\frac{4\pi}{7}} + \cos{\frac{6\pi}{7}} + \cos{\left(-\frac{6\pi}{7}\right)} + \cos{\left(-\frac{4\pi}{7}\right)} + \cos{\left(-\frac{2\pi}{7}\right)} = -1.\]

Now, we can apply $\cos{x} = \cos{\left(-x\right)}$ to obtain

\[2\left(\cos{\frac{2\pi}{7}} + \cos{\frac{4\pi}{7}} + \cos{\frac{6\pi}{7}}\right) = -1\]\[\cos{\frac{2\pi}{7}} + \cos{\frac{4\pi}{7}} + \cos{\frac{6\pi}{7}} = -\frac{1}{2}.\]

Finally, since $\cos{x} = -\cos{(\pi-x)}$,

\[\cos{\frac{2\pi}{7}} - \cos{\frac{3\pi}{7}} - \cos{\frac{\pi}{7}} = -\frac{1}{2}\]\[\cos{\frac{\pi}{7}} - \cos{\frac{2\pi}{7}} + \cos{\frac{3\pi}{7}} = \frac{1}{2}\textrm{. }\square\]",96,1
1962p6,"Consider an isosceles triangle. Let $r$ be the radius of its circumscribed circle and $\rho$ the radius of its inscribed circle. Prove that the distance $d$ between the centers of these two circles is

$d=\sqrt{r(r-2\rho)}$.","Instead of an isosceles triangle, let us consider an arbitrary triangle $ABC$. Let $ABC$ have circumcenter $O$ and incenter $I$. Extend $AI$ to meet the circumcircle again at $L$. Then extend $LO$ so it meets the circumcircle again at $M$. Consider the point where the incircle meets $AB$, and let this be point $D$. We have $\angle ADI = \angle MBL = 90^{\circ}, \angle IAD = \angle LMB$; thus, $\triangle ADI \sim \triangle MBL$, or $\frac {ID}{BL} = \frac {AI} {ML} \iff ID \cdot ML = 2r\rho = AI \cdot BL$. Now, drawing line $BI$, we see that $\angle BIL = \frac {1}{2}\angle A + \frac {1}{2}\angle ABC, \angle IBL = \frac {1}{2}\angle ABC + \angle CBL = \frac {1}{2}\angle ABC + \frac {1}{2}\angle A$. Therefore, $BIL$ is isosceles, and $IL = BL$. Substituting this back in, we have $2r\rho = AI\cdot IL$. Extending $OI$ to meet the circumcircle at $P,Q$, we see that $AI\cdot IL = PI\cdot QI$ by Power of a Point. Therefore, $2r\rho = PI \cdot QI = (PO + OI)(QO - OI) = (r + d)(r - d)$, and we have $2r\rho = r^2 - d^2 \iff d = \sqrt {r(r - 2\rho)}$, and we are done.",201,2
1962p7,"The tetrahedron $SABC$ has the following property: there exist five spheres, each tangent to the edges $SA, SB, SC, BC, CA, AB$, or to their extensions.

(a) Prove that the tetrahedron $SABC$ is regular.

(b) Prove conversely that for every regular tetrahedron five such spheres exist.","Part (a)

Let points $P_{SA}, P_{SB}, P_{SC}, P_{BC}, P_{CA}, P_{AB}$ be the points where the smallest sphere is tangent to the edges $SA,  SB,  SC,  BC,  CA,  AB$ respectively.

For each face of the tetrahedron there is a circular cross section of the smallest sphere. Since that circle also needs to be tangent to the edges, then that circle is the incircle of each triangular face.

From the properties of an incircle we know that:

$|AP_{AB}|=|AP_{AC}|$, $|BP_{BC}|=|BP_{BA}|$, and $|CP_{CA}|=|CP_{CB}|$ in $\Delta ABC$

There is a larger circle that is tangent to $AB$ and the extensions of $CA$ and $CB$.

This larger circle is a cross section of the sphere that's also tangent to the extension of $CS$ away from $S$ and the edges of $\Delta ABC$

Therefore, this larger circle and the incircle of $\Delta ABC$ are part of that same sphere.

In order for these two circles to be part of the same sphere and also tangent to line $AB$, then the point of the tangent of this larger circle needs to be the same as point $P_{AB}$

The only way these to circles can share the same tangent point on edge $AB$ is if $|AP_{AB}|=|BP_{AB}|$

Using the same argument with the larder circle of edge $BC$ then $|BP_{BC}|=|CP_{BC}|$

and with the larger circle of edge $AC$ then $|CP_{AC}|=|AP_{AC}|$

This results in:

$|AP_{AB}|=|AP_{AC}|=|BP_{BC}|=|BP_{BA}|=|CP_{CA}|=|CP_{CB}|$ in $\Delta ABC$

which means that

$|AB|=|BC|=|AC|$ in $\Delta ABC$, thus $\Delta ABC$ is an equilteral triangle.

Likewise,

$|AB|=|BS|=|AS|$ in $\Delta ABS$, thus $\Delta ABS$ is an equilteral triangle.

$|AS|=|SC|=|AC|$ in $\Delta ASC$, thus $\Delta ASC$ is an equilteral triangle.

$|SB|=|BC|=|SC|$ in $\Delta SBC$, thus $\Delta SBC$ is an equilteral triangle.

Since all four faces are equilateral triangles, then tetrahedron $ABCS$ is a regular tetrahedron.



Part (b)

Let's consider a regular tetrahedron in the cartesian space with center at $(0,0,0)$ with $r_c$ as the circumradius.

We can write the coordinates for the four vertices as:

$V_1=\left( \frac{2\sqrt{2}}{3}r_c ,\;0,\;-\frac{r_c}{3}\right)$

$V_2=\left( -\frac{\sqrt{2}}{3}r_c ,\;\frac{\sqrt{6}}{3}r_c,\;\frac{-r_c}{3}\right)$

$V_3=\left( -\frac{\sqrt{2}}{3}r_c ,\;-\frac{\sqrt{6}}{3}r_c,\;\frac{-r_c}{3}\right)$

$V_4=\left(0 ,\;0,\;r_c\right)$

And the midpoints of all edges as:

$M_{12}=\frac{V_1-V_2}{2}=\left( \frac{\sqrt{2}}{6}r_c ,\;\frac{\sqrt{6}}{6}r_c,\;-\frac{r_c}{3}\right)$

$M_{13}=\frac{V_1-V_3}{2}=\left( \frac{\sqrt{2}}{6}r_c ,\;-\frac{\sqrt{6}}{6}r_c,\;-\frac{r_c}{3}\right)$

$M_{23}=\frac{V_2-V_3}{2}=\left( -\frac{\sqrt{2}}{3}r_c ,\;0,\;-\frac{r_c}{3}\right)$

$M_{14}=\frac{V_1-V_4}{2}=\left( \frac{\sqrt{2}}{3}r_c ,\;0,\;\frac{r_c}{3}\right)$

$M_{24}=\frac{V_2-V_4}{2}=\left( -\frac{\sqrt{2}}{6}r_c ,\;\frac{\sqrt{6}}{6}r_c,\;\frac{r_c}{3}\right)$

$M_{34}=\frac{V_3-V_4}{2}=\left( -\frac{\sqrt{2}}{6}r_c ,\;-\frac{\sqrt{6}}{6}r_c,\;\frac{r_c}{3}\right)$

Now we calculate the following six dot products:

$(V_1-V_2) \bullet M_{12}=\left( -\sqrt{2}r_c \right)\left( \frac{\sqrt{2}}{6}r_c \right)+ \left(  \frac{\sqrt{6}}{3}r_c\right)\left( \frac{\sqrt{6}}{6}r_c \right)+ 0=-\frac{1}{3}r_c^2+\frac{1}{3}r_c^2=0$

$(V_1-V_3) \bullet M_{13}=\left( -\sqrt{2}r_c \right)\left( \frac{\sqrt{2}}{6}r_c \right)+ \left(-  \frac{\sqrt{6}}{3}r_c\right)\left( -\frac{\sqrt{6}}{6}r_c \right)+ 0=-\frac{1}{3}r_c^2+\frac{1}{3}r_c^2=0$

$(V_2-V_3) \bullet M_{23}=0+\left(-  \frac{\sqrt{6}}{6}r_c\right)\left( 0\right)+ 0=0$

$(V_1-V_4) \bullet M_{13}=\left( 2\frac{\sqrt{2}}{3}r_c \right)\left( \frac{\sqrt{2}}{3}r_c \right)+0+ \left(-  \frac{4}{3}r_c\right)\left( \frac{1}{3}r_c \right)=\frac{4}{9}r_c^2-\frac{4}{9}r_c^2=0$

$(V_2-V_4) \bullet M_{13}=\left( -\frac{\sqrt{2}}{3}r_c \right)\left( -\frac{\sqrt{2}}{6}r_c \right)+\left( \frac{\sqrt{6}}{3}r_c \right)\left( \frac{\sqrt{6}}{6}r_c \right)+ \left(-  \frac{4}{3}r_c\right)\left( \frac{1}{3}r_c \right)=\frac{1}{9}r_c^2+\frac{1}{3}r_c^2-\frac{4}{9}r_c^2=0$

$(V_3-V_4) \bullet M_{13}=\left( -\frac{\sqrt{2}}{3}r_c \right)\left( -\frac{\sqrt{2}}{6}r_c \right)+\left( -\frac{\sqrt{6}}{3}r_c \right)\left( -\frac{\sqrt{6}}{6}r_c \right)+ \left(-  \frac{4}{3}r_c\right)\left( \frac{1}{3}r_c \right)=\frac{1}{9}r_c^2+\frac{1}{3}r_c^2-\frac{4}{9}r_c^2=0$

Since all these dot producs equal to $0$ that means that the lines from the center to each of the midpoints are all perpendicular.

Now we calculate the distances from $(0,0,0)$ to all the midpoints:

$|M_{12}|=\sqrt{\left( \frac{\sqrt{2}}{6}r_c\right)^2+\left(\frac{\sqrt{6}}{6}r_c\right)^2+\left(-\frac{r_c}{3}\right)^2}=\frac{\sqrt{3}}{3}r_c$

$|M_{13}|=\sqrt{\left( \frac{\sqrt{2}}{6}r_c\right)^2+\left(-\frac{\sqrt{6}}{6}r_c\right)^2+\left(-\frac{r_c}{3}\right)^2}=\frac{\sqrt{3}}{3}r_c$

$|M_{23}|=\sqrt{\left( -\frac{\sqrt{2}}{3}r_c\right)^2+\left(0\right)^2+\left(-\frac{r_c}{3}\right)^2}=\frac{\sqrt{3}}{3}r_c$

$|M_{14}|=\sqrt{\left( \frac{\sqrt{2}}{3}r_c\right)^2+\left(0\right)^2+\left(\frac{r_c}{3}\right)^2}=\frac{\sqrt{3}}{3}r_c$

$|M_{24}|=\sqrt{\left( -\frac{\sqrt{2}}{6}r_c\right)^2+\left(\frac{\sqrt{6}}{6}r_c\right)^2+\left(\frac{r_c}{3}\right)^2}=\frac{\sqrt{3}}{3}r_c$

$|M_{34}|=\sqrt{\left( -\frac{\sqrt{2}}{6}r_c\right)^2+\left(-\frac{\sqrt{6}}{6}r_c\right)^2+\left(\frac{r_c}{3}\right)^2}=\frac{\sqrt{3}}{3}r_c$

Since all distances are all the same and all dot products are $0$, then we have our first sphere at $(0,0,0)$ with a radius of $\frac{\sqrt{3}}{3}r_c$

Now we will look at the other 4 spheres.

Let $E_{ij}$ be the point of tangent of the larger sphere on the extension of line $V{i}V{j}$ in the direction of $V{i}$ to $V{j}$ and beyond $V{j}$ for $i=1,2,3,4$; $j=1,2,3,4$; and $i \ne j$

Since $|V_j E_{ij}|=|V_j M_{ij}|=\frac{1}{2} |V_j V_i|$, then $\frac{1}{2}(V_j-V_i)=E_{ij}-V_j$, thus $E_{ij}=\frac{3V_j-V_i}{2}$

Using this formula we calculate the following:

$E_{41}=\left( \sqrt{2} r_c ,\;0,\;-r_c \right)$

$E_{42}=\left( -\frac{\sqrt{2}}{2}r_c ,\;\frac{\sqrt{6}}{2}r_c,\;-r_c \right)$

$E_{43}=\left( -\frac{\sqrt{2}}{2}r_c ,\;-\frac{\sqrt{6}}{2}r_c,\;-r_c \right)$

We will start with the sphere below the base of the tetrahedron opposite of vertex $V_{4}$ below $\Delta V{1}V{2}V{3}$

The center of this larger sphere is at $C_1=(0,0,-2r_c)$ and it is tangent at points $M_{12}, M_{13}, M_{23}, E_{41}, E_{42}, E_{43}$

We calculate the following dot products:

$(V_1-V_2) \bullet (M_{12}-C_1)=\left( -\sqrt{2}r_c \right)\left( \frac{\sqrt{2}}{6}r_c \right)+ \left(  \frac{\sqrt{6}}{3}r_c\right)\left( \frac{\sqrt{6}}{6}r_c \right)+ 0=-\frac{1}{3}r_c^2+\frac{1}{3}r_c^2=0$

$(V_1-V_3) \bullet (M_{13}-C_1)=\left( -\sqrt{2}r_c \right)\left( \frac{\sqrt{2}}{6}r_c \right)+ \left(-  \frac{\sqrt{6}}{3}r_c\right)\left( -\frac{\sqrt{6}}{6}r_c \right)+ 0=-\frac{1}{3}r_c^2+\frac{1}{3}r_c^2=0$

$(V_2-V_3) \bullet (M_{23}-C_1)=0+\left(-  \frac{\sqrt{6}}{6}r_c\right)\left( 0\right)+ 0=0$

$(E_{41}-V_4) \bullet (E_{41}-C_1) = \left( \sqrt{2}r_c \right)^2+0+\left( -2r_c \right)\left( -r_c+2r_c \right)=2r_c^2-2r_c^2=0$

$(E_{42}-V_4) \bullet (E_{42}-C_1) = \left( -\frac{\sqrt{2}}{2}r_c \right)^2+\left( \frac{\sqrt{6}}{2}r_c \right)^2+\left( -2r_c \right)\left( -r_c+2r_c \right)=2r_c^2-2r_c^2=0$

$(E_{43}-V_4) \bullet (E_{43}-C_1) = \left( -\frac{\sqrt{2}}{2}r_c \right)^2+\left( -\frac{\sqrt{6}}{2}r_c \right)^2+\left( -2r_c \right)\left( -r_c+2r_c \right)=2r_c^2-2r_c^2=0$

Since all these dot producs equal to $0$ that means that the lines from the center $C_1$ to each of the point $M_{12}, M_{13}, M_{23}, E_{41}, E_{42}, E_{43}$ are all perpendicular.

Now we calculate the distances from $C_1=(0,0,-2r_c)$ to points $M_{12}, M_{13}, M_{23}, E_{41}, E_{42}, E_{43}$

$|C_1M_{12}|=\sqrt{\left( \frac{\sqrt{2}}{6}r_c\right)^2+\left(\frac{\sqrt{6}}{6}r_c\right)^2+\left(-\frac{5}{3}r_c\right)^2}=\sqrt{3}r_c$

$|C_1M_{13}|=\sqrt{\left( \frac{\sqrt{2}}{6}r_c\right)^2+\left(-\frac{\sqrt{6}}{6}r_c\right)^2+\left(-\frac{5}{3}r_c\right)^2}=\sqrt{3}r_c$

$|C_1M_{23}|=\sqrt{\left( -\frac{\sqrt{2}}{3}r_c\right)^2+\left(0\right)^2+\left(-\frac{5}{3}r_c\right)^2}=\sqrt{3}r_c$

$|C_1E_{41}|=\sqrt{\left( \sqrt{2}r_c\right)^2+\left(0\right)^2+\left(-r_c\right)^2}=\sqrt{3}r_c$

$|C_1E_{42}|=\sqrt{\left( -\frac{\sqrt{2}}{2}r_c\right)^2+\left(\frac{\sqrt{6}}{2}r_c\right)^2+\left(-r_c\right)^2}=\sqrt{3}r_c$

$|C_1E_{43}|=\sqrt{\left( -\frac{\sqrt{2}}{2}r_c\right)^2+\left(-\frac{\sqrt{6}}{2}r_c\right)^2+\left(-r_c\right)^2}=\sqrt{3}r_c$

Since all distances are all the same and all dot products are $0$, then we have one of the larger spheres at $(0,0,-2r_c)$ with a radius of $\sqrt{3}r_c$

Then, the other three larger spheres which are the same size as the sphere with center at $C_1$ are congruent and tangent to their respective sides near the other faces of the tetrahedron.

and this proves that a tetrahedron with any circumradius $r_c$ will have these 5 spheres, one with radius $\frac{\sqrt{3}}{3}r_c$, at the center of the tetrahedron and the other 4 with radius $\sqrt{3}r_c$ at centers that are at a distance of $3r_c$ away from any of the vertices of the tetrahedron in the direction from that vertex to the center of its opposite face.

Thus these five spheres exist for any regular tetrahedron.",884,4
1961p4,"In the interior of triangle $P_1P_2P_3$ a point $P$ is given. Let $Q_1,Q_2,Q_3$ be the intersections of $PP_1, PP_2,PP_3$ with the opposing edges of triangle $P_1P_2P_3$. Prove that among the ratios $\frac{PP_1}{PQ_1},\frac{PP_2}{PQ_2},\frac{PP_3}{PQ_3}$ there exists one not larger than $2$ and one not smaller than $2$.
","Let $K_1=[P_2PP_3], K_2=[P_3PP_1],$ and $K_3=[P_1PP_2].$ Note that by same base in triangles $P_2PP_3$ and $P_2P_1P_3,$ \[\frac{P_1P}{PQ_1}+1=\frac{P_1Q_1}{PQ_1}=\frac{[P_2P_1P_3]}{[P_2PP_3]}=\frac{K_1+K_2+K_3}{K_1}.\] Thus, \[\frac{P_1P}{PQ_1}=\frac{K_2+K_3}{K_1}\]\[\frac{P_2P}{PQ_2}=\frac{K_1+K_3}{K_2}\]\[\frac{P_3P}{PQ_3}=\frac{K_1+K_2}{K_3}.\] Without loss of generality, assume $K_1\leq K_2\leq K_3.$ Hence, \[\frac{P_1P}{PQ_1}=\frac{K_2+K_3}{K_1}\geq \frac{K_1+K_1}{K_1}=2\] and \[\frac{P_3P}{PQ_3}=\frac{K_1+K_2}{K+3}\leq \frac{K_3+K_3}{K_3}=2,\] as desired.",34,1
1960p3,"In a given right triangle $ABC$, the hypotenuse $BC$, of length $a$, is divided into $n$ equal parts ($n$ an odd integer). Let $\alpha$ be the acute angle subtending, from $A$, that segment which contains the midpoint of the hypotenuse. Let $h$ be the length of the altitude to the hypotenuse of the triangle. Prove that:

$\tan{\alpha}=\frac{4nh}{(n^2-1)a}.$","Let $D$ and $E$ be points on $BC$ such that $\alpha=\angle DAE$, $D$ is closer to $B$ than to $C$, and $E$ is closer to $C$ than $B$. Furthermore, let $\alpha_1=\angle BAD$ and $\alpha_2=\angle CAE$, and let $\beta=\angle B$ and $\gamma=\angle C$. Applying Law of Sines on $\triangle BAD$ yields

Similarly, $\tan\alpha_2=\frac{c(n-1)}{b(n+1)}$. Next, we use the sum of tangents formula:

Since $\alpha+\alpha_1+\alpha_2=90^\circ$, we need to find $\tan\alpha=\tan\left(\frac{\pi}{2}-(\alpha_1+\alpha_2)\right)$. This is equal to $\cot(\alpha_1+\alpha_2)$, which is the reciprocal of $\tan(\alpha_1+\alpha_2)$, or $\frac{4nbc}{(b^2+c^2)(n^2-1)}$. Since $bc=ah$ due to triangle areas and $a^2=b^2+c^2$ due to the Pythagorean Theorem, we conclude that the expression is equal to $\frac{4nah}{a^2(n^2-1)}$, which simplifies to $\frac{4nh}{(n^2-1)a}$.",106,2
