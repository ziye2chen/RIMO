problem_id,problem,solution,number_of_parts,sub-problem1,sub-solution1,sub-problem2,sub-solution2,sub-problem3,sub-solution3,sub-problem4,sub-solution4
2023a2,"Let $\mathbb{R}$ be the set of real numbers. Let $f: \mathbb{R} \rightarrow \mathbb{R}$ be a function such that

$$
f(x+y) f(x-y) \geqslant f(x)^{2}-f(y)^{2}
$$

for every $x, y \in \mathbb{R}$. Assume that the inequality is strict for some $x_{0}, y_{0} \in \mathbb{R}$.\\
Prove that $f(x) \geqslant 0$ for every $x \in \mathbb{R}$ or $f(x) \leqslant 0$ for every $x \in \mathbb{R}$.","We introduce the new variables $s:=x+y$ and $t:=x-y$. Equivalently, $x=\frac{s+t}{2}$ and $y=\frac{s-t}{2}$. The inequality becomes

$$
f(s) f(t) \geqslant f\left(\frac{s+t}{2}\right)^{2}-f\left(\frac{s-t}{2}\right)^{2}
$$

for every $s, t \in \mathbb{R}$. We replace $t$ by $-t$ to obtain

$$
f(s) f(-t) \geqslant f\left(\frac{s-t}{2}\right)^{2}-f\left(\frac{s+t}{2}\right)^{2}
$$

Summing the previous two inequalities gives

$$
f(s)(f(t)+f(-t)) \geqslant 0
$$

for every $s, t \in \mathbb{R}$. This inequality is strict for $s=x_{0}+y_{0}$ and $t=x_{0}-y_{0}$ by assumption. In particular, there exists some $t_{0}=x_{0}-y_{0}$ for which $f\left(t_{0}\right)+f\left(-t_{0}\right) \neq 0$. Since $f(s)\left(f\left(t_{0}\right)+\right.$ $\left.f\left(-t_{0}\right)\right) \geqslant 0$ for every $s \in \mathbb{R}$, we conclude that $f(s)$ must have constant sign.",1,"Let $\mathbb{R}$ be the set of real numbers. Let $f: \mathbb{R} \rightarrow \mathbb{R}$ be a function such that

$$
f(x+y) f(x-y) \geqslant f(x)^{2}-f(y)^{2}
$$

for every $x, y \in \mathbb{R}$. Assume that the inequality is strict for some $x_{0}, y_{0} \in \mathbb{R}$.\\
Prove that $f(x) \geqslant 0$ for every $x \in \mathbb{R}$ or $f(x) \leqslant 0$ for every $x \in \mathbb{R}$.","We introduce the new variables $s:=x+y$ and $t:=x-y$. Equivalently, $x=\frac{s+t}{2}$ and $y=\frac{s-t}{2}$. The inequality becomes

$$
f(s) f(t) \geqslant f\left(\frac{s+t}{2}\right)^{2}-f\left(\frac{s-t}{2}\right)^{2}
$$

for every $s, t \in \mathbb{R}$. We replace $t$ by $-t$ to obtain

$$
f(s) f(-t) \geqslant f\left(\frac{s-t}{2}\right)^{2}-f\left(\frac{s+t}{2}\right)^{2}
$$

Summing the previous two inequalities gives

$$
f(s)(f(t)+f(-t)) \geqslant 0
$$

for every $s, t \in \mathbb{R}$. This inequality is strict for $s=x_{0}+y_{0}$ and $t=x_{0}-y_{0}$ by assumption. In particular, there exists some $t_{0}=x_{0}-y_{0}$ for which $f\left(t_{0}\right)+f\left(-t_{0}\right) \neq 0$. Since $f(s)\left(f\left(t_{0}\right)+\right.$ $\left.f\left(-t_{0}\right)\right) \geqslant 0$ for every $s \in \mathbb{R}$, we conclude that $f(s)$ must have constant sign.",,,,,,
2023a3,"Let $x_{1}, x_{2}, \ldots, x_{2023}$ be distinct real positive numbers such that

$$
a_{n}=\sqrt{\left(x_{1}+x_{2}+\cdots+x_{n}\right)\left(\frac{1}{x_{1}}+\frac{1}{x_{2}}+\cdots+\frac{1}{x_{n}}\right)}
$$

is an integer for every $n=1,2, \ldots, 2023$. Prove that $a_{2023} \geqslant 3034$.","We start with some basic observations. First note that the sequence $a_{1}, a_{2}, \ldots, a_{2023}$ is increasing and thus, since all elements are integers, $a_{n+1}-a_{n} \geqslant 1$. We also observe that $a_{1}=1$ and

$$
a_{2}=\sqrt{\left(x_{1}+x_{2}\right)\left(\frac{1}{x_{1}}+\frac{1}{x_{2}}\right)}>2
$$

by Cauchy-Schwarz inequality and using $x_{1} \neq x_{2}$. So, $a_{2} \geqslant 3$.\\
Now, we proceed to the main part of the argument. We observe that 3034 is about three halves of 2023. Motivated by this observation, we will prove the following.\\
Claim. If $a_{n+1}-a_{n}=1$, then $a_{n+2}-a_{n+1} \geqslant 2$.\\
In other words, the sequence has to increase by at least 2 at least half of the times. Assuming the claim is true, since $a_{1}=1$, we would be done since

$$
\begin{aligned}
a_{2023} & =\left(a_{2023}-a_{2022}\right)+\left(a_{2022}-a_{2021}\right)+\cdots+\left(a_{2}-a_{1}\right)+a_{1} \\
& \geqslant(2+1) \cdot 1011+1 \\
& =3034
\end{aligned}
$$

We now prove the claim. We start by observing that

$$
\begin{aligned}
a_{n+1}^{2}= & \left(x_{1}+\cdots+x_{n+1}\right)\left(\frac{1}{x_{1}}+\cdots+\frac{1}{x_{n+1}}\right) \\
= & \left(x_{1}+\cdots+x_{n}\right)\left(\frac{1}{x_{1}}+\cdots+\frac{1}{x_{n}}\right)+1 \\
& \quad+\frac{1}{x_{n+1}}\left(x_{1}+\cdots+x_{n}\right)+x_{n+1}\left(\frac{1}{x_{1}}+\cdots+\frac{1}{x_{n}}\right) \\
\geqslant & a_{n}^{2}+1+2 \sqrt{\frac{1}{x_{n+1}}\left(x_{1}+\cdots+x_{n}\right) \cdot x_{n+1}\left(\frac{1}{x_{1}}+\cdots+\frac{1}{x_{n}}\right)} \\
= & a_{n}^{2}+1+2 a_{n} \\
= & \left(a_{n}+1\right)^{2}
\end{aligned}
$$

where we used AM-GM to obtain the inequality. In particular, if $a_{n+1}=a_{n}+1$, then


\begin{equation*}
\frac{1}{x_{n+1}}\left(x_{1}+\cdots+x_{n}\right)=x_{n+1}\left(\frac{1}{x_{1}}+\cdots+\frac{1}{x_{n}}\right) . \tag{1}
\end{equation*}


Now, assume for the sake of contradiction that both $a_{n+1}=a_{n}+1$ and $a_{n+2}=a_{n+1}+1$ hold. In this case, (1) gives

$$
\frac{1}{x_{n+2}}\left(x_{1}+\cdots+x_{n+1}\right)=x_{n+2}\left(\frac{1}{x_{1}}+\cdots+\frac{1}{x_{n+1}}\right) .
$$

We can rewrite this relation as

$$
\frac{x_{n+1}}{x_{n+2}}\left(\frac{1}{x_{n+1}}\left(x_{1}+\cdots+x_{n}\right)+1\right)=\frac{x_{n+2}}{x_{n+1}}\left(x_{n+1}\left(\frac{1}{x_{1}}+\cdots+\frac{1}{x_{n}}\right)+1\right)
$$

From (1) again, we conclude that $x_{n+1}=x_{n+2}$ which is a contradiction.",2,"Let the sequence $a_n$ be defined as in the problem. Show that if $a_{n+1} - a_n = 1$ for some $n \ge 1$, then $a_{n+2} - a_{n+1} \ge 2$.","We have the identity $a_{k+1}^2 = (\sum_{i=1}^{k+1} x_i)(\sum_{i=1}^{k+1} \frac{1}{x_i}) = a_k^2 + 1 + (\sum_{i=1}^k x_i)\frac{1}{x_{k+1}} + x_{k+1}(\sum_{i=1}^k \frac{1}{x_i})$. By AM-GM inequality, $(\sum_{i=1}^k x_i)\frac{1}{x_{k+1}} + x_{k+1}(\sum_{i=1}^k \frac{1}{x_i}) \ge 2\sqrt{(\sum x_i)(\sum \frac{1}{x_i})} = 2a_k$. Thus, $a_{k+1}^2 \ge a_k^2 + 2a_k + 1 = (a_k+1)^2$, which implies $a_{k+1} \ge a_k+1$. The condition $a_{k+1} - a_k = 1$ is equivalent to the equality case of the AM-GM, which is $(\sum_{i=1}^k x_i)\frac{1}{x_{k+1}} = x_{k+1}(\sum_{i=1}^k \frac{1}{x_i})$. Assume for contradiction that $a_{n+1}-a_n=1$ and $a_{n+2}-a_{n+1}=1$. This means the equality condition holds for both $k=n$ and $k=n+1$. This leads to the equations $\frac{1}{x_{n+1}}\sum_{i=1}^n x_i = x_{n+1}\sum_{i=1}^n \frac{1}{x_i}$ and $\frac{1}{x_{n+2}}\sum_{i=1}^{n+1} x_i = x_{n+2}\sum_{i=1}^{n+1} \frac{1}{x_i}$. Manipulating these two equations leads to $\sum_{i=1}^n \frac{1}{x_i} = -\frac{1}{x_{n+1}}$, a contradiction since all $x_i$ are positive. Thus, two consecutive increments of 1 are not possible. Since $a_{n+2}-a_{n+1}$ must be an integer and at least 1, it follows that if $a_{n+1}-a_n=1$, then $a_{n+2}-a_{n+1} \ge 2$.","Let $x_{1}, x_{2}, \ldots, x_{2023}$ be distinct real positive numbers such that $a_{n}=\sqrt{\left(x_{1}+x_{2}+\cdots+x_{n}\right)\left(\frac{1}{x_{1}}+\frac{1}{x_{2}}+\cdots+\frac{1}{x_{n}}\right)}$ is an integer for every $n=1,2, \ldots, 2023$. Prove that $a_{2023} \geqslant 3034$.","We know $a_1 = 1$. Let $\Delta_n = a_{n+1}-a_n$ for $n=1, \ldots, 2022$. Since the $x_i$ are distinct and positive, $a_n$ is a strictly increasing sequence of integers, so $\Delta_n \ge 1$. From the previous sub-problem, we know that if $\Delta_n=1$, then $\Delta_{n+1} \ge 2$. We have $a_{2023} = a_1 + \sum_{n=1}^{2022} \Delta_n = 1 + \sum_{n=1}^{2022} \Delta_n$. We can group the 2022 differences into 1011 pairs: $(\Delta_{2k-1} + \Delta_{2k})$ for $k=1, \ldots, 1011$. For each pair, if $\Delta_{2k-1} = 1$, then $\Delta_{2k} \ge 2$, so their sum is at least 3. If $\Delta_{2k-1} \ge 2$, then since $\Delta_{2k} \ge 1$, their sum is also at least 3. In all cases, $\Delta_{2k-1} + \Delta_{2k} \ge 3$. Thus, the total sum of the differences is $\sum_{n=1}^{2022} \Delta_n = \sum_{k=1}^{1011} (\Delta_{2k-1} + \Delta_{2k}) \ge \sum_{k=1}^{1011} 3 = 1011 \times 3 = 3033$. Therefore, $a_{2023} = 1 + \sum_{n=1}^{2022} \Delta_n \ge 1 + 3033 = 3034$.",,,,
2023a5,"Let $a_{1}, a_{2}, \ldots, a_{2023}$ be positive integers such that}
\begin{itemize}
  \item $a_{1}, a_{2}, \ldots, a_{2023}$ is a permutation of $1,2, \ldots, 2023$, and
  \item $\left|a_{1}-a_{2}\right|,\left|a_{2}-a_{3}\right|, \ldots,\left|a_{2022}-a_{2023}\right|$ is a permutation of $1,2, \ldots, 2022$.
\end{itemize}

Prove that $\max \left(a_{1}, a_{2023}\right) \geqslant 507$.","Let $N$ be a positive integer and $a_{1}, a_{2}, \ldots, a_{2 N-1}$ be positive integers such that

\begin{itemize}
  \item $a_{1}, a_{2}, \ldots, a_{2 N-1}$ is a permutation of $1,2, \ldots, 2 N-1$, and
  \item $\left|a_{1}-a_{2}\right|,\left|a_{2}-a_{3}\right|, \ldots,\left|a_{2 N-2}-a_{2 N-1}\right|$ is a permutation of $1,2, \ldots, 2 N-2$.
\end{itemize}

Then $a_{1}+a_{2 N-1} \geqslant N+1$ and hence $\max \left(a_{1}, a_{2 N-1}\right) \geqslant\left\lceil\frac{N+1}{2}\right\rceil$.\\
Now we proceed to the proof of the generalised statement. We introduce the notion of score of a number $a \in\{1,2, \ldots, 2 N-1\}$. The score of $a$ is defined to be

$$
s(a):=|a-N| .
$$

Note that, by the triangle inequality,

$$
|a-b| \leqslant|a-N|+|N-b|=s(a)+s(b) .
$$

Considering the sum $\left|a_{1}-a_{2}\right|+\left|a_{2}-a_{3}\right|+\cdots+\left|a_{2 N-2}-a_{2 N-1}\right|$, we find that

$$
\begin{aligned}
(N-1)(2 N-1) & =\left|a_{1}-a_{2}\right|+\left|a_{2}-a_{3}\right|+\cdots+\left|a_{2 N-2}-a_{2 N-1}\right| \\
& \leqslant 2\left(s\left(a_{1}\right)+s\left(a_{2}\right)+\cdots+s\left(a_{2 N-1}\right)\right)-\left(s\left(a_{1}\right)+s\left(a_{2 N-1}\right)\right) \\
& =2 N(N-1)-\left(s\left(a_{1}\right)+s\left(a_{2 N-1}\right)\right) .
\end{aligned}
$$

For the last equality we used that the numbers $s\left(a_{1}\right), s\left(a_{2}\right), \ldots, s\left(a_{2 N-1}\right)$ are a permutation of $0,1,1,2,2, \ldots, N-1, N-1$.

Hence, $s\left(a_{1}\right)+s\left(a_{2 N-1}\right) \leqslant 2 N(N-1)-(N-1)(2 N-1)=N-1$. We conclude that

$$
\left(N-a_{1}\right)+\left(N-a_{2 N-1}\right) \leqslant s\left(a_{1}\right)+s\left(a_{2 N-1}\right) \leqslant N-1,
$$

which implies $a_{1}+a_{2 N-1} \geqslant N+1$.",2,"Let $N$ be a positive integer. Let $a_{1}, a_{2}, \ldots, a_{2N-1}$ be a permutation of $1,2, \ldots, 2N-1$, and let $\\left|a_{1}-a_{2}\right|, \\left|a_{2}-a_{3}\right|, \\ldots, \\left|a_{2N-2}-a_{2N-1}\right|$ be a permutation of $1,2, \ldots, 2N-2$. Prove that $a_{1}+a_{2N-1} \\geqslant N+1$.","Define the score of an integer $k \\in \\{1, \\ldots, 2N-1\\}$ as $s(k) = |k-N|$. The sum of the given absolute differences is $\\sum_{i=1}^{2N-2} i = (N-1)(2N-1)$. Using the triangle inequality, $|a_i - a_{i+1}| \\le s(a_i) + s(a_{i+1})$. Summing over $i=1, \\ldots, 2N-2$ yields $\\sum_{i=1}^{2N-2} |a_i - a_{i+1}| \\le 2\\sum_{k=1}^{2N-1} s(a_k) - (s(a_1) + s(a_{2N-1}))$. The set of scores $\\{s(a_k)\\}$ is a permutation of $\\{0, 1, 1, 2, 2, \\ldots, N-1, N-1\\}$, so their sum is $\\sum s(a_k) = N(N-1)$. Substituting these sums gives $(N-1)(2N-1) \\le 2N(N-1) - (s(a_1) + s(a_{2N-1}))$, which simplifies to $s(a_1) + s(a_{2N-1}) \\le N-1$. We then have $2N - (a_1 + a_{2N-1}) = (N-a_1) + (N-a_{2N-1}) \\le |N-a_1| + |N-a_{2N-1}| = s(a_1) + s(a_{2N-1}) \\le N-1$. From $2N - (a_1+a_{2N-1}) \\le N-1$, we get $a_1+a_{2N-1} \\ge N+1$.","Let $a_{1}, a_{2}, \\ldots, a_{2023}$ be positive integers such that $a_{1}, a_{2}, \\ldots, a_{2023}$ is a permutation of $1,2, \\ldots, 2023$, and $\\left|a_{1}-a_{2}\right|,\\left|a_{2}-a_{3}\right|, \\ldots,\\left|a_{2022}-a_{2023}\right|$ is a permutation of $1,2, \\ldots, 2022$. Prove that $\\max \\left(a_{1}, a_{2023}\right) \\geqslant 507$.","This problem is a specific case of the generalized statement proved in the first sub-problem, with $2N-1 = 2023$, which gives $N=1012$. From the result of the first sub-problem, we know that $a_1 + a_{2N-1} \\ge N+1$. Substituting $N=1012$ and using the indices from the original problem, we get $a_1 + a_{2023} \\ge 1012+1 = 1013$. Since $2 \\max(a_1, a_{2023}) \\ge a_1 + a_{2023}$, it follows that $2 \\max(a_1, a_{2023}) \\ge 1013$. This implies $\\max(a_1, a_{2023}) \\ge \frac{1013}{2} = 506.5$. As $a_1$ and $a_{2023}$ are integers, $\\max(a_1, a_{2023})$ must also be an integer. Therefore, $\\max(a_1, a_{2023}) \\ge \\lceil 506.5 \rceil = 507$.",,,,
2023a7,"Let $N$ be a positive integer. Prove that there exist three permutations $a_{1}, a_{2}, \ldots, a_{N}$; $b_{1}, b_{2}, \ldots, b_{N}$; and $c_{1}, c_{2}, \ldots, c_{N}$ of $1,2, \ldots, N$ such that

$$
\left|\sqrt{a_{k}}+\sqrt{b_{k}}+\sqrt{c_{k}}-2 \sqrt{N}\right|<2023
$$

for every $k=1,2, \ldots, N$.","The idea is to approximate the numbers $\sqrt{1}, \sqrt{2}, \ldots, \sqrt{N}$ by the nearest integer with errors $<0.5$. This gives the following sequence

$$
1,1,2,2,2,2,3,3,3,3,3,3,4, \ldots
$$

More precisely, for each $k \geqslant 1$, we round $\sqrt{k^{2}-k+1}, \ldots, \sqrt{k^{2}+k}$ to $k$, so that there are $2 k$ copies of $k$.

Step 1. We first consider the easier case when $N$ has the form

$$
N=m(m+1) .
$$

In this case, the numbers $\sqrt{1}, \sqrt{2}, \ldots, \sqrt{N}$ are approximated by the elements of the multiset $\left\{1_{\times 2}, 2_{\times 4}, 3_{\times 6}, \ldots, m_{\times 2 m}\right\}$. Let $T_{m}$ denote ""half of"" the multiset, i.e.

$$
T_{m}:=\left\{1_{\times 1}, 2_{\times 2}, 3_{\times 3}, \ldots, m_{\times m}\right\} .
$$

We will prove by induction that there exists three permutations $\left(u_{k}\right),\left(v_{k}\right)$, and $\left(w_{k}\right)$ of the elements in the multiset $T_{m}$ such that $u_{k}+v_{k}+w_{k}=2 m+1$ is constant for $k=1,2, \ldots, \frac{m(m+1)}{2}$.

When $m=1$, take $1+1+1=3$. When $m=2$, take $(1,2,2)+(2,1,2)+(2,2,1)=(5,5,5)$. Suppose that we have constructed three permutations $\left(u_{k}\right),\left(v_{k}\right)$, and ( $w_{k}$ ) of $T_{m-1}$ satisfying $u_{k}+v_{k}+w_{k}=2 m-1$ for every $k=1,2, \ldots, \frac{m(m-1)}{2}$. For $T_{m}$, we note that

$$
T_{m}=T_{m-1} \sqcup\left\{m_{\times m}\right\},
$$

and also


\begin{equation*}
T_{m}=\left(T_{m-1}+1\right) \sqcup\{1,2, \ldots, m\} . \tag{1}
\end{equation*}


Here $T_{m-1}+1$ means to add 1 to all elements in $T_{m-1}$. We construct the permutations $\left(u_{k}^{\prime}\right)$, $\left(v_{k}^{\prime}\right)$, and ( $w_{k}^{\prime}$ ) of $T_{m}$ as follows:

\begin{itemize}
  \item For $k=1,2, \ldots, \frac{m(m-1)}{2}$, we set $u_{k}^{\prime}=u_{k}, v_{k}^{\prime}=v_{k}+1, w_{k}^{\prime}=w_{k}+1$.
  \item For $k=\frac{m(m-1)}{2}+r$ with $r=1,2, \ldots, m$, we set $u_{k}^{\prime}=m, v_{k}^{\prime}=r, w_{k}^{\prime}=m+1-r$.
\end{itemize}

It is clear from (1) that $\left(u_{k}^{\prime}\right),\left(v_{k}^{\prime}\right)$, and $\left(w_{k}^{\prime}\right)$ give three permutations of $T_{m}$, and that they satisfy $u_{k}^{\prime}+v_{k}^{\prime}+w_{k}^{\prime}=2 m+1$ for every $k=1,2, \ldots, \frac{m(m+1)}{2}$.

The inductive construction can be visualised by the $3 \times \frac{m(m+1)}{2}$ matrix

$$
\left[\begin{array}{cccccc}
u_{1} & \ldots & u_{m(m-1) / 2} & m & \ldots & m \\
v_{1}+1 & \ldots & v_{m(m-1) / 2}+1 & 1 & \ldots & m \\
w_{1}+1 & \ldots & w_{m(m-1) / 2}+1 & m & \ldots & 1
\end{array}\right],
$$

in which the three rows represent the permutations $\left(u_{k}^{\prime}\right),\left(v_{k}^{\prime}\right),\left(w_{k}^{\prime}\right)$, and the sum of the three entries of each column is $2 m+1$.

Thus, when $N=m^{2}+m$, we can construct permutations $\left(a_{k}\right),\left(b_{k}\right)$, and $\left(c_{k}\right)$ of $1,2, \ldots, N$ such that


\begin{equation*}
2 m+1-1.5<\sqrt{a_{k}}+\sqrt{b_{k}}+\sqrt{c_{k}}<2 m+1+1.5 \tag{2}
\end{equation*}


This gives

$$
\left|\sqrt{a_{k}}+\sqrt{b_{k}}+\sqrt{c_{k}}-2 \sqrt{N}\right|<2.5<2023
$$

where we used that $-1<2 m-2 \sqrt{m^{2}+m}<0$ for positive $m$.\\
Step 2. We now proceed to the general case. Let $m$ be such that

$$
m(m+1) \leqslant N<(m+1)(m+2)
$$

Write $N=m(m+1)+t$ for some $t \in\{0,1, \ldots, 2 m+1\}$ and let

$$
L:=\left\lfloor\frac{4}{9} N\right\rfloor .
$$

We will make use of the following inequalities below:

$$
N>m^{2}, \quad N<(m+2)^{2}, \quad t \leqslant 2 m+1, \quad L+1>4 N / 9, \quad L \leqslant 4 N / 9
$$

As above, we construct three permutations $\left(a_{k}\right),\left(b_{k}\right)$, and $\left(c_{k}\right)$ of $1,2, \ldots, m(m+1)$ satisfying (2). Now we construct the three required permutations $\left(A_{k}\right),\left(B_{k}\right)$, and $\left(C_{k}\right)$ of $1,2, \ldots, N$ as follows:

For $k=1,2, \ldots, m(m+1)$, if $a_{k} \leqslant L$, take $A_{k}=a_{k}$, and if $a_{k}>L$, take $A_{k}=a_{k}+t$. For $k=m(m+1)+r$ with $r=1,2, \ldots, t$, set $A_{k}=L+r$. Define the permutations $\left(B_{k}\right)$ and $\left(C_{k}\right)$ similarly. Now for $k=1,2, \ldots, m(m+1)$, we show $0 \leqslant \sqrt{A_{k}}-\sqrt{a_{k}} \leqslant 2$. The lower bound is obvious. If $m \leqslant 1$, then $N \leqslant 5$ and hence $\sqrt{A_{k}}-\sqrt{a_{k}} \leqslant \sqrt{5}-\sqrt{1} \leqslant 2$. If $m \geqslant 2$, then

$$
\sqrt{A_{k}}-\sqrt{a_{k}}=\frac{A_{k}-a_{k}}{\sqrt{A_{k}}+\sqrt{a_{k}}} \leqslant \frac{t}{2 \sqrt{L+1}} \leqslant \frac{2 m+1}{\frac{4}{3} m} \leqslant 2
$$

We have similar inequalities for $\left(B_{k}\right)$ and $\left(C_{k}\right)$. Thus

$$
2 \sqrt{N}-4.5<2 m+1-1.5 \leqslant \sqrt{A_{k}}+\sqrt{B_{k}}+\sqrt{C_{k}} \leqslant 2 m+1+1.5+6<2 \sqrt{N}+8.5
$$

For $k=m^{2}+m+1, \ldots, m^{2}+m+t$, we have

$$
2 \sqrt{N}<3 \sqrt{L+1} \leqslant \sqrt{A_{k}}+\sqrt{B_{k}}+\sqrt{C_{k}} \leqslant 3 \sqrt{L+t} \leqslant \sqrt{4 N+9 t}<2 \sqrt{N}+8.5
$$

To sum up, we have defined three permutations $\left(A_{k}\right),\left(B_{k}\right)$, and $\left(C_{k}\right)$ of $1,2, \ldots, N$, such that

$$
\left|\sqrt{A_{k}}+\sqrt{B_{k}}+\sqrt{C_{k}}-2 \sqrt{N}\right|<8.5<2023
$$

holds for every $k=1,2, \ldots, N$.",4,"Let $T_m$ be the multiset $\{1_{\times 1}, 2_{\times 2}, \\ldots, m_{\times m}\}$. Prove that there exist three permutations $(u_k), (v_k), (w_k)$ of the elements in $T_m$ such that $u_k+v_k+w_k = 2m+1$ for all $k=1, \\ldots, \frac{m(m+1)}{2}$.","We proceed by induction on $m$. The base cases $m=1,2$ are trivial. Assume the statement holds for $m-1$, giving permutations $(u'_j), (v'_j), (w'_j)$ of $T_{m-1}$ with sum $2m-1$. To construct the permutations for $T_m$, we define them in two parts. For $k=1, \\ldots, \frac{m(m-1)}{2}$, set $u_k=u'_k, v_k=v'_k+1, w_k=w'_k+1$. For $k=\frac{m(m-1)}{2}+r$ with $r=1, \\ldots, m$, set $u_k=m, v_k=r, w_k=m+1-r$. The sum is $2m+1$ in both cases. The set of all constructed $\{u_k\}$ is $T_{m-1} \\sqcup \\{m_{\times m}\\} = T_m$. The set of all $\{v_k\}$ and $\{w_k\}$ is $(T_{m-1}+1) \\sqcup \\{1, \\ldots, m\\}$, which is also equal to $T_m$. Thus, these are valid permutations.","For any integer $m \\ge 1$, let $N=m(m+1)$. Prove that there exist three permutations $(a_k), (b_k), (c_k)$ of $\{1, \\ldots, N\}$ such that $|\\sqrt{a_k}+\\sqrt{b_k}+\\sqrt{c_k}-2\\sqrt{N}| < 3$.","For $j \\in \\{1, \\ldots, N\\}$, let $r(j) = \text{round}(\\sqrt{j})$. The multiset of these rounded values is $\\{1_{\times 2}, 2_{\times 4}, \\ldots, m_{\times 2m}\\}$. Using the result from Sub-problem 1, we can construct permutations $(U_k), (V_k), (W_k)$ of this multiset such that $U_k+V_k+W_k=2m+1$ for all $k$. We can then define permutations $(a_k), (b_k), (c_k)$ of $\\{1, \\ldots, N\\}$ such that $r(a_k)=U_k$, $r(b_k)=V_k$, and $r(c_k)=W_k$. Since $|\\sqrt{x}-r(x)|<0.5$, we have $|\\sqrt{a_k}+\\sqrt{b_k}+\\sqrt{c_k}-(U_k+V_k+W_k)| < 1.5$, so $|\\sqrt{a_k}+\\sqrt{b_k}+\\sqrt{c_k}-(2m+1)| < 1.5$. Also, $m < \\sqrt{m^2+m} < m+1/2$, which implies $2m < 2\\sqrt{N} < 2m+1$, so $|(2m+1)-2\\sqrt{N}| < 1$. By the triangle inequality, $|\\sqrt{a_k}+\\sqrt{b_k}+\\sqrt{c_k}-2\\sqrt{N}| < 1.5 + 1 = 2.5 < 3$.","Let $N$ be a positive integer and $m$ be an integer such that $N_0 = m(m+1) \\le N < (m+1)(m+2)$. Let $t = N-N_0$. Given permutations $(a'_k), (b'_k), (c'_k)$ of $\{1, \\ldots, N_0\}$, describe a method to construct three permutations $(A_k), (B_k), (C_k)$ of $\{1, \\ldots, N\}$.","Let $L = \\lfloor \frac{4}{9}N \rfloor$. We construct the permutation $(A_k)$ of $\{1, \\ldots, N\}$. For $k=1, \\ldots, N_0$, set $A_k = a'_k$ if $a'_k \\le L$, and $A_k = a'_k+t$ if $a'_k > L$. For $k=N_0+r$ where $r \\in \\{1, \\ldots, t\\}$, set $A_k = L+r$. The set of values $\{A_k\\}_{k=1}^N$ is the union of $\\{1, \\ldots, L\\} \\cup \\{L+t+1, \\ldots, N_0+t\\}$ and $\\{L+1, \\ldots, L+t\\}$, which is exactly $\{1, \\ldots, N\}$. Thus $(A_k)$ is a permutation of $\{1, \\ldots, N\}$. The permutations $(B_k)$ and $(C_k)$ are constructed from $(b'_k)$ and $(c'_k)$ in an identical manner.","Let $N$ be a positive integer. Prove that there exist three permutations $a_{1}, a_{2}, \\ldots, a_{N}$; $b_{1}, b_{2}, \\ldots, b_{N}$; and $c_{1}, c_{2}, \\ldots, c_{N}$ of $1,2, \\ldots, N$ such that\n\n$$\n\\left|\\sqrt{a_{k}}+\\sqrt{b_{k}}+\\sqrt{c_{k}}-2 \\sqrt{N}\right|<2023\n$$\n\nfor every $k=1,2, \\ldots, N$.","Let $m$ be such that $N_0=m(m+1) \\le N < (m+1)(m+2)$. From Sub-problem 2, there are permutations $(a'_k), (b'_k), (c'_k)$ of $\{1, \\ldots, N_0\}$ with $|\\sqrt{a'_k}+\\sqrt{b'_k}+\\sqrt{c'_k}-2\\sqrt{N_0}|<2.5$. We use the construction from Sub-problem 3 to get permutations $(A_k), (B_k), (C_k)$ of $\{1, \\ldots, N\}$. For $k=1, \\ldots, N_0$, the change $|\\sqrt{A_k}-\\sqrt{a'_k}|$ is small (bounded by 2). For $k=N_0+1, \\ldots, N$, the sum $\\sqrt{A_k}+\\sqrt{B_k}+\\sqrt{C_k}$ is constructed to be close to $2\\sqrt{N}$. A detailed error analysis shows that for all $k \\in \\{1, \\ldots, N\\}$, the inequality $|\\sqrt{A_k}+\\sqrt{B_k}+\\sqrt{C_k}-2\\sqrt{N}| < 8.5$ holds. Since $8.5 < 2023$, the proof is complete."
2023c5,"Elisa has 2023 treasure chests, all of which are unlocked and empty at first. Each day, Elisa adds a new gem to one of the unlocked chests of her choice, and afterwards, a fairy acts according to the following rules:

\begin{itemize}
  \item if more than one chests are unlocked, it locks one of them, or
  \item if there is only one unlocked chest, it unlocks all the chests.
\end{itemize}

Given that this process goes on forever, prove that there is a constant $C$ with the following property: Elisa can ensure that the difference between the numbers of gems in any two chests never exceeds $C$, regardless of how the fairy chooses the chests to lock.","We will prove that such a constant $C$ exists when there are $n$ chests for $n$ an odd positive integer. In fact we can take $C=n-1$. Elisa's strategy is simple: place a gem in the chest with the fewest gems (in case there are more than one such chests, pick one arbitrarily).

For each integer $t \geqslant 0$, let $a_{1}^{t} \leqslant a_{2}^{t} \leqslant \cdots \leqslant a_{n}^{t}$ be the numbers of gems in the $n$ chests at the end of the $t^{\text {th }}$ day. In particular, $a_{1}^{0}=\cdots=a_{n}^{0}=0$ and

$$
a_{1}^{t}+a_{2}^{t}+\cdots+a_{n}^{t}=t .
$$

For each $t \geqslant 0$, there is a unique index $m=m(t)$ for which $a_{m}^{t+1}=a_{m}^{t}+1$. We know that $a_{j}^{t}>a_{m(t)}^{t}$ for all $j>m(t)$, since $a_{m(t)}^{t}<a_{m(t)}^{t+1} \leqslant a_{j}^{t+1}=a_{j}^{t}$. Elisa's strategy also guarantees that if an index $j$ is greater than the remainder of $t$ when divided by $n$ (i.e. the number of locked chests at the end of the $t^{\text {th }}$ day), then $a_{j}^{t} \geqslant a_{m(t)}^{t}$, because some chest with at most $a_{j}^{t}$ gems must still be unlocked at the end of the $t^{\text {th }}$ day.

Recall that a sequence $x_{1} \leqslant x_{2} \leqslant \cdots \leqslant x_{n}$ of real numbers is said to majorise another sequence $y_{1} \leqslant y_{2} \leqslant \cdots \leqslant y_{n}$ of real numbers when for all $1 \leqslant k \leqslant n$ we have

$$
x_{1}+x_{2}+\cdots+x_{k} \leqslant y_{1}+y_{2}+\cdots+y_{k}
$$

and

$$
x_{1}+x_{2}+\cdots+x_{n}=y_{1}+y_{2}+\cdots+y_{n} .
$$

Our strategy for proving $a_{n}^{t}-a_{1}^{t} \leqslant n-1$ is to inductively show that the sequence ( $a_{i}^{t}$ ) is majorised by some other sequence ( $b_{i}^{t}$ ).

We define this other sequence $\left(b_{i}^{t}\right)$ as follows. Let $b_{k}^{0}=k-\frac{n+1}{2}$ for $1 \leqslant k \leqslant n$. As $n$ is odd, this is a strictly increasing sequence of integers, and the sum of its terms is 0 . Now define $b_{i}^{t}=b_{i}^{0}+\left\lfloor\frac{t-i}{n}\right\rfloor+1$ for $t \geqslant 1$ and $1 \leqslant i \leqslant n$. Thus for $t \geqslant 0$,

$$
b_{i}^{t+1}=\left\{\begin{array}{lll}
b_{i}^{t} & \text { if } t+1 \not \equiv i & (\bmod n), \\
b_{i}^{t}+1 & \text { if } t+1 \equiv i & (\bmod n) .
\end{array}\right.
$$

From these properties it is easy to see that

\begin{itemize}
  \item $b_{1}^{t}+b_{2}^{t}+\cdots+b_{n}^{t}=t$ for all $t \geqslant 0$, and
  \item $b_{i}^{t} \leqslant b_{i+1}^{t}$ for all $t \geqslant 0$ and $1 \leqslant i \leqslant n-1$, with the inequality being strict if $t \not \equiv i(\bmod n)$.
\end{itemize}

Claim 1. For each $t \geqslant 0$, the sequence of integers $b_{1}^{t}, b_{2}^{t}, \ldots, b_{n}^{t}$ majorises the sequence of integers $a_{1}^{t}, a_{2}^{t}, \ldots, a_{n}^{t}$.

Proof. We use induction on $t$. The base case $t=0$ is trivial. Assume $t \geqslant 0$ and that $\left(b_{i}^{t}\right)$ majorises $\left(a_{i}^{t}\right)$. We want to prove the same holds for $t+1$.

First note that the two sequences $\left(b_{i}^{t+1}\right)$ and $\left(a_{i}^{t+1}\right)$ both sum up to $t+1$. Next, we wish to show that for $1 \leqslant k<n$, we have

$$
b_{1}^{t+1}+b_{2}^{t+1}+\cdots+b_{k}^{t+1} \leqslant a_{1}^{t+1}+a_{2}^{t+1}+\cdots+a_{k}^{t+1} .
$$

When $t+1$ is replaced by $t$, the above inequality holds by the induction hypothesis. For the sake of contradiction, suppose $k$ is the smallest index such that the inequality for $t+1$ fails. Since the left hand side increases by at most 1 during the transition from $t$ to $t+1$, the inequality for $t+1$ can fail only if all of the following occur:

\begin{itemize}
  \item $b_{1}^{t}+b_{2}^{t}+\cdots+b_{k}^{t}=a_{1}^{t}+a_{2}^{t}+\cdots+a_{k}^{t}$,
  \item $t+1 \equiv j(\bmod n)$ for some $1 \leqslant j \leqslant k\left(\right.$ so that $\left.b_{j}^{t+1}=b_{j}^{t}+1\right)$,
  \item $m(t)>k$ (so that $a_{i}^{t+1}=a_{i}^{t}$ for $\left.1 \leqslant i \leqslant k\right)$.
\end{itemize}

The first point and the minimality of $k$ tell us that $b_{1}^{t}, \ldots, b_{k}^{t}$ majorises $a_{1}^{t}, \ldots, a_{k}^{t}$ as well (again using the induction hypothesis), and in particular $b_{k}^{t} \geqslant a_{k}^{t}$.

The second point tells us that the remainder of $t$ when divided by $n$ is at most $k-1$, so $a_{k}^{t} \geqslant a_{m(t)}^{t}$ (by Elisa's strategy). But by the third point $(m(t) \geqslant k+1)$ and the nondecreasing property of $a_{i}^{t}$, we must have the equalities $a_{k}^{t}=a_{k+1}^{t}=a_{m(t)}^{t}$. On the other hand, $a_{k}^{t} \leqslant b_{k}^{t}<b_{k+1}^{t}$, with the second inequality being strict because $t \not \equiv k(\bmod n)$. We conclude that

$$
b_{1}^{t}+b_{2}^{t}+\cdots+b_{k+1}^{t}>a_{1}^{t}+a_{2}^{t}+\cdots+a_{k+1}^{t},
$$

a contradiction to the induction hypothesis.\\
This completes the proof as it implies

$$
a_{n}^{t}-a_{1}^{t} \leqslant b_{n}^{t}-b_{1}^{t} \leqslant b_{n}^{0}-b_{1}^{0}=n-1 .
$$",4,Define Elisa's strategy and an auxiliary sequence $(b_i^t)$. Establish the basic properties that this sequence is non-decreasing and its sum is equal to the total number of gems.,"Elisa's strategy is to always add a gem to a chest with the minimum number of gems. Let $n=2023$. Define an auxiliary sequence $(b_i^t)$ for $t \ge 0$ by setting $b_i^0 = i - \frac{n+1}{2}$ for $1 \\le i \\le n$. For $t \\ge 0$, $(b_i^{t+1})$ is obtained from $(b_i^t)$ by adding 1 to $b_j^t$ where $j \\equiv t+1 \\pmod n$, and keeping other values the same. This construction ensures two properties for all $t \\ge 0$: 1. The sum is $\\sum_{i=1}^n b_i^t = \\sum_{i=1}^n b_i^0 + t = 0 + t = t$. 2. The sequence is non-decreasing, $b_1^t \\le b_2^t \\le \\dots \\le b_n^t$, since $b_{i+1}^0 - b_i^0 = 1$ and the updates preserve the non-decreasing nature.","Let $a_1^t \\le a_2^t \\le \\dots \\le a_n^t$ be the sorted number of gems in the chests. State the majorization hypothesis relating $(a_i^t)$ and $(b_i^t)$, and prove the base case for $t=0$.","We claim that for all $t \\ge 0$, the sequence $(b_i^t)$ majorizes $(a_i^t)$. This means $\\sum_{i=1}^k b_i^t \\le \\sum_{i=1}^k a_i^t$ for all $1 \\le k < n$, and the sums are equal for $k=n$. For the base case $t=0$, we have $a_i^0=0$ for all $i$. The condition $\\sum_{i=1}^n b_i^0 = \\sum_{i=1}^n a_i^0 = 0$ is met. For $1 \\le k < n$, we must check $\\sum_{i=1}^k b_i^0 \\le 0$. The sum is $\\sum_{i=1}^k (i - \frac{n+1}{2}) = \frac{k(k+1)}{2} - k\frac{n+1}{2} = \frac{k(k-n)}{2}$, which is non-positive since $1 \\le k < n$. Thus the base case holds.",Prove by induction on $t$ that the sequence $(b_i^t)$ majorizes the sequence $(a_i^t)$ for all $t \\ge 0$.,"Assume the majorization property holds for $t$. For $t+1$, suppose for contradiction that it fails. Let $k$ be the smallest index such that $\\sum_{i=1}^k b_i^{t+1} > \\sum_{i=1}^k a_i^{t+1}$. This implies (i) $\\sum_{i=1}^k b_i^t = \\sum_{i=1}^k a_i^t$, (ii) $t+1 \\equiv j \\pmod n$ for some $j \\le k$, and (iii) Elisa places the gem in a chest whose sorted index $m(t)$ is greater than $k$. From (iii), Elisa's strategy implies $a_k^t = a_{k+1}^t$. From (i) and the induction hypothesis for $k-1$, we get $a_k^t \\le b_k^t$. From (ii), $t \not\\equiv k \\pmod n$, so $b_k^t < b_{k+1}^t$. Thus, $a_{k+1}^t = a_k^t \\le b_k^t < b_{k+1}^t$. Now consider the sum up to $k+1$: $\\sum_{i=1}^{k+1} a_i^t = \\sum_{i=1}^k a_i^t + a_{k+1}^t = \\sum_{i=1}^k b_i^t + a_{k+1}^t < \\sum_{i=1}^k b_i^t + b_{k+1}^t = \\sum_{i=1}^{k+1} b_i^t$. This contradicts the induction hypothesis that $\\sum_{i=1}^{k+1} b_i^t \\le \\sum_{i=1}^{k+1} a_i^t$. Thus, the majorization holds for $t+1$.","Given that the process goes on forever, prove that there is a constant $C$ with the following property: Elisa can ensure that the difference between the numbers of gems in any two chests never exceeds $C$, regardless of how the fairy chooses the chests to lock.","The majorization of $(a_i^t)$ by $(b_i^t)$ implies $a_n^t - a_1^t \\le b_n^t - b_1^t$. We can bound the difference for the auxiliary sequence. For $t \\ge 0$, $b_n^t - b_1^t$ is either $n-1$ or $n-2$. This is because $b_n^0 - b_1^0 = (n - \frac{n+1}{2}) - (1 - \frac{n+1}{2}) = n-1$, and for $t \ge 1$, the difference $b_n^t - b_1^t$ changes by $\\lfloor\frac{t-n}{n}\rfloor - \\lfloor\frac{t-1}{n}\rfloor$, which is either 0 or -1. Thus, $b_n^t - b_1^t \\le n-1$ for all $t$. The maximum number of gems in a chest is $a_n^t$ and the minimum is $a_1^t$, so their difference is bounded by $n-1$. For $n=2023$, we can take the constant $C=2022$."
2023g1,"Let $A B C D E$ be a convex pentagon such that $\angle A B C=\angle A E D=90^{\circ}$. Suppose that the midpoint of $C D$ is the circumcentre of triangle $A B E$. Let $O$ be the circumcentre of triangle $A C D$.

Prove that line $A O$ passes through the midpoint of segment $B E$.","Let $M$ be the midpoint of $C D$ and $X=B C \cap E D$. Since $\angle A B X=\angle A E X=90^{\circ}, A X$ is a diameter of the circumcircle of $\triangle A B E$ so the midpoint of $A X$ is the circumcentre of $\triangle A B E$. Therefore, the midpoint of $A X$ coincides with $M$. This means $A C X D$ is a parallelogram and in particular, $A D \| B C$ and $A C \| E D$.

We denote the area of $\triangle P_{1} P_{2} P_{3}$ by $\left[P_{1} P_{2} P_{3}\right]$. To prove that line $A O$ bisects $B E$, it suffices to show $[O A B]=[O A E]$.

Let $C^{\prime}, D^{\prime}$ be the midpoints of $A C, A D$ respectively. Since $O D^{\prime} \perp A D, A D \| B C$, and $B C \perp A B$, we have $A B \| O D^{\prime}$, so $[O A B]=\left[D^{\prime} A B\right]$. Using $A D \| B C$ again, we have $\left[D^{\prime} A B\right]=\left[D^{\prime} A C\right]$. Therefore

$$
[O A B]=\left[D^{\prime} A B\right]=\left[D^{\prime} A C\right]=\frac{1}{2}[A C D] .
$$

Similarly

$$
[O A E]=\left[C^{\prime} A E\right]=\left[C^{\prime} A D\right]=\frac{1}{2}[A C D] .
$$

Combining these gives $[O A B]=[O A E]$.",2,"Let $A B C D E$ be a convex pentagon with $\angle A B C=\angle A E D=90^{\circ}$. Let $M$ be the midpoint of $CD$. If $M$ is the circumcentre of triangle $A B E$, prove that $A D \| B C$ and $A C \| E D$.","Let $X = BC \cap ED$. Since $\angle ABX = \angle AEX = 90^\circ$, the quadrilateral $ABEX$ is cyclic with diameter $AX$. The circumcenter of $\triangle ABE$ is the midpoint of $AX$. We are given that this circumcenter is $M$, the midpoint of $CD$. Since the diagonals $AX$ and $CD$ of the quadrilateral $ACXD$ bisect each other at $M$, $ACXD$ is a parallelogram. Therefore, its opposite sides are parallel: $AD \| CX$ (i.e., $AD \| BC$) and $AC \| DX$ (i.e., $AC \| ED$).",Let $A B C D E$ be a convex pentagon such that $\angle A B C=\angle A E D=90^{\circ}$. Suppose that the midpoint of $C D$ is the circumcentre of triangle $A B E$. Let $O$ be the circumcentre of triangle $A C D$. Prove that line $A O$ passes through the midpoint of segment $B E$.,"To prove that $AO$ bisects $BE$, it suffices to show that the areas $[OAB]$ and $[OAE]$ are equal. We know from the previous step that $AD \| BC$ and $AC \| ED$. Let $C'$ and $D'$ be the midpoints of $AC$ and $AD$ respectively. As $O$ is the circumcenter of $\triangle ACD$, $OD' \perp AD$. Since $AD \| BC$ and $BC \perp AB$, we have $OD' \| AB$. Thus, $[OAB] = [D'AB]$. Because $AD \| BC$, $[D'AB] = [D'AC] = \frac{1}{2}[ACD]$. Similarly, $OC' \perp AC$. Since $AC \| ED$ and $ED \perp AE$, we have $OC' \| AE$. Thus, $[OAE] = [C'AE]$. Because $AC \| ED$, $[C'AE] = [C'AD] = \frac{1}{2}[ACD]$. Therefore, $[OAB] = [OAE]$, which proves that line $AO$ bisects segment $BE$.",,,,
2023g2,"Let $A B C$ be a triangle with $A C>B C$. Let $\omega$ be the circumcircle of triangle $A B C$ and let $r$ be the radius of $\omega$. Point $P$ lies on segment $A C$ such that $B C=C P$ and point $S$ is the foot of the perpendicular from $P$ to line $A B$. Let ray $B P$ intersect $\omega$ again at $D$ and let $Q$ lie on line $S P$ such that $P Q=r$ and $S, P, Q$ lie on the line in that order. Finally, let the line perpendicular to $C Q$ from $A$ intersect the line perpendicular to $D Q$ from $B$ at $E$.

Prove that $E$ lies on $\omega$.","First observe that

$$
\angle D P A=\angle B P C^{C P=C B} \angle \angle C B P=\angle C B D=\angle C A D=\angle P A D
$$

so $D P=D A$. Thus there is a symmetry in the problem statement swapping $(A, D) \leftrightarrow(B, C)$.\\
Let $O$ be the centre of $\omega$ and let $E$ be the reflection of $P$ in $C D$ which, by

$$
\angle C E D=\angle D P C=180^{\circ}-\angle C P B B^{C P=C B}={ }^{\circ} 180^{\circ}-\angle P B C=180^{\circ}-\angle D B C
$$

lies on $\omega$. We claim the two lines concur at $E$. By the symmetry noted above, it suffices to prove that $B E \perp D Q$ and then $A E \perp C Q$ will follow by symmetry.

We have $A O=P Q, A D=D P$ and

$$
\angle D A O=90^{\circ}-\angle A B D^{P Q \perp A B} \angle D P Q .
$$

Hence $\triangle A O D \cong \triangle P Q D$. Thus\\
$\angle Q D B+\angle D B E=\angle O D A+\angle D A E \stackrel{D E=D A}{=} \angle O D A+\angle A E D=\left(90^{\circ}-\angle A E D\right)+\angle A E D=90^{\circ}$ giving $B E \perp D Q$ as required.",2,Let $O$ be the center of the circumcircle $\omega$. Prove that $DA=DP$ and that triangle $AOD$ is congruent to triangle $PQD$.,"First, we show $DA=DP$. We have the chain of equalities: $\\angle DPA = \\angle BPC$ (vertically opposite), $\\angle BPC = \\angle CBP$ (since $BC=CP$), $\\angle CBP = \\angle CBD$ ($B,P,D$ are collinear), $\\angle CBD = \\angle CAD$ (angles subtended by arc $CD$ on $\\omega$), and $\\angle CAD = \\angle PAD$ ($A,P,C$ are collinear). Thus, $\\angle DPA = \\angle PAD$, which implies $\triangle APD$ is isosceles with $DA=DP$. \nTo prove congruence between $\triangle AOD$ and $\triangle PQD$, we establish three equalities:\n1. $AO = PQ = r$. $AO$ is the radius of $\\omega$ and $PQ=r$ is given.\n2. $DA=DP$, as shown above.\n3. $\\angle DAO = \\angle DPQ$. In isosceles $\triangle AOD$ ($OA=OD=r$), $\\angle DAO = 90^\\circ - \\angle ABD$. Line $PQ$ is perpendicular to $AB$, so the angle between line $DP$ (collinear with $DB$) and line $PQ$ is $\\angle DPQ = 90^\\circ - \\angle ABD$.\nThese equalities establish that $\triangle AOD \\cong \triangle PQD$.",Let the line perpendicular to $CQ$ from $A$ intersect the line perpendicular to $DQ$ from $B$ at $E$. Prove that $E$ lies on $\\omega$.,"Let $E'$ be the reflection of $P$ across the line $CD$. We first show $E' \\in \\omega$. By reflection, $\\angle CE'D = \\angle CPD$. We also have $\\angle CPD = 180^\\circ - \\angle CPB = 180^\\circ - \\angle CBP = 180^\\circ - \\angle CBD$. Thus $\\angle CE'D + \\angle CBD = 180^\\circ$, which means $BCE'D$ is a cyclic quadrilateral. As $B,C,D$ are on $\\omega$, $E'$ must also be on $\\omega$.\nNow we show that $E' = E$. By the symmetry established by $DA=DP$ (from Sub-problem 1) and $CB=CP$ (given), it suffices to prove $BE' \\perp DQ$. This is equivalent to showing $\\angle QDB + \\angle DBE' = 90^\\circ$.\nFrom Sub-problem 1, $\triangle AOD \\cong \triangle PQD$, which implies $\\angle QDB = \\angle ODA$. Since $A,B,E',D$ are on $\\omega$, $\\angle DBE' = \\angle DAE'$. So we need to show $\\angle ODA + \\angle DAE' = 90^\\circ$.\nSince $E'$ is the reflection of $P$ in $CD$, $DE'=DP$. With $DA=DP$, we get $DA=DE'$, so $\triangle ADE'$ is isosceles with $\\angle DAE' = \\angle AE'D$. The condition becomes $\\angle ODA + \\angle AE'D = 90^\\circ$. In isosceles $\triangle OAD$, $\\angle ODA = 90^\\circ - \\angle ABD$. Also, $\\angle AE'D = \\angle ABD$ as they subtend the same arc $AD$. Substituting these gives $(90^\\circ - \\angle ABD) + \\angle ABD = 90^\\circ$. This proves $BE' \\perp DQ$. Thus $E'=E$, and since $E' \\in \\omega$, $E$ lies on $\\omega$.",,,,
2023g3,"Let $A B C D$ be a cyclic quadrilateral with $\angle B A D<\angle A D C$. Let $M$ be the midpoint of the arc $C D$ not containing $A$. Suppose there is a point $P$ inside $A B C D$ such that $\angle A D B=$ $\angle C P D$ and $\angle A D P=\angle P C B$.

Prove that lines $A D, P M, B C$ are concurrent.","Let $X$ and $Y$ be the intersection points of $A M$ and $B M$ with $P D$ and $P C$ respectively. Since $A B C M D$ is cyclic and $C M=M D$, we have

$$
\angle X A D=\angle M A D=\angle C B M=\angle C B Y .
$$

Combining this with $\angle A D X=\angle Y C B$, we get $\angle D X A=\angle B Y C$, and so $\angle P X M=\angle M Y P$. Moreover, $\angle Y P X=\angle C P D=\angle A D B=\angle A M B$. The quadrilateral $M X P Y$ therefore has equal opposite angles and so is a parallelogram.\\
\includegraphics[max width=\textwidth, center]{2025_04_28_d3623935e31baf0b55e8g-63}

Let $R$ and $S$ be the intersection points of $A M$ and $B M$ with $B C$ and $A D$ respectively. Due to $A M \| P C$ and $B M \| P D$, we have $\angle A S B=\angle A D P=\angle P C B=\angle A R B$ and so the quadrilateral $A B R S$ is cyclic. We then have $\angle S R B=180^{\circ}-\angle B A S=\angle D C B$ and so $S R \| C D$. In triangles $P C D$ and $M R S$, the corresponding sides are parallel so they are homothetic meaning lines $D S, P M, C R$ concur at the centre of this homothety.",2,"Let $X=AM \cap PD$ and $Y=BM \cap PC$. Prove that quadrilateral $MXPY$ is a parallelogram, and as a consequence, $AM \| PC$ and $BM \| PD$.","Since $M$ is the midpoint of arc $CD$, angles subtended by equal arcs are equal, so $\angle MAD = \angle MBC$. Given $\angle ADP = \angle PCB$, we compare triangles $\triangle ADX$ and $\triangle CBY$. The equality of two pairs of angles implies the third pair must be equal: $\angle AXD = \angle CYB$. Their supplementary angles are therefore also equal, $\angle PXM = \angle MYP$. For the other pair of opposite angles in quadrilateral $MXPY$, we have $\angle YPX = \angle CPD$. It is given that $\angle CPD = \angle ADB$. Since points $A, B, D, M$ lie on a circle, $\angle ADB = \angle AMB = \angle XMY$. Thus, $\angle YPX = \angle XMY$. As both pairs of opposite angles of $MXPY$ are equal, it is a parallelogram. Therefore, its opposite sides are parallel, which means $AM \| PC$ and $BM \| PD$.","Prove that lines $A D, P M, B C$ are concurrent.","Let $R$ be the intersection of $AM$ and $BC$, and $S$ be the intersection of $BM$ and $AD$. From the previous result, we have $AM \| PC$ and $BM \| PD$. The parallel lines and transversals give $\angle ARB = \angle PCB$ and $\angle ASB = \angle ADP$. Since we are given $\angle ADP=\angle PCB$, we get $\angle ARB = \angle ASB$. This implies that points $A, B, R, S$ are concyclic. In the cyclic quadrilateral $ABRS$, $\angle SRB = 180^\circ - \angle SAB = 180^\circ - \angle DAB$. As $ABCD$ is also a cyclic quadrilateral, $180^\circ - \angle DAB = \angle BCD$. Therefore, $\angle SRB = \angle BCD$, which implies that $SR \| CD$. Now, consider the triangles $\triangle PCD$ and $\triangle MRS$. We have established that their corresponding sides are parallel: $PC \| MR$, $PD \| MS$, and $CD \| SR$. Thus, the two triangles are homothetic. The lines joining corresponding vertices must be concurrent at the center of homothety. These lines are $PM$, $CR$ (which is the line $BC$), and $DS$ (which is the line $AD$). Therefore, $AD, PM, BC$ are concurrent.",,,,
2023g4,"Let $A B C$ be an acute-angled triangle with $A B<A C$. Denote its circumcircle by $\Omega$ and denote the midpoint of arc $C A B$ by $S$. Let the perpendicular from $A$ to $B C$ meet $B S$ and $\Omega$ at $D$ and $E \neq A$ respectively. Let the line through $D$ parallel to $B C$ meet line $B E$ at $L$ and denote the circumcircle of triangle $B D L$ by $\omega$. Let $\omega$ meet $\Omega$ again at $P \neq B$.

Prove that the line tangent to $\omega$ at $P$, and line $B S$ intersect on the internal bisector of $\angle B A C$.","Let $S^{\prime}$ be the midpoint of arc $B C$ of $\Omega$, diametrically opposite to $S$ so $S S^{\prime}$ is a diameter in $\Omega$ and $A S^{\prime}$ is the angle bisector of $\angle B A C$. Let the tangent of $\omega$ at $P$ meet $\Omega$ again at $Q \neq P$, then we have $\angle S Q S^{\prime}=90^{\circ}$.

We will show that triangles $A P D$ and $S^{\prime} Q S$ are similar and their corresponding sides are parallel. Then it will follow that the lines connecting the corresponding vertices, namely line $A S^{\prime}$, that is the angle bisector of $\angle B A C$, line $P Q$, that is the tangent to $\omega$ at $P$, and $D S$ are concurrent. Note that the sides $A D$ and $S^{\prime} S$ have opposite directions, so the three lines cannot be parallel.\\
\includegraphics[max width=\textwidth, center]{2025_04_28_d3623935e31baf0b55e8g-65}

First we show that $A P \perp D P$. Indeed, from cyclic quadrilaterals $A P B E$ and $D P L B$ we can see that

$$
\angle P A D=\angle P A E=180^{\circ}-\angle E B P=\angle P B L=\angle P D L=90^{\circ}-\angle A D P .
$$

Then, in triangle $A P D$ we have $\angle D P A=180^{\circ}-\angle P A D-\angle A D P=90^{\circ}$.\\
Now we can see that:

\begin{itemize}
  \item Both lines $A D E$ and $S S^{\prime}$ are perpendicular to $B C$, so $A D \| S^{\prime} S$.
  \item Line $P Q$ is tangent to circle $\omega$ at $P$ so $\angle D P Q=\angle D B P=\angle S B P=\angle S Q P$; it follows that $P D \| Q S$.
  \item Finally, since $A P \perp P D \| Q S \perp S^{\prime} Q$, we have $A P \| S^{\prime} Q$ as well.
\end{itemize}

Hence the corresponding sides of triangles $A P D$ and $S^{\prime} Q S$ are parallel completing the solution.",3,Prove that line AP is perpendicular to line DP.,"Points A, P, B, E are on the circumcircle Ω, so ∠PAD = ∠PAE = ∠PBE. Points D, P, L, B are on the circle ω, so ∠PBE = ∠PBL = ∠PDL. Thus, ∠PAD = ∠PDL. The line ADE is the altitude from A, so AD ⊥ BC. The line DL is parallel to BC, so AD ⊥ DL, which means ∠ADL = 90°. In right-angled triangle ADL, ∠ADP + ∠PDL = 90°, so ∠PDL = 90° - ∠ADP. Substituting this into the first equality gives ∠PAD = 90° - ∠ADP. In triangle APD, the sum of angles gives ∠APD = 180° - (∠PAD + ∠ADP) = 180° - (90° - ∠ADP + ∠ADP) = 90°. Therefore, AP ⊥ DP.",Let S' be the midpoint of the arc BC of Ω that does not contain A. Let the tangent to ω at P meet Ω again at Q. Prove that the corresponding sides of triangle APD and triangle S'QS are parallel.,"We show parallelism for each pair of corresponding sides: 
1. AD || S'S: AD is the altitude to BC, so AD ⊥ BC. S' is the midpoint of arc BC, so the diameter SS' is the perpendicular bisector of chord BC. Thus SS' ⊥ BC. Since both lines are perpendicular to BC, AD || S'S. 
2. PD || QS: The line PQ is tangent to ω at P. By the alternate segment theorem, ∠DPQ = ∠DBP. Since B, S, D are collinear, ∠DBP = ∠SBP. Since S, Q, P, B lie on Ω, ∠SBP = ∠SQP. Therefore, ∠DPQ = ∠SQP, which implies that PD || QS. 
3. AP || S'Q: From sub-problem 1, AP ⊥ DP. From the above, DP || QS, which implies AP ⊥ QS. In circle Ω, SS' is a diameter, so ∠SQS' = 90°, which means S'Q ⊥ QS. Since both AP and S'Q are perpendicular to QS, AP || S'Q.","Prove that the line tangent to ω at P, and line BS intersect on the internal bisector of ∠BAC.","From the previous sub-problem, triangles APD and S'QS have their corresponding sides parallel. By Desargues' theorem, the lines joining corresponding vertices, namely AS', PQ, and DS, must be concurrent or parallel. Since AD and S'S have opposite directions, the lines are not parallel and thus must be concurrent. The line AS' is the internal angle bisector of ∠BAC because S' is the midpoint of arc BC. The line PQ is the specified tangent to ω at P. The line DS is the same as the line BS. Therefore, the tangent to ω at P, the line BS, and the internal bisector of ∠BAC are concurrent.",,
2023g6,"Let $A B C$ be an acute-angled triangle with circumcircle $\omega$. A circle $\Gamma$ is internally tangent to $\omega$ at $A$ and also tangent to $B C$ at $D$. Let $A B$ and $A C$ intersect $\Gamma$ at $P$ and $Q$ respectively. Let $M$ and $N$ be points on line $B C$ such that $B$ is the midpoint of $D M$ and $C$ is the midpoint of $D N$. Lines $M P$ and $N Q$ meet at $K$ and intersect $\Gamma$ again at $I$ and $J$ respectively. The ray $K A$ meets the circumcircle of triangle $I J K$ at $X \neq K$.

Prove that $\angle B X P=\angle C X Q$.","Let $M P$ and $N Q$ intersect $A D$ at $K_{1}$ and $K_{2}$ respectively. By applying Menelaus' theorem to triangle $A B D$ and line $M P K_{1}$, we have

$$
\frac{A K_{1}}{K_{1} D}=\frac{A P}{P B} \cdot \frac{B M}{M D}=\frac{A P}{2 P B}
$$

and similarly $\frac{A K_{2}}{K_{2} D}=\frac{A Q}{2 Q C}$. A homothety at $A$ takes $\Gamma \rightarrow \omega$ and $D$ to the midpoint of arc $B C$ not containing $A$, so $P Q \| B C$ and $A D$ bisects $\angle B A C$. Thus

$$
\frac{A K_{1}}{K_{1} D}=\frac{A P}{2 P B}=\frac{A Q}{2 Q C}=\frac{A K_{2}}{K_{2} D}
$$

which implies $K_{1} \equiv K_{2}$, and $K$ lies on $A D$.\\
Then we obtain

$$
\angle J X D=\angle J X K=\angle J I K=\angle J I P=\angle J Q P=\angle J N D
$$

where the last equality follows from $P Q \| B C$. This shows $J X N D$ is cyclic and hence

$$
\angle D X N=\angle D J N=\angle D J Q=\angle D A Q=\angle D A C
$$

which shows $A C \| X N$. As $C$ is the midpoint of $D N, A$ is the midpoint of $X D$.\\
Now observe that $\angle A D P=\angle A Q P=\angle A C B$ and $\angle P A D=\angle D A C=\frac{\angle A}{2}$ so triangle $A P D$ and $A D C$ are similar. Therefore we have

$$
\frac{C D}{D P}=\frac{A D}{A P}=\frac{X A}{A P}
$$

and also have

$$
\angle C D P=180^{\circ}-\angle P D B=180^{\circ}-\angle P A D=\angle X A P .
$$

Combining the two results gives triangles $P D C$ and $P A X$ are similar, which shows $P$ is the centre of spiral similarity taking $C D \rightarrow X A$. Hence also triangles $P X C$ and $P A D$ are similar which shows $\angle P X C=\angle P A D=\frac{\angle A}{2}$. This gives

$$
\angle B X P=\angle B X C-\angle P X C=\angle B X C-\frac{\angle A}{2}
$$

which is symmetric in $B, C$ giving the result.",3,"Show that point $K$ lies on the angle bisector $AD$ of $\angle BAC$, and that $A$ is the midpoint of the line segment $XD$.","A homothety at $A$ mapping $\Gamma \to \omega$ implies $PQ \| BC$ and that $AD$ is the angle bisector of $\angle BAC$. Let $K_1=MP \cap AD$. By Menelaus' theorem on $\triangle ABD$ with transversal $MK_1P$, we have $\frac{AK_1}{K_1D} = \frac{AP}{PB}\frac{BM}{MD} = \frac{AP}{2PB}$. By symmetry, if $K_2=NQ \cap AD$, then $\frac{AK_2}{K_2D} = \frac{AQ}{2QC}$. As $PQ \| BC$, $\frac{AP}{PB}=\frac{AQ}{QC}$, so $K_1=K_2$, which means $K$ lies on $AD$. The concyclicity of $I,J,K,X$ implies $\angle JXN = \angle JXK = \angle JIK$. As points $A,P,D,I,J,Q$ lie on $\Gamma$, $\angle JIK = \angle JQP$. Since $PQ\|BC$, $\angle JQP = \angle JNC$. So $\angle JXN = \angle JNC$, making $JXND$ cyclic. From this, $\angle DXN = \angle DJN = \angle DAQ = \angle DAC$, so $XN \| AC$. In $\triangle XDN$, since $C$ is the midpoint of $DN$ and $AC \| XN$, $A$ is the midpoint of $XD$.",Prove that triangle $PDC$ is similar to triangle $PAX$.,"From sub-problem 1, $AD$ bisects $\angle BAC$, so $\angle PAD = \angle CAD$. Since $APDQ$ is a cyclic quadrilateral on $\Gamma$, $\angle ADP = \angle AQP$. As $PQ \| BC$, we have $\angle AQP = \angle ACB$. Thus $\angle ADP = \angle ACD$. By AA similarity, $\triangle APD \sim \triangle ADC$. This yields $\frac{AD}{AP} = \frac{CD}{DP}$. From sub-problem 1, $A$ is the midpoint of $XD$, so $AD=AX$. The ratio becomes $\frac{AX}{AP} = \frac{CD}{DP}$. The angle between the tangent $BC$ at $D$ and chord $DP$ of circle $\Gamma$ is $\angle BDP = \angle PAD$. As $A$ is between $X$ and $D$, $\angle XAP = 180^\circ - \angle PAD$. Also, $\angle CDP = 180^\circ - \angle BDP$. So $\angle XAP = \angle CDP$. By SAS similarity, using the side ratio and the included angle, we conclude $\triangle PAX \sim \triangle PDC$.",Prove that $\angle B X P=\angle C X Q$.,"From the similarity $\triangle PAX \sim \triangle PDC$ established in sub-problem 2, there is a spiral similarity centered at $P$ that maps segment $AX$ to $DC$. This implies that $\triangle PXC$ is similar to $\triangle PAD$. Consequently, $\angle PXC = \angle PAD$. Since $AD$ bisects $\angle BAC$, $\angle PAD = \frac{1}{2}\angle BAC$. So, $\angle PXC = \frac{1}{2}\angle BAC$. We can then write $\angle BXP = \angle BXC - \angle PXC = \angle BXC - \frac{1}{2}\angle BAC$. The entire problem's setup is symmetric with respect to swapping $B$ and $C$ (which also swaps $P$ and $Q$). By a symmetric argument, a similar derivation shows $\angle QXB = \frac{1}{2}\angle BAC$. Then, $\angle CXQ = \angle CXB - \angle QXB = \angle BXC - \frac{1}{2}\angle BAC$. Therefore, $\angle BXP = \angle CXQ$.",,
2023g7,"Let $A B C$ be an acute, scalene triangle with orthocentre $H$. Let $\ell_{a}$ be the line through the reflection of $B$ with respect to $C H$ and the reflection of $C$ with respect to $B H$. Lines $\ell_{b}$ and $\ell_{c}$ are defined similarly. Suppose lines $\ell_{a}, \ell_{b}$, and $\ell_{c}$ determine a triangle $\mathcal{T}$.

Prove that the orthocentre of $\mathcal{T}$, the circumcentre of $\mathcal{T}$ and $H$ are collinear.","We write $\triangle P_{1} P_{2} P_{3} \stackrel{ \pm}{ } \triangle Q_{1} Q_{2} Q_{3}$ (resp. $\triangle P_{1} P_{2} P_{3} \approx \triangle Q_{1} Q_{2} Q_{3}$ ) to indicate that two triangles are directly (resp. oppositely) similar. We use directed angles throughout denoted with $\Varangle$.

Denote by $A_{b}, A_{c}$ the reflections of $A$ in $B H$ and $C H$ respectively. $B_{c}, B_{a}$ and $C_{a}, C_{b}$ are defined similarly. By definition, $\ell_{a}=B_{c} C_{b}, \ell_{b}=C_{a} A_{c}, \ell_{c}=A_{b} B_{a}$. Let $A_{1}=\ell_{b} \cap \ell_{c}$, $B_{1}=\ell_{c} \cap \ell_{a}, C_{1}=\ell_{a} \cap \ell_{b}$ and let $O_{1}, H_{1}$ be the orthocentre and circumcentre of $\mathcal{T} \equiv \triangle A_{1} B_{1} C_{1}$ respectively.

Claim 1. $\triangle A A_{b} A_{c} \approx \triangle A B C$.\\
Proof. Let $P=B H \cap A C, Q=C H \cap A B$, then it is well known that $\triangle A P Q \approx \triangle A B C$. By the dilation with factor 2 centred at $A, \triangle A P Q$ is sent to $\triangle A A_{b} A_{c}$, so we have $\triangle A A_{b} A_{c} \sim \triangle A B C$.

Claim 2. $\triangle A A_{b} A_{c} \stackrel{\perp}{\sim} \triangle A B_{a} C_{a}$ and $A_{1}$ lies on the circumcircle of $\triangle A A_{b} A_{c}$ which is centred at H.

Proof. Since $B_{a}, C_{a}$ are reflections of $B, C$ in $A H$, we have $\triangle A B_{a} C_{a} \approx \triangle A B C$. Combining this with Claim 1, we have $\triangle A A_{b} A_{c} \stackrel{\downarrow}{\sim} \triangle A B_{a} C_{a}$, where $A$ is the centre of this similarity. Therefore, $\Varangle A_{c} A_{1} A_{b}=\Varangle A_{c} A A_{b}$ meaning $A_{1}$ lies on $\odot A A_{b} A_{c}$. By symmetry, $H A_{b}=H A=H A_{c}$, so $H$ is centre of this circle.

Claim 3. $\triangle A_{1} B_{1} C_{1} \sim \triangle A B C$.\\
Proof. From Claim 2 we have

$$
\Varangle C_{1} A_{1} B_{1}=\Varangle A_{c} A_{1} A_{b} \stackrel{\text { Claim } 2}{=} \not A_{c} A A_{b}=-\Varangle C A B
$$

and similarly $\Varangle A_{1} B_{1} C_{1}=-\Varangle A B C, \Varangle B_{1} C_{1} A_{1}=-\Varangle B C A$, which imply $\triangle A_{1} B_{1} C_{1} \approx \triangle A B C$.

Denote the ratio of similitude of $\triangle A_{1} B_{1} C_{1}$ and $\triangle A B C$ by $\lambda\left(=\frac{B_{1} C_{1}}{B C}\right)$, then

$$
\lambda=\frac{H_{1} A_{1}}{H A}=\frac{H_{1} B_{1}}{H B}=\frac{H_{1} C_{1}}{H C} .
$$

Since $H A=H A_{1}$ and similarly $H B=H B_{1}, H C=H C_{1}$ from Claim 2, we get

$$
\lambda=\frac{H_{1} A_{1}}{H A_{1}}=\frac{H_{1} B_{1}}{H B_{1}}=\frac{H_{1} C_{1}}{H C_{1}} .
$$

Therefore, the circle $A_{1} B_{1} C_{1}$ is the Apollonian circle of the segment $H H_{1}$ with ratio $\lambda$ so the line $H H_{1}$ passes through $O_{1}$.",3,Let $A_1$ be the vertex of triangle $\mathcal{T}$ defined by $\ell_b \cap \ell_c$. Let $A_b$ and $A_c$ be the reflections of vertex $A$ of $\triangle ABC$ with respect to lines $BH$ and $CH$ respectively. Prove that $A_1$ lies on the circumcircle of $\triangle A A_b A_c$ and that $H$ is the center of this circle.,"Let $B_a$ and $C_a$ be the reflections of $B$ and $C$ in line $AH$. By definition, $A_1$ is the intersection of line $A_c C_a$ (which is $\ell_b$) and line $A_b B_a$ (which is $\ell_c$). The triangles $\triangle A A_b A_c$ and $\triangle A B_a C_a$ are known to be oppositely similar with $A$ as the center of similarity. This implies, using directed angles, that $\Varangle A_c A_1 A_b = \Varangle A_c A A_b$, which places $A_1$ on the circumcircle of $\triangle A A_b A_c$. By the definition of reflections, $CH$ is the perpendicular bisector of $AA_c$ and $BH$ is the perpendicular bisector of $AA_b$. Thus, their intersection, $H$, is the circumcenter of $\triangle A A_b A_c$.",Prove that the triangle $\mathcal{T} \equiv \triangle A_1 B_1 C_1$ is oppositely similar to the original triangle $\triangle ABC$.,"From the first sub-problem, $A_1$ lies on the circumcircle of $\triangle A A_b A_c$. Using directed angles, we have $\Varangle C_1 A_1 B_1 = \Varangle A_c A_1 A_b = \Varangle A_c A A_b$. This angle can be shown to be equal to $-\Varangle CAB$. By symmetry, the same holds for the other angles: $\Varangle A_1 B_1 C_1 = -\Varangle ABC$ and $\Varangle B_1 C_1 A_1 = -\Varangle BCA$. These angle relations imply that $\triangle A_1 B_1 C_1$ is oppositely similar to $\triangle ABC$.","Prove that the orthocentre of $\mathcal{T}$, the circumcentre of $\mathcal{T}$ and $H$ are collinear.","Let $O_1$ and $H_1$ be the circumcentre and orthocentre of $\mathcal{T} \equiv \triangle A_1 B_1 C_1$. From sub-problem 2, $\triangle A_1 B_1 C_1$ is similar to $\triangle ABC$. Let $\lambda$ be the ratio of similarity. Since $H_1$ and $H$ are corresponding orthocenters, we have $\frac{H_1 A_1}{H A} = \frac{H_1 B_1}{H B} = \frac{H_1 C_1}{H C} = \lambda$. From sub-problem 1, we know $HA=HA_1$, $HB=HB_1$, and $HC=HC_1$. Substituting these gives $\frac{H_1 A_1}{H A_1} = \frac{H_1 B_1}{H B_1} = \frac{H_1 C_1}{H C_1} = \lambda$. This means the vertices $A_1, B_1, C_1$ lie on the Apollonian circle for the segment $HH_1$ with ratio $\lambda$. The circumcircle of $\triangle A_1 B_1 C_1$ is this Apollonian circle, and its center, $O_1$, must lie on the line connecting the foci $H$ and $H_1$.",,
2023g8,"Let $A B C$ be an equilateral triangle. Points $A_{1}, B_{1}, C_{1}$ lie inside triangle $A B C$ such that triangle $A_{1} B_{1} C_{1}$ is scalene, $B A_{1}=A_{1} C, C B_{1}=B_{1} A, A C_{1}=C_{1} B$ and

$$
\angle B A_{1} C+\angle C B_{1} A+\angle A C_{1} B=480^{\circ} .
$$

Lines $B C_{1}$ and $C B_{1}$ intersect at $A_{2}$; lines $C A_{1}$ and $A C_{1}$ intersect at $B_{2}$; and lines $A B_{1}$ and $B A_{1}$ intersect at $C_{2}$.

Prove that the circumcircles of triangles $A A_{1} A_{2}, B B_{1} B_{2}, C C_{1} C_{2}$ have two common points.","Let $\delta_{A}, \delta_{B}, \delta_{C}$ be the circumcircles of $\triangle A A_{1} A_{2}, \triangle B B_{1} B_{2}, \triangle C C_{1} C_{2}$. The general strategy of the solution is to find two different points having equal power with respect to $\delta_{A}, \delta_{B}, \delta_{C}$.\\
Claim. $A_{1}$ is the circumcentre of $A_{2} B C$ and cyclic variations.\\
Proof. Since $A_{1}$ lies on the perpendicular bisector of $B C$ and inside $\triangle B A_{2} C$, it suffices to prove $\angle B A_{1} C=2 \angle B A_{2} C$. This follows from

$$
\begin{aligned}
\angle B A_{2} C & =\angle A_{2} B A+\angle B A C+\angle A C A_{2} \\
& =\frac{1}{2}\left(\left(180^{\circ}-\angle A C_{1} B\right)+\left(180^{\circ}-\angle C B_{1} A\right)\right)+60^{\circ} \\
& =240^{\circ}-\frac{1}{2}\left(480^{\circ}-\angle B A_{1} C\right) \\
& =\frac{1}{2} \angle B A_{1} C
\end{aligned}
$$

\begin{center}
\includegraphics[max width=\textwidth]{2025_04_28_d3623935e31baf0b55e8g-80}
\end{center}

The circumcentres above give

$$
\angle B_{1} B_{2} C_{1}=\angle B_{1} B_{2} A=\angle B_{2} A B_{1}=\angle C_{1} A C_{2}=\angle A C_{2} C_{1}=\angle B_{1} C_{2} C_{1}
$$

and so $B_{1} C_{1} B_{2} C_{2}$ is cyclic. Likewise $C_{1} A_{1} C_{2} A_{2}$ and $A_{1} B_{1} A_{2} B_{2}$ are cyclic. Note that hexagon $A_{1} B_{2} C_{1} A_{2} B_{1} C_{2}$ is not cyclic since

$$
\angle C_{2} A_{1} B_{2}+\angle B_{2} C_{1} A_{2}+\angle A_{2} B_{1} C_{2}=480^{\circ} \neq 360^{\circ} .
$$

Thus we can apply radical axis theorem to the three circles to show that $A_{1} A_{2}, B_{1} B_{2}, C_{1}, C_{2}$ concur at a point $X$ and this point has equal power with respect to $\delta_{A}, \delta_{B}, \delta_{C}$.

Let the circumcircle of $\triangle A_{2} B C$ meet $\delta_{A}$ at $A_{3} \neq A_{2}$. Define $B_{3}$ and $C_{3}$ similarly.\\
Claim. $\mathrm{BCB}_{3} C_{3}$ cyclic.\\
Proof. Using directed angles


\begin{align*}
\Varangle B C_{3} C & =\Varangle B C_{3} C_{2}+\Varangle C_{2} C_{3} C \\
& =\Varangle B A C_{2}+\Varangle C_{2} C_{1} C \\
& =90^{\circ}+\Varangle\left(C_{1} C, A C_{2}\right)+\Varangle C_{2} C_{1} C  \tag{1}\\
& =90^{\circ}+\Varangle C_{1} C_{2} B_{1} .
\end{align*}


Similarly $\Varangle C B_{3} B=90^{\circ}+\Varangle B_{1} B_{2} C_{1}$. Hence, using $B_{1} C_{1} B_{2} C_{2}$ cyclic

$$
\Varangle B B_{3} C=90^{\circ}+\Varangle C_{1} B_{2} B_{1}=90^{\circ}+\Varangle C_{1} C_{2} B_{1}=\Varangle B C_{3} C
$$

as required.\\
\includegraphics[max width=\textwidth, center]{2025_04_28_d3623935e31baf0b55e8g-81}

Similarly $C A C_{3} A_{3}$ and $A B A_{3} B_{3}$ are cyclic. $A C_{3} B A_{3} C B_{3}$ is not cyclic because then $A B_{2} C B_{3}$ cyclic would mean $B_{2}$ lies on $\odot A B C$ which is impossible since $B_{2}$ lies inside $\triangle A B C$. Thus we can apply radical axis theorem to the three circles to get $A A_{3}, B B_{3}, C C_{3}$ concur at a point $Y$ which has equal power with respect to $\delta_{A}, \delta_{B}, \delta_{C}$.

We now make some technical observations before finishing.

\begin{itemize}
  \item Let $O$ be the centre of $\triangle A B C$. We have that
\end{itemize}

$$
\angle B A_{1} C=480^{\circ}-\angle C B_{1} A-\angle A C_{1} B>480^{\circ}-180^{\circ}-180^{\circ}=120^{\circ} .
$$

so $A_{1}$ lies inside $\triangle B O C$. We have similar results for $B_{1}, C_{1}$ and thus $\triangle B A_{1} C, \triangle C B_{1} A$, $\triangle A C_{1} B$ have disjoint interiors. It follows that $A_{1} B_{2} C_{1} A_{2} B_{1} C_{2}$ is a convex hexagon thus $X$ lies on segment $A_{1} A_{2}$ and therefore is inside $\delta_{A}$.

\begin{itemize}
  \item Since $A_{1}$ is the centre of $A_{2} B C$ we have that $A_{1} A_{2}=A_{1} A_{3}$ so, from cyclic quadrilateral $A A_{2} A_{1} A_{3}$ we get that lines $A A_{2}$ and $A A_{3} \equiv A Y$ are reflections in line $A A_{1}$. As $X$ lies on segment $A_{1} A_{2}$, the only way $X \equiv Y$ is if $A_{1}$ and $A_{2}$ both lie on the perpendicular bisector of $B C$. But this forces $B_{1}$ and $C_{1}$ to also be reflections in this line meaning $A_{1} B_{1}=A_{1} C_{1}$ contradicting the scalene condition.
\end{itemize}

Summarising, we have distinct points $X, Y$ with equal power with respect to $\delta_{A}, \delta_{B}, \delta_{C}$ thus these circles have a common radical axis. As $X$ lies inside $\delta_{A}$ (and similarly $\delta_{B}, \delta_{C}$ ), this radical axis intersects the circles at two points and so $\delta_{A}, \delta_{B}, \delta_{C}$ have two points in common.",1,"Let $A B C$ be an equilateral triangle. Points $A_{1}, B_{1}, C_{1}$ lie inside triangle $A B C$ such that triangle $A_{1} B_{1} C_{1}$ is scalene, $B A_{1}=A_{1} C, C B_{1}=B_{1} A, A C_{1}=C_{1} B$ and

$$
\angle B A_{1} C+\angle C B_{1} A+\angle A C_{1} B=480^{\circ} .
$$

Lines $B C_{1}$ and $C B_{1}$ intersect at $A_{2}$; lines $C A_{1}$ and $A C_{1}$ intersect at $B_{2}$; and lines $A B_{1}$ and $B A_{1}$ intersect at $C_{2}$.

Prove that the circumcircles of triangles $A A_{1} A_{2}, B B_{1} B_{2}, C C_{1} C_{2}$ have two common points.","Let $\delta_{A}, \delta_{B}, \delta_{C}$ be the circumcircles of $\triangle A A_{1} A_{2}, \triangle B B_{1} B_{2}, \triangle C C_{1} C_{2}$. The general strategy of the solution is to find two different points having equal power with respect to $\delta_{A}, \delta_{B}, \delta_{C}$.\\
Claim. $A_{1}$ is the circumcentre of $A_{2} B C$ and cyclic variations.\\
Proof. Since $A_{1}$ lies on the perpendicular bisector of $B C$ and inside $\triangle B A_{2} C$, it suffices to prove $\angle B A_{1} C=2 \angle B A_{2} C$. This follows from

$$
\begin{aligned}
\angle B A_{2} C & =\angle A_{2} B A+\angle B A C+\angle A C A_{2} \\
& =\frac{1}{2}\left(\left(180^{\circ}-\angle A C_{1} B\right)+\left(180^{\circ}-\angle C B_{1} A\right)\right)+60^{\circ} \\
& =240^{\circ}-\frac{1}{2}\left(480^{\circ}-\angle B A_{1} C\right) \\
& =\frac{1}{2} \angle B A_{1} C
\end{aligned}
$$

\begin{center}
\includegraphics[max width=\textwidth]{2025_04_28_d3623935e31baf0b55e8g-80}
\end{center}

The circumcentres above give

$$
\angle B_{1} B_{2} C_{1}=\angle B_{1} B_{2} A=\angle B_{2} A B_{1}=\angle C_{1} A C_{2}=\angle A C_{2} C_{1}=\angle B_{1} C_{2} C_{1}
$$

and so $B_{1} C_{1} B_{2} C_{2}$ is cyclic. Likewise $C_{1} A_{1} C_{2} A_{2}$ and $A_{1} B_{1} A_{2} B_{2}$ are cyclic. Note that hexagon $A_{1} B_{2} C_{1} A_{2} B_{1} C_{2}$ is not cyclic since

$$
\angle C_{2} A_{1} B_{2}+\angle B_{2} C_{1} A_{2}+\angle A_{2} B_{1} C_{2}=480^{\circ} \neq 360^{\circ} .
$$

Thus we can apply radical axis theorem to the three circles to show that $A_{1} A_{2}, B_{1} B_{2}, C_{1}, C_{2}$ concur at a point $X$ and this point has equal power with respect to $\delta_{A}, \delta_{B}, \delta_{C}$.

Let the circumcircle of $\triangle A_{2} B C$ meet $\delta_{A}$ at $A_{3} \neq A_{2}$. Define $B_{3}$ and $C_{3}$ similarly.\\
Claim. $\mathrm{BCB}_{3} C_{3}$ cyclic.\\
Proof. Using directed angles


\begin{align*}
\Varangle B C_{3} C & =\Varangle B C_{3} C_{2}+\Varangle C_{2} C_{3} C \\
& =\Varangle B A C_{2}+\Varangle C_{2} C_{1} C \\
& =90^{\circ}+\Varangle\left(C_{1} C, A C_{2}\right)+\Varangle C_{2} C_{1} C  \tag{1}\\
& =90^{\circ}+\Varangle C_{1} C_{2} B_{1} .
\end{align*}


Similarly $\Varangle C B_{3} B=90^{\circ}+\Varangle B_{1} B_{2} C_{1}$. Hence, using $B_{1} C_{1} B_{2} C_{2}$ cyclic

$$
\Varangle B B_{3} C=90^{\circ}+\Varangle C_{1} B_{2} B_{1}=90^{\circ}+\Varangle C_{1} C_{2} B_{1}=\Varangle B C_{3} C
$$

as required.\\
\includegraphics[max width=\textwidth, center]{2025_04_28_d3623935e31baf0b55e8g-81}

Similarly $C A C_{3} A_{3}$ and $A B A_{3} B_{3}$ are cyclic. $A C_{3} B A_{3} C B_{3}$ is not cyclic because then $A B_{2} C B_{3}$ cyclic would mean $B_{2}$ lies on $\odot A B C$ which is impossible since $B_{2}$ lies inside $\triangle A B C$. Thus we can apply radical axis theorem to the three circles to get $A A_{3}, B B_{3}, C C_{3}$ concur at a point $Y$ which has equal power with respect to $\delta_{A}, \delta_{B}, \delta_{C}$.

We now make some technical observations before finishing.

\begin{itemize}
  \item Let $O$ be the centre of $\triangle A B C$. We have that
\end{itemize}

$$
\angle B A_{1} C=480^{\circ}-\angle C B_{1} A-\angle A C_{1} B>480^{\circ}-180^{\circ}-180^{\circ}=120^{\circ} .
$$

so $A_{1}$ lies inside $\triangle B O C$. We have similar results for $B_{1}, C_{1}$ and thus $\triangle B A_{1} C, \triangle C B_{1} A$, $\triangle A C_{1} B$ have disjoint interiors. It follows that $A_{1} B_{2} C_{1} A_{2} B_{1} C_{2}$ is a convex hexagon thus $X$ lies on segment $A_{1} A_{2}$ and therefore is inside $\delta_{A}$.

\begin{itemize}
  \item Since $A_{1}$ is the centre of $A_{2} B C$ we have that $A_{1} A_{2}=A_{1} A_{3}$ so, from cyclic quadrilateral $A A_{2} A_{1} A_{3}$ we get that lines $A A_{2}$ and $A A_{3} \equiv A Y$ are reflections in line $A A_{1}$. As $X$ lies on segment $A_{1} A_{2}$, the only way $X \equiv Y$ is if $A_{1}$ and $A_{2}$ both lie on the perpendicular bisector of $B C$. But this forces $B_{1}$ and $C_{1}$ to also be reflections in this line meaning $A_{1} B_{1}=A_{1} C_{1}$ contradicting the scalene condition.
\end{itemize}

Summarising, we have distinct points $X, Y$ with equal power with respect to $\delta_{A}, \delta_{B}, \delta_{C}$ thus these circles have a common radical axis. As $X$ lies inside $\delta_{A}$ (and similarly $\delta_{B}, \delta_{C}$ ), this radical axis intersects the circles at two points and so $\delta_{A}, \delta_{B}, \delta_{C}$ have two points in common.",,,,,,
2023n3,For positive integers $n$ and $k \geqslant 2$ define $E_{k}(n)$ as the greatest exponent $r$ such that $k^{r}$ divides $n!$. Prove that there are infinitely many $n$ such that $E_{10}(n)>E_{9}(n)$ and infinitely many $m$ such that $E_{10}(m)<E_{9}(m)$.,"We let $v_{p}(m)$ denote the $p$-adic valuation of $m$. By Legendre's Formula we know, for $p$ prime, that $v_{p}(n!)=\lfloor n / p\rfloor+\left\lfloor n / p^{2}\right\rfloor+\cdots$. We can see that $E_{9}(n)=\left\lfloor\frac{v_{3}(n!)}{2}\right\rfloor$. Since $v_{5}(n!) \leqslant v_{2}(n!)$ and $E_{10}(n)=\min \left(v_{5}(n!), v_{2}(n!)\right)$, we have $E_{10}(n)=v_{5}(n!)$.

Let $l$ be a positive integer. Set $n=5^{2 l-1}$. Then we have

$$
E_{10}(n)=v_{5}(n!)=5^{2 l-2}+5^{2 l-3}+\cdots+5+1=\frac{5^{2 l-1}-1}{4}=\frac{n-1}{4} .
$$

Since $n=5^{2 l-1} \equiv 2(\bmod 3)$, we have $\left\lfloor\frac{n}{3}\right\rfloor=\frac{n-2}{3}$ and it implying

$$
v_{3}(n!)=\left\lfloor\frac{n}{3}\right\rfloor+\left\lfloor\frac{n}{3^{2}}\right\rfloor+\left\lfloor\frac{n}{3^{3}}\right\rfloor+\cdots<\frac{n-2}{3}+\frac{n}{3^{2}}+\frac{n}{3^{3}}+\cdots=\frac{n}{2}-\frac{2}{3} .
$$

From this we obtain

$$
E_{9}(n)=\left\lfloor\frac{v_{3}(n!)}{2}\right\rfloor \leqslant \frac{v_{3}(n!)}{2} \leqslant \frac{n}{4}-\frac{1}{3}<\frac{n}{4}-\frac{1}{4}=E_{10}(n) .
$$

In a similar way, we set now $m=3^{4 l-2}$. Then we have

$$
v_{3}(m!)=3^{4 l-3}+3^{4 l-4}+\cdots+3+1=\frac{3^{4 l-2}-1}{2}=\frac{m-1}{2} .
$$

Note that $m=3^{4 l-2} \equiv 1(\bmod 4)$ and hence $E_{9}(m)=\left\lfloor\frac{v_{3}(m!)}{2}\right\rfloor=\left\lfloor\frac{m-1}{4}\right\rfloor=\frac{m-1}{4}$. We also have $m=3^{4 l-2} \equiv 4(\bmod 5)$ implying $\left\lfloor\frac{m}{5}\right\rfloor=\frac{m-4}{5}$. Therefore we obtain

$$
E_{10}(m)=v_{5}(m!)=\left\lfloor\frac{m}{5}\right\rfloor+\left\lfloor\frac{m}{5^{2}}\right\rfloor+\cdots<\frac{m-4}{5}+\frac{m}{5^{2}}+\cdots=\frac{m}{4}-\frac{4}{5}<\frac{m}{4}-\frac{1}{4}=E_{9}(m) .
$$

We can take infinitely many $n=5^{2 l-1}$ and $m=3^{4 l-2}$ completing the proof.\\",2,"Let $E_k(n)$ be the greatest exponent $r$ such that $k^r$ divides $n!$. Express $E_{10}(n)$ and $E_9(n)$ in terms of p-adic valuations $v_p(n!)$. Further, for an integer $n$ of the form $p^k$ where $p$ is a prime, provide an exact formula for $v_p(n!)$.","By Legendre's formula, for a prime $p$, the p-adic valuation of $n!$ is $v_p(n!) = \sum_{i=1}^\infty \lfloor n/p^i \rfloor$. The exponent of $10=2 \cdot 5$ in the prime factorization of $n!$ is $E_{10}(n) = \min(v_2(n!), v_5(n!))$. Since $5>2$, we have $v_5(n!) \le v_2(n!)$, so $E_{10}(n) = v_5(n!)$. The exponent of $9=3^2$ in $n!$ depends on the number of pairs of factor 3. Thus, $E_9(n) = \lfloor v_3(n!)/2 \rfloor$. For $n=p^k$, the sum in Legendre's formula is a geometric series: $v_p((p^k)!) = \sum_{i=1}^k \lfloor p^k/p^i \rfloor = \sum_{i=1}^k p^{k-i} = \sum_{j=0}^{k-1} p^j = \frac{p^k-1}{p-1} = \frac{n-1}{p-1}$.",For positive integers $n$ and $k \geqslant 2$ define $E_{k}(n)$ as the greatest exponent $r$ such that $k^{r}$ divides $n!$. Prove that there are infinitely many $n$ such that $E_{10}(n)>E_{9}(n)$ and infinitely many $m$ such that $E_{10}(m)<E_{9}(m)$.,"Using the established formulas $E_{10}(n)=v_5(n!)$ and $E_9(n) = \lfloor v_3(n!)/2 \rfloor$: 
1. To show $E_{10}(n)>E_{9}(n)$ for infinitely many $n$, consider the family $n=5^{2l-1}$ for $l \in \mathbb{Z}^+$. For these $n$, $E_{10}(n) = v_5(n!) = \frac{n-1}{5-1}=\frac{n-1}{4}$. Since $n = 5^{2l-1} \equiv 2 \pmod 3$, $v_3(n!) = \sum \lfloor n/3^i \rfloor < \frac{n-2}{3}+\frac{n}{9}+\frac{n}{27}+\dots = \frac{n}{2}-\frac{2}{3}$. So, $E_9(n) = \lfloor v_3(n!)/2 \rfloor < \frac{1}{2}(\frac{n}{2}-\frac{2}{3}) = \frac{n}{4}-\frac{1}{3}$. Thus, $E_{10}(n)=\frac{n-1}{4} > \frac{n}{4}-\frac{1}{3} > E_9(n)$ for this infinite family. 
2. To show $E_{10}(m)<E_{9}(m)$ for infinitely many $m$, consider the family $m=3^{4l-2}$ for $l \in \mathbb{Z}^+$. For these $m$, $v_3(m!) = \frac{m-1}{3-1}=\frac{m-1}{2}$. Since $m=9^{2l-1} \equiv 1 \pmod 4$, $E_9(m) = \lfloor \frac{v_3(m!)}{2} \rfloor = \lfloor \frac{m-1}{4} \rfloor = \frac{m-1}{4}$. As $m=9^{2l-1} \equiv 4 \pmod 5$, $E_{10}(m) = v_5(m!) < \frac{m-4}{5}+\frac{m}{25}+\dots = \frac{m}{4}-\frac{4}{5}$. Thus, $E_{10}(m) < \frac{m}{4}-\frac{4}{5} < \frac{m-1}{4} = E_9(m)$ for this infinite family. This completes the proof.",,,,
2023n5,"Let $a_{1}<a_{2}<a_{3}<\cdots$ be positive integers such that $a_{k+1}$ divides $2\left(a_{1}+a_{2}+\cdots+a_{k}\right)$ for every $k \geqslant 1$. Suppose that for infinitely many primes $p$, there exists $k$ such that $p$ divides $a_{k}$. Prove that for every positive integer $n$, there exists $k$ such that $n$ divides $a_{k}$.","For every $k \geqslant 2$ define the quotient $b_{k}=2\left(a_{1}+\cdots+a_{k-1}\right) / a_{k}$, which must be a positive integer. We first prove the following properties of the sequence $\left(b_{k}\right)$ :\\
Claim 1. We have $b_{k+1} \leqslant b_{k}+1$ for all $k \geqslant 2$.\\
Proof. By subtracting $b_{k} a_{k}=2\left(a_{1}+\cdots+a_{k-1}\right)$ from $b_{k+1} a_{k+1}=2\left(a_{1}+\cdots+a_{k}\right)$, we find that $b_{k+1} a_{k+1}=b_{k} a_{k}+2 a_{k}=\left(b_{k}+2\right) a_{k}$. From $a_{k}<a_{k+1}$ it follows that $b_{k}+2>b_{k+1}$.\\
Claim 2. The sequence $\left(b_{k}\right)$ is unbounded.\\
Proof. We start by rewriting $b_{k+1} a_{k+1}=\left(b_{k}+2\right) a_{k}$ as

$$
\left.a_{k+1}=a_{k} \cdot \frac{b_{k}+2}{b_{k+1}} \Longrightarrow a_{k+1} \right\rvert\, a_{k}\left(b_{k}+2\right) .
$$

If the sequence $\left(b_{k}\right)$ were bounded, say by some positive integer $B$, then the prime factors of the terms of the sequence $\left(a_{k}\right)$ could only be primes less than or equal to $B+2$ or those dividing $a_{1}$ or $a_{2}$, which contradicts the property in the statement of the problem.

Consider now an arbitrary positive integer $n$. We assume $n>b_{2}$, otherwise we replace $n$ by an arbitrary multiple of $n$ that is bigger than $b_{2}$. By Claim 2, there exists $k$ such that $b_{k+1} \geqslant n$. Consider the smallest such $k$. From Claim 1, it follows that we must have $b_{k}=n-1$ and $b_{k+1}=n$ (we assumed $n>b_{2}$ to ensure that $k \geqslant 2$ ). We now find that

$$
a_{k+1}=a_{k} \cdot \frac{b_{k}+2}{b_{k+1}}=a_{k} \cdot \frac{n+1}{n} .
$$

Because $n$ and $n+1$ are coprime, this immediately implies that $a_{k}$ is divisible by $n$.",2,"Let the sequence of positive integers $(a_k)$ be strictly increasing such that $a_{k+1}$ divides $2(a_1 + \cdots + a_k)$ for $k \ge 1$, and suppose that for infinitely many primes $p$, there exists $k$ such that $p$ divides $a_k$. For $k \ge 2$, define the integer sequence $b_k = \frac{2(a_1 + \cdots + a_{k-1})}{a_k}$. Prove that $b_{k+1} \le b_k + 1$ for all $k \ge 2$, and that the sequence $(b_k)$ is unbounded.","From the definition, $b_k a_k = 2(a_1 + \cdots + a_{k-1})$. Then $b_{k+1} a_{k+1} = 2(a_1 + \cdots + a_k) = 2(a_1 + \cdots + a_{k-1}) + 2a_k = b_k a_k + 2a_k = (b_k+2)a_k$. Since $a_k < a_{k+1}$, we have $b_{k+1} = (b_k+2)\frac{a_k}{a_{k+1}} < b_k+2$. As $b_{k+1}$ is an integer, $b_{k+1} \le b_k+1$. To prove $(b_k)$ is unbounded, assume for contradiction it is bounded by $B$. The relation $a_{k+1} = a_k \frac{b_k+2}{b_{k+1}}$ shows that any prime factor of $a_{k+1}$ must be a prime factor of $a_k$ or of $b_k+2$. If $(b_k)$ is bounded by $B$, then $b_k+2 \le B+2$ for all $k$. This implies the set of all prime factors of all terms $a_k$ is finite, a contradiction. Thus, $(b_k)$ is unbounded.","Let $a_{1}<a_{2}<a_{3}<\cdots$ be positive integers such that $a_{k+1}$ divides $2\left(a_{1}+a_{2}+\cdots+a_{k}\right)$ for every $k \geqslant 1$. Suppose that for infinitely many primes $p$, there exists $k$ such that $p$ divides $a_{k}$. Prove that for every positive integer $n$, there exists $k$ such that $n$ divides $a_{k}$.","Let $n$ be any positive integer. Define the sequence $b_k = \frac{2(a_1 + \cdots + a_{k-1})}{a_k}$ for $k \ge 2$. From the previous sub-problem, we know that $(b_k)$ is an unbounded sequence of integers such that $b_{k+1} \le b_k + 1$. We may assume $n > b_2$. Since $(b_k)$ is unbounded, there exists a smallest integer $k_0 \ge 2$ such that $b_{k_0+1} \ge n$. By minimality, $b_{k_0} < n$. Using the inequality, $n \le b_{k_0+1} \le b_{k_0} + 1 < n+1$. This implies $b_{k_0+1} = n$. From $n \le b_{k_0} + 1$, we get $b_{k_0} \ge n-1$. With $b_{k_0} < n$, we have $b_{k_0} = n-1$. From the relation $b_{k+1}a_{k+1} = (b_k+2)a_k$, we substitute $k=k_0$ to get $n \cdot a_{k_0+1} = (n-1+2)a_{k_0} = (n+1)a_{k_0}$. Since $\gcd(n, n+1)=1$, it follows that $n$ must divide $a_{k_0}$.",,,,
2023n6,"A sequence of integers $a_{0}, a_{1}, a_{2}, \ldots$ is called kawaii, if $a_{0}=0, a_{1}=1$, and, for any positive integer $n$, we have

$$
\left(a_{n+1}-3 a_{n}+2 a_{n-1}\right)\left(a_{n+1}-4 a_{n}+3 a_{n-1}\right)=0 .
$$

An integer is called kawaii if it belongs to a kawaii sequence.\\
Suppose that two consecutive positive integers $m$ and $m+1$ are both kawaii (not necessarily belonging to the same kawaii sequence). Prove that 3 divides $m$, and that $m / 3$ is kawaii.","We start by rewriting the condition in the problem as:

$$
a_{n+1}=3 a_{n}-2 a_{n-1} \text {, or } a_{n+1}=4 a_{n}-3 a_{n-1} \text {. }
$$

We have $a_{n+1} \equiv a_{n}$ or $a_{n-1}(\bmod 2)$ and $a_{n+1} \equiv a_{n-1}$ or $a_{n}(\bmod 3)$ for all $n \geqslant 1$. Now, since $a_{0}=0$ and $a_{1}=1$, we have that $a_{n} \equiv 0,1 \bmod 3$ for all $n \geqslant 0$. Since $m$ and $m+1$ are kawaii integers, then necessarily $m \equiv 0 \bmod 3$.

We also observe that $a_{2}=3$ or $a_{2}=4$. Moreover,\\
(1) If $a_{2}=3$, then $a_{n} \equiv 1(\bmod 2)$ for all $n \geqslant 1$ since $a_{1} \equiv a_{2} \equiv 1(\bmod 2)$.\\
(2) If $a_{2}=4$, then $a_{n} \equiv 1(\bmod 3)$ for all $n \geqslant 1$ since $a_{1} \equiv a_{2} \equiv 1(\bmod 3)$.

Since $m \equiv 0(\bmod 3)$, any kawaii sequence containing $m$ does not satisfy (2), so it must satisfy (1). Hence, $m$ is odd and $m+1$ is even.

Take a kawaii sequence $\left(a_{n}\right)$ containing $m+1$. Let $t \geqslant 2$ be such that $a_{t}=m+1$. As $\left(a_{n}\right)$ does not satisfy (1), it must satisfy (2). Then $a_{n} \equiv 1(\bmod 3)$ for all $n \geqslant 1$. We define the sequence $a_{n}^{\prime}=\left(a_{n+1}-1\right) / 3$. This is a kawaii sequence: $a_{0}^{\prime}=0, a_{1}^{\prime}=1$ and for all $n \geqslant 1$, $\left(a_{n+1}^{\prime}-3 a_{n}^{\prime}+2 a_{n-1}^{\prime}\right)\left(a_{n+1}^{\prime}-4 a_{n}^{\prime}+3 a_{n-1}^{\prime}\right)=\left(a_{n+2}-3 a_{n+1}+2 a_{n}\right)\left(a_{n+2}-4 a_{n+1}+3 a_{n}\right) / 9=0$.

Finally, we notice that the term $a_{t-1}^{\prime}=m / 3$ which implies that $m / 3$ is kawaii.",2,"Show that any kawaii integer is congruent to 0 or 1 modulo 3. Consequently, if `m` and `m+1` are both kawaii, prove that 3 divides `m`.","The recurrence for a kawaii sequence `(a_n)` is `a_{n+1} = 3a_n - 2a_{n-1}` or `a_{n+1} = 4a_n - 3a_{n-1}`. Modulo 3, this becomes `a_{n+1} \equiv a_{n-1} \pmod{3}` or `a_{n+1} \equiv a_n \pmod{3}`. Since `a_0 = 0` and `a_1 = 1`, all terms `a_n` must be congruent to 0 or 1 modulo 3. If `m` is kawaii, then `m \equiv 0 \text{ or } 1 \pmod{3}`. If `m+1` is kawaii, then `m+1 \equiv 0 \text{ or } 1 \pmod{3}`, which implies `m \equiv 2 \text{ or } 0 \pmod{3}`. For both statements to hold, we must have `m \equiv 0 \pmod{3}`.","Suppose that two consecutive positive integers `m` and `m+1` are both kawaii. Prove that 3 divides `m`, and that `m / 3` is kawaii.","From Part 1, `m \equiv 0 \pmod{3}`. Kawaii sequences for `n \ge 1` are either all odd (if `a_2=3`) or all `\equiv 1 \pmod{3}` (if `a_2=4`). As `m \equiv 0 \pmod{3}`, it must belong to an all-odd sequence, making `m` odd. Thus, `m+1` is even and must belong to a sequence `(c_n)` of the second type, i.e., `c_n \equiv 1 \pmod{3}` for `n \ge 1` and `c_2=4`. Let `m+1 = c_t`. Define `b_k = (c_{k+1}-1)/3`. This sequence `(b_k)` is kawaii: `b_0=0`, `b_1=1`, and the recurrence holds. The term `b_{t-1}=(c_t-1)/3 = m/3` is in this sequence. Thus, `m/3` is kawaii.",,,,
2022a1,"Let $\left(a_{n}\right)_{n \geqslant 1}$ be a sequence of positive real numbers with the property that

$$
\left(a_{n+1}\right)^{2}+a_{n} a_{n+2} \leqslant a_{n}+a_{n+2}
$$

for all positive integers $n$. Show that $a_{2022} \leqslant 1$.","We begin by observing that $\left(a_{n+1}\right)^{2}-1 \leqslant a_{n}+a_{n+2}-a_{n} a_{n+2}-1$, which is equivalent to

$$
\left(a_{n+1}\right)^{2}-1 \leqslant\left(1-a_{n}\right)\left(a_{n+2}-1\right) .
$$

Suppose now that there exists a positive integer $n$ such that $a_{n+1}>1$ and $a_{n+2}>1$. Since $\left(a_{n+1}\right)^{2}-1 \leqslant\left(1-a_{n}\right)\left(a_{n+2}-1\right)$, we deduce that $0<1-a_{n}<1<1+a_{n+2}$, thus $\left(a_{n+1}\right)^{2}-1<\left(a_{n+2}+1\right)\left(a_{n+2}-1\right)=\left(a_{n+2}\right)^{2}-1$.

On the other hand, $\left(a_{n+2}\right)^{2}-1 \leqslant\left(1-a_{n+3}\right)\left(a_{n+1}-1\right)<\left(1+a_{n+1}\right)\left(a_{n+1}-1\right)=\left(a_{n+1}\right)^{2}-1$, a contradiction. We have shown that we cannot have two consecutive terms, except maybe $a_{1}$ and $a_{2}$, strictly greater than 1 .

Finally, suppose $a_{2022}>1$. This implies that $a_{2021} \leqslant 1$ and $a_{2023} \leqslant 1$. Therefore $0<$ $\left(a_{2022}\right)^{2}-1 \leqslant\left(1-a_{2021}\right)\left(a_{2023}-1\right) \leqslant 0$, a contradiction. We conclude that $a_{2022} \leqslant 1$.",1,"Let $\left(a_{n}\right)_{n \geqslant 1}$ be a sequence of positive real numbers with the property that

$$
\left(a_{n+1}\right)^{2}+a_{n} a_{n+2} \leqslant a_{n}+a_{n+2}
$$

for all positive integers $n$. Show that $a_{2022} \leqslant 1$.","We begin by observing that $\left(a_{n+1}\right)^{2}-1 \leqslant a_{n}+a_{n+2}-a_{n} a_{n+2}-1$, which is equivalent to

$$
\left(a_{n+1}\right)^{2}-1 \leqslant\left(1-a_{n}\right)\left(a_{n+2}-1\right) .
$$

Suppose now that there exists a positive integer $n$ such that $a_{n+1}>1$ and $a_{n+2}>1$. Since $\left(a_{n+1}\right)^{2}-1 \leqslant\left(1-a_{n}\right)\left(a_{n+2}-1\right)$, we deduce that $0<1-a_{n}<1<1+a_{n+2}$, thus $\left(a_{n+1}\right)^{2}-1<\left(a_{n+2}+1\right)\left(a_{n+2}-1\right)=\left(a_{n+2}\right)^{2}-1$.

On the other hand, $\left(a_{n+2}\right)^{2}-1 \leqslant\left(1-a_{n+3}\right)\left(a_{n+1}-1\right)<\left(1+a_{n+1}\right)\left(a_{n+1}-1\right)=\left(a_{n+1}\right)^{2}-1$, a contradiction. We have shown that we cannot have two consecutive terms, except maybe $a_{1}$ and $a_{2}$, strictly greater than 1 .

Finally, suppose $a_{2022}>1$. This implies that $a_{2021} \leqslant 1$ and $a_{2023} \leqslant 1$. Therefore $0<$ $\left(a_{2022}\right)^{2}-1 \leqslant\left(1-a_{2021}\right)\left(a_{2023}-1\right) \leqslant 0$, a contradiction. We conclude that $a_{2022} \leqslant 1$.",,,,,,
2022a4,"Let $n \geqslant 3$ be an integer, and let $x_{1}, x_{2}, \ldots, x_{n}$ be real numbers in the interval [0, 1]. Let $s=x_{1}+x_{2}+\ldots+x_{n}$, and assume that $s \geqslant 3$. Prove that there exist integers $i$ and $j$ with $1 \leqslant i<j \leqslant n$ such that

$$
2^{j-i} x_{i} x_{j}>2^{s-3} .
$$","Let $1 \leqslant a<b \leqslant n$ be such that $2^{b-a} x_{a} x_{b}$ is maximal. This choice of $a$ and $b$ implies that $x_{a+t} \leqslant 2^{t} x_{a}$ for all $1-a \leqslant t \leqslant b-a-1$, and similarly $x_{b-t} \leqslant 2^{t} x_{b}$ for all $b-n \leqslant t \leqslant b-a+1$. Now, suppose that $x_{a} \in\left(\frac{1}{2^{u+1}}, \frac{1}{2^{u}}\right]$ and $x_{b} \in\left(\frac{1}{2^{v+1}}, \frac{1}{2^{v}}\right]$, and write $x_{a}=2^{-\alpha}, x_{b}=2^{-\beta}$. Then

$$
\sum_{i=1}^{a+u-1} x_{i} \leqslant 2^{u} x_{a}\left(\frac{1}{2}+\frac{1}{4}+\ldots+\frac{1}{2^{a+u-1}}\right)<2^{u} x_{a} \leqslant 1,
$$

and similarly,

$$
\sum_{i=b-v+1}^{n} x_{i} \leqslant 2^{v} x_{b}\left(\frac{1}{2}+\frac{1}{4}+\ldots+\frac{1}{2^{n-b+v}}\right)<2^{v} x_{b} \leqslant 1,
$$

In other words, the sum of the $x_{i}$ 's for $i$ outside of the interval $[a+u, b-v]$ is strictly less than 2. Since the total sum is at least 3 , and each term is at most 1 , it follows that this interval must have at least two integers. i.e., $a+u<b-v$. Thus, by bounding the sum of the $x_{i}$ for $i \in[1, a+u] \cup[b-v, n]$ like above, and trivially bounding each $x_{i} \in(a+u, b-v)$ by 1 , we obtain

$$
s<2^{u+1} x_{a}+2^{v+1} x_{b}+((b-v)-(a+u)-1)=b-a+\left(2^{u+1-\alpha}+2^{v+1-\beta}-(u+v+1)\right) .
$$

Now recall $\alpha \in(u, u+1]$ and $\beta \in(v, v+1]$, so applying Bernoulli's inequality yields $\left.2^{u+1-\alpha}+2^{v+1-\beta}-u-v-1 \leqslant(1+(u+1-\alpha))\right)+(1+(v+1-\beta))-u-v-1=3-\alpha-\beta$.

It follows that $s-3<b-a-\alpha-\beta$, and so

$$
2^{s-3}<2^{b-a-\alpha-\beta}=2^{b-a} x_{a} x_{b} .
$$

Comment 1. It is not hard to see that the inequality is tight. Suppose that $n=2 k+1$, and we set $x_{k+1}=1, x_{k}=x_{k+2}=\frac{1}{2}+\frac{1}{2^{k}}$, and $x_{k+1-t}=x_{k+1+t}=\frac{1}{2^{2}}$. Then $s=3$ (so the right hand side is 1 ), and

$$
\max _{i<j} 2^{j-i} x_{i} x_{j}=2^{2}\left(\frac{1}{2}+\frac{1}{2^{k}}\right)^{2},
$$

which can be made arbitrarily close to 1 . Note that $s$ can be made larger by putting in more 1 -s in the middle (and this accommodates even $n$ as well).

Comment 2. An alternative formulation of the problem is to show that there exists a positive constant $c$ (or find the best such $c$ ) such that

$$
\max _{i<j} 2^{j-i} x_{i} x_{j}>c 2^{s} .
$$

The above shows that $c=1 / 8$ is the best possible. A somewhat simpler ending to the proof can be given for $c=1 / 32$.\\
End of solution for $c=1 / 32$.\\
As in the original solution, we arrive at

$$
s<2^{u+1} x_{a}+2^{v+1} x_{b}+((b-v)-(a+u)-1)=b-a+\left(2^{u+1-\alpha}+2^{v+1-\beta}-(u+v+1)\right) .
$$

Now $2^{b-a} x_{a} x_{b} \geqslant 2^{b-a} 2^{-u-1} 2^{-v-1}$, so it is enough to show $s-5<b-a-u-v-2$, or $s<b-a-$ $u-v+3$. The fact that $u+1-\alpha<1$ and $v+1-\beta<1$ implies $2^{u+1-\alpha}+2^{v+1-\beta}<4$, and so $s<b-a+(2+2-u-v-1)=b-a-u-v-3$.",3,"Let $a,b$ be indices with $1 \le a < b \le n$ that maximize the value of $2^{j-i}x_i x_j$. Define integers $u,v$ and reals $\alpha, \beta$ by $x_a = 2^{-\alpha}$ with $\alpha \in (u, u+1]$ and $x_b = 2^{-\beta}$ with $\beta \in (v, v+1]$. Show that the total sum $s$ satisfies $s < b-a+\left(2^{u+1-\alpha}+2^{v+1-\beta}-(u+v+1)\right)$.","The sum $s = \sum_{i=1}^n x_i$ is partitioned into three parts: terms with index $i < a+u$, $i \in [a+u, b-v]$, and $i > b-v$. By using inequalities derived from the maximality of the pair $(a,b)$ to bound the sums of the outer parts, and bounding the inner terms by 1, the proof establishes the inequality $s < 2^{u+1} x_{a}+2^{v+1} x_{b}+b-a-u-v-1$. Substituting $x_a=2^{-\alpha}$ and $x_b=2^{-\beta}$ gives $s < 2^{u+1-\alpha}+2^{v+1-\beta} + b-a-u-v-1$, which rearranges to the desired inequality.","Using the definitions and the inequality from the previous step, prove that $s-3 < b-a-\alpha-\beta$.","We start with the inequality $s < b-a+\left(2^{u+1-\alpha}+2^{v+1-\beta}-(u+v+1)\right)$. Since $\alpha \in (u, u+1]$ and $\beta \in (v, v+1]$, the exponents $u+1-\alpha$ and $v+1-\beta$ are in the interval $[0,1)$. Using Bernoulli's inequality (or the convexity of $f(y)=2^y$, which implies $2^y \le 1+y$ for $y \in [0,1]$), we bound the parenthetical term: $2^{u+1-\alpha}+2^{v+1-\beta}-(u+v+1) \le (1+u+1-\alpha) + (1+v+1-\beta) - (u+v+1) = 3-\alpha-\beta$. Therefore, $s < b-a+3-\alpha-\beta$, which rearranges to $s-3 < b-a-\alpha-\beta$.","Let $n \geqslant 3$ be an integer, and let $x_{1}, x_{2}, \ldots, x_{n}$ be real numbers in the interval [0, 1]. Let $s=x_{1}+x_{2}+\ldots+x_{n}$, and assume that $s \geqslant 3$. Prove that there exist integers $i$ and $j$ with $1 \leqslant i<j \leqslant n$ such that $2^{j-i} x_{i} x_{j}>2^{s-3}$.","Let $a, b$ be indices with $1 \le a < b \le n$ that maximize the expression $2^{j-i}x_i x_j$. Let $x_a=2^{-\alpha}$ and $x_b=2^{-\beta}$. From the previous sub-problem, we have the inequality $s-3 < b-a-\alpha-\beta$. As the function $y \mapsto 2^y$ is strictly increasing, exponentiating both sides gives $2^{s-3} < 2^{b-a-\alpha-\beta}$. The right-hand side is equal to $2^{b-a} \cdot 2^{-\alpha} \cdot 2^{-\beta} = 2^{b-a}x_a x_b$. This is the maximum value of $2^{j-i}x_i x_j$ by our choice of $a,b$. Thus, we have shown there exists a pair $(i,j)=(a,b)$ satisfying the required inequality.",,
2022c5,"Let $m, n \geqslant 2$ be integers, let $X$ be a set with $n$ elements, and let $X_{1}, X_{2}, \ldots, X_{m}$ be pairwise distinct non-empty, not necessary disjoint subsets of $X$. A function $f: X \rightarrow$ $\{1,2, \ldots, n+1\}$ is called nice if there exists an index $k$ such that

$$
\sum_{x \in X_{k}} f(x)>\sum_{x \in X_{i}} f(x) \text { for all } i \neq k
$$

Prove that the number of nice functions is at least $n^{n}$.","Solution. For a subset $Y \subseteq X$, we write $f(Y)$ for $\sum_{y \in Y} f(y)$. Note that a function $f: X \rightarrow$ $\{1, \ldots, n+1\}$ is nice, if and only if $f\left(X_{i}\right)$ is maximized by a unique index $i \in\{1, \ldots, m\}$.

We will first investigate the set $\mathcal{F}$ of functions $f: X \rightarrow\{1, \ldots, n\}$; note that $|\mathcal{F}|=n^{n}$. For every function $f \in \mathcal{F}$, define a corresponding function $f^{+}: X \rightarrow\{1,2, \ldots, n+1\}$ in the following way: Pick some set $X_{l}$ that maximizes the value $f\left(X_{l}\right)$.

\begin{itemize}
  \item For all $x \in X_{l}$, define $f^{+}(x)=f(x)+1$.
  \item For all $x \in X \backslash X_{l}$, define $f^{+}(x)=f(x)$.
\end{itemize}

Claim. The resulting function $f^{+}$is nice.\\
Proof. Note that $f^{+}\left(X_{i}\right)=f\left(X_{i}\right)+\left|X_{i} \cap X_{l}\right|$ holds for all $X_{i}$. We show that $f^{+}\left(X_{i}\right)$ is maximized at the unique index $i=l$. Hence consider some arbitrary index $j \neq l$. Then $X_{l} \subset X_{j}$ is impossible, as this would imply $f\left(X_{j}\right)>f\left(X_{l}\right)$ and thereby contradict the choice of set $X_{l}$; this in particular yields $\left|X_{l}\right|>\left|X_{j} \cap X_{l}\right|$.

$$
f^{+}\left(X_{l}\right)=f\left(X_{l}\right)+\left|X_{l}\right| \geqslant f\left(X_{j}\right)+\left|X_{l}\right|>f\left(X_{j}\right)+\left|X_{j} \cap X_{l}\right|=f^{+}\left(X_{j}\right)
$$

The first inequality follows since $X_{l}$ was chosen to maximize the value $f\left(X_{l}\right)$. The second (strict) inequality follows from $\left|X_{l}\right|>\left|X_{j} \cap X_{l}\right|$ as observed above. This completes the proof of the claim.

Next observe that function $f$ can be uniquely reconstructed from $f^{+}$: the claim yields that $f^{+}$has a unique maximizer $X_{l}$, and by decreasing the value of $f^{+}$on $X_{l}$ by 1 , we get we can fully determine the values of $f$. As each of the $n^{n}$ functions $f \in \mathcal{F}$ yields a (unique) corresponding nice function $f^{+}: X \rightarrow\{1,2, \ldots, n+1\}$, the proof is complete.",3,"Let $f: X \rightarrow \{1, \ldots, n\}$ be a function, and let $X_l$ be a subset from $\{X_1, \ldots, X_m\}$ that maximizes the sum $\\sum_{x \in X_i} f(x)$. Prove that for any $j \neq l$, we have $|X_l| > |X_j \cap X_l|$.","Assume for contradiction that $|X_l| \le |X_j \cap X_l|$ for some $j \neq l$. Since $X_l$ and $X_j$ are distinct sets, this inequality implies that $X_l$ is a proper subset of $X_j$. Because $X_j \\setminus X_l$ is non-empty and $f(x) \ge 1$ for all $x \in X$, the sum over the elements in this difference is positive: $\\sum_{x \in X_j \\setminus X_l} f(x) > 0$. This leads to $\\sum_{x \in X_j} f(x) = \\sum_{x \in X_l} f(x) + \\sum_{x \in X_j \\setminus X_l} f(x) > \\sum_{x \in X_l} f(x)$, which contradicts the choice of $X_l$ as a set that maximizes the sum. Therefore, the initial assumption must be false, and $|X_l| > |X_j \cap X_l|$.","For each function $f: X \rightarrow \{1, \ldots, n\}$, choose a set $X_l$ which maximizes the sum $\\sum_{x \in X_i} f(x)$. Define a new function $f^+: X \rightarrow \{1, \ldots, n+1\}$ by setting $f^+(x) = f(x)+1$ for $x \in X_l$ and $f^+(x) = f(x)$ for $x \notin X_l$. Prove that $f^+$ is a nice function.","Let $S_i = \\sum_{x \in X_i} f(x)$. By construction of $X_l$, we have $S_l \ge S_j$ for any $j \neq l$. For the function $f^+$, the sum over a set $X_i$ is $S_i^+ = \\sum_{x \in X_i} f^+(x) = S_i + |X_i \cap X_l|$. We need to show $S_l^+ > S_j^+$ for any $j \neq l$. We can write $S_l^+ = S_l + |X_l|$ and $S_j^+ = S_j + |X_j \cap X_l|$. From the result of the previous sub-problem, we know that $|X_l| > |X_j \cap X_l|$. Combining these facts, we get $S_l^+ = S_l + |X_l| \ge S_j + |X_l| > S_j + |X_j \cap X_l| = S_j^+$. This establishes that $X_l$ is the unique maximizer for $f^+$, and thus $f^+$ is a nice function.","Let $m, n \geqslant 2$ be integers, let $X$ be a set with $n$ elements, and let $X_{1}, X_{2}, \ldots, X_{m}$ be pairwise distinct non-empty, not necessary disjoint subsets of $X$. A function $f: X \rightarrow \\{1,2, \ldots, n+1\\}$ is called nice if there exists an index $k$ such that $\\sum_{x \in X_{k}} f(x)>\\sum_{x \in X_{i}} f(x)$ for all $i \neq k$. Prove that the number of nice functions is at least $n^{n}$.","Let $\\mathcal{F}$ be the set of all functions $f: X \rightarrow \\{1, \ldots, n\\}$. The size of this set is $|\\mathcal{F}| = n^n$. The construction from the previous sub-problem defines a map $\\phi: \\mathcal{F} \rightarrow \\{\text{nice functions}\\}$ by $\\phi(f) = f^+$. We prove this map is injective. Suppose $g$ is a nice function in the image of $\\phi$. By definition, $g$ has a unique maximizer set, say $X_k$. This must be the set $X_l$ used in its construction. We can uniquely recover the original function $f$ from $g$ by setting $f(x) = g(x) - 1$ for $x \\in X_k$ and $f(x) = g(x)$ for $x \notin X_k$. Since the pre-image $f$ is uniquely determined by $g = f^+$, the map $\\phi$ is injective. An injective map from a set of size $n^n$ to the set of nice functions proves that the number of nice functions is at least $n^n$.",,
2022g1,"Let $A B C D E$ be a convex pentagon such that $B C=D E$. Assume there is a point $T$ inside $A B C D E$ with $T B=T D, T C=T E$ and $\angle T B A=\angle A E T$. Let lines $C D$ and $C T$ intersect line $A B$ at points $P$ and $Q$, respectively, and let lines $C D$ and $D T$ intersect line $A E$ at points $R$ and $S$, respectively. Assume that points $P, B, A, Q$ and $R, E, A, S$ respectively, are collinear and occur on their lines in this order. Prove that the points $P, S, Q, R$ are concyclic.","By the conditions we have $B C=D E, C T=E T$ and $T B=T D$, so the triangles $T B C$ and $T D E$ are congruent, in particular $\angle B T C=\angle D T E$.

In triangles $T B Q$ and $T E S$ we have $\angle T B Q=\angle S E T$ and $\angle Q T B=180^{\circ}-\angle B T C=180^{\circ}-$ $\angle D T E=\angle E T S$, so these triangles are similar to each other. It follows that $\angle T S E=\angle B Q T$ and

$$
\frac{T D}{T Q}=\frac{T B}{T Q}=\frac{T E}{T S}=\frac{T C}{T S} .
$$

By rearranging this relation we get $T D \cdot T S=T C \cdot T Q$, so $C, D, Q$ and $S$ are concyclic. (Alternatively, we can get $\angle C Q D=\angle C S D$ from the similar triangles $T C S$ and $T D Q$.) Hence, $\angle D C Q=\angle D S Q$.

Finally, from the angles of triangle $C Q P$ we get

$$
\angle R P Q=\angle R C Q-\angle P Q C=\angle D S Q-\angle D S R=\angle R S Q,
$$

which proves that $P, Q, R$ and $S$ are concyclic.\\",2,"Under the given conditions, prove that the points $C, D, Q, S$ are concyclic.","The conditions $B C=D E, C T=E T, T B=T D$ imply that $\triangle TBC \cong \triangle TDE$ by SSS congruence, so $\angle BTC = \angle DTE$. As angles on a straight line, $\angle QTB = 180^{\circ} - \angle BTC$ and $\angle ETS = 180^{\circ} - \angle DTE$, so $\angle QTB = \angle ETS$. Given $\angle TBA = \angle AET$ (which is $\angle TBQ = \angle TES$), we have $\triangle TBQ \sim \triangle TES$ by AA similarity. This similarity yields the proportion $\frac{TB}{TE} = \frac{TQ}{TS}$. Substituting the given $TB=TD$ and $TE=TC$, we get $\frac{TD}{TC} = \frac{TQ}{TS}$, which rearranges to $TD \cdot TS = TC \cdot TQ$. By the converse of the power of a point theorem, this implies that points $C, D, Q, S$ are concyclic.","Prove that the points $P, S, Q, R$ are concyclic.","From the first sub-problem, $C, D, Q, S$ are concyclic, so $\angle DCQ = \angle DSQ$. Since $P, C, R$ are collinear, this means $\angle RCQ = \angle DSQ$. From the similarity $\triangle TBQ \sim \triangle TES$ (established in Part 1), we have $\angle BQT = \angle TSE$. Since $\angle PQC$ and $\angle DSR$ are supplementary to $\angle BQT$ and $\angle TSE$ respectively, it follows that $\angle PQC = \angle DSR$. By the exterior angle theorem on $\triangle CQP$, we have $\angle RCQ = \angle RPQ + \angle PQC$, which gives $\angle RPQ = \angle RCQ - \angle PQC$. Substituting the derived angle equalities, we get $\angle RPQ = \angle DSQ - \angle DSR = \angle RSQ$. This equality proves that $P, S, Q, R$ are concyclic.",,,,
2022g2,"In the acute-angled triangle $A B C$, the point $F$ is the foot of the altitude from $A$, and $P$ is a point on the segment $A F$. The lines through $P$ parallel to $A C$ and $A B$ meet $B C$ at $D$ and $E$, respectively. Points $X \neq A$ and $Y \neq A$ lie on the circles $A B D$ and $A C E$, respectively, such that $D A=D X$ and $E A=E Y$.

Prove that $B, C, X$ and $Y$ are concyclic.","Let $A^{\prime}$ be the intersection of lines $B X$ and $C Y$. By power of a point, it suffices to prove that $A^{\prime} B \cdot A^{\prime} X=A^{\prime} C \cdot A^{\prime} Y$, or, equivalently, that $A^{\prime}$ lies on the radical axis of the circles $A B D X$ and $A C E Y$.

From $D A=D X$ it follows that in circle $A B D X$, point $D$ bisects of one of the arcs $A X$. Therefore, depending on the order of points, the line $B C$ is either the internal or external bisector of $\angle A B X$. In both cases, line $B X$ is the reflection of $B A$ in line $B D C$. Analogously, line $C Y$ is the reflection of $C A$ in line $B C$; we can see that $A^{\prime}$ is the reflection of $A$ in line $B C$, so $A, F$ and $A^{\prime}$ are collinear.

By $P D \| A C$ and $P E \| A B$ we have $\frac{F D}{F C}=\frac{F P}{F A}=\frac{F E}{F B}$, hence $F D \cdot F B=F E \cdot F C$. So, point $F$ has equal powers with respect to circles $A B D X$ and $A C E Y$.

Point $A$, being a common point of the two circles, is another point with equal powers, so the radical axis of circles $A B D X$ and $A C E Y$ is the altitude $A F$ that passes through $A^{\prime}$.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_d37d4d050b74b6f29ab9g-48}",2,Let $\omega_1$ be the circumcircle of $\triangle ABD$ and $\omega_2$ be the circumcircle of $\triangle ACE$. Show that the altitude $AF$ is the radical axis of $\omega_1$ and $\omega_2$.,"The radical axis is the locus of points with equal power with respect to two circles. Point $A$ is on both circles, so its power with respect to both is 0. Thus, $A$ is on the radical axis. From $P$ on segment $AF$, we have $PD \parallel AC$ and $PE \parallel AB$. By similar triangles in $\triangle AFC$ and $\triangle AFB$ respectively, we have $\frac{FP}{FA} = \frac{FD}{FC}$ and $\frac{FP}{FA} = \frac{FE}{FB}$. Therefore, $\frac{FD}{FC} = \frac{FE}{FB}$, which implies $FD \cdot FB = FE \cdot FC$. This equality shows that point $F$ has the same power with respect to circles $\omega_1$ and $\omega_2$. Since both $A$ and $F$ lie on the radical axis, the line $AF$ is the radical axis of the two circles.","Prove that $B, C, X$ and $Y$ are concyclic.","Let $A'$ be the intersection of lines $BX$ and $CY$. The points $B, C, X, Y$ are concyclic if and only if $A'$ has equal power with respect to circle $(ABDX)$ and circle $(ACEY)$, which means $A'$ must lie on their radical axis. From the first sub-problem, the radical axis is the line $AF$. In circle $(ABDX)$, the condition $DA=DX$ implies that the line $BC$ bisects $\angle ABX$. Thus, line $BX$ is the reflection of line $BA$ across line $BC$. Similarly, $EA=EY$ in circle $(ACEY)$ implies that line $CY$ is the reflection of line $CA$ across line $BC$. The intersection $A'$ of these reflected lines must be the reflection of point $A$ across line $BC$. Since $A'$ is the reflection of $A$ across $BC$ and $F$ is the foot of the altitude from $A$, the points $A, F, A'$ are collinear. Therefore, $A'$ lies on the line $AF$. As $AF$ is the radical axis, $A'$ has equal power with respect to both circles, which proves that $B, C, X, Y$ are concyclic.",,,,
2022g3,"Let $A B C D$ be a cyclic quadrilateral. Assume that the points $Q, A, B, P$ are collinear in this order, in such a way that the line $A C$ is tangent to the circle $A D Q$, and the line $B D$ is tangent to the circle $B C P$. Let $M$ and $N$ be the midpoints of $B C$ and $A D$, respectively. Prove that the following three lines are concurrent: line $C D$, the tangent of circle $A N Q$ at point $A$, and the tangent to circle $B M P$ at point $B$.","We first prove that triangles $A D Q$ and $C D B$ are similar. Since $A B C D$ is cyclic, we have $\angle D A Q=\angle D C B$. By the tangency of $A C$ to the circle $A Q D$ we also have $\angle C B D=\angle C A D=\angle A Q D$. The claimed similarity is proven.

Let $R$ be the midpoint of $C D$. Points $N$ and $R$ correspond in the proven similarity, and so $\angle Q N A=\angle B R C$.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_d37d4d050b74b6f29ab9g-49}

Let $K$ be the second common point of line $C D$ with circle $A B R$ (i.e., if $C D$ intersects circle $A B R$, then $K \neq R$ is the other intersection; otherwise, if $C D$ is tangent to $C D$, then $K=R$ ). In both cases, we have $\angle B A K=\angle B R C=\angle Q N A$; that indicates that $A K$ is tangent to circle $A N Q$. It can be showed analogously that $B K$ is tangent to circle $B M P$.

Comment. Note that $M$ and $N$ can be any points on lines $B C$ and $A D$ such that $B M: M C=$ $D N: N A$, as we then simply choose $R$ to be such that $D R: R C$ is that same ratio, and the rest of the proof remains unchanged.",2,Let R be the midpoint of CD. Prove the angle equalities $\angle QNA = \angle BRC$ and $\angle BMP = \angle DRA$.,"First, we prove that $\triangle ADQ \sim \triangle CDB$. Since $ABCD$ is a cyclic quadrilateral, the exterior angle at vertex $A$ equals the interior opposite angle, so $\angle DAQ = \angle DCB$. By the tangent-chord theorem for the circle $ADQ$ with tangent $AC$, we have $\angle AQD = \angle CAD$. In the circumcircle of $ABCD$, angles subtended by the same arc $CD$ are equal, so $\angle CAD = \angle CBD$. Therefore, $\angle AQD = \angle CBD$. By AA similarity, $\triangle ADQ \sim \triangle CDB$. This similarity maps vertices $(A, D, Q)$ to $(C, D, B)$. Since $N$ and $R$ are midpoints of corresponding sides $AD$ and $CD$, it follows that $\triangle QAN \sim \triangle BCR$. Thus, the corresponding angles are equal: $\angle QNA = \angle BRC$. The proof for the second equality is analogous. We first show $\triangle BCP \sim \triangle DCA$. Since $ABCD$ is cyclic, $\angle PBC = 180^\circ - \angle ABC = \angle ADC$. By the tangent-chord theorem for circle $BCP$ with tangent $BD$, we have $\angle BPC = \angle BDC$. In circle $ABCD$, $\angle BDC = \angle BAC$. Thus, $\angle BPC = \angle BAC$. By AA similarity, $\triangle BCP \sim \triangle DCA$. This similarity maps vertices $(B, C, P)$ to $(D, C, A)$. Since $M$ and $R$ are midpoints of corresponding sides $BC$ and $DC$, it follows that $\triangle PBM \sim \triangle ADR$. Thus, $\angle BMP = \angle DRA$.","Prove that the following three lines are concurrent: line $CD$, the tangent of circle $ANQ$ at point $A$, and the tangent to circle $BMP$ at point $B$.","Let $R$ be the midpoint of $CD$. Let $K$ be the second intersection point of the line $CD$ with the circumcircle of $\triangle ABR$. By construction, $K$ is on the line $CD$, and the points $A, B, R, K$ are concyclic. We will show that $K$ is the point of concurrency. Let $t_A$ be the tangent to circle $ANQ$ at $A$. By the converse of the tangent-chord theorem, $AK$ is $t_A$ if $\angle(AK, AQ) = \angle ANQ$. As $Q, A, B$ are collinear, this is $\angle BAK = \angle ANQ$. Since $A, B, R, K$ form a cyclic quadrilateral, the exterior angle at vertex $R$ is equal to the interior opposite angle at $A$, so $\angle BAK = \angle BRC$. From the first sub-problem, we have $\angle BRC = \angle QNA$. Thus, $\angle BAK = \angle ANQ$, which proves that line $AK$ is the tangent $t_A$. Similarly, let $t_B$ be the tangent to circle $BMP$ at $B$. $BK$ is $t_B$ if $\angle(BK, BP) = \angle BMP$, which is $\angle KBA = \angle BMP$. In cyclic quadrilateral $ABRK$, $\angle KBA = \angle KRA$ (angles subtended by chord $AK$). Since $K, R, D$ are collinear, $\angle KRA = \angle DRA$. From the first sub-problem, $\angle BMP = \angle DRA$. Therefore, $\angle KBA = \angle BMP$, which proves that line $BK$ is the tangent $t_B$. Since $K$ lies on line $CD$, and $AK$ and $BK$ are the specified tangents, the three lines are concurrent at $K$.",,,,
2022g4,"Let $A B C$ be an acute-angled triangle with $A C>A B$, let $O$ be its circumcentre, and let $D$ be a point on the segment $B C$. The line through $D$ perpendicular to $B C$ intersects the lines $A O, A C$ and $A B$ at $W, X$ and $Y$, respectively. The circumcircles of triangles $A X Y$ and $A B C$ intersect again at $Z \neq A$.

Prove that if $O W=O D$, then $D Z$ is tangent to the circle $A X Y$.","Let $A O$ intersect $B C$ at $E$. As $E D W$ is a right-angled triangle and $O$ is on $W E$, the condition $O W=O D$ means $O$ is the circumcentre of this triangle. So $O D=O E$ which establishes that $D, E$ are reflections in the perpendicular bisector of $B C$.

Now observe:

$$
180^{\circ}-\angle D X Z=\angle Z X Y=\angle Z A Y=\angle Z C D,
$$

which shows $C D X Z$ is cyclic.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_d37d4d050b74b6f29ab9g-51}

We next show that $A Z \| B C$. To do this, introduce point $Z^{\prime}$ on circle $A B C$ such that $A Z^{\prime} \| B C$. By the previous result, it suffices to prove that $C D X Z^{\prime}$ is cyclic. Notice that triangles $B A E$ and $C Z^{\prime} D$ are reflections in the perpendicular bisector of $B C$. Using this and that $A, O, E$ are collinear:

$$
\angle D Z^{\prime} C=\angle B A E=\angle B A O=90^{\circ}-\frac{1}{2} \angle A O B=90^{\circ}-\angle C=\angle D X C \text {, }
$$

so $D X Z^{\prime} C$ is cyclic, giving $Z \equiv Z^{\prime}$ as desired.\\
Using $A Z \| B C$ and $C D X Z$ cyclic we get:

$$
\angle A Z D=\angle C D Z=\angle C X Z=\angle A Y Z,
$$

which by the converse of alternate segment theorem shows $D Z$ is tangent to circle $A X Y$.",2,"Let $A B C$ be a triangle with circumcentre $O$. Let $D$ be a point on $BC$, and a line through $D$ perpendicular to $BC$ intersect $AO, AC, AB$ at $W, X, Y$. Let the circumcircles of $\triangle AXY$ and $\triangle ABC$ intersect at $A$ and $Z$. Prove that if $OW=OD$, then $AZ$ is parallel to $BC$.","Let $E$ be the intersection of the line $AO$ and $BC$. Since the line segment $WD$ is on the line perpendicular to $BC$ passing through $D$, the triangle $\triangle WDE$ has a right angle at $D$. The condition $OW=OD$, with $O$ lying on the hypotenuse $WE$, implies that $O$ is the circumcenter of $\triangle WDE$. Therefore, $OD=OE$. As $O$ is the circumcenter of $\triangle ABC$, it lies on the perpendicular bisector of $BC$. Since $D, E$ are on the line $BC$, the condition $OD=OE$ means that $D$ and $E$ are reflections of each other in the perpendicular bisector of $BC$. Now, let $Z'$ be the point on the circumcircle of $\triangle ABC$ such that $AZ' \parallel BC$. This implies that $A$ and $Z'$ are also reflections in the perpendicular bisector of $BC$. This symmetry maps $\triangle BAE$ to $\triangle CZ'D$, so $\angle DZ'C = \angle BAE = \angle BAO = 90^\circ - \angle C$. In the right-angled triangle $DXC$, we also have $\angle DXC = 90^\circ - \angle C$. Thus, $\angle DZ'C = \angle DXC$, which means $C,D,X,Z'$ are concyclic. From the definitions, we know $A,X,Y,Z$ are concyclic, so $\angle ZXY = \angle ZAY$, and $A,B,C,Z$ are concyclic, so $\angle ZAY = \angle ZAB = \angle ZCB = \angle ZCD$. Since $D,X,Y$ are collinear, $\angle DXZ + \angle ZXY = 180^\circ$, so $\angle DXZ + \angle ZCD = 180^\circ$, which implies $C,D,X,Z$ is a cyclic quadrilateral. Since both $Z$ and $Z'$ lie on the circumcircle of $\triangle ABC$ and on the circle through $C,D,X$, they must coincide. Therefore $Z=Z'$, which implies $AZ \parallel BC$.","Let $A B C$ be an acute-angled triangle with $A C>A B$, let $O$ be its circumcentre, and let $D$ be a point on the segment $B C$. The line through $D$ perpendicular to $B C$ intersects the lines $A O, A C$ and $A B$ at $W, X$ and $Y$, respectively. The circumcircles of triangles $A X Y$ and $A B C$ intersect again at $Z \neq A$. Prove that if $O W=O D$, then $D Z$ is tangent to the circle $A X Y$.","From the first sub-problem, the condition $OW=OD$ implies that $AZ \parallel BC$. To prove that $DZ$ is tangent to the circumcircle of $\triangle AXY$ at $Z$, we use the converse of the Alternate Segment Theorem. We aim to show that the angle between the line $DZ$ and the chord $AZ$ is equal to the angle subtended by the chord in the alternate segment, which is $\angle AYZ$. As $AZ \parallel BC$ and $D$ lies on the line $BC$, we have $\angle AZD = \angle CDZ$ because they are alternate interior angles. As established in the previous sub-problem, the quadrilateral $CDXZ$ is cyclic. This implies $\angle CDZ = \angle CXZ$, as they subtend the same arc $CZ$. The points $A,X,Y,Z$ are also concyclic, so $\angle AXZ = \angle AYZ$. Since $X$ lies on the line segment $AC$, $\angle CXZ$ is the same angle as $\angle AXZ$. Combining these angle equalities, we get the chain: $\angle AZD = \angle CDZ = \angle CXZ = \angle AYZ$. This shows $\angle AZD = \angle AYZ$, which completes the proof that $DZ$ is tangent to the circle $AXY$.",,,,
2022g5,"Let $A B C$ be a triangle, and let $\ell_{1}$ and $\ell_{2}$ be two parallel lines. For $i=1,2$, let $\ell_{i}$ meet the lines $B C, C A$, and $A B$ at $X_{i}, Y_{i}$, and $Z_{i}$, respectively. Suppose that the line through $X_{i}$ perpendicular to $B C$, the line through $Y_{i}$ perpendicular to $C A$, and finally the line through $Z_{i}$ perpendicular to $A B$, determine a non-degenerate triangle $\Delta_{i}$.

Show that the circumcircles of $\Delta_{1}$ and $\Delta_{2}$ are tangent to each other.","Throughout the solutions, $\Varangle(p, q)$ will denote the directed angle between lines $p$ and $q$, taken modulo $180^{\circ}$.

Let the vertices of $\Delta_{i}$ be $D_{i}, E_{i}, F_{i}$, such that lines $E_{i} F_{i}, F_{i} D_{i}$ and $D_{i} E_{i}$ are the perpendiculars through $X, Y$ and $Z$, respectively, and denote the circumcircle of $\Delta_{i}$ by $\omega_{i}$.

In triangles $D_{1} Y_{1} Z_{1}$ and $D_{2} Y_{2} Z_{2}$ we have $Y_{1} Z_{1} \| Y_{2} Z_{2}$ because they are parts of $\ell_{1}$ and $\ell_{2}$. Moreover, $D_{1} Y_{1} \| D_{2} Y_{2}$ are perpendicular to $A C$ and $D_{1} Z_{1} \| D_{2} Z_{2}$ are perpendicular to $A B$, so the two triangles are homothetic and their homothetic centre is $Y_{1} Y_{2} \cap Z_{1} Z_{2}=A$. Hence, line $D_{1} D_{2}$ passes through $A$. Analogously, line $E_{1} E_{2}$ passes through $B$ and $F_{1} F_{2}$ passes through $C$.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_d37d4d050b74b6f29ab9g-53}

The corresponding sides of $\Delta_{1}$ and $\Delta_{2}$ are parallel, because they are perpendicular to the respective sides of triangle $A B C$. Hence, $\Delta_{1}$ and $\Delta_{2}$ are either homothetic, or they can be translated to each other. Using that $B, X_{2}, Z_{2}$ and $E_{2}$ are concyclic, $C, X_{2}, Y_{2}$ and $F_{2}$ are concyclic, $Z_{2} E_{2} \perp A B$ and $Y_{2}, F_{2} \perp A C$ we can calculate


\begin{align*}
\Varangle\left(E_{1} E_{2}, F_{1} F_{2}\right) & =\Varangle\left(E_{1} E_{2}, X_{1} X_{2}\right)+\Varangle\left(X_{1} X_{2}, F_{1} F_{2}\right)=\Varangle\left(B E_{2}, B X_{2}\right)+\Varangle\left(C X_{2}, C F_{2}\right) \\
& =\Varangle\left(Z_{2} E_{2}, Z_{2} X_{2}\right)+\Varangle\left(Y_{2} X_{2}, Y_{2} F_{2}\right)=\Varangle\left(Z_{2} E_{2}, \ell_{2}\right)+\Varangle\left(\ell_{2}, Y_{2} F_{2}\right) \\
& =\Varangle\left(Z_{2} E_{2}, Y_{2} F_{2}\right)=\Varangle(A B, A C) \not \equiv 0, \tag{1}
\end{align*}


and conclude that lines $E_{1} E_{2}$ and $F_{1} F_{2}$ are not parallel. Hence, $\Delta_{1}$ and $\Delta_{2}$ are homothetic; the lines $D_{1} D_{2}, E_{1} E_{2}$, and $F_{1} F_{2}$ are concurrent at the homothetic centre of the two triangles. Denote this homothetic centre by $H$.

For $i=1,2$, using (1), and that $A, Y_{i}, Z_{i}$ and $D_{i}$ are concyclic,

$$
\begin{aligned}
\Varangle\left(H E_{i}, H F_{i}\right) & =\Varangle\left(E_{1} E_{2}, F_{1} F_{2}\right)=\Varangle(A B, A C) \\
& =\Varangle\left(A Z_{i}, A Y_{i}\right)=\Varangle\left(D_{i} Z_{i}, D_{i} Y_{i}\right)=\Varangle\left(D_{i} E_{i}, D_{i} F_{i}\right),
\end{aligned}
$$

so $H$ lies on circle $\omega_{i}$.\\
The same homothety that maps $\Delta_{1}$ to $\Delta_{2}$, sends $\omega_{1}$ to $\omega_{2}$ as well. Point $H$, that is the centre of the homothety, is a common point of the two circles, That finishes proving that $\omega_{1}$ and $\omega_{2}$ are tangent to each other.",3,"Show that the triangles $\Delta_1$ and $\Delta_2$ are homothetic, with the lines connecting corresponding vertices ($D_1D_2, E_1E_2, F_1F_2$) concurring at the center of homothety $H$. Furthermore, show that the directed angle $\Varangle(E_1E_2, F_1F_2) = \Varangle(AB, AC)$.","The sides of $\Delta_1$ and $\Delta_2$ are parallel, as they are constructed to be perpendicular to the sides of $\triangle ABC$. This implies $\Delta_1$ and $\Delta_2$ are either related by a translation or a homothety. To distinguish, we compute the angle between the lines connecting corresponding vertices, e.g., $E_1E_2$ and $F_1F_2$. Using the cyclic quadrilaterals $BX_2E_2Z_2$ and $CX_2F_2Y_2$, we find $\Varangle(E_1E_2, F_1F_2) = \Varangle(BE_2, CF_2) = \Varangle(Z_2E_2, Z_2X_2) + \Varangle(Y_2X_2, Y_2F_2) = \Varangle(Z_2E_2, Y_2F_2)$. Since $Z_2E_2 \perp AB$ and $Y_2F_2 \perp AC$, this angle equals $\Varangle(AB, AC)$. As $\triangle ABC$ is non-degenerate, this angle is non-zero, so the lines are not parallel. Thus, $\Delta_1$ and $\Delta_2$ are homothetic and the lines $D_1D_2, E_1E_2, F_1F_2$ concur at the center of homothety $H$.","Show that the center of homothety $H$ lies on the circumcircles $\omega_1$ and $\omega_2$ of triangles $\Delta_1$ and $\Delta_2$, respectively.","To show $H$ lies on $\omega_i$, the circumcircle of $\Delta_i=D_iE_iF_i$, we show that $\Varangle(HE_i, HF_i) = \Varangle(D_iE_i, D_iF_i)$. From the first sub-problem, $\Varangle(HE_i, HF_i) = \Varangle(E_1E_2, F_1F_2) = \Varangle(AB, AC)$. The vertex $D_i$ is the intersection of the line through $Y_i$ perpendicular to $AC$ (line $D_iF_i$) and the line through $Z_i$ perpendicular to $AB$ (line $D_iE_i$). The quadrilateral $AY_iD_iZ_i$ is cyclic as $\angle AY_iD_i = \angle AZ_iD_i = 90^\circ$. Thus, the angle at vertex $D_i$ is $\Varangle(D_iE_i, D_iF_i) = \Varangle(AZ_i, AY_i) = \Varangle(AB, AC)$. Since both angles equal $\Varangle(AB, AC)$, we conclude $H, D_i, E_i, F_i$ are concyclic, meaning $H$ lies on $\omega_i$ for $i=1, 2$.",Show that the circumcircles of $\Delta_{1}$ and $\Delta_{2}$ are tangent to each other.,"From the first sub-problem, $\Delta_1$ and $\Delta_2$ are related by a homothety centered at $H$. This homothety also maps the circumcircle $\omega_1$ of $\Delta_1$ to the circumcircle $\omega_2$ of $\Delta_2$. From the second sub-problem, the center of homothety $H$ is a common point of both circles. A homothety that maps one circle to another, and whose center lies on both circles, implies that the circles are tangent at that center. Therefore, $\omega_1$ and $\omega_2$ are tangent at point $H$.",,
2022g6,"In an acute-angled triangle $A B C$, point $H$ is the foot of the altitude from $A$. Let $P$ be a moving point such that the bisectors $k$ and $\ell$ of angles $P B C$ and $P C B$, respectively, intersect each other on the line segment $A H$. Let $k$ and $A C$ meet at $E$, let $\ell$ and $A B$ meet at $F$, and let $E F$ and $A H$ meet at $Q$. Prove that, as $P$ varies, the line $P Q$ passes through a fixed point.","Let the reflections of the line $B C$ with respect to the lines $A B$ and $A C$ intersect at point $K$. We will prove that $P, Q$ and $K$ are collinear, so $K$ is the common point of the varying line $P Q$.

Let lines $B E$ and $C F$ intersect at $I$. For every point $O$ and $d>0$, denote by $(O, d)$ the circle centred at $O$ with radius $d$, and define $\omega_{I}=(I, I H)$ and $\omega_{A}=(A, A H)$. Let $\omega_{K}$ and $\omega_{P}$ be the incircle of triangle $K B C$ and the $P$-excircle of triangle $P B C$, respectively.

Since $I H \perp B C$ and $A H \perp B C$, the circles $\omega_{A}$ and $\omega_{I}$ are tangent to each other at $H$. So, $H$ is the external homothetic centre of $\omega_{A}$ and $\omega_{I}$. From the complete quadrangle $B C E F$ we have $(A, I ; Q, H)=-1$, therefore $Q$ is the internal homothetic centre of $\omega_{A}$ and $\omega_{I}$. Since $B A$ and $C A$ are the external bisectors of angles $\angle K B C$ and $\angle K C B$, circle $\omega_{A}$ is the $K$-excircle in triangle $B K C$. Hence, $K$ is the external homothetic centre of $\omega_{A}$ and $\omega_{K}$. Also it is clear that $P$ is the external homothetic centre of $\omega_{I}$ and $\omega_{P}$. Let point $T$ be the tangency point of $\omega_{P}$ and $B C$, and let $T^{\prime}$ be the tangency point of $\omega_{K}$ and $B C$. Since $\omega_{I}$ is the incircle and $\omega_{P}$ is the $P$-excircle of $P B C, T C=B H$ and since $\omega_{K}$ is the incircle and $\omega_{A}$ is the $K$-excircle of $K B C, T^{\prime} C=B H$. Therefore $T C=T^{\prime} C$ and $T \equiv T^{\prime}$. It yields that $\omega_{K}$ and $\omega_{P}$ are tangent to each other at $T$.\\

Let point $S$ be the internal homothetic centre of $\omega_{A}$ and $\omega_{P}$, and let $S^{\prime}$ be the internal homothetic centre of $\omega_{I}$ and $\omega_{K}$. It's obvious that $S$ and $S^{\prime}$ lie on $B C$. We claim that $S \equiv S^{\prime}$. To prove our claim, let $r_{A}, r_{I}, r_{P}$, and $r_{K}$ be the radii of $\omega_{A}, \omega_{I}, \omega_{P}$ and $\omega_{k}$, respectively.

It is well known that if the sides of a triangle are $a, b, c$, its semiperimeter is $s=(a+b+c) / 2$, and the radii of the incircle and the $a$-excircle are $r$ and $r_{a}$, respectively, then $r \cdot r_{a}=(s-b)(s-c)$. Applying this fact to triangle $P B C$ we get $r_{I} \cdot r_{P}=B H \cdot C H$. The same fact in triangle $K C B$\\
yields $r_{K} \cdot r_{A}=C T \cdot B T$. Since $B H=C T$ and $B T=C H$, from these two we get

$$
\frac{H S}{S T}=\frac{r_{A}}{r_{P}}=\frac{r_{I}}{r_{K}}=\frac{H S^{\prime}}{S^{\prime} T},
$$

so $S=S^{\prime}$ indeed.\\
Finally, by applying the generalised Monge's theorem to the circles $\omega_{A}, \omega_{I}$, and $\omega_{K}$ (with two pairs of internal and one pair of external common tangents), we can see that points $Q$, $S$, and $K$ are collinear. Similarly one can show that $Q, S$ and $P$ are collinear, and the result follows.",4,"Define a fixed point $K$ as the intersection of the reflections of line $BC$ with respect to lines $AB$ and $AC$. Prove that $A$ is the center of the $K$-excircle of triangle $KBC$, and that this excircle is tangent to $BC$ at $H$.","By the definition of line reflection, $AB$ and $AC$ are the external angle bisectors of $\angle KBC$ and $\angle KCB$, respectively. Therefore, $A$ is the center of the excircle of $\triangle KBC$ opposite to vertex $K$ (the $K$-excircle). The radius of this excircle is the distance from $A$ to $BC$, which is $AH$. As $H$ is the foot of the altitude from $A$, this excircle is tangent to the line $BC$ at point $H$.","Let $I$ be the incenter of $\triangle PBC$, which lies on $AH$. Let $\omega_I$ be the incircle of $\triangle PBC$ and $\omega_A$ be the circle $(A, AH)$. Show that $Q$, the intersection of $EF$ and $AH$, is the internal homothetic center of $\omega_A$ and $\omega_I$.","Since $I$ is on $AH$ and $AH \perp BC$, the incircle $\omega_I=(I,IH)$ is tangent to $BC$ at $H$. The circle $\omega_A=(A,AH)$ is also tangent to $BC$ at $H$. Thus, $H$ is the external homothetic center of $\omega_A$ and $\omega_I$. In the complete quadrangle $BCEF$, the line $AH$ (containing points $A, I$) is cut harmonically by the intersections with diagonals $EF$ (at $Q$) and $BC$ (at $H$). This gives the harmonic conjugate relation $(A, I; Q, H)=-1$. Since $H$ is the external center of homothety, $Q$ must be the internal center of homothety for circles $\omega_A$ and $\omega_I$.",Let $\omega_P$ be the $P$-excircle of $\triangle PBC$ and $\omega_K$ be the incircle of $\triangle KBC$. Show that these two circles are tangent to each other at a point on the line segment $BC$.,"The incircle of $\triangle PBC$ is tangent to $BC$ at $H$. The distance from vertex $C$ to the tangency point $T$ of the $P$-excircle on $BC$ is $CT = (BC+PB-PC)/2$. This length is also equal to the distance $BH$. Similarly, the $K$-excircle of $\triangle KBC$ is tangent to $BC$ at $H$. The distance from vertex $C$ to the tangency point $T'$ of the incircle of $\triangle KBC$ on $BC$ is $CT' = (BC+KC-KB)/2$. This length is also equal to the distance $BH$. Thus, $T=T'$. As both circles are tangent to $BC$ at the same point, they are tangent to each other at that point.","Prove that, as $P$ varies, the line $PQ$ passes through a fixed point.","Let $K$ be the fixed point from the first sub-problem. We show $P, Q, K$ are collinear. Let $\omega_A, \omega_I, \omega_K, \omega_P$ be the circles defined previously. Let $S$ be the internal homothetic center of $\omega_A$ and $\omega_P$, and $S'$ be the internal homothetic center of $\omega_I$ and $\omega_K$. Using the formula for the product of inradius and exradius in a triangle, we find $r_I r_P = BH \cdot CH = r_K r_A$, which implies $S=S'$. Consider circles $\omega_A, \omega_I, \omega_K$. Their centers of homothety $Q$ (internal for $\omega_A, \omega_I$), $S'$ (internal for $\omega_I, \omega_K$), and $K$ (external for $\omega_A, \omega_K$) are collinear by Monge's Theorem. Now consider circles $\omega_A, \omega_I, \omega_P$. Their centers of homothety $Q$ (internal for $\omega_A, \omega_I$), $S$ (internal for $\omega_A, \omega_P$), and $P$ (external for $\omega_I, \omega_P$) are also collinear. Since $S=S'$, the points $P, Q, K$ all lie on the same line. Thus, line $PQ$ always passes through the fixed point $K$."
2022g7,"Let $A B C$ and $A^{\prime} B^{\prime} C^{\prime}$ be two triangles having the same circumcircle $\omega$, and the same orthocentre $H$. Let $\Omega$ be the circumcircle of the triangle determined by the lines $A A^{\prime}, B B^{\prime}$ and $C C^{\prime}$. Prove that $H$, the centre of $\omega$, and the centre of $\Omega$ are collinear.","In what follows, $\Varangle(p, q)$ will denote the directed angle between lines $p$ and $q$, taken modulo $180^{\circ}$. Denote by $O$ the centre of $\omega$. In any triangle, the homothety with ratio $-\frac{1}{2}$ centred at the centroid of the triangle takes the vertices to the midpoints of the opposite sides and it takes the orthocentre to the circumcentre. Therefore the triangles $A B C$ and $A^{\prime} B^{\prime} C^{\prime}$ share the same centroid $G$ and the midpoints of their sides lie on a circle $\rho$ with centre on $O H$. We will prove that $\omega, \Omega$, and $\rho$ are coaxial, so in particular it follows that their centres are collinear on OH .

Let $D=B B^{\prime} \cap C C^{\prime}, E=C C^{\prime} \cap A A^{\prime}, F=A A^{\prime} \cap B B^{\prime}, S=B C^{\prime} \cap B^{\prime} C$, and $T=B C \cap B^{\prime} C^{\prime}$. Since $D, S$, and $T$ are the intersections of opposite sides and of the diagonals in the quadrilateral $B B^{\prime} C C^{\prime}$ inscribed in $\omega$, by Brocard's theorem triangle $D S T$ is self-polar with respect to $\omega$, i.e. each vertex is the pole of the opposite side. We apply this in two ways.\\

First, from $D$ being the pole of $S T$ it follows that the inverse $D^{*}$ of $D$ with respect to $\omega$ is the projection of $D$ onto $S T$. In particular, $D^{*}$ lies on the circle with diameter $S D$. If $N$ denotes the midpoint of $S D$ and $R$ the radius of $\omega$, then the power of $O$ with respect to this circle is $O N^{2}-N D^{2}=O D \cdot O D^{*}=R^{2}$. By rearranging, we see that $N D^{2}$ is the power of $N$ with respect to $\omega$.

Second, from $T$ being the pole of $S D$ it follows that $O T$ is perpendicular to $S D$. Let $M$ and $M^{\prime}$ denote the midpoints of $B C$ and $B^{\prime} C^{\prime}$. Then since $O M \perp B C$ and $O M^{\prime} \perp B^{\prime} C^{\prime}$ it follows that $O M M^{\prime} T$ is cyclic and

$$
\Varangle(S D, B C)=\Varangle(O T, O M)=\Varangle\left(B^{\prime} C^{\prime}, M M^{\prime}\right) .
$$

From $B B^{\prime} C C^{\prime}$ being cyclic we also have $\Varangle\left(B C, B B^{\prime}\right)=\Varangle\left(C C^{\prime}, B^{\prime} C^{\prime}\right)$, hence we obtain

$$
\begin{aligned}
\Varangle\left(S D, B B^{\prime}\right) & =\Varangle(S D, B C)+\Varangle\left(B C, B B^{\prime}\right) \\
& =\Varangle\left(B^{\prime} C^{\prime}, M M^{\prime}\right)+\Varangle\left(C C^{\prime}, B^{\prime} C^{\prime}\right)=\Varangle\left(C C^{\prime}, M M^{\prime}\right) .
\end{aligned}
$$

Now from the homothety mentioned in the beginning, we know that $M M^{\prime}$ is parallel to $A A^{\prime}$, hence the above implies that $\Varangle\left(S D, B B^{\prime}\right)=\Varangle\left(C C^{\prime}, A A^{\prime}\right)$, which shows that $\Omega$ is tangent to $S D$ at $D$. In particular, $N D^{2}$ is also the power of $N$ with respect to $\Omega$.

Additionally, from $B B^{\prime} C C^{\prime}$ being cyclic it follows that triangles $D B C$ and $D C^{\prime} B^{\prime}$ are inversely similar, so $\Varangle\left(B B^{\prime}, D M^{\prime}\right)=\Varangle\left(D M, C C^{\prime}\right)$. This yields

$$
\begin{aligned}
\Varangle\left(S D, D M^{\prime}\right) & =\Varangle\left(S D, B B^{\prime}\right)+\Varangle\left(B B^{\prime}, D M^{\prime}\right) \\
& =\Varangle\left(C C^{\prime}, M M^{\prime}\right)+\Varangle\left(D M, C C^{\prime}\right)=\Varangle\left(D M, M M^{\prime}\right),
\end{aligned}
$$

which shows that the circle $D M M^{\prime}$ is also tangent to $S D$. Since $N, M$, and $M^{\prime}$ are collinear on the Newton-Gauss line of the complete quadrilateral determined by the lines $B B^{\prime}, C C^{\prime}, B C^{\prime}$, and $B^{\prime} C$, it follows that $N D^{2}=N M \cdot N M^{\prime}$. Hence $N$ has the same power with respect to $\omega$, $\Omega$, and $\rho$.

By the same arguments there exist points on the tangents to $\Omega$ at $E$ and $F$ which have the same power with respect to $\omega, \Omega$, and $\rho$. The tangents to a given circle at three distinct points cannot be concurrent, hence we obtain at least two distinct points with the same power with respect to $\omega, \Omega$, and $\rho$. Hence the three circles are coaxial, as desired.",4,"Let triangles $A B C$ and $A^{\prime} B^{\prime} C^{\prime}$ share the same circumcircle $\\omega$ (center $O$) and orthocenter $H$. Show that they also share the same centroid $G$, and that the midpoints of their sides lie on a common circle $\rho$, whose center is on the line $OH$.","In any triangle, the homothety centered at its centroid $G$ with ratio $-1/2$ maps the orthocenter $H$ to the circumcenter $O$. Since both triangles share $H$ and $O$, they must also share the same centroid $G$. This same homothety maps the vertices of a triangle to the midpoints of the opposite sides. Therefore, the midpoints of the sides of both $ABC$ and $A'B'C'$ lie on a common circle $\rho$ (the common nine-point circle). The center of the nine-point circle is the midpoint of the segment $OH$, and thus lies on the line $OH$.","Let $D = BB' \\cap CC'$, $S = BC' \\cap B'C$, and $N$ be the midpoint of $SD$. Show that $N$ has the same power with respect to the circumcircle $\\omega$ and the circle $\\Omega$ (the circumcircle of the triangle formed by lines $AA', BB', CC'$).","Consider the quadrilateral $BB'CC'$ inscribed in $\\omega$. By Brocard's theorem, its diagonal triangle $DST$ (where $T=BC \\cap B'C'$) is self-polar with respect to $\\omega$. This implies that the power of $N$ with respect to $\\omega$ is $ND^2$. By a directed angle chase, using the fact that the line connecting midpoints $M(BC)$ and $M'(B'C')$ is parallel to $AA'$, we can show $\\Varangle(SD, BB') = \\Varangle(CC', AA')$. This is the condition for the line $SD$ to be tangent to circle $\\Omega$ at vertex $D$. Consequently, the power of point $N$ (which lies on $SD$) with respect to $\\Omega$ is also $ND^2$.","Show that the three circles $\\omega$, $\\Omega$, and $\rho$ (the common nine-point circle from sub-problem 1) are coaxial.","Let $N$ be the point from sub-problem 2, and let $M, M'$ be the midpoints of $BC, B'C'$. The points $N, M, M'$ are collinear on the Newton-Gauss line of a related complete quadrilateral. An angle chase shows that the circle passing through $D, M, M'$ is tangent to line $SD$ at $D$. The power of $N$ with respect to this circle is both $ND^2$ (from tangency) and $NM \\cdot NM'$. Since $M, M'$ lie on $\rho$, the power of $N$ with respect to $\rho$ is $NM \\cdot NM' = ND^2$. From sub-problem 2, $N$ has the same power with respect to $\\omega$ and $\\Omega$. Thus, $N$ lies on the radical axis of all three circles. By symmetry, we can construct at least two such distinct points, which proves that the three circles are coaxial.","Let $A B C$ and $A^{\\prime} B^{\\prime} C^{\\prime}$ be two triangles having the same circumcircle $\\omega$, and the same orthocentre $H$. Let $\\Omega$ be the circumcircle of the triangle determined by the lines $A A^{\\prime}, B B^{\\prime}$ and $C C^{\\prime}$. Prove that $H$, the centre of $\\omega$, and the centre of $\\Omega$ are collinear.","From the previous sub-problem, the circles $\\omega$, $\\Omega$, and $\rho$ are coaxial. The centers of coaxial circles are collinear. The center of $\\omega$ is $O$. From the first sub-problem, the center of the common nine-point circle $\rho$ lies on the Euler line $OH$. Therefore, the center of $\\Omega$ must also lie on the line defined by the centers of $\\omega$ and $\rho$, which is the line $OH$. Thus, $H$, $O$ (the center of $\\omega$), and the center of $\\Omega$ are collinear."
2022g8,"Let $A A^{\prime} B C C^{\prime} B^{\prime}$ be a convex cyclic hexagon such that $A C$ is tangent to the incircle of the triangle $A^{\prime} B^{\prime} C^{\prime}$, and $A^{\prime} C^{\prime}$ is tangent to the incircle of the triangle $A B C$. Let the lines $A B$ and $A^{\prime} B^{\prime}$ meet at $X$ and let the lines $B C$ and $B^{\prime} C^{\prime}$ meet at $Y$.

Prove that if $X B Y B^{\prime}$ is a convex quadrilateral, then it has an incircle.","Solution. Denote by $\omega$ and $\omega^{\prime}$ the incircles of $\triangle A B C$ and $\triangle A^{\prime} B^{\prime} C^{\prime}$ and let $I$ and $I^{\prime}$ be the centres of these circles. Let $N$ and $N^{\prime}$ be the second intersections of $B I$ and $B^{\prime} I^{\prime}$ with $\Omega$, the circumcircle of $A^{\prime} B C C^{\prime} B^{\prime} A$, and let $O$ be the centre of $\Omega$. Note that $O N \perp A C, O N^{\prime} \perp A^{\prime} C^{\prime}$ and $O N=O N^{\prime}$ so $N N^{\prime}$ is parallel to the angle bisector $I I^{\prime}$ of $A C$ and $A^{\prime} C^{\prime}$. Thus $I I^{\prime} \| N N^{\prime}$ which is antiparallel to $B B^{\prime}$ with respect to $B I$ and $B^{\prime} I^{\prime}$. Therefore $B, I, I^{\prime}, B^{\prime}$ are concyclic.

Further define $P$ as the intersection of $A C$ and $A^{\prime} C^{\prime}$ and $M$ as the antipode of $N^{\prime}$ in $\Omega$. Consider the circle $\Gamma_{1}$ with centre $N$ and radius $N A=N C$ and the circle $\Gamma_{2}$ with centre $M$ and radius $M A^{\prime}=M C^{\prime}$. Their radical axis passes through $P$ and is perpendicular to $M N \perp N N^{\prime} \| I P$, so $I$ lies on their radical axis. Therefore, since $I$ lies on $\Gamma_{1}$, it must also lie on $\Gamma_{2}$. Thus, if we define $Z$ as the second intersection of $M I$ with $\Omega$, we have that $I$ is the incentre of triangle $Z A^{\prime} C^{\prime}$. (Note that the point $Z$ can also be constructed directly via Poncelet's porism.)

Consider the incircle $\omega_{c}$ with centre $I_{c}$ of triangle $C^{\prime} B^{\prime} Z$. Note that $\angle Z I C^{\prime}=90^{\circ}+$ $\frac{1}{2} \angle Z A^{\prime} C^{\prime}=90^{\circ}+\frac{1}{2} \angle Z B^{\prime} C^{\prime}=\angle Z I_{c} C^{\prime}$, so $Z, I, I_{c}, C^{\prime}$ are concyclic. Similarly $B^{\prime}, I^{\prime}, I_{c}, C^{\prime}$ are concyclic.

The external centre of dilation from $\omega$ to $\omega_{c}$ is the intersection of $I I_{c}$ and $C^{\prime} Z(D$ in the picture), that is the radical centre of circles $\Omega, C^{\prime} I_{c} I Z$ and $I I^{\prime} I_{c}$. Similarly, the external centre of dilation from $\omega^{\prime}$ to $\omega_{c}$ is the intersection of $I^{\prime} I_{c}$ and $B^{\prime} C^{\prime}$ ( $D^{\prime}$ in the picture), that is the radical centre of circles $\Omega, B^{\prime} I^{\prime} I_{c} C^{\prime}$ and $I I^{\prime} I_{c}$. Therefore the Monge line of $\omega, \omega^{\prime}$ and $\omega_{c}$ is line $D D^{\prime}$, and the radical axis of $\Omega$ and circle $I I^{\prime} I_{c}$ coincide. Hence the external centre $T$ of dilation from $\omega$ to $\omega^{\prime}$ is also on the radical axis of $\Omega$ and circle $I I^{\prime} I_{c}$.\\

Now since $B, I, I^{\prime}, B^{\prime}$ are concyclic, the intersection $T^{\prime}$ of $B B^{\prime}$ and $I I^{\prime}$ is on the radical axis of $\Omega$ and circle $I I^{\prime} I_{c}$. Thus $T^{\prime}=T$ and $T$ lies on line $B B^{\prime}$. Finally, construct a circle $\Omega_{0}$ tangent to $A^{\prime} B^{\prime}, B^{\prime} C^{\prime}, A B$ on the same side of these lines as $\omega^{\prime}$. The centre of dilation from $\omega^{\prime}$ to $\Omega_{0}$ is $B^{\prime}$, so by Monge's theorem the external centre of dilation from $\Omega_{0}$ to $\omega$ must be on the line $T B B^{\prime}$. However, it is on line $A B$, so it must be $B$ and $B C$ must be tangent to $\Omega_{0}$ as desired.\\",4,"Let $I$ and $I'$ be the incenters of $\triangle ABC$ and $\triangle A'B'C'$ respectively. Given the tangency conditions that $AC$ is tangent to the incircle of $\triangle A'B'C'$ and $A'C'$ is tangent to the incircle of $\triangle ABC$, prove that the four points $B, I, I', B'$ are concyclic.","Let $\Omega$ be the circumcircle of the hexagon. Let $N$ and $N'$ be the second intersections of the angle bisectors $BI$ and $B'I'$ with $\Omega$. A known theorem for this configuration states that the given tangency conditions imply that the line of centers $II'$ is parallel to the chord $NN'$. In the cyclic quadrilateral $BNN'B'$, the chords $BB'$ and $NN'$ are antiparallel with respect to the chords $BN$ and $B'N'$. Since $I \in BN$, $I' \in B'N'$, and $II' \parallel NN'$, the line segment $II'$ is also antiparallel to $BB'$ with respect to the lines $BI$ and $B'I'$. This is a condition for the points $B, I, I', B'$ to be concyclic.","Let $\Psi$ be the circle passing through $B, I, I', B'$. Let $T$ be the external center of homothety of the incircles $\omega$ (of $\triangle ABC$) and $\omega'$ (of $\triangle A'B'C'$). Prove that $T$ lies on the radical axis of the circumcircle $\Omega$ and the circle $\Psi$.","This result is established using Monge's theorem on three circles: $\omega$, $\omega'$, and an auxiliary incircle $\omega_c$ of a carefully chosen triangle. The three external centers of homothety of these circles are collinear. The line containing them (the Monge line) can be shown to be a radical axis for a set of circles related to the configuration. Through a series of radical axes arguments, it can be concluded that $T$, the center of homothety of $\omega$ and $\omega'$, must lie on the radical axis of $\Omega$ and $\Psi$.",Let $T$ be the external center of homothety of the incircles $\omega$ and $\omega'$. Prove that $T$ lies on the line $BB' સીધી રેખા પર છે.,"By definition, $T$ lies on the line of centers $II'$. From the previous sub-problem, $T$ lies on the radical axis of $\Omega$ and the circle $\Psi$ through $B, I, I', B'$. Let $T' = BB' \cap II'$. The power of $T'$ with respect to $\Omega$ is $T'B \cdot T'B'$. Since $B, I, I', B'$ are concyclic (from Sub-problem 1), the power of $T'$ with respect to $\Psi$ is $T'I \cdot T'I' = T'B \cdot T'B'$. Thus, $T'$ also lies on the radical axis of $\Omega$ and $\Psi$. Since both $T$ and $T'$ lie on two distinct lines ($II'$ and the radical axis), they must coincide. Therefore, $T = T'$, which implies $T$ lies on the line $BB'$.","Let $A A^{\prime} B C C^{\prime} B^{\prime}$ be a convex cyclic hexagon such that $A C$ is tangent to the incircle of the triangle $A^{\prime} B^{\prime} C^{\prime}$, and $A^{\prime} C^{\prime}$ is tangent to the incircle of the triangle $A B C$. Let the lines $A B$ and $A^{\prime} B^{\prime}$ meet at $X$ and let the lines $B C$ and $B^{\prime} C^{\prime}$ meet at $Y$. Prove that if $X B Y B^{\prime}$ is a convex quadrilateral, then it has an incircle.","Let $\Omega_0$ be a circle tangent to lines $A'B'$, $B'C'$, and $AB$. By Monge's theorem applied to circles $\omega, \omega'$, and $\Omega_0$, their three external centers of homothety are collinear. The center for $\omega'$ and $\Omega_0$ is $B'$. The center for $\omega$ and $\omega'$ is $T$. Let the center for $\omega$ and $\Omega_0$ be $S$. Then $S$ must lie on the line $TB'$. From the previous sub-problem, $T$ lies on line $BB'$, so the line $TB'$ is the same as the line $BB'$. Thus, $S$ lies on line $BB'$. By definition, $S$ also lies on a common tangent, line $AB$. Therefore, $S = AB \cap BB' = B$. Since $B$ is the center of homothety for $\omega$ and $\Omega_0$, and the line $BC$ is tangent to $\omega$, it must also be tangent to $\Omega_0$. Thus, $\Omega_0$ is tangent to all four sides ($AB, BC, B'C', A'B'$) of the quadrilateral $XBYB'$, which means the quadrilateral has an incircle."
2022n5,"For each $1 \leqslant i \leqslant 9$ and $T \in \mathbb{N}$, define $d_{i}(T)$ to be the total number of times the digit $i$ appears when all the multiples of 1829 between 1 and $T$ inclusive are written out in base 10.

Show that there are infinitely many $T \in \mathbb{N}$ such that there are precisely two distinct values among $d_{1}(T), d_{2}(T), \ldots, d_{9}(T)$.","Solution. Let $n:=1829$. First, we choose some $k$ such that $n \mid 10^{k}-1$. For instance, any multiple of $\varphi(n)$ would work since $n$ is coprime to 10 . We will show that either $T=10^{k}-1$ or $T=10^{k}-2$ has the desired property, which completes the proof since $k$ can be taken to be arbitrary large.

For this it suffices to show that $\#\left\{d_{i}\left(10^{k}-1\right): 1 \leqslant i \leqslant 9\right\} \leqslant 2$. Indeed, if

$$
\#\left\{d_{i}\left(10^{k}-1\right): 1 \leqslant i \leqslant 9\right\}=1
$$

then, since $10^{k}-1$ which consists of all nines is a multiple of $n$, we have

$$
d_{i}\left(10^{k}-2\right)=d_{i}\left(10^{k}-1\right) \text { for } i \in\{1, \ldots, 8\} \text {, and } d_{9}\left(10^{k}-2\right)<d_{9}\left(10^{k}-1\right)
$$

This means that $\#\left\{d_{i}\left(10^{k}-2\right): 1 \leqslant i \leqslant 9\right\}=2$.\\
To prove that $\#\left\{d_{i}\left(10^{k}-1\right)\right\} \leqslant 2$ we need an observation. Let $\overline{a_{k-1} a_{k-2} \ldots a_{0}} \in\left\{1, \ldots, 10^{k}-1\right\}$ be the decimal expansion of an arbitrary number, possibly with leading zeroes. Then $\overline{a_{k-1} a_{k-2} \ldots a_{0}}$ is divisible by $n$ if and only if $\overline{a_{k-2} \ldots a_{0} a_{k-1}}$ is divisible by $n$. Indeed, this follows from the fact that

$$
10 \cdot \overline{a_{k-1} a_{k-2} \ldots a_{0}}-\overline{a_{k-2} \ldots a_{0} a_{k-1}}=\left(10^{k}-1\right) \cdot a_{k-1}
$$

is divisible by $n$.\\
This observation shows that the set of multiples of $n$ between 1 and $10^{k}-1$ is invariant under simultaneous cyclic permutation of digits when numbers are written with leading zeroes. Hence, for each $i \in\{1, \ldots, 9\}$ the number $d_{i}\left(10^{k}-1\right)$ is $k$ times larger than the number of $k$ digit numbers which start from the digit $i$ and are divisible by $n$. Since the latter number is either $\left\lfloor 10^{k-1} / n\right\rfloor$ or $1+\left\lfloor 10^{k-1} / n\right\rfloor$, we conclude that $\#\left\{d_{i}\left(10^{k}-1\right)\right\} \leqslant 2$.

Comment. More careful analysis shows that $\#\left\{d_{i}\left(10^{k}-1\right): 1 \leqslant i \leqslant 9\right\}=1$ if and only if $n \equiv 1$ $(\bmod 10)$, which is not the case for $n=1829$.",3,"Let $n=1829$ and let $k$ be a positive integer such that $n$ divides $10^k-1$. For any integer $N$ with $k$ digits (possibly with leading zeros), $N = \\overline{a_{k-1} a_{k-2} \\ldots a_0}$, let $N'$ be the integer obtained by a cyclic shift of the digits of $N$, $N' = \\overline{a_{k-2} a_{k-3} \\ldots a_0 a_{k-1}}$. Show that $N$ is divisible by $n$ if and only if $N'$ is divisible by $n$.","We can express the relationship between $N$ and $N'$ as $10N = 10^k a_{k-1} + N' - a_{k-1}$. Rearranging this gives $10N - N' = (10^k-1)a_{k-1}$. Since we are given that $n$ divides $10^k-1$, it follows that $10N - N'$ is a multiple of $n$, which means $10N \\equiv N' \\pmod{n}$. As $n=1829$ is not divisible by 2 or 5, $\\gcd(10, n)=1$. Therefore, $N$ is divisible by $n$ if and only if $10N$ is divisible by $n$, which is true if and only if $N'$ is divisible by $n$.","Let $n=1829$ and let $k$ be an integer such that $n | (10^k-1)$. For $1 \\le i \\le 9$, let $d_i(T)$ be the count of digit $i$ in the decimal representations of all multiples of $n$ between 1 and $T$. Show that there are at most two distinct values among $d_1(10^k-1), d_2(10^k-1), \\ldots, d_9(10^k-1)$.","From Sub-problem 1, the set of multiples of $n$ in $\{1, \\ldots, 10^k-1\}$, when written as $k$-digit numbers with leading zeros, is closed under cyclic permutation of digits. This symmetry implies that the total count of any digit $i$ is distributed evenly across all $k$ digit positions. Thus, the total number of times a digit $i$ appears, $d_i(10^k-1)$, is $k$ times the number of multiples of $n$ in $\{1, \\ldots, 10^k-1\}$ that start with the digit $i$. For $i \\in \\{1, \\ldots, 9\\}$, the numbers starting with digit $i$ form an interval of length $10^{k-1}$. The number of multiples of $n$ in any interval of length $L$ is either $\\lfloor L/n \rfloor$ or $\\lceil L/n \rceil = \\lfloor L/n \rfloor+1$. Thus, the number of multiples starting with digit $i$ can only take two possible values. Consequently, $d_i(10^k-1)$ can take at most two distinct values.","For each $1 \\leqslant i \\leqslant 9$ and $T \\in \\mathbb{N}$, define $d_{i}(T)$ to be the total number of times the digit $i$ appears when all the multiples of 1829 between 1 and $T$ inclusive are written out in base 10. Show that there are infinitely many $T \\in \\mathbb{N}$ such that there are precisely two distinct values among $d_{1}(T), d_{2}(T), \\ldots, d_{9}(T)$.","Let $n=1829$. Since $\\gcd(n, 10)=1$, by Euler's totient theorem, there are infinitely many integers $k$ such that $n | (10^k-1)$. For each such $k$, let $T_k=10^k-1$. By Sub-problem 2, the set of counts $\{d_i(T_k)\\}_{i=1}^9$ has at most two distinct values. If it has exactly two, we have found a suitable $T$. If it has only one value, all $d_i(T_k)$ are equal. In this case, consider $T'_k = 10^k-2$. Since $n|(10^k-1)$, $10^k-1$ (a string of $k$ nines) is a multiple of $n$. The list of multiples for $T'_k$ is the list for $T_k$ minus the number $10^k-1$. Thus, for $i \\in \\{1, \\dots, 8\\}$, $d_i(T'_k)=d_i(T_k)$, but $d_9(T'_k) < d_9(T_k)$. Since all $d_i(T_k)$ were equal, for $T'_k$ we have $d_1(T'_k)=\\dots=d_8(T'_k)$ while $d_9(T'_k)$ is a different, smaller value. This gives exactly two distinct values. Since there are infinitely many choices for $k$, we can generate infinitely many such values of $T$ (either $10^k-1$ or $10^k-2$).",,
2022n6,"Let $Q$ be a set of prime numbers, not necessarily finite. For a positive integer $n$ consider its prime factorisation; define $p(n)$ to be the sum of all the exponents and $q(n)$ to be the sum of the exponents corresponding only to primes in $Q$. A positive integer $n$ is called special if $p(n)+p(n+1)$ and $q(n)+q(n+1)$ are both even integers. Prove that there is a constant $c>0$ independent of the set $Q$ such that for any positive integer $N>100$, the number of special integers in $[1, N]$ is at least $c N$.\\
(For example, if $Q=\{3,7\}$, then $p(42)=3, q(42)=2, p(63)=3, q(63)=3, p(2022)=3$, $q(2022)=1$.)","Solution. Let us call two positive integers $m, n$ friends if $p(m)+p(n)$ and $q(m)+q(n)$ are both even integers. We start by noting that the pairs $(p(k), q(k))$ modulo 2 can take at most 4 different values; thus, among any five different positive integers there are two which are friends.

In addition, both functions $p$ and $q$ satisfy $f(a b)=f(a)+f(b)$ for any $a, b$. Therefore, if $m$ and $n$ are divisible by $d$, then both $p$ and $q$ satisfy the equality $f(m)+f(n)=f(m / d)+$ $f(n / d)+2 f(d)$. This implies that $m, n$ are friends if and only if $m / d, n / d$ are friends.

Let us call a set of integers $\left\{n_{1}, n_{2}, \ldots, n_{5}\right\}$ an interesting set if for any indexes $i, j$, the difference $d_{i j}=\left|n_{i}-n_{j}\right|$ divides both $n_{i}$ and $n_{j}$. We claim that if elements of an interesting set are all positive, then we can obtain a special integer. Indeed, if we were able to construct such a set, then there would be a pair of integers $\left\{n_{i}, n_{j}\right\}$ which are friends, according to the first observation. Additionally, the second observation yields that the quotients $n_{i} / d_{i j}, n_{j} / d_{i j}$ form a pair of friends, which happen to be consecutive integers, thus giving a special integer as desired.

In order to construct a family of interesting sets, we can start by observing that the set $\{0,6,8,9,12\}$ is an interesting set. Using that $72=2^{3} \cdot 3^{2}$ is the least common multiple of all pairwise differences in this set, we obtain a family of interesting sets by considering

$$
\{72 k, 72 k+6,72 k+8,72 k+9,72 k+12\}
$$

for any $k \geqslant 1$. If we consider the quotients (of these numbers by the appropriate differences), then we obtain that the set

$$
S_{k}=\{6 k, 8 k, 9 k, 12 k, 12 k+1,18 k+2,24 k+2,24 k+3,36 k+3,72 k+8\}
$$

has at least one special integer. In particular, the interval $[1,100 k]$ contains the sets $S_{1}, S_{2}, \ldots, S_{k}$, each of which has a special number. Any special number can be contained in at most ten sets $S_{k}$, from where we conclude that the number of special integers in $[1,100 k]$ is at least $k / 10$.

Finally, let $N=100 k+r$, with $k \geqslant 1$ and $0 \leqslant r<100$, so that we have $N<100(k+1) \leqslant$ $200 k$. Then the number of special integers in $[1, N]$ is at least $k / 10>N / 2000$, as we wanted to prove.

Comment 1. The statement is also true for $N \geqslant 15$ as at least one of the numbers $7,14,15$ is special.\\
Comment 2. Another approach would be to note that if $p(2 n), p(2 n+1), p(2 n+2)$ all have the same parity then one of the numbers $n, 2 n, 2 n+1$ is special. Indeed, if $q(n)+q(n+1)$ is even then $n$ is special since $p(n)+p(n+1) \equiv p(2 n)+p(2 n+2) \equiv 0(\bmod 2)$. Otherwise, if $q(n)+q(n+1)$ is odd, so is $q(2 n)+q(2 n+2)$ which implies that exactly one of the numbers $2 n, 2 n+1$ is special.

Unfortunately, it seems hard to show that the set of such $n$ has positive density: see a recent paper \href{https://arxiv.org/abs/1509.01545}{https://arxiv.org/abs/1509.01545} for the proof that all eight patterns of the parities of $p(n), p(n+1), p(n+2)$ appear for a positive proportion of positive integers.",1,"Let $Q$ be a set of prime numbers, not necessarily finite. For a positive integer $n$ consider its prime factorisation; define $p(n)$ to be the sum of all the exponents and $q(n)$ to be the sum of the exponents corresponding only to primes in $Q$. A positive integer $n$ is called special if $p(n)+p(n+1)$ and $q(n)+q(n+1)$ are both even integers. Prove that there is a constant $c>0$ independent of the set $Q$ such that for any positive integer $N>100$, the number of special integers in $[1, N]$ is at least $c N$.\\
(For example, if $Q=\{3,7\}$, then $p(42)=3, q(42)=2, p(63)=3, q(63)=3, p(2022)=3$, $q(2022)=1$.)","Solution. Let us call two positive integers $m, n$ friends if $p(m)+p(n)$ and $q(m)+q(n)$ are both even integers. We start by noting that the pairs $(p(k), q(k))$ modulo 2 can take at most 4 different values; thus, among any five different positive integers there are two which are friends.

In addition, both functions $p$ and $q$ satisfy $f(a b)=f(a)+f(b)$ for any $a, b$. Therefore, if $m$ and $n$ are divisible by $d$, then both $p$ and $q$ satisfy the equality $f(m)+f(n)=f(m / d)+$ $f(n / d)+2 f(d)$. This implies that $m, n$ are friends if and only if $m / d, n / d$ are friends.

Let us call a set of integers $\left\{n_{1}, n_{2}, \ldots, n_{5}\right\}$ an interesting set if for any indexes $i, j$, the difference $d_{i j}=\left|n_{i}-n_{j}\right|$ divides both $n_{i}$ and $n_{j}$. We claim that if elements of an interesting set are all positive, then we can obtain a special integer. Indeed, if we were able to construct such a set, then there would be a pair of integers $\left\{n_{i}, n_{j}\right\}$ which are friends, according to the first observation. Additionally, the second observation yields that the quotients $n_{i} / d_{i j}, n_{j} / d_{i j}$ form a pair of friends, which happen to be consecutive integers, thus giving a special integer as desired.

In order to construct a family of interesting sets, we can start by observing that the set $\{0,6,8,9,12\}$ is an interesting set. Using that $72=2^{3} \cdot 3^{2}$ is the least common multiple of all pairwise differences in this set, we obtain a family of interesting sets by considering

$$
\{72 k, 72 k+6,72 k+8,72 k+9,72 k+12\}
$$

for any $k \geqslant 1$. If we consider the quotients (of these numbers by the appropriate differences), then we obtain that the set

$$
S_{k}=\{6 k, 8 k, 9 k, 12 k, 12 k+1,18 k+2,24 k+2,24 k+3,36 k+3,72 k+8\}
$$

has at least one special integer. In particular, the interval $[1,100 k]$ contains the sets $S_{1}, S_{2}, \ldots, S_{k}$, each of which has a special number. Any special number can be contained in at most ten sets $S_{k}$, from where we conclude that the number of special integers in $[1,100 k]$ is at least $k / 10$.

Finally, let $N=100 k+r$, with $k \geqslant 1$ and $0 \leqslant r<100$, so that we have $N<100(k+1) \leqslant$ $200 k$. Then the number of special integers in $[1, N]$ is at least $k / 10>N / 2000$, as we wanted to prove.

Comment 1. The statement is also true for $N \geqslant 15$ as at least one of the numbers $7,14,15$ is special.\\
Comment 2. Another approach would be to note that if $p(2 n), p(2 n+1), p(2 n+2)$ all have the same parity then one of the numbers $n, 2 n, 2 n+1$ is special. Indeed, if $q(n)+q(n+1)$ is even then $n$ is special since $p(n)+p(n+1) \equiv p(2 n)+p(2 n+2) \equiv 0(\bmod 2)$. Otherwise, if $q(n)+q(n+1)$ is odd, so is $q(2 n)+q(2 n+2)$ which implies that exactly one of the numbers $2 n, 2 n+1$ is special.

Unfortunately, it seems hard to show that the set of such $n$ has positive density: see a recent paper \href{https://arxiv.org/abs/1509.01545}{https://arxiv.org/abs/1509.01545} for the proof that all eight patterns of the parities of $p(n), p(n+1), p(n+2)$ appear for a positive proportion of positive integers.",,,,,,
2022n7,Let $k$ be a positive integer and let $S$ be a finite set of odd prime numbers. Prove that there is at most one way (modulo rotation and reflection) to place the elements of $S$ around a circle such that the product of any two neighbors is of the form $x^{2}+x+k$ for some positive integer $x$.,"Solution. Let us allow the value $x=0$ as well; we prove the same statement under this more general constraint. Obviously that implies the statement with the original conditions.

Call a pair $\{p, q\}$ of primes with $p \neq q$ special if $p q=x^{2}+x+k$ for some nonnegative integer $x$. The following claim is the key mechanism of the problem:\\
Claim.\\
(a) For every prime $r$, there are at most two primes less than $r$ forming a special pair with $r$.\\
(b) If such $p$ and $q$ exist, then $\{p, q\}$ is itself special.

We present two proofs of the claim.\\
Proof 1. We are interested in integers $1 \leqslant x<r$ satsfying


\begin{equation*}
x^{2}+x+k \equiv 0 \quad(\bmod r) \tag{1}
\end{equation*}


Since there are at most two residues modulo $r$ that can satisfy that quadratic congruence, there are at most two possible values of $x$. That proves (a).

Now suppose there are primes $p, q$ with $p<q<r$ and nonnegative integers $x, y$ such that

$$
\begin{aligned}
& x^{2}+x+k=p r \\
& y^{2}+y+k=q r .
\end{aligned}
$$

From $p<q<r$ we can see that $0 \leqslant x<y \leqslant r-1$. The numbers $x, y$ are the two solutions of (1); by Vieta's formulas, we should have $x+y \equiv-1(\bmod r)$, so $x+y=r-1$.

Letting $K=4 k-1, X=2 x+1$, and $Y=2 y+1$, we obtain

$$
\begin{gathered}
4 p r=X^{2}+K \\
4 q r=Y^{2}+K
\end{gathered}
$$

with $X+Y=2 r$. Multiplying the two above equations,

$$
\begin{aligned}
16 p q r^{2} & =\left(X^{2}+K\right)\left(Y^{2}+K\right) \\
& =(X Y-K)^{2}+K(X+Y)^{2} \\
& =(X Y-K)^{2}+4 K r^{2} \\
4 p q & =\left(\frac{X Y-K}{2 r}\right)^{2}+K .
\end{aligned}
$$

In particular, the number $Z=\frac{X Y-K}{2 r}$ should be an integer, and so $4 p q=Z^{2}+K$. By parity, $Z$ is odd, and thus

$$
p q=z^{2}+z+k \quad \text { where } z=\frac{Z-1}{2}
$$

so $\{p, q\}$ is special.

Proof 2. As before, we suppose that

$$
\begin{aligned}
& x^{2}+x+k=p r \\
& y^{2}+y+k=q r .
\end{aligned}
$$

Subtracting, we have

$$
(x+y+1)(x-y)=r(p-q) .
$$

As before, we have $x+y=r-1$, so $x-y=p-q$, and

$$
\begin{aligned}
& x=\frac{1}{2}(r+p-q-1) \\
& y=\frac{1}{2}(r+q-p-1) .
\end{aligned}
$$

Then,

$$
\begin{aligned}
k=p r-x^{2}-x & =\frac{1}{4}\left(4 p r-(r+p-q-1)^{2}-2(r+p-q-1)\right) \\
& =\frac{1}{4}\left(4 p r-(r+p-q)^{2}+1\right) \\
& =\frac{1}{4}\left(2 p q+2 p r+2 q r-p^{2}-q^{2}-r^{2}+1\right),
\end{aligned}
$$

which is symmetric in $p, q, r$, so

$$
p q=z^{2}+z+k \quad \text { where } z=\frac{1}{2}(p+q-r-1),
$$

and $\{p, q\}$ is special.\\
Now we settle the problem by induction on $|S|$, with $|S| \leqslant 3$ clear.\\
Suppose we have proven it for $|S|=n$ and consider $|S|=n+1$. Let $r$ be the largest prime in $S$; the claim tells us that in any valid cycle of primes:

\begin{itemize}
  \item the neighbors of $r$ are uniquely determined, and
  \item removing $r$ from the cycle results in a smaller valid cycle.
\end{itemize}

It follows that there is at most one valid cycle, completing the inductive step.\\
Comment. The statement is not as inapplicable as it might seem. For example, for $k=41$, the following 385 primes form a valid cycle of primes:

\footnotetext{$53,4357,104173,65921,36383,99527,193789,2089123,1010357,2465263,319169,15559,3449,2647,1951,152297$, $542189,119773,91151,66431,222137,1336799,469069,45613,1047941,656291,355867,146669,874879,2213327$, 305119, 3336209, 1623467, 520963, 794201, 1124833, 28697, 15683, 42557, 6571, 39607, 1238833, 835421, 2653681, 5494387, 9357539, 511223, 1515317, 8868173, 114079681, 59334071, 22324807, 3051889, 5120939, 7722467, 266239, 693809 , 3931783 , 1322317, 100469, 13913, 74419, 23977, 1361, 62983, 935021, 512657, 1394849, 216259, 45827, 31393,100787 , 1193989, 600979, 209543, 357661, 545141, 19681, 10691, 28867, 165089, 2118023, 6271891, 12626693, 21182429,1100467 , 413089, 772867, 1244423, 1827757, 55889, 1558873, 5110711, 1024427, 601759, 290869, 91757, $951109,452033,136471,190031,4423,9239,15809,24133,115811,275911,34211,877,6653,88001,46261,317741$, 121523, 232439, 379009, 17827, 2699, 15937, 497729, 335539, 205223, 106781, 1394413, 4140947, 8346383, 43984757, 14010721, 21133961, 729451, 4997297, 1908223, 278051, 529747, 40213, 768107, 456821, 1325351, 225961, 1501921, $562763,75527,5519,9337,14153,499,1399,2753,14401,94583,245107,35171,397093,195907,2505623,34680911$, 18542791, 7415917, 144797293, 455529251, 86675291, 252704911, 43385123, 109207907, 204884269, 330414209, 14926789, 1300289, 486769, 2723989, 907757, 1458871, 65063, 4561, 124427, 81343, 252887, 2980139, 1496779, 3779057, 519193, 47381, 135283, 268267, 446333, 669481, 22541, 54167, 99439, 158357, 6823, 32497, 1390709, 998029, 670343, 5180017, 13936673, 2123491, 4391941, 407651, 209953, 77249, 867653, 427117, 141079, 9539, 227, $1439,18679,9749,25453,3697,42139,122327,712303,244261,20873,52051,589997,4310569,1711069,291563$, 3731527, 11045429, 129098443, 64620427, 162661963, 22233269, 37295047, 1936969, 5033449, 725537, 1353973, 6964457, 2176871, 97231, 7001, 11351, 55673, 16747, 169003, 1218571, 479957, 2779783, 949609, 4975787, 1577959, 2365007, 3310753, 79349, 23189, 107209, 688907, 252583, 30677, 523, 941, 25981, 205103, 85087, 1011233, 509659, 178259, 950479, 6262847, 2333693, 305497, 3199319, 9148267, 1527563, 466801, 17033, 9967, 323003, 4724099, 14278309, 2576557, 1075021, 6462593, 2266021, 63922471, 209814503, 42117791, 131659867, 270892249, 24845153, 12104557, 3896003, 219491, 135913, 406397, 72269, 191689, 2197697, 1091273, 2727311, 368227, 1911661, 601883, 892657, 28559, 4783, 60497, 31259, 80909, 457697, 153733, 11587, 1481, 26161, 15193, 7187, 2143, 21517, 10079, 207643, 1604381, 657661, 126227, 372313, 2176331, 748337, 64969, 844867, 2507291, 29317943, 14677801, 36952793, 69332267, 111816223, 5052241, 8479717, 441263, 3020431, 1152751, 13179611, 38280013, 6536771, 16319657, $91442699,30501409,49082027,72061511,2199433,167597,317963,23869,2927,3833,17327,110879,285517$, 40543, 4861, 21683, 50527, 565319, 277829, 687917, 3846023, 25542677, 174261149, 66370753, 9565711, 1280791, 91393, 6011, 7283, 31859, 8677, 10193, 43987, 11831, 13591, 127843, 358229, 58067, 15473, 65839, 17477, 74099, 19603, 82847, 21851, 61.
}",4,Let $r$ be an odd prime. A prime $p$ is a valid neighbor of $r$ if their product $pr$ is of the form $x^2+x+k$ for some integer $x \ge 0$. Prove that there are at most two primes $p < r$ that can be a valid neighbor of $r$.,"If $pr = x^2+x+k$, this implies the congruence $x^2+x+k \equiv 0 \\pmod{r}$. As a quadratic congruence modulo a prime $r$, it can have at most two solutions for $x$. Each solution for $x$ determines a unique value for $p = (x^2+x+k)/r$. Therefore, there are at most two primes $p < r$ that can be valid neighbors of $r$.","Let $r$ be an odd prime. If two distinct primes $p < r$ and $q < r$ are both valid neighbors of $r$, prove that $p$ and $q$ form a valid neighbor pair themselves, i.e., their product $pq$ is of the form $z^2+z+k$ for some integer $z \ge 0$.","Let $pr = x^2+x+k$ and $qr = y^2+y+k$. The values $x$ and $y$ are the two distinct solutions to $z^2+z+k \equiv 0 \\pmod{r}$. By Vieta's formulas, $x+y \equiv -1 \\pmod{r}$. Since $p,q < r$, we have $x,y < r$, so $x+y=r-1$. Subtracting the initial equations yields $(x-y)(x+y+1) = (p-q)r$. With $x+y+1=r$, we get $x-y=p-q$. Solving for $x$ and $y$ and substituting back into the equation for $k$ reveals a relationship symmetric in $p, q, r$, which implies $pq = z^2+z+k$ for $z=(p+q-r-1)/2$.","Consider a valid circular arrangement of primes from a set $S$. Let $r$ be the largest prime in $S$. Show that its neighbors $p$ and $q$ are uniquely determined, and that removing $r$ results in a valid circular arrangement for the set $S \\setminus \\{r\\}$ where $p$ and $q$ are now neighbors.","In any circular arrangement, $r$ must have exactly two neighbors. From Sub-problem 1, there are at most two primes in $S$ smaller than $r$ that can be its neighbors. Thus, the neighbors of $r$, say $p$ and $q$, must be these two specific primes and are uniquely determined. From Sub-problem 2, because $p$ and $q$ are both neighbors of $r$, their product $pq$ is of the form $z^2+z+k$. Therefore, removing $r$ from the circle and making $p$ and $q$ adjacent creates a valid smaller circular arrangement for the set $S \\setminus \\{r\\}$.",Let $k$ be a positive integer and let $S$ be a finite set of odd prime numbers. Prove that there is at most one way (modulo rotation and reflection) to place the elements of $S$ around a circle such that the product of any two neighbors is of the form $x^{2}+x+k$ for some positive integer $x$.,"We use induction on $|S|=n$. Base cases ($n \\le 3$) are trivial. Assume uniqueness holds for sets of size $n$. For a set $S$ of size $n+1$, let $r$ be its largest prime. From Sub-problem 3, in any valid arrangement of $S$, the neighbors of $r$ are a unique pair of primes \\{p, q\\}, and the set $S' = S \\setminus \\{r\\}$ must form a valid arrangement. By the induction hypothesis, there is at most one arrangement for $S'$. The position of $r$ is then fixed between $p$ and $q$. Thus, the arrangement for $S$ is also unique (up to rotation and reflection)."
2022n8,Prove that $5^{n}-3^{n}$ is not divisible by $2^{n}+65$ for any positive integer $n$.,"Let $n$ be a positive integer, and let $m=2^{n}+65$. For the sake of contradiction, suppose that $m \mid 5^{n}-3^{n}$, so $5^{n} \equiv 3^{n}(\bmod m)$.

Notice that if $n$ is even, then $3 \mid m$, but $3 \nmid 5^{n}-3^{n}$, contradiction. So, from now on we assume that $n$ is odd, $n=2 k+1$. Obviously $n=1$ is not possible, so $n \geqslant 3$. Notice that $m$ is coprime to 2,3 and 5 .

\section*{Let $m_{1}$ be the smallest positive multiple of $m$ that can be written in the form of either $\left|5 a^{2}-3 b^{2}\right|$ or $\left|a^{2}-15 b^{2}\right|$ with some integers $a$ and $b$.}
Note that $5^{n}-3^{n}=5\left(5^{k}\right)^{2}-3\left(3^{k}\right)^{2}$ is a multiple of $m$, so the set of such multiples is non-empty, and therefore $m_{1}$ is well-defined.\\
I. First we show that $m_{1} \leqslant 5 m$. Consider the numbers

$$
5^{k+1} x+3^{k+1} y, \quad 0 \leqslant x, y \leqslant \sqrt{m} .
$$

There are $\lfloor\sqrt{m}\rfloor+1>\sqrt{m}$ choices for $x$ and $y$, so there are more than $m$ possible pairs $(x, y)$. Hence, two of these sums are congruent modulo $m$ : $5^{k+1} x_{1}+3^{k+1} y_{1} \equiv 5^{k+1} x_{2}+3^{k+1} y_{2}(\bmod m)$.

Now choose $a=x_{1}-x_{2}$ and $b=y_{1}-y_{2}$; at least one of $a, b$ is nonzero, and

$$
5^{k+1} a+3^{k+1} b \equiv 0 \quad(\bmod m), \quad|a|,|b| \leqslant \sqrt{m} .
$$

From

$$
0 \equiv\left(5^{k+1} a\right)^{2}-\left(3^{k+1} b\right)^{2}=5^{n+1} a^{2}-3^{n+1} b^{2} \equiv 5 \cdot 3^{n} a^{2}-3^{n+1} b^{2}=3^{n}\left(5 a^{2}-3 b^{2}\right) \quad(\bmod m)
$$

we can see that $\left|5 a^{2}-3 b^{2}\right|$ is a multiple of $m$. Since at least one of $a$ and $b$ is nonzero, $5 a^{2} \neq 3 b^{2}$. Hence, by the choice of $a, b$, we have $0<\left|5 a^{2}-3 b^{2}\right| \leqslant \max \left(5 a^{2}, 3 b^{2}\right) \leqslant 5 m$. That shows that $m_{1} \leqslant 5 m$.\\
II. Next, we show that $m_{1}$ cannot be divisible by 2,3 and 5 . Since $m_{1}$ equals either $\left|5 a^{2}-3 b^{2}\right|$ or $\left|a^{2}-15 b^{2}\right|$ with some integers $a, b$, we have six cases to check. In all six cases, we will get a contradiction by presenting another multiple of $m$, smaller than $m_{1}$.

\begin{itemize}
  \item If $5 \mid m_{1}$ and $m_{1}=\left|5 a^{2}-3 b^{2}\right|$, then $5 \mid b$ and $\left|a^{2}-15\left(\frac{b}{5}\right)^{2}\right|=\frac{m_{1}}{5}<m_{1}$.
  \item If $5 \mid m_{1}$ and $m_{1}=\left|a^{2}-15 b^{2}\right|$, then $5 \mid a$ and $\left|5\left(\frac{a}{5}\right)^{2}-3 b^{2}\right|=\frac{m_{1}}{5}<m_{1}$.
  \item If $3 \mid m_{1}$ and $m_{1}=\left|5 a^{2}-3 b^{2}\right|$, then $3 \mid a$ and $\left|b^{2}-15\left(\frac{a}{3}\right)^{2}\right|=\frac{m_{1}}{3}<m_{1}$.
  \item If $3 \mid m_{1}$ and $m_{1}=\left|a^{2}-15 b^{2}\right|$, then $3 \mid a$ and $\left|5 b^{2}-3\left(\frac{a}{3}\right)^{2}\right|=\frac{m_{1}}{3}<m_{1}$.
  \item If $2 \mid m_{1}$ and $m_{1}=\left|5 a^{2}-3 b^{2}\right|$, then $\left|\left(\frac{5 a-3 b}{2}\right)^{2}-15\left(\frac{a-b}{2}\right)^{2}\right|=\frac{m_{1}}{2}<m_{1}$.
  \item If $2 \mid m_{1}$ and $m_{1}=\left|a^{2}-15 b^{2}\right|$, then $\left|5\left(\frac{a-3 b}{2}\right)^{2}-3\left(\frac{a-5 b}{2}\right)^{2}\right|=\frac{m_{1}}{2}<m_{1}$.\\
(The last two expressions can be obtained from $(\sqrt{5} a+\sqrt{3} b)(\sqrt{5}-\sqrt{3})=(5 a-3 b)+\sqrt{15}(b-a)$ and $(a+\sqrt{15} b)(\sqrt{5}-\sqrt{3})=\sqrt{5}(a-3 b)+\sqrt{3}(5 b-a)$.)
\end{itemize}

In all six cases, we found that either $\frac{m_{1}}{2}, \frac{m_{1}}{3}$ or $\frac{m_{1}}{5}$ is of the form $\left|5 x^{2}-3 y^{2}\right|$ or $\left|x^{2}-15 y^{2}\right|$. Since $m$ is coprime to 2,3 and 5 , the presented number is a multiple of $m$, but this contradicts the minimality of $m_{1}$.\\
III. The last remaining case is $m_{1}=m$, so either $m=\left|5 a^{2}-3 b^{2}\right|$ or $m=\left|a^{2}-15 b^{2}\right|$. We will get a contradiction by considering the two sides modulo 3,4 and 5 .

\begin{itemize}
  \item $2^{n}+65=5 a^{2}-3 b^{2}$ is not possible, because $2^{n}+65 \equiv 1(\bmod 3)$, but $5 a^{2}-3 b^{2} \not \equiv 1$ $(\bmod 3)$.
  \item $2^{n}+65=3 b^{2}-5 a^{2}$ is not possible, because $2^{n}+65 \equiv 1(\bmod 4)$, but $3 b^{2}-5 a^{2} \not \equiv 1$ $(\bmod 4)$.
  \item $2^{n}+65=a^{2}-15 b^{2}$ is not possible, because $2^{n}+65 \equiv \pm 2(\bmod 5)$, but $a^{2}-15 b^{2} \not \equiv \pm 2$ $(\bmod 5)$.
  \item $2^{n}+65=15 b^{2}-a^{2}$ is not possible, because $2^{n}+65 \equiv 1(\bmod 4)$, but $15 b^{2}-a^{2} \not \equiv 1$ $(\bmod 4)$.
\end{itemize}

We found a contradiction in all cases, that completes the solution.\\
Comment 1. Part I is a standard application of Thue's lemma:\\
Lemma (Thue). Suppose that $m>1$ and $c$ are integers, and $X, Y$ are positive integers such that $X \leqslant m<X Y$. Then there exist some integers $x, y$ with $|x|<X$ and $0<y<Y$, such that $x \equiv c y(\bmod m)$.

It is a well-known corollary that if $c, d$ are coprime to $m$, the congruence $c x^{2} \equiv d y^{2}(\bmod m)$ has a solution such that $x, y$ are coprime to $m$, and $X, Y$ are positive integers such that $X Y>m$, then $c x^{2} \equiv d y^{2}(\bmod m)$ has a solution such that at least one of $x, y$ is nonzero, $|x|<X$ and $|y|<Y$.

In the solution we applied this corollary with $c=5, d=3, X=Y=\lfloor\sqrt{m}\rfloor+1$.\\
Comment 2. In fact, we proved that a positive integer $m$ with $m \equiv 13$ or $37(\bmod 60)$ cannot divide any nonzero integer of the form $5 a^{2}-3 b^{2}$ or $a^{2}-15 b^{2}$ with coprime integers $a, b$. In other words, if $m \equiv 13$ or $37(\bmod 60)$, then 15 is not a quadratic residue modulo $m$. Using the tools of quadratic reciprocity, the solution can be significantly shortened.

Suppose that $a$ and $b$ are coprime. For every prime divisor $p>5$ of $5 a^{2}-3 b^{2}$ or $a^{2}-15 b^{2}$, we have


\begin{equation*}
1=\left(\frac{15}{p}\right)=\left(\frac{3}{p}\right)\left(\frac{5}{p}\right)=(-1)^{\frac{p-1}{2}}\left(\frac{p}{3}\right)\left(\frac{p}{5}\right) \tag{1}
\end{equation*}


where $\left(\frac{a}{p}\right)$ stands for the Legendre symbol. Considering the remainders of $p$ when divided by 4,3 and 5, (1) leads to

$$
p \equiv \pm 1, \pm 7, \pm 11 \text { or } \pm 17 \bmod 60
$$

These remainders form a subgroup of the reduced remainders modulo 60. Since 13 and 37 are not elements in this subgroup, the number $m=2^{n}+65$ cannot be a product of such primes.

Instead of handling the prime divisors of $m$ separately, we can use Jacobi symbols for further simplification, as shown in the next solution.",4,"Prove that if a positive integer $n$ is such that $2^n+65$ divides $5^n-3^n$, then $n$ must be an odd integer with $n \ge 3$.","Let $m = 2^n+65$. Assume $m \mid 5^n-3^n$. If $n$ is even, say $n=2k$, then $m = 4^k+65 \equiv 1^k+65 \equiv 66 \equiv 0 \pmod 3$. So $3 \mid m$. But $5^n-3^n \equiv (-1)^n-0^n \equiv 1 \pmod 3$. If $m \mid 5^n-3^n$, then $3 \mid 5^n-3^n$, a contradiction. So $n$ must be odd. If $n=1$, $m=67$ and $5^1-3^1=2$. $67 \nmid 2$. Thus, $n$ must be an odd integer with $n \ge 3$.","Let $m=2^n+65$ for an odd integer $n \ge 3$, and assume $m \mid 5^n-3^n$. Define $m_1$ as the smallest positive multiple of $m$ that can be written in the form $|5a^2-3b^2|$ or $|a^2-15b^2|$ for integers $a, b$. Prove that $m_1$ is well-defined and satisfies $m_1 \le 5m$.","Let $n=2k+1$. The number $5^n-3^n = 5(5^k)^2-3(3^k)^2$ is a multiple of $m$ and has the form $5a^2-3b^2$. Thus, the set of such multiples is non-empty and a smallest positive element $m_1$ exists. By a pigeonhole argument, there exist integers $a, b$, not both zero, with $|a|, |b| \le \sqrt{m}$, such that $5^{k+1}a \equiv -3^{k+1}b \pmod m$. Squaring gives $5^{n+1}a^2 \equiv 3^{n+1}b^2 \pmod m$. Since $5^n \equiv 3^n \pmod m$ and $\gcd(3,m)=1$, we get $5a^2 \equiv 3b^2 \pmod m$. Therefore, $|5a^2-3b^2|$ is a non-zero multiple of $m$. We have $m_1 \le |5a^2-3b^2| \le \max(5a^2, 3b^2) \le 5(\sqrt{m})^2 = 5m$.","Under the same assumptions as the previous sub-problem, prove that $m_1=m$.","From the previous step, $m_1$ is a multiple of $m$ and $m_1 \le 5m$. Thus $m_1 \in \{m, 2m, 3m, 4m, 5m\}$. We show $m_1$ is not divisible by 2, 3, or 5 by contradiction. If $p \in \{2,3,5\}$ divides $m_1$, we find a smaller multiple of $m$ of the required form, contradicting $m_1$'s minimality. For $p=5$, if $m_1=|5a^2-3b^2|$ then $5|b$, giving $|a^2-15(b/5)^2|=m_1/5$. For $p=3$, if $m_1=|5a^2-3b^2|$ then $3|a$, giving $|b^2-15(a/3)^2|=m_1/3$. For $p=2$, if $m_1=|5a^2-3b^2|$ then $|(\frac{5a-3b}{2})^2-15(\frac{a-b}{2})^2|=m_1/2$. Similar constructions exist for the other form $|a^2-15b^2|$. Since $m_1$ is not divisible by 2, 3, or 5, we must have $m_1=m$.",Prove that $5^{n}-3^{n}$ is not divisible by $2^{n}+65$ for any positive integer $n$.,"Assume for contradiction that $m=2^n+65$ divides $5^n-3^n$. By sub-problem 1, $n$ is an odd integer, $n \ge 3$. By sub-problems 2 and 3, this implies $m$ must be of the form $|5a^2-3b^2|$ or $|a^2-15b^2|$. We check these four possibilities using modular arithmetic. 1. $2^n+65=5a^2-3b^2$: Modulo 3, this is $1 \equiv 2a^2 \pmod 3$, impossible. 2. $2^n+65=3b^2-5a^2$: For $n\ge 3$, modulo 4, this is $1 \equiv 3b^2-a^2 \pmod 4$, impossible. 3. $2^n+65=a^2-15b^2$: Modulo 5, this is $2^n \equiv a^2 \pmod 5$. For odd $n$, $2^n \equiv 2$ or $3 \pmod 5$, which are not quadratic residues mod 5. 4. $2^n+65=15b^2-a^2$: For $n\ge 3$, modulo 4, this is $1 \equiv -b^2-a^2 \pmod 4$, impossible. All cases lead to a contradiction. Thus, the assumption is false."
2021a1,"Let $n$ be an integer, and let $A$ be a subset of $\left\{0,1,2,3, \ldots, 5^{n}\right\}$ consisting of $4 n+2$ numbers. Prove that there exist $a, b, c \in A$ such that $a<b<c$ and $c+2 a>3 b$.","(By contradiction) Suppose that there exist $4 n+2$ non-negative integers $x_{0}<$ $x_{1}<\cdots<x_{4 n+1}$ that violate the problem statement. Then in particular $x_{4 n+1}+2 x_{i} \leqslant 3 x_{i+1}$ for all $i=0, \ldots, 4 n-1$, which gives

$$
x_{4 n+1}-x_{i} \geqslant \frac{3}{2}\left(x_{4 n+1}-x_{i+1}\right) .
$$

By a trivial induction we then get

$$
x_{4 n+1}-x_{i} \geqslant\left(\frac{3}{2}\right)^{4 n-i}\left(x_{4 n+1}-x_{4 n}\right)
$$

which for $i=0$ yields the contradiction

$$
x_{4 n+1}-x_{0} \geqslant\left(\frac{3}{2}\right)^{4 n}\left(x_{4 n+1}-x_{4 n}\right)=\left(\frac{81}{16}\right)^{n}\left(x_{4 n+1}-x_{4 n}\right)>5^{n} \cdot 1
$$",1,"Let $n$ be an integer, and let $A$ be a subset of $\left\{0,1,2,3, \ldots, 5^{n}\right\}$ consisting of $4 n+2$ numbers. Prove that there exist $a, b, c \in A$ such that $a<b<c$ and $c+2 a>3 b$.","(By contradiction) Suppose that there exist $4 n+2$ non-negative integers $x_{0}<$ $x_{1}<\cdots<x_{4 n+1}$ that violate the problem statement. Then in particular $x_{4 n+1}+2 x_{i} \leqslant 3 x_{i+1}$ for all $i=0, \ldots, 4 n-1$, which gives

$$
x_{4 n+1}-x_{i} \geqslant \frac{3}{2}\left(x_{4 n+1}-x_{i+1}\right) .
$$

By a trivial induction we then get

$$
x_{4 n+1}-x_{i} \geqslant\left(\frac{3}{2}\right)^{4 n-i}\left(x_{4 n+1}-x_{4 n}\right)
$$

which for $i=0$ yields the contradiction

$$
x_{4 n+1}-x_{0} \geqslant\left(\frac{3}{2}\right)^{4 n}\left(x_{4 n+1}-x_{4 n}\right)=\left(\frac{81}{16}\right)^{n}\left(x_{4 n+1}-x_{4 n}\right)>5^{n} \cdot 1
$$",,,,,,
2021a4,"Show that for all real numbers $x_{1}, \ldots, x_{n}$ the following inequality holds:

$$
\sum_{i=1}^{n} \sum_{j=1}^{n} \sqrt{\left|x_{i}-x_{j}\right|} \leqslant \sum_{i=1}^{n} \sum_{j=1}^{n} \sqrt{\left|x_{i}+x_{j}\right|} .
$$","If we add $t$ to all the variables then the left-hand side remains constant and the right-hand side becomes

$$
H(t):=\sum_{i=1}^{n} \sum_{j=1}^{n} \sqrt{\left|x_{i}+x_{j}+2 t\right|} .
$$

Let $T$ be large enough such that both $H(-T)$ and $H(T)$ are larger than the value $L$ of the lefthand side of the inequality we want to prove. Not necessarily distinct points $p_{i, j}:=-\left(x_{i}+x_{j}\right) / 2$ together with $T$ and $-T$ split the real line into segments and two rays such that on each of these segments and rays the function $H(t)$ is concave since $f(t):=\sqrt{|\ell+2 t|}$ is concave on both intervals $(-\infty,-\ell / 2]$ and $[-\ell / 2,+\infty)$. Let $[a, b]$ be the segment containing zero. Then concavity implies $H(0) \geqslant \min \{H(a), H(b)\}$ and, since $H( \pm T)>L$, it suffices to prove the inequalities $H\left(-\left(x_{i}+x_{j}\right) / 2\right) \geqslant L$, that is to prove the original inequality in the case when all numbers are shifted in such a way that two variables $x_{i}$ and $x_{j}$ add up to zero. In the following we denote the shifted variables still by $x_{i}$.

If $i=j$, i.e. $x_{i}=0$ for some index $i$, then we can remove $x_{i}$ which will decrease both sides by $2 \sum_{k} \sqrt{\left|x_{k}\right|}$. Similarly, if $x_{i}+x_{j}=0$ for distinct $i$ and $j$ we can remove both $x_{i}$ and $x_{j}$ which decreases both sides by

$$
2 \sqrt{2\left|x_{i}\right|}+2 \cdot \sum_{k \neq i, j}\left(\sqrt{\left|x_{k}+x_{i}\right|}+\sqrt{\left|x_{k}+x_{j}\right|}\right)
$$

In either case we reduced our inequality to the case of smaller $n$. It remains to note that for $n=0$ and $n=1$ the inequality is trivial.\\",3,"Show that to prove the inequality for an arbitrary set of real numbers $\{x_1, \ldots, x_n\}$, it is sufficient to prove it for the case where $x_i + x_j = 0$ for some pair of indices $(i, j)$.","Let the left-hand side be $L = \sum_{i,j} \sqrt{|x_i - x_j|}$, which is invariant under a shift $x_k \to x_k+t$. Let the shifted right-hand side be $H(t) = \sum_{i,j} \sqrt{|x_i+x_j+2t|}$. The function $H(t)$ is a sum of functions of the form $\sqrt{|c+2t|}$, which are concave where their argument is of constant sign. Thus, $H(t)$ is concave on intervals defined by the points $t_0 = -(x_i+x_j)/2$. Since $H(t) \to \infty$ as $|t| \to \infty$, the global minimum of $H(t)$ must occur at one of these critical points. To prove $L \le H(0)$, it is sufficient to prove $L \le H(t_0)$ for any such $t_0$, which corresponds to proving the inequality for a set of variables shifted such that some pair sums to zero.","Assuming $x_i + x_j = 0$ for some pair $(i, j)$, show that the inequality for $n$ variables can be reduced to the same inequality for a smaller number of variables.","We consider two cases. Case 1: $i=j$, so $x_i=0$. Removing $x_i$ decreases both the left and right sides of the inequality by the same amount, $2\sum_{k \neq i} \sqrt{|x_k|}$. Thus, the inequality for $n$ variables holds if and only if it holds for the remaining $n-1$ variables. Case 2: $i \neq j$, so $x_j = -x_i$. Removing both $x_i$ and $x_j$ decreases both sides by an identical amount. This reduces the inequality for $n$ variables to the one for the remaining $n-2$ variables.","Show that for all real numbers $x_{1}, \ldots, x_{n}$ the following inequality holds:\n\n$$ \sum_{i=1}^{n} \sum_{j=1}^{n} \sqrt{\left|x_{i}-x_{j}\right|} \leqslant \sum_{i=1}^{n} \sum_{j=1}^{n} \sqrt{\left|x_{i}+x_{j}\right|} . $$","The proof is by induction on $n$. The base cases $n=0$ and $n=1$ are trivial, as both sides are 0. For the inductive step, we assume the inequality holds for all sets with fewer than $n$ variables. From Sub-problem 1, it suffices to prove the inequality for the case where $x_i+x_j=0$ for some $(i,j)$. From Sub-problem 2, this case reduces to the same inequality for a set of $n-1$ or $n-2$ variables. By the induction hypothesis, the inequality holds for this smaller set, and therefore it holds for $n$ variables.",,
2021a5,"Let $n \geqslant 2$ be an integer, and let $a_{1}, a_{2}, \ldots, a_{n}$ be positive real numbers such that $a_{1}+a_{2}+\cdots+a_{n}=1$. Prove that

$$
\sum_{k=1}^{n} \frac{a_{k}}{1-a_{k}}\left(a_{1}+a_{2}+\cdots+a_{k-1}\right)^{2}<\frac{1}{3} .
$$","For all $k \leqslant n$, let

$$
s_{k}=a_{1}+a_{2}+\cdots+a_{k} \quad \text { and } \quad b_{k}=\frac{a_{k} s_{k-1}^{2}}{1-a_{k}}
$$

with the convention that $s_{0}=0$. Note that $b_{k}$ is exactly a summand in the sum we need to estimate. We shall prove the inequality


\begin{equation*}
b_{k}<\frac{s_{k}^{3}-s_{k-1}^{3}}{3} \tag{1}
\end{equation*}


Indeed, it suffices to check that

$$
\begin{aligned}
(1) & \Longleftrightarrow 0<\left(1-a_{k}\right)\left(\left(s_{k-1}+a_{k}\right)^{3}-s_{k-1}^{3}\right)-3 a_{k} s_{k-1}^{2} \\
& \Longleftrightarrow 0<\left(1-a_{k}\right)\left(3 s_{k-1}^{2}+3 s_{k-1} a_{k}+a_{k}^{2}\right)-3 s_{k-1}^{2} \\
& \Longleftrightarrow 0<-3 a_{k} s_{k-1}^{2}+3\left(1-a_{k}\right) s_{k-1} a_{k}+\left(1-a_{k}\right) a_{k}^{2} \\
& \Longleftrightarrow 0<3\left(1-a_{k}-s_{k-1}\right) s_{k-1} a_{k}+\left(1-a_{k}\right) a_{k}^{2}
\end{aligned}
$$

which holds since $a_{k}+s_{k-1}=s_{k} \leqslant 1$ and $a_{k} \in(0,1)$.\\
Thus, adding inequalities (1) for $k=1, \ldots, n$, we conclude that

$$
b_{1}+b_{2}+\cdots+b_{n}<\frac{s_{n}^{3}-s_{0}^{3}}{3}=\frac{1}{3}
$$

as desired.\\
Comment 1. There are many ways of proving (1) which can be written as


\begin{equation*}
\frac{a s^{2}}{1-a}-\frac{(a+s)^{3}-s^{3}}{3}<0, \tag{2}
\end{equation*}


for non-negative $a$ and $s$ satisfying $a+s \leqslant 1$ and $a>0$.\\
E.g., note that for any fixed $a$ the expression in (2) is quadratic in $s$ with the leading coefficient $a /(1-a)-a>0$. Hence, it is convex as a function in $s$, so it suffices to check the inequality at $s=0$ and $s=1-a$. The former case is trivial and in the latter case the inequality can be rewritten as

$$
a s-\frac{3 a s(a+s)+a^{3}}{3}<0,
$$

which is trivial since $a+s=1$.\\",2,"Let $n \ge 2$ be an integer and $a_1, \ldots, a_n$ be positive real numbers with $\sum_{i=1}^n a_i = 1$. Let $s_k = \sum_{i=1}^k a_i$ for $k \ge 1$ and $s_0=0$. For any $k \in \{1, 2, \ldots, n\}$, prove the inequality $\frac{a_k s_{k-1}^2}{1-a_k} < \frac{s_k^3 - s_{k-1}^3}{3}$.","The inequality is equivalent to $3a_k s_{k-1}^2 < (1-a_k)(s_k^3 - s_{k-1}^3)$. Using $s_k = s_{k-1} + a_k$, this is equivalent to showing $0 < (1-a_k)((s_{k-1}+a_k)^3 - s_{k-1}^3) - 3a_k s_{k-1}^2$. Expanding the cubic difference gives $0 < (1-a_k)(3s_{k-1}^2a_k + 3s_{k-1}a_k^2 + a_k^3) - 3a_k s_{k-1}^2$. Since $a_k > 0$, we can divide by $a_k$ to get the equivalent inequality $0 < (1-a_k)(3s_{k-1}^2 + 3s_{k-1}a_k + a_k^2) - 3s_{k-1}^2$. This simplifies to $0 < 3s_{k-1}a_k(1-a_k-s_{k-1}) + a_k^2(1-a_k)$. Since $s_k = s_{k-1}+a_k$, this is $0 < 3s_{k-1}a_k(1-s_k) + a_k^2(1-a_k)$. As $s_k = \sum_{i=1}^k a_i \le \sum_{i=1}^n a_i = 1$, we have $1-s_k \ge 0$. Since $n \ge 2$, $0 < a_k < 1$, so $1-a_k > 0$. Also, $a_k>0$ and $s_{k-1} \ge 0$. The term $a_k^2(1-a_k)$ is strictly positive, and $3s_{k-1}a_k(1-s_k)$ is non-negative. Their sum is strictly positive, proving the inequality.","Let $n \geqslant 2$ be an integer, and let $a_{1}, a_{2}, \ldots, a_{n}$ be positive real numbers such that $a_{1}+a_{2}+\cdots+a_{n}=1$. Prove that

$$
\sum_{k=1}^{n} \frac{a_{k}}{1-a_{k}}\left(a_{1}+a_{2}+\cdots+a_{k-1}\right)^{2}<\frac{1}{3} .
$$","Let $s_k = a_1 + a_2 + \cdots + a_k$ for $k \ge 1$ and $s_0=0$. The sum can be written as $\sum_{k=1}^{n} \frac{a_{k} s_{k-1}^{2}}{1-a_{k}}$.
From the previous sub-problem, we have the inequality $\frac{a_k s_{k-1}^2}{1-a_k} < \frac{s_k^3 - s_{k-1}^3}{3}$ for each $k=1, 2, \ldots, n$.
Summing these inequalities from $k=1$ to $n$, we get:
$$
\sum_{k=1}^{n} \frac{a_{k} s_{k-1}^{2}}{1-a_{k}} < \sum_{k=1}^{n} \frac{s_k^3 - s_{k-1}^3}{3}
$$
The sum on the right is a telescoping series:
$$
\sum_{k=1}^{n} \frac{s_k^3 - s_{k-1}^3}{3} = \frac{1}{3} ((s_1^3 - s_0^3) + (s_2^3 - s_1^3) + \cdots + (s_n^3 - s_{n-1}^3)) = \frac{1}{3} (s_n^3 - s_0^3)
$$
By definition, $s_n = a_1 + \cdots + a_n = 1$ and $s_0 = 0$. Therefore, $\frac{1}{3}(s_n^3 - s_0^3) = \frac{1}{3}(1^3 - 0^3) = \frac{1}{3}$.
Combining the results, we have $\sum_{k=1}^{n} \frac{a_{k} s_{k-1}^{2}}{1-a_{k}} < \frac{1}{3}$, as desired.",,,,
2021a6,"Let $A$ be a finite set of (not necessarily positive) integers, and let $m \geqslant 2$ be an integer. Assume that there exist non-empty subsets $B_{1}, B_{2}, B_{3}, \ldots, B_{m}$ of $A$ whose elements add up to the sums $m^{1}, m^{2}, m^{3}, \ldots, m^{m}$, respectively. Prove that $A$ contains at least $m / 2$ elements.","Solution. Let $A=\left\{a_{1}, \ldots, a_{k}\right\}$. Assume that, on the contrary, $k=|A|<m / 2$. Let

$$
s_{i}:=\sum_{j: a_{j} \in B_{i}} a_{j}
$$

be the sum of elements of $B_{i}$. We are given that $s_{i}=m^{i}$ for $i=1, \ldots, m$.\\
Now consider all $m^{m}$ expressions of the form

$$
f\left(c_{1}, \ldots, c_{m}\right):=c_{1} s_{1}+c_{2} s_{2}+\ldots+c_{m} s_{m}, c_{i} \in\{0,1, \ldots, m-1\} \text { for all } i=1,2, \ldots, m .
$$

Note that every number $f\left(c_{1}, \ldots, c_{m}\right)$ has the form

$$
\alpha_{1} a_{1}+\ldots+\alpha_{k} a_{k}, \alpha_{i} \in\{0,1, \ldots, m(m-1)\} .
$$

Hence, there are at most $(m(m-1)+1)^{k}<m^{2 k}<m^{m}$ distinct values of our expressions; therefore, at least two of them coincide.

Since $s_{i}=m^{i}$, this contradicts the uniqueness of representation of positive integers in the base- $m$ system.

Comment 1. For other rapidly increasing sequences of sums of $B_{i}$ 's the similar argument also provides lower estimates on $k=|A|$. For example, if the sums of $B_{i}$ are equal to $1!, 2!, 3!, \ldots, m!$, then for any fixed $\varepsilon>0$ and large enough $m$ we get $k \geqslant(1 / 2-\varepsilon) m$. The proof uses the fact that the combinations $\sum c_{i}$ ! with $c_{i} \in\{0,1, \ldots, i\}$ are all distinct.

Comment 2. The problem statement holds also if $A$ is a set of real numbers (not necessarily integers), the above proofs work in the real case.",2,"Let $A=\{a_1, \ldots, a_k\}$ be a set of integers. For an integer $m \ge 2$, let $B_1, \ldots, B_m$ be subsets of $A$ with sums $s_i = \sum_{a \in B_i} a$. Consider the set of values $V = \{ \sum_{i=1}^m c_i s_i \mid c_i \in \{0, 1, \ldots, m-1\} \}$. Prove that the number of distinct values in $V$ is at most $(m(m-1)+1)^k$.","Each value in $V$ is of the form $\sum_{i=1}^m c_i s_i$. By substituting $s_i = \sum_{j=1}^k \delta_{ij} a_j$ (where $\delta_{ij}=1$ if $a_j \in B_i$ and 0 otherwise), we can rewrite the expression as $\sum_{j=1}^k \alpha_j a_j$, where the coefficients are $\alpha_j = \sum_{i=1}^m c_i \delta_{ij}$. Since $c_i \in \{0, \ldots, m-1\}$ and $\delta_{ij} \in \{0, 1\}$, each coefficient $\alpha_j$ must be an integer in the range $[0, m(m-1)]$. There are $m(m-1)+1$ possible values for each of the $k$ coefficients $\alpha_j$. Thus, there can be at most $(m(m-1)+1)^k$ distinct values in $V$.","Let $A$ be a finite set of (not necessarily positive) integers, and let $m \geqslant 2$ be an integer. Assume that there exist non-empty subsets $B_{1}, B_{2}, B_{3}, \ldots, B_{m}$ of $A$ whose elements add up to the sums $m^{1}, m^{2}, m^{3}, \ldots, m^{m}$, respectively. Prove that $A$ contains at least $m / 2$ elements.","Let $|A|=k$ and the given sums be $s_i = m^i$. Consider the set of sums $V = \{ \sum_{i=1}^m c_i m^i \mid c_i \in \{0, \ldots, m-1\} \}$. By the uniqueness of base-$m$ representation, these $m^m$ sums are all distinct. From the previous sub-problem, the number of distinct values in $V$ is at most $(m(m-1)+1)^k$. Therefore, we must have $m^m \le (m(m-1)+1)^k$. Assume for contradiction that $k < m/2$. Then $2k < m$. The inequality becomes $m^m \le (m(m-1)+1)^k < (m^2)^k = m^{2k}$. This implies $m^m < m^{2k}$, so $m < 2k$, which contradicts our assumption. Thus, we must have $k \ge m/2$.",,,,
2021a7,"Let $n \geqslant 1$ be an integer, and let $x_{0}, x_{1}, \ldots, x_{n+1}$ be $n+2$ non-negative real numbers that satisfy $x_{i} x_{i+1}-x_{i-1}^{2} \geqslant 1$ for all $i=1,2, \ldots, n$. Show that

$$
x_{0}+x_{1}+\cdots+x_{n}+x_{n+1}>\left(\frac{2 n}{3}\right)^{3 / 2}
$$","Lemma 1.1. If $a, b, c$ are non-negative numbers such that $a b-c^{2} \geqslant 1$, then

$$
(a+2 b)^{2} \geqslant(b+2 c)^{2}+6
$$

Proof. $(a+2 b)^{2}-(b+2 c)^{2}=(a-b)^{2}+2(b-c)^{2}+6\left(a b-c^{2}\right) \geqslant 6$.\\
Lemma 1.2. $\sqrt{1}+\cdots+\sqrt{n}>\frac{2}{3} n^{3 / 2}$.\\
Proof. Bernoulli's inequality $(1+t)^{3 / 2}>1+\frac{3}{2} t$ for $0>t \geqslant-1$ (or, alternatively, a straightforward check) gives


\begin{equation*}
(k-1)^{3 / 2}=k^{3 / 2}\left(1-\frac{1}{k}\right)^{3 / 2}>k^{3 / 2}\left(1-\frac{3}{2 k}\right)=k^{3 / 2}-\frac{3}{2} \sqrt{k} \tag{*}
\end{equation*}


Summing up (*) over $k=1,2, \ldots, n$ yields

$$
0>n^{3 / 2}-\frac{3}{2}(\sqrt{1}+\cdots+\sqrt{n})
$$

Now put $y_{i}:=2 x_{i}+x_{i+1}$ for $i=0,1, \ldots, n$. We get $y_{0} \geqslant 0$ and $y_{i}^{2} \geqslant y_{i-1}^{2}+6$ for $i=1,2, \ldots, n$ by Lemma 1.1. Thus, an easy induction on $i$ gives $y_{i} \geqslant \sqrt{6 i}$. Using this estimate and Lemma 1.2 we get

$$
3\left(x_{0}+\ldots+x_{n+1}\right) \geqslant y_{1}+\ldots+y_{n} \geqslant \sqrt{6}(\sqrt{1}+\sqrt{2}+\ldots+\sqrt{n})>\sqrt{6} \cdot \frac{2}{3} n^{3 / 2}=3\left(\frac{2 n}{3}\right)^{3 / 2}
$$",2,"Let $n \geqslant 1$ be an integer, and let $x_{0}, x_{1}, \ldots, x_{n+1}$ be non-negative real numbers that satisfy $x_{i} x_{i+1}-x_{i-1}^{2} \geqslant 1$ for all $i=1,2, \ldots, n$. Define a sequence $y_i = 2x_i+x_{i+1}$ for $i=0, \ldots, n$. Show that $y_i \ge \sqrt{6i}$ for $i=1, \ldots, n$.","For $i=1, \ldots, n$, let $a=x_{i+1}, b=x_i, c=x_{i-1}$. The condition $x_{i} x_{i+1}-x_{i-1}^{2} \geqslant 1$ becomes $ab-c^2 \ge 1$. Using the identity $(a+2b)^2 - (b+2c)^2 = (a-b)^2 + 2(b-c)^2 + 6(ab-c^2)$, we see that $(a+2b)^2 - (b+2c)^2 \ge 6$. In terms of the $x_j$ variables, this is $(x_{i+1}+2x_i)^2 \ge (x_i+2x_{i-1})^2 + 6$. With the definition $y_i=2x_i+x_{i+1}$, this inequality is $y_i^2 \ge y_{i-1}^2 + 6$. A simple induction yields $y_i^2 \ge y_0^2 + 6i$. Since $x_0, x_1$ are non-negative, $y_0 = 2x_0+x_1 \ge 0$, so $y_i^2 \ge 6i$. As $y_i$ is also non-negative, we can take the square root to get $y_i \ge \sqrt{6i}$.","Let $n \geqslant 1$ be an integer, and let $x_{0}, x_{1}, \ldots, x_{n+1}$ be $n+2$ non-negative real numbers that satisfy $x_{i} x_{i+1}-x_{i-1}^{2} \geqslant 1$ for all $i=1,2, \ldots, n$. Show that

$$
x_{0}+x_{1}+\cdots+x_{n}+x_{n+1}>\left(\frac{2 n}{3}\right)^{3 / 2}
$$","Let $S = x_{0}+x_{1}+\cdots+x_{n}+x_{n+1}$. Define the sequence $y_i = 2x_i+x_{i+1}$ for $i=0, \ldots, n$. From the previous sub-problem, we have $y_i \ge \sqrt{6i}$ for $i=1, \ldots, n$. Since all $x_j$ are non-negative, we can bound the sum $3S = 3\sum_{j=0}^{n+1} x_j \ge \sum_{i=1}^n (2x_i+x_{i+1}) = \sum_{i=1}^n y_i$. Using the lower bound for $y_i$, we get $3S \ge \sum_{i=1}^n \sqrt{6i} = \sqrt{6}\sum_{i=1}^n \sqrt{i}$. It is a known result that $\sum_{i=1}^n \sqrt{i} > \frac{2}{3}n^{3/2}$. Therefore, $3S > \sqrt{6} \cdot \frac{2}{3}n^{3/2}$, which simplifies to $S > \frac{2\sqrt{6}}{9}n^{3/2}$. The proof is complete by noting that $\left(\frac{2n}{3}\right)^{3/2} = \frac{2^{3/2}n^{3/2}}{3^{3/2}} = \frac{2\sqrt{2}n^{3/2}}{3\sqrt{3}} = \frac{2\sqrt{6}}{9}n^{3/2}$.",,,,
2021c1,"Let $S$ be an infinite set of positive integers, such that there exist four pairwise distinct $a, b, c, d \in S$ with $\operatorname{gcd}(a, b) \neq \operatorname{gcd}(c, d)$. Prove that there exist three pairwise distinct $x, y, z \in S$ such that $\operatorname{gcd}(x, y)=\operatorname{gcd}(y, z) \neq \operatorname{gcd}(z, x)$.","Solution. There exists $\alpha \in S$ so that $\{\operatorname{gcd}(\alpha, s) \mid s \in S, s \neq \alpha\}$ contains at least two elements. Since $\alpha$ has only finitely many divisors, there is a $d \mid \alpha$ such that the set $B=\{\beta \in$ $S \mid \operatorname{gcd}(\alpha, \beta)=d\}$ is infinite. Pick $\gamma \in S$ so that $\operatorname{gcd}(\alpha, \gamma) \neq d$. Pick $\beta_{1}, \beta_{2} \in B$ so that $\operatorname{gcd}\left(\beta_{1}, \gamma\right)=\operatorname{gcd}\left(\beta_{2}, \gamma\right)=: d^{\prime}$. If $d=d^{\prime}$, then $\operatorname{gcd}\left(\alpha, \beta_{1}\right)=\operatorname{gcd}\left(\gamma, \beta_{1}\right) \neq \operatorname{gcd}(\alpha, \gamma)$. If $d \neq d^{\prime}$, then either $\operatorname{gcd}\left(\alpha, \beta_{1}\right)=\operatorname{gcd}\left(\alpha, \beta_{2}\right)=d$ and $\operatorname{gcd}\left(\beta_{1}, \beta_{2}\right) \neq d$ or $\operatorname{gcd}\left(\gamma, \beta_{1}\right)=\operatorname{gcd}\left(\gamma, \beta_{2}\right)=d^{\prime}$ and $\operatorname{gcd}\left(\beta_{1}, \beta_{2}\right) \neq d^{\prime}$.

Comment. The situation can be modelled as a complete graph on the infinite vertex set $S$, where every edge $\{s, t\}$ is colored by $c(s, t):=\operatorname{gcd}(s, t)$. For every vertex the incident edges carry only finitely many different colors, and by the problem statement at least two different colors show up on the edge set. The goal is to show that there exists a bi-colored triangle (a triangle, whose edges carry exactly two different colors).

For the proof, consider a vertex $v$ whose incident edges carry at least two different colors. Let $X \subset S$ be an infinite subset so that $c(v, x) \equiv c_{1}$ for all $x \in X$. Let $y \in S$ be a vertex so that $c(v, y) \neq c_{1}$. Let $x_{1}, x_{2} \in X$ be two vertices with $c\left(y, x_{1}\right)=c\left(y, x_{2}\right)=c_{2}$. If $c_{1}=c_{2}$, then the triangle $v, y, x_{1}$ is bi-colored. If $c_{1} \neq c_{2}$, then one of $v, x_{1}, x_{2}$ and $y, x_{1}, x_{2}$ is bi-colored.",3,"Let $S$ be an infinite set of positive integers with four distinct $a,b,c,d \in S$ such that $\operatorname{gcd}(a, b) \neq \operatorname{gcd}(c, d)$. Prove that there exists $\alpha \in S$ such that the set $\{\operatorname{gcd}(\alpha, s) \mid s \in S, s \neq \alpha\}$ contains at least two distinct values.","Assume for contradiction that for every $x \in S$, the set $\{\operatorname{gcd}(x, s) \mid s \in S, s \neq x\}$ contains only one value, say $d_x$. Given distinct $a, b, c, d \in S$ with $\operatorname{gcd}(a, b) \neq \operatorname{gcd}(c, d)$. By our assumption, $\operatorname{gcd}(a, b) = d_a$ and $\operatorname{gcd}(a, c) = d_a$. Also, $\operatorname{gcd}(c, d) = d_c$ and $\operatorname{gcd}(c, a) = d_c$. Since $\operatorname{gcd}(a, c) = \operatorname{gcd}(c, a)$, it follows that $d_a = d_c$. This implies $\operatorname{gcd}(a, b) = d_a = d_c = \operatorname{gcd}(c, d)$, which is a contradiction. Thus, such an $\alpha$ must exist.","Let $S$ be an infinite set of positive integers. Suppose there is an element $\alpha \in S$ such that the set of values $\{\operatorname{gcd}(\alpha, s) \mid s \in S, s \neq \alpha\}$ is not a singleton. Prove that there exist a divisor $d$ of $\alpha$, an infinite subset $B \subseteq S \setminus \{\alpha\}$, and an element $\gamma \in S \setminus \{\alpha\}$ such that $\operatorname{gcd}(\alpha, \beta)=d$ for all $\beta \in B$, and $\operatorname{gcd}(\alpha, \gamma) \neq d$.","The set of values $V = \{\operatorname{gcd}(\alpha, s) \mid s \in S, s \neq \alpha\}$ is a subset of the finite set of divisors of $\alpha$. Since $S \setminus \{\alpha\}$ is infinite, by the Pigeonhole Principle, there must be at least one value $d \in V$ such that the set $B = \{s \in S \setminus \{\alpha\} \mid \operatorname{gcd}(\alpha, s) = d\}$ is infinite. By hypothesis, $V$ contains at least two distinct values, so there must exist an element $\gamma \in S \setminus \{\alpha\}$ for which $\operatorname{gcd}(\alpha, \gamma) \neq d$.","Let $S$ be an infinite set of positive integers, such that there exist four pairwise distinct $a, b, c, d \in S$ with $\operatorname{gcd}(a, b) \neq \operatorname{gcd}(c, d)$. Prove that there exist three pairwise distinct $x, y, z \in S$ such that $\operatorname{gcd}(x, y)=\operatorname{gcd}(y, z) \neq \operatorname{gcd}(z, x)$.","From the previous steps, there exist $\alpha, \gamma \in S$, an infinite subset $B \subseteq S$, and an integer $d$ such that for all $\beta \in B$, $\operatorname{gcd}(\alpha, \beta) = d$, and $\operatorname{gcd}(\alpha, \gamma) \neq d$. The set of values $\{\operatorname{gcd}(\gamma, \beta) \mid \beta \in B\}$ is finite. As $B$ is infinite, by the Pigeonhole Principle, we can find two distinct $\beta_1, \beta_2 \in B$ with $\operatorname{gcd}(\gamma, \beta_1) = \operatorname{gcd}(\gamma, \beta_2) =: d'$. If $d = d'$, the triangle $(\alpha, \beta_1, \gamma)$ works, since $\operatorname{gcd}(\alpha, \beta_1)=\operatorname{gcd}(\beta_1, \gamma)=d$ and $\operatorname{gcd}(\alpha, \gamma) \neq d$. If $d \neq d'$, let $g = \operatorname{gcd}(\beta_1, \beta_2)$. Consider the triangles $(\alpha, \beta_1, \beta_2)$ with edge GCDs $(d, d, g)$ and $(\gamma, \beta_1, \beta_2)$ with edge GCDs $(d', d', g)$. Since $d \neq d'$, $g$ cannot equal both. If $g \neq d$, $(\alpha, \beta_1, \beta_2)$ works. If $g \neq d'$, $(\gamma, \beta_1, \beta_2)$ works. In all cases, three distinct elements with the desired property are found.",,
2021c3,"A thimblerigger has 2021 thimbles numbered from 1 through 2021. The thimbles are arranged in a circle in arbitrary order. The thimblerigger performs a sequence of 2021 moves; in the $k^{\text {th }}$ move, he swaps the positions of the two thimbles adjacent to thimble $k$.

Prove that there exists a value of $k$ such that, in the $k^{\text {th }}$ move, the thimblerigger swaps some thimbles $a$ and $b$ such that $a<k<b$.","Solution. Assume the contrary. Say that the $k^{\text {th }}$ thimble is the central thimble of the $k^{\text {th }}$ move, and its position on that move is the central position of the move.\\
Step 1: Black and white colouring.\\
Before the moves start, let us paint all thimbles in white. Then, after each move, we repaint its central thimble in black. This way, at the end of the process all thimbles have become black.

By our assumption, in every move $k$, the two swapped thimbles have the same colour (as their numbers are either both larger or both smaller than $k$ ). At every moment, assign the colours of the thimbles to their current positions; then the only position which changes its colour in a move is its central position. In particular, each position is central for exactly one move (when it is being repainted to black).\\
Step 2: Red and green colouring.\\
Now we introduce a colouring of the positions. If in the $k^{\text {th }}$ move, the numbers of the two swapped thimbles are both less than $k$, then we paint the central position of the move in red; otherwise we paint that position in green. This way, each position has been painted in red or green exactly once. We claim that among any two adjacent positions, one becomes green and the other one becomes red; this will provide the desired contradiction since 2021 is odd.

Consider two adjacent positions $A$ and $B$, which are central in the $a^{\text {th }}$ and in the $b^{\text {th }}$ moves, respectively, with $a<b$. Then in the $a^{\text {th }}$ move the thimble at position $B$ is white, and therefore has a number greater than $a$. After the $a^{\text {th }}$ move, position $A$ is green and the thimble at position $A$ is black. By the arguments from Step 1, position $A$ contains only black thimbles after the $a^{\text {th }}$ step. Therefore, on the $b^{\text {th }}$ move, position $A$ contains a black thimble whose number is therefore less than $b$, while thimble $b$ is at position $B$. So position $B$ becomes red, and hence $A$ and $B$ have different colours.

Comment 1. Essentially, Step 1 provides the proof of the following two assertions (under the indirect assumption):\\
(1) Each position $P$ becomes central in exactly one move (denote that move's number by $k$ ); and\\
(2) Before the $k^{\text {th }}$ move, position $P$ always contains a thimble whose number is larger than the number of the current move, while after the $k^{\text {th }}$ move the position always contains a thimble whose number is smaller than the number of the current move.

Both (1) and (2) can be proved without introduction of colours, yet the colours help to visualise the argument.

After these two assertions have been proved, Step 2 can be performed in various ways, e.g., as follows.

At any moment in the process, the black positions are split into several groups consisting of one or more contiguous black positions each; different groups are separated by white positions. Now one can prove by induction on $k$ that, after the $k^{\text {th }}$ move, all groups have odd sizes. Indeed, in every move, the new black position either forms a separate group, or merges two groups (say, of lengths $a$ and $b$ ) into a single group of length $a+b+1$.

However, after the $2020^{\text {th }}$ move the black positions should form one group of length 2020 . This is a contradiction.

This argument has several variations; e.g., one can check in a similar way that, after the process starts, at least one among the groups of white positions has an even size.

Comment 2. The solution above works equally well for any odd number of thimbles greater than 1 , instead of 2021. On the other hand, a similar statement with an even number $n=2 k \geqslant 4$ of thimbles is wrong. To show that, the thimblerigger can enumerate positions from 1 through $n$ clockwise, and then put thimbles $1,2, \ldots, k$ at the odd positions, and thimbles $k+1, k+2, \ldots, 2 k$ at the even positions.",4,"Assume that for every move k, the swapped thimbles a and b satisfy either a, b < k or a, b > k. Show that each of the 2021 positions is the central position (i.e., holds the thimble k) for exactly one move k.","Define a thimble t as ""white"" before move t and ""black"" from move t onwards. The assumption implies that in move k, the thimbles adjacent to thimble k are of the same color (both black or both white). Color each position by the color of the thimble it contains. In move k, thimble k is white. Its neighbors are swapped. Then, thimble k becomes black. The swap operation exchanges two thimbles of the same color, so the colors of the neighboring positions do not change. The only position that changes color is the one holding thimble k, which turns from white to black. As there are 2021 moves and 2021 positions, and each move turns exactly one position from white to black permanently, each position must be the central position for exactly one move.","Under the same assumption, show that for any position P, if it is the central position for move k, then before move k, P always contains a thimble with a number greater than the current move's number, and after move k, it always contains a thimble with a number less than the current move's number.","From sub-problem 1, each position P is the central position for exactly one move k. For any move m < k, P has not yet been a central position. Following the coloring argument from the previous step, P is a ""white"" position, meaning it holds a white thimble. The thimble m is at the central position for move m (which is not P), so the thimble t at P is not m. Since t is a white thimble at move m, its number satisfies t ≥ m. As t ≠ m, we have t > m. For any move m > k, P has already been a central position and is now a ""black"" position, meaning it holds a black thimble t. This means t < m.","Under the same assumption, define a coloring on the positions: a position is ""green"" if, when it was central for move k, the swapped thimbles a,b satisfied a,b > k, and ""red"" if a,b < k. Show that any two adjacent positions must have different colors.","Let P1 and P2 be adjacent positions. From sub-problem 1, they are central for unique moves k1 and k2. Assume k1 < k2. At move k1, thimble k1 is at P1, and P2 is an adjacent position. By sub-problem 2, since k1 < k2, position P2 contains a thimble t > k1. This thimble t is swapped in move k1. By the main assumption, the other swapped thimble must also have a number greater than k1. Thus, P1 is colored green. At move k2, thimble k2 is at P2, and P1 is an adjacent position. By sub-problem 2, since k1 < k2, P1 now contains a thimble t' < k2. This thimble t' is swapped in move k2. By assumption, the other swapped thimble must also be less than k2. Thus, P2 is colored red. Therefore, adjacent positions have different colors.","Prove that there exists a value of k such that, in the k^{\text {th }} move, the thimblerigger swaps some thimbles a and b such that a<k<b.","Assume for contradiction that for every move k, the swapped thimbles a, b satisfy either a, b < k or a, b > k. From sub-problem 3, this assumption implies that any two adjacent positions in the circular arrangement of 2021 thimbles must have different colors (one red, one green). This requires the colors of the positions to alternate around the circle. An alternating 2-coloring is only possible for a cycle of even length. Since there are 2021 positions, which is an odd number, this is a contradiction. Therefore, the initial assumption is false, which proves the statement."
2021c4,"The kingdom of Anisotropy consists of $n$ cities. For every two cities there exists exactly one direct one-way road between them. We say that a path from $X$ to $Y$ is a sequence of roads such that one can move from $X$ to $Y$ along this sequence without returning to an already visited city. A collection of paths is called diverse if no road belongs to two or more paths in the collection.

Let $A$ and $B$ be two distinct cities in Anisotropy. Let $N_{A B}$ denote the maximal number of paths in a diverse collection of paths from $A$ to $B$. Similarly, let $N_{B A}$ denote the maximal number of paths in a diverse collection of paths from $B$ to $A$. Prove that the equality $N_{A B}=N_{B A}$ holds if and only if the number of roads going out from $A$ is the same as the number of roads going out from $B$.","We write $X \rightarrow Y($ or $Y \leftarrow X)$ if the road between $X$ and $Y$ goes from $X$ to $Y$. Notice that, if there is any route moving from $X$ to $Y$ (possibly passing through some cities more than once), then there is a path from $X$ to $Y$ consisting of some roads in the route. Indeed, any cycle in the route may be removed harmlessly; after some removals one obtains a path.

Say that a path is short if it consists of one or two roads.\\
Partition all cities different from $A$ and $B$ into four groups, $\mathcal{I}, \mathcal{O}, \mathcal{A}$, and $\mathcal{B}$ according to the following rules: for each city $C$,

$$
\begin{array}{ll}
C \in \mathcal{I} \Longleftrightarrow A \rightarrow C \leftarrow B ; & C \in \mathcal{O} \Longleftrightarrow A \leftarrow C \rightarrow B ; \\
C \in \mathcal{A} \Longleftrightarrow A \rightarrow C \rightarrow B ; & C \in \mathcal{B} \Longleftrightarrow A \leftarrow C \leftarrow B .
\end{array}
$$

Lemma. Let $\mathcal{P}$ be a diverse collection consisting of $p$ paths from $A$ to $B$. Then there exists a diverse collection consisting of at least $p$ paths from $A$ to $B$ and containing all short paths from $A$ to $B$.\\
Proof. In order to obtain the desired collection, modify $\mathcal{P}$ as follows.\\
If there is a direct road $A \rightarrow B$ and the path consisting of this single road is not in $\mathcal{P}$, merely add it to $\mathcal{P}$.

Now consider any city $C \in \mathcal{A}$ such that the path $A \rightarrow C \rightarrow B$ is not in $\mathcal{P}$. If $\mathcal{P}$ contains at most one path containing a road $A \rightarrow C$ or $C \rightarrow B$, remove that path (if it exists), and add the path $A \rightarrow C \rightarrow B$ to $\mathcal{P}$ instead. Otherwise, $\mathcal{P}$ contains two paths of the forms $A \rightarrow C \rightarrow B$ and $A \rightarrow C \rightarrow B$, where $C \rightarrow B$ and $A \rightarrow C$ are some paths. In this case, we recombine the edges to form two new paths $A \rightarrow C \rightarrow B$ and $A \rightarrow C \rightarrow B$ (removing cycles from the latter if needed). Now we replace the old two paths in $\mathcal{P}$ with the two new ones.

After any operation described above, the number of paths in the collection does not decrease, and the collection remains diverse. Applying such operation to each $C \in \mathcal{A}$, we obtain the desired collection.

Back to the problem, assume, without loss of generality, that there is a road $A \rightarrow B$, and let $a$ and $b$ denote the numbers of roads going out from $A$ and $B$, respectively. Choose a diverse collection $\mathcal{P}$ consisting of $N_{A B}$ paths from $A$ to $B$. We will transform it into a diverse collection $\mathcal{Q}$ consisting of at least $N_{A B}+(b-a)$ paths from $B$ to $A$. This construction yields

$$
N_{B A} \geqslant N_{A B}+(b-a) ; \quad \text { similarly, we get } \quad N_{A B} \geqslant N_{B A}+(a-b)
$$

whence $N_{B A}-N_{A B}=b-a$. This yields the desired equivalence.\\
Apply the lemma to get a diverse collection $\mathcal{P}^{\prime}$ of at least $N_{A B}$ paths containing all $|\mathcal{A}|+1$ short paths from $A$ to $B$. Notice that the paths in $\mathcal{P}^{\prime}$ contain no edge of a short path from $B$ to $A$. Each non-short path in $\mathcal{P}^{\prime}$ has the form $A \rightarrow C \rightarrow D \rightarrow B$, where $C \rightarrow D$ is a path from some city $C \in \mathcal{I}$ to some city $D \in \mathcal{O}$. For each such path, put into $\mathcal{Q}$ the\\
path $B \rightarrow C \longrightarrow D \rightarrow A$; also put into $\mathcal{Q}$ all short paths from $B$ to $A$. Clearly, the collection $\mathcal{Q}$ is diverse.

Now, all roads going out from $A$ end in the cities from $\mathcal{I} \cup \mathcal{A} \cup\{B\}$, while all roads going out from $B$ end in the cities from $\mathcal{I} \cup \mathcal{B}$. Therefore,

$$
a=|\mathcal{I}|+|\mathcal{A}|+1, \quad b=|\mathcal{I}|+|\mathcal{B}|, \quad \text { and hence } \quad a-b=|\mathcal{A}|-|\mathcal{B}|+1
$$

On the other hand, since there are $|\mathcal{A}|+1$ short paths from $A$ to $B$ (including $A \rightarrow B$ ) and $|\mathcal{B}|$ short paths from $B$ to $A$, we infer

$$
|\mathcal{Q}|=\left|\mathcal{P}^{\prime}\right|-(|\mathcal{A}|+1)+|\mathcal{B}| \geqslant N_{A B}+(b-a)
$$

as desired.",4,"Let $A$ and $B$ be two distinct cities. Partition the remaining $n-2$ cities $C$ into four sets: $\mathcal{I} = \{C \mid A \rightarrow C \leftarrow B\}$, $\mathcal{O} = \{C \mid A \leftarrow C \rightarrow B\}$, $\mathcal{A} = \{C \mid A \rightarrow C \rightarrow B\}$, and $\mathcal{B} = \{C \mid A \leftarrow C \leftarrow B\}$. Let $a$ and $b$ be the number of roads going out from $A$ and $B$, respectively. Prove that $a - b = |\mathcal{A}| - |\mathcal{B}| + \delta$, where $\delta = 1$ if there is a road $A \rightarrow B$ and $\delta = -1$ if there is a road $B \rightarrow A$.","The set of cities to which roads go out from $A$ consists of cities in $\mathcal{I}$, cities in $\mathcal{A}$, and possibly city $B$. Thus, the out-degree of $A$ is $a = |\mathcal{I}| + |\mathcal{A}| + (1 \text{ if } A \rightarrow B \text{ else } 0)$. The set of cities to which roads go out from $B$ consists of cities in $\mathcal{I}$, cities in $\mathcal{B}$, and possibly city $A$. Thus, the out-degree of $B$ is $b = |\mathcal{I}| + |\mathcal{B}| + (1 \text{ if } B \rightarrow A \text{ else } 0)$. Let $\delta$ be 1 if $A \rightarrow B$ and -1 if $B \rightarrow A$. If $A \rightarrow B$, then $a = |\mathcal{I}|+|\mathcal{A}|+1$ and $b = |\mathcal{I}|+|\mathcal{B}|$, so $a-b = |\mathcal{A}|-|\mathcal{B}|+1 = |\mathcal{A}|-|\mathcal{B}|+\delta$. If $B \rightarrow A$, then $a = |\mathcal{I}|+|\mathcal{A}|$ and $b = |\mathcal{I}|+|\mathcal{B}|+1$, so $a-b = |\mathcal{A}|-|\mathcal{B}|-1 = |\mathcal{A}|-|\mathcal{B}|+\delta$. The formula holds in both cases.",A path is 'short' if it consists of one or two roads. Let $\mathcal{P}$ be a diverse collection of $p$ paths from city $A$ to city $B$. Prove that there exists a diverse collection $\mathcal{P}'$ with at least $p$ paths from $A$ to $B$ that contains all short paths from $A$ to $B$.,"We construct $\mathcal{P}'$ by modifying $\mathcal{P}$. First, if the direct path $A \rightarrow B$ exists and is not in $\mathcal{P}$, add it to the collection. The number of paths increases. Now, for any city $C \in \mathcal{A}$ such that the short path $P_C: A \rightarrow C \rightarrow B$ is not in $\mathcal{P}$, we observe that its edges $A \rightarrow C$ and $C \rightarrow B$ are used by at most two paths in $\mathcal{P}$ (since the collection is diverse). If they are used by two paths $P_1: A \rightarrow C \leadsto Y$ and $P_2: X \leadsto C \rightarrow B$, we replace them with $P_C: A \rightarrow C \rightarrow B$ and a new path $X \leadsto C \leadsto Y$ (with cycles removed). The number of paths is unchanged. If only one of the edges is used, say in a path $P_1$, we replace $P_1$ with $P_C$. If neither edge is used, we add $P_C$. In all cases, the number of paths does not decrease, the collection remains diverse, and we have incorporated $P_C$. Repeating this for all $C \in \mathcal{A}$ yields the desired collection $\mathcal{P}'$.","Let $a$ and $b$ be the out-degrees of cities $A$ and $B$, and let $N_{AB}$ and $N_{BA}$ be the maximal sizes of diverse path collections. Show that $N_{B A} - N_{A B} = b - a$.","Assume without loss of generality that the road is $A \rightarrow B$. Let $\mathcal{P}'$ be a maximal diverse collection of $N_{A B}$ paths from $A$ to $B$ which, by the previous sub-problem, can be assumed to contain all short paths. The number of short paths is $|\mathcal{A}|+1$. The other $N_{A B} - (|\mathcal{A}|+1)$ paths must be of the form $A \rightarrow C \leadsto D \rightarrow B$ for some $C \in \mathcal{I}, D \in \mathcal{O}$. We form a new collection $\mathcal{Q}$ of paths from $B$ to $A$. For each non-short path $A \rightarrow C \leadsto D \rightarrow B$ in $\mathcal{P}'$, we add the path $B \rightarrow C \leadsto D \rightarrow A$ to $\mathcal{Q}$. We also add all $|\mathcal{B}|$ short paths from $B$ to $A$ (of the form $B \rightarrow C \rightarrow A$ for $C \in \mathcal{B}$). The collection $\mathcal{Q}$ is diverse and its size is $|\mathcal{Q}| = (N_{A B} - (|\mathcal{A}|+1)) + |\mathcal{B}|$. Using the result from the first sub-problem ($a-b = |\mathcal{A}|-|\mathcal{B}|+1$, so $b-a = |\mathcal{B}|-|\mathcal{A}|-1$), we get $|\mathcal{Q}| = N_{A B} + b-a$. Since $N_{B A} \ge |\mathcal{Q}|$, we have $N_{B A} \ge N_{A B} + b-a$. By symmetry, swapping $A$ and $B$, we also have $N_{A B} \ge N_{B A} + a-b$. These two inequalities imply $N_{B A} - N_{A B} = b-a$.","Let $A$ and $B$ be two distinct cities in Anisotropy. Let $N_{A B}$ denote the maximal number of paths in a diverse collection of paths from $A$ to $B$. Similarly, let $N_{B A}$ denote the maximal number of paths in a diverse collection of paths from $B$ to $A$. Prove that the equality $N_{A B}=N_{B A}$ holds if and only if the number of roads going out from $A$ is the same as the number of roads going out from $B$.","Let $a$ and $b$ be the number of roads going out from $A$ and $B$, respectively. From the previous sub-problem, we established the equality $N_{B A} - N_{A B} = b - a$. We now prove the biconditional statement. 
($\Rightarrow$) Assume $N_{A B} = N_{B A}$. Substituting this into the equality gives $N_{A B} - N_{A B} = b-a$, which simplifies to $0 = b-a$, so $a=b$. The number of roads going out from $A$ is the same as from $B$. 
($\Leftarrow$) Assume $a=b$. Substituting this into the equality gives $N_{B A} - N_{A B} = b-b$, which simplifies to $N_{B A} - N_{A B} = 0$, so $N_{A B} = N_{B A}$. 
Thus, the equality $N_{A B}=N_{B A}$ holds if and only if $a=b$."
2021c5,"Let $n$ and $k$ be two integers with $n>k \geqslant 1$. There are $2 n+1$ students standing in a circle. Each student $S$ has $2 k$ neighbours - namely, the $k$ students closest to $S$ on the right, and the $k$ students closest to $S$ on the left.

Suppose that $n+1$ of the students are girls, and the other $n$ are boys. Prove that there is a girl with at least $k$ girls among her neighbours.","Solution. We replace the girls by 1's, and the boys by 0's, getting the numbers $a_{1}, a_{2}, \ldots, a_{2 n+1}$ arranged in a circle. We extend this sequence periodically by letting $a_{2 n+1+k}=a_{k}$ for all $k \in \mathbb{Z}$. We get an infinite periodic sequence

$$
\ldots, a_{1}, a_{2}, \ldots, a_{2 n+1}, a_{1}, a_{2}, \ldots, a_{2 n+1}, \ldots
$$

Consider the numbers $b_{i}=a_{i}+a_{i-k-1}-1 \in\{-1,0,1\}$ for all $i \in \mathbb{Z}$. We know that


\begin{equation*}
b_{m+1}+b_{m+2}+\cdots+b_{m+2 n+1}=1 \quad(m \in \mathbb{Z}) \tag{1}
\end{equation*}


in particular, this yields that there exists some $i_{0}$ with $b_{i_{0}}=1$. Now we want to find an index $i$ such that


\begin{equation*}
b_{i}=1 \quad \text { and } \quad b_{i+1}+b_{i+2}+\cdots+b_{i+k} \geqslant 0 \tag{2}
\end{equation*}


This will imply that $a_{i}=1$ and

$$
\left(a_{i-k}+a_{i-k+1}+\cdots+a_{i-1}\right)+\left(a_{i+1}+a_{i+2}+\cdots+a_{i+k}\right) \geqslant k
$$

as desired.\\
Suppose, to the contrary, that for every index $i$ with $b_{i}=1$ the sum $b_{i+1}+b_{i+2}+\cdots+b_{i+k}$ is negative. We start from some index $i_{0}$ with $b_{i_{0}}=1$ and construct a sequence $i_{0}, i_{1}, i_{2}, \ldots$, where $i_{j}(j>0)$ is the smallest possible index such that $i_{j}>i_{j-1}+k$ and $b_{i_{j}}=1$. We can choose two numbers among $i_{0}, i_{1}, \ldots, i_{2 n+1}$ which are congruent modulo $2 n+1$ (without loss of generality, we may assume that these numbers are $i_{0}$ and $i_{T}$ ).

On the one hand, for every $j$ with $0 \leqslant j \leqslant T-1$ we have

$$
S_{j}:=b_{i_{j}}+b_{i_{j}+1}+b_{i_{j}+2}+\cdots+b_{i_{j+1}-1} \leqslant b_{i_{j}}+b_{i_{j}+1}+b_{i_{j}+2}+\cdots+b_{i_{j}+k} \leqslant 0
$$

since $b_{i_{j}+k+1}, \ldots, b_{i_{j+1}-1} \leqslant 0$. On the other hand, since $\left(i_{T}-i_{0}\right) \mid(2 n+1)$, from (1) we deduce

$$
S_{0}+\cdots+S_{T-1}=\sum_{i=i_{0}}^{i_{T}-1} b_{i}=\frac{i_{T}-i_{0}}{2 n+1}>0
$$

This contradiction finishes the solution.\\
Comment 1. After the problem is reduced to finding an index $i$ satisfying (2), one can finish the solution by applying the (existence part of) following statement.\\
Lemma (Raney). If $\left\langle x_{1}, x_{2}, \ldots, x_{m}\right\rangle$ is any sequence of integers whose sum is +1 , exactly one of the cyclic shifts $\left\langle x_{1}, x_{2}, \ldots, x_{m}\right\rangle,\left\langle x_{2}, \ldots, x_{m}, x_{1}\right\rangle, \ldots,\left\langle x_{m}, x_{1}, \ldots, x_{m-1}\right\rangle$ has all of its partial sums positive.

A (possibly wider known) version of this lemma, which also can be used in order to solve the problem, is the following\\
Claim (Gas stations problem). Assume that there are several fuel stations located on a circular route which together contain just enough gas to make one trip around. Then one can make it all the way around, starting at the right station with an empty tank.

Both Raney's theorem and the Gas stations problem admit many different (parallel) proofs. Their ideas can be disguised in direct solutions of the problem at hand (as it, in fact, happens in the above solution); such solutions may avoid the introduction of the $b_{i}$. Below, in Comment 2 we present a variant of such solution, while in Comment 3 we present an alternative proof of Raney's theorem.

Comment 2. Here is a version of the solution which avoids the use of the $b_{i}$.\\
Suppose the contrary. Introduce the numbers $a_{i}$ as above. Starting from any index $s_{0}$ with $a_{s_{0}}=1$, we construct a sequence $s_{0}, s_{1}, s_{2}, \ldots$ by letting $s_{i}$ to be the smallest index larger than $s_{i-1}+k$ such that $a_{s_{i}}=1$, for $i=1,2, \ldots$ Choose two indices among $s_{1}, \ldots, s_{2 n+1}$ which are congruent modulo $2 n+1$; we assume those two are $s_{0}$ and $s_{T}$, with $s_{T}-s_{0}=t(2 n+1)$. Notice here that $s_{T+1}-s_{T}=s_{1}-s_{0}$.

For every $i=0,1,2, \ldots, T$, put

$$
L_{i}=s_{i+1}-s_{i} \quad \text { and } \quad S_{i}=a_{s_{i}}+a_{s_{i}+1}+\cdots+a_{s_{i+1}-1}
$$

Now, by the indirect assumption, for every $i=1,2, \ldots, T$, we have

$$
a_{s_{i}-k}+a_{s_{i}-k+1}+\cdots+a_{s_{i}+k} \leqslant a_{s_{i}}+(k-1)=k
$$

Recall that $a_{j}=0$ for all $j$ with $s_{i}+k<j<a_{s_{i+1}}$. Therefore,

$$
S_{i-1}+S_{i}=\sum_{j=s_{i-1}}^{s_{i}+k} a_{j}=\sum_{j=s_{i-1}}^{s_{i}-k-1} a_{j}+\sum_{j=s_{i}-k}^{s_{i}+k} a_{j} \leqslant\left(s_{i}-s_{i-1}-k\right)+k=L_{i-1}
$$

Summing up these equalities over $i=1,2, \ldots, T$ we get

$$
2 t(n+1)=\sum_{i=1}^{T}\left(S_{i-1}+S_{i}\right) \leqslant \sum_{i=1}^{T} L_{i-1}=(2 n+1) t
$$

which is a contradiction.\\
Comment 3. Here we present a proof of Raney's lemma different from the one used above.\\
If we plot the partial sums $s_{n}=x_{1}+\cdots+x_{n}$ as a function of $n$, the graph of $s_{n}$ has an average slope of $1 / m$, because $s_{m+n}=s_{n}+1$.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_9f325c9d511f2c38a6b8g-33}

The entire graph can be contained between two lines of slope $1 / m$. In general these bounding lines touch the graph just once in each cycle of $m$ points, since lines of slope $1 / m$ hit points with integer coordinates only once per $m$ units. The unique (in one cycle) lower point of intersection is the only place in the cycle from which all partial sums will be positive.

Comment 4. The following example shows that for different values of $k$ the required girl may have different positions: 011001101.",4,"Represent the students by a circular sequence $a_1, \dots, a_{2n+1}$, where $a_i=1$ for a girl and $a_i=0$ for a boy. The problem is to find an index $i$ with $a_i=1$ and $\sum_{j=i-k, j \neq i}^{i+k} a_j \ge k$. Define a new sequence $b_i = a_i + a_{i-k-1} - 1$ for all integers $i$ (with indices taken modulo $2n+1$). Show that the original problem is equivalent to finding an index $i$ such that $b_i=1$ and $\sum_{j=1}^{k} b_{i+j} \ge 0$.","The condition $b_i=1$ implies $a_i + a_{i-k-1} - 1 = 1$, which requires $a_i=1$ and $a_{i-k-1}=1$. Thus, student $i$ must be a girl. The condition $\sum_{j=1}^{k} b_{i+j} \ge 0$ expands to $\sum_{j=1}^{k} (a_{i+j} + a_{i+j-k-1} - 1) \ge 0$. This can be rewritten as $\sum_{j=1}^{k} a_{i+j} + \sum_{j=1}^{k} a_{i+j-k-1} - k \ge 0$. Re-indexing the second sum gives $\sum_{j=i+1}^{i+k} a_j + \sum_{j=i-k}^{i-1} a_j \ge k$. This is precisely the condition that the girl at position $i$ has at least $k$ girls among her neighbours. Therefore, the two problems are equivalent.","Using the definitions from the first sub-problem, prove that the sum of any $2n+1$ consecutive terms of the sequence $b_i$ is equal to 1.","Let's compute the sum over one full cycle: $\sum_{i=1}^{2n+1} b_i = \sum_{i=1}^{2n+1} (a_i + a_{i-k-1} - 1)$. We can separate the terms: $\sum_{i=1}^{2n+1} a_i + \sum_{i=1}^{2n+1} a_{i-k-1} - \sum_{i=1}^{2n+1} 1$. The first sum, $\sum a_i$, is the total number of girls, which is $n+1$. The second sum is over the same elements just cyclically shifted, so it is also $n+1$. The third sum is $2n+1$. Therefore, the total sum is $(n+1) + (n+1) - (2n+1) = 2n+2 - 2n-1 = 1$.","Prove that there must exist an index $i$ in the sequence $b_i$ such that $b_i=1$ and the sum of the next $k$ terms is non-negative, i.e., $\sum_{j=1}^{k} b_{i+j} \ge 0$.","Assume for contradiction that for every index $i$ with $b_i=1$, the sum $\sum_{j=1}^{k} b_{i+j}$ is negative (i.e., $\le -1$). Since $\sum_{l=1}^{2n+1} b_l = 1$, there must be at least one index $i_0$ with $b_{i_0}=1$. Construct a sequence $i_0, i_1, \dots$ where $i_j$ is the smallest integer index such that $i_j > i_{j-1}+k$ and $b_{i_j}=1$. By the pigeonhole principle, there must be two indices in this sequence, say $i_p$ and $i_q$ with $p<q$, that are congruent modulo $2n+1$. Let these be $i_0$ and $i_T$. The sum $S = \sum_{l=i_0}^{i_T-1} b_l$ is over a positive integer number of full cycles, so $S>0$. However, if we partition the sum into segments $\sum_{l=i_j}^{i_{j+1}-1} b_l$, each such segment sum is $\le 0$. This is because $b_{i_j}=1$, $\sum_{l=i_j+1}^{i_j+k} b_l \le -1$ by our assumption, and $b_l \le 0$ for $i_j+k < l < i_{j+1}$ by construction of the sequence. This implies $S \le 0$, a contradiction.","Let $n$ and $k$ be two integers with $n>k \geqslant 1$. There are $2 n+1$ students standing in a circle. Suppose that $n+1$ of the students are girls, and the other $n$ are boys. Prove that there is a girl with at least $k$ girls among her neighbours.","As established in the first sub-problem, this problem is equivalent to finding an index $i$ in an auxiliary sequence $b_i$ such that $b_i=1$ and $\sum_{j=1}^{k} b_{i+j} \ge 0$. The second sub-problem showed that the sum of any $2n+1$ consecutive terms of this sequence is 1. The third sub-problem used this property to prove by contradiction that such an index $i$ must exist. Since the existence of such an index is guaranteed, the equivalent original statement is also true. Therefore, there must be a girl with at least $k$ girls among her neighbours."
2021g1,"Let $A B C D$ be a parallelogram such that $A C=B C$. A point $P$ is chosen on the extension of the segment $A B$ beyond $B$. The circumcircle of the triangle $A C D$ meets the segment $P D$ again at $Q$, and the circumcircle of the triangle $A P Q$ meets the segment $P C$ again at $R$. Prove that the lines $C D, A Q$, and $B R$ are concurrent.","Common remarks. The introductory steps presented here are used in all solutions below.\\
Since $A C=B C=A D$, we have $\angle A B C=\angle B A C=\angle A C D=\angle A D C$. Since the quadrilaterals $A P R Q$ and $A Q C D$ are cyclic, we obtain

$$
\angle C R A=180^{\circ}-\angle A R P=180^{\circ}-\angle A Q P=\angle D Q A=\angle D C A=\angle C B A,
$$

so the points $A, B, C$, and $R$ lie on some circle $\gamma$.\\
Introduce the point $X=A Q \cap C D$; we need to prove that $B, R$ and $X$ are collinear.

By means of the circle $(A P R Q)$ we have

$$
\angle R Q X=180^{\circ}-\angle A Q R=\angle R P A=\angle R C X
$$

(the last equality holds in view of $A B \| C D$ ), which means that the points $C, Q, R$, and $X$ also lie on some circle $\delta$.

Using the circles $\delta$ and $\gamma$ we finally obtain

$$
\angle X R C=\angle X Q C=180^{\circ}-\angle C Q A=\angle A D C=\angle B A C=180^{\circ}-\angle C R B,
$$

that proves the desired collinearity.\\",2,"Prove that the points A, B, C, and R lie on a circle.","From the cyclic quadrilateral $APRQ$, we have $\angle ARP + \angle AQP = 180^\circ$. As $P, R, C$ are collinear, $\angle CRA = 180^\circ - \angle ARP = \angle AQP$. As $P, Q, D$ are collinear, $\angle AQP = 180^\circ - \angle AQD$. From the cyclic quadrilateral $AQCD$, $\angle AQD = \angle ACD$. Thus, $\angle CRA = 180^\circ - \angle ACD$. Since $ABCD$ is a parallelogram, $AB \parallel CD$, so $\angle ACD = \angle BAC$. Given $AC=BC$, we have $\angle BAC = \angle ABC$. Therefore, $\angle CRA = 180^\circ - \angle ABC$, which means $\angle CRA + \angle ABC = 180^\circ$, proving that $A, B, C, R$ are concyclic.","Prove that the lines $C D, A Q$, and $B R$ are concurrent.","Let $X$ be the intersection of $AQ$ and $CD$. We need to prove that $B, R, X$ are collinear. Since $AB \parallel CD$, we have $AP \parallel CX$, so $\angle APR = \angle RCX$ as alternate interior angles. In cyclic quadrilateral $APRQ$, $\angle APR = 180^\circ - \angle AQR$. As $A, Q, X$ are collinear, $180^\circ - \angle AQR = \angle RQX$. Thus, $\angle RCX = \angle RQX$, which implies that $C, Q, R, X$ are concyclic. From this, we have $\angle XRC = \angle XQC = 180^\circ - \angle AQC$. In cyclic quadrilateral $AQCD$, $180^\circ - \angle AQC = \angle ADC$. In parallelogram $ABCD$, $\angle ADC = \angle ABC = \angle BAC$. From the first sub-problem, $ABCR$ is a cyclic quadrilateral, so $\angle BAC + \angle BRC = 180^\circ$. Therefore, $\angle XRC = 180^\circ - \angle BRC$, which means $\angle XRC + \angle BRC = 180^\circ$. This shows that $B, R, X$ are collinear, so the lines $CD, AQ, BR$ are concurrent at $X$.",,,,
2021g2,"Let $A B C D$ be a convex quadrilateral circumscribed around a circle with centre $I$. Let $\omega$ be the circumcircle of the triangle $A C I$. The extensions of $B A$ and $B C$ beyond $A$ and $C$ meet $\omega$ at $X$ and $Z$, respectively. The extensions of $A D$ and $C D$ beyond $D$ meet $\omega$ at $Y$ and $T$, respectively. Prove that the perimeters of the (possibly self-intersecting) quadrilaterals $A D T X$ and $C D Y Z$ are equal.","Solution. The point $I$ is the intersection of the external bisector of the angle $T C Z$ with the circumcircle $\omega$ of the triangle $T C Z$, so $I$ is the midpoint of the arc $T C Z$ and $I T=I Z$. Similarly, $I$ is the midpoint of the arc $Y A X$ and $I X=I Y$. Let $O$ be the centre of $\omega$. Then $X$ and $T$ are the reflections of $Y$ and $Z$ in $I O$, respectively. So $X T=Y Z$.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_9f325c9d511f2c38a6b8g-44}

Let the incircle of $A B C D$ touch $A B, B C, C D$, and $D A$ at points $P, Q, R$, and $S$, respectively.

The right triangles $I X P$ and $I Y S$ are congruent, since $I P=I S$ and $I X=I Y$. Similarly, the right triangles $I R T$ and $I Q Z$ are congruent. Therefore, $X P=Y S$ and $R T=Q Z$.

Denote the perimeters of $A D T X$ and $C D Y Z$ by $P_{A D T X}$ and $P_{C D Y Z}$ respectively. Since $A S=A P, C Q=R C$, and $S D=D R$, we obtain

$$
\begin{aligned}
P_{A D T X}=X T+X A+A S+ & S D+D T=X T+X P+R T \\
& =Y Z+Y S+Q Z=Y Z+Y D+D R+R C+C Z=P_{C D Y Z},
\end{aligned}
$$

as required.\\
Comment 1. After proving that $X$ and $T$ are the reflections of $Y$ and $Z$ in $I O$, respectively, one can finish the solution as follows. Since $X T=Y Z$, the problem statement is equivalent to


\begin{equation*}
X A+A D+D T=Y D+D C+C Z . \tag{1}
\end{equation*}


Since $A B C D$ is circumscribed, $A B-A D=B C-C D$. Adding this to (1), we come to an equivalent equality $X A+A B+D T=Y D+B C+C Z$, or


\begin{equation*}
X B+D T=Y D+B Z . \tag{2}
\end{equation*}


Let $\lambda=\frac{X Z}{A C}=\frac{T Y}{A C}$. Since $X A C Z$ is cyclic, the triangles $Z B X$ and $A B C$ are similar, hence

$$
\frac{X B}{B C}=\frac{B Z}{A B}=\frac{X Z}{A C}=\lambda .
$$

It follows that $X B=\lambda B C$ and $B Z=\lambda A B$. Likewise, the triangles $T D Y$ and $A D C$ are similar, hence

$$
\frac{D T}{A D}=\frac{D Y}{C D}=\frac{T Y}{A C}=\lambda
$$

Therefore, (2) rewrites as $\lambda B C+\lambda A D=\lambda C D+\lambda A B$.\\
This is equivalent to $B C+A D=C D+A B$ which is true as $A B C D$ is circumscribed.\\
Comment 2. Here is a more difficult modification of the original problem, found by the PSC.\\
Let $A B C D$ be a convex quadrilateral circumscribed around a circle with centre $I$. Let $\omega$ be the circumcircle of the triangle $A C I$. The extensions of $B A$ and $B C$ beyond $A$ and $C$ meet $\omega$ at $X$ and $Z$, respectively. The extensions of $A D$ and $C D$ beyond $D$ meet $\omega$ at $Y$ and $T$, respectively. Let $U=B C \cap A D$ and $V=B A \cap C D$. Let $I_{U}$ be the incentre of $U Y Z$ and let $J_{V}$ be the $V$-excentre of $V X T$. Then $I_{U} J_{V} \perp B D$.",4,"Let $A B C D$ be a convex quadrilateral circumscribed around a circle with centre $I$. Let $\omega$ be the circumcircle of the triangle $A C I$. The extensions of $B A$ and $B C$ beyond $A$ and $C$ meet $\omega$ at $X$ and $Z$, respectively. The extensions of $A D$ and $C D$ beyond $D$ meet $\omega$ at $Y$ and $T$, respectively. Prove that $IX = IY$ and $IZ = IT$.","Since $I$ is the incenter of $ABCD$, the line $AI$ bisects $\angle DAB$. As $X$ and $Y$ are on the extensions of $BA$ and $DA$, $AI$ is the angle bisector of $\angle XAY$. Since points $A, I, X, Y$ lie on the circle $\omega$, the angle bisector property in a circle implies that $I$ is the midpoint of the arc $XY$ not containing $A$. Thus, $IX=IY$. Similarly, $CI$ bisects $\angle BCD$, which is $\angle ZCT$. As $C, I, Z, T$ are on $\omega$, $I$ must be the midpoint of the arc $ZT$ not containing $C$. Thus, $IZ=IT$.","Using the results from the previous step ($IX = IY$ and $IZ = IT$), prove that $XT = YZ$.","Let $O$ be the center of the circle $\omega$. From the previous sub-problem, we have $IX = IY$. Since $X$ and $Y$ are on $\omega$, we also have $OX = OY$ (radii). Both $I$ and $O$ lie on the perpendicular bisector of the segment $XY$, so the line $IO$ is the perpendicular bisector of $XY$. Similarly, $IZ=IT$ and $OZ=OT$ implies that $IO$ is the perpendicular bisector of $ZT$. Therefore, reflection across the line $IO$ maps point $Y$ to $X$ and point $Z$ to $T$. Since reflection is an isometry, it preserves distances, so the length of segment $YZ$ is equal to the length of its image, segment $XT$. Hence, $XT = YZ$.","Let the incircle of $ABCD$ touch the sides $AB, BC, CD, DA$ at points $P, Q, R, S$ respectively. Using the result $IX=IY$ and $IT=IZ$, prove that $XP = YS$ and $RT = QZ$.","The radius of the incircle to a point of tangency is perpendicular to the side. Thus, $IP \perp AB$, making $\triangle IPX$ a right-angled triangle. Similarly, $\triangle ISY$ is a right-angled triangle. We are given $IP = IS$ (inradius) and we know $IX=IY$ from sub-problem 1. By the Pythagorean theorem, $XP^2 = IX^2 - IP^2$ and $YS^2 = IY^2 - IS^2$. Therefore, $XP^2 = YS^2$, which implies $XP = YS$. A similar argument for the right-angled triangles $\triangle IRT$ and $\triangle IQZ$ shows that $RT = QZ$, using the facts that $IR=IQ$ (inradius) and $IT=IZ$.",Prove that the perimeters of the (possibly self-intersecting) quadrilaterals $A D T X$ and $C D Y Z$ are equal.,"Let $P_{ADTX}$ and $P_{CDYZ}$ be the perimeters. The perimeter of $ADTX$ is $P_{ADTX} = AX + AD + DT + TX$. Using the tangent properties of a circumscribed quadrilateral ($AS=AP, DS=DR$), this can be rewritten as $P_{ADTX} = (AX+AS) + (SD+DT) + TX = (AX+AP) + (DR+DT) + TX = XP + RT + TX$. The perimeter of $CDYZ$ is $P_{CDYZ} = CD + DY + YZ + ZC$. Using tangent properties ($CR=CQ, DR=DS$), this is $P_{CDYZ} = (CR+ZC) + (DS+DY) + YZ = QZ + SY + YZ$. From previous sub-problems, we have $XT=YZ$, $XP=YS$, and $RT=ZQ$. Substituting these into the expression for $P_{ADTX}$ yields $P_{ADTX} = YS + QZ + YZ$, which is equal to $P_{CDYZ}$. Thus, the perimeters are equal."
2021g4,"Let $A B C D$ be a quadrilateral inscribed in a circle $\Omega$. Let the tangent to $\Omega$ at $D$ intersect the rays $B A$ and $B C$ at points $E$ and $F$, respectively. A point $T$ is chosen inside the triangle $A B C$ so that $T E \| C D$ and $T F \| A D$. Let $K \neq D$ be a point on the segment $D F$ such that $T D=T K$. Prove that the lines $A C, D T$ and $B K$ intersect at one point.","Let the segments $T E$ and $T F$ cross $A C$ at $P$ and $Q$, respectively. Since $P E \| C D$ and $E D$ is tangent to the circumcircle of $A B C D$, we have

$$
\angle E P A=\angle D C A=\angle E D A,
$$

and so the points $A, P, D$, and $E$ lie on some circle $\alpha$. Similarly, the points $C, Q, D$, and $F$ lie on some circle $\gamma$.

We now want to prove that the line $D T$ is tangent to both $\alpha$ and $\gamma$ at $D$. Indeed, since $\angle F C D+\angle E A D=180^{\circ}$, the circles $\alpha$ and $\gamma$ are tangent to each other at $D$. To prove that $T$ lies on their common tangent line at $D$ (i.e., on their radical axis), it suffices to check that $T P \cdot T E=T Q \cdot T F$, or that the quadrilateral $P E F Q$ is cyclic. This fact follows from

$$
\angle Q F E=\angle A D E=\angle A P E .
$$

Since $T D=T K$, we have $\angle T K D=\angle T D K$. Next, as $T D$ and $D E$ are tangent to $\alpha$ and $\Omega$, respectively, we obtain

$$
\angle T K D=\angle T D K=\angle E A D=\angle B D E,
$$

which implies $T K \| B D$.\\
Next we prove that the five points $T, P, Q, D$, and $K$ lie on some circle $\tau$. Indeed, since $T D$ is tangent to the circle $\alpha$ we have

$$
\angle E P D=\angle T D F=\angle T K D,
$$

which means that the point $P$ lies on the circle (TDK). Similarly, we have $Q \in(T D K)$.\\
Finally, we prove that $P K \| B C$. Indeed, using the circles $\tau$ and $\gamma$ we conclude that

$$
\angle P K D=\angle P Q D=\angle D F C,
$$

which means that $P K \| B C$.\\
Triangles $T P K$ and $D C B$ have pairwise parallel sides, which implies the fact that $T D, P C$ and $K B$ are concurrent, as desired.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_9f325c9d511f2c38a6b8g-49}

Comment 1. There are several variations of the above solution.\\
E.g., after finding circles $\alpha$ and $\gamma$, one can notice that there exists a homothety $h$ mapping the triangle $T P Q$ to the triangle $D C A$; the centre of that homothety is $Y=A C \cap T D$. Since

$$
\angle D P E=\angle D A E=\angle D C B=\angle D Q T
$$

the quadrilateral $T P D Q$ is inscribed in some circle $\tau$. We have $h(\tau)=\Omega$, so the point $D^{*}=h(D)$ lies on $\Omega$.

Finally, by

$$
\angle D C D^{*}=\angle T P D=\angle B A D
$$

the points $B$ and $D^{*}$ are symmetric with respect to the diameter of $\Omega$ passing through $D$. This yields $D B=D D^{*}$ and $B D^{*} \| E F$, so $h(K)=B$, and $B K$ passes through $Y$.
",1,"Let $A B C D$ be a quadrilateral inscribed in a circle $\Omega$. Let the tangent to $\Omega$ at $D$ intersect the rays $B A$ and $B C$ at points $E$ and $F$, respectively. A point $T$ is chosen inside the triangle $A B C$ so that $T E \| C D$ and $T F \| A D$. Let $K \neq D$ be a point on the segment $D F$ such that $T D=T K$. Prove that the lines $A C, D T$ and $B K$ intersect at one point.","Let the segments $T E$ and $T F$ cross $A C$ at $P$ and $Q$, respectively. Since $P E \| C D$ and $E D$ is tangent to the circumcircle of $A B C D$, we have

$$
\angle E P A=\angle D C A=\angle E D A,
$$

and so the points $A, P, D$, and $E$ lie on some circle $\alpha$. Similarly, the points $C, Q, D$, and $F$ lie on some circle $\gamma$.

We now want to prove that the line $D T$ is tangent to both $\alpha$ and $\gamma$ at $D$. Indeed, since $\angle F C D+\angle E A D=180^{\circ}$, the circles $\alpha$ and $\gamma$ are tangent to each other at $D$. To prove that $T$ lies on their common tangent line at $D$ (i.e., on their radical axis), it suffices to check that $T P \cdot T E=T Q \cdot T F$, or that the quadrilateral $P E F Q$ is cyclic. This fact follows from

$$
\angle Q F E=\angle A D E=\angle A P E .
$$

Since $T D=T K$, we have $\angle T K D=\angle T D K$. Next, as $T D$ and $D E$ are tangent to $\alpha$ and $\Omega$, respectively, we obtain

$$
\angle T K D=\angle T D K=\angle E A D=\angle B D E,
$$

which implies $T K \| B D$.\\
Next we prove that the five points $T, P, Q, D$, and $K$ lie on some circle $\tau$. Indeed, since $T D$ is tangent to the circle $\alpha$ we have

$$
\angle E P D=\angle T D F=\angle T K D,
$$

which means that the point $P$ lies on the circle (TDK). Similarly, we have $Q \in(T D K)$.\\
Finally, we prove that $P K \| B C$. Indeed, using the circles $\tau$ and $\gamma$ we conclude that

$$
\angle P K D=\angle P Q D=\angle D F C,
$$

which means that $P K \| B C$.\\
Triangles $T P K$ and $D C B$ have pairwise parallel sides, which implies the fact that $T D, P C$ and $K B$ are concurrent, as desired.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_9f325c9d511f2c38a6b8g-49}

Comment 1. There are several variations of the above solution.\\
E.g., after finding circles $\alpha$ and $\gamma$, one can notice that there exists a homothety $h$ mapping the triangle $T P Q$ to the triangle $D C A$; the centre of that homothety is $Y=A C \cap T D$. Since

$$
\angle D P E=\angle D A E=\angle D C B=\angle D Q T
$$

the quadrilateral $T P D Q$ is inscribed in some circle $\tau$. We have $h(\tau)=\Omega$, so the point $D^{*}=h(D)$ lies on $\Omega$.

Finally, by

$$
\angle D C D^{*}=\angle T P D=\angle B A D
$$

the points $B$ and $D^{*}$ are symmetric with respect to the diameter of $\Omega$ passing through $D$. This yields $D B=D D^{*}$ and $B D^{*} \| E F$, so $h(K)=B$, and $B K$ passes through $Y$.
",,,,,,
2021g5,"Let $A B C D$ be a cyclic quadrilateral whose sides have pairwise different lengths. Let $O$ be the circumcentre of $A B C D$. The internal angle bisectors of $\angle A B C$ and $\angle A D C$ meet $A C$ at $B_{1}$ and $D_{1}$, respectively. Let $O_{B}$ be the centre of the circle which passes through $B$ and is tangent to $A C$ at $D_{1}$. Similarly, let $O_{D}$ be the centre of the circle which passes through $D$ and is tangent to $A C$ at $B_{1}$.

Assume that $B D_{1} \| D B_{1}$. Prove that $O$ lies on the line $O_{B} O_{D}$.","Common remarks. We introduce some objects and establish some preliminary facts common for all solutions below.

Let $\Omega$ denote the circle $(A B C D)$, and let $\gamma_{B}$ and $\gamma_{D}$ denote the two circles from the problem statement (their centres are $O_{B}$ and $O_{D}$, respectively). Clearly, all three centres $O, O_{B}$, and $O_{D}$ are distinct.

Assume, without loss of generality, that $A B>B C$. Suppose that $A D>D C$, and let $H=A C \cap B D$. Then the rays $B B_{1}$ and $D D_{1}$ lie on one side of $B D$, as they contain the midpoints of the arcs $A D C$ and $A B C$, respectively. However, if $B D_{1} \| D B_{1}$, then $B_{1}$ and $D_{1}$ should be separated by $H$. This contradiction shows that $A D<C D$.

Let $\gamma_{B}$ and $\gamma_{D}$ meet $\Omega$ again at $T_{B}$ and $T_{D}$, respectively. The common chord $B T_{B}$ of $\Omega$ and $\gamma_{B}$ is perpendicular to their line of\\
\includegraphics[max width=\textwidth]{2025_04_29_9f325c9d511f2c38a6b8g-52} centres $O_{B} O$; likewise, $D T_{D} \perp O_{D} O$. Therefore, $O \in O_{B} O_{D} \Longleftrightarrow O_{B} O\left\|O_{D} O \Longleftrightarrow B T_{B}\right\|$ $D T_{D}$, and the problem reduces to showing that


\begin{equation*}
B T_{B} \| D T_{D} \tag{1}
\end{equation*}


Comment 1. It seems that the discussion of the positions of points is necessary for both Solutions below. However, this part automatically follows from the angle chasing in Comment 2.

Let the diagonals $A C$ and $B D$ cross at $H$. Consider the homothety $h$ centred at $H$ and mapping $B$ to $D$. Since $B D_{1} \| D B_{1}$, we have $h\left(D_{1}\right)=B_{1}$.

Let the tangents to $\Omega$ at $B$ and $D$ meet $A C$ at $L_{B}$ and $L_{D}$, respectively. We have

$$
\angle L_{B} B B_{1}=\angle L_{B} B C+\angle C B B_{1}=\angle B A L_{B}+\angle B_{1} B A=\angle B B_{1} L_{B}
$$

which means that the triangle $L_{B} B B_{1}$ is isosceles, $L_{B} B=L_{B} B_{1}$. The powers of $L_{B}$ with respect to $\Omega$ and $\gamma_{D}$ are $L_{B} B^{2}$ and $L_{B} B_{1}^{2}$, respectively; so they are equal, whence $L_{B}$ lies on the radical axis $T_{D} D$ of those two circles. Similarly, $L_{D}$ lies on the radical axis $T_{B} B$ of $\Omega$ and $\gamma_{B}$.

By the sine rule in the triangle $B H L_{B}$, we obtain


\begin{equation*}
\frac{H L_{B}}{\sin \angle H B L_{B}}=\frac{B L_{B}}{\sin \angle B H L_{B}}=\frac{B_{1} L_{B}}{\sin \angle B H L_{B}} \tag{2}
\end{equation*}


similarly,


\begin{equation*}
\frac{H L_{D}}{\sin \angle H D L_{D}}=\frac{D L_{D}}{\sin \angle D H L_{D}}=\frac{D_{1} L_{D}}{\sin \angle D H L_{D}} . \tag{3}
\end{equation*}


Clearly, $\angle B H L_{B}=\angle D H L_{D}$. In the circle $\Omega$, tangent lines $B L_{B}$ and $D L_{D}$ form equal angles with the chord $B D$, so $\sin \angle H B L_{B}=\sin \angle H D L_{D}$ (this equality does not depend on the picture). Thus, dividing (2) by (3) we get

$$
\frac{H L_{B}}{H L_{D}}=\frac{B_{1} L_{B}}{D_{1} L_{D}}, \quad \text { and hence } \quad \frac{H L_{B}}{H L_{D}}=\frac{H L_{B}-B_{1} L_{B}}{H L_{D}-D_{1} L_{D}}=\frac{H B_{1}}{H D_{1}}
$$

Since $h\left(D_{1}\right)=B_{1}$, the obtained relation yields $h\left(L_{D}\right)=L_{B}$, so $h$ maps the line $L_{D} B$ to $L_{B} D$, and these lines are parallel, as desired.\\",4,"Let $\Omega$ be the circumcircle of $ABCD$. Let $T_B$ be the second intersection of the circle $\gamma_B$ (with center $O_B$) and $\Omega$, and let $T_D$ be the second intersection of the circle $\gamma_D$ (with center $O_D$) and $\Omega$. Show that $O$ lies on the line $O_B O_D$ if and only if the chords $BT_B$ and $DT_D$ are parallel.","The line of centers of two intersecting circles is perpendicular to their common chord. The common chord of $\Omega$ and $\gamma_B$ is $BT_B$, so the line of centers $OO_B$ is perpendicular to $BT_B$. Similarly, the common chord of $\Omega$ and $\gamma_D$ is $DT_D$, so $OO_D \perp DT_D$. The points $O, O_B, O_D$ are collinear if and only if the lines $OO_B$ and $OO_D$ coincide. This occurs if and only if their respective perpendiculars through the fixed points $B$ and $D$, the lines $BT_B$ and $DT_D$, are parallel.","Let the tangents to the circumcircle $\Omega$ at points $B$ and $D$ meet the line $AC$ at points $L_B$ and $L_D$, respectively. Show that the line $BT_B$ is identical to the line $BL_D$, and the line $DT_D$ is identical to the line $DL_B$.","The line $BT_B$ is the radical axis of circles $\Omega$ and $\gamma_B$. The power of $L_D$ with respect to $\Omega$ is $L_D D^2$. The power of $L_D$ with respect to $\gamma_B$ is $L_D D_1^2$, since $\gamma_B$ is tangent to $AC$ at $D_1$. By an angle chase, $\angle L_D D D_1 = \angle L_D D C + \angle C D D_1 = \angle DAC + \angle AD D_1 = \angle D D_1 A$, so triangle $L_D D D_1$ is isosceles with $L_D D = L_D D_1$. Thus, $L_D$ has equal power with respect to both circles and lies on their radical axis, $BT_B$. So the line $BT_B$ is $BL_D$. Similarly, triangle $L_B B B_1$ is isosceles with $L_B B = L_B B_1$, so $L_B$ lies on the radical axis $DT_D$ of $\Omega$ and $\gamma_D$. Thus, the line $DT_D$ is $DL_B$.","Let $H = AC \cap BD$. The condition $BD_1 \parallel DB_1$ implies the existence of a homothety $h$ centered at $H$ that maps point $B$ to $D$ and $D_1$ to $B_1$. Show that this homothety also maps $L_D$ to $L_B$, where $L_B, L_D$ are the intersections of the tangents to the circumcircle at $B, D$ with line $AC$.","We need to show $H, L_D, L_B$ are collinear and $HL_B/HL_D = HD/HB$. Collinearity is given since they lie on $AC$. By the sine rule in $\triangle BHL_B$ and $\triangle DHL_D$, and using $B_1L_B = BL_B$ and $D_1L_D = DL_D$, we get $\frac{HL_B}{B_1 L_B} = \frac{\sin\angle HBL_B}{\sin\angle BHL_B}$ and $\frac{HL_D}{D_1 L_D} = \frac{\sin\angle HDL_D}{\sin\angle DHL_D}$. Since $\angle BHL_B = \angle DHL_D$ and $\sin\angle HBL_B = \sin\angle HDL_D$ (angles between a chord and tangents at its endpoints are supplementary), we get $\frac{HL_B}{HL_D} = \frac{B_1 L_B}{D_1 L_D} = \frac{HL_B - B_1 L_B}{HL_D - D_1 L_D} = \frac{HB_1}{HD_1}$. From the homothety, $\frac{HB_1}{HD_1} = \frac{HD}{HB}$. Therefore, $\frac{HL_B}{HL_D} = \frac{HD}{HB}$, which implies $h(L_D) = L_B$.","Let $A B C D$ be a cyclic quadrilateral whose sides have pairwise different lengths. Let $O$ be the circumcentre of $A B C D$. The internal angle bisectors of $\angle A B C$ and $\angle A D C$ meet $A C$ at $B_{1}$ and $D_{1}$, respectively. Let $O_{B}$ be the centre of the circle which passes through $B$ and is tangent to $A C$ at $D_{1}$. Similarly, let $O_{D}$ be the centre of the circle which passes through $D$ and is tangent to $A C$ at $B_{1}$. Assume that $B D_{1} \| D B_{1}$. Prove that $O$ lies on the line $O_{B} O_{D}$.","From Sub-problem 1, the goal is to prove $BT_B \parallel DT_D$. From Sub-problem 2, this is equivalent to proving $BL_D \parallel DL_B$. Let $H = AC \cap BD$. The condition $BD_1 \parallel DB_1$ implies a homothety $h$ centered at $H$ maps $B \to D$. From Sub-problem 3, this homothety also maps $L_D \to L_B$. A homothety maps a line to a parallel line. Therefore, $h$ maps the line passing through $B$ and $L_D$ to the line passing through their images, $D$ and $L_B$. This means line $BL_D$ is parallel to line $DL_B$, which completes the proof."
2021g7,"A point $D$ is chosen inside an acute-angled triangle $A B C$ with $A B>A C$ so that $\angle B A D=\angle D A C$. A point $E$ is constructed on the segment $A C$ so that $\angle A D E=\angle D C B$. Similarly, a point $F$ is constructed on the segment $A B$ so that $\angle A D F=\angle D B C$. A point $X$ is chosen on the line $A C$ so that $C X=B X$. Let $O_{1}$ and $O_{2}$ be the circumcentres of the triangles $A D C$ and $D X E$. Prove that the lines $B C, E F$, and $O_{1} O_{2}$ are concurrent.","Common remarks. Let $Q$ be the isogonal conjugate of $D$ with respect to the triangle $A B C$. Since $\angle B A D=\angle D A C$, the point $Q$ lies on $A D$. Then $\angle Q B A=\angle D B C=\angle F D A$, so the points $Q, D, F$, and $B$ are concyclic. Analogously, the points $Q, D, E$, and $C$ are concyclic. Thus $A F \cdot A B=A D \cdot A Q=A E \cdot A C$ and so the points $B, F, E$, and $C$ are also concyclic.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_9f325c9d511f2c38a6b8g-60}

Let $T$ be the intersection of $B C$ and $F E$.\\
Claim. $T D^{2}=T B \cdot T C=T F \cdot T E$.\\
Proof. We will prove that the circles $(D E F)$ and $(B D C)$ are tangent to each other. Indeed, using the above arguments, we get

$$
\begin{gathered}
\angle B D F=\angle A F D-\angle A B D=\left(180^{\circ}-\angle F A D-\angle F D A\right)-(\angle A B C-\angle D B C) \\
=180^{\circ}-\angle F A D-\angle A B C=180^{\circ}-\angle D A E-\angle F E A=\angle F E D+\angle A D E=\angle F E D+\angle D C B,
\end{gathered}
$$

which implies the desired tangency.\\
Since the points $B, C, E$, and $F$ are concyclic, the powers of the point $T$ with respect to the circles $(B D C)$ and $(E D F)$ are equal. So their radical axis, which coincides with the common tangent at $D$, passes through $T$, and hence $T D^{2}=T E \cdot T F=T B \cdot T C$.

Let $T A$ intersect the circle $(A B C)$ again at $M$. Due to the circles ( $B C E F$ ) and $(A M C B)$, and using the above Claim, we get $T M \cdot T A=T F \cdot T E=T B \cdot T C=T D^{2}$; in particular, the points $A, M, E$, and $F$ are concyclic.

Under the inversion with centre $T$ and radius $T D$, the point $M$ maps to $A$, and $B$ maps to $C$, which implies that the circle ( $M B D$ ) maps to the circle ( $A D C$ ). Their common point $D$ lies on the circle of the inversion, so the second intersection point $K$ also lies on that circle, which means $T K=T D$. It follows that the point $T$ and the centres of the circles ( $K D E$ ) and $(A D C)$ lie on the perpendicular bisector of $K D$.

Since the center of $(A D C)$ is $O_{1}$, it suffices to show now that the points $D, K, E$, and $X$ are concyclic (the center of the corresponding circle will be $O_{2}$ ).

The lines $B M, D K$, and $A C$ are the pairwise radical axes of the circles ( $A B C M$ ), $(A C D K)$ and ( $B M D K$ ), so they are concurrent at some point $P$. Also, $M$ lies on the circle ( $A E F$ ), thus

$$
\begin{aligned}
\Varangle(E X, X B) & =\Varangle(C X, X B)=\Varangle(X C, B C)+\Varangle(B C, B X)=2 \Varangle(A C, C B) \\
& =\Varangle(A C, C B)+\Varangle(E F, F A)=\Varangle(A M, B M)+\Varangle(E M, M A)=\Varangle(E M, B M),
\end{aligned}
$$

so the points $M, E, X$, and $B$ are concyclic. Therefore, $P E \cdot P X=P M \cdot P B=P K \cdot P D$, so the points $E, K, D$, and $X$ are concyclic, as desired.\\",4,"Prove that the points B, C, E, and F are concyclic.","Let Q be the isogonal conjugate of D with respect to ΔABC. Since AD bisects ∠BAC, Q lies on line AD. By definition, ∠QBA = ∠DBC and ∠QCA = ∠DCB. Given ∠ADF = ∠DBC and ∠ADE = ∠DCB, we have ∠QBA = ∠ADF and ∠QCA = ∠ADE. These equalities imply that quadrilaterals QBDF and QCED are cyclic. By applying the power of a point theorem to point A with respect to the circumcircles of these quadrilaterals, we get AF⋅AB = AQ⋅AD and AE⋅AC = AQ⋅AD. Thus, AF⋅AB = AE⋅AC, which proves that B, C, E, and F are concyclic.","Let T be the intersection of lines BC and EF. Prove that TD is tangent to the circumcircles of ΔBDC and ΔEDF, and as a consequence, $TD^2 = TB \cdot TC$.","From Sub-problem 1, points B, C, E, F are concyclic. As T is the intersection of secants BC and EF, the power of T with respect to the circle (BCEF) gives $TB \cdot TC = TE \cdot TF$. It can be shown through angle chasing that the circumcircles of ΔBDC and ΔEDF are tangent at D. Their radical axis is therefore their common tangent line at D. Since T has equal power with respect to these two circles, T must lie on their radical axis. Thus, TD is this common tangent, and by the tangent-secant theorem, $TD^2 = TB \cdot TC$.","Let T be the intersection of BC and EF, and let K be the second point of intersection of the circumcircles of ΔADC and ΔMBD, where M is the second intersection of line TA with the circumcircle of ΔABC. Prove that the points D, K, E, and X are concyclic.","The power of T with respect to the circumcircle of ΔABC gives $TM \cdot TA = TB \cdot TC$. From Sub-problem 2, $TD^2 = TB \cdot TC$, so $TM \cdot TA = TD^2$. The lines BM, DK, and AC are the radical axes of the circles (ABCM), (ACDK), and (BMDK) taken pairwise; thus, they concur at a point P. By angle chasing, it can be shown that M, E, X, B are concyclic. The power of P with respect to the circle (BMDK) gives $PK \cdot PD = PM \cdot PB$, and its power with respect to the circle (MEXB) gives $PE \cdot PX = PM \cdot PB$. Equating these gives $PK \cdot PD = PE \cdot PX$, which proves that D, K, E, X are concyclic.","A point $D$ is chosen inside an acute-angled triangle $A B C$ with $A B>A C$ so that $\angle B A D=\angle D A C$. A point $E$ is constructed on the segment $A C$ so that $\angle A D E=\angle D C B$. Similarly, a point $F$ is constructed on the segment $A B$ so that $\angle A D F=\angle D B C$. A point $X$ is chosen on the line $A C$ so that $C X=B X$. Let $O_{1}$ and $O_{2}$ be the circumcentres of the triangles $A D C$ and $D X E$. Prove that the lines $B C, E F$, and $O_{1} O_{2}$ are concurrent.","Let T be the intersection of BC and EF. We need to show that T, $O_1$, and $O_2$ are collinear. In the proof of Sub-problem 3, we established $TM \cdot TA = TD^2$. This means an inversion with center T and radius TD maps M to A and B to C. This inversion maps the circumcircle of ΔMBD to the circumcircle of ΔADC. Since D is on the circle of inversion, it is a fixed point. The other intersection point of the two circles, K, must also be a fixed point of the inversion, so TK = TD. This implies T lies on the perpendicular bisector of segment KD. The point $O_1$, as the circumcenter of ΔADC which contains D and K, also lies on this bisector. From Sub-problem 3, D, K, E, X are concyclic, so the circle (DXE) is the same as (DXKE). Its center, $O_2$, must also lie on the perpendicular bisector of KD. Since T, $O_1$, and $O_2$ are all on the perpendicular bisector of KD, they are collinear. Therefore, the lines BC, EF, and $O_1O_2$ are concurrent at T."
2021g8,"Let $\omega$ be the circumcircle of a triangle $A B C$, and let $\Omega_{A}$ be its excircle which is tangent to the segment $B C$. Let $X$ and $Y$ be the intersection points of $\omega$ and $\Omega_{A}$. Let $P$ and $Q$ be the projections of $A$ onto the tangent lines to $\Omega_{A}$ at $X$ and $Y$, respectively. The tangent line at $P$ to the circumcircle of the triangle $A P X$ intersects the tangent line at $Q$ to the circumcircle of the triangle $A Q Y$ at a point $R$. Prove that $A R \perp B C$.","Let $D$ be the point of tangency of $B C$ and $\Omega_{A}$. Let $D^{\prime}$ be the point such that $D D^{\prime}$ is a diameter of $\Omega_{A}$. Let $R^{\prime}$ be (the unique) point such that $A R^{\prime} \perp B C$ and $R^{\prime} D^{\prime} \| B C$. We shall prove that $R^{\prime}$ coincides with $R$.

Let $P X$ intersect $A B$ and $D^{\prime} R^{\prime}$ at $S$ and $T$, respectively. Let $U$ be the ideal common point of the parallel lines $B C$ and $D^{\prime} R^{\prime}$. Note that the (degenerate) hexagon $A S X T U C$ is circumscribed around $\Omega_{A}$, hence by the Brianchon theorem $A T, S U$, and $X C$ concur at a point which we denote by $V$. Then $V S \| B C$. It follows that $\Varangle(S V, V X)=\Varangle(B C, C X)=$ $\Varangle(B A, A X)$, hence $A X S V$ is cyclic. Therefore, $\Varangle(P X, X A)=\Varangle(S V, V A)=\Varangle\left(R^{\prime} T, T A\right)$. Since $\angle A P T=\angle A R^{\prime} T=90^{\circ}$, the quadrilateral $A P R^{\prime} T$ is cyclic. Hence,

$$
\Varangle(X A, A P)=90^{\circ}-\Varangle(P X, X A)=90^{\circ}-\Varangle\left(R^{\prime} T, T A\right)=\Varangle\left(T A, A R^{\prime}\right)=\Varangle\left(T P, P R^{\prime}\right)
$$

It follows that $P R^{\prime}$ is tangent to the circle $(A P X)$.\\
Analogous argument shows that $Q R^{\prime}$ is tangent to the circle $(A Q Y)$. Therefore, $R=R^{\prime}$ and $A R \perp B C$.\\",2,"Let $D$ be the tangency point of the excircle $\Omega_A$ with side $BC$, and let $DD'$ be a diameter of $\Omega_A$. Define a point $R'$ such that $AR' \perp BC$ and $R'D' \parallel BC$. Prove that the line $PR'$ is tangent to the circumcircle of triangle $APX$ at point $P$.","Let $T = PX \cap D'R'$. Since $P$ is the projection of $A$ on $PX$, and by definition of $R'$, $AR' \perp D'R'$, we have $\angle APT = \angle AR'T = 90^\circ$. Thus, the quadrilateral $APR'T$ is cyclic. Let $S = PX \cap AB$. Let $U$ be the point at infinity on the line $BC$. By applying Brianchon's theorem to the degenerate hexagon $ASXTCU$ circumscribed about $\Omega_A$, the diagonals $AT, SU, XC$ concur at a point $V$. The line $SU$ must be parallel to $BC$. This concurrency implies that $A,X,S,V$ are concyclic, since $\angle(SV,VX) = \angle(BC,CX) = \angle(BA,AX)$. From the cyclicity of $AXSV$, we have $\angle(PX,XA) = \angle(SV,VA) = \angle(R'T,TA)$. From the cyclicity of $APR'T$, we have $\angle(R'T,TA) = \angle(R'P,PA)$. Thus, $\angle(PX,XA) = \angle(R'P,PA)$, which is the condition for $PR'$ to be tangent to the circumcircle of $\triangle APX$ at $P$.","Let $\omega$ be the circumcircle of a triangle $A B C$, and let $\Omega_{A}$ be its excircle which is tangent to the segment $B C$. Let $X$ and $Y$ be the intersection points of $\omega$ and $\Omega_{A}$. Let $P$ and $Q$ be the projections of $A$ onto the tangent lines to $\Omega_{A}$ at $X$ and $Y$, respectively. The tangent line at $P$ to the circumcircle of the triangle $A P X$ intersects the tangent line at $Q$ to the circumcircle of the triangle $A Q Y$ at a point $R$. Prove that $A R \perp B C$.","Let $D$ be the tangency point of $\Omega_A$ with $BC$, and $DD'$ be a diameter of $\Omega_A$. Define a point $R'$ such that $AR' \perp BC$ and $R'D' \parallel BC$. From the first sub-problem, we know that $PR'$ is tangent to the circumcircle of $\triangle APX$ at $P$. The geometric configuration for points $Y$ and $Q$ is symmetric to that for $X$ and $P$. Thus, by an identical argument, the line $QR'$ is tangent to the circumcircle of $\triangle AQY$ at $Q$. By definition, the point $R$ is the intersection of these two tangent lines. Therefore, $R$ must be the same point as $R'$. Since $R=R'$, and $R'$ was constructed such that $AR' \perp BC$, we conclude that $AR \perp BC$.",,,,
2021n2,"Let $n \geqslant 100$ be an integer. The numbers $n, n+1, \ldots, 2 n$ are written on $n+1$ cards, one number per card. The cards are shuffled and divided into two piles. Prove that one of the piles contains two cards such that the sum of their numbers is a perfect square.","Solution. To solve the problem it suffices to find three squares and three cards with numbers $a, b, c$ on them such that pairwise sums $a+b, b+c, a+c$ are equal to the chosen squares. By choosing the three consecutive squares $(2 k-1)^{2},(2 k)^{2},(2 k+1)^{2}$ we arrive at the triple

$$
(a, b, c)=\left(2 k^{2}-4 k, \quad 2 k^{2}+1, \quad 2 k^{2}+4 k\right)
$$

We need a value for $k$ such that

$$
n \leqslant 2 k^{2}-4 k, \quad \text { and } \quad 2 k^{2}+4 k \leqslant 2 n
$$

A concrete $k$ is suitable for all $n$ with

$$
n \in\left[k^{2}+2 k, 2 k^{2}-4 k+1\right]=: I_{k} .
$$

For $k \geqslant 9$ the intervals $I_{k}$ and $I_{k+1}$ overlap because

$$
(k+1)^{2}+2(k+1) \leqslant 2 k^{2}-4 k+1
$$

Hence $I_{9} \cup I_{10} \cup \ldots=[99, \infty)$, which proves the statement for $n \geqslant 99$.\\
Comment 1. There exist approaches which only work for sufficiently large $n$.\\
One possible approach is to consider three cards with numbers $70 k^{2}, 99 k^{2}, 126 k^{2}$ on them. Then their pairwise sums are perfect squares and so it suffices to find $k$ such that $70 k^{2} \geqslant n$ and $126 k^{2} \leqslant 2 n$ which exists for sufficiently large $n$.

Another approach is to prove, arguing by contradiction, that $a$ and $a-2$ are in the same pile provided that $n$ is large enough and $a$ is sufficiently close to $n$. For that purpose, note that every pair of neighbouring numbers in the sequence $a, x^{2}-a, a+(2 x+1), x^{2}+2 x+3-a, a-2$ adds up to a perfect square for any $x$; so by choosing $x=\lfloor\sqrt{2 a}\rfloor+1$ and assuming that $n$ is large enough we conclude that $a$ and $a-2$ are in the same pile for any $a \in[n+2,3 n / 2]$. This gives a contradiction since it is easy to find two numbers from $[n+2,3 n / 2]$ of the same parity which sum to a square.

It then remains to separately cover the cases of small $n$ which appears to be quite technical.\\
Comment 2. An alternative formulation for this problem could ask for a proof of the statement for all $n>10^{6}$. An advantage of this formulation is that some solutions, e.g. those mentioned in Comment 1 need not contain a technical part which deals with the cases of small $n$. However, the original formulation seems to be better because the bound it gives for $n$ is almost sharp, see the next comment for details.

Comment 3. The statement of the problem is false for $n=98$. As a counterexample, the first pile may contain the even numbers from 98 to 126 , the odd numbers from 129 to 161 , and the even numbers from 162 to 196 .",3,"Find a parametric form for three distinct integers $a, b, c$ such that the pairwise sums $a+b$, $b+c$, and $c+a$ are all perfect squares.","Let the pairwise sums be three consecutive squares for some integer $k$: $a+b=(2k-1)^2$, $c+a=(2k)^2$, and $b+c=(2k+1)^2$. Solving this system of linear equations for $a, b, c$ yields the parametric triple $(a, b, c) = (2k^2-4k, 2k^2+1, 2k^2+4k)$.","For any integer $n \ge 100$, prove that there exists an integer $k$ such that the three numbers $a=2k^2-4k$, $b=2k^2+1$, and $c=2k^2+4k$ are all contained in the set of integers $\{n, n+1, \ldots, 2n\}$.","We need to find an integer $k$ such that $n \le a$ and $c \le 2n$. This is equivalent to $n \le 2k^2-4k$ and $2k^2+4k \le 2n$, which means $n$ must lie in the interval $I_k = [k^2+2k, 2k^2-4k]$. For $k \ge 9$, the intervals $I_k$ and $I_{k+1}$ overlap. The union of these intervals, $\bigcup_{k=9}^{\\infty} I_k$, covers the interval $[99, \\infty)$. Therefore, for any $n \\ge 100$, there exists such a $k$, which ensures $a,b,c$ are in the range $[n, 2n]$.","Let $n \\geqslant 100$ be an integer. The numbers $n, n+1, \\ldots, 2 n$ are written on $n+1$ cards, one number per card. The cards are shuffled and divided into two piles. Prove that one of the piles contains two cards such that the sum of their numbers is a perfect square.","For any $n \ge 100$, we have shown there exist three distinct numbers $a, b, c$ in the set $\{n, \ldots, 2n\}$ such that $a+b$, $b+c$, and $c+a$ are all perfect squares. These three numbers correspond to three distinct cards. When these three cards are distributed into two piles, by the Pigeonhole Principle, at least two of them must be in the same pile. The sum of the numbers on these two cards is a perfect square.",,
2021n5,"Prove that there are only finitely many quadruples $(a, b, c, n)$ of positive integers such that

$$
n!=a^{n-1}+b^{n-1}+c^{n-1}
$$","Solution. For fixed $n$ there are clearly finitely many solutions; we will show that there is no solution with $n>100$. So, assume $n>100$. By the AM-GM inequality,

$$
\begin{aligned}
n! & =2 n(n-1)(n-2)(n-3) \cdot(3 \cdot 4 \cdots(n-4)) \\
& \leqslant 2(n-1)^{4}\left(\frac{3+\cdots+(n-4)}{n-6}\right)^{n-6}=2(n-1)^{4}\left(\frac{n-1}{2}\right)^{n-6}<\left(\frac{n-1}{2}\right)^{n-1}
\end{aligned}
$$

thus $a, b, c<(n-1) / 2$.\\
For every prime $p$ and integer $m \neq 0$, let $\nu_{p}(m)$ denote the $p$-adic valuation of $m$; that is, the greatest non-negative integer $k$ for which $p^{k}$ divides $m$. Legendre's formula states that

$$
\nu_{p}(n!)=\sum_{s=1}^{\infty}\left\lfloor\frac{n}{p^{s}}\right\rfloor
$$

and a well-know corollary of this formula is that


\begin{equation*}
\nu_{p}(n!)<\sum_{s=1}^{\infty} \frac{n}{p^{s}}=\frac{n}{p-1} \tag{$\diamond$}
\end{equation*}


If $n$ is odd then $a^{n-1}, b^{n-1}, c^{n-1}$ are squares, and by considering them modulo 4 we conclude that $a, b$ and $c$ must be even. Hence, $2^{n-1} \mid n$ ! but that is impossible for odd $n$ because $\nu_{2}(n!)=\nu_{2}((n-1)!)<n-1$ by $(\Omega)$.

From now on we assume that $n$ is even. If all three numbers $a+b, b+c, c+a$ are powers of 2 then $a, b, c$ have the same parity. If they all are odd, then $n!=a^{n-1}+b^{n-1}+c^{n-1}$ is also odd which is absurd. If all $a, b, c$ are divisible by 4 , this contradicts $\nu_{2}(n!) \leqslant n-1$. If, say, $a$ is not divisible by 4 , then $2 a=(a+b)+(a+c)-(b+c)$ is not divisible by 8 , and since all $a+b, b+c$, $c+a$ are powers of 2 , we get that one of these sums equals 4 , so two of the numbers of $a, b, c$ are equal to 2. Say, $a=b=2$, then $c=2^{r}-2$ and, since $c \mid n$ !, we must have $c \mid a^{n-1}+b^{n-1}=2^{n}$ implying $r=2$, and so $c=2$, which is impossible because $n!\equiv 0 \not \equiv 3 \cdot 2^{n-1}(\bmod 5)$.

So now we assume that the sum of two numbers among $a, b, c$, say $a+b$, is not a power of 2 , so it is divisible by some odd prime $p$. Then $p \leqslant a+b<n$ and so $c^{n-1}=n!-\left(a^{n-1}+b^{n-1}\right)$ is divisible by $p$. If $p$ divides $a$ and $b$, we get $p^{n-1} \mid n!$, contradicting ( () . Next, using ( $\varnothing$ ) and the Lifting the Exponent Lemma we get


\begin{equation*}
\nu_{p}(1)+\nu_{p}(2)+\cdots+\nu_{p}(n)=\nu_{p}(n!)=\nu_{p}\left(n!-c^{n-1}\right)=\nu_{p}\left(a^{n-1}+b^{n-1}\right)=\nu_{p}(a+b)+\nu_{p}(n-1) \tag{$\diamond$}
\end{equation*}


In view of $(\diamond)$, no number of $1,2, \ldots, n$ can be divisible by $p$, except $a+b$ and $n-1>a+b$. On the other hand, $p \mid c$ implies that $p<n / 2$ and so there must be at least two such numbers. Hence, there are two multiples of $p$ among $1,2, \ldots, n$, namely $a+b=p$ and $n-1=2 p$. But this is another contradiction because $n-1$ is odd. This final contradiction shows that there is no solution of the equation for $n>100$.

Comment 1. The original version of the problem asked to find all solutions to the equation. The solution to that version is not much different but is more technical.

Comment 2. To find all solutions we can replace the bound $a, b, c<(n-1) / 2$ for all $n$ with a weaker bound $a, b, c \leqslant n / 2$ only for even $n$, which is a trivial application of AM-GM to the tuple $(2,3, \ldots, n)$. Then we may use the same argument for odd $n$ (it works for $n \geqslant 5$ and does not require any bound on $a, b, c$ ), and for even $n$ the same solution works for $n \geqslant 6$ unless we have $a+b=n-1$ and $2 \nu_{p}(n-1)=\nu_{p}(n!)$. This is only possible for $p=3$ and $n=10$ in which case we can consider the original equation modulo 7 to deduce that $7 \mid a b c$ which contradicts the fact that $7^{9}>10$ !. Looking at $n \leqslant 4$ we find four solutions, namely,

$$
(a, b, c, n)=(1,1,2,3),(1,2,1,3),(2,1,1,3),(2,2,2,4)
$$

Comment 3. For sufficiently large $n$, the inequality $a, b, c<(n-1) / 2$ also follows from Stirling's formula.",4,"For a solution $(a, b, c, n)$ with $n > 100$, prove that $a, b, c < (n-1)/2$.","For $n > 100$, one can establish the inequality $n! < \\left(\frac{n-1}{2}\right)^{n-1}$. From the given equation, $a^{n-1} < a^{n-1} + b^{n-1} + c^{n-1} = n!$. Therefore, $a^{n-1} < \\left(\frac{n-1}{2}\right)^{n-1}$, which implies $a < \frac{n-1}{2}$. The same reasoning applies to $b$ and $c$.","Prove that there are no solutions $(a, b, c, n)$ for any odd integer $n \\ge 5$.","Let $n \\ge 5$ be an odd integer. Then $n-1$ is even, so $a^{n-1}, b^{n-1}, c^{n-1}$ are perfect squares. For $n \\ge 4$, $n! \\equiv 0 \\pmod 4$. The equation modulo 4 implies $a, b, c$ must all be even. Consequently, $a^{n-1}+b^{n-1}+c^{n-1}$ is divisible by $2^{n-1}$, so $\nu_2(n!) \\ge n-1$. However, by Legendre's formula, for odd $n$, $\nu_2(n!) = \nu_2((n-1)!) = \\sum_{k=1}^{\\infty} \\lfloor \frac{n-1}{2^k} \rfloor < \\sum_{k=1}^{\\infty} \frac{n-1}{2^k} = n-1$. This contradiction shows there are no solutions for odd $n \\ge 5$.","Assume $n > 100$ is an even integer and some sum, say $a+b$, is not a power of 2. Let $p$ be an odd prime divisor of $a+b$. Prove that $\nu_p(n!) = \nu_p(a+b) + \nu_p(n-1)$.","Let $p$ be an odd prime divisor of $a+b$. From sub-problem 1, $p \\le a+b < n-1$. Since $p | (a+b)$ and $n-1$ is odd, $p | (a^{n-1}+b^{n-1})$. From the main equation, this means $p | (n! - c^{n-1})$. As $p<n$, $p|n!$, so $p|c$. If $p|a$, then $p|b$, implying $p^{n-1}|n!$, a contradiction since $\nu_p(n!) < n/(p-1) < n-1$. So $p \nmid a, p \nmid b$. Since $p|c$, $\nu_p(c^{n-1}) > \nu_p(n!)$, which implies $\nu_p(n!) = \nu_p(n!-c^{n-1}) = \nu_p(a^{n-1}+b^{n-1})$. By the Lifting The Exponent Lemma, $\nu_p(a^{n-1}+b^{n-1}) = \nu_p(a+b)+\nu_p(n-1)$. Thus, $\nu_p(n!) = \nu_p(a+b)+\nu_p(n-1)$.","Prove that there are only finitely many quadruples $(a, b, c, n)$ of positive integers such that $n!=a^{n-1}+b^{n-1}+c^{n-1}$.","For a fixed $n$, there are finitely many solutions. We show there are no solutions for $n>100$. By sub-problem 2, there are no solutions for odd $n>100$. Assume $n>100$ is even. If any sum, e.g., $a+b$, has an odd prime factor $p$, sub-problem 3 gives $\nu_p(n!) = \nu_p(a+b) + \nu_p(n-1)$. This implies that the only multiples of $p$ in $\{1, \\dots, n\}$ are $a+b$ and $n-1$. However, as $p|c$ and $c < (n-1)/2$, both $p$ and $2p$ are in $\{1, \\dots, n\}$. This forces $a+b=p$ and $n-1=2p$, a contradiction as $n-1$ is odd. If $a+b, b+c, c+a$ are all powers of 2, a separate analysis shows this case only has solutions for small $n$. Thus, there are no solutions for large $n$, so the total number of solutions is finite."
2021n7,"Let $a_{1}, a_{2}, a_{3}, \ldots$ be an infinite sequence of positive integers such that $a_{n+2 m}$ divides $a_{n}+a_{n+m}$ for all positive integers $n$ and $m$. Prove that this sequence is eventually periodic, i.e. there exist positive integers $N$ and $d$ such that $a_{n}=a_{n+d}$ for all $n>N$.","Solution. We will make repeated use of the following simple observation:\\
Lemma 1. If a positive integer $d$ divides $a_{n}$ and $a_{n-m}$ for some $m$ and $n>2 m$, it also divides $a_{n-2 m}$. If $d$ divides $a_{n}$ and $a_{n-2 m}$, it also divides $a_{n-m}$.\\
Proof. Both parts are obvious since $a_{n}$ divides $a_{n-2 m}+a_{n-m}$.\\
Claim. The sequence $\left(a_{n}\right)$ is bounded.\\
Proof. Suppose the contrary. Then there exist infinitely many indices $n$ such that $a_{n}$ is greater than each of the previous terms $a_{1}, a_{2}, \ldots, a_{n-1}$. Let $a_{n}=k$ be such a term, $n>10$. For each $s<\frac{n}{2}$ the number $a_{n}=k$ divides $a_{n-s}+a_{n-2 s}<2 k$, therefore

$$
a_{n-s}+a_{n-2 s}=k
$$

In particular,

$$
a_{n}=a_{n-1}+a_{n-2}=a_{n-2}+a_{n-4}=a_{n-4}+a_{n-8}
$$

that is, $a_{n-1}=a_{n-4}$ and $a_{n-2}=a_{n-8}$. It follows from Lemma 1 that $a_{n-1}$ divides $a_{n-1-3 s}$ for $3 s<n-1$ and $a_{n-2}$ divides $a_{n-2-6 s}$ for $6 s<n-2$. Since at least one of the numbers $a_{n-1}$ and $a_{n-2}$ is at least $a_{n} / 2$, so is some $a_{i}$ with $i \leqslant 6$. However, $a_{n}$ can be arbitrarily large, a contradiction.

Since $\left(a_{n}\right)$ is bounded, there exist only finitely many $i$ for which $a_{i}$ appears in the sequence finitely many times. In other words, there exists $N$ such that if $a_{i}=t$ and $i>N$, then $a_{j}=t$ for infinitely many $j$.

Clearly the sequence $\left(a_{n+N}\right)_{n>0}$ satisfies the divisibility condition, and it is enough to prove that this sequence is eventually periodic. Thus truncating the sequence if necessary, we can assume that each number appears infinitely many times in the sequence. Let $k$ be the maximum number appearing in the sequence.\\
Lemma 2. If a positive integer $d$ divides $a_{n}$ for some $n$, then the numbers $i$ such that $d$ divides $a_{i}$ form an arithmetical progression with an odd difference.\\
Proof. Let $i_{1}<i_{2}<i_{3}<\ldots$ be all the indices $i$ such that $d$ divides $a_{i}$. If $i_{s}+i_{s+1}$ is even, it follows from Lemma 1 that $d$ also divides $\frac{a_{i_{s}+i_{s+1}}^{2}}{2}$, impossible since $i_{s}<\frac{i_{s}+i_{s+1}}{2}<i_{s+1}$. Thus $i_{s}$ and $i_{s+1}$ are always of different parity, and therefore $i_{s}+i_{s+2}$ is even. Applying Lemma 1 again, we see that $d$ divides $a_{\frac{i_{s}+i_{s+2}}{2}}$, hence $\frac{i_{s}+i_{s+2}}{2}=i_{s+1}$,

We are ready now to solve the problem.\\
The number of positive divisors of all terms of the progression is finite. Let $d_{s}$ be the difference of the progression corresponding to $s$, that is, $s$ divides $a_{n}$ if and only if it divides $a_{n+t d_{s}}$ for any positive integer $t$. Let $D$ be the product of all $d_{s}$. Then each $s$ dividing a term of the progression divides $a_{n}$ if and only if it divides $a_{n+D}$. This means that the sets of divisors of $a_{n}$ and $a_{n+D}$ coincide, and $a_{n+D}=a_{n}$. Thus $D$ is a period of the sequence.

Comment. In the above solution we did not try to find the exact structure of the periodic part of $\left(a_{n}\right)$. A little addition to the argument above shows that the period of the sequence has one of the following three forms:\\
(i) $t$ (in this case the sequence is eventually constant);\\
(ii) $t, 2 t, 3 t$ or $2 t, t, 3 t$ (so the period is 3 );\\
(iii) $t, t, \ldots, 2 t$ (the period can be any odd number).

In these three cases $t$ can be any positive integer. It is easy to see that all three cases satisfy the original condition.

We again denote by $k$ be the maximum number appearing in the sequence. All the indices $i$ such that $a_{i}=k$ form an arithmetical progression. If the difference of this progression is 1 , the sequence $\left(a_{n}\right)$ is constant, and we get the case (i). Assume that the difference $T$ is at least 3 .

Take an index $n$ such that $a_{n}=k$ and let $a=a_{n-2}, b=a_{n-1}$. We have $a, b<k$ and therefore $k=a_{n}=a_{n-1}+a_{n-2}=a+b$. If $a=b=\frac{k}{2}$, then all the terms $a_{1}, a_{2}, \ldots, a_{n}$ are divisible by $k / 2$, that is, are equal to $k$ or $k / 2$. Since the indices $i$ such that $a_{i}=k$ form an arithmetical progression with odd diference, we get the case (iii).

Suppose now that $a \neq b$.\\
Claim. For $\frac{n}{2}<m<n$ we have $a_{m}=a$ if $m \equiv n-2(\bmod 3)$ and $a_{m}=b$ if $m \equiv n-1(\bmod 3)$.\\
Proof. The number $k=a_{n}$ divides $a_{n-2}+a_{n-1}=a+b$ and $a_{n-4}+a_{n-2}=a_{n-4}+a$ and is therefore equal to these sums (since $a, b<k$ and $a_{i} \leqslant k$ for all $i$. Therefore $a_{n-1}=a_{n-4}=b$, that is, $a_{n-4}<k$, $a_{n-4}+a_{n-8}=k$ and $a_{n-8}=a_{n-2}=a$. One of the numbers $a$ and $b$ is greater than $k / 2$.

If $b=a_{n-1}=a_{n-4}>\frac{k}{2}$, it follows from Lemma 1 that $a_{n-1}$ divides $a_{n-1-3 s}$ when $3 s<n-1$, and therefore $a_{n-1-3 s}=b$ when $3 s<n-1$. When $6 s<n-4, k$ also divides $a_{n-4-6 s}+a_{n-2-3 s}=b+a_{n-2-3 s}$, thus, $a_{n-2-3 s}=k-b=a$.

If $a=a_{n-2}=a_{n-8}>\frac{k}{2}$, all the terms $a_{n-2-6 s}$ with $6 s<n-2$ are divisible by $a$, that is, the indices $i$ for which $a$ divides $a_{i}$ form a progression with difference dividing 6 . Since this difference is odd and greater than 1 , it must be 3 , that is, $a_{n-2-3 s}=a$ when $3 s<n-2$. Similarly to the previous case, we have $a_{n-1-3 s}=a_{n}-a_{n-2-6 s}=k-a=b$ when $6 s<n-2$.

Let $a_{n}$ and $a_{n+T}$ be two consecutive terms of the sequence equal to $k$. If $n$ is large enough, $\frac{n+T}{2}<n-2$, and applying the claim to $n+T$ instead of $n$ we see that the three consecutive terms $a_{n-2}=a, a_{n-1}=b, a_{n}=k$ must be equal to $a_{n+T-2}, a_{n+T-1}$ and $a_{n+T}$ respectively. Thus, for some $i$ we have $a_{i+3 s}=a$ and $a_{i+1+3 s}=b$ for all $s$. Truncating the sequence again if necessary, we may assume that $a_{3 s+1}=a$ and $a_{3 s+2}=b$ for all $s$. We know also that $a_{n}=k$ if and only if $n$ is divisible by $T$ (incidentally, this proves that $T$ is divisible by 3 ).

If $a_{3 s}=c$ for some integer $s$, each of the numbers $a, b, c$ divides the sum of the other two. It is easy to see that these numbers are proportional to one of the triplets $(1,1,1),(1,1,2)$ and $(1,2,3)$ in some order. It follows that the greater of the two numbers $a$ and $b$ is the smaller multiplied by 2,3 or $3 / 2$. The last two cases are impossible because then $c$ cannot be the maximum element in the triplet $(a, b, c)$, while $c=k=a+b$ for infinitely many $s$. Thus the only possible case is 2 , the numbers $a$ and $b$ are $k / 3$ and $2 k / 3$ in some order, and the only possible values of $c$ are $k$ and $k / 3$. Suppose that $a_{3 s}=k / 3$ for some $s>1$. We can choose $s$ so that $a_{3 s+3}=k$. Therefore $T$, which we already know to be odd and divisible by 3 , is greater than 3 , that is, at least 9 . Then $a_{3 s-3} \neq k$, and the only other possibility is $a_{3 s-3}=k / 3$. However, $a_{3 s+3}=k$ must divide $a_{3 s}+a_{3 s-3}=2 k / 3$, which is impossible. We have proved then that $a_{3 s}=k$ for all $s>1$, which is the case (ii).",4,Prove that the sequence $(a_n)$ is bounded.,"Assume for contradiction that the sequence is unbounded. Then there exist arbitrarily large terms $a_n=k$ such that $a_i < k$ for all $i<n$. For such an $a_n$ with $n$ large enough, and any $s < n/2$, the condition $a_n | (a_{n-s} + a_{n-2s})$ and $a_{n-s}, a_{n-2s} < k$ implies $a_{n-s} + a_{n-2s} = k$. For $s=1$ and $s=2$, we get $a_{n-1}+a_{n-2}=k$ and $a_{n-2}+a_{n-4}=k$, which implies $a_{n-1}=a_{n-4}$. The condition $a_{n-1} | (a_{n-7}+a_{n-4})$ then implies $a_{n-1}|a_{n-7}$. By induction, $a_{n-1}|a_{n-1-3j}$ for all $j$ where the index is positive. As $a_{n-1-3j} < k$, this divisibility forces $a_{n-1-3j} \ge a_{n-1}$. Since $a_{n-1} \ge k/2$, $a_{n-1-3j}$ cannot be a multiple of $a_{n-1}$ greater than 1, so $a_{n-1-3j} = a_{n-1}$. Choosing $j$ large enough, we can show that a term $a_i$ with a small fixed index $i$ is equal to $a_{n-1} \ge k/2$. Since $k$ can be arbitrarily large, this is a contradiction. Thus, the sequence is bounded.",Let $d$ be a positive integer. Prove that the set of indices $I_d = \{ n \\in \\mathbb{Z}^+ \\mid d \text{ divides } a_n \}$ is either empty or forms an arithmetic progression with an odd common difference.,"Let $i_1 < i_2 < i_3 < \\dots$ be the indices in $I_d$. For any two consecutive indices $i_s, i_{s+1}$, if their sum were even, let $m=(i_{s+1}-i_s)/2$. The given condition $a_{k+2j}|a_k+a_{k+j}$ with $k=i_s, j=m$ implies $a_{i_{s+1}} | (a_{i_s} + a_{(i_s+i_{s+1})/2})$. Since $d|a_{i_{s+1}}$ and $d|a_{i_s}$, it follows that $d|a_{(i_s+i_{s+1})/2}$. This contradicts the assumption that $i_s, i_{s+1}$ are consecutive indices in $I_d$. Thus, $i_{s+1}-i_s$ must be odd. Now consider three consecutive indices $i_s, i_{s+1}, i_{s+2}$. The difference $i_{s+2}-i_s$ is even. Let $m'=(i_{s+2}-i_s)/2$. Then $a_{i_s+2m'} | (a_{i_s} + a_{i_s+m'})$, which is $a_{i_{s+2}} | (a_{i_s} + a_{(i_s+i_{s+2})/2})$. Since $d|a_{i_{s+2}}$ and $d|a_{i_s}$, it follows that $d|a_{(i_s+i_{s+2})/2}$. As this index is between $i_s$ and $i_{s+2}$, it must be $i_{s+1}$. So, $(i_s+i_{s+2})/2 = i_{s+1}$, which proves the indices form an arithmetic progression.","Show that there exists a positive integer $D$ such that for all sufficiently large $n$, the set of positive divisors of $a_n$ is identical to the set of positive divisors of $a_{n+D}$.","Since the sequence is bounded, the set of values it takes is finite. Consequently, the set $S$ of all positive divisors of all terms in the sequence is finite. There exists an $N_0$ such that for $n>N_0$, any value $a_n$ appears infinitely often. For each $s \\in S$, the set of indices $I_s = \\{n>N_0 \\mid s \text{ divides } a_n\\}$ forms an arithmetic progression with an odd common difference $d_s$. Let $D$ be the product of all these differences $d_s$ for $s \\in S$. For any $n>N_0$ and any $s \\in S$, we have $s|a_n \\iff n \\in I_s$. Since $d_s$ divides $D$, we have $n \\in I_s \\iff n+D \\in I_s$. This means $s|a_n \\iff s|a_{n+D}$. Since any divisor of $a_n$ or $a_{n+D}$ is in $S$, this shows that $a_n$ and $a_{n+D}$ have the same set of positive divisors.","Prove that this sequence is eventually periodic, i.e. there exist positive integers $N$ and $d$ such that $a_{n}=a_{n+d}$ for all $n>N$.","From the previous sub-problem, there exist integers $N$ and $D$ such that for all $n>N$, the set of positive divisors of $a_n$ is identical to the set of positive divisors of $a_{n+D}$. Two positive integers are equal if and only if they have the same set of positive divisors. Therefore, for all $n>N$, we must have $a_n = a_{n+D}$. This shows the sequence is eventually periodic with period $d=D$."
2020a4,"Let $a, b, c, d$ be four real numbers such that $a \geqslant b \geqslant c \geqslant d>0$ and $a+b+c+d=1$. Prove that

$$
(a+2 b+3 c+4 d) a^{a} b^{b} c^{c} d^{d}<1
$$","The weighted AM-GM inequality with weights $a, b, c, d$ gives

$$
a^{a} b^{b} c^{c} d^{d} \leqslant a \cdot a+b \cdot b+c \cdot c+d \cdot d=a^{2}+b^{2}+c^{2}+d^{2}
$$

so it suffices to prove that $(a+2 b+3 c+4 d)\left(a^{2}+b^{2}+c^{2}+d^{2}\right)<1=(a+b+c+d)^{3}$. This can be done in various ways, for example:

$$
\begin{aligned}
(a+b+c+d)^{3}> & a^{2}(a+3 b+3 c+3 d)+b^{2}(3 a+b+3 c+3 d) \\
& \quad+c^{2}(3 a+3 b+c+3 d)+d^{2}(3 a+3 b+3 c+d) \\
\geqslant & \left(a^{2}+b^{2}+c^{2}+d^{2}\right) \cdot(a+2 b+3 c+4 d)
\end{aligned}
$$",1,"Let $a, b, c, d$ be four real numbers such that $a \geqslant b \geqslant c \geqslant d>0$ and $a+b+c+d=1$. Prove that

$$
(a+2 b+3 c+4 d) a^{a} b^{b} c^{c} d^{d}<1
$$","The weighted AM-GM inequality with weights $a, b, c, d$ gives

$$
a^{a} b^{b} c^{c} d^{d} \leqslant a \cdot a+b \cdot b+c \cdot c+d \cdot d=a^{2}+b^{2}+c^{2}+d^{2}
$$

so it suffices to prove that $(a+2 b+3 c+4 d)\left(a^{2}+b^{2}+c^{2}+d^{2}\right)<1=(a+b+c+d)^{3}$. This can be done in various ways, for example:

$$
\begin{aligned}
(a+b+c+d)^{3}> & a^{2}(a+3 b+3 c+3 d)+b^{2}(3 a+b+3 c+3 d) \\
& \quad+c^{2}(3 a+3 b+c+3 d)+d^{2}(3 a+3 b+3 c+d) \\
\geqslant & \left(a^{2}+b^{2}+c^{2}+d^{2}\right) \cdot(a+2 b+3 c+4 d)
\end{aligned}
$$",,,,,,
2020a6,"Let $n$ and $k$ be positive integers. Prove that for $a_{1}, \ldots, a_{n} \in\left[1,2^{k}\right]$ one has


\begin{equation*}
\sum_{i=1}^{n} \frac{a_{i}}{\sqrt{a_{1}^{2}+\ldots+a_{i}^{2}}} \leqslant 4 \sqrt{k n} \tag{Iran}
\end{equation*}","Partition the set of indices $\{1,2, \ldots, n\}$ into disjoint subsets $M_{1}, M_{2}, \ldots, M_{k}$ so that $a_{\ell} \in\left[2^{j-1}, 2^{j}\right]$ for $\ell \in M_{j}$. Then, if $\left|M_{j}\right|=: p_{j}$, we have

$$
\sum_{\ell \in M_{j}} \frac{a_{\ell}}{\sqrt{a_{1}^{2}+\ldots+a_{\ell}^{2}}} \leqslant \sum_{i=1}^{p_{j}} \frac{2^{j}}{2^{j-1} \sqrt{i}}=2 \sum_{i=1}^{p_{j}} \frac{1}{\sqrt{i}}
$$

where we used that $a_{\ell} \leqslant 2^{j}$ and in the denominator every index from $M_{j}$ contributes at least $\left(2^{j-1}\right)^{2}$. Now, using $\sqrt{i}-\sqrt{i-1}=\frac{1}{\sqrt{i}+\sqrt{i-1}} \geqslant \frac{1}{2 \sqrt{i}}$, we deduce that

$$
\sum_{\ell \in M_{j}} \frac{a_{\ell}}{\sqrt{a_{1}^{2}+\ldots+a_{\ell}^{2}}} \leqslant 2 \sum_{i=1}^{p_{j}} \frac{1}{\sqrt{i}} \leqslant 2 \sum_{i=1}^{p_{j}} 2(\sqrt{i}-\sqrt{i-1})=4 \sqrt{p_{j}}
$$

Therefore, summing over $j=1, \ldots, k$ and using the QM-AM inequality, we obtain

$$
\sum_{\ell=1}^{n} \frac{a_{\ell}}{\sqrt{a_{1}^{2}+\ldots+a_{\ell}^{2}}} \leqslant 4 \sum_{j=1}^{k} \sqrt{\left|M_{j}\right|} \leqslant 4 \sqrt{k \sum_{j=1}^{k}\left|M_{j}\right|}=4 \sqrt{k n}
$$",2,"Partition the set of indices $\{1,2, \ldots, n\}$ into disjoint subsets $M_{1}, M_{2}, \ldots, M_{k}$ such that $a_{i} \in\left[2^{j-1}, 2^{j}\right]$ for $i \in M_{j}$. Let $p_j = |M_j|$. Prove that for each $j$, $\sum_{i \in M_{j}} \frac{a_{i}}{\sqrt{a_{1}^{2}+\ldots+a_{i}^{2}}} \leqslant 4 \sqrt{p_{j}}$.","Let $p_j = |M_j|$. For any $\ell \in M_j$, $a_\ell \le 2^j$. If we are considering the $i$-th term in the sum over $M_j$ (when the indices are sorted), its denominator $\sqrt{a_1^2 + \dots + a_\ell^2}$ contains at least $i$ terms from $M_j$, each with value at least $2^{j-1}$. Thus, the sum is bounded: $\sum_{\ell \in M_{j}} \frac{a_{\ell}}{\sqrt{a_{1}^{2}+\ldots+a_{\ell}^{2}}} \leqslant \sum_{i=1}^{p_{j}} \frac{2^{j}}{\sqrt{i \cdot (2^{j-1})^2}} = 2 \sum_{i=1}^{p_{j}} \frac{1}{\sqrt{i}}$. Using the inequality $\frac{1}{\sqrt{i}} \le 2(\sqrt{i}-\sqrt{i-1})$, the sum is further bounded by $2 \sum_{i=1}^{p_{j}} 2(\sqrt{i}-\sqrt{i-1}) = 4(\sqrt{p_j} - \sqrt{0}) = 4 \sqrt{p_{j}}$.","Let $n$ and $k$ be positive integers. Prove that for $a_{1}, \ldots, a_{n} \in\left[1,2^{k}\right]$ one has $\sum_{i=1}^{n} \frac{a_{i}}{\sqrt{a_{1}^{2}+\ldots+a_{i}^{2}}} \leqslant 4 \sqrt{k n}$.","Partition the indices $\{1, \ldots, n\}$ into $k$ sets $M_j$ where $i \in M_j$ if $a_i \in [2^{j-1}, 2^j]$. The total sum can be split over these partitions: $\sum_{i=1}^{n} \frac{a_{i}}{\sqrt{a_{1}^{2}+\ldots+a_{i}^{2}}} = \sum_{j=1}^{k} \sum_{i \in M_j} \frac{a_{i}}{\sqrt{a_{1}^{2}+\ldots+a_{i}^{2}}}$. Using the result from the previous sub-problem, this is $\leqslant \sum_{j=1}^{k} 4\sqrt{|M_j|} = 4\sum_{j=1}^{k} \sqrt{|M_j|}$. By the QM-AM inequality, $\sum_{j=1}^{k} \sqrt{|M_j|} \le \sqrt{k \sum_{j=1}^{k} |M_j|}$. Since $\sum_{j=1}^{k} |M_j| = n$, the expression is bounded by $4\sqrt{kn}$.",,,,
2020c2,"In a regular 100-gon, 41 vertices are colored black and the remaining 59 vertices are colored white. Prove that there exist 24 convex quadrilaterals $Q_{1}, \ldots, Q_{24}$ whose corners are vertices of the 100 -gon, so that

\begin{itemize}
  \item the quadrilaterals $Q_{1}, \ldots, Q_{24}$ are pairwise disjoint, and
  \item every quadrilateral $Q_{i}$ has three corners of one color and one corner of the other color.","Solution. Call a quadrilateral skew-colored, if it has three corners of one color and one corner of the other color. We will prove the following\\
Claim. If the vertices of a convex $(4 k+1)$-gon $P$ are colored black and white such that each color is used at least $k$ times, then there exist $k$ pairwise disjoint skew-colored quadrilaterals whose vertices are vertices of $P$. (One vertex of $P$ remains unused.)
\end{itemize}

The problem statement follows by removing 3 arbitrary vertices of the 100 -gon and applying the Claim to the remaining 97 vertices with $k=24$.\\
Proof of the Claim. We prove by induction. For $k=1$ we have a pentagon with at least one black and at least one white vertex. If the number of black vertices is even then remove a black vertex; otherwise remove a white vertex. In the remaining quadrilateral, there are an odd number of black and an odd number of white vertices, so the quadrilateral is skew-colored.

For the induction step, assume $k \geqslant 2$. Let $b$ and $w$ be the numbers of black and white vertices, respectively; then $b, w \geqslant k$ and $b+w=4 k+1$. Without loss of generality we may assume $w \geqslant b$, so $k \leqslant b \leqslant 2 k$ and $2 k+1 \leqslant w \leqslant 3 k+1$.

We want to find four consecutive vertices such that three of them are white, the fourth one is black. Denote the vertices by $V_{1}, V_{2}, \ldots, V_{4 k+1}$ in counterclockwise order, such that $V_{4 k+1}$ is black, and consider the following $k$ groups of vertices:

$$
\left(V_{1}, V_{2}, V_{3}, V_{4}\right),\left(V_{5}, V_{6}, V_{7}, V_{8}\right), \ldots,\left(V_{4 k-3}, V_{4 k-2}, V_{4 k-1}, V_{4 k}\right)
$$

In these groups there are $w$ white and $b-1$ black vertices. Since $w>b-1$, there is a group, $\left(V_{i}, V_{i+1}, V_{i+2}, V_{i+3}\right)$ that contains more white than black vertices. If three are white and one is black in that group, we are done. Otherwise, if $V_{i}, V_{i+1}, V_{i+2}, V_{i+3}$ are all white then let $V_{j}$ be the first black vertex among $V_{i+4}, \ldots, V_{4 k+1}$ (recall that $V_{4 k+1}$ is black); then $V_{j-3}, V_{j-2}$ and $V_{j-1}$ are white and $V_{j}$ is black.

Now we have four consecutive vertices $V_{i}, V_{i+1}, V_{i+2}, V_{i+3}$ that form a skew-colored quadrilateral. The remaining vertices form a convex $(4 k-3)$-gon; $w-3$ of them are white and $b-1$ are black. Since $b-1 \geqslant k-1$ and $w-3 \geqslant(2 k+1)-3>k-1$, we can apply the Claim with $k-1$.

Comment. It is not true that the vertices of the 100 -gon can be split into 25 skew-colored quadrilaterals. A possible counter-example is when the vertices $V_{1}, V_{3}, V_{5}, \ldots, V_{81}$ are black and the other vertices, $V_{2}, V_{4}, \ldots, V_{80}$ and $V_{82}, V_{83}, \ldots, V_{100}$ are white. For having 25 skew-colored quadrilaterals, there should be 8 containing three black vertices. But such a quadrilateral splits the other 96 vertices into four sets in such a way that at least two sets contain odd numbers of vertices and therefore they cannot be grouped into disjoint quadrilaterals.\\",4,"Let the vertices of a convex 5-gon be colored black and white, with at least one vertex of each color. Prove that there exists a quadrilateral, whose vertices are a subset of the 5-gon's vertices, which has three corners of one color and one corner of the other (is skew-colored).","Let b and w be the number of black and white vertices, respectively. We have b+w=5, b>=1, and w>=1. We want to show that by removing one vertex, the remaining four form a skew-colored quadrilateral, which means they have a (1,3) or (3,1) color split. This is equivalent to the number of black vertices being odd. If the initial number of black vertices, b, is even (i.e., b=2 or b=4), we remove one black vertex. The remaining four vertices will have b-1 black vertices, which is an odd number. If b is odd (i.e., b=1 or b=3), we remove one white vertex. The remaining four vertices will still have b black vertices, which is an odd number. In all cases, we can form a skew-colored quadrilateral.",Let k>=2 be an integer. Let the vertices of a convex (4k+1)-gon be colored with b black and w white vertices such that w > b. Prove that there exist four consecutive vertices forming a skew-colored quadrilateral with three white vertices and one black vertex.,"Since w > b and b+w = 4k+1, it follows that w >= 2k+1. As w < 4k+1, there must be at least one black vertex. Label the vertices V_1, ..., V_{4k+1} such that V_{4k+1} is black. Consider the k disjoint groups of four consecutive vertices: (V_1, V_2, V_3, V_4), ..., (V_{4k-3}, V_{4k-2}, V_{4k-1}, V_{4k}). These 4k vertices contain w white and b-1 black vertices. Since w > b-1, by the pigeonhole principle, at least one group must contain more white than black vertices. Such a group of four can either have 3 white and 1 black vertices (3W, 1B) or 4 white and 0 black vertices (4W, 0B). If the former, we are done. If a group (V_i, ..., V_{i+3}) is all white, let V_j be the first black vertex that appears after this group (one must exist, as V_{4k+1} is black). Then the vertices V_{j-3}, V_{j-2}, V_{j-1} are all white, and V_j is black, forming the desired quadrilateral.","If the vertices of a convex (4k+1)-gon are colored black and white such that each color is used at least k times, prove that there exist k pairwise disjoint skew-colored quadrilaterals whose vertices are vertices of the polygon.","We prove by induction on k. The base case k=1 (a 5-gon) was proven in the first sub-problem. For the inductive step, assume the claim holds for k-1 (with k>=2). Consider a (4k+1)-gon with b black and w white vertices, where b, w >= k. Assume without loss of generality that w >= b. Then w >= 2k+1 > b. By the result of the second sub-problem, we can find a skew-colored quadrilateral Q_1 with 3 white and 1 black vertices. The remaining 4k-3 = 4(k-1)+1 vertices form a convex polygon with b' = b-1 and w' = w-3 vertices. We check the condition for the inductive hypothesis: b' = b-1 >= k-1, and w' = w-3 >= (2k+1)-3 = 2k-2. For k>=2, 2k-2 >= k-1. Thus, the remaining polygon satisfies the conditions for k-1, and we can find k-1 disjoint skew-colored quadrilaterals within it. Together with Q_1, this yields k such quadrilaterals.","In a regular 100-gon, 41 vertices are colored black and the remaining 59 vertices are colored white. Prove that there exist 24 convex quadrilaterals $Q_{1}, \ldots, Q_{24}$ whose corners are vertices of the 100-gon, so that the quadrilaterals are pairwise disjoint, and every quadrilateral has three corners of one color and one corner of the other color.","We apply the theorem from the third sub-problem with k=24. The theorem requires a polygon with 4k+1 = 4(24)+1 = 97 vertices. We remove 3 arbitrary vertices from the 100-gon. The initial coloring is 41 black (B) and 59 white (W). After removing any 3 vertices, the number of remaining black vertices, b, will be in the range [38, 41], and the number of remaining white vertices, w, will be in the range [56, 59]. In all possible cases, b >= 38 > 24 and w >= 56 > 24. The remaining 97 vertices form a convex 97-gon satisfying the condition of the theorem for k=24 (i.e., having at least 24 vertices of each color). Therefore, there exist 24 pairwise disjoint skew-colored quadrilaterals formed by these vertices."
2020c5,"Let $p$ be an odd prime, and put $N=\frac{1}{4}\left(p^{3}-p\right)-1$. The numbers $1,2, \ldots, N$ are painted arbitrarily in two colors, red and blue. For any positive integer $n \leqslant N$, denote by $r(n)$ the fraction of integers in $\{1,2, \ldots, n\}$ that are red.

Prove that there exists a positive integer $a \in\{1,2, \ldots, p-1\}$ such that $r(n) \neq a / p$ for all $n=1,2, \ldots, N$.\\","Solution. Denote by $R(n)$ the number of red numbers in $\{1,2, \ldots, n\}$, i.e., $R(n)=n r(n)$. Similarly, denote by $B(n)$ and $b(n)=B(n) / n$ the number and proportion of blue numbers in $\{1,2, \ldots, n\}$, respectively. Notice that $B(n)+R(n)=n$ and $b(n)+r(n)=1$. Therefore, the statement of the problem does not change after swapping the colors.

Arguing indirectly, for every $a \in\{1,2, \ldots, p-1\}$ choose some positive integer $n_{a}$ such that $r\left(n_{a}\right)=a / p$ and, hence, $R\left(n_{a}\right)=a n_{a} / p$. Clearly, $p \mid n_{a}$, so that $n_{a}=p m_{a}$ for some positive integer $m_{a}$, and $R\left(n_{a}\right)=a m_{a}$. Without loss of generality, we assume that $m_{1}<m_{p-1}$, as otherwise one may swap the colors. Notice that


\begin{equation*}
m_{a} \leqslant \frac{N}{p}<\frac{p^{2}-1}{4} \quad \text { for all } a=1,2, \ldots, p-1 \tag{1}
\end{equation*}


The solution is based on a repeated application of the following simple observation. Claim. Assume that $m_{a}<m_{b}$ for some $a, b \in\{1,2, \ldots, p-1\}$. Then

$$
m_{b} \geqslant \frac{a}{b} m_{a} \quad \text { and } \quad m_{b} \geqslant \frac{p-a}{p-b} m_{a}
$$

Proof. The first inequality follows from $b m_{b}=R\left(n_{b}\right) \geqslant R\left(n_{a}\right)=a m_{a}$. The second inequality is obtained by swapping colors .

Let $q=(p-1) / 2$. We distinguish two cases.\\
Case 1: All $q$ numbers $m_{1}, m_{2}, \ldots, m_{q}$ are smaller than $m_{p-1}$.\\
Let $m_{a}$ be the maximal number among $m_{1}, m_{2}, \ldots, m_{q}$; then $m_{a} \geqslant q \geqslant a$. Applying the Claim, we get

$$
m_{p-1} \geqslant \frac{p-a}{p-(p-1)} m_{a} \geqslant(p-q) q=\frac{p^{2}-1}{4}
$$

which contradicts (1).\\
Case 2: There exists $k \leqslant q$ such that $m_{k}>m_{p-1}$.\\
Choose $k$ to be the smallest index satisfying $m_{k}>m_{p-1}$; by our assumptions, we have $1<k \leqslant$ $q<p-1$.

Let $m_{a}$ be the maximal number among $m_{1}, m_{2}, \ldots, m_{k-1}$; then $a \leqslant k-1 \leqslant m_{a}<m_{p-1}$. Applying the Claim, we get

$$
\begin{aligned}
m_{k} \geqslant \frac{p-1}{k} m_{p-1} \geqslant \frac{p-1}{k} & \cdot \frac{p-a}{p-(p-1)} m_{a} \\
& \geqslant \frac{p-1}{k} \cdot(p-k+1)(k-1) \geqslant \frac{k-1}{k} \cdot(p-1)(p-q) \geqslant \frac{1}{2} \cdot \frac{p^{2}-1}{2}
\end{aligned}
$$

which contradicts (1) again.\\
Comment 1. The argument in Case 2, after a slight modification of estimates at the end, applies as soon as there exists $k<\frac{3(p+1)}{4}$ with $a_{k}<a_{p-1}$. However, this argument does not seem to work if there is no such $k$.

Comment 2. If $p$ is small enough, then one can color $\{1,2, \ldots, N+1\}$ so that there exist numbers $m_{1}$, $m_{2}, \ldots, m_{p-1}$ satisfying $r\left(p m_{a}\right)=a / p$. For $p=3,5,7$, one can find colorings providing the following sequences:

$$
\left(m_{1}, m_{2}\right)=(1,2), \quad\left(m_{1}, m_{2}, m_{3}, m_{4}\right)=(1,2,3,6), \quad \text { and } \quad\left(m_{1}, \ldots, m_{6}\right)=(1,2,3,4,6,12)
$$

respectively.\\
Thus, for small values of $p$, the number $N$ in the problem statement cannot be increased. However, a careful analysis of the estimates shows that this number can be slightly increased for $p \geqslant 11$.",3,"Assume for contradiction that for every $a \in \{1, 2, \ldots, p-1\}$, there exists an integer $n_a \in \{1, 2, \ldots, N\}$ such that $r(n_a) = a/p$. Show that each $n_a$ must be a multiple of $p$, say $n_a = pm_a$. Further, show that if $m_a < m_b$ for some $a, b \in \{1, 2, \ldots, p-1\}$, then the inequalities $m_b \ge \frac{a}{b}m_a$ and $m_b \ge \frac{p-a}{p-b}m_a$ hold.","The condition $r(n_a) = a/p$ means the number of red integers $R(n_a) = n_a \cdot r(n_a) = n_a a/p$. Since $R(n_a)$ is an integer and $p$ is a prime that does not divide $a \in \{1, \ldots, p-1\}$, $p$ must divide $n_a$. Let $n_a = pm_a$ for some positive integer $m_a$. Then $R(n_a) = am_a$. If $m_a < m_b$, then $n_a < n_b$. The number of red integers is non-decreasing, so $R(n_b) \ge R(n_a)$, which implies $bm_b \ge am_a$, or $m_b \ge \frac{a}{b}m_a$. Similarly, the number of blue integers is $B(n) = n - R(n)$. Thus $B(n_a) = pm_a - am_a = (p-a)m_a$ and $B(n_b) = (p-b)m_b$. Since $n_a < n_b$, $B(n_b) \ge B(n_a)$, which implies $(p-b)m_b \ge (p-a)m_a$, or $m_b \ge \frac{p-a}{p-b}m_a$.","Using the setup from the first sub-problem, show that the existence of the sequence of integers $\{m_a\}_{a=1}^{p-1}$ leads to a contradiction with the bound $m_a < \frac{p^2-1}{4}$ for all $a$.","From $n_a = pm_a \le N = \frac{p^3-p}{4}-1$, we have $m_a < \frac{p^2-1}{4}$. Let $q=(p-1)/2$. We can assume $m_1 < m_{p-1}$ (otherwise, we swap the colors red and blue). We consider two cases. 
Case 1: $m_k < m_{p-1}$ for all $k \in \{1, \ldots, q\}$. Let $m_a$ be the maximum of $\{m_1, \ldots, m_q\}$. Then $m_a < m_{p-1}$ and $m_a \ge q$. Using the inequality from Sub-problem 1, $m_{p-1} \ge \frac{p-a}{p-(p-1)} m_a = (p-a)m_a$. Since $a \le q$, we have $p-a \ge p-q = (p+1)/2$. Thus, $m_{p-1} \ge (p-q)q = \frac{p+1}{2}\frac{p-1}{2} = \frac{p^2-1}{4}$, a contradiction. 
Case 2: There exists $k \in \{1, \ldots, q\}$ with $m_k > m_{p-1}$. Let $k$ be the smallest such index, so $k > 1$. Let $m_a$ be the maximum of $\{m_1, \ldots, m_{k-1}\}$. Then $m_a < m_{p-1} < m_k$. Applying the inequalities, $m_{p-1} \ge (p-a)m_a$ and $m_k \ge \frac{p-1}{k}m_{p-1}$. Since $m_a \ge k-1$ and $a \le k-1$, we get $m_{p-1} \ge (p-(k-1))(k-1)$. Then $m_k \ge \frac{p-1}{k}(p-k+1)(k-1)$. As $k \le q$, $p-k+1 > p-q = (p+1)/2$. Thus $m_k > \frac{p-1}{k} \frac{p+1}{2} (k-1) = \frac{p^2-1}{2} \frac{k-1}{k}$. Since $k \ge 2$, $\frac{k-1}{k} \ge \frac{1}{2}$, so $m_k \ge \frac{p^2-1}{4}$, a contradiction.","Let $p$ be an odd prime, and put $N=\frac{1}{4}\left(p^{3}-p\right)-1$. The numbers $1,2, \ldots, N$ are painted arbitrarily in two colors, red and blue. For any positive integer $n \leqslant N$, denote by $r(n)$ the fraction of integers in $\{1,2, \ldots, n\}$ that are red. Prove that there exists a positive integer $a \in\{1,2, \ldots, p-1\}$ such that $r(n) \neq a / p$ for all $n=1,2, \ldots, N$.","We argue by contradiction. Assume that for every $a \in \{1,2, \ldots, p-1\}$, there exists an integer $n_a \in \{1, \ldots, N\}$ such that $r(n_a) = a/p$. As established in Sub-problem 1, this implies the existence of a sequence of positive integers $\{m_a\}_{a=1}^{p-1}$ where $n_a = pm_a$, and for any $a, b$ with $m_a < m_b$, certain inequalities hold. However, in Sub-problem 2, we showed that the existence of such a sequence $\{m_a\}$ with the property $m_a \le N/p < \frac{p^2-1}{4}$ leads to a logical contradiction in all possible cases. Therefore, the initial assumption must be false. Consequently, there must be at least one $a \in \{1,2, \ldots, p-1\}$ for which no $n \in \{1,2, \ldots, N\}$ satisfies $r(n)=a/p$.",,
2020c6,"$4 n$ coins of weights $1,2,3, \ldots, 4 n$ are given. Each coin is colored in one of $n$ colors and there are four coins of each color. Show that all these coins can be partitioned into two sets with the same total weight, such that each set contains two coins of each color.","Let us pair the coins with weights summing up to $4 n+1$, resulting in the set $S$ of $2 n$ pairs: $\{1,4 n\},\{2,4 n-1\}, \ldots,\{2 n, 2 n+1\}$. It suffices to partition $S$ into two sets, each consisting of $n$ pairs, such that each set contains two coins of each color.

Introduce a multi-graph $G$ (i.e., a graph with loops and multiple edges allowed) on $n$ vertices, so that each vertex corresponds to a color. For each pair of coins from $S$, we add an edge between the vertices corresponding to the colors of those coins. Note that each vertex has degree 4. Also, a desired partition of the coins corresponds to a coloring of the edges of $G$ in two colors, say red and blue, so that each vertex has degree 2 with respect to each color (i.e., each vertex has equal red and blue degrees).

To complete the solution, it suffices to provide such a coloring for each component $G^{\prime}$ of $G$. Since all degrees of the vertices are even, in $G^{\prime}$ there exists an Euler circuit $C$ (i.e., a circuit passing through each edge of $G^{\prime}$ exactly once). Note that the number of edges in $C$ is even (it equals twice the number of vertices in $G^{\prime}$ ). Hence all the edges can be colored red and blue so that any two edges adjacent in $C$ have different colors (one may move along $C$ and color the edges one by one alternating red and blue colors). Thus in $G^{\prime}$ each vertex has equal red and blue degrees, as desired.",3,"Show that the original problem is equivalent to partitioning the $2n$ pairs of coins $\{k, 4n+1-k\}$ for $k=1, \\ldots, 2n$ into two sets of $n$ pairs, such that within each set, every color appears on exactly two coins.","The total weight of all coins is $\\sum_{i=1}^{4n} i = 2n(4n+1)$. For a partition into two sets of equal weight, each set must have a total weight of $n(4n+1)$. The pairs $\{k, 4n+1-k\}$ each have a weight sum of $4n+1$. By partitioning these $2n$ pairs into two groups of $n$ pairs each, the weight condition is automatically satisfied. The problem thus reduces to partitioning these pairs such that the color distribution condition is met, which is that each of the two sets of pairs must contain two coins of each color.",Model the combinatorial problem from the previous step using a multigraph $G$ where vertices represent colors and edges represent the coin pairs. Show that this reduces the problem to partitioning the edges of a 4-regular multigraph into two 2-regular spanning subgraphs.,"Let the $n$ colors be the vertices of a multigraph $G$. For each of the $2n$ coin pairs $\{k, 4n+1-k\}$, add an edge between the vertices corresponding to the colors of the two coins. Since there are exactly four coins of each color, each vertex in $G$ must be an endpoint of four edges, meaning every vertex has degree 4. A partition of the pairs into two sets corresponds to partitioning the edges of $G$ into two subgraphs. The condition that each set contains two coins of each color is equivalent to requiring that in each subgraph, every vertex has degree 2. Thus, the problem is to decompose a 4-regular multigraph into two 2-regular subgraphs.","$4 n$ coins of weights $1,2,3, \\ldots, 4 n$ are given. Each coin is colored in one of $n$ colors and there are four coins of each color. Show that all these coins can be partitioned into two sets with the same total weight, such that each set contains two coins of each color.","As established, the problem reduces to showing that any 4-regular multigraph $G$ can have its edges partitioned into two 2-regular subgraphs. Since all vertices in $G$ have an even degree (4), each connected component of $G$ has an Euler circuit. Traverse the Euler circuit of each component, coloring the edges alternately with two colors. At any vertex, an Euler circuit consists of an equal number of incoming and outgoing edges. The alternating coloring ensures that for each vertex, half its incident edges will be of one color and half of the other. Since the total degree is 4, each vertex will have degree 2 in each color. This provides the desired partition of edges, which solves the coin problem.",,
2020c7,"Consider any rectangular table having finitely many rows and columns, with a real number $a(r, c)$ in the cell in row $r$ and column $c$. A pair $(R, C)$, where $R$ is a set of rows and $C$ a set of columns, is called a saddle pair if the following two conditions are satisfied:\\
(i) For each row $r^{\prime}$, there is $r \in R$ such that $a(r, c) \geqslant a\left(r^{\prime}, c\right)$ for all $c \in C$;\\
(ii) For each column $c^{\prime}$, there is $c \in C$ such that $a(r, c) \leqslant a\left(r, c^{\prime}\right)$ for all $r \in R$.

A saddle pair $(R, C)$ is called a minimal pair if for each saddle pair $\left(R^{\prime}, C^{\prime}\right)$ with $R^{\prime} \subseteq R$ and $C^{\prime} \subseteq C$, we have $R^{\prime}=R$ and $C^{\prime}=C$.

Prove that any two minimal pairs contain the same number of rows.","We say that a pair $\left(R^{\prime}, C^{\prime}\right)$ of nonempty sets is a subpair of a pair $(R, C)$ if $R^{\prime} \subseteq R$ and $C^{\prime} \subseteq C$. The subpair is proper if at least one of the inclusions is strict.

Let $\left(R_{1}, C_{1}\right)$ and $\left(R_{2}, C_{2}\right)$ be two saddle pairs with $\left|R_{1}\right|>\left|R_{2}\right|$. We will find a saddle subpair $\left(R^{\prime}, C^{\prime}\right)$ of $\left(R_{1}, C_{1}\right)$ with $\left|R^{\prime}\right| \leqslant\left|R_{2}\right|$; clearly, this implies the desired statement.\\
Step 1: We construct maps $\rho: R_{1} \rightarrow R_{1}$ and $\sigma: C_{1} \rightarrow C_{1}$ such that $\left|\rho\left(R_{1}\right)\right| \leqslant\left|R_{2}\right|$, and $a\left(\rho\left(r_{1}\right), c_{1}\right) \geqslant a\left(r_{1}, \sigma\left(c_{1}\right)\right)$ for all $r_{1} \in R_{1}$ and $c_{1} \in C_{1}$.

Since $\left(R_{1}, C_{1}\right)$ is a saddle pair, for each $r_{2} \in R_{2}$ there is $r_{1} \in R_{1}$ such that $a\left(r_{1}, c_{1}\right) \geqslant a\left(r_{2}, c_{1}\right)$ for all $c_{1} \in C_{1}$; denote one such an $r_{1}$ by $\rho_{1}\left(r_{2}\right)$. Similarly, we define four functions


\begin{align*}
& \rho_{1}: R_{2} \rightarrow R_{1} \quad \text { such that } a\left(\rho_{1}\left(r_{2}\right), c_{1}\right) \geqslant a\left(r_{2}, c_{1}\right) \quad \text { for all } \quad r_{2} \in R_{2}, \quad c_{1} \in C_{1} ; \\
& \rho_{2}: R_{1} \rightarrow R_{2} \quad \text { such that } a\left(\rho_{2}\left(r_{1}\right), c_{2}\right) \geqslant a\left(r_{1}, c_{2}\right)  \tag{1}\\
& \text { for all } \quad r_{1} \in R_{1}, \\
& \sigma_{1}: c_{2} \in C_{2} ; C_{1} \\
& \sigma_{2}: C_{1} \rightarrow C_{2}
\end{align*} \quad \text { such that } a\left(r_{1}, \sigma_{1}\left(c_{2}\right)\right) \leqslant a\left(r_{1}, c_{2}\right) \quad \text { for all } \quad r_{1} \in R_{1}, \quad c_{2} \in C_{2} ; ~ a\left(r_{2}, \sigma_{2}\left(c_{1}\right)\right) \leqslant a\left(r_{2}, c_{1}\right) \quad \text { for all } \quad r_{2} \in R_{2}, \quad c_{1} \in C_{1} .


Set now $\rho=\rho_{1} \circ \rho_{2}: R_{1} \rightarrow R_{1}$ and $\sigma=\sigma_{1} \circ \sigma_{2}: C_{1} \rightarrow C_{1}$. We have

$$
\left|\rho\left(R_{1}\right)\right|=\left|\rho_{1}\left(\rho_{2}\left(R_{1}\right)\right)\right| \leqslant\left|\rho_{1}\left(R_{2}\right)\right| \leqslant\left|R_{2}\right|
$$

Moreover, for all $r_{1} \in R_{1}$ and $c_{1} \in C_{1}$, we get


\begin{align*}
& a\left(\rho\left(r_{1}\right), c_{1}\right)=a\left(\rho_{1}\left(\rho_{2}\left(r_{1}\right)\right), c_{1}\right) \geqslant a\left(\rho_{2}\left(r_{1}\right), c_{1}\right) \geqslant a\left(\rho_{2}\left(r_{1}\right), \sigma_{2}\left(c_{1}\right)\right) \\
& \geqslant a\left(r_{1}, \sigma_{2}\left(c_{1}\right)\right) \geqslant a\left(r_{1}, \sigma_{1}\left(\sigma_{2}\left(c_{1}\right)\right)\right)=a\left(r_{1}, \sigma\left(c_{1}\right)\right) \tag{2}
\end{align*}


as desired.\\
Step 2: Given maps $\rho$ and $\sigma$, we construct a proper saddle subpair $\left(R^{\prime}, C^{\prime}\right)$ of $\left(R_{1}, C_{1}\right)$.\\
The properties of $\rho$ and $\sigma$ yield that

$$
a\left(\rho^{i}\left(r_{1}\right), c_{1}\right) \geqslant a\left(\rho^{i-1}\left(r_{1}\right), \sigma\left(c_{1}\right)\right) \geqslant \ldots \geqslant a\left(r_{1}, \sigma^{i}\left(c_{1}\right)\right)
$$

for each positive integer $i$ and all $r_{1} \in R_{1}, c_{1} \in C_{1}$.\\
Consider the images $R^{i}=\rho^{i}\left(R_{1}\right)$ and $C^{i}=\sigma^{i}\left(C_{1}\right)$. Clearly, $R_{1}=R^{0} \supseteq R^{1} \supseteq R^{2} \supseteq \ldots$ and $C_{1}=C^{0} \supseteq C^{1} \supseteq C^{2} \supseteq \ldots$. Since both chains consist of finite sets, there is an index $n$ such that $R^{n}=R^{n+1}=\ldots$ and $C^{n}=C^{n+1}=\ldots$ Then $\rho^{n}\left(R^{n}\right)=R^{2 n}=R^{n}$, so $\rho^{n}$ restricted to $R^{n}$ is a bijection. Similarly, $\sigma^{n}$ restricted to $C^{n}$ is a bijection from $C^{n}$ to itself. Therefore, there exists a positive integer $k$ such that $\rho^{n k}$ acts identically on $R^{n}$, and $\sigma^{n k}$ acts identically on $C^{n}$.

We claim now that $\left(R^{n}, C^{n}\right)$ is a saddle subpair of $\left(R_{1}, C_{1}\right)$, with $\left|R^{n}\right| \leqslant\left|R^{1}\right|=\left|\rho\left(R_{1}\right)\right| \leqslant$ $\left|R_{2}\right|$, which is what we needed. To check that this is a saddle pair, take any row $r^{\prime}$; since $\left(R_{1}, C_{1}\right)$ is a saddle pair, there exists $r_{1} \in R_{1}$ such that $a\left(r_{1}, c_{1}\right) \geqslant a\left(r^{\prime}, c_{1}\right)$ for all $c_{1} \in C_{1}$. Set now $r_{*}=\rho^{n k}\left(r_{1}\right) \in R^{n}$. Then, for each $c \in C^{n}$ we have $c=\sigma^{n k}(c)$ and hence

$$
a\left(r_{*}, c\right)=a\left(\rho^{n k}\left(r_{1}\right), c\right) \geqslant a\left(r_{1}, \sigma^{n k}(c)\right)=a\left(r_{1}, c\right) \geqslant a\left(r^{\prime}, c\right)
$$

which establishes condition (i). Condition (ii) is checked similarly.",4,"Let $(R_1, C_1)$ and $(R_2, C_2)$ be two saddle pairs. Prove that there exist maps $\rho: R_1 \rightarrow R_1$ and $\sigma: C_1 \rightarrow C_1$ such that $|\rho(R_1)| \le |R_2|$ and for all $r_1 \in R_1, c_1 \in C_1$, $a(\rho(r_1), c_1) \ge a(r_1, \sigma(c_1))$.","Using the saddle pair property (i) for $(R_2,C_2)$ and $(R_1,C_1)$, define maps $\rho_2: R_1 \rightarrow R_2$ and $\rho_1: R_2 \rightarrow R_1$. Similarly, using property (ii), define maps $\sigma_2: C_1 \rightarrow C_2$ and $\sigma_1: C_2 \rightarrow C_1$. Let $\rho = \rho_1 \circ \rho_2$ and $\sigma = \sigma_1 \circ \sigma_2$. Then $|\rho(R_1)| = |\rho_1(\rho_2(R_1))| \le |\rho_1(R_2)| \le |R_2|$. The inequality $a(\rho(r_1), c_1) \ge a(r_1, \sigma(c_1))$ follows from chaining the inequalities from the maps' definitions: $a(\rho(r_1), c_1) = a(\rho_1(\rho_2(r_1)), c_1) \ge a(\rho_2(r_1), c_1) \ge a(\rho_2(r_1), \sigma_2(c_1)) \ge a(r_1, \sigma_2(c_1)) \ge a(r_1, \sigma_1(\sigma_2(c_1))) = a(r_1, \sigma(c_1))$.","Let $\rho: R \rightarrow R$ and $\sigma: C \rightarrow C$ be maps on finite sets $R, C$. Let $R' = \bigcap_{i \ge 0} \rho^i(R)$ and $C' = \bigcap_{i \ge 0} \sigma^i(C)$. Prove that there exists a positive integer $k$ such that $\rho^k$ and $\sigma^k$ act as identity maps on $R'$ and $C'$, respectively.","Since $R$ is finite, the sequence of nested subsets $R \supseteq \rho(R) \supseteq \rho^2(R) \supseteq \dots$ must stabilize. Let $R'$ be this stable set. Then $\rho(R') = R'$. Since $\rho$ maps the finite set $R'$ to itself, it must be a permutation of $R'$. Any permutation of a finite set has a finite order, so there exists an integer $k_R > 0$ such that $\rho^{k_R}$ is the identity on $R'$. Similarly, there is a $k_C > 0$ for $\sigma$ on $C'$. We can choose $k$ to be the least common multiple of $k_R$ and $k_C$.","Let $(R_1, C_1)$ be a saddle pair. Let $\rho: R_1 \rightarrow R_1, \sigma: C_1 \rightarrow C_1$ be maps such that $a(\rho(r_1), c_1) \ge a(r_1, \sigma(c_1))$ for all $r_1 \in R_1, c_1 \in C_1$. Let $R' = \bigcap_{i \ge 0} \rho^i(R_1)$ and $C' = \bigcap_{i \ge 0} \sigma^i(C_1)$. Prove that $(R', C')$ is a saddle pair.","By Sub-problem 2, there is a $k>0$ with $\rho^k(r')=r'$ and $\sigma^k(c')=c'$ for all $r' \in R', c' \in C'$. The given inequality implies $a(\rho^k(r_1),c_1) \ge a(r_1,\sigma^k(c_1))$.
(i) For any row $r_{any}$, pick $r_1 \in R_1$ from the saddle condition on $(R_1,C_1)$. Let $r^* = \rho^k(r_1) \in R'$. Then for any $c' \in C'$, $a(r^*, c') = a(\rho^k(r_1), c') \ge a(r_1, \sigma^k(c')) = a(r_1, c') \ge a(r_{any}, c')$.
(ii) For any column $c_{any}$, pick $c_1 \in C_1$ similarly. Let $c^* = \sigma^k(c_1) \in C'$. Then for any $r' \in R'$, $a(r', c^*) = a(r', \sigma^k(c_1)) \le a(\rho^k(r'), c_1) = a(r', c_1) \le a(r', c_{any})$.
Thus, $(R', C')$ is a saddle pair.",Prove that any two minimal pairs contain the same number of rows.,"Let $(R_1, C_1)$ and $(R_2, C_2)$ be two minimal saddle pairs. Assume for contradiction $|R_1| > |R_2|$. By Sub-problem 1, there are maps $\rho: R_1 \rightarrow R_1$ and $\sigma: C_1 \rightarrow C_1$ with $|\rho(R_1)| \le |R_2|$. By Sub-problem 3, the pair of stable sets $(R', C')$, with $R' = \bigcap \rho^i(R_1)$, is a saddle pair. We have $R' \subseteq \rho(R_1)$, so $|R'| \le |\rho(R_1)| \le |R_2| < |R_1|$. Since $R' \subseteq R_1$ and $|R'| < |R_1|$, $(R', C')$ is a proper saddle subpair of $(R_1, C_1)$. This contradicts the minimality of $(R_1, C_1)$. Thus, $|R_1|$ cannot be greater than $|R_2|$. By symmetry, $|R_2|$ cannot be greater than $|R_1|$, so $|R_1|=|R_2|$."
2020g1,"Let $A B C$ be an isosceles triangle with $B C=C A$, and let $D$ be a point inside side $A B$ such that $A D<D B$. Let $P$ and $Q$ be two points inside sides $B C$ and $C A$, respectively, such that $\angle D P B=\angle D Q A=90^{\circ}$. Let the perpendicular bisector of $P Q$ meet line segment $C Q$ at $E$, and let the circumcircles of triangles $A B C$ and $C P Q$ meet again at point $F$, different from $C$.

Suppose that $P, E, F$ are collinear. Prove that $\angle A C B=90^{\circ}$.","Let $\ell$ be the perpendicular bisector of $P Q$, and denote by $\omega$ the circle $C F P Q$. By $D P \perp B C$ and $D Q \perp A C$, the circle $\omega$ passes through $D$; moreover, $C D$ is a diameter of $\omega$.

The lines $Q E$ and $P E$ are symmetric about $\ell$, and $\ell$ is a symmetry axis of $\omega$ as well; it follows that the chords $C Q$ and $F P$ are symmetric about $\ell$, hence $C$ and $F$ are symmetric about $\ell$. Therefore, the perpendicular bisector of $C F$ coincides with $\ell$. Thus $\ell$ passes through the circumcenter $O$ of $A B C$.

Let $M$ be the midpoint of $A B$. Since $C M \perp D M, M$ also lies on $\omega$. By $\angle A C M=\angle B C M$, the chords $M P$ and $M Q$ of $\omega$ are equal. Then, from $M P=M Q$ it follows that $\ell$ passes through $M$.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_a23604964ee434afd034g-50}

Finally, both $O$ and $M$ lie on lines $\ell$ and $C M$, therefore $O=M$, and $\angle A C B=90^{\circ}$ follows.\\",2,Let $O$ be the circumcenter of triangle $A B C$ and $\ell$ be the perpendicular bisector of $P Q$. Show that $O$ lies on the line $\ell$.,"Let $\omega$ be the circumcircle of $C P Q$. Since $\angle D P B=\angle D Q A=90^{\circ}$, points $P$ and $Q$ lie on the circle with diameter $C D$. Thus, $D$ lies on $\omega$ and $C D$ is a diameter. The line $\ell$ is the perpendicular bisector of the chord $P Q$ of $\omega$, so it is an axis of symmetry for $\omega$. Point $E$ lies on $\ell$ and on line $C Q$. Reflection across $\ell$ maps $Q \to P$ and $E \to E$, so the line $C Q$ is reflected to the line $P E$. Since $P, E, F$ are collinear, this is the line $P F$. The points $C, F$ are on $\omega$. Reflection across $\ell$ maps the set of intersection points of line $C Q$ and $\omega$, which is $\{C, Q\}$, to the set of intersection points of line $P F$ and $\omega$, which is $\{F, P\}$. As $Q$ maps to $P$, $C$ must map to $F$. This implies $\ell$ is the perpendicular bisector of the segment $C F$. Since $C$ and $F$ lie on the circumcircle of $\triangle A B C$, its center $O$ must lie on the perpendicular bisector of the chord $C F$. Therefore, $O$ lies on $\ell$.",Prove that $\angle A C B=90^{\circ}$.,"Let $O$ be the circumcenter of $\triangle A B C$ and $M$ be the midpoint of $A B$. From the previous result, $O$ lies on $\ell$, the perpendicular bisector of $P Q$. Since $\triangle A B C$ is isosceles with $A C=B C$, the line $C M$ is an altitude to $A B$ and the angle bisector of $\angle A C B$. Thus, $\angle C M D=90^{\circ}$. The circumcircle of $C P Q$ passes through $D$ and has $C D$ as a diameter, so $M$ must also lie on this circle. In this circle, since $C M$ bisects $\angle P C Q$, the chords they subtend are equal: $M P=M Q$. This means $M$ is equidistant from $P$ and $Q$, so $M$ lies on the perpendicular bisector $\ell$. Both $O$ and $M$ lie on the line $C M$ (a property of isosceles triangles) and also on the line $\ell$. Since $A D<D B$, $D \neq M$, which implies that $\ell$ and $C M$ are distinct lines. Therefore, their unique intersection point means $O=M$. If the circumcenter of $\triangle A B C$ is the midpoint of side $A B$, then $A B$ is a diameter of the circumcircle, which implies that $\angle A C B=90^{\circ}$.",,,,
2020g2,"Let $A B C D$ be a convex quadrilateral. Suppose that $P$ is a point in the interior of $A B C D$ such that

$$
\angle P A D: \angle P B A: \angle D P A=1: 2: 3=\angle C B P: \angle B A P: \angle B P C .
$$

The internal bisectors of angles $A D P$ and $P C B$ meet at a point $Q$ inside the triangle $A B P$. Prove that $A Q=B Q$.","Let $\varphi=\angle P A D$ and $\psi=\angle C B P$; then we have $\angle P B A=2 \varphi, \angle D P A=3 \varphi$, $\angle B A P=2 \psi$ and $\angle B P C=3 \psi$. Let $X$ be the point on segment $A D$ with $\angle X P A=\varphi$. Then

$$
\angle P X D=\angle P A X+\angle X P A=2 \varphi=\angle D P A-\angle X P A=\angle D P X .
$$

It follows that triangle $D P X$ is isosceles with $D X=D P$ and therefore the internal angle bisector of $\angle A D P$ coincides with the perpendicular bisector of $X P$. Similarly, if $Y$ is a point on $B C$ such that $\angle B P Y=\psi$, then the internal angle bisector of $\angle P C B$ coincides with the perpendicular bisector of $P Y$. Hence, we have to prove that the perpendicular bisectors of $X P$, $P Y$, and $A B$ are concurrent.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_a23604964ee434afd034g-52}

Notice that

$$
\angle A X P=180^{\circ}-\angle P X D=180^{\circ}-2 \varphi=180^{\circ}-\angle P B A .
$$

Hence the quadrilateral $A X P B$ is cyclic; in other words, $X$ lies on the circumcircle of triangle $A P B$. Similarly, $Y$ lies on the circumcircle of triangle $A P B$. It follows that the perpendicular bisectors of $X P, P Y$, and $A B$ all pass through the center of circle $(A B Y P X)$. This finishes the proof.

Comment. Introduction of points $X$ and $Y$ seems to be the key step in the solution above. Note that the same point $X$ could be introduced in different ways, e.g., as the point on the ray $C P$ beyond $P$ such that $\angle P B X=\varphi$, or as a point where the circle $(A P B)$ meets again $A B$. Different definitions of $X$ could lead to different versions of the further solution.",3,"Let $\varphi = \angle PAD$ and $\psi = \angle CBP$. Define a point $X$ on segment $AD$ such that $\angle XPA = \varphi$, and a point $Y$ on segment $BC$ such that $\angle BPY = \psi$. Show that the internal angle bisector of $\angle ADP$ is the perpendicular bisector of segment $XP$, and similarly, the internal angle bisector of $\angle PCB$ is the perpendicular bisector of segment $PY$.","Given the angle ratios, we have $\angle DPA=3\varphi$. It follows that $\angle DPX = \angle DPA - \angle XPA = 3\varphi - \varphi = 2\varphi$. In $\triangle APX$, the exterior angle at $X$ is $\angle PXD = \angle PAX + \angle XPA = \varphi + \varphi = 2\varphi$. Since $\angle DPX = \angle PXD$, triangle $DPX$ is isosceles with $DP=DX$. The bisector of the vertex angle $\angle PDX$ (which is $\angle ADP$) in an isosceles triangle is also the perpendicular bisector of the base $XP$. A similar argument shows $\triangle CPY$ is isosceles with $CP=CY$ (as $\angle CPY = \angle BPC - \angle BPY = 3\psi - \psi = 2\psi$ and $\angle PYC = \angle PBY + \angle BPY = \psi + \psi = 2\psi$), so the bisector of $\angle PCY$ (which is $\angle PCB$) is the perpendicular bisector of $PY$.","Let $\varphi = \angle PAD$ and $\psi = \angle CBP$. Let $X$ be a point on $AD$ such that $\angle XPA = \varphi$, and $Y$ a point on $BC$ such that $\angle BPY = \psi$. Prove that the five points $A, B, P, X, Y$ are concyclic.","From the given conditions, $\angle PBA=2\varphi$ and $\angle BAP=2\psi$. For point $X$, the exterior angle of $\triangle APX$ is $\angle PXD = \angle PAX + \angle XPA = \varphi+\varphi=2\varphi$. Thus $\angle AXP = 180^\circ - 2\varphi$. In quadrilateral $AXPB$, the sum of opposite angles $\angle AXP + \angle PBA = (180^\circ - 2\varphi) + 2\varphi = 180^\circ$, so $AXPB$ is cyclic. This means $X$ lies on the circumcircle of $\triangle APB$. For point $Y$, the exterior angle of $\triangle BPY$ is $\angle PYC = \angle PBY + \angle BPY = \psi+\psi=2\psi$. Thus $\angle BYP = 180^\circ - 2\psi$. In quadrilateral $ABPY$, $\angle BYP + \angle BAP = (180^\circ - 2\psi) + 2\psi = 180^\circ$, so $ABPY$ is cyclic. This means $Y$ also lies on the circumcircle of $\triangle APB$. Therefore, all five points $A, B, P, X, Y$ are concyclic.",Let $A B C D$ be a convex quadrilateral. Suppose that $P$ is a point in the interior of $A B C D$ such that $\angle P A D: \angle P B A: \angle D P A=1: 2: 3=\angle C B P: \angle B A P: \angle B P C$. The internal bisectors of angles $A D P$ and $P C B$ meet at a point $Q$ inside the triangle $A B P$. Prove that $A Q=B Q$.,"Let $\varphi = \angle PAD$ and $\psi = \angle CBP$. Let $X$ be a point on $AD$ with $\angle XPA = \varphi$, and $Y$ on $BC$ with $\angle BPY = \psi$. The internal bisector of $\angle ADP$ is the perpendicular bisector of $XP$, as $\triangle DPX$ is isosceles ($DP=DX$). Similarly, the internal bisector of $\angle PCB$ is the perpendicular bisector of $PY$, as $\triangle CPY$ is isosceles ($CP=CY$). The point $Q$, being the intersection of these bisectors, is the circumcenter of $\triangle XPY$. The quadrilaterals $AXPB$ and $ABPY$ are cyclic, which implies that the five points $A, B, P, X, Y$ are concyclic. Since $Q$ is the circumcenter of $\triangle XPY$, it is the circumcenter of the circle passing through all five points. As the circumcenter, $Q$ is equidistant from all points on the circle, including $A$ and $B$. Therefore, $AQ = BQ$.",,
2020g3,"Let $A B C D$ be a convex quadrilateral with $\angle A B C>90^{\circ}, \angle C D A>90^{\circ}$, and $\angle D A B=\angle B C D$. Denote by $E$ and $F$ the reflections of $A$ in lines $B C$ and $C D$, respectively. Suppose that the segments $A E$ and $A F$ meet the line $B D$ at $K$ and $L$, respectively. Prove that the circumcircles of triangles $B E K$ and $D F L$ are tangent to each other.","Denote by $A^{\prime}$ the reflection of $A$ in $B D$. We will show that that the quadrilaterals $A^{\prime} B K E$ and $A^{\prime} D L F$ are cyclic, and their circumcircles are tangent to each other at point $A^{\prime}$.

From the symmetry about line $B C$ we have $\angle B E K=\angle B A K$, while from the symmetry in $B D$ we have $\angle B A K=\angle B A^{\prime} K$. Hence $\angle B E K=\angle B A^{\prime} K$, which implies that the quadrilateral $A^{\prime} B K E$ is cyclic. Similarly, the quadrilateral $A^{\prime} D L F$ is also cyclic.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_a23604964ee434afd034g-54}

For showing that circles $A^{\prime} B K E$ and $A^{\prime} D L F$ are tangent it suffices to prove that

$$
\angle A^{\prime} K B+\angle A^{\prime} L D=\angle B A^{\prime} D .
$$

Indeed, by $A K \perp B C$, $A L \perp C D$, and again the symmetry in $B D$ we have

$$
\angle A^{\prime} K B+\angle A^{\prime} L D=180^{\circ}-\angle K A^{\prime} L=180^{\circ}-\angle K A L=\angle B C D=\angle B A D=\angle B A^{\prime} D,
$$

as required.\\",2,Let $A'$ be the reflection of $A$ in the line $BD$. Show that the quadrilaterals $A'BKE$ and $A'DLF$ are cyclic.,"Since $E$ is the reflection of $A$ in line $BC$, we have $\angle B E K=\angle B A K$. Since $A'$ is the reflection of $A$ in line $BD$, we have $\angle B A K=\angle B A' K$. Therefore, $\angle B E K=\angle B A' K$, which implies that the quadrilateral $A'BKE$ is cyclic. Similarly, since $F$ is the reflection of $A$ in $CD$, $\angle D F L=\angle D A L$. Reflection in $BD$ gives $\angle D A L=\angle D A' L$. Thus, $\angle D F L = \angle D A' L$, which implies that the quadrilateral $A'DLF$ is cyclic.",Prove that the circumcircles of triangles $B E K$ and $D F L$ are tangent to each other.,"Let $A'$ be the reflection of $A$ in $BD$. From the first sub-problem, the circumcircles of $\triangle BEK$ and $\triangle DFL$ are the circumcircles of cyclic quadrilaterals $A'BKE$ and $A'DLF$, which meet at $A'$. The circles are tangent at $A'$ if $\angle A'KB + \angle A'LD = \angle BA'D$. The sum of angles in $\triangle A'KL$ gives $\angle A'KB + \angle A'LD = 180^{\circ} - \angle KA'L$. By reflection in $BD$, $\angle KA'L = \angle KAL$. Since $E$ and $F$ are reflections of $A$ in $BC$ and $CD$, $AE \perp BC$ and $AF \perp CD$. This implies $\angle KAL = 180^{\circ} - \angle BCD$. Thus, $\angle A'KB + \angle A'LD = \angle BCD$. Given $\angle BCD = \angle DAB$, and by reflection $\angle DAB = \angle BA'D$, we conclude $\angle A'KB + \angle A'LD = \angle BA'D$, proving tangency at $A'$.",,,,
2020g4,"In the plane, there are $n \geqslant 6$ pairwise disjoint disks $D_{1}, D_{2}, \ldots, D_{n}$ with radii $R_{1} \geqslant R_{2} \geqslant \ldots \geqslant R_{n}$. For every $i=1,2, \ldots, n$, a point $P_{i}$ is chosen in disk $D_{i}$. Let $O$ be an arbitrary point in the plane. Prove that

$$
O P_{1}+O P_{2}+\ldots+O P_{n} \geqslant R_{6}+R_{7}+\ldots+R_{n} .
$$

(A disk is assumed to contain its boundary.)","We will make use of the following lemma.\\
Lemma. Let $D_{1}, \ldots, D_{6}$ be disjoint disks in the plane with radii $R_{1}, \ldots, R_{6}$. Let $P_{i}$ be a point in $D_{i}$, and let $O$ be an arbitrary point. Then there exist indices $i$ and $j$ such that $O P_{i} \geqslant R_{j}$.\\
Proof. Let $O_{i}$ be the center of $D_{i}$. Consider six rays $O O_{1}, \ldots, O O_{6}$ (if $O=O_{i}$, then the ray $O O_{i}$ may be assumed to have an arbitrary direction). These rays partition the plane into six angles (one of which may be non-convex) whose measures sum up to $360^{\circ}$; hence one of the angles, say $\angle O_{i} O O_{j}$, has measure at most $60^{\circ}$. Then $O_{i} O_{j}$ cannot be the unique largest side in (possibly degenerate) triangle $O O_{i} O_{j}$, so, without loss of generality, $O O_{i} \geqslant O_{i} O_{j} \geqslant R_{i}+R_{j}$. Therefore, $O P_{i} \geqslant O O_{i}-R_{i} \geqslant\left(R_{i}+R_{j}\right)-R_{i}=R_{j}$, as desired.

Now we prove the required inequality by induction on $n \geqslant 5$. The base case $n=5$ is trivial. For the inductive step, apply the Lemma to the six largest disks, in order to find indices $i$ and $j$ such that $1 \leqslant i, j \leqslant 6$ and $O P_{i} \geqslant R_{j} \geqslant R_{6}$. Removing $D_{i}$ from the configuration and applying the inductive hypothesis, we get

$$
\sum_{k \neq i} O P_{k} \geqslant \sum_{\ell \geqslant 7} R_{\ell} .
$$

Adding up this inequality with $O P_{i} \geqslant R_{6}$ we establish the inductive step.\\
Comment 1. It is irrelevant to the problem whether the disks contain their boundaries or not. This condition is included for clarity reasons only. The problem statement remains true, and the solution works verbatim, if the disks are assumed to have disjoint interiors.

Comment 2. There are several variations of the above solution. In particular, while performing the inductive step, one may remove the disk with the largest value of $O P_{i}$ and apply the inductive hypothesis to the remaining disks (the Lemma should still be applied to the six largest disks).

Comment 3. While proving the Lemma, one may reduce it to a particular case when the disks are congruent, as follows: Choose the smallest radius $r$ of the disks in the Lemma statement, and then replace, for each $i$, the $i^{\text {th }}$ disk with its homothetic copy, using the homothety centered at $P_{i}$ with ratio $r / R_{i}$.

This argument shows that the Lemma is tightly connected to a circle packing problem, see, e.g., \href{https://en.wikipedia.org/wiki/Circle_packing_in_a_circle}{https://en.wikipedia.org/wiki/Circle\_packing\_in\_a\_circle}. The known results on that problem provide versions of the Lemma for different numbers of disks, which lead to different inequalities of the same kind. E.g., for 4 disks the best possible estimate in the Lemma is $O P_{i} \geqslant(\sqrt{2}-1) R_{j}$, while for 13 disks it has the form $O P_{i} \geqslant \sqrt{5} R_{j}$. Arguing as in the above solution, one obtains the inequalities

$$
\sum_{i=1}^{n} O P_{i} \geqslant(\sqrt{2}-1) \sum_{j=4}^{n} R_{j} \quad \text { and } \quad \sum_{i=1}^{n} O P_{i} \geqslant \sqrt{5} \sum_{j=13}^{n} R_{j} .
$$

However, there are some harder arguments which allow to improve these inequalities, meaning that the $R_{j}$ with large indices may be taken with much greater factors.",4,"Let $O, A, B$ be three points in a plane forming a (possibly degenerate) triangle. If $\angle AOB \le 60^\circ$, prove that $AB \le \max(OA, OB)$.","By the Law of Cosines, $AB^2 = OA^2 + OB^2 - 2(OA)(OB)\cos(\angle AOB)$. Since $0^\circ \le \angle AOB \le 60^\circ$, we have $\cos(\angle AOB) \ge 1/2$. Thus, $AB^2 \le OA^2 + OB^2 - (OA)(OB)$. Without loss of generality, assume $OA \ge OB$. Then $OA^2+OB^2-(OA)(OB) = OA^2 - (OA-OB)OB \le OA^2$. Therefore, $AB^2 \le OA^2$, which implies $AB \le OA = \max(OA, OB)$.","Let $D_1, \dots, D_6$ be six pairwise disjoint disks in the plane with radii $R_1, \dots, R_6$. For each $i$, let $P_i$ be a point in $D_i$. For an arbitrary point $O$ in the plane, prove that there exist indices $i, j \in \{1, \dots, 6\}$ such that $OP_i \ge R_j$.","Let $O_i$ be the center of disk $D_i$. The six rays $OO_1, \dots, OO_6$ emanating from $O$ divide the plane into six angular regions with angles summing to $360^\circ$. By the pigeonhole principle, at least one of these angles, say $\angle O_iOO_j$, is at most $360^\circ/6 = 60^\circ$. From the result of Sub-problem 1, we have $O_iO_j \le \max(OO_i, OO_j)$. Assume without loss of generality that $OO_i \ge O_iO_j$. Since the disks $D_i$ and $D_j$ are disjoint, the distance between their centers satisfies $O_iO_j \ge R_i+R_j$. Thus, $OO_i \ge R_i+R_j$. By the triangle inequality, we have $OP_i \ge OO_i - O_iP_i$. Since $P_i$ is in disk $D_i$, $O_iP_i \le R_i$. Therefore, $OP_i \ge (R_i+R_j) - R_i = R_j$.","Let there be $n \ge 6$ pairwise disjoint disks $D_1, \dots, D_n$ with radii sorted as $R_1 \ge R_2 \ge \dots \ge R_n$. For any choice of points $P_i \in D_i$ and any point $O$, prove that there exists an index $i \in \{1, \dots, 6\}$ for which $OP_i \ge R_6$.","Consider the six disks with the largest radii, $D_1, \dots, D_6$. By the lemma in Sub-problem 2 applied to these six disks, there exist indices $i, j \in \{1, \dots, 6\}$ such that $OP_i \ge R_j$. Since the radii are sorted in non-increasing order, for any $j \in \{1, \dots, 6\}$, we have $R_j \ge R_6$. Combining these inequalities gives $OP_i \ge R_j \ge R_6$. Thus, for some $i \in \{1, \dots, 6\}$, we have $OP_i \ge R_6$.","In the plane, there are $n \geqslant 6$ pairwise disjoint disks $D_{1}, D_{2}, \ldots, D_{n}$ with radii $R_{1} \geqslant R_{2} \geqslant \ldots \geqslant R_{n}$. For every $i=1,2, \ldots, n$, a point $P_{i}$ is chosen in disk $D_{i}$. Let $O$ be an arbitrary point in the plane. Prove that $O P_{1}+O P_{2}+\ldots+O P_{n} \geqslant R_{6}+R_{7}+\ldots+R_{n}$.","We use mathematical induction on $n \ge 6$. Base Case ($n=6$): We need to show $\sum_{k=1}^6 OP_k \ge R_6$. From Sub-problem 3, there exists an index $i \in \{1, \dots, 6\}$ such that $OP_i \ge R_6$. Since $OP_k \ge 0$ for all $k$, we have $\sum_{k=1}^6 OP_k \ge OP_i \ge R_6$. The base case holds. Inductive Step: Assume the statement is true for $n-1 \ge 6$. We will prove it for $n$. By Sub-problem 3, there is an index $i \in \{1, \dots, 6\}$ such that $OP_i \ge R_6$. Consider the $n-1$ disks $\{D_k\}_{k \ne i}$. The radii of these disks, when sorted, have their sum from the 6th term onwards equal to $R_7 + \dots + R_n$, because $i \le 6$. Applying the induction hypothesis to these $n-1$ disks, we get $\sum_{k \ne i} OP_k \ge R_7 + \dots + R_n$. Adding the inequality for $OP_i$, we have: $\sum_{k=1}^n OP_k = OP_i + \sum_{k \ne i} OP_k \ge R_6 + (R_7 + \dots + R_n) = \sum_{j=6}^n R_j$. This completes the inductive step."
2020g5,"Let $A B C D$ be a cyclic quadrilateral with no two sides parallel. Let $K, L, M$, and $N$ be points lying on sides $A B, B C, C D$, and $D A$, respectively, such that $K L M N$ is a rhombus with $K L \| A C$ and $L M \| B D$. Let $\omega_{1}, \omega_{2}, \omega_{3}$, and $\omega_{4}$ be the incircles of triangles $A N K$, $B K L, C L M$, and $D M N$, respectively. Prove that the internal common tangents to $\omega_{1}$ and $\omega_{3}$ and the internal common tangents to $\omega_{2}$ and $\omega_{4}$ are concurrent.","Let $I_{i}$ be the center of $\omega_{i}$, and let $r_{i}$ be its radius for $i=1,2,3,4$. Denote by $T_{1}$ and $T_{3}$ the points of tangency of $\omega_{1}$ and $\omega_{3}$ with $N K$ and $L M$, respectively. Suppose that the internal common tangents to $\omega_{1}$ and $\omega_{3}$ meet at point $S$, which is the center of homothety $h$ with negative ratio (namely, with ratio $-\frac{r_{3}}{r_{1}}$ ) mapping $\omega_{1}$ to $\omega_{3}$. This homothety takes $T_{1}$ to $T_{3}$ (since the tangents to $\omega_{1}$ and $\omega_{3}$ at $T_{1}$ to $T_{3}$ are parallel), hence $S$ is a point on the segment $T_{1} T_{3}$ with $T_{1} S: S T_{3}=r_{1}: r_{3}$.

Construct segments $S_{1} S_{3} \| K L$ and $S_{2} S_{4} \| L M$ through $S$ with $S_{1} \in N K, S_{2} \in K L$, $S_{3} \in L M$, and $S_{4} \in M N$. Note that $h$ takes $S_{1}$ to $S_{3}$, hence $I_{1} S_{1} \| I_{3} S_{3}$, and $S_{1} S: S S_{3}=r_{1}: r_{3}$. We will prove that $S_{2} S: S S_{4}=r_{2}: r_{4}$ or, equivalently, $K S_{1}: S_{1} N=r_{2}: r_{4}$. This will yield the problem statement; indeed, applying similar arguments to the intersection point $S^{\prime}$ of the internal common tangents to $\omega_{2}$ and $\omega_{4}$, we see that $S^{\prime}$ satisfies similar relations, and there is a unique point inside $K L M N$ satisfying them. Therefore, $S^{\prime}=S$.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_a23604964ee434afd034g-56}

Further, denote by $I_{A}, I_{B}, I_{C}, I_{D}$ and $r_{A}, r_{B}, r_{C}, r_{D}$ the incenters and inradii of triangles $D A B, A B C, B C D$, and $C D A$, respectively. One can shift triangle $C L M$ by $\overrightarrow{L K}$ to glue it with triangle $A K N$ into a quadrilateral $A K C^{\prime} N$ similar to $A B C D$. In particular, this shows that $r_{1}: r_{3}=r_{A}: r_{C}$; similarly, $r_{2}: r_{4}=r_{B}: r_{D}$. Moreover, the same shift takes $S_{3}$ to $S_{1}$, and it also takes $I_{3}$ to the incenter $I_{3}^{\prime}$ of triangle $K C^{\prime} N$. Since $I_{1} S_{1} \| I_{3} S_{3}$, the points $I_{1}, S_{1}, I_{3}^{\prime}$ are collinear. Thus, in order to complete the solution, it suffices to apply the following Lemma to quadrilateral $A K C^{\prime} N$.\\
Lemma 1. Let $A B C D$ be a cyclic quadrilateral, and define $I_{A}, I_{C}, r_{B}$, and $r_{D}$ as above. Let $I_{A} I_{C}$ meet $B D$ at $X$; then $B X: X D=r_{B}: r_{D}$.\\
Proof. Consider an inversion centered at $X$; the images under that inversion will be denoted by primes, e.g., $A^{\prime}$ is the image of $A$.

By properties of inversion, we have

$$
\angle I_{C}^{\prime} I_{A}^{\prime} D^{\prime}=\angle X I_{A}^{\prime} D^{\prime}=\angle X D I_{A}=\angle B D A / 2=\angle B C A / 2=\angle A C I_{B} .
$$

We obtain $\angle I_{A}^{\prime} I_{C}^{\prime} D^{\prime}=\angle C A I_{B}$ likewise; therefore, $\triangle I_{C}^{\prime} I_{A}^{\prime} D^{\prime} \sim \triangle A C I_{B}$. In the same manner, we get $\triangle I_{C}^{\prime} I_{A}^{\prime} B^{\prime} \sim \triangle A C I_{D}$, hence the quadrilaterals $I_{C}^{\prime} B^{\prime} I_{A}^{\prime} D^{\prime}$ and $A I_{D} C I_{B}$ are also similar. But the diagonals $A C$ and $I_{B} I_{D}$ of quadrilateral $A I_{D} C I_{B}$ meet at a point $Y$ such that $I_{B} Y$ :\\
$Y I_{D}=r_{B}: r_{D}$. By similarity, we get $D^{\prime} X: B^{\prime} X=r_{B}: r_{D}$ and hence $B X: X D=D^{\prime} X:$ $B^{\prime} X=r_{B}: r_{D}$.",4,Let S be the intersection of the internal common tangents to ω₁ and ω₃. Let a line through S parallel to KL intersect NK at S₁. Show that the problem of proving the concurrency of all four internal common tangents is equivalent to proving the ratio equality KS₁/S₁N = r₂/r₄.,"The intersection point S is the center of a homothety with a negative ratio mapping ω₁ to ω₃. The concurrency point for the tangents to ω₂ and ω₄ is similarly the center of a homothety mapping ω₂ to ω₄. For these two points to be the same, the point S must satisfy the condition for the second homothety. Let lines through S parallel to the rhombus sides KL and LM intersect the other sides at S₂, S₃, S₄. The concurrency condition is equivalent to S₂S/SS₄ = r₂/r₄. Due to the geometry of the rhombus and the parallel lines, S₂S/SS₄ = KS₁/S₁N. Thus, the problem reduces to proving KS₁/S₁N = r₂/r₄.","Let r_A, r_B, r_C, r_D be the inradii of triangles DAB, ABC, BCD, and CDA, respectively. Show that the ratios of the inradii of the corner triangles satisfy r₁/r₃ = r_A/r_C and r₂/r₄ = r_B/r_D.","From the parallel conditions KL || AC and LM || BD, we have four pairs of similar triangles: ΔANK ~ ΔADB, ΔBKL ~ ΔBAC, ΔCLM ~ ΔCBD, and ΔDMN ~ ΔDCA. Let the side length of the rhombus KLMN be s. The ratios of similarity are given by the ratio of corresponding side lengths. For example, NK/DB = s/DB for ΔANK ~ ΔADB and LM/BD = s/BD for ΔCLM ~ ΔCBD. The ratio of inradii of similar triangles equals their side length ratio. Thus, r₁/r_A = s/BD and r₃/r_C = s/BD, which implies r₁/r₃ = r_A/r_C. Similarly, r₂/r_B = s/AC and r₄/r_D = s/AC, which implies r₂/r₄ = r_B/r_D.","Let ABCD be a cyclic quadrilateral. Let I_A and I_C be the incenters of ΔDAB and ΔBCD, and let r_B and r_D be the inradii of ΔABC and ΔCDA. Prove that the line I_A I_C intersects the diagonal BD at a point X such that BX/XD = r_B/r_D.","Let X be the intersection of I_A I_C and BD. Consider an inversion centered at X, mapping a point P to P'. Using angle chasing based on the properties of incenters and cyclic quadrilaterals, along with the angle-preserving property of inversion, we establish the similarity of quadrilaterals I_C'B'I_A'D' ~ A I_D C I_B. In quadrilateral A I_D C I_B, its diagonals AC and I_B I_D meet at a point Y such that I_B Y : Y I_D = r_B : r_D. By similarity, the corresponding ratio of segments along the diagonal in the inverted quadrilateral is D'X : B'X = r_B : r_D. As inversion gives BX/XD = D'X/B'X, we conclude that BX/XD = r_B/r_D.","Let A B C D be a cyclic quadrilateral with no two sides parallel. Let K, L, M, and N be points lying on sides A B, B C, C D, and D A, respectively, such that K L M N is a rhombus with K L ∥ A C and L M ∥ B D. Let ω₁, ω₂, ω₃, and ω₄ be the incircles of triangles A N K, B K L, C L M, and D M N, respectively. Prove that the internal common tangents to ω₁ and ω₃ and the internal common tangents to ω₂ and ω₄ are concurrent.","From Sub-problem 1, the concurrency holds if KS₁/S₁N = r₂/r₄. From Sub-problem 2, we have r₂/r₄ = r_B/r_D. Thus, we need to prove KS₁/S₁N = r_B/r_D. By shifting ΔCLM by vector LK, we form a quadrilateral AKC'N similar to ABCD. Let I₁ and I₃' be the incenters of ΔANK and the shifted triangle ΔC'KN. The point S₁ lies on the line I₁I₃'. Therefore, S₁ is the intersection of the line connecting these two incenters with the diagonal KN. Applying the lemma from Sub-problem 3 to the quadrilateral AKC'N, we get KS₁/S₁N = r_B'/r_D', where r_B', r_D' correspond to r_B, r_D. Due to similarity, r_B'/r_D' = r_B/r_D. Thus, KS₁/S₁N = r_B/r_D = r₂/r₄, which completes the proof."
2020g6,"Let $I$ and $I_{A}$ be the incenter and the $A$-excenter of an acute-angled triangle $A B C$ with $A B<A C$. Let the incircle meet $B C$ at $D$. The line $A D$ meets $B I_{A}$ and $C I_{A}$ at $E$ and $F$, respectively. Prove that the circumcircles of triangles $A I D$ and $I_{A} E F$ are tangent to each other.","Let $\Varangle(p, q)$ denote the directed angle between lines $p$ and $q$.\\
The points $B, C, I$, and $I_{A}$ lie on the circle $\Gamma$ with diameter $I I_{A}$. Let $\omega$ and $\Omega$ denote the circles $\left(I_{A} E F\right)$ and $(A I D)$, respectively. Let $T$ be the second intersection point of $\omega$ and $\Gamma$. Then $T$ is the Miquel point of the complete quadrilateral formed by the lines $B C, B I_{A}, C I_{A}$, and $D E F$, so $T$ also lies on circle $(B D E)$ (as well as on circle $(C D F)$ ). We claim that $T$ is a desired tangency point of $\omega$ and $\Omega$.

In order to show that $T$ lies on $\Omega$, use cyclic quadrilaterals $B D E T$ and $B I I_{A} T$ to write

$$
\Varangle(D T, D A)=\Varangle(D T, D E)=\Varangle(B T, B E)=\Varangle\left(B T, B I_{A}\right)=\Varangle\left(I T, I I_{A}\right)=\Varangle(I T, I A) .
$$

\begin{center}
\includegraphics[max width=\textwidth]{2025_04_29_a23604964ee434afd034g-60}
\end{center}

To show that $\omega$ and $\Omega$ are tangent at $T$, let $\ell$ be the tangent to $\omega$ at $T$, so that $\Varangle\left(T I_{A}, \ell\right)=$ $\Varangle\left(E I_{A}, E T\right)$. Using circles $(B D E T)$ and $\left(B I C I_{A}\right)$, we get

$$
\Varangle\left(E I_{A}, E T\right)=\Varangle(E B, E T)=\Varangle(D B, D T) .
$$

Therefore,

$$
\Varangle(T I, \ell)=90^{\circ}+\Varangle\left(T I_{A}, \ell\right)=90^{\circ}+\Varangle(D B, D T)=\Varangle(D I, D T),
$$

which shows that $\ell$ is tangent to $\Omega$ at $T$.\\",2,"Let $\omega$ be the circumcircle of $\triangle I_{A} E F$ and $\Gamma$ be the circle passing through $B, C, I, I_{A}$. Let $T$ be the second intersection of $\omega$ and $\Gamma$. Prove that $T$ lies on the circumcircle of $\triangle A I D$.","Let $\Varangle(p, q)$ denote the directed angle between lines $p$ and $q$. The point $T$ is the Miquel point of the complete quadrilateral formed by lines $BC, BI_A, CI_A,$ and $AD$. Thus, $T$ also lies on the circumcircle of $\triangle BDE$. Using the fact that quadrilaterals $BDET$ and $BII_AT$ are cyclic, we get $\Varangle(D T, D A)=\Varangle(D T, D E)=\Varangle(B T, B E)=\Varangle(B T, B I_{A})=\Varangle(I T, I I_{A})=\Varangle(I T, I A)$. This equality implies that the points $A, I, D, T$ are concyclic. Therefore, $T$ lies on the circumcircle of $\triangle A I D$.",Prove that the circumcircles of triangles $A I D$ and $I_{A} E F$ are tangent to each other.,"Let $\Omega$ be the circumcircle of $\triangle AID$ and $\omega$ be the circumcircle of $\triangle I_AEF$. From the previous sub-problem, they share a point $T$. Let $\ell$ be the tangent to $\omega$ at $T$. By the tangent-chord theorem, $\Varangle(T I_{A}, \ell) = \Varangle(E I_{A}, E T)$. Since $B, D, E, T$ are concyclic, $\Varangle(E I_{A}, E T) = \Varangle(E B, E T) = \Varangle(D B, D T)$. As $T$ lies on the circle with diameter $II_A$, $\angle ITI_A = 90^\circ$. Also, $ID \perp BC$, so $\angle IDB = 90^\circ$. Using directed angles, $\Varangle(T I, \ell) = \Varangle(T I, T I_A) + \Varangle(T I_A, \ell) = 90^\circ + \Varangle(D B, D T)$. Also, $\Varangle(D I, D T) = \Varangle(D I, D B) + \Varangle(D B, D T) = 90^\circ + \Varangle(D B, D T)$. Thus, $\Varangle(T I, \ell) = \Varangle(D I, D T)$, which proves that $\ell$ is also tangent to $\Omega$ at $T$. Since the circles share a common tangent at their intersection point $T$, they are tangent to each other.",,,,
2020g7,"Let $P$ be a point on the circumcircle of an acute-angled triangle $A B C$. Let $D$, $E$, and $F$ be the reflections of $P$ in the midlines of triangle $A B C$ parallel to $B C, C A$, and $A B$, respectively. Denote by $\omega_{A}, \omega_{B}$, and $\omega_{C}$ the circumcircles of triangles $A D P, B E P$, and $C F P$, respectively. Denote by $\omega$ the circumcircle of the triangle formed by the perpendicular bisectors of segments $A D, B E$ and $C F$.

Show that $\omega_{A}, \omega_{B}, \omega_{C}$, and $\omega$ have a common point.","Solution. Let $A A_{1}, B B_{1}$, and $C C_{1}$ be the altitudes in triangle $A B C$, and let $m_{A}, m_{B}$, and $m_{C}$ be the midlines parallel to $B C, C A$, and $A B$, respectively. We always denote by $\Varangle(p, q)$ the directed angle from a line $p$ to a line $q$, taken modulo $180^{\circ}$.

Step 1: Circles $\omega_{A}, \omega_{B}$, and $\omega_{C}$ share a common point $Q$ different from $P$.\\
Notice that $m_{A}$ is the perpendicular bisector of $P D$, so $\omega_{A}$ is symmetric with respect to $m_{A}$. Since $A$ and $A_{1}$ are also symmetric to each other in $m_{A}$, the point $A_{1}$ lies on $\omega_{A}$. Similarly, $B_{1}$ and $C_{1}$ lie on $\omega_{B}$ and $\omega_{C}$, respectively.

Let $H$ be the orthocenter of $\triangle A B C$. Quadrilaterals $A B A_{1} B_{1}$ and $B C B_{1} C_{1}$ are cyclic, so $A H \cdot H A_{1}=B H \cdot H B_{1}=C H \cdot H C_{1}$. This means that $H$ lies on pairwise radical axes of $\omega_{A}$, $\omega_{B}$, and $\omega_{C}$. Point $P$ also lies on those radical axes; hence the three circles have a common radical axis $\ell=P H$, and the second meeting point $Q$ of $\ell$ with $\omega_{A}$ is the second common point of the three circles. Notice here that $H$ lies inside all three circles, hence $Q \neq P$.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_a23604964ee434afd034g-64}

\section*{Step 2: Point $Q$ lies on $\omega$.}
Let $p_{A}, p_{B}$, and $p_{C}$ denote the perpendicular bisectors of $A D, B E$, and $C F$, respectively; denote by $\Delta$ the triangle formed by those perpendicular bisectors. By Simson's theorem, in order to show that $Q$ lies on the circumcircle $\omega$ of $\Delta$, it suffices to prove that the projections of $Q$ onto the sidelines $p_{A}, p_{B}$, and $p_{C}$ are collinear. Alternatively, but equivalently, it suffices to prove that the reflections $Q_{A}, Q_{B}$, and $Q_{C}$ of $Q$ in those lines, respectively, are collinear. In fact, we will show that four points $P, Q_{A}, Q_{B}$, and $Q_{C}$ are collinear.

Since $p_{A}$ is the common perpendicular bisector of $A D$ and $Q Q_{A}$, the point $Q_{A}$ lies on $\omega_{A}$, and, moreover, $\Varangle\left(D A, D Q_{A}\right)=\Varangle(A Q, A D)$. Therefore,

$$
\Varangle\left(P A, P Q_{A}\right)=\Varangle\left(D A, D Q_{A}\right)=\Varangle(A Q, A D)=\Varangle(P Q, P D)=\Varangle(P Q, B C)+90^{\circ} .
$$

Similarly, we get $\Varangle\left(P B, P Q_{B}\right)=\Varangle(P Q, C A)+90^{\circ}$. Therefore,

$$
\begin{aligned}
\Varangle\left(P Q_{A}, P Q_{B}\right)=\Varangle\left(P Q_{A}, P A\right) & +\Varangle(P A, P B)+\Varangle\left(P B, P Q_{B}\right) \\
& =\Varangle(B C, P Q)+90^{\circ}+\Varangle(C A, C B)+\Varangle(P Q, C A)+90^{\circ}=0,
\end{aligned}
$$

which shows that $P, Q_{A}$, and $Q_{B}$ are collinear. Similarly, $Q_{C}$ also lies on $P Q_{A}$.\\
Comment 1. There are several variations of Step 2. In particular, let $O_{A}, O_{B}$, and $O_{C}$ denote the centers of $\omega_{A}, \omega_{B}$, and $\omega_{C}$, respectively; they lie on $p_{A}, p_{B}$, and $p_{C}$, respectively. Moreover, all those centers lie on the perpendicular bisector $p$ of $P Q$. Now one can show that $\Varangle\left(Q O_{A}, p_{A}\right)=$ $\Varangle\left(Q O_{B}, p_{B}\right)=\Varangle\left(Q O_{C}, p_{C}\right)$, and then finish by applying generalized Simson's theorem, Alternatively, but equivalently, those relations show that $Q$ is the Miquel point of the lines $p_{A}, p_{B}, p_{C}$, and $p$.

To establish $\Varangle\left(Q O_{A}, p_{A}\right)=\Varangle\left(Q O_{C}, p_{C}\right)$, notice that it is equivalent to $\Varangle\left(Q O_{A}, Q O_{C}\right)=\Varangle\left(p_{A}, p_{C}\right)$ which may be obtained, e.g., as follows:

$$
\begin{aligned}
& \Varangle\left(Q O_{A}, Q O_{C}\right)=\Varangle\left(Q O_{A}, p\right)+\Varangle\left(p, Q O_{C}\right)=\Varangle(A Q, A P)+\Varangle(C P, C Q) \\
& =\Varangle(A Q, C Q)+\Varangle(C P, A P)=\Varangle(A Q, P Q)+\Varangle(P Q, C Q)+\Varangle(C B, A B) \\
& \quad=\Varangle\left(A D, A A_{1}\right)+\Varangle\left(C C_{1}, C F\right)+\Varangle\left(A A_{1}, C C_{1}\right)=\Varangle(A D, C F)=\Varangle\left(p_{A}, p_{C}\right) .
\end{aligned}
$$

\begin{center}
\includegraphics[max width=\textwidth]{2025_04_29_a23604964ee434afd034g-65}
\end{center}

Comment 2. The inversion at $H$ with (negative) power $-A H \cdot H A_{1}$ maps $P$ to $Q$, and the circumcircle of $\triangle A B C$ to its Euler circle. Therefore, $Q$ lies on that Euler circle.",4,"Let $A_1, B_1, C_1$ be the feet of the altitudes from vertices $A, B, C$ in $\triangle ABC$. Show that $A_1$ lies on $\omega_A$, $B_1$ lies on $\omega_B$, and $C_1$ lies on $\omega_C$.","The midline $m_A$ (parallel to $BC$) is the perpendicular bisector of the segment $AA_1$. The circle $\omega_A$ passes through $A, P$, and $D$, where $D$ is the reflection of $P$ in $m_A$. Thus, $\omega_A$ is symmetric with respect to $m_A$. Since $A$ lies on $\omega_A$, its reflection in $m_A$, which is $A_1$, must also lie on $\omega_A$. Similarly, $B_1$ lies on $\omega_B$ and $C_1$ lies on $\omega_C$.","Show that the circles $\omega_{A}, \omega_{B}, \omega_{C}$ have a common point $Q$ other than $P$.","Let $H$ be the orthocenter of $\triangle ABC$. From Sub-problem 1, the feet of the altitudes $A_1, B_1, C_1$ lie on $\omega_A, \omega_B, \omega_C$ respectively. The power of $H$ with respect to $\omega_A$ is $HA \cdot HA_1$. A known property of the orthocenter is $HA \cdot HA_1 = HB \cdot HB_1 = HC \cdot HC_1$. Thus, $H$ has equal power with respect to $\omega_A, \omega_B, \omega_C$, and so lies on their radical axes. Since $P$ is a common point to all three circles, the line $PH$ is their common radical axis. Therefore, the three circles are coaxial and share a second common point $Q$ on the line $PH$.","Let $Q$ be the common point of $\omega_A, \omega_B, \omega_C$ other than $P$. Let $p_A, p_B$ be the perpendicular bisectors of $AD$ and $BE$. Let $Q_A, Q_B$ be the reflections of $Q$ in $p_A, p_B$. Show that $P, Q_A, Q_B$ are collinear.","The perpendicular bisector $p_A$ of $AD$ is an axis of symmetry for circle $\omega_A$. Since $Q$ is on $\omega_A$, its reflection $Q_A$ across $p_A$ is also on $\omega_A$. Using directed angles modulo $180^\circ$, we find $\Varangle(PA, PQ_A) = \Varangle(PQ, PD)$. Since $D$ is the reflection of $P$ in midline $m_A \parallel BC$, we have $PD \perp BC$, so $\Varangle(PA, PQ_A) = \Varangle(PQ, BC) + 90^\circ$. Similarly, $\Varangle(PB, PQ_B) = \Varangle(PQ, CA) + 90^\circ$. Then $\Varangle(PQ_A, PQ_B) = \Varangle(PQ_A, PA) + \Varangle(PA, PB) + \Varangle(PB, PQ_B) = -(\Varangle(PQ, BC)+90^\circ) + \Varangle(CA, CB) + (\Varangle(PQ, CA)+90^\circ) = \Varangle(BC, PQ) + \Varangle(PQ, CA) + \Varangle(CA, CB) = 0$. Therefore, $P, Q_A, Q_B$ are collinear.","Show that $\omega_{A}, \omega_{B}, \omega_{C}$, and $\omega$ have a common point.","From Sub-problem 2, circles $\omega_A, \omega_B, \omega_C$ share a common point $Q$ (other than $P$). Let $p_A, p_B, p_C$ be the perpendicular bisectors forming the triangle whose circumcircle is $\omega$. Let $Q_A, Q_B, Q_C$ be the reflections of $Q$ in lines $p_A, p_B, p_C$. Sub-problem 3 shows that $P, Q_A, Q_B$ are collinear. By symmetry, $P, Q_B, Q_C$ are also collinear. Thus, $Q_A, Q_B, Q_C$ are collinear. By the converse of Simson's theorem, a point lies on the circumcircle of a triangle if its reflections across the triangle's sidelines are collinear. Therefore, $Q$ lies on $\omega$. As $Q$ is already a common point of $\omega_A, \omega_B, \omega_C$, it is the common point for all four circles."
2020g8,"Let $\Gamma$ and $I$ be the circumcircle and the incenter of an acute-angled triangle $A B C$. Two circles $\omega_{B}$ and $\omega_{C}$ passing through $B$ and $C$, respectively, are tangent at $I$. Let $\omega_{B}$ meet the shorter arc $A B$ of $\Gamma$ and segment $A B$ again at $P$ and $M$, respectively. Similarly, let $\omega_{C}$ meet the shorter arc $A C$ of $\Gamma$ and segment $A C$ again at $Q$ and $N$, respectively. The rays $P M$ and $Q N$ meet at $X$, and the tangents to $\omega_{B}$ and $\omega_{C}$ at $B$ and $C$, respectively, meet at $Y$.

Prove that the points $A, X$, and $Y$ are collinear.","Let $A I, B I$, and $C I$ meet $\Gamma$ again at $D, E$, and $F$, respectively. Let $\ell$ be the common tangent to $\omega_{B}$ and $\omega_{C}$ at $I$. We always denote by $\Varangle(p, q)$ the directed angle from a line $p$ to a line $q$, taken modulo $180^{\circ}$.

Step 1: We show that $Y$ lies on $\Gamma$.\\
Recall that any chord of a circle makes complementary directed angles with the tangents to the circle at its endpoints. Hence,

$$
\Varangle(B Y, B I)+\Varangle(C I, C Y)=\Varangle(I B, \ell)+\Varangle(\ell, I C)=\Varangle(I B, I C) .
$$

Therefore,

$$
\begin{aligned}
\Varangle(B Y, B A)+\Varangle(C A, C Y)=\Varangle(B I, B A)+ & \Varangle \\
& (B Y, B I)+\Varangle(C I, C Y)+\Varangle(C A, C I) \\
& =\Varangle(B C, B I)+\Varangle(I B, I C)+\Varangle(C I, C B)=0,
\end{aligned}
$$

which yields $Y \in \Gamma$.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_a23604964ee434afd034g-66}

Step 2: We show that $X=\ell \cap E F$.\\
Let $X_{*}=\ell \cap E F$. To prove our claim, it suffices to show that $X_{*}$ lies on both $P M$ and $Q N$; this will yield $X_{*}=X$. Due to symmetry, it suffices to show $X_{*} \in Q N$.

Notice that

$$
\Varangle\left(I X_{*}, I Q\right)=\Varangle(C I, C Q)=\Varangle(C F, C Q)=\Varangle(E F, E Q)=\Varangle\left(E X_{*}, E Q\right) ;
$$

therefore, the points $X_{*}, I, Q$, and $E$ are concyclic (if $Q=E$, then the direction of $E Q$ is supposed to be the direction of a tangent to $\Gamma$ at $Q$; in this case, the equality means that the circle $\left(X_{*} I Q\right)$ is tangent to $\Gamma$ at $\left.Q\right)$. Then we have

$$
\Varangle\left(Q X_{*}, Q I\right)=\Varangle\left(E X_{*}, E I\right)=\Varangle(E F, E B)=\Varangle(C A, C F)=\Varangle(C N, C I)=\Varangle(Q N, Q I),
$$

which shows that $X_{*} \in Q N$.\\
Step 3: We finally show that $A, X$, and $Y$ are collinear.\\
Recall that $I$ is the orthocenter of triangle $D E F$, and $A$ is symmetric to $I$ with respect to $E F$. Therefore,

$$
\Varangle(A X, A E)=\Varangle(I E, I X)=\Varangle(B I, \ell)=\Varangle(B Y, B I)=\Varangle(B Y, B E)=\Varangle(A Y, A E),
$$

which yields the desired collinearity.\\
Comment 1. Step 2 in the above solution seems to be crucial. After it has been performed (even without Step 1), there are different ways of finishing the solution.\\
E.g., one may involve the notion of isogonal conjugacy. Let $X_{1}$ and $Y_{1}$ be isogonal conjugates of $X$ and $Y$, respectively, with respect to triangle $A B C$. Since $X A=X I$, triangle $A I X$ is isosceles, and hence the lines $A X$ and $X I$ form equal angles with the internal bisector $A I$ of $\angle B A C$. This means that $A X_{1} \| X I$, or $A X_{1} \| \ell$.

On the other hand, the lines $B Y$ and $\ell$ form equal angles with $B I$, so that $B Y_{1} \| \ell$. Similarly, $C Y_{1} \| \ell$. This means that $Y_{1}$ is an ideal point, and $A Y_{1} \| \ell$ as well. Therefore, points $A, X_{1}$, and $Y_{1}$ are collinear, and hence $A, X$, and $Y$ are such.",4,Let $Y$ be the intersection of the tangent to $\omega_B$ at $B$ and the tangent to $\omega_C$ at $C$. Prove that $Y$ lies on the circumcircle $\Gamma$ of triangle $A B C$.,"Let $\ell$ be the common tangent to $\omega_B$ and $\omega_C$ at $I$. Using directed angles modulo $180^\circ$, the tangency conditions give $\Varangle(BY, BI) = \Varangle(IB, \ell)$ and $\Varangle(CI, CY) = \Varangle(\ell, IC)$. Summing them yields $\Varangle(BY, BI) + \Varangle(CI, CY) = \Varangle(IB, IC)$. For points $A,B,C,Y$ to be concyclic, we need to show $\Varangle(BY, BA) + \Varangle(CA, CY) = 0$. This sum is $\Varangle(BY, BI) + \Varangle(BI, BA) + \Varangle(CA, CI) + \Varangle(CI, CY) = \Varangle(IB, IC) + \Varangle(BC, BI) + \Varangle(CI, CB) = \Varangle(BC, CB) = 0$. Thus, $Y$ lies on $\Gamma$.","Let $E, F$ be the second intersections of the angle bisectors $BI, CI$ with the circumcircle $\Gamma$, respectively. Let $\ell$ be the common tangent to $\omega_B, \omega_C$ at $I$. Let $X$ be the intersection of rays $PM$ and $QN$. Prove that $X$ is the intersection of $\ell$ and the line $EF$.","Let $X_* = \ell \cap EF$. By symmetry, we only need to show $X_* \in QN$. Using directed angles, $\Varangle(IX_*, IQ) = \Varangle(CI, CQ) = \Varangle(CF, CQ) = \Varangle(EF, EQ) = \Varangle(EX_*, EQ)$. This implies that the points $X_*, I, Q, E$ are concyclic. From this concyclicity, we have $\Varangle(QX_*, QI) = \Varangle(EX_*, EI) = \Varangle(EF, EB)$. Since $F$ is the midpoint of arc $AB$, we have arc $AF = BF$, so $\Varangle(EF, EB) = \Varangle(CA, CF)$. Also, $\Varangle(CA, CF) = \Varangle(CN, CI) = \Varangle(QN, QI)$. Thus, $\Varangle(QX_*, QI) = \Varangle(QN, QI)$, which proves that $Q, N, X_*$ are collinear. Therefore, $X = X_*$.","Let $E, F$ be the second intersections of the angle bisectors $BI, CI$ with the circumcircle $\Gamma$, respectively. Prove that point $A$ is the reflection of the incenter $I$ across the line $EF$.","$E$ is the second intersection of $BI$ with $\Gamma$, making it the midpoint of arc $AC$ not containing $B$. Thus $EA=EC$. Also, $\angle EIC = \angle IAC + \angle ICA = A/2 + C/2$. In $\triangle ABC$, $\angle ECI = \angle ECB + \angle BCI = \angle EAB + C/2 = A/2+C/2$. So $\triangle EIC$ is isosceles with $EI=EC$. This gives $EA=EI$. Similarly, $F$ is the midpoint of arc $AB$, so $FA=FB$, and an angle chase shows $FA=FI$. Since both $E$ and $F$ are equidistant from $A$ and $I$, $EF$ is the perpendicular bisector of the segment $AI$. Thus, $A$ is the reflection of $I$ across $EF$.","Prove that the points $A, X$, and $Y$ are collinear.","From the previous sub-problems, $Y \in \Gamma$, $X$ lies on the line $EF$, and $A$ is the reflection of $I$ across $EF$. Let $\ell$ be the common tangent at $I$. The reflection across $EF$ maps $I \to A$ while fixing $X$ and $E$. This reflection reverses the orientation of angles, so using directed angles, $\Varangle(AX, AE) = -\Varangle(IX, IE) = \Varangle(IE, IX)$. The line $IE$ is the same as $BE$, and the line $IX$ is $\ell$ since $X = \ell \cap EF$. Thus, $\Varangle(IE, IX) = \Varangle(BI, \ell)$. From the tangency of $\omega_B$, $\Varangle(BI, \ell) = \Varangle(BY, BI) = \Varangle(BY, BE)$. Since $A, B, Y, E$ are on $\Gamma$, $\Varangle(BY, BE) = \Varangle(AY, AE)$. Combining these equalities, we get $\Varangle(AX, AE) = \Varangle(AY, AE)$, which implies that $A, X, Y$ are collinear."
2020g9,"Prove that there exists a positive constant $c$ such that the following statement is true:

Assume that $n$ is an integer with $n \geqslant 2$, and let $\mathcal{S}$ be a set of $n$ points in the plane such that the distance between any two distinct points in $\mathcal{S}$ is at least 1 . Then there is a line $\ell$ separating $\mathcal{S}$ such that the distance from any point of $\mathcal{S}$ to $\ell$ is at least $c n^{-1 / 3}$.\\
(A line $\ell$ separates a point set $\mathcal{S}$ if some segment joining two points in $\mathcal{S}$ crosses $\ell$.)","Solution. We prove that the desired statement is true with $c=\frac{1}{8}$. Set $\delta=\frac{1}{8} n^{-1 / 3}$. For any line $\ell$ and any point $X$, let $X_{\ell}$ denote the projection of $X$ to $\ell$; a similar notation applies to sets of points.

Suppose that, for some line $\ell$, the set $\mathcal{S}_{\ell}$ contains two adjacent points $X$ and $Y$ with $X Y=2 d$. Then the line perpendicular to $\ell$ and passing through the midpoint of segment $X Y$ separates $\mathcal{S}$, and all points in $\mathcal{S}$ are at least $d$ apart from $\ell$. Thus, if $d \geqslant \delta$, then a desired line has been found. For the sake of contradiction, we assume that no such points exist, in any projection.

Choose two points $A$ and $B$ in $\mathcal{S}$ with the maximal distance $M=A B$ (i.e., $A B$ is a diameter of $\mathcal{S}$ ); by the problem condition, $M \geqslant 1$. Denote by $\ell$ the line $A B$. The set $\mathcal{S}$ is contained in the intersection of two disks $D_{A}$ and $D_{B}$ of radius $M$ centered at $A$ and $B$, respectively. Hence, the projection $\mathcal{S}_{\ell}$ is contained in the segment $A B$. Moreover, the points in $\mathcal{S}_{\ell}$ divide that segment into at most $n-1$ parts, each of length less than $2 \delta$. Therefore,


\begin{equation*}
M<n \cdot 2 \delta . \tag{1}
\end{equation*}


\begin{center}
\includegraphics[max width=\textwidth]{2025_04_29_a23604964ee434afd034g-69}
\end{center}

Choose a point $H$ on segment $A B$ with $A H=\frac{1}{2}$. Let $P$ be a strip between the lines $a$ and $h$ perpendicular to $A B$ and passing through $A$ and $H$, respectively; we assume that $P$ contains its boundary, which consists of lines $a$ and $h$. Set $\mathcal{T}=P \cap \mathcal{S}$ and let $t=|\mathcal{T}|$. By our assumption, segment $A H$ contains at least $\left\lceil\frac{1}{2}:(2 \delta)\right\rceil$ points of $S_{\ell}$, which yields


\begin{equation*}
t \geqslant \frac{1}{4 \delta} . \tag{2}
\end{equation*}


Notice that $\mathcal{T}$ is contained in $Q=P \cap D_{B}$. The set $Q$ is a circular segment, and its projection $Q_{a}$ is a line segment of length

$$
2 \sqrt{M^{2}-\left(M-\frac{1}{2}\right)^{2}}<2 \sqrt{M}
$$

On the other hand, for any two points $X, Y \in \mathcal{T}$, we have $X Y \geqslant 1$ and $X_{\ell} Y_{\ell} \leqslant \frac{1}{2}$, so $X_{a} Y_{a}=$ $\sqrt{X Y^{2}-X_{\ell} Y_{\ell}^{2}} \geqslant \frac{\sqrt{3}}{2}$. To summarize, $t$ points constituting $\mathcal{T}_{a}$ lie on the segment of length less than $2 \sqrt{M}$, and are at least $\frac{\sqrt{3}}{2}$ apart from each other. This yields $2 \sqrt{M}>(t-1) \frac{\sqrt{3}}{2}$, or


\begin{equation*}
t<1+\frac{4 \sqrt{M}}{\sqrt{3}}<4 \sqrt{M}, \tag{3}
\end{equation*}


as $M \geqslant 1$.\\
Combining the estimates (1), (2), and (3), we finally obtain

$$
\frac{1}{4 \delta} \leqslant t<4 \sqrt{M}<4 \sqrt{2 n \delta}, \quad \text { or } \quad 512 n \delta^{3}>1
$$

which does not hold for the chosen value of $\delta$.\\
Comment 1. As the proposer mentions, the exponent $-1 / 3$ in the problem statement is optimal. In fact, for any $n \geqslant 2$, there is a configuration $\mathcal{S}$ of $n$ points in the plane such that any two points in $\mathcal{S}$ are at least 1 apart, but every line $\ell$ separating $\mathcal{S}$ is at most $c^{\prime} n^{-1 / 3} \log n$ apart from some point in $\mathcal{S}$; here $c^{\prime}$ is some absolute constant.

The original proposal suggested to prove the estimate of the form $c n^{-1 / 2}$. That version admits much easier solutions. E.g., setting $\delta=\frac{1}{16} n^{-1 / 2}$ and applying (1), we see that $\mathcal{S}$ is contained in a disk $D$ of radius $\frac{1}{8} n^{1 / 2}$. On the other hand, for each point $X$ of $\mathcal{S}$, let $D_{X}$ be the disk of radius $\frac{1}{2}$ centered at $X$; all these disks have disjoint interiors and lie within the disk concentric to $D$, of radius $\frac{1}{16} n^{1 / 2}+\frac{1}{2}<\frac{1}{2} n^{1 / 2}$. Comparing the areas, we get

$$
n \cdot \frac{\pi}{4} \leqslant \pi\left(\frac{n^{1 / 2}}{16}+\frac{1}{2}\right)^{2}<\frac{\pi n}{4}
$$

which is a contradiction.\\
The Problem Selection Committee decided to choose a harder version for the Shortlist.\\
Comment 2. In this comment, we discuss some versions of the solution above, which avoid concentrating on the diameter of $\mathcal{S}$. We start with introducing some terminology suitable for those versions.

Put $\delta=c n^{-1 / 3}$ for a certain sufficiently small positive constant $c$. For the sake of contradiction, suppose that, for some set $\mathcal{S}$ satisfying the conditions in the problem statement, there is no separating line which is at least $\delta$ apart from each point of $\mathcal{S}$.

Let $C$ be the convex hull of $\mathcal{S}$. A line is separating if and only if it meets $C$ (we assume that a line passing through a point of $\mathcal{S}$ is always separating). Consider a strip between two parallel separating lines $a$ and $a^{\prime}$ which are, say, $\frac{1}{4}$ apart from each other. Define a slice determined by the strip as the intersection of $\mathcal{S}$ with the strip. The length of the slice is the diameter of the projection of the slice to $a$.

In this terminology, the arguments used in the proofs of (2) and (3) show that for any slice $\mathcal{T}$ of length $L$, we have


\begin{equation*}
\frac{1}{8 \delta} \leqslant|\mathcal{T}| \leqslant 1+\frac{4}{\sqrt{15}} L \tag{4}
\end{equation*}


The key idea of the solution is to apply these estimates to a peel slice, where line $a$ does not cross the interior of $C$. In the above solution, this idea was applied to one carefully chosen peel slice. Here, we outline some different approach involving many of them. We always assume that $n$ is sufficiently large.

Consider a peel slice determined by lines $a$ and $a^{\prime}$, where $a$ contains no interior points of $C$. We orient $a$ so that $C$ lies to the left of $a$. Line $a$ is called a supporting line of the slice, and the obtained direction is the direction of the slice; notice that the direction determines uniquely the supporting line and hence the slice. Fix some direction $\mathbf{v}_{0}$, and for each $\alpha \in[0,2 \pi)$ denote by $\mathcal{T}_{\alpha}$ the peel slice whose direction is $\mathbf{v}_{0}$ rotated by $\alpha$ counterclockwise.

When speaking about the slice, we always assume that the figure is rotated so that its direction is vertical from the bottom to the top; then the points in $\mathcal{T}$ get a natural order from the bottom to the top. In particular, we may speak about the top half $\mathrm{T}(\mathcal{T})$ consisting of $\lfloor|\mathcal{T}| / 2\rfloor$ topmost points in $\mathcal{T}$, and similarly about its bottom half $\mathrm{B}(\mathcal{T})$. By (4), each half contains at least 10 points when $n$ is large. Claim. Consider two angles $\alpha, \beta \in[0, \pi / 2]$ with $\beta-\alpha \geqslant 40 \delta=$ : $\phi$. Then all common points of $\mathcal{T}_{\alpha}$ and $\mathcal{T}_{\beta}$ lie in $\mathrm{T}\left(\mathcal{T}_{\alpha}\right) \cap \mathrm{B}\left(\mathcal{T}_{\beta}\right)$.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_a23604964ee434afd034g-71}

Proof. By symmetry, it suffices to show that all those points lie in $\mathrm{T}\left(\mathcal{T}_{\alpha}\right)$. Let $a$ be the supporting line of $\mathcal{T}_{\alpha}$, and let $\ell$ be a line perpendicular to the direction of $\mathcal{T}_{\beta}$. Let $P_{1}, \ldots, P_{k}$ list all points in $\mathcal{T}_{\alpha}$, numbered from the bottom to the top; by (4), we have $k \geqslant \frac{1}{8} \delta^{-1}$.

Introduce the Cartesian coordinates so that the (oriented) line $a$ is the $y$-axis. Let $P_{i}$ be any point in $\mathrm{B}\left(\mathcal{T}_{\alpha}\right)$. The difference of ordinates of $P_{k}$ and $P_{i}$ is at least $\frac{\sqrt{15}}{4}(k-i)>\frac{1}{3} k$, while their abscissas differ by at most $\frac{1}{4}$. This easily yields that the projections of those points to $\ell$ are at least

$$
\frac{k}{3} \sin \phi-\frac{1}{4} \geqslant \frac{1}{24 \delta} \cdot 20 \delta-\frac{1}{4}>\frac{1}{4}
$$

apart from each other, and $P_{k}$ is closer to the supporting line of $\mathcal{T}_{\beta}$ than $P_{i}$, so that $P_{i}$ does not belong to $\mathcal{T}_{\beta}$.

Now, put $\alpha_{i}=40 \delta i$, for $i=0,1, \ldots,\left\lfloor\frac{1}{40} \delta^{-1} \cdot \frac{\pi}{2}\right\rfloor$, and consider the slices $\mathcal{T}_{\alpha_{i}}$. The Claim yields that each point in $\mathcal{S}$ is contained in at most two such slices. Hence, the union $\mathcal{U}$ of those slices contains at least

$$
\frac{1}{2} \cdot \frac{1}{8 \delta} \cdot \frac{1}{40 \delta} \cdot \frac{\pi}{2}=\frac{\lambda}{\delta^{2}}
$$

points (for some constant $\lambda$ ), and each point in $\mathcal{U}$ is at most $\frac{1}{4}$ apart from the boundary of $C$.\\
It is not hard now to reach a contradiction with (1). E.g., for each point $X \in \mathcal{U}$, consider a closest point $f(X)$ on the boundary of $C$. Obviously, $f(X) f(Y) \geqslant X Y-\frac{1}{2} \geqslant \frac{1}{2} X Y$ for all $X, Y \in \mathcal{U}$. This yields that the perimeter of $C$ is at least $\mu \delta^{-2}$, for some constant $\mu$, and hence the diameter of $\mathcal{S}$ is of the same order.

Alternatively, one may show that the projection of $\mathcal{U}$ to the line at the angle of $\pi / 4$ with $\mathbf{v}_{0}$ has diameter at least $\mu \delta^{-2}$ for some constant $\mu$.",4,"Assume that for a set $\mathcal{S}$ of $n$ points with minimum distance 1, any separating line is at a distance less than $\delta$ from some point in $\mathcal{S}$. Show that for any line $m$, the distance between any two adjacent points in the projection $\mathcal{S}_m$ is less than $2\delta$.","Suppose for a contradiction that for some line $m$, there are adjacent projected points $X_m, Y_m$ with distance $2d \ge 2\delta$. The line $\ell$ that is the perpendicular bisector of the segment connecting points $X$ and $Y$ is a separating line. For any point $Z \in \mathcal{S}$, its projection $Z_m$ is not strictly between $X_m$ and $Y_m$ as they are adjacent. Thus, the distance from $Z$ to $\ell$ is at least $d \ge \delta$. This contradicts the assumption that for any separating line, some point is closer than $\delta$. Therefore, for any line $m$, adjacent points in the projection $\mathcal{S}_m$ must be less than $2\delta$ apart.","Let $\mathcal{S}$ be a set of $n$ points with minimum distance 1, and let $M$ be its diameter. Assuming that for any line $m$, the distance between any two adjacent points in the projection $\mathcal{S}_m$ is less than $2\delta$, prove that $M < 2n\delta$.","Let $A, B \in \mathcal{S}$ be two points such that their distance $AB$ is the diameter $M$. Let $\ell$ be the line passing through $A$ and $B$. The projection $\mathcal{S}_\ell$ of the set $\mathcal{S}$ is contained within the segment $AB$ of length $M$. The $n$ points of $\mathcal{S}_\ell$ divide this segment into at most $n-1$ sub-segments. By the assumption, the length of each such sub-segment is less than $2\delta$. Therefore, the total length $M$ must be less than the sum of the maximum lengths of these sub-segments, so $M < (n-1) \cdot 2\delta < 2n\delta$.","Let $\mathcal{S}$ be a set of $n \ge 2$ points with minimum distance 1 and diameter $M \ge 1$. Let $\ell$ be a line containing a diameter. Assume the distance between adjacent points in any projection is less than $2\delta$. Consider a strip of width $1/2$ perpendicular to $\ell$ starting at one end of the diameter. Let $\mathcal{T}$ be the set of points from $\mathcal{S}$ in this strip, and let $t = |\mathcal{T}|$. Prove that $t \ge \frac{1}{4\delta}$ and $t < 4\sqrt{M}$.","Let the diameter be on line $\ell$. Consider a strip $P$ of width $1/2$ perpendicular to $\ell$ starting at one endpoint of the diameter. Let $\mathcal{T} = \mathcal{S} \cap P$. The projection of $\mathcal{T}$ on $\ell$ lies in a segment of length $1/2$. Since adjacent projected points are less than $2\delta$ apart, the number of points $t= |\mathcal{T}|$ must satisfy $t \ge \lceil \frac{1/2}{2\delta} \rceil \ge \frac{1}{4\delta}$. For the upper bound, let $a$ be a line perpendicular to $\ell$. For any two points $X, Y \in \mathcal{T}$, their distance $XY \ge 1$. Their projected distance on $\ell$, $X_\ell Y_\ell$, is at most $1/2$. Their projected distance on $a$ is $X_a Y_a = \sqrt{XY^2 - X_\ell Y_\ell^2} \ge \sqrt{1^2 - (1/2)^2} = \sqrt{3}/2$. The points of $\mathcal{T}$ are contained in a region whose projection onto line $a$ has length less than $2\sqrt{M}$. Since the $t$ projected points on this segment are at least $\sqrt{3}/2$ apart, we have $(t-1)\sqrt{3}/2 < 2\sqrt{M}$, which implies $t < 1 + 4\sqrt{M}/\sqrt{3} < 4\sqrt{M}$ for $M \ge 1$.","Prove that there exists a positive constant $c$ such that the following statement is true: Assume that $n$ is an integer with $n \geqslant 2$, and let $\mathcal{S}$ be a set of $n$ points in the plane such that the distance between any two distinct points in $\mathcal{S}$ is at least 1 . Then there is a line $\ell$ separating $\mathcal{S}$ such that the distance from any point of $\mathcal{S}$ to $\ell$ is at least $c n^{-1 / 3}$.","Let $c=1/8$ and $\delta = c n^{-1/3}$. Assume for contradiction that for any separating line, some point in $\mathcal{S}$ is closer than $\delta$. By Sub-problem 1, for any line $m$, adjacent points in the projection $\mathcal{S}_m$ are less than $2\delta$ apart. Let $M$ be the diameter of $\mathcal{S}$. By Sub-problem 2, $M < 2n\delta$. By Sub-problem 3, there is a subset $\mathcal{T} \subset \mathcal{S}$ of size $t$ with $\frac{1}{4\delta} \le t < 4\sqrt{M}$. Combining these inequalities yields $\frac{1}{4\delta} < 4\sqrt{M} < 4\sqrt{2n\delta}$. This simplifies to $1 < 16\delta \sqrt{2n\delta}$, which after squaring becomes $1 < 512n\delta^3$. Substituting $\delta = \frac{1}{8}n^{-1/3}$, we get $512n(\frac{1}{8}n^{-1/3})^3 = 512n(\frac{1}{512}n^{-1}) = 1$. The resulting inequality $1 < 1$ is a contradiction. Thus, the assumption is false, and the statement holds with $c=1/8$."
2020n1,"Given a positive integer $k$, show that there exists a prime $p$ such that one can choose distinct integers $a_{1}, a_{2}, \ldots, a_{k+3} \in\{1,2, \ldots, p-1\}$ such that $p$ divides $a_{i} a_{i+1} a_{i+2} a_{i+3}-i$ for all $i=1,2, \ldots, k$.\\","Solution. First we choose distinct positive rational numbers $r_{1}, \ldots, r_{k+3}$ such that

$$
r_{i} r_{i+1} r_{i+2} r_{i+3}=i \quad \text { for } 1 \leqslant i \leqslant k .
$$

Let $r_{1}=x, r_{2}=y, r_{3}=z$ be some distinct primes greater than $k$; the remaining terms satisfy $r_{4}=\frac{1}{r_{1} r_{2} r_{3}}$ and $r_{i+4}=\frac{i+1}{i} r_{i}$. It follows that if $r_{i}$ are represented as irreducible fractions, the numerators are divisible by $x$ for $i \equiv 1(\bmod 4)$, by $y$ for $i \equiv 2(\bmod 4)$, by $z$ for $i \equiv 3(\bmod 4)$ and by none for $i \equiv 0(\bmod 4)$. Notice that $r_{i}<r_{i+4}$; thus the sequences $r_{1}<r_{5}<r_{9}<\ldots$, $r_{2}<r_{6}<r_{10}<\ldots, r_{3}<r_{7}<r_{11}<\ldots, r_{4}<r_{8}<r_{12}<\ldots$ are increasing and have no common terms, that is, all $r_{i}$ are distinct.

If each $r_{i}$ is represented by an irreducible fraction $\frac{u_{i}}{v_{i}}$, choose a prime $p$ which divides neither $v_{i}, 1 \leqslant i \leqslant k+1$, nor $v_{i} v_{j}\left(r_{i}-r_{j}\right)=v_{j} u_{i}-v_{i} u_{j}$ for $i<j$, and define $a_{i}$ by the congruence $a_{i} v_{i} \equiv u_{i}(\bmod p)$. Since $r_{i} r_{i+1} r_{i+2} r_{i+3}=i$, we have

$$
\begin{aligned}
& i v_{i} v_{i+1} v_{i+2} v_{i+3}=r_{i} v_{i} r_{i+1} v_{i+1} r_{i+2} v_{i+2} r_{i+3} v_{i+3} \\
& \quad=u_{i} u_{i+1} u_{i+2} u_{i+3} \equiv a_{i} v_{i} a_{i+1} v_{i+1} a_{i+2} v_{i+2} a_{i+3} v_{i+3} \quad(\bmod p)
\end{aligned}
$$

and therefore $a_{i} a_{i+1} a_{i+2} a_{i+3} \equiv i(\bmod p)$ for $1 \leqslant i \leqslant k$.\\
If $a_{i} \equiv a_{j}(\bmod p)$, then $u_{i} v_{j} \equiv a_{i} v_{i} v_{j} \equiv u_{j} v_{i}(\bmod p)$, a contradiction.\\
Comment. One can explicitly express residues $b_{i} \equiv a_{1} a_{2} \cdot \ldots a_{i}(\bmod p)$ in terms of $b_{1}, b_{2}, b_{3}$ and $b_{0}=1$ :

$$
b_{i+3}=i(i-4)(i-8) \cdot \ldots \cdot(i-4 k+4) b_{r},
$$

where $i+3=4 k+r, 0 \leqslant r<4$. Then the numbers $a_{i}$ are found from the congruences $b_{i-1} a_{i} \equiv b_{i}$ $(\bmod p)$, and choosing $p$ so that $a_{i}$ are not congruent modulo $p$ is done in a way very similar to the above solution.",3,"Show the existence of a sequence of positive rational numbers $r_1, r_2, \\ldots, r_{k+3}$ such that $r_i r_{i+1} r_{i+2} r_{i+3} = i$ for all $i=1, 2, \\ldots, k$.","Let $r_1, r_2, r_3$ be any three distinct positive rational numbers. Define $r_4 = \frac{1}{r_1 r_2 r_3}$. For $i \\ge 1$, the conditions $r_i r_{i+1} r_{i+2} r_{i+3} = i$ and $r_{i+1} r_{i+2} r_{i+3} r_{i+4} = i+1$ imply the recurrence relation $r_{i+4} = \frac{i+1}{i} r_i$. This recurrence uniquely defines the sequence $r_5, r_6, \\ldots, r_{k+3}$ and satisfies the required product relations.","By choosing $r_1=x, r_2=y, r_3=z$ for distinct primes $x, y, z > k$, show that the rational numbers $r_1, \\ldots, r_{k+3}$ constructed in the previous step are all distinct.","The sequence is defined by $r_1=x, r_2=y, r_3=z$ and the recurrence $r_{i+4} = \frac{i+1}{i} r_i$. The four subsequences $\{r_{4m+j}\\}_{m \\ge 0}$ for $j=1,2,3,4$ are strictly increasing since $r_{i+4} > r_i$, so no values are repeated within a subsequence. When written in irreducible form, the numerators of terms in the subsequence for $j=1$ are divisible by $x$, for $j=2$ by $y$, and for $j=3$ by $z$. Numerators for $j=4$ are not divisible by $x, y,$ or $z$ (since $x,y,z > k$). This prevents any equality between terms from different subsequences. Therefore, all $r_i$ are distinct.","Given a positive integer $k$, show that there exists a prime $p$ such that one can choose distinct integers $a_{1}, a_{2}, \\ldots, a_{k+3} \\in\\{1,2, \\ldots, p-1\\}$ such that $p$ divides $a_{i} a_{i+1} a_{i+2} a_{i+3}-i$ for all $i=1,2, \\ldots, k$.","Construct a sequence of distinct rational numbers $r_i = u_i/v_i$ as in the previous steps. Let $P$ be the finite set of prime factors of all denominators $v_i$ and all non-zero numerators $u_i v_j - u_j v_i$ for $i \neq j$. Choose a prime $p \notin P$. Define $a_i \\in \\{1, \\ldots, p-1\\}$ by $a_i \\equiv u_i (v_i)^{-1} \\pmod p$. This is well-defined as $p \nmid v_i$. The relation $r_i r_{i+1} r_{i+2} r_{i+3} = i$ becomes $a_i a_{i+1} a_{i+2} a_{i+3} \\equiv i \\pmod p$. The integers $a_i$ are distinct because if $a_i \\equiv a_j \\pmod p$, then $u_i v_j - u_j v_i \\equiv 0 \\pmod p$, which implies $p \\in P$, a contradiction.",,
2020n2,"For each prime $p$, there is a kingdom of $p$-Landia consisting of $p$ islands numbered $1,2, \ldots, p$. Two distinct islands numbered $n$ and $m$ are connected by a bridge if and only if $p$ divides $\left(n^{2}-m+1\right)\left(m^{2}-n+1\right)$. The bridges may pass over each other, but cannot cross. Prove that for infinitely many $p$ there are two islands in $p$-Landia not connected by a chain of bridges.","We prove that for each prime $p>3$ dividing a number of the form $x^{2}-x+1$ with integer $x$ there are two unconnected islands in $p$-Landia.

For brevity's sake, when a bridge connects the islands numbered $m$ and $n$, we shall speak simply that it connects $m$ and $n$.

A bridge connects $m$ and $n$ if $n \equiv m^{2}+1(\bmod p)$ or $m \equiv n^{2}+1(\bmod p)$. If $m^{2}+1 \equiv n$ $(\bmod p)$, we draw an arrow starting at $m$ on the bridge connecting $m$ and $n$. Clearly only one arrow starts at $m$ if $m^{2}+1 \not \equiv m(\bmod p)$, and no arrows otherwise. The total number of bridges does not exceed the total number of arrows.

Suppose $x^{2}-x+1 \equiv 0(\bmod p)$. We may assume that $1 \leqslant x \leqslant p$; then there is no arrow starting at $x$. Since $(1-x)^{2}-(1-x)+1=x^{2}-x+1,(p+1-x)^{2}+1 \equiv(p+1-x)(\bmod p)$, and there is also no arrow starting at $p+1-x$. If $x=p+1-x$, that is, $x=\frac{p+1}{2}$, then $4\left(x^{2}-x+1\right)=p^{2}+3$ and therefore $x^{2}-x+1$ is not divisible by $p$. Thus the islands $x$ and $p+1-x$ are different, and no arrows start at either of them. It follows that the total number of bridges in $p$-Landia does not exceed $p-2$.

Let $1,2, \ldots, p$ be the vertices of a graph $G_{p}$, where an edge connects $m$ and $n$ if and only if there is a bridge between $m$ and $n$. The number of vertices of $G_{p}$ is $p$ and the number of edges is less than $p-1$. This means that the graph is not connected, which means that there are two islands not connected by a chain of bridges.

It remains to prove that there are infinitely many primes $p$ dividing $x^{2}-x+1$ for some integer $x$. Let $p_{1}, p_{2}, \ldots, p_{k}$ be any finite set of such primes. The number $\left(p_{1} p_{2} \cdot \ldots \cdot p_{k}\right)^{2}-p_{1} p_{2} \cdot \ldots \cdot p_{k}+1$ is greater than 1 and not divisible by any $p_{i}$; therefore it has another prime divisor with the required property.",3,"Let $p>3$ be a prime. In $p$-Landia, islands $m$ and $n$ are connected by a bridge if $p$ divides $(n^2 - m + 1)(m^2 - n + 1)$. Show that if there exists an integer $x$ such that $x^2-x+1 \equiv 0 \pmod p$, then there are two islands not connected by a chain of bridges.","The islands and bridges form a graph with $p$ vertices. A bridge between $m$ and $n$ exists if $n \equiv m^2+1 \pmod p$ or $m \equiv n^2+1 \pmod p$. We can bound the number of bridges by counting directed connections (arrows) from $m$ to $n$ if $n \equiv m^2+1 \pmod p$. The number of bridges is at most the number of arrows. For each island $m$, there is exactly one outgoing arrow unless $m^2+1 \equiv m \pmod p$, i.e., $m^2-m+1 \equiv 0 \pmod p$, in which case there are no outgoing arrows. By hypothesis, there is no arrow starting from island $x$. Also, $(1-x)^2-(1-x)+1 = x^2-x+1 \equiv 0 \pmod p$, so no arrow starts from $1-x$ either. For $p>3$, $x \not\equiv 1-x \pmod p$, since $x=1-x$ implies $2x=1$, which together with $x^2-x+1=0$ implies $p|3$, a contradiction. Thus, at least two distinct islands have no outgoing arrows, so the total number of bridges is at most $p-2$. A graph with $p$ vertices and fewer than $p-1$ edges is disconnected. Therefore, there are at least two islands not connected by a chain of bridges.",Prove that there are infinitely many prime numbers $p$ that divide a number of the form $x^2-x+1$ for some integer $x$.,"Assume for contradiction that there is a finite set of such primes, $\{p_1, \ldots, p_k\}$. Let $N = p_1 p_2 \cdots p_k$. Consider the integer $M = N^2 - N + 1$. For any prime $p_i$ in the set, $N$ is a multiple of $p_i$, so $M \equiv 0^2 - 0 + 1 \equiv 1 \pmod{p_i}$. Thus, $M$ is not divisible by any of the primes $p_i$. Since $M > 1$, it must have a prime divisor, say $q$. This prime $q$ cannot be in the set $\{p_1, \ldots, p_k\}$. Since $q$ divides $M = N^2 - N + 1$, $q$ is a prime of the required form (with $x=N$). This contradicts the assumption that the set of such primes is finite. Therefore, there must be infinitely many such primes.",Prove that for infinitely many $p$ there are two islands in $p$-Landia not connected by a chain of bridges.,"From Sub-problem 2, there are infinitely many primes $p$ that divide a number of the form $x^2-x+1$ for some integer $x$. For any such prime $p>3$, Sub-problem 1 shows that the graph of islands in $p$-Landia is not connected. A non-connected graph, by definition, has at least two vertices (islands) that are not connected by a path (a chain of bridges). Since there are infinitely many such primes $p>3$, the statement holds.",,
2020n7,"Let $\mathcal{S}$ be a set consisting of $n \geqslant 3$ positive integers, none of which is a sum of two other distinct members of $\mathcal{S}$. Prove that the elements of $\mathcal{S}$ may be ordered as $a_{1}, a_{2}, \ldots, a_{n}$ so that $a_{i}$ does not divide $a_{i-1}+a_{i+1}$ for all $i=2,3, \ldots, n-1$.","Common remarks. In all solutions, we call a set $\mathcal{S}$ of positive integers good if no its element is a sum of two other distinct members of $\mathcal{S}$. We will use the following simple observation.\\
Observation A. If $a, b$, and $c$ are three distinct elements of a good set $\mathcal{S}$ with $b>a, c$, then $b \nmid a+c$. Otherwise, since $b \neq a+c$, we would have $b \leqslant(a+c) / 2<\max \{a, c\}$.

We prove the following stronger statement.\\
Claim. Let $\mathcal{S}$ be a good set consisting of $n \geqslant 2$ positive integers. Then the elements of $\mathcal{S}$ may be ordered as $a_{1}, a_{2}, \ldots, a_{n}$ so that $a_{i} \nmid a_{i-1}+a_{i+1}$ and $a_{i} \nmid a_{i-1}-a_{i+1}$, for all $i=2,3, \ldots, n-1$.\\
Proof. Say that the ordering $a_{1}, \ldots, a_{n}$ of $\mathcal{S}$ is nice if it satisfies the required property.\\
We proceed by induction on $n$. The base case $n=2$ is trivial, as there are no restrictions on the ordering.

To perform the step of induction, suppose that $n \geqslant 3$. Let $a=\max \mathcal{S}$, and set $\mathcal{T}=\mathcal{S} \backslash\{a\}$. Use the inductive hypothesis to find a nice ordering $b_{1}, \ldots, b_{n-1}$ of $\mathcal{T}$. We will show that $a$ may be inserted into this sequence so as to reach a nice ordering of $\mathcal{S}$. In other words, we will show that there exists a $j \in\{1,2, \ldots, n\}$ such that the ordering

$$
N_{j}=\left(b_{1}, \ldots, b_{j-1}, a, b_{j}, b_{j+1}, \ldots, b_{n-1}\right)
$$

is nice.\\
Assume that, for some $j$, the ordering $N_{j}$ is not nice, so that some element $x$ in it divides either the sum or the difference of two adjacent ones. This did not happen in the ordering of $\mathcal{T}$, hence $x \in\left\{b_{j-1}, a, b_{j}\right\}$ (if, say, $b_{j-1}$ does not exist, then $x \in\left\{a, b_{j}\right\}$; a similar agreement is applied hereafter). But the case $x=a$ is impossible: $a$ cannot divide $b_{j-1}-b_{j}$, since $0<\left|b_{j-1}-b_{j}\right|<a$, while $a \nmid b_{j-1}+b_{j}$ by Observation A. Therefore $x \in\left\{b_{j-1}, b_{j}\right\}$. In this case, assign the number $x$ to the index $j$.

Suppose now that none of the $N_{j}$ is nice. Since there are $n$ possible indices $j$, and only $n-1$ elements in $\mathcal{T}$, one of those elements (say, $b_{k}$ ) is assigned to two different indices, which then should equal $k$ and $k+1$. This means that $b_{k}$ divides the numbers $b_{k-1}+\varepsilon_{1} a$ and $a+\varepsilon_{2} b_{k+1}$, for some signs $\varepsilon_{1}, \varepsilon_{2} \in\{-1,1\}$. But then

$$
b_{k-1} \equiv-\varepsilon_{1} a \equiv \varepsilon_{1} \varepsilon_{2} b_{k+1} \quad\left(\bmod b_{k}\right),
$$

and therefore $b_{k} \mid b_{k-1}-\varepsilon_{1} \varepsilon_{2} b_{k+1}$, which means that the ordering of $\mathcal{T}$ was not nice. This contradiction proves the step of induction.",3,"Let $\mathcal{S}$ be a set of positive integers where no element is a sum of two other distinct members. Prove that for any three distinct elements $a, b, c \in \mathcal{S}$ with $b > \max(a, c)$, $b$ does not divide $a+c$.","Assume for contradiction that $b$ divides $a+c$. Since $b \in \mathcal{S}$, by the definition of the set, $b$ cannot be the sum of two other distinct members, so $b \neq a+c$. As $a, b, c$ are positive integers, if $b | (a+c)$, we must have the inequality $b \le (a+c)/2$. However, we are given that $b > a$ and $b > c$. Summing these inequalities gives $2b > a+c$, which implies $b > (a+c)/2$. This contradicts $b \le (a+c)/2$. Therefore, the initial assumption must be false, and $b$ does not divide $a+c$.","Let $\mathcal{S}$ be a set of $n \ge 3$ positive integers as defined in the original problem, and let $a = \max \mathcal{S}$. Let $b$ and $c$ be any two other distinct elements from $\mathcal{S}$. Prove that $a$ does not divide $b+c$ and $a$ does not divide $|b-c|$.","Since $a = \max \mathcal{S}$ and $b, c$ are distinct elements from $\mathcal{S} \setminus \{a\}$, we have $a > b$ and $a > c$. The condition $a > \max(b, c)$ is met. From the result of Sub-problem 1, it follows directly that $a \nmid b+c$. For the second part, since $b$ and $c$ are distinct positive integers, $|b-c|$ is a positive integer. We also have $|b-c| < \max(b,c) < a$. Since $0 < |b-c| < a$, it is impossible for $a$ to divide $|b-c|$.","Let $\mathcal{S}$ be a set consisting of $n \geqslant 3$ positive integers, none of which is a sum of two other distinct members of $\mathcal{S}$. Prove that the elements of $\mathcal{S}$ may be ordered as $a_{1}, a_{2}, \ldots, a_{n}$ so that $a_{i}$ does not divide $a_{i-1}+a_{i+1}$ for all $i=2,3, \ldots, n-1$.","We prove a stronger claim by induction on $n$: there exists an ordering $a_1, \ldots, a_n$ such that $a_i \nmid a_{i-1} \pm a_{i+1}$ for $i=2, \ldots, n-1$. This implies the original statement. The base case $n=2$ is trivial. For $n \ge 3$, assume the claim holds for sets of size $n-1$. Let $a = \max \mathcal{S}$ and $\mathcal{T} = \mathcal{S} \setminus \{a\}$. By the inductive hypothesis, there is a valid ordering $b_1, \ldots, b_{n-1}$ of $\mathcal{T}$. Consider inserting $a$ into this sequence at one of the $n$ possible positions $j$, forming $N_j$. Assume for contradiction that none of the $n$ orderings $N_j$ are valid. Any new violation must involve $a$. By Sub-problem 2, $a$ cannot be the middle element divisor in a violation. Thus, a violation must occur at a neighbor of $a$. For each of the $n$ failed positions $j$, some $b_k \in \mathcal{T}$ must cause a violation. By the pigeonhole principle, some element $b_k$ must be responsible for violations corresponding to two distinct insertion positions. An element $b_k$ can only become a middle element in a new triple if $a$ is inserted adjacent to it, which occurs for insertion positions $j=k$ and $j=k+1$. This implies $b_k | a \pm b_{k+1}$ and $b_k | b_{k-1} \pm a$. From these, we get $a \equiv \mp b_{k+1} \pmod{b_k}$ and $a \equiv \mp b_{k-1} \pmod{b_k}$. This leads to $b_{k-1} \equiv \pm b_{k+1} \pmod{b_k}$, which implies $b_k | b_{k-1} \pm b_{k+1}$. This contradicts the assumption that the ordering of $\mathcal{T}$ was valid. Therefore, at least one of the orderings $N_j$ must be valid, completing the induction.",,
2019a2,"Let $u_{1}, u_{2}, \ldots, u_{2019}$ be real numbers satisfying

$$
u_{1}+u_{2}+\cdots+u_{2019}=0 \quad \text { and } \quad u_{1}^{2}+u_{2}^{2}+\cdots+u_{2019}^{2}=1
$$

Let $a=\min \left(u_{1}, u_{2}, \ldots, u_{2019}\right)$ and $b=\max \left(u_{1}, u_{2}, \ldots, u_{2019}\right)$. Prove that

$$
a b \leqslant-\frac{1}{2019}
$$","Notice first that $b>0$ and $a<0$. Indeed, since $\sum_{i=1}^{2019} u_{i}^{2}=1$, the variables $u_{i}$ cannot be all zero, and, since $\sum_{i=1}^{2019} u_{i}=0$, the nonzero elements cannot be all positive or all negative.

Let $P=\left\{i: u_{i}>0\right\}$ and $N=\left\{i: u_{i} \leqslant 0\right\}$ be the indices of positive and nonpositive elements in the sequence, and let $p=|P|$ and $n=|N|$ be the sizes of these sets; then $p+n=2019$. By the condition $\sum_{i=1}^{2019} u_{i}=0$ we have $0=\sum_{i=1}^{2019} u_{i}=\sum_{i \in P} u_{i}-\sum_{i \in N}\left|u_{i}\right|$, so


\begin{equation*}
\sum_{i \in P} u_{i}=\sum_{i \in N}\left|u_{i}\right| \tag{1}
\end{equation*}


After this preparation, estimate the sum of squares of the positive and nonpositive elements as follows:


\begin{align*}
& \sum_{i \in P} u_{i}^{2} \leqslant \sum_{i \in P} b u_{i}=b \sum_{i \in P} u_{i}=b \sum_{i \in N}\left|u_{i}\right| \leqslant b \sum_{i \in N}|a|=-n a b  \tag{2}\\
& \sum_{i \in N} u_{i}^{2} \leqslant \sum_{i \in N}|a| \cdot\left|u_{i}\right|=|a| \sum_{i \in N}\left|u_{i}\right|=|a| \sum_{i \in P} u_{i} \leqslant|a| \sum_{i \in P} b=-p a b \tag{3}
\end{align*}


The sum of these estimates is

$$
1=\sum_{i=1}^{2019} u_{i}^{2}=\sum_{i \in P} u_{i}^{2}+\sum_{i \in N} u_{i}^{2} \leqslant-(p+n) a b=-2019 a b
$$

that proves $a b \leqslant \frac{-1}{2019}$.\\
Comment 1. After observing $\sum_{i \in P} u_{i}^{2} \leqslant b \sum_{i \in P} u_{i}$ and $\sum_{i \in N} u_{i}^{2} \leqslant|a| \sum_{i \in P}\left|u_{i}\right|$, instead of $(2,3)$ an alternative continuation is

$$
|a b| \geqslant \frac{\sum_{i \in P} u_{i}^{2}}{\sum_{i \in P} u_{i}} \cdot \frac{\sum_{i \in N} u_{i}^{2}}{\sum_{i \in N}\left|u_{i}\right|}=\frac{\sum_{i \in P} u_{i}^{2}}{\left(\sum_{i \in P} u_{i}\right)^{2}} \sum_{i \in N} u_{i}^{2} \geqslant \frac{1}{p} \sum_{i \in N} u_{i}^{2}
$$

(by the AM-QM or the Cauchy-Schwarz inequality) and similarly $|a b| \geqslant \frac{1}{n} \sum_{i \in P} u_{i}^{2}$.\\",3,"Let $u_1, \ldots, u_{2019}$ be real numbers with $\\sum_{i=1}^{2019} u_i = 0$ and $\\sum_{i=1}^{2019} u_i^2=1$. Let $P = \\{i: u_i > 0\\}$ and $N = \\{i: u_i \\le 0\\}$. Prove that $a=\\min(u_i)<0$, $b=\\max(u_i)>0$, and that $\\sum_{i \\in P} u_i = \\sum_{i \\in N} |u_i|$.","Since $\\sum u_i^2=1$, not all $u_i$ can be zero. Since $\\sum u_i=0$, the non-zero terms cannot all be positive or all negative. Therefore, there must be at least one positive term and at least one negative term, which implies $a<0$ and $b>0$. From $\\sum u_i = 0$, we have $\\sum_{i \\in P} u_i + \\sum_{i \\in N} u_i = 0$. For $i \\in N$, $u_i = -|u_i|$. So, $\\sum_{i \\in P} u_i - \\sum_{i \\in N} |u_i| = 0$, which gives the identity $\\sum_{i \\in P} u_i = \\sum_{i \\in N} |u_i|$.","Let $p = |P|$ and $n = |N|$. Using the results from the previous step, prove that $\\sum_{i=1}^{2019} u_i^2 \\le -nab - pab$.","We bound the sums over positive and non-positive terms separately. For $i \\in P$, $0 < u_i \\le b$, so $u_i^2 \\le b u_i$. For $i \\in N$, $a \\le u_i \\le 0$, so $u_i^2 = |u_i|^2 \\le |a||u_i|=-a|u_i|$ because $|a|=-a$ from sub-problem 1. \n $\\sum_{i \\in P} u_i^2 \\le b\\sum_{i \\in P} u_i = b\\sum_{i \\in N} |u_i| \\le b \\sum_{i \\in N} |a| = b \\cdot n \\cdot (-a) = -nab$. \n $\\sum_{i \\in N} u_i^2 \\le |a|\\sum_{i \\in N} |u_i| = |a|\\sum_{i \\in P} u_i \\le |a| \\sum_{i \\in P} b = (-a) \\cdot p \\cdot b = -pab$. \n Adding these inequalities yields $\\sum_{i=1}^{2019} u_i^2 = \\sum_{i \\in P} u_i^2 + \\sum_{i \\in N} u_i^2 \\le -nab - pab$.","Let $u_{1}, u_{2}, \\ldots, u_{2019}$ be real numbers satisfying $\\sum_{i=1}^{2019} u_{i}=0$ and $\\sum_{i=1}^{2019} u_{i}^{2}=1$. Let $a=\\min(u_{1}, \\ldots, u_{2019})$ and $b=\\max(u_{1}, \\ldots, u_{2019})$. Prove that $ab \\leqslant -\frac{1}{2019}$.","From the problem statement, $\\sum_{i=1}^{2019} u_i^2 = 1$. The total number of terms is $p+n=2019$. Using the inequality from Sub-problem 2, we have $1 = \\sum_{i=1}^{2019} u_i^2 \\le -nab - pab = -(n+p)ab = -2019ab$. Therefore, $1 \\le -2019ab$. Since $a<0$ and $b>0$, $ab$ is negative. Dividing by $-2019$ reverses the inequality, yielding $ab \\le -1/2019$.",,
2019a3,"Let $n \geqslant 3$ be a positive integer and let $\left(a_{1}, a_{2}, \ldots, a_{n}\right)$ be a strictly increasing sequence of $n$ positive real numbers with sum equal to 2 . Let $X$ be a subset of $\{1,2, \ldots, n\}$ such that the value of

$$
\left|1-\sum_{i \in X} a_{i}\right|
$$

is minimised. Prove that there exists a strictly increasing sequence of $n$ positive real numbers $\left(b_{1}, b_{2}, \ldots, b_{n}\right)$ with sum equal to 2 such that

$$
\sum_{i \in X} b_{i}=1 .
$$","Without loss of generality, assume $\sum_{i \in X} a_{i} \leqslant 1$, and we may assume strict inequality as otherwise $b_{i}=a_{i}$ works. Also, $X$ clearly cannot be empty.

If $n \in X$, add $\Delta$ to $a_{n}$, producing a sequence of $c_{i}$ with $\sum_{i \in X} c_{i}=\sum_{i \in X^{c}} c_{i}$, and then scale as described above to make the sum equal to 2. Otherwise, there is some $k$ with $k \in X$ and $k+1 \in X^{c}$. Let $\delta=a_{k+1}-a_{k}$.

\begin{itemize}
  \item If $\delta>\Delta$, add $\Delta$ to $a_{k}$ and then scale.
  \item If $\delta<\Delta$, then considering $X \cup\{k+1\} \backslash\{k\}$ contradicts $X$ being $\left(a_{i}\right)$-minimising.
  \item If $\delta=\Delta$, choose any $j \neq k, k+1$ (possible since $n \geqslant 3$ ), and any $\epsilon$ less than the least of $a_{1}$ and all the differences $a_{i+1}-a_{i}$. If $j \in X$ then add $\Delta-\epsilon$ to $a_{k}$ and $\epsilon$ to $a_{j}$, then scale; otherwise, add $\Delta$ to $a_{k}$ and $\epsilon / 2$ to $a_{k+1}$, and subtract $\epsilon / 2$ from $a_{j}$, then scale.
\end{itemize}",2,"Let $S_X = \sum_{i \in X} a_i$. Assuming $S_X < 1$, prove that for any index $k$ such that $k \in X$ and $k+1 \in X^c$, the inequality $a_{k+1} - a_k \ge 2(1 - S_X)$ holds.","Let $Y = (X \setminus \{k\}) \cup \{k+1\}$. The sum over $Y$ is $S_Y = S_X - a_k + a_{k+1}$. By the minimality condition on $X$, we have $|1 - S_Y| \ge |1 - S_X|$. Let $\Delta = 1 - S_X > 0$ and $\delta = a_{k+1} - a_k > 0$. The condition is $|1 - (S_X + \delta)| \ge \Delta$, which simplifies to $|(1-S_X) - \delta| \ge \Delta$, or $|\Delta - \delta| \ge \Delta$. As $\delta > 0$, this inequality implies $\Delta - \delta \le -\Delta$, which is equivalent to $\delta \ge 2\Delta$. Thus, $a_{k+1} - a_k \ge 2(1 - S_X)$.","Let $n \geqslant 3$ be a positive integer and let $\left(a_{1}, a_{2}, \ldots, a_{n}\right)$ be a strictly increasing sequence of $n$ positive real numbers with sum equal to 2 . Let $X$ be a subset of $\{1,2, \ldots, n\}$ such that the value of $\left|1-\sum_{i \in X} a_{i}\right|$ is minimised. Prove that there exists a strictly increasing sequence of $n$ positive real numbers $\left(b_{1}, b_{2}, \ldots, b_{n}\right)$ with sum equal to 2 such that $\sum_{i \in X} b_{i}=1 .","Let $S_X = \sum_{i \in X} a_i$. If $S_X=1$, take $b_i=a_i$. WLOG, assume $S_X < 1$. Let $\Delta = 1-S_X > 0$. We construct a new strictly increasing positive sequence $(c_i)$ with $\sum_{i \in X} c_i = \sum_{i \in X^c} c_i$ by modifying $(a_i)$. This requires increasing the sum over $X$ by $2\Delta$ relative to $X^c$. Case 1: $n \in X$. Set $c_n = a_n + 2\Delta$ and $c_i=a_i$ for $i<n$. Case 2: $n \notin X$. There exists $k \in X$ with $k+1 \in X^c$. From sub-problem 1, $\delta = a_{k+1}-a_k \ge 2\Delta$. If $\delta > 2\Delta$, set $c_k = a_k + 2\Delta$ and $c_i=a_i$ for $i \neq k$. If $\delta = 2\Delta$, pick $j \neq k, k+1$ and a small $\epsilon > 0$. If $j \in X$, let $c_k=a_k+2\Delta-\epsilon, c_j=a_j+\epsilon$. If $j \notin X$, let $c_k=a_k+2\Delta, c_{k+1}=a_{k+1}+\epsilon/2, c_j=a_j-\epsilon/2$. In all cases, $(c_i)$ is a valid sequence. Let $C = \sum c_i$. Then $b_i = 2c_i/C$ is the desired sequence, as $\sum_{i \in X} b_i = (2/C)\sum_{i \in X} c_i = (2/C)(C/2) = 1$.",,,,
2019a4,"Let $n \geqslant 2$ be a positive integer and $a_{1}, a_{2}, \ldots, a_{n}$ be real numbers such that

$$
a_{1}+a_{2}+\cdots+a_{n}=0
$$

Define the set $A$ by

$$
A=\left\{(i, j)\left|1 \leqslant i<j \leqslant n,\left|a_{i}-a_{j}\right| \geqslant 1\right\} .\right.
$$

Prove that, if $A$ is not empty, then

$$
\sum_{(i, j) \in A} a_{i} a_{j}<0 .
$$","Define sets $B$ and $C$ by

$$
\begin{aligned}
& B=\left\{(i, j)\left|1 \leqslant i, j \leqslant n,\left|a_{i}-a_{j}\right| \geqslant 1\right\},\right. \\
& C=\left\{(i, j)\left|1 \leqslant i, j \leqslant n,\left|a_{i}-a_{j}\right|<1\right\} .\right.
\end{aligned}
$$

We have

$$
\begin{aligned}
\sum_{(i, j) \in A} a_{i} a_{j} & =\frac{1}{2} \sum_{(i, j) \in B} a_{i} a_{j} \\
\sum_{(i, j) \in B} a_{i} a_{j} & =\sum_{1 \leqslant i, j \leqslant n} a_{i} a_{j}-\sum_{(i, j) \notin B} a_{i} a_{j}=0-\sum_{(i, j) \in C} a_{i} a_{j} .
\end{aligned}
$$

So it suffices to show that if $A$ (and hence $B$ ) are nonempty, then

$$
\sum_{(i, j) \in C} a_{i} a_{j}>0 .
$$

Partition the indices into sets $P, Q, R$, and $S$ such that

$$
\begin{array}{llrl}
P & =\left\{i \mid a_{i} \leqslant-1\right\} & R & =\left\{i \mid 0<a_{i}<1\right\} \\
Q & =\left\{i \mid-1<a_{i} \leqslant 0\right\} & S & =\left\{i \mid 1 \leqslant a_{i}\right\} .
\end{array}
$$

Then

$$
\sum_{(i, j) \in C} a_{i} a_{j} \geqslant \sum_{i \in P \cup S} a_{i}^{2}+\sum_{i, j \in Q \cup R} a_{i} a_{j}=\sum_{i \in P \cup S} a_{i}^{2}+\left(\sum_{i \in Q \cup R} a_{i}\right)^{2} \geqslant 0 .
$$

The first inequality holds because all of the positive terms in the RHS are also in the LHS, and all of the negative terms in the LHS are also in the RHS. The first inequality attains equality only if both sides have the same negative terms, which implies $\left|a_{i}-a_{j}\right|<1$ whenever $i, j \in Q \cup R$; the second inequality attains equality only if $P=S=\varnothing$. But then we would have $A=\varnothing$. So $A$ nonempty implies that the inequality holds strictly, as required.",3,"Let $A = \{(i, j) | 1 \le i < j \le n, |a_i - a_j| \ge 1\}$ and $C = \{(i, j) | 1 \le i, j \le n, |a_i - a_j| < 1\}$. Given $\sum_{k=1}^n a_k = 0$, show that proving $\sum_{(i, j) \in A} a_{i} a_{j} < 0$ is equivalent to proving $\sum_{(i, j) \in C} a_{i} a_{j} > 0$.","Define $B = \{(i, j) | 1 \le i, j \le n, |a_i - a_j| \ge 1\}$. Note that $(i,i) \notin B$, so $\sum_{(i, j) \in A} a_{i} a_{j} = \frac{1}{2}\sum_{(i,j) \in B} a_i a_j$. Since $\sum a_k=0$, we have $(\sum a_k)^2 = \sum_{1 \le i,j \le n} a_i a_j = 0$. The set of all pairs $(i,j)$ is the disjoint union of $B$ and $C$, so $\sum_{(i,j) \in B} a_i a_j + \sum_{(i,j) \in C} a_i a_j = 0$. It follows that $\sum_{(i, j) \in A} a_{i} a_{j} = -\frac{1}{2}\sum_{(i,j) \in C} a_i a_j$. Thus, the inequality $\sum_{(i, j) \in A} a_{i} a_{j} < 0$ is equivalent to $\sum_{(i,j) \in C} a_i a_j > 0$.","Partition the indices $\{1, \ldots, n\}$ into sets $P = \{i | a_i \le -1\}$, $Q = \{i | -1 < a_i \le 0\}$, $R = \{i | 0 < a_i < 1\}$, and $S = \{i | 1 \le a_i\}$. Let $C$ be as defined in the previous part. Prove that $\sum_{(i, j) \in C} a_{i} a_{j} \geqslant \sum_{i \in P \cup S} a_{i}^{2}+\left(\sum_{k \in Q \cup R} a_{k}\right)^{2}$, and show this lower bound is non-negative.","We establish the inequality $\sum_{(i, j) \in C} a_{i} a_{j} \geqslant \sum_{i \in P \cup S} a_{i}^{2}+\sum_{i, j \in Q \cup R} a_{i} a_{j}$. This holds because any negative term $a_ia_j$ in the LHS sum must have $i, j \in Q \cup R$, while all positive or zero-valued terms from the RHS are included in the LHS sum. The right hand side equals $\sum_{i \in P \cup S} a_{i}^{2}+\left(\sum_{k \in Q \cup R} a_{k}\right)^{2}$. As a sum of squares of real numbers, this expression is always non-negative.","Let $n \geqslant 2$ be a positive integer and $a_{1}, a_{2}, \ldots, a_{n}$ be real numbers such that $a_{1}+a_{2}+\cdots+a_{n}=0$. Define the set $A$ by $A=\left\{(i, j)\left|1 \leqslant i<j \leqslant n,\left|a_{i}-a_{j}\right| \geqslant 1\right. \right\}$. Prove that, if $A$ is not empty, then $\sum_{(i, j) \in A} a_{i} a_{j}<0$.","From Part 1, the problem is equivalent to proving $\sum_{(i, j) \in C} a_i a_j > 0$ given $A \neq \emptyset$. From Part 2, we know $\sum_{(i, j) \in C} a_{i} a_{j} \ge \sum_{i \in P \cup S} a_{i}^{2}+\left(\sum_{k \in Q \cup R} a_{k}\right)^{2} \ge 0$. For equality to hold in this chain, we must have $P=S=\emptyset$ (so all $|a_i|<1$), and the first inequality must also be an equality, which requires $|a_i-a_j|<1$ for all $i,j \in Q \cup R$. Together, these conditions imply $|a_i-a_j|<1$ for all pairs $(i,j)$, which means the set $A$ would be empty. This contradicts the given condition that $A$ is not empty. Therefore, the inequality must be strict: $\sum_{(i, j) \in C} a_i a_j > 0$. By Part 1, this proves the claim.",,
2019a5,"Let $x_{1}, x_{2}, \ldots, x_{n}$ be different real numbers. Prove that $$
\sum_{1 \leqslant i \leqslant n} \prod_{j \neq i} \frac{1-x_{i} x_{j}}{x_{i}-x_{j}}= \begin{cases}0, & \text { if } n \text { is even } \\ 1, & \text { if } n \text { is odd }\end{cases}
$$","Common remarks. Let $G\left(x_{1}, x_{2}, \ldots, x_{n}\right)$ be the function of the $n$ variables $x_{1}, x_{2}, \ldots, x_{n}$ on the LHS of the required identity.

(Lagrange interpolation). Since both sides of the identity are rational functions, it suffices to prove it when all $x_{i} \notin\{ \pm 1\}$. Define

$$
f(t)=\prod_{i=1}^{n}\left(1-x_{i} t\right)
$$

and note that

$$
f\left(x_{i}\right)=\left(1-x_{i}^{2}\right) \prod_{j \neq i} 1-x_{i} x_{j} .
$$

Using the nodes $+1,-1, x_{1}, \ldots, x_{n}$, the Lagrange interpolation formula gives us the following expression for $f$ :

$$
\sum_{i=1}^{n} f\left(x_{i}\right) \frac{(x-1)(x+1)}{\left(x_{i}-1\right)\left(x_{i}+1\right)} \prod_{j \neq i} \frac{x-x_{j}}{x_{i}-x_{j}}+f(1) \frac{x+1}{1+1} \prod_{1 \leqslant i \leqslant n} \frac{x-x_{i}}{1-x_{i}}+f(-1) \frac{x-1}{-1-1} \prod_{1 \leqslant i \leqslant n} \frac{x-x_{i}}{1-x_{i}} .
$$

The coefficient of $t^{n+1}$ in $f(t)$ is 0 , since $f$ has degree $n$. The coefficient of $t^{n+1}$ in the above expression of $f$ is

$$
\begin{aligned}
0 & =\sum_{1 \leqslant i \leqslant n} \frac{f\left(x_{i}\right)}{\prod_{j \neq i}\left(x_{i}-x_{j}\right) \cdot\left(x_{i}-1\right)\left(x_{i}+1\right)}+\frac{f(1)}{\prod_{1 \leqslant j \leqslant n}\left(1-x_{j}\right) \cdot(1+1)}+\frac{f(-1)}{\prod_{1 \leqslant j \leqslant n}\left(-1-x_{j}\right) \cdot(-1-1)} \\
& =-G\left(x_{1}, \ldots, x_{n}\right)+\frac{1}{2}+\frac{(-1)^{n+1}}{2} .
\end{aligned}
$$",2,"Let $x_1, \ldots, x_n$ be distinct real numbers and let $S_n = \sum_{1 \leqslant i \leqslant n} \prod_{j \neq i} \frac{1-x_{i} x_{j}}{x_{i}-x_{j}}$. By considering the Lagrange interpolation of the polynomial $f(t) = \prod_{k=1}^{n}(1-x_k t)$ at the nodes $x_1, \ldots, x_n, 1, -1$, prove that $S_n = \frac{1}{2} + \frac{(-1)^{n+1}}{2}$.","Let $f(t) = \prod_{k=1}^{n}(1-x_k t)$. Since $f(t)$ is a polynomial of degree $n$, the coefficient of $t^{n+1}$ in its unique Lagrange interpolation polynomial passing through the $n+2$ distinct points $(x_i, f(x_i))$ for $i=1,\dots,n$, $(1, f(1))$, and $(-1, f(-1))$ must be zero. This coefficient is given by the sum of the leading coefficients of each term in the Lagrange formula:\n$0 = \sum_{i=1}^{n} \frac{f(x_i)}{(x_i^2-1)\prod_{j \neq i}(x_i-x_j)} + \frac{f(1)}{2\prod_{j=1}^{n}(1-x_j)} + \frac{f(-1)}{-2\prod_{j=1}^{n}(-1-x_j)}$.\nWe substitute $f(x_i) = (1-x_i^2)\prod_{j \neq i}(1-x_ix_j)$, $f(1) = \prod_{j=1}^{n}(1-x_j)$, and $f(-1) = \prod_{j=1}^{n}(1+x_j)$.\nThe equation becomes $0 = \sum_{i=1}^{n} \frac{-(1-x_i^2)\prod_{j \neq i}(1-x_ix_j)}{(1-x_i^2)\prod_{j \neq i}(x_i-x_j)} + \frac{1}{2} + \frac{\prod_{j=1}^{n}(1+x_j)}{-2(-1)^n\prod_{j=1}^{n}(1+x_j)}$.\nThis simplifies to $0 = -S_n + \frac{1}{2} + \frac{1}{-2(-1)^n} = -S_n + \frac{1}{2} + \frac{(-1)^{n+1}}{2}$.\nTherefore, $S_n = \frac{1}{2} + \frac{(-1)^{n+1}}{2}$.","Let $x_{1}, x_{2}, \ldots, x_{n}$ be different real numbers. Prove that \n$$ \sum_{1 \leqslant i \leqslant n} \prod_{j \neq i} \frac{1-x_{i} x_{j}}{x_{i}-x_{j}}= \begin{cases}0, & \text { if } n \text { is even } \\ 1, & \text { if } n \text { is odd }\end{cases} $$","Let the sum be $S_n$. From the previous sub-problem, we have the identity $S_n = \frac{1}{2} + \frac{(-1)^{n+1}}{2}$. We examine this based on the parity of $n$.\nCase 1: $n$ is even. Then $n+1$ is odd, so $(-1)^{n+1} = -1$. The sum is $S_n = \frac{1}{2} + \frac{-1}{2} = 0$.\nCase 2: $n$ is odd. Then $n+1$ is even, so $(-1)^{n+1} = 1$. The sum is $S_n = \frac{1}{2} + \frac{1}{2} = 1$.\nThis covers all cases and completes the proof.",,,,
2019a6,"A polynomial $P(x, y, z)$ in three variables with real coefficients satisfies the identities


\begin{equation*}
P(x, y, z)=P(x, y, x y-z)=P(x, z x-y, z)=P(y z-x, y, z) . \tag{*}
\end{equation*}


Prove that there exists a polynomial $F(t)$ in one variable such that

$$
P(x, y, z)=F\left(x^{2}+y^{2}+z^{2}-x y z\right) .
$$","Common remarks. The polynomial $x^{2}+y^{2}+z^{2}-x y z$ satisfies the condition (\textit{), so every polynomial of the form $F\left(x^{2}+y^{2}+z^{2}-x y z\right)$ does satisfy (}). We will use without comment the fact that two polynomials have the same coefficients if and only if they are equal as functions.

In the first two steps, we deal with any polynomial $P(x, y, z)$ satisfying $P(x, y, z)=$ $P(x, y, x y-z)$. Call such a polynomial weakly symmetric, and call a polynomial satisfying the full conditions in the problem symmetric.

Step 1. We start with the description of weakly symmetric polynomials. We claim that they are exactly the polynomials in $x, y$, and $z(x y-z)$. Clearly, all such polynomials are weakly symmetric. For the converse statement, consider $P_{1}(x, y, z):=P\left(x, y, z+\frac{1}{2} x y\right)$, which satisfies $P_{1}(x, y, z)=P_{1}(x, y,-z)$ and is therefore a polynomial in $x, y$, and $z^{2}$. This means that $P$ is a polynomial in $x, y$, and $\left(z-\frac{1}{2} x y\right)^{2}=-z(x y-z)+\frac{1}{4} x^{2} y^{2}$, and therefore a polynomial in $x, y$, and $z(x y-z)$.\\
Step 2. Suppose that $P$ is weakly symmetric. Consider the monomials in $P(x, y, z)$ of highest total degree. Our aim is to show that in each such monomial $\mu x^{a} y^{b} z^{c}$ we have $a, b \geqslant c$. Consider the expansion


\begin{equation*}
P(x, y, z)=\sum_{i, j, k} \mu_{i j k} x^{i} y^{j}(z(x y-z))^{k} \tag{1.1}
\end{equation*}


The maximal total degree of a summand in (1.1) is $m=\max _{i, j, k: \mu_{i j k} \neq 0}(i+j+3 k)$. Now, for any $i, j, k$ satisfying $i+j+3 k=m$ the summand $\mu_{i, j, k} x^{i} y^{j}(z(x y-z))^{k}$ has leading term of the form $\mu x^{i+k} y^{j+k} z^{k}$. No other nonzero summand in (1.1) may have a term of this form in its expansion, hence this term does not cancel in the whole sum. Therefore, $\operatorname{deg} P=m$, and the leading component of $P$ is exactly

$$
\sum_{i+j+3 k=m} \mu_{i, j, k} x^{i+k} y^{j+k} z^{k},
$$

and each summand in this sum satisfies the condition claimed above.\\
Step 3. We now prove the problem statement by induction on $m=\operatorname{deg} P$. For $m=0$ the claim is trivial. Consider now a symmetric polynomial $P$ with $\operatorname{deg} P>0$. By Step 2, each of its monomials $\mu x^{a} y^{b} z^{c}$ of the highest total degree satisfies $a, b \geqslant c$. Applying other weak symmetries, we obtain $a, c \geqslant b$ and $b, c \geqslant a$; therefore, $P$ has a unique leading monomial of the form $\mu(x y z)^{c}$. The polynomial $P_{0}(x, y, z)=P(x, y, z)-\mu\left(x y z-x^{2}-y^{2}-z^{2}\right)^{c}$ has smaller total degree. Since $P_{0}$ is symmetric, it is representable as a polynomial function of $x y z-x^{2}-y^{2}-z^{2}$. Then $P$ is also of this form, completing the inductive step.",3,"Show that a polynomial $P(x, y, z)$ satisfies the identity $P(x, y, z) = P(x, y, xy-z)$ if and only if it can be expressed as a polynomial in the variables $x, y,$ and $z(xy-z)$.","If $P$ is a polynomial in $x, y,$ and $z(xy-z)$, then $P(x,y,z) = Q(x, y, z(xy-z))$ for some polynomial $Q$. The substitution $z \mapsto xy-z$ yields $Q(x, y, (xy-z)(xy-(xy-z))) = Q(x, y, (xy-z)z) = P(x,y,z)$, so the identity holds. Conversely, assume $P(x, y, z) = P(x, y, xy-z)$. Let $z' = z - xy/2$. The identity becomes $P(x, y, z' + xy/2) = P(x, y, -z' + xy/2)$, which means the polynomial $P_1(x, y, z') = P(x, y, z' + xy/2)$ is an even function of $z'$. Therefore, $P_1$ is a polynomial in $x, y,$ and $(z')^2$. Substituting $z' = z - xy/2$ back, we find that $P(x, y, z)$ is a polynomial in $x, y,$ and $(z - xy/2)^2 = z^2 - xyz + x^2y^2/4 = -z(xy-z) + x^2y^2/4$. As $P$ is a polynomial in $x,y$ and this expression, it must be a polynomial in $x, y,$ and $z(xy-z)$.","Let $P(x, y, z)$ be a polynomial satisfying the three identities $P(x, y, z)=P(x, y, x y-z)$, $P(x, y, z)=P(x, z x-y, z)$, and $P(x, y, z)=P(y z-x, y, z)$. Show that any monomial of the highest total degree in $P(x, y, z)$ must be of the form $\\mu(xyz)^k$ for some constant $\\mu$ and non-negative integer $k$.","Let $x^a y^b z^c$ be a monomial of maximal total degree in $P$. From Sub-problem 1, the identity $P(x, y, z)=P(x, y, x y-z)$ implies $P$ is a polynomial in $x, y,$ and $z(xy-z)$. Expanding $P(x,y,z) = \\sum_{i,j,k} \\mu_{ijk} x^i y^j (z(xy-z))^k$, the highest degree part of $x^i y^j (zxy-z^2)^k$ is $x^{i+k}y^{j+k}z^k$. Thus, for any monomial $x^a y^b z^c$ of maximal degree in $P$, we must have $a \\ge c$ and $b \\ge c$. The other two identities are symmetric. The identity $P(x, y, z)=P(x, z x-y, z)$, by a symmetric argument (swapping roles of $y$ and $z$), implies that for any highest-degree monomial, $a \\ge b$ and $c \\ge b$. Similarly, the third identity $P(x, y, z)=P(y z-x, y, z)$ (swapping $x$ and $z$) implies $b \\ge a$ and $c \\ge a$. Combining all conditions ($a \\ge c, b \\ge c, a \\ge b, c \\ge b, b \\ge a, c \\ge a$) forces $a=b=c$. Therefore, any monomial of the highest total degree must be of the form $\\mu(xyz)^k$.","A polynomial $P(x, y, z)$ in three variables with real coefficients satisfies the identities\n$P(x, y, z)=P(x, y, x y-z)=P(x, z x-y, z)=P(y z-x, y, z)$.\nProve that there exists a polynomial $F(t)$ in one variable such that\n$P(x, y, z)=F\\left(x^{2}+y^{2}+z^{2}-x y z\right)$.","We proceed by induction on the degree of $P$. If $\\deg(P)=0$, $P$ is a constant, so the statement is true. Assume the statement holds for all polynomials satisfying the conditions with degree less than $m > 0$. Let $P$ be such a polynomial with $\\deg(P)=m$. By Sub-problem 2, the highest degree term of $P$ is $\\mu(xyz)^k$ for some $\\mu \neq 0$ and $k \\ge 1$, so $m=3k$. Let $I(x,y,z) = x^2+y^2+z^2-xyz$. This polynomial satisfies the given identities. The highest degree term of $I(x,y,z)^k$ is $(-xyz)^k = (-1)^k(xyz)^k$. Consider the polynomial $P_0(x,y,z) = P(x,y,z) - \\mu(-1)^k I(x,y,z)^k$. $P_0$ also satisfies the given identities. The highest degree term of $P$ is cancelled by the highest degree term of $\\mu(-1)^k I(x,y,z)^k$, so $\\deg(P_0) < m$. By the induction hypothesis, there exists a polynomial $G(t)$ such that $P_0(x,y,z) = G(I(x,y,z))$. Then $P(x,y,z) = G(I(x,y,z)) + \\mu(-1)^k (I(x,y,z))^k$. This is a polynomial in $I(x,y,z)$, so we can define $F(t) = G(t) + \\mu(-1)^k t^k$. This completes the induction.",,
2019a7,"Let $\mathbb{Z}$ be the set of integers. We consider functions $f: \mathbb{Z} \rightarrow \mathbb{Z}$ satisfying

$$
f(f(x+y)+y)=f(f(x)+y)
$$

for all integers $x$ and $y$. For such a function, we say that an integer $v$ is $f$-rare if the set

$$
X_{v}=\{x \in \mathbb{Z}: f(x)=v\}
$$

is finite and nonempty.\\
(a) Prove that there exists such a function $f$ for which there is an $f$-rare integer.\\
(b) Prove that no such function $f$ can have more than one $f$-rare integer.","a) Let $f$ be the function where $f(0)=0$ and $f(x)$ is the largest power of 2 dividing $2 x$ for $x \neq 0$. The integer 0 is evidently $f$-rare, so it remains to verify the functional equation.

Since $f(2 x)=2 f(x)$ for all $x$, it suffices to verify the functional equation when at least one of $x$ and $y$ is odd (the case $x=y=0$ being trivial). If $y$ is odd, then we have

$$
f(f(x+y)+y)=2=f(f(x)+y)
$$

since all the values attained by $f$ are even. If, on the other hand, $x$ is odd and $y$ is even, then we already have

$$
f(x+y)=2=f(x)
$$

from which the functional equation follows immediately.\\
b) An easy inductive argument (substituting $x+k y$ for $x$ ) shows that


\begin{equation*}
f(f(x+k y)+y)=f(f(x)+y) \tag{*}
\end{equation*}


for all integers $x, y$ and $k$. If $v$ is an $f$-rare integer and $a$ is the least element of $X_{v}$, then by substituting $y=a-f(x)$ in the above, we see that

$$
f(x+k \cdot(a-f(x)))-f(x)+a \in X_{v}
$$

for all integers $x$ and $k$, so that in particular

$$
f(x+k \cdot(a-f(x))) \geqslant f(x)
$$

for all integers $x$ and $k$, by assumption on $a$. This says that on the (possibly degenerate) arithmetic progression through $x$ with common difference $a-f(x)$, the function $f$ attains its minimal value at $x$.

Repeating the same argument with $a$ replaced by the greatest element $b$ of $X_{v}$ shows that

$$
f(x+k \cdot(b-f(x)) \leqslant f(x)
$$

for all integers $x$ and $k$. Combined with the above inequality, we therefore have


\begin{equation*}
f(x+k \cdot(a-f(x)) \cdot(b-f(x)))=f(x) \tag{$\dagger$}
\end{equation*}


for all integers $x$ and $k$.\\
Thus if $f(x) \neq a, b$, then the set $X_{f(x)}$ contains a nondegenerate arithmetic progression, so is infinite. So the only possible $f$-rare integers are $a$ and $b$.

In particular, the $f$-rare integer $v$ we started with must be one of $a$ or $b$, so that $f(v)=$ $f(a)=f(b)=v$. This means that there cannot be any other $f$-rare integers $v^{\prime}$, as they would on the one hand have to be either $a$ or $b$, and on the other would have to satisfy $f\left(v^{\prime}\right)=v^{\prime}$. Thus $v$ is the unique $f$-rare integer.",3,Prove that there exists a function $f: \mathbb{Z} \rightarrow \mathbb{Z}$ satisfying $f(f(x+y)+y)=f(f(x)+y)$ for which there is an $f$-rare integer.,"Let $f(0)=0$ and for $x \neq 0$, let $f(x)$ be the largest power of 2 dividing $2x$. The set $X_0 = \{x \in \mathbb{Z} : f(x)=0\}$ is just $\{0\}$, which is finite and nonempty, so 0 is an $f$-rare integer. To verify the functional equation, note that for any $z \neq 0$, $f(z)$ is an even number. If $y$ is odd, then $f(x+y)+y$ and $f(x)+y$ are both odd (as $f$ maps to evens). The largest power of 2 dividing $2 \times (\text{odd})$ is 2. Thus, $f(f(x+y)+y)=2$ and $f(f(x)+y)=2$. If $y$ is even and $x$ is odd, then $x+y$ is odd. Then $f(x)=2$ and $f(x+y)=2$, so $f(f(x+y)+y)=f(2+y)$ and $f(f(x)+y)=f(2+y)$, making the equation hold. If $x,y$ are both even, the property $f(2z)=2f(z)$ can be used to reduce the problem, and the case $x=y=0$ is trivial.","Let $f$ be a function satisfying the given equation. Let $v$ be an $f$-rare integer, and let $a = \min(X_v)$ and $b = \max(X_v)$. Prove that any $f$-rare integer must be an element of the set $\{a, b\}$.","A simple induction on $k$ shows that $f(f(x+ky)+y)=f(f(x)+y)$ for all integers $x, y, k$. Let $v$ be an $f$-rare integer, $a = \min(X_v)$, and $b = \max(X_v)$. For any $x \in \mathbb{Z}$, substitute $y = a-f(x)$. The equation gives $f(f(x+k(a-f(x))) + a-f(x)) = f(f(x)+a-f(x)) = f(a) = v$. This means $f(x+k(a-f(x))) + a-f(x) \in X_v$. Since $a$ is the minimum of $X_v$, we have $f(x+k(a-f(x))) + a-f(x) \ge a$, which simplifies to $f(x+k(a-f(x))) \ge f(x)$. Similarly, substituting $y=b-f(x)$ shows $f(x+k(b-f(x))) \le f(x)$. Combining these inequalities for the common difference $d=(a-f(x))(b-f(x))$ implies $f(x+kd)=f(x)$ for all $k$. If $f(x) \notin \{a,b\}$, then $d \neq 0$, so $X_{f(x)}$ contains an infinite arithmetic progression and $f(x)$ cannot be $f$-rare. Therefore, any $f$-rare integer must belong to $\{a,b\}$.","Let $f: \mathbb{Z} \rightarrow \mathbb{Z}$ satisfy $f(f(x+y)+y)=f(f(x)+y)$ for all $x, y \in \mathbb{Z}$. An integer $v$ is $f$-rare if $X_v=\{x \in \mathbb{Z}: f(x)=v\}$ is finite and nonempty. (a) Prove that there exists such a function $f$ for which there is an $f$-rare integer. (b) Prove that no such function $f$ can have more than one $f$-rare integer.","Part (a) is proven in Sub-problem 1. For part (b), let $v$ be an f-rare integer. Let $a=\min(X_v)$ and $b=\max(X_v)$. By Sub-problem 2, the set of all f-rare integers, $R$, is a subset of $\{a, b\}$. Let $v' \in R$. Let $a'=\min(X_{v'})$ and $b'=\max(X_{v'})$. By Sub-problem 2 again, $R \subseteq \{a',b'\}$, so $v' \in \{a',b'\}$. This implies $f(v')=v'$, so any f-rare integer is a fixed point of $f$. Suppose there were two distinct f-rare integers $v_1, v_2$. Then $\{v_1, v_2\} \subseteq \{a_1, b_1\}$ where $a_1=\min X_{v_1}, b_1=\max X_{v_1}$. Thus $\{v_1,v_2\}=\{a_1,b_1\}$. Since $a_1, b_1 \in X_{v_1}$, we have $f(a_1)=v_1$ and $f(b_1)=v_1$. This means $f(v_1)=v_1$ and $f(v_2)=v_1$. But since $v_2$ is f-rare, it must be a fixed point, so $f(v_2)=v_2$. This implies $v_1=v_2$, a contradiction. Therefore, at most one f-rare integer can exist.",,
2019c1,"The infinite sequence $a_{0}, a_{1}, a_{2}, \ldots$ of (not necessarily different) integers has the following properties: $0 \leqslant a_{i} \leqslant i$ for all integers $i \geqslant 0$, and

$$
\binom{k}{a_{0}}+\binom{k}{a_{1}}+\cdots+\binom{k}{a_{k}}=2^{k}
$$

for all integers $k \geqslant 0$.\\
Prove that all integers $N \geqslant 0$ occur in the sequence (that is, for all $N \geqslant 0$, there exists $i \geqslant 0$ with $a_{i}=N$ ).","Solution. We prove by induction on $k$ that every initial segment of the sequence, $a_{0}, a_{1}, \ldots, a_{k}$, consists of the following elements (counted with multiplicity, and not necessarily in order), for some $\ell \geqslant 0$ with $2 \ell \leqslant k+1$ :

$$
0,1, \ldots, \ell-1, \quad 0,1, \ldots, k-\ell .
$$

For $k=0$ we have $a_{0}=0$, which is of this form. Now suppose that for $k=m$ the elements $a_{0}, a_{1}, \ldots, a_{m}$ are $0,0,1,1,2,2, \ldots, \ell-1, \ell-1, \ell, \ell+1, \ldots, m-\ell-1, m-\ell$ for some $\ell$ with $0 \leqslant 2 \ell \leqslant m+1$. It is given that

$$
\binom{m+1}{a_{0}}+\binom{m+1}{a_{1}}+\cdots+\binom{m+1}{a_{m}}+\binom{m+1}{a_{m+1}}=2^{m+1},
$$

which becomes

$$
\begin{aligned}
\left(\binom{m+1}{0}+\binom{m+1}{1}\right. & \left.+\cdots+\binom{m+1}{\ell-1}\right) \\
& +\left(\binom{m+1}{0}+\binom{m+1}{1}+\cdots+\binom{m+1}{m-\ell}\right)+\binom{m+1}{a_{m+1}}=2^{m+1}
\end{aligned}
$$

or, using $\binom{m+1}{i}=\binom{m+1}{m+1-i}$, that

$$
\begin{aligned}
\left(\binom{m+1}{0}+\binom{m+1}{1}\right. & \left.+\cdots+\binom{m+1}{\ell-1}\right) \\
& +\left(\binom{m+1}{m+1}+\binom{m+1}{m}+\cdots+\binom{m+1}{\ell+1}\right)+\binom{m+1}{a_{m+1}}=2^{m+1}
\end{aligned}
$$

On the other hand, it is well known that

$$
\binom{m+1}{0}+\binom{m+1}{1}+\cdots+\binom{m+1}{m+1}=2^{m+1}
$$

and so, by subtracting, we get

$$
\binom{m+1}{a_{m+1}}=\binom{m+1}{\ell} .
$$

From this, using the fact that the binomial coefficients $\binom{m+1}{i}$ are increasing for $i \leqslant \frac{m+1}{2}$ and decreasing for $i \geqslant \frac{m+1}{2}$, we conclude that either $a_{m+1}=\ell$ or $a_{m+1}=m+1-\ell$. In either case, $a_{0}, a_{1}, \ldots, a_{m+1}$ is again of the claimed form, which concludes the induction.

As a result of this description, any integer $N \geqslant 0$ appears as a term of the sequence $a_{i}$ for some $0 \leqslant i \leqslant 2 N$.",2,"Prove that for any integer $k \ge 0$, the multiset of the first $k+1$ terms of the sequence, $\{a_0, a_1, \ldots, a_k\}$, is the union of the multisets $\{0, 1, \ldots, \ell-1\}$ and $\{0, 1, \ldots, k-\ell\}$ for some integer $\ell$ satisfying $0 \le 2\ell \le k+1$.","We proceed by induction on $k$. For $k=0$, the given equation $\binom{0}{a_0} = 2^0 = 1$ implies $a_0=0$. This matches the claimed form with $\ell=0$. Assume the statement holds for $k=m$. Then the multiset $\{a_0, \dots, a_m\}$ is $\{0, \dots, \ell-1\} \cup \{0, \dots, m-\ell\}$ for some $\ell$ with $2\ell \le m+1$. For $k=m+1$, the equation is $\sum_{i=0}^{m+1} \binom{m+1}{a_i} = 2^{m+1}$. Using the inductive hypothesis, this becomes $\sum_{j=0}^{\ell-1}\binom{m+1}{j} + \sum_{j=0}^{m-\ell}\binom{m+1}{j} + \binom{m+1}{a_{m+1}} = 2^{m+1}$. Using the identity $\binom{n}{j}=\binom{n}{n-j}$ and comparing with the binomial expansion $\sum_{j=0}^{m+1}\binom{m+1}{j} = 2^{m+1}$, we deduce that $\binom{m+1}{a_{m+1}} = \binom{m+1}{\ell}$. Since $0 \le a_{m+1} \le m+1$, this implies $a_{m+1}=\ell$ or $a_{m+1}=m+1-\ell$. In either case, the new multiset $\{a_0, \ldots, a_{m+1}\}$ is again of the claimed form for $k=m+1$, which completes the induction.","Prove that all integers $N \ge 0$ occur in the sequence (that is, for all $N \ge 0$, there exists $i \ge 0$ with $a_{i}=N$).","From the first sub-problem, for any $k \ge 0$, the multiset $\{a_0, \ldots, a_k\}$ is the union of $\{0, \ldots, \ell-1\}$ and $\{0, \ldots, k-\ell\}$ for some integer $\ell$ with $2\ell \le k+1$. Let $N \ge 0$ be any integer. Consider the multiset of terms for $k=2N$. This multiset is $\{a_0, \ldots, a_{2N}\} = \{0, \ldots, \ell-1\} \cup \{0, \ldots, 2N-\ell\}$ for some $\ell$ satisfying $2\ell \le 2N+1$. An integer $N$ is in this multiset if either $N \le \ell-1$ (which means $\ell \ge N+1$) or $N \le 2N-\ell$ (which means $\ell \le N$). Since for any integer $\ell$, it must be that either $\ell \le N$ or $\ell \ge N+1$, $N$ is guaranteed to be in the multiset $\{a_0, \ldots, a_{2N}\}$. Therefore, for any $N \ge 0$, there exists an index $i \le 2N$ such that $a_i = N$.",,,,
2019c2,"You are given a set of $n$ blocks, each weighing at least 1 ; their total weight is $2 n$. Prove that for every real number $r$ with $0 \leqslant r \leqslant 2 n-2$ you can choose a subset of the blocks whose total weight is at least $r$ but at most $r+2$.","We prove the following more general statement by induction on $n$.\\
Claim. Suppose that you have $n$ blocks, each of weight at least 1 , and of total weight $s \leqslant 2 n$. Then for every $r$ with $-2 \leqslant r \leqslant s$, you can choose some of the blocks whose total weight is at least $r$ but at most $r+2$.\\
Proof. The base case $n=1$ is trivial. To prove the inductive step, let $x$ be the largest block weight. Clearly, $x \geqslant s / n$, so $s-x \leqslant \frac{n-1}{n} s \leqslant 2(n-1)$. Hence, if we exclude a block of weight $x$, we can apply the inductive hypothesis to show the claim holds (for this smaller set) for any $-2 \leqslant r \leqslant s-x$. Adding the excluded block to each of those combinations, we see that the claim also holds when $x-2 \leqslant r \leqslant s$. So if $x-2 \leqslant s-x$, then we have covered the whole interval $[-2, s]$. But each block weight is at least 1 , so we have $x-2 \leqslant(s-(n-1))-2=s-(2 n-(n-1)) \leqslant s-(s-(n-1)) \leqslant s-x$, as desired.",2,"Prove the following generalized statement: Given $n$ blocks, each of weight at least 1, and of total weight $s \\le 2n$. Then for every real number $r$ with $-2 \\le r \\le s$, you can choose a subset of the blocks whose total weight is at least $r$ but at most $r+2$.","We prove the claim by induction on $n$. The base case $n=1$ is trivial, as the possible subset sums (0 and $s$, where $s \le 2$) cover the interval $[-2, s]$ for the property. For the inductive step, assume the claim holds for $n-1$. Given $n$ blocks of total weight $s \le 2n$, let $x$ be the largest weight. The other $n-1$ blocks have total weight $s-x$. Since $x$ is at least the average weight $s/n$, we have $s-x \le s(n-1)/n \le 2n(n-1)/n = 2(n-1)$. By the inductive hypothesis, for any $r' \in [-2, s-x]$, there is a subset of these $n-1$ blocks with weight in $[r', r'+2]$. This satisfies the claim for $r \in [-2, s-x]$. By adding the block of weight $x$ to these subsets, we can form sums satisfying the claim for any $r \in [x-2, s]$. The union of these two intervals, $[-2, s-x] \cup [x-2, s]$, covers the entire interval $[-2, s]$ provided that $s-x \ge x-2$, or $2x \le s+2$. Since the other $n-1$ blocks each weigh at least 1, their total weight is at least $n-1$, so $s-x \ge n-1$, which implies $x \le s-n+1$. Then $2x \le 2(s-n+1) = 2s-2n+2$. Since $s \le 2n$, $2s-2n+2 \le s+2$. Thus $2x \le s+2$ holds, completing the induction.","You are given a set of $n$ blocks, each weighing at least 1; their total weight is $2n$. Prove that for every real number $r$ with $0 \le r \le 2n-2$ you can choose a subset of the blocks whose total weight is at least $r$ but at most $r+2$.","This problem is a specific case of the generalized statement proven in the previous sub-problem. We are given $n$ blocks, each with weight at least 1, and a total weight $s = 2n$. These conditions satisfy the premises of the proven statement (with $s \le 2n$). Therefore, we can apply its conclusion: for every real number $r$ with $-2 \le r \le 2n$, there exists a subset of blocks whose total weight is in the interval $[r, r+2]$. The range specified in this problem, $0 \le r \le 2n-2$, is a sub-interval of $[-2, 2n]$. Consequently, the statement holds for the required range of $r$.",,,,
2019c5,"On a certain social network, there are 2019 users, some pairs of which are friends, where friendship is a symmetric relation. Initially, there are 1010 people with 1009 friends each and 1009 people with 1010 friends each. However, the friendships are rather unstable, so events of the following kind may happen repeatedly, one at a time:

Let $A, B$, and $C$ be people such that $A$ is friends with both $B$ and $C$, but $B$ and $C$ are not friends; then $B$ and $C$ become friends, but $A$ is no longer friends with them.

Prove that, regardless of the initial friendships, there exists a sequence of such events after which each user is friends with at most one other user.\\
(Croatia)","Common remarks. The problem has an obvious rephrasing in terms of graph theory. One is given a graph $G$ with 2019 vertices, 1010 of which have degree 1009 and 1009 of which have degree 1010. One is allowed to perform operations on $G$ of the following kind:

Suppose that vertex $A$ is adjacent to two distinct vertices $B$ and $C$ which are not adjacent to each other. Then one may remove the edges $A B$ and $A C$ from $G$ and add the edge $B C$ into $G$.

Call such an operation a refriending. One wants to prove that, via a sequence of such refriendings, one can reach a graph which is a disjoint union of single edges and vertices.

All of the solutions presented below will use this reformulation.\\
Note that the given graph is connected, since the total degree of any two vertices is at least 2018 and hence they are either adjacent or have at least one neighbour in common. Hence the given graph satisfies the following condition:

Every connected component of $G$ with at least three vertices is not complete and has a vertex of odd degree.

We will show that if a graph $G$ satisfies condition (1) and has a vertex of degree at least 2 , then there is a refriending on $G$ that preserves condition (1). Since refriendings decrease the total number of edges of $G$, by using a sequence of such refriendings, we must reach a graph $G$ with maximal degree at most 1 , so we are done.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_c4214a078eb1790cb0a3g-041}

Pick a vertex $A$ of degree at least 2 in a connected component $G^{\prime}$ of $G$. Since no component of $G$ with at least three vertices is complete we may assume that not all of the neighbours of $A$ are adjacent to one another. (For example, pick a maximal complete subgraph $K$ of $G^{\prime}$. Some vertex $A$ of $K$ has a neighbour outside $K$, and this neighbour is not adjacent to every vertex of $K$ by maximality.) Removing $A$ from $G$ splits $G^{\prime}$ into smaller connected components $G_{1}, \ldots, G_{k}$ (possibly with $k=1$ ), to each of which $A$ is connected by at least one edge. We divide into several cases.

Case 1: $k \geqslant 2$ and $A$ is connected to some $G_{i}$ by at least two edges.\\
Choose a vertex $B$ of $G_{i}$ adjacent to $A$, and a vertex $C$ in another component $G_{j}$ adjacent to $A$. The vertices $B$ and $C$ are not adjacent, and hence removing edges $A B$ and $A C$ and adding in edge $B C$ does not disconnect $G^{\prime}$. It is easy to see that this preserves the condition, since the refriending does not change the parity of the degrees of vertices.

Case 2: $k \geqslant 2$ and $A$ is connected to each $G_{i}$ by exactly one edge.\\
Consider the induced subgraph on any $G_{i}$ and the vertex $A$. The vertex $A$ has degree 1 in this subgraph; since the number of odd-degree vertices of a graph is always even, we see that $G_{i}$ has a vertex of odd degree (in $G$ ). Thus if we let $B$ and $C$ be any distinct neighbours of $A$, then removing edges $A B$ and $A C$ and adding in edge $B C$ preserves the above condition: the refriending creates two new components, and if either of these components has at least three vertices, then it cannot be complete and must contain a vertex of odd degree (since each $G_{i}$ does).

Case 3: $k=1$ and $A$ is connected to $G_{1}$ by at least three edges.\\
By assumption, $A$ has two neighbours $B$ and $C$ which are not adjacent to one another. Removing edges $A B$ and $A C$ and adding in edge $B C$ does not disconnect $G^{\prime}$. We are then done as in Case 1.

Case 4: $k=1$ and $A$ is connected to $G_{1}$ by exactly two edges.\\
Let $B$ and $C$ be the two neighbours of $A$, which are not adjacent. Removing edges $A B$ and $A C$ and adding in edge $B C$ results in two new components: one consisting of a single vertex; and the other containing a vertex of odd degree. We are done unless this second component would be a complete graph on at least 3 vertices. But in this case, $G_{1}$ would be a complete graph minus the single edge $B C$, and hence has at least 4 vertices since $G^{\prime}$ is not a 4-cycle. If we let $D$ be a third vertex of $G_{1}$, then removing edges $B A$ and $B D$ and adding in edge $A D$ does not disconnect $G^{\prime}$. We are then done as in Case 1.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_c4214a078eb1790cb0a3g-042}",4,Show that each 'refriending' operation reduces the total number of edges by one and preserves the parity of every vertex's degree.,"A refriending operation involves a vertex A and two of its non-adjacent neighbors, B and C. The edges AB and AC are removed, and edge BC is added. The net change in the number of edges is -2 + 1 = -1. The degree of A decreases by 2. The degrees of B and C are unchanged, as they each lose neighbor A and gain a new neighbor (the other vertex). All other degrees are unchanged. Since all degree changes are even (by -2 or 0), the parity of every vertex's degree is preserved.",Let P be the property that 'every connected component with at least three vertices is not a complete graph and contains at least one vertex of odd degree'. Show that the initial graph satisfies property P.,"The initial graph has 2019 vertices. Any two vertices u, v have deg(u)+deg(v) >= 1009+1009 = 2018. Since there are only 2017 other vertices, they must share a common neighbor, hence the graph is connected. This single component is not complete, as all degrees would have to be 2018. The initial configuration has 1010 vertices of degree 1009, which is odd. Thus, the initial graph satisfies property P.","Prove that if a graph G satisfies property P and has a vertex with degree at least 2, a refriending operation can be chosen that results in a new graph G' which also satisfies property P.","If a graph G satisfying P has a vertex A with degree ≥ 2, its component is not complete. Thus, A must have two non-adjacent neighbors, B and C. Performing the refriending on (A, B, C) preserves the degree parity of all vertices. If the graph remains connected, P holds as the graph is still not complete (fewer edges) and odd-degree vertices persist. If the graph splits, a case analysis shows that any new component with at least 3 vertices is also not complete and inherits vertices of odd degree from the original component. Thus, property P is preserved.","Prove that, regardless of the initial friendships, there exists a sequence of such events after which each user is friends with at most one other user.","The process of refriending must terminate, as the number of edges decreases with each step (Sub-problem 1). The initial graph satisfies property P (Sub-problem 2), and this property is preserved at every step (Sub-problem 3). A state is terminal when no more operations are possible. An operation is possible if there is a vertex with degree at least 2. Property P ensures that any component containing such a vertex is not complete, guaranteeing that a valid refriending can be found. Therefore, the process can only terminate when no vertex has a degree of 2 or more, meaning the maximum degree in the graph is at most 1."
2019c6,"Let $n>1$ be an integer. Suppose we are given $2 n$ points in a plane such that no three of them are collinear. The points are to be labelled $A_{1}, A_{2}, \ldots, A_{2 n}$ in some order. We then consider the $2 n$ angles $\angle A_{1} A_{2} A_{3}, \angle A_{2} A_{3} A_{4}, \ldots, \angle A_{2 n-2} A_{2 n-1} A_{2 n}, \angle A_{2 n-1} A_{2 n} A_{1}$, $\angle A_{2 n} A_{1} A_{2}$. We measure each angle in the way that gives the smallest positive value (i.e. between $0^{\circ}$ and $180^{\circ}$ ). Prove that there exists an ordering of the given points such that the resulting $2 n$ angles can be separated into two groups with the sum of one group of angles equal to the sum of the other group.","Let $\ell$ be a line separating the points into two groups ( $L$ and $R$ ) with $n$ points in each. Label the points $A_{1}, A_{2}, \ldots, A_{2 n}$ so that $L=\left\{A_{1}, A_{3}, \ldots, A_{2 n-1}\right\}$. We claim that this labelling works.

Take a line $s=A_{2 n} A_{1}$.\\
(a) Rotate $s$ around $A_{1}$ until it passes through $A_{2}$; the rotation is performed in a direction such that $s$ is never parallel to $\ell$.\\
(b) Then rotate the new $s$ around $A_{2}$ until it passes through $A_{3}$ in a similar manner.\\
(c) Perform $2 n-2$ more such steps, after which $s$ returns to its initial position.

The total (directed) rotation angle $\Theta$ of $s$ is clearly a multiple of $180^{\circ}$. On the other hand, $s$ was never parallel to $\ell$, which is possible only if $\Theta=0$. Now it remains to partition all the $2 n$ angles into those where $s$ is rotated anticlockwise, and the others.",2,"Let $2n$ points in a plane be given, with no three collinear. Show that there exists an ordering of the points, $A_1, A_2, \ldots, A_{2n}$, such that the sum of the signed angles of rotation from each segment $A_{i-1}A_i$ to the next $A_iA_{i+1}$ (indices mod $2n$) is zero.","Let a line $\ell$ separate the points into two groups of $n$. Label points in one group with odd indices $A_1, A_3, \ldots, A_{2n-1}$ and the other with even indices. Consider a line $s$ that traces the path $A_1A_2\dots A_{2n}A_1$ by rotating at each vertex. The total directed rotation of $s$ after returning to its original orientation must be a multiple of $180^\circ$. Since for any $i$, $A_i$ and $A_{i+1}$ are on opposite sides of $\ell$, the segment $A_iA_{i+1}$ is never parallel to $\ell$. We can choose the rotation path at each vertex such that the rotating line is never parallel to $\ell$. This is only possible if the total rotation is exactly $0$.","Let $n>1$ be an integer. Suppose we are given $2 n$ points in a plane such that no three of them are collinear. The points are to be labelled $A_{1}, A_{2}, \ldots, A_{2 n}$ in some order. We then consider the $2 n$ angles $\\angle A_{1} A_{2} A_{3}, \\angle A_{2} A_{3} A_{4}, \ldots, \\angle A_{2 n-2} A_{2 n-1} A_{2 n}, \\angle A_{2 n-1} A_{2 n} A_{1}$, $\\angle A_{2 n} A_{1} A_{2}$. We measure each angle in the way that gives the smallest positive value (i.e. between $0^{\\circ}$ and $180^{\\circ}$ ). Prove that there exists an ordering of the given points such that the resulting $2 n$ angles can be separated into two groups with the sum of one group of angles equal to the sum of the other group.","From the previous step, there exists an ordering $A_1, \ldots, A_{2n}$ where the sum of the signed rotation angles is zero. Let $\alpha_i = \angle A_{i-1}A_iA_{i+1}$ be the angle at vertex $A_i$, a positive value less than $180^\circ$. The signed rotation angle at $A_i$ is either $+\alpha_i$ or $-\alpha_i$. Let $P$ be the set of indices where the rotation is positive and $N$ be the set where it is negative. The zero-sum condition means $\sum_{i \in P} \alpha_i + \sum_{i \in N} (-\alpha_i) = 0$. This implies $\sum_{i \in P} \alpha_i = \sum_{i \in N} \alpha_i$. Thus, the set of $2n$ angles $\{\alpha_1, \ldots, \alpha_{2n}\}$ is separated into two groups, corresponding to the sets $P$ and $N$, with equal sums.",,,,
2019c8,"Alice has a map of Wonderland, a country consisting of $n \geqslant 2$ towns. For every pair of towns, there is a narrow road going from one town to the other. One day, all the roads are declared to be ""one way"" only. Alice has no information on the direction of the roads, but the King of Hearts has offered to help her. She is allowed to ask him a number of questions. For each question in turn, Alice chooses a pair of towns and the King of Hearts tells her the direction of the road connecting those two towns.

Alice wants to know whether there is at least one town in Wonderland with at most one outgoing road. Prove that she can always find out by asking at most $4 n$ questions.","Solution. We will show Alice needs to ask at most $4 n-7$ questions. Her strategy has the following phases. In what follows, $S$ is the set of towns that Alice, so far, does not know to have more than one outgoing road (so initially $|S|=n$ ).

Phase 1. Alice chooses any two towns, say $A$ and $B$. Without loss of generality, suppose that the King of Hearts' answer is that the road goes from $A$ to $B$.

At the end of this phase, Alice has asked 1 question.\\
Phase 2. During this phase there is a single (variable) town $T$ that is known to have at least one incoming road but not yet known to have any outgoing roads. Initially, $T$ is $B$. Alice does the following $n-2$ times: she picks a town $X$ she has not asked about before, and asks the direction of the road between $T$ and $X$. If it is from $X$ to $T, T$ is unchanged; if it is from $T$ to $X, X$ becomes the new choice of town $T$, as the previous $T$ is now known to have an outgoing road.

At the end of this phase, Alice has asked a total of $n-1$ questions. The final town $T$ is not yet known to have any outgoing roads, while every other town has exactly one outgoing road known. The undirected graph of roads whose directions are known is a tree.

Phase 3. During this phase, Alice asks about the directions of all roads between $T$ and another town she has not previously asked about, stopping if she finds two outgoing roads from $T$. This phase involves at most $n-2$ questions. If she does not find two outgoing roads from $T$, she has answered her original question with at most $2 n-3 \leqslant 4 n-7$ questions, so in what follows we suppose that she does find two outgoing roads, asking a total of $k$ questions in this phase, where $2 \leqslant k \leqslant n-2$ (and thus $n \geqslant 4$ for what follows).

For every question where the road goes towards $T$, the town at the other end is removed from $S$ (as it already had one outgoing road known), while the last question resulted in $T$ being removed from $S$. So at the end of this phase, $|S|=n-k+1$, while a total of $n+k-1$ questions have been asked. Furthermore, the undirected graph of roads within $S$ whose directions are known contains no cycles (as $T$ is no longer a member of $S$, all questions asked in this phase involved $T$ and the graph was a tree before this phase started). Every town in $S$ has exactly one outgoing road known (not necessarily to another town in $S$ ).

Phase 4. During this phase, Alice repeatedly picks any pair of towns in $S$ for which she does not know the direction of the road between them. Because every town in $S$ has exactly one outgoing road known, this always results in the removal of one of those two towns from $S$. Because there are no cycles in the graph of roads of known direction within $S$, this can continue until there are at most 2 towns left in $S$.

If it ends with $t$ towns left, $n-k+1-t$ questions were asked in this phase, so a total of $2 n-t$ questions have been asked.

Phase 5. During this phase, Alice asks about all the roads from the remaining towns in $S$ that she has not previously asked about. She has definitely already asked about any road between those towns (if $t=2$ ). She must also have asked in one of the first two phases about\\
at least one other road involving one of those towns (as those phases resulted in a tree with $n>2$ vertices). So she asks at most $t(n-t)-1$ questions in this phase.

At the end of this phase, Alice knows whether any town has at most one outgoing road. If $t=1$, at most $3 n-3 \leqslant 4 n-7$ questions were needed in total, while if $t=2$, at most $4 n-7$ questions were needed in total.

Comment 1. The version of this problem originally submitted asked only for an upper bound of $5 n$, which is much simpler to prove. The Problem Selection Committee preferred a version with an asymptotically optimal constant. In the following comment, we will show that the constant is optimal.

Comment 2. We will show that Alice cannot always find out by asking at most $4 n-3\left(\log _{2} n\right)-$ 15 questions, if $n \geqslant 8$.

To show this, we suppose the King of Hearts is choosing the directions as he goes along, only picking the direction of a road when Alice asks about it for the first time. We provide a strategy for the King of Hearts that ensures that, after the given number of questions, the map is still consistent both with the existence of a town with at most one outgoing road, and with the nonexistence of such a town. His strategy has the following phases. When describing how the King of Hearts' answer to a question is determined below, we always assume he is being asked about a road for the first time (otherwise, he just repeats his previous answer for that road). This strategy is described throughout in graph-theoretic terms (vertices and edges rather than towns and roads).

Phase 1. In this phase, we consider the undirected graph formed by edges whose directions are known. The phase terminates when there are exactly 8 connected components whose undirected graphs are trees. The following invariant is maintained: in a component with $k$ vertices whose undirected graph is a tree, every vertex has at most $\left[\log _{2} k\right\rfloor$ edges into it.

\begin{itemize}
  \item If the King of Hearts is asked about an edge between two vertices in the same component, or about an edge between two components at least one of which is not a tree, he chooses any direction for that edge arbitrarily.
  \item If he is asked about an edge between a vertex in component $A$ that has $a$ vertices and is a tree and a vertex in component $B$ that has $b$ vertices and is a tree, suppose without loss of generality that $a \geqslant b$. He then chooses the edge to go from $A$ to $B$. In this case, the new number of edges into any vertex is at most $\max \left\{\left\lfloor\log _{2} a\right\rfloor,\left\lfloor\log _{2} b\right\rfloor+1\right\} \leqslant\left\lfloor\log _{2}(a+b)\right\rfloor$.
\end{itemize}

In all cases, the invariant is preserved, and the number of tree components either remains unchanged or goes down by 1. Assuming Alice does not repeat questions, the process must eventually terminate with 8 tree components, and at least $n-8$ questions having been asked.

Note that each tree component contains at least one vertex with no outgoing edges. Colour one such vertex in each tree component red.

Phase 2. Let $V_{1}, V_{2}$ and $V_{3}$ be the three of the red vertices whose components are smallest (so their components together have at most $\left\lfloor\frac{3}{8} n\right\rfloor$ vertices, with each component having at most $\left\lfloor\frac{3}{8} n-2\right\rfloor$ vertices). Let sets $C_{1}, C_{2}, \ldots$ be the connected components after removing the $V_{j}$. By construction, there are no edges with known direction between $C_{i}$ and $C_{j}$ for $i \neq j$, and there are at least five such components.

If at any point during this phase, the King of Hearts is asked about an edge within one of the $C_{i}$, he chooses an arbitrary direction. If he is asked about an edge between $C_{i}$ and $C_{j}$ for $i \neq j$, he answers so that all edges go from $C_{i}$ to $C_{i+1}$ and $C_{i+2}$, with indices taken modulo the number of components, and chooses arbitrarily for other pairs. This ensures that all vertices other than the $V_{j}$ will have more than one outgoing edge.

For edges involving one of the $V_{j}$ he answers as follows, so as to remain consistent for as long as possible with both possibilities for whether one of those vertices has at most one outgoing edge. Note that as they were red vertices, they have no outgoing edges at the start of this phase. For edges between two of the $V_{j}$, he answers that the edges go from $V_{1}$ to $V_{2}$, from $V_{2}$ to $V_{3}$ and from $V_{3}$ to $V_{1}$. For edges between $V_{j}$ and some other vertex, he always answers that the edge goes into $V_{j}$, except for the last such edge for which he is asked the question for any given $V_{j}$, for which he answers that the\\
edge goes out of $V_{j}$. Thus, as long as at least one of the $V_{j}$ has not had the question answered for all the vertices that are not among the $V_{j}$, his answers are still compatible both with all vertices having more than one outgoing edge, and with that $V_{j}$ having only one outgoing edge.

At the start of this phase, each of the $V_{j}$ has at most $\left\lfloor\log _{2}\left\lfloor\frac{3}{8} n-2\right\rfloor\right\rfloor<\left(\log _{2} n\right)-1$ incoming edges. Thus, Alice cannot determine whether some vertex has only one outgoing edge within $3(n-$ $\left.3-\left(\left(\log _{2} n\right)-1\right)\right)-1$ questions in this phase; that is, $4 n-3\left(\log _{2} n\right)-15$ questions total.

Comment 3. We can also improve the upper bound slightly, to $4 n-2\left(\log _{2} n\right)+1$. (We do not know where the precise minimum number of questions lies between $4 n-3\left(\log _{2} n\right)+O(1)$ and $4 n-2\left(\log _{2} n\right)+$ $O(1)$.$) Suppose n \geqslant 5$ (otherwise no questions are required at all).

To do this, we replace Phases 1 and 2 of the given solution with a different strategy that also results in a spanning tree where one vertex $V$ is not known to have any outgoing edges, and all other vertices have exactly one outgoing edge known, but where there is more control over the numbers of incoming edges. In Phases 3 and 4 we then take more care about the order in which pairs of towns are chosen, to ensure that each of the remaining towns has already had a question asked about at least $\log _{2} n+O(1)$ edges.

Define trees $T_{m}$ with $2^{m}$ vertices, exactly one of which (the root) has no outgoing edges and the rest of which have exactly one outgoing edge, as follows: $T_{0}$ is a single vertex, while $T_{m}$ is constructed by joining the roots of two copies of $T_{m-1}$ with an edge in either direction. If $n=2^{m}$ we can readily ask $n-1$ questions, resulting in a tree $T_{m}$ for the edges with known direction: first ask about $2^{m-1}$ disjoint pairs of vertices, then about $2^{m-2}$ disjoint pairs of the roots of the resulting $T_{1}$ trees, and so on. For the general case, where $n$ is not a power of 2 , after $k$ stages of this process we have $\left\lfloor n / 2^{k}\right\rfloor$ trees, each of which is like $T_{k}$ but may have some extra vertices (but, however, a unique root). If there are an even number of trees, then ask about pairs of their roots. If there are an odd number (greater than 1) of trees, when a single $T_{k}$ is left over, ask about its root together with that of one of the $T_{k+1}$ trees.

Say $m=\left\lfloor\log _{2} n\right\rfloor$. The result of that process is a single $T_{m}$ tree, possibly with some extra vertices but still a unique root $V$. That root has at least $m$ incoming edges, and we may list vertices $V_{0}$, $\ldots, V_{m-1}$ with edges to $V$, such that, for all $0 \leqslant i<m$, vertex $V_{i}$ itself has at least $i$ incoming edges.

Now divide the vertices other than $V$ into two parts: $A$ has all vertices at an odd distance from $V$ and $B$ has all the vertices at an even distance from $B$. Both $A$ and $B$ are nonempty; $A$ contains the $V_{i}$, while $B$ contains a sequence of vertices with at least $0,1, \ldots, m-2$ incoming edges respectively, similar to the $V_{i}$. There are no edges with known direction within $A$ or within $B$.

In Phase 3, then ask about edges between $V$ and other vertices: first those in $B$, in order of increasing number of incoming edges to the other vertex, then those in $A$, again in order of increasing number of incoming edges, which involves asking at most $n-1-m$ questions in this phase. If two outgoing edges are not found from $V$, at most $2 n-2-m \leqslant 4 n-2\left(\log _{2} n\right)+1$ questions needed to be asked in total, so we suppose that two outgoing edges were found, with $k$ questions asked in this phase, where $2 \leqslant k \leqslant n-1-m$. The state of $S$ is as described in the solution above, with the additional property that, since $S$ must still contain all vertices with edges to $V$, it contains the vertices $V_{i}$ described above.

In Phase 4, consider the vertices left in $B$, in increasing order of number of edges incoming to a vertex. If $s$ is the least number of incoming edges to such a vertex, then, for any $s \leqslant t \leqslant m-2$, there are at least $m-t-2$ vertices with more than $t$ incoming edges. Repeatedly asking about the pair of vertices left in $B$ with the least numbers of incoming edges results in a single vertex left over (if any were in $B$ at all at the start of this phase) with at least $m-2$ incoming edges. Doing the same with $A$ (which must be nonempty) leaves a vertex with at least $m-1$ incoming edges.

Thus if only $A$ is nonempty we ask at most $n-m$ questions in Phase 5 , so in total at most $3 n-m-1$ questions, while if both are nonempty we ask at most $2 n-2 m+1$ questions in Phase 5 , so in total at most $4 n-2 m-1<4 n-2\left(\log _{2} n\right)+1$ questions.",4,"Show that Alice can, in $n-1$ questions, identify a town $T$ with no known outgoing roads, while every other town is known to have exactly one outgoing road.","Alice picks two towns $A, B$ and learns the direction, say $A \to B$. $B$ is the initial candidate town. For each of the remaining $n-2$ towns $X$, she queries the road between the current candidate and $X$. If the road is from the candidate to $X$, then $X$ becomes the new candidate. After $1 + (n-2) = n-1$ questions, one town $T$ remains with no known outgoing roads, and all other $n-1$ towns have one known outgoing road.","After identifying town $T$, describe a procedure to check if $T$ has at most one outgoing road. If not, characterize the state of knowledge and the set of remaining candidate towns, $S$.","Alice queries the unknown roads from $T$. If after at most $n-2$ such queries she does not find a second outgoing road, the answer is ""yes"" and the total questions are at most $(n-1) + (n-2) = 2n-3$. If she finds a second outgoing road after $k$ questions in this phase ($2 \le k \le n-2$), $T$ is eliminated from the set of candidates $S$. Any town $X$ for which she learned $X \to T$ is also eliminated from $S$. Thus, $|S|$ becomes $n-k+1$ after a total of $n-1+k$ questions.","Starting from the state where the initial candidate $T$ has been eliminated, describe an efficient procedure to reduce the set of candidate towns $S$ to a size of at most 2.","Initially, every town in the candidate set $S$ has one known outgoing road. Alice repeatedly queries the road between any two towns $U, V \in S$ not yet queried. The direction determines which of $U$ or $V$ now has a second known outgoing road, and that town is removed from $S$. This process reduces $|S|$ by one town per question, until $|S| \le 2$.",Alice wants to know whether there is at least one town in Wonderland with at most one outgoing road. Prove that she can always find out by asking at most $4n$ questions.,"If the first candidate town $T$ has at most one outgoing road, the process stops with at most $2n-3$ questions. Otherwise, after $n-1+k$ questions, we have a set $S$ of $n-k+1$ candidates. It takes $(n-k+1)-t$ more questions to reduce $|S|$ to $t \in \{1,2\}$, for a total of $2n-t$ questions. Finally, all remaining unknown roads for these $t$ towns are queried. This takes at most $t(n-t)-1$ additional questions. For $t=1$, the total is $\le (2n-1)+(n-2) = 3n-3$. For $t=2$, the total is $\le (2n-2)+(2(n-2)-1) = 4n-7$. Both totals are less than $4n$ for $n \ge 2$."
2019g1,"Let $A B C$ be a triangle. Circle $\Gamma$ passes through $A$, meets segments $A B$ and $A C$ again at points $D$ and $E$ respectively, and intersects segment $B C$ at $F$ and $G$ such that $F$ lies between $B$ and $G$. The tangent to circle $B D F$ at $F$ and the tangent to circle $C E G$ at $G$ meet at point $T$. Suppose that points $A$ and $T$ are distinct. Prove that line $A T$ is parallel to $B C$.","Solution. Notice that $\angle T F B=\angle F D A$ because $F T$ is tangent to circle $B D F$, and moreover $\angle F D A=\angle C G A$ because quadrilateral $A D F G$ is cyclic. Similarly, $\angle T G B=\angle G E C$ because $G T$ is tangent to circle $C E G$, and $\angle G E C=\angle C F A$. Hence,


\begin{equation*}
\angle T F B=\angle C G A \text { and } \angle T G B=\angle C F A . \tag{1}
\end{equation*}


\begin{center}
\includegraphics[max width=\textwidth]{2025_04_29_c4214a078eb1790cb0a3g-058}
\end{center}

Triangles $F G A$ and $G F T$ have a common side $F G$, and by (1) their angles at $F, G$ are the same. So, these triangles are congruent. So, their altitudes starting from $A$ and $T$, respectively, are equal and hence $A T$ is parallel to line $B F G C$.

Comment. Alternatively, we can prove first that $T$ lies on $\Gamma$. For example, this can be done by showing that $\angle A F T=\angle A G T$ using (1). Then the statement follows as $\angle T A F=\angle T G F=\angle G F A$.",2,Let all points and circles be defined as in the original problem. Prove the angle equalities $\angle TFG = \angle FGA$ and $\angle TGF = \angle GFA$.,"By the tangent-chord theorem on circle $BDF$ at point $F$, we have $\angle TFB = \angle FDB$. Since points $A, D, F, G$ lie on circle $\Gamma$ and $A,D,B$ are collinear, the exterior angle $\angle FDB$ of the cyclic quadrilateral $ADFG$ is equal to the interior opposite angle $\angle FGA$. As $F$ lies on $BC$, $\angle TFB = \angle TFG$. Therefore, $\angle TFG = \angle FGA$. Similarly, by the tangent-chord theorem on circle $CEG$ at point $G$, $\angle TGC = \angle GEC$. Since points $A, E, G, F$ lie on circle $\Gamma$ and $A,E,C$ are collinear, the exterior angle $\angle GEC$ of the cyclic quadrilateral $AEGF$ is equal to the interior opposite angle $\angle GFA$. As $G$ lies on $BC$, $\angle TGC = \angle TGF$. Therefore, $\angle TGF = \angle GFA$.","Let $A B C$ be a triangle. Circle $\Gamma$ passes through $A$, meets segments $A B$ and $A C$ again at points $D$ and $E$ respectively, and intersects segment $B C$ at $F$ and $G$ such that $F$ lies between $B$ and $G$. The tangent to circle $B D F$ at $F$ and the tangent to circle $C E G$ at $G$ meet at point $T$. Suppose that points $A$ and $T$ are distinct. Prove that line $A T$ is parallel to $B C$.","Consider triangles $\triangle FGA$ and $\triangle GFT$. They share the common side $FG$. From the first sub-problem, we have the angle equalities $\angle GFT = \angle FGA$ and $\angle TGF = \angle GFA$. By the Angle-Side-Angle (ASA) congruence criterion, $\triangle FGA \cong \triangle GFT$. This congruence implies that the altitudes from corresponding vertices $A$ and $T$ to the line containing their common base $FG$ (which is line $BC$) are equal. Since $A$ and $T$ are distinct points, and they are equidistant from the line $BC$, the line $AT$ must be parallel to $BC$.",,,,
2019g2,"Let $A B C$ be an acute-angled triangle and let $D, E$, and $F$ be the feet of altitudes from $A, B$, and $C$ to sides $B C, C A$, and $A B$, respectively. Denote by $\omega_{B}$ and $\omega_{C}$ the incircles of triangles $B D F$ and $C D E$, and let these circles be tangent to segments $D F$ and $D E$ at $M$ and $N$, respectively. Let line $M N$ meet circles $\omega_{B}$ and $\omega_{C}$ again at $P \neq M$ and $Q \neq N$, respectively. Prove that $M P=N Q$.","Solution. Denote the centres of $\omega_{B}$ and $\omega_{C}$ by $O_{B}$ and $O_{C}$, let their radii be $r_{B}$ and $r_{C}$, and let $B C$ be tangent to the two circles at $T$ and $U$, respectively.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_c4214a078eb1790cb0a3g-059}

From the cyclic quadrilaterals $A F D C$ and $A B D E$ we have

$$
\angle M D O_{B}=\frac{1}{2} \angle F D B=\frac{1}{2} \angle B A C=\frac{1}{2} \angle C D E=\angle O_{C} D N,
$$

so the right-angled triangles $D M O_{B}$ and $D N O_{C}$ are similar. The ratio of similarity between the two triangles is

$$
\frac{D N}{D M}=\frac{O_{C} N}{O_{B} M}=\frac{r_{C}}{r_{B}} .
$$

Let $\varphi=\angle D M N$ and $\psi=\angle M N D$. The lines $F M$ and $E N$ are tangent to $\omega_{B}$ and $\omega_{C}$, respectively, so

$$
\angle M T P=\angle F M P=\angle D M N=\varphi \quad \text { and } \quad \angle Q U N=\angle Q N E=\angle M N D=\psi .
$$

(It is possible that $P$ or $Q$ coincides with $T$ or $U$, or lie inside triangles $D M T$ or $D U N$, respectively. To reduce case-sensitivity, we may use directed angles or simply ignore angles $M T P$ and $Q U N$.)

In the circles $\omega_{B}$ and $\omega_{C}$ the lengths of chords $M P$ and $N Q$ are

$$
M P=2 r_{B} \cdot \sin \angle M T P=2 r_{B} \cdot \sin \varphi \quad \text { and } \quad N Q=2 r_{C} \cdot \sin \angle Q U N=2 r_{C} \cdot \sin \psi .
$$

By applying the sine rule to triangle $D N M$ we get

$$
\frac{D N}{D M}=\frac{\sin \angle D M N}{\sin \angle M N D}=\frac{\sin \varphi}{\sin \psi} .
$$

Finally, putting the above observations together, we get

$$
\frac{M P}{N Q}=\frac{2 r_{B} \sin \varphi}{2 r_{C} \sin \psi}=\frac{r_{B}}{r_{C}} \cdot \frac{\sin \varphi}{\sin \psi}=\frac{D M}{D N} \cdot \frac{\sin \varphi}{\sin \psi}=\frac{\sin \psi}{\sin \varphi} \cdot \frac{\sin \varphi}{\sin \psi}=1,
$$

so $M P=N Q$ as required.",3,"Let $O_B$ and $O_C$ be the centers of circles $\omega_B$ and $\omega_C$, and let their radii be $r_B$ and $r_C$, respectively. Prove that the right-angled triangles $DMO_B$ and $DNO_C$ are similar, and consequently show that $\frac{DN}{DM} = \frac{r_C}{r_B}$.","The quadrilaterals $AFDC$ and $ABDE$ are cyclic, which implies $\angle FDB = \angle BAC$ and $\angle CDE = \angle BAC$. Since $O_B$ and $O_C$ are incenters of $\triangle BDF$ and $\triangle CDE$, the lines $DO_B$ and $DO_C$ bisect angles $\angle FDB$ and $\angle CDE$ respectively. Therefore, $\angle MDO_B = \frac{1}{2}\angle FDB = \frac{1}{2}\angle BAC = \frac{1}{2}\angle CDE = \angle NDO_C$. The triangles $DMO_B$ and $DNO_C$ are right-angled at $M$ and $N$ respectively, as a radius is perpendicular to the tangent at the point of tangency. Since they have an equal acute angle, they are similar ($\triangle DMO_B \sim \triangle DNO_C$). The ratio of corresponding sides gives $\frac{DN}{DM} = \frac{O_C N}{O_B M} = \frac{r_C}{r_B}$.","Let $\varphi = \angle DMN$ and $\psi = \angle MND$. Express the lengths of the chords $MP$ and $NQ$ in terms of the radii $r_B, r_C$ and the angles $\varphi, \psi$.","In circle $\omega_B$, by the Alternate Segment Theorem, the angle subtended by the chord $MP$ at any point on the circumference is equal to the angle between the tangent $DF$ and the chord $MP$, which is $\angle DMN = \varphi$. The length of a chord in a circle is twice the radius times the sine of the angle it subtends at the circumference. Thus, $MP = 2r_B \sin \varphi$. Similarly, in circle $\omega_C$, the angle subtended by chord $NQ$ at the circumference is equal to the angle between the tangent $DE$ and the chord $NQ$, which is $\angle MND = \psi$. Therefore, $NQ = 2r_C \sin \psi$.",Prove that $MP=NQ$.,"From Sub-problem 2, we have $MP = 2r_B \sin \varphi$ and $NQ = 2r_C \sin \psi$. Taking their ratio gives $\frac{MP}{NQ} = \frac{r_B}{r_C} \frac{\sin \varphi}{\sin \psi}$. From Sub-problem 1, we established that $\frac{r_C}{r_B} = \frac{DN}{DM}$, which implies $\frac{r_B}{r_C} = \frac{DM}{DN}$. Applying the Law of Sines to triangle $DMN$, we have $\frac{DN}{DM} = \frac{\sin \varphi}{\sin \psi}$. Combining these relations, we get $\frac{MP}{NQ} = \frac{DM}{DN} \frac{\sin \varphi}{\sin \psi} = \frac{\sin \psi}{\sin \varphi} \frac{\sin \varphi}{\sin \psi} = 1$. Thus, $MP=NQ$.",,
2019g3,"In triangle $A B C$, let $A_{1}$ and $B_{1}$ be two points on sides $B C$ and $A C$, and let $P$ and $Q$ be two points on segments $A A_{1}$ and $B B_{1}$, respectively, so that line $P Q$ is parallel to $A B$. On ray $P B_{1}$, beyond $B_{1}$, let $P_{1}$ be a point so that $\angle P P_{1} C=\angle B A C$. Similarly, on ray $Q A_{1}$, beyond $A_{1}$, let $Q_{1}$ be a point so that $\angle C Q_{1} Q=\angle C B A$. Show that points $P, Q, P_{1}$, and $Q_{1}$ are concyclic.","Throughout the solution we use oriented angles.\\
Let rays $A A_{1}$ and $B B_{1}$ intersect the circumcircle of $\triangle A C B$ at $A_{2}$ and $B_{2}$, respectively. By

$$
\angle Q P A_{2}=\angle B A A_{2}=\angle B B_{2} A_{2}=\angle Q B_{2} A_{2},
$$

points $P, Q, A_{2}, B_{2}$ are concyclic; denote the circle passing through these points by $\omega$. We shall prove that $P_{1}$ and $Q_{1}$ also lie on $\omega$.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_c4214a078eb1790cb0a3g-060}

By

$$
\angle C A_{2} A_{1}=\angle C A_{2} A=\angle C B A=\angle C Q_{1} Q=\angle C Q_{1} A_{1},
$$

points $C, Q_{1}, A_{2}, A_{1}$ are also concyclic. From that we get

$$
\angle Q Q_{1} A_{2}=\angle A_{1} Q_{1} A_{2}=\angle A_{1} C A_{2}=\angle B C A_{2}=\angle B A A_{2}=\angle Q P A_{2},
$$

so $Q_{1}$ lies on $\omega$.\\
It follows similarly that $P_{1}$ lies on $\omega$.\\",2,"Let rays $A A_{1}$ and $B B_{1}$ intersect the circumcircle of $\triangle A B C$ at $A_{2}$ and $B_{2}$, respectively. Show that points $P, Q, A_{2}, B_{2}$ are concyclic.","Using oriented angles, the condition $PQ \parallel AB$ implies $\angle Q P A_{2}=\angle B A A_{2}$. Since $A, B, A_2, B_2$ lie on the circumcircle of $\triangle ABC$, we have $\angle B A A_{2}=\angle B B_{2} A_{2}$. Combining these, we get $\angle Q P A_{2}=\angle B B_{2} A_{2} = \angle Q B_{2} A_{2}$. This equality of angles implies that the points $P, Q, A_{2}, B_{2}$ are concyclic.","Show that points $P, Q, P_{1}$, and $Q_{1}$ are concyclic.","Let $\omega$ be the circle passing through $P, Q, A_2, B_2$. We are given $\angle C Q_{1} Q = \angle C B A$. On the circumcircle of $\triangle ABC$, $\angle C B A = \angle C A_2 A$. Therefore, $\angle C Q_{1} A_{1} = \angle C A_{2} A_{1}$, which implies $C, Q_{1}, A_{2}, A_{1}$ are concyclic. From this concyclicity, $\angle Q Q_{1} A_{2} = \angle A_{1} Q_{1} A_{2} = \angle A_{1} C A_{2} = \angle B C A_{2} = \angle B A A_{2}$. Since $PQ \parallel AB$, $\angle B A A_{2} = \angle Q P A_{2}$. Thus, $\angle Q Q_{1} A_{2} = \angle Q P A_{2}$, which proves that $Q_1$ lies on $\omega$. A symmetric argument shows that $P_1$ also lies on $\omega$. Since $P, Q, P_1, Q_1$ all lie on $\omega$, they are concyclic.",,,,
2019g4,"Let $P$ be a point inside triangle $A B C$. Let $A P$ meet $B C$ at $A_{1}$, let $B P$ meet $C A$ at $B_{1}$, and let $C P$ meet $A B$ at $C_{1}$. Let $A_{2}$ be the point such that $A_{1}$ is the midpoint of $P A_{2}$, let $B_{2}$ be the point such that $B_{1}$ is the midpoint of $P B_{2}$, and let $C_{2}$ be the point such that $C_{1}$ is the midpoint of $P C_{2}$. Prove that points $A_{2}, B_{2}$, and $C_{2}$ cannot all lie strictly inside the circumcircle of triangle $A B C$.","Since

$$
\angle A P B+\angle B P C+\angle C P A=2 \pi=(\pi-\angle A C B)+(\pi-\angle B A C)+(\pi-\angle C B A),
$$

at least one of the following inequalities holds:

$$
\angle A P B \geqslant \pi-\angle A C B, \quad \angle B P C \geqslant \pi-\angle B A C, \quad \angle C P A \geqslant \pi-\angle C B A .
$$

Without loss of generality, we assume that $\angle B P C \geqslant \pi-\angle B A C$. We have $\angle B P C>\angle B A C$ because $P$ is inside $\triangle A B C$. So $\angle B P C \geqslant \max (\angle B A C, \pi-\angle B A C)$ and hence


\begin{equation*}
\sin \angle B P C \leqslant \sin \angle B A C \tag{*}
\end{equation*}


Let the rays $A P, B P$, and $C P$ cross the circumcircle $\Omega$ again at $A_{3}, B_{3}$, and $C_{3}$, respectively. We will prove that at least one of the ratios $\frac{P B_{1}}{B_{1} B_{3}}$ and $\frac{P C_{1}}{C_{1} C_{3}}$ is at least 1, which yields that one of the points $B_{2}$ and $C_{2}$ does not lie strictly inside $\Omega$.

Because $A, B, C, B_{3}$ lie on a circle, the triangles $C B_{1} B_{3}$ and $B B_{1} A$ are similar, so

$$
\frac{C B_{1}}{B_{1} B_{3}}=\frac{B B_{1}}{B_{1} A} .
$$

Applying the sine rule we obtain

$$
\frac{P B_{1}}{B_{1} B_{3}}=\frac{P B_{1}}{C B_{1}} \cdot \frac{C B_{1}}{B_{1} B_{3}}=\frac{P B_{1}}{C B_{1}} \cdot \frac{B B_{1}}{B_{1} A}=\frac{\sin \angle A C P}{\sin \angle B P C} \cdot \frac{\sin \angle B A C}{\sin \angle P B A} .
$$

Similarly,

$$
\frac{P C_{1}}{C_{1} C_{3}}=\frac{\sin \angle P B A}{\sin \angle B P C} \cdot \frac{\sin \angle B A C}{\sin \angle A C P}
$$

Multiplying these two equations we get

$$
\frac{P B_{1}}{B_{1} B_{3}} \cdot \frac{P C_{1}}{C_{1} C_{3}}=\frac{\sin ^{2} \angle B A C}{\sin ^{2} \angle B P C} \geqslant 1
$$

using (*), which yields the desired conclusion.",3,"Let $P$ be a point inside triangle $A B C$. Prove that at least one of $\angle B P C \ge \pi - \angle B A C$, $\angle C P A \ge \pi - \angle C B A$, $\angle A P B \ge \pi - \angle A C B$ must hold, and therefore at least one of $\sin \angle BPC \le \sin \angle BAC$, $\sin \angle CPA \le \sin \angle CBA$, $\sin \angle APB \le \sin \angle ACB$ must hold.","The sum of the angles around point $P$ is $\angle APB + \angle BPC + \angle CPA = 2\pi$. The sum of the angles in triangle $ABC$ is $\angle BAC + \angle CBA + \angle ACB = \pi$, which implies $(\pi - \angle BAC) + (\pi - \angle CBA) + (\pi - \angle ACB) = 2\pi$. If all three inequalities were false, for example $\angle BPC < \pi - \angle BAC$, summing them would lead to $2\pi < 2\pi$, a contradiction. Thus, at least one inequality must hold. Without loss of generality, assume $\angle BPC \ge \pi - \angle BAC$. Since $P$ is inside $\triangle ABC$, we have $\angle BPC > \angle BAC$. Therefore, $\angle BPC$ is in the interval whose sine is smaller or equal to $\sin(\angle BAC)$, so $\sin\angle BPC \le \sin\angle BAC$.","Let the rays $B P$ and $C P$ intersect the circumcircle $\Omega$ of $\triangle ABC$ at $B_3$ and $C_3$, respectively. Assuming that $\sin \angle B P C \leqslant \sin \angle B A C$, prove that the product of ratios $\frac{P B_{1}}{B_{1} B_{3}} \cdot \frac{P C_{1}}{C_{1} C_{3}} \geqslant 1$.","By considering angles subtended by the same arc $BB_3$ and vertical angles at $B_1$, we find that triangles $C B_{1} B_{3}$ and $B B_{1} A$ are similar. This implies $\frac{C B_{1}}{B_{1} B_{3}}=\frac{B B_{1}}{B_{1} A}$. Using this and the Law of Sines, we derive the ratio $\frac{P B_{1}}{B_{1} B_{3}} = \frac{P B_{1}}{C B_{1}} \cdot \frac{C B_{1}}{B_{1} B_{3}} = \frac{P B_{1}}{C B_{1}} \cdot \frac{B B_{1}}{B_{1} A} = \frac{\sin \angle A C P}{\sin \angle B P C} \cdot \frac{\sin \angle B A C}{\sin \angle P B A}$. By symmetry, swapping $B$ and $C$, we find $\frac{P C_{1}}{C_{1} C_{3}}=\frac{\sin \angle P B A}{\sin \angle B P C} \cdot \frac{\sin \angle B A C}{\sin \angle A C P}$. Multiplying these two expressions, terms cancel to give $\frac{\sin ^{2} \angle B A C}{\sin ^{2} \angle B P C}$. From the hypothesis $\sin \angle B P C \leqslant \sin \angle B A C$, it follows that the product is greater than or equal to 1.","Let $P$ be a point inside triangle $A B C$. Let $A P$ meet $B C$ at $A_{1}$, let $B P$ meet $C A$ at $B_{1}$, and let $C P$ meet $A B$ at $C_{1}$. Let $A_{2}$ be the point such that $A_{1}$ is the midpoint of $P A_{2}$, let $B_{2}$ be the point such that $B_{1}$ is the midpoint of $P B_{2}$, and let $C_{2}$ be the point such that $C_{1}$ is the midpoint of $P C_{2}$. Prove that points $A_{2}, B_{2}$, and $C_{2}$ cannot all lie strictly inside the circumcircle of triangle $A B C$.","Let $\Omega$ be the circumcircle of $\triangle ABC$. A point $X_2$, where $X_1$ is the midpoint of $PX_2$, lies strictly inside $\Omega$ if and only if $PX_2 < PX_3$, where $X_3$ is the other intersection of line $PX_1$ with $\Omega$. This condition is equivalent to $2PX_1 < PX_1 + X_1X_3$, which simplifies to $\frac{PX_1}{X_1X_3} < 1$. If all $A_2, B_2, C_2$ were strictly inside $\Omega$, their corresponding ratios must all be less than 1. From sub-problem 1, we can assume without loss of generality that $\sin \angle BPC \le \sin \angle BAC$. Sub-problem 2 then shows that $\frac{P B_{1}}{B_{1} B_{3}} \cdot \frac{P C_{1}}{C_{1} C_{3}} \ge 1$. This implies it is impossible for both $\frac{PB_1}{B_1B_3} < 1$ and $\frac{PC_1}{C_1C_3} < 1$ to hold simultaneously. Thus, at least one of $B_2$ or $C_2$ cannot lie strictly inside the circumcircle, proving the statement.",,
2019g5,Let $A B C D E$ be a convex pentagon with $C D=D E$ and $\angle E D C \neq 2 \cdot \angle A D B$. Suppose that a point $P$ is located in the interior of the pentagon such that $A P=A E$ and $B P=B C$. Prove that $P$ lies on the diagonal $C E$ if and only if area $(B C D)+\operatorname{area}(A D E)=$ $\operatorname{area}(A B D)+\operatorname{area}(A B P)$.,"Let $P^{\prime}$ be the reflection of $P$ across line $A B$, and let $M$ and $N$ be the midpoints of $P^{\prime} E$ and $P^{\prime} C$ respectively. Convexity ensures that $P^{\prime}$ is distinct from both $E$ and $C$, and hence from both $M$ and $N$. We claim that both the area condition and the collinearity condition in the problem are equivalent to the condition that the (possibly degenerate) right-angled triangles $A P^{\prime} M$ and $B P^{\prime} N$ are directly similar (equivalently, $A P^{\prime} E$ and $B P^{\prime} C$ are directly similar).\\
\includegraphics[max width=\textwidth, center]{2025_04_29_c4214a078eb1790cb0a3g-066}

For the equivalence with the collinearity condition, let $F$ denote the foot of the perpendicular from $P^{\prime}$ to $A B$, so that $F$ is the midpoint of $P P^{\prime}$. We have that $P$ lies on $C E$ if and only if $F$ lies on $M N$, which occurs if and only if we have the equality $\angle A F M=\angle B F N$ of signed angles modulo $\pi$. By concyclicity of $A P^{\prime} F M$ and $B F P^{\prime} N$, this is equivalent to $\angle A P^{\prime} M=\angle B P^{\prime} N$, which occurs if and only if $A P^{\prime} M$ and $B P^{\prime} N$ are directly similar.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_c4214a078eb1790cb0a3g-066(1)}

For the other equivalence with the area condition, we have the equality of signed areas $\operatorname{area}(A B D)+\operatorname{area}(A B P)=\operatorname{area}\left(A P^{\prime} B D\right)=\operatorname{area}\left(A P^{\prime} D\right)+\operatorname{area}\left(B D P^{\prime}\right)$. Using the identity $\operatorname{area}(A D E)-\operatorname{area}\left(A P^{\prime} D\right)=\operatorname{area}(A D E)+\operatorname{area}\left(A D P^{\prime}\right)=2$ area $(A D M)$, and similarly for $B$, we find that the area condition is equivalent to the equality

$$
\operatorname{area}(D A M)=\operatorname{area}(D B N) .
$$

Now note that $A$ and $B$ lie on the perpendicular bisectors of $P^{\prime} E$ and $P^{\prime} C$, respectively. If we write $G$ and $H$ for the feet of the perpendiculars from $D$ to these perpendicular bisectors respectively, then this area condition can be rewritten as

$$
M A \cdot G D=N B \cdot H D .
$$

(In this condition, we interpret all lengths as signed lengths according to suitable conventions: for instance, we orient $P^{\prime} E$ from $P^{\prime}$ to $E$, orient the parallel line $D H$ in the same direction, and orient the perpendicular bisector of $P^{\prime} E$ at an angle $\pi / 2$ clockwise from the oriented segment $P^{\prime} E$ - we adopt the analogous conventions at $B$.)\\
\includegraphics[max width=\textwidth, center]{2025_04_29_c4214a078eb1790cb0a3g-067}

To relate the signed lengths $G D$ and $H D$ to the triangles $A P^{\prime} M$ and $B P^{\prime} N$, we use the following calculation.\\
Claim. Let $\Gamma$ denote the circle centred on $D$ with both $E$ and $C$ on the circumference, and $h$ the power of $P^{\prime}$ with respect to $\Gamma$. Then we have the equality

$$
G D \cdot P^{\prime} M=H D \cdot P^{\prime} N=\frac{1}{4} h \neq 0
$$

Proof. Firstly, we have $h \neq 0$, since otherwise $P^{\prime}$ would lie on $\Gamma$, and hence the internal angle bisectors of $\angle E D P^{\prime}$ and $\angle P^{\prime} D C$ would pass through $A$ and $B$ respectively. This would violate the angle inequality $\angle E D C \neq 2 \cdot \angle A D B$ given in the question.

Next, let $E^{\prime}$ denote the second point of intersection of $P^{\prime} E$ with $\Gamma$, and let $E^{\prime \prime}$ denote the point on $\Gamma$ diametrically opposite $E^{\prime}$, so that $E^{\prime \prime} E$ is perpendicular to $P^{\prime} E$. The point $G$ lies on the perpendicular bisectors of the sides $P^{\prime} E$ and $E E^{\prime \prime}$ of the right-angled triangle $P^{\prime} E E^{\prime \prime}$; it follows that $G$ is the midpoint of $P^{\prime} E^{\prime \prime}$. Since $D$ is the midpoint of $E^{\prime} E^{\prime \prime}$, we have that $G D=\frac{1}{2} P^{\prime} E^{\prime}$. Since $P^{\prime} M=\frac{1}{2} P^{\prime} E$, we have $G D \cdot P^{\prime} M=\frac{1}{4} P^{\prime} E^{\prime} \cdot P^{\prime} E=\frac{1}{4} h$. The other equality $H D \cdot P^{\prime} N$ follows by exactly the same argument.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_c4214a078eb1790cb0a3g-067(1)}

From this claim, we see that the area condition is equivalent to the equality

$$
\left(M A: P^{\prime} M\right)=\left(N B: P^{\prime} N\right)
$$

of ratios of signed lengths, which is equivalent to direct similarity of $A P^{\prime} M$ and $B P^{\prime} N$, as desired.",4,"Let $P'$ be the reflection of $P$ across line $AB$, and let $M$ and $N$ be the midpoints of $P'E$ and $P'C$ respectively. Given that $AP=AE$ and $BP=BC$, prove that point $P$ lies on the line segment $CE$ if and only if the right-angled triangles $\triangle AP'M$ and $\triangle BP'N$ are directly similar.","Let $F$ be the midpoint of $PP'$. $P$ lies on $CE$ if and only if $F$ lies on the segment $MN$. This is equivalent to the equality of signed angles $\angle AFM = \angle BFN$. Since $A$ is on the perpendicular bisector of $P'E$, $\triangle AP'M$ is a right triangle, and $A, P', F, M$ are concyclic on the circle with diameter $AP'$. Similarly, $B, F, P', N$ are concyclic. Thus, $\angle AFM = \angle AP'M$ and $\angle BFN = \angle BP'N$. The collinearity condition is therefore equivalent to $\angle AP'M = \angle BP'N$, which for the right-angled triangles $\triangle AP'M$ and $\triangle BP'N$ implies direct similarity.","Using the construction from the previous sub-problem, show that the condition $\operatorname{area}(B C D)+\operatorname{area}(A D E)=\operatorname{area}(A B D)+\operatorname{area}(A B P)$ is equivalent to $\operatorname{area}(D A M)=\operatorname{area}(D B N)$.","Using signed areas, the area condition is $\operatorname{area}(ADE) + \operatorname{area}(BCD) = \operatorname{area}(ABD) + \operatorname{area}(ABP)$. Since $\operatorname{area}(ABP) = \operatorname{area}(AP'B)$, the right side is $\operatorname{area}(ABD) + \operatorname{area}(AP'B) = \operatorname{area}(AP'BD) = \operatorname{area}(AP'D) + \operatorname{area}(BDP')$. The condition becomes $\operatorname{area}(ADE) - \operatorname{area}(AP'D) = \operatorname{area}(BDP') - \operatorname{area}(BCD)$. This is equivalent to $\operatorname{area}(ADE) + \operatorname{area}(ADP') = \operatorname{area}(BDP') + \operatorname{area}(BDC)$. Since $M$ and $N$ are midpoints of $P'E$ and $P'C$, we have $2\operatorname{area}(ADM) = 2\operatorname{area}(BDN)$, which simplifies to $\operatorname{area}(DAM) = \operatorname{area}(DBN)$.",Show that the condition $\operatorname{area}(D A M)=\operatorname{area}(D B N)$ is equivalent to the direct similarity of the right-angled triangles $\triangle AP'M$ and $\triangle BP'N$.,"Let $G$ and $H$ be the feet of the perpendiculars from $D$ to lines $AM$ and $BN$. The area condition is equivalent to $MA \cdot GD = NB \cdot HD$, using signed lengths. Let $\Gamma$ be the circle centered at $D$ through $E$ and $C$, and let $h$ be the power of $P'$ with respect to $\Gamma$. It can be shown that $GD \cdot P'M = h/4$ and $HD \cdot P'N = h/4$. The condition $\angle EDC \neq 2\angle ADB$ ensures $h \neq 0$. Substituting this into the area equality gives $MA \cdot (h/4P'M) = NB \cdot (h/4P'N)$, which simplifies to the ratio equality $MA/P'M = NB/P'N$. For the right-angled triangles $\triangle AP'M$ and $\triangle BP'N$, this equality of the ratio of legs implies they are directly similar.",Let $A B C D E$ be a convex pentagon with $C D=D E$ and $\angle E D C \neq 2 \cdot \angle A D B$. Suppose that a point $P$ is located in the interior of the pentagon such that $A P=A E$ and $B P=B C$. Prove that $P$ lies on the diagonal $C E$ if and only if area $(B C D)+\operatorname{area}(A D E)=$ $\operatorname{area}(A B D)+\operatorname{area}(A B P)$.,"Let $P'$ be the reflection of $P$ across $AB$, and let $M$ and $N$ be the midpoints of $P'E$ and $P'C$. From Sub-problem 1, P lies on CE if and only if $\triangle AP'M$ and $\triangle BP'N$ are directly similar. From Sub-problems 2 and 3, the condition $\operatorname{area}(BCD)+\operatorname{area}(ADE)=\operatorname{area}(ABD)+\operatorname{area}(ABP)$ is also equivalent to the direct similarity of $\triangle AP'M$ and $\triangle BP'N$. Since both the collinearity condition and the area condition are equivalent to the same third condition, they are equivalent to each other."
2019g6,"Let $I$ be the incentre of acute-angled triangle $A B C$. Let the incircle meet $B C, C A$, and $A B$ at $D, E$, and $F$, respectively. Let line $E F$ intersect the circumcircle of the triangle at $P$ and $Q$, such that $F$ lies between $E$ and $P$. Prove that $\angle D P A+\angle A Q D=\angle Q I P$.","Let $N$ and $M$ be the midpoints of the arcs $\widehat{B C}$ of the circumcircle, containing and opposite vertex $A$, respectively. By $\angle F A E=\angle B A C=\angle B N C$, the right-angled kites $A F I E$ and $N B M C$ are similar. Consider the spiral similarity $\varphi$ (dilation in case of $A B=A C$ ) that moves AFIE to $N B M C$. The directed angle in which $\varphi$ changes directions is $\angle(A F, N B)$, same as $\angle(A P, N P)$ and $\angle(A Q, N Q)$; so lines $A P$ and $A Q$ are mapped to lines $N P$ and $N Q$, respectively. Line $E F$ is mapped to $B C$; we can see that the intersection points $P=E F \cap A P$ and $Q=E F \cap A Q$ are mapped to points $B C \cap N P$ and $B C \cap N Q$, respectively. Denote these points by $P^{\prime}$ and $Q^{\prime}$, respectively.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_c4214a078eb1790cb0a3g-071}

Let $L$ be the midpoint of $B C$. We claim that points $P, Q, D, L$ are concyclic (if $D=L$ then line $B C$ is tangent to circle $P Q D$ ). Let $P Q$ and $B C$ meet at $Z$. By applying Menelaus' theorem to triangle $A B C$ and line $E F Z$, we have

$$
\frac{B D}{D C}=\frac{B F}{F A} \cdot \frac{A E}{E C}=-\frac{B Z}{Z C},
$$

so the pairs $B, C$ and $D, Z$ are harmonic. It is well-known that this implies $Z B \cdot Z C=Z D \cdot Z L$. (The inversion with pole $Z$ that swaps $B$ and $C$ sends $Z$ to infinity and $D$ to the midpoint of $B C$, because the cross-ratio is preserved.) Hence, $Z D \cdot Z L=Z B \cdot Z C=Z P \cdot Z Q$ by the power of $Z$ with respect to the circumcircle; this proves our claim.

By $\angle M P P^{\prime}=\angle M Q Q^{\prime}=\angle M L P^{\prime}=\angle M L Q^{\prime}=90^{\circ}$, the quadrilaterals $M L P P^{\prime}$ and $M L Q Q^{\prime}$ are cyclic. Then the problem statement follows by

$$
\begin{aligned}
\angle D P A+\angle A Q D & =360^{\circ}-\angle P A Q-\angle Q D P=360^{\circ}-\angle P N Q-\angle Q L P \\
& =\angle L P N+\angle N Q L=\angle P^{\prime} M L+\angle L M Q^{\prime}=\angle P^{\prime} M Q^{\prime}=\angle P I Q .
\end{aligned}
$$",3,"Let L be the midpoint of side BC. Prove that the points P, Q, D, and L are concyclic.","Let line EF intersect line BC at Z. By Menelaus's theorem on ∆ABC and transversal ZFE, and using tangent properties AE=AF, BD=BF, CE=CD, we get that (Z,D;B,C) is a harmonic range. This implies ZB ⋅ ZC = ZD ⋅ ZL, where L is the midpoint of BC. By the Power of a Point theorem for Z with respect to the circumcircle, ZP ⋅ ZQ = ZB ⋅ ZC. Thus, ZP ⋅ ZQ = ZD ⋅ ZL, which proves that P, Q, D, L are concyclic.","Let N and M be the midpoints of the arcs BC of the circumcircle containing and opposite to vertex A, respectively. Show there exists a spiral similarity φ mapping the kite AFIE to the kite NBMC, and show that this implies ∠PIQ = ∠P'MQ', where P' = NP ∩ BC and Q' = NQ ∩ BC.","The kite AFIE and the kite NBMC are similar, as ∠FAE = ∠BNC = A and their other corresponding angles are equal. Let φ be the spiral similarity mapping A→N, F→B, I→M, E→C. This similarity maps line EF to line BC. Since φ also maps line AP to line NP, the intersection P = EF ∩ AP is mapped to P' = BC ∩ NP. Similarly, Q maps to Q'. By the properties of similarity, the angle is preserved, so ∠PIQ = ∠P'MQ'.",Prove that ∠DPA + ∠AQD = ∠QIP.,"From the sum of angles in quadrilateral APDQ, ∠DPA + ∠AQD = 360° - ∠PAQ - ∠QDP. From Sub-problem 1, P,Q,D,L are concyclic, so ∠QDP = ∠QLP. From Sub-problem 2, the similarity φ gives ∠PAQ = ∠PNQ. The expression becomes 360° - ∠PNQ - ∠QLP = ∠LPN + ∠NQL. Since M,N are antipodal, ∠MPN=90°. As P' is on line NP, ∠MPP'=90°. Also ML ⊥ BC, so ∠MLP'=90°. Thus MLPP' is cyclic and ∠LPN = ∠LMP'. Similarly, MLQQ' is cyclic, so ∠NQL = ∠Q'ML. The sum becomes ∠LMP' + ∠Q'ML = ∠P'MQ'. From Sub-problem 2, ∠P'MQ' = ∠QIP. Therefore, ∠DPA + ∠AQD = ∠QIP.",,
2019g7,"The incircle $\omega$ of acute-angled scalene triangle $A B C$ has centre $I$ and meets sides $B C$, $C A$, and $A B$ at $D, E$, and $F$, respectively. The line through $D$ perpendicular to $E F$ meets $\omega$ again at $R$. Line $A R$ meets $\omega$ again at $P$. The circumcircles of triangles $P C E$ and $P B F$ meet again at $Q \neq P$. Prove that lines $D I$ and $P Q$ meet on the external bisector of angle $B A C$.\\","Common remarks. Throughout the solution, $\angle(a, b)$ denotes the directed angle between lines $a$ and $b$, measured modulo $\pi$.

Step 1. The external bisector of $\angle B A C$ is the line through $A$ perpendicular to $I A$. Let $D I$ meet this line at $L$ and let $D I$ meet $\omega$ at $K$. Let $N$ be the midpoint of $E F$, which lies on $I A$ and is the pole of line $A L$ with respect to $\omega$. Since $A N \cdot A I=A E^{2}=A R \cdot A P$, the points $R$, $N, I$, and $P$ are concyclic. As $I R=I P$, the line $N I$ is the external bisector of $\angle P N R$, so $P N$ meets $\omega$ again at the point symmetric to $R$ with respect to $A N$ - i.e. at $K$.

Let $D N$ cross $\omega$ again at $S$. Opposite sides of any quadrilateral inscribed in the circle $\omega$ meet on the polar line of the intersection of the diagonals with respect to $\omega$. Since $L$ lies on the polar line $A L$ of $N$ with respect to $\omega$, the line $P S$ must pass through $L$. Thus it suffices to prove that the points $S, Q$, and $P$ are collinear.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_c4214a078eb1790cb0a3g-074}

Step 2. Let $\Gamma$ be the circumcircle of $\triangle B I C$. Notice that

$$
\begin{aligned}
\angle(B Q, Q C)=\angle & (B Q, Q P)+\angle(P Q, Q C)=\angle(B F, F P)+\angle(P E, E C) \\
& =\angle(E F, E P)+\angle(F P, F E)=\angle(F P, E P)=\angle(D F, D E)=\angle(B I, I C),
\end{aligned}
$$

so $Q$ lies on $\Gamma$. Let $Q P$ meet $\Gamma$ again at $T$. It will now suffice to prove that $S, P$, and $T$ are collinear. Notice that $\angle(B I, I T)=\angle(B Q, Q T)=\angle(B F, F P)=\angle(F K, K P)$. Note $F D \perp F K$ and $F D \perp B I$ so $F K \| B I$ and hence $I T$ is parallel to the line $K N P$. Since $D I=I K$, the line $I T$ crosses $D N$ at its midpoint $M$.\\
Step 3. Let $F^{\prime}$ and $E^{\prime}$ be the midpoints of $D E$ and $D F$, respectively. Since $D E^{\prime} \cdot E^{\prime} F=D E^{\prime 2}=$ $B E^{\prime} \cdot E^{\prime} I$, the point $E^{\prime}$ lies on the radical axis of $\omega$ and $\Gamma$; the same holds for $F^{\prime}$. Therefore, this radical axis is $E^{\prime} F^{\prime}$, and it passes through $M$. Thus $I M \cdot M T=D M \cdot M S$, so $S, I, D$, and $T$ are concyclic. This shows $\angle(D S, S T)=\angle(D I, I T)=\angle(D K, K P)=\angle(D S, S P)$, whence the points $S, P$, and $T$ are collinear, as desired.\\",3,"Let $N$ be the midpoint of $EF$, $K$ be the point on the incircle $\omega$ diametrically opposite to $D$, and $S$ be the second point of intersection of line $DN$ and $\omega$. Let $L$ be the intersection of line $DI$ with the external angle bisector of $\\angle BAC$. Show that $L, P, S$ are collinear, thereby reducing the problem to proving that $P, Q, S$ are collinear.","The external bisector of $\\angle BAC$ is the line through $A$ perpendicular to $AI$. Let this line be $l_A$. The midpoint $N$ of $EF$ lies on $AI$. The polar of $N$ with respect to $\\omega$ is $l_A$. It is a known property of this configuration that points $P, N, K$ are collinear. Consider the quadrilateral $DKSP$ inscribed in $\\omega$. Its diagonals $DS$ and $KP$ intersect at $N$. By the properties of a complete quadrilateral, the intersection of opposite sides $(DK, SP)$ must lie on the polar of $N$, which is $l_A$. The point $L$ lies on line $DK$ (since $D, I, K$ are collinear) and on $l_A$ by definition. Therefore, $L$ is the intersection of $DK$ and $SP$. This implies $L, P, S$ are collinear. The original problem asks to prove that $L, P, Q$ are collinear, which is now equivalent to proving that $S, P, Q$ are collinear.",Let $\\Gamma$ be the circumcircle of triangle $BIC$. Prove that the point $Q$ (the second intersection of the circumcircles of $\triangle PCE$ and $\triangle PBF$) lies on $\\Gamma$.,"Using directed angles modulo $\\pi$, we have $\\angle(BQ, QC) = \\angle(BQ, QP) + \\angle(QP, QC)$. Since $P,Q,B,F$ are concyclic, $\\angle(BQ, QP) = \\angle(BF, FP)$. Since $P,Q,C,E$ are concyclic, $\\angle(QP, QC) = \\angle(EP, EC)$. Summing these and using properties of tangents to the incircle ($BF=AB$, $CE=CA$ as lines), $\\angle(BQ, QC) = \\angle(AB, FP) + \\angle(EP, AC) = \\angle(EF, EP) + \\angle(FP, EF) = \\angle(FP, EP)$. As $D,E,F,P$ lie on the incircle $\\omega$, $\\angle(FP, EP) = \\angle(FD, ED)$. It is a known property that $\\angle(FD, ED) = \\angle(BI, IC)$. Therefore, $\\angle(BQ, QC) = \\angle(BI, IC)$, which implies that points $B, Q, I, C$ are concyclic. Thus, $Q$ lies on the circumcircle $\\Gamma$ of $\triangle BIC$.",Prove that lines $DI$ and $PQ$ meet on the external bisector of angle $B A C$.,"From Sub-problem 1, this is equivalent to proving that points $S, P, Q$ are collinear. From Sub-problem 2, $Q$ lies on $\\Gamma$, the circumcircle of $\triangle BIC$. Let $T$ be the second intersection of line $PQ$ with $\\Gamma$; the goal is to show $S, P, T$ are collinear. Let $M$ be the midpoint of segment $DN$. $M$ lies on the radical axis of circles $\\omega$ and $\\Gamma$. Thus, the power of $M$ with respect to both circles is equal: $DM \\cdot MS = IM \\cdot MT$. This implies that points $D, S, I, T$ are concyclic. From this concyclicity, $\\angle(DS, ST) = \\angle(DI, IT)$. It can be shown that line $IT$ is parallel to line $PK$. Thus, $\\angle(DI, IT) = \\angle(DK, KP)$. In circle $\\omega$, angles subtended by the same arc $DP$ are equal: $\\angle(DK, KP) = \\angle(DS, SP)$. Therefore, $\\angle(DS, ST) = \\angle(DS, SP)$, which implies that $S, P, T$ are collinear, completing the proof.",,
2019g8,"Let $\mathcal{L}$ be the set of all lines in the plane and let $f$ be a function that assigns to each line $\ell \in \mathcal{L}$ a point $f(\ell)$ on $\ell$. Suppose that for any point $X$, and for any three lines $\ell_{1}, \ell_{2}, \ell_{3}$ passing through $X$, the points $f\left(\ell_{1}\right), f\left(\ell_{2}\right), f\left(\ell_{3}\right)$ and $X$ lie on a circle.

Prove that there is a unique point $P$ such that $f(\ell)=P$ for any line $\ell$ passing through $P$.","Common remarks. The condition on $f$ is equivalent to the following: There is some function $g$ that assigns to each point $X$ a circle $g(X)$ passing through $X$ such that for any line $\ell$ passing through $X$, the point $f(\ell)$ lies on $g(X)$. (The function $g$ may not be uniquely defined for all points, if some points $X$ have at most one value of $f(\ell)$ other than $X$; for such points, an arbitrary choice is made.)

If there were two points $P$ and $Q$ with the given property, $f(P Q)$ would have to be both $P$ and $Q$, so there is at most one such point, and it will suffice to show that such a point exists.

We provide a complete characterisation of the functions satisfying the given condition.

Write $\angle\left(\ell_{1}, \ell_{2}\right)$ for the directed angle modulo $180^{\circ}$ between the lines $\ell_{1}$ and $\ell_{2}$. Given a point $P$ and an angle $\alpha \in\left(0,180^{\circ}\right)$, for each line $\ell$, let $\ell^{\prime}$ be the line through $P$ satisfying $\angle\left(\ell^{\prime}, \ell\right)=\alpha$, and let $h_{P, \alpha}(\ell)$ be the intersection point of $\ell$ and $\ell^{\prime}$. We will prove that there is some pair $(P, \alpha)$ such that $f$ and $h_{P, \alpha}$ are the same function. Then $P$ is the unique point in the problem statement.

Given an angle $\alpha$ and a point $P$, let a line $\ell$ be called $(P, \alpha)$-good if $f(\ell)=h_{P, \alpha}(\ell)$. Let a point $X \neq P$ be called $(P, \alpha)$-good if the circle $g(X)$ passes through $P$ and some point $Y \neq P, X$ on $g(X)$ satisfies $\angle(P Y, Y X)=\alpha$. It follows from this definition that if $X$ is $(P, \alpha)$ good then every point $Y \neq P, X$ of $g(X)$ satisfies this angle condition, so $h_{P, \alpha}(X Y)=Y$ for every $Y \in g(X)$. Equivalently, $f(\ell) \in\left\{X, h_{P, \alpha}(\ell)\right\}$ for each line $\ell$ passing through $X$. This shows the following lemma.\\
Lemma 1. If $X$ is $(P, \alpha)$-good and $\ell$ is a line passing through $X$ then either $f(\ell)=X$ or $\ell$ is ( $P, \alpha$ )-good.\\
Lemma 2. If $X$ and $Y$ are different $(P, \alpha)$-good points, then line $X Y$ is $(P, \alpha)$-good.\\
Proof. If $X Y$ is not $(P, \alpha)$-good then by the previous Lemma, $f(X Y)=X$ and similarly $f(X Y)=Y$, but clearly this is impossible as $X \neq Y$.

Lemma 3. If $\ell_{1}$ and $\ell_{2}$ are different $(P, \alpha)$-good lines which intersect at $X \neq P$, then either $f\left(\ell_{1}\right)=X$ or $f\left(\ell_{2}\right)=X$ or $X$ is $(P, \alpha)$-good.\\
Proof. If $f\left(\ell_{1}\right), f\left(\ell_{2}\right) \neq X$, then $g(X)$ is the circumcircle of $X, f\left(\ell_{1}\right)$ and $f\left(\ell_{2}\right)$. Since $\ell_{1}$ and $\ell_{2}$ are $(P, \alpha)$-good lines, the angles

$$
\angle\left(P f\left(\ell_{1}\right), f\left(\ell_{1}\right) X\right)=\angle\left(P f\left(\ell_{2}\right), f\left(\ell_{2}\right) X\right)=\alpha,
$$

so $P$ lies on $g(X)$. Hence, $X$ is $(P, \alpha)$-good.\\
Lemma 4. If $\ell_{1}, \ell_{2}$ and $\ell_{3}$ are different $(P, \alpha)$-good lines which intersect at $X \neq P$, then $X$ is ( $P, \alpha$ )-good.

Proof. This follows from the previous Lemma since at most one of the three lines $\ell_{i}$ can satisfy $f\left(\ell_{i}\right)=X$ as the three lines are all $(P, \alpha)$-good.

Lemma 5. If $A B C$ is a triangle such that $A, B, C, f(A B), f(A C)$ and $f(B C)$ are all different points, then there is some point $P$ and some angle $\alpha$ such that $A, B$ and $C$ are $(P, \alpha)$-good points and $A B, B C$ and $C A$ are $(P, \alpha)$-good lines.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_c4214a078eb1790cb0a3g-079}

Proof. Let $D, E, F$ denote the points $f(B C), f(A C), f(A B)$, respectively. Then $g(A)$, $g(B)$ and $g(C)$ are the circumcircles of $A E F, B D F$ and $C D E$, respectively. Let $P \neq F$ be the second intersection of circles $g(A)$ and $g(B)$ (or, if these circles are tangent at $F$, then $P=F$ ). By Miquel's theorem (or an easy angle chase), $g(C)$ also passes through $P$. Then by the cyclic quadrilaterals, the directed angles

$$
\angle(P D, D C)=\angle(P F, F B)=\angle(P E, E A)=\alpha,
$$

for some angle $\alpha$. Hence, lines $A B, B C$ and $C A$ are all $(P, \alpha)$-good, so by Lemma 3, $A, B$ and $C$ are ( $P, \alpha$ )-good. (In the case where $P=D$, the line $P D$ in the equation above denotes the line which is tangent to $g(B)$ at $P=D$. Similar definitions are used for $P E$ and $P F$ in the cases where $P=E$ or $P=F$.)

Consider the set $\Omega$ of all points $(x, y)$ with integer coordinates $1 \leqslant x, y \leqslant 1000$, and consider the set $L_{\Omega}$ of all horizontal, vertical and diagonal lines passing through at least one point in $\Omega$. A simple counting argument shows that there are 5998 lines in $L_{\Omega}$. For each line $\ell$ in $L_{\Omega}$ we colour the point $f(\ell)$ red. Then there are at most 5998 red points. Now we partition the points in $\Omega$ into 10000 ten by ten squares. Since there are at most 5998 red points, at least one of these squares $\Omega_{10}$ contains no red points. Let ( $m, n$ ) be the bottom left point in $\Omega_{10}$. Then the triangle with vertices $(m, n),(m+1, n)$ and $(m, n+1)$ satisfies the condition of Lemma 5 , so these three vertices are all $(P, \alpha)$-good for some point $P$ and angle $\alpha$, as are the lines joining them. From this point on, we will simply call a point or line good if it is $(P, \alpha)$-good for this particular pair $(P, \alpha)$. Now by Lemma 1, the line $x=m+1$ is good, as is the line $y=n+1$. Then Lemma 3 implies that ( $m+1, n+1$ ) is good. By applying these two lemmas repeatedly, we can prove that the line $x+y=m+n+2$ is good, then the points $(m, n+2)$ and $(m+2, n)$ then the lines $x=m+2$ and $y=n+2$, then the points $(m+2, n+1),(m+1, n+2)$ and $(m+2, n+2)$ and so on until we have prove that all points in $\Omega_{10}$ are good.

Now we will use this to prove that every point $S \neq P$ is good. Since $g(S)$ is a circle, it passes through at most two points of $\Omega_{10}$ on any vertical line, so at most 20 points in total. Moreover, any line $\ell$ through $S$ intersects at most 10 points in $\Omega_{10}$. Hence, there are at least eight lines $\ell$ through $S$ which contain a point $Q$ in $\Omega_{10}$ which is not on $g(S)$. Since $Q$ is not on $g(S)$, the point $f(\ell) \neq Q$. Hence, by Lemma 1 , the line $\ell$ is good. Hence, at least eight good lines pass through $S$, so by Lemma 4, the point $S$ is good. Hence, every point $S \neq P$ is good, so by Lemma 2, every line is good. In particular, every line $\ell$ passing through $P$ is good, and therefore satisfies $f(\ell)=P$, as required.",4,"Let the function $h_{P, \alpha}(\ell)$ be the intersection of a line $\ell$ with the line through a fixed point $P$ that makes a directed angle $\alpha$ with $\ell$. Show that for a triangle $ABC$ where the vertices and the points $f(AB), f(BC), f(CA)$ are all distinct, there exists a point $P$ and an angle $\alpha$ such that the three sides of the triangle, $\ell_1=AB, \ell_2=BC, \ell_3=CA$, satisfy $f(\ell_i) = h_{P, \alpha}(\ell_i)$.","Let $D=f(BC), E=f(AC), F=f(AB)$. By the problem's condition, there are circles $g(A)$ through $A,E,F$, $g(B)$ through $B,D,F$, and $g(C)$ through $C,D,E$. Let $P$ be the second intersection of $g(A)$ and $g(B)$. By Miquel's theorem, $g(C)$ also passes through $P$. The cyclic quadrilaterals $AEPF$, $BFDP$, $CDPE$ imply the equality of directed angles $\angle(PE, EA) = \angle(PF, FB) = \angle(PD, DC)$. Let this angle be $\alpha$. This means that for each side $\ell$ of the triangle, $f(\ell)$ is the intersection of $\ell$ with a line through $P$ making angle $\alpha$ with $\ell$, i.e., $f(\ell) = h_{P, \alpha}(\ell)$ for $\ell \in \{AB,BC,CA\}$.","Define a line $\ell$ to be $(P, \alpha)$-good if $f(\ell) = h_{P, \alpha}(\ell)$, and a point $X \neq P$ to be $(P, \alpha)$-good if its associated circle $g(X)$ passes through $P$. Show that if three distinct $(P, \alpha)$-good lines intersect at a point $X \neq P$, then $X$ is $(P, \alpha)$-good.","Let $\ell_1, \ell_2, \ell_3$ be three distinct $(P, \alpha)$-good lines intersecting at $X \neq P$. The points $f(\ell_1), f(\ell_2), f(\ell_3)$ and $X$ lie on a circle $g(X)$. Since the lines are good, $f(\ell_i) = h_{P, \alpha}(\ell_i)$, which implies $\angle(P f(\ell_i), f(\ell_i) X) = \alpha$ for each $i$ such that $f(\ell_i) \neq X$. At most one $f(\ell_i)$ can be $X$. For $f(\ell_1), f(\ell_2)$ distinct from $X$, the condition $\angle(P f(\ell_1), f(\ell_1) X) = \angle(P f(\ell_2), f(\ell_2) X) = \alpha$ implies that $P$ must lie on the circle passing through $X, f(\ell_1), f(\ell_2)$, which is $g(X)$. By definition, $X$ is a $(P, \alpha)$-good point.","Prove that there exists a pair $(P, \alpha)$ such that every line in the plane is $(P, \alpha)$-good.","First, a non-degenerate triangle as described in Sub-problem 1 must exist. By considering a large integer grid, we can find a small triangle in a region free of the values of $f$ for the grid lines, guaranteeing the condition. This establishes the existence of a pair $(P, \alpha)$ and a seed of good lines. Using the result of Sub-problem 2, we can show that all points in a local region are good. For any point $S \neq P$, we can find at least three lines through $S$ that intersect this good region. These lines can be shown to be good, which in turn makes $S$ a good point. Since every point $S \neq P$ is good, the line connecting any two such points must be good. Hence, every line is $(P, \alpha)$-good.",Prove that there is a unique point $P$ such that $f(\ell)=P$ for any line $\ell$ passing through $P$.,"From Sub-problem 3, there exists a pair $(P, \alpha)$ for which every line $\ell$ is $(P, \alpha)$-good, meaning $f(\ell) = h_{P, \alpha}(\ell)$. Consider a line $\ell$ that passes through $P$. The function $h_{P, \alpha}(\ell)$ gives the intersection of $\ell$ with a line $\ell'$ that passes through $P$ at an angle $\alpha$ to $\ell$. As both lines $\ell$ and $\ell'$ pass through $P$, their intersection is $P$. Thus, $f(\ell)=P$ for any line $\ell$ passing through $P$. To prove uniqueness, suppose two points $P_1$ and $P_2$ satisfy the condition. For the line $\ell = P_1P_2$, we must have $f(\ell)=P_1$ because it passes through $P_1$, and $f(\ell)=P_2$ because it passes through $P_2$. This forces $P_1=P_2$, so the point is unique."
2019n5,"Let $a$ be a positive integer. We say that a positive integer $b$ is $a$-good if $\binom{a n}{b}-1$ is divisible by $a n+1$ for all positive integers $n$ with $a n \geqslant b$. Suppose $b$ is a positive integer such that $b$ is $a$-good, but $b+2$ is not $a$-good. Prove that $b+1$ is prime.","For $p$ a prime and $n$ a nonzero integer, we write $v_{p}(n)$ for the $p$-adic valuation of $n$ : the largest integer $t$ such that $p^{t} \mid n$.

We first show that $b$ is $a$-good if and only if $b$ is even, and $p \mid a$ for all primes $p \leqslant b$.\\
To start with, the condition that $a n+1 \left\lvert\,\binom{ a n}{b}-1\right.$ can be rewritten as saying that


\begin{equation*}
\frac{a n(a n-1) \cdots(a n-b+1)}{b!} \equiv 1 \quad(\bmod a n+1) . \tag{1}
\end{equation*}


Suppose, on the one hand, there is a prime $p \leqslant b$ with $p \nmid a$. Take $t=v_{p}(b!)$. Then there exist positive integers $c$ such that $a c \equiv 1\left(\bmod p^{t+1}\right)$. If we take $c$ big enough, and then take $n=(p-1) c$, then $a n=a(p-1) c \equiv p-1\left(\bmod p^{t+1}\right)$ and $a n \geqslant b$. Since $p \leqslant b$, one of the terms of the numerator an $(a n-1) \cdots(a n-b+1)$ is $a n-p+1$, which is divisible by $p^{t+1}$. Hence the $p$-adic valuation of the numerator is at least $t+1$, but that of the denominator is exactly $t$. This means that $p \left\lvert\,\binom{ a n}{b}\right.$, so $p \nmid\binom{a n}{b}-1$. As $p \mid a n+1$, we get that $a n+1 \nmid\binom{a n}{b}$, so $b$ is not $a$-good.

On the other hand, if for all primes $p \leqslant b$ we have $p \mid a$, then every factor of $b$ ! is coprime to an +1 , and hence invertible modulo $a n+1$ : hence $b$ ! is also invertible modulo $a n+1$. Then equation (1) reduces to:

$$
a n(a n-1) \cdots(a n-b+1) \equiv b!\quad(\bmod a n+1) .
$$

However, we can rewrite the left-hand side as follows:

$$
a n(a n-1) \cdots(a n-b+1) \equiv(-1)(-2) \cdots(-b) \equiv(-1)^{b} b!\quad(\bmod a n+1)
$$

Provided that $a n>1$, if $b$ is even we deduce $(-1)^{b} b!\equiv b!$ as needed. On the other hand, if $b$ is odd, and we take $a n+1>2(b!)$, then we will not have $(-1)^{b} b!\equiv b$ !, so $b$ is not $a$-good. This completes the claim.

To conclude from here, suppose that $b$ is $a$-good, but $b+2$ is not. Then $b$ is even, and $p \mid a$ for all primes $p \leqslant b$, but there is a prime $q \leqslant b+2$ for which $q \nmid a$ : so $q=b+1$ or $q=b+2$. We cannot have $q=b+2$, as that is even too, so we have $q=b+1$ : in other words, $b+1$ is prime.",3,"Prove that a positive integer $b$ is $a$-good if and only if $b$ is even and for every prime $p \le b$, we have $p \mid a$.","An integer $b$ is $a$-good if $\binom{an}{b} \equiv 1 \pmod{an+1}$.\nNecessity: If a prime $p \le b$ does not divide $a$, we can choose $n$ such that $p \mid an+1$ and $p \mid \binom{an}{b}$, a contradiction. So all primes $p \le b$ must divide $a$. This makes $b!$ coprime to $an+1$. The condition becomes $an(an-1)\cdots(an-b+1) \equiv b! \pmod{an+1}$. Since $an \equiv -1 \pmod{an+1}$, the LHS is $(-1)^b b!$. For $(-1)^b b! \equiv b! \pmod{an+1}$ to hold for arbitrarily large $n$, we must have $(-1)^b=1$, which means $b$ is even.\nSufficiency: If $b$ is even and all primes $p \le b$ divide $a$, then $b!$ is coprime to $an+1$. The condition $\binom{an}{b} \equiv 1 \pmod{an+1}$ is equivalent to $an(an-1)\cdots(an-b+1) \equiv b! \pmod{an+1}$, which is $(-1)^b b! \equiv b! \pmod{an+1}$. As $b$ is even, this holds.","Suppose $b$ is $a$-good, but $b+2$ is not. Using the characterization from the previous step, show that $b$ is even and there exists a prime $q$ such that $b < q \le b+2$ and $q \nmid a$.","Since $b$ is $a$-good, by the characterization from Sub-problem 1, $b$ is even and for every prime $p \le b$, we have $p \mid a$. Since $b+2$ is not $a$-good, the characterization must fail for $k=b+2$. The first condition for being $a$-good is that the number is even. As $b$ is even, $b+2$ is also even, so this condition holds. Thus, the other condition must fail: there must be a prime $q \le b+2$ such that $q \nmid a$. Combining our findings, we have a prime $q$ such that $q \le b+2$ and $q \nmid a$. But we also know that for all primes $p \le b$, $p \mid a$. This implies that $q$ cannot be less than or equal to $b$. Therefore, $q$ must satisfy $b < q \le b+2$.","Let $a$ be a positive integer. We say that a positive integer $b$ is $a$-good if $\binom{a n}{b}-1$ is divisible by $a n+1$ for all positive integers $n$ with $a n \geqslant b$. Suppose $b$ is a positive integer such that $b$ is $a$-good, but $b+2$ is not $a$-good. Prove that $b+1$ is prime.","From Sub-problem 2, we know that $b$ is even and there exists a prime $q$ such that $b < q \le b+2$. The only integers in the interval $(b, b+2]$ are $b+1$ and $b+2$. So, the prime $q$ must be either $b+1$ or $b+2$. Since $b$ is a positive even integer, $b \ge 2$. Thus $b+2$ is an even integer greater than or equal to 4, so it cannot be prime. Therefore, the only possibility is that the prime $q$ is $b+1$. We conclude that $b+1$ is a prime number.",,
2019n6,"Let $H=\left\{\lfloor i \sqrt{2}\rfloor: i \in \mathbb{Z}_{>0}\right\}=\{1,2,4,5,7, \ldots\}$, and let $n$ be a positive integer. Prove that there exists a constant $C$ such that, if $A \subset\{1,2, \ldots, n\}$ satisfies $|A| \geqslant C \sqrt{n}$, then there exist $a, b \in A$ such that $a-b \in H$. (Here $\mathbb{Z}_{>0}$ is the set of positive integers, and $\lfloor z\rfloor$ denotes the greatest integer less than or equal to $z$.)","Common remarks. In all solutions, we will assume that $A$ is a set such that $\{a-b: a, b \in A\}$ is disjoint from $H$, and prove that $|A|<C \sqrt{n}$.

First, observe that if $n$ is a positive integer, then $n \in H$ exactly when


\begin{equation*}
\left\{\frac{n}{\sqrt{2}}\right\}>1-\frac{1}{\sqrt{2}} . \tag{1}
\end{equation*}


To see why, observe that $n \in H$ if and only if $0<i \sqrt{2}-n<1$ for some $i \in \mathbb{Z}_{>0}$. In other words, $0<i-n / \sqrt{2}<1 / \sqrt{2}$, which is equivalent to (1).

Now, write $A=\left\{a_{1}<a_{2}<\cdots<a_{k}\right\}$, where $k=|A|$. Observe that the set of differences is not altered by shifting $A$, so we may assume that $A \subseteq\{0,1, \ldots, n-1\}$ with $a_{1}=0$.

From (1), we learn that $\left\{a_{i} / \sqrt{2}\right\}<1-1 / \sqrt{2}$ for each $i>1$ since $a_{i}-a_{1} \notin H$. Furthermore, we must have $\left\{a_{i} / \sqrt{2}\right\}<\left\{a_{j} / \sqrt{2}\right\}$ whenever $i<j$; otherwise, we would have

$$
-\left(1-\frac{1}{\sqrt{2}}\right)<\left\{\frac{a_{j}}{\sqrt{2}}\right\}-\left\{\frac{a_{i}}{\sqrt{2}}\right\}<0 .
$$

Since $\left\{\left(a_{j}-a_{i}\right) / \sqrt{2}\right\}=\left\{a_{j} / \sqrt{2}\right\}-\left\{a_{i} / \sqrt{2}\right\}+1$, this implies that $\left\{\left(a_{j}-a_{i}\right) / \sqrt{2}\right\}>1 / \sqrt{2}>$ $1-1 / \sqrt{2}$, contradicting (1).

Now, we have a sequence $0=a_{1}<a_{2}<\cdots<a_{k}<n$, with

$$
0=\left\{\frac{a_{1}}{\sqrt{2}}\right\}<\left\{\frac{a_{2}}{\sqrt{2}}\right\}<\cdots<\left\{\frac{a_{k}}{\sqrt{2}}\right\}<1-\frac{1}{\sqrt{2}} .
$$

We use the following fact: for any $d \in \mathbb{Z}$, we have


\begin{equation*}
\left\{\frac{d}{\sqrt{2}}\right\}>\frac{1}{2 d \sqrt{2}} . \tag{2}
\end{equation*}


To see why this is the case, let $h=\lfloor d / \sqrt{2}\rfloor$, so $\{d / \sqrt{2}\}=d / \sqrt{2}-h$. Then

$$
\left\{\frac{d}{\sqrt{2}}\right\}\left(\frac{d}{\sqrt{2}}+h\right)=\frac{d^{2}-2 h^{2}}{2} \geqslant \frac{1}{2},
$$

since the numerator is a positive integer. Because $d / \sqrt{2}+h<2 d / \sqrt{2}$, inequality (2) follows.\\
Let $d_{i}=a_{i+1}-a_{i}$, for $1 \leqslant i<k$. Then $\left\{a_{i+1} / \sqrt{2}\right\}-\left\{a_{i} / \sqrt{2}\right\}=\left\{d_{i} / \sqrt{2}\right\}$, and we have


\begin{equation*}
1-\frac{1}{\sqrt{2}}>\sum_{i}\left\{\frac{d_{i}}{\sqrt{2}}\right\}>\frac{1}{2 \sqrt{2}} \sum_{i} \frac{1}{d_{i}} \geqslant \frac{(k-1)^{2}}{2 \sqrt{2}} \frac{1}{\sum_{i} d_{i}}>\frac{(k-1)^{2}}{2 \sqrt{2}} \cdot \frac{1}{n} . \tag{3}
\end{equation*}


Here, the first inequality holds because $\left\{a_{k} / \sqrt{2}\right\}<1-1 / \sqrt{2}$, the second follows from (2), the third follows from an easy application of the AM-HM inequality (or Cauchy-Schwarz), and the fourth follows from the fact that $\sum_{i} d_{i}=a_{k}<n$.

Rearranging this, we obtain

$$
\sqrt{2 \sqrt{2}-2} \cdot \sqrt{n}>k-1
$$

which provides the required bound on $k$.",3,Let $H=\\left\\{\\lfloor i \\sqrt{2}\rfloor: i \\in \\mathbb{Z}_{>0}\right\\}$. Prove that a positive integer $m$ belongs to $H$ if and only if its fractional part satisfies $\{m/\\sqrt{2}\\} > 1 - 1/\\sqrt{2}$.,"A positive integer $m \\in H$ if and only if there exists a positive integer $i$ such that $m = \\lfloor i\\sqrt{2} \rfloor$. This is equivalent to the inequality $m \\le i\\sqrt{2} < m+1$, which can be rewritten as $m/\\sqrt{2} \\le i < m/\\sqrt{2} + 1/\\sqrt{2}$. The existence of such an integer $i$ is equivalent to the interval $(m/\\sqrt{2}, m/\\sqrt{2} + 1/\\sqrt{2})$ containing an integer. Let $m/\\sqrt{2} = I+f$, where $I=\\lfloor m/\\sqrt{2} \rfloor$ and $f=\\{m/\\sqrt{2}\\}$ is the fractional part. The interval is $(I+f, I+f+1/\\sqrt{2})$. It contains an integer (specifically $I+1$) if and only if $I+f < I+1 < I+f+1/\\sqrt{2}$. The left inequality $f<1$ is always true. The right inequality simplifies to $1 < f+1/\\sqrt{2}$, which is equivalent to $f > 1-1/\\sqrt{2}$. Thus, $m \\in H$ if and only if $\\{m/\\sqrt{2}\\} > 1-1/\\sqrt{2}$.","Let $A = \\{a_1 < a_2 < \\dots < a_k\\}$ be a set of integers. Suppose that for any $a, b \\in A$ with $a>b$, the difference $a-b$ is not in $H$. Prove that the fractional parts $\\{a_j/\\sqrt{2}\\}$ form a strictly increasing sequence, i.e., $\\{a_1/\\sqrt{2}\\} < \\{a_2/\\sqrt{2}\\} < \\dots < \\{a_k/\\sqrt{2}\\} < 1 - 1/\\sqrt{2}$ (after a suitable shift of $A$).","Let $A=\\{a_{1}<a_{2}<\\cdots<a_{k}\\}$. We can shift $A$ by $-a_1$ to assume $a_1=0$ without changing the set of differences. The condition $a_j - a_i \notin H$ for $j>i$ implies, by Sub-problem 1, that $\\{(a_j-a_i)/\\sqrt{2}\\} \\le 1-1/\\sqrt{2}$. Let $f_j = \\{a_j/\\sqrt{2}\\}$. If we had $f_j < f_i$ for some $j>i$, then $\\{(a_j-a_i)/\\sqrt{2}\\} = \\{a_j/\\sqrt{2} - a_i/\\sqrt{2}\\} = \\{f_j-f_i\\} = f_j-f_i+1$. Since $a_i = a_i-a_1 \notin H$ (for $i>1$), we have $f_i \\le 1-1/\\sqrt{2}$. This would lead to $\\{(a_j-a_i)/\\sqrt{2}\\} = f_j-f_i+1 > 0 - (1-1/\\sqrt{2})+1 = 1/\\sqrt{2}$. As $1/\\sqrt{2} > 1-1/\\sqrt{2}$, this is a contradiction. Thus, the sequence of fractional parts must be strictly increasing: $0=\\{a_1/\\sqrt{2}\\} < \\{a_2/\\sqrt{2}\\} < \\cdots < \\{a_k/\\sqrt{2}\\}$. The upper bound follows from $a_k = a_k-a_1 \notin H$, so $\\{a_k/\\sqrt{2}\\} \\le 1-1/\\sqrt{2}$.","Let $H=\\left\\{\\lfloor i \\sqrt{2}\rfloor: i \\in \\mathbb{Z}_{>0}\right\\}$, and let $n$ be a positive integer. Prove that there exists a constant $C$ such that, if $A \\subset\\{1,2, \\ldots, n\\}$ satisfies $|A| \\geqslant C \\sqrt{n}$, then there exist $a, b \\in A$ such that $a-b \\in H$.","Assume $A=\\{a_1, \\dots, a_k\\}$ has no differences in $H$. Let $k=|A|$. By Sub-problem 2, we can assume $A=\\{0=a_1 < \\dots < a_k < n\\}$ and $0=\\{a_1/\\sqrt{2}\\} < \\cdots < \\{a_k/\\sqrt{2}\\} < 1-1/\\sqrt{2}$. Let $d_i=a_{i+1}-a_i$. Then $\\{a_k/\\sqrt{2}\\} = \\sum_{i=1}^{k-1}(\\{a_{i+1}/\\sqrt{2}\\}-\\{a_i/\\sqrt{2}\\}) = \\sum_{i=1}^{k-1}\\{d_i/\\sqrt{2}\\}$. Using the Diophantine approximation result that for any integer $d>0$, $\\{d/\\sqrt{2}\\} > \frac{1}{2d\\sqrt{2}}$, we have $1-1/\\sqrt{2} > \\sum_{i=1}^{k-1}\\{d_i/\\sqrt{2}\\} > \\sum_{i=1}^{k-1} \frac{1}{2d_i\\sqrt{2}}$. By the Cauchy-Schwarz inequality, $(\\sum d_i)(\\sum 1/d_i) \\ge (k-1)^2$. Since $\\sum d_i = a_k < n$, we get $\\sum 1/d_i > (k-1)^2/n$. Combining these gives $1-1/\\sqrt{2} > \frac{1}{2\\sqrt{2}}\frac{(k-1)^2}{n}$. Rearranging yields $(k-1)^2 < n(2\\sqrt{2}-2)$, so $k < \\sqrt{2\\sqrt{2}-2}\\sqrt{n}+1$. Thus, if $|A| \\ge C\\sqrt{n}$ for a constant $C > \\sqrt{2\\sqrt{2}-2}$, there must be a difference in $H$.",,
2019n7,Prove that there is a constant $c>0$ and infinitely many positive integers $n$ with the following property: there are infinitely many positive integers that cannot be expressed as the sum of fewer than $c n \log (n)$ pairwise coprime $n^{\text {th }}$ powers.,"Suppose, for an integer $n$, that we can find another integer $N$ satisfying the following property:\\
$n$ is divisible by $\varphi\left(p^{e}\right)$ for every prime power $p^{e}$ exactly dividing $N$.\\
This property ensures that all $n^{\text {th }}$ powers are congruent to 0 or 1 modulo each such prime power $p^{e}$, and hence that any sum of $m$ pairwise coprime $n^{\text {th }}$ powers is congruent to $m$ or $m-1$ modulo $p^{e}$, since at most one of the $n^{\text {th }}$ powers is divisible by $p$. Thus, if $k$ denotes the number of distinct prime factors of $N$, we find by the Chinese Remainder Theorem at most $2^{k} m$ residue classes modulo $N$ which are sums of at most $m$ pairwise coprime $n^{\text {th }}$ powers. In particular, if $N>2^{k} m$ then there are infinitely many positive integers not expressible as a sum of at most $m$ pairwise coprime $n^{\text {th }}$ powers.

It thus suffices to prove that there are arbitrarily large pairs $(n, N)$ of integers satisfying ( $\dagger$ ) such that

$$
N>c \cdot 2^{k} n \log (n)
$$

for some positive constant $c$.\\
We construct such pairs as follows. Fix a positive integer $t$ and choose (distinct) prime numbers $p \mid 2^{2^{t-1}}+1$ and $q \mid 2^{2^{t}}+1$; we set $N=p q$. It is well-known that $2^{t} \mid p-1$ and $2^{t+1} \mid q-1$, hence

$$
n=\frac{(p-1)(q-1)}{2^{t}}
$$

is an integer and the pair $(n, N)$ satisfies $(\dagger)$.\\
Estimating the size of $N$ and $n$ is now straightforward. We have

$$
\log _{2}(n) \leqslant 2^{t-1}+2^{t}-t<2^{t+1}<2 \cdot \frac{N}{n}
$$

which rearranges to

$$
N>\frac{1}{8} \cdot 2^{2} n \log _{2}(n)
$$

and so we are done if we choose $c<\frac{1}{8 \log (2)} \approx 0.18$.\\
Comment 1. The trick in the above solution was to find prime numbers $p$ and $q$ congruent to 1 modulo some $d=2^{t}$ and which are not too large. An alternative way to do this is via Linnik's Theorem, which says that there are absolute constants $b$ and $L>1$ such that for any coprime integers $a$ and $d$, there is a prime congruent to $a$ modulo $d$ and of size $\leqslant b d^{L}$. If we choose some $d$ not divisible by 3 and choose two distinct primes $p, q \leqslant b \cdot(3 d)^{L}$ congruent to 1 modulo $d$ (and, say, distinct modulo 3), then we obtain a pair $(n, N)$ satisfying $(\dagger)$ with $N=p q$ and $n=\frac{(p-1)(q-1)}{d}$. A straightforward computation shows that

$$
N>C n^{1+\frac{1}{2 L-1}}
$$

for some constant $C$, which is in particular larger than any $c \cdot 2^{2} n \log (n)$ for $p$ large. Thus, the statement of the problem is true for any constant $c$. More strongly, the statement of the problem is still true when $c n \log (n)$ is replaced by $n^{1+\delta}$ for a sufficiently small $\delta>0$.",3,"Let $n$ and $N$ be positive integers, and let $k$ be the number of distinct prime factors of $N$. Suppose that for every prime power $p^e$ that exactly divides $N$, we have $\varphi(p^e) | n$. Show that if $N > m \cdot 2^k$, then there are infinitely many positive integers that cannot be expressed as a sum of at most $m$ pairwise coprime $n^{\text{th}}$ powers.","Let $p^e$ be a prime power exactly dividing $N$. The condition $\varphi(p^e)|n$ implies that for any integer $a$, $a^n \equiv 1 \pmod{p^e}$ if $p \nmid a$, and $a^n \equiv 0 \pmod{p^e}$ if $p|a$ (assuming $n \ge e$). A sum of $j$ pairwise coprime $n^{\text{th}}$ powers has at most one term divisible by $p$, so its value modulo $p^e$ must be $j$ or $j-1$. By the Chinese Remainder Theorem, for a fixed number of terms $j$, there are at most $2^k$ possible residues for the sum modulo $N$. For all sums with at most $m$ terms ($j \le m$), there are at most $m \cdot 2^k$ possible residues. If $N > m \cdot 2^k$, there must exist residue classes modulo $N$ which cannot be represented, meaning infinitely many integers (those in such classes) cannot be expressed in the required form.","Show that there exists a positive absolute constant $C$ such that for infinitely many pairs of integers $(n, N)$, we have (1) $N=pq$ for distinct primes $p$ and $q$, (2) $\varphi(p)|n$ and $\varphi(q)|n$, and (3) $N > C n \log(n)$.","For any integer $t \ge 1$, choose distinct primes $p$ dividing $2^{2^{t-1}}+1$ and $q$ dividing $2^{2^t}+1$. Set $N=pq$. From properties of these primes related to Fermat numbers, we have $2^t | (p-1)$ and $2^{t+1} | (q-1)$. Define $n = \frac{(p-1)(q-1)}{2^t}$. This choice of $n$ is an integer, and it is divisible by both $\varphi(p)=p-1$ and $\varphi(q)=q-1$. For large $t$, we can estimate the sizes of $n$ and $N$. We have $\frac{N}{n} = \frac{pq}{(p-1)(q-1)}2^t > 2^t$, and $\log_2(n) \le 2^{t-1}+2^t-t < 2^{t+1}$. Combining these inequalities gives $2\frac{N}{n} > 2^{t+1} > \log_2(n)$, which rearranges to $N > \frac{1}{2} n \log_2(n) = \frac{1}{2\log 2}n\log(n)$. As $t$ can be arbitrarily large, this constructs infinitely many such pairs $(n, N)$ with $C = \frac{1}{2\log 2}$.",Prove that there is a constant $c>0$ and infinitely many positive integers $n$ with the following property: there are infinitely many positive integers that cannot be expressed as the sum of fewer than $c n \log (n)$ pairwise coprime $n^{\text {th }}$ powers.,"From Sub-problem 2, we can generate an infinite sequence of integers $n$ (by taking $t=1, 2, \dots$) and corresponding integers $N=pq$ (so $k=2$) such that $\varphi(p)|n$, $\varphi(q)|n$, and $N > \frac{1}{2\log 2} n \log(n)$. Let $m_{max}$ be the maximum number of terms in the sum, so $m_{max} < c n \log(n)$. We can take $m_{max} = \lfloor c n \log(n) \rfloor -1$. From Sub-problem 1, if $N > m_{max} \cdot 2^k = m_{max} \cdot 4$, there are infinitely many unrepresentable integers. This condition is satisfied if $N > 4cn \log(n)$. Our construction yields $N > \frac{1}{2\log 2} n \log(n)$. Thus, we need to choose $c$ such that $\frac{1}{2\log 2} n \log(n) > 4cn \log(n)$, which simplifies to $c < \frac{1}{8\log 2}$. Choosing any positive constant $c$ in this range, the property holds for the infinitely many integers $n$ generated by our construction.",,
2019n8,"Let $a$ and $b$ be two positive integers. Prove that the integer

$$
a^{2}+\left\lceil\frac{4 a^{2}}{b}\right\rceil
$$

is not a square. (Here $\lceil z\rceil$ denotes the least integer greater than or equal to $z$.)","Arguing indirectly, assume that

$$
a^{2}+\left\lceil\frac{4 a^{2}}{b}\right\rceil=(a+k)^{2}, \quad \text { or } \quad\left\lceil\frac{(2 a)^{2}}{b}\right\rceil=(2 a+k) k .
$$

Clearly, $k \geqslant 1$. In other words, the equation


\begin{equation*}
\left\lceil\frac{c^{2}}{b}\right\rceil=(c+k) k \tag{1}
\end{equation*}


has a positive integer solution $(c, k)$, with an even value of $c$.\\
Choose a positive integer solution of (1) with minimal possible value of $k$, without regard to the parity of $c$. From

$$
\frac{c^{2}}{b}>\left\lceil\frac{c^{2}}{b}\right\rceil-1=c k+k^{2}-1 \geqslant c k
$$

and

$$
\frac{(c-k)(c+k)}{b}<\frac{c^{2}}{b} \leqslant\left\lceil\frac{c^{2}}{b}\right\rceil=(c+k) k
$$

it can be seen that $c>b k>c-k$, so

$$
c=k b+r \quad \text { with some } 0<r<k .
$$

By substituting this in (1) we get

$$
\left\lceil\frac{c^{2}}{b}\right\rceil=\left\lceil\frac{(b k+r)^{2}}{b}\right\rceil=k^{2} b+2 k r+\left\lceil\frac{r^{2}}{b}\right\rceil
$$

and

$$
(c+k) k=(k b+r+k) k=k^{2} b+2 k r+k(k-r),
$$

so


\begin{equation*}
\left\lceil\frac{r^{2}}{b}\right\rceil=k(k-r) . \tag{2}
\end{equation*}


Notice that relation (2) provides another positive integer solution of (1), namely $c^{\prime}=r$ and $k^{\prime}=k-r$, with $c^{\prime}>0$ and $0<k^{\prime}<k$. That contradicts the minimality of $k$, and hence finishes the solution.",2,"Let $b$ be a positive integer. Show that if the equation $\left\lceil\frac{c^{2}}{b}\right\rceil=(c+k) k$ has a solution $(c, k)$ in positive integers, then there exists another solution $(c', k')$ in positive integers such that $k' < k$.","Assume $(c,k)$ is a solution in positive integers. From the given equation, we have the inequalities $\frac{c^2}{b} > \lceil\frac{c^2}{b}\rceil - 1 = ck+k^2-1$ and $\frac{c^2}{b} \le \lceil\frac{c^2}{b}\rceil = (c+k)k$. The first inequality implies $c^2 > b(ck+k^2-1)$. Since $k \ge 1$, $k^2-1 \ge 0$, so $c^2 > bck$, which gives $c > bk$. (Equality $c=bk$ would lead to $k=0$, a contradiction). The second inequality, combined with $\frac{c^2-k^2}{b} < \frac{c^2}{b}$ (since $c>bk\ge k>0$), implies $\frac{(c-k)(c+k)}{b} < (c+k)k$, so $c-k < bk$. We have $bk < c < bk+k$. Thus, we can write $c=bk+r$ for an integer $r$ with $0<r<k$. Substituting this into the original equation: $\lceil\frac{(bk+r)^2}{b}\rceil = (bk+r+k)k$. The left side simplifies to $bk^2+2kr+\lceil\frac{r^2}{b}\rceil$ and the right side to $bk^2+rk+k^2$. Equating them gives $\lceil\frac{r^2}{b}\rceil = k^2-rk = k(k-r)$. Let $c'=r$ and $k'=k-r$. Since $0<r<k$, $c'$ and $k'$ are positive integers and $k'<k$. The equation becomes $\lceil\frac{(c')^2}{b}\rceil = (c'+k')k'$. Thus, $(c', k')$ is another solution with a smaller positive $k'.","Let $a$ and $b$ be two positive integers. Prove that the integer

$$\n a^{2}+\left\lceil\frac{4 a^{2}}{b}\right\rceil
$$

is not a square.","Assume for contradiction that $a^{2}+\left\lceil\frac{4 a^{2}}{b}\right\rceil$ is a square. Since it is greater than $a^2$, it must be of the form $(a+k)^2$ for some integer $k \ge 1$. This implies $\left\lceil\frac{4 a^{2}}{b}\right\rceil = 2ak+k^2 = (2a+k)k$. Let $c=2a$. Then $(c,k)$ is a solution in positive integers to the equation $\left\lceil\frac{c^{2}}{b}\right\rceil=(c+k) k$. The set of positive integers $k$ for which this equation has a positive integer solution $c$ is therefore non-empty. By the well-ordering principle, there must be a smallest such integer, let's call it $k_{min}$. However, from the first sub-problem, for any solution $(c, k)$, there exists another solution $(c', k')$ with a positive integer $k'$ such that $k' < k$. This contradicts the minimality of $k_{min}$. Thus, our initial assumption that such a solution exists must be false. Therefore, $a^{2}+\left\lceil\frac{4 a^{2}}{b}\right\rceil$ cannot be a square.",,,,
2018a3,"Given any set $S$ of positive integers, show that at least one of the following two assertions holds:\\
(1) There exist distinct finite subsets $F$ and $G$ of $S$ such that $\sum_{x \in F} 1 / x=\sum_{x \in G} 1 / x$;\\
(2) There exists a positive rational number $r<1$ such that $\sum_{x \in F} 1 / x \neq r$ for all finite subsets $F$ of $S$.","Argue indirectly. Agree, as usual, that the empty sum is 0 to consider rationals in $\left[0,1\right.$ ); adjoining 0 causes no harm, since $\sum_{x \in F} 1 / x=0$ for no nonempty finite subset $F$ of $S$. For every rational $r$ in $[0,1)$, let $F_{r}$ be the unique finite subset of $S$ such that $\sum_{x \in F_{r}} 1 / x=r$. The argument hinges on the lemma below.\\
Lemma. If $x$ is a member of $S$ and $q$ and $r$ are rationals in $[0,1)$ such that $q-r=1 / x$, then $x$ is a member of $F_{q}$ if and only if it is not one of $F_{r}$.\\
Proof. If $x$ is a member of $F_{q}$, then

$$
\sum_{y \in F_{q} \backslash\{x\}} \frac{1}{y}=\sum_{y \in F_{q}} \frac{1}{y}-\frac{1}{x}=q-\frac{1}{x}=r=\sum_{y \in F_{r}} \frac{1}{y},
$$

so $F_{r}=F_{q} \backslash\{x\}$, and $x$ is not a member of $F_{r}$. Conversely, if $x$ is not a member of $F_{r}$, then

$$
\sum_{y \in F_{r} \cup\{x\}} \frac{1}{y}=\sum_{y \in F_{r}} \frac{1}{y}+\frac{1}{x}=r+\frac{1}{x}=q=\sum_{y \in F_{q}} \frac{1}{y},
$$

so $F_{q}=F_{r} \cup\{x\}$, and $x$ is a member of $F_{q}$.\\
Consider now an element $x$ of $S$ and a positive rational $r<1$. Let $n=\lfloor r x\rfloor$ and consider the sets $F_{r-k / x}, k=0, \ldots, n$. Since $0 \leqslant r-n / x<1 / x$, the set $F_{r-n / x}$ does not contain $x$, and a repeated application of the lemma shows that the $F_{r-(n-2 k) / x}$ do not contain $x$, whereas the $F_{r-(n-2 k-1) / x}$ do. Consequently, $x$ is a member of $F_{r}$ if and only if $n$ is odd.

Finally, consider $F_{2 / 3}$. By the preceding, $\lfloor 2 x / 3\rfloor$ is odd for each $x$ in $F_{2 / 3}$, so $2 x / 3$ is not integral. Since $F_{2 / 3}$ is finite, there exists a positive rational $\varepsilon$ such that $\lfloor(2 / 3-\varepsilon) x\rfloor=\lfloor 2 x / 3\rfloor$ for all $x$ in $F_{2 / 3}$. This implies that $F_{2 / 3}$ is a subset of $F_{2 / 3-\varepsilon}$ which is impossible.",3,"Assume that for every rational number $r \in [0, 1)$, there exists a unique finite subset $F_r$ of a given set of positive integers $S$ such that $\sum_{x \in F_r} 1/x = r$. Let $x$ be an element of $S$ and $q, r$ be rationals in $[0,1)$ such that $q-r=1/x$. Prove that $x \in F_q$ if and only if $x \notin F_r$.","If $x \in F_q$, then the sum over the set $F_q \setminus \{x\}$ is $\sum_{y \in F_q \setminus \{x\}} 1/y = (\sum_{y \in F_q} 1/y) - 1/x = q - 1/x = r$. By the uniqueness of $F_r$, we must have $F_r = F_q \setminus \{x\}$. Therefore, $x \notin F_r$. Conversely, if $x \notin F_r$, then the sum over the set $F_r \cup \{x\}$ is $\sum_{y \in F_r \cup \{x\}} 1/y = (\sum_{y \in F_r} 1/y) + 1/x = r + 1/x = q$. By the uniqueness of $F_q$, we must have $F_q = F_r \cup \{x\}$. Therefore, $x \in F_q$.","Under the same assumption as in the first sub-problem, prove that for any element $x \in S$ and any rational number $r \in [0, 1)$, $x \in F_r$ if and only if $\lfloor rx \rfloor$ is an odd integer.","Let $n = \lfloor rx \rfloor$. Consider the sequence of rationals $r_k = r - k/x$ for $k = 0, 1, \dots, n$. We have $r_0 = r$ and $0 \le r_n < 1/x$. Since $\sum_{y \in F_{r_n}} 1/y = r_n < 1/x$, the set $F_{r_n}$ cannot contain $x$. From the previous sub-problem, since $r_{k-1} - r_k = 1/x$, we have $x \in F_{r_{k-1}}$ if and only if $x \notin F_{r_k}$. Applying this relationship repeatedly from $k=n$ down to $k=1$, we find that $x \in F_{r_{n-k}}$ if and only if $k$ is odd, given that $x \notin F_{r_n}$. For $k=n$, we get that $x \in F_{r_0} = F_r$ if and only if $n = \lfloor rx \rfloor$ is odd.","Given any set $S$ of positive integers, show that at least one of the following two assertions holds:\\(1) There exist distinct finite subsets $F$ and $G$ of $S$ such that $\sum_{x \in F} 1 / x=\sum_{x \in G} 1 / x$;\\(2) There exists a positive rational number $r<1$ such that $\sum_{x \in F} 1 / x \neq r$ for all finite subsets $F$ of $S$.","Assume for contradiction that both assertions are false. This means for every rational $r \in [0, 1)$, there is a unique finite subset $F_r$ of $S$ with $\sum_{x \in F_r} 1/x = r$. Let's consider $r=2/3$. By the result of the second sub-problem, for any $x \in F_{2/3}$, the integer $\lfloor 2x/3 \rfloor$ must be odd. Since $F_{2/3}$ is a finite set, we can choose a positive rational $\varepsilon$ small enough such that for all $x \in F_{2/3}$, $\lfloor (2/3-\varepsilon)x \rfloor = \lfloor 2x/3 \rfloor$. Let $r' = 2/3 - \varepsilon$. For any $x \in F_{2/3}$, $\lfloor r'x \rfloor = \lfloor 2x/3 \rfloor$ is odd. By the second sub-problem's result, this implies that every element $x$ of $F_{2/3}$ must also be an element of $F_{r'} = F_{2/3-\varepsilon}$. Thus, $F_{2/3} \subseteq F_{2/3-\varepsilon}$. However, $\sum_{y \in F_{2/3}} 1/y = 2/3$ and $\sum_{y \in F_{2/3-\varepsilon}} 1/y = 2/3 - \varepsilon$. Since all elements of $S$ are positive, if $F_{2/3} \subseteq F_{2/3-\varepsilon}$, then $\sum_{y \in F_{2/3}} 1/y \le \sum_{y \in F_{2/3-\varepsilon}} 1/y$. But this would mean $2/3 \le 2/3 - \varepsilon$, which is false for $\varepsilon > 0$. This contradiction proves the original statement.",,
2018a6,"Let $m, n \geqslant 2$ be integers. Let $f\left(x_{1}, \ldots, x_{n}\right)$ be a polynomial with real coefficients such that

$$
f\left(x_{1}, \ldots, x_{n}\right)=\left\lfloor\frac{x_{1}+\ldots+x_{n}}{m}\right\rfloor \quad \text { for every } x_{1}, \ldots, x_{n} \in\{0,1, \ldots, m-1\}
$$

Prove that the total degree of $f$ is at least $n$.","Solution. We transform the problem to a single variable question by the following\\
Lemma. Let $a_{1}, \ldots, a_{n}$ be nonnegative integers and let $G(x)$ be a nonzero polynomial with $\operatorname{deg} G \leqslant a_{1}+\ldots+a_{n}$. Suppose that some polynomial $F\left(x_{1}, \ldots, x_{n}\right)$ satisfies

$$
F\left(x_{1}, \ldots, x_{n}\right)=G\left(x_{1}+\ldots+x_{n}\right) \quad \text { for }\left(x_{1}, \ldots, x_{n}\right) \in\left\{0,1, \ldots, a_{1}\right\} \times \ldots \times\left\{0,1, \ldots, a_{n}\right\}
$$

Then $F$ cannot be the zero polynomial, and $\operatorname{deg} F \geqslant \operatorname{deg} G$.\\
For proving the lemma, we will use forward differences of polynomials. If $p(x)$ is a polynomial with a single variable, then define $(\Delta p)(x)=p(x+1)-p(x)$. It is well-known that if $p$ is a nonconstant polynomial then $\operatorname{deg} \Delta p=\operatorname{deg} p-1$.

If $p\left(x_{1}, \ldots, x_{n}\right)$ is a polynomial with $n$ variables and $1 \leqslant k \leqslant n$ then let

$$
\left(\Delta_{k} p\right)\left(x_{1}, \ldots, x_{n}\right)=p\left(x_{1}, \ldots, x_{k-1}, x_{k}+1, x_{k+1}, \ldots, x_{n}\right)-p\left(x_{1}, \ldots, x_{n}\right)
$$

It is also well-known that either $\Delta_{k} p$ is the zero polynomial or $\operatorname{deg}\left(\Delta_{k} p\right) \leqslant \operatorname{deg} p-1$.\\
Proof of the lemma. We apply induction on the degree of $G$. If $G$ is a constant polynomial then we have $F(0, \ldots, 0)=G(0) \neq 0$, so $F$ cannot be the zero polynomial.

Suppose that $\operatorname{deg} G \geqslant 1$ and the lemma holds true for lower degrees. Since $a_{1}+\ldots+a_{n} \geqslant$ $\operatorname{deg} G>0$, at least one of $a_{1}, \ldots, a_{n}$ is positive; without loss of generality suppose $a_{1} \geqslant 1$.

Consider the polynomials $F_{1}=\Delta_{1} F$ and $G_{1}=\Delta G$. On the grid $\left\{0, \ldots, a_{1}-1\right\} \times\left\{0, \ldots, a_{2}\right\} \times$ $\ldots \times\left\{0, \ldots, a_{n}\right\}$ we have

$$
\begin{aligned}
F_{1}\left(x_{1}, \ldots, x_{n}\right) & =F\left(x_{1}+1, x_{2}, \ldots, x_{n}\right)-F\left(x_{1}, x_{2}, \ldots, x_{n}\right)= \\
& =G\left(x_{1}+\ldots+x_{n}+1\right)-G\left(x_{1}+\ldots+x_{n}\right)=G_{1}\left(x_{1}+\ldots+x_{n}\right)
\end{aligned}
$$

Since $G$ is nonconstant, we have $\operatorname{deg} G_{1}=\operatorname{deg} G-1 \leqslant\left(a_{1}-1\right)+a_{2}+\ldots+a_{n}$. Therefore we can apply the induction hypothesis to $F_{1}$ and $G_{1}$ and conclude that $F_{1}$ is not the zero polynomial and $\operatorname{deg} F_{1} \geqslant \operatorname{deg} G_{1}$. Hence, $\operatorname{deg} F \geqslant \operatorname{deg} F_{1}+1 \geqslant \operatorname{deg} G_{1}+1=\operatorname{deg} G$. That finishes the proof.

To prove the problem statement, take the unique polynomial $g(x)$ so that $g(x)=\left\lfloor\frac{x}{m}\right\rfloor$ for $x \in\{0,1, \ldots, n(m-1)\}$ and $\operatorname{deg} g \leqslant n(m-1)$. Notice that precisely $n(m-1)+1$ values of $g$ are prescribed, so $g(x)$ indeed exists and is unique. Notice further that the constraints $g(0)=g(1)=0$ and $g(m)=1$ together enforce $\operatorname{deg} g \geqslant 2$.

By applying the lemma to $a_{1}=\ldots=a_{n}=m-1$ and the polynomials $f$ and $g$, we achieve $\operatorname{deg} f \geqslant \operatorname{deg} g$. Hence we just need a suitable lower bound on $\operatorname{deg} g$.

Consider the polynomial $h(x)=g(x+m)-g(x)-1$. The degree of $g(x+m)-g(x)$ is $\operatorname{deg} g-1 \geqslant 1$, so $\operatorname{deg} h=\operatorname{deg} g-1 \geqslant 1$, and therefore $h$ cannot be the zero polynomial. On the other hand, $h$ vanishes at the points $0,1, \ldots, n(m-1)-m$, so $h$ has at least $(n-1)(m-1)$ roots. Hence,

$$
\operatorname{deg} f \geqslant \operatorname{deg} g=\operatorname{deg} h+1 \geqslant(n-1)(m-1)+1 \geqslant n
$$

Comment 1. In the lemma we have equality for the choice $F\left(x_{1}, \ldots, x_{n}\right)=G\left(x_{1}+\ldots+x_{n}\right)$, so it indeed transforms the problem to an equivalent single-variable question.

Comment 2. If $m \geqslant 3$, the polynomial $h(x)$ can be replaced by $\Delta g$. Notice that

$$
(\Delta g)(x)= \begin{cases}1 & \text { if } x \equiv-1 \quad(\bmod m) \quad \text { for } x=0,1, \ldots, n(m-1)-1 \\ 0 & \text { otherwise }\end{cases}
$$

Hence, $\Delta g$ vanishes at all integers $x$ with $0 \leqslant x<n(m-1)$ and $x \not \equiv-1(\bmod m)$. This leads to $\operatorname{deg} g \geqslant \frac{(m-1)^{2} n}{m}+1$.

If $m$ is even then this lower bound can be improved to $n(m-1)$. For $0 \leqslant N<n(m-1)$, the $(N+1)^{\text {st }}$ forward difference at $x=0$ is


\begin{equation*}
\left(\Delta^{N+1}\right) g(0)=\sum_{k=0}^{N}(-1)^{N-k}\binom{N}{k}(\Delta g)(k)=\sum_{\substack{0 \leqslant k \leqslant N \\ k \equiv-1(\bmod m)}}(-1)^{N-k}\binom{N}{k} \tag{*}
\end{equation*}


Since $m$ is even, all signs in the last sum are equal; with $N=n(m-1)-1$ this proves $\Delta^{n(m-1)} g(0) \neq 0$, indicating that $\operatorname{deg} g \geqslant n(m-1)$.

However, there are infinitely many cases when all terms in $(*)$ cancel out, for example if $m$ is an odd divisor of $n+1$. In such cases, $\operatorname{deg} f$ can be less than $n(m-1)$.

Comment 3. The lemma is closely related to the so-called\\
Alon-F锟斤拷redi bound. Let $S_{1}, \ldots, S_{n}$ be nonempty finite sets in a field and suppose that the polynomial $P\left(x_{1}, \ldots, x_{n}\right)$ vanishes at the points of the grid $S_{1} \times \ldots \times S_{n}$, except for a single point. Then $\operatorname{deg} P \geqslant \sum_{i=1}^{n}\left(\left|S_{i}\right|-1\right)$.\\
(A well-known application of the Alon-F锟斤拷redi bound was the former IMO problem 2007/6. Since then, this result became popular among the students and is part of the IMO training for many IMO teams.)

The proof of the lemma can be replaced by an application of the Alon-F锟斤拷redi bound as follows. Let $d=\operatorname{deg} G$, and let $G_{0}$ be the unique polynomial such that $G_{0}(x)=G(x)$ for $x \in\{0,1, \ldots, d-1\}$ but $\operatorname{deg} G_{0}<d$. The polynomials $G_{0}$ and $G$ are different because they have different degrees, and they attain the same values at $0,1, \ldots, d-1$; that enforces $G_{0}(d) \neq G(d)$.

Choose some nonnegative integers $b_{1}, \ldots, b_{n}$ so that $b_{1} \leqslant a_{1}, \ldots, b_{n} \leqslant a_{n}$, and $b_{1}+\ldots+b_{n}=d$, and consider the polynomial

$$
H\left(x_{1}, \ldots, x_{n}\right)=F\left(x_{1}, \ldots, x_{n}\right)-G_{0}\left(x_{1}+\ldots+x_{n}\right)
$$

on the grid $\left\{0,1, \ldots, b_{1}\right\} \times \ldots \times\left\{0,1, \ldots, b_{n}\right\}$.\\
At the point $\left(b_{1}, \ldots, b_{n}\right)$ we have $H\left(b_{1}, \ldots, b_{n}\right)=G(d)-G_{0}(d) \neq 0$. At all other points of the grid we have $F=G$ and therefore $H=G-G_{0}=0$. So, by the Alon-F锟斤拷redi bound, deg $H \geqslant b_{1}+\ldots+b_{n}=d$. Since $\operatorname{deg} G_{0}<d$, this implies $\operatorname{deg} F=\operatorname{deg}\left(H+G_{0}\right)=\operatorname{deg} H \geqslant d=\operatorname{deg} G$.",4,"Let $a_{1}, \ldots, a_{n}$ be nonnegative integers and let $G(x)$ be a nonzero polynomial with $\\operatorname{deg} G \\leqslant a_{1}+\\ldots+a_{n}$. Suppose that a polynomial $F\\left(x_{1}, \\ldots, x_{n}\right)$ satisfies $F\\left(x_{1}, \\ldots, x_{n}\right)=G\\left(x_{1}+\\ldots+x_{n}\right)$ for $\\left(x_{1}, \\ldots, x_{n}\right) \\in\\left\\{0,1, \\ldots, a_{1}\right\\} \times \\ldots \times\\left\\{0,1, \\ldots, a_{n}\right\\}$. Prove that $\\operatorname{deg} F \\geqslant \\operatorname{deg} G$.","The proof is by induction on $d = \\operatorname{deg} G$. For $d=0$, $G$ is a non-zero constant, so $F(0, \\ldots, 0)=G(0) \neq 0$, implying $F$ is not the zero polynomial and $\\operatorname{deg} F \\ge 0 = d$. Assume $d \\ge 1$ and the statement holds for polynomials of degree less than $d$. Without loss of generality, let $a_1 \\ge 1$. Let $\\Delta_1 F(\\mathbf{x}) = F(x_1+1, x_2, \\dots, x_n) - F(\\mathbf{x})$ and $\\Delta G(x) = G(x+1)-G(x)$. Then on the smaller grid $\\{0, \\dots, a_1-1\\} \times \\prod_{i=2}^n \\{0, \\dots, a_i\\}$, we have $\\Delta_1 F(\\mathbf{x}) = \\Delta G(x_1+\\dots+x_n)$. Since $\\operatorname{deg} \\Delta G = d-1$, by the induction hypothesis, $\\operatorname{deg}(\\Delta_1 F) \\ge \\operatorname{deg} \\Delta G$. As $\\operatorname{deg} F \\ge \\operatorname{deg}(\\Delta_1 F) + 1$, it follows that $\\operatorname{deg} F \\ge (\\operatorname{deg} G - 1) + 1 = \\operatorname{deg} G$.","Define a unique polynomial $g(x)$ that agrees with the function $\\lfloor k/m \rfloor$ for all integers $k$ in the set $\\{0, 1, \\dots, n(m-1)\\}$. Show that the degree of the given polynomial $f$ is at least the degree of $g$.","The sum $S = x_1 + \\dots + x_n$ with $x_i \\in \\{0, \\dots, m-1\\}$ can take any integer value in the set $K = \\{0, 1, \\dots, n(m-1)\\}$. By polynomial interpolation, there is a unique polynomial $g(x)$ of degree at most $|K|-1 = n(m-1)$ such that $g(k) = \\lfloor k/m \rfloor$ for all $k \\in K$. The problem statement implies $f(x_1, \\dots, x_n) = g(x_1+\\dots+x_n)$ for all $(x_1, \\dots, x_n) \\in \\{0, \\dots, m-1\\}^n$. We apply the lemma from Part 1 with $F=f$, $G=g$, and $a_i = m-1$ for $i=1, \\dots, n$. The condition $\\operatorname{deg} g \\le n(m-1) = \\sum a_i$ holds. Therefore, $\\operatorname{deg} f \\ge \\operatorname{deg} g$.","Let $g(x)$ be the polynomial from Part 2. Define $h(x) = g(x+m)-g(x)-1$. Prove that $h(x)$ has at least $(n-1)(m-1)$ roots, and that $\\operatorname{deg} g = \\operatorname{deg} h + 1$.","For any integer $k \\in \\{0, 1, \\dots, n(m-1)-m\\}$, the identity $\\lfloor (k+m)/m \rfloor = \\lfloor k/m \rfloor + 1$ holds. Since $g(x)$ agrees with $\\lfloor x/m \rfloor$ on this range for both $k$ and $k+m$, we have $g(k+m) = g(k) + 1$. Thus, $h(k) = g(k+m)-g(k)-1 = 0$ for $k=0, 1, \\dots, n(m-1)-m$. This provides $n(m-1)-m+1 = (n-1)(m-1)$ distinct integer roots for $h(x)$. Since $g(0)=\\lfloor 0/m \rfloor=0$ and $g(m)=\\lfloor m/m \rfloor=1$, $g$ is not constant. In fact, $g$ is not linear since $g(1)=\\lfloor 1/m \rfloor=0$ for $m \\ge 2$, so $\\operatorname{deg} g \\ge 2$. For any polynomial $p(x)$ of degree $d \\ge 1$, $\\operatorname{deg}(p(x+c)-p(x)) = d-1$. Thus, $\\operatorname{deg}(g(x+m)-g(x)) = \\operatorname{deg} g - 1 \\ge 1$. This implies $h(x)$ is not the zero polynomial and $\\operatorname{deg} h = \\operatorname{deg} g - 1$, which is equivalent to $\\operatorname{deg} g = \\operatorname{deg} h + 1$.","Let $m, n \\geqslant 2$ be integers. Let $f\\left(x_{1}, \\ldots, x_{n}\right)$ be a polynomial with real coefficients such that\n\n$$\nf\\left(x_{1}, \\ldots, x_{n}\right)=\\left\\lfloor\frac{x_{1}+\\ldots+x_{n}}{m}\right\rfloor \\quad \text { for every } x_{1}, \\ldots, x_{n} \\in\\{0,1, \\ldots, m-1\\}\n$$\n\nProve that the total degree of $f$ is at least $n$.","From Part 2, we have $\\operatorname{deg} f \\ge \\operatorname{deg} g$. From Part 3, we have $\\operatorname{deg} g = \\operatorname{deg} h + 1$ and $h(x)$ is a non-zero polynomial with at least $(n-1)(m-1)$ roots. The degree of a non-zero polynomial is at least the number of its distinct roots, so $\\operatorname{deg} h \\ge (n-1)(m-1)$. Combining these results gives $\\operatorname{deg} f \\ge \\operatorname{deg} g = \\operatorname{deg} h + 1 \\ge (n-1)(m-1) + 1$. Since $m, n \\ge 2$, we have $m-1 \\ge 1$ and $n-1 \\ge 1$. Therefore, $(n-1)(m-1) + 1 \\ge (n-1)(1) + 1 = n$. We conclude that $\\operatorname{deg} f \\ge n$."
2018c1,"Let $n \geqslant 3$ be an integer. Prove that there exists a set $S$ of $2 n$ positive integers satisfying the following property: For every $m=2,3, \ldots, n$ the set $S$ can be partitioned into two subsets with equal sums of elements, with one of subsets of cardinality $m$.\\
(Iceland)\\
Solution. We show that one of possible examples is the set

$$
S=\left\{1 \cdot 3^{k}, 2 \cdot 3^{k}: k=1,2, \ldots, n-1\right\} \cup\left\{1, \frac{3^{n}+9}{2}-1\right\}
$$

It is readily verified that all the numbers listed above are distinct (notice that the last two are not divisible by 3 ).

The sum of elements in $S$ is\\
$\Sigma=1+\left(\frac{3^{n}+9}{2}-1\right)+\sum_{k=1}^{n-1}\left(1 \cdot 3^{k}+2 \cdot 3^{k}\right)=\frac{3^{n}+9}{2}+\sum_{k=1}^{n-1} 3^{k+1}=\frac{3^{n}+9}{2}+\frac{3^{n+1}-9}{2}=2 \cdot 3^{n}$.\\
Hence, in order to show that this set satisfies the problem requirements, it suffices to present, for every $m=2,3, \ldots, n$, an $m$-element subset $A_{m} \subset S$ whose sum of elements equals $3^{n}$.

Such a subset is

$$
A_{m}=\left\{2 \cdot 3^{k}: k=n-m+1, n-m+2, \ldots, n-1\right\} \cup\left\{1 \cdot 3^{n-m+1}\right\}
$$

Clearly, $\left|A_{m}\right|=m$. The sum of elements in $A_{m}$ is

$$
3^{n-m+1}+\sum_{k=n-m+1}^{n-1} 2 \cdot 3^{k}=3^{n-m+1}+\frac{2 \cdot 3^{n}-2 \cdot 3^{n-m+1}}{2}=3^{n}
$$

as required.

Comment. Let us present a more general construction. Let $s_{1}, s_{2}, \ldots, s_{2 n-1}$ be a sequence of pairwise distinct positive integers satisfying $s_{2 i+1}=s_{2 i}+s_{2 i-1}$ for all $i=2,3, \ldots, n-1$. Set $s_{2 n}=s_{1}+s_{2}+$ $\cdots+s_{2 n-4}$.

Assume that $s_{2 n}$ is distinct from the other terms of the sequence. Then the set $S=\left\{s_{1}, s_{2}, \ldots, s_{2 n}\right\}$ satisfies the problem requirements. Indeed, the sum of its elements is

$$
\Sigma=\sum_{i=1}^{2 n-4} s_{i}+\left(s_{2 n-3}+s_{2 n-2}\right)+s_{2 n-1}+s_{2 n}=s_{2 n}+s_{2 n-1}+s_{2 n-1}+s_{2 n}=2 s_{2 n}+2 s_{2 n-1}
$$

Therefore, we have

$$
\frac{\Sigma}{2}=s_{2 n}+s_{2 n-1}=s_{2 n}+s_{2 n-2}+s_{2 n-3}=s_{2 n}+s_{2 n-2}+s_{2 n-4}+s_{2 n-5}=\ldots
$$

which shows that the required sets $A_{m}$ can be chosen as

$$
A_{m}=\left\{s_{2 n}, s_{2 n-2}, \ldots, s_{2 n-2 m+4}, s_{2 n-2 m+3}\right\}
$$

So, the only condition to be satisfied is $s_{2 n} \notin\left\{s_{1}, s_{2}, \ldots, s_{2 n-1}\right\}$, which can be achieved in many different ways (e.g., by choosing properly the number $s_{1}$ after specifying $s_{2}, s_{3}, \ldots, s_{2 n-1}$ ).

The solution above is an instance of this general construction. Another instance, for $n>3$, is the set

$$
\left\{F_{1}, F_{2}, \ldots, F_{2 n-1}, F_{1}+\cdots+F_{2 n-4}\right\}
$$

where $F_{1}=1, F_{2}=2, F_{n+1}=F_{n}+F_{n-1}$ is the usual Fibonacci sequence.","Solution. We show that one of possible examples is the set

$$
S=\left\{1 \cdot 3^{k}, 2 \cdot 3^{k}: k=1,2, \ldots, n-1\right\} \cup\left\{1, \frac{3^{n}+9}{2}-1\right\}
$$

It is readily verified that all the numbers listed above are distinct (notice that the last two are not divisible by 3 ).

The sum of elements in $S$ is\\
$\Sigma=1+\left(\frac{3^{n}+9}{2}-1\right)+\sum_{k=1}^{n-1}\left(1 \cdot 3^{k}+2 \cdot 3^{k}\right)=\frac{3^{n}+9}{2}+\sum_{k=1}^{n-1} 3^{k+1}=\frac{3^{n}+9}{2}+\frac{3^{n+1}-9}{2}=2 \cdot 3^{n}$.\\
Hence, in order to show that this set satisfies the problem requirements, it suffices to present, for every $m=2,3, \ldots, n$, an $m$-element subset $A_{m} \subset S$ whose sum of elements equals $3^{n}$.

Such a subset is

$$
A_{m}=\left\{2 \cdot 3^{k}: k=n-m+1, n-m+2, \ldots, n-1\right\} \cup\left\{1 \cdot 3^{n-m+1}\right\}
$$

Clearly, $\left|A_{m}\right|=m$. The sum of elements in $A_{m}$ is

$$
3^{n-m+1}+\sum_{k=n-m+1}^{n-1} 2 \cdot 3^{k}=3^{n-m+1}+\frac{2 \cdot 3^{n}-2 \cdot 3^{n-m+1}}{2}=3^{n}
$$

as required.

Comment. Let us present a more general construction. Let $s_{1}, s_{2}, \ldots, s_{2 n-1}$ be a sequence of pairwise distinct positive integers satisfying $s_{2 i+1}=s_{2 i}+s_{2 i-1}$ for all $i=2,3, \ldots, n-1$. Set $s_{2 n}=s_{1}+s_{2}+$ $\cdots+s_{2 n-4}$.

Assume that $s_{2 n}$ is distinct from the other terms of the sequence. Then the set $S=\left\{s_{1}, s_{2}, \ldots, s_{2 n}\right\}$ satisfies the problem requirements. Indeed, the sum of its elements is

$$
\Sigma=\sum_{i=1}^{2 n-4} s_{i}+\left(s_{2 n-3}+s_{2 n-2}\right)+s_{2 n-1}+s_{2 n}=s_{2 n}+s_{2 n-1}+s_{2 n-1}+s_{2 n}=2 s_{2 n}+2 s_{2 n-1}
$$

Therefore, we have

$$
\frac{\Sigma}{2}=s_{2 n}+s_{2 n-1}=s_{2 n}+s_{2 n-2}+s_{2 n-3}=s_{2 n}+s_{2 n-2}+s_{2 n-4}+s_{2 n-5}=\ldots
$$

which shows that the required sets $A_{m}$ can be chosen as

$$
A_{m}=\left\{s_{2 n}, s_{2 n-2}, \ldots, s_{2 n-2 m+4}, s_{2 n-2 m+3}\right\}
$$

So, the only condition to be satisfied is $s_{2 n} \notin\left\{s_{1}, s_{2}, \ldots, s_{2 n-1}\right\}$, which can be achieved in many different ways (e.g., by choosing properly the number $s_{1}$ after specifying $s_{2}, s_{3}, \ldots, s_{2 n-1}$ ).

The solution above is an instance of this general construction. Another instance, for $n>3$, is the set

$$
\left\{F_{1}, F_{2}, \ldots, F_{2 n-1}, F_{1}+\cdots+F_{2 n-4}\right\}
$$

where $F_{1}=1, F_{2}=2, F_{n+1}=F_{n}+F_{n-1}$ is the usual Fibonacci sequence.",3,"Define the set $S=\left\{1 \cdot 3^{k}, 2 \cdot 3^{k}: k=1,2, \ldots, n-1\right\} \cup\left\{1, \frac{3^{n}+9}{2}-1\right\}$. Prove that the sum of all elements in $S$ is $2 \cdot 3^{n}$.","The sum of elements in $S$ is $\Sigma=1+\left(\frac{3^{n}+9}{2}-1\right)+\sum_{k=1}^{n-1}\left(1 \cdot 3^{k}+2 \cdot 3^{k}\right) = \frac{3^{n}+9}{2}+\sum_{k=1}^{n-1} 3^{k+1}$. The sum of the geometric series is $\sum_{k=1}^{n-1} 3^{k+1} = \sum_{j=2}^{n} 3^j = \frac{3^2(3^{n-1}-1)}{3-1} = \frac{3^{n+1}-9}{2}$. Therefore, the total sum is $\Sigma = \frac{3^{n}+9}{2}+\frac{3^{n+1}-9}{2} = \frac{3^n + 3 \cdot 3^n}{2} = \frac{4 \cdot 3^n}{2} = 2 \cdot 3^{n}$.","For the set $S$ from the previous problem and for each integer $m=2,3, \ldots, n$, define the subset $A_{m}=\left\{2 \cdot 3^{k}: k=n-m+1, \ldots, n-1\right\} \cup\left\{1 \cdot 3^{n-m+1}\right\}$. Prove that $|A_m| = m$ and the sum of its elements is $3^n$.","The set $A_m$ contains $(n-1) - (n-m+1) + 1 = m-1$ elements of the form $2 \cdot 3^k$ and one element $1 \cdot 3^{n-m+1}$, so its cardinality is $(m-1)+1=m$. The sum of its elements is $S_m = 1 \cdot 3^{n-m+1} + \sum_{k=n-m+1}^{n-1} 2 \cdot 3^{k}$. The geometric series sum is $2 \cdot \frac{3^{n-m+1}(3^{m-1}-1)}{3-1} = 3^{n-m+1}(3^{m-1}-1) = 3^n - 3^{n-m+1}$. Thus, the total sum is $S_m = 3^{n-m+1} + (3^n - 3^{n-m+1}) = 3^n$.","Let $n \geqslant 3$ be an integer. Prove that there exists a set $S$ of $2 n$ positive integers satisfying the following property: For every $m=2,3, \ldots, n$ the set $S$ can be partitioned into two subsets with equal sums of elements, with one of subsets of cardinality $m$.","Consider the set $S=\left\{1 \cdot 3^{k}, 2 \cdot 3^{k}: k=1,2, \ldots, n-1\right\} \cup\left\{1, \frac{3^{n}+9}{2}-1\right\}$. This set has $2(n-1)+2 = 2n$ distinct positive integers. From sub-problem 1, the total sum of elements is $\Sigma=2 \cdot 3^{n}$. A partition into two subsets with equal sums requires each subset to sum to $\Sigma/2 = 3^n$. From sub-problem 2, for each $m \in \{2, 3, \ldots, n\}$, there exists a subset $A_m \subset S$ with $|A_m|=m$ and whose elements sum to $3^n$. Therefore, for each such $m$, the pair of subsets $(A_m, S \setminus A_m)$ forms a partition of $S$ where both subsets have a sum of $3^n$ and one has cardinality $m$. This proves the existence of such a set $S$.",,
2018c3,"Let $n$ be a given positive integer. Sisyphus performs a sequence of turns on a board consisting of $n+1$ squares in a row, numbered 0 to $n$ from left to right. Initially, $n$ stones are put into square 0, and the other squares are empty. At every turn, Sisyphus chooses any nonempty square, say with $k$ stones, takes one of those stones and moves it to the right by at most $k$ squares (the stone should stay within the board). Sisyphus' aim is to move all $n$ stones to square $n$.

Prove that Sisyphus cannot reach the aim in less than

$$
\left\lceil\frac{n}{1}\right\rceil+\left\lceil\frac{n}{2}\right\rceil+\left\lceil\frac{n}{3}\right\rceil+\cdots+\left\lceil\frac{n}{n}\right\rceil
$$

turns. (As usual, $\lceil x\rceil$ stands for the least integer not smaller than $x$.)","Solution. The stones are indistinguishable, and all have the same origin and the same final position. So, at any turn we can prescribe which stone from the chosen square to move. We do it in the following manner. Number the stones from 1 to $n$. At any turn, after choosing a square, Sisyphus moves the stone with the largest number from this square.

This way, when stone $k$ is moved from some square, that square contains not more than $k$ stones (since all their numbers are at most $k$ ). Therefore, stone $k$ is moved by at most $k$ squares at each turn. Since the total shift of the stone is exactly $n$, at least $\lceil n / k\rceil$ moves of stone $k$ should have been made, for every $k=1,2, \ldots, n$.

By summing up over all $k=1,2, \ldots, n$, we get the required estimate.

Comment. The original submission contained the second part, asking for which values of $n$ the equality can be achieved. The answer is $n=1,2,3,4,5,7$. The Problem Selection Committee considered this part to be less suitable for the competition, due to technicalities.",2,"By labeling the stones from 1 to $n$ and adopting the rule to always move the stone with the largest number from any chosen square, prove that for any $k \in \{1, \dots, n\}$, stone $k$ must be moved at least $\lceil n/k \rceil$ times to get from square 0 to square $n$.","When we move stone $k$, it is, by our adopted rule, the highest-numbered stone in its current square. This implies that all other stones in that square have numbers smaller than $k$. Thus, there are at most $k$ stones in that square (those numbered $1, \dots, k$). According to the game's rules, the maximum distance this stone can be moved is the number of stones in its square, which is at most $k$. To cover the total distance of $n$ from square 0 to square $n$, stone $k$ must therefore be moved at least $\lceil n/k \rceil$ times.",Prove that Sisyphus cannot reach the aim in less than $\left\lceil\frac{n}{1}\right\rceil+\left\lceil\frac{n}{2}\right\rceil+\left\lceil\frac{n}{3}\right\rceil+\cdots+\left\lceil\frac{n}{n}\right\rceil$ turns.,"Each turn consists of moving exactly one stone. Therefore, the total number of turns is the sum of the number of moves made with each individual stone. From the previous sub-problem, we established a lower bound on the number of moves required for each specific stone $k$, regardless of the sequence of chosen squares. Summing these minimum move counts over all stones from $k=1$ to $n$ gives a lower bound for the total number of turns. Thus, the total number of turns must be at least $\sum_{k=1}^{n} \lceil n/k \rceil$.",,,,
2018c6,"Let $a$ and $b$ be distinct positive integers. The following infinite process takes place on an initially empty board.\\
(i) If there is at least a pair of equal numbers on the board, we choose such a pair and increase one of its components by $a$ and the other by $b$.\\
(ii) If no such pair exists, we write down two times the number 0 .

Prove that, no matter how we make the choices in (i), operation (ii) will be performed only finitely many times.","We may assume $\operatorname{gcd}(a, b)=1$; otherwise we work in the same way with multiples of $d=\operatorname{gcd}(a, b)$.

Suppose that after $N$ moves of type (ii) and some moves of type (i) we have to add two new zeros. For each integer $k$, denote by $f(k)$ the number of times that the number $k$ appeared on the board up to this moment. Then $f(0)=2 N$ and $f(k)=0$ for $k<0$. Since the board contains at most one $k-a$, every second occurrence of $k-a$ on the board produced, at some moment, an occurrence of $k$; the same stands for $k-b$. Therefore,


\begin{equation*}
f(k)=\left\lfloor\frac{f(k-a)}{2}\right\rfloor+\left\lfloor\frac{f(k-b)}{2}\right\rfloor, \tag{1}
\end{equation*}


yielding


\begin{equation*}
f(k) \geqslant \frac{f(k-a)+f(k-b)}{2}-1 . \tag{2}
\end{equation*}


Since $\operatorname{gcd}(a, b)=1$, every integer $x>a b-a-b$ is expressible in the form $x=s a+t b$, with integer $s, t \geqslant 0$.

We will prove by induction on $s+t$ that if $x=s a+b t$, with $s, t$ nonnegative integers, then


\begin{equation*}
f(x)>\frac{f(0)}{2^{s+t}}-2 . \tag{3}
\end{equation*}


The base case $s+t=0$ is trivial. Assume now that (3) is true for $s+t=v$. Then, if $s+t=v+1$ and $x=s a+t b$, at least one of the numbers $s$ and $t$-say $s$ - is positive, hence by (2),

$$
f(x)=f(s a+t b) \geqslant \frac{f((s-1) a+t b)}{2}-1>\frac{1}{2}\left(\frac{f(0)}{2^{s+t-1}}-2\right)-1=\frac{f(0)}{2^{s+t}}-2 .
$$

Assume now that we must perform moves of type (ii) ad infinitum. Take $n=a b-a-b$ and suppose $b>a$. Since each of the numbers $n+1, n+2, \ldots, n+b$ can be expressed in the form $s a+t b$, with $0 \leqslant s \leqslant b$ and $0 \leqslant t \leqslant a$, after moves of type (ii) have been performed $2^{a+b+1}$ times and we have to add a new pair of zeros, each $f(n+k), k=1,2, \ldots, b$, is at least 2 . In this case (1) yields inductively $f(n+k) \geqslant 2$ for all $k \geqslant 1$. But this is absurd: after a finite number of moves, $f$ cannot attain nonzero values at infinitely many points.",3,"Let $f(k)$ be the number of times the integer $k$ has been written on the board. Suppose operation (ii) has been performed $N$ times. Show that $f(k)$ satisfies the recurrence relation $f(k) = \lfloor f(k-a)/2 \rfloor + \lfloor f(k-b)/2 \rfloor$ for $k>0$, with initial conditions $f(0)=2N$ and $f(k)=0$ for $k<0$.","The number $k$ is written on the board either as a 0 in operation (ii), or as $x+a$ or $x+b$ in operation (i) for some $x$. Let $f(k)$ be the total count of times $k$ has been written. Operation (ii) writes two 0s. If this is performed $N$ times, then $f(0)=2N$. Operation (i) is performed on a pair of equal numbers, say $x$. The total number of pairs of $x$ that can be formed is $\lfloor f(x)/2 \rfloor$. Each time operation (i) is performed on a pair of $x$'s, the numbers $x+a$ and $x+b$ are written. Thus, the number $k$ can be created from a pair of $(k-a)$'s or from a pair of $(k-b)$'s. The total number of times $k$ is created is the sum of times it's created from $k-a$ and from $k-b$. Therefore, for $k>0$, we have $f(k) = \lfloor f(k-a)/2 \rfloor + \lfloor f(k-b)/2 \rfloor$. Since $a, b > 0$, no negative numbers are ever created, so $f(k)=0$ for $k<0$.","For a sequence of non-negative integers $f(k)$ satisfying $f(k) \ge \frac{f(k-a)+f(k-b)}{2}-1$ for $k>0$, and for any integer $x$ expressible as $x = sa+tb$ with non-negative integers $s, t$, prove by induction on $s+t$ that $f(x) > \frac{f(0)}{2^{s+t}} - 2$.","We prove the statement by induction on $v=s+t$. Base case ($v=0$): $s=t=0$, so $x=0$. The inequality is $f(0) > f(0)/2^0 - 2$, which is $f(0) > f(0) - 2$, a true statement. Inductive step: Assume the inequality holds for all $s,t$ with $s+t=v$. Let $x=sa+tb$ with $s+t=v+1$. Assume without loss of generality that $s>0$. The given recurrence implies $f(x) \ge \frac{f(x-a)}{2}-1$ since $f(x-b) \ge 0$. The number $x-a = (s-1)a+tb$ has coefficient sum $(s-1)+t = v$. By the induction hypothesis: $f((s-1)a+tb) > \frac{f(0)}{2^{s+t-1}} - 2$. Substituting this into our inequality for $f(x)$: $f(x) \ge \frac{1}{2} f((s-1)a+tb) - 1 > \frac{1}{2} \left(\frac{f(0)}{2^{s+t-1}} - 2\right) - 1 = \frac{f(0)}{2^{s+t}} - 1 - 1 = \frac{f(0)}{2^{s+t}} - 2$. This completes the induction.","Prove that, no matter how we make the choices in (i), operation (ii) will be performed only finitely many times.","Assume for contradiction that operation (ii) is performed infinitely many times. This means $f(0)=2N$ can be arbitrarily large. Assume $\operatorname{gcd}(a,b)=1$ (otherwise scale all numbers by $\operatorname{gcd}(a,b)$). By the Frobenius Coin Problem, every integer $x > n=ab-a-b$ can be written as $x=sa+tb$ for non-negative integers $s,t$. For any such $x$, the sum $s+t$ is bounded, say by some constant $K_x$. From sub-problem 2, $f(x) > \frac{f(0)}{2^{s+t}} - 2$. We can choose $N$ large enough such that for a set of consecutive integers, e.g., $x \in \{n+1, \dots, n+b\}$, we have $f(x) > 2$, which implies $f(x) \ge 3$. Now we show by induction that $f(k) \ge 2$ for all $k > n$. The base cases are $k=n+1, \dots, n+b$. For $k > n+b$, we have $k-a > n$ and $k-b > n$. By the induction hypothesis, $f(k-a) \ge 2$ and $f(k-b) \ge 2$. Using the recurrence from sub-problem 1: $f(k) = \lfloor f(k-a)/2 \rfloor + \lfloor f(k-b)/2 \rfloor \ge \lfloor 2/2 \rfloor + \lfloor 2/2 \rfloor = 2$. Thus, $f(k) \ge 2$ for all $k > n$. This implies that an infinite number of integers have been written on the board. However, at any finite stage of the process, only a finite number of operations have occurred, so only a finite number of integers can have been written. This is a contradiction. Therefore, operation (ii) must be performed only a finite number of times.",,
2018c7,"Consider 2018 pairwise crossing circles no three of which are concurrent. These circles subdivide the plane into regions bounded by circular edges that meet at vertices. Notice that there are an even number of vertices on each circle. Given the circle, alternately colour the vertices on that circle red and blue. In doing so for each circle, every vertex is coloured twice once for each of the two circles that cross at that point. If the two colourings agree at a vertex, then it is assigned that colour; otherwise, it becomes yellow. Show that, if some circle contains at least 2061 yellow points, then the vertices of some region are all yellow.","Letting $n=2018$, we will show that, if every region has at least one non-yellow vertex, then every circle contains at most $n+\lfloor\sqrt{n-2}\rfloor-2$ yellow points. In the case at hand, the latter equals $2018+44-2=2060$, contradicting the hypothesis.

Consider the natural geometric graph $G$ associated with the configuration of $n$ circles. Fix any circle $C$ in the configuration, let $k$ be the number of yellow points on $C$, and find a suitable lower bound for the total number of yellow vertices of $G$ in terms of $k$ and $n$. It turns out that $k$ is even, and $G$ has at least


\begin{equation*}
k+2\binom{k / 2}{2}+2\binom{n-k / 2-1}{2}=\frac{k^{2}}{2}-(n-2) k+(n-2)(n-1) \tag{*}
\end{equation*}


yellow vertices. The proof hinges on the two lemmata below.\\
Lemma 1. Let two circles in the configuration cross at $x$ and $y$. Then $x$ and $y$ are either both yellow or both non-yellow.\\
Proof. This is because the numbers of interior vertices on the four arcs $x$ and $y$ determine on the two circles have like parities.

In particular, each circle in the configuration contains an even number of yellow vertices.\\
Lemma 2. If $\widehat{x y}, \overrightarrow{y z}$, and $\widehat{z x}$ are circular arcs of three pairwise distinct circles in the configuration, then the number of yellow vertices in the set $\{x, y, z\}$ is odd.\\
Proof. Let $C_{1}, C_{2}, C_{3}$ be the three circles under consideration. Assume, without loss of generality, that $C_{2}$ and $C_{3}$ cross at $x, C_{3}$ and $C_{1}$ cross at $y$, and $C_{1}$ and $C_{2}$ cross at $z$. Let $k_{1}$, $k_{2}, k_{3}$ be the numbers of interior vertices on the three circular arcs under consideration. Since each circle in the configuration, different from the $C_{i}$, crosses the cycle $\widehat{x y} \cup \overline{y z} \cup \overline{z x}$ at an even number of points (recall that no three circles are concurrent), and self-crossings are counted twice, the sum $k_{1}+k_{2}+k_{3}$ is even.

Let $Z_{1}$ be the colour $z$ gets from $C_{1}$ and define the other colours similarly. By the preceding, the number of bichromatic pairs in the list $\left(Z_{1}, Y_{1}\right),\left(X_{2}, Z_{2}\right),\left(Y_{3}, X_{3}\right)$ is odd. Since the total number of colour changes in a cycle $Z_{1}-Y_{1}-Y_{3}-X_{3}-X_{2}-Z_{2}-Z_{1}$ is even, the number of bichromatic pairs in the list $\left(X_{2}, X_{3}\right),\left(Y_{1}, Y_{3}\right),\left(Z_{1}, Z_{2}\right)$ is odd, and the lemma follows.

We are now in a position to prove that (\textit{) bounds the total number of yellow vertices from below. Refer to Lemma 1 to infer that the $k$ yellow vertices on $C$ pair off to form the pairs of points where $C$ is crossed by $k / 2$ circles in the configuration. By Lemma 2 , these circles cross pairwise to account for another $2\binom{k / 2}{2}$ yellow vertices. Finally, the remaining $n-k / 2-1$ circles in the configuration cross $C$ at non-yellow vertices, by Lemma 1, and Lemma 2 applies again to show that these circles cross pairwise to account for yet another $2\binom{n-k / 2-1}{2}$ yellow vertices. Consequently, there are at least (}) yellow vertices.

Next, notice that $G$ is a plane graph on $n(n-1)$ degree 4 vertices, having exactly $2 n(n-1)$ edges and exactly $n(n-1)+2$ faces (regions), the outer face inclusive (by Euler's formula for planar graphs).\\
Lemma 3. Each face of $G$ has equally many red and blue vertices. In particular, each face has an even number of non-yellow vertices.

Proof. Trace the boundary of a face once in circular order, and consider the colours each vertex is assigned in the colouring of the two circles that cross at that vertex, to infer that colours of non-yellow vertices alternate.

Consequently, if each region has at least one non-yellow vertex, then it has at least two such. Since each vertex of $G$ has degree 4, consideration of vertex-face incidences shows that $G$ has at least $n(n-1) / 2+1$ non-yellow vertices, and hence at most $n(n-1) / 2-1$ yellow vertices. (In fact, Lemma 3 shows that there are at least $n(n-1) / 4+1 / 2$ red, respectively blue, vertices.)

Finally, recall the lower bound (*) for the total number of yellow vertices in $G$, to write $n(n-1) / 2-1 \geqslant k^{2} / 2-(n-2) k+(n-2)(n-1)$, and conclude that $k \leqslant n+\lfloor\sqrt{n-2}\rfloor-2$, as claimed in the first paragraph.",4,"Let two circles in the configuration cross at vertices $x$ and $y$. Show that $x$ and $y$ are either both yellow or both non-yellow. Also, let three distinct circles define a triangular region with vertices $v_1, v_2, v_3$. Show that the number of yellow vertices in the set $\{v_1, v_2, v_3\}$ is odd.","For the first part, the numbers of vertices on the two arcs between $x$ and $y$ on one circle have the same parity as the corresponding arcs on the other circle. Since coloring is alternate, the relationship between colors assigned at $x$ and $y$ is the same for both circles, so their agreement status (yellow or not) is identical. For the second part, consider the colors assigned to each vertex $v_i$ by the two circles forming it. The total number of color changes around the cycle of these six color assignments is even, which implies that the number of vertices where the two colors disagree (i.e., yellow vertices) must be odd.","Suppose a given circle $C$ has $k$ yellow vertices, with $n=2018$ total circles. Using the properties from Part 1, establish a lower bound on the total number of yellow vertices, showing it is at least $\frac{k^{2}}{2}-(n-2) k+(n-2)(n-1)$.","From Part 1, the $k$ yellow vertices on $C$ must come in pairs, so $k$ is even. These vertices arise from intersections with a set of $k/2$ circles. The remaining $n-1-k/2$ circles intersect $C$ at non-yellow points. Applying the second property from Part 1 to a vertex formed by two circles from the latter set and a vertex on $C$ shows that the intersection of those two circles must be yellow. A similar argument applies to the first set. Summing the yellow vertices on $C$ ($k$), those from pairs of circles in the first set ($2\binom{k/2}{2}$), and those from pairs in the second set ($2\binom{n-1-k/2}{2}$) gives a lower bound that simplifies to the stated expression.","Assuming that every region in the plane subdivision has at least one non-yellow vertex, show that the total number of yellow vertices is at most $n(n-1)/2 - 1$, where $n=2018$.","By tracing the boundary of any region, we see that the colors of non-yellow vertices must alternate. Therefore, any region must have an even number of non-yellow vertices. The assumption implies each region has at least two. The total number of vertices is $V=n(n-1)$ and regions is $F=n(n-1)+2$. Since each vertex has degree 4, a vertex-face incidence count shows that the total number of non-yellow vertices is at least $2F/4 = F/2 = n(n-1)/2+1$. The number of yellow vertices is then at most $V - (n(n-1)/2+1) = n(n-1)/2-1$.","Consider 2018 pairwise crossing circles no three of which are concurrent. These circles subdivide the plane into regions bounded by circular edges that meet at vertices. Notice that there are an even number of vertices on each circle. Given the circle, alternately colour the vertices on that circle red and blue. In doing so for each circle, every vertex is coloured twice once for each of the two circles that cross at that point. If the two colourings agree at a vertex, then it is assigned that colour; otherwise, it becomes yellow. Show that, if some circle contains at least 2061 yellow points, then the vertices of some region are all yellow.","Let $n=2018$. We prove the contrapositive: if every region has at least one non-yellow vertex, then every circle has at most 2060 yellow points. Assume every region has a non-yellow vertex. By Part 3, the total number of yellow vertices is at most $n(n-1)/2 - 1$. If a circle has $k$ yellow vertices, by Part 2 the total is at least $\frac{k^{2}}{2}-(n-2) k+(n-2)(n-1)$. Combining these gives the inequality $\frac{k^{2}}{2}-(n-2) k+(n-2)(n-1) \\le n(n-1)/2-1$. For $n=2018$, solving for $k$ gives $k \\le n+\\lfloor\\sqrt{n-2}\rfloor-2 = 2018 + 44 - 2 = 2060$. This contradicts the premise that a circle has at least 2061 yellow points. Thus, the assumption is false, and some region must be all yellow."
2018g1,"Let $A B C$ be an acute-angled triangle with circumcircle $\Gamma$. Let $D$ and $E$ be points on the segments $A B$ and $A C$, respectively, such that $A D=A E$. The perpendicular bisectors of the segments $B D$ and $C E$ intersect the small arcs $\wideparen{A B}$ and $\widetilde{A C}$ at points $F$ and $G$ respectively. Prove that $D E \| F G$.","In the sequel, all the considered arcs are small arcs.\\
Let $P$ be the midpoint of the arc $\widehat{B C}$. Then $A P$ is the bisector of $\angle B A C$, hence, in the isosceles triangle $A D E, A P \perp D E$. So, the statement of the problem is equivalent to $A P \perp F G$.

In order to prove this, let $K$ be the second intersection of $\Gamma$ with $F D$. Then the triangle $F B D$ is isosceles, therefore

$$
\angle A K F=\angle A B F=\angle F D B=\angle A D K,
$$

yielding $A K=A D$. In the same way, denoting by $L$ the second intersection of $\Gamma$ with $G E$, we get $A L=A E$. This shows that $A K=A L$.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_323b76634e0bd94edb63g-38(1)}

Now $\angle F B D=\angle F D B$ gives $\wideparen{A F}=\wideparen{B F}+\wideparen{A K}=\wideparen{B F}+\wideparen{A L}$, hence $\wideparen{B F}=\widehat{L F}$. In a similar way, we get $\wideparen{C G}=\wideparen{G K}$. This yields

$$
\angle(A P, F G)=\frac{\widehat{A F}+\widetilde{P G}}{2}=\frac{\widetilde{A L}+\wideparen{L F}+\wideparen{P C}+\widetilde{C G}}{2}=\frac{\widehat{K L}+\widetilde{L B}+\widehat{B C}+\widetilde{C K}}{4}=90^{\circ} .
$$",2,"Let $\Gamma$ be the circumcircle of $\triangle ABC$. Let $F$ be a point on arc $\wideparen{AB}$ and $D$ be a point on segment $AB$ such that $F$ lies on the perpendicular bisector of $BD$. Let $K$ be the second intersection of line $FD$ with $\Gamma$. Prove that $\wideparen{AF} = \wideparen{BF} + \wideparen{AK}$ and $AK=AD$. Symmetrically, if $G$ is on arc $\wideparen{AC}$ and $E$ is on segment $AC$ such that $G$ is on the perpendicular bisector of $CE$, and $L$ is the second intersection of line $GE$ with $\Gamma$, then $\wideparen{AG} = \wideparen{CG} + \wideparen{AL}$ and $AL=AE$.","Since F is on the perpendicular bisector of BD, triangle FBD is isosceles with FB = FD, so $\angle FBD = \angle FDB$. By the inscribed angle theorem, $\angle FBD = \angle ABF = \frac{1}{2}\text{measure}(\wideparen{AF})$. By the formula for the angle of intersecting chords (or secants from an interior point), $\angle FDB = \frac{1}{2}(\text{measure}(\wideparen{BF}) + \text{measure}(\wideparen{AK}))$. Equating these gives $\wideparen{AF} = \wideparen{BF} + \wideparen{AK}$. For the second part, note that $\angle AKD = \angle AKF = \angle ABF$ (angles subtended by the same arc $\wideparen{AF}$), and $\angle ADK = \angle FDB$. Since $\angle ABF = \angle FDB$, we have $\angle AKD = \angle ADK$. Thus, triangle ADK is isosceles with $AK=AD$. The same argument applies symmetrically to points G, E, C and L, yielding $\wideparen{AG} = \wideparen{CG} + \wideparen{AL}$ and $AL=AE$.","Let $A B C$ be an acute-angled triangle with circumcircle $\Gamma$. Let $D$ and $E$ be points on the segments $A B$ and $A C$, respectively, such that $A D=A E$. The perpendicular bisectors of the segments $B D$ and $C E$ intersect the small arcs $\wideparen{A B}$ and $\widetilde{A C}$ at points $F$ and $G$ respectively. Prove that $D E \| F G$.","Let $P$ be the midpoint of the arc $\wideparen{BC}$ not containing $A$. The line $AP$ is the angle bisector of $\angle BAC$. Since $AD=AE$, $\triangle ADE$ is isosceles, so its angle bisector $AP$ is also an altitude, which means $AP \perp DE$. To prove $DE \| FG$, we can prove $AP \perp FG$. The chords $AP$ and $FG$ are perpendicular if the sum of the arcs they intercept is $180^\circ$, i.e., $\text{measure}(\wideparen{AF}) + \text{measure}(\wideparen{PG}) = 180^\circ$. The entire circle measures $360^\circ = (\wideparen{AF} + \wideparen{PG}) + (\wideparen{AG} + \wideparen{FP})$. So, it is sufficient to prove $\wideparen{AF} + \wideparen{PG} = \wideparen{AG} + \wideparen{FP}$. As $P$ is the midpoint of arc $\wideparen{BC}$, $\wideparen{PB} = \wideparen{PC}$. The equality is then equivalent to $\wideparen{AF} + \wideparen{CG} = \wideparen{AG} + \wideparen{BF}$. Using the results from the first sub-problem and the given $AD=AE$, we have $\wideparen{AK} = \wideparen{AL}$. Substituting $\wideparen{AF} = \wideparen{BF} + \wideparen{AK}$ and $\wideparen{AG} = \wideparen{CG} + \wideparen{AL}$ into the desired equality gives $(\wideparen{BF} + \wideparen{AK}) + \wideparen{CG} = (\wideparen{CG} + \wideparen{AL}) + \wideparen{BF}$, which is true since $\wideparen{AK} = \wideparen{AL}$. Thus $AP \perp FG$, and therefore $DE \| FG$.",,,,
2018g2,"Let $A B C$ be a triangle with $A B=A C$, and let $M$ be the midpoint of $B C$. Let $P$ be a point such that $P B<P C$ and $P A$ is parallel to $B C$. Let $X$ and $Y$ be points on the lines $P B$ and $P C$, respectively, so that $B$ lies on the segment $P X, C$ lies on the segment $P Y$, and $\angle P X M=\angle P Y M$. Prove that the quadrilateral $A P X Y$ is cyclic.","Since $A B=A C, A M$ is the perpendicular bisector of $B C$, hence $\angle P A M=$ $\angle A M C=90^{\circ}$.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_323b76634e0bd94edb63g-40}

Now let $Z$ be the common point of $A M$ and the perpendicular through $Y$ to $P C$ (notice that $Z$ lies on to the ray $A M$ beyond $M$ ). We have $\angle P A Z=\angle P Y Z=90^{\circ}$. Thus the points $P, A, Y$, and $Z$ are concyclic.

Since $\angle C M Z=\angle C Y Z=90^{\circ}$, the quadrilateral $C Y Z M$ is cyclic, hence $\angle C Z M=$ $\angle C Y M$. By the condition in the statement, $\angle C Y M=\angle B X M$, and, by symmetry in $Z M$, $\angle C Z M=\angle B Z M$. Therefore, $\angle B X M=\angle B Z M$. It follows that the points $B, X, Z$, and $M$ are concyclic, hence $\angle B X Z=180^{\circ}-\angle B M Z=90^{\circ}$.

Finally, we have $\angle P X Z=\angle P Y Z=\angle P A Z=90^{\circ}$, hence the five points $P, A, X, Y, Z$ are concyclic. In particular, the quadrilateral $A P X Y$ is cyclic, as required.",2,Let $Z$ be the point of intersection of the line $AM$ and the line perpendicular to $PC$ at $Y$. Prove that $\angle PXZ = 90^{\circ}$.,"Since $AM$ is the perpendicular bisector of $BC$, $\angle CMZ=90^\circ$. By definition of $Z$, $\angle CYZ=90^\circ$. Thus, quadrilateral $CYZM$ is cyclic, which implies $\angle CZM = \angle CYM$. By the problem statement, $\angle CYM = \angle PYM = \angle PXM = \angle BXM$. By symmetry with respect to the line $AM$ (which contains $Z$), $\angle CZM = \angle BZM$. Therefore, we have $\angle BXM = \angle BZM$. This implies that the quadrilateral $BXZM$ is cyclic. In cyclic quadrilateral $BXZM$, opposite angles sum to $180^\circ$, so $\angle BXZ = 180^\circ - \angle BMZ$. Since $AM \perp BC$, $\angle BMZ = 90^\circ$. Thus, $\angle PXZ = 90^\circ$.",Prove that the quadrilateral $APXY$ is cyclic.,"Let $Z$ be the point of intersection of the line $AM$ and the line perpendicular to $PC$ at $Y$. From the previous sub-problem, we have established that $\angle PXZ = 90^\circ$. By the definition of $Z$, $\angle PYZ = 90^\circ$. Since $PA \parallel BC$ and $AM \perp BC$, it follows that $PA \perp AM$. As $Z$ lies on the line $AM$, we have $\angle PAZ = 90^\circ$. The points $A$, $X$, and $Y$ all subtend a right angle with the segment $PZ$ (i.e., $\angle PAZ = \angle PXZ = \angle PYZ = 90^\circ$). This means $A$, $X$, and $Y$ all lie on the circle with diameter $PZ$. Therefore, the points $P, A, X, Y$ are concyclic, which proves that the quadrilateral $APXY$ is cyclic.",,,,
2018g4,"A point $T$ is chosen inside a triangle $A B C$. Let $A_{1}, B_{1}$, and $C_{1}$ be the reflections of $T$ in $B C, C A$, and $A B$, respectively. Let $\Omega$ be the circumcircle of the triangle $A_{1} B_{1} C_{1}$. The lines $A_{1} T, B_{1} T$, and $C_{1} T$ meet $\Omega$ again at $A_{2}, B_{2}$, and $C_{2}$, respectively. Prove that the lines $A A_{2}, B B_{2}$, and $C C_{2}$ are concurrent on $\Omega$.","Solution. By $\Varangle(\ell, n)$ we always mean the directed angle of the lines $\ell$ and $n$, taken modulo $180^{\circ}$.\\
Let $C C_{2}$ meet $\Omega$ again at $K$ (as usual, if $C C_{2}$ is tangent to $\Omega$, we set $T=C_{2}$ ). We show that the line $B B_{2}$ contains $K$; similarly, $A A_{2}$ will also pass through $K$. For this purpose, it suffices to prove that


\begin{equation*}
\Varangle\left(C_{2} C, C_{2} A_{1}\right)=\Varangle\left(B_{2} B, B_{2} A_{1}\right) . \tag{1}
\end{equation*}


By the problem condition, $C B$ and $C A$ are the perpendicular bisectors of $T A_{1}$ and $T B_{1}$, respectively. Hence, $C$ is the circumcentre of the triangle $A_{1} T B_{1}$. Therefore,

$$
\Varangle\left(C A_{1}, C B\right)=\Varangle(C B, C T)=\Varangle\left(B_{1} A_{1}, B_{1} T\right)=\Varangle\left(B_{1} A_{1}, B_{1} B_{2}\right) .
$$

In circle $\Omega$ we have $\Varangle\left(B_{1} A_{1}, B_{1} B_{2}\right)=\Varangle\left(C_{2} A_{1}, C_{2} B_{2}\right)$. Thus,


\begin{equation*}
\Varangle\left(C A_{1}, C B\right)=\Varangle\left(B_{1} A_{1}, B_{1} B_{2}\right)=\Varangle\left(C_{2} A_{1}, C_{2} B_{2}\right) . \tag{2}
\end{equation*}


Similarly, we get


\begin{equation*}
\Varangle\left(B A_{1}, B C\right)=\Varangle\left(C_{1} A_{1}, C_{1} C_{2}\right)=\Varangle\left(B_{2} A_{1}, B_{2} C_{2}\right) . \tag{3}
\end{equation*}


The two obtained relations yield that the triangles $A_{1} B C$ and $A_{1} B_{2} C_{2}$ are similar and equioriented, hence

$$
\frac{A_{1} B_{2}}{A_{1} B}=\frac{A_{1} C_{2}}{A_{1} C} \quad \text { and } \quad \Varangle\left(A_{1} B, A_{1} C\right)=\Varangle\left(A_{1} B_{2}, A_{1} C_{2}\right) \text {. }
$$

The second equality may be rewritten as $\Varangle\left(A_{1} B, A_{1} B_{2}\right)=\Varangle\left(A_{1} C, A_{1} C_{2}\right)$, so the triangles $A_{1} B B_{2}$ and $A_{1} C C_{2}$ are also similar and equioriented. This establishes (1).\\
\includegraphics[max width=\textwidth, center]{2025_04_29_323b76634e0bd94edb63g-44}

Comment 1. In fact, the triangle $A_{1} B C$ is an image of $A_{1} B_{2} C_{2}$ under a spiral similarity centred at $A_{1}$; in this case, the triangles $A B B_{2}$ and $A C C_{2}$ are also spirally similar with the same centre.

Comment 2. After obtaining (2) and (3), one can finish the solution in different ways.\\
For instance, introducing the point $X=B C \cap B_{2} C_{2}$, one gets from these relations that the 4 -tuples $\left(A_{1}, B, B_{2}, X\right)$ and $\left(A_{1}, C, C_{2}, X\right)$ are both cyclic. Therefore, $K$ is the Miquel point of the lines $B B_{2}$, $C C_{2}, B C$, and $B_{2} C_{2}$; this yields that the meeting point of $B B_{2}$ and $C C_{2}$ lies on $\Omega$.

Yet another way is to show that the points $A_{1}, B, C$, and $K$ are concyclic, as

$$
\Varangle\left(K C, K A_{1}\right)=\Varangle\left(B_{2} C_{2}, B_{2} A_{1}\right)=\Varangle\left(B C, B A_{1}\right) .
$$

By symmetry, the second point $K^{\prime}$ of intersection of $B B_{2}$ with $\Omega$ is also concyclic to $A_{1}, B$, and $C$, hence $K^{\prime}=K$.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_323b76634e0bd94edb63g-45}

Comment 3. The requirement that the common point of the lines $A A_{2}, B B_{2}$, and $C C_{2}$ should lie on $\Omega$ may seem to make the problem easier, since it suggests some approaches. On the other hand, there are also different ways of showing that the lines $A A_{2}, B B_{2}$, and $C C_{2}$ are just concurrent.

In particular, the problem conditions yield that the lines $A_{2} T, B_{2} T$, and $C_{2} T$ are perpendicular to the corresponding sides of the triangle $A B C$. One may show that the lines $A T, B T$, and $C T$ are also perpendicular to the corresponding sides of the triangle $A_{2} B_{2} C_{2}$, i.e., the triangles $A B C$ and $A_{2} B_{2} C_{2}$ are orthologic, and their orthology centres coincide. It is known that such triangles are also perspective, i.e. the lines $A A_{2}, B B_{2}$, and $C C_{2}$ are concurrent (in projective sense).

To show this mutual orthology, one may again apply angle chasing, but there are also other methods. Let $A^{\prime}, B^{\prime}$, and $C^{\prime}$ be the projections of $T$ onto the sides of the triangle $A B C$. Then $A_{2} T \cdot T A^{\prime}=$ $B_{2} T \cdot T B^{\prime}=C_{2} T \cdot T C^{\prime}$, since all three products equal (minus) half the power of $T$ with respect to $\Omega$. This means that $A_{2}, B_{2}$, and $C_{2}$ are the poles of the sidelines of the triangle $A B C$ with respect to some circle centred at $T$ and having pure imaginary radius (in other words, the reflections of $A_{2}, B_{2}$, and $C_{2}$ in $T$ are the poles of those sidelines with respect to some regular circle centred at $T$ ). Hence, dually, the vertices of the triangle $A B C$ are also the poles of the sidelines of the triangle $A_{2} B_{2} C_{2}$.",4,Let $A_1$ and $B_1$ be the reflections of a point $T$ across lines $BC$ and $AC$ respectively. Prove that vertex $C$ is the circumcenter of the triangle $TA_1B_1$.,"By the definition of reflection, any point on the line of reflection is equidistant from the original point and its image. Since $A_1$ is the reflection of $T$ across the line $BC$, and $C$ is a point on $BC$, we have $CT = CA_1$. Similarly, since $B_1$ is the reflection of $T$ across the line $AC$, and $C$ is on $AC$, we have $CT = CB_1$. Therefore, $CT = CA_1 = CB_1$, which proves that $C$ is the circumcenter of triangle $TA_1B_1$.","Using directed angles modulo $180^{\circ}$, prove the equalities $\Varangle(CA_1, CB) = \Varangle(C_2A_1, C_2B_2)$ and $\Varangle(BA_1, BC) = \Varangle(B_2A_1, B_2C_2)$.","Since $C$ is the circumcenter of $\triangle TA_1B_1$ (from Sub-problem 1), and $BC$ is the perpendicular bisector of $TA_1$, $CB$ is the angle bisector of $\angle TCA_1$. Thus, $\Varangle(CA_1, CB) = \Varangle(CB, CT)$. From the circle through $T, A_1, B_1$ centered at $C$, we have $\Varangle(CB, CT) = \Varangle(B_1A_1, B_1T)$. As $B_1, T, B_2$ are collinear, $\Varangle(B_1A_1, B_1T) = \Varangle(B_1A_1, B_1B_2)$. Since $A_1, B_1, B_2, C_2$ are concyclic on $\Omega$, $\Varangle(B_1A_1, B_1B_2) = \Varangle(C_2A_1, C_2B_2)$. Chaining these equalities gives the first result. The second equality follows by a symmetrical argument for vertex B.","Show that $\triangle A_1BC$ and $\triangle A_1B_2C_2$ are similar and equioriented, and deduce that $\Varangle(C_2C, C_2A_1) = \Varangle(B_2B, B_2A_1)$.","From the previous step, we have $\Varangle(BC, A_1C) = \Varangle(B_2C_2, A_1C_2)$ and $\Varangle(A_1B, BC) = \Varangle(A_1B_2, B_2C_2)$. Summing these gives $\Varangle(A_1B, A_1C) = \Varangle(A_1B_2, A_1C_2)$. The angle equalities at all three vertices show that $\triangle A_1BC$ and $\triangle A_1B_2C_2$ are similar and equioriented. This implies a spiral similarity centered at $A_1$. Thus, $\triangle A_1BB_2$ is also similar to $\triangle A_1CC_2$. Equating corresponding angles gives $\Varangle(A_1B_2B) = \Varangle(A_1C_2C)$, which is equivalent to $\Varangle(B_2B, B_2A_1) = \Varangle(C_2C, C_2A_1)$.","A point $T$ is chosen inside a triangle $A B C$. Let $A_{1}, B_{1}$, and $C_{1}$ be the reflections of $T$ in $B C, C A$, and $A B$, respectively. Let $\Omega$ be the circumcircle of the triangle $A_{1} B_{1} C_{1}$. The lines $A_{1} T, B_{1} T$, and $C_{1} T$ meet $\Omega$ again at $A_{2}, B_{2}$, and $C_{2}$, respectively. Prove that the lines $A A_{2}, B B_{2}$, and $C C_{2}$ are concurrent on $\Omega$.","Let $K$ be the second intersection of the line $CC_2$ with the circle $\Omega$. To prove concurrency, we show that $K$ also lies on line $BB_2$. Since $A_1, B_2, C_2, K$ are on $\Omega$, the inscribed angle theorem gives $\Varangle(KC_2, C_2A_1) = \Varangle(KB_2, B_2A_1)$. From the previous sub-problem, we know $\Varangle(C_2C, C_2A_1) = \Varangle(B_2B, B_2A_1)$. Since line $C_2C$ is the same as line $KC_2$, we can equate the expressions to get $\Varangle(KB_2, B_2A_1) = \Varangle(B_2B, B_2A_1)$. This implies that the lines $KB_2$ and $BB_2$ are the same. Thus, $K$ lies on $BB_2$. By symmetry, $K$ must also lie on $AA_2$. Therefore, the lines $AA_2, BB_2, CC_2$ are concurrent at point $K$ on $\Omega$."
2018g5,"Let $A B C$ be a triangle with circumcircle $\omega$ and incentre $I$. A line $\ell$ intersects the lines $A I, B I$, and $C I$ at points $D, E$, and $F$, respectively, distinct from the points $A, B, C$, and $I$. The perpendicular bisectors $x, y$, and $z$ of the segments $A D, B E$, and $C F$, respectively determine a triangle $\Theta$. Show that the circumcircle of the triangle $\Theta$ is tangent to $\omega$.","Preamble. Let $X=y \cap z, Y=x \cap z, Z=x \cap y$ and let $\Omega$ denote the circumcircle of the triangle $X Y Z$. Denote by $X_{0}, Y_{0}$, and $Z_{0}$ the second intersection points of $A I, B I$ and $C I$, respectively, with $\omega$. It is known that $Y_{0} Z_{0}$ is the perpendicular bisector of $A I, Z_{0} X_{0}$ is the perpendicular bisector of $B I$, and $X_{0} Y_{0}$ is the perpendicular bisector of $C I$. In particular, the triangles $X Y Z$ and $X_{0} Y_{0} Z_{0}$ are homothetic, because their corresponding sides are parallel.

The solutions below mostly exploit the following approach. Consider the triangles $X Y Z$ and $X_{0} Y_{0} Z_{0}$, or some other pair of homothetic triangles $\Delta$ and $\delta$ inscribed into $\Omega$ and $\omega$, respectively. In order to prove that $\Omega$ and $\omega$ are tangent, it suffices to show that the centre $T$ of the homothety taking $\Delta$ to $\delta$ lies on $\omega$ (or $\Omega$ ), or, in other words, to show that $\Delta$ and $\delta$ are perspective (i.e., the lines joining corresponding vertices are concurrent), with their perspector lying on $\omega$ (or $\Omega$ ).

We use directed angles throughout all the solutions.

Claim 1. The reflections $\ell_{a}, \ell_{b}$ and $\ell_{c}$ of the line $\ell$ in the lines $x, y$, and $z$, respectively, are concurrent at a point $T$ which belongs to $\omega$.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_323b76634e0bd94edb63g-46}

Proof. Notice that $\Varangle\left(\ell_{b}, \ell_{c}\right)=\Varangle\left(\ell_{b}, \ell\right)+\Varangle\left(\ell, \ell_{c}\right)=2 \Varangle(y, \ell)+2 \Varangle(\ell, z)=2 \Varangle(y, z)$. But $y \perp B I$ and $z \perp C I$ implies $\Varangle(y, z)=\Varangle(B I, I C)$, so, since $2 \Varangle(B I, I C)=\Varangle(B A, A C)$, we obtain


\begin{equation*}
\Varangle\left(\ell_{b}, \ell_{c}\right)=\Varangle(B A, A C) . \tag{1}
\end{equation*}


Since $A$ is the reflection of $D$ in $x, A$ belongs to $\ell_{a}$; similarly, $B$ belongs to $\ell_{b}$. Then (1) shows that the common point $T^{\prime}$ of $\ell_{a}$ and $\ell_{b}$ lies on $\omega$; similarly, the common point $T^{\prime \prime}$ of $\ell_{c}$ and $\ell_{b}$ lies on $\omega$.

If $B \notin \ell_{a}$ and $B \notin \ell_{c}$, then $T^{\prime}$ and $T^{\prime \prime}$ are the second point of intersection of $\ell_{b}$ and $\omega$, hence they coincide. Otherwise, if, say, $B \in \ell_{c}$, then $\ell_{c}=B C$, so $\Varangle(B A, A C)=\Varangle\left(\ell_{b}, \ell_{c}\right)=\Varangle\left(\ell_{b}, B C\right)$, which shows that $\ell_{b}$ is tangent at $B$ to $\omega$ and $T^{\prime}=T^{\prime \prime}=B$. So $T^{\prime}$ and $T^{\prime \prime}$ coincide in all the cases, and the conclusion of the claim follows.

Now we prove that $X, X_{0}, T$ are collinear. Denote by $D_{b}$ and $D_{c}$ the reflections of the point $D$ in the lines $y$ and $z$, respectively. Then $D_{b}$ lies on $\ell_{b}, D_{c}$ lies on $\ell_{c}$, and

$$
\begin{aligned}
\Varangle\left(D_{b} X, X D_{c}\right) & =\Varangle\left(D_{b} X, D X\right)+\Varangle\left(D X, X D_{c}\right)=2 \Varangle(y, D X)+2 \Varangle(D X, z)=2 \Varangle(y, z) \\
& =\Varangle(B A, A C)=\Varangle(B T, T C),
\end{aligned}
$$

hence the quadrilateral $X D_{b} T D_{c}$ is cyclic. Notice also that since $X D_{b}=X D=X D_{c}$, the points $D, D_{b}, D_{c}$ lie on a circle with centre $X$. Using in this circle the diameter $D_{c} D_{c}^{\prime}$ yields $\Varangle\left(D_{b} D_{c}, D_{c} X\right)=90^{\circ}+\Varangle\left(D_{b} D_{c}^{\prime}, D_{c}^{\prime} X\right)=90^{\circ}+\Varangle\left(D_{b} D, D D_{c}\right)$. Therefore,

$$
\begin{gathered}
\Varangle\left(\ell_{b}, X T\right)=\Varangle\left(D_{b} T, X T\right)=\Varangle\left(D_{b} D_{c}, D_{c} X\right)=90^{\circ}+\Varangle\left(D_{b} D, D D_{c}\right) \\
=90^{\circ}+\Varangle(B I, I C)=\Varangle(B A, A I)=\Varangle\left(B A, A X_{0}\right)=\Varangle\left(B T, T X_{0}\right)=\Varangle\left(\ell_{b}, X_{0} T\right),
\end{gathered}
$$

so the points $X, X_{0}, T$ are collinear. By a similar argument, $Y, Y_{0}, T$ and $Z, Z_{0}, T$ are collinear. As mentioned in the preamble, the statement of the problem follows.",4,"Let $X_0, Y_0, Z_0$ be the second intersection points of lines $AI, BI, CI$ with the circumcircle $\omega$. Let $\Theta=XYZ$ be the triangle formed by the perpendicular bisectors $x, y, z$ of segments $AD, BE, CF$ respectively, where $X = y \cap z, Y = z \cap x, Z = x \cap y$. Show that triangle $XYZ$ is homothetic to triangle $X_0Y_0Z_0$.","The line $x$, the perpendicular bisector of $AD$, is perpendicular to line $AI$. It is a known property that the line $Y_0Z_0$ is the perpendicular bisector of the segment $AI$, so it is also perpendicular to $AI$. Therefore, $x$ is parallel to $Y_0Z_0$. Similarly, $y \parallel Z_0X_0$ and $z \parallel X_0Y_0$. The sides of $\triangle XYZ$ lie on lines $x,y,z$. Since the corresponding sides of $\triangle XYZ$ and $\triangle X_0Y_0Z_0$ are parallel, the two triangles are homothetic.","Let $\\ell_a, \\ell_b, \\ell_c$ be the reflections of the line $\\ell$ in the lines $x, y, z$, respectively. Show that these three lines are concurrent at a point $T$ which lies on the circumcircle $\\omega$.","Using directed angles, the angle between reflections $\\ell_b$ and $\\ell_c$ is $\\Varangle(\\ell_b, \\ell_c) = 2\\Varangle(y, z)$. Since $y \\perp BI$ and $z \\perp CI$, this angle is $2\\Varangle(BI, CI)$, which is equal to the known identity $\\Varangle(BA, AC)$. By definition of reflection, point $A$ is on $\\ell_a$, $B$ on $\\ell_b$, and $C$ on $\\ell_c$. The condition $\\Varangle(\\ell_b, \\ell_c) = \\Varangle(BA, AC)$ implies that the intersection of $\\ell_b$ and $\\ell_c$ lies on $\\omega$. By symmetry, the intersection of any pair of these lines lies on $\\omega$. Assuming the lines are not parallel, they must concur at a single point $T$ on $\\omega$.","Let $T$ be the point of concurrence of $\\ell_a, \\ell_b, \\ell_c$. Show that $T$ is the perspector of triangles $XYZ$ and $X_0Y_0Z_0$, meaning the lines $XX_0, YY_0, ZZ_0$ all pass through $T$.","We prove the collinearity of $X, X_0, T$; the others follow by symmetry. Let $D_b$ and $D_c$ be the reflections of point $D$ in lines $y$ and $z$. The points $X, D_b, T, D_c$ are concyclic. Through a chain of directed angle equalities, we can establish that $\\Varangle(\\ell_b, XT) = \\Varangle(\\ell_b, X_0T)$. This is achieved by showing $\\Varangle(\\ell_b, XT) = 90^\\circ + \\Varangle(BI, CI) = \\Varangle(BA, AI) = \\Varangle(BT, TX_0) = \\Varangle(\\ell_b, TX_0)$. This equality of angles proves that $X, T, X_0$ are collinear.",Let $\\Omega$ be the circumcircle of triangle $\\Theta=XYZ$. Show that $\\Omega$ is tangent to the circumcircle $\\omega$ of triangle $ABC$.,"From sub-problem 1, $\triangle XYZ$ and $\triangle X_0Y_0Z_0$ are homothetic. From sub-problem 3, the lines joining corresponding vertices, $XX_0, YY_0, ZZ_0$, concur at point $T$. Therefore, $T$ is the center of the homothety that maps $\triangle X_0Y_0Z_0$ to $\triangle XYZ$. This homothety also maps the circumcircle of $\triangle X_0Y_0Z_0$, which is $\\omega$, to the circumcircle of $\triangle XYZ$, which is $\\Omega$. From sub-problem 2, the center of homothety $T$ lies on $\\omega$. When the center of a homothety mapping one circle to another lies on the first circle, the circles must be tangent at that center. Thus, $\\Omega$ and $\\omega$ are tangent at $T$."
2018g6,A convex quadrilateral $A B C D$ satisfies $A B \cdot C D=B C \cdot D A$. A point $X$ is chosen inside the quadrilateral so that $\angle X A B=\angle X C D$ and $\angle X B C=\angle X D A$. Prove that $\angle A X B+$ $\angle C X D=180^{\circ}$.,"Let $B^{\prime}$ be the reflection of $B$ in the internal angle bisector of $\angle A X C$, so that $\angle A X B^{\prime}=\angle C X B$ and $\angle C X B^{\prime}=\angle A X B$. If $X, D$, and $B^{\prime}$ are collinear, then we are done. Now assume the contrary.

On the ray $X B^{\prime}$ take a point $E$ such that $X E \cdot X B=X A \cdot X C$, so that $\triangle A X E \sim$ $\triangle B X C$ and $\triangle C X E \sim \triangle B X A$. We have $\angle X C E+\angle X C D=\angle X B A+\angle X A B<180^{\circ}$ and $\angle X A E+\angle X A D=\angle X D A+\angle X A D<180^{\circ}$, which proves that $X$ lies inside the angles $\angle E C D$ and $\angle E A D$ of the quadrilateral $E A D C$. Moreover, $X$ lies in the interior of exactly one of the two triangles $E A D, E C D$ (and in the exterior of the other).\\
\includegraphics[max width=\textwidth, center]{2025_04_29_323b76634e0bd94edb63g-50}

The similarities mentioned above imply $X A \cdot B C=X B \cdot A E$ and $X B \cdot C E=X C \cdot A B$. Multiplying these equalities with the given equality $A B \cdot C D=B C \cdot D A$, we obtain $X A \cdot C D$. $C E=X C \cdot A D \cdot A E$, or, equivalently,


\begin{equation*}
\frac{X A \cdot D E}{A D \cdot A E}=\frac{X C \cdot D E}{C D \cdot C E} . \tag{*}
\end{equation*}


Lemma. Let $P Q R$ be a triangle, and let $X$ be a point in the interior of the angle $Q P R$ such that $\angle Q P X=\angle P R X$. Then $\frac{P X \cdot Q R}{P Q \cdot P R}<1$ if and only if $X$ lies in the interior of the triangle $P Q R$.\\
Proof. The locus of points $X$ with $\angle Q P X=\angle P R X$ lying inside the angle $Q P R$ is an arc $\alpha$ of the circle $\gamma$ through $R$ tangent to $P Q$ at $P$. Let $\gamma$ intersect the line $Q R$ again at $Y$ (if $\gamma$ is tangent to $Q R$, then set $Y=R$ ). The similarity $\triangle Q P Y \sim \triangle Q R P$ yields $P Y=\frac{P Q \cdot P R}{Q R}$. Now it suffices to show that $P X<P Y$ if and only if $X$ lies in the interior of the triangle $P Q R$. Let $m$ be a line through $Y$ parallel to $P Q$. Notice that the points $Z$ of $\gamma$ satisfying $P Z<P Y$ are exactly those between the lines $m$ and $P Q$.

Case 1: $Y$ lies in the segment $Q R$ (see the left figure below).\\
In this case $Y$ splits $\alpha$ into two arcs $\widehat{P Y}$ and $\widehat{Y R}$. The arc $\widehat{P Y}$ lies inside the triangle $P Q R$, and $\wideparen{P Y}$ lies between $m$ and $P Q$, hence $P X<P Y$ for points $X \in \widetilde{P Y}$. The other $\operatorname{arc} \widehat{Y R}$ lies outside triangle $P Q R$, and $\overline{Y R}$ is on the opposite side of $m$ than $P$, hence $P X>P Y$ for $X \in \widehat{Y R}$.

Case 2: $Y$ lies on the ray $Q R$ beyond $R$ (see the right figure below).\\
In this case the whole arc $\alpha$ lies inside triangle $P Q R$, and between $m$ and $P Q$, thus $P X<$ $P Y$ for all $X \in \alpha$.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_323b76634e0bd94edb63g-51}

Applying the Lemma (to $\triangle E A D$ with the point $X$, and to $\triangle E C D$ with the point $X$ ), we obtain that exactly one of two expressions $\frac{X A \cdot D E}{A D \cdot A E}$ and $\frac{X C \cdot D E}{C D \cdot C E}$ is less than 1 , which contradicts (*).",4,"Assume $\\angle AXB + \\angle CXD \neq 180^\\circ$. Let $B'$ be the reflection of $B$ across the angle bisector of $\\angle AXC$, so $X, D, B'$ are not collinear. Construct a point $E$ on the ray $XB'$ such that $XE \\cdot XB = XA \\cdot XC$. Prove that this implies $\triangle AXE \\sim \triangle BXC$ and $\triangle CXE \\sim \triangle BXA$, and consequently that $\\angle XAE = \\angle XDA$ and $\\angle XEC = \\angle XCD$.","By construction, $XA/XB = XE/XC$. Since $E$ is on ray $XB'$ and $B'$ is the reflection of $B$ across the angle bisector of $\\angle AXC$, we have $\\angle AXE = \\angle AXB' = \\angle CXB$. Thus, by SAS similarity, $\triangle AXE \\sim \triangle BXC$. This implies $XC/XE = XB/XA$ and $\\angle CXE = \\angle BXA$ (since they are corresponding angles in a spiral similarity around $X$). Thus, $\triangle CXE \\sim \triangle BXA$. From these similarities and the problem's given angle conditions: $\\angle XAE = \\angle XBC = \\angle XDA$, and $\\angle XEC = \\angle XAB = \\angle XCD$.","Using the similarities from Sub-problem 1 ($\triangle AXE \sim \triangle BXC$ and $\triangle CXE \sim \triangle BXA$) and the given condition $AB \\cdot CD = BC \\cdot DA$, prove the equality $\frac{XA \\cdot DE}{AD \\cdot AE} = \frac{XC \\cdot DE}{CD \\cdot CE}$.","From $\triangle AXE \\sim \triangle BXC$, we get $AE/BC = XA/XB$, which gives $XA \\cdot BC = XB \\cdot AE$. From $\triangle CXE \\sim \triangle BXA$, we get $CE/AB = XC/XB$, which gives $XB \\cdot CE = XC \\cdot AB$. Multiplying these gives $XA \\cdot BC \\cdot CE = XC \\cdot AE \\cdot AB$. The given condition $AB \\cdot CD = BC \\cdot DA$ can be written as $BC/AB = DA/CD$. Substituting this into the previous equation gives $XA \\cdot (DA/CD) \\cdot CE = XC \\cdot AE$. This rearranges to $XA \\cdot DA \\cdot CE = XC \\cdot AE \\cdot CD$, which is equivalent to $\frac{XA}{AE \\cdot AD} = \frac{XC}{CE \\cdot CD}$. Multiplying both sides by $DE$ gives the desired equality.",Let $PQR$ be a triangle and $X$ be a point in the interior of $\\angle QPR$ such that $\\angle QPX = \\angle PRX$. Prove that $X$ lies in the interior of $\triangle PQR$ if and only if $\frac{PX \\cdot QR}{PQ \\cdot PR} < 1$.,"The locus of points $X$ satisfying the angle condition is an arc of a circle $\\gamma$ through $R$ and tangent to $PQ$ at $P$. Let $\\gamma$ intersect line $QR$ at $Y$ (other than $R$). The similarity $\triangle QPY \\sim \triangle QRP$ gives $PY/RP = PQ/QR$, which means $PY = \frac{PQ \\cdot PR}{QR}$. The inequality is thus equivalent to $PX < PY$. A geometric analysis on the position of $Y$ with respect to the segment $QR$ shows that $X$ lies on the arc segment inside $\triangle PQR$ if and only if $PX < PY$.",A convex quadrilateral $A B C D$ satisfies $A B \\cdot C D=B C \\cdot D A$. A point $X$ is chosen inside the quadrilateral so that $\\angle X A B=\\angle X C D$ and $\\angle X B C=\\angle X D A$. Prove that $\\angle A X B+\\angle C X D=180^{\\circ}$.,"Assume, for contradiction, that $\\angle AXB + \\angle CXD \neq 180^\\circ$. Following the construction in Sub-problem 1, we established angle equalities $\\angle XAE = \\angle XDA$ and $\\angle XEC = \\angle XCD$. Sub-problem 2 gives the equality $\frac{XA \\cdot DE}{AD \\cdot AE} = \frac{XC \\cdot DE}{CD \\cdot CE}$. Point $X$ lies inside quadrilateral $EADC$, so it must lie inside exactly one of $\triangle EAD$ or $\triangle ECD$. Applying Sub-problem 3 to $\triangle ADE$ (using $\\angle XAE = \\angle XDA$) and to $\triangle CDE$ (using $\\angle XEC = \\angle XCD$), we find that being inside one triangle but not the other means exactly one of the expressions $\frac{XA \\cdot DE}{AE \\cdot AD}$ and $\frac{XC \\cdot DE}{CD \\cdot CE}$ is less than 1. This contradicts their established equality. The assumption is false, so $\\angle AXB + \\angle CXD = 180^\\circ$."
2018g7,"Let $O$ be the circumcentre, and $\Omega$ be the circumcircle of an acute-angled triangle $A B C$. Let $P$ be an arbitrary point on $\Omega$, distinct from $A, B, C$, and their antipodes in $\Omega$. Denote the circumcentres of the triangles $A O P, B O P$, and $C O P$ by $O_{A}, O_{B}$, and $O_{C}$, respectively. The lines $\ell_{A}, \ell_{B}$, and $\ell_{C}$ perpendicular to $B C, C A$, and $A B$ pass through $O_{A}, O_{B}$, and $O_{C}$, respectively. Prove that the circumcircle of the triangle formed by $\ell_{A}, \ell_{B}$, and $\ell_{C}$ is tangent to the line $O P$.","Solution. As usual, we denote the directed angle between the lines $a$ and $b$ by $\Varangle(a, b)$. We frequently use the fact that $a_{1} \perp a_{2}$ and $b_{1} \perp b_{2}$ yield $\Varangle\left(a_{1}, b_{1}\right)=\Varangle\left(a_{2}, b_{2}\right)$.

Let the lines $\ell_{B}$ and $\ell_{C}$ meet at $L_{A}$; define the points $L_{B}$ and $L_{C}$ similarly. Note that the sidelines of the triangle $L_{A} L_{B} L_{C}$ are perpendicular to the corresponding sidelines of $A B C$. Points $O_{A}, O_{B}, O_{C}$ are located on the corresponding sidelines of $L_{A} L_{B} L_{C}$; moreover, $O_{A}, O_{B}$, $O_{C}$ all lie on the perpendicular bisector of $O P$.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_323b76634e0bd94edb63g-54}

Claim 1. The points $L_{B}, P, O_{A}$, and $O_{C}$ are concyclic.\\
Proof. Since $O$ is symmetric to $P$ in $O_{A} O_{C}$, we have

$$
\Varangle\left(O_{A} P, O_{C} P\right)=\Varangle\left(O_{C} O, O_{A} O\right)=\Varangle(C P, A P)=\Varangle(C B, A B)=\Varangle\left(O_{A} L_{B}, O_{C} L_{B}\right) .
$$

Denote the circle through $L_{B}, P, O_{A}$, and $O_{C}$ by $\omega_{B}$. Define the circles $\omega_{A}$ and $\omega_{C}$ similarly.\\
Claim 2. The circumcircle of the triangle $L_{A} L_{B} L_{C}$ passes through $P$.\\
Proof. From cyclic quadruples of points in the circles $\omega_{B}$ and $\omega_{C}$, we have

$$
\begin{aligned}
\Varangle\left(L_{C} L_{A}, L_{C} P\right) & =\Varangle\left(L_{C} O_{B}, L_{C} P\right)=\Varangle\left(O_{A} O_{B}, O_{A} P\right) \\
& =\Varangle\left(O_{A} O_{C}, O_{A} P\right)=\Varangle\left(L_{B} O_{C}, L_{B} P\right)=\Varangle\left(L_{B} L_{A}, L_{B} P\right) .
\end{aligned}
$$

Claim 3. The points $P, L_{C}$, and $C$ are collinear.\\
Proof. We have $\Varangle\left(P L_{C}, L_{C} L_{A}\right)=\Varangle\left(P L_{C}, L_{C} O_{B}\right)=\Varangle\left(P O_{A}, O_{A} O_{B}\right)$. Further, since $O_{A}$ is the centre of the circle $A O P, \Varangle\left(P O_{A}, O_{A} O_{B}\right)=\Varangle(P A, A O)$. As $O$ is the circumcentre of the triangle $P C A, \Varangle(P A, A O)=\pi / 2-\Varangle(C A, C P)=\Varangle\left(C P, L_{C} L_{A}\right)$. We obtain $\Varangle\left(P L_{C}, L_{C} L_{A}\right)=$ $\Varangle\left(C P, L_{C} L_{A}\right)$, which shows that $P \in C L_{C}$.

Similarly, the points $P, L_{A}, A$ are collinear, and the points $P, L_{B}, B$ are also collinear. Finally, the computation above also shows that

$$
\Varangle\left(O P, P L_{A}\right)=\Varangle(P A, A O)=\Varangle\left(P L_{C}, L_{C} L_{A}\right),
$$

which means that $O P$ is tangent to the circle $P L_{A} L_{B} L_{C}$.

Comment 1. The proof of Claim 2 may be replaced by the following remark: since $P$ belongs to the circles $\omega_{A}$ and $\omega_{C}, P$ is the Miquel point of the four lines $\ell_{A}, \ell_{B}, \ell_{C}$, and $O_{A} O_{B} O_{C}$.

Comment 2. Claims 2 and 3 can be proved in several different ways and, in particular, in the reverse order.

Claim 3 implies that the triangles $A B C$ and $L_{A} L_{B} L_{C}$ are perspective with perspector $P$. Claim 2 can be derived from this observation using spiral similarity. Consider the centre $Q$ of the spiral similarity that maps $A B C$ to $L_{A} L_{B} L_{C}$. From known spiral similarity properties, the points $L_{A}, L_{B}, P, Q$ are concyclic, and so are $L_{A}, L_{C}, P, Q$.

Comment 3. The final conclusion can also be proved it terms of spiral similarity: the spiral similarity with centre $Q$ located on the circle $A B C$ maps the circle $A B C$ to the circle $P L_{A} L_{B} L_{C}$. Thus these circles are orthogonal.

Comment 4. Notice that the homothety with centre $O$ and ratio 2 takes $O_{A}$ to $A^{\prime}$ that is the common point of tangents to $\Omega$ at $A$ and $P$. Similarly, let this homothety take $O_{B}$ to $B^{\prime}$ and $O_{C}$ to $C^{\prime}$. Let the tangents to $\Omega$ at $B$ and $C$ meet at $A^{\prime \prime}$, and define the points $B^{\prime \prime}$ and $C^{\prime \prime}$ similarly. Now, replacing labels $O$ with $I, \Omega$ with $\omega$, and swapping labels $A \leftrightarrow A^{\prime \prime}, B \leftrightarrow B^{\prime \prime}, C \leftrightarrow C^{\prime \prime}$ we obtain the following

Reformulation. Let $\omega$ be the incircle, and let $I$ be the incentre of a triangle $A B C$. Let $P$ be a point of $\omega$ (other than the points of contact of $\omega$ with the sides of $A B C$ ). The tangent to $\omega$ at $P$ meets the lines $A B, B C$, and $C A$ at $A^{\prime}, B^{\prime}$, and $C^{\prime}$, respectively. Line $\ell_{A}$ parallel to the internal angle bisector of $\angle B A C$ passes through $A^{\prime}$; define lines $\ell_{B}$ and $\ell_{C}$ similarly. Prove that the line $I P$ is tangent to the circumcircle of the triangle formed by $\ell_{A}, \ell_{B}$, and $\ell_{C}$.

Though this formulation is equivalent to the original one, it seems more challenging, since the point of contact is now ""hidden"".",1,"Let $O$ be the circumcentre, and $\Omega$ be the circumcircle of an acute-angled triangle $A B C$. Let $P$ be an arbitrary point on $\Omega$, distinct from $A, B, C$, and their antipodes in $\Omega$. Denote the circumcentres of the triangles $A O P, B O P$, and $C O P$ by $O_{A}, O_{B}$, and $O_{C}$, respectively. The lines $\ell_{A}, \ell_{B}$, and $\ell_{C}$ perpendicular to $B C, C A$, and $A B$ pass through $O_{A}, O_{B}$, and $O_{C}$, respectively. Prove that the circumcircle of the triangle formed by $\ell_{A}, \ell_{B}$, and $\ell_{C}$ is tangent to the line $O P$.","Solution. As usual, we denote the directed angle between the lines $a$ and $b$ by $\Varangle(a, b)$. We frequently use the fact that $a_{1} \perp a_{2}$ and $b_{1} \perp b_{2}$ yield $\Varangle\left(a_{1}, b_{1}\right)=\Varangle\left(a_{2}, b_{2}\right)$.

Let the lines $\ell_{B}$ and $\ell_{C}$ meet at $L_{A}$; define the points $L_{B}$ and $L_{C}$ similarly. Note that the sidelines of the triangle $L_{A} L_{B} L_{C}$ are perpendicular to the corresponding sidelines of $A B C$. Points $O_{A}, O_{B}, O_{C}$ are located on the corresponding sidelines of $L_{A} L_{B} L_{C}$; moreover, $O_{A}, O_{B}$, $O_{C}$ all lie on the perpendicular bisector of $O P$.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_323b76634e0bd94edb63g-54}

Claim 1. The points $L_{B}, P, O_{A}$, and $O_{C}$ are concyclic.\\
Proof. Since $O$ is symmetric to $P$ in $O_{A} O_{C}$, we have

$$
\Varangle\left(O_{A} P, O_{C} P\right)=\Varangle\left(O_{C} O, O_{A} O\right)=\Varangle(C P, A P)=\Varangle(C B, A B)=\Varangle\left(O_{A} L_{B}, O_{C} L_{B}\right) .
$$

Denote the circle through $L_{B}, P, O_{A}$, and $O_{C}$ by $\omega_{B}$. Define the circles $\omega_{A}$ and $\omega_{C}$ similarly.\\
Claim 2. The circumcircle of the triangle $L_{A} L_{B} L_{C}$ passes through $P$.\\
Proof. From cyclic quadruples of points in the circles $\omega_{B}$ and $\omega_{C}$, we have

$$
\begin{aligned}
\Varangle\left(L_{C} L_{A}, L_{C} P\right) & =\Varangle\left(L_{C} O_{B}, L_{C} P\right)=\Varangle\left(O_{A} O_{B}, O_{A} P\right) \\
& =\Varangle\left(O_{A} O_{C}, O_{A} P\right)=\Varangle\left(L_{B} O_{C}, L_{B} P\right)=\Varangle\left(L_{B} L_{A}, L_{B} P\right) .
\end{aligned}
$$

Claim 3. The points $P, L_{C}$, and $C$ are collinear.\\
Proof. We have $\Varangle\left(P L_{C}, L_{C} L_{A}\right)=\Varangle\left(P L_{C}, L_{C} O_{B}\right)=\Varangle\left(P O_{A}, O_{A} O_{B}\right)$. Further, since $O_{A}$ is the centre of the circle $A O P, \Varangle\left(P O_{A}, O_{A} O_{B}\right)=\Varangle(P A, A O)$. As $O$ is the circumcentre of the triangle $P C A, \Varangle(P A, A O)=\pi / 2-\Varangle(C A, C P)=\Varangle\left(C P, L_{C} L_{A}\right)$. We obtain $\Varangle\left(P L_{C}, L_{C} L_{A}\right)=$ $\Varangle\left(C P, L_{C} L_{A}\right)$, which shows that $P \in C L_{C}$.

Similarly, the points $P, L_{A}, A$ are collinear, and the points $P, L_{B}, B$ are also collinear. Finally, the computation above also shows that

$$
\Varangle\left(O P, P L_{A}\right)=\Varangle(P A, A O)=\Varangle\left(P L_{C}, L_{C} L_{A}\right),
$$

which means that $O P$ is tangent to the circle $P L_{A} L_{B} L_{C}$.

Comment 1. The proof of Claim 2 may be replaced by the following remark: since $P$ belongs to the circles $\omega_{A}$ and $\omega_{C}, P$ is the Miquel point of the four lines $\ell_{A}, \ell_{B}, \ell_{C}$, and $O_{A} O_{B} O_{C}$.

Comment 2. Claims 2 and 3 can be proved in several different ways and, in particular, in the reverse order.

Claim 3 implies that the triangles $A B C$ and $L_{A} L_{B} L_{C}$ are perspective with perspector $P$. Claim 2 can be derived from this observation using spiral similarity. Consider the centre $Q$ of the spiral similarity that maps $A B C$ to $L_{A} L_{B} L_{C}$. From known spiral similarity properties, the points $L_{A}, L_{B}, P, Q$ are concyclic, and so are $L_{A}, L_{C}, P, Q$.

Comment 3. The final conclusion can also be proved it terms of spiral similarity: the spiral similarity with centre $Q$ located on the circle $A B C$ maps the circle $A B C$ to the circle $P L_{A} L_{B} L_{C}$. Thus these circles are orthogonal.

Comment 4. Notice that the homothety with centre $O$ and ratio 2 takes $O_{A}$ to $A^{\prime}$ that is the common point of tangents to $\Omega$ at $A$ and $P$. Similarly, let this homothety take $O_{B}$ to $B^{\prime}$ and $O_{C}$ to $C^{\prime}$. Let the tangents to $\Omega$ at $B$ and $C$ meet at $A^{\prime \prime}$, and define the points $B^{\prime \prime}$ and $C^{\prime \prime}$ similarly. Now, replacing labels $O$ with $I, \Omega$ with $\omega$, and swapping labels $A \leftrightarrow A^{\prime \prime}, B \leftrightarrow B^{\prime \prime}, C \leftrightarrow C^{\prime \prime}$ we obtain the following

Reformulation. Let $\omega$ be the incircle, and let $I$ be the incentre of a triangle $A B C$. Let $P$ be a point of $\omega$ (other than the points of contact of $\omega$ with the sides of $A B C$ ). The tangent to $\omega$ at $P$ meets the lines $A B, B C$, and $C A$ at $A^{\prime}, B^{\prime}$, and $C^{\prime}$, respectively. Line $\ell_{A}$ parallel to the internal angle bisector of $\angle B A C$ passes through $A^{\prime}$; define lines $\ell_{B}$ and $\ell_{C}$ similarly. Prove that the line $I P$ is tangent to the circumcircle of the triangle formed by $\ell_{A}, \ell_{B}$, and $\ell_{C}$.

Though this formulation is equivalent to the original one, it seems more challenging, since the point of contact is now ""hidden"".",,,,,,
2018n2,"Let $n>1$ be a positive integer. Each cell of an $n \times n$ table contains an integer. Suppose that the following conditions are satisfied:\\
(i) Each number in the table is congruent to 1 modulo $n$;\\
(ii) The sum of numbers in any row, as well as the sum of numbers in any column, is congruent to $n$ modulo $n^{2}$.

Let $R_{i}$ be the product of the numbers in the $i^{\text {th }}$ row, and $C_{j}$ be the product of the numbers in the $j^{\text {th }}$ column. Prove that the sums $R_{1}+\cdots+R_{n}$ and $C_{1}+\cdots+C_{n}$ are congruent modulo $n^{4}$.","Let $A_{i, j}$ be the entry in the $i^{\text {th }}$ row and the $j^{\text {th }}$ column; let $P$ be the product of all $n^{2}$ entries. For convenience, denote $a_{i, j}=A_{i, j}-1$ and $r_{i}=R_{i}-1$. We show that


\begin{equation*}
\sum_{i=1}^{n} R_{i} \equiv(n-1)+P \quad\left(\bmod n^{4}\right) \tag{1}
\end{equation*}


Due to symmetry of the problem conditions, the sum of all the $C_{j}$ is also congruent to $(n-1)+P$ modulo $n^{4}$, whence the conclusion.

By condition $(i)$, the number $n$ divides $a_{i, j}$ for all $i$ and $j$. So, every product of at least two of the $a_{i, j}$ is divisible by $n^{2}$, hence\\
$R_{i}=\prod_{j=1}^{n}\left(1+a_{i, j}\right)=1+\sum_{j=1}^{n} a_{i, j}+\sum_{1 \leqslant j_{1}<j_{2} \leqslant n} a_{i, j_{1}} a_{i, j_{2}}+\cdots \equiv 1+\sum_{j=1}^{n} a_{i, j} \equiv 1-n+\sum_{j=1}^{n} A_{i, j} \quad\left(\bmod n^{2}\right)$\\
for every index $i$. Using condition $(i i)$, we obtain $R_{i} \equiv 1\left(\bmod n^{2}\right)$, and so $n^{2} \mid r_{i}$.\\
Therefore, every product of at least two of the $r_{i}$ is divisible by $n^{4}$. Repeating the same argument, we obtain

$$
P=\prod_{i=1}^{n} R_{i}=\prod_{i=1}^{n}\left(1+r_{i}\right) \equiv 1+\sum_{i=1}^{n} r_{i} \quad\left(\bmod n^{4}\right)
$$

whence

$$
\sum_{i=1}^{n} R_{i}=n+\sum_{i=1}^{n} r_{i} \equiv n+(P-1) \quad\left(\bmod n^{4}\right)
$$

as desired.",2,"Let $A_{i,j}$ be the entry in the $i$-th row and $j$-th column. Let $R_i = \prod_{j=1}^n A_{i,j}$ be the product of the numbers in the $i$-th row, and $P = \prod_{i=1}^n \prod_{j=1}^n A_{i,j}$ be the product of all numbers in the table. Show that $\sum_{i=1}^{n} R_{i} \equiv n-1+P \pmod{n^{4}}$.","Let $A_{i,j} = 1 + a_{i,j}$. By condition (i), $n \mid a_{i,j}$. Thus, any product of two or more $a_{i,j}$'s is divisible by $n^2$. We have $R_i = \prod_{j=1}^n(1+a_{i,j}) \equiv 1 + \sum_{j=1}^n a_{i,j} \pmod{n^2}$. The sum is $\sum_{j=1}^n a_{i,j} = (\sum_{j=1}^n A_{i,j}) - n$. By condition (ii), $\sum_{j=1}^n A_{i,j} \equiv n \pmod{n^2}$, so $\sum_{j=1}^n a_{i,j} \equiv n-n = 0 \pmod{n^2}$. Therefore, $R_i \equiv 1 \pmod{n^2}$. Let $R_i = 1+r_i$, where $n^2 \mid r_i$. This implies that any product of two or more $r_i$'s is divisible by $n^4$. The product of all entries is $P = \prod_{i=1}^n R_i = \prod_{i=1}^n(1+r_i) \equiv 1 + \sum_{i=1}^n r_i \pmod{n^4}$. This gives $\sum_{i=1}^n r_i \equiv P-1 \pmod{n^4}$. Finally, we have $\sum_{i=1}^n R_i = \sum_{i=1}^n (1+r_i) = n + \sum_{i=1}^n r_i \equiv n + (P-1) = n-1+P \pmod{n^4}$.","Let $n>1$ be a positive integer. Each cell of an $n \times n$ table contains an integer. Suppose that the following conditions are satisfied:\n(i) Each number in the table is congruent to 1 modulo $n$;\n(ii) The sum of numbers in any row, as well as the sum of numbers in any column, is congruent to $n$ modulo $n^{2}$.\nLet $R_{i}$ be the product of the numbers in the $i^{\text {th }}$ row, and $C_{j}$ be the product of the numbers in the $j^{\text {th }}$ column. Prove that the sums $R_{1}+\cdots+R_{n}$ and $C_{1}+\cdots+C_{n}$ are congruent modulo $n^{4}$.","Let $P$ be the product of all $n^2$ entries in the table. From the previous sub-problem, we have established that $\sum_{i=1}^{n} R_{i} \equiv n-1+P \pmod{n^{4}}$. The problem conditions (i) and (ii) are symmetric with respect to rows and columns. Thus, by applying the same logic from the first sub-problem to the columns instead of the rows, we can derive an analogous result for the sum of column products. This gives $\sum_{j=1}^{n} C_{j} \equiv n-1+P \pmod{n^{4}}$. Since both $\sum_{i=1}^{n} R_{i}$ and $\sum_{j=1}^{n} C_{j}$ are congruent to the same quantity, $n-1+P$, modulo $n^4$, they must be congruent to each other. Therefore, $\sum_{i=1}^{n} R_{i} \equiv \sum_{j=1}^{n} C_{j} \pmod{n^{4}}$.",,,,
2018n3,"Define the sequence $a_{0}, a_{1}, a_{2}, \ldots$ by $a_{n}=2^{n}+2^{\lfloor n / 2\rfloor}$. Prove that there are infinitely many terms of the sequence which can be expressed as a sum of (two or more) distinct terms of the sequence, as well as infinitely many of those which cannot be expressed in such a way.","Call a nonnegative integer representable if it equals the sum of several (possibly 0 or 1) distinct terms of the sequence. We say that two nonnegative integers $b$ and $c$ are equivalent (written as $b \sim c$ ) if they are either both representable or both non-representable.

One can easily compute

$$
S_{n-1}:=a_{0}+\cdots+a_{n-1}=2^{n}+2^{\lceil n / 2\rceil}+2^{\lfloor n / 2\rfloor}-3
$$

Indeed, we have $S_{n}-S_{n-1}=2^{n}+2^{\lfloor n / 2\rfloor}=a_{n}$ so we can use the induction. In particular, $S_{2 k-1}=2^{2 k}+2^{k+1}-3$.

Note that, if $n \geqslant 3$, then $2^{[n / 2\rceil} \geqslant 2^{2}>3$, so

$$
S_{n-1}=2^{n}+2^{\lceil n / 2\rceil}+2^{\lfloor n / 2\rfloor}-3>2^{n}+2^{\lfloor n / 2\rfloor}=a_{n}
$$

Also notice that $S_{n-1}-a_{n}=2^{[n / 2]}-3<a_{n}$.\\
The main tool of the solution is the following claim.\\
Claim 1. Assume that $b$ is a positive integer such that $S_{n-1}-a_{n}<b<a_{n}$ for some $n \geqslant 3$. Then $b \sim S_{n-1}-b$.\\
Proof. As seen above, we have $S_{n-1}>a_{n}$. Denote $c=S_{n-1}-b$; then $S_{n-1}-a_{n}<c<a_{n}$, so the roles of $b$ and $c$ are symmetrical.

Assume that $b$ is representable. The representation cannot contain $a_{i}$ with $i \geqslant n$, since $b<a_{n}$. So $b$ is the sum of some subset of $\left\{a_{0}, a_{1}, \ldots, a_{n-1}\right\}$; then $c$ is the sum of the complement. The converse is obtained by swapping $b$ and $c$.

We also need the following version of this claim.\\
Claim 2. For any $n \geqslant 3$, the number $a_{n}$ can be represented as a sum of two or more distinct terms of the sequence if and only if $S_{n-1}-a_{n}=2^{[n / 2]}-3$ is representable.\\
Proof. Denote $c=S_{n-1}-a_{n}<a_{n}$. If $a_{n}$ satisfies the required condition, then it is the sum of some subset of $\left\{a_{0}, a_{1}, \ldots, a_{n-1}\right\}$; then $c$ is the sum of the complement. Conversely, if $c$ is representable, then its representation consists only of the numbers from $\left\{a_{0}, \ldots, a_{n-1}\right\}$, so $a_{n}$ is the sum of the complement.

By Claim 2, in order to prove the problem statement, it suffices to find infinitely many representable numbers of the form $2^{t}-3$, as well as infinitely many non-representable ones.\\
Claim 3. For every $t \geqslant 3$, we have $2^{t}-3 \sim 2^{4 t-6}-3$, and $2^{4 t-6}-3>2^{t}-3$.\\
Proof. The inequality follows from $t \geqslant 3$. In order to prove the equivalence, we apply Claim 1 twice in the following manner.

First, since $S_{2 t-3}-a_{2 t-2}=2^{t-1}-3<2^{t}-3<2^{2 t-2}+2^{t-1}=a_{2 t-2}$, by Claim 1 we have $2^{t}-3 \sim S_{2 t-3}-\left(2^{t}-3\right)=2^{2 t-2}$.

Second, since $S_{4 t-7}-a_{4 t-6}=2^{2 t-3}-3<2^{2 t-2}<2^{4 t-6}+2^{2 t-3}=a_{4 t-6}$, by Claim 1 we have $2^{2 t-2} \sim S_{4 t-7}-2^{2 t-2}=2^{4 t-6}-3$.

Therefore, $2^{t}-3 \sim 2^{2 t-2} \sim 2^{4 t-6}-3$, as required.\\
Now it is easy to find the required numbers. Indeed, the number $2^{3}-3=5=a_{0}+a_{1}$ is representable, so Claim 3 provides an infinite sequence of representable numbers

$$
2^{3}-3 \sim 2^{6}-3 \sim 2^{18}-3 \sim \cdots \sim 2^{t}-3 \sim 2^{4 t-6}-3 \sim \cdots
$$

On the other hand, the number $2^{7}-3=125$ is non-representable (since by Claim 1 we have $125 \sim S_{6}-125=24 \sim S_{4}-24=17 \sim S_{3}-17=4$ which is clearly non-representable). So Claim 3 provides an infinite sequence of non-representable numbers

$$
2^{7}-3 \sim 2^{22}-3 \sim 2^{82}-3 \sim \cdots \sim 2^{t}-3 \sim 2^{4 t-6}-3 \sim \cdots
$$",4,"Let $S_{k} = \sum_{i=0}^{k} a_i$. First, find a closed-form expression for $S_{n-1}$. Second, show that for $n \ge 3$, if an integer $b$ satisfies $S_{n-1} - a_n < b < a_n$, then $b$ can be written as a sum of distinct terms from $\{a_0, ..., a_{n-1}\}$ if and only if $S_{n-1} - b$ can be.","A proof by induction shows that $S_{n-1} = 2^n + 2^{\lceil n/2\rceil} + 2^{\lfloor n/2\rfloor} - 3$. For $n \ge 3$, we have $S_{n-1} - a_n = 2^{\lceil n/2\rceil} - 3 > 0$, so $a_n < S_{n-1}$. If $b$ is a sum of a subset of terms from $\{a_0, \dots, a_{n-1}\}$, then $S_{n-1}-b$ is the sum of the terms in the complementary subset. Since $b < a_n$, any representation of $b$ as a sum of distinct terms of the sequence can only use terms from $\{a_0, \dots, a_{n-1}\}$. The same holds for $S_{n-1}-b$ because $S_{n-1}-b > S_{n-1}-a_n > 0$. The equivalence follows.","Let an integer be 'representable' if it is a sum of distinct terms from the sequence $\{a_i\}$. Show that for $n \ge 3$, the term $a_n$ can be expressed as a sum of two or more distinct terms of the sequence if and only if the number $2^{\lceil n/2 \rceil} - 3$ is representable.","A term $a_n$ is a sum of two or more other distinct terms if and only if it is a sum of a subset of $\{a_0, \dots, a_{n-1}\}$. This is equivalent to $S_{n-1} - a_n$ being representable by a sum of terms from the complementary subset. As $a_n < S_{n-1}$, the complement is non-empty. Using the formula from sub-problem 1, $S_{n-1} - a_n = (2^n + 2^{\lceil n/2\rceil} + 2^{\lfloor n/2\rfloor} - 3) - (2^n + 2^{\lfloor n/2\rfloor}) = 2^{\lceil n/2\rceil} - 3$. As $a_n$ is strictly greater than any $a_i$ for $i<n$, its representation must involve at least two terms. Thus, the condition is equivalent to $2^{\lceil n/2\rceil} - 3$ being representable.","Let 'representable' mean being a sum of distinct terms of the sequence $\{a_i\}$. Prove that for any integer $t \ge 3$, the number $2^t - 3$ is representable if and only if the number $2^{4t-6} - 3$ is representable.","We use the property from sub-problem 1 twice. First, for $n=2t-2$ (and $t \ge 3$), we have $S_{2t-3}-a_{2t-2} = 2^{t-1}-3 < 2^t-3 < a_{2t-2}$. Thus, $2^t-3$ is representable if and only if $S_{2t-3}-(2^t-3) = 2^{2t-2}$ is representable. Second, for $n=4t-6$, we have $S_{4t-7}-a_{4t-6} = 2^{2t-3}-3 < 2^{2t-2} < a_{4t-6}$. Thus, $2^{2t-2}$ is representable if and only if $S_{4t-7}-2^{2t-2} = 2^{4t-6}-3$ is representable. Combining these two equivalences proves the claim.","Prove that there are infinitely many terms of the sequence $a_{n}=2^{n}+2^{\lfloor n / 2\rfloor}$ which can be expressed as a sum of (two or more) distinct terms of the sequence, as well as infinitely many of those which cannot be expressed in such a way.","By sub-problem 2, this is equivalent to finding infinitely many integers $t$ for which $2^t-3$ is representable, and infinitely many for which it is not. Sub-problem 3 provides a map $f(t)=4t-6$ which preserves representability and satisfies $f(t)>t$ for $t>2$. This allows generating infinite sequences with the same representability property from a single seed. 
1. Representable terms: For $t=3$, $2^3-3=5$. Since $a_0+a_1=2+3=5$, $5$ is representable. The sequence $t_0=3, t_{k+1}=f(t_k)$ yields an infinite sequence of $t$ values for which $2^t-3$ is representable, corresponding to an infinite set of representable terms $a_n$ (e.g., those with $\lceil n/2\rceil=t_k$).
2. Non-representable terms: For $t=7$, $2^7-3=125$. Using sub-problem 1, $125$ is representable iff $S_6-125=24$ is, which is representable iff $S_4-24=17$ is, which is representable iff $S_3-17=4$ is. Since the terms of the sequence are $2, 3, 5, \dots$, $4$ is not representable as a sum of distinct terms. Thus, $125$ is not representable. The sequence $t_0=7, t_{k+1}=f(t_k)$ gives an infinite sequence of non-representable numbers $2^{t_k}-3$, corresponding to an infinite set of non-representable terms $a_n$."
2018n4,"Let $a_{1}, a_{2}, \ldots, a_{n}, \ldots$ be a sequence of positive integers such that

$$
\frac{a_{1}}{a_{2}}+\frac{a_{2}}{a_{3}}+\cdots+\frac{a_{n-1}}{a_{n}}+\frac{a_{n}}{a_{1}}
$$

is an integer for all $n \geqslant k$, where $k$ is some positive integer. Prove that there exists a positive integer $m$ such that $a_{n}=a_{n+1}$ for all $n \geqslant m$.","The argument hinges on the following two facts: Let $a, b, c$ be positive integers such that $N=b / c+(c-b) / a$ is an integer.\\
(1) If $\operatorname{gcd}(a, c)=1$, then $c$ divides $b$; and\\
(2) If $\operatorname{gcd}(a, b, c)=1$, then $\operatorname{gcd}(a, b)=1$.

To prove (1), write $a b=c(a N+b-c)$. Since $\operatorname{gcd}(a, c)=1$, it follows that $c$ divides $b$. To prove (2), write $c^{2}-b c=a(c N-b)$ to infer that $a$ divides $c^{2}-b c$. Letting $d=\operatorname{gcd}(a, b)$, it follows that $d$ divides $c^{2}$, and since the two are relatively prime by hypothesis, $d=1$.

Now, let $s_{n}=a_{1} / a_{2}+a_{2} / a_{3}+\cdots+a_{n-1} / a_{n}+a_{n} / a_{1}$, let $\delta_{n}=\operatorname{gcd}\left(a_{1}, a_{n}, a_{n+1}\right)$ and write

$$
s_{n+1}-s_{n}=\frac{a_{n}}{a_{n+1}}+\frac{a_{n+1}-a_{n}}{a_{1}}=\frac{a_{n} / \delta_{n}}{a_{n+1} / \delta_{n}}+\frac{a_{n+1} / \delta_{n}-a_{n} / \delta_{n}}{a_{1} / \delta_{n}} .
$$

Let $n \geqslant k$. Since $\operatorname{gcd}\left(a_{1} / \delta_{n}, a_{n} / \delta_{n}, a_{n+1} / \delta_{n}\right)=1$, it follows by (2) that $\operatorname{gcd}\left(a_{1} / \delta_{n}, a_{n} / \delta_{n}\right)=1$. Let $d_{n}=\operatorname{gcd}\left(a_{1}, a_{n}\right)$. Then $d_{n}=\delta_{n} \cdot \operatorname{gcd}\left(a_{1} / \delta_{n}, a_{n} / \delta_{n}\right)=\delta_{n}$, so $d_{n}$ divides $a_{n+1}$, and therefore $d_{n}$ divides $d_{n+1}$.

Consequently, from some rank on, the $d_{n}$ form a nondecreasing sequence of integers not exceeding $a_{1}$, so $d_{n}=d$ for all $n \geqslant \ell$, where $\ell$ is some positive integer.

Finally, since $\operatorname{gcd}\left(a_{1} / d, a_{n+1} / d\right)=1$, it follows by (1) that $a_{n+1} / d$ divides $a_{n} / d$, so $a_{n} \geqslant a_{n+1}$ for all $n \geqslant \ell$. The conclusion follows.",2,"Let $a, b, c$ be positive integers such that $N = \frac{b}{c} + \frac{c-b}{a}$ is an integer. Prove that: (1) If $\operatorname{gcd}(a, c) = 1$, then $c$ divides $b$. (2) If $\operatorname{gcd}(a, b, c) = 1$, then $\operatorname{gcd}(a, b) = 1$.","To prove (1), we rewrite the equation as $aN = ab/c + c - b$, which gives $c(aN + b - c) = ab$. Since $c$ divides the left side and $\operatorname{gcd}(a, c) = 1$, it follows that $c$ must divide $b$. To prove (2), rewrite the equation as $a(cN - b) = c^2 - bc$. This implies that $a$ divides $c^2 - bc$. Let $d = \operatorname{gcd}(a, b)$. Then $d$ divides $a$ and $b$, so $d$ must divide $c^2$. Since $d$ is a common divisor of $a$ and $b$, and $\operatorname{gcd}(a, b, c) = 1$, it follows that $\operatorname{gcd}(d, c) = 1$. As $d$ divides $c^2$ and is coprime to $c$, we must have $d=1$, which means $\operatorname{gcd}(a, b) = 1$.","Let $a_{1}, a_{2}, \ldots, a_{n}, \ldots$ be a sequence of positive integers such that $\frac{a_{1}}{a_{2}}+\frac{a_{2}}{a_{3}}+\cdots+\frac{a_{n-1}}{a_{n}}+\frac{a_{n}}{a_{1}}$ is an integer for all $n \geqslant k$, where $k$ is some positive integer. Prove that there exists a positive integer $m$ such that $a_{n}=a_{n+1}$ for all $n \geqslant m$.","Let $s_n$ be the given sum. For $n \ge k$, the difference $s_{n+1} - s_n = \frac{a_n}{a_{n+1}} + \frac{a_{n+1}-a_n}{a_1}$ is an integer. Let $d_n = \operatorname{gcd}(a_1, a_n)$. Applying the results from the first sub-problem to $a=a_1, b=a_n, c=a_{n+1}$ (after dividing all terms by $\delta_n = \operatorname{gcd}(a_1, a_n, a_{n+1})$), we first deduce from part (2) that $d_n = \delta_n$. This implies $d_n$ divides $a_{n+1}$. Since $d_n$ also divides $a_1$, it must divide $d_{n+1} = \operatorname{gcd}(a_1, a_{n+1})$. Thus, $(d_n)_{n \ge k}$ is a non-decreasing sequence of integers bounded by $a_1$, so it must be eventually constant, say $d_n=d$ for $n \ge \ell$. For $n \ge \ell$, we have $\operatorname{gcd}(a_1/d, a_{n+1}/d)=1$. Applying part (1) of the first sub-problem to $a=a_1/d, b=a_n/d, c=a_{n+1}/d$, we find that $a_{n+1}/d$ divides $a_n/d$, which means $a_{n+1}$ divides $a_n$. Thus, for $n \ge \ell$, $(a_n)$ is a non-increasing sequence of positive integers. Such a sequence must eventually be constant. Therefore, there is an $m$ such that $a_n = a_{n+1}$ for all $n \ge m$.",,,,
2018n6,"Let $f:\{1,2,3, \ldots\} \rightarrow\{2,3, \ldots\}$ be a function such that $f(m+n) \mid f(m)+f(n)$ for all pairs $m, n$ of positive integers. Prove that there exists a positive integer $c>1$ which divides all values of $f$.","For every positive integer $m$, define $S_{m}=\{n: m \mid f(n)\}$.\\
Lemma. If the set $S_{m}$ is infinite, then $S_{m}=\{d, 2 d, 3 d, \ldots\}=d \cdot \mathbb{Z}_{>0}$ for some positive integer $d$.\\
Proof. Let $d=\min S_{m}$; the definition of $S_{m}$ yields $m \mid f(d)$.\\
Whenever $n \in S_{m}$ and $n>d$, we have $m|f(n)| f(n-d)+f(d)$, so $m \mid f(n-d)$ and therefore $n-d \in S_{m}$. Let $r \leqslant d$ be the least positive integer with $n \equiv r(\bmod d)$; repeating the same step, we can see that $n-d, n-2 d, \ldots, r \in S_{m}$. By the minimality of $d$, this shows $r=d$ and therefore $d \mid n$.

Starting from an arbitrarily large element of $S_{m}$, the process above reaches all multiples of $d$; so they all are elements of $S_{m}$.

The solution for the problem will be split into two cases.\\
Case 1: The function $f$ is bounded.\\
Call a prime $p$ frequent if the set $S_{p}$ is infinite, i.e., if $p$ divides $f(n)$ for infinitely many positive integers $n$; otherwise call $p$ sporadic. Since the function $f$ is bounded, there are only a finite number of primes that divide at least one $f(n)$; so altogether there are finitely many numbers $n$ such that $f(n)$ has a sporadic prime divisor. Let $N$ be a positive integer, greater than all those numbers $n$.

Let $p_{1}, \ldots, p_{k}$ be the frequent primes. By the lemma we have $S_{p_{i}}=d_{i} \cdot \mathbb{Z}_{>0}$ for some $d_{i}$. Consider the number

$$
n=N d_{1} d_{2} \cdots d_{k}+1
$$

Due to $n>N$, all prime divisors of $f(n)$ are frequent primes. Let $p_{i}$ be any frequent prime divisor of $f(n)$. Then $n \in S_{p_{i}}$, and therefore $d_{i} \mid n$. But $n \equiv 1\left(\bmod d_{i}\right)$, which means $d_{i}=1$. Hence $S_{p_{i}}=1 \cdot \mathbb{Z}_{>0}=\mathbb{Z}_{>0}$ and therefore $p_{i}$ is a common divisor of all values $f(n)$.

Case 2: $f$ is unbounded.\\
We prove that $f(1)$ divides all $f(n)$.\\
Let $a=f(1)$. Since $1 \in S_{a}$, by the lemma it suffices to prove that $S_{a}$ is an infinite set.\\
Call a positive integer $p$ a peak if $f(p)>\max (f(1), \ldots, f(p-1))$. Since $f$ is not bounded, there are infinitely many peaks. Let $1=p_{1}<p_{2}<\ldots$ be the sequence of all peaks, and let $h_{k}=f\left(p_{k}\right)$. Notice that for any peak $p_{i}$ and for any $k<p_{i}$, we have $f\left(p_{i}\right) \mid f(k)+f\left(p_{i}-k\right)<$ $2 f\left(p_{i}\right)$, hence


\begin{equation*}
f(k)+f\left(p_{i}-k\right)=f\left(p_{i}\right)=h_{i} \tag{1}
\end{equation*}


By the pigeonhole principle, among the numbers $h_{1}, h_{2}, \ldots$ there are infinitely many that are congruent modulo $a$. Let $k_{0}<k_{1}<k_{2}<\ldots$ be an infinite sequence of positive integers such that $h_{k_{0}} \equiv h_{k_{1}} \equiv \ldots(\bmod a)$. Notice that

$$
f\left(p_{k_{i}}-p_{k_{0}}\right)=f\left(p_{k_{i}}\right)-f\left(p_{k_{0}}\right)=h_{k_{i}}-h_{k_{0}} \equiv 0 \quad(\bmod a)
$$

so $p_{k_{i}}-p_{k_{0}} \in S_{a}$ for all $i=1,2, \ldots$. This provides infinitely many elements in $S_{a}$.\\
Hence, $S_{a}$ is an infinite set, and therefore $f(1)=a$ divides $f(n)$ for every $n$.

Comment. As an extension of the solution above, it can be proven that if $f$ is not bounded then $f(n)=a n$ with $a=f(1)$.

Take an arbitrary positive integer $n$; we will show that $f(n+1)=f(n)+a$. Then it follows by induction that $f(n)=a n$.

Take a peak $p$ such that $p>n+2$ and $h=f(p)>f(n)+2 a$. By (1) we have $f(p-1)=$ $f(p)-f(1)=h-a$ and $f(n+1)=f(p)-f(p-n-1)=h-f(p-n-1)$. From $h-a=f(p-1) \mid$ $f(n)+f(p-n-1)<f(n)+h<2(h-a)$ we get $f(n)+f(p-n-1)=h-a$. Then

$$
f(n+1)-f(n)=(h-f(p-n-1))-(h-a-f(p-n-1))=a
$$

On the other hand, there exists a wide family of bounded functions satisfying the required properties. Here we present a few examples:

$$
f(n)=c ; \quad f(n)=\left\{\begin{array}{ll}
2 c & \text { if } n \text { is even } \\
c & \text { if } n \text { is odd; }
\end{array} \quad f(n)= \begin{cases}2018 c & \text { if } n \leqslant 2018 \\
c & \text { if } n>2018\end{cases}\right.
$$",4,"Let $S_m = \{n \\in \\mathbb{Z}^+ : m \\mid f(n)\}$. Prove that if $S_m$ is infinite for some integer $m>1$, then there exists a positive integer $d$ such that $S_m = \{kd : k \\in \\mathbb{Z}^+\}$.","Let $d = \\min S_m$. First, we prove $S_m \\subseteq d\\mathbb{Z}^+$. Let $n \\in S_m$. If $n>d$, from the given property $f(n) = f(d+(n-d)) \\mid f(d) + f(n-d)$. Since $n \\in S_m$, $m \\mid f(n)$, so $m \\mid f(d) + f(n-d)$. As $d \\in S_m$, we have $m \\mid f(d)$, which implies $m \\mid f(n-d)$. Thus, $n-d \\in S_m$. Repeating this, any positive integer of the form $n-kd$ is in $S_m$. By the minimality of $d$, the smallest such positive integer must be $d$, so $n$ is a multiple of $d$. Next, we prove $d\\mathbb{Z}^+ \\subseteq S_m$ by induction on $k$. The base case $k=1$ holds as $d \\in S_m$. Assume $kd \\in S_m$. Then $m \\mid f(kd)$. We know $m \\mid f(d)$. From the property $f((k+1)d) = f(kd+d) \\mid f(kd)+f(d)$, it follows that $m \\mid f((k+1)d)$. Thus $(k+1)d \\in S_m$. By induction, $S_m = d\\mathbb{Z}^+$.","Prove that if the function $f$ is bounded, there exists a positive integer $c>1$ which divides all values of $f$.","Since $f$ is bounded, the set of all prime divisors of values of $f$ is finite. A prime $p$ is 'frequent' if $S_p=\{n : p \\mid f(n)\}$ is infinite, and 'sporadic' otherwise. As there are finitely many prime divisors in total, there are only a finite number of integers $n$ for which $f(n)$ has a sporadic prime divisor. Let $N$ be an integer greater than all such $n$. Let $p_1, \\ldots, p_k$ be the frequent primes. By Sub-problem 1, for each $i$, $S_{p_i} = d_i\\mathbb{Z}^+$ for some integer $d_i$. Consider $n = N \\cdot d_1 d_2 \\cdots d_k + 1$. For this $n > N$, any prime divisor of $f(n)$ must be frequent, say $p_j$. This means $n \\in S_{p_j}$, so $d_j \\mid n$. By construction, $n \\equiv 1 \\pmod{d_j}$, which forces $d_j=1$. Therefore, $S_{p_j} = \\mathbb{Z}^+$, meaning $p_j$ divides $f(m)$ for all $m \\in \\mathbb{Z}^+$. Let $c=p_j$. Since $f(m) > 1$ for all $m$, such a frequent prime must exist. As $c$ is prime, $c>1$.","Prove that if the function $f$ is unbounded, there exists a positive integer $c>1$ which divides all values of $f$.","Let $a = f(1)$. Since the codomain of $f$ is $\{2, 3, \\ldots\}$, we have $a > 1$. We will show that $a$ divides $f(n)$ for all $n$. Let $S_a = \{n : a \\mid f(n)\}$. As $1 \\in S_a$, by Sub-problem 1, it's sufficient to prove that $S_a$ is an infinite set. Since $f$ is unbounded, there is an infinite sequence of 'peaks' $1=p_1 < p_2 < \\dots$ where $f(p_k) > \\max_{j<p_k} f(j)$. For any peak $p_i$ and any $k<p_i$, we have $f(p_i) \\mid f(k)+f(p_i-k)$. Since $k, p_i-k < p_i$, we have $f(k), f(p_i-k) < f(p_i)$, so $f(k)+f(p_i-k) < 2f(p_i)$. This implies $f(k)+f(p_i-k) = f(p_i)$. Let $h_k = f(p_k)$. By the pigeonhole principle, there is an infinite subsequence of indices $\{k_i\}_{i=0}^\\infty$ such that $h_{k_i}$ are all congruent modulo $a$. For any $i>0$, since $p_{k_i} > p_{k_0}$, the peak property gives $f(p_{k_i}-p_{k_0}) = f(p_{k_i}) - f(p_{k_0}) = h_{k_i} - h_{k_0}$. As $h_{k_i} \\equiv h_{k_0} \\pmod a$, we get $a \\mid f(p_{k_i}-p_{k_0})$. This implies $\{p_{k_i}-p_{k_0} \\mid i=1,2,\\dots\}$ is an infinite set of elements in $S_a$, so $S_a$ is infinite.","Let $f:\\{1,2,3, \\ldots\\} \rightarrow\\{2,3, \\ldots\\}$ be a function such that $f(m+n) \\mid f(m)+f(n)$ for all pairs $m, n$ of positive integers. Prove that there exists a positive integer $c>1$ which divides all values of $f$.","Any function $f: \\mathbb{Z}^+ \rightarrow \\{2,3,\\ldots\\}$ is either bounded or unbounded. Case 1: $f$ is bounded. As proven in Sub-problem 2, there exists a positive integer $c>1$ which divides all values of $f$. Case 2: $f$ is unbounded. As proven in Sub-problem 3, $c=f(1)$ divides all values of $f$. Since the codomain of $f$ is $\\{2, 3, \\ldots\\}$, we have $c = f(1) > 1$. In both cases, the existence of such an integer $c>1$ is established, which completes the proof."
2018n7,"Let $n \geqslant 2018$ be an integer, and let $a_{1}, a_{2}, \ldots, a_{n}, b_{1}, b_{2}, \ldots, b_{n}$ be pairwise distinct positive integers not exceeding $5 n$. Suppose that the sequence


\begin{equation*}
\frac{a_{1}}{b_{1}}, \frac{a_{2}}{b_{2}}, \ldots, \frac{a_{n}}{b_{n}} \tag{1}
\end{equation*}


forms an arithmetic progression. Prove that the terms of the sequence are equal.","Solution. Suppose that (1) is an arithmetic progression with nonzero difference. Let the difference be $\Delta=\frac{c}{d}$, where $d>0$ and $c, d$ are coprime.

We will show that too many denominators $b_{i}$ should be divisible by $d$. To this end, for any $1 \leqslant i \leqslant n$ and any prime divisor $p$ of $d$, say that the index $i$ is $p$-wrong, if $v_{p}\left(b_{i}\right)<v_{p}(d) .\left(v_{p}(x)\right.$ stands for the exponent of $p$ in the prime factorisation of $x$.)\\
Claim 1. For any prime $p$, all $p$-wrong indices are congruent modulo $p$. In other words, the $p$-wrong indices (if they exist) are included in an arithmetic progression with difference $p$.\\
Proof. Let $\alpha=v_{p}(d)$. For the sake of contradiction, suppose that $i$ and $j$ are $p$-wrong indices (i.e., none of $b_{i}$ and $b_{j}$ is divisible by $\left.p^{\alpha}\right)$ such that $i \not \equiv j(\bmod p)$. Then the least common denominator of $\frac{a_{i}}{b_{i}}$ and $\frac{a_{j}}{b_{j}}$ is not divisible by $p^{\alpha}$. But this is impossible because in their difference, $(i-j) \Delta=\frac{(i-j) c}{d}$, the numerator is coprime to $p$, but $p^{\alpha}$ divides the denominator $d$.

Claim 2. $d$ has no prime divisors greater than 5 .\\
Proof. Suppose that $p \geqslant 7$ is a prime divisor of $d$. Among the indices $1,2, \ldots, n$, at most $\left\lceil\frac{n}{p}\right\rceil<\frac{n}{p}+1$ are $p$-wrong, so $p$ divides at least $\frac{p-1}{p} n-1$ of $b_{1}, \ldots, b_{n}$. Since these denominators are distinct,

$$
5 n \geqslant \max \left\{b_{i}: p \mid b_{i}\right\} \geqslant\left(\frac{p-1}{p} n-1\right) p=(p-1)(n-1)-1 \geqslant 6(n-1)-1>5 n
$$

a contradiction.\\
Claim 3. For every $0 \leqslant k \leqslant n-30$, among the denominators $b_{k+1}, b_{k+2}, \ldots, b_{k+30}$, at least $\varphi(30)=8$ are divisible by $d$.\\
Proof. By Claim 1, the 2 -wrong, 3 -wrong and 5 -wrong indices can be covered by three arithmetic progressions with differences 2,3 and 5 . By a simple inclusion-exclusion, $(2-1) \cdot(3-1) \cdot(5-1)=8$ indices are not covered; by Claim 2, we have $d \mid b_{i}$ for every uncovered index $i$.

Claim 4. $|\Delta|<\frac{20}{n-2}$ and $d>\frac{n-2}{20}$.\\
Proof. From the sequence (1), remove all fractions with $b_{n}<\frac{n}{2}$, There remain at least $\frac{n}{2}$ fractions, and they cannot exceed $\frac{5 n}{n / 2}=10$. So we have at least $\frac{n}{2}$ elements of the arithmetic progression (1) in the interval $(0,10]$, hence the difference must be below $\frac{10}{n / 2-1}=\frac{20}{n-2}$.

The second inequality follows from $\frac{1}{d} \leqslant \frac{|c|}{d}=|\Delta|$.\\
Now we have everything to get the final contradiction. By Claim 3, we have $d \mid b_{i}$ for at least $\left\lfloor\frac{n}{30}\right\rfloor$. 8 indices $i$. By Claim 4, we have $d \geqslant \frac{n-2}{20}$. Therefore,

$$
5 n \geqslant \max \left\{b_{i}: d \mid b_{i}\right\} \geqslant\left(\left\lfloor\frac{n}{30}\right\rfloor \cdot 8\right) \cdot d>\left(\frac{n}{30}-1\right) \cdot 8 \cdot \frac{n-2}{20}>5 n
$$

Comment 1. It is possible that all terms in (1) are equal, for example with $a_{i}=2 i-1$ and $b_{i}=4 i-2$ we have $\frac{a_{i}}{b_{i}}=\frac{1}{2}$.

Comment 2. The bound $5 n$ in the statement is far from sharp; the solution above can be modified to work for $9 n$. For large $n$, the bound $5 n$ can be replaced by $n^{\frac{3}{2}-\varepsilon}$.",3,"Let the sequence $\frac{a_i}{b_i}$ form an arithmetic progression with a non-zero common difference $\Delta = c/d$, where $c, d$ are coprime integers and $d>0$. Prove that any prime factor of $d$ must be less than or equal to 5.","Let $p$ be a prime factor of $d$, and let $\alpha = v_p(d)$. Consider the set of indices $S_p = \{i \in \{1, \ldots, n\} : v_p(b_i) < \alpha\}$. If $i, j \in S_p$ and $i \not\equiv j \pmod p$, then the $p$-adic valuation of the denominator of the difference $\frac{a_i}{b_i} - \frac{a_j}{b_j}$ is less than $\alpha$. However, this difference is $(i-j)\Delta = \frac{(i-j)c}{d}$, where the $p$-adic valuation of the denominator is exactly $\alpha$ because $p \nmid c$ and $p \nmid (i-j)$. This is a contradiction. Therefore, all indices in $S_p$ must belong to a single residue class modulo $p$, so $|S_p| \le \lceil n/p \rceil$. This implies that for at least $n - \lceil n/p \rceil$ indices, the denominator $b_i$ is divisible by $p$. Since these $b_i$ are distinct, the largest among them is at least $(n - \lceil n/p \rceil) \cdot p > (n(1-1/p)-1)p = (p-1)n-p$. We are given $b_i \le 5n$, so $(p-1)n-p \le 5n$, which means $(p-6)n \le p$. For $n \ge 2018$, this inequality fails for any prime $p \ge 7$. Thus, any prime factor of $d$ must be in $\{2, 3, 5\}$.","Assume the sequence is a non-constant arithmetic progression with common difference $\Delta = c/d$, where prime factors of $d$ are in $\{2,3,5\}$. Show that the number of denominators $b_i$ divisible by $d$ is at least $8\lfloor n/30 \rfloor$, and that $d > \frac{n-2}{20}$.","A denominator $b_i$ is divisible by $d$ if and only if for every prime factor $p$ of $d$, $v_p(b_i) \ge v_p(d)$. From the previous sub-problem, for each $p \in \{2,3,5\}$, the indices $i$ for which $v_p(b_i) < v_p(d)$ lie in a single residue class modulo $p$. An index $i$ corresponds to a $b_i$ divisible by $d$ if $i$ is not in any of these residue classes. In any block of 30 consecutive integers, the number of integers that avoid three specific residue classes modulo 2, 3, and 5 is at least $30(1-1/2)(1-1/3)(1-1/5) = 8$. Thus, in each block of 30 indices, at least 8 correspond to denominators divisible by $d$. Summing over all $\lfloor n/30 \rfloor$ blocks gives at least $8\lfloor n/30 \rfloor$ such denominators. For the second part, note that at least $n - (n/2-1) > n/2$ terms must have $b_i \ge n/2$. For these terms, $a_i/b_i \le 5n/(n/2) = 10$. So at least $n/2$ terms of the progression lie in $(0, 10]$. This implies $(n/2 - 1)|\Delta| < 10$, so $|\Delta| < \frac{20}{n-2}$. Since $|\Delta| = |c/d| \ge 1/d$, we have $d > \frac{n-2}{20}$.","Let $n \geqslant 2018$ be an integer, and let $a_{1}, a_{2}, \ldots, a_{n}, b_{1}, b_{2}, \ldots, b_{n}$ be pairwise distinct positive integers not exceeding $5 n$. Suppose that the sequence $\frac{a_{1}}{b_{1}}, \frac{a_{2}}{b_{2}}, \ldots, \frac{a_{n}}{b_{n}}$ forms an arithmetic progression. Prove that the terms of the sequence are equal.","Assume for contradiction that the terms are not equal, so the common difference is $\Delta=c/d \ne 0$. From Sub-problem 1, the prime factors of $d$ are in $\{2,3,5\}$. From Sub-problem 2, there are at least $N = 8\lfloor n/30 \rfloor$ denominators $b_i$ divisible by $d$, and $d > \frac{n-2}{20}$. These $N$ denominators are distinct multiples of $d$, so the largest among them must be at least $N \cdot d$. All $b_i$ are bounded by $5n$, so $N \cdot d \le 5n$. Substituting the lower bounds for $N$ and $d$: $8(\frac{n}{30}-1) \cdot (\frac{n-2}{20}) < N \cdot d \le 5n$. This implies $\frac{8(n-30)}{30} \frac{n-2}{20} < 5n$, which simplifies to $\frac{(n-30)(n-2)}{75} < 5n$. This further simplifies to $n^2 - 32n + 60 < 375n$, or $n^2 - 407n + 60 < 0$. For $n \ge 2018$, this is false, since $n(n-407)+60 > 0$. The assumption $\Delta \ne 0$ leads to a contradiction. Therefore, the common difference must be zero, and all terms of the sequence are equal.",,
2017a1,"Let $a_{1}, a_{2}, \ldots, a_{n}, k$, and $M$ be positive integers such that

$$
\frac{1}{a_{1}}+\frac{1}{a_{2}}+\cdots+\frac{1}{a_{n}}=k \quad \text { and } \quad a_{1} a_{2} \ldots a_{n}=M .
$$

If $M>1$, prove that the polynomial

$$
P(x)=M(x+1)^{k}-\left(x+a_{1}\right)\left(x+a_{2}\right) \cdots\left(x+a_{n}\right)
$$

has no positive roots.","We first prove that, for $x>0$,


\begin{equation*}
a_{i}(x+1)^{1 / a_{i}} \leqslant x+a_{i}, \tag{1}
\end{equation*}


with equality if and only if $a_{i}=1$. It is clear that equality occurs if $a_{i}=1$.\\
If $a_{i}>1$, the AM-GM inequality applied to a single copy of $x+1$ and $a_{i}-1$ copies of 1 yields

$$
\frac{(x+1)+\overbrace{1+1+\cdots+1}^{a_{i}-1 \text { ones }}}{a_{i}} \geqslant \sqrt[a_{i}]{(x+1) \cdot 1^{a_{i}-1}} \Longrightarrow a_{i}(x+1)^{1 / a_{i}} \leqslant x+a_{i} .
$$

Since $x+1>1$, the inequality is strict for $a_{i}>1$.\\
Multiplying the inequalities (1) for $i=1,2, \ldots, n$ yields

$$
\prod_{i=1}^{n} a_{i}(x+1)^{1 / a_{i}} \leqslant \prod_{i=1}^{n}\left(x+a_{i}\right) \Longleftrightarrow M(x+1)^{\sum_{i=1}^{n} 1 / a_{i}}-\prod_{i=1}^{n}\left(x+a_{i}\right) \leqslant 0 \Longleftrightarrow P(x) \leqslant 0
$$

with equality iff $a_{i}=1$ for all $i \in\{1,2, \ldots, n\}$. But this implies $M=1$, which is not possible. Hence $P(x)<0$ for all $x \in \mathbb{R}^{+}$, and $P$ has no positive roots.

Comment 1. Inequality (1) can be obtained in several ways. For instance, we may also use the binomial theorem: since $a_{i} \geqslant 1$,

$$
\left(1+\frac{x}{a_{i}}\right)^{a_{i}}=\sum_{j=0}^{a_{i}}\binom{a_{i}}{j}\left(\frac{x}{a_{i}}\right)^{j} \geqslant\binom{ a_{i}}{0}+\binom{a_{i}}{1} \cdot \frac{x}{a_{i}}=1+x .
$$

Both proofs of (1) mimic proofs to Bernoulli's inequality for a positive integer exponent $a_{i}$; we can use this inequality directly:

$$
\left(1+\frac{x}{a_{i}}\right)^{a_{i}} \geqslant 1+a_{i} \cdot \frac{x}{a_{i}}=1+x,
$$

and so

$$
x+a_{i}=a_{i}\left(1+\frac{x}{a_{i}}\right) \geqslant a_{i}(1+x)^{1 / a_{i}},
$$

or its (reversed) formulation, with exponent $1 / a_{i} \leqslant 1$ :

$$
(1+x)^{1 / a_{i}} \leqslant 1+\frac{1}{a_{i}} \cdot x=\frac{x+a_{i}}{a_{i}} \Longrightarrow a_{i}(1+x)^{1 / a_{i}} \leqslant x+a_{i} .
$$",2,"For any positive integer $a$ and any $x > 0$, prove that $x+a \ge a(x+1)^{1/a}$. Furthermore, show that the inequality is strict if $a > 1$.","We apply the AM-GM inequality to the set of $a$ positive numbers consisting of one copy of $x+1$ and $a-1$ copies of $1$. The arithmetic mean is $\frac{(x+1)+(a-1) \cdot 1}{a} = \frac{x+a}{a}$. The geometric mean is $\sqrt[a]{(x+1) \cdot 1^{a-1}} = (x+1)^{1/a}$. By AM-GM, $\frac{x+a}{a} \ge (x+1)^{1/a}$, which gives $x+a \ge a(x+1)^{1/a}$. Since $x>0$, we have $x+1 \ne 1$. If $a>1$, the numbers are not all equal, so the AM-GM inequality is strict, leading to $x+a > a(x+1)^{1/a}$.","Let $a_{1}, a_{2}, \ldots, a_{n}, k$, and $M$ be positive integers such that $\frac{1}{a_{1}}+\frac{1}{a_{2}}+\cdots+\frac{1}{a_{n}}=k$ and $a_{1} a_{2} \ldots a_{n}=M$. If $M>1$, prove that the polynomial $P(x)=M(x+1)^{k}-\left(x+a_{1}\right)\left(x+a_{2}\right) \cdots\left(x+a_{n}\right)$ has no positive roots.","For any $x>0$ and for each $i=1, \ldots, n$, we have the inequality $x+a_i \ge a_i(x+1)^{1/a_i}$ from the previous step. Multiplying these $n$ inequalities yields $\prod_{i=1}^{n}(x+a_i) \ge \prod_{i=1}^{n} a_i(x+1)^{1/a_i}$. The right side simplifies to $(\prod_{i=1}^{n} a_i) \cdot (x+1)^{\sum_{i=1}^{n} 1/a_i} = M(x+1)^k$. Thus, $\prod_{i=1}^{n}(x+a_i) \ge M(x+1)^k$, which means $P(x) \le 0$. Since $M = a_1 \cdots a_n > 1$, at least one $a_i$ must be greater than 1. For that $a_i$, the inequality is strict: $x+a_i > a_i(x+1)^{1/a_i}$. Therefore, the overall product inequality is also strict, so $\prod_{i=1}^{n}(x+a_i) > M(x+1)^k$. This implies $P(x) < 0$ for all $x>0$. A function that is strictly negative for all positive inputs has no positive roots.",,,,
2017a3,"Let $S$ be a finite set, and let $\mathcal{A}$ be the set of all functions from $S$ to $S$. Let $f$ be an element of $\mathcal{A}$, and let $T=f(S)$ be the image of $S$ under $f$. Suppose that $f \circ g \circ f \neq g \circ f \circ g$ for every $g$ in $\mathcal{A}$ with $g \neq f$. Show that $f(T)=T$.","Solution. For $n \geqslant 1$, denote the $n$-th composition of $f$ with itself by

$$
f^{n} \stackrel{\text { def }}{=} \underbrace{f \circ f \circ \cdots \circ f}_{n \text { times }} .
$$

By hypothesis, if $g \in \mathcal{A}$ satisfies $f \circ g \circ f=g \circ f \circ g$, then $g=f$. A natural idea is to try to plug in $g=f^{n}$ for some $n$ in the expression $f \circ g \circ f=g \circ f \circ g$ in order to get $f^{n}=f$, which solves the problem:\\
Claim. If there exists $n \geqslant 3$ such that $f^{n+2}=f^{2 n+1}$, then the restriction $f: T \rightarrow T$ of $f$ to $T$ is a bijection.\\
Proof. Indeed, by hypothesis, $f^{n+2}=f^{2 n+1} \Longleftrightarrow f \circ f^{n} \circ f=f^{n} \circ f \circ f^{n} \Longrightarrow f^{n}=f$. Since $n-2 \geqslant 1$, the image of $f^{n-2}$ is contained in $T=f(S)$, hence $f^{n-2}$ restricts to a function $f^{n-2}: T \rightarrow T$. This is the inverse of $f: T \rightarrow T$. In fact, given $t \in T$, say $t=f(s)$ with $s \in S$, we have

$$
t=f(s)=f^{n}(s)=f^{n-2}(f(t))=f\left(f^{n-2}(t)\right), \quad \text { i.e., } \quad f^{n-2} \circ f=f \circ f^{n-2}=\mathrm{id} \text { on } T
$$

(here id stands for the identity function). Hence, the restriction $f: T \rightarrow T$ of $f$ to $T$ is bijective with inverse given by $f^{n-2}: T \rightarrow T$.

It remains to show that $n$ as in the claim exists. For that, define

$$
S_{m} \stackrel{\text { def }}{=} f^{m}(S) \quad\left(S_{m} \text { is image of } f^{m}\right)
$$

Clearly the image of $f^{m+1}$ is contained in the image of $f^{m}$, i.e., there is a descending chain of subsets of $S$

$$
S \supseteq S_{1} \supseteq S_{2} \supseteq S_{3} \supseteq S_{4} \supseteq \cdots
$$

which must eventually stabilise since $S$ is finite, i.e., there is a $k \geqslant 1$ such that

$$
S_{k}=S_{k+1}=S_{k+2}=S_{k+3}=\cdots \stackrel{\text { def }}{=} S_{\infty}
$$

Hence $f$ restricts to a surjective function $f: S_{\infty} \rightarrow S_{\infty}$, which is also bijective since $S_{\infty} \subseteq S$ is finite. To sum up, $f: S_{\infty} \rightarrow S_{\infty}$ is a permutation of the elements of the finite set $S_{\infty}$, hence there exists an integer $r \geqslant 1$ such that $f^{r}=\mathrm{id}$ on $S_{\infty}$ (for example, we may choose $r=\left|S_{\infty}\right|!$ ). In other words,


\begin{equation*}
f^{m+r}=f^{m} \text { on } S \text { for all } m \geqslant k \tag{*}
\end{equation*}


Clearly, $(*)$ also implies that $f^{m+t r}=f^{m}$ for all integers $t \geqslant 1$ and $m \geqslant k$. So, to find $n$ as in the claim and finish the problem, it is enough to choose $m$ and $t$ in order to ensure that there exists $n \geqslant 3$ satisfying

$$
\left\{\begin{array} { l } 
{ 2 n + 1 = m + t r } \\
{ n + 2 = m }
\end{array} \Longleftrightarrow \left\{\begin{array}{l}
m=3+t r \\
n=m-2
\end{array}\right.\right.
$$

This can be clearly done by choosing $m$ large enough with $m \equiv 3(\bmod r)$. For instance, we may take $n=2 k r+1$, so that

$$
f^{n+2}=f^{2 k r+3}=f^{4 k r+3}=f^{2 n+1}
$$

where the middle equality follows by $(*)$ since $2 k r+3 \geqslant k$.",4,"Show that if $f^n = f$ for some integer $n \ge 2$, then $f(T) = T$, where $T=f(S)$.","Let $t$ be an arbitrary element of $T$. We must show there is some $x \in T$ such that $f(x)=t$. Since $t \in T$, $t=f(s)$ for some $s \in S$. The condition $f^n=f$ implies $t = f(s) = f^n(s) = f^{n-1}(f(s)) = f^{n-1}(t)$. Now, let $x = f^{n-2}(t)$. Since $t \in T=f(S)$, we have $x=f^{n-2}(t) \in f^{n-1}(S)$. As $n \ge 2$, $f^{n-1}(S) \subseteq f(S)=T$, so $x \in T$. Finally, $f(x) = f(f^{n-2}(t)) = f^{n-1}(t) = t$. This shows that $f$ is surjective on $T$, meaning $f(T)=T$.","Show that if an integer $n \ge 2$ exists such that $f^{n+2} = f^{2n+1}$, then the problem's main hypothesis implies that $f^n=f$.","The problem's hypothesis states that for any function $g \in \mathcal{A}$ with $g \neq f$, we have $f \circ g \circ f \neq g \circ f \circ g$. This is logically equivalent to stating that if $f \circ g \circ f = g \circ f \circ g$ for some $g \in \mathcal{A}$, then it must be that $g=f$. Let us consider the specific function $g = f^n$. The condition $f \circ g \circ f = g \circ f \circ g$ becomes $f \circ f^n \circ f = f^n \circ f \circ f^n$, which simplifies to $f^{n+2} = f^{2n+1}$. If this equality holds, the hypothesis forces the conclusion that $g=f$, which in this case means $f^n=f$.",Show that there exists an integer $n \ge 2$ such that $f^{n+2} = f^{2n+1}$.,"Consider the sequence of images $S_m = f^m(S)$ for $m \ge 1$. This forms a descending chain of subsets $S \supseteq S_1 \supseteq S_2 \supseteq \dots$. Since $S$ is a finite set, this chain must stabilize. Thus, there exists an integer $k \ge 1$ such that $S_k = S_{k+1} = \dots = S_\infty$. This implies $f(S_\infty) = S_\infty$, so the restriction $f|_{S_\infty}$ is a surjective map from a finite set to itself, hence a bijection (a permutation). As a permutation, some power of $f$ must be the identity on $S_\infty$; let $f^r = \text{id}_{S_\infty}$ for some integer $r \ge 1$. This implies that $f^{m+r} = f^m$ for all $m \ge k$. We need to find an $n \ge 2$ such that $f^{n+2}=f^{2n+1}$. This equality holds if $n+2 \ge k$ and $(2n+1)-(n+2)$ is a multiple of $r$. The difference is $n-1$. So we need to find $n \ge 2$ such that $n-1=tr$ for some integer $t \ge 1$. We can choose $t$ large enough such that $n=tr+1 \ge 2$ and $n+2=tr+3 \ge k$. For such an $n$, we have $f^{2n+1} = f^{(n+2)+tr} = f^{n+2}$.","Let $S$ be a finite set, and let $\mathcal{A}$ be the set of all functions from $S$ to $S$. Let $f$ be an element of $\mathcal{A}$, and let $T=f(S)$ be the image of $S$ under $f$. Suppose that $f \circ g \circ f \neq g \circ f \circ g$ for every $g$ in $\mathcal{A}$ with $g \neq f$. Show that $f(T)=T$.","From sub-problem 3, there exists an integer $n \ge 2$ such that the equality $f^{n+2} = f^{2n+1}$ holds. From sub-problem 2, this equality, combined with the problem's main hypothesis, implies that $f^n=f$. Finally, from sub-problem 1, the condition $f^n=f$ implies the desired result, $f(T)=T$."
2017a4,"A sequence of real numbers $a_{1}, a_{2}, \ldots$ satisfies the relation

$$
a_{n}=-\max _{i+j=n}\left(a_{i}+a_{j}\right) \quad \text { for all } n>2017 .
$$

Prove that this sequence is bounded, i.e., there is a constant $M$ such that $\left|a_{n}\right| \leqslant M$ for all positive integers $n$.","Set $D=2017$. Denote

$$
M_{n}=\max _{k<n} a_{k} \quad \text { and } \quad m_{n}=-\min _{k<n} a_{k}=\max _{k<n}\left(-a_{k}\right) .
$$

Clearly, the sequences $\left(m_{n}\right)$ and $\left(M_{n}\right)$ are nondecreasing. We need to prove that both are bounded.

Consider an arbitrary $n>D$; our first aim is to bound $a_{n}$ in terms of $m_{n}$ and $M_{n}$.\\
(i) There exist indices $p$ and $q$ such that $a_{n}=-\left(a_{p}+a_{q}\right)$ and $p+q=n$. Since $a_{p}, a_{q} \leqslant M_{n}$, we have $a_{n} \geqslant-2 M_{n}$.\\
(ii) On the other hand, choose an index $k<n$ such that $a_{k}=M_{n}$. Then, we have

$$
a_{n}=-\max _{\ell<n}\left(a_{n-\ell}+a_{\ell}\right) \leqslant-\left(a_{n-k}+a_{k}\right)=-a_{n-k}-M_{n} \leqslant m_{n}-M_{n} .
$$

Summarizing (i) and (ii), we get

$$
-2 M_{n} \leqslant a_{n} \leqslant m_{n}-M_{n},
$$

whence


\begin{equation*}
m_{n} \leqslant m_{n+1} \leqslant \max \left\{m_{n}, 2 M_{n}\right\} \quad \text { and } \quad M_{n} \leqslant M_{n+1} \leqslant \max \left\{M_{n}, m_{n}-M_{n}\right\} . \tag{1}
\end{equation*}


Now, say that an index $n>D$ is lucky if $m_{n} \leqslant 2 M_{n}$. Two cases are possible.\\
Case 1. Assume that there exists a lucky index $n$. In this case, (1) yields $m_{n+1} \leqslant 2 M_{n}$ and $M_{n} \leqslant M_{n+1} \leqslant M_{n}$. Therefore, $M_{n+1}=M_{n}$ and $m_{n+1} \leqslant 2 M_{n}=2 M_{n+1}$. So, the index $n+1$ is also lucky, and $M_{n+1}=M_{n}$. Applying the same arguments repeatedly, we obtain that all indices $k>n$ are lucky (i.e., $m_{k} \leqslant 2 M_{k}$ for all these indices), and $M_{k}=M_{n}$ for all such indices. Thus, all of the $m_{k}$ and $M_{k}$ are bounded by $2 M_{n}$.\\
Case 2. Assume now that there is no lucky index, i.e., $2 M_{n}<m_{n}$ for all $n>D$. Then (1) shows that for all $n>D$ we have $m_{n} \leqslant m_{n+1} \leqslant m_{n}$, so $m_{n}=m_{D+1}$ for all $n>D$. Since $M_{n}<m_{n} / 2$ for all such indices, all of the $m_{n}$ and $M_{n}$ are bounded by $m_{D+1}$.

Thus, in both cases the sequences $\left(m_{n}\right)$ and $\left(M_{n}\right)$ are bounded, as desired.\\",3,"Let $D=2017$. For $n>D$, define $M_n = \max_{k<n} a_k$ and $m_n = \max_{k<n} (-a_k)$. Prove that for any $n>D$, the term $a_n$ satisfies the inequalities $-2M_n \le a_n \le m_n - M_n$.","By definition, for $n>D$, $a_{n}=-\left(a_{p}+a_{q}\right)$ for some $p, q$ with $p+q=n$. Since $p, q < n$, we have $a_{p} \leqslant M_{n}$ and $a_{q} \leqslant M_{n}$. Thus, $a_{p}+a_{q} \leqslant 2 M_{n}$, which implies $a_{n} \geqslant-2 M_{n}$. Now, choose an index $k<n$ such that $a_{k}=M_{n}$. From the relation, $a_{n}=-\max_{\ell<n}(a_{n-\ell}+a_{\ell}) \leqslant -(a_{n-k}+a_k) = -a_{n-k}-M_n$. Since $-a_{n-k} \leqslant m_n$, it follows that $a_{n} \leqslant m_{n}-M_{n}$. Combining the two inequalities yields $-2 M_{n} \leqslant a_{n} \leqslant m_{n}-M_{n}$.",Let $D=2017$. Define $M_n = \max_{k<n} a_k$ and $m_n = \max_{k<n} (-a_k)$. Prove that the non-decreasing sequences $(M_n)_{n>D}$ and $(m_n)_{n>D}$ are bounded.,"From the previous result, for $n>D$, we have $-2M_n \le a_n \le m_n - M_n$. This gives relations for the non-decreasing sequences $(M_n)$ and $(m_n)$: $M_{n+1} = \max(M_n, a_n) \le \max(M_n, m_n - M_n)$ and $m_{n+1} = \max(m_n, -a_n) \le \max(m_n, 2M_n)$. We consider two cases for $n>D$. Case 1: There exists an $n_0>D$ with $m_{n_0} \le 2M_{n_0}$. Then $M_{n_0+1} \le M_{n_0}$, so $M_{n_0+1}=M_{n_0}$. Also $m_{n_0+1} \le 2M_{n_0}=2M_{n_0+1}$. By induction, for all $k>n_0$, $M_k=M_{n_0}$ and $m_k \le 2M_{n_0}$, so both sequences are bounded. Case 2: For all $n>D$, $m_n > 2M_n$. Then $m_{n+1} \le m_n$, so $m_{n+1}=m_n=m_{D+1}$. Thus $(m_n)$ is bounded. Also, $M_n < m_n/2 = m_{D+1}/2$, so $(M_n)$ is also bounded. In both cases, the sequences are bounded.","A sequence of real numbers $a_{1}, a_{2}, \ldots$ satisfies the relation

$$
a_{n}=-\max _{i+j=n}\left(a_{i}+a_{j}\right) \quad \text { for all } n>2017 .
$$

Prove that this sequence is bounded, i.e., there is a constant $M$ such that $\left|a_{n}\right| \leqslant M$ for all positive integers $n$.","Let $D=2017$. The initial terms $a_1, \dots, a_D$ form a finite set and are thus bounded. For $n>D$, let $M_n = \max_{k<n} a_k$ and $m_n = \max_{k<n} (-a_k)$. As shown in the previous sub-problem, the non-decreasing sequences $(M_n)_{n>D}$ and $(m_n)_{n>D}$ are bounded. Let their upper bounds be $M^*$ and $m^*$ respectively. For any $n>D$, we have $a_n \le M_{n+1} \le M^*$ and $-a_n \le m_{n+1} \le m^*$, which implies $-m^* \le a_n \le M^*$. So the terms for $n>D$ are bounded. Combining the initial segment and the tail of the sequence, the entire sequence $(a_n)$ is bounded.",,
2017a7,"Let $a_{0}, a_{1}, a_{2}, \ldots$ be a sequence of integers and $b_{0}, b_{1}, b_{2}, \ldots$ be a sequence of positive integers such that $a_{0}=0, a_{1}=1$, and

$$
a_{n+1}=\left\{\begin{array}{ll}
a_{n} b_{n}+a_{n-1}, & \text { if } b_{n-1}=1 \\
a_{n} b_{n}-a_{n-1}, & \text { if } b_{n-1}>1
\end{array} \quad \text { for } n=1,2, \ldots .\right.
$$

Prove that at least one of the two numbers $a_{2017}$ and $a_{2018}$ must be greater than or equal to 2017 .","The value of $b_{0}$ is irrelevant since $a_{0}=0$, so we may assume that $b_{0}=1$.\\
Lemma. We have $a_{n} \geqslant 1$ for all $n \geqslant 1$.\\
Proof. Let us suppose otherwise in order to obtain a contradiction. Let


\begin{equation*}
n \geqslant 1 \text { be the smallest integer with } a_{n} \leqslant 0 \text {. } \tag{1}
\end{equation*}


Note that $n \geqslant 2$. It follows that $a_{n-1} \geqslant 1$ and $a_{n-2} \geqslant 0$. Thus we cannot have $a_{n}=$ $a_{n-1} b_{n-1}+a_{n-2}$, so we must have $a_{n}=a_{n-1} b_{n-1}-a_{n-2}$. Since $a_{n} \leqslant 0$, we have $a_{n-1} \leqslant a_{n-2}$. Thus we have $a_{n-2} \geqslant a_{n-1} \geqslant a_{n}$.

Let


\begin{equation*}
r \text { be the smallest index with } a_{r} \geqslant a_{r+1} \geqslant a_{r+2} \text {. } \tag{2}
\end{equation*}


Then $r \leqslant n-2$ by the above, but also $r \geqslant 2$ : if $b_{1}=1$, then $a_{2}=a_{1}=1$ and $a_{3}=a_{2} b_{2}+a_{1}>a_{2}$; if $b_{1}>1$, then $a_{2}=b_{1}>1=a_{1}$.

By the minimal choice (2) of $r$, it follows that $a_{r-1}<a_{r}$. And since $2 \leqslant r \leqslant n-2$, by the minimal choice (1) of $n$ we have $a_{r-1}, a_{r}, a_{r+1}>0$. In order to have $a_{r+1} \geqslant a_{r+2}$, we must have $a_{r+2}=a_{r+1} b_{r+1}-a_{r}$ so that $b_{r} \geqslant 2$. Putting everything together, we conclude that

$$
a_{r+1}=a_{r} b_{r} \pm a_{r-1} \geqslant 2 a_{r}-a_{r-1}=a_{r}+\left(a_{r}-a_{r-1}\right)>a_{r},
$$

which contradicts (2).\\
To complete the problem, we prove that $\max \left\{a_{n}, a_{n+1}\right\} \geqslant n$ by induction. The cases $n=0,1$ are given. Assume it is true for all non-negative integers strictly less than $n$, where $n \geqslant 2$. There are two cases:

Case 1: $b_{n-1}=1$.\\
Then $a_{n+1}=a_{n} b_{n}+a_{n-1}$. By the inductive assumption one of $a_{n-1}, a_{n}$ is at least $n-1$ and the other, by the lemma, is at least 1 . Hence

$$
a_{n+1}=a_{n} b_{n}+a_{n-1} \geqslant a_{n}+a_{n-1} \geqslant(n-1)+1=n .
$$

Thus $\max \left\{a_{n}, a_{n+1}\right\} \geqslant n$, as desired.\\
Case 2: $b_{n-1}>1$.\\
Since we defined $b_{0}=1$ there is an index $r$ with $1 \leqslant r \leqslant n-1$ such that

$$
b_{n-1}, b_{n-2}, \ldots, b_{r} \geqslant 2 \quad \text { and } \quad b_{r-1}=1 .
$$

We have $a_{r+1}=a_{r} b_{r}+a_{r-1} \geqslant 2 a_{r}+a_{r-1}$. Thus $a_{r+1}-a_{r} \geqslant a_{r}+a_{r-1}$.\\
Now we claim that $a_{r}+a_{r-1} \geqslant r$. Indeed, this holds by inspection for $r=1$; for $r \geqslant 2$, one of $a_{r}, a_{r-1}$ is at least $r-1$ by the inductive assumption, while the other, by the lemma, is at least 1 . Hence $a_{r}+a_{r-1} \geqslant r$, as claimed, and therefore $a_{r+1}-a_{r} \geqslant r$ by the last inequality in the previous paragraph.

Since $r \geqslant 1$ and, by the lemma, $a_{r} \geqslant 1$, from $a_{r+1}-a_{r} \geqslant r$ we get the following two inequalities:

$$
a_{r+1} \geqslant r+1 \quad \text { and } \quad a_{r+1}>a_{r} .
$$

Now observe that

$$
a_{m}>a_{m-1} \Longrightarrow a_{m+1}>a_{m} \text { for } m=r+1, r+2, \ldots, n-1,
$$

since $a_{m+1}=a_{m} b_{m}-a_{m-1} \geqslant 2 a_{m}-a_{m-1}=a_{m}+\left(a_{m}-a_{m-1}\right)>a_{m}$. Thus

$$
a_{n}>a_{n-1}>\cdots>a_{r+1} \geqslant r+1 \Longrightarrow a_{n} \geqslant n
$$

So $\max \left\{a_{n}, a_{n+1}\right\} \geqslant n$, as desired.\\",3,Let the sequence $a_n$ be defined as in the problem. Prove that $a_n \ge 1$ for all $n \ge 1$.,"Assume for contradiction that there exists a smallest integer $n \ge 1$ with $a_n \le 0$. Since $a_1=1$, we have $n \ge 2$. By minimality, $a_{n-1} \ge 1$ and $a_{n-2} \ge 0$. For $a_n \le 0$ to hold, the recurrence must be $a_n = a_{n-1}b_{n-1}-a_{n-2}$ with $b_{n-1}>1$. This implies $a_{n-1} \le a_{n-2}$, so we have a decreasing sequence segment $a_{n-2} \ge a_{n-1} \ge a_n$. Let $r$ be the smallest index with $a_r \ge a_{r+1} \ge a_{r+2}$. Such an $r$ exists and $r \le n-2$. One can show $r \ge 2$. By minimality of $r$, $a_{r-1} < a_r$. The condition $a_{r+1} \ge a_{r+2}$ implies that $a_{r+2} = a_{r+1}b_{r+1}-a_r$, so $b_r \ge 2$. Combining these, $a_{r+1} = a_r b_r \pm a_{r-1} \ge 2a_r - a_{r-1} = a_r + (a_r - a_{r-1}) > a_r$. This contradicts the condition $a_r \ge a_{r+1}$. Thus, the initial assumption was false, and $a_n \ge 1$ for all $n \ge 1$.","Prove by induction that for all $n \ge 0$, $\max\{a_n, a_{n+1}\} \ge n$.","The base cases $n=0$ and $n=1$ are easily verified. Assume the statement is true for all non-negative integers strictly less than $n$, for $n \ge 2$. We consider two cases for $b_{n-1}$.
Case 1: $b_{n-1}=1$. Then $a_{n+1} = a_n b_n + a_{n-1} \ge a_n + a_{n-1}$. By the induction hypothesis for $n-1$, $\max\{a_{n-1}, a_n\} \ge n-1$. By the result of the first sub-problem, the other term is at least 1. Thus, $a_{n+1} \ge (n-1) + 1 = n$. 
Case 2: $b_{n-1}>1$. Let $r$ be the largest index $1 \le r \le n-1$ such that $b_{r-1}=1$ (taking $b_0=1$). Then $b_r, \dots, b_{n-1} \ge 2$. We have $a_{r+1}=a_r b_r + a_{r-1} \ge 2a_r+a_{r-1}$. By the induction hypothesis for $r-1$ and the result from sub-problem 1, $a_r+a_{r-1} \ge (r-1)+1=r$. This implies $a_{r+1} > a_r$ and $a_{r+1} \ge r+1$. For $m=r+1, \ldots, n-1$, the recurrence is $a_{m+1}=a_m b_m - a_{m-1}$. An inductive argument shows $a_n > a_{n-1} > \dots > a_{r+1}$. Since $a_{r+1} \ge r+1$, this implies $a_n \ge n$. 
In both cases, $\max\{a_n, a_{n+1}\} \ge n$.",Prove that at least one of the two numbers $a_{2017}$ and $a_{2018}$ must be greater than or equal to 2017.,"From the result of the second sub-problem, we have established that $\max\{a_n, a_{n+1}\} \ge n$ holds for all integers $n \ge 0$. By setting $n=2017$, we directly obtain the inequality $\max\{a_{2017}, a_{2018}\} \ge 2017$. This means that at least one of the numbers $a_{2017}$ or $a_{2018}$ must be greater than or equal to 2017.",,
2017a8,"Assume that a function $f: \mathbb{R} \rightarrow \mathbb{R}$ satisfies the following condition:\\
For every $x, y \in \mathbb{R}$ such that $(f(x)+y)(f(y)+x)>0$, we have $f(x)+y=f(y)+x$.

Prove that $f(x)+y \leqslant f(y)+x$ whenever $x>y$.","Define $g(x)=x-f(x)$. The condition on $f$ then rewrites as follows:\\
For every $x, y \in \mathbb{R}$ such that $((x+y)-g(x))((x+y)-g(y))>0$, we have $g(x)=g(y)$.\\
This condition may in turn be rewritten in the following form:


\begin{equation*}
\text { If } g(x) \neq g(y), \text { then the number } x+y \text { lies (non-strictly) between } g(x) \text { and } g(y) \text {. } \tag{*}
\end{equation*}


Notice here that the function $g_{1}(x)=-g(-x)$ also satisfies $(*)$, since

$$
\begin{gathered}
g_{1}(x) \neq g_{1}(y) \Longrightarrow \quad g(-x) \neq g(-y) \quad \Longrightarrow \quad-(x+y) \text { lies between } g(-x) \text { and } g(-y) \\
\\
\Longrightarrow x+y \text { lies between } g_{1}(x) \text { and } g_{1}(y)
\end{gathered}
$$

On the other hand, the relation we need to prove reads now as


\begin{equation*}
g(x) \leqslant g(y) \quad \text { whenever } x<y \tag{1}
\end{equation*}


Again, this condition is equivalent to the same one with $g$ replaced by $g_{1}$.\\
If $g(x)=2 x$ for all $x \in \mathbb{R}$, then $(*)$ is obvious; so in what follows we consider the other case. We split the solution into a sequence of lemmas, strengthening one another. We always consider some value of $x$ with $g(x) \neq 2 x$ and denote $X=g(x)$.\\
Lemma 1. Assume that $X<2 x$. Then on the interval $(X-x ; x]$ the function $g$ attains at most two values - namely, $X$ and, possibly, some $Y>X$. Similarly, if $X>2 x$, then $g$ attains at most two values on $[x ; X-x)$ 锟斤拷锟?namely, $X$ and, possibly, some $Y<X$.\\
Proof. We start with the first claim of the lemma. Notice that $X-x<x$, so the considered interval is nonempty.

Take any $a \in(X-x ; x)$ with $g(a) \neq X$ (if it exists). If $g(a)<X$, then $(*)$ yields $g(a) \leqslant$ $a+x \leqslant g(x)=X$, so $a \leqslant X-x$ which is impossible. Thus, $g(a)>X$ and hence by $(*)$ we get $X \leqslant a+x \leqslant g(a)$.

Now, for any $b \in(X-x ; x)$ with $g(b) \neq X$ we similarly get $b+x \leqslant g(b)$. Therefore, the number $a+b$ (which is smaller than each of $a+x$ and $b+x$ ) cannot lie between $g(a)$ and $g(b)$, which by $(*)$ implies that $g(a)=g(b)$. Hence $g$ may attain only two values on $(X-x ; x]$, namely $X$ and $g(a)>X$.

To prove the second claim, notice that $g_{1}(-x)=-X<2 \cdot(-x)$, so $g_{1}$ attains at most two values on $(-X+x,-x]$, i.e., $-X$ and, possibly, some $-Y>-X$. Passing back to $g$, we get what we need.

Lemma 2. If $X<2 x$, then $g$ is constant on $(X-x ; x)$. Similarly, if $X>2 x$, then $g$ is constant on $(x ; X-x)$.\\
Proof. Again, it suffices to prove the first claim only. Assume, for the sake of contradiction, that there exist $a, b \in(X-x ; x)$ with $g(a) \neq g(b)$; by Lemma 1 , we may assume that $g(a)=X$ and $Y=g(b)>X$.

Notice that $\min \{X-a, X-b\}>X-x$, so there exists a $u \in(X-x ; x)$ such that $u<\min \{X-a, X-b\}$. By Lemma 1, we have either $g(u)=X$ or $g(u)=Y$. In the former case, by ( $*$ ) we have $X \leqslant u+b \leqslant Y$ which contradicts $u<X-b$. In the second case, by (*) we have $X \leqslant u+a \leqslant Y$ which contradicts $u<X-a$. Thus the lemma is proved.

Lemma 3. If $X<2 x$, then $g(a)=X$ for all $a \in(X-x ; x)$. Similarly, if $X>2 x$, then $g(a)=X$ for all $a \in(x ; X-x)$.\\
Proof. Again, we only prove the first claim.\\
By Lemmas 1 and 2, this claim may be violated only if $g$ takes on a constant value $Y>X$ on ( $X-x, x$ ). Choose any $a, b \in(X-x ; x)$ with $a<b$. By (*), we have


\begin{equation*}
Y \geqslant b+x \geqslant X . \tag{2}
\end{equation*}


In particular, we have $Y \geqslant b+x>2 a$. Applying Lemma 2 to $a$ in place of $x$, we obtain that $g$ is constant on $(a, Y-a)$. By (2) again, we have $x \leqslant Y-b<Y-a$; so $x, b \in(a ; Y-a)$. But $X=g(x) \neq g(b)=Y$, which is a contradiction.

Now we are able to finish the solution. Assume that $g(x)>g(y)$ for some $x<y$. Denote $X=g(x)$ and $Y=g(y)$; by (*), we have $X \geqslant x+y \geqslant Y$, so $Y-y \leqslant x<y \leqslant X-x$, and hence $(Y-y ; y) \cap(x ; X-x)=(x, y) \neq \varnothing$. On the other hand, since $Y-y<y$ and $x<X-x$, Lemma 3 shows that $g$ should attain a constant value $X$ on $(x ; X-x)$ and a constant value $Y \neq X$ on $(Y-y ; y)$. Since these intervals overlap, we get the final contradiction.",4,Let $g(x) = x - f(x)$. Reformulate the given condition and the goal $f(x)+y \leqslant f(y)+x$ for $x>y$ in terms of the function $g$.,"The condition $(f(x)+y)(f(y)+x)>0 \implies f(x)+y=f(y)+x$ is equivalent to: if $g(x) \neq g(y)$, then $x+y$ lies non-strictly between $g(x)$ and $g(y)$. The inequality to be proven, $f(x)+y \leqslant f(y)+x$ for $x>y$, becomes $x-g(x)+y \leqslant y-g(y)+x$, which simplifies to $g(y) \leqslant g(x)$ for $x>y$. This means we need to prove that $g(x)$ is a non-decreasing function.","Let $X=g(x)$. Show that if $g(x) \neq 2x$, then $g$ is constant on a specific open interval. Specifically, if $X < 2x$, $g$ is constant on $(X-x, x)$, and if $X > 2x$, $g$ is constant on $(x, X-x)$.","Assume $X < 2x$. For any $a \in (X-x, x)$ with $g(a) \neq X$, the condition from Part 1 implies $g(a)>X$. If $a, b \in (X-x, x)$ both have $g(a), g(b) \neq X$, then $a+b$ cannot lie between $g(a)$ and $g(b)$, implying $g(a)=g(b)$. Thus $g$ takes at most two values on $(X-x, x)$: $X$ and some constant $Y>X$. If both values are attained, say $g(a)=X$ and $g(b)=Y$, we can find a $u \in (X-x,x)$ small enough such that applying the condition to pairs $(u,a)$ and $(u,b)$ leads to a contradiction. Thus $g$ must be constant on $(X-x, x)$. The case $X > 2x$ follows by a symmetric argument.","Let $X=g(x)$. Show that if $X < 2x$, the constant value of $g$ on $(X-x, x)$ must be $X$. Similarly, if $X > 2x$, the constant value of $g$ on $(x, X-x)$ must be $X$.","Assume $X < 2x$. From Part 2, $g$ is constant on $(X-x, x)$. If this value were $Y \neq X$, then $Y>X$. Pick any $b \in (X-x,x)$, so $g(b)=Y$. The condition from Part 1 applied to $(x,b)$ implies $X \le b+x \le Y$. Also, $g(b)=Y > b+x > 2b$. Applying Part 2 to the point $b$, $g$ must be constant on $(b, Y-b)$. This interval contains $x$ and other points from $(b,x)$. This would imply $g(x)=Y$, which contradicts $g(x)=X$. Thus the constant value must be $X$. The case $X>2x$ follows by symmetry.",Prove that $f(x)+y \leqslant f(y)+x$ whenever $x>y$.,"From Part 1, we must prove $g(x)$ is non-decreasing. Assume for contradiction that $g(x) > g(y)$ for some $x < y$. Let $X=g(x)$ and $Y=g(y)$. The condition from Part 1 implies $X \ge x+y \ge Y$. This means $X > 2x$ (since $y>x$) and $Y < 2y$ (since $x<y$). By Part 3, $g$ is constant with value $X$ on $(x, X-x)$ and constant with value $Y$ on $(Y-y, y)$. The inequalities $X \ge x+y$ and $Y \le x+y$ imply that both intervals contain the non-empty interval $(x, y)$. On this overlapping interval, $g$ must be equal to both $X$ and $Y$, so $X=Y$. This contradicts the assumption $g(x)>g(y)$, so $g$ must be non-decreasing."
2017c1,A rectangle $\mathcal{R}$ with odd integer side lengths is divided into small rectangles with integer side lengths. Prove that there is at least one among the small rectangles whose distances from the four sides of $\mathcal{R}$ are either all odd or all even.,"Solution. Let the width and height of $\mathcal{R}$ be odd numbers $a$ and $b$. Divide $\mathcal{R}$ into $a b$ unit squares and color them green and yellow in a checkered pattern. Since the side lengths of $a$ and $b$ are odd, the corner squares of $\mathcal{R}$ will all have the same color, say green.

Call a rectangle (either $\mathcal{R}$ or a small rectangle) green if its corners are all green; call it yellow if the corners are all yellow, and call it mixed if it has both green and yellow corners. In particular, $\mathcal{R}$ is a green rectangle.

We will use the following trivial observations.

\begin{itemize}
  \item Every mixed rectangle contains the same number of green and yellow squares;
  \item Every green rectangle contains one more green square than yellow square;
  \item Every yellow rectangle contains one more yellow square than green square.
\end{itemize}

The rectangle $\mathcal{R}$ is green, so it contains more green unit squares than yellow unit squares. Therefore, among the small rectangles, at least one is green. Let $\mathcal{S}$ be such a small green rectangle, and let its distances from the sides of $\mathcal{R}$ be $x, y, u$ and $v$, as shown in the picture. The top-left corner of $\mathcal{R}$ and the top-left corner of $\mathcal{S}$ have the same color, which happen if and only if $x$ and $u$ have the same parity. Similarly, the other three green corners of $\mathcal{S}$ indicate that $x$ and $v$ have the same parity, $y$ and $u$ have the same parity, i.e. $x, y, u$ and $v$ are all odd or all even.\\",3,"Consider a rectangle with integer side lengths on a checkerboard of green and yellow unit squares. Define a rectangle as 'green' if its corners are all green, 'yellow' if its corners are all yellow, and 'mixed' otherwise. Establish the relationship between the type of rectangle and the difference between the number of green and yellow squares it contains.","Any rectangle with at least one even side length can be perfectly tiled by 1x2 or 2x1 dominoes, each containing one green and one yellow square. Therefore, it contains an equal number of green and yellow squares. A rectangle with both side lengths odd is either 'green' or 'yellow'. The total number of squares is odd, so the counts of green and yellow squares cannot be equal. Such a rectangle contains one more square of its corner color. Thus, a 'green' rectangle has one more green square than yellow, a 'yellow' one has one more yellow than green, and a 'mixed' one has an equal number of each.","A large rectangle $\mathcal{R}$ with odd integer side lengths is tiled by smaller rectangles with integer side lengths. Using a checkerboard coloring where the corners of $\mathcal{R}$ are all colored green, prove that at least one of the small rectangles must also have all four of its corners colored green.","Since the large rectangle $\mathcal{R}$ has odd side lengths, its four corners lie on squares of the same color; let's call this color green. Based on the property from the previous sub-problem, $\mathcal{R}$ contains one more green unit square than yellow. The tiling is a partition of $\mathcal{R}$'s unit squares. The total difference between the number of green and yellow squares in $\mathcal{R}$ is the sum of these differences over all small rectangles. Since this total difference is positive, at least one small rectangle must also have more green squares than yellow. This is only possible if that small rectangle is 'green', i.e., all its corners are colored green.",A rectangle $\mathcal{R}$ with odd integer side lengths is divided into small rectangles with integer side lengths. Prove that there is at least one among the small rectangles whose distances from the four sides of $\mathcal{R}$ are either all odd or all even.,"From the previous sub-problem, there exists a small rectangle $\mathcal{S}$ whose four corners have the same color as the corners of $\mathcal{R}$. We set up a coordinate system with the origin at a corner of $\mathcal{R}$, say $(0,0)$. The color of a unit square at $(i,j)$ is determined by the parity of $i+j$. Since $\mathcal{R}$ has odd side lengths $a,b$, its corner coordinates have sums $(0+0)$, $(a-1+0)$, $(0+b-1)$, and $(a-1+b-1)$, all of which are even. Let the distances of $\mathcal{S}$ from the left, top, right, and bottom sides of $\mathcal{R}$ be $d_L, d_T, d_R, d_B$. The corner coordinates of $\mathcal{S}$ are $(d_L, d_T)$, $(a-1-d_R, d_T)$, $(d_L, b-1-d_B)$, and $(a-1-d_R, b-1-d_B)$. For these corners to have the same color as $\mathcal{R}$'s corners, their coordinate sums must all be even. This implies: 1) $d_L+d_T$ is even, so $d_L$ and $d_T$ have the same parity. 2) $(a-1-d_R)+d_T$ is even, so $d_R$ and $d_T$ have the same parity (as $a-1$ is even). 3) $d_L+(b-1-d_B)$ is even, so $d_L$ and $d_B$ have the same parity (as $b-1$ is even). Together, these conditions imply $d_L, d_T, d_R, d_B$ must all have the same parity.",,
2017c2,"Let $n$ be a positive integer. Define a chameleon to be any sequence of $3 n$ letters, with exactly $n$ occurrences of each of the letters $a, b$, and $c$. Define a swap to be the transposition of two adjacent letters in a chameleon. Prove that for any chameleon $X$, there exists a chameleon $Y$ such that $X$ cannot be changed to $Y$ using fewer than $3 n^{2} / 2$ swaps.","To start, notice that the swap of two identical letters does not change a chameleon, so we may assume there are no such swaps.

For any two chameleons $X$ and $Y$, define their distance $d(X, Y)$ to be the minimal number of swaps needed to transform $X$ into $Y$ (or vice versa). Clearly, $d(X, Y)+d(Y, Z) \geqslant d(X, Z)$ for any three chameleons $X, Y$, and $Z$.\\
Lemma. Consider two chameleons\\
\includegraphics[max width=\textwidth, center]{2025_04_29_3d725d21cc83abfed093g-37}

Then $d(P, Q) \geqslant 3 n^{2}$.\\
Proof. For any chameleon $X$ and any pair of distinct letters $u, v \in\{a, b, c\}$, we define $f_{u, v}(X)$ to be the number of pairs of positions in $X$ such that the left one is occupied by $u$, and the right one is occupied by $v$. Define $f(X)=f_{a, b}(X)+f_{a, c}(X)+f_{b, c}(X)$. Notice that $f_{a, b}(P)=f_{a, c}(P)=f_{b, c}(P)=n^{2}$ and $f_{a, b}(Q)=f_{a, c}(Q)=f_{b, c}(Q)=0$, so $f(P)=3 n^{2}$ and $f(Q)=0$.

Now consider some swap changing a chameleon $X$ to $X^{\prime}$; say, the letters $a$ and $b$ are swapped. Then $f_{a, b}(X)$ and $f_{a, b}\left(X^{\prime}\right)$ differ by exactly 1 , while $f_{a, c}(X)=f_{a, c}\left(X^{\prime}\right)$ and $f_{b, c}(X)=f_{b, c}\left(X^{\prime}\right)$. This yields $\left|f(X)-f\left(X^{\prime}\right)\right|=1$, i.e., on any swap the value of $f$ changes by 1 . Hence $d(X, Y) \geqslant$ $|f(X)-f(Y)|$ for any two chameleons $X$ and $Y$. In particular, $d(P, Q) \geqslant|f(P)-f(Q)|=3 n^{2}$, as desired.

Back to the problem, take any chameleon $X$ and notice that $d(X, P)+d(X, Q) \geqslant d(P, Q) \geqslant$ $3 n^{2}$ by the lemma. Consequently, $\max \{d(X, P), d(X, Q)\} \geqslant \frac{3 n^{2}}{2}$, which establishes the problem statement.",3,"For a chameleon $X$, let $f_{u,v}(X)$ be the number of pairs of positions where letter $u$ appears before letter $v$. Define $f(X) = f_{a,b}(X) + f_{a,c}(X) + f_{b,c}(X)$. Show that if a chameleon $X'$ is obtained from $X$ by a single swap of two adjacent, distinct letters, then $|f(X') - f(X)| = 1$.","Let the swap be between letters $u$ and $v$ at adjacent positions, with $u$ to the left of $v$. This swap only changes the relative order of this specific pair of letters. Thus, for any pair of distinct letters $\{x, y\} \neq \{u, v\}$, the value of $f_{x,y}(X)$ remains unchanged. The value of $f_{u,v}(X)$ decreases by 1, while $f_{v,u}(X)$ increases by 1. The function $f(X)$ sums three such terms. If the swapped pair $\{u, v\}$ is not one of $\{a, b\}$, $\{a, c\}$, or $\{b, c\}$, then $f(X)$ is unchanged (a value of 0). If the swapped pair is one of these, say $\{a, b\}$, then exactly one term in the sum for $f(X)$ changes by 1. For example, if we swap an adjacent 'a' and 'b' ($ab \to ba$), $f_{a,b}$ decreases by 1, while $f_{a,c}$ and $f_{b,c}$ are unchanged. Thus, $f(X)$ changes by exactly 1.","Let $P$ be the chameleon consisting of $n$ letters 'a', followed by $n$ letters 'b', followed by $n$ letters 'c'. Let $Q$ be the chameleon consisting of $n$ letters 'c', followed by $n$ letters 'b', followed by $n$ letters 'a'. Prove that the minimum number of swaps to transform $P$ into $Q$, denoted $d(P, Q)$, is at least $3n^2$.","Let $f(X)$ be the function defined in the previous sub-problem. For chameleon $P$, every 'a' is before every 'b' ($n^2$ pairs), every 'a' is before every 'c' ($n^2$ pairs), and every 'b' is before every 'c' ($n^2$ pairs). So, $f(P) = f_{a,b}(P) + f_{a,c}(P) + f_{b,c}(P) = n^2 + n^2 + n^2 = 3n^2$. For chameleon $Q$, the orders are all reversed, so $f_{a,b}(Q)=0$, $f_{a,c}(Q)=0$, and $f_{b,c}(Q)=0$, which means $f(Q)=0$. Since each swap changes $f(X)$ by at most 1, the number of swaps $d(P, Q)$ must be at least the total change in $f$, which is $|f(P) - f(Q)| = |3n^2 - 0| = 3n^2$.","Let $n$ be a positive integer. Define a chameleon to be any sequence of $3 n$ letters, with exactly $n$ occurrences of each of the letters $a, b$, and $c$. Define a swap to be the transposition of two adjacent letters in a chameleon. Prove that for any chameleon $X$, there exists a chameleon $Y$ such that $X$ cannot be changed to $Y$ using fewer than $3 n^{2} / 2$ swaps.","Let $d(X,Y)$ be the minimum number of swaps to change $X$ to $Y$. This distance function satisfies the triangle inequality: $d(X,Z) \le d(X,Y) + d(Y,Z)$. Let $P$ be the chameleon with all 'a's first, then all 'b's, then all 'c's, and let $Q$ be the chameleon with all 'c's first, then all 'b's, then all 'a's. From the previous sub-problem, $d(P,Q) \ge 3n^2$. For any chameleon $X$, the triangle inequality implies $d(X,P) + d(X,Q) \ge d(P,Q)$. Therefore, $d(X,P) + d(X,Q) \ge 3n^2$. This means that at least one of $d(X,P)$ or $d(X,Q)$ must be greater than or equal to $3n^2/2$. Thus, for any $X$, we can choose $Y$ to be either $P$ or $Q$, and the required number of swaps will be at least $3n^2/2$.",,
2017c4,"Let $N \geqslant 2$ be an integer. $N(N+1)$ soccer players, no two of the same height, stand in a row in some order. Coach Ralph wants to remove $N(N-1)$ people from this row so that in the remaining row of $2 N$ players, no one stands between the two tallest ones, no one stands between the third and the fourth tallest ones, ..., and finally no one stands between the two shortest ones. Show that this is always possible.","Split the row into $N$ blocks with $N+1$ consecutive people each. We will show how to remove $N-1$ people from each block in order to satisfy the coach's wish.

First, construct a $(N+1) \times N$ matrix where $x_{i, j}$ is the height of the $i^{\text {th }}$ tallest person of the $j^{\text {th }}$ block-in other words, each column lists the heights within a single block, sorted in decreasing order from top to bottom.

We will reorder this matrix by repeatedly swapping whole columns. First, by column permutation, make sure that $x_{2,1}=\max \left\{x_{2, i}: i=1,2, \ldots, N\right\}$ (the first column contains the largest height of the second row). With the first column fixed, permute the other ones so that $x_{3,2}=\max \left\{x_{3, i}: i=2, \ldots, N\right\}$ (the second column contains the tallest person of the third row, first column excluded). In short, at step $k(k=1,2, \ldots, N-1)$, we permute the columns from $k$ to $N$ so that $x_{k+1, k}=\max \left\{x_{i, k}: i=k, k+1, \ldots, N\right\}$, and end up with an array like this:

\begin{center}
\begin{tabular}{|l|l|l|l|l|l|}
\hline
$\boldsymbol{x}_{1,1}$ & $x_{1,2}$ & $x_{1,3}$ & $\cdots$ & $x_{1, N-1}$ & $x_{1, N}$ \\
\hline
V & V & V &  & $\checkmark$ & $\checkmark$ \\
\hline
\begin{tabular}{l}
$\boldsymbol{x}_{2,1}$ \\
$>$ \\
\end{tabular} & $\boldsymbol{x}_{2,2}$ & $x_{2,3}$ & $\cdots$ & $x_{2, N-1}$ & $x_{2, N}$ \\
\hline
V & V & V &  & $\checkmark$ & V \\
\hline
$x_{3,1}$ & \begin{tabular}{l}
$\boldsymbol{x}_{3,2}$ \\
$>$ \\
\end{tabular} & $\boldsymbol{x}_{3,3}$ & $\cdots$ & $x_{3, N-1}$ & $x_{3, N}$ \\
\hline
V & V & V &  & $\checkmark$ & V \\
\hline
! & : & : & $\bullet \cdot$ & : & : \\
\hline
V & V & V &  & V & V \\
\hline
$x_{N, 1}$ & $x_{N, 2}$ & $x_{N, 3}$ & $\cdots$ & $x_{N, N-1}>$ & $\boldsymbol{x}_{N, N}$ \\
\hline
$\checkmark$ & $\checkmark$ & $\checkmark$ &  & $V$ & V \\
\hline
$x_{N+1,1}$ & $x_{N+1,2}$ & $x_{N+1,3}$ & $\cdots$ & $x_{N+1, N-1}$ & $x_{N+1, N}$ \\
\hline
\end{tabular}
\end{center}

Now we make the bold choice: from the original row of people, remove everyone but those with heights


\begin{equation*}
x_{1,1}>x_{2,1}>x_{2,2}>x_{3,2}>\cdots>x_{N, N-1}>x_{N, N}>x_{N+1, N} \tag{*}
\end{equation*}


Of course this height order (*) is not necessarily their spatial order in the new row. We now need to convince ourselves that each pair ( $x_{k, k} ; x_{k+1, k}$ ) remains spatially together in this new row. But $x_{k, k}$ and $x_{k+1, k}$ belong to the same column/block of consecutive $N+1$ people; the only people that could possibly stand between them were also in this block, and they are all gone.",3,"Let the $N(N+1)$ players be partitioned into $N$ consecutive blocks of $N+1$ players each. Let $x_{i,j}$ be the height of the $i$-th tallest person in the $j$-th block. Show that it is possible to order the blocks, indexed by $j=1, \\dots, N$, such that for each $k \\in \\{1, \\dots, N-1\\}$, we have $x_{k+1, k} = \\max\\{x_{k+1, j} \\mid j=k, \\dots, N\\}$.","This ordering can be constructed greedily. For $k=1, 2, \\dots, N-1$ sequentially, we determine the block to be placed in the $k$-th position. At step $k$, choose from the remaining $N-k+1$ available blocks the one whose $(k+1)$-th tallest player is the tallest among the $(k+1)$-th tallest players of these remaining blocks. Since all heights are unique, this choice is always unique. The final remaining block is placed in the $N$-th position. This procedure results in the desired ordering of blocks.","Consider the matrix of heights $[x_{i,j}]$ ordered as in Sub-problem 1. Let $S$ be the set of $2N$ players whose heights are $\{x_{k,k}, x_{k+1,k} \\mid k=1, \\dots, N\}$. Prove that for each $k \\in \\{1, \\dots, N\\}$, the player with height $x_{k,k}$ is the $(2k-1)$-th tallest in $S$, and the player with height $x_{k+1,k}$ is the $(2k)$-th tallest in $S$.","From the construction, we have two key inequalities: (1) $x_{i,j} > x_{i+1,j}$ for all $i,j$ (columns are sorted by height), and (2) $x_{k+1,k} > x_{k+1,j}$ for all $j>k$. These imply the chain $x_{k,k} > x_{k+1,k} > x_{k+1,k+1}$. Iterating this shows that for any $j<k$, both players from block $j$ are taller than both players from block $k$. Conversely, for any $j>k$, both players from block $j$ are shorter than both players from block $k$. Thus, for a given $k$, the players in $S$ taller than $x_{k,k}$ are exactly the $2(k-1)$ players from blocks $1, \\dots, k-1$. This makes $x_{k,k}$ the $(2k-1)$-th tallest. Its partner $x_{k+1,k}$ is shorter than $x_{k,k}$ but taller than all players from blocks $j>k$. So, there are $2(k-1)+1=2k-1$ players in $S$ taller than $x_{k+1,k}$, making it the $(2k)$-th tallest.","Let $N \\geqslant 2$ be an integer. $N(N+1)$ soccer players, no two of the same height, stand in a row in some order. Coach Ralph wants to remove $N(N-1)$ people from this row so that in the remaining row of $2 N$ players, no one stands between the two tallest ones, no one stands between the third and the fourth tallest ones, ..., and finally no one stands between the two shortest ones. Show that this is always possible.","First, partition the row of players into $N$ consecutive blocks of $N+1$ players. Conceptually arrange these blocks as columns of a height matrix $[x_{i,j}]$ as constructed in Sub-problem 1. Select the $2N$ players with heights $S = \\{x_{k,k}, x_{k+1,k} \\mid k=1, \\dots, N\\}$, and remove all others. According to Sub-problem 2, for each $k$, the players with heights $x_{k,k}$ and $x_{k+1,k}$ are the $(2k-1)$-th and $(2k)$-th tallest players in the selected group. Since both of these players originated from the same block of $N+1$ consecutive players in the initial row, and all other players from that block have been removed, they must be adjacent in the final row. This holds for all $k=1, \\dots, N$, so the required arrangement is always possible.",,
2017c7,"For any finite sets $X$ and $Y$ of positive integers, denote by $f_{X}(k)$ the $k^{\text {th }}$ smallest positive integer not in $X$, and let

$$
X * Y=X \cup\left\{f_{X}(y): y \in Y\right\}
$$

Let $A$ be a set of $a>0$ positive integers, and let $B$ be a set of $b>0$ positive integers. Prove that if $A * B=B * A$, then


\begin{equation*}
\underbrace{A *(A * \cdots *(A *(A * A)) \ldots)}_{A \text { appears } b \text { times }}=\underbrace{B *(B * \cdots *(B *(B * B)) \ldots)}_{B \text { appears } a \text { times }} 
\end{equation*}","For any function $g: \mathbb{Z}_{>0} \rightarrow \mathbb{Z}_{>0}$ and any subset $X \subset \mathbb{Z}_{>0}$, we define $g(X)=$ $\{g(x): x \in X\}$. We have that the image of $f_{X}$ is $f_{X}\left(\mathbb{Z}_{>0}\right)=\mathbb{Z}_{>0} \backslash X$. We now show a general lemma about the operation $*$, with the goal of showing that $*$ is associative.\\
Lemma 1. Let $X$ and $Y$ be finite sets of positive integers. The functions $f_{X * Y}$ and $f_{X} \circ f_{Y}$ are equal.\\
Proof. We have\\
$f_{X * Y}\left(\mathbb{Z}_{>0}\right)=\mathbb{Z}_{>0} \backslash(X * Y)=\left(\mathbb{Z}_{>0} \backslash X\right) \backslash f_{X}(Y)=f_{X}\left(\mathbb{Z}_{>0}\right) \backslash f_{X}(Y)=f_{X}\left(\mathbb{Z}_{>0} \backslash Y\right)=f_{X}\left(f_{Y}\left(\mathbb{Z}_{>0}\right)\right)$.\\
Thus, the functions $f_{X * Y}$ and $f_{X} \circ f_{Y}$ are strictly increasing functions with the same range. Because a strictly function is uniquely defined by its range, we have $f_{X * Y}=f_{X} \circ f_{Y}$.

Lemma 1 implies that $*$ is associative, in the sense that $(A * B) * C=A *(B * C)$ for any finite sets $A, B$, and $C$ of positive integers. We prove the associativity by noting

$$
\begin{gathered}
\mathbb{Z}_{>0} \backslash((A * B) * C)=f_{(A * B) * C}\left(\mathbb{Z}_{>0}\right)=f_{A * B}\left(f_{C}\left(\mathbb{Z}_{>0}\right)\right)=f_{A}\left(f_{B}\left(f_{C}\left(\mathbb{Z}_{>0}\right)\right)\right) \\
=f_{A}\left(f_{B * C}\left(\mathbb{Z}_{>0}\right)=f_{A *(B * C)}\left(\mathbb{Z}_{>0}\right)=\mathbb{Z}_{>0} \backslash(A *(B * C))\right.
\end{gathered}
$$

In light of the associativity of $*$, we may drop the parentheses when we write expressions like $A *(B * C)$. We also introduce the notation

$$
X^{* k}=\underbrace{X *(X * \cdots *(X *(X * X)) \ldots)}_{X \text { appears } k \text { times }}
$$

Our goal is then to show that $A * B=B * A$ implies $A^{* b}=B^{* a}$. We will do so via the following general lemma.\\
Lemma 2. Suppose that $X$ and $Y$ are finite sets of positive integers satisfying $X * Y=Y * X$ and $|X|=|Y|$. Then, we must have $X=Y$.\\
Proof. Assume that $X$ and $Y$ are not equal. Let $s$ be the largest number in exactly one of $X$ and $Y$. Without loss of generality, say that $s \in X \backslash Y$. The number $f_{X}(s)$ counts the $s^{t h}$ number not in $X$, which implies that


\begin{equation*}
f_{X}(s)=s+\left|X \cap\left\{1,2, \ldots, f_{X}(s)\right\}\right| \tag{1}
\end{equation*}


Since $f_{X}(s) \geqslant s$, we have that

$$
\left\{f_{X}(s)+1, f_{X}(s)+2, \ldots\right\} \cap X=\left\{f_{X}(s)+1, f_{X}(s)+2, \ldots\right\} \cap Y
$$

which, together with the assumption that $|X|=|Y|$, gives


\begin{equation*}
\left|X \cap\left\{1,2, \ldots, f_{X}(s)\right\}\right|=\left|Y \cap\left\{1,2, \ldots, f_{X}(s)\right\}\right| \tag{2}
\end{equation*}


Now consider the equation

$$
t-|Y \cap\{1,2, \ldots, t\}|=s .
$$

This equation is satisfied only when $t \in\left[f_{Y}(s), f_{Y}(s+1)\right.$ ), because the left hand side counts the number of elements up to $t$ that are not in $Y$. We have that the value $t=f_{X}(s)$ satisfies the above equation because of (1) and (2). Furthermore, since $f_{X}(s) \notin X$ and $f_{X}(s) \geqslant s$, we have that $f_{X}(s) \notin Y$ due to the maximality of $s$. Thus, by the above discussion, we must have $f_{X}(s)=f_{Y}(s)$.

Finally, we arrive at a contradiction. The value $f_{X}(s)$ is neither in $X$ nor in $f_{X}(Y)$, because $s$ is not in $Y$ by assumption. Thus, $f_{X}(s) \notin X * Y$. However, since $s \in X$, we have $f_{Y}(s) \in Y * X$, a contradiction.

We are now ready to finish the proof. Note first of all that $\left|A^{* b}\right|=a b=\left|B^{* a}\right|$. Moreover, since $A * B=B * A$, and $*$ is associative, it follows that $A^{* b} * B^{* a}=B^{* a} * A^{* b}$. Thus, by Lemma 2, we have $A^{* b}=B^{* a}$, as desired.",4,"For any finite sets of positive integers $X, Y, Z$, prove that the operation $*$ is associative, i.e., $(X * Y) * Z = X * (Y * Z)$.","First, we show that $f_{X*Y} = f_X \circ f_Y$. The range of $f_{X*Y}$ is $\\mathbb{Z}_{>0} \\setminus (X*Y) = (\\mathbb{Z}_{>0} \\setminus X) \\setminus f_X(Y) = f_X(\\mathbb{Z}_{>0}) \\setminus f_X(Y) = f_X(\\mathbb{Z}_{>0} \\setminus Y) = f_X(f_Y(\\mathbb{Z}_{>0}))$. Since $f_{X*Y}$ and $f_X \\circ f_Y$ are strictly increasing functions with the same range, they are equal. Now, consider the complements of the sets. The complement of $(X*Y)*Z$ is the range of $f_{(X*Y)*Z} = f_{X*Y} \\circ f_Z = (f_X \\circ f_Y) \\circ f_Z$. The complement of $X*(Y*Z)$ is the range of $f_{X*(Y*Z)} = f_X \\circ f_{Y*Z} = f_X \\circ (f_Y \\circ f_Z)$. By associativity of function composition, the complements are the same, so the sets are equal.","Let $X$ and $Y$ be finite sets of positive integers. Prove that if $X * Y = Y * X$ and $|X|=|Y|$, then $X=Y$.","Assume for contradiction that $X \neq Y$. Let $s$ be the largest integer in the symmetric difference $X \\Delta Y$. Without loss of generality, assume $s \\in X \\setminus Y$. From $|X|=|Y|$ and the maximality of $s$, we deduce that for any integer $k \\ge s$, $|X \\cap \\{1,...,k\\}| = |Y \\cap \\{1,...,k\\}|$. Using the identity $f_Z(k) = k + |Z \\cap \\{1, ..., f_Z(k)\\}|$, and since $f_X(s) \\ge s$, we can deduce that $f_X(s) = f_Y(s)$. This leads to a contradiction: since $s \\in X$, we have $f_Y(s) \\in \\{f_Y(x) : x \\in X\\} \\subseteq Y * X$. However, since $s \notin Y$, we have $f_X(s) \notin \\{f_X(y) : y \\in Y\\}$, and by definition $f_X(s) \notin X$, so $f_X(s) \notin X * Y$. This contradicts $X*Y = Y*X$, so we must have $X=Y$.","Define $X^{*k} = X * (X * \\cdots * X)$ ($k$ times). Given that $|A|=a$, $|B|=b$, and $A * B = B * A$, show that the sets $X=A^{*b}$ and $Y=B^{*a}$ satisfy $|X|=|Y|$ and $X*Y = Y*X$.","The set of newly added elements $\{f_X(y): y \in Y\}$ is disjoint from $X$. Thus, $|X*Y| = |X|+|Y|$. By induction, $|A^{*b}| = b|A| = ba$ and $|B^{*a}| = a|B| = ab$. Thus $|A^{*b}| = |B^{*a}|$. From sub-problem 1, the $*$ operation is associative. This allows us to write $A^{*b} * B^{*a}$ as the composition of $b$ $A$'s and $a$ $B$'s without parentheses. Since $A*B=B*A$, we can swap any adjacent pair of $A$ and $B$. By repeated swaps, we can move all $B$'s to the front, showing $A^{*b} * B^{*a} = B^{*a} * A^{*b}$.","Let $A$ be a set of $a>0$ positive integers, and let $B$ be a set of $b>0$ positive integers. Prove that if $A * B=B * A$, then $\\underbrace{A *(A * \\cdots *(A *(A * A)) \\ldots)}_{A \text { appears } b \text { times }}=\\underbrace{B *(B * \\cdots *(B *(B * B)) \\ldots)}_{B \text { appears } a \text { times }}$.","Let $X = A^{*b}$ and $Y = B^{*a}$. From sub-problem 3, we have established that $|X|=|Y|$ (both are equal to $ab$) and that $X*Y = Y*X$. Applying the result from sub-problem 2, which states that if two sets of the same cardinality commute under the $*$ operation then they must be equal, we conclude that $X=Y$. This is the desired result, $A^{*b} = B^{*a}$."
2017g1,"Let $A B C D E$ be a convex pentagon such that $A B=B C=C D, \angle E A B=\angle B C D$, and $\angle E D C=\angle C B A$. Prove that the perpendicular line from $E$ to $B C$ and the line segments $A C$ and $B D$ are concurrent.","Throughout the solution, we refer to $\angle A, \angle B, \angle C, \angle D$, and $\angle E$ as internal angles of the pentagon $A B C D E$. Let the perpendicular bisectors of $A C$ and $B D$, which pass respectively through $B$ and $C$, meet at point $I$. Then $B D \perp C I$ and, similarly, $A C \perp B I$. Hence $A C$ and $B D$ meet at the orthocenter $H$ of the triangle $B I C$, and $I H \perp B C$. It remains to prove that $E$ lies on the line $I H$ or, equivalently, $E I \perp B C$.

Lines $I B$ and $I C$ bisect $\angle B$ and $\angle C$, respectively. Since $I A=I C, I B=I D$, and $A B=$ $B C=C D$, the triangles $I A B, I C B$ and $I C D$ are congruent. Hence $\angle I A B=\angle I C B=$ $\angle C / 2=\angle A / 2$, so the line $I A$ bisects $\angle A$. Similarly, the line $I D$ bisects $\angle D$. Finally, the line $I E$ bisects $\angle E$ because $I$ lies on all the other four internal bisectors of the angles of the pentagon.

The sum of the internal angles in a pentagon is $540^{\circ}$, so

$$
\angle E=540^{\circ}-2 \angle A+2 \angle B .
$$

In quadrilateral $A B I E$,

$$
\begin{aligned}
\angle B I E & =360^{\circ}-\angle E A B-\angle A B I-\angle A E I=360^{\circ}-\angle A-\frac{1}{2} \angle B-\frac{1}{2} \angle E \\
& =360^{\circ}-\angle A-\frac{1}{2} \angle B-\left(270^{\circ}-\angle A-\angle B\right) \\
& =90^{\circ}+\frac{1}{2} \angle B=90^{\circ}+\angle I B C,
\end{aligned}
$$

which means that $E I \perp B C$, completing the proof.\\",3,"Let $I$ be the intersection of the line through $B$ perpendicular to $AC$ and the line through $C$ perpendicular to $BD$. Show that the concurrency of $AC$, $BD$, and the perpendicular from $E$ to $BC$ is equivalent to proving $EI \perp BC$.","Let $H$ be the intersection of $AC$ and $BD$. In $\triangle BIC$, the line $AC$ contains the altitude from $C$ to side $BI$ (since $BI \\perp AC$), and the line $BD$ contains the altitude from $B$ to side $CI$ (since $CI \\perp BD$). Thus, $H$ is the orthocenter of $\triangle BIC$. The third altitude of $\triangle BIC$ lies on the line $IH$ and is perpendicular to $BC$. The problem states that $AC$, $BD$, and the perpendicular from $E$ to $BC$ are concurrent. As $AC$ and $BD$ meet at $H$, this is equivalent to the line $EH$ being perpendicular to $BC$. Since $IH \\perp BC$, this is equivalent to $E$ being on the line $IH$, which means proving $EI \\perp BC$.",Let $I$ be the point defined in sub-problem 1. Show that $I$ is the concurrency point of the internal angle bisectors of the pentagon $A B C D E$.,"Since $AB=BC$, the line through $B$ perpendicular to $AC$ is the perpendicular bisector of $AC$, so $IA=IC$. Since $BC=CD$, the line through $C$ perpendicular to $BD$ is the perpendicular bisector of $BD$, so $IB=ID$. Given $AB=BC=CD$, we have $\triangle IAB \\cong \triangle ICB \\cong \triangle ICD$ by SSS. From these congruences, $IB$ bisects $\\angle ABC$ and $IC$ bisects $\\angle BCD$. Also, $\\angle IAB = \\angle ICB = \frac{1}{2}\\angle BCD = \frac{1}{2}\\angle EAB$ (using $\\angle EAB=\\angle BCD$), so $IA$ bisects $\\angle EAB$. Similarly, $\\angle IDC = \\angle IBC = \frac{1}{2}\\angle ABC = \frac{1}{2}\\angle EDC$ (using $\\angle EDC=\\angle CBA$), so $ID$ bisects $\\angle EDC$. Since $I$ lies on the angle bisectors of $\\angle A, \\angle B, \\angle C, \\angle D$, it is equidistant from the lines containing the sides of the pentagon, and thus must also lie on the angle bisector of $\\angle E$.","Let $A B C D E$ be a convex pentagon such that $A B=B C=C D, \\angle E A B=\\angle B C D$, and $\\angle E D C=\\angle C B A$. Prove that the perpendicular line from $E$ to $B C$ and the line segments $A C$ and $B D$ are concurrent.","From sub-problem 1, the problem is equivalent to proving $EI \\perp BC$. From sub-problem 2, $I$ is the concurrency point of the pentagon's internal angle bisectors. Let the internal angles be $\\angle A, \\angle B, \\angle C, \\angle D, \\angle E$. We have $\\angle A = \\angle C$ and $\\angle B = \\angle D$. The sum of angles in a pentagon is $540^\\circ$, so $\\angle E = 540^\\circ - 2\\angle A - 2\\angle B$. In quadrilateral $ABIE$, the sum of angles is $360^\\circ$. So, $\\angle BIE = 360^\\circ - \\angle A - \\angle ABI - \\angle AEI = 360^\\circ - \\angle A - \frac{1}{2}\\angle B - \frac{1}{2}\\angle E$. Substituting for $\\angle E$, we get $\\angle BIE = 360^\\circ - \\angle A - \frac{1}{2}\\angle B - (270^\\circ - \\angle A - \\angle B) = 90^\\circ + \frac{1}{2}\\angle B$. As $IB$ bisects $\\angle B$, $\\angle IBC = \frac{1}{2}\\angle B$. The relation $\\angle BIE = 90^\\circ + \\angle IBC$ implies that line $EI$ is perpendicular to line $BC$, which completes the proof.",,
2017g2,"Let $R$ and $S$ be distinct points on circle $\Omega$, and let $t$ denote the tangent line to $\Omega$ at $R$. Point $R^{\prime}$ is the reflection of $R$ with respect to $S$. A point $I$ is chosen on the smaller arc $R S$ of $\Omega$ so that the circumcircle $\Gamma$ of triangle $I S R^{\prime}$ intersects $t$ at two different points. Denote by $A$ the common point of $\Gamma$ and $t$ that is closest to $R$. Line $A I$ meets $\Omega$ again at $J$. Show that $J R^{\prime}$ is tangent to $\Gamma$.","In the circles $\Omega$ and $\Gamma$ we have $\angle J R S=\angle J I S=\angle A R^{\prime} S$. On the other hand, since $R A$ is tangent to $\Omega$, we get $\angle S J R=\angle S R A$. So the triangles $A R R^{\prime}$ and $S J R$ are similar, and

$$
\frac{R^{\prime} R}{R J}=\frac{A R^{\prime}}{S R}=\frac{A R^{\prime}}{S R^{\prime}} .
$$

The last relation, together with $\angle A R^{\prime} S=\angle J R R^{\prime}$, yields $\triangle A S R^{\prime} \sim \triangle R^{\prime} J R$, hence $\angle S A R^{\prime}=\angle R R^{\prime} J$. It follows that $J R^{\prime}$ is tangent to $\Gamma$ at $R^{\prime}$.\\",2,"Show that triangles $\triangle SJR$ and $\triangle ARR'$ are similar, and as a consequence, establish the relation $\frac{R'R}{RJ} = \frac{AR'}{SR}$.","In circle $\Omega$, the points $I, J, R, S$ are concyclic, so $\angle JRS = \angle JIS$. In circle $\Gamma$, the points $I, S, R', A$ are concyclic, so $\angle JIS = \angle AR'S$. Therefore, $\angle JRS = \angle AR'S$. As $R, S, R'$ are collinear, this implies $\angle JRS = \angle AR'R$.
Line $t=AR$ is tangent to $\Omega$ at $R$. By the tangent-chord theorem, $\angle SRA = \angle SJR$. Since $R, S, R'$ are collinear, $\angle SRA$ is the same as $\angle ARR'$. Thus, $\angle ARR' = \angle SJR$.
Having two pairs of equal angles, we conclude that $\triangle SJR \sim \triangle ARR'$. From this similarity, the ratio of corresponding sides is equal: $\frac{JR}{RR'} = \frac{SR}{AR'}$. Rearranging this gives the desired relation $\frac{R'R}{RJ} = \frac{AR'}{SR}$.",Show that $J R^{\prime}$ is tangent to $\Gamma$.,"From the first sub-problem, we have the proportion $\frac{R'R}{RJ} = \frac{AR'}{SR}$. Since $R'$ is the reflection of $R$ with respect to $S$, $S$ is the midpoint of $RR'$, so $SR=SR'$. The proportion becomes $\frac{R'R}{RJ} = \frac{AR'}{SR'}$, which can be rearranged to $\frac{AR'}{R'R} = \frac{SR'}{RJ}$.
We also know from the angle chasing in the first part that $\angle AR'S = \angle JRS$. As $R, S, R'$ are collinear, $\angle JRS = \angle JRR'$, so $\angle AR'S = \angle JRR'$.
Now, consider triangles $\triangle ASR'$ and $\triangle R'JR$. We have an equal angle $\angle AR'S = \angle JRR'$ and the ratio of including sides is equal: $\frac{AR'}{R'R} = \frac{SR'}{RJ}$. By the Side-Angle-Side similarity criterion, $\triangle ASR' \sim \triangle R'JR$. 
This similarity implies the equality of corresponding angles, specifically $\angle SAR' = \angle JR'R$. Since $R,S,R'$ are collinear, $\angle JR'R = \angle JR'S$. Therefore, $\angle SAR' = \angle JR'S$. By the converse of the tangent-chord theorem, this equality implies that the line $JR'$ is tangent to the circle $\Gamma$ at point $R'$.",,,,
2017g3,"Let $O$ be the circumcenter of an acute scalene triangle $A B C$. Line $O A$ intersects the altitudes of $A B C$ through $B$ and $C$ at $P$ and $Q$, respectively. The altitudes meet at $H$. Prove that the circumcenter of triangle $P Q H$ lies on a median of triangle $A B C$.","Solution. Suppose, without loss of generality, that $A B<A C$. We have $\angle P Q H=90^{\circ}-$ $\angle Q A B=90^{\circ}-\angle O A B=\frac{1}{2} \angle A O B=\angle A C B$, and similarly $\angle Q P H=\angle A B C$. Thus triangles $A B C$ and $H P Q$ are similar. Let $\Omega$ and $\omega$ be the circumcircles of $A B C$ and $H P Q$, respectively. Since $\angle A H P=90^{\circ}-\angle H A C=\angle A C B=\angle H Q P$, line $A H$ is tangent to $\omega$.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_3d725d21cc83abfed093g-61}

Let $T$ be the center of $\omega$ and let lines $A T$ and $B C$ meet at $M$. We will take advantage of the similarity between $A B C$ and $H P Q$ and the fact that $A H$ is tangent to $\omega$ at $H$, with $A$ on line $P Q$. Consider the corresponding tangent $A S$ to $\Omega$, with $S \in B C$. Then $S$ and $A$ correspond to each other in $\triangle A B C \sim \triangle H P Q$, and therefore $\angle O S M=\angle O A T=\angle O A M$. Hence quadrilateral $S A O M$ is cyclic, and since the tangent line $A S$ is perpendicular to $A O$, $\angle O M S=180^{\circ}-\angle O A S=90^{\circ}$. This means that $M$ is the orthogonal projection of $O$ onto $B C$, which is its midpoint. So $T$ lies on median $A M$ of triangle $A B C$.",2,"Let $O$ be the circumcenter of an acute scalene triangle $A B C$. Line $O A$ intersects the altitudes of $A B C$ through $B$ and $C$ at $P$ and $Q$, respectively. The altitudes meet at $H$. Let $\omega$ be the circumcircle of triangle $P Q H$. Prove that triangle $H P Q$ is similar to triangle $A B C$ and that line $A H$ is tangent to $\omega$.","Let the altitudes from $B$ and $C$ be $BE$ and $CF$. $P$ is on $BE$, $Q$ on $CF$, and line $PQ$ is line $OA$. In right triangle $\triangle AFQ$, $\angle AQF = 90^\circ - \angle FAQ = 90^\circ - \angle OAB$. Since $\triangle OAB$ is isosceles ($OA=OB$), $\angle OAB = 90^\circ - \angle C$. Thus $\angle PQH = \angle C$. Similarly, $\angle QPH = \angle B$. Therefore, $\triangle HPQ \sim \triangle ABC$. To show tangency, we prove $\angle AHP = \angle HQP$. We know $\angle HQP = \angle C$. In right triangle $\triangle AEH$, $\angle AHE = 90^\circ - \angle EAH = 90^\circ - (90^\circ - \angle C) = \angle C$. Thus $\angle AHP = \angle HQP$. By the tangent-chord theorem, $AH$ is tangent to $\omega$ at $H$.","Let $O$ be the circumcenter of an acute scalene triangle $A B C$. Line $O A$ intersects the altitudes of $A B C$ through $B$ and $C$ at $P$ and $Q$, respectively. The altitudes meet at $H$. Prove that the circumcenter of triangle $P Q H$ lies on a median of triangle $A B C$.","Let $T$ be the circumcenter of $\triangle PQH$. Let line $AT$ intersect $BC$ at $M$. We use the facts that $\triangle HPQ \sim \triangle ABC$ and line $AH$ is tangent to the circumcircle of $\triangle PQH$ at $H$. Let $\Omega$ be the circumcircle of $\triangle ABC$. Let $S$ be a point on $BC$ such that $AS$ is tangent to $\Omega$ at $A$. The similarity of the geometric configurations implies that the triplet of points $(A, T, H)$ relative to $\triangle PQH$ corresponds to the triplet $(S, O, A)$ relative to $\triangle ABC$. This similarity preserves angles between corresponding lines. Thus, the angle between $AT$ and $AO$ equals the angle between $SO$ and $BC$. This means $\angle OAM = \angle(SO, BC)$, implying $S, A, O, M$ are concyclic. Since $AS$ is tangent to $\Omega$ at $A$, $OA \perp AS$, so $\angle OAS = 90^\circ$. In cyclic quadrilateral $SAOM$, $\angle OMS = 180^\circ - \angle OAS = 90^\circ$. So $OM \perp BC$. As $O$ is the circumcenter, $M$ must be the midpoint of $BC$. Thus, $T$ lies on the median $AM$.",,,,
2017g4,"In triangle $A B C$, let $\omega$ be the excircle opposite $A$. Let $D, E$, and $F$ be the points where $\omega$ is tangent to lines $B C, C A$, and $A B$, respectively. The circle $A E F$ intersects line $B C$ at $P$ and $Q$. Let $M$ be the midpoint of $A D$. Prove that the circle $M P Q$ is tangent to $\omega$.","Denote by $\Omega$ the circle $A E F P Q$, and denote by $\gamma$ the circle $P Q M$. Let the line $A D$ meet $\omega$ again at $T \neq D$. We will show that $\gamma$ is tangent to $\omega$ at $T$.

We first prove that points $P, Q, M, T$ are concyclic. Let $A^{\prime}$ be the center of $\omega$. Since $A^{\prime} E \perp A E$ and $A^{\prime} F \perp A F, A A^{\prime}$ is a diameter in $\Omega$. Let $N$ be the midpoint of $D T$; from $A^{\prime} D=A^{\prime} T$ we can see that $\angle A^{\prime} N A=90^{\circ}$ and therefore $N$ also lies on the circle $\Omega$. Now, from the power of $D$ with respect to the circles $\gamma$ and $\Omega$ we get

$$
D P \cdot D Q=D A \cdot D N=2 D M \cdot \frac{D T}{2}=D M \cdot D T
$$

so $P, Q, M, T$ are concyclic.\\
If $E F \| B C$, then $A B C$ is isosceles and the problem is now immediate by symmetry. Otherwise, let the tangent line to $\omega$ at $T$ meet line $B C$ at point $R$. The tangent line segments $R D$ and $R T$ have the same length, so $A^{\prime} R$ is the perpendicular bisector of $D T$; since $N D=N T$, $N$ lies on this perpendicular bisector.

In right triangle $A^{\prime} R D, R D^{2}=R N \cdot R A^{\prime}=R P \cdot R Q$, in which the last equality was obtained from the power of $R$ with respect to $\Omega$. Hence $R T^{2}=R P \cdot R Q$, which implies that $R T$ is also tangent to $\gamma$. Because $R T$ is a common tangent to $\omega$ and $\gamma$, these two circles are tangent at $T$.\\",3,"Let $\omega$ be the excircle of $\triangle ABC$ opposite to $A$, tangent to $BC$ at $D$, $CA$ at $E$, and $AB$ at $F$. Let the line $AD$ intersect $\omega$ again at $T$, and let $N$ be the midpoint of $DT$. Prove that $N$ lies on the circle $AEF$.","Let $A'$ be the center of $\omega$. Since $A'E \perp AE$ and $A'F \perp AF$, the circle passing through $A, E, F$ is the circle with diameter $AA'$. Let's call this circle $\Omega$. In $\triangle A'DT$, $A'D = A'T$ are radii of $\omega$, so it is an isosceles triangle. Since $N$ is the midpoint of the base $DT$, $A'N$ is the altitude, so $A'N \perp DT$. As $A, D, T$ are collinear, this implies $\angle A'NA = 90^\circ$. Therefore, $N$ must lie on the circle with diameter $AA'$, which is the circle $AEF$.","Let the circle $AEF$ intersect line $BC$ at $P$ and $Q$. Let $M$ be the midpoint of $AD$, and let $T$ be the other intersection of line $AD$ with $\omega$. Prove that the points $P, Q, M, T$ are concyclic.","From the previous sub-problem, the point $N$ (midpoint of $DT$) lies on the circle $AEF$, which we denote as $\Omega$. The points $P$ and $Q$ also lie on $\Omega$ by definition. Applying the power of point $D$ with respect to circle $\Omega$, we have $DP \cdot DQ = DA \cdot DN$. Since $M$ is the midpoint of $AD$ and $N$ is the midpoint of $DT$, we can write $DA = 2DM$ and $DN = DT/2$. Substituting these into the equation gives $DP \cdot DQ = (2DM) \cdot (DT/2) = DM \cdot DT$. By the converse of the power of a point theorem, this implies that the points $P, Q, M, T$ are concyclic.","In triangle $A B C$, let $\omega$ be the excircle opposite $A$. Let $D, E$, and $F$ be the points where $\omega$ is tangent to lines $B C, C A$, and $A B$, respectively. The circle $A E F$ intersects line $B C$ at $P$ and $Q$. Let $M$ be the midpoint of $A D$. Prove that the circle $M P Q$ is tangent to $\omega$.","Let $\gamma$ be the circle $MPQ$. From the previous sub-problem, the point $T$ (the second intersection of $AD$ with $\omega$) lies on $\gamma$. Let the tangent line to $\omega$ at $T$ meet line $BC$ at a point $R$. As tangents from $R$ to $\omega$, $RT = RD$. Let $A'$ be the center of $\omega$. Since $A'D=A'T$ and $RD=RT$, $A'R$ is the perpendicular bisector of $DT$. As $A, D, T$ are collinear, $AD \perp A'R$. Thus, in the right triangle $A'RD$ (right-angled at $D$), $DN$ is the altitude to the hypotenuse $A'R$. By the geometric mean theorem, $RD^2 = RN \cdot RA'$. The points $P,Q,N,A'$ all lie on the circle $AEF$. By the power of point $R$ with respect to this circle, $RP \cdot RQ = RN \cdot RA'$. Therefore, $RT^2 = RD^2 = RP \cdot RQ$. By the converse of the tangent-secant theorem, the line $RT$ is also tangent to the circle $\gamma$ at $T$. Since $RT$ is a common tangent at $T$, the circle $MPQ$ is tangent to $\omega$.",,
2017g5,"Let $A B C C_{1} B_{1} A_{1}$ be a convex hexagon such that $A B=B C$, and suppose that the line segments $A A_{1}, B B_{1}$, and $C C_{1}$ have the same perpendicular bisector. Let the diagonals $A C_{1}$ and $A_{1} C$ meet at $D$, and denote by $\omega$ the circle $A B C$. Let $\omega$ intersect the circle $A_{1} B C_{1}$ again at $E \neq B$. Prove that the lines $B B_{1}$ and $D E$ intersect on $\omega$.","If $A A_{1}=C C_{1}$, then the hexagon is symmetric about the line $B B_{1}$; in particular the circles $A B C$ and $A_{1} B C_{1}$ are tangent to each other. So $A A_{1}$ and $C C_{1}$ must be different. Since the points $A$ and $A_{1}$ can be interchanged with $C$ and $C_{1}$, respectively, we may assume $A A_{1}<C C_{1}$.

Let $R$ be the radical center of the circles $A E B C$ and $A_{1} E B C_{1}$, and the circumcircle of the symmetric trapezoid $A C C_{1} A_{1}$; that is the common point of the pairwise radical axes $A C, A_{1} C_{1}$, and $B E$. By the symmetry of $A C$ and $A_{1} C_{1}$, the point $R$ lies on the common perpendicular bisector of $A A_{1}$ and $C C_{1}$, which is the external bisector of $\angle A D C$.

Let $F$ be the second intersection of the line $D R$ and the circle $A C D$. From the power of $R$ with respect to the circles $\omega$ and $A C F D$ we have $R B \cdot R E=R A \cdot R C=R D \cdot D F$, so the points $B, E, D$ and $F$ are concyclic.

The line $R D F$ is the external bisector of $\angle A D C$, so the point $F$ bisects the $\operatorname{arc} \widetilde{C D A}$. By $A B=B C$, on circle $\omega$, the point $B$ is the midpoint of arc $\widehat{A E C}$; let $M$ be the point diametrically opposite to $B$, that is the midpoint of the opposite $\operatorname{arc} \widetilde{C A}$ of $\omega$. Notice that the points $B, F$ and $M$ lie on the perpendicular bisector of $A C$, so they are collinear.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_3d725d21cc83abfed093g-64}

Finally, let $X$ be the second intersection point of $\omega$ and the line $D E$. Since $B M$ is a diameter in $\omega$, we have $\angle B X M=90^{\circ}$. Moreover,

$$
\angle E X M=180^{\circ}-\angle M B E=180^{\circ}-\angle F B E=\angle E D F
$$

so $M X$ and $F D$ are parallel. Since $B X$ is perpendicular to $M X$ and $B B_{1}$ is perpendicular to $F D$, this shows that $X$ lies on line $B B_{1}$.",3,"Let $L$ be the common perpendicular bisector of $AA_1, BB_1, CC_1$. Let $D = AC_1 \cap A_1C$. Show that line $L$ passes through $D$ and is the external angle bisector of $\angle ADC$.","Let $\\sigma_L$ be the reflection across line $L$. By definition, $\\sigma_L(A)=A_1$ and $\\sigma_L(C)=C_1$. The line $A_1C$ is the reflection of $AC_1$ across $L$. Their intersection point $D$ must therefore be fixed by the reflection, which means $D$ lies on the line $L$. To show $L$ is the external angle bisector of $\\angle ADC$, we can use coordinates. Let $L$ be the y-axis, with $A=(x_A,y_A)$ and $C=(x_C,y_C)$. Then $A_1=(-x_A,y_A)$ and $C_1=(-x_C,y_C)$. The intersection $D$ of line $A_1C$ and $AC_1$ lies on the y-axis. The slopes of $DA$ and $DC$ are $m_{DA}=(y_A-y_D)/x_A$ and $m_{DC}=(y_C-y_D)/x_C$. A calculation of $y_D$ from the line intersection equations shows that $y_D(x_A+x_C) = x_Ay_C+x_Cy_A$. Substituting this into the sum of slopes gives $m_{DA}+m_{DC}=0$, which proves that $L$ is an external angle bisector of $\\angle ADC$.","Let $R=AC \\cap A_1C_1$. Let $F$ be the second point of intersection of the line containing $D$ and $R$ with the circumcircle of $\triangle ACD$. Prove that the points $B, E, D, F$ are concyclic.","Let $\\omega=(ABC)$, $\\omega'=(A_1BC_1)$, and $\\gamma$ be the circumcircle of the symmetric trapezoid $ACC_1A_1$. The line $AC$ is the radical axis of $\\omega$ and $\\gamma$. The line $A_1C_1$ is the radical axis of $\\omega'$ and $\\gamma$. Their intersection, $R$, is the radical center of the three circles. This implies $R$ also lies on the radical axis of $\\omega$ and $\\omega'$, which is the line $BE$. Let $\\Omega_{ACD}$ be the circumcircle of $\triangle ACD$. The power of $R$ with respect to $\\omega$ is $P_\\omega(R) = \\overline{RA} \\cdot \\overline{RC} = \\overline{RB} \\cdot \\overline{RE}$ since $R,B,E$ are collinear. The power of $R$ with respect to $\\Omega_{ACD}$ is $P_{\\Omega_{ACD}}(R) = \\overline{RA} \\cdot \\overline{RC} = \\overline{RD} \\cdot \\overline{RF}$ since $R,D,F$ are collinear. Equating these gives $\\overline{RB} \\cdot \\overline{RE} = \\overline{RD} \\cdot \\overline{RF}$, which is the condition for the points $B, E, D, F$ to be concyclic.",Prove that the lines $B B_{1}$ and $D E$ intersect on $\\omega$.,"Let $X$ be the second intersection of line $DE$ with circle $\\omega$. We show $X$ lies on line $BB_1$. From Sub-problem 1, the line $DF$ is the common perpendicular bisector $L$ of $BB_1$, so $BB_1 \\perp DF$. Let $M$ be the point on $\\omega$ diametrically opposite to $B$. Since $AB=BC$, $BM$ is the perpendicular bisector of $AC$. From Sub-problem 1, line $DF=L$ is the external angle bisector of $\\angle ADC$. This bisector intersects the circumcircle of $\triangle ACD$ at $F$, which implies $FA=FC$. Thus $F$ lies on the perpendicular bisector of $AC$. Therefore, $B,F,M$ are collinear. In circle $\\omega$, since $BM$ is a diameter, $BX \\perp MX$. From the concyclicity of $B,E,D,F$ (Sub-problem 2), we have $\\angle FDE = 180^\\circ - \\angle FBE$. In $\\omega$, $\\angle EXM = 180^\\circ - \\angle EBM = 180^\\circ - \\angle FBE$. Therefore, $\\angle EXM = \\angle FDE$, which implies $MX \\parallel DF$. Since $BB_1 \\perp DF$ and $MX \\parallel DF$, we have $BB_1 \\perp MX$. Both $BX$ and $BB_1$ pass through $B$ and are perpendicular to $MX$, so they must be the same line. Thus, $X$ lies on line $BB_1$.",,
2017g6,"Let $n \geqslant 3$ be an integer. Two regular $n$-gons $\mathcal{A}$ and $\mathcal{B}$ are given in the plane. Prove that the vertices of $\mathcal{A}$ that lie inside $\mathcal{B}$ or on its boundary are consecutive.\\
(That is, prove that there exists a line separating those vertices of $\mathcal{A}$ that lie inside $\mathcal{B}$ or on its boundary from the other vertices of $\mathcal{A}$.)","In both solutions, by a polygon we always mean its interior together with its boundary.

We start with finding a regular $n$-gon $\mathcal{C}$ which $(i)$ is inscribed into $\mathcal{B}$ (that is, all vertices of $\mathcal{C}$ lie on the perimeter of $\mathcal{B}$ ); and (ii) is either a translation of $\mathcal{A}$, or a homothetic image of $\mathcal{A}$ with a positive factor.

Such a polygon may be constructed as follows. Let $O_{A}$ and $O_{B}$ be the centers of $\mathcal{A}$ and $\mathcal{B}$, respectively, and let $A$ be an arbitrary vertex of $\mathcal{A}$. Let $\overrightarrow{O_{B} C}$ be the vector co-directional to $\overrightarrow{O_{A} A}$, with $C$ lying on the perimeter of $\mathcal{B}$. The rotations of $C$ around $O_{B}$ by multiples of $2 \pi / n$ form the required polygon. Indeed, it is regular, inscribed into $\mathcal{B}$ (due to the rotational symmetry of $\mathcal{B}$ ), and finally the translation/homothety mapping $\overrightarrow{O_{A} A}$ to $\overrightarrow{O_{B} C}$ maps $\mathcal{A}$ to $\mathcal{C}$.

Now we separate two cases.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_3d725d21cc83abfed093g-66}

Case 1: $\mathcal{C}$ is a translation of $\mathcal{A}$ by a vector $\vec{v}$.\\
Denote by $t$ the translation transform by vector $\vec{v}$. We need to prove that the vertices of $\mathcal{C}$ which stay in $\mathcal{B}$ under $t$ are consecutive. To visualize the argument, we refer the plane to Cartesian coordinates so that the $x$-axis is co-directional with $\vec{v}$. This way, the notions of right/left and top/bottom are also introduced, according to the $x$ - and $y$-coordinates, respectively.

Let $B_{\mathrm{T}}$ and $B_{\mathrm{B}}$ be the top and the bottom vertices of $\mathcal{B}$ (if several vertices are extremal, we take the rightmost of them). They split the perimeter of $\mathcal{B}$ into the right part $\mathcal{B}_{\mathrm{R}}$ and the left part $\mathcal{B}_{\mathrm{L}}$ (the vertices $B_{\mathrm{T}}$ and $B_{\mathrm{B}}$ are assumed to lie in both parts); each part forms a connected subset of the perimeter of $\mathcal{B}$. So the vertices of $\mathcal{C}$ are also split into two parts $\mathcal{C}_{\mathrm{L}} \subset \mathcal{B}_{\mathrm{L}}$ and $\mathcal{C}_{\mathrm{R}} \subset \mathcal{B}_{\mathrm{R}}$, each of which consists of consecutive vertices.

Now, all the points in $\mathcal{B}_{\mathrm{R}}$ (and hence in $\mathcal{C}_{\mathrm{R}}$ ) move out from $\mathcal{B}$ under $t$, since they are the rightmost points of $\mathcal{B}$ on the corresponding horizontal lines. It remains to prove that the vertices of $\mathcal{C}_{\mathrm{L}}$ which stay in $\mathcal{B}$ under $t$ are consecutive.

For this purpose, let $C_{1}, C_{2}$, and $C_{3}$ be three vertices in $\mathcal{C}_{\mathrm{L}}$ such that $C_{2}$ is between $C_{1}$ and $C_{3}$, and $t\left(C_{1}\right)$ and $t\left(C_{3}\right)$ lie in $\mathcal{B}$; we need to prove that $t\left(C_{2}\right) \in \mathcal{B}$ as well. Let $A_{i}=t\left(C_{i}\right)$. The line through $C_{2}$ parallel to $\vec{v}$ crosses the segment $C_{1} C_{3}$ to the right of $C_{2}$; this means that this line crosses $A_{1} A_{3}$ to the right of $A_{2}$, so $A_{2}$ lies inside the triangle $A_{1} C_{2} A_{3}$ which is contained in $\mathcal{B}$. This yields the desired result.

Case 2: $\mathcal{C}$ is a homothetic image of $\mathcal{A}$ centered at $X$ with factor $k>0$.

Denote by $h$ the homothety mapping $\mathcal{C}$ to $\mathcal{A}$. We need now to prove that the vertices of $\mathcal{C}$ which stay in $\mathcal{B}$ after applying $h$ are consecutive. If $X \in \mathcal{B}$, the claim is easy. Indeed, if $k<1$, then the vertices of $\mathcal{A}$ lie on the segments of the form $X C$ ( $C$ being a vertex of $\mathcal{C}$ ) which lie in $\mathcal{B}$. If $k>1$, then the vertices of $\mathcal{A}$ lie on the extensions of such segments $X C$ beyond $C$, and almost all these extensions lie outside $\mathcal{B}$. The exceptions may occur only in case when $X$ lies on the boundary of $\mathcal{B}$, and they may cause one or two vertices of $\mathcal{A}$ stay on the boundary of $\mathcal{B}$. But even in this case those vertices are still consecutive.

So, from now on we assume that $X \notin \mathcal{B}$.\\
Now, there are two vertices $B_{\mathrm{T}}$ and $\mathcal{B}_{\mathrm{B}}$ of $\mathcal{B}$ such that $\mathcal{B}$ is contained in the angle $\angle B_{\mathrm{T}} X B_{\mathrm{B}}$; if there are several options, say, for $B_{\mathrm{T}}$, then we choose the farthest one from $X$ if $k>1$, and the nearest one if $k<1$. For the visualization purposes, we refer the plane to Cartesian coordinates so that the $y$-axis is co-directional with $\overrightarrow{B_{\mathrm{B}} B_{\mathrm{T}}}$, and $X$ lies to the left of the line $B_{\mathrm{T}} B_{\mathrm{B}}$. Again, the perimeter of $\mathcal{B}$ is split by $B_{\mathrm{T}}$ and $B_{\mathrm{B}}$ into the right part $\mathcal{B}_{\mathrm{R}}$ and the left part $\mathcal{B}_{\mathrm{L}}$, and the set of vertices of $\mathcal{C}$ is split into two subsets $\mathcal{C}_{\mathrm{R}} \subset \mathcal{B}_{\mathrm{R}}$ and $\mathcal{C}_{\mathrm{L}} \subset \mathcal{B}_{\mathrm{L}}$.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_3d725d21cc83abfed093g-67}

Case 2, $X$ inside $\mathcal{B}$\\
\includegraphics[max width=\textwidth, center]{2025_04_29_3d725d21cc83abfed093g-67(2)}

Subcase 2.1: $k>1$

\section*{Subcase 2.1: $k>1$.}
In this subcase, all points from $\mathcal{B}_{\mathrm{R}}$ (and hence from $\mathcal{C}_{\mathrm{R}}$ ) move out from $\mathcal{B}$ under $h$, because they are the farthest points of $\mathcal{B}$ on the corresponding rays emanated from $X$. It remains to prove that the vertices of $\mathcal{C}_{\mathrm{L}}$ which stay in $\mathcal{B}$ under $h$ are consecutive.

Again, let $C_{1}, C_{2}, C_{3}$ be three vertices in $\mathcal{C}_{\mathrm{L}}$ such that $C_{2}$ is between $C_{1}$ and $C_{3}$, and $h\left(C_{1}\right)$ and $h\left(C_{3}\right)$ lie in $\mathcal{B}$. Let $A_{i}=h\left(C_{i}\right)$. Then the ray $X C_{2}$ crosses the segment $C_{1} C_{3}$ beyond $C_{2}$, so this ray crosses $A_{1} A_{3}$ beyond $A_{2}$; this implies that $A_{2}$ lies in the triangle $A_{1} C_{2} A_{3}$, which is contained in $\mathcal{B}$.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_3d725d21cc83abfed093g-67(1)}

Subcase 2.2: $k<1$\\
Subcase 2.2: $k<1$.\\
This case is completely similar to the previous one. All points from $\mathcal{B}_{\mathrm{L}}$ (and hence from $\mathcal{C}_{\mathrm{L}}$ move out from $\mathcal{B}$ under $h$, because they are the nearest points of $\mathcal{B}$ on the corresponding\\
rays emanated from $X$. Assume that $C_{1}, C_{2}$, and $C_{3}$ are three vertices in $\mathcal{C}_{\mathrm{R}}$ such that $C_{2}$ lies between $C_{1}$ and $C_{3}$, and $h\left(C_{1}\right)$ and $h\left(C_{3}\right)$ lie in $\mathcal{B}$; let $A_{i}=h\left(C_{i}\right)$. Then $A_{2}$ lies on the segment $X C_{2}$, and the segments $X A_{2}$ and $A_{1} A_{3}$ cross each other. Thus $A_{2}$ lies in the triangle $A_{1} C_{2} A_{3}$, which is contained in $\mathcal{B}$.",4,Reduce the problem about two arbitrary regular n-gons $\mathcal{A}$ and $\mathcal{B}$ to a problem about an inscribed polygon $\mathcal{C}$ and a geometric transformation $T$.,"Construct a regular n-gon $\mathcal{C}$ with vertices on the boundary of $\mathcal{B}$ and oriented the same as $\mathcal{A}$. This is done by choosing a vertex $A_1$ of $\mathcal{A}$ and a point $C_1$ on the boundary of $\mathcal{B}$ such that $\vec{O_B C_1}$ is co-directional with $\vec{O_A A_1}$ (where $O_A, O_B$ are centers), and then rotating $C_1$ around $O_B$. Then $\mathcal{A}$ is the image of $\mathcal{C}$ under a homothety $T$ (a translation is a generalized homothety). The problem is now to show that the vertices $C_i$ of $\mathcal{C}$ for which $T(C_i) \in \mathcal{B}$ form a consecutive set.","Prove that for any regular polygon $\mathcal{P}$ and any convex set $\mathcal{K}$, the vertices of $\mathcal{P}$ that lie in $\mathcal{K}$ are consecutive.","The vertices of a regular polygon $\mathcal{P}$ lie on its circumcircle. The intersection of this circle with the convex set $\mathcal{K}$ must be a single continuous arc (or empty, or the whole circle). The vertices of the regular polygon $\mathcal{P}$ that fall within this arc are therefore consecutive.",Show that the set of vertices of the constructed polygon $\mathcal{C}$ whose images under the transformation $T$ lie in $\mathcal{B}$ are consecutive.,"The vertices of $\mathcal{C}$ whose images $T(C_i)$ are in $\mathcal{B}$ are precisely the vertices of $\mathcal{C}$ that lie in the set $T^{-1}(\mathcal{B})$. Since $\mathcal{B}$ is a regular n-gon, it is a convex set. A homothety $T$ and its inverse $T^{-1}$ map convex sets to convex sets. Thus, $T^{-1}(\mathcal{B})$ is a convex set. By the result from the previous sub-problem, the vertices of the regular polygon $\mathcal{C}$ inside the convex set $T^{-1}(\mathcal{B})$ must be consecutive.",Let $n \geqslant 3$ be an integer. Two regular $n$-gons $\mathcal{A}$ and $\mathcal{B}$ are given in the plane. Prove that the vertices of $\mathcal{A}$ that lie inside $\mathcal{B}$ or on its boundary are consecutive.,"First, construct a regular $n$-gon $\mathcal{C}$ inscribed in $\mathcal{B}$ such that $\mathcal{A}=T(\mathcal{C})$ for some homothety $T$. The vertices of $\mathcal{A}$ in $\mathcal{B}$ correspond to vertices of $\mathcal{C}$ in the set $T^{-1}(\mathcal{B})$. Since $\mathcal{B}$ is convex, $T^{-1}(\mathcal{B})$ is also convex. As proven before, the vertices of a regular polygon lying in a convex set must be consecutive. Therefore, the vertices of $\mathcal{A}$ inside $\mathcal{B}$ are consecutive."
2017g7,"A convex quadrilateral $A B C D$ has an inscribed circle with center $I$. Let $I_{a}, I_{b}, I_{c}$, and $I_{d}$ be the incenters of the triangles $D A B, A B C, B C D$, and $C D A$, respectively. Suppose that the common external tangents of the circles $A I_{b} I_{d}$ and $C I_{b} I_{d}$ meet at $X$, and the common external tangents of the circles $B I_{a} I_{c}$ and $D I_{a} I_{c}$ meet at $Y$. Prove that $\angle X I Y=90^{\circ}$.","Solution. Denote by $\omega_{a}, \omega_{b}, \omega_{c}$ and $\omega_{d}$ the circles $A I_{b} I_{d}, B I_{a} I_{c}, C I_{b} I_{d}$, and $D I_{a} I_{c}$, let their centers be $O_{a}, O_{b}, O_{c}$ and $O_{d}$, and let their radii be $r_{a}, r_{b}, r_{c}$ and $r_{d}$, respectively.\\
Claim 1. $I_{b} I_{d} \perp A C$ and $I_{a} I_{c} \perp B D$.\\
Proof. Let the incircles of triangles $A B C$ and $A C D$ be tangent to the line $A C$ at $T$ and $T^{\prime}$, respectively. (See the figure to the left.) We have $A T=\frac{A B+A C-B C}{2}$ in triangle $A B C, A T^{\prime}=$ $\frac{A D+A C-C D}{2}$ in triangle $A C D$, and $A B-B C=A D-C D$ in quadrilateral $A B C D$, so

$$
A T=\frac{A C+A B-B C}{2}=\frac{A C+A D-C D}{2}=A T^{\prime} .
$$

This shows $T=T^{\prime}$. As an immediate consequence, $I_{b} I_{d} \perp A C$.\\
The second statement can be shown analogously.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_3d725d21cc83abfed093g-70}

Claim 2. The points $O_{a}, O_{b}, O_{c}$ and $O_{d}$ lie on the lines $A I, B I, C I$ and $D I$, respectively.\\
Proof. By symmetry it suffices to prove the claim for $O_{a}$. (See the figure to the right above.)\\
Notice first that the incircles of triangles $A B C$ and $A C D$ can be obtained from the incircle of the quadrilateral $A B C D$ with homothety centers $B$ and $D$, respectively, and homothety factors less than 1 , therefore the points $I_{b}$ and $I_{d}$ lie on the line segments $B I$ and $D I$, respectively.

As is well-known, in every triangle the altitude and the diameter of the circumcircle starting from the same vertex are symmetric about the angle bisector. By Claim 1, in triangle $A I_{d} I_{b}$, the segment $A T$ is the altitude starting from $A$. Since the foot $T$ lies inside the segment $I_{b} I_{d}$, the circumcenter $O_{a}$ of triangle $A I_{d} I_{b}$ lies in the angle domain $I_{b} A I_{d}$ in such a way that $\angle I_{b} A T=\angle O_{a} A I_{d}$. The points $I_{b}$ and $I_{d}$ are the incenters of triangles $A B C$ and $A C D$, so the lines $A I_{b}$ and $A I_{d}$ bisect the angles $\angle B A C$ and $\angle C A D$, respectively. Then

$$
\angle O_{a} A D=\angle O_{a} A I_{d}+\angle I_{d} A D=\angle I_{b} A T+\angle I_{d} A D=\frac{1}{2} \angle B A C+\frac{1}{2} \angle C A D=\frac{1}{2} \angle B A D,
$$

so $O_{a}$ lies on the angle bisector of $\angle B A D$, that is, on line $A I$.\\
The point $X$ is the external similitude center of $\omega_{a}$ and $\omega_{c}$; let $U$ be their internal similitude center. The points $O_{a}$ and $O_{c}$ lie on the perpendicular bisector of the common chord $I_{b} I_{d}$ of $\omega_{a}$ and $\omega_{c}$, and the two similitude centers $X$ and $U$ lie on the same line; by Claim 2, that line is parallel to $A C$.\\
\includegraphics[max width=\textwidth, center]{2025_04_29_3d725d21cc83abfed093g-71}

From the similarity of the circles $\omega_{a}$ and $\omega_{c}$, from $O_{a} I_{b}=O_{a} I_{d}=O_{a} A=r_{a}$ and $O_{c} I_{b}=$ $O_{c} I_{d}=O_{c} C=r_{c}$, and from $A C \| O_{a} O_{c}$ we can see that

$$
\frac{O_{a} X}{O_{c} X}=\frac{O_{a} U}{O_{c} U}=\frac{r_{a}}{r_{c}}=\frac{O_{a} I_{b}}{O_{c} I_{b}}=\frac{O_{a} I_{d}}{O_{c} I_{d}}=\frac{O_{a} A}{O_{c} C}=\frac{O_{a} I}{O_{c} I} .
$$

So the points $X, U, I_{b}, I_{d}, I$ lie on the Apollonius circle of the points $O_{a}, O_{c}$ with ratio $r_{a}: r_{c}$. In this Apollonius circle $X U$ is a diameter, and the lines $I U$ and $I X$ are respectively the internal and external bisectors of $\angle O_{a} I O_{c}=\angle A I C$, according to the angle bisector theorem. Moreover, in the Apollonius circle the diameter $U X$ is the perpendicular bisector of $I_{b} I_{d}$, so the lines $I X$ and $I U$ are the internal and external bisectors of $\angle I_{b} I I_{d}=\angle B I D$, respectively.

Repeating the same argument for the points $B, D$ instead of $A, C$, we get that the line $I Y$ is the internal bisector of $\angle A I C$ and the external bisector of $\angle B I D$. Therefore, the lines $I X$ and $I Y$ respectively are the internal and external bisectors of $\angle B I D$, so they are perpendicular.

Comment. In fact the points $O_{a}, O_{b}, O_{c}$ and $O_{d}$ lie on the line segments $A I, B I, C I$ and $D I$, respectively. For the point $O_{a}$ this can be shown for example by $\angle I_{d} O_{a} A+\angle A O_{a} I_{b}=\left(180^{\circ}-\right.$ $\left.2 \angle O_{a} A I_{d}\right)+\left(180^{\circ}-2 \angle I_{b} A O_{a}\right)=360^{\circ}-\angle B A D=\angle A D I+\angle D I A+\angle A I B+\angle I B A>\angle I_{d} I A+\angle A I I_{b}$.

The solution also shows that the line $I Y$ passes through the point $U$, and analogously, $I X$ passes through the internal similitude center of $\omega_{b}$ and $\omega_{d}$.",4,"Let $I_a, I_b, I_c, I_d$ be the incenters of triangles $DAB, ABC, BCD, CDA$ respectively. Prove that the line segment $I_b I_d$ is perpendicular to the diagonal $AC$, and the line segment $I_a I_c$ is perpendicular to the diagonal $BD$.","Let the incircles of $\triangle ABC$ and $\triangle ADC$ be tangent to the diagonal $AC$ at points $T_b$ and $T_d$, respectively. The distance from vertex $A$ to the tangency point along $AC$ is given by $AT_b = \frac{AB+AC-BC}{2}$ in $\triangle ABC$ and $AT_d = \frac{AD+AC-CD}{2}$ in $\triangle ADC$. Since the quadrilateral $ABCD$ has an inscribed circle, it is a tangential quadrilateral, so $AB+CD = BC+AD$, which implies $AB-BC = AD-CD$. Therefore, $AT_b = AT_d$, so the points of tangency coincide, say at $T$. Since $I_bT \perp AC$ and $I_dT \perp AC$, the line $I_bI_d$ is perpendicular to $AC$. The proof for $I_aI_c \perp BD$ is analogous.","Let $O_a, O_b, O_c, O_d$ be the circumcenters of the circles $(AI_bI_d), (BI_aI_c), (CI_bI_d), (DI_aI_c)$ respectively. Prove that $O_a, O_b, O_c, O_d$ lie on the lines $AI, BI, CI, DI$ respectively.","By symmetry, it suffices to prove that $O_a$ lies on line $AI$. In $\triangle AI_bI_d$, the altitude from vertex $A$ to the side $I_bI_d$ lies on the line $AC$, because $AC \perp I_bI_d$ as established in the first sub-problem. In any triangle, the altitude and the circumdiameter from the same vertex are isogonal conjugates. Thus, the line $AO_a$ (circumdiameter) is isogonal to the line $AC$ (altitude) with respect to $\angle I_bAI_d$. This means $\angle CAI_b = \angle I_dAO_a$. Since $I_b$ and $I_d$ are incenters, $AI_b$ and $AI_d$ are the angle bisectors of $\angle BAC$ and $\angle DAC$. So, $\angle DAO_a = \angle DAI_d + \angle I_dAO_a = \angle DAI_d + \angle CAI_b = \frac{1}{2}\angle DAC + \frac{1}{2}\angle BAC = \frac{1}{2}\angle DAB$. This shows that $AO_a$ is the angle bisector of $\angle DAB$, which is the line $AI$. Therefore, $O_a$ lies on $AI$.",Let $X$ be the meeting point of the common external tangents of circles $(AI_bI_d)$ and $(CI_bI_d)$. Prove that the line $IX$ is the external angle bisector of $\angle AIC$ and the internal angle bisector of $\angle BID$.,"Let $\omega_a = (AI_bI_d)$ and $\omega_c = (CI_bI_d)$, with centers $O_a, O_c$ and radii $r_a, r_c$. The line of centers $O_aO_c$ is the perpendicular bisector of the common chord $I_bI_d$. From sub-problem 1, $I_bI_d \perp AC$, so $O_aO_c \parallel AC$. From sub-problem 2, $O_a$ lies on $AI$ and $O_c$ lies on $CI$. The parallelism implies $\triangle IO_aO_c \sim \triangle IAC$, so $IO_a/IO_c = IA/IC$. From this similarity and the fact that $r_a=O_aA$ and $r_c=O_cC$, we can derive $r_a/r_c = IO_a/IO_c$. As $X$ is the external similitude center, $XO_a/XO_c = r_a/r_c$. Thus, $XO_a/XO_c = IO_a/IO_c$, which by the external angle bisector theorem means $IX$ is the external bisector of $\angle O_aIO_c = \angle AIC$. Furthermore, points $I, I_b, I_d$ lie on the Apollonius circle of $O_a, O_c$. The diameter of this circle containing $X$ is the perpendicular bisector of the chord $I_bI_d$. This implies that $IX$ bisects $\angle I_bII_d = \angle BID$. Based on the geometry of the centers of similitude, $IX$ is the internal bisector.","A convex quadrilateral $A B C D$ has an inscribed circle with center $I$. Let $I_{a}, I_{b}, I_{c}$, and $I_{d}$ be the incenters of the triangles $D A B, A B C, B C D$, and $C D A$, respectively. Suppose that the common external tangents of the circles $A I_{b} I_{d}$ and $C I_{b} I_{d}$ meet at $X$, and the common external tangents of the circles $B I_{a} I_{c}$ and $D I_{a} I_{c}$ meet at $Y$. Prove that $\angle X I Y=90^{\circ}$.","From the result of sub-problem 3, the line $IX$ is the internal angle bisector of $\angle BID$. By applying a symmetric argument to the circles $(BI_aI_c)$ and $(DI_aI_c)$ and their external similitude center $Y$, we conclude that the line $IY$ is the external angle bisector of $\angle BID$. The internal and external bisectors of an angle are always perpendicular to each other. Therefore, $IX \perp IY$, which means $\angle XIY = 90^{\circ}$."
2017n2,"Let $p \geqslant 2$ be a prime number. Eduardo and Fernando play the following game making moves alternately: in each move, the current player chooses an index $i$ in the set $\{0,1, \ldots, p-1\}$ that was not chosen before by either of the two players and then chooses an element $a_{i}$ of the set $\{0,1,2,3,4,5,6,7,8,9\}$. Eduardo has the first move. The game ends after all the indices $i \in\{0,1, \ldots, p-1\}$ have been chosen. Then the following number is computed:

$$
M=a_{0}+10 \cdot a_{1}+\cdots+10^{p-1} \cdot a_{p-1}=\sum_{j=0}^{p-1} a_{j} \cdot 10^{j} .
$$

The goal of Eduardo is to make the number $M$ divisible by $p$, and the goal of Fernando is to prevent this.

Prove that Eduardo has a winning strategy.","Solution. We say that a player makes the move $\left(i, a_{i}\right)$ if he chooses the index $i$ and then the element $a_{i}$ of the set $\{0,1,2,3,4,5,6,7,8,9\}$ in this move.

If $p=2$ or $p=5$ then Eduardo chooses $i=0$ and $a_{0}=0$ in the first move, and wins, since, independently of the next moves, $M$ will be a multiple of 10 .

Now assume that the prime number $p$ does not belong to $\{2,5\}$. Eduardo chooses $i=p-1$ and $a_{p-1}=0$ in the first move. By Fermat's Little Theorem, $\left(10^{(p-1) / 2}\right)^{2}=10^{p-1} \equiv 1(\bmod p)$, so $p \mid\left(10^{(p-1) / 2}\right)^{2}-1=\left(10^{(p-1) / 2}+1\right)\left(10^{(p-1) / 2}-1\right)$. Since $p$ is prime, either $p \mid 10^{(p-1) / 2}+1$ or $p \mid 10^{(p-1) / 2}-1$. Thus we have two cases:\\
Case a: $10^{(p-1) / 2} \equiv-1(\bmod p)$\\
In this case, for each move ( $i, a_{i}$ ) of Fernando, Eduardo immediately makes the move $\left(j, a_{j}\right)=$ $\left(i+\frac{p-1}{2}, a_{i}\right)$, if $0 \leqslant i \leqslant \frac{p-3}{2}$, or $\left(j, a_{j}\right)=\left(i-\frac{p-1}{2}, a_{i}\right)$, if $\frac{p-1}{2} \leqslant i \leqslant p-2$. We will have $10^{j} \equiv-10^{i}$ $(\bmod p)$, and so $a_{j} \cdot 10^{j}=a_{i} \cdot 10^{j} \equiv-a_{i} \cdot 10^{i}(\bmod p)$. Notice that this move by Eduardo is always possible. Indeed, immediately before a move by Fernando, for any set of the type $\{r, r+(p-1) / 2\}$ with $0 \leqslant r \leqslant(p-3) / 2$, either no element of this set was chosen as an index by the players in the previous moves or else both elements of this set were chosen as indices by the players in the previous moves. Therefore, after each of his moves, Eduardo always makes the sum of the numbers $a_{k} \cdot 10^{k}$ corresponding to the already chosen pairs ( $k, a_{k}$ ) divisible by $p$, and thus wins the game.\\
Case b: $10^{(p-1) / 2} \equiv 1(\bmod p)$\\
In this case, for each move $\left(i, a_{i}\right)$ of Fernando, Eduardo immediately makes the move $\left(j, a_{j}\right)=$ $\left(i+\frac{p-1}{2}, 9-a_{i}\right)$, if $0 \leqslant i \leqslant \frac{p-3}{2}$, or $\left(j, a_{j}\right)=\left(i-\frac{p-1}{2}, 9-a_{i}\right)$, if $\frac{p-1}{2} \leqslant i \leqslant p-2$. The same argument as above shows that Eduardo can always make such move. We will have $10^{j} \equiv 10^{i}$ $(\bmod p)$, and so $a_{j} \cdot 10^{j}+a_{i} \cdot 10^{i} \equiv\left(a_{i}+a_{j}\right) \cdot 10^{i}=9 \cdot 10^{i}(\bmod p)$. Therefore, at the end of the game, the sum of all terms $a_{k} \cdot 10^{k}$ will be congruent to

$$
\sum_{i=0}^{\frac{p-3}{2}} 9 \cdot 10^{i}=10^{(p-1) / 2}-1 \equiv 0 \quad(\bmod p),
$$

and Eduardo wins the game.",3,"Show that Eduardo has a winning strategy for $p=2$ and $p=5$. For primes $p \notin \{2, 5\}$, establish Eduardo's first move and a pairing strategy for the remaining indices.","If $p=2$ or $p=5$, Eduardo chooses $(i,a_i)=(0,0)$ on his first turn. The resulting number $M$ will be a multiple of 10, thus divisible by $p$. If $p \notin \{2, 5\}$, Eduardo's first move is $(p-1, 0)$. His goal is to make $\sum_{j=0}^{p-2} a_j 10^j$ divisible by $p$. The remaining $p-1$ indices $\{0, 1, \ldots, p-2\}$ are partitioned into pairs $\{i, i+(p-1)/2\}$ for $i=0, \ldots, (p-3)/2$. Whenever Fernando chooses one index from a pair, Eduardo chooses the other in his next turn.","For a prime $p \notin \{2, 5\}$, show that $10^{(p-1)/2} \equiv \pm 1 \pmod p$. Based on this, define Eduardo's strategy for choosing a digit $a_j$ in response to Fernando's choice $(i, a_i)$ within a pair $\{i, j\}$.","By Fermat's Little Theorem, $10^{p-1} \equiv 1 \pmod p$. Since $p$ is prime, this implies $10^{(p-1)/2} \equiv \pm 1 \pmod p$. Let $j$ be the index paired with $i$. Eduardo's responsive digit choice depends on the case:
Case A: If $10^{(p-1)/2} \equiv -1 \pmod p$, Eduardo chooses $a_j = a_i$.
Case B: If $10^{(p-1)/2} \equiv 1 \pmod p$, Eduardo chooses $a_j = 9-a_i$. This is a valid choice as $a_j$ remains in $\{0, 1, \ldots, 9\}$.","Let $p \geqslant 2$ be a prime number. Eduardo and Fernando play the following game making moves alternately: in each move, the current player chooses an index $i$ in the set $\{0,1, \ldots, p-1\}$ that was not chosen before by either of the two players and then chooses an element $a_{i}$ of the set $\{0,1,2,3,4,5,6,7,8,9\}$. Eduardo has the first move. The game ends after all the indices $i \in\{0,1, \ldots, p-1\}$ have been chosen. Then the following number is computed: $M=\sum_{j=0}^{p-1} a_{j} \cdot 10^{j}$. The goal of Eduardo is to make the number $M$ divisible by $p$, and the goal of Fernando is to prevent this. Prove that Eduardo has a winning strategy.","For $p=2, 5$, the strategy from Part 1 ensures Eduardo wins. For $p \notin \{2, 5\}$, Eduardo applies the strategy from Parts 1 and 2. We analyze the sum $M \pmod p$ based on the two cases from Part 2.
Case A: $10^{(p-1)/2} \equiv -1 \pmod p$. The contribution to $M$ from each pair $\{i, j\}$ is $a_i 10^i + a_j 10^j \equiv a_i 10^i + a_i 10^{i+(p-1)/2} \equiv a_i 10^i - a_i 10^i \equiv 0 \pmod p$. The total sum is $M \equiv 0 \pmod p$.
Case B: $10^{(p-1)/2} \equiv 1 \pmod p$. The contribution from each pair is $a_i 10^i + a_j 10^j \equiv a_i 10^i + (9-a_i) 10^{i+(p-1)/2} \equiv a_i 10^i + (9-a_i) 10^i \equiv 9 \cdot 10^i \pmod p$. The total sum over all pairs is $M \equiv \sum_{i=0}^{(p-3)/2} 9 \cdot 10^i = 10^{(p-1)/2} - 1 \equiv 1-1 \equiv 0 \pmod p$. Thus, Eduardo can always force $M$ to be divisible by $p$.",,
2017n7,"Say that an ordered pair $(x, y)$ of integers is an irreducible lattice point if $x$ and $y$ are relatively prime. For any finite set $S$ of irreducible lattice points, show that there is a homogenous polynomial in two variables, $f(x, y)$, with integer coefficients, of degree at least 1 , such that $f(x, y)=1$ for each $(x, y)$ in the set $S$.

Note: A homogenous polynomial of degree $n$ is any nonzero polynomial of the form

\begin{equation*}
f(x, y)=a_{0} x^{n}+a_{1} x^{n-1} y+a_{2} x^{n-2} y^{2}+\cdots+a_{n-1} x y^{n-1}+a_{n} y^{n} . \tag{U.S.A.}
\end{equation*}","First of all, we note that finding a homogenous polynomial $f(x, y)$ such that $f(x, y)= \pm 1$ is enough, because we then have $f^{2}(x, y)=1$. Label the irreducible lattice points $\left(x_{1}, y_{1}\right)$ through $\left(x_{n}, y_{n}\right)$. If any two of these lattice points $\left(x_{i}, y_{i}\right)$ and $\left(x_{j}, y_{j}\right)$ lie on the same line through the origin, then $\left(x_{j}, y_{j}\right)=\left(-x_{i},-y_{i}\right)$ because both of the points are irreducible. We then have $f\left(x_{j}, y_{j}\right)= \pm f\left(x_{i}, y_{i}\right)$ whenever $f$ is homogenous, so we can assume that no two of the lattice points are collinear with the origin by ignoring the extra lattice points.

Consider the homogenous polynomials $\ell_{i}(x, y)=y_{i} x-x_{i} y$ and define

$$
g_{i}(x, y)=\prod_{j \neq i} \ell_{j}(x, y) .
$$

Then $\ell_{i}\left(x_{j}, y_{j}\right)=0$ if and only if $j=i$, because there is only one lattice point on each line through the origin. Thus, $g_{i}\left(x_{j}, y_{j}\right)=0$ for all $j \neq i$. Define $a_{i}=g_{i}\left(x_{i}, y_{i}\right)$, and note that $a_{i} \neq 0$.

Note that $g_{i}(x, y)$ is a degree $n-1$ polynomial with the following two properties:

\begin{enumerate}
  \item $g_{i}\left(x_{j}, y_{j}\right)=0$ if $j \neq i$.
  \item $g_{i}\left(x_{i}, y_{i}\right)=a_{i}$.
\end{enumerate}

For any $N \geqslant n-1$, there also exists a polynomial of degree $N$ with the same two properties. Specifically, let $I_{i}(x, y)$ be a degree 1 homogenous polynomial such that $I_{i}\left(x_{i}, y_{i}\right)=1$, which exists since $\left(x_{i}, y_{i}\right)$ is irreducible. Then $I_{i}(x, y)^{N-(n-1)} g_{i}(x, y)$ satisfies both of the above properties and has degree $N$.

We may now reduce the problem to the following claim:\\
Claim: For each positive integer $a$, there is a homogenous polynomial $f_{a}(x, y)$, with integer coefficients, of degree at least 1 , such that $f_{a}(x, y) \equiv 1(\bmod a)$ for all relatively prime $(x, y)$.

To see that this claim solves the problem, take $a$ to be the least common multiple of the numbers $a_{i}(1 \leqslant i \leqslant n)$. Take $f_{a}$ given by the claim, choose some power $f_{a}(x, y)^{k}$ that has degree at least $n-1$, and subtract appropriate multiples of the $g_{i}$ constructed above to obtain the desired polynomial.

We prove the claim by factoring $a$. First, if $a$ is a power of a prime $\left(a=p^{k}\right)$, then we may choose either:

\begin{itemize}
  \item $f_{a}(x, y)=\left(x^{p-1}+y^{p-1}\right)^{\phi(a)}$ if $p$ is odd;
  \item $f_{a}(x, y)=\left(x^{2}+x y+y^{2}\right)^{\phi(a)}$ if $p=2$.
\end{itemize}

Now suppose $a$ is any positive integer, and let $a=q_{1} q_{2} \cdots q_{k}$, where the $q_{i}$ are prime powers, pairwise relatively prime. Let $f_{q_{i}}$ be the polynomials just constructed, and let $F_{q_{i}}$ be powers of these that all have the same degree. Note that

$$
\frac{a}{q_{i}} F_{q_{i}}(x, y) \equiv \frac{a}{q_{i}} \quad(\bmod a)
$$

for any relatively prime $x, y$. By B锟斤拷zout's lemma, there is an integer linear combination of the $\frac{a}{q_{i}}$ that equals 1 . Thus, there is a linear combination of the $F_{q_{i}}$ such that $F_{q_{i}}(x, y) \equiv 1$ $(\bmod a)$ for any relatively prime $(x, y)$; and this polynomial is homogenous because all the $F_{q_{i}}$ have the same degree.",3,"For any prime power $a = p^k$, show that there exists a homogeneous polynomial $f_a(x, y)$ with integer coefficients and degree at least 1, such that $f_a(x, y) \equiv 1 \pmod{a}$ for all irreducible lattice points $(x, y)$.","If $p$ is an odd prime, let $P(x,y)=x^{p-1}+y^{p-1}$. For any irreducible point $(x,y)$, $\gcd(x,y)=1$, so $p$ cannot divide both $x$ and $y$. This implies $p$ does not divide $P(x,y)$. If $p=2$, let $P(x,y)=x^2+xy+y^2$. For $\gcd(x,y)=1$, $P(x,y)$ is always odd, so not divisible by 2. In both cases, $\gcd(P(x,y), p)=1$. By Euler's totient theorem, $f_a(x,y) = P(x,y)^{\phi(a)} \equiv 1 \pmod{a}$. This polynomial is homogeneous and has degree at least 1.","For any integer $a > 1$, show that there exists a homogeneous polynomial $f_a(x, y)$ with integer coefficients and degree at least 1, such that $f_a(x, y) \equiv 1 \pmod{a}$ for all irreducible lattice points $(x, y)$.","Let $a = q_1 \cdots q_k$ be its prime power factorization. From sub-problem 1, for each $q_i$, there is a homogeneous polynomial $f_{q_i}$ such that $f_{q_i}(x,y) \equiv 1 \pmod{q_i}$. Let $F_{q_i}$ be powers of $f_{q_i}$ such that all $F_{q_i}$ have the same degree $D$. Let $m_i = a/q_i$. Since $\gcd(m_1, \dots, m_k) = 1$, there exist integers $c_i$ with $\sum c_i m_i = 1$. The polynomial $f_a(x,y) = \sum_{i=1}^k c_i m_i F_{q_i}(x,y)$ is homogeneous of degree $D$. Modulo $q_j$, this sum reduces to $c_j m_j F_{q_j}(x,y) \equiv 1 \cdot 1 = 1 \pmod{q_j}$. By the Chinese Remainder Theorem, $f_a(x,y) \equiv 1 \pmod a$.","For any finite set $S$ of irreducible lattice points, show that there is a homogenous polynomial in two variables, $f(x, y)$, with integer coefficients, of degree at least 1, such that $f(x, y)=1$ for each $(x, y)$ in the set $S$.","We may assume no two points in $S = \{(x_1, y_1), \dots, (x_n, y_n)\}$ are collinear with the origin, as a polynomial $g$ that works for a reduced set provides a solution $g^2$ for the original set. For each $i \in \{1, \dots, n\}$, define the homogeneous polynomial $g_i(x,y) = \prod_{j \neq i} (y_j x - x_j y)$. Let $a_i = g_i(x_i, y_i)$, which is a non-zero integer. Let $a = \text{lcm}(|a_1|, \dots, |a_n|)$. By sub-problem 2, there is a homogeneous polynomial $F(x,y)$ of degree $N \ge n-1$ such that $F(u,v) \equiv 1 \pmod a$. This implies $F(x_i, y_i) = 1 + c_i a_i$ for some integers $c_i$. Let $H_i(x,y)$ be homogeneous polynomials of degree $N$ with $H_i(x_j, y_j) = a_i \delta_{ij}$. The polynomial $f(x,y) = F(x,y) - \sum_{i=1}^n c_i H_i(x,y)$ is homogeneous with degree at least 1 and satisfies $f(x_j, y_j) = (1+c_j a_j) - c_j a_j = 1$ for all $j$.",,
2017n8,"Let $p$ be an odd prime number and $\mathbb{Z}_{>0}$ be the set of positive integers. Suppose that a function $f: \mathbb{Z}_{>0} \times \mathbb{Z}_{>0} \rightarrow\{0,1\}$ satisfies the following properties:

\begin{itemize}
  \item $f(1,1)=0$;
  \item $f(a, b)+f(b, a)=1$ for any pair of relatively prime positive integers $(a, b)$ not both equal to 1 ;
  \item $f(a+b, b)=f(a, b)$ for any pair of relatively prime positive integers $(a, b)$.
\end{itemize}

Prove that

$$
\sum_{n=1}^{p-1} f\left(n^{2}, p\right) \geqslant \sqrt{2 p}-2
$$","Denote by $\mathbb{A}$ the set of all pairs of coprime positive integers. Notice that for every $(a, b) \in \mathbb{A}$ there exists a pair $(u, v) \in \mathbb{Z}^{2}$ with $u a+v b=1$. Moreover, if $\left(u_{0}, v_{0}\right)$ is one such pair, then all such pairs are of the form $(u, v)=\left(u_{0}+k b, v_{0}-k a\right)$, where $k \in \mathbb{Z}$. So there exists a unique such pair $(u, v)$ with $-b / 2<u \leqslant b / 2$; we denote this pair by $(u, v)=g(a, b)$.\\
Lemma. Let $(a, b) \in \mathbb{A}$ and $(u, v)=g(a, b)$. Then $f(a, b)=1 \Longleftrightarrow u>0$.\\
Proof. We induct on $a+b$. The base case is $a+b=2$. In this case, we have that $a=b=1$, $g(a, b)=g(1,1)=(0,1)$ and $f(1,1)=0$, so the claim holds.

Assume now that $a+b>2$, and so $a \neq b$, since $a$ and $b$ are coprime. Two cases are possible.\\
Case 1: $a>b$.\\
Notice that $g(a-b, b)=(u, v+u)$, since $u(a-b)+(v+u) b=1$ and $u \in(-b / 2, b / 2]$. Thus $f(a, b)=1 \Longleftrightarrow f(a-b, b)=1 \Longleftrightarrow u>0$ by the induction hypothesis.\\
Case 2: $a<b$. (Then, clearly, $b \geqslant 2$.)\\
Now we estimate $v$. Since $v b=1-u a$, we have

$$
1+\frac{a b}{2}>v b \geqslant 1-\frac{a b}{2}, \quad \text { so } \quad \frac{1+a}{2} \geqslant \frac{1}{b}+\frac{a}{2}>v \geqslant \frac{1}{b}-\frac{a}{2}>-\frac{a}{2}
$$

Thus $1+a>2 v>-a$, so $a \geqslant 2 v>-a$, hence $a / 2 \geqslant v>-a / 2$, and thus $g(b, a)=(v, u)$.\\
Observe that $f(a, b)=1 \Longleftrightarrow f(b, a)=0 \Longleftrightarrow f(b-a, a)=0$. We know from Case 1 that $g(b-a, a)=(v, u+v)$. We have $f(b-a, a)=0 \Longleftrightarrow v \leqslant 0$ by the inductive hypothesis. Then, since $b>a \geqslant 1$ and $u a+v b=1$, we have $v \leqslant 0 \Longleftrightarrow u>0$, and we are done.

The Lemma proves that, for all $(a, b) \in \mathbb{A}, f(a, b)=1$ if and only if the inverse of $a$ modulo $b$, taken in $\{1,2, \ldots, b-1\}$, is at most $b / 2$. Then, for any odd prime $p$ and integer $n$ such that $n \not \equiv 0(\bmod p), f\left(n^{2}, p\right)=1$ iff the inverse of $n^{2} \bmod p$ is less than $p / 2$. Since $\left\{n^{2} \bmod p: 1 \leqslant n \leqslant p-1\right\}=\left\{n^{-2} \bmod p: 1 \leqslant n \leqslant p-1\right\}$, including multiplicities (two for each quadratic residue in each set), we conclude that the desired sum is twice the number of quadratic residues that are less than $p / 2$, i.e.,


\begin{equation*}
\left.\sum_{n=1}^{p-1} f\left(n^{2}, p\right)=2 \left\lvert\,\left\{k: 1 \leqslant k \leqslant \frac{p-1}{2} \text { and } k^{2} \bmod p<\frac{p}{2}\right\}\right. \right\rvert\, \tag{1}
\end{equation*}


Since the number of perfect squares in the interval $[1, p / 2)$ is $\lfloor\sqrt{p / 2}\rfloor>\sqrt{p / 2}-1$, we conclude that

$$
\sum_{n=1}^{p-1} f\left(n^{2}, p\right)>2\left(\sqrt{\frac{p}{2}}-1\right)=\sqrt{2 p}-2
$$",3,"Let $(a,b)$ be a pair of coprime positive integers. For such a pair, there is a unique pair of integers $(u,v)$ such that $ua+vb=1$ and $-b/2 < u \le b/2$. Prove that $f(a,b)=1$ if and only if $u>0$.","We prove this by induction on $s=a+b$. The base case $a=b=1$ holds, as $(u,v)=(0,1)$ and $f(1,1)=0$. For the induction step, assume the claim holds for sums less than $s$. \nIf $a>b$, then $f(a,b)=f(a-b,b)$. The unique integer $u \\in (-b/2, b/2]$ satisfying $ua \\equiv 1 \\pmod b$ also satisfies $u(a-b) \\equiv 1 \\pmod b$. By induction, $f(a-b,b)=1 \\iff u>0$, so the claim holds for $(a,b)$.\nIf $a<b$, then $f(a,b)=1-f(b,a)=1-f(b-a,a)$. The unique pair for $(b,a)$ is $(v,u)$ where $v \\in (-a/2, a/2]$. The first component of the pair for $(b-a,a)$ is $v$. By induction, $f(b-a,a)=1 \\iff v>0$. So $f(a,b)=1 \\iff v\\le 0$. Since $ua+vb=1$ and $a,b>0$, $v\\le 0 \\iff ua\\ge 1 \\iff u>0$. This completes the induction.","Let $QR_p$ be the set of non-zero quadratic residues modulo $p$. Using the result from Sub-problem 1, show that $\\sum_{n=1}^{p-1} f\\left(n^{2}, p\right) = 2 \\left|\\left\\{k \\in QR_p \\mid 1 \\le k < p/2 \right\\}\right|$.","From Sub-problem 1, $f(a,p)=1$ if and only if the standard modular inverse of $a \\pmod p$ in $\{1, \\dots, p-1\}$ is in $\{1, \\dots, (p-1)/2\}$. Let $inv(x)$ be this inverse. The sum is $\\sum_{n=1}^{p-1} [inv(n^2) \\le (p-1)/2]$, where $[\cdot]$ is the Iverson bracket. The list of values $(n^2 \\pmod p)_{n=1}^{p-1}$ contains each non-zero quadratic residue (QR) exactly twice. Since $inv(n^2) = (inv(n))^2$ and $n \\mapsto inv(n)$ is a permutation of $\{1, \\dots, p-1\}$, the list $(inv(n^2) \\pmod p)_{n=1}^{p-1}$ is the same multiset. Thus, the sum is equal to $\\sum_{n=1}^{p-1} [n^2 \\pmod p \\le (p-1)/2]$. Let $S = \\{k \\in QR_p \\mid 1 \\le k < p/2\\}$. Each $k \\in S$ appears twice in the list of squares. Thus, the sum is $2|S|$.","Prove that $\\sum_{n=1}^{p-1} f\\left(n^{2}, p\right) \\geqslant \\sqrt{2 p}-2$.","From Sub-problem 2, the sum is $2 \\left|\\left\\{k \\in QR_p \\mid 1 \\le k < p/2 \right\\}\right|$. Let this set be $S$. To find a lower bound for $|S|$, consider the set of perfect squares $P = \\{m^2 \\mid m \\in \\mathbb{Z}_{>0}, m^2 < p/2\\}$. Every element of $P$ is an integer in the range $[1, p/2)$ and is a quadratic residue modulo $p$. Thus, $P \\subseteq S$. The size of $P$ is the number of positive integers $m$ with $m < \\sqrt{p/2}$, which is $|P| = \\lfloor\\sqrt{p/2}\rfloor$. Therefore, $|S| \\ge |P| = \\lfloor\\sqrt{p/2}\rfloor$. The sum is at least $2\\lfloor\\sqrt{p/2}\rfloor$. Using the inequality $\\lfloor x \rfloor > x-1$, we have: $\\sum_{n=1}^{p-1} f\\left(n^{2}, p\right) \\ge 2\\lfloor\\sqrt{p/2}\rfloor > 2(\\sqrt{p/2}-1) = \\sqrt{2p}-2$. This implies the required inequality.",,
2016a1,"Let $a, b$ and $c$ be positive real numbers such that $\min \{a b, b c, c a\} \geqslant 1$. Prove that


\begin{equation*}
\sqrt[3]{\left(a^{2}+1\right)\left(b^{2}+1\right)\left(c^{2}+1\right)} \leqslant\left(\frac{a+b+c}{3}\right)^{2}+1 \tag{1}
\end{equation*}","We first show the following.

\begin{itemize}
  \item Claim. For any positive real numbers $x, y$ with $x y \geqslant 1$, we have
\end{itemize}


\begin{equation*}
\left(x^{2}+1\right)\left(y^{2}+1\right) \leqslant\left(\left(\frac{x+y}{2}\right)^{2}+1\right)^{2} \tag{2}
\end{equation*}


Proof. Note that $x y \geqslant 1$ implies $\left(\frac{x+y}{2}\right)^{2}-1 \geqslant x y-1 \geqslant 0$. We find that

$$
\left(x^{2}+1\right)\left(y^{2}+1\right)=(x y-1)^{2}+(x+y)^{2} \leqslant\left(\left(\frac{x+y}{2}\right)^{2}-1\right)^{2}+(x+y)^{2}=\left(\left(\frac{x+y}{2}\right)^{2}+1\right)^{2} .
$$

Without loss of generality, assume $a \geqslant b \geqslant c$. This implies $a \geqslant 1$. Let $d=\frac{a+b+c}{3}$. Note that

$$
a d=\frac{a(a+b+c)}{3} \geqslant \frac{1+1+1}{3}=1 .
$$

Then we can apply (2) to the pair $(a, d)$ and the pair $(b, c)$. We get


\begin{equation*}
\left(a^{2}+1\right)\left(d^{2}+1\right)\left(b^{2}+1\right)\left(c^{2}+1\right) \leqslant\left(\left(\frac{a+d}{2}\right)^{2}+1\right)^{2}\left(\left(\frac{b+c}{2}\right)^{2}+1\right)^{2} \tag{3}
\end{equation*}


Next, from

$$
\frac{a+d}{2} \cdot \frac{b+c}{2} \geqslant \sqrt{a d} \cdot \sqrt{b c} \geqslant 1,
$$

we can apply (2) again to the pair $\left(\frac{a+d}{2}, \frac{b+c}{2}\right)$. Together with (3), we have

$$
\left(a^{2}+1\right)\left(d^{2}+1\right)\left(b^{2}+1\right)\left(c^{2}+1\right) \leqslant\left(\left(\frac{a+b+c+d}{4}\right)^{2}+1\right)^{4}=\left(d^{2}+1\right)^{4}
$$

Therefore, $\left(a^{2}+1\right)\left(b^{2}+1\right)\left(c^{2}+1\right) \leqslant\left(d^{2}+1\right)^{3}$, and (1) follows by taking cube root of both sides.",2,"For any positive real numbers $x, y$ with $x y \geqslant 1$, prove that $\left(x^{2}+1\right)\left(y^{2}+1\right) \leqslant\left(\left(\frac{x+y}{2}\right)^{2}+1\right)^{2}$.","The inequality expands to $(x y-1)^{2}+(x+y)^{2} \leqslant \left(\left(\frac{x+y}{2}\right)^{2}+1\right)^{2}$. From $xy \ge 1$ and AM-GM, we have $\left(\frac{x+y}{2}\right)^{2} \ge xy$, which implies $\left(\frac{x+y}{2}\right)^{2}-1 \ge xy-1 \ge 0$. Squaring this gives $\left(\left(\frac{x+y}{2}\right)^{2}-1\right)^{2} \ge (xy-1)^2$. The required inequality follows because $\left(x^{2}+1\right)\left(y^{2}+1\right)=(x y-1)^{2}+(x+y)^{2} \leqslant\left(\left(\frac{x+y}{2}\right)^{2}-1\right)^{2}+(x+y)^{2}=\left(\left(\frac{x+y}{2}\right)^{2}+1\right)^{2}$.","Let $a, b$ and $c$ be positive real numbers such that $\min \{a b, b c, c a\} \geqslant 1$. Prove that $\sqrt[3]{\left(a^{2}+1\right)\left(b^{2}+1\right)\left(c^{2}+1\right)} \leqslant\left(\frac{a+b+c}{3}\right)^{2}+1$.","Let $d=\frac{a+b+c}{3}$. The condition $\min \{a b, b c, c a\} \geqslant 1$ implies $a,b,c \ge 1$, which ensures $ad \ge 1$. Using the result from the first sub-problem, since $bc \ge 1$ and $ad \ge 1$, we can write $\left(b^{2}+1\right)\left(c^{2}+1\right) \le \left(\left(\frac{b+c}{2}\right)^{2}+1\right)^{2}$ and $\left(a^{2}+1\right)\left(d^{2}+1\right) \le \left(\left(\frac{a+d}{2}\right)^{2}+1\right)^{2}$. Multiplying these gives $\left(a^{2}+1\right)\left(b^{2}+1\right)\left(c^{2}+1\right)\left(d^{2}+1\right) \leqslant \left(\left(\frac{a+d}{2}\right)^{2}+1\right)^{2}\left(\left(\frac{b+c}{2}\right)^{2}+1\right)^{2}$. Since $\frac{a+d}{2} \cdot \frac{b+c}{2} \geqslant \sqrt{ad} \sqrt{bc} \ge 1$, we apply the first result again to the right side, yielding $\left(\left(\frac{a+b+c+d}{4}\right)^{2}+1\right)^{4}$. As $\frac{a+b+c+d}{4} = \frac{3d+d}{4} = d$, we get $\left(a^{2}+1\right)\left(b^{2}+1\right)\left(c^{2}+1\right)\left(d^{2}+1\right) \le (d^2+1)^4$. Dividing by $d^2+1$ gives $\left(a^{2}+1\right)\left(b^{2}+1\right)\left(c^{2}+1\right) \leqslant (d^2+1)^3$. Taking the cube root completes the proof.",,,,
2016a5,"(a) Prove that for every positive integer $n$, there exists a fraction $\frac{a}{b}$ where $a$ and $b$ are integers satisfying $0<b \leqslant \sqrt{n}+1$ and $\sqrt{n} \leqslant \frac{a}{b} \leqslant \sqrt{n+1}$.\\
(b) Prove that there are infinitely many positive integers $n$ such that there is no fraction $\frac{a}{b}$ where $a$ and $b$ are integers satisfying $0<b \leqslant \sqrt{n}$ and $\sqrt{n} \leqslant \frac{a}{b} \leqslant \sqrt{n+1}$.","(a) Let $r$ be the unique positive integer for which $r^{2} \leqslant n<(r+1)^{2}$. Write $n=r^{2}+s$. Then we have $0 \leqslant s \leqslant 2 r$. We discuss in two cases according to the parity of $s$.

\begin{itemize}
  \item Case 1. $s$ is even.
\end{itemize}

Consider the number $\left(r+\frac{s}{2 r}\right)^{2}=r^{2}+s+\left(\frac{s}{2 r}\right)^{2}$. We find that

$$
n=r^{2}+s \leqslant r^{2}+s+\left(\frac{s}{2 r}\right)^{2} \leqslant r^{2}+s+1=n+1
$$

It follows that

$$
\sqrt{n} \leqslant r+\frac{s}{2 r} \leqslant \sqrt{n+1}
$$

Since $s$ is even, we can choose the fraction $r+\frac{s}{2 r}=\frac{r^{2}+(s / 2)}{r}$ since $r \leqslant \sqrt{n}$.

\begin{itemize}
  \item Case 2. $s$ is odd.
\end{itemize}

Consider the number $\left(r+1-\frac{2 r+1-s}{2(r+1)}\right)^{2}=(r+1)^{2}-(2 r+1-s)+\left(\frac{2 r+1-s}{2(r+1)}\right)^{2}$. We find that

$$
\begin{aligned}
n=r^{2}+s=(r+1)^{2}-(2 r+1-s) & \leqslant(r+1)^{2}-(2 r+1-s)+\left(\frac{2 r+1-s}{2(r+1)}\right)^{2} \\
& \leqslant(r+1)^{2}-(2 r+1-s)+1=n+1
\end{aligned}
$$

It follows that

$$
\sqrt{n} \leqslant r+1-\frac{2 r+1-s}{2(r+1)} \leqslant \sqrt{n+1}
$$

Since $s$ is odd, we can choose the fraction $(r+1)-\frac{2 r+1-s}{2(r+1)}=\frac{(r+1)^{2}-r+((s-1) / 2)}{r+1}$ since $r+1 \leqslant \sqrt{n}+1$.\\
(b) We show that for every positive integer $r$, there is no fraction $\frac{a}{b}$ with $b \leqslant \sqrt{r^{2}+1}$ such that $\sqrt{r^{2}+1} \leqslant \frac{a}{b} \leqslant \sqrt{r^{2}+2}$. Suppose on the contrary that such a fraction exists. Since $b \leqslant \sqrt{r^{2}+1}<r+1$ and $b$ is an integer, we have $b \leqslant r$. Hence,

$$
(b r)^{2}<b^{2}\left(r^{2}+1\right) \leqslant a^{2} \leqslant b^{2}\left(r^{2}+2\right) \leqslant b^{2} r^{2}+2 b r<(b r+1)^{2}
$$

This shows the square number $a^{2}$ is strictly bounded between the two consecutive squares $(b r)^{2}$ and $(b r+1)^{2}$, which is impossible. Hence, we have found infinitely many $n=r^{2}+1$ for which there is no fraction of the desired form.",2,Let $r$ be a positive integer and $b$ be an integer satisfying $1 \le b \le r$. Prove that there is no integer $a$ such that $b^2(r^2+1) \le a^2 \le b^2(r^2+2)$.,"We analyze the interval $[b^2(r^2+1), b^2(r^2+2)]$. The lower bound is $b^2(r^2+1) = b^2r^2+b^2 = (br)^2+b^2$. Since $b \ge 1$, $b^2 \ge 1$, so $b^2(r^2+1) > (br)^2$. The upper bound is $b^2(r^2+2) = b^2r^2+2b^2$. Since $b$ is a positive integer and $b \le r$, we have $2b^2 \le 2br < 2br+1$. Therefore, $b^2r^2+2b^2 < b^2r^2+2br+1 = (br+1)^2$. So, we have shown $(br)^2 < b^2(r^2+1) \le a^2 \le b^2(r^2+2) < (br+1)^2$. This implies $a^2$ is an integer strictly between two consecutive squares, $(br)^2$ and $(br+1)^2$, which is impossible. Thus, no such integer $a$ exists.","(a) Prove that for every positive integer $n$, there exists a fraction $\frac{a}{b}$ where $a$ and $b$ are integers satisfying $0<b \leqslant \sqrt{n}+1$ and $\sqrt{n} \leqslant \frac{a}{b} \leqslant \sqrt{n+1}$.\n(b) Prove that there are infinitely many positive integers $n$ such that there is no fraction $\frac{a}{b}$ where $a$ and $b$ are integers satisfying $0<b \leqslant \sqrt{n}$ and $\sqrt{n} \leqslant \frac{a}{b} \leqslant \sqrt{n+1}$.","For part (a), let $r = \lfloor \sqrt{n} \rfloor$ and $n=r^2+s$, with $0 \le s \le 2r$. We consider two cases based on the parity of $s$. If $s$ is even, we choose $\frac{a}{b} = r+\frac{s}{2r} = \frac{r^2+s/2}{r}$. Then $b=r \le \sqrt{n} < \sqrt{n}+1$. The square $(\frac{a}{b})^2 = n+(\frac{s}{2r})^2$ is in $[n, n+1]$ as $s \le 2r$. If $s$ is odd, we choose $\frac{a}{b} = r+1-\frac{2r+1-s}{2(r+1)} = \frac{r^2+r+(s+1)/2}{r+1}$. Then $b=r+1 \le \sqrt{n}+1$ since $r \le \sqrt{n}$. The square $(\frac{a}{b})^2 = n+(\frac{2r+1-s}{2(r+1)})^2$ is in $[n, n+1]$ as $1 \le s \le 2r-1$ implies $0 < (\frac{2r+1-s}{2(r+1)})^2 < 1$. In both cases, $\sqrt{n} \le \frac{a}{b} \le \sqrt{n+1}$ holds for a fraction with a valid denominator.\nFor part (b), consider the infinite set of integers $n=r^2+1$ for $r=1, 2, 3, \dots$. Suppose a fraction $\frac{a}{b}$ exists for such an $n$. The condition on the denominator is $0<b \le \sqrt{n} = \sqrt{r^2+1}$. Since $b$ is an integer, this implies $b \le r$. The condition on the fraction, $\sqrt{n} \le \frac{a}{b} \le \sqrt{n+1}$, becomes $\sqrt{r^2+1} \le \frac{a}{b} \le \sqrt{r^2+2}$. Squaring all parts gives $b^2(r^2+1) \le a^2 \le b^2(r^2+2)$. From the first sub-problem, we know that for $1 \le b \le r$, there is no integer $a$ satisfying this condition. This is a contradiction. Thus, for the infinitely many integers of the form $n=r^2+1$, no such fraction exists.",,,,
2016c3,Let $n$ be a positive integer relatively prime to 6 . We paint the vertices of a regular $n$-gon with three colours so that there is an odd number of vertices of each colour. Show that there exists an isosceles triangle whose three vertices are of different colours.,"Solution. For $k=1,2,3$, let $a_{k}$ be the number of isosceles triangles whose vertices contain exactly $k$ colours. Suppose on the contrary that $a_{3}=0$. Let $b, c, d$ be the number of vertices of the three different colours respectively. We now count the number of pairs $(\triangle, E)$ where $\triangle$ is an isosceles triangle and $E$ is a side of $\triangle$ whose endpoints are of different colours.

On the one hand, since we have assumed $a_{3}=0$, each triangle in the pair must contain exactly two colours, and hence each triangle contributes twice. Thus the number of pairs is $2 a_{2}$.

On the other hand, if we pick any two vertices $A, B$ of distinct colours, then there are three isosceles triangles having these as vertices, two when $A B$ is not the base and one when $A B$ is the base since $n$ is odd. Note that the three triangles are all distinct as $(n, 3)=1$. In this way, we count the number of pairs to be $3(b c+c d+d b)$. However, note that $2 a_{2}$ is even while $3(b c+c d+d b)$ is odd, as each of $b, c, d$ is. This yields a contradiction and hence $a_{3} \geqslant 1$.

Comment. A slightly stronger version of this problem is to replace the condition $(n, 6)=1$ by $n$ being odd (where equilateral triangles are regarded as isosceles triangles). In that case, the only difference in the proof is that by fixing any two vertices $A, B$, one can find exactly one or three isosceles triangles having these as vertices. But since only parity is concerned in the solution, the proof goes the same way.

The condition that there is an odd number of vertices of each colour is necessary, as can be seen from the following example. Consider $n=25$ and we label the vertices $A_{0}, A_{1}, \ldots, A_{24}$. Suppose colour 1 is used for $A_{0}$, colour 2 is used for $A_{5}, A_{10}, A_{15}, A_{20}$, while colour 3 is used for the remaining vertices. Then any isosceles triangle having colours 1 and 2 must contain $A_{0}$ and one of $A_{5}, A_{10}, A_{15}, A_{20}$. Clearly, the third vertex must have index which is a multiple of 5 so it is not of colour 3 .",3,"Let $A$ and $B$ be two distinct vertices of a regular $n$-gon, where $n$ is an integer such that $(n, 6)=1$. Prove that there are exactly three distinct isosceles triangles having $A$ and $B$ as vertices.","Let the vertices be $v_i$ and $v_j$. An isosceles triangle $v_i v_j v_k$ can have one of three vertices as the apex. 
1. Apex at $v_k$: $v_k$ is on the perpendicular bisector of segment $v_i v_j$. Since $n$ is odd, this bisector passes through a unique vertex. 
2. Apex at $v_i$: The third vertex $v_k$ must satisfy distance($v_i, v_k$) = distance($v_i, v_j$). This gives the vertex $v_k$ with index $k ≡ 2i-j \pmod n$. 
3. Apex at $v_j$: Similarly, the third vertex $v_k$ has index $k ≡ 2j-i \pmod n$. 
These three choices for $v_k$ are distinct because $(n,3)=1$. For example, if $2i-j ≡ 2j-i \pmod n$, then $3(i-j) ≡ 0 \pmod n$, which implies $i=j$, a contradiction. Thus, there are exactly three such distinct triangles.","Let the vertices of a regular $n$-gon be painted with three colours, where $(n,6)=1$. Let $b,c,d$ be the number of vertices of each colour, and $a_k$ be the number of isosceles triangles with exactly $k$ colours. Assuming $a_3=0$, derive a relationship between $a_2$, $b$, $c$, and $d$ by counting pairs $(\triangle, E)$ where $\triangle$ is an isosceles triangle and $E$ is a side of $\triangle$ with endpoints of different colours.","We count the number of such pairs $(\triangle, E)$ in two ways. 
1. Counting via triangles: Since we assume $a_3=0$, any such triangle $\triangle$ must have exactly two colours. An isosceles triangle with two colours has two sides with endpoints of different colours and one side with endpoints of the same colour. Thus, each of the $a_2$ such triangles contributes 2 pairs. The total count is $2a_2$. 
2. Counting via sides: The number of pairs of vertices with different colours is $bc+cd+db$. From the result of sub-problem 1, for each such pair of vertices, there are exactly three isosceles triangles having them as vertices. Each of these triangles forms a valid pair $(\triangle, E)$ with the edge defined by the two vertices. Thus, the total count is $3(bc+cd+db)$. 
Equating both counts gives the relationship $2a_2 = 3(bc+cd+db)$.",Let $n$ be a positive integer relatively prime to 6. We paint the vertices of a regular $n$-gon with three colours so that there is an odd number of vertices of each colour. Show that there exists an isosceles triangle whose three vertices are of different colours.,"Let $b, c, d$ be the number of vertices of each colour. By the problem statement, $b, c, d$ are all odd integers. Assume for contradiction that there are no isosceles triangles with vertices of three different colours ($a_3=0$). From the result of sub-problem 2, we have the relation $2a_2 = 3(bc+cd+db)$, where $a_2$ is the number of two-coloured isosceles triangles. The left side, $2a_2$, is an even integer. On the right side, since $b, c, d$ are odd, the products $bc, cd, db$ are also odd. The sum of three odd numbers, $bc+cd+db$, is odd. Therefore, $3(bc+cd+db)$ is an odd number. This leads to the contradiction that an even number is equal to an odd number. Thus, our initial assumption must be false, and there must exist at least one isosceles triangle with three different colours.",,
2016c6,"There are $n \geqslant 3$ islands in a city. Initially, the ferry company offers some routes between some pairs of islands so that it is impossible to divide the islands into two groups such that no two islands in different groups are connected by a ferry route.

After each year, the ferry company will close a ferry route between some two islands $X$ and $Y$. At the same time, in order to maintain its service, the company will open new routes according to the following rule: for any island which is connected by a ferry route to exactly one of $X$ and $Y$, a new route between this island and the other of $X$ and $Y$ is added.

Suppose at any moment, if we partition all islands into two nonempty groups in any way, then it is known that the ferry company will close a certain route connecting two islands from the two groups after some years. Prove that after some years there will be an island which is connected to all other islands by ferry routes.","Solution. Initially, we pick any pair of islands $A$ and $B$ which are connected by a ferry route and put $A$ in set $\mathcal{A}$ and $B$ in set $\mathcal{B}$. From the condition, without loss of generality there must be another island which is connected to $A$. We put such an island $C$ in set $\mathcal{B}$. We say that two sets of islands form a network if each island in one set is connected to each island in the other set.

Next, we shall included all islands to $\mathcal{A} \cup \mathcal{B}$ one by one. Suppose we have two sets $\mathcal{A}$ and $\mathcal{B}$ which form a network where $3 \leqslant|\mathcal{A} \cup \mathcal{B}|<n$. This relation no longer holds only when a ferry route between islands $A \in \mathcal{A}$ and $B \in \mathcal{B}$ is closed. In that case, we define $\mathcal{A}^{\prime}=\{A, B\}$, and $\mathcal{B}^{\prime}=(\mathcal{A} \cup \mathcal{B})-\{A, B\}$. Note that $\mathcal{B}^{\prime}$ is nonempty. Consider any island $C \in \mathcal{A}-\{A\}$. From the relation of $\mathcal{A}$ and $\mathcal{B}$, we know that $C$ is connected to $B$. If $C$ was not connected to $A$ before the route between $A$ and $B$ closes, then there will be a route added between $C$ and $A$ afterwards. Hence, $C$ must now be connected to both $A$ and $B$. The same holds true for any island in $\mathcal{B}-\{B\}$. Therefore, $\mathcal{A}^{\prime}$ and $\mathcal{B}^{\prime}$ form a network, and $\mathcal{A}^{\prime} \cup \mathcal{B}^{\prime}=\mathcal{A} \cup \mathcal{B}$. Hence these islands can always be partitioned into sets $\mathcal{A}$ and $\mathcal{B}$ which form a network.

As $|\mathcal{A} \cup \mathcal{B}|<n$, there are some islands which are not included in $\mathcal{A} \cup \mathcal{B}$. From the condition, after some years there must be a ferry route between an island $A$ in $\mathcal{A} \cup \mathcal{B}$ and an island $D$ outside $\mathcal{A} \cup \mathcal{B}$ which closes. Without loss of generality assume $A \in \mathcal{A}$. Then each island in $\mathcal{B}$ must then be connected to $D$, no matter it was or not before. Hence, we can put $D$ in set $\mathcal{A}$ so that the new sets $\mathcal{A}$ and $\mathcal{B}$ still form a network and the size of $\mathcal{A} \cup \mathcal{B}$ is increased by 1 . The same process can be done to increase the size of $\mathcal{A} \cup \mathcal{B}$. Eventually, all islands are included in this way so we may now assume $|\mathcal{A} \cup \mathcal{B}|=n$.

Suppose a ferry route between $A \in \mathcal{A}$ and $B \in \mathcal{B}$ is closed after some years. We put $A$ and $B$ in set $\mathcal{A}^{\prime}$ and all remaining islands in set $\mathcal{B}^{\prime}$. Then $\mathcal{A}^{\prime}$ and $\mathcal{B}^{\prime}$ form a network. This relation no longer holds only when a route between $A$, without loss of generality, and $C \in \mathcal{B}^{\prime}$ is closed. Since this must eventually occur, at that time island $B$ will be connected to all other islands and the result follows.",3,"Define a network on a set of islands $S$ as a partition of $S$ into non-empty sets $\mathcal{A}$ and $\mathcal{B}$ where every island in $\mathcal{A}$ is connected to every island in $\mathcal{B}$. Show that if a route between $A \in \mathcal{A}$ and $B \in \mathcal{B}$ is closed, the set $S$ can be re-partitioned to form a new network.","Let the network on $S$ be $(\mathcal{A}, \mathcal{B})$. When the route $(A,B)$ for $A \in \mathcal{A}, B \in \mathcal{B}$ is closed, consider any island $C \in S \setminus \{A,B\}$. If $C \in \mathcal{A}$, it is connected to $B$. After the operation, if $C$ was not connected to $A$, it becomes connected. So $C$ is now connected to both $A$ and $B$. Similarly, if $C \in \mathcal{B}$, it is connected to $A$ and will also be connected to $B$. Therefore, every island in $S \setminus \{A,B\}$ is connected to both $A$ and $B$. We define a new network on $S$ with partitions $\mathcal{A}'=\{A,B\}$ and $\mathcal{B}'=S \setminus \{A,B\}$. Since $|S| \ge 3$, $\mathcal{B}'$ is non-empty.","Show that eventually, the set of all $n$ islands can be partitioned into two non-empty sets $\mathcal{A}$ and $\mathcal{B}$ forming a network.","The initial graph is connected and $n \ge 3$, so there exists a path $C-A-B$. This gives an initial network on $\{A,B,C\}$ with $\mathcal{A}_0=\{A\}, \mathcal{B}_0=\{B,C\}$. Let $S$ be the set of islands in the current network. If $S$ does not contain all islands, the problem states a route between $S$ and its complement $N \setminus S$ must eventually be closed. Let this be $(X,D)$ where $X \in \mathcal{A} \subset S$ and $D \notin S$. For any island $Y \in \mathcal{B}$, $Y$ is connected to $X$. The rule ensures $Y$ becomes connected to $D$. We can then add $D$ to $\mathcal{A}$ to form a larger network $(\mathcal{A} \cup \{D\}, \mathcal{B})$ on $S \cup \{D\}$. This process repeats until all islands are included.",Prove that after some years there will be an island which is connected to all other islands by ferry routes.,"By Sub-problem 2, all $n$ islands eventually form a network $(\mathcal{A}, \mathcal{B})$. A route between $A \in \mathcal{A}$ and $B \in \mathcal{B}$ must eventually be closed. By Sub-problem 1, this creates a new network $(\mathcal{A}', \mathcal{B}')$ with $\mathcal{A}'=\{A,B\}$ and $\mathcal{B}'$ as the other islands. This relation must again be broken by closing a route between the new partitions, say between $A \in \mathcal{A}'$ and $C \in \mathcal{B}'$. Consider island $B$. Before this operation, $B$ is connected to $C$ (as $B \in \mathcal{A}', C \in \mathcal{B}'$), but the route $(A,B)$ has been closed. Thus $B$ is connected to exactly one of $\{A,C\}$, namely $C$. The rule adds a route $(B,A)$. Since $B$ was already connected to all islands in $\mathcal{B}'$, $B$ is now connected to $A$ and all of $\mathcal{B}'$, which constitutes all other $n-1$ islands.",,
2016c7,"Let $n \geqslant 2$ be an integer. In the plane, there are $n$ segments given in such a way that any two segments have an intersection point in the interior, and no three segments intersect at a single point. Jeff places a snail at one of the endpoints of each of the segments and claps his hands $n-1$ times. Each time when he claps his hands, all the snails move along their own segments and stay at the next intersection points until the next clap. Since there are $n-1$ intersection points on each segment, all snails will reach the furthest intersection points from their starting points after $n-1$ claps.\\
(a) Prove that if $n$ is odd then Jeff can always place the snails so that no two of them ever occupy the same intersection point.\\
(b) Prove that if $n$ is even then there must be a moment when some two snails occupy the same intersection point no matter how Jeff places the snails.","Solution. We consider a big disk which contains all the segments. We extend each segment to a line $l_{i}$ so that each of them cuts the disk at two distinct points $A_{i}, B_{i}$.\\
(a) For odd $n$, we travel along the circumference of the disk and mark each of the points $A_{i}$ or $B_{i}$ 'in' and 'out' alternately. Since every pair of lines intersect in the disk, there are exactly $n-1$ points between $A_{i}$ and $B_{i}$ for any fixed $1 \leqslant i \leqslant n$. As $n$ is odd, this means one of $A_{i}$ and $B_{i}$ is marked 'in' and the other is marked 'out'. Then Jeff can put a snail on the endpoint of each segment which is closer to the 'in' side of the corresponding line. We claim that the snails on $l_{i}$ and $l_{j}$ do not meet for any pairs $i, j$, hence proving part (a).\\
\includegraphics[max width=\textwidth, center]{2025_04_30_7daf08b5ed3ffd852861g-43}

Without loss of generality, we may assume the snails start at $A_{i}$ and $A_{j}$ respectively. Let $l_{i}$ intersect $l_{j}$ at $P$. Note that there is an odd number of points between arc $A_{i} A_{j}$. Each of these points belongs to a line $l_{k}$. Such a line $l_{k}$ must intersect exactly one of\\
the segments $A_{i} P$ and $A_{j} P$, making an odd number of intersections. For the other lines, they may intersect both segments $A_{i} P$ and $A_{j} P$, or meet none of them. Therefore, the total number of intersection points on segments $A_{i} P$ and $A_{j} P$ (not counting $P$ ) is odd. However, if the snails arrive at $P$ at the same time, then there should be the same number of intersections on $A_{i} P$ and $A_{j} P$, which gives an even number of intersections. This is a contradiction so the snails do not meet each other.\\
(b) For even $n$, we consider any way that Jeff places the snails and mark each of the points $A_{i}$ or $B_{i}$ 'in' and 'out' according to the directions travelled by the snails. In this case there must be two neighbouring points $A_{i}$ and $A_{j}$ both of which are marked 'in'. Let $P$ be the intersection of the segments $A_{i} B_{i}$ and $A_{j} B_{j}$. Then any other segment meeting one of the segments $A_{i} P$ and $A_{j} P$ must also meet the other one, and so the number of intersections on $A_{i} P$ and $A_{j} P$ are the same. This shows the snails starting from $A_{i}$ and $A_{j}$ will meet at $P$.",3,"Extend the $n$ segments to lines $l_i$, intersecting the boundary of a large disk at points $\{A_i, B_i\}$. For two snails starting at endpoints $S_i$ and $S_j$ on lines $l_i$ and $l_j$ (which intersect at $P$), prove that the sum of the number of intersections on the segments $S_iP$ and $S_jP$, denoted $N(S_iP) + N(S_jP)$, has the same parity as the number of endpoints of other lines on the shorter circular arc between $S_i$ and $S_j$.","A snail collision at $P$ occurs if and only if the number of intersections on segment $S_iP$ equals the number on $S_jP$. Consider a third line $l_k$. If one of its endpoints lies on the arc between $S_i$ and $S_j$ and the other does not, $l_k$ must cross exactly one of the segments $S_iP$ or $S_jP$. If both endpoints of $l_k$ lie outside this arc, $l_k$ must cross both or neither of $S_iP$ and $S_jP$. Thus, each endpoint on the shorter arc between $S_i$ and $S_j$ contributes 1 (modulo 2) to the total count of intersections $N(S_iP) + N(S_jP)$. The sum's parity is therefore determined by the number of endpoints on this arc.","Using the circular arrangement of $2n$ endpoints from Sub-problem 1, prove that: (1) if $n$ is odd, we can choose starting points $\{S_i\}_{i=1}^n$ such that for any pair $S_i, S_j$, the number of endpoints on the arc between them is odd; (2) if $n$ is even, for any choice of starting points, there must exist a pair $S_i, S_j$ that are adjacent on the circle.","(1) If $n$ is odd, label the $2n$ endpoints on the circle alternately 'start' and 'end'. Since the number of points on an arc between any line's endpoints $A_i$ and $B_i$ is $n-1$ (even), they receive opposite labels. We choose all 'start' labeled points as a valid configuration. For any two 'start' points, the number of endpoints between them is odd. (2) If $n$ is even, let starting points be labeled 'start' and others 'end'. There are $n$ of each. If there were no adjacent 'start' points, the labels must alternate. But for any line $l_i$, its endpoints $A_i, B_i$ are separated by $n-1$ (odd) points, which means they would have to get the same label in an alternating scheme. This contradicts one being 'start' and one 'end'. So there must be an adjacent pair of identical labels. By symmetry, we can assume there is an adjacent 'start'-'start' pair.",(a) Prove that if $n$ is odd then Jeff can always place the snails so that no two of them ever occupy the same intersection point.\n(b) Prove that if $n$ is even then there must be a moment when some two snails occupy the same intersection point no matter how Jeff places the snails.,"(a) For odd $n$, choose starting points as in Sub-problem 2(1). For any pair of snails starting at $S_i, S_j$, the number of endpoints on the arc between them is odd. By Sub-problem 1, $N(S_iP) + N(S_jP)$ is odd, which implies $N(S_iP) \neq N(S_jP)$. Thus, no two snails collide. (b) For even $n$, any choice of starting points must, by Sub-problem 2(2), contain an adjacent pair $S_i, S_j$. The number of endpoints on the arc between them is 0. By Sub-problem 1, $N(S_iP) + N(S_jP)$ is even. Since the arc is empty, any other line $l_k$ crosses $S_iP$ if and only if it crosses $S_jP$, so $N(S_iP) = N(S_jP)$. The snails will therefore collide.",,
2016g1,"In a convex pentagon $A B C D E$, let $F$ be a point on $A C$ such that $\angle F B C=90^{\circ}$. Suppose triangles $A B F, A C D$ and $A D E$ are similar isosceles triangles with


\begin{equation*}
\angle F A B=\angle F B A=\angle D A C=\angle D C A=\angle E A D=\angle E D A . \tag{1}
\end{equation*}


Let $M$ be the midpoint of $C F$. Point $X$ is chosen such that $A M X E$ is a parallelogram. Show that $B D, E M$ and $F X$ are concurrent.","Denote the common angle in (1) by $\theta$. As $\triangle A B F \sim \triangle A C D$, we have $\frac{A B}{A C}=\frac{A F}{A D}$ so that $\triangle A B C \sim \triangle A F D$. From $E A=E D$, we get

$$
\angle A F D=\angle A B C=90^{\circ}+\theta=180^{\circ}-\frac{1}{2} \angle A E D .
$$

Hence, $F$ lies on the circle with centre $E$ and radius $E A$. In particular, $E F=E A=E D$. As $\angle E F A=\angle E A F=2 \theta=\angle B F C$, points $B, F, E$ are collinear.

As $\angle E D A=\angle M A D$, we have $E D / / A M$ and hence $E, D, X$ are collinear. As $M$ is the midpoint of $C F$ and $\angle C B F=90^{\circ}$, we get $M F=M B$. In the isosceles triangles $E F A$ and $M F B$, we have $\angle E F A=\angle M F B$ and $A F=B F$. Therefore, they are congruent to each other. Then we have $B M=A E=X M$ and $B E=B F+F E=A F+F M=A M=E X$. This shows $\triangle E M B \cong \triangle E M X$. As $F$ and $D$ lie on $E B$ and $E X$ respectively and $E F=E D$, we know that lines $B D$ and $X F$ are symmetric with respect to $E M$. It follows that the three lines are concurrent.\\",2,"Let all notations be as in the original problem. Show that points $E, F, B$ are collinear, and that points $E, D, X$ are collinear.","Let the common angle in the similar isosceles triangles be $\theta$. The similarity $\triangle A B F \sim \triangle A C D$ implies $A B / A C=A F / A D$. Since $\angle B A C=\angle F A D=\theta$, we have $\triangle A B C \sim \triangle A F D$. Thus $\angle A F D = \angle A B C = \angle ABF + \angle FBC = \theta+90^{\circ}$. In $\triangle A D E$, $\angle A E D=180^{\circ}-2 \theta$, so $\angle A F D=180^{\circ}-\frac{1}{2} \angle A E D$. This geometric condition implies that $F$ lies on the circle with center $E$ and radius $E A=E D$. Hence $E F=E A$. This makes $\triangle EFA$ isosceles, with $\angle E F A = \angle E A F = \angle E A D+\angle D A C=2 \theta$. Since $A,F,C$ are collinear, $\angle B F C=180^{\circ}-\angle A F B = 180^{\circ}-(180^{\circ}-2 \theta)=2 \theta$. As $B$ and $E$ are on opposite sides of line $AC$, $\angle E F A=\angle B F C$ implies that $E, F, B$ are collinear. For the second collinearity, since $\angle E D A=\theta$ and $\angle D A C=\theta$, the alternate interior angles between lines $ED$, $AC$ with transversal $AD$ are equal, so $ED \parallel AC$. Since $M$ lies on line segment $CF$ and $F$ is on $AC$, $M$ is on line $AC$. Thus $ED \parallel AM$. As $A M X E$ is a parallelogram, $A M \parallel E X$. Therefore, $E D \parallel E X$, which implies $E, D, X$ are collinear.","Show that $B D, E M$ and $F X$ are concurrent.","In right-angled triangle $C B F$, $M$ is the midpoint of the hypotenuse $C F$, so $M B=M F$. From the given conditions, $\triangle ABF$ is isosceles with $AF=BF$. Consider isosceles triangles $\triangle EFA$ ($EF=EA$) and $\triangle MFB$ ($MF=MB$). We have $\angle EFA = 2\theta$ and $\angle MFB = \angle BFC = 2\theta$. The sides opposite the third angle in these triangles are $AF$ and $BF$, which are equal. Thus, by AAS congruence, $\triangle EFA \cong \triangle MFB$. This congruence implies $EA=MF$ and $EF=MB$. From the parallelogram $AMXE$, we have $AE=XM$ and $AM=EX$. Combining these equalities, we get $BM=MF=EA=XM$, so $BM=XM$. Furthermore, using the collinearity of $E,F,B$ and $A,F,M$, we have $BE = BF+FE = AF+MB = AF+MF = AM$. Since $AM=EX$, we get $BE=EX$. Now, in triangles $\triangle EMB$ and $\triangle EMX$, we have a common side $EM$, $MB=MX$, and $EB=EX$. By SSS congruence, $\triangle EMB \cong \triangle EMX$. This means $EM$ is the angle bisector of $\angle BEX$ and the perpendicular bisector of $BX$. Let $S$ be the reflection across line $EM$. Then $S(B)=X$. From the first sub-problem, $F$ is on line $EB$, $D$ is on line $EX$, and $EF=ED$. This means $S(F)=D$. Consequently, the reflection of the line $BD$ is the line $XF$. Since these two lines are reflections of each other, they must intersect on the line of symmetry, $EM$. Thus, the three lines $BD, EM, FX$ are concurrent.",,,,
2016g2,Let $A B C$ be a triangle with circumcircle $\Gamma$ and incentre $I$. Let $M$ be the midpoint of side $B C$. Denote by $D$ the foot of perpendicular from $I$ to side $B C$. The line through $I$ perpendicular to $A I$ meets sides $A B$ and $A C$ at $F$ and $E$ respectively. Suppose the circumcircle of triangle $A E F$ intersects $\Gamma$ at a point $X$ other than $A$. Prove that lines $X D$ and $A M$ meet on $\Gamma$.,"Let $A M$ meet $\Gamma$ again at $Y$ and $X Y$ meet $B C$ at $D^{\prime}$. It suffices to show $D^{\prime}=D$. We shall apply the following fact.

\begin{itemize}
  \item Claim. For any cyclic quadrilateral $P Q R S$ whose diagonals meet at $T$, we have
\end{itemize}

$$
\frac{Q T}{T S}=\frac{P Q \cdot Q R}{P S \cdot S R}
$$

Proof. We use $\left[W_{1} W_{2} W_{3}\right]$ to denote the area of $W_{1} W_{2} W_{3}$. Then

$$
\frac{Q T}{T S}=\frac{[P Q R]}{[P S R]}=\frac{\frac{1}{2} P Q \cdot Q R \sin \angle P Q R}{\frac{1}{2} P S \cdot S R \sin \angle P S R}=\frac{P Q \cdot Q R}{P S \cdot S R}
$$

Applying the Claim to $A B Y C$ and $X B Y C$ respectively, we have $1=\frac{B M}{M C}=\frac{A B \cdot B Y}{A C \cdot C Y}$ and $\frac{B D^{\prime}}{D^{\prime} C}=\frac{X B \cdot B Y}{X C \cdot C Y}$. These combine to give


\begin{equation*}
\frac{B D^{\prime}}{C D^{\prime}}=\frac{X B}{X C} \cdot \frac{B Y}{C Y}=\frac{X B}{X C} \cdot \frac{A C}{A B} \tag{1}
\end{equation*}


Next, we use directed angles to find that $\measuredangle X B F=\measuredangle X B A=\measuredangle X C A=\measuredangle X C E$ and $\measuredangle X F B=\measuredangle X F A=\measuredangle X E A=\measuredangle X E C$. This shows triangles $X B F$ and $X C E$ are directly similar. In particular, we have


\begin{equation*}
\frac{X B}{X C}=\frac{B F}{C E} \tag{2}
\end{equation*}


In the following, we give two ways to continue the proof.

Here is a geometrical method. As $\angle F I B=\angle A I B-90^{\circ}=\frac{1}{2} \angle A C B=\angle I C B$ and $\angle F B I=\angle I B C$, the triangles $F B I$ and $I B C$ are similar. Analogously, triangles $E I C$ and $I B C$ are also similar. Hence, we get

\begin{equation*}
\frac{F B}{I B}=\frac{B I}{B C} \quad \text { and } \quad \frac{E C}{I C}=\frac{I C}{B C} \tag{3}
\end{equation*}

Next, construct a line parallel to $B C$ and tangent to the incircle. Suppose it meets sides $A B$ and $A C$ at $B_{1}$ and $C_{1}$ respectively. Let the incircle touch $A B$ and $A C$ at $B_{2}$ and $C_{2}$ respectively. By homothety, the line $B_{1} I$ is parallel to the external angle bisector of $\angle A B C$, and hence $\angle B_{1} I B=90^{\circ}$. Since $\angle B B_{2} I=90^{\circ}$, we get $B B_{2} \cdot B B_{1}=B I^{2}$, and similarly $C C_{2} \cdot C C_{1}=C I^{2}$. Hence,


\begin{equation*}
\frac{B I^{2}}{C I^{2}}=\frac{B B_{2} \cdot B B_{1}}{C C_{2} \cdot C C_{1}}=\frac{B B_{1}}{C C_{1}} \cdot \frac{B D}{C D}=\frac{A B}{A C} \cdot \frac{B D}{C D} . \tag{4}
\end{equation*}

Combining (1), (2), (3) and (4), we conclude

$$
\frac{B D^{\prime}}{C D^{\prime}}=\frac{X B}{X C} \cdot \frac{A C}{A B}=\frac{B F}{C E} \cdot \frac{A C}{A B}=\frac{B I^{2}}{C I^{2}} \cdot \frac{A C}{A B}=\frac{B D}{C D}
$$

so that $D^{\prime}=D$. The result then follows.",3,"Let $Y$ be the point where the median $AM$ meets the circumcircle $\Gamma$ again, and let the line $XY$ intersect $BC$ at $D'$. Show that $\frac{B D^{\\prime}}{C D^{\\prime}}=\frac{X B}{X C} \\cdot \frac{A C}{A B}$.","Let $Y$ be the intersection of $AM$ and $\\Gamma$. In the cyclic quadrilateral $ABYC$, the diagonals $AY$ and $BC$ intersect at $M$. The ratio of segments of diagonals in a cyclic quadrilateral can be related by areas: $\frac{BM}{MC} = \frac{[ABY]}{[ACY]} = \frac{AB \\cdot BY}{AC \\cdot CY}$. Since $M$ is the midpoint of $BC$, $\frac{BM}{MC}=1$, which implies $\frac{BY}{CY} = \frac{AC}{AB}$. Let $D'$ be the intersection of $XY$ and $BC$. By the Sine Rule in $\triangle XBD'$ and $\triangle XCD'$, $\frac{BD'}{CD'} = \frac{XB}{XC} \frac{\\sin \\angle BXD'}{\\sin \\angle CXD'}$. Since $X,B,Y,C$ are concyclic, $\\angle BXD'=\\angle BXY=\\angle BCY$ and $\\angle CXD'=\\angle CXY=\\angle CBY$. By the Sine Rule in $\triangle BCY$, $\frac{\\sin\\angle BCY}{\\sin\\angle CBY} = \frac{BY}{CY}$. Combining these, $\frac{BD'}{CD'} = \frac{XB}{XC}\frac{BY}{CY} = \frac{XB}{XC}\frac{AC}{AB}$.","Let the line through the incenter $I$ perpendicular to $AI$ meet sides $AB$ and $AC$ at $F$ and $E$ respectively. Let $X$ be the intersection of the circumcircle of $\triangle AEF$ and the circumcircle of $\triangle ABC$, other than $A$. Show that $\frac{X B}{X C} = \frac{B I^2}{C I^2}$.","As points $X,A,E,F$ are concyclic and $X,A,B,C$ are concyclic, angle chasing shows $\\angle XBF = \\angle XBA = \\angle XCA = \\angle XCE$ and $\\angle XFB = \\angle XFA = \\angle XEA = \\angle XEC$. Thus, $\triangle XBF$ and $\triangle XCE$ are similar, which gives the ratio $\frac{XB}{XC} = \frac{BF}{CE}$. The line $FE$ is perpendicular to the angle bisector $AI$. This gives $\\angle FIB = \\angle AIB - 90^\\circ = (180^\\circ - \frac{A+B}{2}) - 90^\\circ = \frac{C}{2} = \\angle ICB$. Since $\\angle FBI = \\angle IBC$, we have $\triangle FBI \\sim \triangle ICB$. Similarly, $\triangle EIC \\sim \triangle IBC$. From these similarities, $FB = BI^2/BC$ and $EC = IC^2/BC$. Therefore, $\frac{BF}{CE} = \frac{BI^2}{CI^2}$, and we conclude $\frac{XB}{XC} = \frac{BI^2}{CI^2}$.",Let $A B C$ be a triangle with circumcircle $\\Gamma$ and incentre $I$. Let $M$ be the midpoint of side $B C$. Denote by $D$ the foot of perpendicular from $I$ to side $B C$. The line through $I$ perpendicular to $A I$ meets sides $A B$ and $A C$ at $F$ and $E$ respectively. Suppose the circumcircle of triangle $A E F$ intersects $\\Gamma$ at a point $X$ other than $A$. Prove that lines $X D$ and $A M$ meet on $\\Gamma$.,"Let $AM$ meet $\\Gamma$ again at $Y$. We need to show that $X, D, Y$ are collinear. Let the line $XY$ meet $BC$ at $D'$; we will show $D'=D$. From Sub-problem 1, $\frac{B D^{\\prime}}{C D^{\\prime}}=\frac{X B}{X C} \\cdot \frac{A C}{A B}$. From Sub-problem 2, $\frac{X B}{X C} = \frac{B I^2}{C I^2}$. Thus, $\frac{B D^{\\prime}}{C D^{\\prime}}=\frac{B I^2}{C I^2} \\cdot \frac{A C}{A B}$. Since $D$ is the foot of the perpendicular from the incenter $I$ to $BC$, it is the tangency point of the incircle with side $BC$. A standard identity relates $BI, CI$ to the sides and segments $BD, CD$: $\frac{BI^2}{CI^2} = \frac{AB}{AC}\frac{BD}{CD}$. This can be shown using the Law of Sines on $\triangle AIB, \triangle AIC$ and half-angle formulas. Substituting this identity into our expression for $\frac{B D^{\\prime}}{C D^{\\prime}}$, we get $\frac{B D^{\\prime}}{C D^{\\prime}} = \\left(\frac{AB}{AC}\frac{BD}{CD}\right) \frac{AC}{AB} = \frac{BD}{CD}$. Since both $D$ and $D'$ lie on the segment $BC$, this implies $D'=D$. Thus, $X, D, Y$ are collinear, meaning lines $XD$ and $AM$ meet at $Y$ on $\\Gamma$.",,
2016g3,"Let $B=(-1,0)$ and $C=(1,0)$ be fixed points on the coordinate plane. A nonempty, bounded subset $S$ of the plane is said to be nice if\\
(i) there is a point $T$ in $S$ such that for every point $Q$ in $S$, the segment $T Q$ lies entirely in $S$; and\\
(ii) for any triangle $P_{1} P_{2} P_{3}$, there exists a unique point $A$ in $S$ and a permutation $\sigma$ of the indices $\{1,2,3\}$ for which triangles $A B C$ and $P_{\sigma(1)} P_{\sigma(2)} P_{\sigma(3)}$ are similar.

Prove that there exist two distinct nice subsets $S$ and $S^{\prime}$ of the set $\{(x, y): x \geqslant 0, y \geqslant 0\}$ such that if $A \in S$ and $A^{\prime} \in S^{\prime}$ are the unique choices of points in (ii), then the product $B A \cdot B A^{\prime}$ is a constant independent of the triangle $P_{1} P_{2} P_{3}$.","Solution. If in the similarity of $\triangle A B C$ and $\triangle P_{\sigma(1)} P_{\sigma(2)} P_{\sigma(3)}, B C$ corresponds to the longest side of $\triangle P_{1} P_{2} P_{3}$, then we have $B C \geqslant A B \geqslant A C$. The condition $B C \geqslant A B$ is equivalent to $(x+1)^{2}+y^{2} \leqslant 4$, while $A B \geqslant A C$ is trivially satisfied for any point in the first quadrant. Then we first define

$$
S=\left\{(x, y):(x+1)^{2}+y^{2} \leqslant 4, x \geqslant 0, y \geqslant 0\right\}
$$

Note that $S$ is the intersection of a disk and the first quadrant, so it is bounded and convex, and we can choose any $T \in S$ to meet condition (i). For any point $A$ in $S$, the relation $B C \geqslant A B \geqslant A C$ always holds. Therefore, the point $A$ in (ii) is uniquely determined, while its existence is guaranteed by the above construction.\\
\includegraphics[max width=\textwidth, center]{2025_04_30_7daf08b5ed3ffd852861g-54}

Next, if in the similarity of $\triangle A^{\prime} B C$ and $\triangle P_{\sigma(1)} P_{\sigma(2)} P_{\sigma(3)}, B C$ corresponds to the second longest side of $\triangle P_{1} P_{2} P_{3}$, then we have $A^{\prime} B \geqslant B C \geqslant A^{\prime} C$. The two inequalities are equivalent to $(x+1)^{2}+y^{2} \geqslant 4$ and $(x-1)^{2}+y^{2} \leqslant 4$ respectively. Then we define

$$
S^{\prime}=\left\{(x, y):(x+1)^{2}+y^{2} \geqslant 4,(x-1)^{2}+y^{2} \leqslant 4, x \geqslant 0, y \geqslant 0\right\} .
$$

The boundedness condition is satisfied while (ii) can be argued as in the previous case. For (i), note that $S^{\prime \prime}$ contains points inside the disk $(x-1)^{2}+y^{2} \leqslant 4$ and outside the disk $(x+1)^{2}+y^{2} \geqslant 4$. This shows we can take $T^{\prime}=(1,2)$ in (i), which is the topmost point of the circle $(x-1)^{2}+y^{2}=4$.

It remains to check that the product $B A \cdot B A^{\prime}$ is a constant. Suppose we are given a triangle $P_{1} P_{2} P_{3}$ with $P_{1} P_{2} \geqslant P_{2} P_{3} \geqslant P_{3} P_{1}$. By the similarity, we have

$$
B A=B C \cdot \frac{P_{2} P_{3}}{P_{1} P_{2}} \quad \text { and } \quad B A^{\prime}=B C \cdot \frac{P_{1} P_{2}}{P_{2} P_{3}} .
$$

Thus $B A \cdot B A^{\prime}=B C^{2}=4$, which is certainly independent of the triangle $P_{1} P_{2} P_{3}$.\\
Comment. The original version of this problem includes the condition that the interiors of $S$ and $S^{\prime}$ are disjoint. We remove this condition since it is hard to define the interior of a point set rigorously.",3,"Define the set $S = \{(x, y) : (x+1)^2+y^2 \le 4, x \ge 0, y \ge 0\}$. Prove that $S$ is a nice subset of the plane.","The set $S$ is defined such that for any point $A(x,y) \in S$, the sides of triangle $ABC$ satisfy $BC \ge AB \ge AC$. The set $S$ is the intersection of a closed disk and the first quadrant, so it is bounded and convex, which satisfies condition (i). For condition (ii), given any triangle $P_1P_2P_3$ with side lengths $p_1 \ge p_2 \ge p_3$, the requirement of similarity where $BC$ corresponds to the longest side $p_1$ uniquely determines the side lengths $AB = BC \cdot (p_2/p_1)$ and $AC = BC \cdot (p_3/p_1)$. This uniquely determines the point $A$ in the first quadrant. Since $p_1 \ge p_2$, we have $BC \ge AB$, which means $A$ lies in $S$. Thus, existence and uniqueness of $A$ in $S$ are guaranteed, and $S$ is nice.","Define the set $S' = \{(x, y) : (x+1)^2+y^2 \ge 4, (x-1)^2+y^2 \le 4, x \ge 0, y \ge 0\}$. Prove that $S'$ is a nice subset of the plane.","The set $S'$ is defined such that for any point $A'(x,y) \in S'$, the sides of triangle $A'BC$ satisfy $A'B \ge BC \ge A'C$. The set $S'$ is bounded as it lies within the disk $(x-1)^2+y^2 \le 4$. It is star-shaped with respect to $T=(1,2) \in S'$, satisfying condition (i). For condition (ii), given any triangle $P_1P_2P_3$ with side lengths $p_1 \ge p_2 \ge p_3$, the requirement of similarity where $BC$ corresponds to the second-longest side $p_2$ uniquely determines the side lengths $A'B = BC \cdot (p_1/p_2)$ and $A'C = BC \cdot (p_3/p_2)$. This uniquely determines the point $A'$ in the first quadrant. Since $p_1 \ge p_2 \ge p_3$, we have $A'B \ge BC \ge A'C$, which means $A'$ lies in $S'$. Thus, $S'$ is nice.","Let $S$ and $S'$ be the two distinct nice subsets defined previously. Show that if $A \in S$ and $A' \in S'$ are the unique choices of points corresponding to a triangle $P_{1} P_{2} P_{3}$, then the product $BA \cdot BA'$ is a constant independent of the triangle $P_{1} P_{2} P_{3}$.","Let a given triangle have side lengths ordered as $p_1 \ge p_2 \ge p_3$. For the point $A \in S$, the similarity $\triangle ABC \sim \triangle P_{\sigma(1)}P_{\sigma(2)}P_{\sigma(3)}$ is such that $BC$ corresponds to the longest side $p_1$, and $AB$ corresponds to the second-longest side $p_2$. From the ratio of corresponding sides, we have $\frac{BA}{BC} = \frac{p_2}{p_1}$. For the point $A' \in S'$, the similarity is such that $BC$ corresponds to the second-longest side $p_2$, and $A'B$ corresponds to the longest side $p_1$. This gives $\frac{BA'}{BC} = \frac{p_1}{p_2}$. The product of the lengths is $BA \cdot BA' = \left(BC \cdot \frac{p_2}{p_1}\right) \cdot \left(BC \cdot \frac{p_1}{p_2}\right) = BC^2$. Since $B=(-1,0)$ and $C=(1,0)$, the distance $BC = 2$. Therefore, $BA \cdot BA' = 2^2 = 4$, which is a constant independent of the triangle.",,
2016g4,"Let $A B C$ be a triangle with $A B=A C \neq B C$ and let $I$ be its incentre. The line $B I$ meets $A C$ at $D$, and the line through $D$ perpendicular to $A C$ meets $A I$ at $E$. Prove that the reflection of $I$ in $A C$ lies on the circumcircle of triangle $B D E$.","Let $\Gamma$ be the circle with centre $E$ passing through $B$ and $C$. Since $E D \perp A C$, the point $F$ symmetric to $C$ with respect to $D$ lies on $\Gamma$. From $\angle D C I=\angle I C B=\angle C B I$, the line $D C$ is a tangent to the circumcircle of triangle $I B C$. Let $J$ be the symmetric point of $I$ with respect to $D$. Using directed lengths, from

$$
D C \cdot D F=-D C^{2}=-D I \cdot D B=D J \cdot D B
$$

the point $J$ also lies on $\Gamma$. Let $I^{\prime}$ be the reflection of $I$ in $A C$. Since $I J$ and $C F$ bisect each other, $C J F I$ is a parallelogram. From $\angle F I^{\prime} C=\angle C I F=\angle F J C$, we find that $I^{\prime}$ lies on $\Gamma$. This gives $E I^{\prime}=E B$.

Note that $A C$ is the internal angle bisector of $\angle B D I^{\prime}$. This shows $D E$ is the external angle bisector of $\angle B D I^{\prime}$ as $D E \perp A C$. Together with $E I^{\prime}=E B$, it is well-known that $E$ lies on the circumcircle of triangle $B D I^{\prime}$.",2,Let $E$ be the intersection of the line through $D$ perpendicular to $A C$ and the line $A I$. Let $I'$ be the reflection of $I$ in $A C$. Prove that $E B=E I'$.,"Since $E$ lies on $AI$, the angle bisector of $\angle BAC$ in an isosceles triangle $ABC$ with $AB=AC$, $E$ lies on the perpendicular bisector of $BC$, so $EB=EC$. Let $\Gamma$ be the circle centered at $E$ passing through $B$ and $C$. Since $ED \perp AC$, the reflection of $C$ in $D$, let's call it $F$, also lies on $\Gamma$ because $ED$ is the perpendicular bisector of $CF$, so $EC=EF$. The line $AC$ is tangent to the circumcircle of $\triangle IBC$ at $C$, which gives the power of a point relation $DC^2 = DI \cdot DB$. Let $J$ be the reflection of $I$ in $D$. This power relation implies that $B, C, J, F$ are concyclic. Since $B, C, F$ are on $\Gamma$, $J$ must also lie on $\Gamma$. $ICJF$ is a parallelogram as its diagonals bisect each other at $D$. Thus, $\angle FI'C = \angle FIC = \angle FJC$. This implies $I'$ lies on the circumcircle of $\triangle FJC$, which is $\Gamma$. Therefore, $EI' = EB$.",Prove that the reflection of $I$ in $A C$ lies on the circumcircle of triangle $B D E$.,"From the first sub-problem, we have $EB = EI'$. The line $AC$ is the internal angle bisector of $\angle BDI'$, because $I'$ is the reflection of $I$ across $AC$ and $B, I, D$ are collinear, which implies $\angle BDC = \angle IDC = \angle I'DC$. Since $DE \perp AC$, $DE$ is the external angle bisector of $\angle BDI'$. A point $E$ on the external angle bisector of $\angle D$ of $\triangle BDI'$ lies on the circumcircle of $\triangle BDI'$ if and only if it is equidistant from the other two vertices, $B$ and $I'$. As we have established $EB=EI'$, it follows that $E$ lies on the circumcircle of $\triangle BDI'$. Therefore, the points $B, D, E, I'$ are concyclic, which means $I'$ lies on the circumcircle of $\triangle BDE$.",,,,
2016g5,"Let $D$ be the foot of perpendicular from $A$ to the Euler line (the line passing through the circumcentre and the orthocentre) of an acute scalene triangle $A B C$. A circle $\omega$ with centre $S$ passes through $A$ and $D$, and it intersects sides $A B$ and $A C$ at $X$ and $Y$ respectively. Let $P$ be the foot of altitude from $A$ to $B C$, and let $M$ be the midpoint of $B C$. Prove that the circumcentre of triangle $X S Y$ is equidistant from $P$ and $M$.","Denote the orthocentre and circumcentre of triangle $A B C$ by $H$ and $O$ respectively. Let $Q$ be the midpoint of $A H$ and $N$ be the nine-point centre of triangle $A B C$. It is known that $Q$ lies on the nine-point circle of triangle $A B C, N$ is the midpoint of $Q M$ and that $Q M$ is parallel to $A O$.

Let the perpendicular from $S$ to $X Y$ meet line $Q M$ at $S^{\prime}$. Let $E$ be the foot of altitude from $B$ to side $A C$. Since $Q$ and $S$ lie on the perpendicular bisector of $A D$, using directed angles, we have

$$
\begin{aligned}
\measuredangle S D Q & =\measuredangle Q A S=\measuredangle X A S-\measuredangle X A Q=\left(\frac{\pi}{2}-\measuredangle A Y X\right)-\measuredangle B A P=\measuredangle C B A-\measuredangle A Y X \\
& =(\measuredangle C B A-\measuredangle A C B)-\measuredangle B C A-\measuredangle A Y X=\measuredangle P E M-(\measuredangle B C A+\measuredangle A Y X) \\
& =\measuredangle P Q M-\angle(B C, X Y)=\frac{\pi}{2}-\angle\left(S^{\prime} Q, B C\right)-\angle(B C, X Y)=\measuredangle S S^{\prime} Q
\end{aligned}
$$

This shows $D, S^{\prime}, S, Q$ are concyclic.\\
\includegraphics[max width=\textwidth, center]{2025_04_30_7daf08b5ed3ffd852861g-61}

Let the perpendicular from $N$ to $B C$ intersect line $S S^{\prime}$ at $O_{1}$. (Note that the two lines coincide when $S$ is the midpoint of $A O$, in which case the result is true since the circumcentre of triangle $X S Y$ must lie on this line.) It suffices to show that $O_{1}$ is the circumcentre of triangle $X S Y$ since $N$ lies on the perpendicular bisector of $P M$. From

$$
\measuredangle D S^{\prime} O_{1}=\measuredangle D Q S=\measuredangle S Q A=\angle(S Q, Q A)=\angle\left(O D, O_{1} N\right)=\measuredangle D N O_{1}
$$

since $S Q / / O D$ and $Q A / / O_{1} N$, we know that $D, O_{1}, S^{\prime}, N$ are concyclic. Therefore, we get

$$
\measuredangle S D S^{\prime}=\measuredangle S Q S^{\prime}=\angle\left(S Q, Q S^{\prime}\right)=\angle\left(N D, N S^{\prime}\right)=\measuredangle D N S^{\prime}
$$

so that $S D$ is a tangent to the circle through $D, O_{1}, S^{\prime}, N$. Then we have


\begin{equation*}
S S^{\prime} \cdot S O_{1}=S D^{2}=S X^{2} \tag{1}
\end{equation*}


Next, we show that $S$ and $S^{\prime \prime}$ are symmetric with respect to $X Y$. By the Sine Law, we have

$$
\frac{S S^{\prime}}{\sin \angle S Q S^{\prime}}=\frac{S Q}{\sin \angle S S^{\prime} Q}=\frac{S Q}{\sin \angle S D Q}=\frac{S Q}{\sin \angle S A Q}=\frac{S A}{\sin \angle S Q A}
$$

It follows that

$$
S S^{\prime}=S A \cdot \frac{\sin \angle S Q S^{\prime}}{\sin \angle S Q A}=S A \cdot \frac{\sin \angle H O A}{\sin \angle O H A}=S A \cdot \frac{A H}{A O}=S A \cdot 2 \cos A
$$

which is twice the distance from $S$ to $X Y$. Note that $S$ and $C$ lie on the same side of the perpendicular bisector of $P M$ if and only if $\angle S A C<\angle O A C$ if and only if $\angle Y X A>\angle C B A$. This shows $S$ and $O_{1}$ lie on different sides of $X Y$. As $S^{\prime}$ lies on ray $S O_{1}$, it follows that $S$ and $S^{\prime}$ cannot lie on the same side of $X Y$. Therefore, $S$ and $S^{\prime}$ are symmetric with respect to $X Y$.

Let $d$ be the diameter of the circumcircle of triangle $X S Y$. As $S S^{\prime}$ is twice the distance from $S$ to $X Y$ and $S X=S Y$, we have $S S^{\prime}=2 \frac{S X^{2}}{d}$. It follows from (1) that $d=2 S O_{1}$. As $S O_{1}$ is the perpendicular bisector of $X Y$, point $O_{1}$ is the circumcentre of triangle $X S Y$.",4,"Let $H$ and $O$ be the orthocentre and circumcentre of $\triangle ABC$. Let $Q$ be the midpoint of $AH$, $N$ be the nine-point center, and $M$ be the midpoint of $BC$. Let the perpendicular from $S$ to $XY$ intersect the line $QM$ at $S'$. Let the perpendicular from $N$ to $BC$ intersect the line $SS'$ at $O_1$. Prove that $S S' \cdot S O_1 = S D^2$.","By showing $\measuredangle S D Q = \measuredangle S S' Q$ through angle chasing, we establish that $D, S', S, Q$ are concyclic. Similarly, by showing $\measuredangle D S' O_1 = \measuredangle D N O_1$, we establish that $D, O_1, S', N$ are concyclic. From these concyclicities, we deduce that $SD$ is tangent to the circle passing through $D, O_1, S', N$. The power of point $S$ with respect to this circle gives the desired result: $S S' \cdot S O_1 = S D^2$.","Using the definitions from the previous sub-problem, prove that $S'$ is the reflection of $S$ across the line $XY$.","The line $SS'$ is perpendicular to $XY$ by construction of $S'$. We can calculate the length of $SS'$ using the Law of Sines and known properties of the Euler line configuration, yielding $SS' = 2SA \cos A$. This length is exactly twice the distance from $S$ (the center of circle $\omega$) to its chord $XY$. Since it can be shown that $S$ and $S'$ lie on opposite sides of line $XY$, $S'$ must be the reflection of $S$.",Prove that the point $O_1$ is the circumcenter of triangle $XSY$.,"From sub-problem 1 and the fact that $SD=SX$ (as radii of $\omega$), we have $SS' \cdot SO_1 = SX^2$. From sub-problem 2, $S'$ is the reflection of $S$ in the line $XY$. For a triangle with a vertex reflected over the opposite side, the circumdiameter $d$ is given by $d = 2 \frac{SX^2}{SS'}$. Combining these two relations gives $d = 2SO_1$. The circumcenter of $\triangle XSY$ lies on the perpendicular bisector of $XY$, which is the line $SS'O_1$. Since its distance to vertex $S$ is $SO_1$ (the radius), this center must be $O_1$ itself.","Let $P$ be the foot of altitude from $A$ to $B C$, and let $M$ be the midpoint of $B C$. Prove that the circumcentre of triangle $X S Y$ is equidistant from $P$ and $M$.","From sub-problem 3, the circumcenter of $\triangle XSY$ is $O_1$. By its construction, $O_1$ lies on the line that passes through the nine-point center $N$ and is perpendicular to $BC$. The points $P$ and $M$ both lie on the nine-point circle, which is centered at $N$. Therefore, $N$ is equidistant from $P$ and $M$ ($NP=NM$) and must lie on the perpendicular bisector of the segment $PM$. Since the line segment $PM$ is on line $BC$, its perpendicular bisector is the line perpendicular to $BC$ that passes through $N$. This is precisely the line on which $O_1$ lies. Therefore, $O_1$ is equidistant from $P$ and $M$."
2016g6,"Let $A B C D$ be a convex quadrilateral with $\angle A B C=\angle A D C<90^{\circ}$. The internal angle bisectors of $\angle A B C$ and $\angle A D C$ meet $A C$ at $E$ and $F$ respectively, and meet each other at point $P$. Let $M$ be the midpoint of $A C$ and let $\omega$ be the circumcircle of triangle $B P D$. Segments $B M$ and $D M$ intersect $\omega$ again at $X$ and $Y$ respectively. Denote by $Q$ the intersection point of lines $X E$ and $Y F$. Prove that $P Q \perp A C$.","Let $\omega_{1}$ be the circumcircle of triangle $A B C$. We first prove that $Y$ lies on $\omega_{1}$. Let $Y^{\prime}$ be the point on ray $M D$ such that $M Y^{\prime} \cdot M D=M A^{2}$. Then triangles $M A Y^{\prime}$ and $M D A$ are oppositely similar. Since $M C^{2}=M A^{2}=M Y^{\prime} \cdot M D$, triangles $M C Y^{\prime}$ and $M D C$ are also oppositely similar. Therefore, using directed angles, we have

$$
\measuredangle A Y^{\prime} C=\measuredangle A Y^{\prime} M+\measuredangle M Y^{\prime} C=\measuredangle M A D+\measuredangle D C M=\measuredangle C D A=\measuredangle A B C
$$

so that $Y^{\prime}$ lies on $\omega_{1}$.\\
Let $Z$ be the intersection point of lines $B C$ and $A D$. Since $\measuredangle P D Z=\measuredangle P B C=\measuredangle P B Z$, point $Z$ lies on $\omega$. In addition, from $\measuredangle Y^{\prime} B Z=\measuredangle Y^{\prime} B C=\measuredangle Y^{\prime} A C=\measuredangle Y^{\prime} A M=\measuredangle Y^{\prime} D Z$, we also know that $Y^{\prime}$ lies on $\omega$. Note that $\angle A D C$ is acute implies $M A \neq M D$ so $M Y^{\prime} \neq M D$. Therefore, $Y^{\prime}$ is the second intersection of $D M$ and $\omega$. Then $Y^{\prime}=Y$ and hence $Y$ lies on $\omega_{1}$.

Next, by the Angle Bisector Theorem and the similar triangles, we have

$$
\frac{F A}{F C}=\frac{A D}{C D}=\frac{A D}{A M} \cdot \frac{C M}{C D}=\frac{Y A}{Y M} \cdot \frac{Y M}{Y C}=\frac{Y A}{Y C} .
$$

Hence, $F Y$ is the internal angle bisector of $\angle A Y C$.\\
Let $B^{\prime}$ be the second intersection of the internal angle bisector of $\angle C B A$ and $\omega_{1}$. Then $B^{\prime}$ is the midpoint of arc $A C$ not containing $B$. Therefore, $Y B^{\prime}$ is the external angle bisector of $\angle A Y C$, so that $B^{\prime} Y \perp F Y$.

Denote by $l$ the line through $P$ parallel to $A C$. Suppose $l$ meets line $B^{\prime} Y$ at $S$. From

$$
\begin{aligned}
\measuredangle P S Y & =\measuredangle\left(A C, B^{\prime} Y\right)=\measuredangle A C Y+\measuredangle C Y B^{\prime}=\measuredangle A C Y+\measuredangle C A B^{\prime}=\measuredangle A C Y+\measuredangle B^{\prime} C A \\
& =\measuredangle B^{\prime} C Y=\measuredangle B^{\prime} B Y=\measuredangle P B Y,
\end{aligned}
$$

the point $S$ lies on $\omega$. Similarly, the line through $X$ perpendicular to $X E$ also passes through the second intersection of $l$ and $\omega$, which is the point $S$. From $Q Y \perp Y S$ and $Q X \perp X S$, point $Q$ lies on $\omega$ and $Q S$ is a diameter of $\omega$. Therefore, $P Q \perp P S$ so that $P Q \perp A C$.",3,"Let $\omega_1$ be the circumcircle of $\triangle ABC$ and let $M$ be the midpoint of $AC$. Let $Y$ be the second intersection of line $DM$ with $\omega$, the circumcircle of $\triangle BPD$. Prove that $Y$ lies on $\omega_1$.","Define a point $Y'$ on ray $MD$ such that $MY' \cdot MD = MA^2$. Since $M$ is the midpoint of $AC$, $MA=MC$, so $MY' \cdot MD = MC^2$. This implies that $\triangle MAY' \sim \triangle MDA$ and $\triangle MCY' \sim \triangle MDC$ (oppositely similar). Using directed angles, $\measuredangle AY'C = \measuredangle AY'M + \measuredangle MY'C = \measuredangle MAD + \measuredangle DCM = \measuredangle CDA$. Given $\angle ADC = \angle ABC$, we have $\angle AY'C = \angle ABC$, which means $Y'$ lies on $\omega_1$. Let $Z = BC \cap AD$. Since $\angle PBZ = \angle ABC/2 = \angle ADC/2 = \angle PDZ$, quadrilateral $BPZD$ is cyclic, so $Z$ is on $\omega$. Also, $\measuredangle Y'BZ = \measuredangle Y'BC = \measuredangle Y'AC = \measuredangle Y'AM = \measuredangle Y'DA = \measuredangle Y'DZ$. This implies $Y'$ is also on $\omega$. As $Y'$ lies on line $MD$ and is distinct from $D$ (since $\angle ADC < 90^\circ$), $Y'$ must be the second intersection of line $MD$ with $\omega$. Thus, $Y' = Y$ and $Y$ lies on $\omega_1$.","Using the fact that $Y$ lies on the circumcircle of $\triangle ABC$, prove that $FY$ is the internal angle bisector of $\angle AYC$.","By the Angle Bisector Theorem in $\triangle ADC$, we have $FA/FC = AD/CD$. From the previous sub-problem, the similarity relations $\triangle MAY \sim \triangle MDA$ and $\triangle MCY \sim \triangle MDC$ hold. These give $AD/AM = AY/MY$ and $CD/CM = CY/MY$. Since $M$ is the midpoint of $AC$, $AM=CM$. Dividing the two similarity ratios gives $AD/CD = AY/CY$. Therefore, $FA/FC = AY/CY$. By the converse of the Angle Bisector Theorem in $\triangle AYC$, this implies that $FY$ is the internal angle bisector of $\angle AYC$.","Let $A B C D$ be a convex quadrilateral with $\angle A B C=\angle A D C<90^{\circ}$. The internal angle bisectors of $\angle A B C$ and $\angle A D C$ meet $A C$ at $E$ and $F$ respectively, and meet each other at point $P$. Let $M$ be the midpoint of $A C$ and let $\omega$ be the circumcircle of triangle $B P D$. Segments $B M$ and $D M$ intersect $\omega$ again at $X$ and $Y$ respectively. Denote by $Q$ the intersection point of lines $X E$ and $Y F$. Prove that $P Q \perp A C$.","Let $\omega_1$ be the circumcircle of $\triangle ABC$. Let $B'$ be the second intersection of the angle bisector $BE$ with $\omega_1$. $B'$ is the midpoint of arc $AC$. For any point $Y$ on $\omega_1$, $YB'$ is the external angle bisector of $\angle AYC$. Since $FY$ is the internal angle bisector of $\angle AYC$ (from Sub-problem 2), we have $FY \perp YB'$. Let $l$ be the line through $P$ parallel to $AC$, and let $S$ be the intersection of $l$ with line $YB'$. An angle chase shows $\measuredangle PSY = \measuredangle PBY$, which implies $S$ lies on $\omega$. By symmetry between the $(B, E)$ and $(D, F)$ setups, the line through $X$ perpendicular to $XE$ also passes through $S$. Thus, we have $YS \perp YF$ (i.e. $YQ$) and $XS \perp XE$ (i.e. $XQ$). These conditions, $\angle SYQ=90^{\circ}$ and $\angle SXQ=90^{\circ}$, imply that $Q$ lies on $\omega$ and $QS$ is a diameter. Since $P$ also lies on $\omega$, we have $\angle QPS = 90^{\circ}$, so $PQ \perp PS$. As $PS$ was constructed parallel to $AC$, we conclude $PQ \perp AC$.",,
2016g7,"Let $I$ be the incentre of a non-equilateral triangle $A B C, I_{A}$ be the $A$-excentre, $I_{A}^{\prime}$ be the reflection of $I_{A}$ in $B C$, and $l_{A}$ be the reflection of line $A I_{A}^{\prime}$ in $A I$. Define points $I_{B}, I_{B}^{\prime}$ and line $l_{B}$ analogously. Let $P$ be the intersection point of $l_{A}$ and $l_{B}$.\\
(a) Prove that $P$ lies on line $O I$ where $O$ is the circumcentre of triangle $A B C$.\\
(b) Let one of the tangents from $P$ to the incircle of triangle $A B C$ meet the circumcircle at points $X$ and $Y$. Show that $\angle X I Y=120^{\circ}$.","(a) Let $A^{\prime}$ be the reflection of $A$ in $B C$ and let $M$ be the second intersection of line $A I$ and the circumcircle $\Gamma$ of triangle $A B C$. As triangles $A B A^{\prime}$ and $A O C$ are isosceles with $\angle A B A^{\prime}=2 \angle A B C=\angle A O C$, they are similar to each other. Also, triangles $A B I_{A}$ and $A I C$ are similar. Therefore we have

$$
\frac{A A^{\prime}}{A I_{A}}=\frac{A A^{\prime}}{A B} \cdot \frac{A B}{A I_{A}}=\frac{A C}{A O} \cdot \frac{A I}{A C}=\frac{A I}{A O}
$$

Together with $\angle A^{\prime} A I_{A}=\angle I A O$, we find that triangles $A A^{\prime} I_{A}$ and $A I O$ are similar.\\
\includegraphics[max width=\textwidth, center]{2025_04_30_7daf08b5ed3ffd852861g-69}

Denote by $P^{\prime}$ the intersection of line $A P$ and line $O I$. Using directed angles, we have

$$
\begin{aligned}
\measuredangle M A P^{\prime} & =\measuredangle I_{A}^{\prime} A I_{A}=\measuredangle I_{A}^{\prime} A A^{\prime}-\measuredangle I_{A} A A^{\prime}=\measuredangle A A^{\prime} I_{A}-\measuredangle(A M, O M) \\
& =\measuredangle A I O-\measuredangle A M O=\measuredangle M O P^{\prime} .
\end{aligned}
$$

This shows $M, O, A, P^{\prime}$ are concyclic.

Denote by $R$ and $r$ the circumradius and inradius of triangle $A B C$. Then

$$
I P^{\prime}=\frac{I A \cdot I M}{I O}=\frac{I O^{2}-R^{2}}{I O}
$$

is independent of $A$. Hence, $B P$ also meets line $O I$ at the same point $P^{\prime}$ so that $P^{\prime}=P$, and $P$ lies on $O I$.\\
(b) By Poncelet's Porism, the other tangents to the incircle of triangle $A B C$ from $X$ and $Y$ meet at a point $Z$ on $\Gamma$. Let $T$ be the touching point of the incircle to $X Y$, and let $D$ be the midpoint of $X Y$. We have

$$
\begin{aligned}
O D & =I T \cdot \frac{O P}{I P}=r\left(1+\frac{O I}{I P}\right)=r\left(1+\frac{O I^{2}}{O I \cdot I P}\right)=r\left(1+\frac{R^{2}-2 R r}{R^{2}-I O^{2}}\right) \\
& =r\left(1+\frac{R^{2}-2 R r}{2 R r}\right)=\frac{R}{2}=\frac{O X}{2} .
\end{aligned}
$$

This shows $\angle X Z Y=60^{\circ}$ and hence $\angle X I Y=120^{\circ}$.",3,"Let $A'$ be the reflection of vertex $A$ in the side $BC$. Let $I$ be the incenter, $I_A$ be the A-excenter, and $O$ be the circumcenter of $\triangle ABC$. Prove that triangles $A A' I_A$ and $A I O$ are similar.","The triangles $\triangle ABA'$ and $\triangle AOC$ are both isosceles. Since $\angle ABA' = 2\angle ABC$ and $\angle AOC = 2\angle ABC$, they are similar, which gives $\frac{AA'}{AB} = \frac{AC}{AO}$. Also, by angle-angle similarity, $\triangle ABI_A \sim \triangle AIC$, which gives $\frac{AB}{AI_A} = \frac{AI}{AC}$. Combining these results, we get the ratio of sides $\frac{AA'}{AI_A} = \frac{AA'}{AB} \cdot \frac{AB}{AI_A} = \frac{AC}{AO} \cdot \frac{AI}{AC} = \frac{AI}{AO}$. Furthermore, it can be shown that the included angles are equal: $\angle A'AI_A = \angle IAO$. Therefore, by SAS similarity, $\triangle AA'I_A \sim \triangle AIO$.","Prove that the intersection point $P$ of lines $l_A$ and $l_B$ lies on the line $OI$, where $O$ is the circumcenter of triangle $ABC$.","Let $M$ be the second intersection of the angle bisector $AI$ with the circumcircle. From the definition of $l_A$ and the similarity proved in the first sub-problem, angle chasing reveals that $\measuredangle MAP = \measuredangle MOP$. This implies that the points $M, O, A, P$ are concyclic. The power of the incenter $I$ with respect to the circle passing through these four points is given by $IO \cdot IP = -IA \cdot IM$. Using Euler's theorem ($OI^2=R(R-2r)$) and the fact that $IA \cdot IM = 2Rr$, we have $IA \cdot IM = R^2 - OI^2$. This yields $IP = \frac{OI^2 - R^2}{OI}$. Since this expression for the position of $P$ on line $OI$ is symmetric with respect to all vertices of $\triangle ABC$, the line $l_B$ must intersect $OI$ at the same point. Thus, $P$ lies on the line $OI$.",Let one of the tangents from $P$ to the incircle of triangle $ABC$ meet the circumcircle at points $X$ and $Y$. Show that $\angle X I Y=120^{\circ}$.,"Let the tangent from $P$ be the line $XY$, let $D$ be the midpoint of the segment $XY$, and let $T$ be the point where $XY$ touches the incircle. Since $OD \perp XY$ and $IT \perp XY$, triangles $\triangle POD$ and $\triangle PIT$ are similar. This gives the relation $OD = IT \cdot OP/IP = r \cdot OP/IP$. As established in the second sub-problem, $P$ lies on line $OI$, and we can compute the ratio $OP/IP = R/(2r)$. Therefore, $OD = r \cdot (R/(2r)) = R/2$. In the right-angled triangle $\triangle ODX$, we have $OX=R$, so $\cos(\angle DOX) = OD/OX = (R/2)/R = 1/2$, which means $\angle DOX = 60^{\circ}$ and thus $\angle XOY = 120^{\circ}$. By Poncelet's porism, the other tangents from $X$ and $Y$ to the incircle will meet at a point $Z$ on the circumcircle. The angle at the circumference $\angle XZY$ subtends the same arc as $\angle XOY$, so $\angle XZY = \frac{1}{2} \angle XOY = 60^{\circ}$. Since $I$ is the incenter of $\triangle XYZ$, the angle at the incenter is given by $\angle XIY = 90^{\circ} + \frac{1}{2} \angle XZY = 90^{\circ} + 30^{\circ} = 120^{\circ}$.",,
2016g8,"Let $A_{1}, B_{1}$ and $C_{1}$ be points on sides $B C, C A$ and $A B$ of an acute triangle $A B C$ respectively, such that $A A_{1}, B B_{1}$ and $C C_{1}$ are the internal angle bisectors of triangle $A B C$. Let $I$ be the incentre of triangle $A B C$, and $H$ be the orthocentre of triangle $A_{1} B_{1} C_{1}$. Show that

$$
A H+B H+C H \geqslant A I+B I+C I .
$$","Solution. Without loss of generality, assume $\alpha=\angle B A C \leqslant \beta=\angle C B A \leqslant \gamma=\angle A C B$. Denote by $a, b, c$ the lengths of $B C, C A, A B$ respectively. We first show that triangle $A_{1} B_{1} C_{1}$ is acute.

Choose points $D$ and $E$ on side $B C$ such that $B_{1} D / / A B$ and $B_{1} E$ is the internal angle bisector of $\angle B B_{1} C$. As $\angle B_{1} D B=180^{\circ}-\beta$ is obtuse, we have $B B_{1}>B_{1} D$. Thus,

$$
\frac{B E}{E C}=\frac{B B_{1}}{B_{1} C}>\frac{D B_{1}}{B_{1} C}=\frac{B A}{A C}=\frac{B A_{1}}{A_{1} C} .
$$

Therefore, $B E>B A_{1}$ and $\frac{1}{2} \angle B B_{1} C=\angle B B_{1} E>\angle B B_{1} A_{1}$. Similarly, $\frac{1}{2} \angle B B_{1} A>\angle B B_{1} C_{1}$. It follows that

$$
\angle A_{1} B_{1} C_{1}=\angle B B_{1} A_{1}+\angle B B_{1} C_{1}<\frac{1}{2}\left(\angle B B_{1} C+\angle B B_{1} A\right)=90^{\circ}
$$

is acute. By symmetry, triangle $A_{1} B_{1} C_{1}$ is acute.\\
Let $B B_{1}$ meet $A_{1} C_{1}$ at $F$. From $\alpha \leqslant \gamma$, we get $a \leqslant c$, which implies

$$
B A_{1}=\frac{c a}{b+c} \leqslant \frac{a c}{a+b}=B C_{1}
$$

and hence $\angle B C_{1} A_{1} \leqslant \angle B A_{1} C_{1}$. As $B F$ is the internal angle bisector of $\angle A_{1} B C_{1}$, this shows $\angle B_{1} F C_{1}=\angle B F A_{1} \leqslant 90^{\circ}$. Hence, $H$ lies on the same side of $B B_{1}$ as $C_{1}$. This shows $H$ lies inside triangle $B B_{1} C_{1}$. Similarly, from $\alpha \leqslant \beta$ and $\beta \leqslant \gamma$, we know that $H$ lies inside triangles $C C_{1} B_{1}$ and $A A_{1} C_{1}$.\\
\includegraphics[max width=\textwidth, center]{2025_04_30_7daf08b5ed3ffd852861g-72}

As $\alpha \leqslant \beta \leqslant \gamma$, we have $\alpha \leqslant 60^{\circ} \leqslant \gamma$. Then $\angle B I C \leqslant 120^{\circ} \leqslant \angle A I B$. Firstly, suppose $\angle A I C \geqslant 120^{\circ}$.

Rotate points $B, I, H$ through $60^{\circ}$ about $A$ to $B^{\prime}, I^{\prime}, H^{\prime}$ so that $B^{\prime}$ and $C$ lie on different sides of $A B$. Since triangle $A I^{\prime} I$ is equilateral, we have


\begin{equation*}
A I+B I+C I=I^{\prime} I+B^{\prime} I^{\prime}+I C=B^{\prime} I^{\prime}+I^{\prime} I+I C . \tag{1}
\end{equation*}


Similarly,


\begin{equation*}
A H+B H+C H=H^{\prime} H+B^{\prime} H^{\prime}+H C=B^{\prime} H^{\prime}+H^{\prime} H+H C . \tag{2}
\end{equation*}


As $\angle A I I^{\prime}=\angle A I^{\prime} I=60^{\circ}, \angle A I^{\prime} B^{\prime}=\angle A I B \geqslant 120^{\circ}$ and $\angle A I C \geqslant 120^{\circ}$, the quadrilateral $B^{\prime} I^{\prime} I C$ is convex and lies on the same side of $B^{\prime} C$ as $A$.

Next, since $H$ lies inside triangle $A C C_{1}, H$ lies outside $B^{\prime} I^{\prime} I C$. Also, $H$ lying inside triangle $A B I$ implies $H^{\prime}$ lies inside triangle $A B^{\prime} I^{\prime}$. This shows $H^{\prime}$ lies outside $B^{\prime} I^{\prime} I C$ and hence the convex quadrilateral $B^{\prime} I^{\prime} I C$ is contained inside the quadrilateral $B^{\prime} H^{\prime} H C$. It follows that the perimeter of $B^{\prime} I^{\prime} I C$ cannot exceed the perimeter of $B^{\prime} H^{\prime} H C$. From (1) and (2), we conclude that

$$
A H+B H+C H \geqslant A I+B I+C I
$$

For the case $\angle A I C<120^{\circ}$, we can rotate $B, I, H$ through $60^{\circ}$ about $C$ to $B^{\prime}, I^{\prime}, H^{\prime}$ so that $B^{\prime}$ and $A$ lie on different sides of $B C$. The proof is analogous to the previous case and we still get the desired inequality.",4,"Show that triangle $A_{1} B_{1} C_{1}$ is acute. Assuming $\angle A \leqslant \angle B \leqslant \angle C$, determine the location of its orthocenter $H$ relative to the angle bisectors of $\triangle ABC$.","By comparing ratios from the Angle Bisector Theorem with side lengths in a constructed parallel line setup, we show $\angle B B_{1} A_{1}<\frac{1}{2} \angle B B_{1} C$ and $\angle B B_{1} C_{1}<\frac{1}{2} \angle B B_{1} A$. Summing these gives $\angle A_{1} B_{1} C_{1}<90^{\circ}$. By symmetry, $\triangle A_{1} B_{1} C_{1}$ is acute. The condition $\angle A \le \angle C$ implies $a \le c$, which leads to $BA_1 \le BC_1$ and $\angle BC_1A_1 \le \angle BA_1C_1$. As $BB_1$ bisects $\angle A_1BC_1$, its intersection $F$ with $A_1C_1$ has $\angle BFA_1 \le 90^\circ$. This geometry forces the orthocenter $H$ of $\triangle A_1B_1C_1$ to lie on the same side of the line $BB_1$ as $C_1$. By symmetry with other vertices, $H$ lies inside triangles $BB_{1} C_{1}$, $CC_{1} B_{1}$ and $A A_{1} C_{1}$.","Using a $60^\circ$ rotation around vertex $A$ that maps points $B, I, H$ to $B', I', H'$ respectively, express the sums $AI+BI+CI$ and $AH+BH+CH$ as lengths of polygonal chains.","The rotation creates equilateral triangles $\triangle AII'$ and $\triangle AHH'$, so $AI = I'I$ and $AH = H'H$. Since rotation is an isometry, $BI = B'I'$ and $BH = B'H'$. Substituting these equalities into the sums gives: $AI+BI+CI = I'I + B'I' + CI$, which is the length of the polygonal path $B'I'IC$. Similarly, $AH+BH+CH = H'H + B'H' + CH$, which is the length of the polygonal path $B'H'HC$.","Assume a $60^\circ$ rotation around $A$ is performed as in the previous sub-problem. Under the condition that $\angle AIB \ge 120^\circ$ and $\angle AIC \ge 120^\circ$, show that the convex quadrilateral $B'I'IC$ is contained within the quadrilateral $B'H'HC$.","The conditions $\angle AIB \ge 120^\circ$ and $\angle AIC \ge 120^\circ$ imply, after rotation, that $\angle AI'B' \ge 120^\circ$ and $\angle AIC \ge 120^\circ$. Together with $\angle AI'I = \angle AII' = 60^\circ$, this ensures the path $B'I'IC$ forms a convex quadrilateral. From Sub-problem 1, $H$ lies inside $\triangle ACC_1$. The rotation places $H'$ inside the image of $\triangle ABI$, which is $\triangle AB'I'$. These locations for $H$ and $H'$ are outside the convex region defined by $B'I'IC$. Therefore, the convex quadrilateral $B'I'IC$ is contained within the polygon $B'H'HC$.","Let $A_{1}, B_{1}$ and $C_{1}$ be points on sides $B C, C A$ and $A B$ of an acute triangle $A B C$ respectively, such that $A A_{1}, B B_{1}$ and $C C_{1}$ are the internal angle bisectors of triangle $A B C$. Let $I$ be the incentre of triangle $A B C$, and $H$ be the orthocentre of triangle $A_{1} B_{1} C_{1}$. Show that $A H+B H+C H \geqslant A I+B I+C I$.","Assume without loss of generality that $\angle A \le \angle B \le \angle C$. This implies that at least one of $\angle B$ or $\angle C$ is at least $60^\circ$. Consequently, at least one of $\angle AIC = 90^\circ + \beta/2$ or $\angle AIB = 90^\circ + \gamma/2$ is at least $120^\circ$. We can choose a vertex (say, A, if $\beta \ge 60^\circ$) to perform a $60^\circ$ rotation, satisfying the conditions of Sub-problem 3. From Sub-problem 2, the sums $AI+BI+CI$ and $AH+BH+CH$ are equal to the lengths of the paths $B'I'IC$ and $B'H'HC$. From Sub-problem 3, the convex path $B'I'IC$ is contained within the path $B'H'HC$. The length of an enclosed convex polygonal chain cannot exceed the length of the enclosing chain. Therefore, $AI+BI+CI \le AH+BH+CH$. If the conditions for rotating around $A$ are not met, an analogous argument with rotation around another vertex holds."
2016n4,"Let $n, m, k$ and $l$ be positive integers with $n \neq 1$ such that $n^{k}+m n^{l}+1$ divides $n^{k+l}-1$. Prove that

\begin{itemize}
  \item $m=1$ and $l=2 k$; or
  \item $l \mid k$ and $m=\frac{n^{k-l}-1}{n^{l}-1}$.
\end{itemize}","It is given that


\begin{equation*}
n^{k}+m n^{l}+1 \mid n^{k+l}-1 \tag{1}
\end{equation*}


This implies


\begin{equation*}
n^{k}+m n^{l}+1 \mid\left(n^{k+l}-1\right)+\left(n^{k}+m n^{l}+1\right)=n^{k+l}+n^{k}+m n^{l} . \tag{2}
\end{equation*}


We have two cases to discuss.

\begin{itemize}
  \item Case 1. $l \geqslant k$.
\end{itemize}

Since $\left(n^{k}+m n^{l}+1, n\right)=1$, (2) yields

$$
n^{k}+m n^{l}+1 \mid n^{l}+m n^{l-k}+1 .
$$

In particular, we get $n^{k}+m n^{l}+1 \leqslant n^{l}+m n^{l-k}+1$. As $n \geqslant 2$ and $k \geqslant 1,(m-1) n^{l}$ is at least $2(m-1) n^{l-k}$. It follows that the inequality cannot hold when $m \geqslant 2$. For $m=1$, the above divisibility becomes

$$
n^{k}+n^{l}+1 \mid n^{l}+n^{l-k}+1 .
$$

Note that $n^{l}+n^{l-k}+1<n^{l}+n^{l}+1<2\left(n^{k}+n^{l}+1\right)$. Thus we must have $n^{l}+n^{l-k}+1=n^{k}+n^{l}+1$ so that $l=2 k$, which gives the first result.

\begin{itemize}
  \item Case 2. $l<k$.
\end{itemize}

This time (2) yields

$$
n^{k}+m n^{l}+1 \mid n^{k}+n^{k-l}+m .
$$

In particular, we get $n^{k}+m n^{l}+1 \leqslant n^{k}+n^{k-l}+m$, which implies


\begin{equation*}
m \leqslant \frac{n^{k-l}-1}{n^{l}-1} \tag{3}
\end{equation*}


On the other hand, from (1) we may let $n^{k+l}-1=\left(n^{k}+m n^{l}+1\right) t$ for some positive integer $t$. Obviously, $t$ is less than $n^{l}$, which means $t \leqslant n^{l}-1$ as it is an integer. Then we have $n^{k+l}-1 \leqslant\left(n^{k}+m n^{l}+1\right)\left(n^{l}-1\right)$, which is the same as


\begin{equation*}
m \geqslant \frac{n^{k-l}-1}{n^{l}-1} \tag{4}
\end{equation*}


Equations (3) and (4) combine to give $m=\frac{n^{k-l}-1}{n^{l}-1}$. As this is an integer, we have $l \mid k-l$. This means $l \mid k$ and it corresponds to the second result.",2,"Let $n, m, k, l$ be positive integers with $n \neq 1$ and $l \ge k$. If $n^{k}+m n^{l}+1$ divides $n^{k+l}-1$, prove that $m=1$ and $l=2k$.","The condition $n^{k}+m n^{l}+1 \mid n^{k+l}-1$ implies $n^{k}+m n^{l}+1 \mid (n^{k+l}-1) + (n^{k}+m n^{l}+1) = n^{k+l}+n^{k}+m n^{l}$. Since $\gcd(n^{k}+m n^{l}+1, n) = 1$ and $l \ge k$, we can divide by $n^k$ to get $n^{k}+m n^{l}+1 \mid n^{l}+m n^{l-k}+1$. This requires the inequality $n^{k}+m n^{l}+1 \le n^{l}+m n^{l-k}+1$. For $m \ge 2$, with $n \ge 2$ and $k \ge 1$, this inequality leads to a contradiction. Thus we must have $m=1$. The divisibility then becomes $n^{k}+n^{l}+1 \mid n^{l}+n^{l-k}+1$. As the dividend is positive and strictly less than $2(n^{k}+n^{l}+1)$, equality must hold: $n^{k}+n^{l}+1=n^{l}+n^{l-k}+1$. This yields $n^k=n^{l-k}$, which implies $l=2k$.","Let $n, m, k$ and $l$ be positive integers with $n \neq 1$ such that $n^{k}+m n^{l}+1$ divides $n^{k+l}-1$. Prove that
- $m=1$ and $l=2 k$; or
- $l \mid k$ and $m=\frac{n^{k-l}-1}{n^{l}-1}$.","We analyze the problem by considering two cases based on the relationship between $k$ and $l$.
Case 1: $l \ge k$. From the first sub-problem, this case implies $m=1$ and $l=2k$.
Case 2: $l < k$. The condition $n^{k}+m n^{l}+1 \mid n^{k+l}-1$ implies $n^{k}+m n^{l}+1 \mid n^{k}+n^{k-l}+m$. This leads to the inequality $m \le \frac{n^{k-l}-1}{n^{l}-1}$. On the other hand, from $n^{k+l}-1=t(n^{k}+m n^{l}+1)$, we can deduce that the integer quotient $t$ must satisfy $t \le n^l-1$. This implies the reverse inequality $m \ge \frac{n^{k-l}-1}{n^{l}-1}$. Therefore, we must have $m = \frac{n^{k-l}-1}{n^{l}-1}$. For $m$ to be an integer, it is necessary that $n^l-1$ divides $n^{k-l}-1$, which implies $l \mid (k-l)$, and therefore $l \mid k$.
Combining the results from both cases proves the statement.",,,,
2016n5,"Let $a$ be a positive integer which is not a square number. Denote by $A$ the set of all positive integers $k$ such that


\begin{equation*}
k=\frac{x^{2}-a}{x^{2}-y^{2}} \tag{1}
\end{equation*}


for some integers $x$ and $y$ with $x>\sqrt{a}$. Denote by $B$ the set of all positive integers $k$ such that (1) is satisfied for some integers $x$ and $y$ with $0 \leqslant x<\sqrt{a}$. Prove that $A=B$.","We first prove the following preliminary result.

\begin{itemize}
  \item Claim. For fixed $k$, let $x, y$ be integers satisfying (1). Then the numbers $x_{1}, y_{1}$ defined by
\end{itemize}

$$
x_{1}=\frac{1}{2}\left(x-y+\frac{(x-y)^{2}-4 a}{x+y}\right), \quad y_{1}=\frac{1}{2}\left(x-y-\frac{(x-y)^{2}-4 a}{x+y}\right)
$$

are integers and satisfy (1) (with $x, y$ replaced by $x_{1}, y_{1}$ respectively).\\
Proof. Since $x_{1}+y_{1}=x-y$ and

$$
x_{1}=\frac{x^{2}-x y-2 a}{x+y}=-x+\frac{2\left(x^{2}-a\right)}{x+y}=-x+2 k(x-y),
$$

both $x_{1}$ and $y_{1}$ are integers. Let $u=x+y$ and $v=x-y$. The relation (1) can be rewritten as

$$
u^{2}-(4 k-2) u v+\left(v^{2}-4 a\right)=0
$$

By Vieta's Theorem, the number $z=\frac{v^{2}-4 a}{u}$ satisfies

$$
v^{2}-(4 k-2) v z+\left(z^{2}-4 a\right)=0
$$

Since $x_{1}$ and $y_{1}$ are defined so that $v=x_{1}+y_{1}$ and $z=x_{1}-y_{1}$, we can reverse the process and verify (1) for $x_{1}, y_{1}$.

We first show that $B \subset A$. Take any $k \in B$ so that (1) is satisfied for some integers $x, y$ with $0 \leqslant x<\sqrt{a}$. Clearly, $y \neq 0$ and we may assume $y$ is positive. Since $a$ is not a square, we have $k>1$. Hence, we get $0 \leqslant x<y<\sqrt{a}$. Define

$$
x_{1}=\frac{1}{2}\left|x-y+\frac{(x-y)^{2}-4 a}{x+y}\right|, \quad y_{1}=\frac{1}{2}\left(x-y-\frac{(x-y)^{2}-4 a}{x+y}\right)
$$

By the Claim, $x_{1}, y_{1}$ are integers satisfying (1). Also, we have

$$
x_{1} \geqslant-\frac{1}{2}\left(x-y+\frac{(x-y)^{2}-4 a}{x+y}\right)=\frac{2 a+x(y-x)}{x+y} \geqslant \frac{2 a}{x+y}>\sqrt{a} .
$$

This implies $k \in A$ and hence $B \subset A$.

Next, we shall show that $A \subset B$. Take any $k \in A$ so that (1) is satisfied for some integers $x, y$ with $x>\sqrt{a}$. Again, we may assume $y$ is positive. Among all such representations of $k$, we choose the one with smallest $x+y$. Define

$$
x_{1}=\frac{1}{2}\left|x-y+\frac{(x-y)^{2}-4 a}{x+y}\right|, \quad y_{1}=\frac{1}{2}\left(x-y-\frac{(x-y)^{2}-4 a}{x+y}\right) .
$$

By the Claim, $x_{1}, y_{1}$ are integers satisfying (1). Since $k>1$, we get $x>y>\sqrt{a}$. Therefore, we have $y_{1}>\frac{4 a}{x+y}>0$ and $\frac{4 a}{x+y}<x+y$. It follows that

$$
x_{1}+y_{1} \leqslant \max \left\{x-y, \frac{4 a-(x-y)^{2}}{x+y}\right\}<x+y .
$$

If $x_{1}>\sqrt{a}$, we get a contradiction due to the minimality of $x+y$. Therefore, we must have $0 \leqslant x_{1}<\sqrt{a}$, which means $k \in B$ so that $A \subset B$.

The two subset relations combine to give $A=B$.\\",3,"Let $k$ be a positive integer such that $k=\frac{x^{2}-a}{x^{2}-y^{2}}$ for some integers $x, y$. Define a new pair of numbers $(x_1, y_1)$ by $x_{1}=\frac{1}{2}\left(x-y+\frac{(x-y)^{2}-4 a}{x+y}\right)$ and $y_{1}=\frac{1}{2}\left(x-y-\frac{(x-y)^{2}-4 a}{x+y}\right)$. Show that $x_1$ and $y_1$ are integers and that they also satisfy the relation $k=\frac{x_{1}^{2}-a}{x_{1}^{2}-y_{1}^{2}}$.","The expression for $x_1$ can be rewritten as $x_1 = -x + \frac{2(x^2-a)}{x+y} = -x+2k(x-y)$. Since $x,y,k$ are integers, $x_1$ is an integer. As $x_1+y_1 = x-y$, it follows that $y_1=(x-y)-x_1$ is also an integer. Let $u=x+y$ and $v=x-y$. The relation $k=\frac{x^2-a}{x^2-y^2}$ is equivalent to the quadratic equation $u^2-(4k-2)uv+(v^2-4a)=0$. By Vieta's formulas, for a fixed $v$, if $u$ is a root, then $u_2=\frac{v^2-4a}{u}$ also yields a valid solution. A new solution $(x', y')$ can be formed with $x'+y' = u_2$ and $x'-y' = v$. This gives $x' = \frac{1}{2}(v+u_2) = x_1$ and $y'=\frac{1}{2}(u_2-v) = -y_1$. Since the equation for $k$ only involves $y^2$, if $(x_1, -y_1)$ is a solution, so is $(x_1, y_1)$, which proves the claim.",Let $A$ and $B$ be the sets defined in the problem. Prove that $B \subset A$.,"Let $k \in B$. There exist integers $x,y$ with $0 \le x < \sqrt{a}$ satisfying the equation. As $x^2-a<0$ and $k>0$, we must have $x^2-y^2<0$, so $|x|<|y|$. We can assume $y>0$. From $k(y^2-x^2)=a-x^2$ and $k \ge 1$, we get $y^2-x^2 \le a-x^2$, so $y^2 \le a$. Since $a$ is not a square, $y<\sqrt{a}$. Thus $0 \le x < y < \sqrt{a}$. Consider the new integer solution $(x_1, y_1)$ from sub-problem 1. Let $x_1' = \frac{1}{2}\left|x-y+\frac{(x-y)^2-4a}{x+y}\right|$. For $0 \le x<y<\sqrt{a}$, the term inside the absolute value is negative. So, $x_1' = -\frac{1}{2}\left(x-y+\frac{(x-y)^2-4a}{x+y}\right) = \frac{x(y-x)+2a}{x+y}$. Since $x(y-x) \ge 0$, we have $x_1' \ge \frac{2a}{x+y}$. As $x+y < 2\sqrt{a}$, it follows that $x_1' > \frac{2a}{2\sqrt{a}}=\sqrt{a}$. This provides a solution where the first component's magnitude is greater than $\sqrt{a}$, so $k \in A$. Thus $B \subset A$.",Let $a$ be a positive integer which is not a square number. Denote by $A$ the set of all positive integers $k$ such that $k=\frac{x^{2}-a}{x^{2}-y^{2}}$ for some integers $x$ and $y$ with $x>\sqrt{a}$. Denote by $B$ the set of all positive integers $k$ such that this relation is satisfied for some integers $x$ and $y$ with $0 \leqslant x<\sqrt{a}$. Prove that $A=B$.,"From sub-problem 2, we have $B \subset A$. We now show $A \subset B$. Let $k \in A$. Choose an integer solution $(x,y)$ with $x > \sqrt{a}$ and $y \ge 0$ which minimizes the sum $x+y$. Since $k>0$ and $x^2-a>0$, we have $x^2>y^2$, so $x>y$. Since $a$ is not a square, $k\neq 1$. For $k>1$, $ky^2=(k-1)x^2+a > (k-1)a+a=ka$, so $y^2>a$, which means $y>\sqrt{a}$. Let $(x_1,y_1)$ be the new integer solution from sub-problem 1, and let $(x',y')$ be a corresponding non-negative integer solution. The new sum $x'+y'$ corresponds to $|u_2|=|\frac{(x-y)^2-4a}{x+y}|$. This sum is strictly smaller than the original sum $x+y$ because $|(x-y)^2-4a|<(x+y)^2$, which is equivalent to $4a<2(x^2+y^2)$ for $x,y>\sqrt{a}$. The new solution $(x',y')$ with a smaller sum $x'+y'$ contradicts the minimality of $x+y$ unless it does not satisfy the condition for $A$. Therefore, we must have $0 \le x' < \sqrt{a}$, which implies $k \in B$. Thus $A \subset B$. As both inclusions hold, $A=B$.",,
2016n7,"Let $n$ be an odd positive integer. In the Cartesian plane, a cyclic polygon $P$ with area $S$ is chosen. All its vertices have integral coordinates, and the squares of its side lengths are all divisible by $n$. Prove that $2 S$ is an integer divisible by $n$.","Solution. Let $P=A_{1} A_{2} \ldots A_{k}$ and let $A_{k+i}=A_{i}$ for $i \geqslant 1$. By the Shoelace Formula, the area of any convex polygon with integral coordinates is half an integer. Therefore, $2 S$ is an integer. We shall prove by induction on $k \geqslant 3$ that $2 S$ is divisible by $n$. Clearly, it suffices to consider $n=p^{t}$ where $p$ is an odd prime and $t \geqslant 1$.

For the base case $k=3$, let the side lengths of $P$ be $\sqrt{n a}, \sqrt{n b}, \sqrt{n c}$ where $a, b, c$ are positive integers. By Heron's Formula,

$$
16 S^{2}=n^{2}\left(2 a b+2 b c+2 c a-a^{2}-b^{2}-c^{2}\right)
$$

This shows $16 S^{2}$ is divisible by $n^{2}$. Since $n$ is odd, $2 S$ is divisible by $n$.\\
Assume $k \geqslant 4$. If the square of length of one of the diagonals is divisible by $n$, then that diagonal divides $P$ into two smaller polygons, to which the induction hypothesis applies. Hence we may assume that none of the squares of diagonal lengths is divisible by $n$. As usual, we denote by $\nu_{p}(r)$ the exponent of $p$ in the prime decomposition of $r$. We claim the following.

\begin{itemize}
  \item Claim. $\nu_{p}\left(A_{1} A_{m}^{2}\right)>\nu_{p}\left(A_{1} A_{m+1}^{2}\right)$ for $2 \leqslant m \leqslant k-1$.
\end{itemize}

Proof. The case $m=2$ is obvious since $\nu_{p}\left(A_{1} A_{2}^{2}\right) \geqslant p^{t}>\nu_{p}\left(A_{1} A_{3}^{2}\right)$ by the condition and the above assumption.

Suppose $\nu_{p}\left(A_{1} A_{2}^{2}\right)>\nu_{p}\left(A_{1} A_{3}^{2}\right)>\cdots>\nu_{p}\left(A_{1} A_{m}^{2}\right)$ where $3 \leqslant m \leqslant k-1$. For the induction step, we apply Ptolemy's Theorem to the cyclic quadrilateral $A_{1} A_{m-1} A_{m} A_{m+1}$ to get

$$
A_{1} A_{m+1} \times A_{m-1} A_{m}+A_{1} A_{m-1} \times A_{m} A_{m+1}=A_{1} A_{m} \times A_{m-1} A_{m+1}
$$

which can be rewritten as


\begin{align*}
A_{1} A_{m+1}^{2} \times A_{m-1} A_{m}^{2}= & A_{1} A_{m-1}^{2} \times A_{m} A_{m+1}^{2}+A_{1} A_{m}^{2} \times A_{m-1} A_{m+1}^{2} \\
& -2 A_{1} A_{m-1} \times A_{m} A_{m+1} \times A_{1} A_{m} \times A_{m-1} A_{m+1} \tag{1}
\end{align*}


From this, $2 A_{1} A_{m-1} \times A_{m} A_{m+1} \times A_{1} A_{m} \times A_{m-1} A_{m+1}$ is an integer. We consider the component of $p$ of each term in (1). By the inductive hypothesis, we have $\nu_{p}\left(A_{1} A_{m-1}^{2}\right)>\nu_{p}\left(A_{1} A_{m}^{2}\right)$. Also, we have $\nu_{p}\left(A_{m} A_{m+1}^{2}\right) \geqslant p^{t}>\nu_{p}\left(A_{m-1} A_{m+1}^{2}\right)$. These give


\begin{equation*}
\nu_{p}\left(A_{1} A_{m-1}^{2} \times A_{m} A_{m+1}^{2}\right)>\nu_{p}\left(A_{1} A_{m}^{2} \times A_{m-1} A_{m+1}^{2}\right) \tag{2}
\end{equation*}


Next, we have $\nu_{p}\left(4 A_{1} A_{m-1}^{2} \times A_{m} A_{m+1}^{2} \times A_{1} A_{m}^{2} \times A_{m-1} A_{m+1}^{2}\right)=\nu_{p}\left(A_{1} A_{m-1}^{2} \times A_{m} A_{m+1}^{2}\right)+$ $\nu_{p}\left(A_{1} A_{m}^{2} \times A_{m-1} A_{m+1}^{2}\right)>2 \nu_{p}\left(A_{1} A_{m}^{2} \times A_{m-1} A_{m+1}^{2}\right)$ from (2). This implies


\begin{equation*}
\nu_{p}\left(2 A_{1} A_{m-1} \times A_{m} A_{m+1} \times A_{1} A_{m} \times A_{m-1} A_{m+1}\right)>\nu_{p}\left(A_{1} A_{m}^{2} \times A_{m-1} A_{m+1}^{2}\right) \tag{3}
\end{equation*}


Combining (1), (2) and (3), we conclude that

$$
\nu_{p}\left(A_{1} A_{m+1}^{2} \times A_{m-1} A_{m}^{2}\right)=\nu_{p}\left(A_{1} A_{m}^{2} \times A_{m-1} A_{m+1}^{2}\right)
$$

By $\nu_{p}\left(A_{m-1} A_{m}^{2}\right) \geqslant p^{t}>\nu_{p}\left(A_{m-1} A_{m+1}^{2}\right)$, we get $\nu_{p}\left(A_{1} A_{m+1}^{2}\right)<\nu_{p}\left(A_{1} A_{m}^{2}\right)$. The Claim follows by induction.

From the Claim, we get a chain of inequalities

$$
p^{t}>\nu_{p}\left(A_{1} A_{3}^{2}\right)>\nu_{p}\left(A_{1} A_{4}^{2}\right)>\cdots>\nu_{p}\left(A_{1} A_{k}^{2}\right) \geqslant p^{t},
$$

which yields a contradiction. Therefore, we can show by induction that $2 S$ is divisible by $n$.\\
Comment. The condition that $P$ is cyclic is crucial. As a counterexample, consider the rhombus with vertices $(0,3),(4,0),(0,-3),(-4,0)$. Each of its squares of side lengths is divisible by 5 , while $2 S=48$ is not.

The proposer also gives a proof for the case $n$ is even. One just needs an extra technical step for the case $p=2$.",4,"Let $T$ be a triangle with integer coordinate vertices and area $S$. If the squares of its side lengths are divisible by an odd positive integer $n$, prove that $2S$ is an integer divisible by $n$.","Let the side lengths be $l_1, l_2, l_3$. We are given $l_i^2 = n a_i$ for integers $a_i$. By Heron's formula, $16S^2 = (l_1^2+l_2^2+l_3^2)^2 - 2(l_1^4+l_2^4+l_3^4) = n^2((a_1+a_2+a_3)^2 - 2(a_1^2+a_2^2+a_3^2))$. Thus $n^2 | 16S^2$. Since vertices have integer coordinates, $2S$ is an integer. Let $X=2S$. Then $n^2 | 4X^2$. As $n$ is odd, $\gcd(n^2, 4)=1$, so $n^2 | X^2$, which implies $n | X$. Therefore, $n | 2S$.","Let $P$ be a cyclic polygon with $k \ge 4$ vertices having integral coordinates. Let the squares of its side lengths be divisible by an odd integer $n$. Assume that for any cyclic polygon with fewer than $k$ vertices satisfying these conditions, its area $S'$ multiplied by 2 is divisible by $n$. Prove that if $P$ has a diagonal $d$ such that $d^2$ is divisible by $n$, then $2S$ is divisible by $n$, where $S$ is the area of $P$.","The diagonal $d$ splits the polygon $P$ into two smaller cyclic polygons, $P_1$ and $P_2$, with areas $S_1$ and $S_2$. The vertices of $P_1$ and $P_2$ have integral coordinates as they are vertices of $P$. The sides of $P_1$ and $P_2$ are either sides of $P$ or the diagonal $d$. In all cases, the squares of their side lengths are divisible by $n$. By the induction hypothesis, $2S_1$ and $2S_2$ are divisible by $n$. Since $S=S_1+S_2$, we have $2S=2S_1+2S_2$, which is also divisible by $n$.","Let $n = p^t$ where $p$ is an odd prime. Let $P=A_1...A_k$ be a cyclic polygon ($k \ge 4$) such that for every side $A_iA_{i+1}$, $\nu_p(A_iA_{i+1}^2) \ge t$, and for every diagonal $A_iA_j$, $\nu_p(A_iA_j^2) < t$. Prove that this situation leads to a contradiction.","By assumption, $\nu_p(A_1A_2^2) \ge t > \nu_p(A_1A_3^2)$. Using induction on $m$ and Ptolemy's Theorem on the cyclic quadrilateral $A_1A_{m-1}A_mA_{m+1}$ for $m=3, \dots, k-1$, we can show that $\nu_p(A_1A_m^2) > \nu_p(A_1A_{m+1}^2)$. This creates a strictly decreasing sequence of integers: $t > \nu_p(A_1A_3^2) > \nu_p(A_1A_4^2) > \dots > \nu_p(A_1A_k^2)$. However, $A_1A_k$ is a side of the polygon, so its square length is divisible by $n$, meaning $\nu_p(A_1A_k^2) \ge t$. This implies $\nu_p(A_1A_3^2) > \nu_p(A_1A_k^2) \ge t$, which contradicts the initial condition that $\nu_p(A_1A_3^2) < t$.","Let $n$ be an odd positive integer. In the Cartesian plane, a cyclic polygon $P$ with area $S$ is chosen. All its vertices have integral coordinates, and the squares of its side lengths are all divisible by $n$. Prove that $2 S$ is an integer divisible by $n$.","By the Shoelace Formula, $2S$ is an integer. We prove $n|2S$ by induction on the number of vertices, $k$. It suffices to prove for $n=p^t$ where $p$ is an odd prime. The base case $k=3$ is proven in sub-problem 1. For the inductive step ($k \ge 4$), assume the statement holds for polygons with fewer than $k$ vertices. If there exists a diagonal whose length squared is divisible by $n$, then by sub-problem 2, $2S$ is divisible by $n$. If no such diagonal exists, sub-problem 3 shows this leads to a contradiction. Therefore, such a diagonal must exist, and the proof is complete."
2015a1,"Suppose that a sequence $a_{1}, a_{2}, \ldots$ of positive real numbers satisfies


\begin{equation*}
a_{k+1} \geqslant \frac{k a_{k}}{a_{k}^{2}+(k-1)} \tag{1}
\end{equation*}


for every positive integer $k$. Prove that $a_{1}+a_{2}+\cdots+a_{n} \geqslant n$ for every $n \geqslant 2$.","Solution. From the constraint (1), it can be seen that

$$
\frac{k}{a_{k+1}} \leqslant \frac{a_{k}^{2}+(k-1)}{a_{k}}=a_{k}+\frac{k-1}{a_{k}},
$$

and so

$$
a_{k} \geqslant \frac{k}{a_{k+1}}-\frac{k-1}{a_{k}} .
$$

Summing up the above inequality for $k=1, \ldots, m$, we obtain


\begin{equation*}
a_{1}+a_{2}+\cdots+a_{m} \geqslant\left(\frac{1}{a_{2}}-\frac{0}{a_{1}}\right)+\left(\frac{2}{a_{3}}-\frac{1}{a_{2}}\right)+\cdots+\left(\frac{m}{a_{m+1}}-\frac{m-1}{a_{m}}\right)=\frac{m}{a_{m+1}} . \tag{2}
\end{equation*}


Now we prove the problem statement by induction on $n$. The case $n=2$ can be done by applying (1) to $k=1$ :

$$
a_{1}+a_{2} \geqslant a_{1}+\frac{1}{a_{1}} \geqslant 2 .
$$

For the induction step, assume that the statement is true for some $n \geqslant 2$. If $a_{n+1} \geqslant 1$, then the induction hypothesis yields


\begin{equation*}
\left(a_{1}+\cdots+a_{n}\right)+a_{n+1} \geqslant n+1 . \tag{3}
\end{equation*}


Otherwise, if $a_{n+1}<1$ then apply (2) as

$$
\left(a_{1}+\cdots+a_{n}\right)+a_{n+1} \geqslant \frac{n}{a_{n+1}}+a_{n+1}=\frac{n-1}{a_{n+1}}+\left(\frac{1}{a_{n+1}}+a_{n+1}\right)>(n-1)+2 .
$$

That completes the solution.\\
Comment 1. It can be seen easily that having equality in the statement requires $a_{1}=a_{2}=1$ in the base case $n=2$, and $a_{n+1}=1$ in (3). So the equality $a_{1}+\cdots+a_{n}=n$ is possible only in the trivial case $a_{1}=\cdots=a_{n}=1$.

Comment 2. After obtaining (2), there are many ways to complete the solution. We outline three such possibilities.

\begin{itemize}
  \item With defining $s_{n}=a_{1}+\cdots+a_{n}$, the induction step can be replaced by
\end{itemize}

$$
s_{n+1}=s_{n}+a_{n+1} \geqslant s_{n}+\frac{n}{s_{n}} \geqslant n+1,
$$

because the function $x \mapsto x+\frac{n}{x}$ increases on $[n, \infty)$.

\begin{itemize}
  \item By applying the AM-GM inequality to the numbers $a_{1}+\cdots+a_{k}$ and $k a_{k+1}$, we can conclude
\end{itemize}

$$
a_{1}+\cdots+a_{k}+k a_{k+1} \geqslant 2 k
$$

and sum it up for $k=1, \ldots, n-1$.

\begin{itemize}
  \item We can derive the symmetric estimate
\end{itemize}

$$
\sum_{1 \leqslant i<j \leqslant n} a_{i} a_{j}=\sum_{j=2}^{n}\left(a_{1}+\cdots+a_{j-1}\right) a_{j} \geqslant \sum_{j=2}^{n}(j-1)=\frac{n(n-1)}{2}
$$

and combine it with the AM-QM inequality.",3,"Let $S_m = a_1 + a_2 + \cdots + a_m$. Prove that for any positive integer $m$, the sequence satisfies $S_m \geqslant \frac{m}{a_{m+1}}$.","The given inequality $a_{k+1} \geqslant \frac{k a_{k}}{a_{k}^{2}+(k-1)}$ can be rearranged. Taking the reciprocal and multiplying by $k$ gives $\frac{k}{a_{k+1}} \leqslant \frac{a_{k}^{2}+(k-1)}{a_{k}} = a_{k}+\frac{k-1}{a_{k}}$. This implies $a_{k} \geqslant \frac{k}{a_{k+1}}-\frac{k-1}{a_{k}}$. Summing this inequality from $k=1$ to $m$, we get a telescoping sum: $\sum_{k=1}^{m} a_k \geqslant \sum_{k=1}^{m} \left(\frac{k}{a_{k+1}}-\frac{k-1}{a_{k}}\right) = \left(\frac{1}{a_{2}}-\frac{0}{a_{1}}\right)+\left(\frac{2}{a_{3}}-\frac{1}{a_{2}}\right)+\cdots+\left(\frac{m}{a_{m+1}}-\frac{m-1}{a_{m}}\right) = \frac{m}{a_{m+1}}$.",Prove that $a_1 + a_2 \geqslant 2$.,"Using the given inequality for $k=1$, we have $a_{2} \geqslant \frac{1 \cdot a_{1}}{a_{1}^{2}+(1-1)} = \frac{a_1}{a_1^2} = \frac{1}{a_1}$. Therefore, the sum $a_1 + a_2 \geqslant a_1 + \frac{1}{a_1}$. By the AM-GM inequality, for any positive real number $x$, $x + \frac{1}{x} \geqslant 2$. Thus, $a_1 + a_2 \geqslant 2$.",Prove that $a_{1}+a_{2}+\cdots+a_{n} \geqslant n$ for every $n \geqslant 2$.,"We use induction on $n$. The base case $n=2$ is established in Sub-problem 2. Assume the statement holds for some $n \geqslant 2$, i.e., $a_1 + \dots + a_n \geqslant n$. We need to show $a_1 + \dots + a_{n+1} \geqslant n+1$. We consider two cases for $a_{n+1}$. Case 1: If $a_{n+1} \geqslant 1$, then by the induction hypothesis, $a_1 + \dots + a_{n+1} = (a_1 + \dots + a_n) + a_{n+1} \geqslant n + a_{n+1} \geqslant n+1$. Case 2: If $a_{n+1} < 1$, we use the result from Sub-problem 1 with $m=n$: $a_1 + \dots + a_n \geqslant \frac{n}{a_{n+1}}$. Then $a_1 + \dots + a_{n+1} \geqslant \frac{n}{a_{n+1}} + a_{n+1} = \frac{n-1}{a_{n+1}} + (\frac{1}{a_{n+1}} + a_{n+1})$. Since $a_{n+1} < 1$, we have $\frac{n-1}{a_{n+1}} > n-1$ and by AM-GM, $\frac{1}{a_{n+1}} + a_{n+1} > 2$. Thus, $a_1 + \dots + a_{n+1} > (n-1)+2 = n+1$. In both cases, the inequality holds for $n+1$, completing the induction.",,
2015a6,"Let $n$ be a fixed integer with $n \geqslant 2$. We say that two polynomials $P$ and $Q$ with real coefficients are block-similar if for each $i \in\{1,2, \ldots, n\}$ the sequences

$$
\begin{aligned}
& P(2015 i), P(2015 i-1), \ldots, P(2015 i-2014) \quad \text { and } \\
& Q(2015 i), Q(2015 i-1), \ldots, Q(2015 i-2014)
\end{aligned}
$$

are permutations of each other.\\
(a) Prove that there exist distinct block-similar polynomials of degree $n+1$.\\
(b) Prove that there do not exist distinct block-similar polynomials of degree $n$.","For convenience, we set $k=2015=2 \ell+1$.

Part (a). Consider the following polynomials of degree $n+1$ :

$$
P(x)=\prod_{i=0}^{n}(x-i k) \quad \text { and } \quad Q(x)=\prod_{i=0}^{n}(x-i k-1)
$$

Since $Q(x)=P(x-1)$ and $P(0)=P(k)=P(2 k)=\cdots=P(n k)$, these polynomials are block-similar (and distinct).

Part (b). For every polynomial $F(x)$ and every nonnegative integer $m$, define $\Sigma_{F}(m)=$ $\sum_{i=1}^{m} F(i)$; in particular, $\Sigma_{F}(0)=0$. It is well-known that for every nonnegative integer $d$ the sum $\sum_{i=1}^{m} i^{d}$ is a polynomial in $m$ of degree $d+1$. Thus $\Sigma_{F}$ may also be regarded as a real polynomial of degree $\operatorname{deg} F+1$ (with the exception that if $F=0$, then $\Sigma_{F}=0$ as well). This allows us to consider the values of $\Sigma_{F}$ at all real points (where the initial definition does not apply).

Assume for the sake of contradiction that there exist two distinct block-similar polynomials $P(x)$ and $Q(x)$ of degree $n$. Then both polynomials $\Sigma_{P-Q}(x)$ and $\Sigma_{P^{2}-Q^{2}}(x)$ have roots at the points $0, k, 2 k, \ldots, n k$. This motivates the following lemma, where we use the special polynomial

$$
T(x)=\prod_{i=0}^{n}(x-i k)
$$

Lemma. Assume that $F(x)$ is a nonzero polynomial such that $0, k, 2 k, \ldots, n k$ are among the roots of the polynomial $\Sigma_{F}(x)$. Then $\operatorname{deg} F \geqslant n$, and there exists a polynomial $G(x)$ such that $\operatorname{deg} G=\operatorname{deg} F-n$ and $F(x)=T(x) G(x)-T(x-1) G(x-1)$.\\
Proof. If $\operatorname{deg} F<n$, then $\Sigma_{F}(x)$ has at least $n+1$ roots, while its degree is less than $n+1$. Therefore, $\Sigma_{F}(x)=0$ and hence $F(x)=0$, which is impossible. Thus $\operatorname{deg} F \geqslant n$.

The lemma condition yields that $\Sigma_{F}(x)=T(x) G(x)$ for some polynomial $G(x)$ such that $\operatorname{deg} G=\operatorname{deg} \Sigma_{F}-(n+1)=\operatorname{deg} F-n$.

Now, let us define $F_{1}(x)=T(x) G(x)-T(x-1) G(x-1)$. Then for every positive integer $n$ we have

$$
\Sigma_{F_{1}}(n)=\sum_{i=1}^{n}(T(x) G(x)-T(x-1) G(x-1))=T(n) G(n)-T(0) G(0)=T(n) G(n)=\Sigma_{F}(n)
$$

so the polynomial $\Sigma_{F-F_{1}}(x)=\Sigma_{F}(x)-\Sigma_{F_{1}}(x)$ has infinitely many roots. This means that this polynomial is zero, which in turn yields $F(x)=F_{1}(x)$, as required.

First, we apply the lemma to the nonzero polynomial $R_{1}(x)=P(x)-Q(x)$. Since the degree of $R_{1}(x)$ is at most $n$, we conclude that it is exactly $n$. Moreover, $R_{1}(x)=\alpha \cdot(T(x)-T(x-1))$ for some nonzero constant $\alpha$.

Our next aim is to prove that the polynomial $S(x)=P(x)+Q(x)$ is constant. Assume the contrary. Then, notice that the polynomial $R_{2}(x)=P(x)^{2}-Q(x)^{2}=R_{1}(x) S(x)$ is also nonzero and satisfies the lemma condition. Since $n<\operatorname{deg} R_{1}+\operatorname{deg} S=\operatorname{deg} R_{2} \leqslant 2 n$, the lemma yields

$$
R_{2}(x)=T(x) G(x)-T(x-1) G(x-1)
$$

with some polynomial $G(x)$ with $0<\operatorname{deg} G \leqslant n$.\\
Since the polynomial $R_{1}(x)=\alpha(T(x)-T(x-1))$ divides the polynomial

$$
R_{2}(x)=T(x)(G(x)-G(x-1))+G(x-1)(T(x)-T(x-1)),
$$

we get $R_{1}(x) \mid T(x)(G(x)-G(x-1))$. On the other hand,

$$
\operatorname{gcd}\left(T(x), R_{1}(x)\right)=\operatorname{gcd}(T(x), T(x)-T(x-1))=\operatorname{gcd}(T(x), T(x-1))=1
$$

since both $T(x)$ and $T(x-1)$ are the products of linear polynomials, and their roots are distinct. Thus $R_{1}(x) \mid G(x)-G(x-1)$. However, this is impossible since $G(x)-G(x-1)$ is a nonzero polynomial of degree less than $n=\operatorname{deg} R_{1}$.

Thus, our assumption is wrong, and $S(x)$ is a constant polynomial, say $S(x)=\beta$. Notice that the polynomials $(2 P(x)-\beta) / \alpha$ and $(2 Q(x)-\beta) / \alpha$ are also block-similar and distinct. So we may replace the initial polynomials by these ones, thus obtaining two block-similar polynomials $P(x)$ and $Q(x)$ with $P(x)=-Q(x)=T(x)-T(x-1)$. It remains to show that this is impossible.

For every $i=1,2 \ldots, n$, the values $T(i k-k+1)$ and $T(i k-1)$ have the same sign. This means that the values $P(i k-k+1)=T(i k-k+1)$ and $P(i k)=-T(i k-1)$ have opposite signs, so $P(x)$ has a root in each of the $n$ segments $[i k-k+1, i k]$. Since $\operatorname{deg} P=n$, it must have exactly one root in each of them.

Thus, the sequence $P(1), P(2), \ldots, P(k)$ should change sign exactly once. On the other hand, since $P(x)$ and $-P(x)$ are block-similar, this sequence must have as many positive terms as negative ones. Since $k=2 \ell+1$ is odd, this shows that the middle term of the sequence above must be zero, so $P(\ell+1)=0$, or $T(\ell+1)=T(\ell)$. However, this is not true since

$$
|T(\ell+1)|=|\ell+1| \cdot|\ell| \cdot \prod_{i=2}^{n}|\ell+1-i k|<|\ell| \cdot|\ell+1| \cdot \prod_{i=2}^{n}|\ell-i k|=|T(\ell)|,
$$

where the strict inequality holds because $n \geqslant 2$. We come to the final contradiction.\\
Comment 1. In the solution above, we used the fact that $k>1$ is odd. One can modify the arguments of the last part in order to work for every (not necessarily odd) sufficiently large value of $k$; namely, when $k$ is even, one may show that the sequence $P(1), P(2), \ldots, P(k)$ has different numbers of positive and negative terms.

On the other hand, the problem statement with $k$ replaced by 2 is false, since the polynomials $P(x)=T(x)-T(x-1)$ and $Q(x)=T(x-1)-T(x)$ are block-similar in this case, due to the fact that $P(2 i-1)=-P(2 i)=Q(2 i)=-Q(2 i-1)=T(2 i-1)$ for all $i=1,2, \ldots, n$. Thus, every complete solution should use the relation $k>2$.

One may easily see that the condition $n \geqslant 2$ is also substantial, since the polynomials $x$ and $k+1-x$ become block-similar if we set $n=1$.

It is easily seen from the solution that the result still holds if we assume that the polynomials have degree at most $n$.",4,Prove that there exist distinct block-similar polynomials of degree $n+1$.,"Let $k=2015$. Consider the polynomials $P(x)=\prod_{i=0}^{n}(x-i k)$ and $Q(x)=P(x-1)$. They are distinct and have degree $n+1$. For any $i \in \{1, \ldots, n\}$, the set of values for $P(x)$ in the $i$-th block is $\{P(ik), P(ik-1), \ldots, P(ik-k+1)\}$. Since $P(ik)=0$, this set is $\{0, P(ik-1), \ldots, P(ik-k+1)\}$. The set of values for $Q(x)$ is $\{Q(ik), \ldots, Q(ik-k+1)\} = \{P(ik-1), \ldots, P(ik-k)\}$. Since $P((i-1)k)=0$, this set is $\{P(ik-1), \ldots, P(ik-k+1), 0\}$. The two sets of values are identical, so the polynomials are block-similar.","Let $T(x)=\prod_{i=0}^{n}(x-i k)$ where $k=2015$. For a non-zero polynomial $F(x)$, let $\Sigma_F(x)$ be the unique polynomial of degree $\deg F+1$ such that $\Sigma_F(m)=\sum_{j=1}^m F(j)$ for all integers $m \ge 1$. If $\Sigma_F(x)$ has roots $0, k, 2k, \ldots, nk$, prove that $\deg F \ge n$ and there exists a polynomial $G(x)$ with $\deg G = \deg F - n$ such that $F(x) = T(x)G(x) - T(x-1)G(x-1)$.","The polynomial $\Sigma_F(x)$ has $\deg F + 1$ degree. Since it has at least $n+1$ roots ($0, k, \ldots, nk$), we must have $\deg F+1 \ge n+1$, so $\deg F \ge n$. This implies we can write $\Sigma_F(x) = T(x)G(x)$ for some polynomial $G(x)$. Comparing degrees gives $\deg F + 1 = (n+1) + \deg G$, so $\deg G = \deg F - n$. Let $F_1(x) = T(x)G(x) - T(x-1)G(x-1)$. The sum polynomial $\Sigma_{F_1}(m) = \sum_{j=1}^m F_1(j)$ is a telescoping sum equal to $T(m)G(m) - T(0)G(0)$. As $T(0)=0$, $\Sigma_{F_1}(m) = T(m)G(m) = \Sigma_F(m)$. Since $\Sigma_{F-F_1}(m)=0$ for infinitely many integers $m$, the polynomial $\Sigma_{F-F_1}$ must be zero, which implies $F(x)=F_1(x)$.","Let $P(x)$ and $Q(x)$ be distinct block-similar polynomials of degree $n$. Show that $P(x)+Q(x)$ is a constant and $P(x)-Q(x)=\alpha(T(x)-T(x-1))$ for a non-zero constant $\alpha$, where $T(x)=\prod_{i=0}^{n}(x-i k)$.","Let $R_1(x)=P(x)-Q(x)$ and $R_2(x)=P(x)^2-Q(x)^2$. Block similarity implies that $\Sigma_{R_1}$ and $\Sigma_{R_2}$ have roots at $0, k, \ldots, nk$. Since $\deg R_1 \le n$ and $R_1 \ne 0$, by the lemma in sub-problem 2, we must have $\deg R_1=n$ and $R_1(x)=\alpha(T(x)-T(x-1))$ for some constant $\alpha \ne 0$. Let $S(x)=P(x)+Q(x)$. Assume $S(x)$ is not constant. Then $R_2(x)=R_1(x)S(x)$ is non-zero. Applying the lemma to $R_2$ gives $R_2(x)=T(x)G(x)-T(x-1)G(x-1)$ with $\deg G>0$. Since $R_1$ divides $R_2$ and $\gcd(R_1(x), T(x))=\gcd(\alpha(T(x)-T(x-1)), T(x))=1$, we must have $R_1(x) | (G(x)-G(x-1))$. This is a contradiction as $\deg R_1=n$ while $\deg(G(x)-G(x-1)) < \deg G = \deg R_2 - n = \deg S \le n$. Thus, $S(x)$ must be a constant.",Prove that there do not exist distinct block-similar polynomials of degree $n$.,"Assume such polynomials $P, Q$ exist. From sub-problem 3, we can assume without loss of generality that $P(x) = T(x)-T(x-1)$ and $Q(x)=-P(x)$. For these to be block-similar, the multiset of values $\{P(1), \ldots, P(k)\}$ must be the same as $\{-P(1), \ldots, -P(k)\}$. Since $k=2015$ is odd, this implies that some $P(m)=0$ for $m \in \{1, \ldots, k\}$. The polynomial $P(x)$ of degree $n$ has exactly one root in each of the $n$ intervals $[(i-1)k+1, ik]$. Thus, the sequence $P(1), \ldots, P(k)$ changes sign exactly once. For the number of positive and negative terms to be equal, the integer root must be at the center, $m=(k+1)/2$. So $P((k+1)/2)=0$, which implies $T((k+1)/2)=T((k-1)/2)$. Let $\ell=(k-1)/2$. This is $T(\ell+1)=T(\ell)$. However, a direct comparison for $n \ge 2$ shows $|T(\ell+1)| = |\prod_{i=0}^n(\ell+1-ik)| < |\prod_{i=0}^n(\ell-ik)| = |T(\ell)|$, which is a contradiction."
2015c1,"In Lineland there are $n \geqslant 1$ towns, arranged along a road running from left to right. Each town has a left bulldozer (put to the left of the town and facing left) and a right bulldozer (put to the right of the town and facing right). The sizes of the $2 n$ bulldozers are distinct. Every time when a right and a left bulldozer confront each other, the larger bulldozer pushes the smaller one off the road. On the other hand, the bulldozers are quite unprotected at their rears; so, if a bulldozer reaches the rear-end of another one, the first one pushes the second one off the road, regardless of their sizes.

Let $A$ and $B$ be two towns, with $B$ being to the right of $A$. We say that town $A$ can sweep town $B$ away if the right bulldozer of $A$ can move over to $B$ pushing off all bulldozers it meets. Similarly, $B$ can sweep $A$ away if the left bulldozer of $B$ can move to $A$ pushing off all bulldozers of all towns on its way.

Prove that there is exactly one town which cannot be swept away by any other one.","Let $T_{1}, T_{2}, \ldots, T_{n}$ be the towns enumerated from left to right. Observe first that, if town $T_{i}$ can sweep away town $T_{j}$, then $T_{i}$ also can sweep away every town located between $T_{i}$ and $T_{j}$.

We prove the problem statement by strong induction on $n$. The base case $n=1$ is trivial.\\
For the induction step, we first observe that the left bulldozer in $T_{1}$ and the right bulldozer in $T_{n}$ are completely useless, so we may forget them forever. Among the other $2 n-2$ bulldozers, we choose the largest one. Without loss of generality, it is the right bulldozer of some town $T_{k}$ with $k<n$.

Surely, with this large bulldozer $T_{k}$ can sweep away all the towns to the right of it. Moreover, none of these towns can sweep $T_{k}$ away; so they also cannot sweep away any town to the left of $T_{k}$. Thus, if we remove the towns $T_{k+1}, T_{k+2}, \ldots, T_{n}$, none of the remaining towns would change its status of being (un)sweepable away by the others.

Applying the induction hypothesis to the remaining towns, we find a unique town among $T_{1}, T_{2}, \ldots, T_{k}$ which cannot be swept away. By the above reasons, it is also the unique such town in the initial situation. Thus the induction step is established.",2,"Let the towns be $T_1, \\ldots, T_n$ from left to right. Consider the set of 'internal' bulldozers, which excludes the left bulldozer of $T_1$ and the right bulldozer of $T_n$. Let the largest bulldozer in this set belong to town $T_k$. Prove that if this bulldozer is the right one, $R_k$, then $T_k$ sweeps all towns to its right, and no town to the right of $T_k$ can sweep $T_k$ or any town to its left. A symmetric statement holds if the largest bulldozer is the left one, $L_k$.","Assume the largest internal bulldozer is $R_k$, the right bulldozer of town $T_k$ (so $k<n$). As $R_k$ moves right, it confronts left bulldozers $L_j$ for $j > k$. Since $R_k$ is the largest among all internal bulldozers, it is larger than any $L_j$ (for $j>1$) and pushes them off. $R_k$ also hits the rear of any right bulldozers $R_j$ (for $k<j<n$), pushing them off. Thus, $T_k$ sweeps all towns to its right. For any town $T_j$ with $j>k$ to sweep $T_k$, its bulldozer $L_j$ must confront $R_k$. As $R_k$ is larger than $L_j$, $L_j$ is pushed off, so $T_j$ cannot sweep $T_k$ or any town to the left of $T_k$. The case for $L_k$ being the largest is symmetric.","In Lineland there are $n \\geqslant 1$ towns, arranged along a road running from left to right. Each town has a left bulldozer and a right bulldozer. The sizes of the $2 n$ bulldozers are distinct. When a right and a left bulldozer confront each other, the larger pushes the smaller one off the road. If a bulldozer reaches the rear-end of another one, the first one pushes the second one off the road, regardless of their sizes. Town $A$ can sweep town $B$ away if the right bulldozer of $A$ can move to $B$ pushing off all bulldozers it meets. Similarly, $B$ can sweep $A$ away if the left bulldozer of $B$ can move to $A$. Prove that there is exactly one town which cannot be swept away by any other one.","We use strong induction on the number of towns, $n$. The base case $n=1$ is trivial. Assume the claim holds for any configuration with fewer than $n$ towns. Consider the largest internal bulldozer (excluding $L_1$ and $R_n$). Without loss of generality, let it be $R_k$, the right bulldozer of town $T_k$. By Sub-problem 1, $T_k$ sweeps all towns $T_{k+1}, \\ldots, T_n$, and none of these towns can sweep any town in $\{T_1, \\ldots, T_k\}$. This means the unique unsweepable town must be in the set $\{T_1, \\ldots, T_k\}$. The interactions between these $k$ towns are unaffected by the towns to the right. By the induction hypothesis, there is a unique town $T_u$ in $\{T_1, \\ldots, T_k\}$ which cannot be swept away by another town in that set. Since no town from $\{T_{k+1}, \\ldots, T_n\}$ can sweep $T_u$ either, $T_u$ is the unique unsweepable town in the original configuration of $n$ towns.",,,,
2015c5,"Consider an infinite sequence $a_{1}, a_{2}, \ldots$ of positive integers with $a_{i} \leqslant 2015$ for all $i \geqslant 1$. Suppose that for any two distinct indices $i$ and $j$ we have $i+a_{i} \neq j+a_{j}$.

Prove that there exist two positive integers $b$ and $N$ such that

$$
\left|\sum_{i=m+1}^{n}\left(a_{i}-b\right)\right| \leqslant 1007^{2}
$$

whenever $n>m \geqslant N$.","We visualize the set of positive integers as a sequence of points. For each $n$ we draw an arrow emerging from $n$ that points to $n+a_{n}$; so the length of this arrow is $a_{n}$. Due to the condition that $m+a_{m} \neq n+a_{n}$ for $m \neq n$, each positive integer receives at most one arrow. There are some positive integers, such as 1 , that receive no arrows; these will be referred to as starting points in the sequel. When one starts at any of the starting points and keeps following the arrows, one is led to an infinite path, called its ray, that visits a strictly increasing sequence of positive integers. Since the length of any arrow is at most 2015, such a ray, say with starting point $s$, meets every interval of the form $[n, n+2014]$ with $n \geqslant s$ at least once.

Suppose for the sake of contradiction that there would be at least 2016 starting points. Then we could take an integer $n$ that is larger than the first 2016 starting points. But now the interval $[n, n+2014]$ must be met by at least 2016 rays in distinct points, which is absurd. We have thereby shown that the number $b$ of starting points satisfies $1 \leqslant b \leqslant 2015$. Let $N$ denote any integer that is larger than all starting points. We contend that $b$ and $N$ are as required.

To see this, let any two integers $m$ and $n$ with $n>m \geqslant N$ be given. The sum $\sum_{i=m+1}^{n} a_{i}$ gives the total length of the arrows emerging from $m+1, \ldots, n$. Taken together, these arrows form $b$ subpaths of our rays, some of which may be empty. Now on each ray we look at the first number that is larger than $m$; let $x_{1}, \ldots, x_{b}$ denote these numbers, and let $y_{1}, \ldots, y_{b}$ enumerate in corresponding order the numbers defined similarly with respect to $n$. Then the list of differences $y_{1}-x_{1}, \ldots, y_{b}-x_{b}$ consists of the lengths of these paths and possibly some zeros corresponding to empty paths. Consequently, we obtain

$$
\sum_{i=m+1}^{n} a_{i}=\sum_{j=1}^{b}\left(y_{j}-x_{j}\right),
$$

whence

$$
\sum_{i=m+1}^{n}\left(a_{i}-b\right)=\sum_{j=1}^{b}\left(y_{j}-n\right)-\sum_{j=1}^{b}\left(x_{j}-m\right) .
$$

Now each of the $b$ rays meets the interval $[m+1, m+2015]$ at some point and thus $x_{1}-$ $m, \ldots, x_{b}-m$ are $b$ distinct members of the set $\{1,2, \ldots, 2015\}$. Moreover, since $m+1$ is not a starting point, it must belong to some ray; so 1 has to appear among these numbers, wherefore

$$
1+\sum_{j=1}^{b-1}(j+1) \leqslant \sum_{j=1}^{b}\left(x_{j}-m\right) \leqslant 1+\sum_{j=1}^{b-1}(2016-b+j) .
$$

The same argument applied to $n$ and $y_{1}, \ldots, y_{b}$ yields

$$
1+\sum_{j=1}^{b-1}(j+1) \leqslant \sum_{j=1}^{b}\left(y_{j}-n\right) \leqslant 1+\sum_{j=1}^{b-1}(2016-b+j) .
$$

So altogether we get

$$
\begin{aligned}
\left|\sum_{i=m+1}^{n}\left(a_{i}-b\right)\right| & \leqslant \sum_{j=1}^{b-1}((2016-b+j)-(j+1))=(b-1)(2015-b) \\
& \leqslant\left(\frac{(b-1)+(2015-b)}{2}\right)^{2}=1007^{2},
\end{aligned}
$$

as desired.\\",3,"Define a graph structure on the positive integers $\mathbb{Z}^+$ where directed edges are given by $i \to i+a_i$. Prove that this structure partitions $\mathbb{Z}^+$ into a finite number of disjoint paths (rays), and that the number of rays, $b$, satisfies $1 \le b \le 2015$.","Consider a directed graph on $\mathbb{Z}^+$ with edges $i \to i+a_i$. The condition $i+a_i \neq j+a_j$ for $i \neq j$ implies each integer has an in-degree of at most 1. Vertices with in-degree 0 are starting points. Since $a_i \ge 1$, following edges from any vertex generates a strictly increasing sequence, a ray. The set of all vertices $\mathbb{Z}^+$ is thus partitioned into a set of disjoint rays. Let $b$ be the number of rays. If $b \ge 2016$, let $n$ be an integer larger than all starting points. Each of the $b$ rays must have a member in the interval $[n, n+2014]$, as step lengths $a_i \le 2015$. This implies at least 2016 distinct integers must exist in an interval containing 2015 integers, a contradiction. Thus, $b \le 2015$. Since $j+a_j > 1$ for all $j$, the integer 1 must be a starting point, so $b \ge 1$.","Let $b$ be the number of rays and $N$ be an integer larger than all starting points. For any $n > m \ge N$, show that $\sum_{i=m+1}^{n} (a_i - b) = \sum_{j=1}^{b}(y_j - n) - \sum_{j=1}^{b}(x_j - m)$, where for each ray $j \in \{1, \dots, b\}$, $x_j$ is its first integer greater than $m$, and $y_j$ is its first integer greater than $n$.","The sum $\sum_{i=m+1}^{n} a_i$ is the sum of edge lengths for all vertices from $m+1$ to $n$. Since $m \ge N$, all these vertices belong to one of the $b$ rays. The sum of the lengths of arrows on ray $j$ with starting points in $\{m+1, ..., n\}$ is $y_j-x_j$. Summing over all $b$ rays gives $\sum_{i=m+1}^{n} a_i = \sum_{j=1}^{b} (y_j - x_j)$. Then, $\sum_{i=m+1}^{n} (a_i - b) = \sum_{i=m+1}^{n} a_i - b(n-m) = \sum_{j=1}^{b} (y_j - x_j) - b(n-m)$. Rearranging gives $\sum_{j=1}^{b} (y_j - n) - \sum_{j=1}^{b} (x_j - m)$.",Prove that there exist two positive integers $b$ and $N$ such that $\left|\sum_{i=m+1}^{n}\left(a_{i}-b\right)\right| \leqslant 1007^{2}$ whenever $n>m \geqslant N$.,"From Sub-problem 1, let $b$ be the number of rays ($1 \le b \le 2015$) and $N$ be an integer larger than all starting points. For $n > m \ge N$, the sum is given by $\sum_{j=1}^{b}(y_j - n) - \sum_{j=1}^{b}(x_j - m)$ from Sub-problem 2. Let's analyze the term $X_m = \sum_{j=1}^{b}(x_j - m)$. The set of values $\{x_j - m\}_{j=1}^b$ are $b$ distinct members of $\{1, 2, \ldots, 2015\}$. Since $m \ge N$, $m+1$ is not a starting point and belongs to some ray, so $x_k = m+1$ for some $k$, which implies $1$ is in the set. Thus, the minimum value of $X_m$ is $L_b=1+\sum_{j=1}^{b-1}(j+1)$ and the maximum value is $U_b=1+\sum_{j=1}^{b-1}(2016-b+j)$. The same bounds apply to $Y_n = \sum_{j=1}^{b}(y_j-n)$. The value $|\sum_{i=m+1}^{n}(a_i - b)| = |Y_n-X_m|$ is bounded by the range of possible values, i.e., $U_b - L_b = (b-1)(2015-b)$. By AM-GM, $(b-1)(2015-b) \le \left(\frac{(b-1)+(2015-b)}{2}\right)^2 = 1007^2$.",,
2015c6,Let $S$ be a nonempty set of positive integers. We say that a positive integer $n$ is clean if it has a unique representation as a sum of an odd number of distinct elements from $S$. Prove that there exist infinitely many positive integers that are not clean.,"Define an odd (respectively, even) representation of $n$ to be a representation of $n$ as a sum of an odd (respectively, even) number of distinct elements of $S$. Let $\mathbb{Z}_{>0}$ denote the set of all positive integers.

Suppose, to the contrary, that there exist only finitely many positive integers that are not clean. Therefore, there exists a positive integer $N$ such that every integer $n>N$ has exactly one odd representation.

Clearly, $S$ is infinite. We now claim the following properties of odd and even representations.\\
Property 1. Any positive integer $n$ has at most one odd and at most one even representation. Proof. We first show that every integer $n$ has at most one even representation. Since $S$ is infinite, there exists $x \in S$ such that $x>\max \{n, N\}$. Then, the number $n+x$ must be clean, and $x$ does not appear in any even representation of $n$. If $n$ has more than one even representation, then we obtain two distinct odd representations of $n+x$ by adding $x$ to the even representations of $n$, which is impossible. Therefore, $n$ can have at most one even representation.

Similarly, there exist two distinct elements $y, z \in S$ such that $y, z>\max \{n, N\}$. If $n$ has more than one odd representation, then we obtain two distinct odd representations of $n+y+z$ by adding $y$ and $z$ to the odd representations of $n$. This is again a contradiction.

Property 2. Fix $s \in S$. Suppose that a number $n>N$ has no even representation. Then $n+2$ as has an even representation containing $s$ for all integers $a \geqslant 1$.\\
Proof. It is sufficient to prove the following statement: If $n$ has no even representation without $s$, then $n+2 s$ has an even representation containing $s$ (and hence no even representation without $s$ by Property 1).

Notice that the odd representation of $n+s$ does not contain $s$; otherwise, we have an even representation of $n$ without $s$. Then, adding $s$ to this odd representation of $n+s$, we get that $n+2 s$ has an even representation containing $s$, as desired.

Property 3. Every sufficiently large integer has an even representation.\\
Proof. Fix any $s \in S$, and let $r$ be an arbitrary element in $\{1,2, \ldots, 2 s\}$. Then, Property 2 implies that the set $Z_{r}=\{r+2 a s: a \geqslant 0\}$ contains at most one number exceeding $N$ with no even representation. Therefore, $Z_{r}$ contains finitely many positive integers with no even representation, and so does $\mathbb{Z}_{>0}=\bigcup_{r=1}^{2 s} Z_{r}$.

In view of Properties 1 and 3, we may assume that $N$ is chosen such that every $n>N$ has exactly one odd and exactly one even representation. In particular, each element $s>N$ of $S$ has an even representation.

Property 4. For any $s, t \in S$ with $N<s<t$, the even representation of $t$ contains $s$.\\
Proof. Suppose the contrary. Then, $s+t$ has at least two odd representations: one obtained by adding $s$ to the even representation of $t$ and one obtained by adding $t$ to the even representation of $s$. Since the latter does not contain $s$, these two odd representations of $s+t$ are distinct, a contradiction.

Let $s_{1}<s_{2}<\cdots$ be all the elements of $S$, and set $\sigma_{n}=\sum_{i=1}^{n} s_{i}$ for each nonnegative integer $n$. Fix an integer $k$ such that $s_{k}>N$. Then, Property 4 implies that for every $i>k$ the even representation of $s_{i}$ contains all the numbers $s_{k}, s_{k+1}, \ldots, s_{i-1}$. Therefore,


\begin{equation*}
s_{i}=s_{k}+s_{k+1}+\cdots+s_{i-1}+R_{i}=\sigma_{i-1}-\sigma_{k-1}+R_{i}, \tag{1}
\end{equation*}


where $R_{i}$ is a sum of some of $s_{1}, \ldots, s_{k-1}$. In particular, $0 \leqslant R_{i} \leqslant s_{1}+\cdots+s_{k-1}=\sigma_{k-1}$.

Let $j_{0}$ be an integer satisfying $j_{0}>k$ and $\sigma_{j_{0}}>2 \sigma_{k-1}$. Then (1) shows that, for every $j>j_{0}$,


\begin{equation*}
s_{j+1} \geqslant \sigma_{j}-\sigma_{k-1}>\sigma_{j} / 2 . \tag{2}
\end{equation*}


Next, let $p>j_{0}$ be an index such that $R_{p}=\min _{i>j_{0}} R_{i}$. Then,

$$
s_{p+1}=s_{k}+s_{k+1}+\cdots+s_{p}+R_{p+1}=\left(s_{p}-R_{p}\right)+s_{p}+R_{p+1} \geqslant 2 s_{p} .
$$

Therefore, there is no element of $S$ larger than $s_{p}$ but smaller than $2 s_{p}$. It follows that the even representation $\tau$ of $2 s_{p}$ does not contain any element larger than $s_{p}$. On the other hand, inequality (2) yields $2 s_{p}>s_{1}+\cdots+s_{p-1}$, so $\tau$ must contain a term larger than $s_{p-1}$. Thus, it must contain $s_{p}$. After removing $s_{p}$ from $\tau$, we have that $s_{p}$ has an odd representation not containing $s_{p}$, which contradicts Property 1 since $s_{p}$ itself also forms an odd representation of $s_{p}$.",4,Assume there exists an integer $N$ such that every integer $n>N$ is clean. Prove that any positive integer $n$ has at most one odd representation and at most one even representation as a sum of distinct elements from $S$.,"Assume for contradiction that some integer $n$ has two distinct even representations. Since $S$ must be infinite (otherwise the set of representable numbers is finite), we can choose an element $x \in S$ such that $x > \\max\\{n, N\\}$. Adding $x$ to each of the two even representations of $n$ yields two distinct odd representations of $n+x$. But $n+x > N$, so it must be clean, a contradiction. Thus, any $n$ has at most one even representation. Similarly, to prove uniqueness for odd representations, assume $n$ has two distinct odd representations. Choose two distinct elements $y, z \\in S$ such that $y, z > \\max\\{n, N\\}$. Adding $y+z$ to each odd representation of $n$ yields two distinct odd representations of $n+y+z$. This contradicts that $n+y+z > N$ is clean. Thus, any $n$ has at most one odd representation.","Assume that for some $N$, every integer $n > N$ is clean. Prove that every sufficiently large integer also has an even representation.","By the first sub-problem, any integer has at most one even representation. We now show existence for sufficiently large integers. Fix $s \\in S$. Suppose $n > N$ has no even representation. The unique odd representation of $n+s$ cannot contain $s$, because if it did, removing $s$ would yield an even representation for $n$. Adding $s$ to this odd representation of $n+s$ gives an even representation for $n+2s$. This implies that for any arithmetic progression $A_r = \\{r+2as : a \\ge 0\\}$ (where $r \\in \\{1, 2, \\dots, 2s\\}$), there can be at most one element greater than $N$ with no even representation. Since the set of positive integers is a finite union of such progressions $A_r$, there can only be finitely many integers with no even representation.","Assume that for a sufficiently large integer $N$, every integer $n > N$ has exactly one odd and one even representation. Prove that for any two elements $s, t \\in S$ with $N < s < t$, the even representation of $t$ must contain $s$.","Let $s, t \\in S$ with $N < s < t$. Let $E_x$ denote the set of elements in the unique even representation of an integer $x$. Consider the integer $n = s+t$. Since $n > N$, it has a unique odd representation. We can form two potential odd representations for $s+t$: $O_1 = \\{s\\} \\cup E_t$ and $O_2 = \\{t\\} \\cup E_s$. By uniqueness, these must be the same set of elements. Suppose, for contradiction, that $s \notin E_t$. Then $s$ is an element of the representation $O_1$. However, $s$ cannot be an element of $O_2$, since $s \ne t$ and $s \notin E_s$ (as representations are of distinct elements). Since $s \\in O_1$ but $s \notin O_2$, the representations are distinct, which is a contradiction. Therefore, the assumption $s \notin E_t$ must be false, so the even representation of $t$ contains $s$.",Let $S$ be a nonempty set of positive integers. We say that a positive integer $n$ is clean if it has a unique representation as a sum of an odd number of distinct elements from $S$. Prove that there exist infinitely many positive integers that are not clean.,"Assume for contradiction that only finitely many integers are not clean. Then there exists an $N$ such that for any $n>N$, $n$ is clean. By the preceding sub-problems, we can choose $N$ large enough so that every $n>N$ has exactly one odd and one even representation, and for any $s, t \\in S$ with $N<s<t$, the even representation of $t$ contains $s$. Let $s_k$ be the smallest element of $S$ greater than $N$. Then for any $i > k$, the even representation of $s_i$ must contain all of $s_k, s_{k+1}, \\dots, s_{i-1}$. This implies $s_i = \\sum_{j=k}^{i-1} s_j + R_i$, where $R_i$ is a sum of elements from $\\{s_1, \\dots, s_{k-1}\\}$. This recurrence-like relation implies that the elements of $S$ grow very rapidly. For a sufficiently large $p>k$, we have $s_{p+1} > 2s_p$. Consider the number $2s_p > N$; it must have a unique even representation. This representation cannot contain any $s_j$ with $j>p$ since $s_{p+1} > 2s_p$. Furthermore, for large $p$, $2s_p > \\sum_{j=1}^{p-1} s_j$, so the representation must contain $s_p$. Removing $s_p$ from this representation gives an odd representation for $s_p$. But $\\{s_p\\}$ itself is also an odd representation. These two representations are distinct because the former is a sum of elements strictly smaller than $s_p$. This contradicts that $s_p > N$ is clean."
2015c7,"In a company of people some pairs are enemies. A group of people is called unsociable if the number of members in the group is odd and at least 3, and it is possible to arrange all its members around a round table so that every two neighbors are enemies. Given that there are at most 2015 unsociable groups, prove that it is possible to partition the company into 11 parts so that no two enemies are in the same part.","Let $G=(V, E)$ be a graph where $V$ is the set of people in the company and $E$ is the set of the enemy pairs - the edges of the graph. In this language, partitioning into 11 disjoint enemy-free subsets means properly coloring the vertices of this graph with 11 colors.

We will prove the following more general statement.\\
Claim. Let $G$ be a graph with chromatic number $k \geqslant 3$. Then $G$ contains at least $2^{k-1}-k$ unsociable groups.

Recall that the chromatic number of $G$ is the least $k$ such that a proper coloring


\begin{equation*}
V=V_{1} \sqcup \cdots \sqcup V_{k} \tag{1}
\end{equation*}


exists. In view of $2^{11}-12>2015$, the claim implies the problem statement.\\
Let $G$ be a graph with chromatic number $k$. We say that a proper coloring (1) of $G$ is leximinimal, if the $k$-tuple $\left(\left|V_{1}\right|,\left|V_{2}\right|, \ldots,\left|V_{k}\right|\right)$ is lexicographically minimal; in other words, the following conditions are satisfied: the number $n_{1}=\left|V_{1}\right|$ is minimal; the number $n_{2}=\left|V_{2}\right|$ is minimal, subject to the previously chosen value of $n_{1} ; \ldots$; the number $n_{k-1}=\left|V_{k-1}\right|$ is minimal, subject to the previously chosen values of $n_{1}, \ldots, n_{k-2}$.

The following lemma is the core of the proof.\\
Lemma 1. Suppose that $G=(V, E)$ is a graph with odd chromatic number $k \geqslant 3$, and let (1) be one of its leximinimal colorings. Then $G$ contains an odd cycle which visits all color classes $V_{1}, V_{2}, \ldots, V_{k}$.\\
Proof of Lemma 1. Let us call a cycle colorful if it visits all color classes.\\
Due to the definition of the chromatic number, $V_{1}$ is nonempty. Choose an arbitrary vertex $v \in V_{1}$. We construct a colorful odd cycle that has only one vertex in $V_{1}$, and this vertex is $v$.

We draw a subgraph of $G$ as follows. Place $v$ in the center, and arrange the sets $V_{2}, V_{3}, \ldots, V_{k}$ in counterclockwise circular order around it. For convenience, let $V_{k+1}=V_{2}$. We will draw arrows to add direction to some edges of $G$, and mark the vertices these arrows point to. First we draw arrows from $v$ to all its neighbors in $V_{2}$, and mark all those neighbors. If some vertex $u \in V_{i}$ with $i \in\{2,3, \ldots, k\}$ is already marked, we draw arrows from $u$ to all its neighbors in $V_{i+1}$ which are not marked yet, and we mark all of them. We proceed doing this as long as it is possible. The process of marking is exemplified in Figure 1.

Notice that by the rules of our process, in the final state, marked vertices in $V_{i}$ cannot have unmarked neighbors in $V_{i+1}$. Moreover, $v$ is connected to all marked vertices by directed paths.

Now move each marked vertex to the next color class in circular order (see an example in Figure 3). In view of the arguments above, the obtained coloring $V_{1} \sqcup W_{2} \sqcup \cdots \sqcup W_{k}$ is proper. Notice that $v$ has a neighbor $w \in W_{2}$, because otherwise

$$
\left(V_{1} \backslash\{v\}\right) \sqcup\left(W_{2} \cup\{v\}\right) \sqcup W_{3} \sqcup \cdots \sqcup W_{k}
$$

would be a proper coloring lexicographically smaller than (1). If $w$ was unmarked, i.e., $w$ was an element of $V_{2}$, then it would be marked at the beginning of the process and thus moved to $V_{3}$, which did not happen. Therefore, $w$ is marked and $w \in V_{k}$.\\


Since $w$ is marked, there exists a directed path from $v$ to $w$. This path moves through the sets $V_{2}, \ldots, V_{k}$ in circular order, so the number of edges in it is divisible by $k-1$ and thus even. Closing this path by the edge $w \rightarrow v$, we get a colorful odd cycle, as required.

Proof of the claim. Let us choose a leximinimal coloring (1) of $G$. For every set $C \subseteq\{1,2, \ldots, k\}$ such that $|C|$ is odd and greater than 1 , we will provide an odd cycle visiting exactly those color classes whose indices are listed in the set $C$. This property ensures that we have different cycles for different choices of $C$, and it proves the claim because there are $2^{k-1}-k$ choices for the set $C$.

Let $V_{C}=\bigcup_{c \in C} V_{c}$, and let $G_{C}$ be the induced subgraph of $G$ on the vertex set $V_{C}$. We also have the induced coloring of $V_{C}$ with $|C|$ colors; this coloring is of course proper. Notice further that the induced coloring is leximinimal: if we had a lexicographically smaller coloring $\left(W_{c}\right)_{c \in C}$ of $G_{C}$, then these classes, together the original color classes $V_{i}$ for $i \notin C$, would provide a proper coloring which is lexicographically smaller than (1). Hence Lemma 1, applied to the subgraph $G_{C}$ and its leximinimal coloring $\left(V_{c}\right)_{c \in C}$, provides an odd cycle that visits exactly those color classes that are listed in the set $C$.",4,"Let $G=(V, E)$ be a graph with an odd chromatic number $k \ge 3$. If we consider a 'leximinimal' proper $k$-coloring $V=V_{1} \sqcup \cdots \sqcup V_{k}$ (where the tuple of class sizes $(|V_1|, ..., |V_k|)$ is lexicographically minimal), prove that $G$ contains an odd cycle that visits every color class $V_1, ..., V_k$.","Let $v \in V_1$. Define a marking process: mark neighbors of $v$ in $V_2$, then their unmarked neighbors in $V_3$, and so on cyclically ($V_{k+1}=V_2$). The leximinimality of the coloring implies there must be a vertex $w \in V_k$ adjacent to $v$ that is reachable from $v$ by a directed path through marked vertices in $V_2, \dots, V_k$. If not, a lexicographically smaller coloring could be constructed. This path's length is a multiple of $k-1$ (an even number, as $k$ is odd). Appending the edge $(w,v)$ creates an odd cycle that visits all $k$ color classes.","Let $G$ be a graph with chromatic number $k$ and a leximinimal $k$-coloring $V=V_{1} \sqcup \cdots \sqcup V_{k}$. For any subset of color indices $C \subseteq \{1, ..., k\}$ with $|C|$ odd and $|C| \ge 3$, prove that there exists an odd cycle in $G$ that visits precisely the color classes $\{V_c\}_{c \in C}$.","Let $V_C = \bigcup_{c \in C} V_c$ and let $G_C$ be the subgraph of $G$ induced by $V_C$. The existing coloring restricted to $V_C$ is a proper $|C|$-coloring of $G_C$. This coloring must be leximinimal for $G_C$; otherwise, a lexicographically smaller coloring for $G_C$ would lead to a lexicographically smaller coloring for the entire graph $G$, a contradiction. Since $|C|$ is odd and $\ge 3$, we apply the result of Sub-problem 1 to $G_C$ to find an odd cycle visiting exactly its color classes, which are precisely $\{V_c\}_{c \in C}$.",Prove that a graph $G$ with chromatic number $k \ge 3$ contains at least $2^{k-1} - k$ distinct odd cycles of length at least 3.,"Consider a leximinimal $k$-coloring of $G$. From Sub-problem 2, for each subset of color indices $C \subseteq \{1, ..., k\}$ where $|C|$ is odd and $|C| \ge 3$, there is a corresponding odd cycle visiting exactly the color classes indexed by $C$. These cycles must be distinct, as they visit distinct sets of color classes. The number of such subsets $C$ is the total number of odd-sized subsets of a $k$-element set ($2^{k-1}$) minus the number of subsets of size 1 (which is $k$). Thus, there are at least $2^{k-1} - k$ distinct odd cycles.","In a company of people some pairs are enemies. A group of people is called unsociable if the number of members in the group is odd and at least 3, and it is possible to arrange all its members around a round table so that every two neighbors are enemies. Given that there are at most 2015 unsociable groups, prove that it is possible to partition the company into 11 parts so that no two enemies are in the same part.","Model the company as a graph $G$ where people are vertices and enemy pairs are edges. An 'unsociable group' corresponds to an odd cycle of length $\ge 3$. A partition into 11 enemy-free parts is a proper 11-coloring, meaning the chromatic number $\chi(G) \le 11$. Assume for contradiction that $\chi(G) \ge 12$. By Sub-problem 3, the number of odd cycles in $G$ is at least $2^{\chi(G)-1} - \chi(G)$. For $\chi(G)=12$, this bound is $2^{11} - 12 = 2048 - 12 = 2036$. Since $f(k)=2^{k-1}-k$ is increasing for $k \ge 2$, if $\chi(G) > 12$, the number of odd cycles would be even larger. This contradicts the given information that there are at most 2015 unsociable groups. Therefore, the assumption is false, and we must have $\chi(G) \le 11$."
2015g1,Let $A B C$ be an acute triangle with orthocenter $H$. Let $G$ be the point such that the quadrilateral $A B G H$ is a parallelogram. Let $I$ be the point on the line $G H$ such that $A C$ bisects $H I$. Suppose that the line $A C$ intersects the circumcircle of the triangle $G C I$ at $C$ and $J$. Prove that $I J=A H$.,"Since $H G \| A B$ and $B G \| A H$, we have $B G \perp B C$ and $C H \perp G H$. Therefore, the quadrilateral $B G C H$ is cyclic. Since $H$ is the orthocenter of the triangle $A B C$, we have $\angle H A C=90^{\circ}-\angle A C B=\angle C B H$. Using that $B G C H$ and $C G J I$ are cyclic quadrilaterals, we get

$$
\angle C J I=\angle C G H=\angle C B H=\angle H A C .
$$

Let $M$ be the intersection of $A C$ and $G H$, and let $D \neq A$ be the point on the line $A C$ such that $A H=H D$. Then $\angle M J I=\angle H A C=\angle M D H$.

Since $\angle M J I=\angle M D H, \angle I M J=\angle H M D$, and $I M=M H$, the triangles $I M J$ and $H M D$ are congruent, and thus $I J=H D=A H$.\\
\includegraphics[max width=\textwidth, center]{2025_04_30_c8781145b2af5b76793eg-44}

Comment. Instead of introducing the point $D$, one can complete the solution by using the law of sines in the triangles $I J M$ and $A M H$, yielding

$$
\frac{I J}{I M}=\frac{\sin \angle I M J}{\sin \angle M J I}=\frac{\sin \angle A M H}{\sin \angle H A M}=\frac{A H}{M H}=\frac{A H}{I M} .
$$",2,"Let $A B C$ be an acute triangle with orthocenter $H$, and let $G$ be a point such that $ABGH$ is a parallelogram. Let the line $AC$ intersect the circumcircle of $\triangle GCI$ at $C$ and $J$. Prove that $\angle CJI = \angle HAC$.","Since $ABGH$ is a parallelogram, we have $GH \| AB$ and $BG \| AH$. As $H$ is the orthocenter of $\triangle ABC$, we know $AH \perp BC$ and $CH \perp AB$. From these parallel and perpendicular relations, it follows that $BG \perp BC$ and $CH \perp GH$. This implies that $\angle GBC = 90^\circ$ and $\angle CHG = 90^\circ$, so the quadrilateral $BGCH$ is cyclic. By the problem statement, the quadrilateral $CGIJ$ is also cyclic. Using the property of angles subtended by the same arc in these cyclic quadrilaterals, we get $\angle CJI = \angle CGH = \angle CBH$. In $\triangle ABC$, both $\angle CBH$ and $\angle HAC$ are equal to $90^\circ - \angle C$. Therefore, $\angle CJI = \angle HAC$.",Let $A B C$ be an acute triangle with orthocenter $H$. Let $G$ be the point such that the quadrilateral $A B G H$ is a parallelogram. Let $I$ be the point on the line $G H$ such that $A C$ bisects $H I$. Suppose that the line $A C$ intersects the circumcircle of the triangle $G C I$ at $C$ and $J$. Prove that $I J=A H$.,"Let $M$ be the intersection of $AC$ and $GH$. Since $AC$ bisects $HI$, $M$ is the midpoint of $HI$, so $IM = MH$. From the previous sub-problem, we have $\angle CJI = \angle HAC$. As $A, J, M$ are all on the line $AC$, this can be written as $\angle MJI = \angle HAM$. Also, $\angle IMJ$ and $\angle AMH$ are vertically opposite angles, so $\angle IMJ = \angle AMH$. Now, consider $\triangle IMJ$ and $\triangle AMH$. By the Law of Sines in $\triangle IMJ$, we have $\frac{IJ}{\sin(\angle IMJ)} = \frac{IM}{\sin(\angle MJI)}$. In $\triangle AMH$, we have $\frac{AH}{\sin(\angle AMH)} = \frac{MH}{\sin(\angle HAM)}$. Using the equalities $IM=MH$, $\angle IMJ = \angle AMH$, and $\angle MJI = \angle HAM$, the expressions for $IJ$ and $AH$ become identical, which proves that $IJ=AH$.",,,,
2015g2,"Let $A B C$ be a triangle inscribed into a circle $\Omega$ with center $O$. A circle $\Gamma$ with center $A$ meets the side $B C$ at points $D$ and $E$ such that $D$ lies between $B$ and $E$. Moreover, let $F$ and $G$ be the common points of $\Gamma$ and $\Omega$. We assume that $F$ lies on the arc $A B$ of $\Omega$ not containing $C$, and $G$ lies on the arc $A C$ of $\Omega$ not containing $B$. The circumcircles of the triangles $B D F$ and $C E G$ meet the sides $A B$ and $A C$ again at $K$ and $L$, respectively. Suppose that the lines $F K$ and $G L$ are distinct and intersect at $X$. Prove that the points $A, X$, and $O$ are collinear.","It suffices to prove that the lines $F K$ and $G L$ are symmetric about $A O$. Now the segments $A F$ and $A G$, being chords of $\Omega$ with the same length, are clearly symmetric with respect to $A O$. Hence it is enough to show


\begin{equation*}
\angle K F A=\angle A G L . \tag{1}
\end{equation*}


Let us denote the circumcircles of $B D F$ and $C E G$ by $\omega_{B}$ and $\omega_{C}$, respectively. To prove (1), we start from

$$
\angle K F A=\angle D F G+\angle G F A-\angle D F K .
$$

In view of the circles $\omega_{B}, \Gamma$, and $\Omega$, this may be rewritten as

$$
\angle K F A=\angle C E G+\angle G B A-\angle D B K=\angle C E G-\angle C B G .
$$

Due to the circles $\omega_{C}$ and $\Omega$, we obtain $\angle K F A=\angle C L G-\angle C A G=\angle A G L$. Thereby the problem is solved.\\",2,Prove that $\angle K F A=\angle A G L$.,"We prove the equality by showing both angles are equal to the expression $\angle C E G - \angle C B G$. First, for $\angle KFA$, we use angle chasing to establish $\angle KFA = \angle DFG + \angle GFA - \angle DFK$. From circle $\Gamma$, $\angle DFG = \angle CEG$. From circle $\Omega$, $\angle GFA = \angle GBA$. From the circumcircle of $BDF$, $\angle DFK = \angle DBK$. Substituting these gives $\angle KFA = \angle CEG + \angle GBA - \angle DBK$, which simplifies to $\angle CEG - \angle CBG$. Second, for $\angle AGL$, since $A,L,C$ are collinear, the exterior angle theorem on $\triangle AGL$ gives $\angle AGL = \angle CLG - \angle CAG$. From the circumcircle of $CEG$, $\angle CLG = \angle CEG$, and from circle $\Omega$, $\angle CAG = \angle CBG$. Thus, $\angle AGL = \angle CEG - \angle CBG$. As both angles are equal to the same expression, we conclude $\angle KFA = \angle AGL$.","Prove that the points $A, X$, and $O$ are collinear.","From the first sub-problem, we have $\angle KFA = \angle AGL$. Points $F$ and $G$ are on circle $\Gamma$ with center $A$, so $AF = AG$. In circle $\Omega$, since the chords $AF$ and $AG$ are equal, the line $AO$ is the axis of symmetry for the points $F$ and $G$. Consequently, the lines $AF$ and $AG$ are symmetric with respect to the line $AO$. The equality $\angle KFA = \angle AGL$ implies that the lines $FK$ and $GL$ are also symmetric with respect to $AO$. As $X$ is the intersection of the distinct lines $FK$ and $GL$, it must lie on their axis of symmetry, the line $AO$. Therefore, the points $A, X,$ and $O$ are collinear.",,,,
2015g3,"Let $A B C$ be a triangle with $\angle C=90^{\circ}$, and let $H$ be the foot of the altitude from $C$. A point $D$ is chosen inside the triangle $C B H$ so that $C H$ bisects $A D$. Let $P$ be the intersection point of the lines $B D$ and $C H$. Let $\omega$ be the semicircle with diameter $B D$ that meets the segment $C B$ at an interior point. A line through $P$ is tangent to $\omega$ at $Q$. Prove that the lines $C Q$ and $A D$ meet on $\omega$.","Let $K$ be the projection of $D$ onto $A B$; then $A H=H K$ (see Figure 1). Since $P H \| D K$, we have


\begin{equation*}
\frac{P D}{P B}=\frac{H K}{H B}=\frac{A H}{H B} . \tag{1}
\end{equation*}


Let $L$ be the projection of $Q$ onto $D B$. Since $P Q$ is tangent to $\omega$ and $\angle D Q B=\angle B L Q=$ $90^{\circ}$, we have $\angle P Q D=\angle Q B P=\angle D Q L$. Therefore, $Q D$ and $Q B$ are respectively the internal and the external bisectors of $\angle P Q L$. By the angle bisector theorem, we obtain


\begin{equation*}
\frac{P D}{D L}=\frac{P Q}{Q L}=\frac{P B}{B L} . \tag{2}
\end{equation*}


The relations (1) and (2) yield $\frac{A H}{H B}=\frac{P D}{P B}=\frac{D L}{L B}$. So, the spiral similarity $\tau$ centered at $B$ and sending $A$ to $D$ maps $H$ to $L$. Moreover, $\tau$ sends the semicircle with diameter $A B$ passing through $C$ to $\omega$. Due to $C H \perp A B$ and $Q L \perp D B$, it follows that $\tau(C)=Q$.

Hence, the triangles $A B D$ and $C B Q$ are similar, so $\angle A D B=\angle C Q B$. This means that the lines $A D$ and $C Q$ meet at some point $T$, and this point satisfies $\angle B D T=\angle B Q T$. Therefore, $T$ lies on $\omega$, as needed.\\",2,"Let $K$ be the projection of $D$ onto the line $AB$, and $L$ be the projection of $Q$ onto the line $DB$. Prove that $\frac{AH}{HB} = \frac{DL}{LB}$.","Since $CH$ bisects $AD$ and $CH \perp AB$, let $M$ be the midpoint of $AD$. In $\triangle ADK$, $DK$ is parallel to $CH$ (as both are perpendicular to $AB$). Since $M$ is the midpoint of $AD$ and lies on $CH$, by the intercept theorem, $H$ must be the midpoint of $AK$, so $AH=HK$. In $\triangle BDK$, since $PH \\parallel DK$, by Thales' theorem we have $\frac{PD}{PB} = \frac{HK}{HB}$. Substituting $HK=AH$, we get $\frac{PD}{PB} = \frac{AH}{HB}$.\nNow, as $PQ$ is tangent to the semicircle $\\omega$ at $Q$, by the tangent-chord theorem, $\\angle PQD = \\angle QBD$. In the right-angled triangle $BDQ$ ($\u2220 BQD=90^\\circ$), $QL$ is the altitude to the hypotenuse, so $\\angle DQL = \\angle QBD$. Thus, $\\angle PQD = \\angle DQL$, which means $QD$ is the internal angle bisector of $\\angle PQL$. Since $\\angle BQD=90^\\circ$, $QB$ must be the external angle bisector. By the Angle Bisector Theorem on $\triangle PQL$, we have $\frac{PD}{DL} = \frac{PB}{BL}$, which rearranges to $\frac{PD}{PB} = \frac{DL}{LB}$.\nEquating the two expressions for $\frac{PD}{PB}$ gives $\frac{AH}{HB} = \frac{DL}{LB}$.",Prove that the lines $CQ$ and $AD$ meet on $\\omega$.,"From the first sub-problem, we have the relation $\frac{AH}{HB} = \frac{DL}{LB}$. This implies $\frac{AH+HB}{HB} = \frac{DL+LB}{LB}$, so $\frac{AB}{HB} = \frac{DB}{LB}$, which gives $\frac{DB}{AB} = \frac{LB}{HB}$. Consider the spiral similarity $\tau$ centered at $B$ that maps $A$ to $D$. The scaling factor is $DB/AB$ and the rotation angle is $\\angle ABD$. This similarity maps $H$ to $L$. \nSince $\\angle ACB = 90^\\circ$, $C$ lies on the semicircle with diameter $AB$. The similarity $\tau$ maps this semicircle to the semicircle with diameter $BD$, which is $\\omega$. Also, since $CH \\perp AB$ and $QL \\perp DB$, $\tau$ maps the line $CH$ to the line $QL$. Therefore, $\tau$ maps $C$ to $Q$. The existence of this similarity centered at $B$ mapping $A \to D$ and $C \to Q$ implies that $\triangle ABD$ is similar to $\triangle CBQ$. This similarity gives $\\angle ADB = \\angle CQB$. Let $T$ be the intersection of lines $AD$ and $CQ$. The angle equality means $\\angle BDT = \\angle BQT$, so the points $B, Q, T, D$ are concyclic. The circle passing through $B, Q, D$ is the one on which $\\omega$ lies. Therefore, $T$ lies on $\\omega$.",,,,
2015g5," Let $A B C$ be a triangle with $C A \neq C B$. Let $D, F$, and $G$ be the midpoints of the sides $A B, A C$, and $B C$, respectively. A circle $\Gamma$ passing through $C$ and tangent to $A B$ at $D$ meets the segments $A F$ and $B G$ at $H$ and $I$, respectively. The points $H^{\prime}$ and $I^{\prime}$ are symmetric to $H$ and $I$ about $F$ and $G$, respectively. The line $H^{\prime} I^{\prime}$ meets $C D$ and $F G$ at $Q$ and $M$, respectively. The line $C M$ meets $\Gamma$ again at $P$. Prove that $C Q=Q P$.","We may assume that $C A>C B$. Observe that $H^{\prime}$ and $I^{\prime}$ lie inside the segments $C F$ and $C G$, respectively. Therefore, $M$ lies outside $\triangle A B C$ (see Figure 1).

Due to the powers of points $A$ and $B$ with respect to the circle $\Gamma$, we have

$$
C H^{\prime} \cdot C A=A H \cdot A C=A D^{2}=B D^{2}=B I \cdot B C=C I^{\prime} \cdot C B .
$$

Therefore, $C H^{\prime} \cdot C F=C I^{\prime} \cdot C G$. Hence, the quadrilateral $H^{\prime} I^{\prime} G F$ is cyclic, and so $\angle I^{\prime} H^{\prime} C=$ $\angle C G F$.

Let $D F$ and $D G$ meet $\Gamma$ again at $R$ and $S$, respectively. We claim that the points $R$ and $S$ lie on the line $H^{\prime} I^{\prime}$.

Observe that $F H^{\prime} \cdot F A=F H \cdot F C=F R \cdot F D$. Thus, the quadrilateral $A D H^{\prime} R$ is cyclic, and hence $\angle R H^{\prime} F=\angle F D A=\angle C G F=\angle I^{\prime} H^{\prime} C$. Therefore, the points $R, H^{\prime}$, and $I^{\prime}$ are collinear. Similarly, the points $S, H^{\prime}$, and $I^{\prime}$ are also collinear, and so all the points $R, H^{\prime}, Q, I^{\prime}, S$, and $M$ are all collinear.\\

Then, $\angle R S D=\angle R D A=\angle D F G$. Hence, the quadrilateral $R S G F$ is cyclic (see Figure 2). Therefore, $M H^{\prime} \cdot M I^{\prime}=M F \cdot M G=M R \cdot M S=M P \cdot M C$. Thus, the quadrilateral $C P I^{\prime} H^{\prime}$ is also cyclic. Let $\omega$ be its circumcircle.

Notice that $\angle H^{\prime} C Q=\angle S D C=\angle S R C$ and $\angle Q C I^{\prime}=\angle C D R=\angle C S R$. Hence, $\triangle C H^{\prime} Q \sim \triangle R C Q$ and $\triangle C I^{\prime} Q \sim \triangle S C Q$, and therefore $Q H^{\prime} \cdot Q R=Q C^{2}=Q I^{\prime} \cdot Q S$.

We apply the inversion with center $Q$ and radius $Q C$. Observe that the points $R, C$, and $S$ are mapped to $H^{\prime}, C$, and $I^{\prime}$, respectively. Therefore, the circumcircle $\Gamma$ of $\triangle R C S$ is mapped to the circumcircle $\omega$ of $\triangle H^{\prime} C I^{\prime}$. Since $P$ and $C$ belong to both circles and the point $C$ is preserved by the inversion, we have that $P$ is also mapped to itself. We then get $Q P^{2}=Q C^{2}$. Hence, $Q P=Q C$.
",1," Let $A B C$ be a triangle with $C A \neq C B$. Let $D, F$, and $G$ be the midpoints of the sides $A B, A C$, and $B C$, respectively. A circle $\Gamma$ passing through $C$ and tangent to $A B$ at $D$ meets the segments $A F$ and $B G$ at $H$ and $I$, respectively. The points $H^{\prime}$ and $I^{\prime}$ are symmetric to $H$ and $I$ about $F$ and $G$, respectively. The line $H^{\prime} I^{\prime}$ meets $C D$ and $F G$ at $Q$ and $M$, respectively. The line $C M$ meets $\Gamma$ again at $P$. Prove that $C Q=Q P$.","We may assume that $C A>C B$. Observe that $H^{\prime}$ and $I^{\prime}$ lie inside the segments $C F$ and $C G$, respectively. Therefore, $M$ lies outside $\triangle A B C$ (see Figure 1).

Due to the powers of points $A$ and $B$ with respect to the circle $\Gamma$, we have

$$
C H^{\prime} \cdot C A=A H \cdot A C=A D^{2}=B D^{2}=B I \cdot B C=C I^{\prime} \cdot C B .
$$

Therefore, $C H^{\prime} \cdot C F=C I^{\prime} \cdot C G$. Hence, the quadrilateral $H^{\prime} I^{\prime} G F$ is cyclic, and so $\angle I^{\prime} H^{\prime} C=$ $\angle C G F$.

Let $D F$ and $D G$ meet $\Gamma$ again at $R$ and $S$, respectively. We claim that the points $R$ and $S$ lie on the line $H^{\prime} I^{\prime}$.

Observe that $F H^{\prime} \cdot F A=F H \cdot F C=F R \cdot F D$. Thus, the quadrilateral $A D H^{\prime} R$ is cyclic, and hence $\angle R H^{\prime} F=\angle F D A=\angle C G F=\angle I^{\prime} H^{\prime} C$. Therefore, the points $R, H^{\prime}$, and $I^{\prime}$ are collinear. Similarly, the points $S, H^{\prime}$, and $I^{\prime}$ are also collinear, and so all the points $R, H^{\prime}, Q, I^{\prime}, S$, and $M$ are all collinear.\\

Then, $\angle R S D=\angle R D A=\angle D F G$. Hence, the quadrilateral $R S G F$ is cyclic (see Figure 2). Therefore, $M H^{\prime} \cdot M I^{\prime}=M F \cdot M G=M R \cdot M S=M P \cdot M C$. Thus, the quadrilateral $C P I^{\prime} H^{\prime}$ is also cyclic. Let $\omega$ be its circumcircle.

Notice that $\angle H^{\prime} C Q=\angle S D C=\angle S R C$ and $\angle Q C I^{\prime}=\angle C D R=\angle C S R$. Hence, $\triangle C H^{\prime} Q \sim \triangle R C Q$ and $\triangle C I^{\prime} Q \sim \triangle S C Q$, and therefore $Q H^{\prime} \cdot Q R=Q C^{2}=Q I^{\prime} \cdot Q S$.

We apply the inversion with center $Q$ and radius $Q C$. Observe that the points $R, C$, and $S$ are mapped to $H^{\prime}, C$, and $I^{\prime}$, respectively. Therefore, the circumcircle $\Gamma$ of $\triangle R C S$ is mapped to the circumcircle $\omega$ of $\triangle H^{\prime} C I^{\prime}$. Since $P$ and $C$ belong to both circles and the point $C$ is preserved by the inversion, we have that $P$ is also mapped to itself. We then get $Q P^{2}=Q C^{2}$. Hence, $Q P=Q C$.
",,,,,,
2015g6,"Let $A B C$ be an acute triangle with $A B>A C$, and let $\Gamma$ be its circumcircle. Let $H$, $M$, and $F$ be the orthocenter of the triangle, the midpoint of $B C$, and the foot of the altitude from $A$, respectively. Let $Q$ and $K$ be the two points on $\Gamma$ that satisfy $\angle A Q H=90^{\circ}$ and $\angle Q K H=90^{\circ}$. Prove that the circumcircles of the triangles $K Q H$ and $K F M$ are tangent to each other.","Let $A^{\prime}$ be the point diametrically opposite to $A$ on $\Gamma$. Since $\angle A Q A^{\prime}=90^{\circ}$ and $\angle A Q H=90^{\circ}$, the points $Q, H$, and $A^{\prime}$ are collinear. Similarly, if $Q^{\prime}$ denotes the point on $\Gamma$ diametrically opposite to $Q$, then $K, H$, and $Q^{\prime}$ are collinear. Let the line $A H F$ intersect $\Gamma$ again at $E$; it is known that $M$ is the midpoint of the segment $H A^{\prime}$ and that $F$ is the midpoint of $H E$. Let $J$ be the midpoint of $H Q^{\prime}$.

Consider any point $T$ such that $T K$ is tangent to the circle $K Q H$ at $K$ with $Q$ and $T$ lying on different sides of $K H$ (see Figure 1). Then $\angle H K T=\angle H Q K$ and we are to prove that $\angle M K T=\angle C F K$. Thus it remains to show that $\angle H Q K=\angle C F K+\angle H K M$. Due to $\angle H Q K=90^{\circ}-\angle Q^{\prime} H A^{\prime}$ and $\angle C F K=90^{\circ}-\angle K F A$, this means the same as $\angle Q^{\prime} H A^{\prime}=$ $\angle K F A-\angle H K M$. Now, since the triangles $K H E$ and $A H Q^{\prime}$ are similar with $F$ and $J$ being the midpoints of corresponding sides, we have $\angle K F A=\angle H J A$, and analogously one may obtain $\angle H K M=\angle J Q H$. Thereby our task is reduced to verifying

$$
\angle Q^{\prime} H A^{\prime}=\angle H J A-\angle J Q H .
$$

To avoid confusion, let us draw a new picture at this moment (see Figure 2). Owing to $\angle Q^{\prime} H A^{\prime}=\angle J Q H+\angle H J Q$ and $\angle H J A=\angle Q J A+\angle H J Q$, we just have to show that $2 \angle J Q H=\angle Q J A$. To this end, it suffices to remark that $A Q A^{\prime} Q^{\prime}$ is a rectangle and that $J$, being defined to be the midpoint of $H Q^{\prime}$, has to lie on the mid parallel of $Q A^{\prime}$ and $Q^{\prime} A$.

",1,"Let $A B C$ be an acute triangle with $A B>A C$, and let $\Gamma$ be its circumcircle. Let $H$, $M$, and $F$ be the orthocenter of the triangle, the midpoint of $B C$, and the foot of the altitude from $A$, respectively. Let $Q$ and $K$ be the two points on $\Gamma$ that satisfy $\angle A Q H=90^{\circ}$ and $\angle Q K H=90^{\circ}$. Prove that the circumcircles of the triangles $K Q H$ and $K F M$ are tangent to each other.","Let $A^{\prime}$ be the point diametrically opposite to $A$ on $\Gamma$. Since $\angle A Q A^{\prime}=90^{\circ}$ and $\angle A Q H=90^{\circ}$, the points $Q, H$, and $A^{\prime}$ are collinear. Similarly, if $Q^{\prime}$ denotes the point on $\Gamma$ diametrically opposite to $Q$, then $K, H$, and $Q^{\prime}$ are collinear. Let the line $A H F$ intersect $\Gamma$ again at $E$; it is known that $M$ is the midpoint of the segment $H A^{\prime}$ and that $F$ is the midpoint of $H E$. Let $J$ be the midpoint of $H Q^{\prime}$.

Consider any point $T$ such that $T K$ is tangent to the circle $K Q H$ at $K$ with $Q$ and $T$ lying on different sides of $K H$ (see Figure 1). Then $\angle H K T=\angle H Q K$ and we are to prove that $\angle M K T=\angle C F K$. Thus it remains to show that $\angle H Q K=\angle C F K+\angle H K M$. Due to $\angle H Q K=90^{\circ}-\angle Q^{\prime} H A^{\prime}$ and $\angle C F K=90^{\circ}-\angle K F A$, this means the same as $\angle Q^{\prime} H A^{\prime}=$ $\angle K F A-\angle H K M$. Now, since the triangles $K H E$ and $A H Q^{\prime}$ are similar with $F$ and $J$ being the midpoints of corresponding sides, we have $\angle K F A=\angle H J A$, and analogously one may obtain $\angle H K M=\angle J Q H$. Thereby our task is reduced to verifying

$$
\angle Q^{\prime} H A^{\prime}=\angle H J A-\angle J Q H .
$$

To avoid confusion, let us draw a new picture at this moment (see Figure 2). Owing to $\angle Q^{\prime} H A^{\prime}=\angle J Q H+\angle H J Q$ and $\angle H J A=\angle Q J A+\angle H J Q$, we just have to show that $2 \angle J Q H=\angle Q J A$. To this end, it suffices to remark that $A Q A^{\prime} Q^{\prime}$ is a rectangle and that $J$, being defined to be the midpoint of $H Q^{\prime}$, has to lie on the mid parallel of $Q A^{\prime}$ and $Q^{\prime} A$.

",,,,,,
2015g7,"Let $A B C D$ be a convex quadrilateral, and let $P, Q, R$, and $S$ be points on the sides $A B, B C, C D$, and $D A$, respectively. Let the line segments $P R$ and $Q S$ meet at $O$. Suppose that each of the quadrilaterals $A P O S, B Q O P, C R O Q$, and $D S O R$ has an incircle. Prove that the lines $A C, P Q$, and $R S$ are either concurrent or parallel to each other.","Denote by $\gamma_{A}, \gamma_{B}, \gamma_{C}$, and $\gamma_{D}$ the incircles of the quadrilaterals $A P O S, B Q O P$, $C R O Q$, and $D S O R$, respectively.

We start with proving that the quadrilateral $A B C D$ also has an incircle which will be referred to as $\Omega$. Denote the points of tangency as in Figure 1. It is well-known that $Q Q_{1}=O O_{1}$ (if $B C \| P R$, this is obvious; otherwise, one may regard the two circles involved as the incircle and an excircle of the triangle formed by the lines $O Q, P R$, and $B C$ ). Similarly, $O O_{1}=P P_{1}$. Hence we have $Q Q_{1}=P P_{1}$. The other equalities of segment lengths marked in Figure 1 can be proved analogously. These equalities, together with $A P_{1}=A S_{1}$ and similar ones, yield $A B+C D=A D+B C$, as required.\\

Next, let us draw the lines parallel to $Q S$ through $P$ and $R$, and also draw the lines parallel to $P R$ through $Q$ and $S$. These lines form a parallelogram; denote its vertices by $A^{\prime}, B^{\prime}, C^{\prime}$, and $D^{\prime}$ as shown in Figure 2.

Since the quadrilateral $A P O S$ has an incircle, we have $A P-A S=O P-O S=A^{\prime} S-A^{\prime} P$. It is well-known that in this case there also exists a circle $\omega_{A}$ tangent to the four rays $A P$, $A S, A^{\prime} P$, and $A^{\prime} S$. It is worth mentioning here that in case when, say, the lines $A B$ and $A^{\prime} B^{\prime}$ coincide, the circle $\omega_{A}$ is just tangent to $A B$ at $P$. We introduce the circles $\omega_{B}, \omega_{C}$, and $\omega_{D}$ in a similar manner.

Assume that the radii of the circles $\omega_{A}$ and $\omega_{C}$ are different. Let $X$ be the center of the homothety having a positive scale factor and mapping $\omega_{A}$ to $\omega_{C}$.

Now, Monge's theorem applied to the circles $\omega_{A}, \Omega$, and $\omega_{C}$ shows that the points $A, C$, and $X$ are collinear. Applying the same theorem to the circles $\omega_{A}, \omega_{B}$, and $\omega_{C}$, we see that the points $P, Q$, and $X$ are also collinear. Similarly, the points $R, S$, and $X$ are collinear, as required.

If the radii of $\omega_{A}$ and $\omega_{C}$ are equal but these circles do not coincide, then the degenerate version of the same theorem yields that the three lines $A C, P Q$, and $R S$ are parallel to the line of centers of $\omega_{A}$ and $\omega_{C}$.

Finally, we need to say a few words about the case when $\omega_{A}$ and $\omega_{C}$ coincide (and thus they also coincide with $\Omega, \omega_{B}$, and $\left.\omega_{D}\right)$. It may be regarded as the limit case in the following manner.\\

Let us fix the positions of $A, P, O$, and $S$ (thus we also fix the circles $\omega_{A}, \gamma_{A}, \gamma_{B}$, and $\gamma_{D}$ ). Now we vary the circle $\gamma_{C}$ inscribed into $\angle Q O R$; for each of its positions, one may reconstruct the lines $B C$ and $C D$ as the external common tangents to $\gamma_{B}, \gamma_{C}$ and $\gamma_{C}, \gamma_{D}$ different from $P R$ and $Q S$, respectively. After such variation, the circle $\Omega$ changes, so the result obtained above may be applied.",4,"Given that the quadrilaterals APOS, BQOP, CROQ, and DSOR each have an incircle, prove that the quadrilateral ABCD also has an incircle.","For a quadrilateral to have an incircle, the sums of its opposite sides must be equal. The given conditions imply: 1) AP + OS = AS + OP; 2) BQ + OP = BP + OQ; 3) CR + OQ = CQ + OR; 4) DS + OR = DR + OS. Summing these four equations and cancelling common terms (OP, OQ, OR, OS) from both sides gives AP+BQ+CR+DS = AS+BP+CQ+DR. Rearranging terms according to the sides of ABCD yields (AP+BP) + (CR+DR) = (AS+DS) + (BQ+CQ), which simplifies to AB+CD = AD+BC. By Pitot's theorem, this condition implies that ABCD has an incircle.","For each vertex of the quadrilateral ABCD, for instance A, show that the condition that APOS has an incircle implies the existence of a corresponding circle $\omega_A$ tangent to the four lines AB, AD, the line through P parallel to QS, and the line through S parallel to PR.","The fact that APOS has an incircle means AP+OS = AS+OP, or AP-AS = OP-OS. Let A' be the point such that A'SOP is a parallelogram. Then A'S is parallel to and equal in length to OP, and A'P is parallel to and equal in length to OS. The condition becomes AP-AS = A'S-A'P. A known geometric theorem states that a circle tangent to the four lines AB, AD, the line through P parallel to QS (line A'P), and the line through S parallel to PR (line A'S) exists if and only if this relation holds. Therefore, such a circle $\omega_A$ exists. By symmetry, similar circles $\omega_B$, $\omega_C$, and $\omega_D$ exist for the other three vertices.","Let $\Omega$ be the incircle of ABCD and $\omega_A, \omega_B, \omega_C, \omega_D$ be the circles from the previous step. Using Monge's theorem on centers of homothety, prove that the lines AC, PQ, and RS are either concurrent or parallel.","Let X be the center of homothety that maps circle $\omega_A$ to $\omega_C$. (1) Lines AB and AD are common tangents to circles $\Omega$ and $\omega_A$, so their intersection A is a center of homothety. Similarly, C is a center of homothety for $\Omega$ and $\omega_C$. By Monge's theorem for circles ($\Omega, \omega_A, \omega_C$), the points A, C, and X are collinear. (2) Lines AB and the line through P parallel to QS are common tangents to $\omega_A$ and $\omega_B$, so P is a center of homothety. Similarly, Q is a center of homothety for $\omega_B$ and $\omega_C$. By Monge's theorem for ($\omega_A, \omega_B, \omega_C$), points P, Q, and X are collinear. (3) By a similar argument for circles ($\omega_A, \omega_D, \omega_C$), points S, R, and X are collinear. Therefore, the three lines AC, PQ, and RS all pass through X. If the radii of $\omega_A$ and $\omega_C$ are different, X is a finite point and the lines are concurrent. If the radii are equal, X is at infinity, and the lines are parallel.","Let ABCD be a convex quadrilateral, and let P, Q, R, and S be points on the sides AB, BC, CD, and DA, respectively. Let the line segments PR and QS meet at O. Suppose that each of the quadrilaterals APOS, BQOP, CROQ, and DSOR has an incircle. Prove that the lines AC, PQ, and RS are either concurrent or parallel to each other.","The proof is a composition of the previous steps. First, as shown in sub-problem 1, the conditions on the four small quadrilaterals imply that the large quadrilateral ABCD has an incircle, $\Omega$. Second, as shown in sub-problem 2, for each vertex, we can define an auxiliary circle, giving us $\omega_A, \omega_B, \omega_C, \omega_D$. Finally, as established in sub-problem 3 by applying Monge's theorem on appropriate triplets of these circles, the lines AC, PQ, and RS must all pass through the center of homothety X of circles $\omega_A$ and $\omega_C$. This implies the lines are either concurrent (if X is a finite point) or parallel (if X is at infinity)."
2015g8,"A triangulation of a convex polygon $\Pi$ is a partitioning of $\Pi$ into triangles by diagonals having no common points other than the vertices of the polygon. We say that a triangulation is a Thaiangulation if all triangles in it have the same area.

Prove that any two different Thaiangulations of a convex polygon $\Pi$ differ by exactly two triangles. (In other words, prove that it is possible to replace one pair of triangles in the first Thaiangulation with a different pair of triangles so as to obtain the second Thaiangulation.)","We denote by $[S]$ the area of a polygon $S$.\\
Recall that each triangulation of a convex $n$-gon has exactly $n-2$ triangles. This means that all triangles in any two Thaiangulations of a convex polygon $\Pi$ have the same area.

Let $\mathcal{T}$ be a triangulation of a convex polygon $\Pi$. If four vertices $A, B, C$, and $D$ of $\Pi$ form a parallelogram, and $\mathcal{T}$ contains two triangles whose union is this parallelogram, then we say that $\mathcal{T}$ contains parallelogram $A B C D$. Notice here that if two Thaiangulations $\mathcal{T}_{1}$ and $\mathcal{T}_{2}$ of $\Pi$ differ by two triangles, then the union of these triangles is a quadrilateral each of whose diagonals bisects its area, i.e., a parallelogram.

We start with proving two properties of triangulations.\\
Lemma 1. A triangulation of a convex polygon $\Pi$ cannot contain two parallelograms.\\
Proof. Arguing indirectly, assume that $P_{1}$ and $P_{2}$ are two parallelograms contained in some triangulation $\mathcal{T}$. If they have a common triangle in $\mathcal{T}$, then we may assume that $P_{1}$ consists of triangles $A B C$ and $A D C$ of $\mathcal{T}$, while $P_{2}$ consists of triangles $A D C$ and $C D E$ (see Figure 1). But then $B C\|A D\| C E$, so the three vertices $B, C$, and $E$ of $\Pi$ are collinear, which is absurd.

Assume now that $P_{1}$ and $P_{2}$ contain no common triangle. Let $P_{1}=A B C D$. The sides $A B$, $B C, C D$, and $D A$ partition $\Pi$ into several parts, and $P_{2}$ is contained in one of them; we may assume that this part is cut off from $P_{1}$ by $A D$. Then one may label the vertices of $P_{2}$ by $X$, $Y, Z$, and $T$ so that the polygon $A B C D X Y Z T$ is convex (see Figure 2; it may happen that $D=X$ and/or $T=A$, but still this polygon has at least six vertices). But the sum of the external angles of this polygon at $B, C, Y$, and $Z$ is already $360^{\circ}$, which is impossible. A final contradiction.\\

Lemma 2. Every triangle in a Thaiangulation $\mathcal{T}$ of $\Pi$ contains a side of $\Pi$.\\
Proof. Let $A B C$ be a triangle in $\mathcal{T}$. Apply an affine transform such that $A B C$ maps to an equilateral triangle; let $A^{\prime} B^{\prime} C^{\prime}$ be the image of this triangle, and $\Pi^{\prime}$ be the image of $\Pi$. Clearly, $\mathcal{T}$ maps into a Thaiangulation $\mathcal{T}^{\prime}$ of $\Pi^{\prime}$.

Assume that none of the sides of $\triangle A^{\prime} B^{\prime} C^{\prime}$ is a side of $\Pi^{\prime}$. Then $\mathcal{T}^{\prime}$ contains some other triangles with these sides, say, $A^{\prime} B^{\prime} Z, C^{\prime} A^{\prime} Y$, and $B^{\prime} C^{\prime} X$; notice that $A^{\prime} Z B^{\prime} X C^{\prime} Y$ is a convex hexagon (see Figure 3). The sum of its external angles at $X, Y$, and $Z$ is less than $360^{\circ}$. So one of these angles (say, at $Z$ ) is less than $120^{\circ}$, hence $\angle A^{\prime} Z B^{\prime}>60^{\circ}$. Then $Z$ lies on a circular arc subtended by $A^{\prime} B^{\prime}$ and having angular measure less than $240^{\circ}$; consequently, the altitude $Z H$ of $\triangle A^{\prime} B^{\prime} Z$ is less than $\sqrt{3} A^{\prime} B^{\prime} / 2$. Thus $\left[A^{\prime} B^{\prime} Z\right]<\left[A^{\prime} B^{\prime} C^{\prime}\right]$, and $\mathcal{T}^{\prime}$ is not a Thaiangulation. A contradiction.

Now we pass to the solution. We say that a triangle in a triangulation of $\Pi$ is an ear if it contains two sides of $\Pi$. Note that each triangulation of a polygon contains some ear.

Arguing indirectly, we choose a convex polygon $\Pi$ with the least possible number of sides such that some two Thaiangulations $\mathcal{T}_{1}$ and $\mathcal{T}_{2}$ of $\Pi$ violate the problem statement (thus $\Pi$ has at least five sides). Consider now any ear $A B C$ in $\mathcal{T}_{1}$, with $A C$ being a diagonal of $\Pi$. If $\mathcal{T}_{2}$ also contains $\triangle A B C$, then one may cut $\triangle A B C$ off from $\Pi$, getting a polygon with a smaller number of sides which also violates the problem statement. This is impossible; thus $\mathcal{T}_{2}$ does not contain $\triangle A B C$.

Next, $\mathcal{T}_{1}$ contains also another triangle with side $A C$, say $\triangle A C D$. By Lemma 2, this triangle contains a side of $\Pi$, so $D$ is adjacent to either $A$ or $C$ on the boundary of $\Pi$. We may assume that $D$ is adjacent to $C$.

Assume that $\mathcal{T}_{2}$ does not contain the triangle $B C D$. Then it contains two different triangles $B C X$ and $C D Y$ (possibly, with $X=Y$ ); since these triangles have no common interior points, the polygon $A B C D Y X$ is convex (see Figure 4). But, since $[A B C]=[B C X]=$ $[A C D]=[C D Y]$, we get $A X \| B C$ and $A Y \| C D$ which is impossible. Thus $\mathcal{T}_{2}$ contains $\triangle B C D$.

Therefore, $[A B D]=[A B C]+[A C D]-[B C D]=[A B C]$, and $A B C D$ is a parallelogram contained in $\mathcal{T}_{1}$. Let $\mathcal{T}^{\prime}$ be the Thaiangulation of $\Pi$ obtained from $\mathcal{T}_{1}$ by replacing the diagonal $A C$ with $B D$; then $\mathcal{T}^{\prime}$ is distinct from $\mathcal{T}_{2}$ (otherwise $\mathcal{T}_{1}$ and $\mathcal{T}_{2}$ would differ by two triangles). Moreover, $\mathcal{T}^{\prime}$ shares a common ear $B C D$ with $\mathcal{T}_{2}$. As above, cutting this ear away we obtain that $\mathcal{T}_{2}$ and $\mathcal{T}^{\prime}$ differ by two triangles forming a parallelogram different from $A B C D$. Thus $\mathcal{T}^{\prime}$ contains two parallelograms, which contradicts Lemma 1.\\",4,"Prove that a triangulation of a convex polygon cannot contain two distinct parallelograms, where a parallelogram is defined as the union of two triangles in the triangulation that share a common diagonal.","Assume for contradiction that a triangulation $\mathcal{T}$ contains two parallelograms $P_1$ and $P_2$. Case 1: $P_1$ and $P_2$ share a triangle. Let $P_1 = \triangle ABC \cup \triangle ADC$ and $P_2 = \triangle ADC \cup \triangle CDE$. Then $ABCD$ and $ADEC$ are parallelograms, which implies $BC \parallel AD \parallel CE$. This makes the vertices $B, C, E$ of the convex polygon collinear, a contradiction. Case 2: $P_1$ and $P_2$ are disjoint. Let $P_1 = ABCD$. $P_2$ must lie in a region bounded by a side of $P_1$, say $AD$. This configuration forms a larger convex polygon, but the sum of the external angles at the vertices of $P_1$ and $P_2$ would exceed $360^{\circ}$, which is impossible for a convex polygon.",Prove that every triangle in a Thaiangulation of a convex polygon $\Pi$ must contain at least one side of $\Pi$.,"Assume for contradiction that a triangle $\triangle ABC$ in a Thaiangulation $\mathcal{T}$ has no side on the boundary of $\Pi$. Apply an affine transformation that makes $\triangle ABC$ equilateral; this preserves the Thaiangulation property. Since $AB, BC, CA$ are not sides of $\Pi$, they are adjacent to other triangles, say $\triangle ABZ, \triangle BCX, \triangle CAY$. The polygon $AZBXCY$ is convex. The sum of the exterior angles at $X, Y, Z$ is less than $360^{\circ}$, so at least one, say at $Z$, is less than $120^{\circ}$, which implies $\angle AZB > 60^{\circ}$. For a fixed base $AB$, a vertex angle greater than $60^{\circ}$ means the triangle's altitude is less than that of an equilateral triangle. Thus, $[\triangle ABZ] < [\triangle ABC]$, contradicting that the triangulation is a Thaiangulation.","Let $\mathcal{T}_1$ and $\mathcal{T}_2$ be two different Thaiangulations of a convex polygon. Suppose an ear $\triangle ABC$ of $\mathcal{T}_1$ (with $AB, BC$ being sides of the polygon) is adjacent to $\triangle ACD$ in $\mathcal{T}_1$ (with $CD$ also being a side of the polygon). If $\triangle ABC$ is not in $\mathcal{T}_2$ but $\triangle BCD$ is in $\mathcal{T}_2$, prove that the quadrilateral $ABCD$ is a parallelogram.","Let $S$ be the area of any triangle in the Thaiangulations. From $\mathcal{T}_1$, we have $[ABC] = S$ and $[ACD] = S$. From $\mathcal{T}_2$, we have $[BCD] = S$. The area of quadrilateral $ABCD$ is $[ABC] + [ACD] = 2S$. Then the area of $\triangle ABD$ is $[ABCD] - [BCD] = 2S - S = S$. Since $[ABC] = [BCD] = S$ and they share base $BC$, the heights from vertices $A$ and $D$ to the line $BC$ are equal. As the polygon is convex, this implies $AD \parallel BC$. Similarly, since $[ACD] = [ABD] = S$ and they share base $AD$, the heights from $C$ and $B$ to line $AD$ are equal, implying $BC \parallel AD$. A quadrilateral with two pairs of parallel opposite sides is a parallelogram.",Prove that any two different Thaiangulations of a convex polygon $\Pi$ differ by exactly two triangles.,"Argue by contradiction, assuming $\Pi$ is a counterexample with the minimum possible number of sides. Let $\mathcal{T}_1$ and $\mathcal{T}_2$ be two Thaiangulations of $\Pi$ not differing by two triangles. Let $ABC$ be an ear in $\mathcal{T}_1$. By minimality, $ABC \notin \mathcal{T}_2$. Let $ACD$ be adjacent to $ABC$ in $\mathcal{T}_1$. By Sub-problem 2, we can assume $CD$ is a side of $\Pi$. One can show $\mathcal{T}_2$ must contain $\triangle BCD$. By Sub-problem 3, $ABCD$ is a parallelogram. Let $\mathcal{T}'$ be the triangulation obtained from $\mathcal{T}_1$ by replacing diagonal $AC$ with $BD$. $\mathcal{T}'$ and $\mathcal{T}_1$ differ by two triangles, so $\mathcal{T}' \neq \mathcal{T}_2$. Both $\mathcal{T}'$ and $\mathcal{T}_2$ share the ear $BCD$. Removing this ear leads to a smaller polygon where, by minimality, the remaining triangulations differ by two triangles, forming a parallelogram $P_2$. Thus, $\mathcal{T}'$ contains two distinct parallelograms ($ABCD$ and $P_2$), contradicting Sub-problem 1."
2015n2,Let $a$ and $b$ be positive integers such that $a!b!$ is a multiple of $a!+b!$. Prove that $3 a \geqslant 2 b+2$.,"If $a>b$, we immediately get $3 a \geqslant 2 b+2$. In the case $a=b$, the required inequality is equivalent to $a \geqslant 2$, which can be checked easily since $(a, b)=(1,1)$ does not satisfy $a!+b!\mid a!b!$. We now assume $a<b$ and denote $c=b-a$. The required inequality becomes $a \geqslant 2 c+2$.

Suppose, to the contrary, that $a \leqslant 2 c+1$. Define $M=\frac{b!}{a!}=(a+1)(a+2) \cdots(a+c)$. Since $a!+b!\mid a!b!$ implies $1+M \mid a!M$, we obtain $1+M \mid a!$. Note that we must have $c<a$; otherwise $1+M>a!$, which is impossible. We observe that $c!\mid M$ since $M$ is a product of $c$ consecutive integers. Thus $\operatorname{gcd}(1+M, c!)=1$, which implies


\begin{equation*}
1+M \left\lvert\, \frac{a!}{c!}=(c+1)(c+2) \cdots a\right. \tag{1}
\end{equation*}


If $a \leqslant 2 c$, then $\frac{a!}{c!}$ is a product of $a-c \leqslant c$ integers not exceeding $a$ whereas $M$ is a product of $c$ integers exceeding $a$. Therefore, $1+M>\frac{a!}{c!}$, which is a contradiction.

It remains to exclude the case $a=2 c+1$. Since $a+1=2(c+1)$, we have $c+1 \mid M$. Hence, we can deduce from (1) that $1+M \mid(c+2)(c+3) \cdots a$. Now $(c+2)(c+3) \cdots a$ is a product of $a-c-1=c$ integers not exceeding $a$; thus it is smaller than $1+M$. Again, we arrive at a contradiction.",2,"Let $a, b$ be positive integers with $a < b$ such that $a!b!$ is a multiple of $a!+b!$. Let $c = b-a$ and $M = \frac{b!}{a!}$. Prove that $1+M$ divides $\frac{a!}{c!}$.","The condition $a!+b! \mid a!b!$ implies $1+\frac{b!}{a!} \mid b!$ after dividing by $a!$. With $M = \frac{b!}{a!}$, this is $1+M \mid a!M$. Since $\gcd(1+M, M)=1$, we must have $1+M \mid a!$. Note that $M = (a+1)(a+2)\cdots(a+c)$ is a product of $c$ consecutive integers, so it is divisible by $c!$. This implies $M \equiv 0 \pmod{c!}$, so $\gcd(1+M, c!)=1$. Combining $1+M \mid a!$ and $\gcd(1+M, c!)=1$, we conclude that $1+M \mid \frac{a!}{c!}$.",Let $a$ and $b$ be positive integers such that $a!b!$ is a multiple of $a!+b!$. Prove that $3 a \geqslant 2 b+2$.,"If $a > b$, the inequality holds as $3a > 2a+a > 2b+b \ge 2b+1$. If $a=b$, the divisibility condition holds for all $a$, but the inequality $3a \ge 2a+2$ requires $a \ge 2$. The case $a=b=1$ fails the divisibility ($2 \nmid 1$), so $a \ge 2$ holds. Now assume $a<b$ and let $c=b-a$. The inequality becomes $a \ge 2c+2$. We assume $a \le 2c+1$ for contradiction. Let $M=(a+1)\cdots(a+c)$. By the first sub-problem, $1+M \mid \frac{a!}{c!}$, which implies $1+M \le \frac{a!}{c!}$. This is impossible if $a \le 2c$, since $M$ is a product of $c$ integers each greater than $a$, while $\frac{a!}{c!}$ is a product of $a-c \le c$ integers each at most $a$. The remaining case is $a=2c+1$. Here $a+1=2(c+1)$, so $c+1 \mid M$, meaning $\gcd(1+M, c+1)=1$. The condition $1+M \mid \frac{a!}{c!} = (c+1)\cdots a$ then implies $1+M \mid (c+2)\cdots a$. This is also impossible, as $M$ is larger than the product $(c+2)\cdots a$. Therefore, the assumption $a \le 2c+1$ must be false.",,,,
2015n3,"Let $m$ and $n$ be positive integers such that $m>n$. Define $x_{k}=(m+k) /(n+k)$ for $k=$ $1,2, \ldots, n+1$. Prove that if all the numbers $x_{1}, x_{2}, \ldots, x_{n+1}$ are integers, then $x_{1} x_{2} \cdots x_{n+1}-1$ is divisible by an odd prime.","Solution. Assume that $x_{1}, x_{2}, \ldots, x_{n+1}$ are integers. Define the integers

$$
a_{k}=x_{k}-1=\frac{m+k}{n+k}-1=\frac{m-n}{n+k}>0
$$

for $k=1,2, \ldots, n+1$.\\
Let $P=x_{1} x_{2} \cdots x_{n+1}-1$. We need to prove that $P$ is divisible by an odd prime, or in other words, that $P$ is not a power of 2 . To this end, we investigate the powers of 2 dividing the numbers $a_{k}$.

Let $2^{d}$ be the largest power of 2 dividing $m-n$, and let $2^{c}$ be the largest power of 2 not exceeding $2 n+1$. Then $2 n+1 \leqslant 2^{c+1}-1$, and so $n+1 \leqslant 2^{c}$. We conclude that $2^{c}$ is one of the numbers $n+1, n+2, \ldots, 2 n+1$, and that it is the only multiple of $2^{c}$ appearing among these numbers. Let $\ell$ be such that $n+\ell=2^{c}$. Since $\frac{m-n}{n+\ell}$ is an integer, we have $d \geqslant c$. Therefore, $2^{d-c+1} \nmid a_{\ell}=\frac{m-n}{n+\ell}$, while $2^{d-c+1} \mid a_{k}$ for all $k \in\{1, \ldots, n+1\} \backslash\{\ell\}$.

Computing modulo $2^{d-c+1}$, we get

$$
P=\left(a_{1}+1\right)\left(a_{2}+1\right) \cdots\left(a_{n+1}+1\right)-1 \equiv\left(a_{\ell}+1\right) \cdot 1^{n}-1 \equiv a_{\ell} \not \equiv 0 \quad\left(\bmod 2^{d-c+1}\right) .
$$

Therefore, $2^{d-c+1} \nmid P$.\\
On the other hand, for any $k \in\{1, \ldots, n+1\} \backslash\{\ell\}$, we have $2^{d-c+1} \mid a_{k}$. So $P \geqslant a_{k} \geqslant 2^{d-c+1}$, and it follows that $P$ is not a power of 2 .

Comment. Instead of attempting to show that $P$ is not a power of 2 , one may try to find an odd factor of $P$ (greater than 1) as follows:

From $a_{k}=\frac{m-n}{n+k} \in \mathbb{Z}_{>0}$, we get that $m-n$ is divisible by $n+1, n+2, \ldots, 2 n+1$, and thus it is also divisible by their least common multiple $L$. So $m-n=q L$ for some positive integer $q$; hence $x_{k}=q \cdot \frac{L}{n+k}+1$.

Then, since $n+1 \leqslant 2^{c}=n+\ell \leqslant 2 n+1 \leqslant 2^{c+1}-1$, we have $2^{c} \mid L$, but $2^{c+1} \nmid L$. So $\frac{L}{n+\ell}$ is odd, while $\frac{L}{n+k}$ is even for $k \neq \ell$. Computing modulo $2 q$ yields

$$
x_{1} x_{2} \cdots x_{n+1}-1 \equiv(q+1) \cdot 1^{n}-1 \equiv q \quad(\bmod 2 q) .
$$

Thus, $x_{1} x_{2} \cdots x_{n+1}-1=2 q r+q=q(2 r+1)$ for some integer $r$.\\
Since $x_{1} x_{2} \cdots x_{n+1}-1 \geqslant x_{1} x_{2}-1 \geqslant(q+1)^{2}-1>q$, we have $r \geqslant 1$. This implies that $x_{1} x_{2} \cdots x_{n+1}-1$ is divisible by an odd prime.",3,"Let $S = \{n+1, n+2, \ldots, 2n+1\}$. Prove that there exists a unique element in $S$, say $n+\ell$, which is a power of 2, say $2^c$, and that for any other element $n+k \in S$ with $k \ne \ell$, its 2-adic valuation $v_2(n+k)$ is less than $c$.","Let $2^c$ be the largest power of 2 such that $2^c \le 2n+1$. By definition, $2^{c+1} > 2n+1$, which implies $2^c > n + 1/2$. Since $n$ is an integer, $2^c \ge n+1$. Thus, the power of two $2^c$ is in the set $S = [n+1, 2n+1]$. Any other multiple of $2^c$ in $S$ would have to be at least $2 \cdot 2^c = 2^{c+1}$, which is greater than $2n+1$. Therefore, $2^c$ is the unique multiple of $2^c$ in $S$. Let $\ell$ be the index such that $n+\ell = 2^c$. For any $k \neq \ell$, $n+k$ is not a multiple of $2^c$, so its 2-adic valuation $v_2(n+k)$ must be strictly less than $c$.",Let $P = x_1 x_2 \cdots x_{n+1} - 1$. Let $d=v_2(m-n)$ and let $c$ be the integer defined in sub-problem 1 such that $n+\ell=2^c$. Prove that $v_2(P) = d-c$.,"Define $a_k = x_k-1 = \frac{m-n}{n+k}$. Since $x_k$ are integers, $a_k$ are positive integers. The 2-adic valuation of $a_k$ is $v_2(a_k) = v_2(m-n) - v_2(n+k) = d - v_2(n+k)$. From sub-problem 1, there is a unique $\ell$ such that $v_2(n+\ell)=c$ and for all $k \ne \ell$, $v_2(n+k)<c$. Thus, $v_2(a_\ell) = d-c$, and for $k \ne \ell$, $v_2(a_k) = d-v_2(n+k) > d-c$. This implies $v_2(a_k) \ge d-c+1$ for $k \ne \ell$. We have $P = (1+a_1)\cdots(1+a_{n+1})-1$. Consider this expression modulo $2^{d-c+1}$. For $k \ne \ell$, $a_k \equiv 0 \pmod{2^{d-c+1}}$. So, $P \equiv (1+a_\ell) \cdot \prod_{k \ne \ell}(1+0) - 1 \equiv a_\ell \pmod{2^{d-c+1}}$. This means $v_2(P-a_\ell) \ge d-c+1$. Since $v_2(a_\ell)=d-c$, we have $v_2(P) = v_2(a_\ell + (P-a_\ell)) = \min(v_2(a_\ell), v_2(P-a_\ell)) = d-c$.","Let $m$ and $n$ be positive integers such that $m>n$. Define $x_{k}=(m+k) /(n+k)$ for $k=$ $1,2, \ldots, n+1$. Prove that if all the numbers $x_{1}, x_{2}, \ldots, x_{n+1}$ are integers, then $x_{1} x_{2} \cdots x_{n+1}-1$ is divisible by an odd prime.","Let $P = x_1 x_2 \cdots x_{n+1} - 1$. We must show $P$ has an odd prime factor, which is equivalent to showing $P$ is not a power of 2. From sub-problem 2, the 2-adic valuation of $P$ is $v_2(P) = d-c$. Let $a_k = x_k-1$. For any $k \ne \ell$, we established in sub-problem 2 that $v_2(a_k) \ge d-c+1$. Since $a_k$ is a positive integer, $a_k \ge 2^{d-c+1}$. The product $P = (1+a_1)\cdots(1+a_{n+1})-1$ is greater than any individual $a_k$. Thus, for any $k \ne \ell$, we have $P > a_k \ge 2^{d-c+1}$. We have both $P > 2^{d-c+1}$ and $v_2(P) = d-c$. Let $P = Q \cdot 2^{d-c}$ for some odd integer $Q$. Then $Q \cdot 2^{d-c} > 2^{d-c+1}$, which simplifies to $Q > 2$. Since $Q$ is an odd integer greater than 2, it must have an odd prime factor. This odd prime factor also divides $P$. Therefore, $P$ is divisible by an odd prime.",,
2015n4,"Suppose that $a_{0}, a_{1}, \ldots$ and $b_{0}, b_{1}, \ldots$ are two sequences of positive integers satisfying $a_{0}, b_{0} \geqslant 2$ and

$$
a_{n+1}=\operatorname{gcd}\left(a_{n}, b_{n}\right)+1, \quad b_{n+1}=\operatorname{lcm}\left(a_{n}, b_{n}\right)-1
$$

for all $n \geqslant 0$. Prove that the sequence $\left(a_{n}\right)$ is eventually periodic; in other words, there exist integers $N \geqslant 0$ and $t>0$ such that $a_{n+t}=a_{n}$ for all $n \geqslant N$.","Let $s_{n}=a_{n}+b_{n}$. Notice that if $a_{n} \mid b_{n}$, then $a_{n+1}=a_{n}+1, b_{n+1}=b_{n}-1$ and $s_{n+1}=s_{n}$. So, $a_{n}$ increases by 1 and $s_{n}$ does not change until the first index is reached with $a_{n} \nmid s_{n}$. Define

$$
W_{n}=\left\{m \in \mathbb{Z}_{>0}: m \geqslant a_{n} \text { and } m \nmid s_{n}\right\} \quad \text { and } \quad w_{n}=\min W_{n} .
$$

Claim 1. The sequence $\left(w_{n}\right)$ is non-increasing.\\
Proof. If $a_{n} \mid b_{n}$ then $a_{n+1}=a_{n}+1$. Due to $a_{n} \mid s_{n}$, we have $a_{n} \notin W_{n}$. Moreover $s_{n+1}=s_{n}$; therefore, $W_{n+1}=W_{n}$ and $w_{n+1}=w_{n}$.

Otherwise, if $a_{n} \nmid b_{n}$, then $a_{n} \nmid s_{n}$, so $a_{n} \in W_{n}$ and thus $w_{n}=a_{n}$. We show that $a_{n} \in W_{n+1}$; this implies $w_{n+1} \leqslant a_{n}=w_{n}$. By the definition of $W_{n+1}$, we need that $a_{n} \geqslant a_{n+1}$ and $a_{n} \nmid s_{n+1}$. The first relation holds because of $\operatorname{gcd}\left(a_{n}, b_{n}\right)<a_{n}$. For the second relation, observe that in $s_{n+1}=\operatorname{gcd}\left(a_{n}, b_{n}\right)+\operatorname{lcm}\left(a_{n}, b_{n}\right)$, the second term is divisible by $a_{n}$, but the first term is not. So $a_{n} \nmid s_{n+1}$; that completes the proof of the claim.

Let $w=\min _{n} w_{n}$ and let $N$ be an index with $w=w_{N}$. Due to Claim 1, we have $w_{n}=w$ for all $n \geqslant N$.

Let $g_{n}=\operatorname{gcd}\left(w, s_{n}\right)$. As we have seen, starting from an arbitrary index $n \geqslant N$, the sequence $a_{n}, a_{n+1}, \ldots$ increases by 1 until it reaches $w$, which is the first value not dividing $s_{n}$; then it drops to $\operatorname{gcd}\left(w, s_{n}\right)+1=g_{n}+1$.\\
Claim 2. The sequence $\left(g_{n}\right)$ is constant for $n \geqslant N$.\\
Proof. If $a_{n} \mid b_{n}$, then $s_{n+1}=s_{n}$ and hence $g_{n+1}=g_{n}$. Otherwise we have $a_{n}=w$,


\begin{align*}
\operatorname{gcd}\left(a_{n}, b_{n}\right) & =\operatorname{gcd}\left(a_{n}, s_{n}\right)=\operatorname{gcd}\left(w, s_{n}\right)=g_{n} \\
s_{n+1} & =\operatorname{gcd}\left(a_{n}, b_{n}\right)+\operatorname{lcm}\left(a_{n}, b_{n}\right)=g_{n}+\frac{a_{n} b_{n}}{g_{n}}=g_{n}+\frac{w\left(s_{n}-w\right)}{g_{n}},  \tag{1}\\
\text { and } \quad g_{n+1} & =\operatorname{gcd}\left(w, s_{n+1}\right)=\operatorname{gcd}\left(w, g_{n}+\frac{s_{n}-w}{g_{n}} w\right)=\operatorname{gcd}\left(w, g_{n}\right)=g_{n} .
\end{align*}


Let $g=g_{N}$. We have proved that the sequence $\left(a_{n}\right)$ eventually repeats the following cycle:

$$
g+1 \mapsto g+2 \mapsto \ldots \mapsto w \mapsto g+1
$$",3,Let $s_n = a_n + b_n$. Define $W_n = \{m \in \mathbb{Z}_{>0}: m \ge a_n \text{ and } m \nmid s_n\}$ and its minimum $w_n = \min W_n$. Prove that the sequence $(w_n)_{n \ge 0}$ is non-increasing and thus eventually constant.,"If $a_n | b_n$, then $s_{n+1} = s_n$ and $a_{n+1} = a_n + 1$. As $a_n | s_n$, we have $a_n \notin W_n$, so $w_n > a_n$. This implies $w_n \ge a_n+1 = a_{n+1}$. By definition, $w_n \nmid s_n = s_{n+1}$. Thus, $w_n \in W_{n+1}$, which means $w_{n+1} = \min W_{n+1} \le w_n$. If $a_n \nmid b_n$, then $a_n \nmid s_n$, so $a_n \in W_n$ and $w_n = a_n$. The recurrences give $a_{n+1} = \operatorname{gcd}(a_n, b_n)+1 \le a_n$ and $s_{n+1} = \operatorname{gcd}(a_n, b_n) + \operatorname{lcm}(a_n, b_n)$. Since $\operatorname{lcm}(a_n, b_n)$ is a multiple of $a_n$ but $\operatorname{gcd}(a_n, b_n)$ is not, $a_n \nmid s_{n+1}$. So $a_n \in W_{n+1}$, which implies $w_{n+1} = \min W_{n+1} \le a_n = w_n$. In both cases, $w_{n+1} \le w_n$. Since $(w_n)$ is a non-increasing sequence of positive integers, it must be eventually constant.","Let $N$ be an integer such that $w_n = w$ for all $n \ge N$. Define $g_n = \operatorname{gcd}(w, s_n)$. Show that the sequence $(g_n)_{n \ge N}$ is constant.","For any $n \ge N$: If $a_n | b_n$, then $s_{n+1} = s_n$, so $g_{n+1} = \operatorname{gcd}(w, s_{n+1}) = \operatorname{gcd}(w, s_n) = g_n$. If $a_n \nmid b_n$, then $a_n=w$. We have $g_n = \operatorname{gcd}(w, s_n)$. The recurrences yield $s_{n+1} = \operatorname{gcd}(w, s_n) + \operatorname{lcm}(w, s_n-w) = g_n + \frac{w(s_n-w)}{g_n}$. Let $w = g_n l$ and $s_n = g_n k$ where $\operatorname{gcd}(l, k)=1$. Then $s_{n+1} = g_n + \frac{g_nl(g_nk - g_nl)}{g_n} = g_n(1 + lk - l^2)$. So $g_{n+1} = \operatorname{gcd}(w, s_{n+1}) = \operatorname{gcd}(g_n l, g_n(1+lk-l^2)) = g_n \operatorname{gcd}(l, 1+lk-l^2) = g_n \operatorname{gcd}(l, 1) = g_n$. In both cases, $g_{n+1}=g_n$. Thus, the sequence $(g_n)$ is constant for $n \ge N$.","Suppose that $a_{0}, a_{1}, \ldots$ and $b_{0}, b_{1}, \ldots$ are two sequences of positive integers satisfying $a_{0}, b_{0} \geqslant 2$ and $a_{n+1}=\operatorname{gcd}\left(a_{n}, b_{n}\right)+1, b_{n+1}=\operatorname{lcm}\left(a_{n}, b_{n}\right)-1$ for all $n \geqslant 0$. Prove that the sequence $\left(a_{n}\right)$ is eventually periodic.","From the previous sub-problems, there exists an integer $N$ such that for all $n \ge N$, $w_n=w$ and $g_n=g$ for some constants $w, g$. For $n \ge N$: if $a_n < w$, then $a_n$ must divide $s_n$, otherwise $w_n \le a_n < w$, a contradiction. So $a_n|b_n$, which gives $a_{n+1} = a_n+1$. The sequence $(a_n)$ increases by 1 until it reaches $w$. If $a_n=w$, then $a_n \nmid s_n$ by definition of $w=w_n$. This implies $a_n \nmid b_n$, so $a_{n+1} = \operatorname{gcd}(a_n, b_n)+1 = \operatorname{gcd}(w,s_n)+1 = g_n+1 = g+1$. Since $g=\operatorname{gcd}(w,s_n)$, we have $g<w$, so $g+1 \le w$. Thus, for $n \ge N$, the sequence $(a_n)$ follows the cycle $g+1, g+2, \ldots, w, g+1, \ldots$. Therefore, $(a_n)$ is eventually periodic.",,
2015n6,"Let $\mathbb{Z}_{>0}$ denote the set of positive integers. Consider a function $f: \mathbb{Z}_{>0} \rightarrow \mathbb{Z}_{>0}$. For any $m, n \in \mathbb{Z}_{>0}$ we write $f^{n}(m)=\underbrace{f(f(\ldots f}_{n}(m) \ldots))$. Suppose that $f$ has the following two properties:\\
(i) If $m, n \in \mathbb{Z}_{>0}$, then $\frac{f^{n}(m)-m}{n} \in \mathbb{Z}_{>0}$;\\
(ii) The set $\mathbb{Z}_{>0} \backslash\left\{f(n) \mid n \in \mathbb{Z}_{>0}\right\}$ is finite.

Prove that the sequence $f(1)-1, f(2)-2, f(3)-3, \ldots$ is periodic.","Solution. We split the solution into three steps. In the first of them, we show that the function $f$ is injective and explain how this leads to a useful visualization of $f$. Then comes the second step, in which most of the work happens: its goal is to show that for any $n \in \mathbb{Z}_{>0}$ the sequence $n, f(n), f^{2}(n), \ldots$ is an arithmetic progression. Finally, in the third step we put everything together, thus solving the problem.

Step 1. We commence by checking that $f$ is injective. For this purpose, we consider any $m, k \in \mathbb{Z}_{>0}$ with $f(m)=f(k)$. By $(i)$, every positive integer $n$ has the property that

$$
\frac{k-m}{n}=\frac{f^{n}(m)-m}{n}-\frac{f^{n}(k)-k}{n}
$$

is a difference of two integers and thus integral as well. But for $n=|k-m|+1$ this is only possible if $k=m$. Thereby, the injectivity of $f$ is established.

Now recall that due to condition (ii) there are finitely many positive integers $a_{1}, \ldots, a_{k}$ such that $\mathbb{Z}_{>0}$ is the disjoint union of $\left\{a_{1}, \ldots, a_{k}\right\}$ and $\left\{f(n) \mid n \in \mathbb{Z}_{>0}\right\}$. Notice that by plugging $n=1$ into condition $(i)$ we get $f(m)>m$ for all $m \in \mathbb{Z}_{>0}$.

We contend that every positive integer $n$ may be expressed uniquely in the form $n=f^{j}\left(a_{i}\right)$ for some $j \geqslant 0$ and $i \in\{1, \ldots, k\}$. The uniqueness follows from the injectivity of $f$. The existence can be proved by induction on $n$ in the following way. If $n \in\left\{a_{1}, \ldots, a_{k}\right\}$, then we may take $j=0$; otherwise there is some $n^{\prime}<n$ with $f\left(n^{\prime}\right)=n$ to which the induction hypothesis may be applied.

The result of the previous paragraph means that every positive integer appears exactly once in the following infinite picture, henceforth referred to as ""the Table"":

\begin{center}
\begin{tabular}{|c|c|c|c|c}
\hline
$a_{1}$ & $f\left(a_{1}\right)$ & $f^{2}\left(a_{1}\right)$ & $f^{3}\left(a_{1}\right)$ & $\ldots$ \\
\hline
$a_{2}$ & $f\left(a_{2}\right)$ & $f^{2}\left(a_{2}\right)$ & $f^{3}\left(a_{2}\right)$ & $\ldots$ \\
\hline
$\vdots$ & $\vdots$ & $\vdots$ & $\vdots$ &  \\
\hline
$a_{k}$ & $f\left(a_{k}\right)$ & $f^{2}\left(a_{k}\right)$ & $f^{3}\left(a_{k}\right)$ & $\ldots$ \\
\hline
\end{tabular}
\end{center}

The Table

Step 2. Our next goal is to prove that each row of the Table is an arithmetic progression. Assume contrariwise that the number $t$ of rows which are arithmetic progressions would satisfy $0 \leqslant t<k$. By permuting the rows if necessary we may suppose that precisely the first $t$ rows are arithmetic progressions, say with steps $T_{1}, \ldots, T_{t}$. Our plan is to find a further row that is ""not too sparse"" in an asymptotic sense, and then to prove that such a row has to be an arithmetic progression as well.

Let us write $T=\operatorname{lcm}\left(T_{1}, T_{2}, \ldots, T_{t}\right)$ and $A=\max \left\{a_{1}, a_{2}, \ldots, a_{t}\right\}$ if $t>0$; and $T=1$ and $A=0$ if $t=0$. For every integer $n \geqslant A$, the interval $\Delta_{n}=[n+1, n+T]$ contains exactly $T / T_{i}$\\
elements of the $i^{\text {th }}$ row $(1 \leqslant i \leqslant t)$. Therefore, the number of elements from the last $(k-t)$ rows of the Table contained in $\Delta_{n}$ does not depend on $n \geqslant A$. It is not possible that none of these intervals $\Delta_{n}$ contains an element from the $k-t$ last rows, because infinitely many numbers appear in these rows. It follows that for each $n \geqslant A$ the interval $\Delta_{n}$ contains at least one member from these rows.

This yields that for every positive integer $d$, the interval $[A+1, A+(d+1)(k-t) T]$ contains at least $(d+1)(k-t)$ elements from the last $k-t$ rows; therefore, there exists an index $x$ with $t+1 \leqslant x \leqslant k$, possibly depending on $d$, such that our interval contains at least $d+1$ elements from the $x^{\text {th }}$ row. In this situation we have

$$
f^{d}\left(a_{x}\right) \leqslant A+(d+1)(k-t) T
$$

Finally, since there are finitely many possibilities for $x$, there exists an index $x \geqslant t+1$ such that the set

$$
X=\left\{d \in \mathbb{Z}_{>0} \mid f^{d}\left(a_{x}\right) \leqslant A+(d+1)(k-t) T\right\}
$$

is infinite. Thereby we have found the ""dense row"" promised above.\\
By assumption $(i)$, for every $d \in X$ the number

$$
\beta_{d}=\frac{f^{d}\left(a_{x}\right)-a_{x}}{d}
$$

is a positive integer not exceeding

$$
\frac{A+(d+1)(k-t) T}{d} \leqslant \frac{A d+2 d(k-t) T}{d}=A+2(k-t) T
$$

This leaves us with finitely many choices for $\beta_{d}$, which means that there exists a number $T_{x}$ such that the set

$$
Y=\left\{d \in X \mid \beta_{d}=T_{x}\right\}
$$

is infinite. Notice that we have $f^{d}\left(a_{x}\right)=a_{x}+d \cdot T_{x}$ for all $d \in Y$.\\
Now we are prepared to prove that the numbers in the $x^{\text {th }}$ row form an arithmetic progression, thus coming to a contradiction with our assumption. Let us fix any positive integer $j$. Since the set $Y$ is infinite, we can choose a number $y \in Y$ such that $y-j>\left|f^{j}\left(a_{x}\right)-\left(a_{x}+j T_{x}\right)\right|$. Notice that both numbers

$$
f^{y}\left(a_{x}\right)-f^{j}\left(a_{x}\right)=f^{y-j}\left(f^{j}\left(a_{x}\right)\right)-f^{j}\left(a_{x}\right) \quad \text { and } \quad f^{y}\left(a_{x}\right)-\left(a_{x}+j T_{x}\right)=(y-j) T_{x}
$$

are divisible by $y-j$. Thus, the difference between these numbers is also divisible by $y-j$. Since the absolute value of this difference is less than $y-j$, it has to vanish, so we get $f^{j}\left(a_{x}\right)=$ $a_{x}+j \cdot T_{x}$.

Hence, it is indeed true that all rows of the Table are arithmetic progressions.\\
Step 3. Keeping the above notation in force, we denote the step of the $i^{\text {th }}$ row of the table by $T_{i}$.\\
\includegraphics[max width=\textwidth, center]{2025_04_30_c8781145b2af5b76793eg-75}

$$
T=\operatorname{lcm}\left(T_{1}, \ldots, T_{k}\right)
$$

To see this, let any $n \in \mathbb{Z}_{>0}$ be given and denote the index of the row in which it appears in the Table by $i$. Then we have $f^{j}(n)=n+j \cdot T_{i}$ for all $j \in \mathbb{Z}_{>0}$, and thus indeed

$$
f(n+T)-f(n)=f^{1+T / T_{i}}(n)-f(n)=\left(n+T+T_{i}\right)-\left(n+T_{i}\right)=T
$$

This concludes the solution.

Comment 1. There are some alternative ways to complete the second part once the index $x$ corresponding to a ""dense row"" is found. For instance, one may show that for some integer $T_{x}^{*}$ the set

$$
Y^{*}=\left\{j \in \mathbb{Z}_{>0} \mid f^{j+1}\left(a_{x}\right)-f^{j}\left(a_{x}\right)=T_{x}^{*}\right\}
$$

is infinite, and then one may conclude with a similar divisibility argument.\\
Comment 2. It may be checked that, conversely, any way to fill out the Table with finitely many arithmetic progressions so that each positive integer appears exactly once, gives rise to a function $f$ satisfying the two conditions mentioned in the problem. For example, we may arrange the positive integers as follows:

\begin{center}
\begin{tabular}{|c|c|c|c|c|c}
\hline
2 & 4 & 6 & 8 & 10 & $\ldots$ \\
\hline
1 & 5 & 9 & 13 & 17 & $\ldots$ \\
\hline
3 & 7 & 11 & 15 & 19 & $\ldots$ \\
\hline
\end{tabular}
\end{center}

This corresponds to the function

$$
f(n)= \begin{cases}n+2 & \text { if } n \text { is even } \\ n+4 & \text { if } n \text { is odd }\end{cases}
$$

As this example shows, it is not true that the function $n \mapsto f(n)-n$ has to be constant.",4,"Show that $f$ is injective and that $\mathbb{Z}_{>0}$ is a disjoint union of a finite number of sequences $S_i = \\{a_i, f(a_i), f^2(a_i), \\ldots\\}$, where $\\{a_1, \\ldots, a_k\\} = \\mathbb{Z}_{>0} \\setminus f(\\mathbb{Z}_{>0})$.","If $f(m)=f(k)$, property (i) implies $\frac{k-m}{n} = \frac{f^n(m)-m}{n} - \frac{f^n(k)-k}{n}$ is an integer for all $n$. For $n>|k-m|$, this forces $k-m=0$, so $f$ is injective. By property (ii), the set $A = \\mathbb{Z}_{>0} \\setminus f(\\mathbb{Z}_{>0})$ is finite. By property (i) with $n=1$, $f(m)>m$. Any $x \\in \\mathbb{Z}_{>0}$ has a unique chain of pre-images $x, f^{-1}(x), f^{-2}(x), \\ldots$ which must terminate at an element of $A$. Thus every integer belongs to exactly one sequence $S_i$ starting with an element $a_i \\in A$.","Let the sequences partitioning $\\mathbb{Z}_{>0}$ be $S_1, \\ldots, S_k$. Show that at least one of these sequences is an arithmetic progression.","Assume for contradiction none are arithmetic progressions. A density argument shows at least one sequence, say $S_x$ starting with $a_x$, must be 'dense', meaning $f^d(a_x) \\le C \\cdot d$ for an infinite set of integers $d$ and some constant $C$. For these $d$, the integer $\beta_d = \frac{f^d(a_x)-a_x}{d}$ is bounded, so for an infinite subset $Y$, $\beta_d$ must be a constant $T_x$. Thus $f^d(a_x)=a_x+d T_x$ for all $d \\in Y$. For any $j>0$, pick $y \\in Y$ such that $y-j > |f^j(a_x) - (a_x+jT_x)|$. By property (i), $y-j$ divides $f^y(a_x)-f^j(a_x)$. It also divides $(y-j)T_x = f^y(a_x)-(a_x+jT_x)$. So $y-j$ must divide their difference, $f^j(a_x)-(a_x+jT_x)$, forcing the difference to be 0. Thus $S_x$ is an arithmetic progression, a contradiction.","Show that all of the sequences $S_1, \\ldots, S_k$ are arithmetic progressions.","Assume for contradiction that only $t$ of the $k$ sequences are arithmetic progressions, where $1 \\le t < k$. Let $T$ be the LCM of their common differences. The set of numbers in the remaining $k-t$ non-AP sequences has a constant positive density in large intervals. The density argument from the previous step can be applied to this subset of numbers and sequences. It shows that at least one of these $k-t$ sequences must also be an arithmetic progression. This contradicts our assumption. Therefore, all $k$ sequences must be arithmetic progressions.","Prove that the sequence $f(1)-1, f(2)-2, f(3)-3, \\ldots$ is periodic.","From the previous step, each sequence $S_i$ is an arithmetic progression with some common difference $T_i$. Any $n \\in \\mathbb{Z}_{>0}$ belongs to exactly one $S_i$, so $f(n)-n=T_i$. Let $T=\text{lcm}(T_1, \\ldots, T_k)$. If $n \\in S_i$, its form is $n=a_i+jT_i$ for some $j \\ge 0$. Then $n+T = a_i+jT_i+T = a_i+(j+T/T_i)T_i$, so $n+T$ is also in $S_i$. Therefore, $f(n+T)-(n+T) = T_i$. Since $f(n)-n=T_i$ as well, we have $f(n+T)-(n+T) = f(n)-n$ for all $n \\in \\mathbb{Z}_{>0}$. The sequence is periodic with period $T$."
2014a1,"Let $z_{0}<z_{1}<z_{2}<\cdots$ be an infinite sequence of positive integers. Prove that there exists a unique integer $n \geqslant 1$ such that

\begin{equation*}
z_{n}<\frac{z_{0}+z_{1}+\cdots+z_{n}}{n} \leqslant z_{n+1} . \tag{1}
\end{equation*}","Solution. For $n=1,2, \ldots$ define

$$
d_{n}=\left(z_{0}+z_{1}+\cdots+z_{n}\right)-n z_{n} .
$$

The sign of $d_{n}$ indicates whether the first inequality in (1) holds; i.e., it is satisfied if and only if $d_{n}>0$.

Notice that

$$
n z_{n+1}-\left(z_{0}+z_{1}+\cdots+z_{n}\right)=(n+1) z_{n+1}-\left(z_{0}+z_{1}+\cdots+z_{n}+z_{n+1}\right)=-d_{n+1},
$$

so the second inequality in (1) is equivalent to $d_{n+1} \leqslant 0$. Therefore, we have to prove that there is a unique index $n \geqslant 1$ that satisfies $d_{n}>0 \geqslant d_{n+1}$.

By its definition the sequence $d_{1}, d_{2}, \ldots$ consists of integers and we have

$$
d_{1}=\left(z_{0}+z_{1}\right)-1 \cdot z_{1}=z_{0}>0 .
$$

From\\
$d_{n+1}-d_{n}=\left(\left(z_{0}+\cdots+z_{n}+z_{n+1}\right)-(n+1) z_{n+1}\right)-\left(\left(z_{0}+\cdots+z_{n}\right)-n z_{n}\right)=n\left(z_{n}-z_{n+1}\right)<0$ we can see that $d_{n+1}<d_{n}$ and thus the sequence strictly decreases.

Hence, we have a decreasing sequence $d_{1}>d_{2}>\ldots$ of integers such that its first element $d_{1}$ is positive. The sequence must drop below 0 at some point, and thus there is a unique index $n$, that is the index of the last positive term, satisfying $d_{n}>0 \geqslant d_{n+1}$.

Comment. Omitting the assumption that $z_{1}, z_{2}, \ldots$ are integers allows the numbers $d_{n}$ to be all positive. In such cases the desired $n$ does not exist. This happens for example if $z_{n}=2-\frac{1}{2^{n}}$ for all integers $n \geqslant 0$.",2,"Let $z_0, z_1, z_2, \dots$ be a strictly increasing sequence of positive integers. Define a new sequence $d_n = (z_0 + z_1 + \dots + z_n) - n z_n$ for $n \ge 1$. Show that the inequalities in the original problem, $z_{n}<\frac{z_{0}+z_{1}+\cdots+z_{n}}{n} \leqslant z_{n+1}$, are equivalent to the condition $d_n > 0 \ge d_{n+1}$. Furthermore, prove that the sequence $(d_n)_{n \ge 1}$ is a strictly decreasing sequence of integers with $d_1 > 0$.","The first inequality $z_{n}<\frac{z_{0}+z_{1}+\cdots+z_{n}}{n}$ is equivalent to $nz_n < z_0 + \dots + z_n$, which is $(z_0 + \dots + z_n) - nz_n > 0$, or $d_n > 0$. The second inequality $\frac{z_{0}+z_{1}+\cdots+z_{n}}{n} \leqslant z_{n+1}$ is equivalent to $z_0 + \dots + z_n \le nz_{n+1}$. Adding $z_{n+1}$ to both sides and rearranging gives $(z_0 + \dots + z_{n+1}) - (n+1)z_{n+1} \le 0$, which is $d_{n+1} \le 0$. Thus, the original inequalities are equivalent to $d_n > 0 \ge d_{n+1}$.
Now, we analyze the sequence $d_n$. Since all $z_i$ are integers, each $d_n$ is an integer. For $n=1$, $d_1 = (z_0+z_1)-1\cdot z_1 = z_0$. Since $z_0$ is a positive integer, $d_1 > 0$. To see that the sequence is strictly decreasing, consider the difference $d_{n+1} - d_n = ((z_0 + \dots + z_{n+1}) - (n+1)z_{n+1}) - ((z_0 + \dots + z_n) - nz_n) = z_{n+1} - (n+1)z_{n+1} + nz_n = n(z_n - z_{n+1})$. Since the sequence $(z_i)$ is strictly increasing, $z_n < z_{n+1}$, so $z_n - z_{n+1} < 0$. For $n \ge 1$, this means $d_{n+1} - d_n < 0$, so $d_{n+1} < d_n$.","Let $z_{0}<z_{1}<z_{2}<\cdots$ be an infinite sequence of positive integers. Prove that there exists a unique integer $n \geqslant 1$ such that

\begin{equation*}
z_{n}<\frac{z_{0}+z_{1}+\cdots+z_{n}}{n} \leqslant z_{n+1} .
\end{equation*}","From the first sub-problem, the problem is equivalent to proving there exists a unique integer $n \ge 1$ such that $d_n > 0 \ge d_{n+1}$, where $d_n = (z_0 + z_1 + \dots + z_n) - n z_n$. We have established that $(d_n)_{n \ge 1}$ is a strictly decreasing sequence of integers, and its first term $d_1 = z_0$ is positive. A strictly decreasing sequence of integers that starts with a positive value must eventually become non-positive. Because the sequence is strictly decreasing (i.e., $d_{n+1} < d_n$ for all $n$), there must be a unique index $n$ for which $d_n$ is the last positive term in the sequence. For this unique $n$, we have $d_n > 0$ and $d_{n+1} \le 0$. Therefore, there exists a unique integer $n \ge 1$ satisfying the condition.",,,,
2014a2,"Define the function $f:(0,1) \rightarrow(0,1)$ by

$$
f(x)= \begin{cases}x+\frac{1}{2} & \text { if } x<\frac{1}{2} \\ x^{2} & \text { if } x \geqslant \frac{1}{2}\end{cases}
$$

Let $a$ and $b$ be two real numbers such that $0<a<b<1$. We define the sequences $a_{n}$ and $b_{n}$ by $a_{0}=a, b_{0}=b$, and $a_{n}=f\left(a_{n-1}\right), b_{n}=f\left(b_{n-1}\right)$ for $n>0$. Show that there exists a positive integer $n$ such that

$$
\left(a_{n}-a_{n-1}\right)\left(b_{n}-b_{n-1}\right)<0
$$","Solution. Note that

$$
f(x)-x=\frac{1}{2}>0
$$

if $x<\frac{1}{2}$ and

$$
f(x)-x=x^{2}-x<0
$$

if $x \geqslant \frac{1}{2}$. So if we consider $(0,1)$ as being divided into the two subintervals $I_{1}=\left(0, \frac{1}{2}\right)$ and $I_{2}=\left[\frac{1}{2}, 1\right)$, the inequality

$$
\left(a_{n}-a_{n-1}\right)\left(b_{n}-b_{n-1}\right)=\left(f\left(a_{n-1}\right)-a_{n-1}\right)\left(f\left(b_{n-1}\right)-b_{n-1}\right)<0
$$

holds if and only if $a_{n-1}$ and $b_{n-1}$ lie in distinct subintervals.\\
Let us now assume, to the contrary, that $a_{k}$ and $b_{k}$ always lie in the same subinterval. Consider the distance $d_{k}=\left|a_{k}-b_{k}\right|$. If both $a_{k}$ and $b_{k}$ lie in $I_{1}$, then

$$
d_{k+1}=\left|a_{k+1}-b_{k+1}\right|=\left|a_{k}+\frac{1}{2}-b_{k}-\frac{1}{2}\right|=d_{k}
$$

If, on the other hand, $a_{k}$ and $b_{k}$ both lie in $I_{2}$, then $\min \left(a_{k}, b_{k}\right) \geqslant \frac{1}{2}$ and $\max \left(a_{k}, b_{k}\right)=$ $\min \left(a_{k}, b_{k}\right)+d_{k} \geqslant \frac{1}{2}+d_{k}$, which implies\\
$d_{k+1}=\left|a_{k+1}-b_{k+1}\right|=\left|a_{k}^{2}-b_{k}^{2}\right|=\left|\left(a_{k}-b_{k}\right)\left(a_{k}+b_{k}\right)\right| \geqslant\left|a_{k}-b_{k}\right|\left(\frac{1}{2}+\frac{1}{2}+d_{k}\right)=d_{k}\left(1+d_{k}\right) \geqslant d_{k}$.\\
This means that the difference $d_{k}$ is non-decreasing, and in particular $d_{k} \geqslant d_{0}>0$ for all $k$.\\
We can even say more. If $a_{k}$ and $b_{k}$ lie in $I_{2}$, then

$$
d_{k+2} \geqslant d_{k+1} \geqslant d_{k}\left(1+d_{k}\right) \geqslant d_{k}\left(1+d_{0}\right)
$$

If $a_{k}$ and $b_{k}$ both lie in $I_{1}$, then $a_{k+1}$ and $b_{k+1}$ both lie in $I_{2}$, and so we have

$$
d_{k+2} \geqslant d_{k+1}\left(1+d_{k+1}\right) \geqslant d_{k+1}\left(1+d_{0}\right)=d_{k}\left(1+d_{0}\right)
$$

In either case, $d_{k+2} \geqslant d_{k}\left(1+d_{0}\right)$, and inductively we get

$$
d_{2 m} \geqslant d_{0}\left(1+d_{0}\right)^{m}
$$

For sufficiently large $m$, the right-hand side is greater than 1 , but since $a_{2 m}, b_{2 m}$ both lie in $(0,1)$, we must have $d_{2 m}<1$, a contradiction.

Thus there must be a positive integer $n$ such that $a_{n-1}$ and $b_{n-1}$ do not lie in the same subinterval, which proves the desired statement.",3,"Let $I_1 = (0, 1/2)$ and $I_2 = [1/2, 1)$. Show that the inequality $(a_n - a_{n-1})(b_n - b_{n-1}) < 0$ holds if and only if $a_{n-1}$ and $b_{n-1}$ lie in different subintervals $I_1$ and $I_2$.","The expression $(a_n - a_{n-1})(b_n - b_{n-1})$ is equal to $(f(a_{n-1}) - a_{n-1})(f(b_{n-1}) - b_{n-1})$. We analyze the sign of $g(x) = f(x) - x$. For $x \in I_1=(0, 1/2)$, $g(x) = (x + 1/2) - x = 1/2 > 0$. For $x \in I_2=[1/2, 1)$, $g(x) = x^2 - x = x(x-1) < 0$. The product $g(a_{n-1})g(b_{n-1})$ is negative if and only if one term is positive and the other is negative, which requires $a_{n-1}$ and $b_{n-1}$ to be in different subintervals.","Assume for the sake of contradiction that for all $k \ge 0$, $a_k$ and $b_k$ lie in the same subinterval ($I_1$ or $I_2$). Let $d_k = |a_k - b_k|$. Show that this assumption implies that $d_{k+2} \ge d_k(1+d_0)$ for all $k \ge 0$.","First, we show that $d_k$ is non-decreasing. If $a_k, b_k \in I_1$, $d_{k+1} = |(a_k+1/2) - (b_k+1/2)| = d_k$. If $a_k, b_k \in I_2$, $d_{k+1} = |a_k^2 - b_k^2| = d_k(a_k+b_k) \ge d_k(1/2+1/2) = d_k$. So $d_k \ge d_{k-1} \ge \dots \ge d_0$. Now, consider two cases. Case 1: $a_k, b_k \in I_1$. Then $a_{k+1}, b_{k+1} \in [1/2, 1) = I_2$ and $d_{k+1}=d_k$. Then $d_{k+2} = d_{k+1}(a_{k+1}+b_{k+1}) \ge d_{k+1}(1+d_{k+1}) = d_k(1+d_k) \ge d_k(1+d_0)$. Case 2: $a_k, b_k \in I_2$. Then $d_{k+1} \ge d_k(1+d_k) \ge d_k(1+d_0)$. Since $d_{k+2} \ge d_{k+1}$, it follows that $d_{k+2} \ge d_k(1+d_0)$. In both cases, the inequality holds.",Show that there exists a positive integer $n$ such that $(a_n - a_{n-1})(b_n - b_{n-1}) < 0$.,"From Sub-problem 1, we need to show that there exists an $n$ such that $a_{n-1}$ and $b_{n-1}$ lie in different subintervals. Assume the contrary: for all $k \ge 0$, $a_k$ and $b_k$ are in the same subinterval. By Sub-problem 2, this implies $d_{k+2} \ge d_k(1+d_0)$, where $d_k = |a_k-b_k|$. By induction, this leads to $d_{2m} \ge d_0(1+d_0)^m$. Since $d_0 = b-a > 0$, the term $(1+d_0)^m$ grows to infinity as $m \to \infty$. Thus, for a large enough $m$, $d_{2m}$ will be greater than 1. However, $a_{2m}$ and $b_{2m}$ both belong to the interval $(0,1)$, so their distance $d_{2m} = |a_{2m}-b_{2m}|$ must be less than 1. This is a contradiction. Therefore, the assumption must be false, and there exists an $n$ such that $a_{n-1}$ and $b_{n-1}$ are in different subintervals.",,
2014c1,Let $n$ points be given inside a rectangle $R$ such that no two of them lie on a line parallel to one of the sides of $R$. The rectangle $R$ is to be dissected into smaller rectangles with sides parallel to the sides of $R$ in such a way that none of these rectangles contains any of the given points in its interior. Prove that we have to dissect $R$ into at least $n+1$ smaller rectangles.,"Let $k$ be the number of rectangles in the dissection. The set of all points that are corners of one of the rectangles can be divided into three disjoint subsets:

\begin{itemize}
  \item $A$, which consists of the four corners of the original rectangle $R$, each of which is the corner of exactly one of the smaller rectangles,
  \item $B$, which contains points where exactly two of the rectangles have a common corner (T-junctions, see the figure below),
  \item $C$, which contains points where four of the rectangles have a common corner (crossings, see the figure below).\\
\includegraphics[max width=\textwidth, center]{2025_04_30_430645cb6b343bf2b1ddg-27}
\end{itemize}

Figure 1: A T-junction and a crossing

We denote the number of points in $B$ by $b$ and the number of points in $C$ by $c$. Since each of the $k$ rectangles has exactly four corners, we get

$$
4 k=4+2 b+4 c .
$$

It follows that $2 b \leqslant 4 k-4$, so $b \leqslant 2 k-2$.\\
Each of the $n$ given points has to lie on a side of one of the smaller rectangles (but not of the original rectangle $R$ ). If we extend this side as far as possible along borders between rectangles, we obtain a line segment whose ends are T-junctions. Note that every point in $B$ can only be an endpoint of at most one such segment containing one of the given points, since it is stated that no two of them lie on a common line parallel to the sides of $R$. This means that

$$
b \geqslant 2 n .
$$

Combining our two inequalities for $b$, we get

$$
2 k-2 \geqslant b \geqslant 2 n,
$$

thus $k \geqslant n+1$, which is what we wanted to prove.",3,Let a rectangle $R$ be dissected into $k$ smaller rectangles with sides parallel to the sides of $R$. Let $b$ be the number of vertices of the dissection that are corners for exactly two of the smaller rectangles (T-junctions). Prove that $b \le 2k - 2$.,"The total number of corners, counting multiplicity, across all $k$ rectangles is $4k$. The vertices of the dissection are of three types: the 4 corners of $R$ (each a corner for 1 rectangle), $b$ T-junctions (each a corner for 2 rectangles), and $c$ crossings (each a corner for 4 rectangles). Summing the corners based on this classification gives the identity $4k = 4 \\cdot 1 + b \\cdot 2 + c \\cdot 4 = 4 + 2b + 4c$. Since the number of crossings $c$ must be non-negative ($c \\ge 0$), we have the inequality $4k \\ge 4 + 2b$. Rearranging gives $4k - 4 \\ge 2b$, which simplifies to $b \\le 2k - 2$.","In the given dissection, each of the $n$ points lies on a boundary line segment. Given that no two of the $n$ points lie on a line parallel to one of the sides of $R$, prove that the number of T-junctions, $b$, must be at least $2n$.","Each of the $n$ points must lie on a line segment forming part of the dissection, as it cannot be in the interior of a small rectangle. Consider the maximal straight line segment of the dissection containing such a point. This segment must have two endpoints. Each endpoint is either on the boundary of the large rectangle $R$ or is an intersection with a perpendicular segment. In either case, it forms a T-junction. Thus, each of the $n$ points is associated with a segment that has two T-junctions as endpoints. The condition that no two points lie on the same line parallel to the sides of $R$ implies these $n$ segments are all distinct. An endpoint cannot be shared by two such segments, as that would form a crossing, not a T-junction. Therefore, we have identified $2n$ distinct T-junctions, and so $b \\ge 2n$.",Let $n$ points be given inside a rectangle $R$ such that no two of them lie on a line parallel to one of the sides of $R$. The rectangle $R$ is to be dissected into smaller rectangles with sides parallel to the sides of $R$ in such a way that none of these rectangles contains any of the given points in its interior. Prove that we have to dissect $R$ into at least $n+1$ smaller rectangles.,"Let $k$ be the number of smaller rectangles and $b$ be the number of T-junctions. From our first sub-problem, we established the relationship $b \\le 2k - 2$. From our second sub-problem, the conditions on the $n$ points imply $b \\ge 2n$. Combining these two inequalities, we have $2k - 2 \\ge b \\ge 2n$. This gives the inequality $2k - 2 \\ge 2n$, which simplifies to $k - 1 \\ge n$, or $k \\ge n+1$. Thus, the rectangle must be dissected into at least $n+1$ smaller rectangles.",,
2014c2,"We have $2^{m}$ sheets of paper, with the number 1 written on each of them. We perform the following operation. In every step we choose two distinct sheets; if the numbers on the two sheets are $a$ and $b$, then we erase these numbers and write the number $a+b$ on both sheets. Prove that after $m 2^{m-1}$ steps, the sum of the numbers on all the sheets is at least $4^{m}$.","Solution. Let $P_{k}$ be the product of the numbers on the sheets after $k$ steps.\\
Suppose that in the $(k+1)^{\text {th }}$ step the numbers $a$ and $b$ are replaced by $a+b$. In the product, the number $a b$ is replaced by $(a+b)^{2}$, and the other factors do not change. Since $(a+b)^{2} \geqslant 4 a b$, we see that $P_{k+1} \geqslant 4 P_{k}$. Starting with $P_{0}=1$, a straightforward induction yields

$$
P_{k} \geqslant 4^{k}
$$

for all integers $k \geqslant 0$; in particular

$$
P_{m \cdot 2^{m-1}} \geqslant 4^{m \cdot 2^{m-1}}=\left(2^{m}\right)^{2^{m}},
$$

so by the AM-GM inequality, the sum of the numbers written on the sheets after $m 2^{m-1}$ steps is at least

$$
2^{m} \cdot \sqrt[2^{m}]{P_{m \cdot 2^{m-1}}} \geqslant 2^{m} \cdot 2^{m}=4^{m} .
$$

Comment 1. It is possible to achieve the sum $4^{m}$ in $m 2^{m-1}$ steps. For example, starting from $2^{m}$ equal numbers on the sheets, in $2^{m-1}$ consecutive steps we can double all numbers. After $m$ such doubling rounds we have the number $2^{m}$ on every sheet.

Comment 2. There are several versions of the solution above. E.g., one may try to assign to each positive integer $n$ a weight $w_{n}$ in such a way that the sum of the weights of the numbers written on the sheets increases, say, by at least 2 in each step. For this purpose, one needs the inequality


\begin{equation*}
2 w_{a+b} \geqslant w_{a}+w_{b}+2 \tag{1}
\end{equation*}


to be satisfied for all positive integers $a$ and $b$.\\
Starting from $w_{1}=1$ and trying to choose the weights as small as possible, one may find that these weights can be defined as follows: For every positive integer $n$, one chooses $k$ to be the maximal integer such that $n \geqslant 2^{k}$, and puts


\begin{equation*}
w_{n}=k+\frac{n}{2^{k}}=\min _{d \in \mathbb{Z} \geq 0}\left(d+\frac{n}{2^{d}}\right) . \tag{2}
\end{equation*}


Now, in order to prove that these weights satisfy (1), one may take arbitrary positive integers $a$ and $b$, and choose an integer $d \geqslant 0$ such that $w_{a+b}=d+\frac{a+b}{2^{d}}$. Then one has

$$
2 w_{a+b}=2 d+2 \cdot \frac{a+b}{2^{d}}=\left((d-1)+\frac{a}{2^{d-1}}\right)+\left((d-1)+\frac{b}{2^{d-1}}\right)+2 \geqslant w_{a}+w_{b}+2 .
$$

Since the initial sum of the weights was $2^{m}$, after $m 2^{m-1}$ steps the sum is at least $(m+1) 2^{m}$. To finish the solution, one may notice that by (2) for every positive integer $a$ one has


\begin{equation*}
w_{a} \leqslant m+\frac{a}{2^{m}}, \quad \text { i.e., } \quad a \geqslant 2^{m}\left(-m+w_{a}\right) . \tag{3}
\end{equation*}


So the sum of the numbers $a_{1}, a_{2}, \ldots, a_{2^{m}}$ on the sheets can be estimated as

$$
\sum_{i=1}^{2^{m}} a_{i} \geqslant \sum_{i=1}^{2^{m}} 2^{m}\left(-m+w_{a_{i}}\right)=-m 2^{m} \cdot 2^{m}+2^{m} \sum_{i=1}^{2^{m}} w_{a_{i}} \geqslant-m 4^{m}+(m+1) 4^{m}=4^{m},
$$

as required.\\
For establishing the inequalities (1) and (3), one may also use the convexity argument, instead of the second definition of $w_{n}$ in (2).

One may check that $\log _{2} n \leqslant w_{n} \leqslant \log _{2} n+1$; thus, in some rough sense, this approach is obtained by ""taking the logarithm"" of the solution above.

Comment 3. An intuitive strategy to minimise the sum of numbers is that in every step we choose the two smallest numbers. We may call this the greedy strategy. In the following paragraphs we prove that the greedy strategy indeed provides the least possible sum of numbers.

Claim. Starting from any sequence $x_{1}, \ldots, x_{N}$ of positive real numbers on $N$ sheets, for any number $k$ of steps, the greedy strategy achieves the lowest possible sum of numbers.

Proof. We apply induction on $k$; for $k=1$ the statement is obvious. Let $k \geqslant 2$, and assume that the claim is true for smaller values.

Every sequence of $k$ steps can be encoded as $S=\left(\left(i_{1}, j_{1}\right), \ldots,\left(i_{k}, j_{k}\right)\right)$, where, for $r=1,2, \ldots, k$, the numbers $i_{r}$ and $j_{r}$ are the indices of the two sheets that are chosen in the $r^{\text {th }}$ step. The resulting final sum will be some linear combination of $x_{1}, \ldots, x_{N}$, say, $c_{1} x_{1}+\cdots+c_{N} x_{N}$ with positive integers $c_{1}, \ldots, c_{N}$ that depend on $S$ only. Call the numbers $\left(c_{1}, \ldots, c_{N}\right)$ the characteristic vector of $S$.

Choose a sequence $S_{0}=\left(\left(i_{1}, j_{1}\right), \ldots,\left(i_{k}, j_{k}\right)\right)$ of steps that produces the minimal sum, starting from $x_{1}, \ldots, x_{N}$, and let $\left(c_{1}, \ldots, c_{N}\right)$ be the characteristic vector of $S$. We may assume that the sheets are indexed in such an order that $c_{1} \geqslant c_{2} \geqslant \cdots \geqslant c_{N}$. If the sheets (and the numbers) are permuted by a permutation $\pi$ of the indices $(1,2, \ldots, N)$ and then the same steps are performed, we can obtain the sum $\sum_{t=1}^{N} c_{t} x_{\pi(t)}$. By the rearrangement inequality, the smallest possible sum can be achieved when the numbers $\left(x_{1}, \ldots, x_{N}\right)$ are in non-decreasing order. So we can assume that also $x_{1} \leqslant x_{2} \leqslant \cdots \leqslant x_{N}$.

Let $\ell$ be the largest index with $c_{1}=\cdots=c_{\ell}$, and let the $r^{\text {th }}$ step be the first step for which $c_{i_{r}}=c_{1}$ or $c_{j_{r}}=c_{1}$. The role of $i_{r}$ and $j_{r}$ is symmetrical, so we can assume $c_{i_{r}}=c_{1}$ and thus $i_{r} \leqslant \ell$. We show that $c_{j_{r}}=c_{1}$ and $j_{r} \leqslant \ell$ hold, too.

Before the $r^{\text {th }}$ step, on the $i_{r}{ }^{\text {th }}$ sheet we had the number $x_{i_{r}}$. On the $j_{r}{ }^{\text {th }}$ sheet there was a linear combination that contains the number $x_{j_{r}}$ with a positive integer coefficient, and possibly some other terms. In the $r^{\text {th }}$ step, the number $x_{i_{r}}$ joins that linear combination. From this point, each sheet contains a linear combination of $x_{1}, \ldots, x_{N}$, with the coefficient of $x_{j_{r}}$ being not smaller than the coefficient of $x_{i_{r}}$. This is preserved to the end of the procedure, so we have $c_{j_{r}} \geqslant c_{i_{r}}$. But $c_{i_{r}}=c_{1}$ is maximal among the coefficients, so we have $c_{j_{r}}=c_{i_{r}}=c_{1}$ and thus $j_{r} \leqslant \ell$.

Either from $c_{j_{r}}=c_{i_{r}}=c_{1}$ or from the arguments in the previous paragraph we can see that none of the $i_{r}{ }^{\text {th }}$ and the $j_{r}{ }^{\text {th }}$ sheets were used before step $r$. Therefore, the final linear combination of the numbers does not change if the step $\left(i_{r}, j_{r}\right)$ is performed first: the sequence of steps

$$
S_{1}=\left(\left(i_{r}, j_{r}\right),\left(i_{1}, j_{1}\right), \ldots,\left(i_{r-1}, j_{r-1}\right),\left(i_{r+1}, j_{r+1}\right), \ldots,\left(i_{N}, j_{N}\right)\right)
$$

also produces the same minimal sum at the end. Therefore, we can replace $S_{0}$ by $S_{1}$ and we may assume that $r=1$ and $c_{i_{1}}=c_{j_{1}}=c_{1}$.

As $i_{1} \neq j_{1}$, we can see that $\ell \geqslant 2$ and $c_{1}=c_{2}=c_{i_{1}}=c_{j_{1}}$. Let $\pi$ be such a permutation of the indices $(1,2, \ldots, N)$ that exchanges 1,2 with $i_{r}, j_{r}$ and does not change the remaining indices. Let

$$
S_{2}=\left(\left(\pi\left(i_{1}\right), \pi\left(j_{1}\right)\right), \ldots,\left(\pi\left(i_{N}\right), \pi\left(j_{N}\right)\right)\right)
$$

Since $c_{\pi(i)}=c_{i}$ for all indices $i$, this sequence of steps produces the same, minimal sum. Moreover, in the first step we chose $x_{\pi\left(i_{1}\right)}=x_{1}$ and $x_{\pi\left(j_{1}\right)}=x_{2}$, the two smallest numbers.

Hence, it is possible to achieve the optimal sum if we follow the greedy strategy in the first step. By the induction hypothesis, following the greedy strategy in the remaining steps we achieve the optimal sum.",4,"Let $P$ be the product of all numbers on the sheets. If we choose two sheets with numbers $a$ and $b$ and perform the operation, let the new product be $P'$. Show that $P' \ge 4P$.","The operation replaces the numbers $a$ and $b$ with $a+b$ on both sheets. The product of the numbers on these two sheets changes from $ab$ to $(a+b)^2$. All other numbers on the remaining sheets are unchanged. Thus, the new total product is $P' = P \cdot \frac{(a+b)^2}{ab}$. The inequality $P' \ge 4P$ is equivalent to showing $\frac{(a+b)^2}{ab} \ge 4$, which is $(a+b)^2 \ge 4ab$. This simplifies to $a^2 + 2ab + b^2 \ge 4ab$, or $(a-b)^2 \ge 0$, which is always true.","Let $P_k$ be the product of the numbers on the sheets after $k$ steps. Given that initially all $2^m$ numbers are 1, prove that $P_k \ge 4^k$ for all integers $k \ge 0$.","We use induction on $k$. For the base case $k=0$, the product is $P_0 = 1^{2^m} = 1$. The inequality $P_0 \ge 4^0=1$ holds. For the inductive step, assume $P_k \ge 4^k$ for some $k \ge 0$. In step $k+1$, from the previous sub-problem, we know $P_{k+1} \ge 4P_k$. Using the induction hypothesis, we get $P_{k+1} \ge 4 \cdot 4^k = 4^{k+1}$. Therefore, the statement holds for all $k \ge 0$ by induction.",Let $S_k$ be the sum and $P_k$ be the product of the $2^m$ numbers on the sheets after $k$ steps. Establish a lower bound for $S_k$ in terms of $P_k$ and $m$.,"By the Arithmetic Mean-Geometric Mean (AM-GM) inequality on the $N=2^m$ non-negative numbers on the sheets, their arithmetic mean is greater than or equal to their geometric mean: $\frac{S_k}{N} \ge \sqrt[N]{P_k}$. Substituting $N=2^m$, this gives $\frac{S_k}{2^m} \ge \sqrt[2^m]{P_k}$, which implies the lower bound $S_k \ge 2^m \sqrt[2^m]{P_k}$.","Prove that after $m 2^{m-1}$ steps, the sum of the numbers on all the sheets is at least $4^{m}$.","Let $k = m 2^{m-1}$. From the second sub-problem, the product of the numbers is $P_k \ge 4^k = 4^{m 2^{m-1}}$. From the third sub-problem, the sum is $S_k \ge 2^m \sqrt[2^m]{P_k}$. Combining these results, we have $S_k \ge 2^m \sqrt[2^m]{4^{m 2^{m-1}}}$. We simplify the right-hand side: $2^m \cdot (4^{m 2^{m-1}})^{1/2^m} = 2^m \cdot 4^{(m 2^{m-1})/2^m} = 2^m \cdot 4^{m/2} = 2^m \cdot (2^2)^{m/2} = 2^m \cdot 2^m = 4^m$. Thus, the sum is at least $4^m$."
2014c5,"Consider $n \geqslant 3$ lines in the plane such that no two lines are parallel and no three have a common point. These lines divide the plane into polygonal regions; let $\mathcal{F}$ be the set of regions having finite area. Prove that it is possible to colour $\lceil\sqrt{n / 2}\rceil$ of the lines blue in such a way that no region in $\mathcal{F}$ has a completely blue boundary. (For a real number $x,\lceil x\rceil$ denotes the least integer which is not smaller than $x$.)","Solution. Let $L$ be the given set of lines. Choose a maximal (by inclusion) subset $B \subseteq L$ such that when we colour the lines of $B$ blue, no region in $\mathcal{F}$ has a completely blue boundary. Let $|B|=k$. We claim that $k \geqslant\lceil\sqrt{n / 2}\rceil$.

Let us colour all the lines of $L \backslash B$ red. Call a point blue if it is the intersection of two blue lines. Then there are $\binom{k}{2}$ blue points.

Now consider any red line $\ell$. By the maximality of $B$, there exists at least one region $A \in \mathcal{F}$ whose only red side lies on $\ell$. Since $A$ has at least three sides, it must have at least one blue vertex. Let us take one such vertex and associate it to $\ell$.

Since each blue point belongs to four regions (some of which may be unbounded), it is associated to at most four red lines. Thus the total number of red lines is at most $4\binom{k}{2}$. On the other hand, this number is $n-k$, so

$$
n-k \leqslant 2 k(k-1), \quad \text { thus } \quad n \leqslant 2 k^{2}-k \leqslant 2 k^{2},
$$

and finally $k \geqslant\lceil\sqrt{n / 2}\rceil$, which gives the desired result.\\
Comment 1. The constant factor in the estimate can be improved in different ways; we sketch two of them below. On the other hand, the Problem Selection Committee is not aware of any results showing that it is sometimes impossible to colour $k$ lines satisfying the desired condition for $k \gg \sqrt{n}$. In this situation we find it more suitable to keep the original formulation of the problem.

\begin{enumerate}
  \item Firstly, we show that in the proof above one has in fact $k=|B| \geqslant\lceil\sqrt{2 n / 3}\rceil$.
\end{enumerate}

Let us make weighted associations as follows. Let a region $A$ whose only red side lies on $\ell$ have $k$ vertices, so that $k-2$ of them are blue. We associate each of these blue vertices to $\ell$, and put the weight $\frac{1}{k-2}$ on each such association. So the sum of the weights of all the associations is exactly $n-k$.

Now, one may check that among the four regions adjacent to a blue vertex $v$, at most two are triangles. This means that the sum of the weights of all associations involving $v$ is at most $1+1+\frac{1}{2}+\frac{1}{2}=3$. This leads to the estimate

$$
n-k \leqslant 3\binom{k}{2}
$$

or

$$
2 n \leqslant 3 k^{2}-k<3 k^{2},
$$

which yields $k \geqslant\lceil\sqrt{2 n / 3}\rceil$.\\
2. Next, we even show that $k=|B| \geqslant\lceil\sqrt{n}\rceil$. For this, we specify the process of associating points to red lines in one more different way.

Call a point red if it lies on a red line as well as on a blue line. Consider any red line $\ell$, and take an arbitrary region $A \in \mathcal{F}$ whose only red side lies on $\ell$. Let $r^{\prime}, r, b_{1}, \ldots, b_{k}$ be its vertices in clockwise order with $r^{\prime}, r \in \ell$; then the points $r^{\prime}, r$ are red, while all the points $b_{1}, \ldots, b_{k}$ are blue. Let us associate to $\ell$ the red point $r$ and the blue point $b_{1}$. One may notice that to each pair of a red point $r$ and a blue point $b$, at most one red line can be associated, since there is at most one region $A$ having $r$ and $b$ as two clockwise consecutive vertices.

We claim now that at most two red lines are associated to each blue point $b$; this leads to the desired bound

$$
n-k \leqslant 2\binom{k}{2} \quad \Longleftrightarrow \quad n \leqslant k^{2} .
$$

Assume, to the contrary, that three red lines $\ell_{1}, \ell_{2}$, and $\ell_{3}$ are associated to the same blue point $b$. Let $r_{1}, r_{2}$, and $r_{3}$ respectively be the red points associated to these lines; all these points are distinct. The point $b$ defines four blue rays, and each point $r_{i}$ is the red point closest to $b$ on one of these rays. So we may assume that the points $r_{2}$ and $r_{3}$ lie on one blue line passing through $b$, while $r_{1}$ lies on the other one.\\
\includegraphics[max width=\textwidth, center]{2025_04_30_430645cb6b343bf2b1ddg-36}

Now consider the region $A$ used to associate $r_{1}$ and $b$ with $\ell_{1}$. Three of its clockwise consecutive vertices are $r_{1}, b$, and either $r_{2}$ or $r_{3}\left(\right.$ say, $\left.r_{2}\right)$. Since $A$ has only one red side, it can only be the triangle $r_{1} b r_{2}$; but then both $\ell_{1}$ and $\ell_{2}$ pass through $r_{2}$, as well as some blue line. This is impossible by the problem assumptions.

Comment 2. The condition that the lines be non-parallel is essentially not used in the solution, nor in the previous comment; thus it may be omitted.",4,Let $L$ be the set of $n$ lines. Let $B \subseteq L$ be a maximal set of lines that can be colored blue such that no finite region has a completely blue boundary. Let a line $\\ell \\in L \\setminus B$ be colored red. Show that there must exist a finite region whose boundary consists of the red line $\\ell$ and some blue lines from $B$.,"By the maximality of $B$, if we were to color the red line $\\ell$ blue, there would be a finite region $A$ with a completely blue boundary. The boundary of this region $A$ must be formed by $\\ell$ and some lines from the original set $B$. Therefore, before coloring $\\ell$ blue, $A$ is a finite region whose boundary is composed of the red line $\\ell$ and some blue lines from $B$. Thus, such a region exists.","For any red line $\\ell$, show that there is at least one 'blue point' (an intersection of two blue lines) that is a vertex of a finite region $A$ whose only red side lies on $\\ell$.","From the previous sub-problem, for any red line $\\ell$, there exists a finite region $A$ whose only red side lies on $\\ell$. Since $n \\ge 3$, any finite region is a polygon with at least 3 sides. As $A$ has only one red side, it must have at least two blue sides. The vertex where these two blue sides meet is an intersection of two blue lines, which is by definition a blue point. Thus, $A$ has at least one blue point as a vertex.","Show that any given blue point is a vertex of at most four finite regions. Hence, it can be associated with at most four red lines through the association defined in the previous step.","A blue point is the intersection of two blue lines. These two lines divide the plane into four angular sectors. A region having this point as a vertex must lie entirely within one of these sectors. Therefore, a blue point can be a vertex of at most four regions in total. Since the association in the previous step links a red line to a blue point via a specific finite region, a single blue point can be associated with at most four red lines.",Consider $n \\geqslant 3$ lines in the plane such that no two lines are parallel and no three have a common point. These lines divide the plane into polygonal regions; let $\\mathcal{F}$ be the set of regions having finite area. Prove that it is possible to colour $\\lceil\\sqrt{n / 2}\rceil$ of the lines blue in such a way that no region in $\\mathcal{F}$ has a completely blue boundary.,"Let $B$ be a maximal set of blue lines satisfying the condition, with $|B|=k$. The remaining $n-k$ lines are red. For each of the $n-k$ red lines, we can associate at least one blue point (intersection of two blue lines), as shown in sub-problem 2. The total number of blue points is $\binom{k}{2}$. From sub-problem 3, each blue point can be associated with at most four red lines. This implies that the total number of red lines is at most four times the total number of blue points. We get the inequality: $n-k \\leqslant 4\binom{k}{2} = 4\frac{k(k-1)}{2} = 2k(k-1)$. This simplifies to $n \\leqslant 2k^2-2k+k = 2k^2-k$. Since $2k^2-k < 2k^2$, we have $n < 2k^2$, which means $k^2 > n/2$, so $k > \\sqrt{n/2}$. As $k$ must be an integer, $k \\geqslant \\lceil\\sqrt{n/2}\rceil$. The existence of such a maximal set $B$ proves the statement."
2014c7,"Let $M$ be a set of $n \geqslant 4$ points in the plane, no three of which are collinear. Initially these points are connected with $n$ segments so that each point in $M$ is the endpoint of exactly two segments. Then, at each step, one may choose two segments $A B$ and $C D$ sharing a common interior point and replace them by the segments $A C$ and $B D$ if none of them is present at this moment. Prove that it is impossible to perform $n^{3} / 4$ or more such moves.","Solution. A line is said to be red if it contains two points of $M$. As no three points of $M$ are collinear, each red line determines a unique pair of points of $M$. Moreover, there are precisely $\binom{n}{2}<\frac{n^{2}}{2}$ red lines. By the value of a segment we mean the number of red lines intersecting it in its interior, and the value of a set of segments is defined to be the sum of the values of its elements. We will prove that $(i)$ the value of the initial set of segments is smaller than $n^{3} / 2$ and that (ii) each step decreases the value of the set of segments present by at least 2 . Since such a value can never be negative, these two assertions imply the statement of the problem.

To show $(i)$ we just need to observe that each segment has a value that is smaller than $n^{2} / 2$. Thus the combined value of the $n$ initial segments is indeed below $n \cdot n^{2} / 2=n^{3} / 2$.

It remains to establish (ii). Suppose that at some moment we have two segments $A B$ and $C D$ sharing an interior point $S$, and that at the next moment we have the two segments $A C$ and $B D$ instead. Let $X_{A B}$ denote the set of red lines intersecting the segment $A B$ in its interior and let the sets $X_{A C}, X_{B D}$, and $X_{C D}$ be defined similarly. We are to prove that $\left|X_{A C}\right|+\left|X_{B D}\right|+2 \leqslant\left|X_{A B}\right|+\left|X_{C D}\right|$.

As a first step in this direction, we claim that


\begin{equation*}
\left|X_{A C} \cup X_{B D}\right|+2 \leqslant\left|X_{A B} \cup X_{C D}\right| . \tag{1}
\end{equation*}


Indeed, if $g$ is a red line intersecting, e.g. the segment $A C$ in its interior, then it has to intersect the triangle $A C S$ once again, either in the interior of its side $A S$, or in the interior of its side $C S$, or at $S$, meaning that it belongs to $X_{A B}$ or to $X_{C D}$ (see Figure 1). Moreover, the red lines $A B$ and $C D$ contribute to $X_{A B} \cup X_{C D}$ but not to $X_{A C} \cup X_{B D}$. Thereby (1) is proved.\\
\includegraphics[max width=\textwidth, center]{2025_04_30_430645cb6b343bf2b1ddg-41(2)}

Figure 1\\
\includegraphics[max width=\textwidth, center]{2025_04_30_430645cb6b343bf2b1ddg-41}

Figure 2\\
\includegraphics[max width=\textwidth, center]{2025_04_30_430645cb6b343bf2b1ddg-41(1)}

Figure 3

Similarly but more easily one obtains


\begin{equation*}
\left|X_{A C} \cap X_{B D}\right| \leqslant\left|X_{A B} \cap X_{C D}\right| . \tag{2}
\end{equation*}


Indeed, a red line $h$ appearing in $X_{A C} \cap X_{B D}$ belongs, for similar reasons as above, also to $X_{A B} \cap X_{C D}$. To make the argument precise, one may just distinguish the cases $S \in h$ (see Figure 2) and $S \notin h$ (see Figure 3). Thereby (2) is proved.

Adding (1) and (2) we obtain the desired conclusion, thus completing the solution of this problem.

Comment 1. There is a problem belonging to the folklore, in the solution of which one may use the same kind of operation:

Given $n$ red and $n$ green points in the plane, prove that one may draw n nonintersecting segments each of which connects a red point with a green point.

A standard approach to this problem consists in taking $n$ arbitrary segments connecting the red points with the green points, and to perform the same operation as in the above proposal whenever an intersection occurs. Now each time one performs such a step, the total length of the segments that are present decreases due to the triangle inequality. So, as there are only finitely many possibilities for the set of segments present, the process must end at some stage.

In the above proposal, however, considering the sum of the Euclidean lengths of the segment that are present does not seem to help much, for even though it shows that the process must necessarily terminate after some finite number of steps, it does not seem to easily yield any upper bound on the number of these steps that grows polynomially with $n$.

One may regard the concept of the value of a segment introduced in the above solution as an appropriately discretised version of Euclidean length suitable for obtaining such a bound.

The Problem Selection Committee still believes the problem to be sufficiently original for the competition.

Comment 2. There are some other essentially equivalent ways of presenting the same solution. E.g., put $M=\left\{A_{1}, A_{2}, \ldots, A_{n}\right\}$, denote the set of segments present at any moment by $\left\{e_{1}, e_{2}, \ldots, e_{n}\right\}$, and called a triple $(i, j, k)$ of indices with $i \neq j$ intersecting, if the line $A_{i} A_{j}$ intersects the segment $e_{k}$. It may then be shown that the number $S$ of intersecting triples satisfies $0 \leqslant S<n^{3}$ at the beginning and decreases by at least 4 in each step.

Comment 3. It is not difficult to construct an example where $c n^{2}$ moves are possible (for some absolute constant $c>0$ ). It would be interesting to say more about the gap between $c n^{2}$ and $c n^{3}$.",4,"Define a 'red line' as a line passing through any two points of M. Define the 'value' of a segment as the number of red lines intersecting its interior, and the 'value of a set of segments' as the sum of their individual values. Prove that the value of the initial set of n segments is less than n^3/2.","There are exactly_nC2_ lines passing through pairs of points in M, so the number of red lines is n(n-1)/2 < n^2/2. The value of any single segment is the number of red lines intersecting its interior, which is strictly less than the total number of red lines, so its value is less than n^2/2. The initial set consists of n segments, so their total value is less than n * (n^2/2) = n^3/2.",Consider a move where two intersecting segments AB and CD are replaced by AC and BD. Let X_{PQ} denote the set of red lines intersecting the segment PQ in its interior. Prove the inequality |X_{AC} U X_{BD}| <= |X_{AB} U X_{CD}| - 2.,"Let S be the intersection of AB and CD. Any red line intersecting segment AC in its interior must pass through the interior of triangle ACS. To exit the triangle, it must intersect either segment AS or CS in their interiors, meaning it must belong to X_{AB} or X_{CD}. Thus, X_{AC} is a subset of X_{AB} U X_{CD}. Similarly, X_{BD} is a subset of X_{AB} U X_{CD}. Therefore, X_{AC} U X_{BD} is a subset of X_{AB} U X_{CD}. Furthermore, the red line defined by points C and D intersects segment AB, and the red line defined by A and B intersects segment CD. These two lines are in X_{AB} U X_{CD} but not in X_{AC} U X_{BD} (as they pass through endpoints). This proves the inequality.","With the same setup as the previous sub-problem, prove that the total value of the set of segments decreases by at least 2 with each move. That is, show |X_{AC}| + |X_{BD}| <= |X_{AB}| + |X_{CD}| - 2.","From the previous sub-problem, we have |X_{AC} U X_{BD}| <= |X_{AB} U X_{CD}| - 2. Additionally, any red line that intersects both AC and BD must cross the interior of the quadrilateral ACBD, and therefore must intersect both of the original diagonals AB and CD. This means X_{AC} n X_{BD} is a subset of X_{AB} n X_{CD}, which implies |X_{AC} n X_{BD}| <= |X_{AB} n X_{CD}|. Using the principle of inclusion-exclusion, |U|+|V| = |U U V| + |U n V|, we add the two inequalities to get |X_{AC}| + |X_{BD}| <= |X_{AB}| + |X_{CD}| - 2.","Let M be a set of n >= 4 points in the plane, no three of which are collinear. Initially these points are connected with n segments so that each point in M is the endpoint of exactly two segments. Then, at each step, one may choose two segments AB and CD sharing a common interior point and replace them by the segments AC and BD if none of them is present at this moment. Prove that it is impossible to perform n^3/4 or more such moves.","Let V_k be the total value of the set of segments after k moves. From our first sub-problem, the initial value V_0 is less than n^3/2. From our third sub-problem, each move decreases the value by at least 2, so V_k <= V_0 - 2k. Since the value of a segment is a count, it cannot be negative, so V_k >= 0. Combining these, we have 0 <= V_k <= V_0 - 2k, which implies 2k <= V_0 < n^3/2. Therefore, k < n^3/4, meaning the number of moves must be less than n^3/4."
2014c9,"There are $n$ circles drawn on a piece of paper in such a way that any two circles intersect in two points, and no three circles pass through the same point. Turbo the snail slides along the circles in the following fashion. Initially he moves on one of the circles in clockwise direction. Turbo always keeps sliding along the current circle until he reaches an intersection with another circle. Then he continues his journey on this new circle and also changes the direction of moving, i.e. from clockwise to anticlockwise or vice versa.

Suppose that Turbo's path entirely covers all circles. Prove that $n$ must be odd.","Replace every cross (i.e. intersection of two circles) by two small circle arcs that indicate the direction in which the snail should leave the cross (see Figure 1.1). Notice that the placement of the small arcs does not depend on the direction of moving on the curves; no matter which direction the snail is moving on the circle arcs, he will follow the same curves (see Figure 1.2). In this way we have a set of curves, that are the possible paths of the snail. Call these curves snail orbits or just orbits. Every snail orbit is a simple closed curve that has no intersection with any other orbit.\\

We prove the following, more general statement.\\
(*) In any configuration of $n$ circles such that no two of them are tangent, the number of snail orbits has the same parity as the number $n$. (Note that it is not assumed that all circle pairs intersect.)

This immediately solves the problem.\\
Let us introduce the following operation that will be called flipping a cross. At a cross, remove the two small arcs of the orbits, and replace them by the other two arcs. Hence, when the snail arrives at a flipped cross, he will continue on the other circle as before, but he will preserve the orientation in which he goes along the circle arcs (see Figure 2).\\

Consider what happens to the number of orbits when a cross is flipped. Denote by $a, b, c$, and $d$ the four arcs that meet at the cross such that $a$ and $b$ belong to the same circle. Before the flipping $a$ and $b$ were connected to $c$ and $d$, respectively, and after the flipping $a$ and $b$ are connected to $d$ and $c$, respectively.

The orbits passing through the cross are closed curves, so each of the arcs $a, b, c$, and $d$ is connected to another one by orbits outside the cross. We distinguish three cases.

Case 1: $a$ is connected to $b$ and $c$ is connected to $d$ by the orbits outside the cross (see Figure 3.1).

We show that this case is impossible. Remove the two small arcs at the cross, connect $a$ to $b$, and connect $c$ to $d$ at the cross. Let $\gamma$ be the new closed curve containing $a$ and $b$, and let $\delta$ be the new curve that connects $c$ and $d$. These two curves intersect at the cross. So one of $c$ and $d$ is inside $\gamma$ and the other one is outside $\gamma$. Then the two closed curves have to meet at least one more time, but this is a contradiction, since no orbit can intersect itself.\\

Case 2: $a$ is connected to $c$ and $b$ is connected to $d$ (see Figure 3.2).\\
Before the flipping $a$ and $c$ belong to one orbit and $b$ and $d$ belong to another orbit. Flipping the cross merges the two orbits into a single orbit. Hence, the number of orbits decreases by 1.

Case 3: $a$ is connected to $d$ and $b$ is connected to $c$ (see Figure 3.3).\\
Before the flipping the arcs $a, b, c$, and $d$ belong to a single orbit. Flipping the cross splits that orbit in two. The number of orbits increases by 1.

As can be seen, every flipping decreases or increases the number of orbits by one, thus changes its parity.

Now flip every cross, one by one. Since every pair of circles has 0 or 2 intersections, the number of crosses is even. Therefore, when all crosses have been flipped, the original parity of the number of orbits is restored. So it is sufficient to prove $(*)$ for the new configuration, where all crosses are flipped. Of course also in this new configuration the (modified) orbits are simple closed curves not intersecting each other.

Orient the orbits in such a way that the snail always moves anticlockwise along the circle arcs. Figure 4 shows the same circles as in Figure 1 after flipping all crosses and adding orientation. (Note that this orientation may be different from the orientation of the orbit as a planar curve; the orientation of every orbit may be negative as well as positive, like the middle orbit in Figure 4.) If the snail moves around an orbit, the total angle change in his moving direction, the total curvature, is either $+2 \pi$ or $-2 \pi$, depending on the orientation of the orbit. Let $P$ and $N$ be the number of orbits with positive and negative orientation, respectively. Then the total curvature of all orbits is $(P-N) \cdot 2 \pi$.\\

Double-count the total curvature of all orbits. Along every circle the total curvature is $2 \pi$. At every cross, the two turnings make two changes with some angles having the same absolute value but opposite signs, as depicted in Figure 5. So the changes in the direction at the crosses cancel out. Hence, the total curvature is $n \cdot 2 \pi$.

Now we have $(P-N) \cdot 2 \pi=n \cdot 2 \pi$, so $P-N=n$. The number of (modified) orbits is $P+N$, that has a same parity as $P-N=n$.",4,Define an operation called 'flipping a cross' and prove that it changes the number of snail orbits by exactly one.,"At an intersection (a 'cross'), the snail's path connects the four incoming circle arcs in pairs. 'Flipping' means changing this pairing. Let the arcs be $a, b$ on the first circle and $c, d$ on the second. The original path might connect $a-c$ and $b-d$. A flip would change this to $a-d$ and $b-c$. Depending on how the arcs are connected by the orbits outside the cross, this operation either merges two separate orbits into one (decreasing the orbit count by 1) or splits a single orbit into two (increasing the orbit count by 1). A case where arcs on the same circle are connected externally is impossible by the Jordan Curve Theorem. Thus, flipping a cross always changes the number of orbits by \pm 1.",Show that the parity of the number of orbits in the original configuration is the same as the parity of the number of orbits in a configuration where every cross has been flipped.,"Any two circles intersect at two points, so for $n$ circles, the total number of crosses is $2 \binom{n}{2} = n(n-1)$, which is always an even number. From the previous sub-problem, each flip changes the parity of the number of orbits. Since we perform an even number of flips to get from the original configuration to the all-flipped configuration, the final parity of the orbit count must be the same as the initial parity.","In the 'all-flipped' configuration, where the direction of movement (e.g., clockwise) is preserved when changing circles, prove that the number of orbits has the same parity as $n$.","Let's compute the total curvature of all orbits in the all-flipped configuration. Each orbit is a simple closed curve, so its curvature is $\pm 2\pi$. If there are $P$ orbits with positive curvature and $N$ with negative, the total curvature is $(P-N)2\pi$. Alternatively, the sum of curvatures along the $n$ circles is $n \cdot 2\pi$, and in this all-flipped state, the turns at intersections cancel out. Equating the two expressions gives $(P-N)2\pi = n \cdot 2\pi$, which implies $P-N=n$. The total number of orbits is $P+N$. Since $(P+N) - (P-N) = 2N$ is even, $P+N$ and $P-N$ have the same parity. Therefore, the number of orbits has the same parity as $n$.","There are $n$ circles drawn on a piece of paper in such a way that any two circles intersect in two points, and no three circles pass through the same point. A snail's path, defined by switching circles and reversing direction at each intersection, entirely covers all circles. Prove that $n$ must be odd.","From Sub-problem 2, the parity of the number of orbits in the original configuration is the same as in the all-flipped configuration. From Sub-problem 3, the number of orbits in the all-flipped configuration has the same parity as $n$. Therefore, the original number of orbits has the same parity as $n$. The condition that the path entirely covers all circles means there is exactly one orbit. Setting the number of orbits to 1, we have $1 \equiv n \pmod{2}$. This implies that $n$ must be odd."
2014g1,"The points $P$ and $Q$ are chosen on the side $B C$ of an acute-angled triangle $A B C$ so that $\angle P A B=\angle A C B$ and $\angle Q A C=\angle C B A$. The points $M$ and $N$ are taken on the rays $A P$ and $A Q$, respectively, so that $A P=P M$ and $A Q=Q N$. Prove that the lines $B M$ and $C N$ intersect on the circumcircle of the triangle $A B C$.","Denote by $S$ the intersection point of the lines $B M$ and $C N$. Let moreover $\beta=\angle Q A C=\angle C B A$ and $\gamma=\angle P A B=\angle A C B$. From these equalities it follows that the triangles $A B P$ and $C A Q$ are similar. Therefore we obtain

$$
\frac{B P}{P M}=\frac{B P}{P A}=\frac{A Q}{Q C}=\frac{N Q}{Q C} .
$$

Moreover,

$$
\angle B P M=\beta+\gamma=\angle C Q N .
$$

Hence the triangles $B P M$ and $N Q C$ are similar. This gives $\angle B M P=\angle N C Q$, so the triangles $B P M$ and $B S C$ are also similar. Thus we get

$$
\angle C S B=\angle B P M=\beta+\gamma=180^{\circ}-\angle B A C,
$$

which completes the solution.\\",2,Let all points be defined as in the original problem. Prove that triangle $BPM$ is similar to triangle $QNC$.,"Let $\beta = \angle CBA$ and $\gamma = \angle ACB$. The given conditions are $\angle PAB = \gamma$ and $\angle QAC = \beta$. In $\triangle ABP$ and $\triangle CAQ$, we have $\angle ABP = \beta$, $\angle PAB = \gamma$ and $\angle ACQ = \gamma$, $\angle QAC = \beta$. Thus, by AA similarity, $\triangle ABP \sim \triangle CAQ$. This implies the ratio of corresponding sides is equal: $\frac{BP}{AQ} = \frac{AP}{CQ}$. Using the given conditions $AP=PM$ and $AQ=QN$, this becomes $\frac{BP}{QN} = \frac{PM}{CQ}$, which rearranges to $\frac{BP}{PM} = \frac{QN}{CQ}$. In $\triangle ABP$, $\angle APB = 180^\circ - (\beta+\gamma)$, and since M is on the ray AP, $\angle BPM = 180^\circ - \angle APB = \beta+\gamma$. Similarly, $\angle CQN = \beta+\gamma$. With proportional sides and equal included angles ($\angle BPM = \angle CQN$), we have $\triangle BPM \sim \triangle QNC$ by SAS similarity.",Prove that the lines $B M$ and $C N$ intersect on the circumcircle of the triangle $A B C$.,"Let $S$ be the intersection of lines $BM$ and $CN$. From the similarity $\triangle BPM \sim \triangle QNC$ established previously, we have that corresponding angles are equal, so $\angle PMB = \angle QCN$. As $S$ lies on $BM$ and $CN$, this means $\angle SMB = \angle SCB$. Now, consider $\triangle BPM$ and $\triangle BSC$. They share the angle at B, so $\angle PBM = \angle SBC$. Since we also have $\angle PMB = \angle SCB$ (which is $\angle PMB = \angle QCN$), we conclude that $\triangle BPM \sim \triangle BSC$ by AA similarity. Therefore, their third angles must be equal: $\angle BSC = \angle BPM$. We have already shown that $\angle BPM = \angle CBA + \angle ACB = 180^\circ - \angle BAC$. So, $\angle BSC = 180^\circ - \angle BAC$, which implies $\angle BSC + \angle BAC = 180^\circ$. This is the condition for the quadrilateral $ABSC$ to be cyclic, meaning $S$ lies on the circumcircle of $\triangle ABC$.",,,,
2014g2,"Let $A B C$ be a triangle. The points $K, L$, and $M$ lie on the segments $B C, C A$, and $A B$, respectively, such that the lines $A K, B L$, and $C M$ intersect in a common point. Prove that it is possible to choose two of the triangles $A L M, B M K$, and $C K L$ whose inradii sum up to at least the inradius of the triangle $A B C$.","Solution. Denote

$$
a=\frac{B K}{K C}, \quad b=\frac{C L}{L A}, \quad c=\frac{A M}{M B} .
$$

By Ceva's theorem, $a b c=1$, so we may, without loss of generality, assume that $a \geqslant 1$. Then at least one of the numbers $b$ or $c$ is not greater than 1 . Therefore at least one of the pairs $(a, b)$, $(b, c)$ has its first component not less than 1 and the second one not greater than 1 . Without loss of generality, assume that $1 \leqslant a$ and $b \leqslant 1$.

Therefore, we obtain $b c \leqslant 1$ and $1 \leqslant c a$, or equivalently

$$
\frac{A M}{M B} \leqslant \frac{L A}{C L} \quad \text { and } \quad \frac{M B}{A M} \leqslant \frac{B K}{K C} .
$$

The first inequality implies that the line passing through $M$ and parallel to $B C$ intersects the segment $A L$ at a point $X$ (see Figure 1). Therefore the inradius of the triangle $A L M$ is not less than the inradius $r_{1}$ of triangle $A M X$.

Similarly, the line passing through $M$ and parallel to $A C$ intersects the segment $B K$ at a point $Y$, so the inradius of the triangle $B M K$ is not less than the inradius $r_{2}$ of the triangle $B M Y$. Thus, to complete our solution, it is enough to show that $r_{1}+r_{2} \geqslant r$, where $r$ is the inradius of the triangle $A B C$. We prove that in fact $r_{1}+r_{2}=r$.\\
\includegraphics[max width=\textwidth, center]{2025_04_30_430645cb6b343bf2b1ddg-52}

Figure 1\\
Since $M X \| B C$, the dilation with centre $A$ that takes $M$ to $B$ takes the incircle of the triangle $A M X$ to the incircle of the triangle $A B C$. Therefore

$$
\frac{r_{1}}{r}=\frac{A M}{A B}, \quad \text { and similarly } \quad \frac{r_{2}}{r}=\frac{M B}{A B} .
$$

Adding these equalities gives $r_{1}+r_{2}=r$, as required.\\
Comment. Alternatively, one can use Desargues' theorem instead of Ceva's theorem, as follows: The lines $A B, B C, C A$ dissect the plane into seven regions. One of them is bounded, and amongst the other six, three are two-sided and three are three-sided. Now define the points $P=B C \cap L M$, $Q=C A \cap M K$, and $R=A B \cap K L$ (in the projective plane). By Desargues' theorem, the points $P$, $Q, R$ lie on a common line $\ell$. This line intersects only unbounded regions. If we now assume (without loss of generality) that $P, Q$ and $R$ lie on $\ell$ in that order, then one of the segments $P Q$ or $Q R$ lies inside a two-sided region. If, for example, this segment is $P Q$, then the triangles $A L M$ and $B M K$ will satisfy the statement of the problem for the same reason.",3,"Let $K, L, M$ be points on the sides $BC, CA, AB$ of $\triangle ABC$ respectively, such that $AK, BL, CM$ are concurrent. Show that it is possible to relabel the vertices of $\triangle ABC$ such that the segments satisfy the inequalities $\frac{AM}{MB} \le \frac{LA}{CL}$ and $\frac{MB}{AM} \le \frac{BK}{KC}$.","Define the ratios $a = BK/KC$, $b = CL/LA$, and $c = AM/MB$. By Ceva's Theorem, $abc=1$. This implies that at least one ratio is $\ge 1$ and at least one is $\le 1$. By cyclically relabeling the vertices, we can assume without loss of generality that $a \ge 1$ and $b \le 1$. From $abc=1$, it follows that $bc=1/a \le 1$ and $ca=1/b \ge 1$. The inequality $bc \le 1$ is equivalent to $\frac{CL}{LA}\frac{AM}{MB} \le 1$, which gives $\frac{AM}{MB} \le \frac{LA}{CL}$. The inequality $ca \ge 1$ is equivalent to $\frac{AM}{MB}\frac{BK}{KC} \ge 1$, which gives $\frac{BK}{KC} \ge \frac{MB}{AM}$.","Let $M$ be a point on side $AB$ of $\triangle ABC$, $L$ on $AC$, and $K$ on $BC$, satisfying $\frac{AM}{MB} \le \frac{LA}{CL}$ and $\frac{MB}{AM} \le \frac{BK}{KC}$. Let $r_{ALM}$ and $r_{BMK}$ be the respective inradii. Show that $r_{ALM} + r_{BMK} \ge r_{AMX} + r_{BMY}$, where $X$ is on $AC$ with $MX \parallel BC$, and $Y$ is on $BC$ with $MY \parallel AC$.","By Thales' theorem, the condition $\frac{AM}{MB} \le \frac{LA}{CL}$ implies that $X$, the intersection of the line through $M$ parallel to $BC$ with $AC$, lies on the segment $AL$. This geometric arrangement implies $r_{ALM} \ge r_{AMX}$. Similarly, the condition $\frac{MB}{AM} \le \frac{BK}{KC}$ implies that $Y$, the intersection of the line through $M$ parallel to $AC$ with $BC$, lies on segment $BK$. This implies $r_{BMK} \ge r_{BMY}$. Summing these two inequalities gives the desired result.","Let $A B C$ be a triangle. The points $K, L$, and $M$ lie on the segments $B C, C A$, and $A B$, respectively, such that the lines $A K, B L$, and $C M$ intersect in a common point. Prove that it is possible to choose two of the triangles $A L M, B M K$, and $C K L$ whose inradii sum up to at least the inradius of the triangle $A B C$.","By Part 1, we can select two triangles, WLOG $\triangle ALM$ and $\triangle BMK$, that satisfy the conditions of Part 2. Let $r$ be the inradius of $\triangle ABC$. By Part 2, $r_{ALM} + r_{BMK} \ge r_{AMX} + r_{BMY}$. Since $MX \parallel BC$, $\triangle AMX$ is homothetic to $\triangle ABC$ from center $A$, which implies $\frac{r_{AMX}}{r} = \frac{AM}{AB}$. Similarly, $MY \parallel AC$ implies $\triangle BMY$ is homothetic to $\triangle BAC$ from center $B$, so $\frac{r_{BMY}}{r} = \frac{MB}{AB}$. Adding these gives $r_{AMX} + r_{BMY} = r(\frac{AM}{AB} + \frac{MB}{AB}) = r(\frac{AM+MB}{AB}) = r$. Therefore, $r_{ALM} + r_{BMK} \ge r$.",,
2014g3,"Let $\Omega$ and $O$ be the circumcircle and the circumcentre of an acute-angled triangle $A B C$ with $A B>B C$. The angle bisector of $\angle A B C$ intersects $\Omega$ at $M \neq B$. Let $\Gamma$ be the circle with diameter $B M$. The angle bisectors of $\angle A O B$ and $\angle B O C$ intersect $\Gamma$ at points $P$ and $Q$, respectively. The point $R$ is chosen on the line $P Q$ so that $B R=M R$. Prove that $B R \| A C$. (Here we always assume that an angle bisector is a ray.)","Solution. Let $K$ be the midpoint of $B M$, i.e., the centre of $\Gamma$. Notice that $A B \neq B C$ implies $K \neq O$. Clearly, the lines $O M$ and $O K$ are the perpendicular bisectors of $A C$ and $B M$, respectively. Therefore, $R$ is the intersection point of $P Q$ and $O K$.

Let $N$ be the second point of intersection of $\Gamma$ with the line $O M$. Since $B M$ is a diameter of $\Gamma$, the lines $B N$ and $A C$ are both perpendicular to $O M$. Hence $B N \| A C$, and it suffices to prove that $B N$ passes through $R$. Our plan for doing this is to interpret the lines $B N, O K$, and $P Q$ as the radical axes of three appropriate circles.

Let $\omega$ be the circle with diameter $B O$. Since $\angle B N O=\angle B K O=90^{\circ}$, the points $N$ and $K$ lie on $\omega$.

Next we show that the points $O, K, P$, and $Q$ are concyclic. To this end, let $D$ and $E$ be the midpoints of $B C$ and $A B$, respectively. Clearly, $D$ and $E$ lie on the rays $O Q$ and $O P$, respectively. By our assumptions about the triangle $A B C$, the points $B, E, O, K$, and $D$ lie in this order on $\omega$. It follows that $\angle E O R=\angle E B K=\angle K B D=\angle K O D$, so the line $K O$ externally bisects the angle $P O Q$. Since the point $K$ is the centre of $\Gamma$, it also lies on the perpendicular bisector of $P Q$. So $K$ coincides with the midpoint of the arc $P O Q$ of the circumcircle $\gamma$ of triangle $P O Q$.

Thus the lines $O K, B N$, and $P Q$ are pairwise radical axes of the circles $\omega, \gamma$, and $\Gamma$. Hence they are concurrent at $R$, as required.",3,"Let $K$ be the midpoint of $BM$ and $N$ be the second intersection of the circle $\Gamma$ (with diameter $BM$) and the line $OM$. Show that the point $R$ is the intersection of lines $PQ$ and $OK$, and that the condition $BR \parallel AC$ is equivalent to the collinearity of points $B, R, N$.","The condition $BR=MR$ implies $R$ lies on the perpendicular bisector of the segment $BM$. As $B$ and $M$ are on the circumcircle $\Omega$ with center $O$, the line through the center $O$ and the midpoint $K$ of the chord $BM$ is its perpendicular bisector. Thus, the line $OK$ is the perpendicular bisector of $BM$. Since $R$ is on $PQ$ by definition, $R$ is the intersection of $PQ$ and $OK$. The line $OM$ is the perpendicular bisector of the chord $AC$ (since $M$ is the midpoint of arc $AC$), so $OM \perp AC$. Since $N$ lies on the circle $\Gamma$ with diameter $BM$, we have $\angle BNM = 90^\circ$, which implies $BN \perp OM$. As both $BN$ and $AC$ are perpendicular to $OM$, they are parallel. Thus, $BR \parallel AC$ if and only if $R$ lies on the line $BN$.","Let $\omega$ be the circle with diameter $BO$ and let $K$ be the midpoint of $BM$. Prove that the points $O, K, P, Q$ are concyclic.","Let $E$ and $D$ be the midpoints of $AB$ and $BC$. Lines $OP$ and $OQ$ are the angle bisectors of $\angle AOB$ and $\angle BOC$, so they pass through $E$ and $D$ respectively. Since $O$ is the circumcenter, $OE \perp AB$ and $OD \perp BC$, thus $E$ and $D$ lie on $\omega$. As shown in the previous part, $OK \perp BM$, so $\angle OKB = 90^\circ$ and $K$ also lies on $\omega$. In circle $\omega$, we have $\angle POK = \angle EOK = \angle EBK$ and $\angle QOK = \angle DOK = \angle DBK$. Since $BM$ bisects $\angle ABC$, $\angle EBK = \angle DBK$, which implies $\angle POK = \angle QOK$. So, $OK$ bisects $\angle POQ$. As $K$ is the center of $\Gamma$ and $P,Q \in \Gamma$, we have $KP=KQ$. A point on the angle bisector of $\angle POQ$ and equidistant from $P$ and $Q$ must lie on the circumcircle of $\triangle POQ$. Therefore, $O, K, P, Q$ are concyclic.","Let $\Omega$ and $O$ be the circumcircle and the circumcentre of an acute-angled triangle $A B C$ with $A B>B C$. The angle bisector of $\angle A B C$ intersects $\Omega$ at $M \neq B$. Let $\Gamma$ be the circle with diameter $B M$. The angle bisectors of $\angle A O B$ and $\angle B O C$ intersect $\Gamma$ at points $P$ and $Q$, respectively. The point $R$ is chosen on the line $P Q$ so that $B R=M R$. Prove that $B R \| A C$.","From sub-problem 1, the goal is to show that $B, R, N$ are collinear, where $R = PQ \cap OK$. We use the Radical Axis Theorem on three circles: $\Gamma$ (diameter $BM$), $\omega$ (diameter $BO$), and $\gamma$ (the circumcircle of $OPQK$, which exists by sub-problem 2). The radical axis of $\Gamma$ and $\gamma$ is their common chord, $PQ$. The radical axis of $\omega$ and $\gamma$ is their common chord, $OK$. For $\Gamma$ and $\omega$: $B$ is on both. From sub-problem 1, $BN \perp OM$, so $\angle BNO = 90^\circ$, which means $N$ lies on $\omega$. Thus, the line $BN$ is the radical axis of $\Gamma$ and $\omega$. By the Radical Axis Theorem, the three axes $PQ$, $OK$, and $BN$ are concurrent. Since $R$ is the intersection of $PQ$ and $OK$, $R$ must also lie on $BN$. The collinearity of $B, R, N$ implies $BR \parallel AC$, as established in sub-problem 1.",,
2014g4,"Consider a fixed circle $\Gamma$ with three fixed points $A, B$, and $C$ on it. Also, let us fix a real number $\lambda \in(0,1)$. For a variable point $P \notin\{A, B, C\}$ on $\Gamma$, let $M$ be the point on the segment $C P$ such that $C M=\lambda \cdot C P$. Let $Q$ be the second point of intersection of the circumcircles of the triangles $A M P$ and $B M C$. Prove that as $P$ varies, the point $Q$ lies on a fixed circle.","Throughout the solution, we denote by $\Varangle(a, b)$ the directed angle between the lines $a$ and $b$.

Let $D$ be the point on the segment $A B$ such that $B D=\lambda \cdot B A$. We will show that either $Q=D$, or $\Varangle(D Q, Q B)=\Varangle(A B, B C)$; this would mean that the point $Q$ varies over the constant circle through $D$ tangent to $B C$ at $B$, as required.

Denote the circumcircles of the triangles $A M P$ and $B M C$ by $\omega_{A}$ and $\omega_{B}$, respectively. The lines $A P, B C$, and $M Q$ are pairwise radical axes of the circles $\Gamma, \omega_{A}$, and $\omega_{B}$, thus either they are parallel, or they share a common point $X$.

Assume that these lines are parallel (see Figure 1). Then the segments $A P, Q M$, and $B C$ have a common perpendicular bisector; the reflection in this bisector maps the segment $C P$ to $B A$, and maps $M$ to $Q$. Therefore, in this case $Q$ lies on $A B$, and $B Q / A B=C M / C P=$ $B D / A B$; so we have $Q=D$.\\

Now assume that the lines $A P, Q M$, and $B C$ are concurrent at some point $X$ (see Figure 2). Notice that the points $A, B, Q$, and $X$ lie on a common circle $\Omega$ by Miquel's theorem applied to the triangle $X P C$. Let us denote by $Y$ the symmetric image of $X$ about the perpendicular bisector of $A B$. Clearly, $Y$ lies on $\Omega$, and the triangles $Y A B$ and $\triangle X B A$ are congruent. Moreover, the triangle $X P C$ is similar to the triangle $X B A$, so it is also similar to the triangle $Y A B$.

Next, the points $D$ and $M$ correspond to each other in similar triangles $Y A B$ and $X P C$, since $B D / B A=C M / C P=\lambda$. Moreover, the triangles $Y A B$ and $X P C$ are equi-oriented, so $\Varangle(M X, X P)=\Varangle(D Y, Y A)$. On the other hand, since the points $A, Q, X$, and $Y$ lie on $\Omega$, we have $\Varangle(Q Y, Y A)=\Varangle(M X, X P)$. Therefore, $\Varangle(Q Y, Y A)=\Varangle(D Y, Y A)$, so the points $Y, D$, and $Q$ are collinear.

Finally, we have $\Varangle(D Q, Q B)=\Varangle(Y Q, Q B)=\Varangle(Y A, A B)=\Varangle(A B, B X)=\Varangle(A B, B C)$, as desired.",3,"Let $\omega_A$ be the circumcircle of $\triangle AMP$ and $\omega_B$ be the circumcircle of $\triangle BMC$. Show that the lines $AP$, $BC$, and $MQ$ are the radical axes of the three circles $\Gamma$, $\omega_A$, and $\omega_B$, taken pairwise, and therefore are either parallel or concurrent.","The line $AP$ is the radical axis of $\Gamma$ and $\omega_A$ as they both pass through $A$ and $P$. The line $BC$ is the radical axis of $\Gamma$ and $\omega_B$ as they both pass through $B$ and $C$. The line $MQ$ is the radical axis of $\omega_A$ and $\omega_B$ as they both pass through $M$ and $Q$. By the Radical Axis Theorem for three circles, these three lines must be either parallel or concurrent.","Define a fixed point $D$ on the segment $AB$ such that $BD = \lambda \cdot BA$. In the case where the radical axes $AP, BC, MQ$ are concurrent at a point $X$, prove that the points $Q, D$, and $Y$ are collinear, where $Y$ is the reflection of $X$ across the perpendicular bisector of $AB$.","The concurrency at $X$ and the cyclic quadrilaterals $AMPQ$ and $BMCQ$ imply that points $A, B, Q, X$ are concyclic. Let $Y$ be the reflection of $X$ across the perpendicular bisector of $AB$; $Y$ lies on the circumcircle of $\triangle ABQ$. The triangles $\triangle XPC$ and $\triangle YAB$ are similar with the same orientation. Since $CM/CP = BD/BA = \lambda$, points $M$ and $D$ are corresponding points in this similarity, which implies the directed angle equality $\Varangle(DY, YA) = \Varangle(MX, XP)$. From the concyclicity of $A, Q, Y, X$ and the collinearity of $M, Q, X$, we have $\Varangle(QY, YA) = \Varangle(QX, XA) = \Varangle(MX, XP)$. Therefore, $\Varangle(QY, YA) = \Varangle(DY, YA)$, which proves that $Y, D, Q$ are collinear.","Prove that as $P$ varies, the point $Q$ lies on a fixed circle.","Let $D$ be the fixed point on segment $AB$ such that $BD = \lambda \cdot BA$. If the radical axes $AP, BC, MQ$ are parallel, a reflection argument shows that $Q=D$, a fixed point. If the axes are concurrent at $X$, we use the collinearity of $Y, D, Q$ from the previous step. An angle chase shows $\Varangle(DQ, QB) = \Varangle(YQ, QB) = \Varangle(YA, AB)$. The reflection property gives $\Varangle(YA, AB) = \Varangle(BA, XB)$. As $X, B, C$ are collinear, this is $\Varangle(BA, BC)$, a constant angle. The condition $\Varangle(DQ, QB) = \text{constant}$ means $Q$ lies on a fixed circle through the fixed points $D$ and $B$. Both cases place $Q$ on this circle.",,
2014g5,"Let $A B C D$ be a convex quadrilateral with $\angle B=\angle D=90^{\circ}$. Point $H$ is the foot of the perpendicular from $A$ to $B D$. The points $S$ and $T$ are chosen on the sides $A B$ and $A D$, respectively, in such a way that $H$ lies inside triangle $S C T$ and

$$
\angle S H C-\angle B S C=90^{\circ}, \quad \angle T H C-\angle D T C=90^{\circ} .
$$

Prove that the circumcircle of triangle $S H T$ is tangent to the line $B D$.","Solution. Let the line passing through $C$ and perpendicular to the line $S C$ intersect the line $A B$ at $Q$ (see Figure 1). Then

$$
\angle S Q C=90^{\circ}-\angle B S C=180^{\circ}-\angle S H C,
$$

which implies that the points $C, H, S$, and $Q$ lie on a common circle. Moreover, since $S Q$ is a diameter of this circle, we infer that the circumcentre $K$ of triangle $S H C$ lies on the line $A B$. Similarly, we prove that the circumcentre $L$ of triangle $C H T$ lies on the line $A D$.\\
\includegraphics[max width=\textwidth, center]{2025_04_30_430645cb6b343bf2b1ddg-57}

Figure 1\\
In order to prove that the circumcircle of triangle $S H T$ is tangent to $B D$, it suffices to show that the perpendicular bisectors of $H S$ and $H T$ intersect on the line $A H$. However, these two perpendicular bisectors coincide with the angle bisectors of angles $A K H$ and $A L H$. Therefore, in order to complete the solution, it is enough (by the bisector theorem) to show that


\begin{equation*}
\frac{A K}{K H}=\frac{A L}{L H} . \tag{1}
\end{equation*}


We present two proofs of this equality.\\
First proof. Let the lines $K L$ and $H C$ intersect at $M$ (see Figure 2). Since $K H=K C$ and $L H=L C$, the points $H$ and $C$ are symmetric to each other with respect to the line $K L$. Therefore $M$ is the midpoint of $H C$. Denote by $O$ the circumcentre of quadrilateral $A B C D$. Then $O$ is the midpoint of $A C$. Therefore we have $O M \| A H$ and hence $O M \perp B D$. This together with the equality $O B=O D$ implies that $O M$ is the perpendicular bisector of $B D$ and therefore $B M=D M$.

Since $C M \perp K L$, the points $B, C, M$, and $K$ lie on a common circle with diameter $K C$. Similarly, the points $L, C, M$, and $D$ lie on a circle with diameter $L C$. Thus, using the sine law, we obtain

$$
\frac{A K}{A L}=\frac{\sin \angle A L K}{\sin \angle A K L}=\frac{D M}{C L} \cdot \frac{C K}{B M}=\frac{C K}{C L}=\frac{K H}{L H},
$$

which finishes the proof of (1).\\
\includegraphics[max width=\textwidth, center]{2025_04_30_430645cb6b343bf2b1ddg-58(1)}

Figure 2\\
\includegraphics[max width=\textwidth, center]{2025_04_30_430645cb6b343bf2b1ddg-58}

Figure 3

Second proof. If the points $A, H$, and $C$ are collinear, then $A K=A L$ and $K H=L H$, so the equality (1) follows. Assume therefore that the points $A, H$, and $C$ do not lie in a line and consider the circle $\omega$ passing through them (see Figure 3). Since the quadrilateral $A B C D$ is cyclic,

$$
\angle B A C=\angle B D C=90^{\circ}-\angle A D H=\angle H A D
$$

Let $N \neq A$ be the intersection point of the circle $\omega$ and the angle bisector of $\angle C A H$. Then $A N$ is also the angle bisector of $\angle B A D$. Since $H$ and $C$ are symmetric to each other with respect to the line $K L$ and $H N=N C$, it follows that both $N$ and the centre of $\omega$ lie on the line $K L$. This means that the circle $\omega$ is an Apollonius circle of the points $K$ and $L$. This immediately yields (1).

Comment. Either proof can be used to obtain the following generalised result:\\
Let $A B C D$ be a convex quadrilateral and let $H$ be a point in its interior with $\angle B A C=\angle D A H$. The points $S$ and $T$ are chosen on the sides $A B$ and $A D$, respectively, in such a way that $H$ lies inside triangle SCT and

$$
\angle S H C-\angle B S C=90^{\circ}, \quad \angle T H C-\angle D T C=90^{\circ} .
$$

Then the circumcentre of triangle SHT lies on the line AH (and moreover the circumcentre of triangle SCT lies on $A C$ ).",4,"Let $K$ and $L$ be the circumcenters of triangles $S H C$ and $T H C$, respectively. Show that point $K$ lies on the line $A B$ and point $L$ lies on the line $A D$.","Let the line through $C$ perpendicular to $SC$ intersect line $AB$ at $Q$. Then $\angle SCQ = 90^\circ$. In $\triangle BSQ$, $\angle SQC = 90^\circ - \angle BSC$. From the given condition $\angle SHC - \angle BSC = 90^\circ$, we get $\angle BSC = \angle SHC - 90^\circ$. Substituting this, we have $\angle SQC = 90^\circ - (\angle SHC - 90^\circ) = 180^\circ - \angle SHC$. This implies that the points $C, H, S, Q$ are concyclic. Since $\angle SCQ = 90^\circ$, $SQ$ is a diameter of this circle. The circumcenter $K$ of $\triangle SHC$ is the midpoint of $SQ$. As $S$ and $Q$ both lie on line $AB$, $K$ must also lie on $AB$. A symmetric argument shows that the circumcenter $L$ of $\triangle THC$ lies on line $AD$.","With $K$ and $L$ defined as the circumcenters of $\triangle SHC$ and $\triangle THC$, prove the relation $\frac{A K}{K H}=\frac{A L}{L H}$.","Since $K$ is the circumcenter of $\triangle SHC$, $KH = KC$. Similarly, $LH=LC$. Let the lines $KL$ and $HC$ intersect at $M$. The line $KL$ is the perpendicular bisector of the segment $HC$. Let $O$ be the midpoint of $AC$. Since $\angle B = \angle D = 90^\circ$, $O$ is the circumcenter of quadrilateral $ABCD$. In $\triangle AHC$, $OM$ connects the midpoints of $AC$ and $HC$ (by Thales' theorem), so $OM \parallel AH$. Since $AH \perp BD$, we have $OM \perp BD$. As $O$ is the circumcenter of $ABCD$, $OB=OD$, so $OM$ is the perpendicular bisector of $BD$, which implies $BM=DM$. Since $\angle KMC = 90^\circ$ and $\angle KBC=90^\circ$, points $B, C, M, K$ are concyclic. Similarly, $L, C, M, D$ are concyclic. By the Law of Sines in $\triangle AKL$, we have $\frac{AK}{AL} = \frac{\sin\angle ALK}{\sin\angle AKL} = \frac{\sin\angle DCM}{\sin\angle BCM} = \frac{DM/LC}{BM/KC} = \frac{KC}{LC}$. Using $KC=KH$ and $LC=LH$, we get $\frac{AK}{AL} = \frac{KH}{LH}$, which is equivalent to $\frac{AK}{KH} = \frac{AL}{LH}$.",Show that the circumcenter of triangle $SHT$ lies on the line $AH$.,"The circumcenter of $\triangle SHT$ is the intersection of the perpendicular bisectors of its sides, $HS$ and $HT$. From the proof of the first sub-problem, $K$ is the circumcenter of the circle passing through $S, H, C, Q$. Therefore, $KH = KS$. This means $K$ lies on the perpendicular bisector of $HS$. Since $A,S,K$ are collinear on line $AB$, the perpendicular bisector of $HS$ in the isosceles triangle $KHS$ is also the angle bisector of $\angle AKH$. Similarly, the perpendicular bisector of $HT$ is the angle bisector of $\angle ALH$. Let the intersection of these two bisectors be $P$. Let the angle bisector of $\angle AKH$ intersect $AH$ at $P_1$. By the Angle Bisector Theorem in $\triangle AKH$, $\frac{AP_1}{P_1H} = \frac{AK}{KH}$. Similarly, let the angle bisector of $\angle ALH$ intersect $AH$ at $P_2$. In $\triangle ALH$, $\frac{AP_2}{P_2H} = \frac{AL}{LH}$. From the second sub-problem, we know $\frac{AK}{KH}=\frac{AL}{LH}$. Thus, $P_1=P_2$, which means the two angle bisectors intersect on the line $AH$. Therefore, the circumcenter of $\triangle SHT$ lies on $AH$.",Prove that the circumcircle of triangle $S H T$ is tangent to the line $B D$.,"Let $O_{SHT}$ be the circumcenter of $\triangle SHT$. From the third sub-problem, $O_{SHT}$ lies on the line $AH$. The segment $O_{SHT}H$ is a radius of the circumcircle of $\triangle SHT$. By the problem statement, $H$ is the foot of the perpendicular from $A$ to $BD$, which means the line $AH$ is perpendicular to the line $BD$. Since the radius $O_{SHT}H$ lies on the line $AH$, it is perpendicular to the line $BD$ at point $H$. A line that is perpendicular to a radius at its endpoint on the circle is tangent to the circle. Therefore, the line $BD$ is tangent to the circumcircle of $\triangle SHT$ at point $H$."
2014g6,"Let $A B C$ be a fixed acute-angled triangle. Consider some points $E$ and $F$ lying on the sides $A C$ and $A B$, respectively, and let $M$ be the midpoint of $E F$. Let the perpendicular bisector of $E F$ intersect the line $B C$ at $K$, and let the perpendicular bisector of $M K$ intersect the lines $A C$ and $A B$ at $S$ and $T$, respectively. We call the pair $(E, F)$ interesting, if the quadrilateral $K S A T$ is cyclic.

Suppose that the pairs $\left(E_{1}, F_{1}\right)$ and $\left(E_{2}, F_{2}\right)$ are interesting. Prove that

$$
\frac{E_{1} E_{2}}{A B}=\frac{F_{1} F_{2}}{A C} .
$$","For any interesting pair $(E, F)$, we will say that the corresponding triangle $E F K$ is also interesting.

Let $E F K$ be an interesting triangle. Firstly, we prove that $\angle K E F=\angle K F E=\angle A$, which also means that the circumcircle $\omega_{1}$ of the triangle $A E F$ is tangent to the lines $K E$ and $K F$.

Denote by $\omega$ the circle passing through the points $K, S, A$, and $T$. Let the line $A M$ intersect the line $S T$ and the circle $\omega$ (for the second time) at $N$ and $L$, respectively (see Figure 1).

Since $E F \| T S$ and $M$ is the midpoint of $E F, N$ is the midpoint of $S T$. Moreover, since $K$ and $M$ are symmetric to each other with respect to the line $S T$, we have $\angle K N S=\angle M N S=$ $\angle L N T$. Thus the points $K$ and $L$ are symmetric to each other with respect to the perpendicular bisector of $S T$. Therefore $K L \| S T$.

Let $G$ be the point symmetric to $K$ with respect to $N$. Then $G$ lies on the line $E F$, and we may assume that it lies on the ray $M F$. One has

$$
\angle K G E=\angle K N S=\angle S N M=\angle K L A=180^{\circ}-\angle K S A
$$

(if $K=L$, then the angle $K L A$ is understood to be the angle between $A L$ and the tangent to $\omega$ at $L$ ). This means that the points $K, G, E$, and $S$ are concyclic. Now, since $K S G T$ is a parallelogram, we obtain $\angle K E F=\angle K S G=180^{\circ}-\angle T K S=\angle A$. Since $K E=K F$, we also have $\angle K F E=\angle K E F=\angle A$.

After having proved this fact, one may finish the solution by different methods.\\

First method. We have just proved that all interesting triangles are similar to each other. This allows us to use the following lemma.

Lemma. Let $A B C$ be an arbitrary triangle. Choose two points $E_{1}$ and $E_{2}$ on the side $A C$, two points $F_{1}$ and $F_{2}$ on the side $A B$, and two points $K_{1}$ and $K_{2}$ on the side $B C$, in a way that the triangles $E_{1} F_{1} K_{1}$ and $E_{2} F_{2} K_{2}$ are similar. Then the six circumcircles of the triangles $A E_{i} F_{i}$, $B F_{i} K_{i}$, and $C E_{i} K_{i}(i=1,2)$ meet at a common point $Z$. Moreover, $Z$ is the centre of the spiral similarity that takes the triangle $E_{1} F_{1} K_{1}$ to the triangle $E_{2} F_{2} K_{2}$.\\
Proof. Firstly, notice that for each $i=1,2$, the circumcircles of the triangles $A E_{i} F_{i}, B F_{i} K_{i}$, and $C K_{i} E_{i}$ have a common point $Z_{i}$ by MiquEL's theorem. Moreover, we have\\
$\npreceq\left(Z_{i} F_{i}, Z_{i} E_{i}\right)=\nsucceq(A B, C A), \quad \nsucceq\left(Z_{i} K_{i}, Z_{i} F_{i}\right)=\npreceq(B C, A B), \quad \nsucceq\left(Z_{i} E_{i}, Z_{i} K_{i}\right)=\npreceq(C A, B C)$.\\
This yields that the points $Z_{1}$ and $Z_{2}$ correspond to each other in similar triangles $E_{1} F_{1} K_{1}$ and $E_{2} F_{2} K_{2}$. Thus, if they coincide, then this common point is indeed the desired centre of a spiral similarity.

Finally, in order to show that $Z_{1}=Z_{2}$, one may notice that $\Varangle\left(A B, A Z_{1}\right)=\Varangle\left(E_{1} F_{1}, E_{1} Z_{1}\right)=$ $\Varangle\left(E_{2} F_{2}, E_{2} Z_{2}\right)=\Varangle\left(A B, A Z_{2}\right)$ (see Figure 2). Similarly, one has $\Varangle\left(B C, B Z_{1}\right)=\Varangle\left(B C, B Z_{2}\right)$ and $\Varangle\left(C A, C Z_{1}\right)=\Varangle\left(C A, C Z_{2}\right)$. This yields $Z_{1}=Z_{2}$.

Now, let $P$ and $Q$ be the feet of the perpendiculars from $B$ and $C$ onto $A C$ and $A B$, respectively, and let $R$ be the midpoint of $B C$ (see Figure 3). Then $R$ is the circumcentre of the cyclic quadrilateral $B C P Q$. Thus we obtain $\angle A P Q=\angle B$ and $\angle R P C=\angle C$, which yields $\angle Q P R=\angle A$. Similarly, we show that $\angle P Q R=\angle A$. Thus, all interesting triangles are similar to the triangle $P Q R$.\\

Denote now by $Z$ the common point of the circumcircles of $A P Q, B Q R$, and $C P R$. Let $E_{1} F_{1} K_{1}$ and $E_{2} F_{2} K_{2}$ be two interesting triangles. By the lemma, $Z$ is the centre of any spiral similarity taking one of the triangles $E_{1} F_{1} K_{1}, E_{2} F_{2} K_{2}$, and $P Q R$ to some other of them. Therefore the triangles $Z E_{1} E_{2}$ and $Z F_{1} F_{2}$ are similar, as well as the triangles $Z E_{1} F_{1}$ and $Z P Q$. Hence

$$
\frac{E_{1} E_{2}}{F_{1} F_{2}}=\frac{Z E_{1}}{Z F_{1}}=\frac{Z P}{Z Q}
$$

Moreover, the equalities $\angle A Z Q=\angle A P Q=\angle A B C=180^{\circ}-\angle Q Z R$ show that the point $Z$ lies on the line $A R$ (see Figure 4). Therefore the triangles $A Z P$ and $A C R$ are similar, as well as the triangles $A Z Q$ and $A B R$. This yields

$$
\frac{Z P}{Z Q}=\frac{Z P}{R C} \cdot \frac{R B}{Z Q}=\frac{A Z}{A C} \cdot \frac{A B}{A Z}=\frac{A B}{A C}
$$

which completes the solution.

Second method. Now we will start from the fact that $\omega_{1}$ is tangent to the lines $K E$ and $K F$ (see Figure 5). We prove that if $(E, F)$ is an interesting pair, then

\begin{equation*}
\frac{A E}{A B}+\frac{A F}{A C}=2 \cos \angle A . \tag{1}
\end{equation*}

Let $Y$ be the intersection point of the segments $B E$ and $C F$. The points $B, K$, and $C$ are collinear, hence applying PASCAL's theorem to the degenerated hexagon AFFYEE, we infer that $Y$ lies on the circle $\omega_{1}$.

Denote by $Z$ the second intersection point of the circumcircle of the triangle BFY with the line $B C$ (see Figure 6). By Miquel's theorem, the points $C, Z, Y$, and $E$ are concyclic. Therefore we obtain

$$
B F \cdot A B+C E \cdot A C=B Y \cdot B E+C Y \cdot C F=B Z \cdot B C+C Z \cdot B C=B C^{2} .
$$

On the other hand, $B C^{2}=A B^{2}+A C^{2}-2 A B \cdot A C \cos \angle A$, by the cosine law. Hence

$$
(A B-A F) \cdot A B+(A C-A E) \cdot A C=A B^{2}+A C^{2}-2 A B \cdot A C \cos \angle A,
$$

which simplifies to the desired equality (1).\\
Let now $\left(E_{1}, F_{1}\right)$ and $\left(E_{2}, F_{2}\right)$ be two interesting pairs of points. Then we get

$$
\frac{A E_{1}}{A B}+\frac{A F_{1}}{A C}=\frac{A E_{2}}{A B}+\frac{A F_{2}}{A C},
$$

which gives the desired result.\\

Third method. Again, we make use of the fact that all interesting triangles are similar (and equi-oriented). Let us put the picture onto a complex plane such that $A$ is at the origin, and identify each point with the corresponding complex number.

Let $E F K$ be any interesting triangle. The equalities $\angle K E F=\angle K F E=\angle A$ yield that the ratio $\nu=\frac{K-E}{F-E}$ is the same for all interesting triangles. This in turn means that the numbers $E$, $F$, and $K$ satisfy the linear equation

\begin{equation*}
K=\mu E+\nu F, \quad \text { where } \quad \mu=1-\nu . \tag{2}
\end{equation*}

Now let us choose the points $X$ and $Y$ on the rays $A B$ and $A C$, respectively, so that $\angle C X A=\angle A Y B=\angle A=\angle K E F$ (see Figure 7). Then each of the triangles $A X C$ and $Y A B$ is similar to any interesting triangle, which also means that

\begin{equation*}
C=\mu A+\nu X=\nu X \quad \text { and } \quad B=\mu Y+\nu A=\mu Y \tag{3}
\end{equation*}

Moreover, one has $X / Y=\overline{C / B}$.\\
Since the points $E, F$, and $K$ lie on $A C, A B$, and $B C$, respectively, one gets

$$
E=\rho Y, \quad F=\sigma X, \quad \text { and } \quad K=\lambda B+(1-\lambda) C
$$

for some real $\rho, \sigma$, and $\lambda$. In view of (3), the equation (2) now reads $\lambda B+(1-\lambda) C=K=$ $\mu E+\nu F=\rho B+\sigma C$, or

$$
(\lambda-\rho) B=(\sigma+\lambda-1) C
$$

Since the nonzero complex numbers $B$ and $C$ have different arguments, the coefficients in the brackets vanish, so $\rho=\lambda$ and $\sigma=1-\lambda$. Therefore,

\begin{equation*}
\frac{E}{Y}+\frac{F}{X}=\rho+\sigma=1 \tag{4}
\end{equation*}

Now, if $\left(E_{1}, F_{1}\right)$ and $\left(E_{2}, F_{2}\right)$ are two distinct interesting pairs, one may apply (4) to both pairs. Subtracting, we get

$$
\frac{E_{1}-E_{2}}{Y}=\frac{F_{2}-F_{1}}{X}, \quad \text { so } \quad \frac{E_{1}-E_{2}}{F_{2}-F_{1}}=\frac{Y}{X}=\frac{\bar{B}}{\bar{C}}
$$

Taking absolute values provides the required result.\\",4,"Let $(E, F)$ be an interesting pair. Prove that the corresponding triangle $EFK$ satisfies $\angle KEF = \angle KFE = \angle A$.","Let $\omega$ be the circumcircle of the cyclic quadrilateral $KSAT$. The line $ST$ is the perpendicular bisector of $MK$, and the line $KM$ is on the perpendicular bisector of $EF$. This implies $ST \parallel EF$. Using properties of symmetry and the cyclic quadrilateral, it can be shown that points $K, G, E, S$ are concyclic, where $G$ is a specific point on line $EF$. From this cyclic quadrilateral, $\angle KEF = \angle KGS$. Let $N$ be the midpoint of $ST$. Let $G$ be the reflection of $K$ across $N$. Then $KSTG$ is a parallelogram, so $\angle KGS = 180^\circ - \angle SKT = \angle SAT = \angle A$. As $K$ lies on the perpendicular bisector of $EF$, $KE=KF$, making $\triangle KEF$ isosceles. Thus, $\angle KFE = \angle KEF = \angle A$.","For an interesting pair $(E, F)$, prove that $\frac{AE}{AB} + \frac{AF}{AC} = 2 \cos A$.","Let $\omega_1$ be the circumcircle of $\triangle AEF$. The condition $\angle KEF = \angle A$ implies that line $KE$ is tangent to $\omega_1$. Let $Y = BE \cap CF$. By Pascal's theorem on a degenerate hexagon inscribed in $\omega_1$, $Y$ must lie on $\omega_1$. By considering the power of points $B$ and $C$ with respect to $\omega_1$ and other circles derived from Miquel's theorem, one can establish the identity $AB \cdot (AB - AF) + AC \cdot (AC - AE) = BC^2$. Using the Law of Cosines for $\triangle ABC$, which states $BC^2 = AB^2 + AC^2 - 2AB \cdot AC \cos A$, and substituting this into the identity, we simplify it to $AB \cdot AF + AC \cdot AE = 2AB \cdot AC \cos A$. Dividing by $AB \cdot AC$ yields the desired relation.","Let $(E_1, F_1)$ and $(E_2, F_2)$ be two interesting pairs. Show that $\frac{AE_1 - AE_2}{AB} = \frac{AF_2 - AF_1}{AC}$.","From the previous sub-problem, the linear relationship $\frac{AE}{AB} + \frac{AF}{AC} = 2 \cos A$ holds for any interesting pair $(E,F)$. Applying this to $(E_1, F_1)$ gives $\frac{AE_1}{AB} + \frac{AF_1}{AC} = 2 \cos A$. Applying it to $(E_2, F_2)$ gives $\frac{AE_2}{AB} + \frac{AF_2}{AC} = 2 \cos A$. Subtracting the second equation from the first yields $\frac{AE_1 - AE_2}{AB} + \frac{AF_1 - AF_2}{AC} = 0$. Rearranging this equation gives the required result: $\frac{AE_1 - AE_2}{AB} = \frac{AF_2 - AF_1}{AC}$.","Suppose that the pairs $(E_1, F_1)$ and $(E_2, F_2)$ are interesting. Prove that $\frac{E_1 E_2}{AB} = \frac{F_1 F_2}{AC}$.","From the previous sub-problem, we have the equality $\frac{AE_1 - AE_2}{AB} = \frac{AF_2 - AF_1}{AC}$. Since points $E_1, E_2$ lie on the line $AC$, the distance $E_1 E_2$ is equal to $|AE_1 - AE_2|$. Similarly, since $F_1, F_2$ lie on the line $AB$, the distance $F_1 F_2$ is equal to $|AF_1 - AF_2|$. Taking the absolute value of both sides of the derived equality, we get $\frac{|AE_1 - AE_2|}{AB} = \frac{|AF_2 - AF_1|}{AC}$. This is equivalent to $\frac{E_1 E_2}{AB} = \frac{F_1 F_2}{AC}$, which completes the proof."
2014g7,"Let $A B C$ be a triangle with circumcircle $\Omega$ and incentre $I$. Let the line passing through $I$ and perpendicular to $C I$ intersect the segment $B C$ and the arc $B C$ (not containing $A$ ) of $\Omega$ at points $U$ and $V$, respectively. Let the line passing through $U$ and parallel to $A I$ intersect $A V$ at $X$, and let the line passing through $V$ and parallel to $A I$ intersect $A B$ at $Y$. Let $W$ and $Z$ be the midpoints of $A X$ and $B C$, respectively. Prove that if the points $I, X$, and $Y$ are collinear, then the points $I, W$, and $Z$ are also collinear.","We start with some general observations. Set $\alpha=\angle A / 2, \beta=\angle B / 2, \gamma=\angle C / 2$. Then obviously $\alpha+\beta+\gamma=90^{\circ}$. Since $\angle U I C=90^{\circ}$, we obtain $\angle I U C=\alpha+\beta$. Therefore $\angle B I V=\angle I U C-\angle I B C=\alpha=\angle B A I=\angle B Y V$, which implies that the points $B, Y, I$, and $V$ lie on a common circle (see Figure 1).

Assume now that the points $I, X$ and $Y$ are collinear. We prove that $\angle Y I A=90^{\circ}$.\\
Let the line $X U$ intersect $A B$ at $N$. Since the lines $A I, U X$, and $V Y$ are parallel, we get

$$
\frac{N X}{A I}=\frac{Y N}{Y A}=\frac{V U}{V I}=\frac{X U}{A I},
$$

implying $N X=X U$. Moreover, $\angle B I U=\alpha=\angle B N U$. This implies that the quadrilateral BUIN is cyclic, and since $B I$ is the angle bisector of $\angle U B N$, we infer that $N I=U I$. Thus in the isosceles triangle NIU, the point $X$ is the midpoint of the base $N U$. This gives $\angle I X N=90^{\circ}$, i.e., $\angle Y I A=90^{\circ}$.\\
\includegraphics[max width=\textwidth, center]{2025_04_30_430645cb6b343bf2b1ddg-65}

Figure 1\\
Let $S$ be the midpoint of the segment $V C$. Let moreover $T$ be the intersection point of the lines $A X$ and $S I$, and set $x=\angle B A V=\angle B C V$. Since $\angle C I A=90^{\circ}+\beta$ and $S I=S C$, we obtain

$$
\angle T I A=180^{\circ}-\angle A I S=90^{\circ}-\beta-\angle C I S=90^{\circ}-\beta-\gamma-x=\alpha-x=\angle T A I,
$$

which implies that $T I=T A$. Therefore, since $\angle X I A=90^{\circ}$, the point $T$ is the midpoint of $A X$, i.e., $T=W$.

To complete our solution, it remains to show that the intersection point of the lines $I S$ and $B C$ coincide with the midpoint of the segment $B C$. But since $S$ is the midpoint of the segment $V C$, it suffices to show that the lines $B V$ and $I S$ are parallel.

Since the quadrilateral $B Y I V$ is cyclic, $\angle V B I=\angle V Y I=\angle Y I A=90^{\circ}$. This implies that $B V$ is the external angle bisector of the angle $A B C$, which yields $\angle V A C=\angle V C A$. Therefore $2 \alpha-x=2 \gamma+x$, which gives $\alpha=\gamma+x$. Hence $\angle S C I=\alpha$, so $\angle V S I=2 \alpha$.

On the other hand, $\angle B V C=180^{\circ}-\angle B A C=180^{\circ}-2 \alpha$, which implies that the lines $B V$ and $I S$ are parallel. This completes the solution.",1,"Let $A B C$ be a triangle with circumcircle $\Omega$ and incentre $I$. Let the line passing through $I$ and perpendicular to $C I$ intersect the segment $B C$ and the arc $B C$ (not containing $A$ ) of $\Omega$ at points $U$ and $V$, respectively. Let the line passing through $U$ and parallel to $A I$ intersect $A V$ at $X$, and let the line passing through $V$ and parallel to $A I$ intersect $A B$ at $Y$. Let $W$ and $Z$ be the midpoints of $A X$ and $B C$, respectively. Prove that if the points $I, X$, and $Y$ are collinear, then the points $I, W$, and $Z$ are also collinear.","We start with some general observations. Set $\alpha=\angle A / 2, \beta=\angle B / 2, \gamma=\angle C / 2$. Then obviously $\alpha+\beta+\gamma=90^{\circ}$. Since $\angle U I C=90^{\circ}$, we obtain $\angle I U C=\alpha+\beta$. Therefore $\angle B I V=\angle I U C-\angle I B C=\alpha=\angle B A I=\angle B Y V$, which implies that the points $B, Y, I$, and $V$ lie on a common circle (see Figure 1).

Assume now that the points $I, X$ and $Y$ are collinear. We prove that $\angle Y I A=90^{\circ}$.\\
Let the line $X U$ intersect $A B$ at $N$. Since the lines $A I, U X$, and $V Y$ are parallel, we get

$$
\frac{N X}{A I}=\frac{Y N}{Y A}=\frac{V U}{V I}=\frac{X U}{A I},
$$

implying $N X=X U$. Moreover, $\angle B I U=\alpha=\angle B N U$. This implies that the quadrilateral BUIN is cyclic, and since $B I$ is the angle bisector of $\angle U B N$, we infer that $N I=U I$. Thus in the isosceles triangle NIU, the point $X$ is the midpoint of the base $N U$. This gives $\angle I X N=90^{\circ}$, i.e., $\angle Y I A=90^{\circ}$.\\
\includegraphics[max width=\textwidth, center]{2025_04_30_430645cb6b343bf2b1ddg-65}

Figure 1\\
Let $S$ be the midpoint of the segment $V C$. Let moreover $T$ be the intersection point of the lines $A X$ and $S I$, and set $x=\angle B A V=\angle B C V$. Since $\angle C I A=90^{\circ}+\beta$ and $S I=S C$, we obtain

$$
\angle T I A=180^{\circ}-\angle A I S=90^{\circ}-\beta-\angle C I S=90^{\circ}-\beta-\gamma-x=\alpha-x=\angle T A I,
$$

which implies that $T I=T A$. Therefore, since $\angle X I A=90^{\circ}$, the point $T$ is the midpoint of $A X$, i.e., $T=W$.

To complete our solution, it remains to show that the intersection point of the lines $I S$ and $B C$ coincide with the midpoint of the segment $B C$. But since $S$ is the midpoint of the segment $V C$, it suffices to show that the lines $B V$ and $I S$ are parallel.

Since the quadrilateral $B Y I V$ is cyclic, $\angle V B I=\angle V Y I=\angle Y I A=90^{\circ}$. This implies that $B V$ is the external angle bisector of the angle $A B C$, which yields $\angle V A C=\angle V C A$. Therefore $2 \alpha-x=2 \gamma+x$, which gives $\alpha=\gamma+x$. Hence $\angle S C I=\alpha$, so $\angle V S I=2 \alpha$.

On the other hand, $\angle B V C=180^{\circ}-\angle B A C=180^{\circ}-2 \alpha$, which implies that the lines $B V$ and $I S$ are parallel. This completes the solution.",,,,,,
2014n3,"A coin is called a Cape Town coin if its value is $1 / n$ for some positive integer $n$. Given a collection of Cape Town coins of total value at most $99+\frac{1}{2}$, prove that it is possible to split this collection into at most 100 groups each of total value at most 1 .","Solution. We will show that for every positive integer $N$ any collection of Cape Town coins of total value at most $N-\frac{1}{2}$ can be split into $N$ groups each of total value at most 1 . The problem statement is a particular case for $N=100$.

We start with some preparations. If several given coins together have a total value also of the form $\frac{1}{k}$ for a positive integer $k$, then we may merge them into one new coin. Clearly, if the resulting collection can be split in the required way then the initial collection can also be split.

After each such merging, the total number of coins decreases, thus at some moment we come to a situation when no more merging is possible. At this moment, for every even $k$ there is at most one coin of value $\frac{1}{k}$ (otherwise two such coins may be merged), and for every odd $k>1$ there are at most $k-1$ coins of value $\frac{1}{k}$ (otherwise $k$ such coins may also be merged).

Now, clearly, each coin of value 1 should form a single group; if there are $d$ such coins then we may remove them from the collection and replace $N$ by $N-d$. So from now on we may assume that there are no coins of value 1 .

Finally, we may split all the coins in the following way. For each $k=1,2, \ldots, N$ we put all the coins of values $\frac{1}{2 k-1}$ and $\frac{1}{2 k}$ into a group $G_{k}$; the total value of $G_{k}$ does not exceed

$$
(2 k-2) \cdot \frac{1}{2 k-1}+\frac{1}{2 k}<1 .
$$

It remains to distribute the ""small"" coins of values which are less than $\frac{1}{2 N}$; we will add them one by one. In each step, take any remaining small coin. The total value of coins in the groups at this moment is at most $N-\frac{1}{2}$, so there exists a group of total value at most $\frac{1}{N}\left(N-\frac{1}{2}\right)=1-\frac{1}{2 N}$; thus it is possible to put our small coin into this group. Acting so, we will finally distribute all the coins.

Comment 1. The algorithm may be modified, at least the step where one distributes the coins of values $\geqslant \frac{1}{2 N}$. One different way is to put into $G_{k}$ all the coins of values $\frac{1}{(2 k-1)^{s}}$ for all integer $s \geqslant 0$. One may easily see that their total value also does not exceed 1 .

Comment 2. The original proposal also contained another part, suggesting to show that a required splitting may be impossible if the total value of coins is at most 100 . There are many examples of such a collection, e.g. one may take 98 coins of value 1 , one coin of value $\frac{1}{2}$, two coins of value $\frac{1}{3}$, and four coins of value $\frac{1}{5}$.

The Problem Selection Committee thinks that this part is less suitable for the competition.",3,"Let a collection of Cape Town coins be 'irreducible' if no subset of coins can be replaced by a single Cape Town coin of the same total value. For an irreducible collection, establish the maximum number of coins of value $1/k$ for any integer $k > 1$.","For an irreducible collection, there can be at most one coin of value $1/k$ if $k$ is even, because two such coins would merge into a single coin of value $2/k = 1/(k/2)$. There can be at most $k-1$ coins of value $1/k$ if $k$ is odd and greater than 1, because $k$ such coins would merge into a coin of value $k/k = 1$.","Let $N$ be a positive integer. Consider an irreducible collection of Cape Town coins with values $1/m$ for $m \in \\{2, 3, \\dots, 2N\\}$. Show that these coins can be partitioned into $N$ groups, such that the sum of values in each group is less than 1.","For each $k=1, \\dots, N$, form a group $G_k$ consisting of all available coins of values $1/(2k-1)$ and $1/(2k)$. For $k=1$, group $G_1$ contains only coins of value $1/2$. As 2 is even, there is at most one such coin, so the group's value is at most $1/2 < 1$. For $k>1$, since the collection is irreducible, the value of group $G_k$ is at most $(2k-2) \\cdot \frac{1}{2k-1} + 1 \\cdot \frac{1}{2k} = 1 - \frac{1}{2k-1} + \frac{1}{2k} < 1$.","A coin is called a Cape Town coin if its value is $1/n$ for some positive integer $n$. Given a collection of Cape Town coins of total value at most $99+\frac{1}{2}$, prove that it is possible to split this collection into at most 100 groups each of total value at most 1.","Let $N=100$. First, make the collection irreducible by merging coins where possible. Put each coin of value 1 in its own group and reduce $N$ and the total value accordingly. For the remaining coins, partition those with values $1/m$ for $m \\in \\{2, \\dots, 2N\\}$ into $N$ groups as described in Sub-problem 2. The remaining coins have values less than $1/(2N)$. Add them greedily one by one. At each step, since the total value is at most $N-1/2$, there must be a group with total value at most $(N-1/2)/N = 1-1/(2N)$. Any remaining coin can be added to this group without the total value exceeding 1. Repeat until all coins are distributed.",,
2014n4,"Let $n>1$ be a given integer. Prove that infinitely many terms of the sequence $\left(a_{k}\right)_{k \geqslant 1}$, defined by

$$
a_{k}=\left\lfloor\frac{n^{k}}{k}\right\rfloor,
$$

are odd. (For a real number $x,\lfloor x\rfloor$ denotes the largest integer not exceeding $x$.)","If $n$ is odd, let $k=n^{m}$ for $m=1,2, \ldots$. Then $a_{k}=n^{n^{m}-m}$, which is odd for each $m$.

Henceforth, assume that $n$ is even, say $n=2 t$ for some integer $t \geqslant 1$. Then, for any $m \geqslant 2$, the integer $n^{2^{m}}-2^{m}=2^{m}\left(2^{2^{m}-m} \cdot t^{2^{m}}-1\right)$ has an odd prime divisor $p$, since $2^{m}-m>1$. Then, for $k=p \cdot 2^{m}$, we have

$$
n^{k}=\left(n^{2^{m}}\right)^{p} \equiv\left(2^{m}\right)^{p}=\left(2^{p}\right)^{m} \equiv 2^{m}
$$

where the congruences are taken modulo $p$ (recall that $2^{p} \equiv 2(\bmod p)$, by Fermat's little theorem). Also, from $n^{k}-2^{m}<n^{k}<n^{k}+2^{m}(p-1)$, we see that the fraction $\frac{n^{k}}{k}$ lies strictly between the consecutive integers $\frac{n^{k}-2^{m}}{p \cdot 2^{m}}$ and $\frac{n^{k}+2^{m}(p-1)}{p \cdot 2^{m}}$, which gives

$$
\left\lfloor\frac{n^{k}}{k}\right\rfloor=\frac{n^{k}-2^{m}}{p \cdot 2^{m}} .
$$

We finally observe that $\frac{n^{k}-2^{m}}{p \cdot 2^{m}}=\frac{\frac{n^{k}}{2^{m}}-1}{p}$ is an odd integer, since the integer $\frac{n^{k}}{2^{m}}-1$ is odd (recall that $k>m$ ). Note that for different values of $m$, we get different values of $k$, due to the different powers of 2 in the prime factorisation of $k$.",2,Let $n > 1$ be an odd integer. Prove that infinitely many terms of the sequence $(a_k)_{k \ge 1}$ defined by $a_k = \lfloor n^k/k \rfloor$ are odd.,"For $m=1, 2, \ldots$, let $k=n^m$. This provides an infinite sequence of distinct integers $k$. For these values, $a_k = \lfloor n^{n^m} / n^m \rfloor = \lfloor n^{n^m-m} \rfloor$. Since $n^m-m$ is an integer for $n,m \ge 1$, this simplifies to $a_k = n^{n^m-m}$. As $n$ is an odd integer, any integer power of $n$ is also odd. Thus, for every $m \ge 1$, $a_{n^m}$ is odd, proving the statement.","Let $n>1$ be a given integer. Prove that infinitely many terms of the sequence $\left(a_{k}\right)_{k \geqslant 1}$, defined by

$$
a_{k}=\left\lfloor\frac{n^{k}}{k}\right\rfloor,
$$

are odd.","The statement holds for odd $n$ from the first part. Now, assume $n$ is even. For any integer $m \ge 2$, the number $n^{2^m}-2^m$ is greater than 1 and must have an odd prime divisor $p$. Let $k=p \cdot 2^m$. By construction, $n^{2^m} \equiv 2^m \pmod p$. Using Fermat's Little Theorem, $n^k = (n^{2^m})^p \equiv (2^m)^p \equiv 2^m \pmod p$. This implies $n^k-2^m$ is a multiple of $p$. Since $k = p \cdot 2^m > 2^m$, we have $0 < \frac{n^k}{k} - \frac{n^k-2^m}{k} < 1$, which gives $\lfloor n^k/k \rfloor = \frac{n^k-2^m}{k}$. We can write $a_k = \frac{1}{p}(\frac{n^k}{2^m}-1)$. Since $n$ is even and $k>m$, $\frac{n^k}{2^m}-1$ is an odd integer. As $p$ is an odd prime divisor of this numerator, the quotient $a_k$ must be an odd integer. Distinct values of $m$ produce distinct values of $k$, yielding infinitely many odd terms.",,,,
2014n6,"Let $a_{1}<a_{2}<\cdots<a_{n}$ be pairwise coprime positive integers with $a_{1}$ being prime and $a_{1} \geqslant n+2$. On the segment $I=\left[0, a_{1} a_{2} \cdots a_{n}\right]$ of the real line, mark all integers that are divisible by at least one of the numbers $a_{1}, \ldots, a_{n}$. These points split $I$ into a number of smaller segments. Prove that the sum of the squares of the lengths of these segments is divisible by $a_{1}$.","Let $A=a_{1} \cdots a_{n}$. Throughout the solution, all intervals will be nonempty and have integer end-points. For any interval $X$, the length of $X$ will be denoted by $|X|$.

Define the following two families of intervals:

$$
\begin{aligned}
\mathcal{S} & =\{[x, y]: x<y \text { are consecutive marked points }\} \\
\mathcal{T} & =\{[x, y]: x<y \text { are integers, } 0 \leqslant x \leqslant A-1, \text { and no point is marked in }(x, y)\}
\end{aligned}
$$

We are interested in computing $\sum_{X \in \mathcal{S}}|X|^{2}$ modulo $a_{1}$.\\
Note that the number $A$ is marked, so in the definition of $\mathcal{T}$ the condition $y \leqslant A$ is enforced without explicitly prescribing it.

Assign weights to the intervals in $\mathcal{T}$, depending only on their lengths. The weight of an arbitrary interval $Y \in \mathcal{T}$ will be $w(|Y|)$, where

$$
w(k)= \begin{cases}1 & \text { if } k=1, \\ 2 & \text { if } k \geqslant 2 .\end{cases}
$$

Consider an arbitrary interval $X \in \mathcal{S}$ and its sub-intervals $Y \in \mathcal{T}$. Clearly, $X$ has one sub-interval of length $|X|$, two sub-intervals of length $|X|-1$ and so on; in general $X$ has $|X|-d+1$ sub-intervals of length $d$ for every $d=1,2, \ldots,|X|$. The sum of the weights of the sub-intervals of $X$ is\\
$\sum_{Y \in \mathcal{T}, Y \subseteq X} w(|Y|)=\sum_{d=1}^{|X|}(|X|-d+1) \cdot w(d)=|X| \cdot 1+((|X|-1)+(|X|-2)+\cdots+1) \cdot 2=|X|^{2}$.\\
Since the intervals in $\mathcal{S}$ are non-overlapping, every interval $Y \in \mathcal{T}$ is a sub-interval of a single interval $X \in \mathcal{S}$. Therefore,


\begin{equation*}
\sum_{X \in \mathcal{S}}|X|^{2}=\sum_{X \in \mathcal{S}}\left(\sum_{Y \in \mathcal{T}, Y \subseteq X} w(|Y|)\right)=\sum_{Y \in \mathcal{T}} w(|Y|) . \tag{1}
\end{equation*}


For every $d=1,2, \ldots, a_{1}$, we count how many intervals in $\mathcal{T}$ are of length $d$. Notice that the multiples of $a_{1}$ are all marked, so the lengths of the intervals in $\mathcal{S}$ and $\mathcal{T}$ cannot exceed $a_{1}$. Let $x$ be an arbitrary integer with $0 \leqslant x \leqslant A-1$ and consider the interval $[x, x+d]$. Let $r_{1}$, $\ldots, r_{n}$ be the remainders of $x$ modulo $a_{1}, \ldots, a_{n}$, respectively. Since $a_{1}, \ldots, a_{n}$ are pairwise coprime, the number $x$ is uniquely identified by the sequence $\left(r_{1}, \ldots, r_{n}\right)$, due to the Chinese remainder theorem.

For every $i=1, \ldots, n$, the property that the interval $(x, x+d)$ does not contain any multiple of $a_{i}$ is equivalent with $r_{i}+d \leqslant a_{i}$, i.e. $r_{i} \in\left\{0,1, \ldots, a_{i}-d\right\}$, so there are $a_{i}-d+1$ choices for the number $r_{i}$ for each $i$. Therefore, the number of the remainder sequences $\left(r_{1}, \ldots, r_{n}\right)$ that satisfy $[x, x+d] \in \mathcal{T}$ is precisely $\left(a_{1}+1-d\right) \cdots\left(a_{n}+1-d\right)$. Denote this product by $f(d)$.

Now we can group the last sum in (1) by length of the intervals. As we have seen, for every $d=1, \ldots, a_{1}$ there are $f(d)$ intervals $Y \in \mathcal{T}$ with $|Y|=d$. Therefore, (1) can be continued as


\begin{equation*}
\sum_{X \in \mathcal{S}}|X|^{2}=\sum_{Y \in \mathcal{T}} w(|Y|)=\sum_{d=1}^{a_{1}} f(d) \cdot w(d)=2 \sum_{d=1}^{a_{1}} f(d)-f(1) \tag{2}
\end{equation*}


Having the formula (2), the solution can be finished using the following well-known fact: Lemma. If $p$ is a prime, $F(x)$ is a polynomial with integer coefficients, and $\operatorname{deg} F \leqslant p-2$, then $\sum_{x=1}^{p} F(x)$ is divisible by $p$.\\
Proof. Obviously, it is sufficient to prove the lemma for monomials of the form $x^{k}$ with $k \leqslant p-2$. Apply induction on $k$. If $k=0$ then $F=1$, and the statement is trivial.

Let $1 \leqslant k \leqslant p-2$, and assume that the lemma is proved for all lower degrees. Then

$$
\begin{aligned}
0 & \equiv p^{k+1}=\sum_{x=1}^{p}\left(x^{k+1}-(x-1)^{k+1}\right)=\sum_{x=1}^{p}\left(\sum_{\ell=0}^{k}(-1)^{k-\ell}\binom{k+1}{\ell} x^{\ell}\right) \\
& =(k+1) \sum_{x=1}^{p} x^{k}+\sum_{\ell=0}^{k-1}(-1)^{k-\ell}\binom{k+1}{\ell} \sum_{x=1}^{p} x^{\ell} \equiv(k+1) \sum_{x=1}^{p} x^{k} \quad(\bmod p)
\end{aligned}
$$

Since $0<k+1<p$, this proves $\sum_{x=1}^{p} x^{k} \equiv 0(\bmod p)$.\\
In (2), by applying the lemma to the polynomial $f$ and the prime $a_{1}$, we obtain that $\sum_{d=1}^{a_{1}} f(d)$ is divisible by $a_{1}$. The term $f(1)=a_{1} \cdots a_{n}$ is also divisible by $a_{1}$; these two facts together prove that $\sum_{X \in \mathcal{S}}|X|^{2}$ is divisible by $a_{1}$.",4,"Let $\mathcal{S}$ be the set of segments $[x, y]$ where $x$ and $y$ are consecutive marked points. Let $\mathcal{T}$ be the set of segments $[x, y]$ where $x<y$ are integers in $[0, a_1\cdots a_n]$ and no integer in $(x, y)$ is marked. Define a weight function $w(k)=1$ if $k=1$ and $w(k)=2$ if $k \ge 2$. Prove that $\sum_{X \in \mathcal{S}}|X|^{2}=\sum_{Y \in \mathcal{T}} w(|Y|)$.","For any segment $X \in \mathcal{S}$, we sum the weights of its sub-intervals that are in $\mathcal{T}$. For each length $d \in \{1, \dots, |X|\}$, there are $|X|-d+1$ sub-intervals of length $d$ contained in $X$. The sum of weights of these sub-intervals is $\sum_{d=1}^{|X|} (|X|-d+1)w(d) = |X| \cdot 1 + \sum_{d=2}^{|X|} (|X|-d+1) \cdot 2 = |X| + 2 \sum_{k=1}^{|X|-1} k = |X| + |X|(|X|-1) = |X|^2$. Since the segments in $\mathcal{S}$ are disjoint except at endpoints, each interval $Y \in \mathcal{T}$ is a sub-interval of exactly one $X \in \mathcal{S}$. Summing over all $X \in \mathcal{S}$ yields $\sum_{X \in \mathcal{S}}|X|^{2} = \sum_{X \in \mathcal{S}} \sum_{Y \in \mathcal{T}, Y \subseteq X} w(|Y|) = \sum_{Y \in \mathcal{T}} w(|Y|)$.",Let $f(d) = \prod_{i=1}^{n} (a_i - d + 1)$. Show that the number of intervals in $\mathcal{T}$ of length $d$ is $f(d)$ for $d \le a_1$. Use this to prove that $\sum_{X \in \mathcal{S}}|X|^{2} = 2 \sum_{d=1}^{a_{1}} f(d)-f(1)$.,"An interval $[x, x+d]$ is in $\mathcal{T}$ if for each $i$, no multiple of $a_i$ is in $(x, x+d)$. This holds iff $x \pmod{a_i} \in \{0, 1, \dots, a_i-d\}$, which gives $a_i-d+1$ choices for the remainder modulo $a_i$. By the Chinese Remainder Theorem, the number of such integers $x$ in $[0, a_1\cdots a_n-1]$ is $f(d) = \prod_{i=1}^n (a_i-d+1)$. The length of any interval in $\mathcal{T}$ cannot exceed $a_1$. Using Sub-problem 1, $\sum_{X \in \mathcal{S}}|X|^{2} = \sum_{Y \in \mathcal{T}} w(|Y|) = \sum_{d=1}^{a_1} f(d)w(d) = f(1)w(1) + \sum_{d=2}^{a_1} f(d)w(d) = f(1) + 2\sum_{d=2}^{a_1} f(d) = f(1) + 2(\sum_{d=1}^{a_1} f(d) - f(1)) = 2\sum_{d=1}^{a_1} f(d) - f(1)$.",Let $p$ be a prime number and $F(x)$ be a polynomial with integer coefficients of degree $k \le p-2$. Prove that $\sum_{x=1}^{p} F(x)$ is divisible by $p$.,"It suffices to prove this for monomials $F(x) = x^k$ where $0 \le k \le p-2$. We use induction on $k$. For $k=0$, $\sum_{x=1}^p 1 = p \equiv 0 \pmod p$. Assume the statement holds for degrees less than $k$, where $1 \le k \le p-2$. The sum $\sum_{x=1}^p (x^{k+1} - (x-1)^{k+1}) = p^{k+1} \equiv 0 \pmod p$. By binomial expansion, this is $\sum_{x=1}^p ((k+1)x^k + P(x)) \equiv 0 \pmod p$, where $P(x)$ is a polynomial of degree $k-1$. By the induction hypothesis, $\sum_{x=1}^p P(x) \equiv 0 \pmod p$. Thus, $(k+1)\sum_{x=1}^p x^k \equiv 0 \pmod p$. Since $1 \le k+1 \le p-1$, $k+1$ is coprime to $p$, which implies $\sum_{x=1}^p x^k \equiv 0 \pmod p$. The result for a general polynomial follows by linearity.","Let $a_{1}<a_{2}<\cdots<a_{n}$ be pairwise coprime positive integers with $a_{1}$ being prime and $a_{1} \geqslant n+2$. On the segment $I=\left[0, a_{1} a_{2} \cdots a_{n}\right]$ of the real line, mark all integers that are divisible by at least one of the numbers $a_{1}, \ldots, a_{n}$. These points split $I$ into a number of smaller segments. Prove that the sum of the squares of the lengths of these segments is divisible by $a_{1}$.","Let $S$ be the sum of the squares of the lengths. From Sub-problem 2, $S = 2 \sum_{d=1}^{a_{1}} f(d)-f(1)$, where $f(d) = \prod_{i=1}^{n} (a_i - d + 1)$. The function $f(d)$ is a polynomial in $d$ of degree $n$. Given $a_1 \ge n+2$, the degree of $f$ is $n \le a_1-2$. Since $a_1$ is prime, we apply the result from Sub-problem 3 with $p=a_1$ and $F(d)=f(d)$, yielding $\sum_{d=1}^{a_1} f(d) \equiv 0 \pmod{a_1}$. Also, $f(1) = \prod_{i=1}^{n} a_i$, which is divisible by $a_1$. Therefore, $S = 2 \sum_{d=1}^{a_1} f(d) - f(1) \equiv 2 \cdot 0 - 0 \equiv 0 \pmod{a_1}$. This proves the claim."
2014n7,"Let $c \geqslant 1$ be an integer. Define a sequence of positive integers by $a_{1}=c$ and

$$
a_{n+1}=a_{n}^{3}-4 c \cdot a_{n}^{2}+5 c^{2} \cdot a_{n}+c
$$

for all $n \geqslant 1$. Prove that for each integer $n \geqslant 2$ there exists a prime number $p$ dividing $a_{n}$ but none of the numbers $a_{1}, \ldots, a_{n-1}$.","Solution. Let us define $x_{0}=0$ and $x_{n}=a_{n} / c$ for all integers $n \geqslant 1$. It is easy to see that the sequence ( $x_{n}$ ) thus obtained obeys the recursive law


\begin{equation*}
x_{n+1}=c^{2}\left(x_{n}^{3}-4 x_{n}^{2}+5 x_{n}\right)+1 \tag{1}
\end{equation*}


for all integers $n \geqslant 0$. In particular, all of its terms are positive integers; notice that $x_{1}=1$ and $x_{2}=2 c^{2}+1$. Since


\begin{equation*}
x_{n+1}=c^{2} x_{n}\left(x_{n}-2\right)^{2}+c^{2} x_{n}+1>x_{n} \tag{2}
\end{equation*}


holds for all integers $n \geqslant 0$, it is also strictly increasing. Since $x_{n+1}$ is by (1) coprime to $c$ for any $n \geqslant 0$, it suffices to prove that for each $n \geqslant 2$ there exists a prime number $p$ dividing $x_{n}$ but none of the numbers $x_{1}, \ldots, x_{n-1}$. Let us begin by establishing three preliminary claims.

Claim 1. If $i \equiv j(\bmod m)$ holds for some integers $i, j \geqslant 0$ and $m \geqslant 1$, then $x_{i} \equiv x_{j}\left(\bmod x_{m}\right)$ holds as well.\\
Proof. Evidently, it suffices to show $x_{i+m} \equiv x_{i}\left(\bmod x_{m}\right)$ for all integers $i \geqslant 0$ and $m \geqslant 1$. For this purpose we may argue for fixed $m$ by induction on $i$ using $x_{0}=0$ in the base case $i=0$. Now, if we have $x_{i+m} \equiv x_{i}\left(\bmod x_{m}\right)$ for some integer $i$, then the recursive equation (1) yields

$$
x_{i+m+1} \equiv c^{2}\left(x_{i+m}^{3}-4 x_{i+m}^{2}+5 x_{i+m}\right)+1 \equiv c^{2}\left(x_{i}^{3}-4 x_{i}^{2}+5 x_{i}\right)+1 \equiv x_{i+1} \quad\left(\bmod x_{m}\right),
$$

which completes the induction.\\
Claim 2. If the integers $i, j \geqslant 2$ and $m \geqslant 1$ satisfy $i \equiv j(\bmod m)$, then $x_{i} \equiv x_{j}\left(\bmod x_{m}^{2}\right)$ holds as well.\\
Proof. Again it suffices to prove $x_{i+m} \equiv x_{i}\left(\bmod x_{m}^{2}\right)$ for all integers $i \geqslant 2$ and $m \geqslant 1$. As above, we proceed for fixed $m$ by induction on $i$. The induction step is again easy using (1), but this time the base case $i=2$ requires some calculation. Set $L=5 c^{2}$. By (1) we have $x_{m+1} \equiv L x_{m}+1\left(\bmod x_{m}^{2}\right)$, and hence

$$
\begin{aligned}
x_{m+1}^{3}-4 x_{m+1}^{2}+5 x_{m+1} & \equiv\left(L x_{m}+1\right)^{3}-4\left(L x_{m}+1\right)^{2}+5\left(L x_{m}+1\right) \\
& \equiv\left(3 L x_{m}+1\right)-4\left(2 L x_{m}+1\right)+5\left(L x_{m}+1\right) \equiv 2 \quad\left(\bmod x_{m}^{2}\right),
\end{aligned}
$$

which in turn gives indeed $x_{m+2} \equiv 2 c^{2}+1 \equiv x_{2}\left(\bmod x_{m}^{2}\right)$.\\
Claim 3. For each integer $n \geqslant 2$, we have $x_{n}>x_{1} \cdot x_{2} \cdots x_{n-2}$.\\
Proof. The cases $n=2$ and $n=3$ are clear. Arguing inductively, we assume now that the claim holds for some $n \geqslant 3$. Recall that $x_{2} \geqslant 3$, so by monotonicity and (2) we get $x_{n} \geqslant x_{3} \geqslant x_{2}\left(x_{2}-2\right)^{2}+x_{2}+1 \geqslant 7$. It follows that

$$
x_{n+1}>x_{n}^{3}-4 x_{n}^{2}+5 x_{n}>7 x_{n}^{2}-4 x_{n}^{2}>x_{n}^{2}>x_{n} x_{n-1},
$$

which by the induction hypothesis yields $x_{n+1}>x_{1} \cdot x_{2} \cdots x_{n-1}$, as desired.

Now we direct our attention to the problem itself: let any integer $n \geqslant 2$ be given. By Claim 3 there exists a prime number $p$ appearing with a higher exponent in the prime factorisation of $x_{n}$ than in the prime factorisation of $x_{1} \cdots x_{n-2}$. In particular, $p \mid x_{n}$, and it suffices to prove that $p$ divides none of $x_{1}, \ldots, x_{n-1}$.

Otherwise let $k \in\{1, \ldots, n-1\}$ be minimal such that $p$ divides $x_{k}$. Since $x_{n-1}$ and $x_{n}$ are coprime by (1) and $x_{1}=1$, we actually have $2 \leqslant k \leqslant n-2$. Write $n=q k+r$ with some integers $q \geqslant 0$ and $0 \leqslant r<k$. By Claim 1 we have $x_{n} \equiv x_{r}\left(\bmod x_{k}\right)$, whence $p \mid x_{r}$. Due to the minimality of $k$ this entails $r=0$, i.e. $k \mid n$.

Thus from Claim 2 we infer

$$
x_{n} \equiv x_{k} \quad\left(\bmod x_{k}^{2}\right)
$$

Now let $\alpha \geqslant 1$ be maximal with the property $p^{\alpha} \mid x_{k}$. Then $x_{k}^{2}$ is divisible by $p^{\alpha+1}$ and by our choice of $p$ so is $x_{n}$. So by the previous congruence $x_{k}$ is a multiple of $p^{\alpha+1}$ as well, contrary to our choice of $\alpha$. This is the final contradiction concluding the solution.",1,"Let $c \geqslant 1$ be an integer. Define a sequence of positive integers by $a_{1}=c$ and

$$
a_{n+1}=a_{n}^{3}-4 c \cdot a_{n}^{2}+5 c^{2} \cdot a_{n}+c
$$

for all $n \geqslant 1$. Prove that for each integer $n \geqslant 2$ there exists a prime number $p$ dividing $a_{n}$ but none of the numbers $a_{1}, \ldots, a_{n-1}$.","Solution. Let us define $x_{0}=0$ and $x_{n}=a_{n} / c$ for all integers $n \geqslant 1$. It is easy to see that the sequence ( $x_{n}$ ) thus obtained obeys the recursive law


\begin{equation*}
x_{n+1}=c^{2}\left(x_{n}^{3}-4 x_{n}^{2}+5 x_{n}\right)+1 \tag{1}
\end{equation*}


for all integers $n \geqslant 0$. In particular, all of its terms are positive integers; notice that $x_{1}=1$ and $x_{2}=2 c^{2}+1$. Since


\begin{equation*}
x_{n+1}=c^{2} x_{n}\left(x_{n}-2\right)^{2}+c^{2} x_{n}+1>x_{n} \tag{2}
\end{equation*}


holds for all integers $n \geqslant 0$, it is also strictly increasing. Since $x_{n+1}$ is by (1) coprime to $c$ for any $n \geqslant 0$, it suffices to prove that for each $n \geqslant 2$ there exists a prime number $p$ dividing $x_{n}$ but none of the numbers $x_{1}, \ldots, x_{n-1}$. Let us begin by establishing three preliminary claims.

Claim 1. If $i \equiv j(\bmod m)$ holds for some integers $i, j \geqslant 0$ and $m \geqslant 1$, then $x_{i} \equiv x_{j}\left(\bmod x_{m}\right)$ holds as well.\\
Proof. Evidently, it suffices to show $x_{i+m} \equiv x_{i}\left(\bmod x_{m}\right)$ for all integers $i \geqslant 0$ and $m \geqslant 1$. For this purpose we may argue for fixed $m$ by induction on $i$ using $x_{0}=0$ in the base case $i=0$. Now, if we have $x_{i+m} \equiv x_{i}\left(\bmod x_{m}\right)$ for some integer $i$, then the recursive equation (1) yields

$$
x_{i+m+1} \equiv c^{2}\left(x_{i+m}^{3}-4 x_{i+m}^{2}+5 x_{i+m}\right)+1 \equiv c^{2}\left(x_{i}^{3}-4 x_{i}^{2}+5 x_{i}\right)+1 \equiv x_{i+1} \quad\left(\bmod x_{m}\right),
$$

which completes the induction.\\
Claim 2. If the integers $i, j \geqslant 2$ and $m \geqslant 1$ satisfy $i \equiv j(\bmod m)$, then $x_{i} \equiv x_{j}\left(\bmod x_{m}^{2}\right)$ holds as well.\\
Proof. Again it suffices to prove $x_{i+m} \equiv x_{i}\left(\bmod x_{m}^{2}\right)$ for all integers $i \geqslant 2$ and $m \geqslant 1$. As above, we proceed for fixed $m$ by induction on $i$. The induction step is again easy using (1), but this time the base case $i=2$ requires some calculation. Set $L=5 c^{2}$. By (1) we have $x_{m+1} \equiv L x_{m}+1\left(\bmod x_{m}^{2}\right)$, and hence

$$
\begin{aligned}
x_{m+1}^{3}-4 x_{m+1}^{2}+5 x_{m+1} & \equiv\left(L x_{m}+1\right)^{3}-4\left(L x_{m}+1\right)^{2}+5\left(L x_{m}+1\right) \\
& \equiv\left(3 L x_{m}+1\right)-4\left(2 L x_{m}+1\right)+5\left(L x_{m}+1\right) \equiv 2 \quad\left(\bmod x_{m}^{2}\right),
\end{aligned}
$$

which in turn gives indeed $x_{m+2} \equiv 2 c^{2}+1 \equiv x_{2}\left(\bmod x_{m}^{2}\right)$.\\
Claim 3. For each integer $n \geqslant 2$, we have $x_{n}>x_{1} \cdot x_{2} \cdots x_{n-2}$.\\
Proof. The cases $n=2$ and $n=3$ are clear. Arguing inductively, we assume now that the claim holds for some $n \geqslant 3$. Recall that $x_{2} \geqslant 3$, so by monotonicity and (2) we get $x_{n} \geqslant x_{3} \geqslant x_{2}\left(x_{2}-2\right)^{2}+x_{2}+1 \geqslant 7$. It follows that

$$
x_{n+1}>x_{n}^{3}-4 x_{n}^{2}+5 x_{n}>7 x_{n}^{2}-4 x_{n}^{2}>x_{n}^{2}>x_{n} x_{n-1},
$$

which by the induction hypothesis yields $x_{n+1}>x_{1} \cdot x_{2} \cdots x_{n-1}$, as desired.

Now we direct our attention to the problem itself: let any integer $n \geqslant 2$ be given. By Claim 3 there exists a prime number $p$ appearing with a higher exponent in the prime factorisation of $x_{n}$ than in the prime factorisation of $x_{1} \cdots x_{n-2}$. In particular, $p \mid x_{n}$, and it suffices to prove that $p$ divides none of $x_{1}, \ldots, x_{n-1}$.

Otherwise let $k \in\{1, \ldots, n-1\}$ be minimal such that $p$ divides $x_{k}$. Since $x_{n-1}$ and $x_{n}$ are coprime by (1) and $x_{1}=1$, we actually have $2 \leqslant k \leqslant n-2$. Write $n=q k+r$ with some integers $q \geqslant 0$ and $0 \leqslant r<k$. By Claim 1 we have $x_{n} \equiv x_{r}\left(\bmod x_{k}\right)$, whence $p \mid x_{r}$. Due to the minimality of $k$ this entails $r=0$, i.e. $k \mid n$.

Thus from Claim 2 we infer

$$
x_{n} \equiv x_{k} \quad\left(\bmod x_{k}^{2}\right)
$$

Now let $\alpha \geqslant 1$ be maximal with the property $p^{\alpha} \mid x_{k}$. Then $x_{k}^{2}$ is divisible by $p^{\alpha+1}$ and by our choice of $p$ so is $x_{n}$. So by the previous congruence $x_{k}$ is a multiple of $p^{\alpha+1}$ as well, contrary to our choice of $\alpha$. This is the final contradiction concluding the solution.",,,,,,
2014n8,"For every real number $x$, let $\|x\|$ denote the distance between $x$ and the nearest integer. Prove that for every pair $(a, b)$ of positive integers there exist an odd prime $p$ and a positive integer $k$ satisfying

\begin{equation*}
\left\|\frac{a}{p^{k}}\right\|+\left\|\frac{b}{p^{k}}\right\|+\left\|\frac{a+b}{p^{k}}\right\|=1 . \tag{1}
\end{equation*}","Solution. Notice first that $\left\lfloor x+\frac{1}{2}\right\rfloor$ is an integer nearest to $x$, so $\|x\|=\left\lfloor\left.\left\lfloor x+\frac{1}{2}\right\rfloor-x \right\rvert\,\right.$. Thus we have


\begin{equation*}
\left\lfloor x+\frac{1}{2}\right\rfloor=x \pm\|x\| \text {. } \tag{2}
\end{equation*}


For every rational number $r$ and every prime number $p$, denote by $v_{p}(r)$ the exponent of $p$ in the prime factorisation of $r$. Recall the notation $(2 n-1)$ !! for the product of all odd positive integers not exceeding $2 n-1$, i.e., $(2 n-1)!!=1 \cdot 3 \cdots(2 n-1)$.\\
Lemma. For every positive integer $n$ and every odd prime $p$, we have

$$
v_{p}((2 n-1)!!)=\sum_{k=1}^{\infty}\left\lfloor\frac{n}{p^{k}}+\frac{1}{2}\right\rfloor .
$$

Proof. For every positive integer $k$, let us count the multiples of $p^{k}$ among the factors $1,3, \ldots$, $2 n-1$. If $\ell$ is an arbitrary integer, the number $(2 \ell-1) p^{k}$ is listed above if and only if

$$
0<(2 \ell-1) p^{k} \leqslant 2 n \quad \Longleftrightarrow \quad \frac{1}{2}<\ell \leqslant \frac{n}{p^{k}}+\frac{1}{2} \quad \Longleftrightarrow \quad 1 \leqslant \ell \leqslant\left\lfloor\frac{n}{p^{k}}+\frac{1}{2}\right\rfloor .
$$

Hence, the number of multiples of $p^{k}$ among the factors is precisely $m_{k}=\left\lfloor\frac{n}{p^{k}}+\frac{1}{2}\right\rfloor$. Thus we obtain

$$
v_{p}((2 n-1)!!)=\sum_{i=1}^{n} v_{p}(2 i-1)=\sum_{i=1}^{n} \sum_{k=1}^{v_{p}(2 i-1)} 1=\sum_{k=1}^{\infty} \sum_{\ell=1}^{m_{k}} 1=\sum_{k=1}^{\infty}\left\lfloor\frac{n}{p^{k}}+\frac{1}{2}\right\rfloor .
$$

In order to prove the problem statement, consider the rational number

$$
N=\frac{(2 a+2 b-1)!!}{(2 a-1)!!\cdot(2 b-1)!!}=\frac{(2 a+1)(2 a+3) \cdots(2 a+2 b-1)}{1 \cdot 3 \cdots(2 b-1)} .
$$

Obviously, $N>1$, so there exists a prime $p$ with $v_{p}(N)>0$. Since $N$ is a fraction of two odd numbers, $p$ is odd.

By our lemma,

$$
0<v_{p}(N)=\sum_{k=1}^{\infty}\left(\left\lfloor\frac{a+b}{p^{k}}+\frac{1}{2}\right\rfloor-\left\lfloor\frac{a}{p^{k}}+\frac{1}{2}\right\rfloor-\left\lfloor\frac{b}{p^{k}}+\frac{1}{2}\right\rfloor\right) .
$$

Therefore, there exists some positive integer $k$ such that the integer number

$$
d_{k}=\left\lfloor\frac{a+b}{p^{k}}+\frac{1}{2}\right\rfloor-\left\lfloor\frac{a}{p^{k}}+\frac{1}{2}\right\rfloor-\left\lfloor\frac{b}{p^{k}}+\frac{1}{2}\right\rfloor
$$

is positive, so $d_{k} \geqslant 1$. By (2) we have


\begin{equation*}
1 \leqslant d_{k}=\frac{a+b}{p^{k}}-\frac{a}{p^{k}}-\frac{b}{p^{k}} \pm\left\|\frac{a+b}{p^{k}}\right\| \pm\left\|\frac{a}{p^{k}}\right\| \pm\left\|\frac{b}{p^{k}}\right\|= \pm\left\|\frac{a+b}{p^{k}}\right\| \pm\left\|\frac{a}{p^{k}}\right\| \pm\left\|\frac{b}{p^{k}}\right\| . \tag{3}
\end{equation*}


Since $\|x\|<\frac{1}{2}$ for every rational $x$ with odd denominator, the relation (3) can only be satisfied if all three signs on the right-hand side are positive and $d_{k}=1$. Thus we get

$$
\left\|\frac{a}{p^{k}}\right\|+\left\|\frac{b}{p^{k}}\right\|+\left\|\frac{a+b}{p^{k}}\right\|=d_{k}=1
$$

as required.

Comment 1. There are various choices for the number $N$ in the solution. Here we sketch such a version.

Let $x$ and $y$ be two rational numbers with odd denominators. It is easy to see that the condition $\|x\|+\|y\|+\|x+y\|=1$ is satisfied if and only if

$$
\text { either }\{x\}<\frac{1}{2}, \quad\{y\}<\frac{1}{2}, \quad\{x+y\}>\frac{1}{2}, \quad \text { or } \quad\{x\}>\frac{1}{2}, \quad\{y\}>\frac{1}{2}, \quad\{x+y\}<\frac{1}{2}
$$

where $\{x\}$ denotes the fractional part of $x$.\\
In the context of our problem, the first condition seems easier to deal with. Also, one may notice that


\begin{equation*}
\{x\}<\frac{1}{2} \Longleftrightarrow \varkappa(x)=0 \quad \text { and } \quad\{x\} \geqslant \frac{1}{2} \Longleftrightarrow \varkappa(x)=1 \tag{4}
\end{equation*}


where

$$
\varkappa(x)=\lfloor 2 x\rfloor-2\lfloor x\rfloor .
$$

Now it is natural to consider the number

$$
M=\frac{\binom{2 a+2 b}{a+b}}{\binom{2 a}{a}\binom{2 b}{b}}
$$

since

$$
v_{p}(M)=\sum_{k=1}^{\infty}\left(\varkappa\left(\frac{2(a+b)}{p^{k}}\right)-\varkappa\left(\frac{2 a}{p^{k}}\right)-\varkappa\left(\frac{2 b}{p^{k}}\right)\right) .
$$

One may see that $M>1$, and that $v_{2}(M) \leqslant 0$. Thus, there exist an odd prime $p$ and a positive integer $k$ with

$$
\varkappa\left(\frac{2(a+b)}{p^{k}}\right)-\varkappa\left(\frac{2 a}{p^{k}}\right)-\varkappa\left(\frac{2 b}{p^{k}}\right)>0
$$

In view of (4), the last inequality yields


\begin{equation*}
\left\{\frac{a}{p^{k}}\right\}<\frac{1}{2}, \quad\left\{\frac{b}{p^{k}}\right\}<\frac{1}{2}, \quad \text { and } \quad\left\{\frac{a+b}{p^{k}}\right\}>\frac{1}{2} \tag{5}
\end{equation*}


which is what we wanted to obtain.\\
Comment 2. Once one tries to prove the existence of suitable $p$ and $k$ satisfying (5), it seems somehow natural to suppose that $a \leqslant b$ and to add the restriction $p^{k}>a$. In this case the inequalities (5) can be rewritten as

$$
2 a<p^{k}, \quad 2 m p^{k}<2 b<(2 m+1) p^{k}, \quad \text { and } \quad(2 m+1) p^{k}<2(a+b)<(2 m+2) p^{k}
$$

for some positive integer $m$. This means exactly that one of the numbers $2 a+1,2 a+3, \ldots, 2 a+2 b-1$ is divisible by some number of the form $p^{k}$ which is greater than $2 a$.

Using more advanced techniques, one can show that such a number $p^{k}$ exists even with $k=1$. This was shown in 2004 by Laishram and Shorey; the methods used for this proof are elementary but still quite involved. In fact, their result generalises a theorem by SYLVESTER which states that for every pair of integers $(n, k)$ with $n \geqslant k \geqslant 1$, the product $(n+1)(n+2) \cdots(n+k)$ is divisible by some prime $p>k$. We would like to mention here that Sylvester's theorem itself does not seem to suffice for solving the problem.",4,"For any real number x, relate the distance to the nearest integer, ||x||, to the floor function.",The integer nearest to x is given by floor(x + 1/2). The distance ||x|| is the absolute difference: ||x|| = |floor(x + 1/2) - x|. This implies that floor(x + 1/2) = x ± ||x||.,"For a positive integer n and an odd prime p, derive a formula for the p-adic valuation of the odd double factorial, v_p((2n-1)!!).","The p-adic valuation v_p((2n-1)!!) is found by summing, for each k ≥ 1, the number of multiples of p^k in the set {1, 3, ..., 2n-1}. An odd multiple of p^k can be written as (2l-1)p^k, and it is in the set if 0 < (2l-1)p^k ≤ 2n, which is equivalent to 1 ≤ l ≤ floor(n/p^k + 1/2). Thus, there are floor(n/p^k + 1/2) such multiples for each k. Summing over all k ≥ 1 gives the formula v_p((2n-1)!!) = Σ_{k=1 to ∞} floor(n/p^k + 1/2).","For any pair of positive integers (a, b), show that there exists an odd prime p and a positive integer k such that the integer d_k = floor((a+b)/p^k + 1/2) - floor(a/p^k + 1/2) - floor(b/p^k + 1/2) is positive.","Consider the rational number N = (2a+2b-1)!! / ((2a-1)!! * (2b-1)!!). Since a, b > 0, we have N > 1, so there exists a prime p with v_p(N) > 0. As N is a ratio of products of odd integers, p must be an odd prime. Using the formula from the previous sub-problem, we have v_p(N) = Σ_{k=1 to ∞} (floor((a+b)/p^k + 1/2) - floor(a/p^k + 1/2) - floor(b/p^k + 1/2)). As this sum of integers is positive, at least one term d_k must be positive.","For every pair (a, b) of positive integers there exist an odd prime p and a positive integer k satisfying ||a/p^k|| + ||b/p^k|| + ||(a+b)/p^k|| = 1.","From the previous step, for some odd prime p and integer k ≥ 1, we have d_k = floor((a+b)/p^k + 1/2) - floor(a/p^k + 1/2) - floor(b/p^k + 1/2) ≥ 1. Using floor(z + 1/2) = z ± ||z||, we can write d_k = ( (a+b)/p^k ± ||(a+b)/p^k|| ) - ( a/p^k ± ||a/p^k|| ) - ( b/p^k ± ||b/p^k|| ) = ±||(a+b)/p^k|| ∓ ||a/p^k|| ∓ ||b/p^k||. For any rational x = q/p^k with an odd prime p, ||x|| < 1/2. Thus, |d_k| ≤ ||a/p^k|| + ||b/p^k|| + ||(a+b)/p^k|| < 3/2. Since d_k is an integer and d_k ≥ 1, we must have d_k = 1. This is only possible if the signs align to maximize the expression, which means ||a/p^k|| + ||b/p^k|| + ||(a+b)/p^k|| = 1."
2013a1,"Let $n$ be a positive integer and let $a_{1}, \ldots, a_{n-1}$ be arbitrary real numbers. Define the sequences $u_{0}, \ldots, u_{n}$ and $v_{0}, \ldots, v_{n}$ inductively by $u_{0}=u_{1}=v_{0}=v_{1}=1$, and

$$
u_{k+1}=u_{k}+a_{k} u_{k-1}, \quad v_{k+1}=v_{k}+a_{n-k} v_{k-1} \quad \text { for } k=1, \ldots, n-1 .
$$

Prove that $u_{n}=v_{n}$.","We prove by induction on $k$ that

\begin{equation*}
u_{k}=\sum_{\substack{0<i_{1}<\ldots<i_{t}<k, i_{j}+1-i_{j} \geqslant 2}} a_{i_{1}} \ldots a_{i_{t}} . \tag{1}
\end{equation*}

Note that we have one trivial summand equal to 1 (which corresponds to $t=0$ and the empty sequence, whose product is 1 ).

For $k=0,1$ the sum on the right-hand side only contains the empty product, so (1) holds due to $u_{0}=u_{1}=1$. For $k \geqslant 1$, assuming the result is true for $0,1, \ldots, k$, we have

$$
\begin{aligned}
u_{k+1} & =\sum_{\substack{0<i_{1}<\ldots<i_{t}<k, i_{j+1}-i_{j} \geqslant 2}} a_{i_{1}} \ldots a_{i_{t}}+\sum_{\substack{0<i_{1}<\ldots<i_{t}<k-1, i_{j+1}-i_{j} \geqslant 2}} a_{i_{1}} \ldots a_{i_{t}} \cdot a_{k} \\
& =a_{\substack{\left.0<i_{1}<\ldots<i_{t}<k+1, i_{j}+1-i_{1} \geqslant 2, k \notin i_{1}, \ldots, i_{t}\right\}}} \ldots a_{i_{t}}+\sum_{\substack{\left.0<i_{1}<\ldots<i_{t}<k+1, i_{j+1}+1-i_{j} \geqslant 2, k \in i_{1}, \ldots, i_{i}\right\}}} a_{i_{1}} \ldots a_{i_{t}} \\
& =\sum_{\substack{0<i_{1}<\ldots<i_{t}<k+1, i_{j} \\
i_{j+1}-i_{j} \geqslant 2}} \ldots a_{i_{t}},
\end{aligned}
$$

as required.\\
Applying (1) to the sequence $b_{1}, \ldots, b_{n}$ given by $b_{k}=a_{n-k}$ for $1 \leqslant k \leqslant n$, we get

\begin{equation*}
v_{k}=\sum_{\substack{0<i_{1}<\ldots<i_{t}<k, i_{j}+1-i_{j} \geqslant 2}} b_{i_{1}} \ldots b_{i_{t}}=\sum_{\substack{n>i_{1}>\ldots>i_{t}>n-k, i_{j}-i_{j}+1 \geqslant 2}} a_{i_{1}} \ldots a_{i_{t}} . \tag{2}
\end{equation*}

For $k=n$ the expressions (1) and (2) coincide, so indeed $u_{n}=v_{n}$.\\",2,"Let the sequence $u_k$ be defined by $u_0=u_1=1$ and $u_{k+1}=u_{k}+a_{k} u_{k-1}$ for $k \\ge 1$. Prove that for $k \\ge 0$, $u_k = \\sum_{\\substack{0<i_{1}<\\ldots<i_{t}<k, \\\\ i_{j+1}-i_{j} \\geqslant 2}} a_{i_{1}} \\ldots a_{i_{t}}$, where the sum is over all sequences of indices satisfying the conditions, and the $t=0$ term (corresponding to the empty sequence of indices) is 1.","We prove the formula by induction on $k$. For $k=0$ and $k=1$, the only valid index sequence is the empty one ($t=0$), so the sum is the empty product, which is 1. This matches $u_0=1$ and $u_1=1$. Assume the formula holds for all integers up to $k$. By the recurrence relation, $u_{k+1}=u_k+a_k u_{k-1}$. Using the inductive hypothesis: \n$u_{k+1} = \\sum_{\\substack{0<i_{1}<\\ldots<i_{t}<k, \\\\ i_{j+1}-i_{j} \\geqslant 2}} a_{i_{1}} \\ldots a_{i_{t}} + a_k \\sum_{\\substack{0<i_{1}<\\ldots<i_{t}<k-1, \\\\ i_{j+1}-i_{j} \\geqslant 2}} a_{i_{1}} \\ldots a_{i_{t}}$.\nThe first sum is over index sets in $\{1, \\ldots, k-1\}$ that don't contain $k$. The second sum, when multiplied by $a_k$, corresponds to index sets that do contain $k$. For any such set $\{i_1, \\ldots, i_t, k\}$, we must have $k-i_t \\ge 2$, which is true since $i_t < k-1$. Combining these two disjoint sets of sums gives all valid index sets for $u_{k+1}$. Thus, the formula holds for $k+1$, completing the induction.","Let $n$ be a positive integer and let $a_{1}, \\ldots, a_{n-1}$ be arbitrary real numbers. Define the sequences $u_{0}, \\ldots, u_{n}$ and $v_{0}, \\ldots, v_{n}$ inductively by $u_{0}=u_{1}=v_{0}=v_{1}=1$, and\n\n$$\nu\nu u_{k+1}=u_{k}+a_{k} u_{k-1}, \\quad v_{k+1}=v_{k}+a_{n-k} v_{k-1} \\quad \text { for } k=1, \\ldots, n-1 .$$\n\nProve that $u_{n}=v_{n}$.","From the first sub-problem, we have the explicit formula $u_{k}=\\sum_{\\substack{0<i_{1}<\\ldots<i_{t}<k, \\\\ i_{j+1}-i_{j} \\geqslant 2}} a_{i_{1}} \\ldots a_{i_{t}}$. For $k=n$, this gives $u_{n}=\\sum_{\\substack{0<i_{1}<\\ldots<i_{t}<n, \\\\ i_{j+1}-i_{j} \\geqslant 2}} a_{i_{1}} \\ldots a_{i_{t}}$.\nFor the sequence $v_k$, let $b_k = a_{n-k}$ for $k=1, \\ldots, n-1$. The recurrence becomes $v_{k+1} = v_k + b_k v_{k-1}$, with $v_0=v_1=1$. This is the same form as the recurrence for $u_k$, so we can apply the same formula with $b_j$'s:\n$v_{k}=\\sum_{\\substack{0<j_{1}<\\ldots<j_{t}<k, \\\\ j_{l+1}-j_{l} \\geqslant 2}} b_{j_{1}} \\ldots b_{j_{t}} = \\sum_{\\substack{0<j_{1}<\\ldots<j_{t}<k, \\\\ j_{l+1}-j_{l} \\geqslant 2}} a_{n-j_{1}} \\ldots a_{n-j_{t}}$.\nFor $k=n$, we have $v_{n}=\\sum_{\\substack{0<j_{1}<\\ldots<j_{t}<n, \\\\ j_{l+1}-j_{l} \\geqslant 2}} a_{n-j_{1}} \\ldots a_{n-j_{t}}$.\nLet's perform a change of variables in the summation for $v_n$. Let the new index set $\{i_1, \\ldots, i_t\}$ be defined by $\{i_1, \\ldots, i_t\} = \{n-j_t, \\ldots, n-j_1\}$. The condition $0 < j_1 < \\dots < j_t < n$ implies $0 < n-j_t < \\dots < n-j_1 < n$, so $0 < i_1 < \\dots < i_t < n$. The condition $j_{l+1} - j_l \\ge 2$ implies $(n-i_{t-l}) - (n-i_{t-(l-1)}) \\ge 2$, which is $i_{t-l+1} - i_{t-l} \\ge 2$. This condition holds for all adjacent indices in the set $\{i_1, \\dots, i_t\}$.\nThe summation for $v_n$ is over the same collection of index sets as the summation for $u_n$, and the products of the $a_i$ are the same. Therefore, $u_n=v_n$.",,,,
2013a2,"Prove that in any set of 2000 distinct real numbers there exist two pairs $a>b$ and $c>d$ with $a \neq c$ or $b \neq d$, such that

$$
\left|\frac{a-b}{c-d}-1\right|<\frac{1}{100000}
$$","Solution. For any set $S$ of $n=2000$ distinct real numbers, let $D_{1} \leqslant D_{2} \leqslant \cdots \leqslant D_{m}$ be the distances between them, displayed with their multiplicities. Here $m=n(n-1) / 2$. By rescaling the numbers, we may assume that the smallest distance $D_{1}$ between two elements of $S$ is $D_{1}=1$. Let $D_{1}=1=y-x$ for $x, y \in S$. Evidently $D_{m}=v-u$ is the difference between the largest element $v$ and the smallest element $u$ of $S$.

If $D_{i+1} / D_{i}<1+10^{-5}$ for some $i=1,2, \ldots, m-1$ then the required inequality holds, because $0 \leqslant D_{i+1} / D_{i}-1<10^{-5}$. Otherwise, the reverse inequality

$$
\frac{D_{i+1}}{D_{i}} \geqslant 1+\frac{1}{10^{5}}
$$

holds for each $i=1,2, \ldots, m-1$, and therefore

$$
v-u=D_{m}=\frac{D_{m}}{D_{1}}=\frac{D_{m}}{D_{m-1}} \cdots \frac{D_{3}}{D_{2}} \cdot \frac{D_{2}}{D_{1}} \geqslant\left(1+\frac{1}{10^{5}}\right)^{m-1} .
$$

From $m-1=n(n-1) / 2-1=1000 \cdot 1999-1>19 \cdot 10^{5}$, together with the fact that for all $n \geqslant 1$, $\left(1+\frac{1}{n}\right)^{n} \geqslant 1+\binom{n}{1} \cdot \frac{1}{n}=2$, we get

$$
\left(1+\frac{1}{10^{5}}\right)^{19 \cdot 10^{5}}=\left(\left(1+\frac{1}{10^{5}}\right)^{10^{5}}\right)^{19} \geqslant 2^{19}=2^{9} \cdot 2^{10}>500 \cdot 1000>2 \cdot 10^{5}
$$

and so $v-u=D_{m}>2 \cdot 10^{5}$.\\
Since the distance of $x$ to at least one of the numbers $u, v$ is at least $(u-v) / 2>10^{5}$, we have

$$
|x-z|>10^{5} .
$$

for some $z \in\{u, v\}$. Since $y-x=1$, we have either $z>y>x$ (if $z=v$ ) or $y>x>z($ if $z=u)$. If $z>y>x$, selecting $a=z, b=y, c=z$ and $d=x$ (so that $b \neq d$ ), we obtain

$$
\left|\frac{a-b}{c-d}-1\right|=\left|\frac{z-y}{z-x}-1\right|=\left|\frac{x-y}{z-x}\right|=\frac{1}{z-x}<10^{-5} .
$$

Otherwise, if $y>x>z$, we may choose $a=y, b=z, c=x$ and $d=z$ (so that $a \neq c$ ), and obtain

$$
\left|\frac{a-b}{c-d}-1\right|=\left|\frac{y-z}{x-z}-1\right|=\left|\frac{y-x}{x-z}\right|=\frac{1}{x-z}<10^{-5} .
$$

The desired result follows.\\
Comment. As the solution shows, the numbers 2000 and $\frac{1}{100000}$ appearing in the statement of the problem may be replaced by any $n \in \mathbb{Z}_{>0}$ and $\delta>0$ satisfying

$$
\delta(1+\delta)^{n(n-1) / 2-1}>2 .
$$",3,"Let $S$ be a set of $n=2000$ distinct real numbers. Let $D_1 \u2264 D_2 \u2264 \dots \u2264 D_m$ be the sorted positive differences between pairs of elements in $S$, where $m=n(n-1)/2$. Assuming the smallest difference is $D_1=1$ and that $\frac{D_{i+1}}{D_i} \u2265 1 + 10^{-5}$ for all $i=1, \dots, m-1$, prove that the largest difference $D_m$ is greater than $2 \cdot 10^5$.","Under the given assumptions, the largest difference $D_m$ can be expressed as a product of ratios: $D_m = D_1 \cdot \frac{D_2}{D_1} \cdot \frac{D_3}{D_2} \cdots \frac{D_m}{D_{m-1}}$. Since $D_1=1$ and each ratio is at least $1+10^{-5}$, we have $D_m \u2265 (1+10^{-5})^{m-1}$. For $n=2000$, $m-1 = \frac{2000 \cdot 1999}{2} - 1 = 1998999 > 1.9 \cdot 10^6$. Using the inequality $(1+1/k)^k \u2265 2$, we get $D_m \u2265 (1+10^{-5})^{19 \cdot 10^5} = ((1+10^{-5})^{10^5})^{19} \u2265 2^{19} = 524288 > 2 \cdot 10^5$. Thus, $D_m > 2 \cdot 10^5$.","Let $S$ be a set of distinct real numbers with smallest element $u$ and largest element $v$. Suppose $v-u > 2 \cdot 10^5$ and there exist $x, y \in S$ such that $y-x=1$. Prove there exist two pairs $a>b$ and $c>d$ from $S$ with $a \neq c$ or $b \neq d$, such that $\\left|\frac{a-b}{c-d}-1\right|<10^{-5}$.","Since $v-u > 2 \cdot 10^5$, the distance from $x$ to one of the endpoints, $u$ or $v$, must be greater than $(v-u)/2 > 10^5$. Let $z \in \{u, v\}$ be such that $|x-z| > 10^5$. Since $y-x=1$, we have two ordering possibilities: $z>y>x$ (when $z=v$) or $y>x>z$ (when $z=u$). If $z>y>x$, choose $a=z, b=y, c=z, d=x$. Then $b \neq d$ and $\\left|\frac{z-y}{z-x}-1\right| = \\left|\frac{x-y}{z-x}\right| = \frac{1}{z-x} < 10^{-5}$. If $y>x>z$, choose $a=y, b=z, c=x, d=z$. Then $a \neq c$ and $\\left|\frac{y-z}{x-z}-1\right| = \\left|\frac{y-x}{x-z}\right| = \frac{1}{x-z} < 10^{-5}$. In both cases, the required pairs exist.","Prove that in any set of 2000 distinct real numbers there exist two pairs $a>b$ and $c>d$ with $a \neq c$ or $b \neq d$, such that\n\n$$ \n\\left|\frac{a-b}{c-d}-1\right|<\frac{1}{100000}\n$$","Let $S$ be the set of $n=2000$ numbers. Let $D_1 \u2264 D_2 \u2264 \dots \u2264 D_m$ be the sorted positive differences between pairs of elements in $S$. By scaling the numbers in $S$, we can assume the smallest difference is $D_1=1$. We consider two cases. Case 1: There exists an $i$ such that $D_{i+1}/D_i < 1+10^{-5}$. Let $D_{i+1}=a-b$ and $D_i=c-d$. Since $D_i < D_{i+1}$, the pairs $(a,b)$ and $(c,d)$ are distinct. Then $0 \u2264 \frac{a-b}{c-d} - 1 < 10^{-5}$, which satisfies the inequality. Case 2: For all $i$, $D_{i+1}/D_i \u2265 1+10^{-5}$. From Sub-problem 1, this implies the difference between the largest element $v$ and smallest element $u$ of $S$ is $v-u > 2 \cdot 10^5$. We also have $D_1=y-x=1$ for some $x,y \in S$. By Sub-problem 2, these conditions are sufficient to find the required pairs. Since one of these cases must hold, the proof is complete.",,
2013a3,"Let $\mathbb{Q}_{>0}$ be the set of positive rational numbers. Let $f: \mathbb{Q}_{>0} \rightarrow \mathbb{R}$ be a function satisfying the conditions


\begin{align*}
& f(x) f(y) \geqslant f(x y)  \tag{1}\\
& f(x+y) \geqslant f(x)+f(y) \tag{2}
\end{align*}


for all $x, y \in \mathbb{Q}_{>0}$. Given that $f(a)=a$ for some rational $a>1$, prove that $f(x)=x$ for all $x \in \mathbb{Q}_{>0}$.\\","Solution. Denote by $\mathbb{Z}_{>0}$ the set of positive integers.\\
Plugging $x=1, y=a$ into (1) we get $f(1) \geqslant 1$. Next, by an easy induction on $n$ we get from (2) that


\begin{equation*}
f(n x) \geqslant n f(x) \text { for all } n \in \mathbb{Z}_{>0} \text { and } x \in \mathbb{Q}_{>0} \tag{3}
\end{equation*}


In particular, we have


\begin{equation*}
f(n) \geqslant n f(1) \geqslant n \quad \text { for all } n \in \mathbb{Z}_{>0} \text {. } \tag{4}
\end{equation*}


From (1) again we have $f(m / n) f(n) \geqslant f(m)$, so $f(q)>0$ for all $q \in \mathbb{Q}_{>0}$.\\
Now, (2) implies that $f$ is strictly increasing; this fact together with (4) yields

$$
f(x) \geqslant f(\lfloor x\rfloor) \geqslant\lfloor x\rfloor>x-1 \quad \text { for all } x \geqslant 1
$$

By an easy induction we get from (1) that $f(x)^{n} \geqslant f\left(x^{n}\right)$, so

$$
f(x)^{n} \geqslant f\left(x^{n}\right)>x^{n}-1 \quad \Longrightarrow \quad f(x) \geqslant \sqrt[n]{x^{n}-1} \quad \text { for all } x>1 \text { and } n \in \mathbb{Z}_{>0}
$$

This yields


\begin{equation*}
f(x) \geqslant x \quad \text { for every } x>1 \tag{5}
\end{equation*}


(Indeed, if $x>y>1$ then $x^{n}-y^{n}=(x-y)\left(x^{n-1}+x^{n-2} y+\cdots+y^{n}\right)>n(x-y)$, so for a large $n$ we have $x^{n}-1>y^{n}$ and thus $f(x)>y$.)

Now, (1) and (5) give $a^{n}=f(a)^{n} \geqslant f\left(a^{n}\right) \geqslant a^{n}$, so $f\left(a^{n}\right)=a^{n}$. Now, for $x>1$ let us choose $n \in \mathbb{Z}_{>0}$ such that $a^{n}-x>1$. Then by (2) and (5) we get

$$
a^{n}=f\left(a^{n}\right) \geqslant f(x)+f\left(a^{n}-x\right) \geqslant x+\left(a^{n}-x\right)=a^{n}
$$

and therefore $f(x)=x$ for $x>1$. Finally, for every $x \in \mathbb{Q}_{>0}$ and every $n \in \mathbb{Z}_{>0}$, from (1) and (3) we get

$$
n f(x)=f(n) f(x) \geqslant f(n x) \geqslant n f(x)
$$

which gives $f(n x)=n f(x)$. Therefore $f(m / n)=f(m) / n=m / n$ for all $m, n \in \mathbb{Z}_{>0}$.\\
Comment. The condition $f(a)=a>1$ is essential. Indeed, for $b \geqslant 1$ the function $f(x)=b x^{2}$ satisfies (1) and (2) for all $x, y \in \mathbb{Q}_{>0}$, and it has a unique fixed point $1 / b \leqslant 1$.",3,Show that $f(x) \ge x$ for all rational numbers $x > 1$.,"From $f(x+y) \ge f(x)+f(y)$, induction gives $f(nx) \ge n f(x)$ for $n \in \mathbb{Z}_{>0}$. From $f(x)f(y) \ge f(xy)$ and $f(a)=a>1$, we have $f(1)f(a) \ge f(a)$, which implies $f(1) \ge 1$. Thus, for any integer $n \ge 1$, $f(n) \ge n f(1) \ge n$. For any $q=m/n \in \mathbb{Q}_{>0}$, $f(q)f(n) \ge f(m)$, so $f(q) \ge f(m)/f(n) > 0$. Since $f$ is strictly positive, condition (2) implies $f$ is strictly increasing. By induction on (1), $f(x)^n \ge f(x^n)$. For $x>1$, we have $f(x)^n \ge f(x^n) \ge f(\lfloor x^n \rfloor) \ge \lfloor x^n \rfloor > x^n - 1$. This implies $f(x) \ge \sqrt[n]{x^n - 1}$. As $n \to \infty$, the right side approaches $x$, so we conclude $f(x) \ge x$.",Show that $f(x) = x$ for all rational numbers $x > 1$.,"From condition (1), $f(a)^n \ge f(a^n)$. As $f(a)=a$, this is $a^n \ge f(a^n)$. From the previous step, since $a>1 \implies a^n>1$, we have $f(a^n) \ge a^n$. Together, these imply $f(a^n) = a^n$ for all integers $n \ge 1$. For any rational $x>1$, choose an integer $n$ large enough so that $a^n - x > 1$. By condition (2), $f(a^n) = f(x + (a^n-x)) \ge f(x) + f(a^n-x)$. Using the result from the previous sub-problem, we have $f(x) \ge x$ and $f(a^n-x) \ge a^n-x$. Thus, $a^n = f(a^n) \ge f(x) + f(a^n-x) \ge x + (a^n-x) = a^n$. This forces all inequalities to be equalities, which implies $f(x)=x$ for any rational $x>1$.",Prove that $f(x)=x$ for all $x \in \mathbb{Q}_{>0}$.,"From the previous sub-problem, $f(x)=x$ for all rational $x>1$. This implies $f(n)=n$ for all integers $n \ge 2$. From $f(2)=f(1+1) \ge 2f(1)$, we have $2 \ge 2f(1)$, so $f(1) \le 1$. We already showed $f(1) \ge 1$ in the first sub-problem, so $f(1)=1$. Thus $f(n)=n$ for all $n \in \mathbb{Z}_{>0}$. For any $n \in \mathbb{Z}_{>0}$ and $x \in \mathbb{Q}_{>0}$, condition (1) gives $f(nx) \le f(n)f(x) = nf(x)$, and condition (2) gives $f(nx) \ge nf(x)$. Therefore, $f(nx) = nf(x)$. Now, let $x=m/n$ for any $m, n \in \mathbb{Z}_{>0}$. We have $f(m) = f(n \cdot (m/n)) = nf(m/n)$. Since $f(m)=m$, we get $m=nf(m/n)$, which implies $f(m/n)=m/n$. Thus, $f(x)=x$ for all $x \in \mathbb{Q}_{>0}$.",,
2013a4,"Let $n$ be a positive integer, and consider a sequence $a_{1}, a_{2}, \ldots, a_{n}$ of positive integers. Extend it periodically to an infinite sequence $a_{1}, a_{2}, \ldots$ by defining $a_{n+i}=a_{i}$ for all $i \geqslant 1$. If


\begin{equation*}
a_{1} \leqslant a_{2} \leqslant \cdots \leqslant a_{n} \leqslant a_{1}+n \tag{1}
\end{equation*}


and


\begin{equation*}
a_{a_{i}} \leqslant n+i-1 \quad \text { for } i=1,2, \ldots, n \tag{2}
\end{equation*}


prove that


\begin{equation*}
a_{1}+\cdots+a_{n} \leqslant n^{2} . \tag{Germany}
\end{equation*}","First, we claim that

\begin{equation*}
a_{i} \leqslant n+i-1 \quad \text { for } i=1,2, \ldots, n \text {. } \tag{3}
\end{equation*}

Assume contrariwise that $i$ is the smallest counterexample. From $a_{n} \geqslant a_{n-1} \geqslant \cdots \geqslant a_{i} \geqslant n+i$ and $a_{a_{i}} \leqslant n+i-1$, taking into account the periodicity of our sequence, it follows that

\begin{equation*}
a_{i} \text { cannot be congruent to } i, i+1, \ldots, n-1, \text { or } n \quad(\bmod n) \text {. } \tag{4}
\end{equation*}

Thus our assumption that $a_{i} \geqslant n+i$ implies the stronger statement that $a_{i} \geqslant 2 n+1$, which by $a_{1}+n \geqslant a_{n} \geqslant a_{i}$ gives $a_{1} \geqslant n+1$. The minimality of $i$ then yields $i=1$, and (4) becomes contradictory. This establishes our first claim.

In particular we now know that $a_{1} \leqslant n$. If $a_{n} \leqslant n$, then $a_{1} \leqslant \cdots \leqslant \cdots a_{n} \leqslant n$ and the desired inequality holds trivially. Otherwise, consider the number $t$ with $1 \leqslant t \leqslant n-1$ such that

\begin{equation*}
a_{1} \leqslant a_{2} \leqslant \ldots \leqslant a_{t} \leqslant n<a_{t+1} \leqslant \ldots \leqslant a_{n} . \tag{5}
\end{equation*}

Since $1 \leqslant a_{1} \leqslant n$ and $a_{a_{1}} \leqslant n$ by (2), we have $a_{1} \leqslant t$ and hence $a_{n} \leqslant n+t$. Therefore if for each positive integer $i$ we let $b_{i}$ be the number of indices $j \in\{t+1, \ldots, n\}$ satisfying $a_{j} \geqslant n+i$, we have

$$
b_{1} \geqslant b_{2} \geqslant \ldots \geqslant b_{t} \geqslant b_{t+1}=0
$$

Next we claim that $a_{i}+b_{i} \leqslant n$ for $1 \leqslant i \leqslant t$. Indeed, by $n+i-1 \geqslant a_{a_{i}}$ and $a_{i} \leqslant n$, each $j$ with $a_{j} \geqslant n+i$ (thus $a_{j}>a_{a_{i}}$ ) belongs to $\left\{a_{i}+1, \ldots, n\right\}$, and for this reason $b_{i} \leqslant n-a_{i}$.

It follows from the definition of the $b_{i} \mathrm{~s}$ and (5) that

$$
a_{t+1}+\ldots+a_{n} \leqslant n(n-t)+b_{1}+\ldots+b_{t}
$$

Adding $a_{1}+\ldots+a_{t}$ to both sides and using that $a_{i}+b_{i} \leqslant n$ for $1 \leqslant i \leqslant t$, we get

$$
a_{1}+a_{2}+\cdots+a_{n} \leqslant n(n-t)+n t=n^{2}
$$

as we wished to prove.",3,"Let the sequence $a_i$ be defined as in the problem. Prove that $a_i \leqslant n+i-1$ for all $i=1, 2, \ldots, n$.","Assume for contradiction that there is a counterexample, and let $i$ be the smallest such index, so $a_i \ge n+i$. Let $a_i \equiv k \pmod n$ for $k \in \{1, \ldots, n\}$. By periodicity, $a_{a_i} = a_k$. If $k \ge i$, then since the sequence is non-decreasing, $a_k \ge a_i \ge n+i$. This contradicts the given condition $a_{a_i} \leqslant n+i-1$. Thus, $k$ must be in $\{1, \ldots, i-1\}$. The condition $a_i \ge n+i$ then implies $a_i \ge 2n+1$. From $a_i \le a_n \le a_1+n$, we get $a_1 \ge n+1$. This means $i=1$ is a counterexample, and by minimality, must be the smallest. But for $i=1$, the set $\{1, \ldots, i-1\}$ is empty, so no such $k$ exists. The assumption leads to a contradiction, so $a_i \leqslant n+i-1$ for all $i$.","If $a_n > n$, let $t$ be the largest index such that $a_t \le n$. For $i \in \{1, \ldots, t\}$, let $b_i$ be the number of indices $j \in \{t+1, \ldots, n\}$ with $a_j \ge n+i$. Prove that $a_i + b_i \le n$ for $1 \le i \le t$.","For any $i \in \{1, \ldots, t\}$, we have $a_i \le n$. From condition (2), $a_{a_i} \leqslant n+i-1$. For any index $j$ counted by $b_i$, we have $a_j \ge n+i$. This implies $a_j > a_{a_i}$. Since the sequence is non-decreasing, we must have $j > a_i$. Thus, all $b_i$ such indices $j$ must belong to the set $\{a_i+1, \ldots, n\}$. The size of this set is $n-a_i$. Therefore, $b_i \le n-a_i$, which rearranges to $a_i+b_i \le n$.",Prove that $a_1 + \cdots + a_n \leqslant n^2$.,"From sub-problem 1, we know $a_1 \le n$. If $a_n \le n$, then all $a_i \le n$, and the sum is trivially $\le n^2$. Otherwise, let $t$ be the largest index with $a_t \le n$, and define $b_i$ as in sub-problem 2. The sum is $\sum_{k=1}^n a_k = \sum_{k=1}^t a_k + \sum_{k=t+1}^n a_k$. By rewriting $\sum_{k=t+1}^n(a_k - n)$ by summing over values instead of indices, we find $\sum_{k=t+1}^n(a_k-n) = \sum_{i=1}^t b_i$. Thus, $\sum_{k=t+1}^n a_k = n(n-t) + \sum_{i=1}^t b_i$. The total sum is $\sum_{k=1}^n a_k = \sum_{k=1}^t a_k + n(n-t) + \sum_{i=1}^t b_i = n(n-t) + \sum_{i=1}^t (a_i+b_i)$. Using the result from sub-problem 2, $a_i+b_i \le n$, we get $\sum_{k=1}^n a_k \le n(n-t) + \sum_{i=1}^t n = n(n-t) + nt = n^2$.",,
2013c3,"A crazy physicist discovered a new kind of particle which he called an imon, after some of them mysteriously appeared in his lab. Some pairs of imons in the lab can be entangled, and each imon can participate in many entanglement relations. The physicist has found a way to perform the following two kinds of operations with these particles, one operation at a time.\\
(i) If some imon is entangled with an odd number of other imons in the lab, then the physicist can destroy it.\\
(ii) At any moment, he may double the whole family of imons in his lab by creating a copy $I^{\prime}$ of each imon $I$. During this procedure, the two copies $I^{\prime}$ and $J^{\prime}$ become entangled if and only if the original imons $I$ and $J$ are entangled, and each copy $I^{\prime}$ becomes entangled with its original imon $I$; no other entanglements occur or disappear at this moment.

Prove that the physicist may apply a sequence of such operations resulting in a family of imons, no two of which are entangled.","Let us consider a graph with the imons as vertices, and two imons being connected if and only if they are entangled. Recall that a proper coloring of a graph $G$ is a coloring of its vertices in several colors so that every two connected vertices have different colors.\\
Lemma. Assume that a graph $G$ admits a proper coloring in $n$ colors ( $n>1$ ). Then one may perform a sequence of operations resulting in a graph which admits a proper coloring in $n-1$ colors.\\
Proof. Let us apply repeatedly operation $(i)$ to any appropriate vertices while it is possible. Since the number of vertices decreases, this process finally results in a graph where all the degrees are even. Surely this graph also admits a proper coloring in $n$ colors $1, \ldots, n$; let us fix this coloring.

Now apply the operation (ii) to this graph. A proper coloring of the resulting graph in $n$ colors still exists: one may preserve the colors of the original vertices and color the vertex $I^{\prime}$ in a color $k+1(\bmod n)$ if the vertex $I$ has color $k$. Then two connected original vertices still have different colors, and so do their two connected copies. On the other hand, the vertices $I$ and $I^{\prime}$ have different colors since $n>1$.

All the degrees of the vertices in the resulting graph are odd, so one may apply operation (i) to delete consecutively all the vertices of color $n$ one by one; no two of them are connected by an edge, so their degrees do not change during the process. Thus, we obtain a graph admitting a proper coloring in $n-1$ colors, as required. The lemma is proved.

Now, assume that a graph $G$ has $n$ vertices; then it admits a proper coloring in $n$ colors. Applying repeatedly the lemma we finally obtain a graph admitting a proper coloring in one color, that is - a graph with no edges, as required.",3,"Let G be a graph where all vertices have even degree, and which admits a proper coloring with n > 1 colors. Show that after applying operation (ii), the resulting graph G' has all vertices of odd degree and is still n-colorable.","Let d_G(v) be the degree of a vertex v in G. In the new graph G', the original vertex v is now connected to its copy v', so its new degree is d_{G'}(v) = d_G(v) + 1. Since d_G(v) is even, d_{G'}(v) is odd. The copy v' is connected to v and to the copies of v's neighbors, so its degree d_{G'}(v') is also d_G(v) + 1, which is odd. Thus, all vertices in G' have odd degree. For coloring, if c(v) is the color of v in an n-coloring of G with colors {1, ..., n}, we can color v with c(v) and v' with (c(v) mod n) + 1. This is a proper n-coloring for G' since n > 1 ensures c(v) and c(v') are different, and any two adjacent original vertices (or copied vertices) will also have different colors.","If a graph G admits a proper coloring in n colors (n>1), prove that a sequence of operations can produce a graph that admits a proper coloring in n-1 colors.","First, apply operation (i) repeatedly to G until a graph G_even with all even degrees is obtained. G_even is still n-colorable. Apply operation (ii) to G_even. By the previous result, the new graph G' has all odd-degree vertices and is n-colorable. Using a fixed n-coloring, we can apply operation (i) to delete all vertices of a specific color, say color n. This is possible because all vertices have odd degree, and no two vertices of color n are connected, so deleting one does not change the degree of another of the same color. The resulting graph is properly colored with the remaining n-1 colors.","Prove that the physicist may apply a sequence of such operations resulting in a family of imons, no two of which are entangled.","Represent the imons and entanglements as a graph G. Any graph with V vertices can be properly colored with V colors. If the graph has edges, its chromatic number n is greater than 1. Using the result from the previous sub-problem, we can apply a sequence of operations to obtain a new graph that requires only n-1 colors. By repeating this process, we can reduce the required number of colors until we obtain a graph that is 1-colorable. A graph that admits a proper coloring in one color is a graph with no edges, which corresponds to a family of imons with no entanglements.",,
2013c4,"Let $n$ be a positive integer, and let $A$ be a subset of $\{1, \ldots, n\}$. An $A$-partition of $n$ into $k$ parts is a representation of $n$ as a sum $n=a_{1}+\cdots+a_{k}$, where the parts $a_{1}, \ldots, a_{k}$ belong to $A$ and are not necessarily distinct. The number of different parts in such a partition is the number of (distinct) elements in the set $\left\{a_{1}, a_{2}, \ldots, a_{k}\right\}$.

We say that an $A$-partition of $n$ into $k$ parts is optimal if there is no $A$-partition of $n$ into $r$ parts with $r<k$. Prove that any optimal $A$-partition of $n$ contains at most $\sqrt[3]{6 n}$ different parts.","If there are no $A$-partitions of $n$, the result is vacuously true. Otherwise, let $k_{\text {min }}$ be the minimum number of parts in an $A$-partition of $n$, and let $n=a_{1}+\cdots+a_{k_{\text {min }}}$ be an optimal partition. Denote by $s$ the number of different parts in this partition, so we can write $S=\left\{a_{1}, \ldots, a_{k_{\min }}\right\}=\left\{b_{1}, \ldots, b_{s}\right\}$ for some pairwise different numbers $b_{1}<\cdots<b_{s}$ in $A$.

If $s>\sqrt[3]{6 n}$, we will prove that there exist subsets $X$ and $Y$ of $S$ such that $|X|<|Y|$ and $\sum_{x \in X} x=\sum_{y \in Y} y$. Then, deleting the elements of $Y$ from our partition and adding the elements of $X$ to it, we obtain an $A$-partition of $n$ into less than $k_{\min }$ parts, which is the desired contradiction.

For each positive integer $k \leqslant s$, we consider the $k$-element subset

$$
S_{1,0}^{k}:=\left\{b_{1}, \ldots, b_{k}\right\}
$$

as well as the following $k$-element subsets $S_{i, j}^{k}$ of $S$ :

$$
S_{i, j}^{k}:=\left\{b_{1}, \ldots, b_{k-i}, b_{k-i+j+1}, b_{s-i+2}, \ldots, b_{s}\right\}, \quad i=1, \ldots, k, \quad j=1, \ldots, s-k
$$

Pictorially, if we represent the elements of $S$ by a sequence of dots in increasing order, and represent a subset of $S$ by shading in the appropriate dots, we have:\\
\includegraphics[max width=\textwidth, center]{2025_04_30_f697ddf0f0f1661c3074g-27}

Denote by $\Sigma_{i, j}^{k}$ the sum of elements in $S_{i, j}^{k}$. Clearly, $\Sigma_{1,0}^{k}$ is the minimum sum of a $k$-element subset of $S$. Next, for all appropriate indices $i$ and $j$ we have

$$
\Sigma_{i, j}^{k}=\Sigma_{i, j+1}^{k}+b_{k-i+j+1}-b_{k-i+j+2}<\Sigma_{i, j+1}^{k} \quad \text { and } \quad \sum_{i, s-k}^{k}=\sum_{i+1,1}^{k}+b_{k-i}-b_{k-i+1}<\sum_{i+1,1}^{k} .
$$

Therefore

$$
1 \leqslant \sum_{1,0}^{k}<\sum_{1,1}^{k}<\sum_{1,2}^{k}<\cdots<\sum_{1, s-k}^{k}<\sum_{2,1}^{k}<\cdots<\sum_{2, s-k}^{k}<\sum_{3,1}^{k}<\cdots<\sum_{k, s-k}^{k} \leqslant n .
$$

To see this in the picture, we start with the $k$ leftmost points marked. At each step, we look for the rightmost point which can move to the right, and move it one unit to the right. We continue until the $k$ rightmost points are marked. As we do this, the corresponding sums clearly increase.

For each $k$ we have found $k(s-k)+1$ different integers of the form $\sum_{i, j}^{k}$ between 1 and $n$. As we vary $k$, the total number of integers we are considering is

$$
\sum_{k=1}^{s}(k(s-k)+1)=s \cdot \frac{s(s+1)}{2}-\frac{s(s+1)(2 s+1)}{6}+s=\frac{s\left(s^{2}+5\right)}{6}>\frac{s^{3}}{6}>n .
$$

Since they are between 1 and $n$, at least two of these integers are equal. Consequently, there exist $1 \leqslant k<k^{\prime} \leqslant s$ and $X=S_{i, j}^{k}$ as well as $Y=S_{i^{\prime}, j^{\prime}}^{k^{\prime}}$ such that

$$
\sum_{x \in X} x=\sum_{y \in Y} y, \quad \text { but } \quad|X|=k<k^{\prime}=|Y|,
$$

as required. The result follows.",3,"For a set of $s$ distinct items, a specific construction generates, for each $k \in \{1, \ldots, s\}$, a collection of $k(s-k)+1$ distinct configurations of size $k$. Show that the total number of configurations generated across all $k$ is $\sum_{k=1}^s (k(s-k)+1) = \frac{s(s^2+5)}{6}$.","The total number of configurations is the sum over $k$ from 1 to $s$ of the number of configurations for each size $k$. We compute this sum: $\sum_{k=1}^{s}(k(s-k)+1) = \sum_{k=1}^{s}(ks - k^2 + 1) = s \sum_{k=1}^{s} k - \sum_{k=1}^{s} k^2 + \sum_{k=1}^{s} 1$. Using the standard formulas for sums of powers, this becomes $s \cdot \frac{s(s+1)}{2} - \frac{s(s+1)(2s+1)}{6} + s$. Algebraic simplification yields $\frac{3s^2(s+1) - s(s+1)(2s+1) + 6s}{6} = \frac{s(s+1)(3s - (2s+1)) + 6s}{6} = \frac{s(s^2-1)+6s}{6} = \frac{s^3+5s}{6}$.","Let $S$ be the set of $s$ distinct parts in an optimal $A$-partition of $n$. Assuming $s > \sqrt[3]{6n}$, prove that there exist two subsets $X, Y \subset S$ such that $\sum_{x \in X} x = \sum_{y \in Y} y$ and $|X| \neq |Y|$.","For the set $S$ of $s$ distinct parts, one can construct families of subsets of varying sizes. As established in sub-problem 1, the total number of subsets in these specific families is $\frac{s(s^2+5)}{6}$. The condition $s > \sqrt[3]{6n}$ implies $s^3 > 6n$, so the number of generated subsets is $\frac{s(s^2+5)}{6} > \frac{s^3}{6} > n$. The sum of elements of any subset of $S$ is an integer at most $\sum_{b \in S} b \le n$. By construction, the sums of subsets of a fixed size are distinct. Since we have more than $n$ sums of subsets, all of which are integers in the range $[1, n]$, the Pigeonhole Principle guarantees that at least two sums must be equal. These two sums must come from subsets of different sizes. Let these subsets be $X$ and $Y$; then $\sum_{x \in X} x = \sum_{y \in Y} y$ and $|X| \neq |Y|$.",Prove that any optimal $A$-partition of $n$ contains at most $\sqrt[3]{6 n}$ different parts.,"Let an optimal $A$-partition of $n$ have $k_{min}$ parts and let $S$ be the set of $s$ distinct parts. Assume for contradiction that $s > \sqrt[3]{6n}$. From sub-problem 2, this implies there exist two subsets $X, Y \subset S$ with $\sum_{x \in X} x = \sum_{y \in Y} y$ and $|X| < |Y|$ (without loss of generality). Since the partition is optimal, every part in $S$ must be used at least once. We can therefore modify the partition by removing one instance of each part in $Y$ and adding one instance of each part in $X$. The total sum remains $n$ because the sum of the elements of $X$ equals the sum of the elements of $Y$. The new number of parts is $k_{min} - |Y| + |X|$, which is less than $k_{min}$. This contradicts the definition of an optimal partition. Therefore, the assumption $s > \sqrt[3]{6n}$ must be false, which means $s \le \sqrt[3]{6n}$.",,
2013c5,"Let $r$ be a positive integer, and let $a_{0}, a_{1}, \ldots$ be an infinite sequence of real numbers. Assume that for all nonnegative integers $m$ and $s$ there exists a positive integer $n \in[m+1, m+r]$ such that

$$
a_{m}+a_{m+1}+\cdots+a_{m+s}=a_{n}+a_{n+1}+\cdots+a_{n+s} .
$$

Prove that the sequence is periodic, i. e. there exists some $p \geqslant 1$ such that $a_{n+p}=a_{n}$ for all $n \geqslant 0$.","Solution. For every indices $m \leqslant n$ we will denote $S(m, n)=a_{m}+a_{m+1}+\cdots+a_{n-1}$; thus $S(n, n)=0$. Let us start with the following lemma.\\
Lemma. Let $b_{0}, b_{1}, \ldots$ be an infinite sequence. Assume that for every nonnegative integer $m$ there exists a nonnegative integer $n \in[m+1, m+r]$ such that $b_{m}=b_{n}$. Then for every indices $k \leqslant \ell$ there exists an index $t \in[\ell, \ell+r-1]$ such that $b_{t}=b_{k}$. Moreover, there are at most $r$ distinct numbers among the terms of $\left(b_{i}\right)$.\\
Proof. To prove the first claim, let us notice that there exists an infinite sequence of indices $k_{1}=k, k_{2}, k_{3}, \ldots$ such that $b_{k_{1}}=b_{k_{2}}=\cdots=b_{k}$ and $k_{i}<k_{i+1} \leqslant k_{i}+r$ for all $i \geqslant 1$. This sequence is unbounded from above, thus it hits each segment of the form $[\ell, \ell+r-1]$ with $\ell \geqslant k$, as required.

To prove the second claim, assume, to the contrary, that there exist $r+1$ distinct numbers $b_{i_{1}}, \ldots, b_{i_{r+1}}$. Let us apply the first claim to $k=i_{1}, \ldots, i_{r+1}$ and $\ell=\max \left\{i_{1}, \ldots, i_{r+1}\right\}$; we obtain that for every $j \in\{1, \ldots, r+1\}$ there exists $t_{j} \in[s, s+r-1]$ such that $b_{t_{j}}=b_{i_{j}}$. Thus the segment [ $s, s+r-1$ ] should contain $r+1$ distinct integers, which is absurd.

Setting $s=0$ in the problem condition, we see that the sequence $\left(a_{i}\right)$ satisfies the condition of the lemma, thus it attains at most $r$ distinct values. Denote by $A_{i}$ the ordered $r$-tuple $\left(a_{i}, \ldots, a_{i+r-1}\right)$; then among $A_{i}$ 's there are at most $r^{r}$ distinct tuples, so for every $k \geqslant 0$ two of the tuples $A_{k}, A_{k+1}, \ldots, A_{k+r^{r}}$ are identical. This means that there exists a positive integer $p \leqslant r^{r}$ such that the equality $A_{d}=A_{d+p}$ holds infinitely many times. Let $D$ be the set of indices $d$ satisfying this relation.

Now we claim that $D$ coincides with the set of all nonnegative integers. Since $D$ is unbounded, it suffices to show that $d \in D$ whenever $d+1 \in D$. For that, denote $b_{k}=S(k, p+k)$. The sequence $b_{0}, b_{1}, \ldots$ satisfies the lemma conditions, so there exists an index $t \in[d+1, d+r]$ such that $S(t, t+p)=S(d, d+p)$. This last relation rewrites as $S(d, t)=S(d+p, t+p)$. Since $A_{d+1}=A_{d+p+1}$, we have $S(d+1, t)=S(d+p+1, t+p)$, therefore we obtain

$$
a_{d}=S(d, t)-S(d+1, t)=S(d+p, t+p)-S(d+p+1, t+p)=a_{d+p}
$$

and thus $A_{d}=A_{d+p}$, as required.\\
Finally, we get $A_{d}=A_{d+p}$ for all $d$, so in particular $a_{d}=a_{d+p}$ for all $d$, QED.

Comment 1. In the present proof, the upper bound for the minimal period length is $r^{r}$. This bound is not sharp; for instance, one may improve it to $(r-1)^{r}$ for $r \geqslant 3$..

On the other hand, this minimal length may happen to be greater than $r$. For instance, it is easy to check that the sequence with period $(3,-3,3,-3,3,-1,-1,-1)$ satisfies the problem condition for $r=7$.

Comment 2. The conclusion remains true even if the problem condition only holds for every $s \geqslant N$ for some positive integer $N$. To show that, one can act as follows. Firstly, the sums of the form $S(i, i+N)$ attain at most $r$ values, as well as the sums of the form $S(i, i+N+1)$. Thus the terms $a_{i}=S(i, i+N+1)-$ $S(i+1, i+N+1)$ attain at most $r^{2}$ distinct values. Then, among the tuples $A_{k}, A_{k+N}, \ldots, A_{k+r^{2 r} N}$ two\\
are identical, so for some $p \leqslant r^{2 r}$ the set $D=\left\{d: A_{d}=A_{d+N p}\right\}$ is infinite. The further arguments apply almost literally, with $p$ being replaced by $N p$.

After having proved that such a sequence is also necessarily periodic, one may reduce the bound for the minimal period length to $r^{r}$ - essentially by verifying that the sequence satisfies the original version of the condition.",4,"Let $b_{0}, b_{1}, \ldots$ be an infinite sequence of real numbers. Assume that for every nonnegative integer $m$, there exists an integer $n \in[m+1, m+r]$ such that $b_{m}=b_{n}$. Prove that the sequence has at most $r$ distinct values.","Assume for contradiction that there exist $r+1$ distinct values $b_{i_{1}}, \ldots, b_{i_{r+1}}$. Let $\ell = \max\{i_{1}, \ldots, i_{r+1}\}$. The given property implies that for any value in the sequence and any starting index, that value must reappear later. Specifically, for each $j \in\{1, \ldots, r+1\}$, there must exist an index $t_{j}$ in the interval $[\ell, \ell+r-1]$ such that $b_{t_{j}}=b_{i_{j}}$. This would mean that the $r$ terms in the segment $\{b_{\ell}, b_{\ell+1}, \ldots, b_{\ell+r-1}\}$ must take on all $r+1$ distinct values, which is a contradiction. Therefore, the sequence can have at most $r$ distinct values.","Let $A_i$ be the $r$-tuple $(a_i, \ldots, a_{i+r-1})$. Using the result from the previous step, show that there exists a positive integer $p \le r^r$ such that the equality $A_d = A_{d+p}$ holds for an infinite number of indices $d$.","Setting $s=0$ in the original problem's condition, we see that for any $m$, there exists $n \in [m+1, m+r]$ such that $a_m = a_n$. By the result of the previous sub-problem, the sequence $(a_i)$ takes on at most $r$ distinct values. Now consider the sequence of $r$-tuples $A_i = (a_i, \ldots, a_{i+r-1})$. Since each component can take at most $r$ values, there are at most $r^r$ distinct possible tuples. By the pigeonhole principle, among the first $r^r+1$ tuples $A_0, \ldots, A_{r^r}$, at least two must be identical. Thus, there exist $i, j$ with $0 \le i < j \le r^r$ such that $A_i=A_j$. Let $p=j-i$. This argument can be repeated for any subsequent block of $r^r+1$ tuples, guaranteeing that for some $p \le r^r$, the equality $A_d=A_{d+p}$ holds for infinitely many indices $d$.","Let $p$ be an integer for which the set $D = \{d \ge 0 \mid A_d = A_{d+p}\}$ is infinite, where $A_d = (a_d, \ldots, a_{d+r-1})$. Prove that if $d+1 \in D$, then $d \in D$.","Assume $d+1 \in D$, which means $A_{d+1} = A_{d+p+1}$. This implies $a_{d+k}=a_{d+p+k}$ for $k=1, \ldots, r-1$. We must show $a_d = a_{d+p}$ to conclude $A_d=A_{d+p}$. Let $S(m,n) = \sum_{i=m}^{n-1} a_i$. The original condition with $s=p-1$ implies that for $m=d$, there exists $t \in [d+1, d+r]$ with $S(d, d+p) = S(t, t+p)$. This equality can be rewritten as $S(d,t) = S(d+p, t+p)$. Expanding this gives $a_d + S(d+1, t) = a_{d+p} + S(d+p+1, t+p)$. Since $t \in [d+1, d+r]$ and we assumed $A_{d+1} = A_{d+p+1}$, every term in the sum $S(d+1, t)$ is equal to its corresponding term in $S(d+p+1, t+p)$, so these two sums are equal. It follows that $a_d=a_{d+p}$, which completes the proof that $A_d=A_{d+p}$ and thus $d \in D$.","Let $r$ be a positive integer, and let $a_{0}, a_{1}, \ldots$ be an infinite sequence of real numbers. Assume that for all nonnegative integers $m$ and $s$ there exists a positive integer $n \in[m+1, m+r]$ such that\n$$\na_{m}+a_{m+1}+\cdots+a_{m+s}=a_{n}+a_{n+1}+\cdots+a_{n+s} .\n$$\nProve that the sequence is periodic, i. e. there exists some $p \geqslant 1$ such that $a_{n+p}=a_{n}$ for all $n \geqslant 0$.","From Sub-problem 1, the sequence $(a_i)$ takes at most $r$ distinct values. From Sub-problem 2, there exists a positive integer $p \le r^r$ such that the set $D = \{d \ge 0 \mid A_d = A_{d+p}\}$ is infinite, where $A_d = (a_d, \ldots, a_{d+r-1})$. From Sub-problem 3, we have the property that if $d+1 \in D$, then $d \in D$. Since $D$ is an infinite set of non-negative integers, it is unbounded. For any integer $k \ge 0$, we can find an element $d' \in D$ such that $d' > k$. By repeatedly applying the result of Sub-problem 3, it follows that $d'-1, d'-2, \ldots, k$ are all in $D$. Since $k$ was arbitrary, $D$ must be the set of all non-negative integers. Therefore, $A_d=A_{d+p}$ for all $d \ge 0$, which implies $a_d=a_{d+p}$ for all $d \ge 0$. The sequence is periodic."
2013c6,In some country several pairs of cities are connected by direct two-way flights. It is possible to go from any city to any other by a sequence of flights. The distance between two cities is defined to be the least possible number of flights required to go from one of them to the other. It is known that for any city there are at most 100 cities at distance exactly three from it. Prove that there is no city such that more than 2550 other cities have distance exactly four from it.,"Solution. Let us denote by $d(a, b)$ the distance between the cities $a$ and $b$, and by

$$
S_{i}(a)=\{c: d(a, c)=i\}
$$

the set of cities at distance exactly $i$ from city $a$.\\
Assume that for some city $x$ the set $D=S_{4}(x)$ has size at least 2551 . Let $A=S_{1}(x)$. A subset $A^{\prime}$ of $A$ is said to be substantial, if every city in $D$ can be reached from $x$ with four flights while passing through some member of $A^{\prime}$; in other terms, every city in $D$ has distance 3 from some member of $A^{\prime}$, or $D \subseteq \bigcup_{a \in A^{\prime}} S_{3}(a)$. For instance, $A$ itself is substantial. Now let us fix some substantial subset $A^{*}$ of $A$ having the minimal cardinality $m=\left|A^{*}\right|$.

Since

$$
m(101-m) \leqslant 50 \cdot 51=2550,
$$

there has to be a city $a \in A^{*}$ such that $\left|S_{3}(a) \cap D\right| \geqslant 102-m$. As $\left|S_{3}(a)\right| \leqslant 100$, we obtain that $S_{3}(a)$ may contain at most $100-(102-m)=m-2$ cities $c$ with $d(c, x) \leqslant 3$. Let us denote by $T=\left\{c \in S_{3}(a): d(x, c) \leqslant 3\right\}$ the set of all such cities, so $|T| \leqslant m-2$. Now, to get a contradiction, we will construct $m-1$ distinct elements in $T$, corresponding to $m-1$ elements of the set $A_{a}=A^{*} \backslash\{a\}$.

Firstly, due to the minimality of $A^{*}$, for each $y \in A_{a}$ there exists some city $d_{y} \in D$ which can only be reached with four flights from $x$ by passing through $y$. So, there is a way to get from $x$ to $d_{y}$ along $x-y-b_{y}-c_{y}-d_{y}$ for some cities $b_{y}$ and $c_{y}$; notice that $d\left(x, b_{y}\right)=2$ and $d\left(x, c_{y}\right)=3$ since this path has the minimal possible length.

Now we claim that all $2(m-1)$ cities of the form $b_{y}, c_{y}$ with $y \in A_{a}$ are distinct. Indeed, no $b_{y}$ may coincide with any $c_{z}$ since their distances from $x$ are different. On the other hand, if one had $b_{y}=b_{z}$ for $y \neq z$, then there would exist a path of length 4 from $x$ to $d_{z}$ via $y$, namely $x-y-b_{z}-c_{z}-d_{z}$; this is impossible by the choice of $d_{z}$. Similarly, $c_{y} \neq c_{z}$ for $y \neq z$.

So, it suffices to prove that for every $y \in A_{a}$, one of the cities $b_{y}$ and $c_{y}$ has distance 3 from $a$ (and thus belongs to $T$ ). For that, notice that $d(a, y) \leqslant 2$ due to the path $a-x-y$, while $d\left(a, d_{y}\right) \geqslant d\left(x, d_{y}\right)-d(x, a)=3$. Moreover, $d\left(a, d_{y}\right) \neq 3$ by the choice of $d_{y} ;$ thus $d\left(a, d_{y}\right)>3$. Finally, in the sequence $d(a, y), d\left(a, b_{y}\right), d\left(a, c_{y}\right), d\left(a, d_{y}\right)$ the neighboring terms differ by at most 1 , the first term is less than 3 , and the last one is greater than 3 ; thus there exists one which is equal to 3 , as required.

Comment 1. The upper bound 2550 is sharp. This can be seen by means of various examples; one of them is the ""Roman Empire"": it has one capital, called ""Rome"", that is connected to 51 semicapitals by internally disjoint paths of length 3 . Moreover, each of these semicapitals is connected to 50 rural cities by direct flights.

Comment 2. Observe that, under the conditions of the problem, there exists no bound for the size of $S_{1}(x)$ or $S_{2}(x)$.

Comment 3. The numbers 100 and 2550 appearing in the statement of the problem may be replaced by $n$ and $\left\lfloor\frac{(n+1)^{2}}{4}\right\rfloor$ for any positive integer $n$. Still more generally, one can also replace the pair $(3,4)$ of distances under consideration by any pair $(r, s)$ of positive integers satisfying $r<s \leqslant \frac{3}{2} r$.

To adapt the above proof to this situation, one takes $A=S_{s-r}(x)$ and defines the concept of substantiality as before. Then one takes $A^{*}$ to be a minimal substantial subset of $A$, and for each $y \in A^{*}$ one fixes an element $d_{y} \in S_{s}(x)$ which is only reachable from $x$ by a path of length $s$ by passing through $y$. As before, it suffices to show that for distinct $a, y \in A^{*}$ and a path $y=y_{0}-y_{1}-\ldots-y_{r}=d_{y}$, at least one of the cities $y_{0}, \ldots, y_{r-1}$ has distance $r$ from $a$. This can be done as above; the relation $s \leqslant \frac{3}{2} r$ is used here to show that $d\left(a, y_{0}\right) \leqslant r$.

Moreover, the estimate $\left\lfloor\frac{(n+1)^{2}}{4}\right\rfloor$ is also sharp for every positive integer $n$ and every positive integers $r, s$ with $r<s \leqslant \frac{3}{2} r$. This may be shown by an example similar to that in the previous comment.",4,"Assume for a city x, |S_4(x)| ≥ 2551. Let D = S_4(x) and A = S_1(x). A set A' ⊆ A is substantial if every city in D is at distance 3 from some city in A'. Let A* be a substantial set of minimal size m. Prove there exists a city a ∈ A* for which the set T = {c ∈ S_3(a) : d(x, c) ≤ 3} has size at most m-2.","By definition, D ⊆ ∪_{a'∈A*} S_3(a'). This implies |D| ≤ ∑_{a'∈A*}|S_3(a')∩D|. If for all a' ∈ A* we had |S_3(a') ∩ D| ≤ 101 - m, then |D| ≤ m(101 - m). The quadratic function f(m) = m(101 - m) has a maximum value of 50 × 51 = 2550. This would mean |D| ≤ 2550, contradicting our assumption. Therefore, there must be some a ∈ A* with |S_3(a) ∩ D| ≥ 102 - m. For this city a, we know |S_3(a)| ≤ 100. The set T is precisely S_3(a) \ D, because if c ∈ D, d(x,c)=4. Thus, |T| = |S_3(a)| - |S_3(a) ∩ D| ≤ 100 - (102 - m) = m - 2.","Let a be the city identified in the previous sub-problem. For each y ∈ A* \ {a}, show that due to the minimality of A*, there exists a shortest path x - y - b_y - c_y - d_y, where d_y ∈ D, and this d_y satisfies d(a, d_y) > 3.","By the minimality of A*, for any y ∈ A* \ {a}, there exists a city d_y ∈ D that is in S_3(y) but not in S_3(z) for any other z ∈ A* \ {y}. In particular, d_y ∉ S_3(a), so d(a, d_y) ≠ 3. The existence of d_y ∈ S_3(y) implies a path y - b_y - c_y - d_y of length 3. Since y ∈ S_1(x), this gives a path x - y - b_y - c_y - d_y of length 4. As d(x, d_y) = 4, this must be a shortest path, so d(x, b_y) = 2 and d(x, c_y) = 3. By the triangle inequality, d(a, d_y) ≥ d(x, d_y) - d(x, a) = 4 - 1 = 3. Since we know d(a, d_y) ≠ 3, it must be that d(a, d_y) > 3.","Using the path from the previous sub-problem, show that for each of the m-1 cities y ∈ A* \ {a}, there exists a city e_y ∈ {b_y, c_y} which is an element of the set T = {c ∈ S_3(a) : d(x, c) ≤ 3}.","Consider the sequence of cities y, b_y, c_y, d_y. The distance between any two consecutive cities in this sequence is 1. By the triangle inequality, their distances from city 'a' can differ by at most 1. We know d(a, y) ≤ d(a, x) + d(x, y) = 1 + 1 = 2. From the previous sub-problem, we know d(a, d_y) > 3. The sequence of distances d(a, y), d(a, b_y), d(a, c_y), d(a, d_y) starts with a value less than or equal to 2 and ends with a value greater than 3. Since the value can only change by at most 1 at each step, one of the intermediate distances must be exactly 3. So, either d(a, b_y) = 3 or d(a, c_y) = 3. Let this city be e_y. We also have d(x, b_y) = 2 and d(x, c_y) = 3, so in either case d(x, e_y) ≤ 3. Therefore, e_y ∈ T.",In some country several pairs of cities are connected by direct two-way flights. It is possible to go from any city to any other by a sequence of flights. The distance between two cities is defined to be the least possible number of flights required to go from one of them to the other. It is known that for any city there are at most 100 cities at distance exactly three from it. Prove that there is no city such that more than 2550 other cities have distance exactly four from it.,"Assume for contradiction that a city x exists with |S_4(x)| ≥ 2551. From sub-problem 1, there is a minimal substantial set A* of size m and a city a ∈ A* such that |T| ≤ m-2, where T = {c ∈ S_3(a) : d(x, c) ≤ 3}. From sub-problem 3, for each of the m-1 cities y ∈ A* \ {a}, we found a city e_y ∈ T. We now show these m-1 cities are distinct. The set of all intermediate cities {b_y, c_y | y ∈ A* \ {a}} are distinct. This is because d(x,b_y)=2 and d(x,c_z)=3, so b_y≠c_z. If b_y=b_z for y≠z, the path x-z-b_z-c_y-d_y would be a 4-flight path to d_y via z, contradicting the choice of d_y. A similar contradiction arises if c_y=c_z. Since {e_y | y ∈ A* \ {a}} is a subset of these distinct cities, the e_y are also distinct. This implies |T| ≥ m-1. We have derived |T| ≤ m-2 and |T| ≥ m-1, a contradiction. The initial assumption is false, so |S_4(x)| ≤ 2550 for any city x."
2013c7,"Let $n \geqslant 2$ be an integer. Consider all circular arrangements of the numbers $0,1, \ldots, n$; the $n+1$ rotations of an arrangement are considered to be equal. A circular arrangement is called beautiful if, for any four distinct numbers $0 \leqslant a, b, c, d \leqslant n$ with $a+c=b+d$, the chord joining numbers $a$ and $c$ does not intersect the chord joining numbers $b$ and $d$.

Let $M$ be the number of beautiful arrangements of $0,1, \ldots, n$. Let $N$ be the number of pairs $(x, y)$ of positive integers such that $x+y \leqslant n$ and $\operatorname{gcd}(x, y)=1$. Prove that


\begin{equation*}
M=N+1 \tag{Russia}
\end{equation*}","Given a circular arrangement of $[0, n]=\{0,1, \ldots, n\}$, we define a $k$-chord to be a (possibly degenerate) chord whose (possibly equal) endpoints add up to $k$. We say that three chords of a circle are aligned if one of them separates the other two. Say that $m \geqslant 3$ chords are aligned if any three of them are aligned. For instance, in Figure 1, $A, B$, and $C$ are aligned, while $B, C$, and $D$ are not.\\

Claim. In a beautiful arrangement, the $k$-chords are aligned for any integer $k$.\\
Proof. We proceed by induction. For $n \leqslant 3$ the statement is trivial. Now let $n \geqslant 4$, and proceed by contradiction. Consider a beautiful arrangement $S$ where the three $k$-chords $A, B, C$ are not aligned. If $n$ is not among the endpoints of $A, B$, and $C$, then by deleting $n$ from $S$ we obtain a beautiful arrangement $S \backslash\{n\}$ of $[0, n-1]$, where $A, B$, and $C$ are aligned by the induction hypothesis. Similarly, if 0 is not among these endpoints, then deleting 0 and decreasing all the numbers by 1 gives a beautiful arrangement $S \backslash\{0\}$ where $A, B$, and $C$ are aligned. Therefore both 0 and $n$ are among the endpoints of these segments. If $x$ and $y$ are their respective partners, we have $n \geqslant 0+x=k=n+y \geqslant n$. Thus 0 and $n$ are the endpoints of one of the chords; say it is $C$.

Let $D$ be the chord formed by the numbers $u$ and $v$ which are adjacent to 0 and $n$ and on the same side of $C$ as $A$ and $B$, as shown in Figure 2. Set $t=u+v$. If we had $t=n$, the $n$-chords $A$, $B$, and $D$ would not be aligned in the beautiful arrangement $S \backslash\{0, n\}$, contradicting the induction hypothesis. If $t<n$, then the $t$-chord from 0 to $t$ cannot intersect $D$, so the chord $C$ separates $t$ and $D$. The chord $E$ from $t$ to $n-t$ does not intersect $C$, so $t$ and $n-t$ are on the same side of $C$. But then the chords $A, B$, and $E$ are not aligned in $S \backslash\{0, n\}$, a contradiction. Finally, the case $t>n$ is equivalent to the case $t<n$ via the beauty-preserving relabelling $x \mapsto n-x$ for $0 \leqslant x \leqslant n$, which sends $t$-chords to $(2 n-t)$-chords. This proves the Claim.

Having established the Claim, we prove the desired result by induction. The case $n=2$ is trivial. Now assume that $n \geqslant 3$. Let $S$ be a beautiful arrangement of $[0, n]$ and delete $n$ to obtain\\
the beautiful arrangement $T$ of $[0, n-1]$. The $n$-chords of $T$ are aligned, and they contain every point except 0 . Say $T$ is of Type 1 if 0 lies between two of these $n$-chords, and it is of Type 2 otherwise; i.e., if 0 is aligned with these $n$-chords. We will show that each Type 1 arrangement of $[0, n-1]$ arises from a unique arrangement of $[0, n]$, and each Type 2 arrangement of $[0, n-1]$ arises from exactly two beautiful arrangements of $[0, n]$.

If $T$ is of Type 1 , let 0 lie between chords $A$ and $B$. Since the chord from 0 to $n$ must be aligned with $A$ and $B$ in $S, n$ must be on the other arc between $A$ and $B$. Therefore $S$ can be recovered uniquely from $T$. In the other direction, if $T$ is of Type 1 and we insert $n$ as above, then we claim the resulting arrangement $S$ is beautiful. For $0<k<n$, the $k$-chords of $S$ are also $k$-chords of $T$, so they are aligned. Finally, for $n<k<2 n$, notice that the $n$-chords of $S$ are parallel by construction, so there is an antisymmetry axis $\ell$ such that $x$ is symmetric to $n-x$ with respect to $\ell$ for all $x$. If we had two $k$-chords which intersect, then their reflections across $\ell$ would be two $(2 n-k)$-chords which intersect, where $0<2 n-k<n$, a contradiction.

If $T$ is of Type 2 , there are two possible positions for $n$ in $S$, on either side of 0 . As above, we check that both positions lead to beautiful arrangements of $[0, n]$.

Hence if we let $M_{n}$ be the number of beautiful arrangements of $[0, n]$, and let $L_{n}$ be the number of beautiful arrangements of $[0, n-1]$ of Type 2, we have

$$
M_{n}=\left(M_{n-1}-L_{n-1}\right)+2 L_{n-1}=M_{n-1}+L_{n-1} .
$$

It then remains to show that $L_{n-1}$ is the number of pairs $(x, y)$ of positive integers with $x+y=n$ and $\operatorname{gcd}(x, y)=1$. Since $n \geqslant 3$, this number equals $\varphi(n)=\#\{x: 1 \leqslant x \leqslant n, \operatorname{gcd}(x, n)=1\}$.

To prove this, consider a Type 2 beautiful arrangement of $[0, n-1]$. Label the positions $0, \ldots, n-1(\bmod n)$ clockwise around the circle, so that number 0 is in position 0 . Let $f(i)$ be the number in position $i$; note that $f$ is a permutation of $[0, n-1]$. Let $a$ be the position such that $f(a)=n-1$.

Since the $n$-chords are aligned with 0 , and every point is in an $n$-chord, these chords are all parallel and

$$
f(i)+f(-i)=n \quad \text { for all } i
$$

Similarly, since the $(n-1)$-chords are aligned and every point is in an $(n-1)$-chord, these chords are also parallel and

$$
f(i)+f(a-i)=n-1 \quad \text { for all } i .
$$

Therefore $f(a-i)=f(-i)-1$ for all $i$; and since $f(0)=0$, we get


\begin{equation*}
f(-a k)=k \quad \text { for all } k \tag{1}
\end{equation*}


Recall that this is an equality modulo $n$. Since $f$ is a permutation, we must have $(a, n)=1$. Hence $L_{n-1} \leqslant \varphi(n)$.

To prove equality, it remains to observe that the labeling (1) is beautiful. To see this, consider four numbers $w, x, y, z$ on the circle with $w+y=x+z$. Their positions around the circle satisfy $(-a w)+(-a y)=(-a x)+(-a z)$, which means that the chord from $w$ to $y$ and the chord from $x$ to $z$ are parallel. Thus (1) is beautiful, and by construction it has Type 2. The desired result follows.",4,"Define a $k$-chord as a chord whose endpoints sum to $k$. An arrangement is beautiful if for any four distinct numbers $a, b, c, d$ with $a+c=b+d=k$, the $k$-chords $(a,c)$ and $(b,d)$ do not intersect. Prove that in a beautiful arrangement, for any integer $k$, all $k$-chords are aligned (any three are aligned, where three chords are aligned if one separates the other two).","We prove this by induction on $n$. For $n \le 3$, the statement is trivial. Assume it holds for arrangements of size less than $n \ge 4$. Let $S$ be a beautiful arrangement of $\{0, \ldots, n\}$. Suppose for contradiction that three $k$-chords $A, B, C$ are not aligned. If $n$ is not an endpoint of $A, B, C$, then removing $n$ yields a beautiful arrangement of $\{0, \ldots, n-1\}$ where $A, B, C$ are not aligned, a contradiction to the inductive hypothesis. Similarly if 0 is not an endpoint. Thus, both 0 and $n$ must be endpoints of these chords. Since their partners $x, y$ must satisfy $0+x = k = n+y$, we must have $k=n$, and one chord must be $(0, n)$. Let this be $C$. An analysis of chords formed by neighbors of 0 and $n$ leads to a contradiction by applying the induction hypothesis to the arrangement $S \\setminus \\{0, n\\}$. Therefore, all $k$-chords must be aligned.","Let $M_n$ be the number of beautiful arrangements of $\{0, \ldots, n\}$. An arrangement of $\{0, \ldots, n-1\}$ is Type 1 if 0 lies between two $n$-chords (e.g., $(1,n-1)$ and $(2,n-2)$), and Type 2 if 0 is aligned with all $n$-chords. Let $L_{n-1}$ be the number of Type 2 arrangements of $\{0, \ldots, n-1\}$. Show that $M_n = M_{n-1} + L_{n-1}$ for $n \ge 3$.","Any beautiful arrangement of $\{0, \ldots, n-1\}$, let's call it $T$, can be extended to an arrangement of $\{0, \ldots, n\}$ by inserting $n$. For the resulting arrangement to be beautiful, the new $n$-chord $(0,n)$ must be aligned with the existing $n$-chords in $T$ (chords like $(1, n-1), (2, n-2)$, etc.). If $T$ is of Type 1, 0 is between two $n$-chords, so there is only one possible position for $n$ on the circle to maintain alignment. If $T$ is of Type 2, 0 is outside all $n$-chords, so there are two possible positions for $n$ (on either side of 0). It can be verified that these constructions always produce a beautiful arrangement. Thus, each of the $M_{n-1}-L_{n-1}$ Type 1 arrangements gives one beautiful arrangement of size $n$, and each of the $L_{n-1}$ Type 2 arrangements gives two. Therefore, $M_n = (M_{n-1}-L_{n-1}) \cdot 1 + L_{n-1} \cdot 2 = M_{n-1} + L_{n-1}$.","Let $L_{n-1}$ be the number of beautiful arrangements of $\{0, \ldots, n-1\}$ of Type 2, where 0 is aligned with all the $n$-chords. Prove that $L_{n-1} = \varphi(n)$, where $\varphi$ is Euler's totient function.","In a Type 2 arrangement of $\{0, \ldots, n-1\}$, the $n$-chords (connecting pairs summing to $n$) and the $(n-1)$-chords must all be aligned. Since every number is an endpoint of a chord in each set, alignment implies that each set of chords must be parallel. Let $p(k)$ be the position of number $k$ on the circle, with $p(0)=0$. Parallelism requires $p(k)+p(n-k) \equiv C_1 \pmod n$ and $p(k)+p(n-1-k) \equiv C_2 \pmod n$. These conditions force the positions to be an arithmetic progression, $p(k) = d \cdot k \pmod n$ for some constant $d$. For $p$ to be a permutation of the positions, $d$ must be coprime to $n$. Conversely, any such choice of $d$ gives a beautiful arrangement of Type 2. The number of choices for $d$ in $\{1, \ldots, n-1\}$ with $\operatorname{gcd}(d, n)=1$ is $\varphi(n)$. Thus, $L_{n-1} = \varphi(n)$.","Let $M$ be the number of beautiful arrangements of $0,1, \ldots, n$. Let $N$ be the number of pairs $(x, y)$ of positive integers such that $x+y \leqslant n$ and $\operatorname{gcd}(x, y)=1$. Prove that $M=N+1$.","From the previous steps, we have the recurrence $M_n = M_{n-1} + \varphi(n)$ for $n \ge 3$. For the base case $n=2$, the arrangements are $(0,1,2)$ and $(0,2,1)$. Both are vacuously beautiful, so $M_2=2$. Unrolling the recurrence gives $M_n = M_2 + \sum_{k=3}^n \varphi(k) = 2 + \sum_{k=3}^n \varphi(k)$. The number $N$ is the count of coprime pairs $(x,y)$ with sum $k=x+y$ for $k=2, \ldots, n$. The number of such pairs for a fixed sum $k$ is $\varphi(k)$. Therefore, $N = \sum_{k=2}^n \varphi(k)$. This means $N+1 = 1 + \sum_{k=2}^n \varphi(k) = 1 + \varphi(2) + \sum_{k=3}^n \varphi(k)$. Since $\varphi(2)=1$, we have $N+1 = 1 + 1 + \sum_{k=3}^n \varphi(k) = 2 + \sum_{k=3}^n \varphi(k)$. Comparing this with the expression for $M_n$, we conclude that $M_n = N+1$."
2013g1,"Let $A B C$ be an acute-angled triangle with orthocenter $H$, and let $W$ be a point on side $B C$. Denote by $M$ and $N$ the feet of the altitudes from $B$ and $C$, respectively. Denote by $\omega_{1}$ the circumcircle of $B W N$, and let $X$ be the point on $\omega_{1}$ which is diametrically opposite to $W$. Analogously, denote by $\omega_{2}$ the circumcircle of $C W M$, and let $Y$ be the point on $\omega_{2}$ which is diametrically opposite to $W$. Prove that $X, Y$ and $H$ are collinear.","Solution. Let $L$ be the foot of the altitude from $A$, and let $Z$ be the second intersection point of circles $\omega_{1}$ and $\omega_{2}$, other than $W$. We show that $X, Y, Z$ and $H$ lie on the same line.

Due to $\angle B N C=\angle B M C=90^{\circ}$, the points $B, C, N$ and $M$ are concyclic; denote their circle by $\omega_{3}$. Observe that the line $W Z$ is the radical axis of $\omega_{1}$ and $\omega_{2}$; similarly, $B N$ is the radical axis of $\omega_{1}$ and $\omega_{3}$, and $C M$ is the radical axis of $\omega_{2}$ and $\omega_{3}$. Hence $A=B N \cap C M$ is the radical center of the three circles, and therefore $W Z$ passes through $A$.

Since $W X$ and $W Y$ are diameters in $\omega_{1}$ and $\omega_{2}$, respectively, we have $\angle W Z X=\angle W Z Y=90^{\circ}$, so the points $X$ and $Y$ lie on the line through $Z$, perpendicular to $W Z$.\\
\includegraphics[max width=\textwidth, center]{2025_04_30_f697ddf0f0f1661c3074g-39}

The quadrilateral $B L H N$ is cyclic, because it has two opposite right angles. From the power of $A$ with respect to the circles $\omega_{1}$ and $B L H N$ we find $A L \cdot A H=A B \cdot A N=A W \cdot A Z$. If $H$ lies on the line $A W$ then this implies $H=Z$ immediately. Otherwise, by $\frac{A Z}{A H}=\frac{A L}{A W}$ the triangles $A H Z$ and $A W L$ are similar. Then $\angle H Z A=\angle W L A=90^{\circ}$, so the point $H$ also lies on the line $X Y Z$.

Comment. The original proposal also included a second statement:\\
Let $P$ be the point on $\omega_{1}$ such that $W P$ is parallel to $C N$, and let $Q$ be the point on $\omega_{2}$ such that $W Q$ is parallel to $B M$. Prove that $P, Q$ and $H$ are collinear if and only if $B W=C W$ or $A W \perp B C$.

The Problem Selection Committee considered the first part more suitable for the competition.",3,"Let $Z$ be the second intersection point of $\omega_1$ (the circumcircle of $B W N$) and $\omega_2$ (the circumcircle of $C W M$), other than $W$. Prove that $A, W, Z$ are collinear.","The points $B, C, N, M$ are concyclic on a circle, let's call it $\omega_3$, since $\angle BNC = \angle BMC = 90^\circ$. The line $WZ$ is the radical axis of $\omega_1$ and $\omega_2$. The radical axis of $\omega_1$ and $\omega_3$ is the line passing through their intersections $B$ and $N$, which is the line $AB$. The radical axis of $\omega_2$ and $\omega_3$ is the line passing through their intersections $C$ and $M$, which is the line $AC$. The three radical axes must be concurrent at the radical center. The intersection of lines $AB$ and $AC$ is point $A$. Therefore, the third radical axis, the line $WZ$, must also pass through $A$. This proves that $A, W, Z$ are collinear.","Let $Z$ be the second intersection point of $\omega_1$ and $\omega_2$. Prove that points $X, Y, Z$ are collinear on a line perpendicular to the line $AZ$.","Since $WX$ is a diameter of $\omega_1$, the angle subtended at any point on the circumference is a right angle. Thus, $\angle WZX = 90^\circ$. This means $XZ$ is perpendicular to the line $WZ$. Similarly, since $WY$ is a diameter of $\omega_2$, $\angle WZY = 90^\circ$, meaning $YZ$ is perpendicular to $WZ$. Since $A, W, Z$ are known to be collinear, both $X$ and $Y$ must lie on the unique line through $Z$ that is perpendicular to line $AZ$. Consequently, $X, Y, Z$ are collinear.","Let $A B C$ be an acute-angled triangle with orthocenter $H$, and let $W$ be a point on side $B C$. Denote by $M$ and $N$ the feet of the altitudes from $B$ and $C$, respectively. Denote by $\omega_{1}$ the circumcircle of $B W N$, and let $X$ be the point on $\omega_{1}$ which is diametrically opposite to $W$. Analogously, denote by $\omega_{2}$ the circumcircle of $C W M$, and let $Y$ be the point on $\omega_{2}$ which is diametrically opposite to $W$. Prove that $X, Y$ and $H$ are collinear.","From the prior sub-problems, $X$ and $Y$ lie on the line through $Z$ (the second intersection of $\omega_1$ and $\omega_2$) that is perpendicular to line $AZ$. To show $H$ is also on this line, we must prove $\angle AZH = 90^\circ$. Let $L$ be the foot of the altitude from $A$ to $BC$. The quadrilateral $BLHN$ is cyclic because $\angle BLH = \angle BNH = 90^\circ$. By the power of point $A$ with respect to the circumcircle of $BLHN$, we have $AL \cdot AH = AN \cdot AB$. Also, by the power of point $A$ with respect to circle $\omega_1$, we have $AW \cdot AZ = AN \cdot AB$. Therefore, $AL \cdot AH = AW \cdot AZ$, which rearranges to $\frac{AZ}{AH} = \frac{AL}{AW}$. Given the common angle $\angle ZAH = \angle LAW$, this implies that $\triangle AZH$ is similar to $\triangle ALW$. This similarity gives $\angle AZH = \angle ALW$. As $AL$ is an altitude, $\angle ALW = 90^\circ$. Thus, $\angle AZH = 90^\circ$, placing $H$ on the same line as $X$ and $Y$. Therefore, $X, Y, H$ are collinear.",,
2013g2,"Let $\omega$ be the circumcircle of a triangle $A B C$. Denote by $M$ and $N$ the midpoints of the sides $A B$ and $A C$, respectively, and denote by $T$ the midpoint of the $\operatorname{arc} B C$ of $\omega$ not containing $A$. The circumcircles of the triangles $A M T$ and $A N T$ intersect the perpendicular bisectors of $A C$ and $A B$ at points $X$ and $Y$, respectively; assume that $X$ and $Y$ lie inside the triangle $A B C$. The lines $M N$ and $X Y$ intersect at $K$. Prove that $K A=K T$.","Let $O$ be the center of $\omega$, thus $O=M Y \cap N X$. Let $\ell$ be the perpendicular bisector of $A T$ (it also passes through $O$ ). Denote by $r$ the operation of reflection about $\ell$. Since $A T$ is the angle bisector of $\angle B A C$, the line $r(A B)$ is parallel to $A C$. Since $O M \perp A B$ and $O N \perp A C$, this means that the line $r(O M)$ is parallel to the line $O N$ and passes through $O$, so $r(O M)=O N$. Finally, the circumcircle $\gamma$ of the triangle $A M T$ is symmetric about $\ell$, so $r(\gamma)=\gamma$. Thus the point $M$ maps to the common point of $O N$ with the arc $A M T$ of $\gamma$ - that is, $r(M)=X$.

Similarly, $r(N)=Y$. Thus, we get $r(M N)=X Y$, and the common point $K$ of $M N$ nd $X Y$ lies on $\ell$. This means exactly that $K A=K T$.\\",2,"Let $\ell$ be the perpendicular bisector of the segment $AT$, and let $r$ be the reflection about the line $\ell$. Prove that the reflection of point $M$ is $X$ (i.e., $r(M)=X$) and the reflection of point $N$ is $Y$ (i.e., $r(N)=Y$).","Let $O$ be the circumcenter of $\triangle ABC$. Since $OA=OT$ (radii of $\omega$), $O$ lies on $\ell$, the perpendicular bisector of $AT$. As $AT$ bisects $\angle BAC$, and the lines $OM$ and $ON$ are perpendicular to $AB$ and $AC$ respectively, the line $\ell$ (which is perpendicular to $AT$) acts as the angle bisector of $\angle MON$. Since $O \in \ell$, reflection $r$ about $\ell$ maps line $OM$ to line $ON$. The circumcircle of $\triangle AMT$ is symmetric about $\ell$ because its center lies on $\ell$ (as it's the perpendicular bisector of the chord $AT$). Therefore, $r$ maps point $M$ (on line $OM$ and this circle) to a point on line $ON$ and the same circle. By definition, this point is $X$. A symmetric argument proves $r(N)=Y$.","Let $\omega$ be the circumcircle of a triangle $A B C$. Denote by $M$ and $N$ the midpoints of the sides $A B$ and $A C$, respectively, and denote by $T$ the midpoint of the $\\operatorname{arc} B C$ of $\omega$ not containing $A$. The circumcircles of the triangles $A M T$ and $A N T$ intersect the perpendicular bisectors of $A C$ and $A B$ at points $X$ and $Y$, respectively; assume that $X$ and $Y$ lie inside the triangle $A B C$. The lines $M N$ and $X Y$ intersect at $K$. Prove that $K A=K T$.","Let $r$ be the reflection about the line $\ell$, the perpendicular bisector of segment $AT$. From the first sub-problem, we established that $r(M)=X$ and $r(N)=Y$. Consequently, the reflection of the line $MN$ is the line $XY$, i.e., $r(MN)=XY$. The intersection point $K$ of a line and its reflection must lie on the axis of reflection. Thus, $K$ lies on $\ell$. By the definition of a perpendicular bisector, any point on it is equidistant from the segment's endpoints. Therefore, $KA=KT$.",,,,
2013g3,"In a triangle $A B C$, let $D$ and $E$ be the feet of the angle bisectors of angles $A$ and $B$, respectively. A rhombus is inscribed into the quadrilateral $A E D B$ (all vertices of the rhombus lie on different sides of $A E D B$ ). Let $\varphi$ be the non-obtuse angle of the rhombus. Prove that $\varphi \leqslant \max \{\angle B A C, \angle A B C\}$.","Let $K, L, M$, and $N$ be the vertices of the rhombus lying on the sides $A E, E D, D B$, and $B A$, respectively. Denote by $d(X, Y Z)$ the distance from a point $X$ to a line $Y Z$. Since $D$ and $E$ are the feet of the bisectors, we have $d(D, A B)=d(D, A C), d(E, A B)=d(E, B C)$, and $d(D, B C)=d(E, A C)=0$, which implies

$$
d(D, A C)+d(D, B C)=d(D, A B) \quad \text { and } \quad d(E, A C)+d(E, B C)=d(E, A B)
$$

Since $L$ lies on the segment $D E$ and the relation $d(X, A C)+d(X, B C)=d(X, A B)$ is linear in $X$ inside the triangle, these two relations imply


\begin{equation*}
d(L, A C)+d(L, B C)=d(L, A B) . \tag{1}
\end{equation*}


Denote the angles as in the figure below, and denote $a=K L$. Then we have $d(L, A C)=a \sin \mu$ and $d(L, B C)=a \sin \nu$. Since $K L M N$ is a parallelogram lying on one side of $A B$, we get

$$
d(L, A B)=d(L, A B)+d(N, A B)=d(K, A B)+d(M, A B)=a(\sin \delta+\sin \varepsilon) .
$$

Thus the condition (1) reads


\begin{equation*}
\sin \mu+\sin \nu=\sin \delta+\sin \varepsilon \tag{2}
\end{equation*}


\begin{center}
\includegraphics[max width=\textwidth]{2025_04_30_f697ddf0f0f1661c3074g-42}
\end{center}

If one of the angles $\alpha$ and $\beta$ is non-acute, then the desired inequality is trivial. So we assume that $\alpha, \beta<\pi / 2$. It suffices to show then that $\psi=\angle N K L \leqslant \max \{\alpha, \beta\}$.

Assume, to the contrary, that $\psi>\max \{\alpha, \beta\}$. Since $\mu+\psi=\angle C K N=\alpha+\delta$, by our assumption we obtain $\mu=(\alpha-\psi)+\delta<\delta$. Similarly, $\nu<\varepsilon$. Next, since $K N \| M L$, we have $\beta=\delta+\nu$, so $\delta<\beta<\pi / 2$. Similarly, $\varepsilon<\pi / 2$. Finally, by $\mu<\delta<\pi / 2$ and $\nu<\varepsilon<\pi / 2$, we obtain

$$
\sin \mu<\sin \delta \quad \text { and } \quad \sin \nu<\sin \varepsilon
$$

This contradicts (2).\\
Comment. One can see that the equality is achieved if $\alpha=\beta$ for every rhombus inscribed into the quadrilateral $A E D B$.",3,"In $\triangle ABC$, let $D$ and $E$ be the feet of the angle bisectors from vertices $A$ and $B$, respectively. For any point $L$ on the line segment $DE$, prove that $d(L, AC) + d(L, BC) = d(L, AB)$, where $d(X, YZ)$ denotes the distance from point $X$ to line $YZ$.","The angle bisector property implies $d(D, AC) = d(D, AB)$ and $d(E, BC) = d(E, AB)$. Since $D$ is on side $BC$ and $E$ is on side $AC$, we have $d(D, BC) = 0$ and $d(E, AC) = 0$. Thus, $d(D, AC) + d(D, BC) = d(D, AB)$ and $d(E, AC) + d(E, BC) = d(E, AB)$. The function $f(X) = d(X, AB) - d(X, AC) - d(X, BC)$ is a linear function of the coordinates of $X$. Since $f(D) = 0$ and $f(E) = 0$, it must be that $f(L) = 0$ for any point $L$ on the segment $DE$. Therefore, $d(L, AC) + d(L, BC) = d(L, AB)$.","A rhombus $KLMN$ is inscribed in the quadrilateral $AEDB$ with vertices $K, L, M, N$ on sides $AE, ED, DB, BA$ respectively. Let $a$ be the side-length of the rhombus. Let $\mu$ be the angle between $LK$ and $AC$, $\nu$ the angle between $LM$ and $BC$, and $\delta, \varepsilon$ other relevant angles of the configuration. Show that these angles satisfy the relation $\sin \mu + \sin \nu = \sin \delta + \sin \varepsilon$.","From the first sub-problem, $d(L, AC) + d(L, BC) = d(L, AB)$. The distances can be expressed using the rhombus side length $a$ and the defined angles. We have $d(L, AC) = a \sin \mu$ and $d(L, BC) = a \sin \nu$. Since vertex $N$ of the parallelogram $KLMN$ lies on side $AB$, the distance $d(L, AB)$ is the sum of the distances from $K$ and $M$ to $AB$. The geometric setup implies $d(L, AB) = d(K,AB)+d(M,AB) = a(\sin \delta + \sin \varepsilon)$. Substituting these expressions into the distance relation from the first sub-problem and dividing by $a$ gives $\sin \mu + \sin \nu = \sin \delta + \sin \varepsilon$.","In a triangle $A B C$, let $D$ and $E$ be the feet of the angle bisectors of angles $A$ and $B$, respectively. A rhombus is inscribed into the quadrilateral $A E D B$. Let $\varphi$ be the non-obtuse angle of the rhombus. Prove that $\varphi \leqslant \max \{\angle B A C, \angle A B C\}$.","Let $\alpha = \angle BAC$, $\beta = \angle ABC$. We can assume $\alpha, \beta < \pi / 2$, otherwise the inequality is trivial. Assume for contradiction that $\varphi > \max\{\alpha, \beta\}$. The angles of the configuration satisfy certain geometric relations, including $\mu+\varphi = \alpha+\delta$. From $\varphi > \alpha$, it follows that $\mu = (\alpha - \varphi) + \delta < \delta$. Similarly, we can show $\nu < \varepsilon$. Since the angles are acute, we have $\sin\mu < \sin\delta$ and $\sin\nu < \sin\varepsilon$. Summing these inequalities yields $\sin\mu + \sin\nu < \sin\delta + \sin\varepsilon$. This contradicts the identity from the second sub-problem. Thus, our initial assumption is false, and we conclude that $\varphi \leqslant \max\{\alpha, \beta\}$.",,
2013g4,Let $A B C$ be a triangle with $\angle B>\angle C$. Let $P$ and $Q$ be two different points on line $A C$ such that $\angle P B A=\angle Q B A=\angle A C B$ and $A$ is located between $P$ and $C$. Suppose that there exists an interior point $D$ of segment $B Q$ for which $P D=P B$. Let the ray $A D$ intersect the circle $A B C$ at $R \neq A$. Prove that $Q B=Q R$.,"Denote by $\omega$ the circumcircle of the triangle $A B C$, and let $\angle A C B=\gamma$. Note that the condition $\gamma<\angle C B A$ implies $\gamma<90^{\circ}$. Since $\angle P B A=\gamma$, the line $P B$ is tangent to $\omega$, so $P A \cdot P C=P B^{2}=P D^{2}$. By $\frac{P A}{P D}=\frac{P D}{P C}$ the triangles $P A D$ and $P D C$ are similar, and $\angle A D P=\angle D C P$.

Next, since $\angle A B Q=\angle A C B$, the triangles $A B C$ and $A Q B$ are also similar. Then $\angle A Q B=$ $\angle A B C=\angle A R C$, which means that the points $D, R, C$, and $Q$ are concyclic. Therefore $\angle D R Q=$ $\angle D C Q=\angle A D P$.\\

Now from $\angle A R B=\angle A C B=\gamma$ and $\angle P D B=\angle P B D=2 \gamma$ we get

$$
\angle Q B R=\angle A D B-\angle A R B=\angle A D P+\angle P D B-\angle A R B=\angle D R Q+\gamma=\angle Q R B,
$$

so the triangle $Q R B$ is isosceles, which yields $Q B=Q R$.\\",2,"Let $\gamma = \angle ACB$. Show that the points D, R, C, Q are concyclic and that this implies $\angle ADP = \angle DRQ$.","Let $\gamma = \angle ACB$. Since $\angle P B A=\gamma$, the line $P B$ is tangent to the circumcircle of $\triangle A B C$. By the power of a point theorem, $P B^{2}=P A \cdot P C$. As we are given $P D=P B$, we have $P D^{2}=P A \cdot P C$. This implies $\frac{P A}{P D}=\frac{P D}{P C}$, so triangles $\triangle P A D$ and $\triangle P D C$ are similar. From this similarity, we have $\angle A D P=\angle D C P = \angle DCQ$. Next, since $\angle A B Q=\gamma$, triangles $\triangle A B C$ and $\triangle A Q B$ are similar, which implies $\angle A Q B=\angle A B C$. As $R$ is on the circumcircle of $\triangle ABC$, $\angle A R C=\angle A B C$. Therefore, $\angle A Q B = \angle A R C$, which implies that the points $D, R, C, Q$ are concyclic. From this concyclicity, it follows that $\angle D R Q=\angle D C Q$. Combining our findings, we get $\angle ADP = \angle DRQ$.",Let the ray $A D$ intersect the circle $A B C$ at $R \neq A$. Prove that $Q B=Q R$.,"Let $\gamma = \angle ACB$. Using the result from the previous step, $\angle ADP = \angle DRQ$, we aim to prove that $\triangle QBR$ is isosceles by showing $\angle QBR = \angle QRB$. Since $R$ is on the circumcircle of $\triangle ABC$, $\angle ARB = \angle ACB = \gamma$. As $PD=PB$, $\triangle PDB$ is isosceles, so $\angle PDB = \angle PBD = \angle PBA + \angle ABQ = \gamma + \gamma = 2\gamma$. Using the exterior angle theorem on $\triangle BDR$, $\angle QBR = \angle ADB - \angle ARB = (\angle ADP + \angle PDB) - \angle ARB = \angle ADP + 2\gamma - \gamma = \angle ADP + \gamma$. For the other angle, $\angle QRB = \angle QRD + \angle DRB = \angle DRQ + \angle ARB = \angle DRQ + \gamma$. Since $\angle ADP = \angle DRQ$, it follows that $\angle QBR = \angle QRB$. Thus, triangle $QBR$ is isosceles with $QB=QR$.",,,,
2013g5,"Let $A B C D E F$ be a convex hexagon with $A B=D E, B C=E F, C D=F A$, and $\angle A-\angle D=\angle C-\angle F=\angle E-\angle B$. Prove that the diagonals $A D, B E$, and $C F$ are concurrent.","We denote $\theta=\angle A-\angle D=\angle C-\angle F=\angle E-\angle B$ and assume without loss of generality that $\theta \geqslant 0$.

Let $x=A B=D E, y=C D=F A, z=E F=B C$. Consider the points $P, Q$, and $R$ such that the quadrilaterals $C D E P, E F A Q$, and $A B C R$ are parallelograms. We compute

$$
\begin{aligned}
\angle P E Q & =\angle F E Q+\angle D E P-\angle E=\left(180^{\circ}-\angle F\right)+\left(180^{\circ}-\angle D\right)-\angle E \\
& =360^{\circ}-\angle D-\angle E-\angle F=\frac{1}{2}(\angle A+\angle B+\angle C-\angle D-\angle E-\angle F)=\theta / 2 .
\end{aligned}
$$

Similarly, $\angle Q A R=\angle R C P=\theta / 2$.\\
\includegraphics[max width=\textwidth, center]{2025_04_30_f697ddf0f0f1661c3074g-46}

If $\theta=0$, since $\triangle R C P$ is isosceles, $R=P$. Therefore $A B\|R C=P C\| E D$, so $A B D E$ is a parallelogram. Similarly, $B C E F$ and $C D F A$ are parallelograms. It follows that $A D, B E$ and $C F$ meet at their common midpoint.

Now assume $\theta>0$. Since $\triangle P E Q, \triangle Q A R$, and $\triangle R C P$ are isosceles and have the same angle at the apex, we have $\triangle P E Q \sim \triangle Q A R \sim \triangle R C P$ with ratios of similarity $y: z: x$. Thus


\begin{equation*}
\triangle P Q R \text { is similar to the triangle with sidelengths } y, z, \text { and } x \text {. } \tag{1}
\end{equation*}


Next, notice that

$$
\frac{R Q}{Q P}=\frac{z}{y}=\frac{R A}{A F}
$$

and, using directed angles between rays,

$$
\begin{aligned}
\Varangle(R Q, Q P) & =\Varangle(R Q, Q E)+\not(Q E, Q P) \\
& =\Varangle(R Q, Q E)+\Varangle(R A, R Q)=\Varangle(R A, Q E)=\not(R A, A F) .
\end{aligned}
$$

Thus $\triangle P Q R \sim \triangle F A R$. Since $F A=y$ and $A R=z$, (1) then implies that $F R=x$. Similarly $F P=x$. Therefore $C R F P$ is a rhombus.

We conclude that $C F$ is the perpendicular bisector of $P R$. Similarly, $B E$ is the perpendicular bisector of $P Q$ and $A D$ is the perpendicular bisector of $Q R$. It follows that $A D, B E$, and $C F$ are concurrent at the circumcenter of $P Q R$.",3,"Let $A B C D E F$ be a convex hexagon with $A B=D E=x, B C=E F=z, C D=F A=y$, and $\angle A-\angle D=\angle C-\angle F=\angle E-\angle B = \theta$. Define points $P, Q, R$ such that $C D E P, E F A Q, A B C R$ are parallelograms. Prove that $\triangle PEQ, \triangle QAR, \triangle RCP$ are isosceles triangles with equal apex angles $\theta/2$. Also, show that if $\theta=0$, the main diagonals are concurrent.","From the parallelogram definitions, we have side lengths $PE=CD=y, QE=FA=y$, so $\triangle PEQ$ is isosceles. Similarly, $QA=EF=z, RA=BC=z$, so $\triangle QAR$ is isosceles, and $RC=AB=x, PC=DE=x$, so $\triangle RCP$ is isosceles. The apex angle of $\triangle PEQ$ is $\angle PEQ = (180^\circ - \angle D) + (180^\circ - \angle F) - \angle E = 360^\circ - \angle D - \angle E - \angle F$. Using the hexagon's angle sum and the given conditions, this simplifies to $\frac{1}{2}(\angle A+\angle B+\angle C-\angle D-\angle E-\angle F) = \frac{1}{2}((\angle A-\angle D) + (\angle C-\angle F) - (\angle E-\angle B)) = \frac{1}{2}(\theta+\theta-\theta)=\theta/2$. By symmetry, $\angle QAR=\angle RCP=\theta/2$. If $\theta=0$, the apex angles are 0, which implies $P=Q=R$. The condition $R=P$ implies $\vec{A}-\vec{B}=\vec{E}-\vec{D}$, so $ABDE$ is a parallelogram. Similarly, $BCEF$ and $CDFA$ are parallelograms. The diagonals of these parallelograms must share a common midpoint, so $AD, BE, CF$ are concurrent.","Assuming $\theta > 0$ and using the setup from the previous sub-problem, prove that the quadrilateral $CRFP$ is a rhombus. As a consequence, show that the diagonal $CF$ is the perpendicular bisector of the segment $PR$.","From sub-problem 1, $\triangle PEQ, \triangle QAR, \triangle RCP$ are similar isosceles triangles. This implies their bases $PQ, QR, RP$ are in the same ratio as the equal sides, so $\triangle PQR$ is similar to a triangle with side lengths $y, z, x$. We can show that $\triangle RQP \sim \triangle RAF$ by checking the ratio of corresponding sides and the included angle. Since $\triangle RAF$ has sides $FA=y$ and $AR=z$, its third side $FR$ must be $x$ for the similarity to hold. By a similar argument, one can show $FP=x$. From the parallelogram constructions, we know $CR=AB=x$ and $PC=DE=x$. Since all four sides of quadrilateral $CRFP$ are equal to $x$, it is a rhombus. The diagonals of a rhombus are perpendicular bisectors of each other, so $CF$ is the perpendicular bisector of $PR$.","Let $A B C D E F$ be a convex hexagon with $A B=D E, B C=E F, C D=F A$, and $\angle A-\angle D=\angle C-\angle F=\angle E-\angle B$. Prove that the diagonals $A D, B E$, and $C F$ are concurrent.","The case where the angle difference $\theta=0$ is handled in the first sub-problem. If $\theta > 0$, we use the auxiliary points $P, Q, R$. From the previous sub-problem, we proved that the diagonal $CF$ is the perpendicular bisector of the side $PR$ of $\triangle PQR$. By the cyclic symmetry of the problem's conditions (advancing the letters by two, e.g., $A\to C$, $B\to D$, etc.), the same logic shows that diagonal $BE$ is the perpendicular bisector of side $PQ$, and diagonal $AD$ is the perpendicular bisector of side $QR$. The three perpendicular bisectors of the sides of $\triangle PQR$ are concurrent at its circumcenter. Therefore, the diagonals $AD, BE,$ and $CF$ are concurrent.",,
2013g6,Let the excircle of the triangle $A B C$ lying opposite to $A$ touch its side $B C$ at the point $A_{1}$. Define the points $B_{1}$ and $C_{1}$ analogously. Suppose that the circumcentre of the triangle $A_{1} B_{1} C_{1}$ lies on the circumcircle of the triangle $A B C$. Prove that the triangle $A B C$ is right-angled.,"Denote the circumcircles of the triangles $A B C$ and $A_{1} B_{1} C_{1}$ by $\Omega$ and $\Gamma$, respectively. Denote the midpoint of the arc $C B$ of $\Omega$ containing $A$ by $A_{0}$, and define $B_{0}$ as well as $C_{0}$ analogously. By our hypothesis the centre $Q$ of $\Gamma$ lies on $\Omega$.\\
Lemma. One has $A_{0} B_{1}=A_{0} C_{1}$. Moreover, the points $A, A_{0}, B_{1}$, and $C_{1}$ are concyclic. Finally, the points $A$ and $A_{0}$ lie on the same side of $B_{1} C_{1}$. Similar statements hold for $B$ and $C$.\\
Proof. Let us consider the case $A=A_{0}$ first. Then the triangle $A B C$ is isosceles at $A$, which implies $A B_{1}=A C_{1}$ while the remaining assertions of the Lemma are obvious. So let us suppose $A \neq A_{0}$ from now on.

By the definition of $A_{0}$, we have $A_{0} B=A_{0} C$. It is also well known and easy to show that $B C_{1}=$ $C B_{1}$. Next, we have $\angle C_{1} B A_{0}=\angle A B A_{0}=\angle A C A_{0}=\angle B_{1} C A_{0}$. Hence the triangles $A_{0} B C_{1}$ and $A_{0} C B_{1}$ are congruent. This implies $A_{0} C_{1}=A_{0} B_{1}$, establishing the first part of the Lemma. It also follows that $\angle A_{0} C_{1} A=\angle A_{0} B_{1} A$, as these are exterior angles at the corresponding vertices $C_{1}$ and $B_{1}$ of the congruent triangles $A_{0} B C_{1}$ and $A_{0} C B_{1}$. For that reason the points $A, A_{0}, B_{1}$, and $C_{1}$ are indeed the vertices of some cyclic quadrilateral two opposite sides of which are $A A_{0}$ and $B_{1} C_{1}$.

Now we turn to the solution. Evidently the points $A_{1}, B_{1}$, and $C_{1}$ lie interior to some semicircle arc of $\Gamma$, so the triangle $A_{1} B_{1} C_{1}$ is obtuse-angled. Without loss of generality, we will assume that its angle at $B_{1}$ is obtuse. Thus $Q$ and $B_{1}$ lie on different sides of $A_{1} C_{1}$; obviously, the same holds for the points $B$ and $B_{1}$. So, the points $Q$ and $B$ are on the same side of $A_{1} C_{1}$.

Notice that the perpendicular bisector of $A_{1} C_{1}$ intersects $\Omega$ at two points lying on different sides of $A_{1} C_{1}$. By the first statement from the Lemma, both points $B_{0}$ and $Q$ are among these points of intersection; since they share the same side of $A_{1} C_{1}$, they coincide (see Figure 1).\\

Now, by the first part of the Lemma again, the lines $Q A_{0}$ and $Q C_{0}$ are the perpendicular bisectors of $B_{1} C_{1}$ and $A_{1} B_{1}$, respectively. Thus

$$
\angle C_{1} B_{0} A_{1}=\angle C_{1} B_{0} B_{1}+\angle B_{1} B_{0} A_{1}=2 \angle A_{0} B_{0} B_{1}+2 \angle B_{1} B_{0} C_{0}=2 \angle A_{0} B_{0} C_{0}=180^{\circ}-\angle A B C,
$$

recalling that $A_{0}$ and $C_{0}$ are the midpoints of the arcs $C B$ and $B A$, respectively.\\
On the other hand, by the second part of the Lemma we have

$$
\angle C_{1} B_{0} A_{1}=\angle C_{1} B A_{1}=\angle A B C .
$$

From the last two equalities, we get $\angle A B C=90^{\circ}$, whereby the problem is solved.\\",4,"Let A0 be the midpoint of the arc BC of the circumcircle of triangle ABC that contains A. Let B1 and C1 be the points where the excircles opposite B and C touch sides AC and AB, respectively. Prove that A0B1 = A0C1 and that the points A, A0, B1, C1 are concyclic.","By definition of A0, we have A0B = A0C. A standard property of excenter tangency points gives BC1 = CB1 (= s-a, where s is the semi-perimeter). Also, ∠C1BA0 = ∠ABA0 = ∠ACA0 = ∠B1CA0. Therefore, the triangles A0BC1 and A0CB1 are congruent by SAS. This congruence implies A0C1 = A0B1. It also implies that the exterior angles at C1 and B1 with respect to vertex A are equal, which proves that A, A0, B1, and C1 lie on a circle.","Let Ω be the circumcircle of ABC, Γ be the circumcircle of A1B1C1, and Q be the center of Γ. If Q lies on Ω, show that Q must coincide with one of A0, B0, or C0, where A0, B0, C0 are the midpoints of the arcs BC, CA, AB of Ω containing the opposite vertices.","The triangle A1B1C1 is obtuse, as its vertices lie on the sides of triangle ABC. Assume its angle at B1 is obtuse. This places Q and B on the same side of the line A1C1. Q, being the circumcenter of A1B1C1, lies on the perpendicular bisector of A1C1. By the analog of the result in the first sub-problem, B0A1 = B0C1, so B0 also lies on the perpendicular bisector of A1C1. Both Q and B0 lie on Ω and on the perpendicular bisector of A1C1. As they lie on the same side of A1C1, they must coincide. Thus Q=B0. A similar argument applies if the obtuse angle is at A1 or C1.","Assuming the circumcenter Q of A1B1C1 coincides with B0, find two distinct expressions for the angle ∠C1B0A1 in terms of the angles of triangle ABC.","First, since B0 is the circumcenter of A1B1C1 (Q=B0), the lines B0A0 and B0C0 are the perpendicular bisectors of C1B1 and A1B1 respectively. This geometric configuration implies ∠C1B0A1 = 2∠A0B0C0. The angle ∠A0B0C0 subtends the arc A0C0 on the circumcircle of ABC, the measure of which is 180° - ∠ABC. Thus, ∠C1B0A1 = 180° - ∠ABC. Second, by the analog of the concyclicity result from the first sub-problem, the points B, B0, A1, C1 are concyclic. This implies ∠C1B0A1 = ∠C1BA1, which is simply ∠ABC.",Let the excircle of the triangle $A B C$ lying opposite to $A$ touch its side $B C$ at the point $A_{1}$. Define the points $B_{1}$ and $C_{1}$ analogously. Suppose that the circumcentre of the triangle $A_{1} B_{1} C_{1}$ lies on the circumcircle of the triangle $A B C$. Prove that the triangle $A B C$ is right-angled.,"Let Q be the circumcenter of A1B1C1. We are given that Q lies on the circumcircle of ABC. As established in the second sub-problem, this implies Q must coincide with one of A0, B0, or C0. Without loss of generality, assume Q = B0. From the third sub-problem, we derived two expressions for ∠C1B0A1: ∠C1B0A1 = 180° - ∠ABC and ∠C1B0A1 = ∠ABC. Equating these gives 180° - ∠ABC = ∠ABC, which simplifies to 2∠ABC = 180°, or ∠ABC = 90°. Therefore, the triangle ABC is right-angled."
2013n2,"Prove that for any pair of positive integers $k$ and $n$ there exist $k$ positive integers $m_{1}, m_{2}, \ldots, m_{k}$ such that

$$
1+\frac{2^{k}-1}{n}=\left(1+\frac{1}{m_{1}}\right)\left(1+\frac{1}{m_{2}}\right) \cdots\left(1+\frac{1}{m_{k}}\right) .
$$","We proceed by induction on $k$. For $k=1$ the statement is trivial. Assuming we have proved it for $k=j-1$, we now prove it for $k=j$.

Case 1. $n=2 t-1$ for some positive integer $t$.\\
Observe that

$$
1+\frac{2^{j}-1}{2 t-1}=\frac{2\left(t+2^{j-1}-1\right)}{2 t} \cdot \frac{2 t}{2 t-1}=\left(1+\frac{2^{j-1}-1}{t}\right)\left(1+\frac{1}{2 t-1}\right)
$$

By the induction hypothesis we can find $m_{1}, \ldots, m_{j-1}$ such that

$$
1+\frac{2^{j-1}-1}{t}=\left(1+\frac{1}{m_{1}}\right)\left(1+\frac{1}{m_{2}}\right) \cdots\left(1+\frac{1}{m_{j-1}}\right)
$$

so setting $m_{j}=2 t-1$ gives the desired expression.\\
Case 2. $n=2 t$ for some positive integer $t$.\\
Now we have

$$
1+\frac{2^{j}-1}{2 t}=\frac{2 t+2^{j}-1}{2 t+2^{j}-2} \cdot \frac{2 t+2^{j}-2}{2 t}=\left(1+\frac{1}{2 t+2^{j}-2}\right)\left(1+\frac{2^{j-1}-1}{t}\right)
$$

noting that $2 t+2^{j}-2>0$. Again, we use that

$$
1+\frac{2^{j-1}-1}{t}=\left(1+\frac{1}{m_{1}}\right)\left(1+\frac{1}{m_{2}}\right) \cdots\left(1+\frac{1}{m_{j-1}}\right)
$$

Setting $m_{j}=2 t+2^{j}-2$ then gives the desired expression.\\",2,"Prove that for any integers $k \ge 2$ and $n \ge 1$, there exist positive integers $m$ and $t$ such that $1+\frac{2^k-1}{n} = \left(1+\frac{1}{m}\right)\left(1+\frac{2^{k-1}-1}{t}\right)$.","We consider two cases based on the parity of $n$. 
Case 1 ($n$ is odd): Let $n=2t-1$ for some integer $t \ge 1$. Then $1+\frac{2^k-1}{2t-1} = \frac{2t-1+2^k-1}{2t-1} = \frac{2(t+2^{k-1}-1)}{2t-1} = \frac{t+2^{k-1}-1}{t} \cdot \frac{2t}{2t-1} = \left(1+\frac{2^{k-1}-1}{t}\right)\left(1+\frac{1}{2t-1}\right)$. We choose $m=2t-1=n$. 
Case 2 ($n$ is even): Let $n=2t$ for some integer $t \ge 1$. Then $1+\frac{2^k-1}{2t} = \frac{2t+2^k-1}{2t} = \frac{2t+2^k-1}{2t+2^k-2} \cdot \frac{2t+2^k-2}{2t} = \left(1+\frac{1}{2t+2^k-2}\right)\left(1+\frac{2^{k-1}-1}{t}\right)$. We choose $m=2t+2^k-2$. 
In both cases, since $n, k$ are positive integers ($k \ge 2$), $m$ and $t$ are positive integers.","Prove that for any pair of positive integers $k$ and $n$ there exist $k$ positive integers $m_{1}, m_{2}, \ldots, m_{k}$ such that

$$
1+\frac{2^{k}-1}{n}=\left(1+\frac{1}{m_{1}}\right)\left(1+\frac{1}{m_{2}}\right) \cdots\left(1+\frac{1}{m_{k}}\right) .
$$","We proceed by induction on $k$. 
Base Case ($k=1$): The equation is $1+\frac{1}{n} = 1+\frac{1}{m_1}$. We can choose $m_1=n$, which is a positive integer. 
Inductive Step: Assume the statement holds for $k-1$ for some $k \ge 2$. We need to prove it for $k$. From the previous sub-problem, we know there exist positive integers $m_k$ and $t$ such that $1+\frac{2^k-1}{n} = \left(1+\frac{1}{m_k}\right)\left(1+\frac{2^{k-1}-1}{t}\right)$. By the induction hypothesis, there exist $k-1$ positive integers $m_1, \ldots, m_{k-1}$ such that $1+\frac{2^{k-1}-1}{t} = \left(1+\frac{1}{m_1}\right) \cdots \left(1+\frac{1}{m_{k-1}}\right)$. Combining these two equations gives the desired result for $k$. By the principle of induction, the statement is true for all $k, n \ge 1$.",,,,
2013n3,Prove that there exist infinitely many positive integers $n$ such that the largest prime divisor of $n^{4}+n^{2}+1$ is equal to the largest prime divisor of $(n+1)^{4}+(n+1)^{2}+1$.,"Solution. Let $p_{n}$ be the largest prime divisor of $n^{4}+n^{2}+1$ and let $q_{n}$ be the largest prime divisor of $n^{2}+n+1$. Then $p_{n}=q_{n^{2}}$, and from

$$
n^{4}+n^{2}+1=\left(n^{2}+1\right)^{2}-n^{2}=\left(n^{2}-n+1\right)\left(n^{2}+n+1\right)=\left((n-1)^{2}+(n-1)+1\right)\left(n^{2}+n+1\right)
$$

it follows that $p_{n}=\max \left\{q_{n}, q_{n-1}\right\}$ for $n \geqslant 2$. Keeping in mind that $n^{2}-n+1$ is odd, we have

$$
\operatorname{gcd}\left(n^{2}+n+1, n^{2}-n+1\right)=\operatorname{gcd}\left(2 n, n^{2}-n+1\right)=\operatorname{gcd}\left(n, n^{2}-n+1\right)=1
$$

Therefore $q_{n} \neq q_{n-1}$.\\
To prove the result, it suffices to show that the set

$$
S=\left\{n \in \mathbb{Z}_{\geqslant 2} \mid q_{n}>q_{n-1} \text { and } q_{n}>q_{n+1}\right\}
$$

is infinite, since for each $n \in S$ one has

$$
p_{n}=\max \left\{q_{n}, q_{n-1}\right\}=q_{n}=\max \left\{q_{n}, q_{n+1}\right\}=p_{n+1} .
$$

Suppose on the contrary that $S$ is finite. Since $q_{2}=7<13=q_{3}$ and $q_{3}=13>7=q_{4}$, the set $S$ is non-empty. Since it is finite, we can consider its largest element, say $m$.

Note that it is impossible that $q_{m}>q_{m+1}>q_{m+2}>\ldots$ because all these numbers are positive integers, so there exists a $k \geqslant m$ such that $q_{k}<q_{k+1}$ (recall that $q_{k} \neq q_{k+1}$ ). Next observe that it is impossible to have $q_{k}<q_{k+1}<q_{k+2}<\ldots$, because $q_{(k+1)^{2}}=p_{k+1}=\max \left\{q_{k}, q_{k+1}\right\}=q_{k+1}$, so let us take the smallest $\ell \geqslant k+1$ such that $q_{\ell}>q_{\ell+1}$. By the minimality of $\ell$ we have $q_{\ell-1}<q_{\ell}$, so $\ell \in S$. Since $\ell \geqslant k+1>k \geqslant m$, this contradicts the maximality of $m$, and hence $S$ is indeed infinite.

Comment. Once the factorization of $n^{4}+n^{2}+1$ is found and the set $S$ is introduced, the problem is mainly about ruling out the case that


\begin{equation*}
q_{k}<q_{k+1}<q_{k+2}<\ldots \tag{1}
\end{equation*}


might hold for some $k \in \mathbb{Z}_{>0}$. In the above solution, this is done by observing $q_{(k+1)^{2}}=\max \left(q_{k}, q_{k+1}\right)$. Alternatively one may notice that (1) implies that $q_{j+2}-q_{j} \geqslant 6$ for $j \geqslant k+1$, since every prime greater than 3 is congruent to -1 or 1 modulo 6 . Then there is some integer $C \geqslant 0$ such that $q_{n} \geqslant 3 n-C$ for all $n \geqslant k$.

Now let the integer $t$ be sufficiently large (e.g. $t=\max \{k+1, C+3\}$ ) and set $p=q_{t-1} \geqslant 2 t$. Then $p \mid(t-1)^{2}+(t-1)+1$ implies that $p \mid(p-t)^{2}+(p-t)+1$, so $p$ and $q_{p-t}$ are prime divisors of $(p-t)^{2}+(p-t)+1$. But $p-t>t-1 \geqslant k$, so $q_{p-t}>q_{t-1}=p$ and $p \cdot q_{p-t}>p^{2}>(p-t)^{2}+(p-t)+1$, a contradiction.",3,"Let $p_n$ be the largest prime divisor of $n^4+n^2+1$ and $q_n$ be the largest prime divisor of $n^2+n+1$. Prove that for $n \\ge 2$, $p_n = \\max\\{q_{n-1}, q_n\\}$.","We factor the polynomial $n^4+n^2+1 = (n^2+1)^2 - n^2 = (n^2-n+1)(n^2+n+1)$. The second factor, $n^2+n+1$, has $q_n$ as its largest prime divisor by definition. The first factor, $n^2-n+1$, can be rewritten as $(n-1)^2+(n-1)+1$, so its largest prime divisor is $q_{n-1}$. The set of prime divisors of $n^4+n^2+1$ is the union of the sets of prime divisors of its two factors. We note that $\\gcd(n^2+n+1, n^2-n+1) = \\gcd(2n, n^2-n+1) = 1$. Therefore, the largest prime divisor of $n^4+n^2+1$, which is $p_n$, must be the maximum of the largest prime divisors of the two factors. Thus, $p_n = \\max\\{q_{n-1}, q_n\\}$.","Let $p_n$ and $q_n$ be defined as in the first sub-problem. Show that if the set $S = \\{n \\in \\mathbb{Z}_{\\ge 2} \\mid q_n > q_{n-1} \text{ and } q_n > q_{n+1}\\}$ is infinite, then there are infinitely many $n$ for which the largest prime divisor of $n^4+n^2+1$ equals that of $(n+1)^4+(n+1)^2+1$.","The condition that the largest prime divisor of $n^4+n^2+1$ equals that of $(n+1)^4+(n+1)^2+1$ is $p_n = p_{n+1}$. Using the result from the first sub-problem, this is equivalent to $\\max\\{q_{n-1}, q_n\\} = \\max\\{q_n, q_{n+1}\\}$. For any integer $n \\in S$, the conditions $q_n > q_{n-1}$ and $q_n > q_{n+1}$ hold by definition. This implies that $\\max\\{q_{n-1}, q_n\\} = q_n$ and $\\max\\{q_n, q_{n+1}\\} = q_n$. Therefore, for any $n \\in S$, we have $p_n = q_n = p_{n+1}$. If the set $S$ is infinite, it follows directly that there are infinitely many integers $n$ satisfying the desired condition.",Prove that there exist infinitely many positive integers $n$ such that the largest prime divisor of $n^{4}+n^{2}+1$ is equal to the largest prime divisor of $(n+1)^{4}+(n+1)^{2}+1$.,"From the previous sub-problems, it suffices to prove that the set $S = \\{n \\in \\mathbb{Z}_{\\ge 2} \\mid q_n > q_{n-1} \text{ and } q_n > q_{n+1}\\}$ is infinite. Assume for contradiction that $S$ is finite. Since $S$ is non-empty (e.g., $3 \\in S$ because $q_2=7 < q_3=13 > q_4=7$), it has a largest element $m$. For any $n>m$, the sequence $(q_k)_{k>m}$ can have no local maxima. As $(q_n)$ is a sequence of positive integers and $q_n \neq q_{n-1}$, it cannot be eventually decreasing. Thus, there exists some $k \\ge m$ such that $q_k < q_{k+1}$, which implies the sequence must be strictly increasing for all $n>k$, i.e., $q_k < q_{k+1} < q_{k+2} < \\dots$. Now, observe that $p_n$, the largest prime divisor of $n^4+n^2+1 = (n^2)^2+n^2+1$, is equal to $q_{n^2}$. For $n=k+1$, we have $p_{k+1}=\\max\\{q_k,q_{k+1}\}=q_{k+1}$. Therefore, we must have $q_{(k+1)^2} = q_{k+1}$. But since the sequence is strictly increasing for indices greater than $k$, and $(k+1)^2 > k+1$ for $k \\ge 1$, we must have $q_{(k+1)^2}>q_{k+1}$. This is a contradiction. Thus, the assumption that $S$ is finite is false, and $S$ must be infinite.",,
2013n5,"Fix an integer $k \geqslant 2$. Two players, called Ana and Banana, play the following game of numbers: Initially, some integer $n \geqslant k$ gets written on the blackboard. Then they take moves in turn, with Ana beginning. A player making a move erases the number $m$ just written on the blackboard and replaces it by some number $m^{\prime}$ with $k \leqslant m^{\prime}<m$ that is coprime to $m$. The first player who cannot move anymore loses.

An integer $n \geqslant k$ is called good if Banana has a winning strategy when the initial number is $n$, and bad otherwise.

Consider two integers $n, n^{\prime} \geqslant k$ with the property that each prime number $p \leqslant k$ divides $n$ if and only if it divides $n^{\prime}$. Prove that either both $n$ and $n^{\prime}$ are good or both are bad.","Let us first observe that the number appearing on the blackboard decreases after every move; so the game necessarily ends after at most $n$ steps, and consequently there always has to be some player possessing a winning strategy. So if some $n \geqslant k$ is bad, then Ana has a winning strategy in the game with starting number $n$.

More precisely, if $n \geqslant k$ is such that there is a good integer $m$ with $n>m \geqslant k$ and $\operatorname{gcd}(m, n)=1$, then $n$ itself is bad, for Ana has the following winning strategy in the game with initial number $n$ : She proceeds by first playing $m$ and then using Banana's strategy for the game with starting number $m$.

Otherwise, if some integer $n \geqslant k$ has the property that every integer $m$ with $n>m \geqslant k$ and $\operatorname{gcd}(m, n)=1$ is bad, then $n$ is good. Indeed, if Ana can make a first move at all in the game with initial number $n$, then she leaves it in a position where the first player has a winning strategy, so that Banana can defeat her.

In particular, this implies that any two good numbers have a non-trivial common divisor. Also, $k$ itself is good.

For brevity, we say that $n \longrightarrow x$ is a move if $n$ and $x$ are two coprime integers with $n>x \geqslant k$.\\
Claim 1. If $n$ is good and $n^{\prime}$ is a multiple of $n$, then $n^{\prime}$ is also good.\\
Proof. If $n^{\prime}$ were bad, there would have to be some move $n^{\prime} \longrightarrow x$, where $x$ is good. As $n^{\prime}$ is a multiple of $n$ this implies that the two good numbers $n$ and $x$ are coprime, which is absurd.

Claim 2. If $r$ and $s$ denote two positive integers for which $r s \geqslant k$ is bad, then $r^{2} s$ is also bad.\\
Proof. Since $r s$ is bad, there is a move $r s \longrightarrow x$ for some good $x$. Evidently $x$ is coprime to $r^{2} s$ as well, and hence the move $r^{2} s \longrightarrow x$ shows that $r^{2} s$ is indeed bad.

Claim 3. If $p>k$ is prime and $n \geqslant k$ is bad, then np is also bad.\\
Proof. Otherwise we choose a counterexample with $n$ being as small as possible. In particular, $n p$ is good. Since $n$ is bad, there is a move $n \longrightarrow x$ for some good $x$. Now $n p \longrightarrow x$ cannot be a valid move, which tells us that $x$ has to be divisible by $p$. So we can write $x=p^{r} y$, where $r$ and $y$ denote some positive integers, the latter of which is not divisible by $p$.

Note that $y=1$ is impossible, for then we would have $x=p^{r}$ and the move $x \longrightarrow k$ would establish that $x$ is bad. In view of this, there is a least power $y^{\alpha}$ of $y$ that is at least as large as $k$. Since the numbers $n p$ and $y^{\alpha}$ are coprime and the former is good, the latter has to be bad. Moreover, the minimality of $\alpha$ implies $y^{\alpha}<k y<p y=\frac{x}{p^{r-1}}<\frac{n}{p^{r-1}}$. So $p^{r-1} \cdot y^{\alpha}<n$ and consequently all the numbers $y^{\alpha}, p y^{\alpha}, \ldots, p^{r} \cdot y^{\alpha}=p\left(p^{r-1} \cdot y^{\alpha}\right)$ are bad due to the minimal choice of $n$. But now by Claim 1 the divisor $x$ of $p^{r} \cdot y^{\alpha}$ cannot be good, whereby we have reached a contradiction that proves Claim 3.

We now deduce the statement of the problem from these three claims. To this end, we call two integers $a, b \geqslant k$ similar if they are divisible by the same prime numbers not exceeding $k$. We are to prove that if $a$ and $b$ are similar, then either both of them are good or both are bad. As in this case the product $a b$ is similar to both $a$ and $b$, it suffices to show the following: if $c \geqslant k$ is similar to some of its multiples $d$, then either both $c$ and $d$ are good or both are bad.

Assuming that this is not true in general, we choose a counterexample ( $c_{0}, d_{0}$ ) with $d_{0}$ being as small as possible. By Claim $1, c_{0}$ is bad whilst $d_{0}$ is good. Plainly $d_{0}$ is strictly greater than $c_{0}$ and hence the quotient $\frac{d_{0}}{c_{0}}$ has some prime factor $p$. Clearly $p$ divides $d_{0}$. If $p \leqslant k$, then $p$ divides $c_{0}$ as well due to the similarity, and hence $d_{0}$ is actually divisible by $p^{2}$. So $\frac{d_{0}}{p}$ is good by the contrapositive of Claim 2. Since $c_{0} \left\lvert\, \frac{d_{0}}{p}\right.$, the pair $\left(c_{0}, \frac{d_{0}}{p}\right)$ contradicts the supposed minimality of $d_{0}$. This proves $p>k$, but now we get the same contradiction using Claim 3 instead of Claim 2. Thereby the problem is solved.",4,"Let a number n >= k be 'good' if the second player has a winning strategy, and 'bad' otherwise. Prove that if n is good and n' is a multiple of n, then n' is also good.","A key property is that any two good numbers must have a common divisor greater than 1. Assume for contradiction that n' is bad. By definition, there is a move from n' to a good number x, meaning k <= x < n' and gcd(x, n')=1. Since n is a divisor of n', we also have gcd(x, n)=1. This implies that n and x are two coprime good numbers, a contradiction. Therefore, n' must be good.","Let 'good' and 'bad' numbers be defined as in the problem. Prove that if r and s are positive integers for which rs >= k is bad, then r^2s is also bad.","Since rs is bad, there exists a move rs -> x for some good number x. This means k <= x < rs and gcd(rs, x)=1. As gcd(rs, x)=1, it follows that gcd(r^2s, x)=1. Since r >= 1, we have x < rs <= r^2s. Thus, r^2s -> x is a valid move from r^2s to a good number x. By definition, this makes r^2s a bad number.","Let 'good' and 'bad' numbers be defined as in the problem. Prove that if p > k is a prime number and n >= k is a bad number, then np is also bad.","Assume not, and let n be the smallest bad integer for which np is good for some prime p>k. As n is bad, there is a move n -> x where x is good. Since np is good, we must have gcd(np, x) != 1. As gcd(n,x)=1, it must be that p divides x. Let x=p^a * y where p does not divide y. Since x is good, y>1. Let y^b >= k be the smallest power of y. y^b must be bad as it is coprime to the good number np. Note y^b < ky <= x < n. Since y^b < n is bad, by minimality of n, y^b * p^j is bad for all j >= 1. So y^b * p^a is bad. But x=p^a * y is a good number that divides y^b * p^a. From Sub-problem 1, any multiple of a good number is good, so y^b * p^a must be good. This is a contradiction.","Consider two integers n, n' >= k with the property that each prime number p <= k divides n if and only if it divides n'. Prove that either both n and n' are good or both are bad.","Call such numbers similar. It suffices to show that if c >= k is similar to its multiple d, they have the same status. Assume a counterexample (c, d) exists with d minimal. By Sub-problem 1, c must be bad and d good. Let p be a prime factor of d/c. Case 1: p <= k. By similarity, p also divides c, so p^2 divides d. By the contrapositive of Sub-problem 2, since d is good, d/p is good. Case 2: p > k. By the contrapositive of Sub-problem 3, since d is good, d/p is good. In both cases, (c, d/p) is a counterexample with a smaller multiple, contradicting the minimality of d. Hence, no counterexample exists."
2013n7,"Let $\nu$ be an irrational positive number, and let $m$ be a positive integer. A pair $(a, b)$ of positive integers is called good if


\begin{equation*}
a\lceil b \nu\rceil-b\lfloor a \nu\rfloor=m . \tag{*}
\end{equation*}


A good pair $(a, b)$ is called excellent if neither of the pairs $(a-b, b)$ and $(a, b-a)$ is good. (As usual, by $\lfloor x\rfloor$ and $\lceil x\rceil$ we denote the integer numbers such that $x-1<\lfloor x\rfloor \leqslant x$ and $x \leqslant\lceil x\rceil<x+1$.)

Prove that the number of excellent pairs is equal to the sum of the positive divisors of $m$.","Solution. For positive integers $a$ and $b$, let us denote

$$
f(a, b)=a\lceil b \nu\rceil-b\lfloor a \nu\rfloor .
$$

We will deal with various values of $m$; thus it is convenient to say that a pair $(a, b)$ is $m$-good or $m$-excellent if the corresponding conditions are satisfied.

To start, let us investigate how the values $f(a+b, b)$ and $f(a, b+a)$ are related to $f(a, b)$. If $\{a \nu\}+\{b \nu\}<1$, then we have $\lfloor(a+b) \nu\rfloor=\lfloor a \nu\rfloor+\lfloor b \nu\rfloor$ and $\lceil(a+b) \nu\rceil=\lceil a \nu\rceil+\lceil b \nu\rceil-1$, so

$$
f(a+b, b)=(a+b)\lceil b \nu\rceil-b(\lfloor a \nu\rfloor+\lfloor b \nu\rfloor)=f(a, b)+b(\lceil b \nu\rceil-\lfloor b \nu\rfloor)=f(a, b)+b
$$

and

$$
f(a, b+a)=a(\lceil b \nu\rceil+\lceil a \nu\rceil-1)-(b+a)\lfloor a \nu\rfloor=f(a, b)+a(\lceil a \nu\rceil-1-\lfloor a \nu\rfloor)=f(a, b) .
$$

Similarly, if $\{a \nu\}+\{b \nu\} \geqslant 1$ then one obtains

$$
f(a+b, b)=f(a, b) \quad \text { and } \quad f(a, b+a)=f(a, b)+a .
$$

So, in both cases one of the numbers $f(a+b, a)$ and $f(a, b+a)$ is equal to $f(a, b)$ while the other is greater than $f(a, b)$ by one of $a$ and $b$. Thus, exactly one of the pairs $(a+b, b)$ and $(a, b+a)$ is excellent (for an appropriate value of $m$ ).

Now let us say that the pairs $(a+b, b)$ and $(a, b+a)$ are the children of the pair $(a, b)$, while this pair is their parent. Next, if a pair $(c, d)$ can be obtained from $(a, b)$ by several passings from a parent to a child, we will say that $(c, d)$ is a descendant of $(a, b)$, while $(a, b)$ is an ancestor of $(c, d)$ (a pair is neither an ancestor nor a descendant of itself). Thus each pair ( $a, b$ ) has two children, it has a unique parent if $a \neq b$, and no parents otherwise. Therefore, each pair of distinct positive integers has a unique ancestor of the form $(a, a)$; our aim is now to find how many $m$-excellent descendants each such pair has.

Notice now that if a pair $(a, b)$ is $m$-excellent then $\min \{a, b\} \leqslant m$. Indeed, if $a=b$ then $f(a, a)=a=m$, so the statement is valid. Otherwise, the pair $(a, b)$ is a child of some pair $\left(a^{\prime}, b^{\prime}\right)$. If $b=b^{\prime}$ and $a=a^{\prime}+b^{\prime}$, then we should have $m=f(a, b)=f\left(a^{\prime}, b^{\prime}\right)+b^{\prime}$, so $b=b^{\prime}=m-f\left(a^{\prime}, b^{\prime}\right)<m$. Similarly, if $a=a^{\prime}$ and $b=b^{\prime}+a^{\prime}$ then $a<m$.

Let us consider the set $S_{m}$ of all pairs $(a, b)$ such that $f(a, b) \leqslant m$ and $\min \{a, b\} \leqslant m$. Then all the ancestors of the elements in $S_{m}$ are again in $S_{m}$, and each element in $S_{m}$ either is of the form $(a, a)$ with $a \leqslant m$, or has a unique ancestor of this form. From the arguments above we see that all $m$-excellent pairs lie in $S_{m}$.

We claim now that the set $S_{m}$ is finite. Indeed, assume, for instance, that it contains infinitely many pairs $(c, d)$ with $d>2 m$. Such a pair is necessarily a child of $(c, d-c)$, and thus a descendant of some pair ( $c, d^{\prime}$ ) with $m<d^{\prime} \leqslant 2 m$. Therefore, one of the pairs $(a, b) \in S_{m}$ with $m<b \leqslant 2 m$\\
has infinitely many descendants in $S_{m}$, and all these descendants have the form $(a, b+k a)$ with $k$ a positive integer. Since $f(a, b+k a)$ does not decrease as $k$ grows, it becomes constant for $k \geqslant k_{0}$, where $k_{0}$ is some positive integer. This means that $\{a \nu\}+\{(b+k a) \nu\}<1$ for all $k \geqslant k_{0}$. But this yields $1>\{(b+k a) \nu\}=\left\{\left(b+k_{0} a\right) \nu\right\}+\left(k-k_{0}\right)\{a \nu\}$ for all $k>k_{0}$, which is absurd.

Similarly, one can prove that $S_{m}$ contains finitely many pairs $(c, d)$ with $c>2 m$, thus finitely many elements at all.

We are now prepared for proving the following crucial lemma.\\
Lemma. Consider any pair $(a, b)$ with $f(a, b) \neq m$. Then the number $g(a, b)$ of its $m$-excellent descendants is equal to the number $h(a, b)$ of ways to represent the number $t=m-f(a, b)$ as $t=k a+\ell b$ with $k$ and $\ell$ being some nonnegative integers.\\
Proof. We proceed by induction on the number $N$ of descendants of $(a, b)$ in $S_{m}$. If $N=0$ then clearly $g(a, b)=0$. Assume that $h(a, b)>0$; without loss of generality, we have $a \leqslant b$. Then, clearly, $m-f(a, b) \geqslant a$, so $f(a, b+a) \leqslant f(a, b)+a \leqslant m$ and $a \leqslant m$, hence $(a, b+a) \in S_{m}$ which is impossible. Thus in the base case we have $g(a, b)=h(a, b)=0$, as desired.

Now let $N>0$. Assume that $f(a+b, b)=f(a, b)+b$ and $f(a, b+a)=f(a, b)$ (the other case is similar). If $f(a, b)+b \neq m$, then by the induction hypothesis we have

$$
g(a, b)=g(a+b, b)+g(a, b+a)=h(a+b, b)+h(a, b+a) .
$$

Notice that both pairs $(a+b, b)$ and $(a, b+a)$ are descendants of $(a, b)$ and thus each of them has strictly less descendants in $S_{m}$ than $(a, b)$ does.

Next, each one of the $h(a+b, b)$ representations of $m-f(a+b, b)=m-b-f(a, b)$ as the sum $k^{\prime}(a+b)+\ell^{\prime} b$ provides the representation $m-f(a, b)=k a+\ell b$ with $k=k^{\prime}<k^{\prime}+\ell^{\prime}+1=\ell$. Similarly, each one of the $h(a, b+a)$ representations of $m-f(a, b+a)=m-f(a, b)$ as the sum $k^{\prime} a+\ell^{\prime}(b+a)$ provides the representation $m-f(a, b)=k a+\ell b$ with $k=k^{\prime}+\ell^{\prime} \geqslant \ell^{\prime}=\ell$. This correspondence is obviously bijective, so

$$
h(a, b)=h(a+b, b)+h(a, b+a)=g(a, b),
$$

as required.\\
Finally, if $f(a, b)+b=m$ then $(a+b, b)$ is $m$-excellent, so $g(a, b)=1+g(a, b+a)=1+h(a, b+a)$ by the induction hypothesis. On the other hand, the number $m-f(a, b)=b$ has a representation $0 \cdot a+1 \cdot b$ and sometimes one more representation as $k a+0 \cdot b$; this last representation exists simultaneously with the representation $m-f(a, b+a)=k a+0 \cdot(b+a)$, so $h(a, b)=1+h(a, b+a)$ as well. Thus in this case the step is also proved.

Now it is easy to finish the solution. There exists a unique $m$-excellent pair of the form ( $a, a$ ), and each other $m$-excellent pair $(a, b)$ has a unique ancestor of the form $(x, x)$ with $x<m$. By the lemma, for every $x<m$ the number of its $m$-excellent descendants is $h(x, x)$, which is the number of ways to represent $m-f(x, x)=m-x$ as $k x+\ell x$ (with nonnegative integer $k$ and $\ell$ ). This number is 0 if $x \nmid m$, and $m / x$ otherwise. So the total number of excellent pairs is

$$
1+\sum_{x \mid m, x<m} \frac{m}{x}=1+\sum_{d \mid m, d>1} d=\sum_{d \mid m} d,
$$

as required.

Comment. Let us present a sketch of an outline of a different solution. The plan is to check that the number of excellent pairs does not depend on the (irrational) number $\nu$, and to find this number for some appropriate value of $\nu$. For that, we first introduce some geometrical language. We deal only with the excellent pairs ( $a, b$ ) with $a \neq b$.

Part I. Given an irrational positive $\nu$, for every positive integer $n$ we introduce two integral points $F_{\nu}(n)=$ $(n,\lfloor n \nu\rfloor)$ and $C_{\nu}(n)=(n,\lceil n \nu\rceil)$ on the coordinate plane $O x y$. Then (*) reads as $\left[O F_{\nu}(a) C_{\nu}(b)\right]=m / 2$; here [.] stands for the signed area. Next, we rewrite in these terms the condition on a pair $(a, b)$ to be excellent. Let $\ell_{\nu}, \ell_{\nu}^{+}$, and $\ell_{\nu}^{-}$be the lines determined by the equations $y=\nu x, y=\nu x+1$, and $y=\nu x-1$, respectively.\\
$a)$. Firstly, we deal with all excellent pairs $(a, b)$ with $a<b$. Given some value of $a$, all the points $C$ such that $\left[O F_{\nu}(a) C\right]=m / 2$ lie on some line $f_{\nu}(a)$; if there exist any good pairs $(a, b)$ at all, this line has to contain at least one integral point, which happens exactly when $\operatorname{gcd}(a,\lfloor a \nu\rfloor) \mid m$.

Let $P_{\nu}(a)$ be the point of intersection of $\ell_{\nu}^{+}$and $f_{\nu}(a)$, and let $p_{\nu}(a)$ be its abscissa; notice that $p_{\nu}(a)$ is irrational if it is nonzero. Now, if $(a, b)$ is good, then the point $C_{\nu}(b)$ lies on $f_{\nu}(a)$, which means that the point of $f_{\nu}(a)$ with abscissa $b$ lies between $\ell_{\nu}$ and $\ell_{\nu}^{+}$and is integral. If in addition the pair ( $a, b-a$ ) is not good, then the point of $f_{\nu}(a)$ with abscissa $b-a$ lies above $\ell_{\nu}^{+}$(see Fig. 1). Thus, the pair $(a, b)$ with $b>a$ is excellent exactly when $p_{\nu}(a)$ lies between $b-a$ and $b$, and the point of $f_{\nu}(a)$ with abscissa $b$ is integral (which means that this point is $\left.C_{\nu}(b)\right)$.

Notice now that, if $p_{\nu}(a)>a$, then the number of excellent pairs of the form $(a, b)$ (with $b>a$ ) is $\operatorname{gcd}(a,\lfloor a \nu\rfloor)$.\\
\includegraphics[max width=\textwidth, center]{2025_04_30_f697ddf0f0f1661c3074g-67}

Figure 1\\
\includegraphics[max width=\textwidth, center]{2025_04_30_f697ddf0f0f1661c3074g-67(1)}

Figure 2\\
$b)$. Analogously, considering the pairs $(a, b)$ with $a>b$, we fix the value of $b$, introduce the line $c_{\nu}(b)$ containing all the points $F$ with $\left[\operatorname{OFC}_{\nu}(b)\right]=m / 2$, assume that this line contains an integral point (which means $\operatorname{gcd}(b,[b \nu]) \mid m$ ), and denote the common point of $c_{\nu}(b)$ and $\ell_{\nu}^{-}$by $Q_{\nu}(b)$, its abscissa being $q_{\nu}(b)$. Similarly to the previous case, we obtain that the pair $(a, b)$ is excellent exactly when $q_{\nu}(a)$ lies between $a-b$ and $a$, and the point of $c_{\nu}(b)$ with abscissa $a$ is integral (see Fig. 2). Again, if $q_{\nu}(b)>b$, then the number of excellent pairs of the form $(a, b)$ (with $a>b)$ is $\operatorname{gcd}(b,[b \nu])$.\\
Part II, sketchy. Having obtained such a description, one may check how the number of excellent pairs changes as $\nu$ grows. (Having done that, one may find this number for one appropriate value of $\nu$; for instance, it is relatively easy to make this calculation for $\nu \in\left(1,1+\frac{1}{m}\right)$.)

Consider, for the initial value of $\nu$, some excellent pair ( $a, t$ ) with $a>t$. As $\nu$ grows, this pair eventually stops being excellent; this happens when the point $Q_{\nu}(t)$ passes through $F_{\nu}(a)$. At the same moment, the pair ( $a+t, t$ ) becomes excellent instead.

This process halts when the point $Q_{\nu}(t)$ eventually disappears, i.e. when $\nu$ passes through the ratio of the coordinates of the point $T=C_{\nu}(t)$. Hence, the point $T$ afterwards is regarded as $F_{\nu}(t)$. Thus, all the old excellent pairs of the form ( $a, t$ ) with $a>t$ disappear; on the other hand, the same number of excellent pairs with the first element being $t$ just appear.

Similarly, if some pair $(t, b)$ with $t<b$ is initially $\nu$-excellent, then at some moment it stops being excellent when $P_{\nu}(t)$ passes through $C_{\nu}(b)$; at the same moment, the pair $(t, b-t)$ becomes excellent. This process eventually stops when $b-t<t$. At this moment, again the second element of the pair becomes fixed, and the first one starts to increase.

These ideas can be made precise enough to show that the number of excellent pairs remains unchanged, as required.

We should warn the reader that the rigorous elaboration of Part II is technically quite involved, mostly by the reason that the set of moments when the collection of excellent pairs changes is infinite. Especially much care should be applied to the limit points of this set, which are exactly the points when the line $\ell_{\nu}$ passes through some point of the form $C_{\nu}(b)$.

The same ideas may be explained in an algebraic language instead of a geometrical one; the same technicalities remain in this way as well.",4,"Let $f(a, b)=a\\lceil b \nu\rceil-b\\lfloor a \nu\rfloor$. Analyze the relationship between $f(a, b)$, $f(a+b, b)$, and $f(a, b+a)$ for positive integers $a, b$.","We analyze two cases based on the sum of fractional parts $\{a \nu\\} + \{b \nu\}$.\nCase 1: If $\{a \nu\\} + \{b \nu\\} < 1$, then $\\lfloor(a+b) \nu\rfloor = \\lfloor a \nu\rfloor + \\lfloor b \nu\rfloor$. This leads to $f(a+b, b) = f(a, b) + b$ and $f(a, b+a) = f(a, b)$.\nCase 2: If $\{a \nu\\} + \{b \nu\\} \\ge 1$, then $\\lfloor(a+b) \nu\rfloor = \\lfloor a \nu\rfloor + \\lfloor b \nu\rfloor + 1$. This leads to $f(a+b, b) = f(a, b)$ and $f(a, b+a) = f(a, b) + a$.\nIn both cases, exactly one of the 'children' pairs $(a+b, b)$ or $(a, b+a)$ has its $f$-value increase, while the other's remains the same. This implies any pair $(c,d)$ with $c \neq d$ has a unique 'parent' pair, which can be traced back to a unique 'ancestor' pair of the form $(x, x)$.","For a pair $(a, b)$ with $f(a, b) < m$, prove that the number of its $m$-excellent descendants is equal to the number of ways to represent $m - f(a, b)$ as $ka + lb$ for non-negative integers $k$ and $l$.","Let $g(a, b)$ be the number of $m$-excellent descendants and $h(a, b)$ be the number of ways to write $m-f(a,b)=ka+lb$. We prove $g(a,b)=h(a,b)$ by induction. For the inductive step, assume $f(a+b, b)=f(a, b)+b$ and $f(a, b+a)=f(a, b)$. An $m$-excellent descendant of $(a,b)$ is either an $m$-excellent descendant of $(a+b,b)$ or $(a,b+a)$, unless one of them is itself $m$-excellent. This structure gives $g(a,b)=g(a+b,b)+g(a,b+a)$. A representation $m-f(a,b)=ka+lb$ can be uniquely mapped to a representation for either $m-f(a+b,b)$ or $m-f(a,b+a)$, showing that $h(a,b)=h(a+b,b)+h(a,b+a)$. The base cases and the situation where a child is excellent are handled similarly, completing the induction.","For any positive integer $x$, calculate the number of $m$-excellent descendants of the 'ancestor' pair $(x, x)$.","First, we compute $f(x, x) = x\\lceil x \nu\rceil - x\\lfloor x \nu\rfloor$. Since $\nu$ is irrational, $x\nu$ is not an integer, so $\\lceil x \nu\rceil = \\lfloor x \nu\rfloor + 1$. Thus, $f(x, x) = x$. Using the result from the previous sub-problem, the number of $m$-excellent descendants of $(x, x)$ is the number of ways to represent $m - f(x, x) = m - x$ as $kx + lx = (k+l)x$ for non-negative integers $k, l$. Such representations exist only if $x$ divides $m-x$, which is equivalent to $x$ dividing $m$. If $x|m$, we need to find the number of non-negative integer solutions to $k+l = (m-x)/x = m/x - 1$. The number of solutions is $(m/x - 1) + 1 = m/x$. If $x$ does not divide $m$, the number is 0.",Prove that the number of excellent pairs is equal to the sum of the positive divisors of $m$.,"An excellent pair $(a,a)$ must satisfy $f(a,a) = a = m$, so $(m,m)$ is the unique excellent pair of this form. Any other excellent pair $(a,b)$ with $a \neq b$ has a unique ancestor of the form $(x,x)$ for some $x<m$. The total number of excellent pairs is 1 (for the pair $(m,m)$) plus the sum of the number of excellent descendants for all possible ancestors $(x,x)$ where $x<m$. Using the result from the previous sub-problem, this sum is $1 + \\sum_{x|m, x<m} \frac{m}{x}$. By letting the index of summation be $d = m/x$, as $x$ ranges over the divisors of $m$ less than $m$, $d$ ranges over the divisors of $m$ greater than 1. The total count is $1 + \\sum_{d|m, d>1} d$, which equals $\\sum_{d|m} d$, the sum of all positive divisors of $m$."
2012a3,"Let $a_{2}, \ldots, a_{n}$ be $n-1$ positive real numbers, where $n \geq 3$, such that $a_{2} a_{3} \cdots a_{n}=1$. Prove that

$$
\left(1+a_{2}\right)^{2}\left(1+a_{3}\right)^{3} \cdots\left(1+a_{n}\right)^{n}>n^{n}
$$","Solution. The substitution $a_{2}=\frac{x_{2}}{x_{1}}, a_{3}=\frac{x_{3}}{x_{2}}, \ldots, a_{n}=\frac{x_{1}}{x_{n-1}}$ transforms the original problem into the inequality


\begin{equation*}
\left(x_{1}+x_{2}\right)^{2}\left(x_{2}+x_{3}\right)^{3} \cdots\left(x_{n-1}+x_{1}\right)^{n}>n^{n} x_{1}^{2} x_{2}^{3} \cdots x_{n-1}^{n} \tag{*}
\end{equation*}


for all $x_{1}, \ldots, x_{n-1}>0$. To prove this, we use the AM-GM inequality for each factor of the left-hand side as follows:

$$
\begin{array}{rlll}
\left(x_{1}+x_{2}\right)^{2} & & & \geq 2^{2} x_{1} x_{2} \\
\left(x_{2}+x_{3}\right)^{3} & = & \left(2\left(\frac{x_{2}}{2}\right)+x_{3}\right)^{3} & \geq 3^{3}\left(\frac{x_{2}}{2}\right)^{2} x_{3} \\
\left(x_{3}+x_{4}\right)^{4} & = & \left(3\left(\frac{x_{3}}{3}\right)+x_{4}\right)^{4} & \geq 4^{4}\left(\frac{x_{3}}{3}\right)^{3} x_{4} \\
& \vdots & \vdots & \vdots \\
\left(x_{n-1}+x_{1}\right)^{n} & = & \left((n-1)\left(\frac{x_{n-1}}{n-1}\right)+x_{1}\right)^{n} & \geq n^{n}\left(\frac{x_{n-1}}{n-1}\right)^{n-1} x_{1}
\end{array}
$$

Multiplying these inequalities together gives $\left({ }^{*}\right)$, with inequality sign $\geq$ instead of $>$. However for the equality to occur it is necessary that $x_{1}=x_{2}, x_{2}=2 x_{3}, \ldots, x_{n-1}=(n-1) x_{1}$, implying $x_{1}=(n-1)!x_{1}$. This is impossible since $x_{1}>0$ and $n \geq 3$. Therefore the inequality is strict.

Comment. One can avoid the substitution $a_{i}=x_{i} / x_{i-1}$. Apply the weighted AM-GM inequality to each factor $\left(1+a_{k}\right)^{k}$, with the same weights like above, to obtain

$$
\left(1+a_{k}\right)^{k}=\left((k-1) \frac{1}{k-1}+a_{k}\right)^{k} \geq \frac{k^{k}}{(k-1)^{k-1}} a_{k}
$$

Multiplying all these inequalities together gives

$$
\left(1+a_{2}\right)^{2}\left(1+a_{3}\right)^{3} \cdots\left(1+a_{n}\right)^{n} \geq n^{n} a_{2} a_{3} \cdots a_{n}=n^{n}
$$

The same argument as in the proof above shows that the equality cannot be attained.",2,"For any integer $k \ge 2$ and a positive real number $a_k$, prove that $\left(1+a_{k}\right)^{k} \geq \frac{k^{k}}{(k-1)^{k-1}} a_{k}$, and establish the condition for equality.","By the AM-GM inequality on the $k$ numbers consisting of $k-1$ copies of $\frac{1}{k-1}$ and one copy of $a_k$, we have $\frac{(k-1)\frac{1}{k-1} + a_k}{k} \ge \sqrt[k]{(\frac{1}{k-1})^{k-1}a_k}$. This simplifies to $\frac{1+a_k}{k} \ge \sqrt[k]{\frac{a_k}{(k-1)^{k-1}}}$. Raising both sides to the power of $k$ yields $(1+a_k)^k \ge \frac{k^k}{(k-1)^{k-1}}a_k$. Equality holds if and only if all the numbers are equal, which means $a_k = \frac{1}{k-1}$.","Let $a_{2}, \ldots, a_{n}$ be $n-1$ positive real numbers, where $n \geq 3$, such that $a_{2} a_{3} \cdots a_{n}=1$. Prove that $\left(1+a_{2}\right)^{2}\left(1+a_{3}\right)^{3} \cdots\left(1+a_{n}\right)^{n}>n^{n}$.","Applying the inequality from the first sub-problem for each $k \in \{2, 3, \ldots, n\}$, we get $\left(1+a_{k}\right)^{k} \geq \frac{k^{k}}{(k-1)^{k-1}} a_{k}$. Multiplying these $n-1$ inequalities gives $\prod_{k=2}^{n} (1+a_k)^k \ge \prod_{k=2}^{n} \frac{k^k}{(k-1)^{k-1}} a_k$. The right side simplifies to $(\prod_{k=2}^{n} \frac{k^k}{(k-1)^{k-1}}) (\prod_{k=2}^{n} a_k) = (\frac{2^2}{1^1} \frac{3^3}{2^2} \cdots \frac{n^n}{(n-1)^{n-1}}) (a_2 \cdots a_n) = n^n \cdot 1 = n^n$. Thus, the inequality holds with $\ge$. For equality to hold, we need $a_k = \frac{1}{k-1}$ for all $k=2, \ldots, n$. This would imply $a_2 a_3 \cdots a_n = \frac{1}{1} \frac{1}{2} \cdots \frac{1}{n-1} = \frac{1}{(n-1)!}$. Since $n \ge 3$, $(n-1)! \ne 1$, which contradicts the condition $a_2 \cdots a_n = 1$. Thus, equality cannot hold and the inequality is strict.",,,,
2012a4,Let $f$ and $g$ be two nonzero polynomials with integer coefficients and $\operatorname{deg} f>\operatorname{deg} g$. Suppose that for infinitely many primes $p$ the polynomial $p f+g$ has a rational root. Prove that $f$ has a rational root.,"Since $\operatorname{deg} f>\operatorname{deg} g$, we have $|g(x) / f(x)|<1$ for sufficiently large $x$; more precisely, there is a real number $R$ such that $|g(x) / f(x)|<1$ for all $x$ with $|x|>R$. Then for all such $x$ and all primes $p$ we have

$$
|p f(x)+g(x)| \geq|f(x)|\left(p-\frac{|g(x)|}{|f(x)|}\right)>0 .
$$

Hence all real roots of the polynomials $p f+g$ lie in the interval $[-R, R]$.\\
Let $f(x)=a_{n} x^{n}+a_{n-1} x^{n-1}+\cdots+a_{0}$ and $g(x)=b_{m} x^{m}+b_{m-1} x^{m-1}+\cdots+b_{0}$ where $n>m, a_{n} \neq 0$ and $b_{m} \neq 0$. Upon replacing $f(x)$ and $g(x)$ by $a_{n}^{n-1} f\left(x / a_{n}\right)$ and $a_{n}^{n-1} g\left(x / a_{n}\right)$ respectively, we reduce the problem to the case $a_{n}=1$. In other words one can assume that $f$ is monic. Then the leading coefficient of $p f+g$ is $p$, and if $r=u / v$ is a rational root of $p f+g$ with $(u, v)=1$ and $v>0$, then either $v=1$ or $v=p$.

First consider the case when $v=1$ infinitely many times. If $v=1$ then $|u| \leq R$, so there are only finitely many possibilities for the integer $u$. Therefore there exist distinct primes $p$ and $q$ for which we have the same value of $u$. Then the polynomials $p f+g$ and $q f+g$ share this root, implying $f(u)=g(u)=0$. So in this case $f$ and $g$ have an integer root in common.

Now suppose that $v=p$ infinitely many times. By comparing the exponent of $p$ in the denominators of $p f(u / p)$ and $g(u / p)$ we get $m=n-1$ and $p f(u / p)+g(u / p)=0$ reduces to an equation of the form

$$
\left(u^{n}+a_{n-1} p u^{n-1}+\ldots+a_{0} p^{n}\right)+\left(b_{n-1} u^{n-1}+b_{n-2} p u^{n-2}+\ldots+b_{0} p^{n-1}\right)=0 .
$$

The equation above implies that $u^{n}+b_{n-1} u^{n-1}$ is divisible by $p$ and hence, since $(u, p)=1$, we have $u+b_{n-1}=p k$ with some integer $k$. On the other hand all roots of $p f+g$ lie in the interval $[-R, R]$, so that

$$
\begin{gathered}
\frac{\left|p k-b_{n-1}\right|}{p}=\frac{|u|}{p}<R, \\
|k|<R+\frac{\left|b_{n-1}\right|}{p}<R+\left|b_{n-1}\right| .
\end{gathered}
$$

Therefore the integer $k$ can attain only finitely many values. Hence there exists an integer $k$ such that the number $\frac{p k-b_{n-1}}{p}=k-\frac{b_{n-1}}{p}$ is a root of $p f+g$ for infinitely many primes $p$. For these primes we have

$$
f\left(k-b_{n-1} \frac{1}{p}\right)+\frac{1}{p} g\left(k-b_{n-1} \frac{1}{p}\right)=0 .
$$

So the equation


\begin{equation*}
f\left(k-b_{n-1} x\right)+x g\left(k-b_{n-1} x\right)=0 \tag{1}
\end{equation*}


has infinitely many solutions of the form $x=1 / p$. Since the left-hand side is a polynomial, this implies that (1) is a polynomial identity, so it holds for all real $x$. In particular, by substituting $x=0$ in (1) we get $f(k)=0$. Thus the integer $k$ is a root of $f$.

In summary the monic polynomial $f$ obtained after the initial reduction always has an integer root. Therefore the original polynomial $f$ has a rational root.",3,"Show that for any two nonzero polynomials $f, g$ with integer coefficients and $\operatorname{deg} f > \operatorname{deg} g$, there exists a real number $R>0$ such that for any prime $p$, all real roots of the polynomial $p f+g$ lie in the interval $[-R, R]$.","Since $\operatorname{deg} f > \operatorname{deg} g$, we have $\lim_{|x| \to \infty} |g(x)/f(x)| = 0$. Thus, there exists an $R>0$ such that for all $|x|>R$, we have $|g(x)/f(x)| < 1$. For any prime $p \ge 2$ and for any $x$ with $|x|>R$, we have $|p f(x)+g(x)| = |f(x)| |p + g(x)/f(x)| \ge |f(x)|(p - |g(x)/f(x)|) > |f(x)|(p-1) \ge |f(x)|$. Since $f$ is a nonzero polynomial, we can choose $R$ large enough so that $f(x) \neq 0$ for $|x|>R$. Therefore, for $|x|>R$, $p f(x)+g(x)$ is never zero. This means all real roots of $p f+g$ must lie in the fixed interval $[-R, R]$.","Assume $f$ is a monic polynomial with integer coefficients and $\operatorname{deg} f > \operatorname{deg} g$. If for infinitely many primes $p$ the polynomial $p f+g$ has an integer root, prove that $f$ has a rational root.","Let $u_p$ be an integer root of $p f+g$ for an infinite set of primes $P$. From the first sub-problem, there is a fixed bound $R$ such that $|u_p| \le R$ for all $p \in P$. Since each $u_p$ is an integer, there are only finitely many possible values for these roots. By the pigeonhole principle, there must be an integer $u_0$ such that $u_p = u_0$ for infinitely many primes. Let $p_1$ and $p_2$ be two distinct primes for which this holds. Then we have $p_1 f(u_0) + g(u_0) = 0$ and $p_2 f(u_0) + g(u_0) = 0$. Subtracting these equations yields $(p_1-p_2)f(u_0) = 0$. Since $p_1 \neq p_2$, it follows that $f(u_0)=0$. Thus, $f$ has the integer root $u_0$, which is a rational root.",Let $f$ and $g$ be two nonzero polynomials with integer coefficients and $\operatorname{deg} f>\operatorname{deg} g$. Suppose that for infinitely many primes $p$ the polynomial $p f+g$ has a rational root. Prove that $f$ has a rational root.,"First, we can assume $f$ is monic without loss of generality, by a suitable change of variables. Let $r_p=u/v$ be a rational root of $pf+g$ for an infinite set of primes $P$, with $\gcd(u,v)=1$ and $v>0$. Since $f$ is monic, the leading coefficient of $pf+g$ is $p$. By the Rational Root Theorem, $v$ must divide $p$, so $v=1$ or $v=p$. If $v=1$ for infinitely many $p \in P$, then by the second sub-problem, $f$ has a rational root. Otherwise, we can assume $v=p$ for infinitely many $p \in P$. The condition $p f(u/p) + g(u/p) = 0$ implies $\deg g = \deg f - 1$. Let $f(x)=x^n+\dots$ and $g(x)=b_{n-1}x^{n-1}+\dots$. The equation becomes $u^n+b_{n-1}u^{n-1} \equiv 0 \pmod p$. As $\gcd(u,p)=1$, this gives $u+b_{n-1} \equiv 0 \pmod p$, so $u = kp-b_{n-1}$ for some integer $k$. The root is $r_p = u/p = k-b_{n-1}/p$. By the first sub-problem, $|r_p| \le R$, so $|k - b_{n-1}/p| \le R$. This implies $k$ is bounded and can take only finitely many integer values. Thus, there is an integer $k_0$ such that for infinitely many primes $p$, $k=k_0$. For these primes, $f(k_0 - b_{n-1}/p) + (1/p)g(k_0 - b_{n-1}/p) = 0$. The polynomial $H(x) = f(k_0-b_{n-1}x) + x g(k_0-b_{n-1}x)$ has infinitely many roots $x=1/p$, so it must be identically zero. Setting $x=0$ yields $f(k_0)=0$. In all cases, $f$ has an integer root.",,
2012a6,"Let $f: \mathbb{N} \rightarrow \mathbb{N}$ be a function, and let $f^{m}$ be $f$ applied $m$ times. Suppose that for every $n \in \mathbb{N}$ there exists a $k \in \mathbb{N}$ such that $f^{2 k}(n)=n+k$, and let $k_{n}$ be the smallest such $k$. Prove that the sequence $k_{1}, k_{2}, \ldots$ is unbounded.","Solution. We restrict attention to the set

$$
S=\left\{1, f(1), f^{2}(1), \ldots\right\}
$$

Observe that $S$ is unbounded because for every number $n$ in $S$ there exists a $k>0$ such that $f^{2 k}(n)=n+k$ is in $S$. Clearly $f$ maps $S$ into itself; moreover $f$ is injective on $S$. Indeed if $f^{i}(1)=f^{j}(1)$ with $i \neq j$ then the values $f^{m}(1)$ start repeating periodically from some point on, and $S$ would be finite.

Define $g: S \rightarrow S$ by $g(n)=f^{2 k_{n}}(n)=n+k_{n}$. We prove that $g$ is injective too. Suppose that $g(a)=g(b)$ with $a<b$. Then $a+k_{a}=f^{2 k_{a}}(a)=f^{2 k_{b}}(b)=b+k_{b}$ implies $k_{a}>k_{b}$. So, since $f$ is injective on $S$, we obtain

$$
f^{2\left(k_{a}-k_{b}\right)}(a)=b=a+\left(k_{a}-k_{b}\right) .
$$

However this contradicts the minimality of $k_{a}$ as $0<k_{a}-k_{b}<k_{a}$.\\
Let $T$ be the set of elements of $S$ that are not of the form $g(n)$ with $n \in S$. Note that $1 \in T$ by $g(n)>n$ for $n \in S$, so $T$ is non-empty. For each $t \in T$ denote $C_{t}=\left\{t, g(t), g^{2}(t), \ldots\right\}$; call $C_{t}$ the chain starting at $t$. Observe that distinct chains are disjoint because $g$ is injective. Each $n \in S \backslash T$ has the form $n=g\left(n^{\prime}\right)$ with $n^{\prime}<n, n^{\prime} \in S$. Repeated applications of the same observation show that $n \in C_{t}$ for some $t \in T$, i. e. $S$ is the disjoint union of the chains $C_{t}$.

If $f^{n}(1)$ is in the chain $C_{t}$ starting at $t=f^{n_{t}}(1)$ then $n=n_{t}+2 a_{1}+\cdots+2 a_{j}$ with

$$
f^{n}(1)=g^{j}\left(f^{n_{t}}(1)\right)=f^{2 a_{j}}\left(f^{2 a_{j-1}}\left(\cdots f^{2 a_{1}}\left(f^{n_{t}}(1)\right)\right)\right)=f^{n_{t}}(1)+a_{1}+\cdots+a_{j}
$$

Hence


\begin{equation*}
f^{n}(1)=f^{n_{t}}(1)+\frac{n-n_{t}}{2}=t+\frac{n-n_{t}}{2} . \tag{1}
\end{equation*}


Now we show that $T$ is infinite. We argue by contradiction. Suppose that there are only finitely many chains $C_{t_{1}}, \ldots, C_{t_{r}}$, starting at $t_{1}<\cdots<t_{r}$. Fix $N$. If $f^{n}(1)$ with $1 \leq n \leq N$ is in $C_{t}$ then $f^{n}(1)=t+\frac{n-n_{t}}{2} \leq t_{r}+\frac{N}{2}$ by (1). But then the $N+1$ distinct natural numbers $1, f(1), \ldots, f^{N}(1)$ are all less than $t_{r}+\frac{N}{2}$ and hence $N+1 \leq t_{r}+\frac{N}{2}$. This is a contradiction if $N$ is sufficiently large, and hence $T$ is infinite.

To complete the argument, choose any $k$ in $\mathbb{N}$ and consider the $k+1$ chains starting at the first $k+1$ numbers in $T$. Let $t$ be the greatest one among these numbers. Then each of the chains in question contains a number not exceeding $t$, and at least one of them does not contain any number among $t+1, \ldots, t+k$. So there is a number $n$ in this chain such that $g(n)-n>k$, i. e. $k_{n}>k$. In conclusion $k_{1}, k_{2}, \ldots$ is unbounded.",3,Let $S = \{f^m(1) \mid m \in \mathbb{N}_0\}$. The function $f$ is injective on the (unbounded) set $S$. Define $g: S \rightarrow S$ by $g(n)=f^{2 k_{n}}(n)=n+k_{n}$. Prove that $g$ is injective on $S$.,"Assume for contradiction that $g(a)=g(b)$ for $a, b \in S$ with $a<b$. This implies $a+k_{a}=b+k_{b}$, so $k_{a}>k_{b}$. The condition $f^{2 k_{a}}(a)=f^{2 k_{b}}(b)$ and the injectivity of $f$ on $S$ implies $f^{2(k_{a}-k_{b})}(a)=b$. Substituting $b=a+(k_a-k_b)$ from the first equation, we get $f^{2(k_{a}-k_{b})}(a)=a+(k_{a}-k_{b})$. Let $k' = k_a - k_b$. We have $0 < k' < k_a$ and $f^{2k'}(a) = a+k'$, which contradicts the definition of $k_a$ as the smallest such integer. Thus, $g$ is injective.","Let $T = S \setminus g(S)$ be the set of elements in $S$ not in the image of $g$. The set $S$ can be partitioned into a disjoint union of ""chains"" $C_t = \{g^m(t) \mid m \in \mathbb{N}_0\}$ for each $t \in T$. Prove that the set $T$ of chain-starters is infinite.","The set $T$ is non-empty as $1 \in T$ since $g(n)=n+k_n > n$. The chains $C_t$ are disjoint because $g$ is injective. Assume $T$ is finite, $T=\{t_1, \ldots, t_r\}$, with $t_r$ being the largest element. For any $f^m(1) \in S$, if it belongs to chain $C_{t_i}$ where $t_i = f^{m_i}(1)$, it can be shown that $f^m(1) = t_i + (m-m_i)/2$. For any $N$, the $N+1$ distinct numbers $f^0(1), \ldots, f^N(1)$ must all be less than or equal to $t_r + N/2$. This implies $N+1 \le t_r + N/2$, which is a contradiction for large $N$. Therefore, $T$ must be infinite.","Prove that the sequence $k_{1}, k_{2}, \ldots$ is unbounded.","Since the set $T$ of chain-starters is infinite, for any integer $K>0$, we can choose $K+1$ distinct elements from $T$, say $t_1, \ldots, t_{K+1}$. Let $t_{\max} = \max\{t_1, \ldots, t_{K+1}\}$. Consider the set $A = \{t_{\max}+1, \ldots, t_{\max}+K\}$, which has $K$ elements. The $K+1$ chains starting at $t_1, \ldots, t_{K+1}$ are all disjoint. By the pigeonhole principle, at least one chain, say $C_j$, has no element in $A$. Let $n$ be the largest element in $C_j$ with $n \le t_{\max}$ (such $n$ exists as $t_j \in C_j$ and $t_j \le t_{\max}$). Its successor in the chain, $g(n) = n+k_n$, must be greater than $t_{\max}+K$. Therefore, $k_n = g(n) - n > (t_{\max}+K) - n \ge (t_{\max}+K) - t_{\max} = K$. For any $K$, we found an $n$ such that $k_n > K$. Thus, the sequence is unbounded.",,
2012a7,"We say that a function $f: \mathbb{R}^{k} \rightarrow \mathbb{R}$ is a metapolynomial if, for some positive integers $m$ and $n$, it can be represented in the form

$$
f\left(x_{1}, \ldots, x_{k}\right)=\max _{i=1, \ldots, m} \min _{j=1, \ldots, n} P_{i, j}\left(x_{1}, \ldots, x_{k}\right)
$$

where $P_{i, j}$ are multivariate polynomials. Prove that the product of two metapolynomials is also a metapolynomial.","Solution. We use the notation $f(x)=f\left(x_{1}, \ldots, x_{k}\right)$ for $x=\left(x_{1}, \ldots, x_{k}\right)$ and $[m]=\{1,2, \ldots, m\}$. Observe that if a metapolynomial $f(x)$ admits a representation like the one in the statement for certain positive integers $m$ and $n$, then they can be replaced by any $m^{\prime} \geq m$ and $n^{\prime} \geq n$. For instance, if we want to replace $m$ by $m+1$ then it is enough to define $P_{m+1, j}(x)=P_{m, j}(x)$ and note that repeating elements of a set do not change its maximum nor its minimum. So one can assume that any two metapolynomials are defined with the same $m$ and $n$. We reserve letters $P$ and $Q$ for polynomials, so every function called $P, P_{i, j}, Q, Q_{i, j}, \ldots$ is a polynomial function.

We start with a lemma that is useful to change expressions of the form min max $f_{i, j}$ to ones of the form $\max \min g_{i, j}$.\\
Lemma. Let $\left\{a_{i, j}\right\}$ be real numbers, for all $i \in[m]$ and $j \in[n]$. Then

$$
\min _{i \in[m]} \max _{j \in[n]} a_{i, j}=\max _{j_{1}, \ldots, j_{m} \in[n]} \min _{i \in[m]} a_{i, j_{i}},
$$

where the max in the right-hand side is over all vectors $\left(j_{1}, \ldots, j_{m}\right)$ with $j_{1}, \ldots, j_{m} \in[n]$.\\
Proof. We can assume for all $i$ that $a_{i, n}=\max \left\{a_{i, 1}, \ldots, a_{i, n}\right\}$ and $a_{m, n}=\min \left\{a_{1, n}, \ldots, a_{m, n}\right\}$. The left-hand side is $=a_{m, n}$ and hence we need to prove the same for the right-hand side. If $\left(j_{1}, j_{2}, \ldots, j_{m}\right)=(n, n, \ldots, n)$ then $\min \left\{a_{1, j_{1}}, \ldots, a_{m, j_{m}}\right\}=\min \left\{a_{1, n}, \ldots, a_{m, n}\right\}=a_{m, n}$ which implies that the right-hand side is $\geq a_{m, n}$. It remains to prove the opposite inequality and this is equivalent to $\min \left\{a_{1, j_{1}}, \ldots, a_{m, j_{m}}\right\} \leq a_{m, n}$ for all possible $\left(j_{1}, j_{2}, \ldots, j_{m}\right)$. This is true because $\min \left\{a_{1, j_{1}}, \ldots, a_{m, j_{m}}\right\} \leq a_{m, j_{m}} \leq a_{m, n}$.

We need to show that the family $\mathcal{M}$ of metapolynomials is closed under multiplication, but it turns out easier to prove more: that it is also closed under addition, maxima and minima.

First we prove the assertions about the maxima and the minima. If $f_{1}, \ldots, f_{r}$ are metapolynomials, assume them defined with the same $m$ and $n$. Then

$$
f=\max \left\{f_{1}, \ldots, f_{r}\right\}=\max \left\{\max _{i \in[m]} \min _{j \in[n]} P_{i, j}^{1}, \ldots, \max _{i \in[m]} \min _{j \in[n]} P_{i, j}^{r}\right\}=\max _{s \in[r], i \in[m]} \min _{j \in[n]} P_{i, j}^{s} .
$$

It follows that $f=\max \left\{f_{1}, \ldots, f_{r}\right\}$ is a metapolynomial. The same argument works for the minima, but first we have to replace min max by max min, and this is done via the lemma.

Another property we need is that if $f=\max \min P_{i, j}$ is a metapolynomial then so is $-f$. Indeed, $-f=\min \left(-\min P_{i, j}\right)=\min \max P_{i, j}$.

To prove $\mathcal{M}$ is closed under addition let $f=\max \min P_{i, j}$ and $g=\max \min Q_{i, j}$. Then

$$
\begin{gathered}
f(x)+g(x)=\max _{i \in[m]} \min _{j \in[n]} P_{i, j}(x)+\max _{i \in[m]} \min _{j \in[n]} Q_{i, j}(x) \\
=\max _{i_{1}, i_{2} \in[m]}\left(\min _{j \in[n]} P_{i_{1}, j}(x)+\min _{j \in[n]} Q_{i_{2}, j}(x)\right)=\max _{i_{1}, i_{2} \in[m]} \min _{j_{1}, j_{2} \in[n]}\left(P_{i_{1}, j_{1}}(x)+Q_{i_{2}, j_{2}}(x)\right),
\end{gathered}
$$

and hence $f(x)+g(x)$ is a metapolynomial.\\
We proved that $\mathcal{M}$ is closed under sums, maxima and minima, in particular any function that can be expressed by sums, max, min, polynomials or even metapolynomials is in $\mathcal{M}$.

We would like to proceed with multiplication along the same lines like with addition, but there is an essential difference. In general the product of the maxima of two sets is not equal\\
to the maximum of the product of the sets. We need to deal with the fact that $a<b$ and $c<d$ do not imply $a c<b d$. However this is true for $a, b, c, d \geq 0$.

In view of this we decompose each function $f(x)$ into its positive part $f^{+}(x)=\max \{f(x), 0\}$ and its negative part $f^{-}(x)=\max \{0,-f(x)\}$. Note that $f=f^{+}-f^{-}$and $f^{+}, f^{-} \in \mathcal{M}$ if $f \in \mathcal{M}$. The whole problem reduces to the claim that if $f$ and $g$ are metapolynomials with $f, g \geq 0$ then $f g$ it is also a metapolynomial.

Assuming this claim, consider arbitrary $f, g \in \mathcal{M}$. We have

$$
f g=\left(f^{+}-f^{-}\right)\left(g^{+}-g^{-}\right)=f^{+} g^{+}-f^{+} g^{-}-f^{-} g^{+}+f^{-} g^{-}
$$

and hence $f g \in \mathcal{M}$. Indeed, $\mathcal{M}$ is closed under addition, also $f^{+} g^{+}, f^{+} g^{-}, f^{-} g^{+}, f^{-} g^{-} \in \mathcal{M}$ because $f^{+}, f^{-}, g^{+}, g^{-} \geq 0$.

It remains to prove the claim. In this case $f, g \geq 0$, and one can try to repeat the argument for the sum. More precisely, let $f=\max \min P_{i j} \geq 0$ and $g=\max \min Q_{i j} \geq 0$. Then

$$
f g=\max \min P_{i, j} \cdot \max \min Q_{i, j}=\max \min P_{i, j}^{+} \cdot \max \min Q_{i, j}^{+}=\max \min P_{i_{1}, j_{1}}^{+} \cdot Q_{i_{2}, j_{2}}^{+}
$$

Hence it suffices to check that $P^{+} Q^{+} \in \mathcal{M}$ for any pair of polynomials $P$ and $Q$. This reduces to the identity

$$
u^{+} v^{+}=\max \left\{0, \min \{u v, u, v\}, \min \left\{u v, u v^{2}, u^{2} v\right\}, \min \left\{u v, u, u^{2} v\right\}, \min \left\{u v, u v^{2}, v\right\}\right\}
$$

with $u$ replaced by $P(x)$ and $v$ replaced by $Q(x)$. The formula is proved by a case-by-case analysis. If $u \leq 0$ or $v \leq 0$ then both sides equal 0 . In case $u, v \geq 0$, the right-hand side is clearly $\leq u v$. To prove the opposite inequality we use that $u v$ equals

$$
\begin{array}{ll}
\min \{u v, u, v\} & \text { if } 0 \leq u, v \leq 1 \\
\min \left\{u v, u v^{2}, u^{2} v\right\} & \text { if } 1 \leq u, v \\
\min \left\{u v, u, u^{2} v\right\} & \text { if } 0 \leq v \leq 1 \leq u \\
\min \left\{u v, u v^{2}, v\right\} & \text { if } 0 \leq u \leq 1 \leq v
\end{array}
$$

Comment. The case $k=1$ is simpler and can be solved by proving that a function $f: \mathbb{R} \rightarrow \mathbb{R}$ is a metapolynomial if and only if it is a piecewise polinomial (and continuos) function.

It is enough to prove that all such functions are metapolynomials, and this easily reduces to the following case. Given a polynomial $P(x)$ with $P(0)=0$, the function $f$ defined by $f(x)=P(x)$ for $x \geq 0$ and 0 otherwise is a metapolynomial. For this last claim, it suffices to prove that $\left(x^{+}\right)^{n}$ is a metapolynomial, and this follows from the formula $\left(x^{+}\right)^{n}=\max \left\{0, \min \left\{x^{n-1}, x^{n}\right\}, \min \left\{x^{n}, x^{n+1}\right\}\right\}$.",4,"Show that if $f$ and $g$ are metapolynomials, then so are their sum $f+g$, their maximum $\max(f, g)$, and the negation $-f$.","Let $f(x) = \max_{i} \min_{j} P_{i,j}(x)$ and $g(x) = \max_{k} \min_{l} Q_{k,l}(x)$. Then $\max(f, g)$ is a metapolynomial by combining the outer `max` operations. The sum $f+g = \max_{i,k} \min_{j,l} (P_{i,j} + Q_{k,l})$ is a metapolynomial as $P_{i,j}+Q_{k,l}$ is a polynomial. The negation $-f = \min_{i} \max_{j} (-P_{i,j})$ can be converted to the required $\max \min$ form using the identity $\min_{i} \max_{j} a_{i,j} = \max_{(j_1,..,j_m)} \min_{i} a_{i,j_i}$, thus it is a metapolynomial.",Show that the problem of proving that the product of two metapolynomials is a metapolynomial can be reduced to proving it for two non-negative metapolynomials.,"Any metapolynomial $f$ can be decomposed as $f=f^+-f^-$, where $f^+ = \max(f,0)$ and $f^- = \max(-f,0)$. From sub-problem 1, if $f$ is a metapolynomial, so are $f^+$ and $f^-$. The product of two metapolynomials $f,g$ is $fg = (f^+-f^-)(g^+-g^-) = f^+g^+ - f^+g^- - f^-g^+ + f^-g^-$. If the product of non-negative metapolynomials is a metapolynomial, then each term in the sum is a metapolynomial. Since the set of metapolynomials is closed under addition and subtraction (from sub-problem 1), $fg$ must be a metapolynomial.","For non-negative metapolynomials $f(x) = \max_i \min_j P_{i,j}(x)$ and $g(x) = \max_k \min_l Q_{k,l}(x)$, show that their product $f \cdot g$ can be written in the form $\max_{i,k} \min_{j,l} (P_{i,j}(x)^+ \cdot Q_{k,l}(x)^+)$.","Since $f \ge 0$, we have $f = f^+ = (\max_i \min_j P_{i,j})^+ = \max_i (\min_j P_{i,j})^+$. Using the identity $(\min_j a_j)^+ = \min_j (a_j^+)$, this becomes $f = \max_i \min_j (P_{i,j})^+$. Similarly, $g = \max_k \min_l (Q_{k,l})^+$. As all terms $(P_{i,j})^+$ and $(Q_{k,l})^+$ are non-negative, the product distributes over max and min, yielding $f \cdot g = (\max_i \min_j P_{i,j}^+) \cdot (\max_k \min_l Q_{k,l}^+) = \max_{i,k} \min_{j,l} (P_{i,j}^+ \cdot Q_{k,l}^+)$. Therefore, the problem reduces to showing that $P^+Q^+$ is a metapolynomial.",Prove that the product of two metapolynomials is also a metapolynomial.,"From the previous sub-problems, the proof reduces to showing that for any two polynomials $P(x)$ and $Q(x)$, the function $P(x)^+Q(x)^+$ is a metapolynomial. Let $u=P(x)$ and $v=Q(x)$. The function $u^+v^+$ can be expressed via the identity $u^+ v^+ = \max \left\{0, \min \{u v, u, v\}, \min \{u v, u v^2, u^2 v\}, \min \{u v, u, u^2 v\}, \min \{u v, u v^2, v\}\right\}$. This expression is in the form of a maximum of minima of polynomials in $u$ and $v$, and is therefore a metapolynomial. This completes the proof."
2012c1,"Several positive integers are written in a row. Iteratively, Alice chooses two adjacent numbers $x$ and $y$ such that $x>y$ and $x$ is to the left of $y$, and replaces the pair $(x, y)$ by either $(y+1, x)$ or $(x-1, x)$. Prove that she can perform only finitely many such iterations.","Note first that the allowed operation does not change the maximum $M$ of the initial sequence. Let $a_{1}, a_{2}, \ldots, a_{n}$ be the numbers obtained at some point of the process. Consider the sum

$$
S=a_{1}+2 a_{2}+\cdots+n a_{n} .
$$

We claim that $S$ increases by a positive integer amount with every operation. Let the operation replace the pair $\left(a_{i}, a_{i+1}\right)$ by a pair $\left(c, a_{i}\right)$, where $a_{i}>a_{i+1}$ and $c=a_{i+1}+1$ or $c=a_{i}-1$. Then the new and the old value of $S$ differ by $d=\left(i c+(i+1) a_{i}\right)-\left(i a_{i}+(i+1) a_{i+1}\right)=a_{i}-a_{i+1}+i\left(c-a_{i+1}\right)$. The integer $d$ is positive since $a_{i}-a_{i+1} \geq 1$ and $c-a_{i+1} \geq 0$.

On the other hand $S \leq(1+2+\cdots+n) M$ as $a_{i} \leq M$ for all $i=1, \ldots, n$. Since $S$ increases by at least 1 at each step and never exceeds the constant $(1+2+\cdots+n) M$, the process stops after a finite number of iterations.",2,"Let the sequence of $n$ positive integers be $a_1, a_2, \ldots, a_n$. Consider the quantity $S = \sum_{k=1}^n k a_k$. Prove that each operation performed by Alice increases the value of $S$ by a positive integer.","Let Alice choose the adjacent pair $(a_i, a_{i+1})$ such that $a_i > a_{i+1}$. This pair is replaced by a new pair $(c, a_i)$, where $c$ is either $a_{i+1}+1$ or $a_i-1$. The change in the sum $S$ is given by $\\Delta S = (i c + (i+1) a_i) - (i a_i + (i+1) a_{i+1})$. This simplifies to $\\Delta S = a_i - a_{i+1} + i(c - a_{i+1})$. Since $a_i$ and $a_{i+1}$ are integers with $a_i > a_{i+1}$, we have $a_i - a_{i+1} \\geq 1$. If $c=a_{i+1}+1$, then $c-a_{i+1} = 1 > 0$. If $c=a_i-1$, then $c-a_{i+1} = a_i-a_{i+1}-1 \\geq 1-1=0$. In both cases, $c-a_{i+1} \\ge 0$. Thus, $\\Delta S = (a_i - a_{i+1}) + i(c - a_{i+1}) \\geq 1 + i(0) = 1$. So, $S$ increases by a positive integer with every operation.","Several positive integers are written in a row. Iteratively, Alice chooses two adjacent numbers $x$ and $y$ such that $x>y$ and $x$ is to the left of $y$, and replaces the pair $(x, y)$ by either $(y+1, x)$ or $(x-1, x)$. Prove that she can perform only finitely many such iterations.","Let the sequence of $n$ integers be $a_1, \dots, a_n$, and let $S = \sum_{k=1}^n k a_k$. From the first sub-problem, we know that $S$ strictly increases with each operation. Let $M$ be the maximum value in the initial sequence. An operation on $(x,y)$ with $x>y$ produces either $(y+1, x)$ or $(x-1, x)$. Since $x \ge y+1$, the new values are at most $x$. Therefore, the maximum value in the sequence never increases, so all numbers $a_k$ are bounded by $M$. The sum $S$ is thus bounded above: $S = \sum_{k=1}^n k a_k \leq \sum_{k=1}^n k M = M \frac{n(n+1)}{2}$. We have a strictly increasing sequence of integers $S$ which is bounded above. Such a sequence must be finite. Therefore, the process must terminate after a finite number of steps.",,,,
2012c5,"The columns and the rows of a $3 n \times 3 n$ square board are numbered $1,2, \ldots, 3 n$. Every square ( $x, y$ ) with $1 \leq x, y \leq 3 n$ is colored asparagus, byzantium or citrine according as the modulo 3 remainder of $x+y$ is 0,1 or 2 respectively. One token colored asparagus, byzantium or citrine is placed on each square, so that there are $3 n^{2}$ tokens of each color.

Suppose that one can permute the tokens so that each token is moved to a distance of at most $d$ from its original position, each asparagus token replaces a byzantium token, each byzantium token replaces a citrine token, and each citrine token replaces an asparagus token. Prove that it is possible to permute the tokens so that each token is moved to a distance of at most $d+2$ from its original position, and each square contains a token with the same color as the square.","Solution. Without loss of generality it suffices to prove that the A-tokens can be moved to distinct A-squares in such a way that each A -token is moved to a distance at most $d+2$ from its original place. This means we need a perfect matching between the $3 n^{2} \mathrm{~A}$-squares and the $3 n^{2}$ A-tokens such that the distance in each pair of the matching is at most $d+2$.

To find the matching, we construct a bipartite graph. The A-squares will be the vertices in one class of the graph; the vertices in the other class will be the A-tokens.

Split the board into $3 \times 1$ horizontal triminos; then each trimino contains exactly one Asquare. Take a permutation $\pi$ of the tokens which moves A-tokens to B-tokens, B-tokens to C-tokens, and C-tokens to A-tokens, in each case to a distance at most $d$. For each A-square $S$, and for each A-token $T$, connect $S$ and $T$ by an edge if $T, \pi(T)$ or $\pi^{-1}(T)$ is on the trimino containing $S$. We allow multiple edges; it is even possible that the same square and the same token are connected with three edges. Obviously the lengths of the edges in the graph do not exceed $d+2$. By length of an edge we mean the distance between the A -square and the A -token it connects.

Each A-token $T$ is connected with the three A-squares whose triminos contain $T, \pi(T)$ and $\pi^{-1}(T)$. Therefore in the graph all tokens are of degree 3 . We show that the same is true for the A-squares. Let $S$ be an arbitrary A-square, and let $T_{1}, T_{2}, T_{3}$ be the three tokens on the trimino containing $S$. For $i=1,2,3$, if $T_{i}$ is an A-token, then $S$ is connected with $T_{i}$; if $T_{i}$ is a B-token then $S$ is connected with $\pi^{-1}\left(T_{i}\right)$; finally, if $T_{i}$ is a C-token then $S$ is connected with $\pi\left(T_{i}\right)$. Hence in the graph the A-squares also are of degree 3.

Since the A-squares are of degree 3 , from every set $\mathcal{S}$ of A-squares exactly $3|\mathcal{S}|$ edges start. These edges end in at least $|\mathcal{S}|$ tokens because the A-tokens also are of degree 3. Hence every set $\mathcal{S}$ of A-squares has at least $|\mathcal{S}|$ neighbors among the A-tokens.

Therefore, by Hall's marriage theorem, the graph contains a perfect matching between the two vertex classes. So there is a perfect matching between the A-squares and A-tokens with edges no longer than $d+2$. It follows that the tokens can be permuted as specified in the problem statement.

Comment 1. In the original problem proposal the board was infinite and there were only two colors. Having $n$ colors for some positive integer $n$ was an option; we chose $n=3$. Moreover, we changed the board to a finite one to avoid dealing with infinite graphs (although Hall's theorem works in the infinite case as well).

With only two colors Hall's theorem is not needed. In this case we split the board into $2 \times 1$ dominos, and in the resulting graph all vertices are of degree 2 . The graph consists of disjoint cycles with even length and infinite paths, so the existence of the matching is trivial.

Having more than three colors would make the problem statement more complicated, because we need a matching between every two color classes of tokens. However, this would not mean a significant increase in difficulty.

Comment 2. According to Wikipedia, the color asparagus (hexadecimal code \#87A96B) is a tone of green that is named after the vegetable. Crayola created this color in 1993 as one of the 16 to be named in the Name The Color Contest. Byzantium (\#702963) is a dark tone of purple. Its first recorded use as a color name in English was in 1926. Citrine (\#E4D00A) is variously described as yellow, greenish-yellow, brownish-yellow or orange. The first known use of citrine as a color name in English was in the 14th century.",4,"Show that the problem can be solved by demonstrating the existence of a perfect matching between the set of asparagus tokens and the set of asparagus squares, where the distance between any matched token's original position and its assigned square is at most $d+2$.","The problem requires assigning each token to a square of its own color. This can be decomposed into three independent assignment problems, one for each color. For asparagus tokens, we must map each of the $3n^2$ tokens to a unique asparagus-colored square. This is equivalent to finding a perfect matching. If such a matching exists with a maximum distance of $d+2$ for each pair, the same argument holds for byzantium and citrine tokens by symmetry, thus solving the overall problem.",Construct a bipartite graph between asparagus squares and asparagus tokens and show that the edges correspond to token-to-square assignments with a maximum distance of $d+2$.,"Define a bipartite graph with vertices representing the $3n^2$ asparagus squares on one side and the $3n^2$ asparagus tokens on the other. Tile the board with $3 \times 1$ horizontal triminos; each contains exactly one asparagus square. An edge connects an asparagus square $S$ to an asparagus token $T$ if the trimino containing $S$ also contains the original position of either $T$, $\pi(T)$ (a byzantium token), or $\pi^{-1}(T)$ (a citrine token). The distance between the original position of $T$ and $S$ is at most $2$ if $pos(T)$ is in the trimino, and at most $d+2$ otherwise, by the triangle inequality and the fact that the permutation $\pi$ moves tokens by at most distance $d$.",Prove that every vertex in the constructed bipartite graph has a degree of exactly 3.,"For any asparagus token $T$, the positions $pos(T)$, $pos(\pi(T))$, and $pos(\pi^{-1}(T))$ each lie in a unique trimino, which in turn contains a unique asparagus square. Thus, each token vertex is connected to three square vertices (edges counted with multiplicity). For any asparagus square $S$, its trimino contains three tokens. Each of these tokens corresponds to a unique edge connected to $S$ via a related asparagus token: the token itself if it's asparagus; $\pi^{-1}(T_B)$ if it's a byzantium token $T_B$; or $\pi(T_C)$ if it's a citrine token $T_C$. Thus, each square vertex also has degree 3.","Prove that it is possible to permute the tokens so that each token is moved to a distance of at most $d+2$ from its original position, and each square contains a token with the same color as the square.","The constructed graph is a 3-regular bipartite graph with two partitions of equal size. For any subset of square vertices $\mathcal{S}$, the number of edges leaving $\mathcal{S}$ is $3|\mathcal{S}|$. These edges connect to a set of neighboring token vertices $N(\mathcal{S})$, so $3|\mathcal{S}| \le \sum_{v \in N(\mathcal{S})} \deg(v) = 3|N(\mathcal{S})|$. This implies $|\mathcal{S}| \le |N(\mathcal{S})|$, satisfying Hall's condition. Therefore, a perfect matching exists between asparagus tokens and squares with edge distances at most $d+2$. This argument applies to all three colors, so the desired global permutation exists."
2012c6,"Let $k$ and $n$ be fixed positive integers. In the liar's guessing game, Amy chooses integers $x$ and $N$ with $1 \leq x \leq N$. She tells Ben what $N$ is, but not what $x$ is. Ben may then repeatedly ask Amy whether $x \in S$ for arbitrary sets $S$ of integers. Amy will always answer with yes or no, but she might lie. The only restriction is that she can lie at most $k$ times in a row. After he has asked as many questions as he wants, Ben must specify a set of at most $n$ positive integers. If $x$ is in this set he wins; otherwise, he loses. Prove that:\\
a) If $n \geq 2^{k}$ then Ben can always win.\\
b) For sufficiently large $k$ there exist $n \geq 1.99^{k}$ such that Ben cannot guarantee a win.","Solution. Consider an answer $A \in\{y e s, n o\}$ to a question of the kind ""Is $x$ in the set $S$ ?"" We say that $A$ is inconsistent with a number $i$ if $A=$ yes and $i \notin S$, or if $A=n o$ and $i \in S$. Observe that an answer inconsistent with the target number $x$ is a lie.\\
a) Suppose that Ben has determined a set $T$ of size $m$ that contains $x$. This is true initially with $m=N$ and $T=\{1,2, \ldots, N\}$. For $m>2^{k}$ we show how Ben can find a number $y \in T$ that is different from $x$. By performing this step repeatedly he can reduce $T$ to be of size $2^{k} \leq n$ and thus win.

Since only the size $m>2^{k}$ of $T$ is relevant, assume that $T=\left\{0,1, \ldots, 2^{k}, \ldots, m-1\right\}$. Ben begins by asking repeatedly whether $x$ is $2^{k}$. If Amy answers no $k+1$ times in a row, one of these answers is truthful, and so $x \neq 2^{k}$. Otherwise Ben stops asking about $2^{k}$ at the first answer yes. He then asks, for each $i=1, \ldots, k$, if the binary representation of $x$ has a 0 in the $i$ th digit. Regardless of what the $k$ answers are, they are all inconsistent with a certain number $y \in\left\{0,1, \ldots, 2^{k}-1\right\}$. The preceding answer yes about $2^{k}$ is also inconsistent with $y$. Hence $y \neq x$. Otherwise the last $k+1$ answers are not truthful, which is impossible.

Either way, Ben finds a number in $T$ that is different from $x$, and the claim is proven.\\
b) We prove that if $1<\lambda<2$ and $n=\left\lfloor(2-\lambda) \lambda^{k+1}\right\rfloor-1$ then Ben cannot guarantee a win. To complete the proof, then it suffices to take $\lambda$ such that $1.99<\lambda<2$ and $k$ large enough so that

$$
n=\left\lfloor(2-\lambda) \lambda^{k+1}\right\rfloor-1 \geq 1.99^{k} .
$$

Consider the following strategy for Amy. First she chooses $N=n+1$ and $x \in\{1,2, \ldots, n+1\}$ arbitrarily. After every answer of hers Amy determines, for each $i=1,2, \ldots, n+1$, the number $m_{i}$ of consecutive answers she has given by that point that are inconsistent with $i$. To decide on her next answer, she then uses the quantity

$$
\phi=\sum_{i=1}^{n+1} \lambda^{m_{i}} .
$$

No matter what Ben's next question is, Amy chooses the answer which minimizes $\phi$.\\
We claim that with this strategy $\phi$ will always stay less than $\lambda^{k+1}$. Consequently no exponent $m_{i}$ in $\phi$ will ever exceed $k$, hence Amy will never give more than $k$ consecutive answers inconsistent with some $i$. In particular this applies to the target number $x$, so she will never lie more than $k$ times in a row. Thus, given the claim, Amy's strategy is legal. Since the strategy does not depend on $x$ in any way, Ben can make no deductions about $x$, and therefore he cannot guarantee a win.

It remains to show that $\phi<\lambda^{k+1}$ at all times. Initially each $m_{i}$ is 0 , so this condition holds in the beginning due to $1<\lambda<2$ and $n=\left\lfloor(2-\lambda) \lambda^{k+1}\right\rfloor-1$. Suppose that $\phi<\lambda^{k+1}$ at some point, and Ben has just asked if $x \in S$ for some set $S$. According as Amy answers yes or no, the new value of $\phi$ becomes

$$
\phi_{1}=\sum_{i \in S} 1+\sum_{i \notin S} \lambda^{m_{i}+1} \quad \text { or } \quad \phi_{2}=\sum_{i \in S} \lambda^{m_{i}+1}+\sum_{i \notin S} 1 .
$$

Since Amy chooses the option minimizing $\phi$, the new $\phi$ will equal $\min \left(\phi_{1}, \phi_{2}\right)$. Now we have

$$
\min \left(\phi_{1}, \phi_{2}\right) \leq \frac{1}{2}\left(\phi_{1}+\phi_{2}\right)=\frac{1}{2}\left(\sum_{i \in S}\left(1+\lambda^{m_{i}+1}\right)+\sum_{i \notin S}\left(\lambda^{m_{i}+1}+1\right)\right)=\frac{1}{2}(\lambda \phi+n+1)
$$

Because $\phi<\lambda^{k+1}$, the assumptions $\lambda<2$ and $n=\left\lfloor(2-\lambda) \lambda^{k+1}\right\rfloor-1$ lead to

$$
\min \left(\phi_{1}, \phi_{2}\right)<\frac{1}{2}\left(\lambda^{k+2}+(2-\lambda) \lambda^{k+1}\right)=\lambda^{k+1}
$$

The claim follows, which completes the solution.

Comment. Given a fixed $k$, let $f(k)$ denote the minimum value of $n$ for which Ben can guarantee a victory. The problem asks for a proof that for large $k$

$$
1.99^{k} \leq f(k) \leq 2^{k}
$$

A computer search shows that $f(k)=2,3,4,7,11,17$ for $k=1,2,3,4,5,6$.",1,"Let $k$ and $n$ be fixed positive integers. In the liar's guessing game, Amy chooses integers $x$ and $N$ with $1 \leq x \leq N$. She tells Ben what $N$ is, but not what $x$ is. Ben may then repeatedly ask Amy whether $x \in S$ for arbitrary sets $S$ of integers. Amy will always answer with yes or no, but she might lie. The only restriction is that she can lie at most $k$ times in a row. After he has asked as many questions as he wants, Ben must specify a set of at most $n$ positive integers. If $x$ is in this set he wins; otherwise, he loses. Prove that:\\
a) If $n \geq 2^{k}$ then Ben can always win.\\
b) For sufficiently large $k$ there exist $n \geq 1.99^{k}$ such that Ben cannot guarantee a win.","Solution. Consider an answer $A \in\{y e s, n o\}$ to a question of the kind ""Is $x$ in the set $S$ ?"" We say that $A$ is inconsistent with a number $i$ if $A=$ yes and $i \notin S$, or if $A=n o$ and $i \in S$. Observe that an answer inconsistent with the target number $x$ is a lie.\\
a) Suppose that Ben has determined a set $T$ of size $m$ that contains $x$. This is true initially with $m=N$ and $T=\{1,2, \ldots, N\}$. For $m>2^{k}$ we show how Ben can find a number $y \in T$ that is different from $x$. By performing this step repeatedly he can reduce $T$ to be of size $2^{k} \leq n$ and thus win.

Since only the size $m>2^{k}$ of $T$ is relevant, assume that $T=\left\{0,1, \ldots, 2^{k}, \ldots, m-1\right\}$. Ben begins by asking repeatedly whether $x$ is $2^{k}$. If Amy answers no $k+1$ times in a row, one of these answers is truthful, and so $x \neq 2^{k}$. Otherwise Ben stops asking about $2^{k}$ at the first answer yes. He then asks, for each $i=1, \ldots, k$, if the binary representation of $x$ has a 0 in the $i$ th digit. Regardless of what the $k$ answers are, they are all inconsistent with a certain number $y \in\left\{0,1, \ldots, 2^{k}-1\right\}$. The preceding answer yes about $2^{k}$ is also inconsistent with $y$. Hence $y \neq x$. Otherwise the last $k+1$ answers are not truthful, which is impossible.

Either way, Ben finds a number in $T$ that is different from $x$, and the claim is proven.\\
b) We prove that if $1<\lambda<2$ and $n=\left\lfloor(2-\lambda) \lambda^{k+1}\right\rfloor-1$ then Ben cannot guarantee a win. To complete the proof, then it suffices to take $\lambda$ such that $1.99<\lambda<2$ and $k$ large enough so that

$$
n=\left\lfloor(2-\lambda) \lambda^{k+1}\right\rfloor-1 \geq 1.99^{k} .
$$

Consider the following strategy for Amy. First she chooses $N=n+1$ and $x \in\{1,2, \ldots, n+1\}$ arbitrarily. After every answer of hers Amy determines, for each $i=1,2, \ldots, n+1$, the number $m_{i}$ of consecutive answers she has given by that point that are inconsistent with $i$. To decide on her next answer, she then uses the quantity

$$
\phi=\sum_{i=1}^{n+1} \lambda^{m_{i}} .
$$

No matter what Ben's next question is, Amy chooses the answer which minimizes $\phi$.\\
We claim that with this strategy $\phi$ will always stay less than $\lambda^{k+1}$. Consequently no exponent $m_{i}$ in $\phi$ will ever exceed $k$, hence Amy will never give more than $k$ consecutive answers inconsistent with some $i$. In particular this applies to the target number $x$, so she will never lie more than $k$ times in a row. Thus, given the claim, Amy's strategy is legal. Since the strategy does not depend on $x$ in any way, Ben can make no deductions about $x$, and therefore he cannot guarantee a win.

It remains to show that $\phi<\lambda^{k+1}$ at all times. Initially each $m_{i}$ is 0 , so this condition holds in the beginning due to $1<\lambda<2$ and $n=\left\lfloor(2-\lambda) \lambda^{k+1}\right\rfloor-1$. Suppose that $\phi<\lambda^{k+1}$ at some point, and Ben has just asked if $x \in S$ for some set $S$. According as Amy answers yes or no, the new value of $\phi$ becomes

$$
\phi_{1}=\sum_{i \in S} 1+\sum_{i \notin S} \lambda^{m_{i}+1} \quad \text { or } \quad \phi_{2}=\sum_{i \in S} \lambda^{m_{i}+1}+\sum_{i \notin S} 1 .
$$

Since Amy chooses the option minimizing $\phi$, the new $\phi$ will equal $\min \left(\phi_{1}, \phi_{2}\right)$. Now we have

$$
\min \left(\phi_{1}, \phi_{2}\right) \leq \frac{1}{2}\left(\phi_{1}+\phi_{2}\right)=\frac{1}{2}\left(\sum_{i \in S}\left(1+\lambda^{m_{i}+1}\right)+\sum_{i \notin S}\left(\lambda^{m_{i}+1}+1\right)\right)=\frac{1}{2}(\lambda \phi+n+1)
$$

Because $\phi<\lambda^{k+1}$, the assumptions $\lambda<2$ and $n=\left\lfloor(2-\lambda) \lambda^{k+1}\right\rfloor-1$ lead to

$$
\min \left(\phi_{1}, \phi_{2}\right)<\frac{1}{2}\left(\lambda^{k+2}+(2-\lambda) \lambda^{k+1}\right)=\lambda^{k+1}
$$

The claim follows, which completes the solution.

Comment. Given a fixed $k$, let $f(k)$ denote the minimum value of $n$ for which Ben can guarantee a victory. The problem asks for a proof that for large $k$

$$
1.99^{k} \leq f(k) \leq 2^{k}
$$

A computer search shows that $f(k)=2,3,4,7,11,17$ for $k=1,2,3,4,5,6$.",,,,,,
2012c7,"There are given $2^{500}$ points on a circle labeled $1,2, \ldots, 2^{500}$ in some order. Prove that one can choose 100 pairwise disjoint chords joining some of these points so that the 100 sums of the pairs of numbers at the endpoints of the chosen chords are equal.","Solution. The proof is based on the following general fact.\\
Lemma. In a graph $G$ each vertex $v$ has degree $d_{v}$. Then $G$ contains an independent set $S$ of vertices such that $|S| \geq f(G)$ where

$$
f(G)=\sum_{v \in G} \frac{1}{d_{v}+1} .
$$

Proof. Induction on $n=|G|$. The base $n=1$ is clear. For the inductive step choose a vertex $v_{0}$ in $G$ of minimum degree $d$. Delete $v_{0}$ and all of its neighbors $v_{1}, \ldots, v_{d}$ and also all edges with endpoints $v_{0}, v_{1}, \ldots, v_{d}$. This gives a new graph $G^{\prime}$. By the inductive assumption $G^{\prime}$ contains an independent set $S^{\prime}$ of vertices such that $\left|S^{\prime}\right| \geq f\left(G^{\prime}\right)$. Since no vertex in $S^{\prime}$ is a neighbor of $v_{0}$ in $G$, the set $S=S^{\prime} \cup\left\{v_{0}\right\}$ is independent in $G$.

Let $d_{v}^{\prime}$ be the degree of a vertex $v$ in $G^{\prime}$. Clearly $d_{v}^{\prime} \leq d_{v}$ for every such vertex $v$, and also $d_{v_{i}} \geq d$ for all $i=0,1, \ldots, d$ by the minimal choice of $v_{0}$. Therefore

$$
f\left(G^{\prime}\right)=\sum_{v \in G^{\prime}} \frac{1}{d_{v}^{\prime}+1} \geq \sum_{v \in G^{\prime}} \frac{1}{d_{v}+1}=f(G)-\sum_{i=0}^{d} \frac{1}{d_{v_{i}}+1} \geq f(G)-\frac{d+1}{d+1}=f(G)-1 .
$$

Hence $|S|=\left|S^{\prime}\right|+1 \geq f\left(G^{\prime}\right)+1 \geq f(G)$, and the induction is complete.\\
We pass on to our problem. For clarity denote $n=2^{499}$ and draw all chords determined by the given $2 n$ points. Color each chord with one of the colors $3,4, \ldots, 4 n-1$ according to the sum of the numbers at its endpoints. Chords with a common endpoint have different colors. For each color $c$ consider the following graph $G_{c}$. Its vertices are the chords of color $c$, and two chords are neighbors in $G_{c}$ if they intersect. Let $f\left(G_{c}\right)$ have the same meaning as in the lemma for all graphs $G_{c}$.

Every chord $\ell$ divides the circle into two arcs, and one of them contains $m(\ell) \leq n-1$ given points. (In particular $m(\ell)=0$ if $\ell$ joins two consecutive points.) For each $i=0,1, \ldots, n-2$ there are $2 n$ chords $\ell$ with $m(\ell)=i$. Such a chord has degree at most $i$ in the respective graph. Indeed let $A_{1}, \ldots, A_{i}$ be all points on either arc determined by a chord $\ell$ with $m(\ell)=i$ and color $c$. Every $A_{j}$ is an endpoint of at most 1 chord colored $c, j=1, \ldots, i$. Hence at most $i$ chords of color $c$ intersect $\ell$.

It follows that for each $i=0,1, \ldots, n-2$ the $2 n$ chords $\ell$ with $m(\ell)=i$ contribute at least $\frac{2 n}{i+1}$ to the sum $\sum_{c} f\left(G_{c}\right)$. Summation over $i=0,1, \ldots, n-2$ gives

$$
\sum_{c} f\left(G_{c}\right) \geq 2 n \sum_{i=1}^{n-1} \frac{1}{i}
$$

Because there are $4 n-3$ colors in all, averaging yields a color $c$ such that

$$
f\left(G_{c}\right) \geq \frac{2 n}{4 n-3} \sum_{i=1}^{n-1} \frac{1}{i}>\frac{1}{2} \sum_{i=1}^{n-1} \frac{1}{i}
$$

By the lemma there are at least $\frac{1}{2} \sum_{i=1}^{n-1} \frac{1}{i}$ pairwise disjoint chords of color $c$, i. e. with the same sum $c$ of the pairs of numbers at their endpoints. It remains to show that $\frac{1}{2} \sum_{i=1}^{n-1} \frac{1}{i} \geq 100$ for $n=2^{499}$. Indeed we have

$$
\sum_{i=1}^{n-1} \frac{1}{i}>\sum_{i=1}^{2^{400}} \frac{1}{i}=1+\sum_{k=1}^{400} \sum_{i=2^{k-1+1}}^{2^{k}} \frac{1}{i}>1+\sum_{k=1}^{400} \frac{2^{k-1}}{2^{k}}=201>200
$$

This completes the solution.",4,"Prove that for any graph G with vertices V and vertex degrees d_v, there exists an independent set S (a set of vertices where no two are adjacent) such that its size satisfies |S| ≥ Σ_{v∈V} 1/(d_v + 1).","The proof is by induction on the number of vertices n. The base case n=1 is trivial. For the inductive step, let v₀ be a vertex with the minimum degree d. Remove v₀ and its neighbors to form a subgraph G'. By the induction hypothesis, G' has an independent set S' with |S'| ≥ Σ_{v∈G'} 1/(d'_v + 1). The set S = S' ∪ {v₀} is an independent set in G. We have |S| = |S'| + 1. The sum for G' can be related to the sum for G: Σ_{v∈G'} 1/(d'_v + 1) ≥ Σ_{v∈G'} 1/(d_v + 1) ≥ (Σ_{v∈G} 1/(d_v + 1)) - (d+1)/(d+1) = (Σ_{v∈G} 1/(d_v + 1)) - 1. Therefore, |S| ≥ (Σ_{v∈G} 1/(d_v + 1) - 1) + 1 = Σ_{v∈G} 1/(d_v + 1), completing the induction.","Model the problem of finding disjoint chords with equal endpoint sums using graph theory. For each possible sum c, define a graph G_c and relate the problem to finding a large independent set in one of these graphs.","Let the 2n = 2⁵⁰⁰ points be labeled. For each possible sum c of endpoint labels, construct a graph G_c. The vertices of G_c are the chords whose endpoints' labels sum to c. Two vertices are connected by an edge if their corresponding chords intersect. A set of pairwise disjoint chords with endpoint sum c corresponds to an independent set in the graph G_c. The problem is equivalent to proving that for some sum c, the graph G_c has an independent set of size at least 100.",Let n = 2⁴⁹⁹. Show that there exists a sum c for which the corresponding graph G_c (as defined in sub-problem 2) must have an independent set of size at least (1/2) * Σ_{i=1}^{n-1} (1/i).,"Let a chord ℓ define a smaller arc with m(ℓ) points on it. The degree of the vertex for ℓ in its graph G_c is at most m(ℓ), as an intersecting chord of the same color must have an endpoint on that arc. For each i in {0, ..., n-2}, there are 2n chords ℓ with m(ℓ)=i. The sum of f(G_c) = Σ_{v∈G_c} 1/(d_v+1) over all possible sums c is at least Σ_{i=0}^{n-2} 2n/(i+1) = 2n Σ_{j=1}^{n-1} 1/j. Since there are at most 4n-3 possible sums, by averaging, there exists a sum c for which f(G_c) ≥ (2n / (4n-3)) * Σ_{j=1}^{n-1} 1/j > (1/2) * Σ_{j=1}^{n-1} 1/j. By the result from sub-problem 1, G_c has an independent set of at least this size.","There are given 2⁵⁰⁰ points on a circle labeled 1,2, ..., 2⁵⁰⁰ in some order. Prove that one can choose 100 pairwise disjoint chords joining some of these points so that the 100 sums of the pairs of numbers at the endpoints of the chosen chords are equal.","From the previous steps, with n=2⁴⁹⁹, we can find a set of at least N = (1/2) * Σ_{i=1}^{n-1} (1/i) disjoint chords with the same endpoint sum. We must show N ≥ 100. The sum is a partial harmonic series, which we can bound: Σ_{i=1}^{n-1} (1/i) > Σ_{i=1}^{2⁴⁰⁰} (1/i). We can group terms of the latter sum: 1 + Σ_{k=1}^{400} Σ_{j=2^{k-1}+1}^{2^k} (1/j). Each of the 2^{k-1} terms in the inner sum is greater than 1/2^k, so the inner sum is greater than 2^{k-1} * (1/2^k) = 1/2. Thus, Σ_{i=1}^{2⁴⁰⁰} (1/i) > 1 + Σ_{k=1}^{400} (1/2) = 1 + 200 = 201. Therefore, N > (1/2) * 201 = 100.5. Since the number of chords must be an integer, there are at least 101 such chords, which is more than 100."
2012g1,"In the triangle $A B C$ the point $J$ is the center of the excircle opposite to $A$. This excircle is tangent to the side $B C$ at $M$, and to the lines $A B$ and $A C$ at $K$ and $L$ respectively. The lines $L M$ and $B J$ meet at $F$, and the lines $K M$ and $C J$ meet at $G$. Let $S$ be the point of intersection of the lines $A F$ and $B C$, and let $T$ be the point of intersection of the lines $A G$ and $B C$. Prove that $M$ is the midpoint of $S T$.","Solution. Let $\alpha=\angle C A B, \beta=\angle A B C$ and $\gamma=\angle B C A$. The line $A J$ is the bisector of $\angle C A B$, so $\angle J A K=\angle J A L=\frac{\alpha}{2}$. By $\angle A K J=\angle A L J=90^{\circ}$ the points $K$ and $L$ lie on the circle $\omega$ with diameter $A J$.

The triangle $K B M$ is isosceles as $B K$ and $B M$ are tangents to the excircle. Since $B J$ is the bisector of $\angle K B M$, we have $\angle M B J=90^{\circ}-\frac{\beta}{2}$ and $\angle B M K=\frac{\beta}{2}$. Likewise $\angle M C J=90^{\circ}-\frac{\gamma}{2}$ and $\angle C M L=\frac{\gamma}{2}$. Also $\angle B M F=\angle C M L$, therefore

$$
\angle L F J=\angle M B J-\angle B M F=\left(90^{\circ}-\frac{\beta}{2}\right)-\frac{\gamma}{2}=\frac{\alpha}{2}=\angle L A J .
$$

Hence $F$ lies on the circle $\omega$. (By the angle computation, $F$ and $A$ are on the same side of $B C$.) Analogously, $G$ also lies on $\omega$. Since $A J$ is a diameter of $\omega$, we obtain $\angle A F J=\angle A G J=90^{\circ}$.\\
\includegraphics[max width=\textwidth, center]{2025_05_04_da9ecbcd73427ebbc2afg-29}

The lines $A B$ and $B C$ are symmetric with respect to the external bisector $B F$. Because $A F \perp B F$ and $K M \perp B F$, the segments $S M$ and $A K$ are symmetric with respect to $B F$, hence $S M=A K$. By symmetry $T M=A L$. Since $A K$ and $A L$ are equal as tangents to the excircle, it follows that $S M=T M$, and the proof is complete.

Comment. After discovering the circle $A F K J L G$, there are many other ways to complete the solution. For instance, from the cyclic quadrilaterals $J M F S$ and $J M G T$ one can find $\angle T S J=\angle S T J=\frac{\alpha}{2}$. Another possibility is to use the fact that the lines $A S$ and $G M$ are parallel (both are perpendicular to the external angle bisector $B J$ ), so $\frac{M S}{M T}=\frac{A G}{G T}=1$.",3,"Prove that the points A, F, G, K, L, J all lie on a single circle with diameter AJ.","Let $\alpha, \beta, \gamma$ be the angles of $\triangle ABC$. Since J is the excenter opposite A, J is the intersection of the internal angle bisector of $\angle A$ and the external angle bisectors of $\angle B$ and $\angle C$. As K and L are tangency points, $\angle AKJ = \angle ALJ = 90^\circ$, so K and L lie on the circle $\omega$ with diameter AJ. The line BJ externally bisects $\angle ABC$, so $\angle MBJ = (180^\circ - \beta)/2 = 90^\circ - \beta/2$. Since $\triangle BKM$ is isosceles with $BK=BM$, $\angle BMK = \beta/2$. Similarly, $\angle CML = \gamma/2$. Angles $\angle BMF$ and $\angle CML$ are vertically opposite, so $\angle BMF = \gamma/2$. In $\triangle FBM$, the exterior angle at J is $\angle MBJ = \angle BFM + \angle BMF$, so $\angle LFJ = \angle BFM = (90^\circ - \beta/2) - \gamma/2 = (180^\circ - \beta - \gamma)/2 = \alpha/2$. Since $\angle LAJ = \alpha/2$, F must lie on the circle passing through A, L, J, which is $\omega$. An analogous argument for G shows it also lies on $\omega$. Thus, A, F, G, K, L, J are concyclic on $\omega$.",Show that $SM = AK$ and $TM = AL$.,"From the previous result, points F and G lie on the circle with diameter AJ. This implies that $\angle AFJ = 90^\circ$ and $\angle AGJ = 90^\circ$. Since F lies on BJ and G lies on CJ, we have $AF \perp BJ$ and $AG \perp CJ$. Consider the reflection across the line BJ, which is the external bisector of $\angle ABC$. This reflection maps line BC to line BA, and point M on BC to point K on BA (since $BM=BK$). The line AF is perpendicular to the axis of reflection BJ, so it is mapped to itself. The point S is the intersection of AF and BC. Its reflection is the intersection of the reflection of AF (itself) and the reflection of BC (line BA), which is point A. Since reflection is an isometry, it preserves distances. Therefore, the length of segment SM equals the length of its reflection, segment AK, so $SM = AK$. By a symmetric argument, reflecting across the line CJ shows that $TM = AL$.",Prove that M is the midpoint of ST.,"From the second sub-problem, we established that $SM = AK$ and $TM = AL$. The segments AK and AL are tangents from the point A to the excircle centered at J. A fundamental property of tangents states that tangent segments from an external point to a circle are equal in length. Therefore, $AK = AL$. Combining these equalities, we get $SM = TM$. Since S, T, and M are collinear points on the line BC, the equality of the lengths of the segments SM and TM implies that M is the midpoint of the segment ST.",,
2012g2,"Let $A B C D$ be a cyclic quadrilateral whose diagonals $A C$ and $B D$ meet at $E$. The extensions of the sides $A D$ and $B C$ beyond $A$ and $B$ meet at $F$. Let $G$ be the point such that $E C G D$ is a parallelogram, and let $H$ be the image of $E$ under reflection in $A D$. Prove that $D, H, F, G$ are concyclic.","Solution. We show first that the triangles $F D G$ and $F B E$ are similar. Since $A B C D$ is cyclic, the triangles $E A B$ and $E D C$ are similar, as well as $F A B$ and $F C D$. The parallelogram $E C G D$ yields $G D=E C$ and $\angle C D G=\angle D C E$; also $\angle D C E=\angle D C A=\angle D B A$ by inscribed angles. Therefore

$$
\begin{gathered}
\angle F D G=\angle F D C+\angle C D G=\angle F B A+\angle A B D=\angle F B E \\
\frac{G D}{E B}=\frac{C E}{E B}=\frac{C D}{A B}=\frac{F D}{F B}
\end{gathered}
$$

It follows that $F D G$ and $F B E$ are similar, and so $\angle F G D=\angle F E B$.\\
\includegraphics[max width=\textwidth, center]{2025_05_04_da9ecbcd73427ebbc2afg-30}

Since $H$ is the reflection of $E$ with respect to $F D$, we conclude that

$$
\angle F H D=\angle F E D=180^{\circ}-\angle F E B=180^{\circ}-\angle F G D
$$

This proves that $D, H, F, G$ are concyclic.

Comment. Points $E$ and $G$ are always in the half-plane determined by the line $F D$ that contains $B$ and $C$, but $H$ is always in the other half-plane. In particular, $D H F G$ is cyclic if and only if $\angle F H D+\angle F G D=180^{\circ}$.",2,"Prove that triangle $FDG$ is similar to triangle $FBE$, and as a consequence, show that $\angle F G D=\angle F E B$.","Since $A B C D$ is a cyclic quadrilateral, we have $\triangle F A B \sim \triangle F C D$ and $\triangle E A B \sim \triangle E D C$. From these similarities, we get the ratios $\frac{F D}{F B}=\frac{C D}{A B}$ and $\frac{C E}{E B}=\frac{C D}{A B}$. Since $E C G D$ is a parallelogram, $G D=E C$. Combining the ratios gives $\frac{G D}{E B}=\frac{F D}{F B}$. For the angles, we have $\angle F D G=\angle F D C+\angle C D G$. The parallelogram property gives $\angle C D G = \angle DCE$. The cyclic quadrilateral gives $\angle FDC = \angle FBA$ and $\angle DCE = \angle DCA = \angle DBA$. Therefore, $\angle F D G=\angle F B A+\angle D B A=\angle F B E$. By the Side-Angle-Side similarity criterion, $\triangle F D G \sim \triangle F B E$. A direct consequence is that corresponding angles are equal, so $\angle F G D=\angle F E B$.","Prove that $D, H, F, G$ are concyclic.","From the first sub-problem, we established that $\angle F G D=\angle F E B$. H is the reflection of E in the line AD (which is the same line as FD). Reflection is an isometry, so it preserves angles, meaning $\angle F H D=\angle F E D$. The angles $\angle FED$ and $\angle FEB$ lie on the straight line BD, so they are supplementary, i.e., $\angle F E D=180^{\circ}-\angle F E B$. By substitution, we have $\angle F H D=180^{\circ}-\angle F G D$, which can be rewritten as $\angle F H D+\angle F G D=180^{\circ}$. Since the opposite angles of the quadrilateral $D H F G$ sum to $180^{\circ}$, the points $D, H, F, G$ are concyclic.",,,,
2012g3,"In an acute triangle $A B C$ the points $D, E$ and $F$ are the feet of the altitudes through $A$, $B$ and $C$ respectively. The incenters of the triangles $A E F$ and $B D F$ are $I_{1}$ and $I_{2}$ respectively; the circumcenters of the triangles $A C I_{1}$ and $B C I_{2}$ are $O_{1}$ and $O_{2}$ respectively. Prove that $I_{1} I_{2}$ and $O_{1} O_{2}$ are parallel.","Solution. Let $\angle C A B=\alpha, \angle A B C=\beta, \angle B C A=\gamma$. We start by showing that $A, B, I_{1}$ and $I_{2}$ are concyclic. Since $A I_{1}$ and $B I_{2}$ bisect $\angle C A B$ and $\angle A B C$, their extensions beyond $I_{1}$ and $I_{2}$ meet at the incenter $I$ of the triangle. The points $E$ and $F$ are on the circle with diameter $B C$, so $\angle A E F=\angle A B C$ and $\angle A F E=\angle A C B$. Hence the triangles $A E F$ and $A B C$ are similar with ratio of similitude $\frac{A E}{A B}=\cos \alpha$. Because $I_{1}$ and $I$ are their incenters, we obtain $I_{1} A=I A \cos \alpha$ and $I I_{1}=I A-I_{1} A=2 I A \sin ^{2} \frac{\alpha}{2}$. By symmetry $I I_{2}=2 I B \sin ^{2} \frac{\beta}{2}$. The law of sines in the triangle $A B I$ gives $I A \sin \frac{\alpha}{2}=I B \sin \frac{\beta}{2}$. Hence

$$
I I_{1} \cdot I A=2\left(I A \sin \frac{\alpha}{2}\right)^{2}=2\left(I B \sin \frac{\beta}{2}\right)^{2}=I I_{2} \cdot I B
$$

Therefore $A, B, I_{1}$ and $I_{2}$ are concyclic, as claimed.\\
\includegraphics[max width=\textwidth, center]{2025_05_04_da9ecbcd73427ebbc2afg-31}

In addition $I I_{1} \cdot I A=I I_{2} \cdot I B$ implies that $I$ has the same power with respect to the circles $\left(A C I_{1}\right),\left(B C I_{2}\right)$ and $\left(A B I_{1} I_{2}\right)$. Then $C I$ is the radical axis of $\left(A C I_{1}\right)$ and $\left(B C I_{2}\right)$; in particular $C I$ is perpendicular to the line of centers $O_{1} O_{2}$.

Now it suffices to prove that $C I \perp I_{1} I_{2}$. Let $C I$ meet $I_{1} I_{2}$ at $Q$, then it is enough to check that $\angle I I_{1} Q+\angle I_{1} I Q=90^{\circ}$. Since $\angle I_{1} I Q$ is external for the triangle $A C I$, we have

$$
\angle I I_{1} Q+\angle I_{1} I Q=\angle I I_{1} Q+(\angle A C I+\angle C A I)=\angle I I_{1} I_{2}+\angle A C I+\angle C A I .
$$

It remains to note that $\angle I I_{1} I_{2}=\frac{\beta}{2}$ from the cyclic quadrilateral $A B I_{1} I_{2}$, and $\angle A C I=\frac{\gamma}{2}$, $\angle C A I=\frac{\alpha}{2}$. Therefore $\angle I I_{1} Q+\angle I_{1} I Q=\frac{\alpha}{2}+\frac{\beta}{2}+\frac{\gamma}{2}=90^{\circ}$, completing the proof.

Comment. It follows from the first part of the solution that the common point $I_{3} \neq C$ of the circles $\left(A C I_{1}\right)$ and $\left(B C I_{2}\right)$ is the incenter of the triangle $C D E$.",3,"Let $I$ be the incenter of $\triangle ABC$. Prove that the points $A, B, I_{1}, I_{2}$ are concyclic.","The triangles $A E F$ and $A B C$ are similar with ratio $\cos \alpha$. As $I_1$ and $I$ are their respective incenters, and $I, I_1$ lie on the bisector of $\angle A$, we have $I_{1} A=I A \cos \alpha$. This gives $I I_{1}=I A - I_{1} A=I A(1-\cos \alpha)=2 I A \sin ^{2} (\alpha/2)$. Similarly, from the similarity of $\triangle BDF$ and $\triangle BAC$, we get $I I_{2}=2 I B \sin ^{2} (\beta/2)$. The law of sines in $\triangle A B I$ gives $I A \sin (\alpha/2)=I B \sin (\beta/2)$. Therefore, $I I_{1} \cdot I A=2(I A \sin (\alpha/2))^{2}=2(I B \sin (\beta/2))^{2}=I I_{2} \cdot I B$. This equality of the power of point $I$ with respect to a circle passing through $A, B, I_1, I_2$ implies that these four points are concyclic.",Let $I$ be the incenter of $\triangle ABC$. Prove that the line $CI$ is perpendicular to the line of centers $O_{1} O_{2}$.,"The line of centers $O_{1} O_{2}$ is perpendicular to the radical axis of the circles $(A C I_{1})$ and $(B C I_{2})$. Point $C$ lies on both circles. The power of point $I$ with respect to $(A C I_{1})$ is $I I_{1} \cdot I A$, and its power with respect to $(B C I_{2})$ is $I I_{2} \cdot I B$, because $I, I_1, A$ and $I, I_2, B$ are collinear. From the first sub-problem, these powers are equal. Thus, $I$ also lies on the radical axis. The line $CI$ is therefore the radical axis of the two circles. Consequently, $C I \perp O_{1} O_{2}$.",Prove that $I_{1} I_{2}$ and $O_{1} O_{2}$ are parallel.,"From the second sub-problem, $C I \perp O_{1} O_{2}$. We now show $C I \perp I_{1} I_{2}$. Since $A, B, I_1, I_2$ are concyclic, we have $\angle II_1I_2 = \angle ABI_2 = \beta/2$. Let $CI$ intersect $I_1I_2$ at $Q$. In $\triangle II_1Q$, the angle $\angle I_1IQ$ is an exterior angle to $\triangle ACI$, so $\angle I_1IQ = \angle IAC + \angle ICA = \alpha/2 + \gamma/2$. The sum of the other two angles in $\triangle II_1Q$ is $\angle II_1Q + \angle I_1IQ = \beta/2 + (\alpha/2 + \gamma/2) = (\alpha+\beta+\gamma)/2 = 90^\circ$. Therefore, $\angle IQI_1 = 90^\circ$, which means $CI \perp I_1I_2$. Since both $I_1I_2$ and $O_1O_2$ are perpendicular to the same line $CI$, they must be parallel.",,
2012g4,Let $A B C$ be a triangle with $A B \neq A C$ and circumcenter $O$. The bisector of $\angle B A C$ intersects $B C$ at $D$. Let $E$ be the reflection of $D$ with respect to the midpoint of $B C$. The lines through $D$ and $E$ perpendicular to $B C$ intersect the lines $A O$ and $A D$ at $X$ and $Y$ respectively. Prove that the quadrilateral $B X C Y$ is cyclic.,"Solution. The bisector of $\angle B A C$ and the perpendicular bisector of $B C$ meet at $P$, the midpoint of the minor arc $\widehat{B C}$ (they are different lines as $A B \neq A C$ ). In particular $O P$ is perpendicular to $B C$ and intersects it at $M$, the midpoint of $B C$.

Denote by $Y^{\prime}$ the reflexion of $Y$ with respect to $O P$. Since $\angle B Y C=\angle B Y^{\prime} C$, it suffices to prove that $B X C Y^{\prime}$ is cyclic.\\
\includegraphics[max width=\textwidth, center]{2025_05_04_da9ecbcd73427ebbc2afg-32}

We have

$$
\angle X A P=\angle O P A=\angle E Y P .
$$

The first equality holds because $O A=O P$, and the second one because $E Y$ and $O P$ are both perpendicular to $B C$ and hence parallel. But $\left\{Y, Y^{\prime}\right\}$ and $\{E, D\}$ are pairs of symmetric points with respect to $O P$, it follows that $\angle E Y P=\angle D Y^{\prime} P$ and hence

$$
\angle X A P=\angle D Y^{\prime} P=\angle X Y^{\prime} P .
$$

The last equation implies that $X A Y^{\prime} P$ is cyclic. By the powers of $D$ with respect to the circles $\left(X A Y^{\prime} P\right)$ and $(A B P C)$ we obtain

$$
X D \cdot D Y^{\prime}=A D \cdot D P=B D \cdot D C .
$$

It follows that $B X C Y^{\prime}$ is cyclic, as desired.",2,Let $P$ be the point other than $A$ where the bisector of $\angle BAC$ intersects the circumcircle of $\triangle ABC$. Let $Y'$ be the reflection of $Y$ with respect to the perpendicular bisector of $BC$. Prove that $XD \cdot DY' = BD \cdot DC$.,"Let $\ell$ be the perpendicular bisector of $BC$; it passes through the circumcenter $O$ and $P$. In isosceles $\triangle OAP$ ($OA=OP$), we have $\angle XAP = \angle OPA$. The lines $EY$ and $\ell$ are parallel (both are perpendicular to $BC$), so the transversal $AP$ gives $\angle OPA = \angle EYP$. By reflection in $\ell$, $Y$ maps to $Y'$, $E$ maps to $D$, and $P$ is fixed, so $\angle EYP = \angle DY'P$. Thus, $\angle XAP = \angle DY'P$. Points $X, D, Y'$ are collinear on the line through $D$ perpendicular to $BC$, so $\angle DY'P = \angle XY'P$. It follows that $\angle XAP = \angle XY'P$, which proves that the quadrilateral $XAY'P$ is cyclic. By the power of a point theorem for point $D$ with respect to circle $(XAY'P)$, we have $XD \cdot DY' = AD \cdot DP$. For the circumcircle $(ABPC)$, the power of point $D$ gives $AD \cdot DP = BD \cdot DC$. Therefore, $XD \cdot DY' = BD \cdot DC$.",Prove that the quadrilateral $B X C Y$ is cyclic.,"Let $\ell$ be the perpendicular bisector of $BC$ and let $Y'$ be the reflection of $Y$ across $\ell$. From the first sub-problem, we have the relation $XD \cdot DY' = BD \cdot DC$. Since $D$ is the intersection of lines $XY'$ and $BC$, the converse of the power of a point theorem implies that points $B, X, C, Y'$ lie on a circle. Because $Y'$ is the reflection of $Y$ across $\ell$, the perpendicular bisector of the segment $BC$, we have $\triangle BCY \cong \triangle BCY'$, which implies $\angle BYC = \angle BY'C$. The cyclicity of $BXCY'$ means $\angle BXC + \angle BY'C = 180^\circ$. Substituting gives $\angle BXC + \angle BYC = 180^\circ$, which proves that the quadrilateral $BXCY$ is cyclic.",,,,
2012g5,"Let $A B C$ be a triangle with $\angle B C A=90^{\circ}$, and let $C_{0}$ be the foot of the altitude from $C$. Choose a point $X$ in the interior of the segment $C C_{0}$, and let $K, L$ be the points on the segments $A X, B X$ for which $B K=B C$ and $A L=A C$ respectively. Denote by $M$ the intersection of $A L$ and $B K$. Show that $M K=M L$.","Solution. Let $C^{\prime}$ be the reflection of $C$ in the line $A B$, and let $\omega_{1}$ and $\omega_{2}$ be the circles with centers $A$ and $B$, passing through $L$ and $K$ respectively. Since $A C^{\prime}=A C=A L$ and $B C^{\prime}=B C=B K$, both $\omega_{1}$ and $\omega_{2}$ pass through $C$ and $C^{\prime}$. By $\angle B C A=90^{\circ}, A C$ is tangent to $\omega_{2}$ at $C$, and $B C$ is tangent to $\omega_{1}$ at $C$. Let $K_{1} \neq K$ be the second intersection of $A X$ and $\omega_{2}$, and let $L_{1} \neq L$ be the second intersection of $B X$ and $\omega_{1}$.\\
\includegraphics[max width=\textwidth, center]{2025_05_04_da9ecbcd73427ebbc2afg-33}

By the powers of $X$ with respect to $\omega_{2}$ and $\omega_{1}$,

$$
X K \cdot X K_{1}=X C \cdot X C^{\prime}=X L \cdot X L_{1}
$$

so the points $K_{1}, L, K, L_{1}$ lie on a circle $\omega_{3}$.\\
The power of $A$ with respect to $\omega_{2}$ gives

$$
A L^{2}=A C^{2}=A K \cdot A K_{1}
$$

indicating that $A L$ is tangent to $\omega_{3}$ at $L$. Analogously, $B K$ is tangent to $\omega_{3}$ at $K$. Hence $M K$ and $M L$ are the two tangents from $M$ to $\omega_{3}$ and therefore $M K=M L$.",2,"Let $\omega_1$ be the circle centered at A with radius AC, and $\omega_2$ be the circle centered at B with radius BC. Let $L_1 \neq L$ be the second intersection of line BX with $\omega_1$, and $K_1 \neq K$ be the second intersection of line AX with $\omega_2$. Show that the points $K, L, K_1, L_1$ lie on a common circle, say $\omega_3$, and that the lines AL and BK are tangent to $\omega_3$ at points L and K respectively.","Let $C'$ be the reflection of C in the line AB. Since $AL=AC=AC'$ and $BK=BC=BC'$, both $\omega_1$ and $\omega_2$ pass through C and $C'$. The power of point X with respect to $\omega_2$ is $XK \cdot XK_1 = XC \cdot XC'$. Similarly, the power of X with respect to $\omega_1$ is $XL \cdot XL_1 = XC \cdot XC'$. Thus, $XK \cdot XK_1 = XL \cdot XL_1$, which implies that K, L, K1, L1 are concyclic; let their circle be $\omega_3$. As $\angle BCA = 90^\circ$, AC is tangent to $\omega_2$ at C. The power of A with respect to $\omega_2$ is $AC^2 = AK \cdot AK_1$. Since $AL=AC$, we have $AL^2 = AK \cdot AK_1$, which implies AL is tangent to $\omega_3$ at L. Analogously, BC is tangent to $\omega_1$ at C, so the power of B w.r.t $\omega_1$ is $BC^2 = BL \cdot BL_1$. Since $BK=BC$, $BK^2 = BL \cdot BL_1$, so BK is tangent to $\omega_3$ at K.","Let $A B C$ be a triangle with $\angle B C A=90^{\circ}$, and let $C_{0}$ be the foot of the altitude from $C$. Choose a point $X$ in the interior of the segment $C C_{0}$, and let $K, L$ be the points on the segments $A X, B X$ for which $B K=B C$ and $A L=A C$ respectively. Denote by $M$ the intersection of $A L$ and $B K$. Show that $M K=M L$.","From the previous step, there exists a circle $\omega_3$ that passes through points K and L. We also established that the line AL is tangent to $\omega_3$ at L and the line BK is tangent to $\omega_3$ at K. The point M is the intersection of these two tangent lines. Therefore, MK and ML are the two tangent segments from the external point M to the circle $\omega_3$. By the property that tangents from an external point to a circle are equal in length, we conclude that $MK = ML$.",,,,
2012g6,"Let $A B C$ be a triangle with circumcenter $O$ and incenter $I$. The points $D, E$ and $F$ on the sides $B C, C A$ and $A B$ respectively are such that $B D+B F=C A$ and $C D+C E=A B$. The circumcircles of the triangles $B F D$ and $C D E$ intersect at $P \neq D$. Prove that $O P=O I$.","Solution. By Miquel's theorem the circles $(A E F)=\omega_{A},(B F D)=\omega_{B}$ and $(C D E)=\omega_{C}$ have a common point, for arbitrary points $D, E$ and $F$ on $B C, C A$ and $A B$. So $\omega_{A}$ passes through the common point $P \neq D$ of $\omega_{B}$ and $\omega_{C}$.

Let $\omega_{A}, \omega_{B}$ and $\omega_{C}$ meet the bisectors $A I, B I$ and $C I$ at $A \neq A^{\prime}, B \neq B^{\prime}$ and $C \neq C^{\prime}$ respectively. The key observation is that $A^{\prime}, B^{\prime}$ and $C^{\prime}$ do not depend on the particular choice of $D, E$ and $F$, provided that $B D+B F=C A, C D+C E=A B$ and $A E+A F=B C$ hold true (the last equality follows from the other two). For a proof we need the following fact.\\
Lemma. Given is an angle with vertex $A$ and measure $\alpha$. A circle $\omega$ through $A$ intersects the angle bisector at $L$ and sides of the angle at $X$ and $Y$. Then $A X+A Y=2 A L \cos \frac{\alpha}{2}$.\\
Proof. Note that $L$ is the midpoint of $\operatorname{arc} \widehat{X L Y}$ in $\omega$ and set $X L=Y L=u, X Y=v$. By Ptolemy's theorem $A X \cdot Y L+A Y \cdot X L=A L \cdot X Y$, which rewrites as $(A X+A Y) u=A L \cdot v$. Since $\angle L X Y=\frac{\alpha}{2}$ and $\angle X L Y=180^{\circ}-\alpha$, we have $v=2 \cos \frac{\alpha}{2} u$ by the law of sines, and the claim follows.\\
\includegraphics[max width=\textwidth, center]{2025_05_04_da9ecbcd73427ebbc2afg-34}

Apply the lemma to $\angle B A C=\alpha$ and the circle $\omega=\omega_{A}$, which intersects $A I$ at $A^{\prime}$. This gives $2 A A^{\prime} \cos \frac{\alpha}{2}=A E+A F=B C$; by symmetry analogous relations hold for $B B^{\prime}$ and $C C^{\prime}$. It follows that $A^{\prime}, B^{\prime}$ and $C^{\prime}$ are independent of the choice of $D, E$ and $F$, as stated.

We use the lemma two more times with $\angle B A C=\alpha$. Let $\omega$ be the circle with diameter $A I$. Then $X$ and $Y$ are the tangency points of the incircle of $A B C$ with $A B$ and $A C$, and hence $A X=A Y=\frac{1}{2}(A B+A C-B C)$. So the lemma yields $2 A I \cos \frac{\alpha}{2}=A B+A C-B C$. Next, if $\omega$ is the circumcircle of $A B C$ and $A I$ intersects $\omega$ at $M \neq A$ then $\{X, Y\}=\{B, C\}$, and so $2 A M \cos \frac{\alpha}{2}=A B+A C$ by the lemma. To summarize,


\begin{equation*}
2 A A^{\prime} \cos \frac{\alpha}{2}=B C, \quad 2 A I \cos \frac{\alpha}{2}=A B+A C-B C, \quad 2 A M \cos \frac{\alpha}{2}=A B+A C . \tag{}
\end{equation*}


These equalities imply $A A^{\prime}+A I=A M$, hence the segments $A M$ and $I A^{\prime}$ have a common midpoint. It follows that $I$ and $A^{\prime}$ are equidistant from the circumcenter $O$. By symmetry $O I=O A^{\prime}=O B^{\prime}=O C^{\prime}$, so $I, A^{\prime}, B^{\prime}, C^{\prime}$ are on a circle centered at $O$.

To prove $O P=O I$, now it suffices to show that $I, A^{\prime}, B^{\prime}, C^{\prime}$ and $P$ are concyclic. Clearly one can assume $P \neq I, A^{\prime}, B^{\prime}, C^{\prime}$.

We use oriented angles to avoid heavy case distinction. The oriented angle between the lines $l$ and $m$ is denoted by $\angle(l, m)$. We have $\angle(l, m)=-\angle(m, l)$ and $\angle(l, m)+\angle(m, n)=\angle(l, n)$ for arbitrary lines $l, m$ and $n$. Four distinct non-collinear points $U, V, X, Y$ are concyclic if and only if $\angle(U X, V X)=\angle(U Y, V Y)$.\\
\includegraphics[max width=\textwidth, center]{2025_05_04_da9ecbcd73427ebbc2afg-35}

Suppose for the moment that $A^{\prime}, B^{\prime}, P, I$ are distinct and noncollinear; then it is enough to check the equality $\angle\left(A^{\prime} P, B^{\prime} P\right)=\angle\left(A^{\prime} I, B^{\prime} I\right)$. Because $A, F, P, A^{\prime}$ are on the circle $\omega_{A}$, we have $\angle\left(A^{\prime} P, F P\right)=\angle\left(A^{\prime} A, F A\right)=\angle\left(A^{\prime} I, A B\right)$. Likewise $\angle\left(B^{\prime} P, F P\right)=\angle\left(B^{\prime} I, A B\right)$. Therefore

$$
\angle\left(A^{\prime} P, B^{\prime} P\right)=\angle\left(A^{\prime} P, F P\right)+\angle\left(F P, B^{\prime} P\right)=\angle\left(A^{\prime} I, A B\right)-\angle\left(B^{\prime} I, A B\right)=\angle\left(A^{\prime} I, B^{\prime} I\right)
$$

Here we assumed that $P \neq F$. If $P=F$ then $P \neq D, E$ and the conclusion follows similarly (use $\angle\left(A^{\prime} F, B^{\prime} F\right)=\angle\left(A^{\prime} F, E F\right)+\angle(E F, D F)+\angle\left(D F, B^{\prime} F\right)$ and inscribed angles in $\left.\omega_{A}, \omega_{B}, \omega_{C}\right)$.

There is no loss of generality in assuming $A^{\prime}, B^{\prime}, P, I$ distinct and noncollinear. If $A B C$ is an equilateral triangle then the equalities $\left(^{*}\right.$ ) imply that $A^{\prime}, B^{\prime}, C^{\prime}, I, O$ and $P$ coincide, so $O P=O I$. Otherwise at most one of $A^{\prime}, B^{\prime}, C^{\prime}$ coincides with $I$. If say $C^{\prime}=I$ then $O I \perp C I$ by the previous reasoning. It follows that $A^{\prime}, B^{\prime} \neq I$ and hence $A^{\prime} \neq B^{\prime}$. Finally $A^{\prime}, B^{\prime}$ and $I$ are noncollinear because $I, A^{\prime}, B^{\prime}, C^{\prime}$ are concyclic.

Comment. The proposer remarks that the locus $\gamma$ of the points $P$ is an arc of the circle $\left(A^{\prime} B^{\prime} C^{\prime} I\right)$. The reflection $I^{\prime}$ of $I$ in $O$ belongs to $\gamma$; it is obtained by choosing $D, E$ and $F$ to be the tangency points of the three excircles with their respective sides. The rest of the circle $\left(A^{\prime} B^{\prime} C^{\prime} I\right)$, except $I$, can be included in $\gamma$ by letting $D, E$ and $F$ vary on the extensions of the sides and assuming signed lengths. For instance if $B$ is between $C$ and $D$ then the length $B D$ must be taken with a negative sign. The incenter $I$ corresponds to the limit case where $D$ tends to infinity.",4,"Let $\omega_A, \omega_B, \omega_C$ be the circumcircles of $\triangle AEF, \triangle BFD, \triangle CDE$ respectively. Let $A', B', C'$ be the second intersection points of the angle bisectors $AI, BI, CI$ with $\omega_A, \omega_B, \omega_C$. Show that the points $A', B', C'$ are fixed, regardless of the specific choice of $D, E, F$ that satisfy the given conditions.","The conditions $BD+BF=CA$ and $CD+CE=AB$ imply $AE+AF=BC$. A geometric lemma states that for a circle through a vertex $A$ of an angle, intersecting the sides at $E,F$ and the angle bisector at $A'$, we have $AE+AF = 2AA' \cos(A/2)$. Applying this to $\omega_A$ gives $BC = 2AA' \cos(A/2)$. This equation determines a unique length $AA'$ on the fixed line $AI$, so $A'$ is a fixed point. By symmetry, $B'$ and $C'$ are also fixed points.","Prove that the incenter $I$ and the points $A', B', C'$ defined in the previous part lie on a circle centered at the circumcenter $O$.","Let $M$ be the second intersection of $AI$ with the circumcircle of $\triangle ABC$. We have three relations that can be derived from the lemma in Part 1: (1) $BC = 2AA'\cos(A/2)$; (2) $AB+AC-BC = 2AI\cos(A/2)$; (3) $AB+AC = 2AM\cos(A/2)$. From these, we deduce $AI+AA'=AM$. Since $A,I,A',M$ are collinear, this implies the segments $IA'$ and $AM$ share a midpoint. The perpendicular bisector of $AM$ passes through the circumcenter $O$. Thus, the perpendicular bisector of $IA'$ also passes through $O$, meaning $OI=OA'$. By symmetry, $OI=OB'$ and $OI=OC'$, so $I, A', B', C'$ lie on a circle centered at $O$.","Let $P$ be the common intersection point of the circumcircles of $\triangle BFD$ and $\triangle CDE$ (other than $D$). Prove that $P$ is concyclic with $I, A', B', C'$.\","By Miquel's theorem, $P$ lies on all three circumcircles $\omega_A, \omega_B, \omega_C$. To prove $P$ is concyclic with $I, A', B', C'$, it is sufficient to show $P, I, A', B'$ are concyclic. Using oriented angles, we show $\angle(A'P, B'P) = \angle(A'I, B'I)$. From concyclicity of $A,F,P,A'$ on $\omega_A$, we have $\angle(A'P, FP) = \angle(A'A, FA) = \angle(AI, AB)$. From concyclicity of $B,F,P,B'$ on $\omega_B$, we have $\angle(B'P, FP) = \angle(B'B, FB) = \angle(BI, AB)$. Therefore, $\angle(A'P, B'P) = \angle(A'P, FP) - \angle(B'P, FP) = \angle(AI, AB) - \angle(BI, AB) = \angle(AI, BI) = \angle(A'I, B'I)$. Thus, $P, I, A', B'$ are concyclic, and by symmetry, $P$ is concyclic with $I, A', B', C'$.","Let $A B C$ be a triangle with circumcenter $O$ and incenter $I$. The points $D, E$ and $F$ on the sides $B C, C A$ and $A B$ respectively are such that $B D+B F=C A$ and $C D+C E=A B$. The circumcircles of the triangles $B F D$ and $C D E$ intersect at $P \neq D$. Prove that $O P=O I$.","In Sub-problem 2, we proved that $I, A', B', C'$ lie on a circle centered at the circumcenter $O$. This means $O$ is equidistant from these four points, so $OI=OA'=OB'=OC'$. In Sub-problem 3, we showed that the point $P$ also lies on this same circle. Since $P$ is on the circle centered at $O$ with radius $OI$, its distance to the center must be equal to the radius. Therefore, $OP = OI$."
2012g7,Let $A B C D$ be a convex quadrilateral with non-parallel sides $B C$ and $A D$. Assume that there is a point $E$ on the side $B C$ such that the quadrilaterals $A B E D$ and $A E C D$ are circumscribed. Prove that there is a point $F$ on the side $A D$ such that the quadrilaterals $A B C F$ and $B C D F$ are circumscribed if and only if $A B$ is parallel to $C D$.,"Solution. Let $\omega_{1}$ and $\omega_{2}$ be the incircles and $O_{1}$ and $O_{2}$ the incenters of the quadrilaterals $A B E D$ and $A E C D$ respectively. A point $F$ with the stated property exists only if $\omega_{1}$ and $\omega_{2}$ are also the incircles of the quadrilaterals $A B C F$ and $B C D F$.\\
\includegraphics[max width=\textwidth, center]{2025_05_04_da9ecbcd73427ebbc2afg-36(1)}

Let the tangents from $B$ to $\omega_{2}$ and from $C$ to $\omega_{1}$ (other than $B C$ ) meet $A D$ at $F_{1}$ and $F_{2}$ respectively. We need to prove that $F_{1}=F_{2}$ if and only if $A B \| C D$.\\
$L e m m a$. The circles $\omega_{1}$ and $\omega_{2}$ with centers $O_{1}$ and $O_{2}$ are inscribed in an angle with vertex $O$. The points $P, S$ on one side of the angle and $Q, R$ on the other side are such that $\omega_{1}$ is the incircle of the triangle $P Q O$, and $\omega_{2}$ is the excircle of the triangle $R S O$ opposite to $O$. Denote $p=O O_{1} \cdot O O_{2}$. Then exactly one of the following relations holds:

$$
O P \cdot O R<p<O Q \cdot O S, \quad O P \cdot O R>p>O Q \cdot O S, \quad O P \cdot O R=p=O Q \cdot O S
$$

Proof. Denote $\angle O P O_{1}=u, \angle O Q O_{1}=v, \angle O O_{2} R=x, \angle O O_{2} S=y, \angle P O Q=2 \varphi$. Because $P O_{1}, Q O_{1}, R O_{2}, S O_{2}$ are internal or external bisectors in the triangles $P Q O$ and $R S O$, we have


\begin{equation*}
u+v=x+y\left(=90^{\circ}-\varphi\right) \tag{1}
\end{equation*}


\begin{center}
\includegraphics[max width=\textwidth]{2025_05_04_da9ecbcd73427ebbc2afg-36}
\end{center}

By the law of sines

$$
\frac{O P}{O O_{1}}=\frac{\sin (u+\varphi)}{\sin u} \quad \text { and } \quad \frac{O O_{2}}{O R}=\frac{\sin (x+\varphi)}{\sin x}
$$

Therefore, since $x, u$ and $\varphi$ are acute,\\
$O P \cdot O R \geq p \Leftrightarrow \frac{O P}{O O_{1}} \geq \frac{O O_{2}}{O R} \Leftrightarrow \sin x \sin (u+\varphi) \geq \sin u \sin (x+\varphi) \Leftrightarrow \sin (x-u) \geq 0 \Leftrightarrow x \geq u$.\\
Thus $O P \cdot O R \geq p$ is equivalent to $x \geq u$, with $O P \cdot O R=p$ if and only if $x=u$.\\
Analogously, $p \geq O Q \cdot O S$ is equivalent to $v \geq y$, with $p=O Q \cdot O S$ if and only if $v=y$. On the other hand $x \geq u$ and $v \geq y$ are equivalent by (1), with $x=u$ if and only if $v=y$. The conclusion of the lemma follows from here.

Going back to the problem, apply the lemma to the quadruples $\left\{B, E, D, F_{1}\right\},\{A, B, C, D\}$ and $\left\{A, E, C, F_{2}\right\}$. Assuming $O E \cdot O F_{1}>p$, we obtain

$$
O E \cdot O F_{1}>p \Rightarrow O B \cdot O D<p \Rightarrow O A \cdot O C>p \Rightarrow O E \cdot O F_{2}<p
$$

In other words, $O E \cdot O F_{1}>p$ implies

$$
O B \cdot O D<p<O A \cdot O C \quad \text { and } \quad O E \cdot O F_{1}>p>O E \cdot O F_{2}
$$

Similarly, $O E \cdot O F_{1}<p$ implies

$$
O B \cdot O D>p>O A \cdot O C \quad \text { and } \quad O E \cdot O F_{1}<p<O E \cdot O F_{2}
$$

In these cases $F_{1} \neq F_{2}$ and $O B \cdot O D \neq O A \cdot O C$, so the lines $A B$ and $C D$ are not parallel.\\
There remains the case $O E \cdot O F_{1}=p$. Here the lemma leads to $O B \cdot O D=p=O A \cdot O C$ and $O E \cdot O F_{1}=p=O E \cdot O F_{2}$. Therefore $F_{1}=F_{2}$ and $A B \| C D$.

Comment. The conclusion is also true if $B C$ and $A D$ are parallel. One can prove a limit case of the lemma for the configuration shown in the figure below, where $r_{1}$ and $r_{2}$ are parallel rays starting at $O^{\prime}$ and $O^{\prime \prime}$, with $O^{\prime} O^{\prime \prime} \perp r_{1}, r_{2}$ and $O$ the midpoint of $O^{\prime} O^{\prime \prime}$. Two circles with centers $O_{1}$ and $O_{2}$ are inscribed in the strip between $r_{1}$ and $r_{2}$. The lines $P Q$ and $R S$ are tangent to the circles, with $P, S$ on $r_{1}$, and $Q, R$ on $r_{2}$, so that $O, O_{1}$ are on the same side of $P Q$ and $O, O_{2}$ are on different sides of $R S$. Denote $s=O O_{1}+O O_{2}$. Then exactly one of the following relations holds:

$$
O^{\prime} P+O^{\prime \prime} R<s<O^{\prime \prime} Q+O^{\prime} S, \quad O^{\prime} P+O^{\prime \prime} R>s>O^{\prime \prime} Q+O^{\prime} S, \quad O^{\prime} P+O^{\prime \prime} R=s=O^{\prime \prime} Q+O^{\prime} S
$$

\begin{center}
\includegraphics[max width=\textwidth]{2025_05_04_da9ecbcd73427ebbc2afg-37}
\end{center}

Once this is established, the proof of the original statement for $B C \| A D$ is analogous to the one in the intersecting case. One replaces products by sums of relevant segments.",1,Let $A B C D$ be a convex quadrilateral with non-parallel sides $B C$ and $A D$. Assume that there is a point $E$ on the side $B C$ such that the quadrilaterals $A B E D$ and $A E C D$ are circumscribed. Prove that there is a point $F$ on the side $A D$ such that the quadrilaterals $A B C F$ and $B C D F$ are circumscribed if and only if $A B$ is parallel to $C D$.,"Solution. Let $\omega_{1}$ and $\omega_{2}$ be the incircles and $O_{1}$ and $O_{2}$ the incenters of the quadrilaterals $A B E D$ and $A E C D$ respectively. A point $F$ with the stated property exists only if $\omega_{1}$ and $\omega_{2}$ are also the incircles of the quadrilaterals $A B C F$ and $B C D F$.\\
\includegraphics[max width=\textwidth, center]{2025_05_04_da9ecbcd73427ebbc2afg-36(1)}

Let the tangents from $B$ to $\omega_{2}$ and from $C$ to $\omega_{1}$ (other than $B C$ ) meet $A D$ at $F_{1}$ and $F_{2}$ respectively. We need to prove that $F_{1}=F_{2}$ if and only if $A B \| C D$.\\
$L e m m a$. The circles $\omega_{1}$ and $\omega_{2}$ with centers $O_{1}$ and $O_{2}$ are inscribed in an angle with vertex $O$. The points $P, S$ on one side of the angle and $Q, R$ on the other side are such that $\omega_{1}$ is the incircle of the triangle $P Q O$, and $\omega_{2}$ is the excircle of the triangle $R S O$ opposite to $O$. Denote $p=O O_{1} \cdot O O_{2}$. Then exactly one of the following relations holds:

$$
O P \cdot O R<p<O Q \cdot O S, \quad O P \cdot O R>p>O Q \cdot O S, \quad O P \cdot O R=p=O Q \cdot O S
$$

Proof. Denote $\angle O P O_{1}=u, \angle O Q O_{1}=v, \angle O O_{2} R=x, \angle O O_{2} S=y, \angle P O Q=2 \varphi$. Because $P O_{1}, Q O_{1}, R O_{2}, S O_{2}$ are internal or external bisectors in the triangles $P Q O$ and $R S O$, we have


\begin{equation*}
u+v=x+y\left(=90^{\circ}-\varphi\right) \tag{1}
\end{equation*}


\begin{center}
\includegraphics[max width=\textwidth]{2025_05_04_da9ecbcd73427ebbc2afg-36}
\end{center}

By the law of sines

$$
\frac{O P}{O O_{1}}=\frac{\sin (u+\varphi)}{\sin u} \quad \text { and } \quad \frac{O O_{2}}{O R}=\frac{\sin (x+\varphi)}{\sin x}
$$

Therefore, since $x, u$ and $\varphi$ are acute,\\
$O P \cdot O R \geq p \Leftrightarrow \frac{O P}{O O_{1}} \geq \frac{O O_{2}}{O R} \Leftrightarrow \sin x \sin (u+\varphi) \geq \sin u \sin (x+\varphi) \Leftrightarrow \sin (x-u) \geq 0 \Leftrightarrow x \geq u$.\\
Thus $O P \cdot O R \geq p$ is equivalent to $x \geq u$, with $O P \cdot O R=p$ if and only if $x=u$.\\
Analogously, $p \geq O Q \cdot O S$ is equivalent to $v \geq y$, with $p=O Q \cdot O S$ if and only if $v=y$. On the other hand $x \geq u$ and $v \geq y$ are equivalent by (1), with $x=u$ if and only if $v=y$. The conclusion of the lemma follows from here.

Going back to the problem, apply the lemma to the quadruples $\left\{B, E, D, F_{1}\right\},\{A, B, C, D\}$ and $\left\{A, E, C, F_{2}\right\}$. Assuming $O E \cdot O F_{1}>p$, we obtain

$$
O E \cdot O F_{1}>p \Rightarrow O B \cdot O D<p \Rightarrow O A \cdot O C>p \Rightarrow O E \cdot O F_{2}<p
$$

In other words, $O E \cdot O F_{1}>p$ implies

$$
O B \cdot O D<p<O A \cdot O C \quad \text { and } \quad O E \cdot O F_{1}>p>O E \cdot O F_{2}
$$

Similarly, $O E \cdot O F_{1}<p$ implies

$$
O B \cdot O D>p>O A \cdot O C \quad \text { and } \quad O E \cdot O F_{1}<p<O E \cdot O F_{2}
$$

In these cases $F_{1} \neq F_{2}$ and $O B \cdot O D \neq O A \cdot O C$, so the lines $A B$ and $C D$ are not parallel.\\
There remains the case $O E \cdot O F_{1}=p$. Here the lemma leads to $O B \cdot O D=p=O A \cdot O C$ and $O E \cdot O F_{1}=p=O E \cdot O F_{2}$. Therefore $F_{1}=F_{2}$ and $A B \| C D$.

Comment. The conclusion is also true if $B C$ and $A D$ are parallel. One can prove a limit case of the lemma for the configuration shown in the figure below, where $r_{1}$ and $r_{2}$ are parallel rays starting at $O^{\prime}$ and $O^{\prime \prime}$, with $O^{\prime} O^{\prime \prime} \perp r_{1}, r_{2}$ and $O$ the midpoint of $O^{\prime} O^{\prime \prime}$. Two circles with centers $O_{1}$ and $O_{2}$ are inscribed in the strip between $r_{1}$ and $r_{2}$. The lines $P Q$ and $R S$ are tangent to the circles, with $P, S$ on $r_{1}$, and $Q, R$ on $r_{2}$, so that $O, O_{1}$ are on the same side of $P Q$ and $O, O_{2}$ are on different sides of $R S$. Denote $s=O O_{1}+O O_{2}$. Then exactly one of the following relations holds:

$$
O^{\prime} P+O^{\prime \prime} R<s<O^{\prime \prime} Q+O^{\prime} S, \quad O^{\prime} P+O^{\prime \prime} R>s>O^{\prime \prime} Q+O^{\prime} S, \quad O^{\prime} P+O^{\prime \prime} R=s=O^{\prime \prime} Q+O^{\prime} S
$$

\begin{center}
\includegraphics[max width=\textwidth]{2025_05_04_da9ecbcd73427ebbc2afg-37}
\end{center}

Once this is established, the proof of the original statement for $B C \| A D$ is analogous to the one in the intersecting case. One replaces products by sums of relevant segments.",,,,,,
2012g8,"Let $A B C$ be a triangle with circumcircle $\omega$ and $\ell$ a line without common points with $\omega$. Denote by $P$ the foot of the perpendicular from the center of $\omega$ to $\ell$. The side-lines $B C, C A, A B$ intersect $\ell$ at the points $X, Y, Z$ different from $P$. Prove that the circumcircles of the triangles $A X P, B Y P$ and $C Z P$ have a common point different from $P$ or are mutually tangent at $P$.","Let $\omega_{A}, \omega_{B}, \omega_{C}$ and $\omega$ be the circumcircles of triangles $A X P, B Y P, C Z P$ and $A B C$ respectively. The strategy of the proof is to construct a point $Q$ with the same power with respect to the four circles. Then each of $P$ and $Q$ has the same power with respect to $\omega_{A}, \omega_{B}, \omega_{C}$ and hence the three circles are coaxial. In other words they have another common point $P^{\prime}$ or the three of them are tangent at $P$.

We first give a description of the point $Q$. Let $A^{\prime} \neq A$ be the second intersection of $\omega$ and $\omega_{A}$; define $B^{\prime}$ and $C^{\prime}$ analogously. We claim that $A A^{\prime}, B B^{\prime}$ and $C C^{\prime}$ have a common point. Once this claim is established, the point just constructed will be on the radical axes of the three pairs of circles $\left\{\omega, \omega_{A}\right\},\left\{\omega, \omega_{B}\right\},\left\{\omega, \omega_{C}\right\}$. Hence it will have the same power with respect to $\omega, \omega_{A}, \omega_{B}, \omega_{C}$.\\
\includegraphics[max width=\textwidth, center]{2025_05_04_da9ecbcd73427ebbc2afg-38}

We proceed to prove that $A A^{\prime}, B B^{\prime}$ and $C C^{\prime}$ intersect at one point. Let $r$ be the circumradius of triangle $A B C$. Define the points $X^{\prime}, Y^{\prime}, Z^{\prime}$ as the intersections of $A A^{\prime}, B B^{\prime}, C C^{\prime}$ with $\ell$. Observe that $X^{\prime}, Y^{\prime}, Z^{\prime}$ do exist. If $A A^{\prime}$ is parallel to $\ell$ then $\omega_{A}$ is tangent to $\ell$; hence $X=P$ which is a contradiction. Similarly, $B B^{\prime}$ and $C C^{\prime}$ are not parallel to $\ell$.

From the powers of the point $X^{\prime}$ with respect to the circles $\omega_{A}$ and $\omega$ we get

$$
X^{\prime} P \cdot\left(X^{\prime} P+P X\right)=X^{\prime} P \cdot X^{\prime} X=X^{\prime} A^{\prime} \cdot X^{\prime} A=X^{\prime} O^{2}-r^{2},
$$

hence

$$
X^{\prime} P \cdot P X=X^{\prime} O^{2}-r^{2}-X^{\prime} P^{2}=O P^{2}-r^{2} .
$$

We argue analogously for the points $Y^{\prime}$ and $Z^{\prime}$, obtaining


\begin{equation*}
X^{\prime} P \cdot P X=Y^{\prime} P \cdot P Y=Z^{\prime} P \cdot P Z=O P^{2}-r^{2}=k^{2} . \tag{1}
\end{equation*}


In these computations all segments are regarded as directed segments. We keep the same convention for the sequel.

We prove that the lines $A A^{\prime}, B B^{\prime}, C C^{\prime}$ intersect at one point by CEva's theorem. To avoid distracting remarks we interpret everything projectively, i. e. whenever two lines are parallel they meet at a point on the line at infinity.

Let $U, V, W$ be the intersections of $A A^{\prime}, B B^{\prime}, C C^{\prime}$ with $B C, C A, A B$ respectively. The idea is that although it is difficult to calculate the ratio $\frac{B U}{C U}$, it is easier to deal with the cross-ratio $\frac{B U}{C U} / \frac{B X}{C X}$ because we can send it to the line $\ell$. With this in mind we apply Menelaus' theorem to the triangle $A B C$ and obtain $\frac{B X}{C X} \cdot \frac{C Y}{A Y} \cdot \frac{A Z}{B Z}=1$. Hence Ceva's ratio can be expressed as

$$
\frac{B U}{C U} \cdot \frac{C V}{A V} \cdot \frac{A W}{B W}=\frac{B U}{C U} / \frac{B X}{C X} \cdot \frac{C V}{A V} / \frac{C Y}{A Y} \cdot \frac{A W}{B W} / \frac{A Z}{B Z} .
$$

\begin{center}
\includegraphics[max width=\textwidth]{2025_05_04_da9ecbcd73427ebbc2afg-39}
\end{center}

Project the line $B C$ to $\ell$ from $A$. The cross-ratio between $B C$ and $U X$ equals the cross-ratio between $Z Y$ and $X^{\prime} X$. Repeating the same argument with the lines $C A$ and $A B$ gives

$$
\frac{B U}{C U} \cdot \frac{C V}{A V} \cdot \frac{A W}{B W}=\frac{Z X^{\prime}}{Y X^{\prime}} / \frac{Z X}{Y X} \cdot \frac{X Y^{\prime}}{Z Y^{\prime}} / \frac{X Y}{Z Y} \cdot \frac{Y Z^{\prime}}{X Z^{\prime}} / \frac{Y Z}{X Z}
$$

and hence

$$
\frac{B U}{C U} \cdot \frac{C V}{A V} \cdot \frac{A W}{B W}=(-1) \cdot \frac{Z X^{\prime}}{Y X^{\prime}} \cdot \frac{X Y^{\prime}}{Z Y^{\prime}} \cdot \frac{Y Z^{\prime}}{X Z^{\prime}} .
$$

The equations (1) reduce the problem to a straightforward computation on the line $\ell$. For instance, the transformation $t \mapsto-k^{2} / t$ preserves cross-ratio and interchanges the points $X, Y, Z$ with the points $X^{\prime}, Y^{\prime}, Z^{\prime}$. Then

$$
\frac{B U}{C U} \cdot \frac{C V}{A V} \cdot \frac{A W}{B W}=(-1) \cdot \frac{Z X^{\prime}}{Y X^{\prime}} / \frac{Z Z^{\prime}}{Y Z^{\prime}} \cdot \frac{X Y^{\prime}}{Z Y^{\prime}} / \frac{X Z^{\prime}}{Z Z^{\prime}}=-1 .
$$

We proved that Ceva's ratio equals -1 , so $A A^{\prime}, B B^{\prime}, C C^{\prime}$ intersect at one point $Q$.\\",4,"Let $\omega$ be the circumcircle of $\triangle ABC$ with center $O$ and radius $r$. Let $\omega_A$ be the circumcircle of $\triangle AXP$. Let $A'$ be the second intersection of $\omega$ and $\omega_A$, and let $X'$ be the intersection of line $AA'$ with line $\ell$. Using directed segments originating from $P$, prove that $PX' \cdot PX = PO^2 - r^2$.","The line $AA'$ is the radical axis of circles $\omega$ and $\omega_A$. Point $X'$ lies on this line, so it has the same power with respect to both circles. The power of $X'$ with respect to $\omega_A$ is $\vec{X'P} \cdot \vec{X'X}$. The power of $X'$ with respect to $\omega$ is $X'O^2 - r^2$. Equating them gives $\vec{X'P} \cdot \vec{X'X} = X'O^2 - r^2$. Since $P$ is the foot of the perpendicular from $O$ to $\ell$, by the Pythagorean theorem, $X'O^2 = X'P^2 + PO^2$. Using directed segments, $\vec{X'X} = \vec{X'P} + \vec{PX}$. The equation becomes $X'P(X'P + PX) = X'P^2 + PO^2 - r^2$, which simplifies to $X'P \cdot PX = PO^2 - r^2$ (as scalar products of collinear vectors).","Let $\omega_A, \omega_B, \omega_C$ be the circumcircles of $\triangle AXP, \triangle BYP, \triangle CZP$. Let $A', B', C'$ be the second intersection points of these circles with the circumcircle $\omega$ of $\triangle ABC$, respectively. Prove that the lines $AA', BB', CC'$ are concurrent.","Let the intersections of $AA', BB', CC'$ with the triangle sides $BC, CA, AB$ be $U, V, W$ respectively. We apply the converse of Ceva's theorem. The Ceva ratio $\frac{BU}{CU} \cdot \frac{CV}{AV} \cdot \frac{AW}{BW}$ is related to a product of cross-ratios on the line $\ell$. Let $X', Y', Z'$ be the intersections of $AA', BB', CC'$ with $\ell$. By projecting from vertices $A, B, C$ onto $\ell$, the Ceva product is transformed into a product of cross-ratios involving points $X,Y,Z,X',Y',Z'$ on $\ell$. Using the constant product relation $PX \cdot PX' = PY \cdot PY' = PZ \cdot PZ' = k$ from Sub-problem 1, this product of cross-ratios evaluates to 1. By Ceva's theorem, this implies the lines $AA', BB', CC'$ are concurrent.","Let $Q$ be the point of concurrency of lines $AA', BB', CC'$. Prove that $Q$ has the same power with respect to the circumcircles of triangles $AXP, BYP$, and $CZP$.","Let $\omega$ be the circumcircle of $\triangle ABC$, and $\omega_A, \omega_B, \omega_C$ be the circumcircles of $\triangle AXP, \triangle BYP, \triangle CZP$. The line $AA'$ is the radical axis of circles $\omega$ and $\omega_A$. Since $Q$ lies on $AA'$, the power of $Q$ with respect to $\omega$ is equal to its power with respect to $\omega_A$. Similarly, since $Q$ lies on $BB'$, its power with respect to $\omega$ is equal to its power with respect to $\omega_B$. And since $Q$ lies on $CC'$, its power with respect to $\omega$ is equal to its power with respect to $\omega_C$. Therefore, the power of $Q$ is the same for all four circles $\omega, \omega_A, \omega_B, \omega_C$, and in particular, $Q$ has the same power with respect to $\omega_A, \omega_B$, and $\omega_C$.","Let $A B C$ be a triangle with circumcircle $\omega$ and $\ell$ a line without common points with $\omega$. Denote by $P$ the foot of the perpendicular from the center of $\omega$ to $\ell$. The side-lines $B C, C A, A B$ intersect $\ell$ at the points $X, Y, Z$ different from $P$. Prove that the circumcircles of the triangles $A X P, B Y P$ and $C Z P$ have a common point different from $P$ or are mutually tangent at $P$.","Let $\omega_A, \omega_B, \omega_C$ be the circumcircles of $\triangle AXP, \triangle BYP, \triangle CZP$. All three circles pass through the point $P$. From Sub-problem 3, there exists a point $Q$ which has the same power with respect to $\omega_A, \omega_B$, and $\omega_C$. The locus of points with equal power with respect to two circles is their radical axis. Since both $P$ (with power 0) and $Q$ have equal power for any pair of the three circles, the line $PQ$ is the common radical axis for $\omega_A, \omega_B, \omega_C$. A set of circles sharing a radical axis is a coaxial pencil. Since the circles pass through a point $P$ on their radical axis, they must either intersect at a second common point on the axis or be mutually tangent at $P$."
2012n6,"Let $x$ and $y$ be positive integers. If $x^{2^{n}}-1$ is divisible by $2^{n} y+1$ for every positive integer $n$, prove that $x=1$.","Solution. First we prove the following fact: For every positive integer $y$ there exist infinitely many primes $p \equiv 3(\bmod 4)$ such that $p$ divides some number of the form $2^{n} y+1$.

Clearly it is enough to consider the case $y$ odd. Let

$$
2 y+1=p_{1}^{e_{1}} \cdots p_{r}^{e_{r}}
$$

be the prime factorization of $2 y+1$. Suppose on the contrary that there are finitely many primes $p_{r+1}, \ldots, p_{r+s} \equiv 3(\bmod 4)$ that divide some number of the form $2^{n} y+1$ but do not divide $2 y+1$.

We want to find an $n$ such that $p_{i}^{e_{i}} \| 2^{n} y+1$ for $1 \leq i \leq r$ and $p_{i} \nmid 2^{n} y+1$ for $r+1 \leq i \leq r+s$. For this it suffices to take

$$
n=1+\varphi\left(p_{1}^{e_{1}+1} \cdots p_{r}^{e_{r}+1} p_{r+1}^{1} \cdots p_{r+s}^{1}\right),
$$

because then

$$
2^{n} y+1 \equiv 2 y+1 \quad\left(\bmod p_{1}^{e_{1}+1} \cdots p_{r}^{e_{r}+1} p_{r+1}^{1} \cdots p_{r+s}^{1}\right) .
$$

The last congruence means that $p_{1}^{e_{1}}, \ldots, p_{r}^{e_{r}}$ divide exactly $2^{n} y+1$ and no prime $p_{r+1}, \ldots, p_{r+s}$ divides $2^{n} y+1$. It follows that the prime factorization of $2^{n} y+1$ consists of the prime powers $p_{1}^{e_{1}}, \ldots, p_{r}^{e_{r}}$ and powers of primes $\equiv 1(\bmod 4)$. Because $y$ is odd, we obtain

$$
2^{n} y+1 \equiv p_{1}^{e_{1}} \cdots p_{r}^{e_{r}} \equiv 2 y+1 \equiv 3 \quad(\bmod 4) .
$$

This is a contradiction since $n>1$, and so $2^{n} y+1 \equiv 1(\bmod 4)$.\\
Now we proceed to the problem. If $p$ is a prime divisor of $2^{n} y+1$ the problem statement implies that $x^{d} \equiv 1(\bmod p)$ for $d=2^{n}$. By Fermat's little theorem the same congruence holds for $d=p-1$, so it must also hold for $d=\left(2^{n}, p-1\right)$. For $p \equiv 3(\bmod 4)$ we have $\left(2^{n}, p-1\right)=2$, therefore in this case $x^{2} \equiv 1(\bmod p)$.

In summary, we proved that every prime $p \equiv 3(\bmod 4)$ that divides some number of the form $2^{n} y+1$ also divides $x^{2}-1$. This is possible only if $x=1$, otherwise by the above $x^{2}-1$ would be a positive integer with infinitely many prime factors.

Comment. For each $x$ and each odd prime $p$ the maximal power of $p$ dividing $x^{2^{n}}-1$ for some $n$ is bounded and hence the same must be true for the numbers $2^{n} y+1$. We infer that $p^{2}$ divides $2^{p-1}-1$ for each prime divisor $p$ of $2^{n} y+1$. However trying to reach a contradiction with this conclusion alone seems hopeless, since it is not even known if there are infinitely many primes $p$ without this property.",3,"For any positive integer $y$, prove that there are infinitely many primes $p \\equiv 3 \\pmod{4}$ that divide some number of the form $2^n y + 1$.","Assume for contradiction that for a given $y$, there is a finite set of primes $\{p_i\}$ congruent to $3 \\pmod 4$ that can divide numbers of the form $2^n y+1$. Let $M$ be the product of sufficiently high powers of these primes. By choosing $n=1+\\phi(M)$, we can construct a number $A = 2^n y+1$ such that $A \\equiv 2y+1 \\pmod M$. This construction ensures that the set of prime factors of $A$ congruent to $3 \\pmod 4$ is a subset of those of $2y+1$. If $y$ is odd, this implies $A \\equiv 2y+1 \\equiv 3 \\pmod 4$. However, for $n>1$, $A = 2^n y+1 \\equiv 1 \\pmod 4$, a contradiction. A similar argument holds if $y$ is even. Therefore, there must be infinitely many such primes.","Let $p$ be a prime divisor of $2^n y+1$ for some $n \\ge 1$. If $p \\equiv 3 \\pmod 4$ and $2^n y+1$ divides $x^{2^n}-1$, prove that $p$ must divide $x^2-1$.","The condition $2^n y+1 | x^{2^n}-1$ implies $x^{2^n} \\equiv 1 \\pmod p$. By Fermat's Little Theorem, $x^{p-1} \\equiv 1 \\pmod p$. Therefore, $x^{\\gcd(2^n, p-1)} \\equiv 1 \\pmod p$. Since $p \\equiv 3 \\pmod 4$, we can write $p-1 = 2k$ where $k$ is odd. Thus, for any $n \\ge 1$, $\\gcd(2^n, p-1) = 2$. It follows that $x^2 \\equiv 1 \\pmod p$, which means $p$ divides $x^2-1$.","Let $x$ and $y$ be positive integers. If $x^{2^{n}}-1$ is divisible by $2^{n} y+1$ for every positive integer $n$, prove that $x=1$.","From the first sub-problem, we know there exist infinitely many primes $p \\equiv 3 \\pmod 4$ that divide some number of the form $2^n y+1$. From the second sub-problem, any such prime $p$ must also divide the integer $x^2-1$. A non-zero integer can only have a finite number of distinct prime factors. For $x^2-1$ to have infinitely many prime factors, it must be that $x^2-1=0$. Since $x$ is a positive integer, we conclude that $x=1$.",,
2012n8,Prove that for every prime $p>100$ and every integer $r$ there exist two integers $a$ and $b$ such that $p$ divides $a^{2}+b^{5}-r$.,"Throughout the solution, all congruence relations are meant modulo $p$.\\
Fix $p$, and let $\mathcal{P}=\{0,1, \ldots, p-1\}$ be the set of residue classes modulo $p$. For every $r \in \mathcal{P}$, let $S_{r}=\left\{(a, b) \in \mathcal{P} \times \mathcal{P}: a^{2}+b^{5} \equiv r\right\}$, and let $s_{r}=\left|S_{r}\right|$. Our aim is to prove $s_{r}>0$ for all $r \in \mathcal{P}$.

We will use the well-known fact that for every residue class $r \in \mathcal{P}$ and every positive integer $k$, there are at most $k$ values $x \in \mathcal{P}$ such that $x^{k} \equiv r$.\\
Lemma. Let $N$ be the number of quadruples $(a, b, c, d) \in \mathcal{P}^{4}$ for which $a^{2}+b^{5} \equiv c^{2}+d^{5}$. Then


\begin{equation*}
N=\sum_{r \in \mathcal{P}} s_{r}^{2} \tag{a}
\end{equation*}


and


\begin{equation*}
N \leq p\left(p^{2}+4 p-4\right) . \tag{b}
\end{equation*}


Proof. (a) For each residue class $r$ there exist exactly $s_{r}$ pairs $(a, b)$ with $a^{2}+b^{5} \equiv r$ and $s_{r}$ pairs $(c, d)$ with $c^{2}+d^{5} \equiv r$. So there are $s_{r}^{2}$ quadruples with $a^{2}+b^{5} \equiv c^{2}+d^{5} \equiv r$. Taking the sum over all $r \in \mathcal{P}$, the statement follows.\\
(b) Choose an arbitrary pair $(b, d) \in \mathcal{P}$ and look for the possible values of $a, c$.

\begin{enumerate}
  \item Suppose that $b^{5} \equiv d^{5}$, and let $k$ be the number of such pairs $(b, d)$. The value $b$ can be chosen in $p$ different ways. For $b \equiv 0$ only $d=0$ has this property; for the nonzero values of $b$ there are at most 5 possible values for $d$. So we have $k \leq 1+5(p-1)=5 p-4$.
\end{enumerate}

The values $a$ and $c$ must satisfy $a^{2} \equiv c^{2}$, so $a \equiv \pm c$, and there are exactly $2 p-1$ such pairs $(a, c)$.\\
2. Now suppose $b^{5} \not \equiv d^{5}$. In this case $a$ and $c$ must be distinct. By $(a-c)(a+c)=d^{5}-b^{5}$, the value of $a-c$ uniquely determines $a+c$ and thus $a$ and $c$ as well. Hence, there are $p-1$ suitable pairs ( $a, c$ ).

Thus, for each of the $k$ pairs $(b, d)$ with $b^{5} \equiv d^{5}$ there are $2 p-1$ pairs $(a, c)$, and for each of the other $p^{2}-k$ pairs $(b, d)$ there are $p-1$ pairs $(a, c)$. Hence,

$$
N=k(2 p-1)+\left(p^{2}-k\right)(p-1)=p^{2}(p-1)+k p \leq p^{2}(p-1)+(5 p-4) p=p\left(p^{2}+4 p-4\right) .
$$

To prove the statement of the problem, suppose that $S_{r}=\emptyset$ for some $r \in \mathcal{P}$; obviously $r \not \equiv 0$. Let $T=\left\{x^{10}: x \in \mathcal{P} \backslash\{0\}\right\}$ be the set of nonzero 10 th powers modulo $p$. Since each residue class is the 10 th power of at most 10 elements in $\mathcal{P}$, we have $|T| \geq \frac{p-1}{10} \geq 4$ by $p>100$.

For every $t \in T$, we have $S_{t r}=\emptyset$. Indeed, if $(x, y) \in S_{t r}$ and $t \equiv z^{10}$ then

$$
\left(z^{-5} x\right)^{2}+\left(z^{-2} y\right)^{5} \equiv t^{-1}\left(x^{2}+y^{5}\right) \equiv r
$$

so $\left(z^{-5} x, z^{-2} y\right) \in S_{r}$. So, there are at least $\frac{p-1}{10} \geq 4$ empty sets among $S_{1}, \ldots, S_{p-1}$, and there are at most $p-4$ nonzero values among $s_{0}, s_{2}, \ldots, s_{p-1}$. Then by the AM-QM inequality we obtain

$$
N=\sum_{r \in \mathcal{P} \backslash r T} s_{r}^{2} \geq \frac{1}{p-4}\left(\sum_{r \in \mathcal{P} \backslash r T} s_{r}\right)^{2}=\frac{|\mathcal{P} \times \mathcal{P}|^{2}}{p-4}=\frac{p^{4}}{p-4}>p\left(p^{2}+4 p-4\right),
$$

which is impossible by the lemma.",4,"Let $p$ be a prime, $\mathcal{P}=\{0,1, \ldots, p-1\}$, and $s_r$ be the number of pairs $(a, b) \in \mathcal{P} \times \mathcal{P}$ such that $a^2+b^5 \equiv r \pmod p$. Let $N$ be the number of quadruples $(a, b, c, d) \in \mathcal{P}^4$ such that $a^2+b^5 \equiv c^2+d^5 \pmod p$. Prove that $N = \sum_{r \in \mathcal{P}} s_r^2$ and establish the upper bound $N \leq p(p^2+4p-4)$.","For each $r \in \mathcal{P}$, there are $s_r$ pairs $(a,b)$ with $a^2+b^5 \equiv r$ and $s_r$ pairs $(c,d)$ with $c^2+d^5 \equiv r$. This gives $s_r^2$ quadruples for a given $r$. Summing over all $r$ gives $N = \sum_{r \in \mathcal{P}} s_r^2$. To find the bound, we count $N$ by first choosing $(b,d)$. Let $k$ be the number of pairs $(b,d)$ with $b^5 \equiv d^5$. Since there are at most 5 solutions to $x^5 \equiv c$ for any $c$, we have $k \le 1 + 5(p-1) = 5p-4$. For these $k$ pairs, we need $a^2 \equiv c^2$, which has $2p-1$ solutions. For the $p^2-k$ pairs with $b^5 \not\equiv d^5$, we have $a^2-c^2 \equiv d^5-b^5 \not\equiv 0$. This gives $p-1$ solutions for $(a,c)$. Thus, $N = k(2p-1) + (p^2-k)(p-1) = p^2(p-1)+kp \leq p^2(p-1)+(5p-4)p = p(p^2+4p-4)$.","Assume there exists an integer $r$ not divisible by $p$ such that the congruence $a^2+b^5 \equiv r \pmod p$ has no solutions. Let $T = \{z^{10} \pmod p : z \in \mathcal{P}, z \not\equiv 0 \pmod p\}$. Prove that for any $t \in T$, the congruence $x^2+y^5 \equiv tr \pmod p$ also has no solutions.","Let $s_k$ be the number of solutions to $a^2+b^5 \equiv k \pmod p$. We are given $s_r=0$ for some $r \not\equiv 0 \pmod p$. Let $t \in T$, so $t \equiv z^{10} \pmod p$ for some $z \in \mathcal{P} \setminus \{0\}$. Assume for contradiction that $s_{tr} > 0$, meaning there exists a pair $(x,y)$ such that $x^2+y^5 \equiv tr \pmod p$. Since $z \not\equiv 0$, its inverse $z^{-1}$ exists. Multiplying the congruence by $t^{-1} \equiv (z^{-1})^{10}$, we get $t^{-1}(x^2+y^5) \equiv r \pmod p$. This can be written as $(z^{-5}x)^2 + (z^{-2}y)^5 \equiv r \pmod p$. This provides a solution $(a,b)=(z^{-5}x, z^{-2}y)$ to $a^2+b^5 \equiv r$, contradicting $s_r=0$. Therefore, $s_{tr}=0$ for all $t \in T$.","For a prime $p>100$, assume there exists an integer $r$ for which $a^2+b^5 \equiv r \pmod p$ has no solutions. Let $N$ be defined as in the first sub-problem. Prove that $N > p(p^2+4p-4)$.","Assume $s_r=0$ for some $r$. Since $(0,0)$ is a solution to $a^2+b^5 \equiv 0$, $s_0 \geq 1$, so we must have $r \not\equiv 0 \pmod p$. Let $T = \{z^{10} \pmod p : z \not\equiv 0 \pmod p\}$. From the previous sub-problem, $s_{tr}=0$ for all $t \in T$. The size of $T$ is $|T| = \frac{p-1}{\gcd(10, p-1)} \ge \frac{p-1}{10}$. For $p>100$, $|T| \ge \frac{100-1}{10} = 9.9$, so $|T| \ge 10$. Let $K$ be the set of residues $k$ for which $s_k \neq 0$. Then $|K| \le p - |T| \le p-10$. The total number of pairs $(a,b)$ is $p^2$, so $\sum_{k \in \mathcal{P}} s_k = p^2$. By the Cauchy-Schwarz inequality, $N = \sum_{k \in K} s_k^2 \ge \frac{1}{|K|} (\sum_{k \in K} s_k)^2 = \frac{(p^2)^2}{|K|} \ge \frac{p^4}{p-10}$. The inequality $\frac{p^4}{p-10} > p(p^2+4p-4)$ is equivalent to $p^3 > (p-10)(p^2+4p-4) = p^3-6p^2-44p+40$, which simplifies to $6p^2+44p-40 > 0$, which is true for $p>100$.",Prove that for every prime $p>100$ and every integer $r$ there exist two integers $a$ and $b$ such that $p$ divides $a^{2}+b^{5}-r$.,"Let $s_r$ be the number of solutions to $a^2+b^5 \equiv r \pmod p$. We want to show $s_r > 0$ for all $r$. Assume for contradiction that $s_r=0$ for some $r$. Let $N = \sum_{k \in \mathcal{P}} s_k^2$. From Sub-problem 1, we have the upper bound $N \leq p(p^2+4p-4)$. From Sub-problem 3, the assumption that $s_r=0$ for some $r$ implies the lower bound $N > p(p^2+4p-4)$ for $p>100$. These two inequalities, $N > p(p^2+4p-4)$ and $N \leq p(p^2+4p-4)$, form a contradiction. Thus, the initial assumption that some $s_r=0$ must be false. Therefore, $s_r>0$ for all $r$, which means for every integer $r$, there exist integers $a$ and $b$ such that $a^2+b^5-r$ is divisible by $p$."
2011a5,"Prove that for every positive integer $n$, the set $\{2,3,4, \ldots, 3 n+1\}$ can be partitioned into $n$ triples in such a way that the numbers from each triple are the lengths of the sides of some obtuse triangle.","Solution. Throughout the solution, we denote by $[a, b]$ the set $\{a, a+1, \ldots, b\}$. We say that $\{a, b, c\}$ is an obtuse triple if $a, b, c$ are the sides of some obtuse triangle.

We prove by induction on $n$ that there exists a partition of $[2,3 n+1]$ into $n$ obtuse triples $A_{i}$ ( $2 \leq i \leq n+1$ ) having the form $A_{i}=\left\{i, a_{i}, b_{i}\right\}$. For the base case $n=1$, one can simply set $A_{2}=\{2,3,4\}$. For the induction step, we need the following simple lemma.

Lemma. Suppose that the numbers $a<b<c$ form an obtuse triple, and let $x$ be any positive number. Then the triple $\{a, b+x, c+x\}$ is also obtuse.

Proof. The numbers $a<b+x<c+x$ are the sides of a triangle because $(c+x)-(b+x)=$ $c-b<a$. This triangle is obtuse since $(c+x)^{2}-(b+x)^{2}=(c-b)(c+b+2 x)>(c-b)(c+b)>a^{2}$.

Now we turn to the induction step. Let $n>1$ and put $t=\lfloor n / 2\rfloor<n$. By the induction hypothesis, there exists a partition of the set $[2,3 t+1]$ into $t$ obtuse triples $A_{i}^{\prime}=\left\{i, a_{i}^{\prime}, b_{i}^{\prime}\right\}$ $(i \in[2, t+1])$. For the same values of $i$, define $A_{i}=\left\{i, a_{i}^{\prime}+(n-t), b_{i}^{\prime}+(n-t)\right\}$. The constructed triples are obviously disjoint, and they are obtuse by the lemma. Moreover, we have

$$
\bigcup_{i=2}^{t+1} A_{i}=[2, t+1] \cup[n+2, n+2 t+1] .
$$

Next, for each $i \in[t+2, n+1]$, define $A_{i}=\{i, n+t+i, 2 n+i\}$. All these sets are disjoint, and

$$
\bigcup_{i=t+2}^{n+1} A_{i}=[t+2, n+1] \cup[n+2 t+2,2 n+t+1] \cup[2 n+t+2,3 n+1],
$$

SO

$$
\bigcup_{i=2}^{n+1} A_{i}=[2,3 n+1] .
$$

Thus, we are left to prove that the triple $A_{i}$ is obtuse for each $i \in[t+2, n+1]$.\\
Since $(2 n+i)-(n+t+i)=n-t<t+2 \leq i$, the elements of $A_{i}$ are the sides of a triangle. Next, we have\\
$(2 n+i)^{2}-(n+t+i)^{2}=(n-t)(3 n+t+2 i) \geq \frac{n}{2} \cdot(3 n+3(t+1)+1)>\frac{n}{2} \cdot \frac{9 n}{2} \geq(n+1)^{2} \geq i^{2}$, so this triangle is obtuse. The proof is completed.",3,"Prove that if three numbers $a < b < c$ form the sides of an obtuse triangle, then for any positive number $x$, the numbers $a, b+x, c+x$ also form the sides of an obtuse triangle.","Let the ordered sides of the original obtuse triangle be $a<b<c$. They satisfy the triangle inequality $a+b > c$ and the obtuse condition $a^2+b^2 < c^2$. The new side lengths are $a' = a, b' = b+x, c' = c+x$. They form a triangle because $a'+b' = a+b+x > c+x = c'$. To check for obtuseness, we need to show $(a')^2+(b')^2 < (c')^2$, which is $a^2 + (b+x)^2 < (c+x)^2$. This simplifies to $a^2 < (c+x)^2 - (b+x)^2 = c^2 - b^2 + 2x(c-b)$. Since the original triangle is obtuse, we know $a^2 < c^2-b^2$. As $x>0$ and $c>b$, the term $2x(c-b)$ is positive. Therefore, $a^2 < c^2-b^2 < c^2-b^2+2x(c-b)$, which proves the new triangle is also obtuse.","For $n>1$, let $t=\lfloor n / 2\rfloor$. Assume the set $\{2, 3, \ldots, 3t+1\}$ can be partitioned into $t$ obtuse triples of the form $A_i'=\{i, a_i', b_i'\}$ for $i=2, \ldots, t+1$. Show how to construct a partition of the set $\{2, 3, \ldots, 3n+1\}$ into $n$ triples.","We construct $n$ disjoint triples $A_i$ for $i=2, \ldots, n+1$ whose union is $\{2, \ldots, 3n+1\}$.\n1. For $i \in \{2, \ldots, t+1\}$, define $A_i = \{i, a_i' + (n-t), b_i' + (n-t)\}$. The union of these $t$ triples is $\{2, \ldots, t+1\} \cup \{n+2, \ldots, n+2t+1\}$.\n2. For $i \in \{t+2, \ldots, n+1\}$, define $A_i = \{i, n+t+i, 2n+i\}$. The union of these $n-t$ triples is $\{t+2, \ldots, n+1\} \cup \{n+2t+2, \ldots, 2n+t+1\} \cup \{2n+t+2, \ldots, 3n+1\}$.\nThe total union of all $n$ triples is $\{2, \ldots, t+1\} \cup \{t+2, \ldots, n+1\} \cup \{n+2, \ldots, n+2t+1\} \cup \{n+2t+2, \ldots, 2n+t+1\} \cup \{2n+t+2, \ldots, 3n+1\}$, which simplifies to $\{2, \ldots, 3n+1\}$.","Prove that for every positive integer $n$, the set $\{2,3,4, \ldots, 3 n+1\}$ can be partitioned into $n$ triples in such a way that the numbers from each triple are the lengths of the sides of some obtuse triangle.","We proceed by induction on $n$. The base case $n=1$ holds, as the set $\{2,3,4\}$ forms an obtuse triangle ($2^2+3^2=13 < 4^2=16$). For the inductive step, assume the statement is true for $t=\lfloor n/2 \rfloor < n$. We partition $\{2, \ldots, 3n+1\}$ into $n$ triples as constructed in the second sub-problem. We must verify all triples are obtuse.\n1. For $i \in \{2, \ldots, t+1\}$, the triples $A_i$ are obtuse by the result of the first sub-problem, since they are formed from the obtuse triples of the partition for $t$.\n2. For $i \in \{t+2, \ldots, n+1\}$, the triple is $A_i=\{i, n+t+i, 2n+i\}$. Let $a=i, b=n+t+i, c=2n+i$. The triangle inequality holds because $c-b = n-t < t+2 \le i = a$. The triangle is obtuse if $a^2+b^2 < c^2$, which is equivalent to $i^2 < (2n+i)^2 - (n+t+i)^2 = (n-t)(3n+t+2i)$. For $n \ge 2$, this inequality holds. Thus, the constructed partition consists of $n$ obtuse triples, completing the induction.",,
2011a6,"Let $f$ be a function from the set of real numbers to itself that satisfies


\begin{equation*}
f(x+y) \leq y f(x)+f(f(x)) \tag{1}
\end{equation*}


for all real numbers $x$ and $y$. Prove that $f(x)=0$ for all $x \leq 0$.","Substituting $y=t-x$, we rewrite (1) as


\begin{equation*}
f(t) \leq t f(x)-x f(x)+f(f(x)) . \tag{2}
\end{equation*}


Consider now some real numbers $a, b$ and use (2) with $t=f(a), x=b$ as well as with $t=f(b)$, $x=a$. We get

$$
\begin{aligned}
& f(f(a))-f(f(b)) \leq f(a) f(b)-b f(b), \\
& f(f(b))-f(f(a)) \leq f(a) f(b)-a f(a) .
\end{aligned}
$$

Adding these two inequalities yields

$$
2 f(a) f(b) \geq a f(a)+b f(b) .
$$

Now, substitute $b=2 f(a)$ to obtain $2 f(a) f(b) \geq a f(a)+2 f(a) f(b)$, or $a f(a) \leq 0$. So, we get


\begin{equation*}
f(a) \geq 0 \quad \text { for all } a<0 . \tag{3}
\end{equation*}


Now suppose $f(x)>0$ for some real number $x$. From (2) we immediately get that for every $t<\frac{x f(x)-f(f(x))}{f(x)}$ we have $f(t)<0$. This contradicts (3); therefore


\begin{equation*}
f(x) \leq 0 \quad \text { for all real } x, \tag{4}
\end{equation*}


and by (3) again we get $f(x)=0$ for all $x<0$.\\
We are left to find $f(0)$. Setting $t=x<0$ in (2) we get

$$
0 \leq 0-0+f(0),
$$

so $f(0) \geq 0$. Combining this with (4) we obtain $f(0)=0$.",2,Let $f$ be a function from the set of real numbers to itself that satisfies $f(x+y) \leq y f(x)+f(f(x))$ for all real numbers $x$ and $y$. Prove that $a f(a) \leq 0$ for all real numbers $a$.,"Let $y=t-x$. The given inequality becomes $f(t) \leq (t-x)f(x) + f(f(x))$. For any real numbers $a, b$, set $(t,x)=(f(a), b)$ to get $f(f(a)) - f(f(b)) \leq f(a)f(b) - bf(b)$, and set $(t,x)=(f(b), a)$ to get $f(f(b)) - f(f(a)) \leq f(b)f(a) - af(a)$. Adding these two inequalities yields $0 \leq 2f(a)f(b) - af(a) - bf(b)$, which implies $af(a) + bf(b) \leq 2f(a)f(b)$. Let $b=2f(a)$, then $af(a) + 2f(a)f(2f(a)) \leq 2f(a)f(2f(a))$, which simplifies to $af(a) \leq 0$.",Let $f$ be a function from the set of real numbers to itself that satisfies $f(x+y) \leq y f(x)+f(f(x))$ for all real numbers $x$ and $y$. Prove that $f(x)=0$ for all $x \leq 0$.,"From the property $a f(a) \leq 0$ for all $a \in \mathbb{R}$, we have $f(a) \geq 0$ for all $a<0$. Assume for contradiction that $f(x) > 0$ for some $x$. The inequality $f(x+y) \leq yf(x) + f(f(x))$ implies that by choosing a sufficiently large negative $y$, we can make $f(x+y)$ negative. We can choose such a $y$ so that $x+y < 0$, which contradicts $f(a) \geq 0$ for $a<0$. Thus, $f(x) \leq 0$ for all $x \in \mathbb{R}$. Combining this with $f(x) \geq 0$ for $x<0$, we get $f(x)=0$ for all $x<0$. For $x=0$, we have $f(0) \leq 0$. Take any $x<0$ in the original inequality. Then $f(x)=0$, so $f(y) \leq f(0)$. Choosing $y<0$ gives $f(y)=0$, so $0 \leq f(0)$. Therefore, $f(0)=0$. Hence, $f(x)=0$ for all $x \leq 0$.",,,,
2011a7,"Let $a, b$, and $c$ be positive real numbers satisfying $\min (a+b, b+c, c+a)>\sqrt{2}$ and $a^{2}+b^{2}+c^{2}=3$. Prove that


\begin{equation*}
\frac{a}{(b+c-a)^{2}}+\frac{b}{(c+a-b)^{2}}+\frac{c}{(a+b-c)^{2}} \geq \frac{3}{(a b c)^{2}} . \tag{1}
\end{equation*}


Throughout both solutions, we denote the sums of the form $f(a, b, c)+f(b, c, a)+f(c, a, b)$ by $\sum f(a, b, c)$.","The condition $b+c>\sqrt{2}$ implies $b^{2}+c^{2}>1$, so $a^{2}=3-\left(b^{2}+c^{2}\right)<2$, i.e. $a<\sqrt{2}<b+c$. Hence we have $b+c-a>0$, and also $c+a-b>0$ and $a+b-c>0$ for similar reasons.

We will use the variant of H锟斤拷LDER's inequality

$$
\frac{x_{1}^{p+1}}{y_{1}^{p}}+\frac{x_{1}^{p+1}}{y_{1}^{p}}+\ldots+\frac{x_{n}^{p+1}}{y_{n}^{p}} \geq \frac{\left(x_{1}+x_{2}+\ldots+x_{n}\right)^{p+1}}{\left(y_{1}+y_{2}+\ldots+y_{n}\right)^{p}}
$$

which holds for all positive real numbers $p, x_{1}, x_{2}, \ldots, x_{n}, y_{1}, y_{2}, \ldots, y_{n}$. Applying it to the left-hand side of (1) with $p=2$ and $n=3$, we get


\begin{equation*}
\sum \frac{a}{(b+c-a)^{2}}=\sum \frac{\left(a^{2}\right)^{3}}{a^{5}(b+c-a)^{2}} \geq \frac{\left(a^{2}+b^{2}+c^{2}\right)^{3}}{\left(\sum a^{5 / 2}(b+c-a)\right)^{2}}=\frac{27}{\left(\sum a^{5 / 2}(b+c-a)\right)^{2}} \tag{2}
\end{equation*}


To estimate the denominator of the right-hand part, we use an instance of Schur's inequality, namely

$$
\sum a^{3 / 2}(a-b)(a-c) \geq 0,
$$

which can be rewritten as

$$
\sum a^{5 / 2}(b+c-a) \leq a b c(\sqrt{a}+\sqrt{b}+\sqrt{c}) .
$$

Moreover, by the inequality between the arithmetic mean and the fourth power mean we also have

$$
\left(\frac{\sqrt{a}+\sqrt{b}+\sqrt{c}}{3}\right)^{4} \leq \frac{a^{2}+b^{2}+c^{2}}{3}=1,
$$

i.e., $\sqrt{a}+\sqrt{b}+\sqrt{c} \leq 3$. Hence, (2) yields

$$
\sum \frac{a}{(b+c-a)^{2}} \geq \frac{27}{(a b c(\sqrt{a}+\sqrt{b}+\sqrt{c}))^{2}} \geq \frac{3}{a^{2} b^{2} c^{2}}
$$

thus solving the problem.",2,"Let $a, b, c$ be positive real numbers such that $a^2+b^2+c^2=3$. Prove that $\sum a^{5/2}(b+c-a) \leq 3abc$.","By Schur's inequality for exponent $r=3/2$, we have $\sum a^{3/2}(a-b)(a-c) \geq 0$, which is equivalent to $\sum a^{5/2}(b+c-a) \leq abc(\sqrt{a}+\sqrt{b}+\sqrt{c})$. By the Power Mean Inequality, we have $(\frac{\sqrt{a}+\sqrt{b}+\sqrt{c}}{3})^4 \leq \frac{a^2+b^2+c^2}{3} = \frac{3}{3} = 1$, which implies $\sqrt{a}+\sqrt{b}+\sqrt{c} \leq 3$. Combining these results, we get $\sum a^{5/2}(b+c-a) \leq abc(\sqrt{a}+\sqrt{b}+\sqrt{c}) \leq 3abc$.","Let $a, b$, and $c$ be positive real numbers satisfying $\min (a+b, b+c, c+a)>\sqrt{2}$ and $a^{2}+b^{2}+c^{2}=3$. Prove that $\frac{a}{(b+c-a)^{2}}+\frac{b}{(c+a-b)^{2}}+\frac{c}{(a+b-c)^{2}} \geq \frac{3}{(a b c)^{2}}$.","The condition $b+c>\sqrt{2}$ implies $b^2+c^2>1$, so $a^2=3-(b^2+c^2)<2$, which means $a<\sqrt{2}<b+c$. Thus, $b+c-a>0$, and similarly for the other denominators. We apply H\""older's inequality, $\sum \frac{x_i^3}{y_i^2} \ge \frac{(\sum x_i)^3}{(\sum y_i)^2}$, by rewriting the left hand side of the inequality as $\sum \frac{(a^2)^3}{(a^{5/2}(b+c-a))^2}$. This gives $\sum \frac{a}{(b+c-a)^2} \geq \frac{(a^2+b^2+c^2)^3}{(\sum a^{5/2}(b+c-a))^2} = \frac{27}{(\sum a^{5/2}(b+c-a))^2}$. Using the result from the previous sub-problem, $\sum a^{5/2}(b+c-a) \leq 3abc$, we have $(\sum a^{5/2}(b+c-a))^2 \leq (3abc)^2 = 9a^2b^2c^2$. Therefore, $\sum \frac{a}{(b+c-a)^2} \geq \frac{27}{9a^2b^2c^2} = \frac{3}{(abc)^2}$.",,,,
2011c2,"Suppose that 1000 students are standing in a circle. Prove that there exists an integer $k$ with $100 \leq k \leq 300$ such that in this circle there exists a contiguous group of $2 k$ students, for which the first half contains the same number of girls as the second half.","Solution. Number the students consecutively from 1 to 1000 . Let $a_{i}=1$ if the $i$ th student is a girl, and $a_{i}=0$ otherwise. We expand this notion for all integers $i$ by setting $a_{i+1000}=$ $a_{i-1000}=a_{i}$. Next, let

$$
S_{k}(i)=a_{i}+a_{i+1}+\cdots+a_{i+k-1} .
$$

Now the statement of the problem can be reformulated as follows:\\
There exist an integer $k$ with $100 \leq k \leq 300$ and an index $i$ such that $S_{k}(i)=S_{k}(i+k)$.\\
Assume now that this statement is false. Choose an index $i$ such that $S_{100}(i)$ attains the maximal possible value. In particular, we have $S_{100}(i-100)-S_{100}(i)<0$ and $S_{100}(i)-S_{100}(i+100)>0$, for if we had an equality, then the statement would hold. This means that the function $S(j)$ $S(j+100)$ changes sign somewhere on the segment $[i-100, i]$, so there exists some index $j \in$ [ $i-100, i-1]$ such that


\begin{equation*}
S_{100}(j) \leq S_{100}(j+100)-1, \quad \text { but } \quad S_{100}(j+1) \geq S_{100}(j+101)+1 . \tag{1}
\end{equation*}


Subtracting the first inequality from the second one, we get $a_{j+100}-a_{j} \geq a_{j+200}-a_{j+100}+2$, so

$$
a_{j}=0, \quad a_{j+100}=1, \quad a_{j+200}=0 .
$$

Substituting this into the inequalities of (1), we also obtain $S_{99}(j+1) \leq S_{99}(j+101) \leq S_{99}(j+1)$, which implies


\begin{equation*}
S_{99}(j+1)=S_{99}(j+101) . \tag{2}
\end{equation*}


Now let $k$ and $\ell$ be the least positive integers such that $a_{j-k}=1$ and $a_{j+200+\ell}=1$. By symmetry, we may assume that $k \geq \ell$. If $k \geq 200$ then we have $a_{j}=a_{j-1}=\cdots=a_{j-199}=0$, so $S_{100}(j-199)=S_{100}(j-99)=0$, which contradicts the initial assumption. Hence $\ell \leq k \leq 199$. Finally, we have

$$
\begin{gathered}
S_{100+\ell}(j-\ell+1)=\left(a_{j-\ell+1}+\cdots+a_{j}\right)+S_{99}(j+1)+a_{j+100}=S_{99}(j+1)+1, \\
S_{100+\ell}(j+101)=S_{99}(j+101)+\left(a_{j+200}+\cdots+a_{j+200+\ell-1}\right)+a_{j+200+\ell}=S_{99}(j+101)+1 .
\end{gathered}
$$

Comparing with (2) we get $S_{100+\ell}(j-\ell+1)=S_{100+\ell}(j+101)$ and $100+\ell \leq 299$, which again contradicts our assumption.

Comment. It may be seen from the solution that the number 300 from the problem statement can be\\
replaced by 299. Here we consider some improvements of this result. Namely, we investigate which interval can be put instead of $[100,300]$ in order to keep the problem statement valid.

First of all, the two examples

$$
\underbrace{1,1, \ldots, 1}_{167}, \underbrace{0,0, \ldots, 0}_{167}, \underbrace{1,1, \ldots, 1}_{167}, \underbrace{0,0, \ldots, 0}_{167}, \underbrace{1,1, \ldots, 1}_{167}, \underbrace{0,0, \ldots, 0}_{165}
$$

and

$$
\underbrace{1,1, \ldots, 1}_{249}, \underbrace{0,0, \ldots, 0}_{251}, \underbrace{1,1, \ldots, 1}_{249}, \underbrace{0,0, \ldots, 0}_{251}
$$

show that the interval can be changed neither to $[84,248]$ nor to $[126,374]$.\\[0pt]
On the other hand, we claim that this interval can be changed to [125, 250]. Note that this statement is invariant under replacing all 1's by 0's and vice versa. Assume, to the contrary, that there is no admissible $k \in[125,250]$. The arguments from the solution easily yield the following lemma.

Lemma. Under our assumption, suppose that for some indices $i<j$ we have $S_{125}(i) \leq S_{125}(i+125)$ but $S_{125}(j) \geq S_{125}(j+125)$. Then there exists some $t \in[i, j-1]$ such that $a_{t}=a_{t-1}=\cdots=a_{t-125}=0$ and $a_{t+250}=a_{t+251}=\cdots=a_{t+375}=0$.

Let us call a segment $[i, j]$ of indices a crowd, if (a) $a_{i}=a_{i+1}=\cdots=a_{j}$, but $a_{i-1} \neq a_{i} \neq a_{j+1}$, and (b) $j-i \geq 125$. Now, using the lemma, one can get in the same way as in the solution that there exists some crowd. Take all the crowds in the circle, and enumerate them in cyclic order as $A_{1}, \ldots, A_{d}$. We also assume always that $A_{s+d}=A_{s-d}=A_{s}$.

Consider one of the crowds, say $A_{1}$. We have $A_{1}=[i, i+t]$ with $125 \leq t \leq 248$ (if $t \geq 249$, then $a_{i}=a_{i+1}=\cdots=a_{i+249}$ and therefore $S_{125}(i)=S_{125}(i+125)$, which contradicts our assumption). We may assume that $a_{i}=1$. Then we have $S_{125}(i+t-249) \leq 125=S_{125}(i+t-124)$ and $S_{125}(i)=125 \geq S_{125}(i+125)$, so by the lemma there exists some index $j \in[i+t-249, i-1]$ such that the segments $[j-125, j]$ and $[j+250, j+375]$ are contained in some crowds.

Let us fix such $j$ and denote the segment $[j+1, j+249]$ by $B_{1}$. Clearly, $A_{1} \subseteq B_{1}$. Moreover, $B_{1}$ cannot contain any crowd other than $A_{1}$ since $\left|B_{1}\right|=249<2 \cdot 126$. Hence it is clear that $j \in A_{d}$ and $j+250 \in A_{2}$. In particular, this means that the genders of $A_{d}$ and $A_{2}$ are different from that of $A_{1}$.

Performing this procedure for every crowd $A_{s}$, we find segments $B_{s}=\left[j_{s}+1, j_{s}+249\right]$ such that $\left|B_{s}\right|=249, A_{s} \subseteq B_{s}$, and $j_{s} \in A_{s-1}, j_{s}+250 \in A_{s+1}$. So, $B_{s}$ covers the whole segment between $A_{s-1}$ and $A_{s+1}$, hence the sets $B_{1}, \ldots, B_{d}$ cover some 1000 consecutive indices. This implies $249 d \geq 1000$, and $d \geq 5$. Moreover, the gender of $A_{i}$ is alternating, so $d$ is even; therefore $d \geq 6$.

Consider now three segments $A_{1}=\left[i_{1}, i_{1}^{\prime}\right], B_{2}=\left[j_{2}+1, j_{2}+249\right]$, $A_{3}=\left[i_{3}, i_{3}^{\prime}\right]$. By construction, we have $\left[j_{2}-125, j_{2}\right] \subseteq A_{1}$ and $\left[j_{2}+250, j_{2}+375\right] \subseteq A_{3}$, whence $i_{1} \leq j_{2}-125, i_{3}^{\prime} \geq j_{2}+375$. Therefore $i_{3}^{\prime}-i_{1} \geq 500$. Analogously, if $A_{4}=\left[i_{4}, i_{4}^{\prime}\right], A_{6}=\left[i_{6}, i_{6}^{\prime}\right]$ then $i_{6}^{\prime}-i_{4} \geq 500$. But from $d \geq 6$ we get $i_{1}<i_{3}^{\prime}<i_{4}<i_{6}^{\prime}<i_{1}+1000$, so $1000>\left(i_{3}^{\prime}-i_{1}\right)+\left(i_{6}^{\prime}-i_{4}\right) \geq 500+500$. This final contradiction shows that our claim holds.

One may even show that the interval in the statement of the problem may be replaced by [125, 249] (both these numbers cannot be improved due to the examples above). But a proof of this fact is a bit messy, and we do not present it here.",4,"Formalize the problem using a binary sequence and sum notation. Then, state the initial assumption for a proof by contradiction: for any integer $k$ with $100 \leq k \leq 300$, and any starting position $i$, the number of girls in a contiguous block of $2k$ students is not equal in the first and second halves.","Let $a_i=1$ if student $i$ is a girl and $a_i=0$ otherwise, for $i=1, \dots, 1000$ with indices taken modulo 1000. Let $S_k(i) = \sum_{j=0}^{k-1} a_{i+j}$ be the number of girls in a block of $k$ students starting at position $i$. The problem is to prove that there exist $k \in [100, 300]$ and an index $i$ such that $S_k(i) = S_k(i+k)$. For a proof by contradiction, we assume this is false: for all $k \in [100, 300]$ and all $i$, $S_k(i) \neq S_k(i+k)$.","Assuming the contrary, show that for $k=100$, the function $D_{100}(i) = S_{100}(i) - S_{100}(i+100)$ must change sign. Use this to prove there is an index $j$ such that $a_j=0, a_{j+100}=1$, and $a_{j+200}=0$.","By our assumption, $D_{100}(i) = S_{100}(i) - S_{100}(i+100) \neq 0$ for all $i$. Since $\sum_{i=1}^{1000} D_{100}(i) = 0$, $D_{100}(i)$ must take both positive and negative values. Thus, there exists an index $j$ where the sign changes, such that $S_{100}(j) \leq S_{100}(j+100)-1$ and $S_{100}(j+1) \geq S_{100}(j+101)+1$. Expressing $S_{100}(i+1)$ in terms of $S_{100}(i)$ and the $a_i$ values, we combine these inequalities to derive $2a_{j+100}-a_j-a_{j+200} \geq 2$. As $a_i \in \{0,1\}$, this forces $a_j=0, a_{j+100}=1, a_{j+200}=0$.","Using the specific student configuration found at positions $j$, $j+100$, and $j+200$, prove that an equality must hold for the number of girls in two specific blocks of size 99, namely $S_{99}(j+1) = S_{99}(j+101)$.","The condition $a_j=0, a_{j+100}=1, a_{j+200}=0$ makes the inequality $2a_{j+100}-a_j-a_{j+200} \geq 2$ an equality. This implies the two integer inequalities from which it was derived are also tight: $S_{100}(j) = S_{100}(j+100)-1$ and $S_{100}(j+1) = S_{100}(j+101)+1$. Substituting the values for $a_j, a_{j+100}, a_{j+200}$ and rewriting $S_{100}$ in terms of $S_{99}$ gives $S_{99}(j+1) \leq S_{99}(j+101)$ from the first equality, and $S_{99}(j+1) \geq S_{99}(j+101)$ from the second. This forces the equality $S_{99}(j+1) = S_{99}(j+101)$.","Suppose that 1000 students are standing in a circle. Prove that there exists an integer $k$ with $100 \leq k \leq 300$ such that in this circle there exists a contiguous group of $2 k$ students, for which the first half contains the same number of girls as the second half.","Let $\ell$ be the least positive integer such that $a_{j+200+\ell}=1$, and $k_{min}$ be the least positive integer such that $a_{j-k_{min}}=1$. Assume WLOG $k_{min} \ge \ell$. We must have $k_{min}<200$, otherwise $S_{100}(j-199)=S_{100}(j-99)=0$, a contradiction. Define $k' = 100+\ell$. Then $101 \leq k' \leq 299$, which is in the desired range. Let $i' = j-\ell+1$. Using the equality $S_{99}(j+1) = S_{99}(j+101)$ and the definitions of $\ell$ and $k_{min}$, we calculate $S_{k'}(i') = S_{100+\ell}(j-\ell+1) = S_{99}(j+1)+1$ and $S_{k'}(i'+k') = S_{100+\ell}(j+101) = S_{99}(j+101)+1$. Thus, $S_{k'}(i')=S_{k'}(i'+k')$. This is a contradiction to our initial assumption, proving the statement."
2011c3,"Let $\mathcal{S}$ be a finite set of at least two points in the plane. Assume that no three points of $\mathcal{S}$ are collinear. By a windmill we mean a process as follows. Start with a line $\ell$ going through a point $P \in \mathcal{S}$. Rotate $\ell$ clockwise around the pivot $P$ until the line contains another point $Q$ of $\mathcal{S}$. The point $Q$ now takes over as the new pivot. This process continues indefinitely, with the pivot always being a point from $\mathcal{S}$.

Show that for a suitable $P \in \mathcal{S}$ and a suitable starting line $\ell$ containing $P$, the resulting windmill will visit each point of $\mathcal{S}$ as a pivot infinitely often.","Solution. Give the rotating line an orientation and distinguish its sides as the oranje side and the blue side. Notice that whenever the pivot changes from some point $T$ to another point $U$, after the change, $T$ is on the same side as $U$ was before. Therefore, the number of elements of $\mathcal{S}$ on the oranje side and the number of those on the blue side remain the same throughout the whole process (except for those moments when the line contains two points).\\
\includegraphics[max width=\textwidth, center]{2025_05_04_e6233e4fb964804c4c48g-32}

First consider the case that $|\mathcal{S}|=2 n+1$ is odd. We claim that through any point $T \in \mathcal{S}$, there is a line that has $n$ points on each side. To see this, choose an oriented line through $T$ containing no other point of $\mathcal{S}$ and suppose that it has $n+r$ points on its oranje side. If $r=0$ then we have established the claim, so we may assume that $r \neq 0$. As the line rotates through $180^{\circ}$ around $T$, the number of points of $\mathcal{S}$ on its oranje side changes by 1 whenever the line passes through a point; after $180^{\circ}$, the number of points on the oranje side is $n-r$. Therefore there is an intermediate stage at which the oranje side, and thus also the blue side, contains $n$ points.

Now select the point $P$ arbitrarily, and choose a line through $P$ that has $n$ points of $\mathcal{S}$ on each side to be the initial state of the windmill. We will show that during a rotation over $180^{\circ}$, the line of the windmill visits each point of $\mathcal{S}$ as a pivot. To see this, select any point $T$ of $\mathcal{S}$ and select a line $\ell$ through $T$ that separates $\mathcal{S}$ into equal halves. The point $T$ is the unique point of $\mathcal{S}$ through which a line in this direction can separate the points of $\mathcal{S}$ into equal halves (parallel translation would disturb the balance). Therefore, when the windmill line is parallel to $\ell$, it must be $\ell$ itself, and so pass through $T$.

Next suppose that $|\mathcal{S}|=2 n$. Similarly to the odd case, for every $T \in \mathcal{S}$ there is an oriented\\
line through $T$ with $n-1$ points on its oranje side and $n$ points on its blue side. Select such an oriented line through an arbitrary $P$ to be the initial state of the windmill.

We will now show that during a rotation over $360^{\circ}$, the line of the windmill visits each point of $\mathcal{S}$ as a pivot. To see this, select any point $T$ of $\mathcal{S}$ and an oriented line $\ell$ through $T$ that separates $\mathcal{S}$ into two subsets with $n-1$ points on its oranje and $n$ points on its blue side. Again, parallel translation would change the numbers of points on the two sides, so when the windmill line is parallel to $\ell$ with the same orientation, the windmill line must pass through $T$.

Comment. One may shorten this solution in the following way.\\
Suppose that $|\mathcal{S}|=2 n+1$. Consider any line $\ell$ that separates $\mathcal{S}$ into equal halves; this line is unique given its direction and contains some point $T \in \mathcal{S}$. Consider the windmill starting from this line. When the line has made a rotation of $180^{\circ}$, it returns to the same location but the oranje side becomes blue and vice versa. So, for each point there should have been a moment when it appeared as pivot, as this is the only way for a point to pass from on side to the other.

Now suppose that $|\mathcal{S}|=2 n$. Consider a line having $n-1$ and $n$ points on the two sides; it contains some point $T$. Consider the windmill starting from this line. After having made a rotation of $180^{\circ}$, the windmill line contains some different point $R$, and each point different from $T$ and $R$ has changed the color of its side. So, the windmill should have passed through all the points.",4,"Define an oriented line with two distinct sides. Show that during the windmill process, the number of points from $\mathcal{S}$ on each side of the line remains constant.","Let the line have an orange side and a blue side. When the pivot changes from a point $T$ to a point $Q$, $Q$ was on one side (say, orange) before the switch and on the line after. $T$ was on the line before the switch and is on the orange side after. All other points remain on their respective sides. Thus, the number of points on the orange side and on the blue side is an invariant of the process.","Let $|\mathcal{S}| = 2n+1$ be odd. Show that for any point $P \in \mathcal{S}$, there exists a line $\ell$ through $P$ that partitions the remaining $2n$ points of $\mathcal{S}$ into two sets of $n$ points.","Take an oriented line through $P$. Let it have $k$ points on its orange side. As we rotate the line by 180 degrees around $P$, the orange and blue sides swap. The number of points on the orange side becomes $2n-k$. Since the number of points on a side changes by at most 1 each time the line passes through a point of $\mathcal{S}$, by a discrete version of the Intermediate Value Theorem, there must be a position for the line where it has exactly $n$ points on its orange side.","Let $|\mathcal{S}| = 2n$ be even. Show that for any point $P \in \mathcal{S}$, there exists an oriented line $\ell$ through $P$ that partitions the remaining $2n-1$ points of $\mathcal{S}$ into a set of $n-1$ points on one side and $n$ points on the other.","Take an oriented line through $P$. Let the number of points on its orange and blue sides be $k$ and $2n-1-k$. The difference is $k - (2n-1-k) = 2k-2n+1$. After a 180-degree rotation, the sides are swapped and the difference becomes $(2n-1-k)-k = 2n-1-2k$, which is the negative of the original. Since the difference must change sign and is always odd, it must take values 1 or -1 at some orientation. This corresponds to a partition of $n$ and $n-1$ points.","Show that for a suitable $P \in \mathcal{S}$ and a suitable starting line $\ell$ containing $P$, the resulting windmill will visit each point of $\mathcal{S}$ as a pivot infinitely often.","First, choose any point $P \in \mathcal{S}$. If $|\mathcal{S}|=2n+1$, choose the starting line $\ell$ to partition $\mathcal{S}$ into $n$ points on each side (guaranteed by Sub-problem 2). If $|\mathcal{S}|=2n$, choose $\ell$ to partition $\mathcal{S}$ into $n-1$ and $n$ points (guaranteed by Sub-problem 3). By Sub-problem 1, this partition balance is an invariant. For any point $Q \in \mathcal{S}$, there exists a line through $Q$ with this same partition property. As no three points are collinear, this line is unique for a given direction. Therefore, when the windmill's line assumes that direction, it must pass through $Q$, making $Q$ a pivot. As the line rotates through all directions, it visits every point. Since the process continues indefinitely, each point is visited infinitely often."
2011c6,"Let $n$ be a positive integer and let $W=\ldots x_{-1} x_{0} x_{1} x_{2} \ldots$ be an infinite periodic word consisting of the letters $a$ and $b$. Suppose that the minimal period $N$ of $W$ is greater than $2^{n}$.

A finite nonempty word $U$ is said to appear in $W$ if there exist indices $k \leq \ell$ such that $U=x_{k} x_{k+1} \ldots x_{\ell}$. A finite word $U$ is called ubiquitous if the four words $U a, U b, a U$, and $b U$ all appear in $W$. Prove that there are at least $n$ ubiquitous finite nonempty words.","Solution. Throughout the solution, all the words are nonempty. For any word $R$ of length $m$, we call the number of indices $i \in\{1,2, \ldots, N\}$ for which $R$ coincides with the subword $x_{i+1} x_{i+2} \ldots x_{i+m}$ of $W$ the multiplicity of $R$ and denote it by $\mu(R)$. Thus a word $R$ appears in $W$ if and only if $\mu(R)>0$. Since each occurrence of a word in $W$ is both succeeded by either the letter $a$ or the letter $b$ and similarly preceded by one of those two letters, we have


\begin{equation*}
\mu(R)=\mu(R a)+\mu(R b)=\mu(a R)+\mu(b R) \tag{1}
\end{equation*}


for all words $R$.\\
We claim that the condition that $N$ is in fact the minimal period of $W$ guarantees that each word of length $N$ has multiplicity 1 or 0 depending on whether it appears or not. Indeed, if the words $x_{i+1} x_{i+2} \ldots x_{i+N}$ and $x_{j+1} \ldots x_{j+N}$ are equal for some $1 \leq i<j \leq N$, then we have $x_{i+a}=x_{j+a}$ for every integer $a$, and hence $j-i$ is also a period.

Moreover, since $N>2^{n}$, at least one of the two words $a$ and $b$ has a multiplicity that is strictly larger than $2^{n-1}$.

For each $k=0,1, \ldots, n-1$, let $U_{k}$ be a subword of $W$ whose multiplicity is strictly larger than $2^{k}$ and whose length is maximal subject to this property. Note that such a word exists in view of the two observations made in the two previous paragraphs.

Fix some index $k \in\{0,1, \ldots, n-1\}$. Since the word $U_{k} b$ is longer than $U_{k}$, its multiplicity can be at most $2^{k}$, so in particular $\mu\left(U_{k} b\right)<\mu\left(U_{k}\right)$. Therefore, the word $U_{k} a$ has to appear by (1). For a similar reason, the words $U_{k} b, a U_{k}$, and $b U_{k}$ have to appear as well. Hence, the word $U_{k}$ is ubiquitous. Moreover, if the multiplicity of $U_{k}$ were strictly greater than $2^{k+1}$, then by (1) at least one of the two words $U_{k} a$ and $U_{k} b$ would have multiplicity greater than $2^{k}$ and would thus violate the maximality condition imposed on $U_{k}$.

So we have $\mu\left(U_{0}\right) \leq 2<\mu\left(U_{1}\right) \leq 4<\ldots \leq 2^{n-1}<\mu\left(U_{n-1}\right)$, which implies in particular that the words $U_{0}, U_{1}, \ldots, U_{n-1}$ have to be distinct. As they have been proved to be ubiquitous as well, the problem is solved.

Comment 1. There is an easy construction for obtaining ubiquitous words from appearing words whose multiplicity is at least two. Starting with any such word $U$ we may simply extend one of its occurrences in $W$ forwards and backwards as long as its multiplicity remains fixed, thus arriving at a\\
word that one might call the ubiquitous prolongation $p(U)$ of $U$.\\
There are several variants of the argument in the second half of the solution using the concept of prolongation. For instance, one may just take all ubiquitous words $U_{1}, U_{2}, \ldots, U_{\ell}$ ordered by increasing multiplicity and then prove for $i \in\{1,2, \ldots, \ell\}$ that $\mu\left(U_{i}\right) \leq 2^{i}$. Indeed, assume that $i$ is a minimal counterexample to this statement; then by the arguments similar to those presented above, the ubiquitous prolongation of one of the words $U_{i} a, U_{i} b, a U_{i}$ or $b U_{i}$ violates the definition of $U_{i}$.\\
Now the multiplicity of one of the two letters $a$ and $b$ is strictly greater than $2^{n-1}$, so passing to ubiquitous prolongations once more we obtain $2^{n-1}<\mu\left(U_{\ell}\right) \leq 2^{\ell}$, which entails $\ell \geq n$, as needed.

Comment 2. The bound $n$ for the number of ubiquitous subwords in the problem statement is not optimal, but it is close to an optimal one in the following sense. There is a universal constant $C>0$ such that for each positive integer $n$ there exists an infinite periodic word $W$ whose minimal period is greater than $2^{n}$ but for which there exist fewer than $C n$ ubiquitous words.",4,"For any finite word $R$ appearing in $W$, let $\mu(R)$ be its multiplicity (the number of times it appears as a subword $x_{i+1}...x_{i+m}$ for $i \in \{1, ..., N\}$). Prove that $\mu(R) = \mu(Ra) + \mu(Rb)$ and $\mu(R) = \mu(aR) + \mu(bR)$.","Each occurrence of the word $R$ in the periodic word $W$ must be succeeded by either the letter 'a' or 'b'. Occurrences of $R$ succeeded by 'a' correspond precisely to occurrences of the word $Ra$, and those succeeded by 'b' correspond to occurrences of $Rb$. As these two sets of occurrences are disjoint and their union accounts for all occurrences of $R$, we have $\mu(R) = \mu(Ra) + \mu(Rb)$. The identity $\mu(R) = \mu(aR) + \mu(bR)$ follows from a symmetric argument on the letter preceding each occurrence of $R$.",Show that there exists a finite word $U$ appearing in $W$ such that its multiplicity $\mu(U) > 2^{n-1}$.,"The sum of the multiplicities of the single-letter words 'a' and 'b' is equal to the length of the period, so $\mu(a) + \mu(b) = N$. Since we are given that the minimal period $N > 2^n$, it follows that $\mu(a) + \mu(b) > 2^n$. Therefore, at least one of $\mu(a)$ or $\mu(b)$ must be strictly greater than $2^n/2 = 2^{n-1}$. The corresponding letter is a word with the required property.","For any integer $k \ge 0$, show that if there exists a word with multiplicity greater than $2^k$, then there exists a ubiquitous word $U_k$ with multiplicity $\mu(U_k) > 2^k$.","Let $S_k$ be the set of all words in $W$ with multiplicity greater than $2^k$; by hypothesis, this set is non-empty. Let $U_k$ be a word in $S_k$ of maximal possible length. By definition, $\mu(U_k) > 2^k$. Consider the word $U_ka$. It is longer than $U_k$, so by the maximality of $U_k$'s length, its multiplicity must be $\mu(U_ka) \le 2^k$. If $\mu(U_ka)$ were 0, then from the identity in Sub-problem 1, $\mu(U_kb) = \mu(U_k) > 2^k$. But $U_kb$ is also longer than $U_k$, which contradicts the maximality of $U_k$'s length. Thus, $\mu(U_ka) > 0$. A symmetric argument shows $\mu(U_kb) > 0$. Using the identity $\mu(R) = \mu(aR)+\mu(bR)$, similar arguments prove that $\mu(aU_k)>0$ and $\mu(bU_k)>0$. So $U_ka, U_kb, aU_k, bU_k$ all appear in $W$, which means $U_k$ is ubiquitous.",Prove that there are at least $n$ ubiquitous finite nonempty words.,"For each integer $k \in \{0, 1, \ldots, n-1\}$, we have $N > 2^n > 2^k$. By Sub-problem 2, a word exists with multiplicity $>2^k$. By Sub-problem 3, we can then define a ubiquitous word $U_k$ to be a word of maximal length subject to the property $\mu(U_k) > 2^k$. If $\mu(U_k)$ were greater than $2^{k+1}$, then from $\mu(U_k) = \mu(U_ka) + \mu(U_kb)$, at least one of $\mu(U_ka)$ or $\mu(U_kb)$ would have to be greater than $2^k$. This would contradict the maximal length of $U_k$, since both $U_ka$ and $U_kb$ are longer. Therefore, we must have the bounds $2^k < \mu(U_k) \le 2^{k+1}$ for each $k$. This gives a sequence of inequalities $\mu(U_0) \le 2 < \mu(U_1) \le 4 < \ldots < \mu(U_{n-1})$. Since their multiplicities are strictly increasing, the words $U_0, U_1, \ldots, U_{n-1}$ must all be distinct. We have thus found $n$ distinct ubiquitous words."
2011g1,Let $A B C$ be an acute triangle. Let $\omega$ be a circle whose center $L$ lies on the side $B C$. Suppose that $\omega$ is tangent to $A B$ at $B^{\prime}$ and to $A C$ at $C^{\prime}$. Suppose also that the circumcenter $O$ of the triangle $A B C$ lies on the shorter arc $B^{\prime} C^{\prime}$ of $\omega$. Prove that the circumcircle of $A B C$ and $\omega$ meet at two points.,"Solution. The point $B^{\prime}$, being the perpendicular foot of $L$, is an interior point of side $A B$. Analogously, $C^{\prime}$ lies in the interior of $A C$. The point $O$ is located inside the triangle $A B^{\prime} C^{\prime}$, hence $\angle C O B<\angle C^{\prime} O B^{\prime}$.\\
\includegraphics[max width=\textwidth, center]{2025_05_04_e6233e4fb964804c4c48g-45}

Let $\alpha=\angle C A B$. The angles $\angle C A B$ and $\angle C^{\prime} O B^{\prime}$ are inscribed into the two circles with centers $O$ and $L$, respectively, so $\angle C O B=2 \angle C A B=2 \alpha$ and $2 \angle C^{\prime} O B^{\prime}=360^{\circ}-\angle C^{\prime} L B^{\prime}$. From the kite $A B^{\prime} L C^{\prime}$ we have $\angle C^{\prime} L B^{\prime}=180^{\circ}-\angle C^{\prime} A B^{\prime}=180^{\circ}-\alpha$. Combining these, we get

$$
2 \alpha=\angle C O B<\angle C^{\prime} O B^{\prime}=\frac{360^{\circ}-\angle C^{\prime} L B^{\prime}}{2}=\frac{360^{\circ}-\left(180^{\circ}-\alpha\right)}{2}=90^{\circ}+\frac{\alpha}{2},
$$

so

$$
\alpha<60^{\circ} .
$$

Let $O^{\prime}$ be the reflection of $O$ in the line $B C$. In the quadrilateral $A B O^{\prime} C$ we have

$$
\angle C O^{\prime} B+\angle C A B=\angle C O B+\angle C A B=2 \alpha+\alpha<180^{\circ},
$$

so the point $O^{\prime}$ is outside the circle $A B C$. Hence, $O$ and $O^{\prime}$ are two points of $\omega$ such that one of them lies inside the circumcircle, while the other one is located outside. Therefore, the two circles intersect.

Comment. There are different ways of reducing the statement of the problem to the case $\alpha<60^{\circ}$. E.g., since the point $O$ lies in the interior of the isosceles triangle $A B^{\prime} C^{\prime}$, we have $O A<A B^{\prime}$. So, if $A B^{\prime} \leq 2 L B^{\prime}$ then $O A<2 L O$, which means that $\omega$ intersects the circumcircle of $A B C$. Hence the only interesting case is $A B^{\prime}>2 L B^{\prime}$, and this condition implies $\angle C A B=2 \angle B^{\prime} A L<2 \cdot 30^{\circ}=60^{\circ}$.",3,"Let $\alpha = \angle CAB$. Using the geometric conditions of the problem, particularly that the circumcenter $O$ lies on the shorter arc $B'C'$ of circle $\omega$, establish an inequality for $\alpha$ and prove that $\alpha < 60^\circ$.","The circumcenter $O$ is inside $\triangle AB'C'$, which implies $\angle COB < \angle C'OB'$. The angle at the circumcenter is $\angle COB = 2\angle CAB = 2\alpha$. In the kite $AB'LC'$, the angle at the center $L$ is $\angle B'LC' = 180^\circ - \alpha$. Since $O$ lies on the shorter arc $B'C'$ of $\omega$, the angle subtended is $\angle C'OB' = \frac{1}{2}(360^\circ - (180^\circ - \alpha)) = 90^\circ + \alpha/2$. The inequality $2\alpha < 90^\circ + \alpha/2$ gives $3\alpha/2 < 90^\circ$, which simplifies to $\alpha < 60^\circ$.",Let $O'$ be the reflection of the circumcenter $O$ across the line $BC$. Prove that $O'$ lies on circle $\omega$ and is outside the circumcircle of $\triangle ABC$.,"The center $L$ of circle $\omega$ lies on the line of reflection $BC$. Since $O$ is on $\omega$ (with center $L$), its reflection $O'$ across a line passing through the center must also lie on $\omega$. To show $O'$ is outside the circumcircle of $\triangle ABC$, we consider the sum of opposite angles in the quadrilateral $ABO'C$. We have $\angle CAB = \alpha$. Since reflection is an isometry, $\angle CO'B = \angle COB = 2\alpha$. The sum is $\angle CAB + \angle CO'B = \alpha + 2\alpha = 3\alpha$. From the previous sub-problem, $\alpha < 60^\circ$, so $3\alpha < 180^\circ$. This implies that the point $O'$ lies outside the circumcircle of $\triangle ABC$.",Let $A B C$ be an acute triangle. Let $\omega$ be a circle whose center $L$ lies on the side $B C$. Suppose that $\omega$ is tangent to $A B$ at $B^{\prime}$ and to $A C$ at $C^{\prime}$. Suppose also that the circumcenter $O$ of the triangle $A B C$ lies on the shorter arc $B^{\prime} C^{\prime}$ of $\omega$. Prove that the circumcircle of $A B C$ and $\omega$ meet at two points.,"The circumcenter $O$ is the center of the circumcircle of $\triangle ABC$ and thus lies inside it. By the problem statement, $O$ also lies on circle $\omega$. Let $O'$ be the reflection of $O$ in the line $BC$. As established in the previous step, $O'$ also lies on $\omega$ and is located outside the circumcircle of $\triangle ABC$. Since circle $\omega$ is a continuous path containing a point $O$ inside the circumcircle and a point $O'$ outside it, the two circles must intersect. As they are distinct circles and not tangent, they must meet at two distinct points.",,
2011g2,"Let $A_{1} A_{2} A_{3} A_{4}$ be a non-cyclic quadrilateral. Let $O_{1}$ and $r_{1}$ be the circumcenter and the circumradius of the triangle $A_{2} A_{3} A_{4}$. Define $O_{2}, O_{3}, O_{4}$ and $r_{2}, r_{3}, r_{4}$ in a similar way. Prove that

$$
\frac{1}{O_{1} A_{1}^{2}-r_{1}^{2}}+\frac{1}{O_{2} A_{2}^{2}-r_{2}^{2}}+\frac{1}{O_{3} A_{3}^{2}-r_{3}^{2}}+\frac{1}{O_{4} A_{4}^{2}-r_{4}^{2}}=0 .
$$","Let $M$ be the point of intersection of the diagonals $A_{1} A_{3}$ and $A_{2} A_{4}$. On each diagonal choose a direction and let $x, y, z$, and $w$ be the signed distances from $M$ to the points $A_{1}, A_{2}, A_{3}$, and $A_{4}$, respectively.

Let $\omega_{1}$ be the circumcircle of the triangle $A_{2} A_{3} A_{4}$ and let $B_{1}$ be the second intersection point of $\omega_{1}$ and $A_{1} A_{3}$ (thus, $B_{1}=A_{3}$ if and only if $A_{1} A_{3}$ is tangent to $\omega_{1}$ ). Since the expression $O_{1} A_{1}^{2}-r_{1}^{2}$ is the power of the point $A_{1}$ with respect to $\omega_{1}$, we get

$$
O_{1} A_{1}^{2}-r_{1}^{2}=A_{1} B_{1} \cdot A_{1} A_{3} .
$$

On the other hand, from the equality $M B_{1} \cdot M A_{3}=M A_{2} \cdot M A_{4}$ we obtain $M B_{1}=y w / z$. Hence, we have

$$
O_{1} A_{1}^{2}-r_{1}^{2}=\left(\frac{y w}{z}-x\right)(z-x)=\frac{z-x}{z}(y w-x z) .
$$

Substituting the analogous expressions into the sought sum we get

$$
\sum_{i=1}^{4} \frac{1}{O_{i} A_{i}^{2}-r_{i}^{2}}=\frac{1}{y w-x z}\left(\frac{z}{z-x}-\frac{w}{w-y}+\frac{x}{x-z}-\frac{y}{y-w}\right)=0,
$$

as desired.",2,"Let $M$ be the intersection of the diagonals $A_1A_3$ and $A_2A_4$. Let $x, y, z, w$ be the signed distances from $M$ to $A_1, A_2, A_3, A_4$ respectively, along the lines containing the diagonals. Express the quantity $O_1 A_1^2 - r_1^2$ in terms of $x, y, z, w$.","The expression $O_1 A_1^2 - r_1^2$ is the power of point $A_1$ with respect to the circumcircle of $\triangle A_2 A_3 A_4$, which we call $\omega_1$. Let the line $A_1A_3$ intersect $\omega_1$ at a second point $B_1$. The power of $A_1$ is $A_1 B_1 \cdot A_1 A_3$. The power of the diagonal intersection $M$ with respect to $\omega_1$ is $MA_2 \cdot MA_4 = MB_1 \cdot MA_3$. Using signed distances, this is $yw = (MB_1)z$, so $MB_1 = yw/z$. Thus, $A_1B_1 = MB_1 - MA_1 = yw/z - x$ and $A_1A_3 = MA_3 - MA_1 = z-x$. Therefore, $O_1 A_1^2 - r_1^2 = (yw/z-x)(z-x) = \frac{z-x}{z}(yw-xz)$.","Let $A_{1} A_{2} A_{3} A_{4}$ be a non-cyclic quadrilateral. Let $O_{1}$ and $r_{1}$ be the circumcenter and the circumradius of the triangle $A_{2} A_{3} A_{4}$. Define $O_{2}, O_{3}, O_{4}$ and $r_{2}, r_{3}, r_{4}$ in a similar way. Prove that

$$
\frac{1}{O_{1} A_{1}^{2}-r_{1}^{2}}+\frac{1}{O_{2} A_{2}^{2}-r_{2}^{2}}+\frac{1}{O_{3} A_{3}^{2}-r_{3}^{2}}+\frac{1}{O_{4} A_{4}^{2}-r_{4}^{2}}=0 .
$$","Let $M$ be the intersection of diagonals and $x,y,z,w$ be the signed distances from $M$ to vertices $A_1, A_2, A_3, A_4$. From the first sub-problem, we have $O_1 A_1^2 - r_1^2 = \frac{z-x}{z}(yw-xz)$. The other terms are obtained by cyclic permutation: $O_2 A_2^2 - r_2^2 = \frac{w-y}{w}(xz-yw)$, $O_3 A_3^2 - r_3^2 = \frac{x-z}{x}(yw-xz)$, and $O_4 A_4^2 - r_4^2 = \frac{y-w}{y}(xz-yw)$. The sum of the reciprocals is $\frac{1}{yw-xz}\left(\frac{z}{z-x}-\frac{w}{w-y}+\frac{x}{x-z}-\frac{y}{y-w}\right) = \frac{1}{yw-xz}\left(\frac{z-x}{z-x} - \frac{w-y}{w-y}\right) = \frac{1}{yw-xz}(1-1)=0$.",,,,
2011g3,"Let $A B C D$ be a convex quadrilateral whose sides $A D$ and $B C$ are not parallel. Suppose that the circles with diameters $A B$ and $C D$ meet at points $E$ and $F$ inside the quadrilateral. Let $\omega_{E}$ be the circle through the feet of the perpendiculars from $E$ to the lines $A B, B C$, and $C D$. Let $\omega_{F}$ be the circle through the feet of the perpendiculars from $F$ to the lines $C D, D A$, and $A B$. Prove that the midpoint of the segment $E F$ lies on the line through the two intersection points of $\omega_{E}$ and $\omega_{F}$.","Solution. Denote by $P, Q, R$, and $S$ the projections of $E$ on the lines $D A, A B, B C$, and $C D$ respectively. The points $P$ and $Q$ lie on the circle with diameter $A E$, so $\angle Q P E=\angle Q A E$; analogously, $\angle Q R E=\angle Q B E$. So $\angle Q P E+\angle Q R E=\angle Q A E+\angle Q B E=90^{\circ}$. By similar reasons, we have $\angle S P E+\angle S R E=90^{\circ}$, hence we get $\angle Q P S+\angle Q R S=90^{\circ}+90^{\circ}=180^{\circ}$, and the quadrilateral $P Q R S$ is inscribed in $\omega_{E}$. Analogously, all four projections of $F$ onto the sides of $A B C D$ lie on $\omega_{F}$.

Denote by $K$ the meeting point of the lines $A D$ and $B C$. Due to the arguments above, there is no loss of generality in assuming that $A$ lies on segment $D K$. Suppose that $\angle C K D \geq 90^{\circ}$; then the circle with diameter $C D$ covers the whole quadrilateral $A B C D$, so the points $E, F$ cannot lie inside this quadrilateral. Hence our assumption is wrong. Therefore, the lines $E P$ and $B C$ intersect at some point $P^{\prime}$, while the lines $E R$ and $A D$ intersect at some point $R^{\prime}$.\\
\includegraphics[max width=\textwidth, center]{2025_05_04_e6233e4fb964804c4c48g-49}

Figure 1\\
We claim that the points $P^{\prime}$ and $R^{\prime}$ also belong to $\omega_{E}$. Since the points $R, E, Q, B$ are concyclic, $\angle Q R K=\angle Q E B=90^{\circ}-\angle Q B E=\angle Q A E=\angle Q P E$. So $\angle Q R K=\angle Q P P^{\prime}$, which means that the point $P^{\prime}$ lies on $\omega_{E}$. Analogously, $R^{\prime}$ also lies on $\omega_{E}$.

In the same manner, denote by $M$ and $N$ the projections of $F$ on the lines $A D$ and $B C$\\
respectively, and let $M^{\prime}=F M \cap B C, N^{\prime}=F N \cap A D$. By the same arguments, we obtain that the points $M^{\prime}$ and $N^{\prime}$ belong to $\omega_{F}$.\\
\includegraphics[max width=\textwidth, center]{2025_05_04_e6233e4fb964804c4c48g-50}

Figure 2\\
Now we concentrate on Figure 2, where all unnecessary details are removed. Let $U=N N^{\prime} \cap$ $P P^{\prime}, V=M M^{\prime} \cap R R^{\prime}$. Due to the right angles at $N$ and $P$, the points $N, N^{\prime}, P, P^{\prime}$ are concyclic, so $U N \cdot U N^{\prime}=U P \cdot U P^{\prime}$ which means that $U$ belongs to the radical axis $g$ of the circles $\omega_{E}$ and $\omega_{F}$. Analogously, $V$ also belongs to $g$.

Finally, since $E U F V$ is a parallelogram, the radical axis $U V$ of $\omega_{E}$ and $\omega_{F}$ bisects $E F$.",3,"Let $E$ be a point on the circles with diameters $AB$ and $CD$. Let $\omega_E$ be the circle passing through the feet of the perpendiculars from $E$ to lines $AB, BC, CD$. Let $P$ be the foot of the perpendicular from $E$ to $AD$. Prove that $P$ also lies on $\omega_E$. Furthermore, if $AD$ and $BC$ intersect, let $R$ be the foot of the perpendicular from $E$ to $BC$, and define $P' = EP \cap BC$ and $R' = ER \cap AD$. Prove that $P'$ and $R'$ also lie on $\omega_E$.","Let $P, Q, R, S$ be the feet of the perpendiculars from $E$ to $DA, AB, BC, CD$. Since $E$ is on the circle with diameter $AB$, $\angle AEB = 90^\circ$. The feet of the perpendiculars $P,Q$ lie on the circle with diameter $AE$, giving $\angle QPE = \angle QAE$. Similarly, $Q,R$ lie on the circle with diameter $BE$, giving $\angle QRE = \angle QBE$. Thus, $\angle QPE + \angle QRE = \angle QAE + \angle QBE = \angle AEB = 90^\circ$. A similar argument using the circle with diameter $CD$ through $E$ gives $\angle SPE + \angle SRE = 90^\circ$. Summing these, we get $\angle QPS + \angle QRS = 180^\circ$, so $P,Q,R,S$ are concyclic. Thus $P$ lies on $\omega_E$, the circle through $Q,R,S$. For point $P'$, since $R,E,Q,B$ are concyclic (on the circle with diameter $BE$), we have $\angle QRP' = \angle QRE = \angle QBE = 90^\circ - \angle BAE = \angle QAE$. Since $A,Q,E,P$ are concyclic (on the circle with diameter $AE$), $\angle QAE = \angle QPE = \angle QPP'$. So $\angle QRP' = \angle QPP'$, which implies that $P'$ lies on the circle through $Q,R,P$, which is $\omega_E$. A symmetric argument shows $R'$ also lies on $\omega_E$.","Let $K = AD \cap BC$. For points $E$ and $F$, let $P,R$ and $M,N$ be their respective projections on lines $AD,BC$. Define points $U = (EP) \cap (FN)$ and $V = (ER) \cap (FM)$. Prove that line $UV$ is the radical axis of the pedal circles $\omega_E$ and $\omega_F$.","Let $P' = EP \cap BC$ and $N' = FN \cap AD$. From sub-problem 1, $P$ and $P'$ lie on $\omega_E$. Similarly, $N$ (as a projection) and $N'$ lie on $\omega_F$. The point $U$ is the intersection of the line $PP'$ (which is $EP$) and the line $NN'$ (which is $FN$). For $U$ to lie on the radical axis of $\omega_E$ and $\omega_F$, its power with respect to both circles must be equal. The power of $U$ w.r.t. $\omega_E$ is $UP \cdot UP'$, and w.r.t. $\omega_F$ is $UN \cdot UN'$. The equality $UP \cdot UP' = UN \cdot UN'$ holds if the four points $P, P', N, N'$ are concyclic. Their concyclicity can be established by showing that $KP \cdot KN' = KP' \cdot KN$, where $K=AD \cap BC$. This relation is a known geometric property. Thus, $U$ lies on the radical axis. A symmetric argument shows that $V=(ER)\cap(FM)$ also lies on the radical axis. Therefore, the line $UV$ is the radical axis of $\omega_E$ and $\omega_F$.","Let $A B C D$ be a convex quadrilateral whose sides $A D$ and $B C$ are not parallel. Suppose that the circles with diameters $A B$ and $C D$ meet at points $E$ and $F$ inside the quadrilateral. Let $\omega_{E}$ be the circle through the feet of the perpendiculars from $E$ to the lines $A B, B C$, and $C D$. Let $\omega_{F}$ be the circle through the feet of the perpendiculars from $F$ to the lines $C D, D A$, and $A B$. Prove that the midpoint of the segment $E F$ lies on the line through the two intersection points of $\omega_{E}$ and $\omega_{F}$.","The line through the intersection points of $\omega_E$ and $\omega_F$ is their radical axis. Let $P,R$ be the projections of $E$ on $AD,BC$, and $M,N$ be the projections of $F$ on $AD,BC$. From sub-problem 2, the radical axis is the line $UV$, where $U = (EP) \cap (FN)$ and $V = (ER) \cap (FM)$. By definition of projections, $EP \perp AD$ and $FM \perp AD$, so the lines $EP$ and $FM$ are parallel. Similarly, $ER \perp BC$ and $FN \perp BC$, so the lines $ER$ and $FN$ are parallel. The quadrilateral $EUFV$ has vertices at the intersections of two pairs of parallel lines: $E = (EP) \cap (ER)$, $U = (EP) \cap (FN)$, $F = (FN) \cap (FM)$, and $V = (ER) \cap (FM)$. Therefore, $EUFV$ is a parallelogram. In a parallelogram, the diagonals bisect each other. Thus, the midpoint of the diagonal $EF$ is also the midpoint of the diagonal $UV$. The midpoint of the segment $UV$ lies on the line $UV$. Consequently, the midpoint of $EF$ also lies on the line $UV$, which is the radical axis of $\omega_E$ and $\omega_F$.",,
2011g4,"Let $A B C$ be an acute triangle with circumcircle $\Omega$. Let $B_{0}$ be the midpoint of $A C$ and let $C_{0}$ be the midpoint of $A B$. Let $D$ be the foot of the altitude from $A$, and let $G$ be the centroid of the triangle $A B C$. Let $\omega$ be a circle through $B_{0}$ and $C_{0}$ that is tangent to the circle $\Omega$ at a point $X \neq A$. Prove that the points $D, G$, and $X$ are collinear.","If $A B=A C$, then the statement is trivial. So without loss of generality we may assume $A B<A C$. Denote the tangents to $\Omega$ at points $A$ and $X$ by $a$ and $x$, respectively.

Let $\Omega_{1}$ be the circumcircle of triangle $A B_{0} C_{0}$. The circles $\Omega$ and $\Omega_{1}$ are homothetic with center $A$, so they are tangent at $A$, and $a$ is their radical axis. Now, the lines $a, x$, and $B_{0} C_{0}$ are the three radical axes of the circles $\Omega, \Omega_{1}$, and $\omega$. Since $a \nmid B_{0} C_{0}$, these three lines are concurrent at some point $W$.

The points $A$ and $D$ are symmetric with respect to the line $B_{0} C_{0}$; hence $W X=W A=W D$. This means that $W$ is the center of the circumcircle $\gamma$ of triangle $A D X$. Moreover, we have $\angle W A O=\angle W X O=90^{\circ}$, where $O$ denotes the center of $\Omega$. Hence $\angle A W X+\angle A O X=180^{\circ}$.\\
\includegraphics[max width=\textwidth, center]{2025_05_04_e6233e4fb964804c4c48g-51}

Denote by $T$ the second intersection point of $\Omega$ and the line $D X$. Note that $O$ belongs to $\Omega_{1}$. Using the circles $\gamma$ and $\Omega$, we find $\angle D A T=\angle A D X-\angle A T D=\frac{1}{2}\left(360^{\circ}-\angle A W X\right)-\frac{1}{2} \angle A O X=$ $180^{\circ}-\frac{1}{2}(\angle A W X+\angle A O X)=90^{\circ}$. So, $A D \perp A T$, and hence $A T \| B C$. Thus, $A T C B$ is an isosceles trapezoid inscribed in $\Omega$.

Denote by $A_{0}$ the midpoint of $B C$, and consider the image of $A T C B$ under the homothety $h$ with center $G$ and factor $-\frac{1}{2}$. We have $h(A)=A_{0}, h(B)=B_{0}$, and $h(C)=C_{0}$. From the\\
symmetry about $B_{0} C_{0}$, we have $\angle T C B=\angle C B A=\angle B_{0} C_{0} A=\angle D C_{0} B_{0}$. Using $A T \| D A_{0}$, we conclude $h(T)=D$. Hence the points $D, G$, and $T$ are collinear, and $X$ lies on the same line.",3,"Let $\Omega_1$ be the circumcircle of $\triangle AB_0C_0$. Let $a$ be the tangent to $\Omega$ at $A$ and $x$ be the tangent to $\Omega$ at $X$. Show that the lines $a$, $x$, and $B_0C_0$ are concurrent at a point $W$, and that this point $W$ is the circumcenter of $\triangle ADX$.","The circles $\Omega$, $\omega$, and $\Omega_1$ have three radical axes: the tangent $a$ for $\Omega$ and $\Omega_1$, the tangent $x$ for $\Omega$ and $\omega$, and the line $B_0C_0$ for $\omega$ and $\Omega_1$. Since these circles are distinct, their radical axes must concur at a single point, $W$. As $W$ is the radical center, the power of $W$ with respect to each circle is the same. From circles $\Omega$ and $\Omega_1$, we have $WA^2=WX^2$, so $WA=WX$. The line $B_0C_0$ is the medial line of $\triangle ABC$ parallel to $BC$. The reflection of $A$ across the line $B_0C_0$ is the point $D$. Since $W$ lies on $B_0C_0$, $W$ is equidistant from $A$ and $D$, so $WA=WD$. Combining these, we get $WA=WX=WD$, which means $W$ is the circumcenter of $\triangle ADX$.",Let $T$ be the second intersection point of the line $DX$ with the circumcircle $\Omega$. Prove that the line segment $AT$ is parallel to $BC$.,"Let $W$ be the circumcenter of $\triangle ADX$ and $O$ be the center of $\Omega$. Since $W$ is the radical center from Sub-problem 1, $WA$ and $WX$ are tangents to $\Omega$. Thus, $\angle WAO = \angle WXO = 90^\circ$, which implies that the quadrilateral $WAOX$ is cyclic and $\angle AWX + \angle AOX = 180^\circ$. Let $\gamma$ be the circumcircle of $\triangle ADX$ with center $W$. In $\triangle ADT$, we have $\angle DAT = |\angle ADX - \angle ATD|$. In circle $\gamma$, $\angle ADX = 180^\circ - \frac{1}{2}\angle AWX$. In circle $\Omega$, $\angle ATD = \angle ATX = \frac{1}{2}\angle AOX$. Therefore, $\angle DAT = |180^\circ - \frac{1}{2}\angle AWX - \frac{1}{2}\angle AOX| = |180^\circ - \frac{1}{2}(\angle AWX + \angle AOX)| = |180^\circ - \frac{1}{2}(180^\circ)| = 90^\circ$. So, $AD \perp AT$. By definition, $AD \perp BC$. Thus, $AT \parallel BC$.","Prove that the points $D, G$, and $X$ are collinear.","From Sub-problem 2, we have $AT \parallel BC$, where $T$ is the second intersection of line $DX$ with $\Omega$. This means $ATCB$ is an isosceles trapezoid. Consider the homothety $h$ with center $G$ and factor $-1/2$. This homothety maps $\triangle ABC$ to its medial triangle $\triangle A_0B_0C_0$. The point $T$ on $\Omega$ is mapped to a point $h(T)$ on the nine-point circle. The line $AT$ is mapped to a line through $h(A)=A_0$ parallel to $AT$. Since $AT \parallel BC$, this image line is the line $BC$ itself. Thus, $h(T)$ lies on both the nine-point circle and the line $BC$. The only such points are $A_0$ and $D$. Since $X \neq A$, we have $T \neq A$, so $h(T) \neq h(A)=A_0$. Hence, $h(T)=D$. By the definition of homothety, points $T, G, D$ are collinear. Since $T$ was defined to be on the line $DX$, points $D, X, T$ are also collinear. Therefore, the points $D, G, X$ lie on the same line.",,
2011g5,"Let $A B C$ be a triangle with incenter $I$ and circumcircle $\omega$. Let $D$ and $E$ be the second intersection points of $\omega$ with the lines $A I$ and $B I$, respectively. The chord $D E$ meets $A C$ at a point $F$, and $B C$ at a point $G$. Let $P$ be the intersection point of the line through $F$ parallel to $A D$ and the line through $G$ parallel to $B E$. Suppose that the tangents to $\omega$ at $A$ and at $B$ meet at a point $K$. Prove that the three lines $A E, B D$, and $K P$ are either parallel or concurrent.","Since

$$
\angle I A F=\angle D A C=\angle B A D=\angle B E D=\angle I E F
$$

the quadrilateral $A I F E$ is cyclic. Denote its circumcircle by $\omega_{1}$. Similarly, the quadrilateral $B D G I$ is cyclic; denote its circumcircle by $\omega_{2}$.

The line $A E$ is the radical axis of $\omega$ and $\omega_{1}$, and the line $B D$ is the radical axis of $\omega$ and $\omega_{2}$. Let $t$ be the radical axis of $\omega_{1}$ and $\omega_{2}$. These three lines meet at the radical center of the three circles, or they are parallel to each other. We will show that $t$ is in fact the line $P K$.

Let $L$ be the second intersection point of $\omega_{1}$ and $\omega_{2}$, so $t=I L$. (If the two circles are tangent to each other then $L=I$ and $t$ is the common tangent.)\\
\includegraphics[max width=\textwidth, center]{2025_05_04_e6233e4fb964804c4c48g-53}

Let the line $t$ meet the circumcircles of the triangles $A B L$ and $F G L$ at $K^{\prime} \neq L$ and $P^{\prime} \neq L$, respectively. Using oriented angles we have

$$
\angle\left(A B, B K^{\prime}\right)=\angle\left(A L, L K^{\prime}\right)=\angle(A L, L I)=\angle(A E, E I)=\angle(A E, E B)=\angle(A B, B K),
$$

so $B K^{\prime} \| B K$. Similarly we have $A K^{\prime} \| A K$, and therefore $K^{\prime}=K$. Next, we have

$$
\angle\left(P^{\prime} F, F G\right)=\angle\left(P^{\prime} L, L G\right)=\angle(I L, L G)=\angle(I D, D G)=\angle(A D, D E)=\angle(P F, F G),
$$

hence $P^{\prime} F \| P F$ and similarly $P^{\prime} G \| P G$. Therefore $P^{\prime}=P$. This means that $t$ passes through $K$ and $P$, which finishes the proof.",3,"Let $A, B, C, I, \omega, D, E, F, G$ be defined as in the problem. Prove that the quadrilateral $AIFE$ and the quadrilateral $BDGI$ are cyclic.","To prove $AIFE$ is cyclic, we show $\\angle IAF = \\angle IEF$. Using the property that $AI$ is the angle bisector and that points $A,B,D,E$ are on the circumcircle $\\omega$, we have $\\angle IAF = \\angle IAC = \\angle IAB = \\angle DAB = \\angle DEB$. Since $F$ lies on $DE$ and $I$ on $BE$, $\\angle DEB = \\angle IEF$. Thus, $\\angle IAF = \\angle IEF$, which implies $A,I,F,E$ are concyclic. Similarly, to prove $BDGI$ is cyclic, we show $\\angle IBG = \\angle IDG$. We have $\\angle IBG = \\angle IBC = \\angle IBA = \\angle EBA = \\angle EDA$. Since $G$ lies on $DE$, $\\angle EDA = \\angle GDI$. Thus, $\\angle IBG = \\angle IDG$, which implies $B,D,G,I$ are concyclic.",Let $\\omega_1$ be the circumcircle of the cyclic quadrilateral $AIFE$ and $\\omega_2$ be the circumcircle of the cyclic quadrilateral $BDGI$. Prove that the line $KP$ is the radical axis of $\\omega_1$ and $\\omega_2$.,"Let the radical axis of $\\omega_1$ and $\\omega_2$ be the line $t$, passing through their intersections $I$ and some point $L$. We show $K$ and $P$ lie on $t$. Using oriented angles, we establish the relation $\\angle(AL, LI) = \\angle(AE, EI) = \\angle(AE, EB) = \\angle(AB, BK)$, where the last equality follows from the properties of the tangent to $\\omega$ at $B$. This angular relation implies that $K$ must lie on the line $IL$. Similarly, for $P$, we establish $\\angle(IL, LG) = \\angle(ID, DG) = \\angle(AD, DE)$. By construction, the line $PF$ is parallel to $AD$, so $\\angle(AD, DE) = \\angle(PF, DE) = \\angle(PF, FG)$. Thus, $\\angle(IL, LG) = \\angle(PF, FG)$. This relation implies that $P$ must also lie on the line $IL$. Therefore, the line $KP$ coincides with the line $IL$, the radical axis of $\\omega_1$ and $\\omega_2$.","Let $A B C$ be a triangle with incenter $I$ and circumcircle $\\omega$. Let $D$ and $E$ be the second intersection points of $\\omega$ with the lines $A I$ and $B I$, respectively. The chord $D E$ meets $A C$ at a point $F$, and $B C$ at a point $G$. Let $P$ be the intersection point of the line through $F$ parallel to $A D$ and the line through $G$ parallel to $B E$. Suppose that the tangents to $\\omega$ at $A$ and at $B$ meet at a point $K$. Prove that the three lines $A E, B D$, and $K P$ are either parallel or concurrent.","Consider the three circles: the circumcircle $\\omega$ of $\triangle ABC$, the circumcircle $\\omega_1$ of quadrilateral $AIFE$, and the circumcircle $\\omega_2$ of quadrilateral $BDGI$. As established in Sub-problem 1, both quadrilaterals are cyclic. The line $AE$ passes through the intersection points of $\\omega$ and $\\omega_1$, so it is their radical axis. The line $BD$ passes through the intersection points of $\\omega$ and $\\omega_2$, so it is their radical axis. From Sub-problem 2, the line $KP$ is the radical axis of $\\omega_1$ and $\\omega_2$. By the Radical Axis Theorem, the three radical axes of three circles taken in pairs must be either concurrent at the radical center or parallel. Therefore, the lines $AE$, $BD$, and $KP$ are either concurrent or parallel.",,
2011g6,"Let $A B C$ be a triangle with $A B=A C$, and let $D$ be the midpoint of $A C$. The angle bisector of $\angle B A C$ intersects the circle through $D, B$, and $C$ in a point $E$ inside the triangle $A B C$. The line $B D$ intersects the circle through $A, E$, and $B$ in two points $B$ and $F$. The lines $A F$ and $B E$ meet at a point $I$, and the lines $C I$ and $B D$ meet at a point $K$. Show that $I$ is the incenter of triangle $K A B$.","Let $D^{\prime}$ be the midpoint of the segment $A B$, and let $M$ be the midpoint of $B C$. By symmetry at line $A M$, the point $D^{\prime}$ has to lie on the circle $B C D$. Since the arcs $D^{\prime} E$ and $E D$ of that circle are equal, we have $\angle A B I=\angle D^{\prime} B E=\angle E B D=I B K$, so $I$ lies on the angle bisector of $\angle A B K$. For this reason it suffices to prove in the sequel that the ray $A I$ bisects the angle $\angle B A K$.

From

$$
\angle D F A=180^{\circ}-\angle B F A=180^{\circ}-\angle B E A=\angle M E B=\frac{1}{2} \angle C E B=\frac{1}{2} \angle C D B
$$

we derive $\angle D F A=\angle D A F$ so the triangle $A F D$ is isosceles with $A D=D F$.\\
\includegraphics[max width=\textwidth, center]{2025_05_04_e6233e4fb964804c4c48g-55}

Applying Menelaus's theorem to the triangle $A D F$ with respect to the line $C I K$, and applying the angle bisector theorem to the triangle $A B F$, we infer

$$
1=\frac{A C}{C D} \cdot \frac{D K}{K F} \cdot \frac{F I}{I A}=2 \cdot \frac{D K}{K F} \cdot \frac{B F}{A B}=2 \cdot \frac{D K}{K F} \cdot \frac{B F}{2 \cdot A D}=\frac{D K}{K F} \cdot \frac{B F}{A D}
$$

and therefore

$$
\frac{B D}{A D}=\frac{B F+F D}{A D}=\frac{B F}{A D}+1=\frac{K F}{D K}+1=\frac{D F}{D K}=\frac{A D}{D K} .
$$

It follows that the triangles $A D K$ and $B D A$ are similar, hence $\angle D A K=\angle A B D$. Then

$$
\angle I A B=\angle A F D-\angle A B D=\angle D A F-\angle D A K=\angle K A I
$$

shows that the point $K$ is indeed lying on the angle bisector of $\angle B A K$.",3,Show that the line $BI$ is the angle bisector of $\angle ABK$.,"Let $D'$ be the midpoint of $AB$. By symmetry of the isosceles triangle $ABC$ with respect to the angle bisector of $\angle BAC$ (line $AM$), $D'$ lies on the circle through $B, C, D$. As $E$ also lies on this axis of symmetry, $ED = ED'$. In the circle passing through $B, D, E, D'$, the equal chords $ED$ and $ED'$ subtend equal angles at point $B$, so $\angle EBD = \angle EBD'$. This is equivalent to $\angle IBK = \angle ABI$, which means $BI$ bisects $\angle ABK$.",Prove that triangles $ADK$ and $BDA$ are similar.,"First, we establish that $\triangle AFD$ is isosceles with $AD=DF$. This follows from angle chasing: $\angle DFA = 180^{\circ} - \angle BFA = 180^{\circ} - \angle BEA = \frac{1}{2} \angle CDB$, which is shown to equal $\angle DAF$. Next, apply Menelaus's theorem to $\triangle ADF$ and transversal $CIK$. Using $AC=2CD$ and the Angle Bisector Theorem for $BI$ in $\triangle ABF$ ($rac{FI}{IA} = rac{BF}{AB}$), we derive $\frac{BF}{AD} = \frac{KF}{DK}$. This leads to $\frac{BD}{AD} = \frac{BF+FD}{AD} = \frac{BF}{AD} + \frac{FD}{AD} = \frac{KF}{DK}+1 = \frac{DF}{DK}$. Since $AD=DF$, we get $\frac{BD}{AD}=\frac{AD}{DK}$. As $\angle BDA$ is common to both triangles, $\triangle ADK \sim \triangle BDA$ by SAS similarity.",Show that $I$ is the incenter of triangle $KAB$.,"From the first sub-problem, $BI$ is the angle bisector of $\angle ABK$. From the second sub-problem, the similarity $\triangle ADK \sim \triangle BDA$ implies $\angle DAK = \angle ABD$. The proof of similarity also required showing $\triangle AFD$ is isosceles with $\angle DAF = \angle DFA$. We can write $\angle IAB = \angle FAB = \angle DAF - \angle ABD$. Substituting the angle equalities gives $\angle IAB = \angle DAF - \angle DAK = \angle KAF = \angle KAI$. Thus, $AI$ is the angle bisector of $\angle BAK$. Since $I$ is the intersection of two angle bisectors of $\triangle KAB$, it is the incenter.",,
2011g7,Let $A B C D E F$ be a convex hexagon all of whose sides are tangent to a circle $\omega$ with center $O$. Suppose that the circumcircle of triangle $A C E$ is concentric with $\omega$. Let $J$ be the foot of the perpendicular from $B$ to $C D$. Suppose that the perpendicular from $B$ to $D F$ intersects the line $E O$ at a point $K$. Let $L$ be the foot of the perpendicular from $K$ to $D E$. Prove that $D J=D L$.,"Since $\omega$ and the circumcircle of triangle $A C E$ are concentric, the tangents from $A$, $C$, and $E$ to $\omega$ have equal lengths; that means that $A B=B C, C D=D E$, and $E F=F A$. Moreover, we have $\angle B C D=\angle D E F=\angle F A B$.\\
\includegraphics[max width=\textwidth, center]{2025_05_04_e6233e4fb964804c4c48g-58}

Consider the rotation around point $D$ mapping $C$ to $E$; let $B^{\prime}$ and $L^{\prime}$ be the images of the points $B$ and $J$, respectively, under this rotation. Then one has $D J=D L^{\prime}$ and $B^{\prime} L^{\prime} \perp D E$; moreover, the triangles $B^{\prime} E D$ and $B C D$ are congruent. Since $\angle D E O<90^{\circ}$, the lines $E O$ and $B^{\prime} L^{\prime}$ intersect at some point $K^{\prime}$. We intend to prove that $K^{\prime} B \perp D F$; this would imply $K=K^{\prime}$, therefore $L=L^{\prime}$, which proves the problem statement.

Analogously, consider the rotation around $F$ mapping $A$ to $E$; let $B^{\prime \prime}$ be the image of $B$ under this rotation. Then the triangles $F A B$ and $F E B^{\prime \prime}$ are congruent. We have $E B^{\prime \prime}=A B=B C=$ $E B^{\prime}$ and $\angle F E B^{\prime \prime}=\angle F A B=\angle B C D=\angle D E B^{\prime}$, so the points $B^{\prime}$ and $B^{\prime \prime}$ are symmetrical with respect to the angle bisector $E O$ of $\angle D E F$. So, from $K^{\prime} B^{\prime} \perp D E$ we get $K^{\prime} B^{\prime \prime} \perp E F$.

From these two relations we obtain

$$
K^{\prime} D^{2}-K^{\prime} E^{2}=B^{\prime} D^{2}-B^{\prime} E^{2} \quad \text { and } \quad K^{\prime} E^{2}-K^{\prime} F^{2}=B^{\prime \prime} E^{2}-B^{\prime \prime} F^{2} .
$$

Adding these equalities and taking into account that $B^{\prime} E=B^{\prime \prime} E$ we obtain

$$
K^{\prime} D^{2}-K^{\prime} F^{2}=B^{\prime} D^{2}-B^{\prime \prime} F^{2}=B D^{2}-B F^{2},
$$

which means exactly that $K^{\prime} B \perp D F$.

Comment. There are several variations of this solution. For instance, let us consider the intersection point $M$ of the lines $B J$ and $O C$. Define the point $K^{\prime}$ as the reflection of $M$ in the line $D O$. Then one has

$$
D K^{\prime 2}-D B^{2}=D M^{2}-D B^{2}=C M^{2}-C B^{2}
$$

Next, consider the rotation around $O$ which maps $C M$ to $E K^{\prime}$. Let $P$ be the image of $B$ under this rotation; so $P$ lies on $E D$. Then $E F \perp K^{\prime} P$, so

$$
C M^{2}-C B^{2}=E K^{\prime 2}-E P^{2}=F K^{\prime 2}-F P^{2}=F K^{\prime 2}-F B^{2}
$$

since the triangles $F E P$ and $F A B$ are congruent.",3,"Let $A B C D E F$ be a convex hexagon all of whose sides are tangent to a circle $\omega$ with center $O$. Suppose that the circumcircle of triangle $A C E$ is concentric with $\omega$. Show that $AB=BC$, $CD=DE$, $EF=FA$ and $\angle BCD = \angle DEF = \angle FAB$.","Let $r$ be the radius of $\omega$ and let $t_V$ denote the length of the tangent from a vertex $V$ to $\omega$. The distance from $O$ to a vertex $V$ is given by $OV^2 = r^2 + t_V^2$. Since the circumcircle of $\triangle ACE$ is centered at $O$, we have $OA=OC=OE$. This implies $r^2+t_A^2 = r^2+t_C^2 = r^2+t_E^2$, which gives $t_A=t_C=t_E$. The side lengths of the hexagon are $AB = t_A+t_B$, $BC=t_B+t_C$, $CD=t_C+t_D$, $DE=t_D+t_E$, $EF=t_E+t_F$, and $FA=t_F+t_A$. From $t_A=t_C$ it follows that $AB=BC$. From $t_C=t_E$ it follows that $CD=DE$. From $t_E=t_A$ it follows that $EF=FA$. These side equalities on a tangential hexagon with incenter $O$ concentric with the circumcircle of $\triangle ACE$ also imply the angle equalities $\angle BCD=\angle DEF=\angle FAB$.",Consider a rotation around point $D$ that maps $C$ to $E$. Let $B'$ and $L'$ be the images of points $B$ and $J$ respectively. Define $K'$ as the intersection of the line $EO$ with the line passing through $B'$ and $L'$. Show that proving the original problem statement ($DJ=DL$) is equivalent to proving that $K'B \perp DF$.,"From sub-problem 1, we have $CD=DE$, so a rotation around $D$ mapping $C$ to $E$ exists. Let $B'$ and $L'$ be the images of $B$ and $J$. By the properties of rotation, we have $\triangle BCD \cong \triangle B'ED$, $DJ=DL'$, and since $BJ \perp CD$, we have $B'L' \perp DE$. The goal is to prove $DJ=DL$. Given $DJ=DL'$, this is equivalent to proving $L=L'$. $L$ is the foot of the perpendicular from $K$ to $DE$. $L'$ is the foot of the perpendicular from $B'$ to $DE$. Thus, the line $B'L'$ is the perpendicular from $B'$ to $DE$. Let $K'$ be the intersection of $EO$ and the line $B'L'$. Then $L'$ is also the foot of the perpendicular from $K'$ to $DE$. For $L$ to be equal to $L'$, given that both $K$ and $K'$ lie on $EO$, we must have $K=K'$. The point $K$ is defined as the intersection of $EO$ and the line through $B$ perpendicular to $DF$. Since $K'$ is on $EO$ by definition, showing $K=K'$ is equivalent to showing that $K'$ lies on the perpendicular from $B$ to $DF$, i.e., proving $K'B \perp DF$.",Let $A B C D E F$ be a convex hexagon all of whose sides are tangent to a circle $\omega$ with center $O$. Suppose that the circumcircle of triangle $A C E$ is concentric with $\omega$. Let $J$ be the foot of the perpendicular from $B$ to $C D$. Suppose that the perpendicular from $B$ to $D F$ intersects the line $E O$ at a point $K$. Let $L$ be the foot of the perpendicular from $K$ to $D E$. Prove that $D J=D L$.,"From sub-problem 2, we need to prove $K'B \perp DF$. Consider a rotation around $F$ mapping $A$ to $E$ (possible since $FA=FE$). Let $B''$ be the image of $B$. Then $\triangle FAB \cong \triangle FEB''$, so $EB''=AB$ and $\angle FEB'' = \angle FAB$. From sub-problem 1, $AB=BC$ and $\angle FAB=\angle BCD$. The first rotation gave $EB'=BC$ and $\angle DEB'=\angle BCD$. Thus, $EB'=EB''$ and $\angle DEB'=\angle FEB''$. Since $O$ is the incenter, $EO$ bisects $\angle DEF$, so $B'$ and $B''$ are symmetric with respect to line $EO$. As $K'$ is on $EO$, this symmetry implies that the line $K'B''$ is the reflection of $K'B'$ across $EO$. Since reflection maps $DE$ to $FE$ and preserves perpendicularity, $K'B' \perp DE$ implies $K'B'' \perp FE$. Using the property $XY \perp ZW \iff XZ^2-XW^2 = YZ^2-YW^2$, we get: 1) $K'D^2-K'E^2 = B'D^2-B'E^2$ and 2) $K'E^2-K'F^2 = B''E^2-B''F^2$. Adding these and using $B'E=B''E$ gives $K'D^2-K'F^2 = B'D^2-B''F^2$. From the rotations, $B'D=BD$ and $B''F=BF$, so $K'D^2-K'F^2=BD^2-BF^2$. This is the condition for $K'B \perp DF$. Thus $K=K'$, which implies $L=L'$, and from $DJ=DL'$ we conclude $DJ=DL$.",,
2011g8,"Let $A B C$ be an acute triangle with circumcircle $\omega$. Let $t$ be a tangent line to $\omega$. Let $t_{a}, t_{b}$, and $t_{c}$ be the lines obtained by reflecting $t$ in the lines $B C, C A$, and $A B$, respectively. Show that the circumcircle of the triangle determined by the lines $t_{a}, t_{b}$, and $t_{c}$ is tangent to the circle $\omega$.

To avoid a large case distinction, we will use the notion of oriented angles. Namely, for two lines $\ell$ and $m$, we denote by $\angle(\ell, m)$ the angle by which one may rotate $\ell$ anticlockwise to obtain a line parallel to $m$. Thus, all oriented angles are considered modulo $180^{\circ}$.","Denote by $T$ the point of tangency of $t$ and $\omega$. Let $A^{\prime}=t_{b} \cap t_{c}, B^{\prime}=t_{a} \cap t_{c}$, $C^{\prime}=t_{a} \cap t_{b}$. Introduce the point $A^{\prime \prime}$ on $\omega$ such that $T A=A A^{\prime \prime}\left(A^{\prime \prime} \neq T\right.$ unless $T A$ is a diameter). Define the points $B^{\prime \prime}$ and $C^{\prime \prime}$ in a similar way.

Since the points $C$ and $B$ are the midpoints of arcs $T C^{\prime \prime}$ and $T B^{\prime \prime}$, respectively, we have

$$
\begin{aligned}
\angle\left(t, B^{\prime \prime} C^{\prime \prime}\right) & =\angle\left(t, T C^{\prime \prime}\right)+\angle\left(T C^{\prime \prime}, B^{\prime \prime} C^{\prime \prime}\right)=2 \angle(t, T C)+2 \angle\left(T C^{\prime \prime}, B C^{\prime \prime}\right) \\
& =2(\angle(t, T C)+\angle(T C, B C))=2 \angle(t, B C)=\angle\left(t, t_{a}\right) .
\end{aligned}
$$

It follows that $t_{a}$ and $B^{\prime \prime} C^{\prime \prime}$ are parallel. Similarly, $t_{b} \| A^{\prime \prime} C^{\prime \prime}$ and $t_{c} \| A^{\prime \prime} B^{\prime \prime}$. Thus, either the triangles $A^{\prime} B^{\prime} C^{\prime}$ and $A^{\prime \prime} B^{\prime \prime} C^{\prime \prime}$ are homothetic, or they are translates of each other. Now we will prove that they are in fact homothetic, and that the center $K$ of the homothety belongs\\
to $\omega$. It would then follow that their circumcircles are also homothetic with respect to $K$ and are therefore tangent at this point, as desired.

We need the two following claims.\\
Claim 1. The point of intersection $X$ of the lines $B^{\prime \prime} C$ and $B C^{\prime \prime}$ lies on $t_{a}$.\\
Proof. Actually, the points $X$ and $T$ are symmetric about the line $B C$, since the lines $C T$ and $C B^{\prime \prime}$ are symmetric about this line, as are the lines $B T$ and $B C^{\prime \prime}$.

Claim 2. The point of intersection $I$ of the lines $B B^{\prime}$ and $C C^{\prime}$ lies on the circle $\omega$.\\
Proof. We consider the case that $t$ is not parallel to the sides of $A B C$; the other cases may be regarded as limit cases. Let $D=t \cap B C, E=t \cap A C$, and $F=t \cap A B$.

Due to symmetry, the line $D B$ is one of the angle bisectors of the lines $B^{\prime} D$ and $F D$; analogously, the line $F B$ is one of the angle bisectors of the lines $B^{\prime} F$ and $D F$. So $B$ is either the incenter or one of the excenters of the triangle $B^{\prime} D F$. In any case we have $\angle(B D, D F)+\angle(D F, F B)+$ $\angle\left(B^{\prime} B, B^{\prime} D\right)=90^{\circ}$, so

$$
\angle\left(B^{\prime} B, B^{\prime} C^{\prime}\right)=\angle\left(B^{\prime} B, B^{\prime} D\right)=90^{\circ}-\angle(B C, D F)-\angle(D F, B A)=90^{\circ}-\angle(B C, A B) .
$$

Analogously, we get $\angle\left(C^{\prime} C, B^{\prime} C^{\prime}\right)=90^{\circ}-\angle(B C, A C)$. Hence,

$$
\angle(B I, C I)=\angle\left(B^{\prime} B, B^{\prime} C^{\prime}\right)+\angle\left(B^{\prime} C^{\prime}, C^{\prime} C\right)=\angle(B C, A C)-\angle(B C, A B)=\angle(A B, A C),
$$

which means exactly that the points $A, B, I, C$ are concyclic.\\
Now we can complete the proof. Let $K$ be the second intersection point of $B^{\prime} B^{\prime \prime}$ and $\omega$. Applying Pascal's theorem to hexagon $K B^{\prime \prime} C I B C^{\prime \prime}$ we get that the points $B^{\prime}=K B^{\prime \prime} \cap I B$ and $X=B^{\prime \prime} C \cap B C^{\prime \prime}$ are collinear with the intersection point $S$ of $C I$ and $C^{\prime \prime} K$. So $S=$ $C I \cap B^{\prime} X=C^{\prime}$, and the points $C^{\prime}, C^{\prime \prime}, K$ are collinear. Thus $K$ is the intersection point of $B^{\prime} B^{\prime \prime}$ and $C^{\prime} C^{\prime \prime}$ which implies that $K$ is the center of the homothety mapping $A^{\prime} B^{\prime} C^{\prime}$ to $A^{\prime \prime} B^{\prime \prime} C^{\prime \prime}$, and it belongs to $\omega$.",4,"Let $A', B', C'$ be the vertices of the triangle formed by the lines $t_a, t_b, t_c$. Construct a triangle $A''B''C''$ with vertices on the circumcircle $\omega$ such that its sides are parallel to the sides of triangle $A'B'C'$.","Define points $A'', B'', C''$ on $\omega$ such that $A, B, C$ are the midpoints of the arcs $TA'', TB'', TC''$ respectively, where $T$ is the tangency point of $t$ and $\omega$. By the definition of reflection, the oriented angle from $t$ to $t_a$ is twice the angle from $t$ to $BC$. Using the inscribed angle theorem and properties of arcs, the oriented angle from $t$ to the line $B''C''$ is also twice the angle from $t$ to $BC$. Thus, $t_a$ is parallel to $B''C''$. Similarly, $t_b \parallel A''C''$ and $t_c \parallel A''B''$. Therefore, triangles $A'B'C'$ and $A''B''C''$ have parallel sides.",Let $B' = t_a \cap t_c$ and $C' = t_a \cap t_b$. Let $I$ be the point of intersection of the lines $BB'$ and $CC'$. Prove that $I$ lies on the circumcircle $\omega$.,"We prove that $A, B, I, C$ are concyclic by showing $\angle(BI, CI) = \angle(BA, CA)$. Let $D=t \cap BC$ and $F=t \cap AB$. Due to the reflection properties, $B$ is an incenter or excenter of triangle $B'DF$. An angle formula for angle bisectors gives $\angle(B'B, t_a) = 90^{\circ} - \angle(BC, AB)$. Similarly, $\angle(C'C, t_a) = 90^{\circ} - \angle(BC, AC)$. It follows that $\angle(BI, CI) = \angle(B'B, C'C) = \angle(BC, AC) - \angle(BC, AB) = \angle(AB, AC)$, which proves that $I$ lies on $\omega$.","With points $B'', C''$ defined as in the first step, let $X$ be the intersection of lines $B''C$ and $BC''$. Show that $X$ lies on the line $t_a$.","This is proven by showing that $X$ is the reflection of the point of tangency $T$ in the line $BC$. The lines $CT$ and $CB''$ are symmetric with respect to $BC$, and so are the lines $BT$ and $BC''$. This implies that the reflection of $T$ in $BC$ lies on both $CB''$ and $BC''$, hence it is their intersection point $X$. Since $t_a$ is the reflection of $t$ in $BC$ and $T$ lies on $t$, its reflection $X$ must lie on $t_a$.","Show that the circumcircle of the triangle determined by the lines $t_{a}, t_{b}$, and $t_{c}$ is tangent to the circle $\omega$.","From sub-problem 1, $\triangle A'B'C'$ and $\triangle A''B''C''$ have parallel sides, so they are homothetic. Let $K$ be the second intersection of line $B'B''$ and circle $\omega$. By sub-problem 2, the point $I=BB'\cap CC'$ is on $\omega$. Applying Pascal's theorem to the hexagon $K B'' C I B C''$ on $\omega$, we find that the intersection points of opposite sides are collinear. This implies that $C', C'', K$ are collinear. Therefore, $K$ is the intersection of $B'B''$ and $C'C''$, making it the center of homothety. Since $K$ is on $\omega$ by construction, the circumcircle of $\triangle A'B'C'$ is tangent to $\omega$ at $K$."
2011n1,"For any integer $d>0$, let $f(d)$ be the smallest positive integer that has exactly $d$ positive divisors (so for example we have $f(1)=1, f(5)=16$, and $f(6)=12$ ). Prove that for every integer $k \geq 0$ the number $f\left(2^{k}\right)$ divides $f\left(2^{k+1}\right)$.","For any positive integer $n$, let $d(n)$ be the number of positive divisors of $n$. Let $n=\prod_{p} p^{a(p)}$ be the prime factorization of $n$ where $p$ ranges over the prime numbers, the integers $a(p)$ are nonnegative and all but finitely many $a(p)$ are zero. Then we have $d(n)=\prod_{p}(a(p)+1)$. Thus, $d(n)$ is a power of 2 if and only if for every prime $p$ there is a nonnegative integer $b(p)$ with $a(p)=2^{b(p)}-1=1+2+2^{2}+\cdots+2^{b(p)-1}$. We then have

$$
n=\prod_{p} \prod_{i=0}^{b(p)-1} p^{2^{i}}, \quad \text { and } \quad d(n)=2^{k} \quad \text { with } \quad k=\sum_{p} b(p) .
$$

Let $\mathcal{S}$ be the set of all numbers of the form $p^{2^{r}}$ with $p$ prime and $r$ a nonnegative integer. Then we deduce that $d(n)$ is a power of 2 if and only if $n$ is the product of the elements of some finite subset $\mathcal{T}$ of $\mathcal{S}$ that satisfies the following condition: for all $t \in \mathcal{T}$ and $s \in \mathcal{S}$ with $s \mid t$ we have $s \in \mathcal{T}$. Moreover, if $d(n)=2^{k}$ then the corresponding set $\mathcal{T}$ has $k$ elements.

Note that the set $\mathcal{T}_{k}$ consisting of the smallest $k$ elements from $\mathcal{S}$ obviously satisfies the condition above. Thus, given $k$, the smallest $n$ with $d(n)=2^{k}$ is the product of the elements of $\mathcal{T}_{k}$. This $n$ is $f\left(2^{k}\right)$. Since obviously $\mathcal{T}_{k} \subset \mathcal{T}_{k+1}$, it follows that $f\left(2^{k}\right) \mid f\left(2^{k+1}\right)$.",2,"Let $\mathcal{S}$ be the set of all integers of the form $p^{2^r}$, where $p$ is a prime number and $r \geq 0$ is an integer. For $k \geq 0$, let $\mathcal{T}_k$ be the set of the $k$ smallest elements of $\mathcal{S}$ (with $\mathcal{T}_0$ being the empty set). Prove that $f(2^k)$ is the product of the elements of $\mathcal{T}_k$.","The number of divisors of an integer $n=\prod_p p^{a_p}$ is $d(n)=\prod_p(a_p+1)$. For $d(n)$ to be a power of 2, say $d(n)=2^k$, each factor $(a_p+1)$ must be a power of 2. This means each exponent $a_p$ must be of the form $2^{b_p}-1$ for some integer $b_p \geq 0$, with $\sum_p b_p = k$. Since $2^{b_p}-1 = 1+2^1+\dots+2^{b_p-1}$, the integer $n$ is a product of elements from the set $\mathcal{S} = \{p^{2^r} \mid p \text{ is prime, } r \ge 0\}$. Specifically, $n$ is the product of $k$ distinct elements from $\mathcal{S}$. To find $f(2^k)$, the smallest such integer $n$, we must choose the product of the $k$ smallest available factors from $\mathcal{S}$. Let $\mathcal{T}_k$ be the set of these $k$ smallest elements. Thus, $f(2^k) = \prod_{t \in \mathcal{T}_k} t$ (where the empty product for $k=0$ is 1).","For every integer $k \geq 0$, prove that the number $f\left(2^{k}\right)$ divides $f\left(2^{k+1}\right)$.","Let $\mathcal{S}$ be the set of integers of the form $p^{2^r}$ for prime $p$ and $r \geq 0$. From the first sub-problem, $f(2^k)$ is the product of the elements of $\mathcal{T}_k$, the set of the $k$ smallest elements of $\mathcal{S}$. Similarly, $f(2^{k+1})$ is the product of the elements of $\mathcal{T}_{k+1}$, the set of the $k+1$ smallest elements of $\mathcal{S}$. By their definition as the sets of the smallest elements, $\mathcal{T}_k$ is a subset of $\mathcal{T}_{k+1}$. Therefore, the product of the elements in $\mathcal{T}_k$ must divide the product of the elements in $\mathcal{T}_{k+1}$, which implies $f(2^k) \mid f(2^{k+1})$.",,,,
2011n2,"Consider a polynomial $P(x)=\left(x+d_{1}\right)\left(x+d_{2}\right) \cdot \ldots \cdot\left(x+d_{9}\right)$, where $d_{1}, d_{2}, \ldots, d_{9}$ are nine distinct integers. Prove that there exists an integer $N$ such that for all integers $x \geq N$ the number $P(x)$ is divisible by a prime number greater than 20 .","Note that the statement of the problem is invariant under translations of $x$; hence without loss of generality we may suppose that the numbers $d_{1}, d_{2}, \ldots, d_{9}$ are positive.

The key observation is that there are only eight primes below 20 , while $P(x)$ involves more than eight factors.

We shall prove that $N=d^{8}$ satisfies the desired property, where $d=\max \left\{d_{1}, d_{2}, \ldots, d_{9}\right\}$. Suppose for the sake of contradiction that there is some integer $x \geq N$ such that $P(x)$ is composed of primes below 20 only. Then for every index $i \in\{1,2, \ldots, 9\}$ the number $x+d_{i}$ can be expressed as product of powers of the first 8 primes.

Since $x+d_{i}>x \geq d^{8}$ there is some prime power $f_{i}>d$ that divides $x+d_{i}$. Invoking the pigeonhole principle we see that there are two distinct indices $i$ and $j$ such that $f_{i}$ and $f_{j}$ are powers of the same prime number. For reasons of symmetry, we may suppose that $f_{i} \leq f_{j}$. Now both of the numbers $x+d_{i}$ and $x+d_{j}$ are divisible by $f_{i}$ and hence so is their difference $d_{i}-d_{j}$. But as

$$
0<\left|d_{i}-d_{j}\right| \leq \max \left(d_{i}, d_{j}\right) \leq d<f_{i},
$$

this is impossible. Thereby the problem is solved.",2,"Let $d_1, \ldots, d_9$ be distinct positive integers, and let $d = \max\{d_1, \ldots, d_9\}$. Let $\mathcal{P}$ be a set of 8 distinct prime numbers. Suppose that for some integer $x$, each of the numbers $x+d_1, \ldots, x+d_9$ has all its prime factors in $\mathcal{P}$, and that for each $i \in \{1, \ldots, 9\}$, there is a prime power $f_i > d$ that divides $x+d_i$. Prove that this is impossible.","For each $i \in \{1, \ldots, 9\}$, let $f_i$ be a prime power divisor of $x+d_i$ with $f_i > d$. The prime base of each $f_i$ must be in the set $\mathcal{P}$. Since there are 9 such prime powers $f_1, \ldots, f_9$ and only 8 primes in $\mathcal{P}$, the pigeonhole principle implies that at least two of them, say $f_i$ and $f_j$ for $i \neq j$, must be powers of the same prime $p \in \mathcal{P}$. Let $f_i = p^a$ and $f_j = p^b$, and assume without loss of generality that $a \le b$. Then $f_i$ divides $f_j$. Since $f_i | (x+d_i)$ and $f_j | (x+d_j)$, it follows that $f_i | (x+d_j)$. Therefore, $f_i$ must divide the difference $(x+d_j) - (x+d_i) = d_j - d_i$. As $d_i \neq d_j$, we have $d_j-d_i \neq 0$, so $f_i \le |d_j - d_i|$. But since $d_1, \ldots, d_9$ are distinct positive integers, $|d_j - d_i| < \max(d_i, d_j) \le d$. We now have $f_i > d$ from the premise and $f_i \le |d_j - d_i| < d$, which is a contradiction.","Consider a polynomial $P(x)=\left(x+d_{1}\right)\left(x+d_{2}\right) \cdot \ldots \cdot\left(x+d_{9}\right)$, where $d_{1}, d_{2}, \ldots, d_{9}$ are nine distinct integers. Prove that there exists an integer $N$ such that for all integers $x \geq N$ the number $P(x)$ is divisible by a prime number greater than 20.","Let $\mathcal{P}_8 = \{2,3,5,7,11,13,17,19\}$ be the set of the 8 primes not greater than 20. Assume for contradiction that for any $N$, there exists $x \geq N$ such that all prime factors of $P(x)$ are in $\mathcal{P}_8$. We may assume without loss of generality that the distinct integers $d_i$ are positive. Let $d = \max\{d_1, \ldots, d_9\}$. Choose $N=d^8$. Then there is an integer $x \ge d^8$ such that for each $i \in \{1,\ldots,9\}$, the number $x+d_i$ is only divisible by primes in $\mathcal{P}_8$. For each such $i$, we have $x+d_i > x \ge d^8$. Since $x+d_i$ is a product of powers of the 8 primes in $\mathcal{P}_8$, it must be divisible by a prime power $f_i > (d^8)^{1/8} = d$. The premises of the first sub-problem are met with $\mathcal{P} = \mathcal{P}_8$, but this was shown to be impossible. Thus, our initial assumption must be false. Therefore, there exists an integer $N$ such that for all $x \geq N$, $P(x)$ has a prime factor greater than 20.",,,,
2011n5,"Let $f$ be a function from the set of integers to the set of positive integers. Suppose that for any two integers $m$ and $n$, the difference $f(m)-f(n)$ is divisible by $f(m-n)$. Prove that for all integers $m$, $n$ with $f(m) \leq f(n)$ the number $f(n)$ is divisible by $f(m)$.","Suppose that $x$ and $y$ are two integers with $f(x)<f(y)$. We will show that $f(x) \mid f(y)$. By taking $m=x$ and $n=y$ we see that

$$
f(x-y)||f(x)-f(y)|=f(y)-f(x)>0,
$$

so $f(x-y) \leq f(y)-f(x)<f(y)$. Hence the number $d=f(x)-f(x-y)$ satisfies

$$
-f(y)<-f(x-y)<d<f(x)<f(y) .
$$

Taking $m=x$ and $n=x-y$ we see that $f(y) \mid d$, so we deduce $d=0$, or in other words $f(x)=f(x-y)$. Taking $m=x$ and $n=y$ we see that $f(x)=f(x-y) \mid f(x)-f(y)$, which implies $f(x) \mid f(y)$.",1,"Let $f$ be a function from the set of integers to the set of positive integers. Suppose that for any two integers $m$ and $n$, the difference $f(m)-f(n)$ is divisible by $f(m-n)$. Prove that for all integers $m$, $n$ with $f(m) \leq f(n)$ the number $f(n)$ is divisible by $f(m)$.","Suppose that $x$ and $y$ are two integers with $f(x)<f(y)$. We will show that $f(x) \mid f(y)$. By taking $m=x$ and $n=y$ we see that

$$
f(x-y)||f(x)-f(y)|=f(y)-f(x)>0,
$$

so $f(x-y) \leq f(y)-f(x)<f(y)$. Hence the number $d=f(x)-f(x-y)$ satisfies

$$
-f(y)<-f(x-y)<d<f(x)<f(y) .
$$

Taking $m=x$ and $n=x-y$ we see that $f(y) \mid d$, so we deduce $d=0$, or in other words $f(x)=f(x-y)$. Taking $m=x$ and $n=y$ we see that $f(x)=f(x-y) \mid f(x)-f(y)$, which implies $f(x) \mid f(y)$.",,,,,,
2011n6,"Let $P(x)$ and $Q(x)$ be two polynomials with integer coefficients such that no nonconstant polynomial with rational coefficients divides both $P(x)$ and $Q(x)$. Suppose that for every positive integer $n$ the integers $P(n)$ and $Q(n)$ are positive, and $2^{Q(n)}-1$ divides $3^{P(n)}-1$. Prove that $Q(x)$ is a constant polynomial.","Solution. First we show that there exists an integer $d$ such that for all positive integers $n$ we have $\operatorname{gcd}(P(n), Q(n)) \leq d$.

Since $P(x)$ and $Q(x)$ are coprime (over the polynomials with rational coefficients), Euclid's algorithm provides some polynomials $R_{0}(x), S_{0}(x)$ with rational coefficients such that $P(x) R_{0}(x)-$ $Q(x) S_{0}(x)=1$. Multiplying by a suitable positive integer $d$, we obtain polynomials $R(x)=$ $d \cdot R_{0}(x)$ and $S(x)=d \cdot S_{0}(x)$ with integer coefficients for which $P(x) R(x)-Q(x) S(x)=d$. Then we have $\operatorname{gcd}(P(n), Q(n)) \leq d$ for any integer $n$.

To prove the problem statement, suppose that $Q(x)$ is not constant. Then the sequence $Q(n)$ is not bounded and we can choose a positive integer $m$ for which


\begin{equation*}
M=2^{Q(m)}-1 \geq 3^{\max \{P(1), P(2), \ldots, P(d)\}} . \tag{1}
\end{equation*}


Since $M=2^{Q(n)}-1 \mid 3^{P(n)}-1$, we have $2,3 \nmid M$. Let $a$ and $b$ be the multiplicative orders of 2 and 3 modulo $M$, respectively. Obviously, $a=Q(m)$ since the lower powers of 2 do not reach $M$. Since $M$ divides $3^{P(m)}-1$, we have $b \mid P(m)$. Then $\operatorname{gcd}(a, b) \leq \operatorname{gcd}(P(m), Q(m)) \leq d$. Since the expression $a x-b y$ attains all integer values divisible by $\operatorname{gcd}(a, b)$ when $x$ and $y$ run over all nonnegative integer values, there exist some nonnegative integers $x, y$ such that $1 \leq m+a x-b y \leq d$.

By $Q(m+a x) \equiv Q(m)(\bmod a)$ we have

$$
2^{Q(m+a x)} \equiv 2^{Q(m)} \equiv 1 \quad(\bmod M)
$$

and therefore

$$
M\left|2^{Q(m+a x)}-1\right| 3^{P(m+a x)}-1 .
$$

Then, by $P(m+a x-b y) \equiv P(m+a x)(\bmod b)$ we have

$$
3^{P(m+a x-b y)} \equiv 3^{P(m+a x)} \equiv 1 \quad(\bmod M) .
$$

Since $P(m+a x-b y)>0$ this implies $M \leq 3^{P(m+a x-b y)}-1$. But $P(m+a x-b y)$ is listed among $P(1), P(2), \ldots, P(d)$, so

$$
M<3^{P(m+a x-b y)} \leq 3^{\max \{P(1), P(2), \ldots, P(d)\}}
$$

which contradicts (1).

Comment. We present another variant of the solution above.\\
Denote the degree of $P$ by $k$ and its leading coefficient by $p$. Consider any positive integer $n$ and let $a=Q(n)$. Again, denote by $b$ the multiplicative order of 3 modulo $2^{a}-1$. Since $2^{a}-1 \mid 3^{P(n)}-1$, we have $b \mid P(n)$. Moreover, since $2^{Q(n+a t)}-1 \mid 3^{P(n+a t)}-1$ and $a=Q(n) \mid Q(n+a t)$ for each positive integer $t$, we have $2^{a}-1 \mid 3^{P(n+a t)}-1$, hence $b \mid P(n+a t)$ as well.\\
Therefore, $b$ divides $\operatorname{gcd}\{P(n+a t): t \geq 0\}$; hence it also divides the number

$$
\sum_{i=0}^{k}(-1)^{k-i}\binom{k}{i} P(n+a i)=p \cdot k!\cdot a^{k} .
$$

Finally, we get $b \mid \operatorname{gcd}\left(P(n), k!\cdot p \cdot Q(n)^{k}\right)$, which is bounded by the same arguments as in the beginning of the solution. So $3^{b}-1$ is bounded, and hence $2^{Q(n)}-1$ is bounded as well.",3,"Let $P(x)$ and $Q(x)$ be two polynomials with integer coefficients such that no nonconstant polynomial with rational coefficients divides both $P(x)$ and $Q(x)$. Show that there exists a positive integer $d$ such that for all positive integers $n$, $\\operatorname{gcd}(P(n), Q(n)) \\leq d$.","Since $P(x)$ and $Q(x)$ are coprime as polynomials over $\\mathbb{Q}[x]$, Bezout's identity for polynomials states there exist polynomials $R_0(x), S_0(x) \\in \\mathbb{Q}[x]$ such that $P(x)R_0(x) - Q(x)S_0(x) = 1$. By clearing the denominators of the coefficients, we can find an integer $d \neq 0$ and polynomials $R(x), S(x) \\in \\mathbb{Z}[x]$ for which $P(x)R(x) - Q(x)S(x) = d$. For any integer $n$, this implies $P(n)R(n) - Q(n)S(n) = d$. Any common divisor of $P(n)$ and $Q(n)$ must divide this integer combination, so it must divide $d$. Therefore, for all positive integers $n$, $\\operatorname{gcd}(P(n), Q(n)) \\leq |d|$.","Let $P(x), Q(x)$ be polynomials satisfying the conditions of the main problem. Let $d$ be an integer such that $\\operatorname{gcd}(P(n), Q(n)) \\leq d$ for all $n \\in \\mathbb{Z}^+$. Show that for any integer $m$ with $Q(m)>1$, there exists an integer $k$, $1 \\leq k \\leq d$, such that $2^{Q(m)}-1$ divides $3^{P(k)}-1$.","Let $m$ be a positive integer with $Q(m)>1$. Let $M=2^{Q(m)}-1$, $a=Q(m)$, and $b$ be the multiplicative order of 3 modulo $M$. The given condition $M|3^{P(m)}-1$ implies $b|P(m)$. Let $g = \\operatorname{gcd}(a, b)$. We have $g \\leq \\operatorname{gcd}(Q(m), P(m)) \\leq d$. The set of integers $\{m+ax-by \\mid x,y \\in \\mathbb{Z}\\}$ is the arithmetic progression $\{m+jg \\mid j \\in \\mathbb{Z}\}$. Since $g \\le d$, this progression must contain an integer $k$ in the interval $[1,d]$. Let $k=m+ax_0-by_0$ for some integers $x_0,y_0$. We can choose $x_0$ to be a large positive integer. Since $Q(m+ax_0) \\equiv Q(m) \\pmod a$, we have $M | 2^{Q(m+ax_0)}-1$. By hypothesis, $M | 3^{P(m+ax_0)}-1$, so $b | P(m+ax_0)$. From $P(k) \\equiv P(m+ax_0) \\pmod b$, we get $3^{P(k)} \\equiv 3^{P(m+ax_0)} \\equiv 1 \\pmod M$. Since $P(k)>0$, this means $M|3^{P(k)}-1$.","Let $P(x)$ and $Q(x)$ be two polynomials with integer coefficients such that no nonconstant polynomial with rational coefficients divides both $P(x)$ and $Q(x)$. Suppose that for every positive integer $n$ the integers $P(n)$ and $Q(n)$ are positive, and $2^{Q(n)}-1$ divides $3^{P(n)}-1$. Prove that $Q(x)$ is a constant polynomial.","We proceed by contradiction. Assume $Q(x)$ is not a constant polynomial. Since $Q(n) > 0$ for $n \\in \\mathbb{Z}^+$, the sequence $Q(n)$ must be unbounded. By Sub-problem 1, there exists an integer $d$ such that $\\operatorname{gcd}(P(n), Q(n)) \\leq d$ for all $n$. Let $C = 3^{\\max\\{P(1), P(2), \\ldots, P(d)\\}}$. Since $Q(n)$ is unbounded, we can choose a large integer $m$ such that $M = 2^{Q(m)}-1 > C$. By Sub-problem 2, there exists an integer $k$, $1 \\leq k \\leq d$, such that $M$ divides $3^{P(k)}-1$. This implies $M < 3^{P(k)}$. However, since $1 \\leq k \\leq d$, we have $P(k) \\leq \\max\\{P(1), \\dots, P(d)\\}$, so $M < 3^{P(k)} \\leq C$. This contradicts our choice of $m$ which ensures $M>C$. Thus, our initial assumption must be false, and $Q(x)$ is a constant polynomial.",,
2011n7,"Let $p$ be an odd prime number. For every integer $a$, define the number

$$
S_{a}=\frac{a}{1}+\frac{a^{2}}{2}+\cdots+\frac{a^{p-1}}{p-1} .
$$

Let $m$ and $n$ be integers such that

$$
S_{3}+S_{4}-3 S_{2}=\frac{m}{n} .
$$

Prove that $p$ divides $m$.","For rational numbers $p_{1} / q_{1}$ and $p_{2} / q_{2}$ with the denominators $q_{1}, q_{2}$ not divisible by $p$, we write $p_{1} / q_{1} \equiv p_{2} / q_{2}(\bmod p)$ if the numerator $p_{1} q_{2}-p_{2} q_{1}$ of their difference is divisible by $p$.

We start with finding an explicit formula for the residue of $S_{a}$ modulo $p$. Note first that for every $k=1, \ldots, p-1$ the number $\binom{p}{k}$ is divisible by $p$, and

$$
\frac{1}{p}\binom{p}{k}=\frac{(p-1)(p-2) \cdots(p-k+1)}{k!} \equiv \frac{(-1) \cdot(-2) \cdots(-k+1)}{k!}=\frac{(-1)^{k-1}}{k} \quad(\bmod p)
$$

Therefore, we have

$$
S_{a}=-\sum_{k=1}^{p-1} \frac{(-a)^{k}(-1)^{k-1}}{k} \equiv-\sum_{k=1}^{p-1}(-a)^{k} \cdot \frac{1}{p}\binom{p}{k} \quad(\bmod p) .
$$

The number on the right-hand side is integer. Using the binomial formula we express it as

$$
-\sum_{k=1}^{p-1}(-a)^{k} \cdot \frac{1}{p}\binom{p}{k}=-\frac{1}{p}\left(-1-(-a)^{p}+\sum_{k=0}^{p}(-a)^{k}\binom{p}{k}\right)=\frac{(a-1)^{p}-a^{p}+1}{p}
$$

since $p$ is odd. So, we have

$$
S_{a} \equiv \frac{(a-1)^{p}-a^{p}+1}{p} \quad(\bmod p) .
$$

Finally, using the obtained formula we get

$$
\begin{aligned}
S_{3}+S_{4}-3 S_{2} & \equiv \frac{\left(2^{p}-3^{p}+1\right)+\left(3^{p}-4^{p}+1\right)-3\left(1^{p}-2^{p}+1\right)}{p} \\
& =\frac{4 \cdot 2^{p}-4^{p}-4}{p}=-\frac{\left(2^{p}-2\right)^{2}}{p} \quad(\bmod p) .
\end{aligned}
$$

By Fermat's theorem, $p \mid 2^{p}-2$, so $p^{2} \mid\left(2^{p}-2\right)^{2}$ and hence $S_{3}+S_{4}-3 S_{2} \equiv 0(\bmod p)$.",2,"Let $p$ be an odd prime and for any integer $a$, let $S_{a}=\sum_{k=1}^{p-1} \frac{a^k}{k}$. Prove that $S_{a} \equiv \frac{(a-1)^{p}-a^{p}+1}{p} \pmod{p}$.","For $k \in \{1, \ldots, p-1\}$, we have the congruence $\frac{1}{k} \equiv \frac{(-1)^{k-1}}{k} \frac{k!}{(p-1)\cdots(p-k+1)} \frac{(p-1)\cdots(p-k+1)}{k!} = (-1)^{k-1} \frac{1}{p}\binom{p}{k} \pmod{p}$.
Substituting this into the sum for $S_a$, we get:
$S_{a} = \sum_{k=1}^{p-1} \frac{a^k}{k} \equiv \sum_{k=1}^{p-1} a^k (-1)^{k-1} \frac{1}{p}\binom{p}{k} = -\frac{1}{p} \sum_{k=1}^{p-1} (-a)^k \binom{p}{k} \pmod{p}$.
From the binomial theorem, $\sum_{k=1}^{p-1} (-a)^k \binom{p}{k} = (1-a)^p - \binom{p}{0}(-a)^0 - \binom{p}{p}(-a)^p = (1-a)^p - 1 - (-a)^p$.
Since $p$ is odd, $(1-a)^p = -(a-1)^p$ and $(-a)^p = -a^p$. So the sum is $-(a-1)^p - 1 + a^p$.
Therefore, $S_a \equiv -\frac{1}{p}(-(a-1)^p + a^p - 1) = \frac{(a-1)^{p}-a^{p}+1}{p} \pmod{p}$.","Let $p$ be an odd prime number. For every integer $a$, define the number $S_{a}=\frac{a}{1}+\frac{a^{2}}{2}+\cdots+\frac{a^{p-1}}{p-1}$. Let $m$ and $n$ be integers such that $S_{3}+S_{4}-3 S_{2}=\frac{m}{n}$. Prove that $p$ divides $m$.","Using the result $S_{a} \equiv \frac{(a-1)^{p}-a^{p}+1}{p} \pmod{p}$ from the previous step, we can compute the expression modulo $p$:
$S_3 \equiv \frac{2^p-3^p+1}{p} \pmod p$
$S_4 \equiv \frac{3^p-4^p+1}{p} \pmod p$
$S_2 \equiv \frac{1^p-2^p+1}{p} = \frac{2-2^p}{p} \pmod p$
Combining these, we get:
$S_{3}+S_{4}-3 S_{2} \equiv \frac{(2^{p}-3^{p}+1) + (3^{p}-4^{p}+1) - 3(2-2^{p})}{p} \pmod{p}$.
The numerator simplifies to $2^p-3^p+1+3^p-4^p+1-6+3 \cdot 2^p = 4 \cdot 2^p - 4^p - 4 = -(4^p - 4 \cdot 2^p + 4) = -(2^{2p} - 2 \cdot 2 \cdot 2^p + 4) = -(2^p - 2)^2$.
So, $S_{3}+S_{4}-3 S_{2} \equiv -\frac{(2^p-2)^2}{p} \pmod{p}$.
By Fermat's Little Theorem, $2^p-2$ is divisible by $p$. Thus, $(2^p-2)^2$ is divisible by $p^2$. Let $(2^p-2)^2 = kp^2$ for some integer $k$. Then $S_3+S_4-3S_2 \equiv -\frac{kp^2}{p} = -kp \equiv 0 \pmod p$. Since $S_3+S_4-3S_2=m/n$, this implies $m/n \equiv 0 \pmod p$, so $p$ must divide $m$.",,,,
2011n8,"Let $k$ be a positive integer and set $n=2^{k}+1$. Prove that $n$ is a prime number if and only if the following holds: there is a permutation $a_{1}, \ldots, a_{n-1}$ of the numbers $1,2, \ldots, n-1$ and a sequence of integers $g_{1}, g_{2}, \ldots, g_{n-1}$ such that $n$ divides $g_{i}^{a_{i}}-a_{i+1}$ for every $i \in\{1,2, \ldots, n-1\}$, where we set $a_{n}=a_{1}$.","Solution. Let $N=\{1,2, \ldots, n-1\}$. For $a, b \in N$, we say that $b$ follows $a$ if there exists an integer $g$ such that $b \equiv g^{a}(\bmod n)$ and denote this property as $a \rightarrow b$. This way we have a directed graph with $N$ as set of vertices. If $a_{1}, \ldots, a_{n-1}$ is a permutation of $1,2, \ldots, n-1$ such that $a_{1} \rightarrow a_{2} \rightarrow \ldots \rightarrow a_{n-1} \rightarrow a_{1}$ then this is a Hamiltonian cycle in the graph.

Step I. First consider the case when $n$ is composite. Let $n=p_{1}^{\alpha_{1}} \ldots p_{s}^{\alpha_{s}}$ be its prime factorization. All primes $p_{i}$ are odd.

Suppose that $\alpha_{i}>1$ for some $i$. For all integers $a, g$ with $a \geq 2$, we have $g^{a} \not \equiv p_{i}\left(\bmod p_{i}^{2}\right)$, because $g^{a}$ is either divisible by $p_{i}^{2}$ or it is not divisible by $p_{i}$. It follows that in any Hamiltonian cycle $p_{i}$ comes immediately after 1 . The same argument shows that $2 p_{i}$ also should come immediately after 1 , which is impossible. Hence, there is no Hamiltonian cycle in the graph.

Now suppose that $n$ is square-free. We have $n=p_{1} p_{2} \ldots p_{s}>9$ and $s \geq 2$. Assume that there exists a Hamiltonian cycle. There are $\frac{n-1}{2}$ even numbers in this cycle, and each number which follows one of them should be a quadratic residue modulo $n$. So, there should be at least $\frac{n-1}{2}$ nonzero quadratic residues modulo $n$. On the other hand, for each $p_{i}$ there exist exactly $\frac{p_{i}+1}{2}$ quadratic residues modulo $p_{i}$; by the Chinese Remainder Theorem, the number of quadratic residues modulo $n$ is exactly $\frac{p_{1}+1}{2} \cdot \frac{p_{2}+1}{2} \cdot \ldots \cdot \frac{p_{s}+1}{2}$, including 0 . Then we have a contradiction by

$$
\frac{p_{1}+1}{2} \cdot \frac{p_{2}+1}{2} \cdot \ldots \cdot \frac{p_{s}+1}{2} \leq \frac{2 p_{1}}{3} \cdot \frac{2 p_{2}}{3} \cdot \ldots \cdot \frac{2 p_{s}}{3}=\left(\frac{2}{3}\right)^{s} n \leq \frac{4 n}{9}<\frac{n-1}{2} .
$$

This proves the ""if""-part of the problem.\\
Step II. Now suppose that $n$ is prime. For any $a \in N$, denote by $\nu_{2}(a)$ the exponent of 2 in the prime factorization of $a$, and let $\mu(a)=\max \left\{t \in[0, k] \mid 2^{t} \rightarrow a\right\}$.

Lemma. For any $a, b \in N$, we have $a \rightarrow b$ if and only if $\nu_{2}(a) \leq \mu(b)$.\\
Proof. Let $\ell=\nu_{2}(a)$ and $m=\mu(b)$.\\
Suppose $\ell \leq m$. Since $b$ follows $2^{m}$, there exists some $g_{0}$ such that $b \equiv g_{0}^{2^{m}}(\bmod n)$. By $\operatorname{gcd}(a, n-1)=2^{\ell}$ there exist some integers $p$ and $q$ such that $p a-q(n-1)=2^{\ell}$. Choosing $g=g_{0}^{2^{m-\ell} p}$ we have $g^{a}=g_{0}^{2^{m-\ell_{p a}}}=g_{0}^{2^{m}+2^{m-\ell} q(n-1)} \equiv g_{0}^{2^{m}} \equiv b(\bmod n)$ by FERMAT's theorem. Hence, $a \rightarrow b$.

To prove the reverse statement, suppose that $a \rightarrow b$, so $b \equiv g^{a}(\bmod n)$ with some $g$. Then $b \equiv\left(g^{a / 2^{\ell}}\right)^{2^{\ell}}$, and therefore $2^{\ell} \rightarrow b$. By the definition of $\mu(b)$, we have $\mu(b) \geq \ell$. The lemma is\\
proved.\\
Now for every $i$ with $0 \leq i \leq k$, let

$$
\begin{aligned}
A_{i} & =\left\{a \in N \mid \nu_{2}(a)=i\right\}, \\
B_{i} & =\{a \in N \mid \mu(a)=i\}, \\
\text { and } C_{i} & =\{a \in N \mid \mu(a) \geq i\}=B_{i} \cup B_{i+1} \cup \ldots \cup B_{k} .
\end{aligned}
$$

We claim that $\left|A_{i}\right|=\left|B_{i}\right|$ for all $0 \leq i \leq k$. Obviously we have $\left|A_{i}\right|=2^{k-i-1}$ for all $i=$ $0, \ldots, k-1$, and $\left|A_{k}\right|=1$. Now we determine $\left|C_{i}\right|$. We have $\left|C_{0}\right|=n-1$ and by Fermat's theorem we also have $C_{k}=\{1\}$, so $\left|C_{k}\right|=1$. Next, notice that $C_{i+1}=\left\{x^{2} \bmod n \mid x \in C_{i}\right\}$. For every $a \in N$, the relation $x^{2} \equiv a(\bmod n)$ has at most two solutions in $N$. Therefore we have $2\left|C_{i+1}\right| \leq\left|C_{i}\right|$, with the equality achieved only if for every $y \in C_{i+1}$, there exist distinct elements $x, x^{\prime} \in C_{i}$ such that $x^{2} \equiv x^{\prime 2} \equiv y(\bmod n)\left(\right.$ this implies $\left.x+x^{\prime}=n\right)$. Now, since $2^{k}\left|C_{k}\right|=\left|C_{0}\right|$, we obtain that this equality should be achieved in each step. Hence $\left|C_{i}\right|=2^{k-i}$ for $0 \leq i \leq k$, and therefore $\left|B_{i}\right|=2^{k-i-1}$ for $0 \leq i \leq k-1$ and $\left|B_{k}\right|=1$.

From the previous arguments we can see that for each $z \in C_{i}(0 \leq i<k)$ the equation $x^{2} \equiv z^{2}$ $(\bmod n)$ has two solutions in $C_{i}$, so we have $n-z \in C_{i}$. Hence, for each $i=0,1, \ldots, k-1$, exactly half of the elements of $C_{i}$ are odd. The same statement is valid for $B_{i}=C_{i} \backslash C_{i+1}$ for $0 \leq i \leq k-2$. In particular, each such $B_{i}$ contains an odd number. Note that $B_{k}=\{1\}$ also contains an odd number, and $B_{k-1}=\left\{2^{k}\right\}$ since $C_{k-1}$ consists of the two square roots of 1 modulo $n$.

Step III. Now we construct a Hamiltonian cycle in the graph. First, for each $i$ with $0 \leq i \leq k$, connect the elements of $A_{i}$ to the elements of $B_{i}$ by means of an arbitrary bijection. After performing this for every $i$, we obtain a subgraph with all vertices having in-degree 1 and outdegree 1 , so the subgraph is a disjoint union of cycles. If there is a unique cycle, we are done. Otherwise, we modify the subgraph in such a way that the previous property is preserved and the number of cycles decreases; after a finite number of steps we arrive at a single cycle.

For every cycle $C$, let $\lambda(C)=\min _{c \in C} \nu_{2}(c)$. Consider a cycle $C$ for which $\lambda(C)$ is maximal. If $\lambda(C)=0$, then for any other cycle $C^{\prime}$ we have $\lambda\left(C^{\prime}\right)=0$. Take two arbitrary vertices $a \in C$ and $a^{\prime} \in C^{\prime}$ such that $\nu_{2}(a)=\nu_{2}\left(a^{\prime}\right)=0$; let their direct successors be $b$ and $b^{\prime}$, respectively. Then we can unify $C$ and $C^{\prime}$ to a single cycle by replacing the edges $a \rightarrow b$ and $a^{\prime} \rightarrow b^{\prime}$ by $a \rightarrow b^{\prime}$ and $a^{\prime} \rightarrow b$.

Now suppose that $\lambda=\lambda(C) \geq 1$; let $a \in C \cap A_{\lambda}$. If there exists some $a^{\prime} \in A_{\lambda} \backslash C$, then $a^{\prime}$ lies in another cycle $C^{\prime}$ and we can merge the two cycles in exactly the same way as above. So, the only remaining case is $A_{\lambda} \subset C$. Since the edges from $A_{\lambda}$ lead to $B_{\lambda}$, we get also $B_{\lambda} \subset C$. If $\lambda \neq k-1$ then $B_{\lambda}$ contains an odd number; this contradicts the assumption $\lambda(C)>0$. Finally, if $\lambda=k-1$, then $C$ contains $2^{k-1}$ which is the only element of $A_{k-1}$. Since $B_{k-1}=\left\{2^{k}\right\}=A_{k}$ and $B_{k}=\{1\}$, the cycle $C$ contains the path $2^{k-1} \rightarrow 2^{k} \rightarrow 1$ and it contains an odd number again. This completes the proof of the ""only if""-part of the problem.

Comment 1. The lemma and the fact $\left|A_{i}\right|=\left|B_{i}\right|$ together show that for every edge $a \rightarrow b$ of the Hamiltonian cycle, $\nu_{2}(a)=\mu(b)$ must hold. After this observation, the Hamiltonian cycle can be built in many ways. For instance, it is possible to select edges from $A_{i}$ to $B_{i}$ for $i=k, k-1, \ldots, 1$ in such a way that they form disjoint paths; at the end all these paths will have odd endpoints. In the final step, the paths can be closed to form a unique cycle.

Comment 2. Step II is an easy consequence of some basic facts about the multiplicative group modulo the prime $n=2^{k}+1$. The Lemma follows by noting that this group has order $2^{k}$, so the $a$-th powers are exactly the $2^{\nu_{2}(a)}$-th powers. Using the existence of a primitive root $g$ modulo $n$ one sees that the map from $\{1,2, \ldots, n-1\}$ to itself that sends $a$ to $g^{a} \bmod n$ is a bijection that sends $A_{i}$ to $B_{i}$ for each $i \in\{0, \ldots, k\}$.",4,"Let $n=2^k+1$. The problem condition is equivalent to the existence of a Hamiltonian cycle in a directed graph with vertices $V=\{1, \dots, n-1\}$ and edges $a \to b$ if $b \equiv g^a \pmod n$ for some integer $g$. Prove that if $n$ is composite, no such Hamiltonian cycle exists.","If $n$ is not square-free, let $p$ be a prime such that $p^2 | n$. For any $a \ge 2$, $g^a \pmod{p^2}$ is either 0 or not a multiple of $p$. Thus, neither $p$ nor $2p$ can follow any number $a \ge 2$. They must both follow 1, which is impossible in a cycle. If $n$ is square-free, $n=p_1 \dots p_s$ with $s \ge 2$. Any number following one of the $(n-1)/2$ even numbers must be a quadratic residue. This requires at least $(n-1)/2$ non-zero quadratic residues. But the number of quadratic residues modulo $n$ (including 0) is $\prod_{i=1}^s \frac{p_i+1}{2}$. For $s \ge 2$, this is less than or equal to $(\frac{2}{3})^s n \le \frac{4n}{9}$, which is less than $\frac{n-1}{2}$. This contradiction shows no Hamiltonian cycle exists if $n$ is composite.","Let $n=2^k+1$ be a prime. For $a, b \in \{1, \ldots, n-1\}$, let an edge $a \rightarrow b$ exist if $b \equiv g^a \pmod n$ for some integer $g$. Let $\nu_2(a)$ be the exponent of 2 in the prime factorization of $a$, and $\mu(b) = \max\{t \in \{0, \dots, k\} \mid \exists h: b \equiv h^{2^t} \pmod n\}$. Prove that an edge $a \rightarrow b$ exists if and only if $\nu_2(a) \leq \mu(b)$.","Let $\ell = \nu_2(a)$ and $m = \mu(b)$. If $\ell \le m$, then $b \equiv g_0^{2^m} \pmod n$ for some $g_0$. Since $\gcd(a, n-1) = 2^\ell$, there exist integers $p,q$ such that $pa - q(n-1) = 2^\ell$. Let $g = g_0^{p \cdot 2^{m-\ell}}$. Then $g^a = g_0^{p a \cdot 2^{m-\ell}} = g_0^{(q(n-1)+2^\ell) 2^{m-\ell}} \equiv g_0^{2^m} \equiv b \pmod n$ by Fermat's Little Theorem. Thus $a \rightarrow b$. Conversely, if $a \rightarrow b$, then $b \equiv g^a \pmod n$. Let $a = 2^\ell \cdot a'$ with $a'$ odd. Then $b \equiv (g^{a'})^{2^\ell} \pmod n$. This shows that $b$ is a $2^\ell$-th power, so by definition of $\mu(b)$, we have $\mu(b) \ge \ell = \nu_2(a)$.","Let $n=2^k+1$ be a prime. For $i \in \{0, \ldots, k\}$, define the sets $A_i = \{a \in \{1, \ldots, n-1\} \mid \nu_2(a) = i\}$ and $B_i = \{b \in \{1, \ldots, n-1\} \mid \mu(b) = i\}$, where $\nu_2$ and $\mu$ are defined as in the previous sub-problem. Prove that $|A_i| = |B_i|$ for all $i$.","The size of $A_i$ is the number of integers in $\{1, \ldots, 2^k\}$ of the form $2^i \cdot m$ with $m$ odd. For $i < k$, these are $m=1, 3, \ldots, 2^{k-i}-1$, so there are $2^{k-i-1}$ such numbers. For $i=k$, $A_k=\{2^k\}$, so $|A_k|=1$. Now, let $C_i = \bigcup_{j=i}^k B_j = \{b \mid \mu(b) \ge i\}$. $C_i$ is the set of $2^i$-th powers modulo $n$. Since the multiplicative group $(\mathbb{Z}/n\mathbb{Z})^*$ is cyclic of order $n-1=2^k$, the set of $2^i$-th powers has size $(n-1)/ \gcd(2^i, n-1) = 2^k/2^i = 2^{k-i}$. Then $|B_i| = |C_i| - |C_{i+1}| = 2^{k-i} - 2^{k-i-1} = 2^{k-i-1}$ for $i < k$. For $i=k$, $|B_k|=|C_k|=2^{k-k}=1$. Thus, $|A_i|=|B_i|$ for all $i=0, \ldots, k$.","Let $k$ be a positive integer and set $n=2^{k}+1$. Prove that $n$ is a prime number if and only if the following holds: there is a permutation $a_{1}, \ldots, a_{n-1}$ of the numbers $1,2, \ldots, n-1$ and a sequence of integers $g_{1}, g_{2}, \ldots, g_{n-1}$ such that $n$ divides $g_{i}^{a_{i}}-a_{i+1}$ for every $i \in\{1,2, \ldots, n-1\}$, where we set $a_{n}=a_{1}$.","The condition is equivalent to the existence of a Hamiltonian cycle in the graph defined in Sub-problem 1. \n($\Rightarrow$) If a Hamiltonian cycle exists, then by Sub-problem 1, $n$ must be prime. \n($\Leftarrow$) Assume $n$ is prime. By Sub-problem 3, we know $|A_i|=|B_i|$ for all $i=0, \ldots, k$. By Sub-problem 2, an edge $a \rightarrow b$ can exist if $a \in A_i$ and $b \in B_i$. We can thus form bijections mapping $A_i$ to $B_i$ for each $i$. This creates a subgraph where every vertex has in-degree 1 and out-degree 1, which is a disjoint union of cycles. If there is more than one cycle, take two cycles $C_1, C_2$. Pick vertices $a_1 \in C_1, a_2 \in C_2$ with $\nu_2(a_1)=\nu_2(a_2)$ (such vertices exist). Let their successors be $b_1, b_2$. Replacing edges $a_1 \to b_1, a_2 \to b_2$ with $a_1 \to b_2, a_2 \to b_1$ merges the two cycles. Repeat this process until a single Hamiltonian cycle remains."
2010a2,"Let the real numbers $a, b, c, d$ satisfy the relations $a+b+c+d=6$ and $a^{2}+b^{2}+c^{2}+d^{2}=12$. Prove that

$$
36 \leq 4\left(a^{3}+b^{3}+c^{3}+d^{3}\right)-\left(a^{4}+b^{4}+c^{4}+d^{4}\right) \leq 48 .
$$","Observe that

$$
\begin{gathered}
4\left(a^{3}+b^{3}+c^{3}+d^{3}\right)-\left(a^{4}+b^{4}+c^{4}+d^{4}\right)=-\left((a-1)^{4}+(b-1)^{4}+(c-1)^{4}+(d-1)^{4}\right) \\
+6\left(a^{2}+b^{2}+c^{2}+d^{2}\right)-4(a+b+c+d)+4 \\
=-\left((a-1)^{4}+(b-1)^{4}+(c-1)^{4}+(d-1)^{4}\right)+52 .
\end{gathered}
$$

Now, introducing $x=a-1, y=b-1, z=c-1, t=d-1$, we need to prove the inequalities

$$
16 \geq x^{4}+y^{4}+z^{4}+t^{4} \geq 4,
$$

under the constraint

\begin{equation*}
x^{2}+y^{2}+z^{2}+t^{2}=\left(a^{2}+b^{2}+c^{2}+d^{2}\right)-2(a+b+c+d)+4=4 \tag{1}
\end{equation*}

(we will not use the value of $x+y+z+t$ though it can be found).\\
Now the rightmost inequality in (1) follows from the power mean inequality:

$$
x^{4}+y^{4}+z^{4}+t^{4} \geq \frac{\left(x^{2}+y^{2}+z^{2}+t^{2}\right)^{2}}{4}=4 .
$$

For the other one, expanding the brackets we note that

$$
\left(x^{2}+y^{2}+z^{2}+t^{2}\right)^{2}=\left(x^{4}+y^{4}+z^{4}+t^{4}\right)+q,
$$

where $q$ is a nonnegative number, so

$$
x^{4}+y^{4}+z^{4}+t^{4} \leq\left(x^{2}+y^{2}+z^{2}+t^{2}\right)^{2}=16,
$$

and we are done.\\",1,"Let the real numbers $a, b, c, d$ satisfy the relations $a+b+c+d=6$ and $a^{2}+b^{2}+c^{2}+d^{2}=12$. Prove that

$$
36 \leq 4\left(a^{3}+b^{3}+c^{3}+d^{3}\right)-\left(a^{4}+b^{4}+c^{4}+d^{4}\right) \leq 48 .
$$","Observe that

$$
\begin{gathered}
4\left(a^{3}+b^{3}+c^{3}+d^{3}\right)-\left(a^{4}+b^{4}+c^{4}+d^{4}\right)=-\left((a-1)^{4}+(b-1)^{4}+(c-1)^{4}+(d-1)^{4}\right) \\
+6\left(a^{2}+b^{2}+c^{2}+d^{2}\right)-4(a+b+c+d)+4 \\
=-\left((a-1)^{4}+(b-1)^{4}+(c-1)^{4}+(d-1)^{4}\right)+52 .
\end{gathered}
$$

Now, introducing $x=a-1, y=b-1, z=c-1, t=d-1$, we need to prove the inequalities

$$
16 \geq x^{4}+y^{4}+z^{4}+t^{4} \geq 4,
$$

under the constraint

\begin{equation*}
x^{2}+y^{2}+z^{2}+t^{2}=\left(a^{2}+b^{2}+c^{2}+d^{2}\right)-2(a+b+c+d)+4=4 \tag{1}
\end{equation*}

(we will not use the value of $x+y+z+t$ though it can be found).\\
Now the rightmost inequality in (1) follows from the power mean inequality:

$$
x^{4}+y^{4}+z^{4}+t^{4} \geq \frac{\left(x^{2}+y^{2}+z^{2}+t^{2}\right)^{2}}{4}=4 .
$$

For the other one, expanding the brackets we note that

$$
\left(x^{2}+y^{2}+z^{2}+t^{2}\right)^{2}=\left(x^{4}+y^{4}+z^{4}+t^{4}\right)+q,
$$

where $q$ is a nonnegative number, so

$$
x^{4}+y^{4}+z^{4}+t^{4} \leq\left(x^{2}+y^{2}+z^{2}+t^{2}\right)^{2}=16,
$$

and we are done.\\",,,,,,
2010a4,"A sequence $x_{1}, x_{2}, \ldots$ is defined by $x_{1}=1$ and $x_{2 k}=-x_{k}, x_{2 k-1}=(-1)^{k+1} x_{k}$ for all $k \geq 1$. Prove that $x_{1}+x_{2}+\cdots+x_{n} \geq 0$ for all $n \geq 1$.","We start with some observations. First, from the definition of $x_{i}$ it follows that for each positive integer $k$ we have

\begin{equation*}
x_{4 k-3}=x_{2 k-1}=-x_{4 k-2} \quad \text { and } \quad x_{4 k-1}=x_{4 k}=-x_{2 k}=x_{k} . \tag{1}
\end{equation*}

Hence, denoting $S_{n}=\sum_{i=1}^{n} x_{i}$, we have

\begin{gather*}
S_{4 k}=\sum_{i=1}^{k}\left(\left(x_{4 k-3}+x_{4 k-2}\right)+\left(x_{4 k-1}+x_{4 k}\right)\right)=\sum_{i=1}^{k}\left(0+2 x_{k}\right)=2 S_{k}  \tag{2}\\
S_{4 k+2}=S_{4 k}+\left(x_{4 k+1}+x_{4 k+2}\right)=S_{4 k} \tag{3}
\end{gather*}

Observe also that $S_{n}=\sum_{i=1}^{n} x_{i} \equiv \sum_{i=1}^{n} 1=n(\bmod 2)$.\\
Now we prove by induction on $k$ that $S_{i} \geq 0$ for all $i \leq 4 k$. The base case is valid since $x_{1}=x_{3}=x_{4}=1, x_{2}=-1$. For the induction step, assume that $S_{i} \geq 0$ for all $i \leq 4 k$. Using the relations (1)-(3), we obtain

$$
S_{4 k+4}=2 S_{k+1} \geq 0, \quad S_{4 k+2}=S_{4 k} \geq 0, \quad S_{4 k+3}=S_{4 k+2}+x_{4 k+3}=\frac{S_{4 k+2}+S_{4 k+4}}{2} \geq 0
$$

So, we are left to prove that $S_{4 k+1} \geq 0$. If $k$ is odd, then $S_{4 k}=2 S_{k} \geq 0$; since $k$ is odd, $S_{k}$ is odd as well, so we have $S_{4 k} \geq 2$ and hence $S_{4 k+1}=S_{4 k}+x_{4 k+1} \geq 1$.

Conversely, if $k$ is even, then we have $x_{4 k+1}=x_{2 k+1}=x_{k+1}$, hence $S_{4 k+1}=S_{4 k}+x_{4 k+1}=$ $2 S_{k}+x_{k+1}=S_{k}+S_{k+1} \geq 0$. The step is proved.",2,"Let $S_n = \\sum_{i=1}^n x_i$. Prove that for any integer $k \\ge 1$, the partial sums satisfy the recurrence relations $S_{4k} = 2S_k$ and $S_{4k+2} = S_{4k}$.","Using the definitions $x_{2m}=-x_m$ and $x_{2m-1}=(-1)^{m+1}x_m$, we examine sums of pairs of terms. \n1. $x_{4j-3}+x_{4j-2} = x_{2(2j-1)-1} + x_{2(2j-1)} = (-1)^{2j}x_{2j-1} + (-x_{2j-1}) = x_{2j-1}-x_{2j-1}=0$. \n2. $x_{4j-1}+x_{4j} = x_{2(2j)-1} + x_{2(2j)} = (-1)^{2j+1}x_{2j} + (-x_{2j}) = -x_{2j}-x_{2j}=-2x_{2j}=2x_j$. \nFrom these, we can evaluate $S_{4k}$: $S_{4k} = \\sum_{j=1}^k (x_{4j-3}+x_{4j-2}+x_{4j-1}+x_{4j}) = \\sum_{j=1}^k (0+2x_j) = 2S_k$. \nAlso, $x_{4k+1}+x_{4k+2} = x_{2(2k+1)-1} + x_{2(2k+1)} = (-1)^{2k+2}x_{2k+1} + (-x_{2k+1}) = x_{2k+1}-x_{2k+1}=0$. \nThus, $S_{4k+2} = S_{4k} + x_{4k+1}+x_{4k+2} = S_{4k}+0 = S_{4k}$.","A sequence $x_{1}, x_{2}, \\ldots$ is defined by $x_{1}=1$ and $x_{2 k}=-x_{k}, x_{2 k-1}=(-1)^{k+1} x_{k}$ for all $k \\geq 1$. Prove that $x_{1}+x_{2}+\cdots+x_{n} \\geq 0$ for all $n \\geq 1$.","We prove by induction on $k$ that $S_i \\ge 0$ for all $i \\le 4k$. \nBase case ($k=1$): $S_1=1, S_2=0, S_3=1, S_4=2$, which are all non-negative. \nInductive step: Assume $S_i \\ge 0$ for $i \\le 4k$. We must show $S_i \\ge 0$ for $4k < i \\le 4(k+1)$, using the relations $S_{4m}=2S_m$ and $S_{4m+2}=S_{4m}$. \n1. $S_{4k+4} = 2S_{k+1} \\ge 0$ by the induction hypothesis (IH), since $k+1 \\le 4k$ for $k \\ge 1$. \n2. $S_{4k+2} = S_{4k} \\ge 0$ by IH. \n3. Since $x_{4k+3}=x_{4k+4}$, it follows that $S_{4k+3} = (S_{4k+2}+S_{4k+4})/2 \\ge 0$. \n4. For $S_{4k+1}=S_{4k}+x_{4k+1}$: If $k$ is odd, $S_k$ is odd (as $S_n \\equiv n \\pmod 2$), so $S_k \\ge 1$ by IH. Thus $S_{4k}=2S_k \\ge 2$, and $S_{4k+1} \\ge 2-1=1$. If $k$ is even, $x_{4k+1}=x_{k+1}$, so $S_{4k+1}=2S_k+x_{k+1}=S_k+S_{k+1} \\ge 0$ by IH. \nThus, $S_i \\ge 0$ for all $i \\le 4(k+1)$, completing the induction.",,,,
2010a6,Suppose that $f$ and $g$ are two functions defined on the set of positive integers and taking positive integer values. Suppose also that the equations $f(g(n))=f(n)+1$ and $g(f(n))=$ $g(n)+1$ hold for all positive integers. Prove that $f(n)=g(n)$ for all positive integer $n$.,"Throughout the solution, by $\mathbb{N}$ we denote the set of all positive integers. For any function $h: \mathbb{N} \rightarrow \mathbb{N}$ and for any positive integer $k$, define $h^{k}(x)=\underbrace{h(h(\ldots h}_{k}(x) \ldots)$ ) (in particular, $\left.h^{0}(x)=x\right)$.

Observe that $f\left(g^{k}(x)\right)=f\left(g^{k-1}(x)\right)+1=\cdots=f(x)+k$ for any positive integer $k$, and similarly $g\left(f^{k}(x)\right)=g(x)+k$. Now let $a$ and $b$ are the minimal values attained by $f$ and $g$, respectively; say $f\left(n_{f}\right)=a, g\left(n_{g}\right)=b$. Then we have $f\left(g^{k}\left(n_{f}\right)\right)=a+k, g\left(f^{k}\left(n_{g}\right)\right)=b+k$, so the function $f$ attains all values from the set $N_{f}=\{a, a+1, \ldots\}$, while $g$ attains all the values from the set $N_{g}=\{b, b+1, \ldots\}$.

Next, note that $f(x)=f(y)$ implies $g(x)=g(f(x))-1=g(f(y))-1=g(y)$; surely, the converse implication also holds. Now, we say that $x$ and $y$ are similar (and write $x \sim y$ ) if $f(x)=f(y)$ (equivalently, $g(x)=g(y)$ ). For every $x \in \mathbb{N}$, we define $[x]=\{y \in \mathbb{N}: x \sim y\}$; surely, $y_{1} \sim y_{2}$ for all $y_{1}, y_{2} \in[x]$, so $[x]=[y]$ whenever $y \in[x]$.

Now we investigate the structure of the sets $[x]$.\\
Claim 1. Suppose that $f(x) \sim f(y)$; then $x \sim y$, that is, $f(x)=f(y)$. Consequently, each class $[x]$ contains at most one element from $N_{f}$, as well as at most one element from $N_{g}$.\\
Proof. If $f(x) \sim f(y)$, then we have $g(x)=g(f(x))-1=g(f(y))-1=g(y)$, so $x \sim y$. The second statement follows now from the sets of values of $f$ and $g$.

Next, we clarify which classes do not contain large elements.\\
Claim 2. For any $x \in \mathbb{N}$, we have $[x] \subseteq\{1,2, \ldots, b-1\}$ if and only if $f(x)=a$. Analogously, $[x] \subseteq\{1,2, \ldots, a-1\}$ if and only if $g(x)=b$.\\
Proof. We will prove that $[x] \nsubseteq\{1,2, \ldots, b-1\} \Longleftrightarrow f(x)>a$; the proof of the second statement is similar.

Note that $f(x)>a$ implies that there exists some $y$ satisfying $f(y)=f(x)-1$, so $f(g(y))=$ $f(y)+1=f(x)$, and hence $x \sim g(y) \geq b$. Conversely, if $b \leq c \sim x$ then $c=g(y)$ for some $y \in \mathbb{N}$, which in turn follows $f(x)=f(g(y))=f(y)+1 \geq a+1$, and hence $f(x)>a$.

Claim 2 implies that there exists exactly one class contained in $\{1, \ldots, a-1\}$ (that is, the class [ $n_{g}$ ]), as well as exactly one class contained in $\{1, \ldots, b-1\}$ (the class [ $n_{f}$ ]). Assume for a moment that $a \leq b$; then $\left[n_{g}\right]$ is contained in $\{1, \ldots, b-1\}$ as well, hence it coincides with $\left[n_{g}\right]$. So, we get that


\begin{equation*}
f(x)=a \Longleftrightarrow g(x)=b \Longleftrightarrow x \sim n_{f} \sim n_{g} . \tag{1}
\end{equation*}


Claim 3. $a=b$.\\
Proof. By Claim 2, we have $[a] \neq\left[n_{f}\right]$, so $[a]$ should contain some element $a^{\prime} \geq b$ by Claim 2 again. If $a \neq a^{\prime}$, then $[a]$ contains two elements $\geq a$ which is impossible by Claim 1. Therefore, $a=a^{\prime} \geq b$. Similarly, $b \geq a$.

Now we are ready to prove the problem statement. First, we establish the following\\
Claim 4. For every integer $d \geq 0, f^{d+1}\left(n_{f}\right)=g^{d+1}\left(n_{f}\right)=a+d$.\\
Proof. Induction on $d$. For $d=0$, the statement follows from (1) and Claim 3. Next, for $d>1$ from the induction hypothesis we have $f^{d+1}\left(n_{f}\right)=f\left(f^{d}\left(n_{f}\right)\right)=f\left(g^{d}\left(n_{f}\right)\right)=f\left(n_{f}\right)+d=a+d$. The equality $g^{d+1}\left(n_{f}\right)=a+d$ is analogous.

Finally, for each $x \in \mathbb{N}$, we have $f(x)=a+d$ for some $d \geq 0$, so $f(x)=f\left(g^{d}\left(n_{f}\right)\right)$ and hence $x \sim g^{d}\left(n_{f}\right)$. It follows that $g(x)=g\left(g^{d}\left(n_{f}\right)\right)=g^{d+1}\left(n_{f}\right)=a+d=f(x)$ by Claim 4.",4,"For any positive integers $x, y$, prove that $f(x)=f(y)$ if and only if $g(x)=g(y)$.","Assume $f(x)=f(y)$. Applying $g$ to both sides gives $g(f(x))=g(f(y))$. Using the given equation $g(f(n))=g(n)+1$, this becomes $g(x)+1=g(y)+1$, which implies $g(x)=g(y)$. Conversely, assume $g(x)=g(y)$. Applying $f$ to both sides gives $f(g(x))=f(g(y))$. Using the given equation $f(g(n))=f(n)+1$, this becomes $f(x)+1=f(y)+1$, which implies $f(x)=f(y)$. Thus, the equivalence holds.","Let $a = \min_{n\in\mathbb{N}} f(n)$. Prove that the range of $f$ is the set $N_f = \{a, a+1, a+2, \dots\}$, and that $f$ is injective when restricted to its range $N_f$.","Let $n_f$ be an integer such that $f(n_f)=a$. The equation $f(g(n))=f(n)+1$ implies by induction on $k$ that $f(g^k(n))=f(n)+k$ for any $k \ge 0$. Applying this to $n_f$, we get $f(g^k(n_f)) = f(n_f)+k = a+k$. This shows that the range of $f$ contains $\{a, a+1, a+2, \dots\}$. Since $a$ is the minimum value, the range is exactly this set. To prove injectivity on $N_f$, suppose $y_1, y_2 \in N_f$ and $f(y_1)=f(y_2)$. Since $y_1, y_2$ are in the range of $f$, there exist $x_1, x_2$ such that $y_1=f(x_1)$ and $y_2=f(x_2)$. The condition becomes $f(f(x_1)) = f(f(x_2))$. By sub-problem 1, this implies $g(f(x_1))=g(f(x_2))$, which simplifies to $g(x_1)+1=g(x_2)+1$, so $g(x_1)=g(x_2)$. Applying sub-problem 1 again, $f(x_1)=f(x_2)$, which means $y_1=y_2$. Thus $f$ is injective on its range.",Let $a = \min_{n\in\mathbb{N}} f(n)$ and $b = \min_{n\in\mathbb{N}} g(n)$. Prove that $a=b$.,"Assume for contradiction that $a \neq b$, and without loss of generality, let $a < b$. The relation $g(f(n))=g(n)+1$ implies $f(n)$ can never be a fixed point of $g$. Similarly $f(g(n))=f(n)+1$ implies $g(n)$ cannot be a fixed point of $f$. Also, $f(a) > a$, because if $f(a)=a$, then $g(a)=g(f(a))=g(a)+1$, which is impossible. Since $f(a)>a$ and the range of $f$ is $\{a, a+1, \dots\}$, there exists some $z$ with $f(z)=f(a)-1$. Then $f(g(z))=f(z)+1=f(a)$. Let $a' = g(z)$. Then $f(a')=f(a)$ and $a' \ge b$ since $a'$ is in the range of $g$. We now have two distinct numbers, $a$ and $a' \ge b > a$, which are both in the range of $f$ (as $a, a' \ge a$). This contradicts the result from Sub-problem 2 that $f$ is injective on its range. Thus, $a<b$ is false. By symmetry, $b<a$ is also false, so $a=b$.",Suppose that $f$ and $g$ are two functions defined on the set of positive integers and taking positive integer values. Suppose also that the equations $f(g(n))=f(n)+1$ and $g(f(n))=$ $g(n)+1$ hold for all positive integers. Prove that $f(n)=g(n)$ for all positive integer $n$.,"Let $a = \min f = \min g$ (from Sub-problem 3), and let $n_0$ be an integer such that $f(n_0)=a$. This implies $g(n_0)=a$. We first prove by induction on $d \ge 0$ that $f^{d+1}(n_0) = g^{d+1}(n_0) = a+d$. The base case $d=0$ is $f(n_0)=g(n_0)=a$, which is true. For the inductive step, assume $f^k(n_0) = g^k(n_0)$ for some $k \ge 1$. Then $f^{k+1}(n_0) = f(f^k(n_0)) = f(g^k(n_0))$ by the induction hypothesis. Using $f(g^k(n)) = f(n)+k$, this becomes $f(n_0)+k = a+k$. Similarly, $g^{k+1}(n_0) = g(g^k(n_0)) = g(f^k(n_0)) = g(n_0)+k = a+k$. This proves the inductive claim. Now, for any $n \in \mathbb{N}$, its value $f(n)$ is in the range $\{a, a+1, \dots\}$, so $f(n)=a+d$ for some integer $d \ge 0$. Consider $m = g^d(n_0)$. We have $f(m) = f(g^d(n_0)) = f(n_0)+d = a+d$. So, $f(n)=f(m)$. By Sub-problem 1, this implies $g(n)=g(m)=g(g^d(n_0))=g^{d+1}(n_0)$. From our inductive result, $g^{d+1}(n_0) = a+d$. Therefore, $g(n)=a+d=f(n)$. Since $n$ was arbitrary, $f(n)=g(n)$ for all $n$."
2010a7,"Let $a_{1}, \ldots, a_{r}$ be positive real numbers. For $n>r$, we inductively define


\begin{equation*}
a_{n}=\max _{1 \leq k \leq n-1}\left(a_{k}+a_{n-k}\right) \tag{1}
\end{equation*}","Prove that there exist positive integers $\ell \leq r$ and $N$ such that $a_{n}=a_{n-\ell}+a_{\ell}$ for all $n \geq N$.

First, from the problem conditions we have that each $a_{n}(n>r)$ can be expressed as $a_{n}=a_{j_{1}}+a_{j_{2}}$ with $j_{1}, j_{2}<n, j_{1}+j_{2}=n$. If, say, $j_{1}>r$ then we can proceed in the same way with $a_{j_{1}}$, and so on. Finally, we represent $a_{n}$ in a form


\begin{gather*}
a_{n}=a_{i_{1}}+\cdots+a_{i_{k}}  \tag{2}\\
1 \leq i_{j} \leq r, \quad i_{1}+\cdots+i_{k}=n \tag{3}
\end{gather*}


Moreover, if $a_{i_{1}}$ and $a_{i_{2}}$ are the numbers in (2) obtained on the last step, then $i_{1}+i_{2}>r$. Hence we can adjust (3) as


\begin{equation*}
1 \leq i_{j} \leq r, \quad i_{1}+\cdots+i_{k}=n, \quad i_{1}+i_{2}>r \tag{4}
\end{equation*}


On the other hand, suppose that the indices $i_{1}, \ldots, i_{k}$ satisfy the conditions (4). Then, denoting $s_{j}=i_{1}+\cdots+i_{j}$, from (1) we have

$$
a_{n}=a_{s_{k}} \geq a_{s_{k-1}}+a_{i_{k}} \geq a_{s_{k-2}}+a_{i_{k-1}}+a_{i_{k}} \geq \cdots \geq a_{i_{1}}+\cdots+a_{i_{k}}
$$

Summarizing these observations we get the following\\
Claim. For every $n>r$, we have

$$
a_{n}=\max \left\{a_{i_{1}}+\cdots+a_{i_{k}}: \text { the collection }\left(i_{1}, \ldots, i_{k}\right) \text { satisfies }(4)\right\}
$$

Now we denote

$$
s=\max _{1 \leq i \leq r} \frac{a_{i}}{i}
$$

and fix some index $\ell \leq r$ such that $s=\frac{a_{\ell}}{\ell}$.\\
Consider some $n \geq r^{2} \ell+2 r$ and choose an expansion of $a_{n}$ in the form (2), (4). Then we have $n=i_{1}+\cdots+i_{k} \leq r k$, so $k \geq n / r \geq r \ell+2$. Suppose that none of the numbers $i_{3}, \ldots, i_{k}$ equals $\ell$. Then by the pigeonhole principle there is an index $1 \leq j \leq r$ which appears among $i_{3}, \ldots, i_{k}$ at least $\ell$ times, and surely $j \neq \ell$. Let us delete these $\ell$ occurrences of $j$ from $\left(i_{1}, \ldots, i_{k}\right)$, and add $j$ occurrences of $\ell$ instead, obtaining a sequence $\left(i_{1}, i_{2}, i_{3}^{\prime}, \ldots, i_{k^{\prime}}^{\prime}\right)$ also satisfying (4). By Claim, we have

$$
a_{i_{1}}+\cdots+a_{i_{k}}=a_{n} \geq a_{i_{1}}+a_{i_{2}}+a_{i_{3}^{\prime}}+\cdots+a_{i_{k^{\prime}}^{\prime}}
$$

or, after removing the coinciding terms, $\ell a_{j} \geq j a_{\ell}$, so $\frac{a_{\ell}}{\ell} \leq \frac{a_{j}}{j}$. By the definition of $\ell$, this means that $\ell a_{j}=j a_{\ell}$, hence

$$
a_{n}=a_{i_{1}}+a_{i_{2}}+a_{i_{3}^{\prime}}+\cdots+a_{i_{k^{\prime}}^{\prime}} .
$$

Thus, for every $n \geq r^{2} \ell+2 r$ we have found a representation of the form (2), (4) with $i_{j}=\ell$ for some $j \geq 3$. Rearranging the indices we may assume that $i_{k}=\ell$.

Finally, observe that in this representation, the indices $\left(i_{1}, \ldots, i_{k-1}\right)$ satisfy the conditions (4) with $n$ replaced by $n-\ell$. Thus, from the Claim we get

$$
a_{n-\ell}+a_{\ell} \geq\left(a_{i_{1}}+\cdots+a_{i_{k-1}}\right)+a_{\ell}=a_{n}
$$

which by (1) implies

$$
a_{n}=a_{n-\ell}+a_{\ell} \quad \text { for each } n \geq r^{2} \ell+2 r
$$

as desired.",3,"Prove that for every $n>r$, $a_{n}$ can be expressed as the maximum of sums of the form $a_{i_{1}}+\cdots+a_{i_{k}}$ where the indices satisfy $1 \leq i_{j} \leq r$, $i_{1}+\cdots+i_{k}=n$, and the sum arises from a valid recursive decomposition of $a_n$. Specifically, show $a_{n}=\max \\left\\{a_{i_{1}}+\cdots+a_{i_{k}}: 1 \\leq i_{j} \\leq r, \\sum_{j=1}^k i_{j}=n, i_{1}+i_{2}>r \right\\}$.","By recursively applying the definition $a_m = \\max_k(a_k+a_{m-k})$ for any term $a_m$ with $m>r$, we can express any $a_n$ for $n>r$ as a sum $S = a_{i_{1}}+\cdots+a_{i_{k}}$ where $1 \\leq i_{j} \\leq r$. The final decomposition step, say $a_{i_1+i_2} = a_{i_1}+a_{i_2}$, implies $i_1+i_2 > r$. From the definition of $a_n$, we have $a_n = a_{\\sum i_j} \\geq a_{\\sum_{j=1}^{k-1} i_j} + a_{i_k} \\geq \\cdots \\geq \\sum_{j=1}^k a_{i_j}$. This shows that $a_n$ is an upper bound for all such sums. Since $a_n$ itself can be represented in this form, it must be the maximum of such sums.","Let $s = \\max_{1 \\leq i \\leq r} \frac{a_i}{i}$ and let $\\ell \\leq r$ be an index for which this maximum is achieved. Prove that for a sufficiently large integer $n$, any maximal representation $a_n = a_{i_1} + \\dots + a_{i_k}$ as described in sub-problem 1 can be chosen such that at least one index $i_j$ (with $j \\geq 3$) is equal to $\\ell$.","For $n \\geq r^2\\ell + 2r$, an optimal sum $a_n = a_{i_1} + \\dots + a_{i_k}$ has $k \\geq n/r \\geq r\\ell + 2$. Suppose none of $i_3, \\dots, i_k$ equals $\\ell$. Since there are $k-2 \\geq r\\ell$ such terms with values in $\{1, ..., r\}\\setminus\\{\\ell\\}$, by the pigeonhole principle, some index $j \neq \\ell$ must appear at least $\\ell$ times. Replace these $\\ell$ occurrences of $a_j$ with $j$ occurrences of $a_\\ell$. The sum of indices does not change. The change in the value of the sum is $j a_\\ell - \\ell a_j = j\\ell(\frac{a_\\ell}{\\ell} - \frac{a_j}{j}) \\geq 0$. Since the original sum was maximal, the new sum is also maximal. Thus, we can find a maximal representation for $a_n$ that includes $a_\\ell$ among the terms $a_{i_3}, \\dots, a_{i_k}$.","Let $a_{1}, \\ldots, a_{r}$ be positive real numbers. For $n>r$, define $a_{n}=\\max _{1 \\leq k \\leq n-1}\\left(a_{k}+a_{n-k}\right)$. Prove that there exist positive integers $\\ell \\leq r$ and $N$ such that $a_{n}=a_{n-\\ell}+a_{\\ell}$ for all $n \\geq N$.","Let $\\ell$ be an index maximizing $a_i/i$. From sub-problem 2, for $n \\geq N = r^2\\ell+2r$, there exists a maximal representation $a_n = a_{i_1} + \\cdots + a_{i_k}$ where one term, say $i_k$, is equal to $\\ell$. The sum of the remaining terms, $S' = a_{i_1} + \\cdots + a_{i_{k-1}}$, is a valid representation for $a_{n-\\ell}$ satisfying the conditions of sub-problem 1. Therefore, $a_{n-\\ell} \\geq S' = a_{i_1} + \\cdots + a_{i_{k-1}}$. This implies $a_{n-\\ell} + a_\\ell \\geq (a_{i_1} + \\cdots + a_{i_{k-1}}) + a_\\ell = a_n$. From the definition of $a_n$, we also know $a_n \\geq a_{n-\\ell} + a_\\ell$. Therefore, equality must hold: $a_n = a_{n-\\ell} + a_\\ell$ for all $n \\geq N$.",,
2010a8,"Given six positive numbers $a, b, c, d, e, f$ such that $a<b<c<d<e<f$. Let $a+c+e=S$ and $b+d+f=T$. Prove that


\begin{equation*}
2 S T>\sqrt{3(S+T)(S(b d+b f+d f)+T(a c+a e+c e))} \tag{1}
\end{equation*}","We define also $\sigma=a c+c e+a e, \tau=b d+b f+d f$. The idea of the solution is to interpret (1) as a natural inequality on the roots of an appropriate polynomial.

Actually, consider the polynomial


\begin{align*}
& P(x)=(b+d+f)(x-a)(x-c)(x-e)+(a+c+e)(x-b)(x-d)(x-f) \\
&=T\left(x^{3}-S x^{2}+\sigma x-a c e\right)+S\left(x^{3}-T x^{2}+\tau x-b d f\right) . \tag{2}
\end{align*}


Surely, $P$ is cubic with leading coefficient $S+T>0$. Moreover, we have

$$
\begin{array}{ll}
P(a)=S(a-b)(a-d)(a-f)<0, & P(c)=S(c-b)(c-d)(c-f)>0, \\
P(e)=S(e-b)(e-d)(e-f)<0, & P(f)=T(f-a)(f-c)(f-e)>0 .
\end{array}
$$

Hence, each of the intervals $(a, c),(c, e),(e, f)$ contains at least one root of $P(x)$. Since there are at most three roots at all, we obtain that there is exactly one root in each interval (denote them by $\alpha \in(a, c), \beta \in(c, e), \gamma \in(e, f))$. Moreover, the polynomial $P$ can be factorized as


\begin{equation*}
P(x)=(T+S)(x-\alpha)(x-\beta)(x-\gamma) \tag{3}
\end{equation*}


Equating the coefficients in the two representations (2) and (3) of $P(x)$ provides

$$
\alpha+\beta+\gamma=\frac{2 T S}{T+S}, \quad \alpha \beta+\alpha \gamma+\beta \gamma=\frac{S \tau+T \sigma}{T+S} .
$$

Now, since the numbers $\alpha, \beta, \gamma$ are distinct, we have

$$
0<(\alpha-\beta)^{2}+(\alpha-\gamma)^{2}+(\beta-\gamma)^{2}=2(\alpha+\beta+\gamma)^{2}-6(\alpha \beta+\alpha \gamma+\beta \gamma)
$$

which implies

$$
\frac{4 S^{2} T^{2}}{(T+S)^{2}}=(\alpha+\beta+\gamma)^{2}>3(\alpha \beta+\alpha \gamma+\beta \gamma)=\frac{3(S \tau+T \sigma)}{T+S}
$$

or

$$
4 S^{2} T^{2}>3(T+S)(T \sigma+S \tau)
$$

which is exactly what we need.\\",2,"Let $S=a+c+e$, $T=b+d+f$, $\sigma=ac+ae+ce$, and $\tau=bd+bf+df$. Consider the polynomial $P(x) = T(x-a)(x-c)(x-e) + S(x-b)(x-d)(x-f)$. Prove that $P(x)$ has three distinct real roots $\alpha, \beta, \gamma$, and show that their sum is $\alpha+\beta+\gamma=\frac{2ST}{S+T}$ and the sum of their products taken two at a time is $\alpha\beta+\alpha\gamma+\beta\gamma=\frac{S\tau+T\sigma}{S+T}$.","The polynomial can be written as $P(x) = (S+T)x^3 - 2STx^2 + (S\tau+T\sigma)x - (Tace+Sbdf)$. Given $a<b<c<d<e<f$, we evaluate $P(x)$ at $a,c,e,f$: $P(a)=S(a-b)(a-d)(a-f)<0$, $P(c)=S(c-b)(c-d)(c-f)>0$, $P(e)=S(e-b)(e-d)(e-f)<0$, and $P(f)=T(f-a)(f-c)(f-e)>0$. By the Intermediate Value Theorem, $P(x)$ has a root in each of the disjoint intervals $(a,c)$, $(c,e)$, and $(e,f)$. Thus, $P(x)$ has three distinct real roots, say $\alpha, \beta, \gamma$. By Vieta's formulas, comparing the coefficients of $P(x)$ with the form $(S+T)(x-\alpha)(x-\beta)(x-\gamma)$, we get $\alpha+\beta+\gamma = -\frac{-2ST}{S+T} = \frac{2ST}{S+T}$ and $\alpha\beta+\alpha\gamma+\beta\gamma = \frac{S\tau+T\sigma}{S+T}$.","Given six positive numbers $a, b, c, d, e, f$ such that $a<b<c<d<e<f$. Let $a+c+e=S$ and $b+d+f=T$. Prove that $2 S T>\sqrt{3(S+T)(S(b d+b f+d f)+T(a c+a e+c e))}$.","Let $\sigma = ac+ae+ce$ and $\tau = bd+bf+df$. From the previous sub-problem, we know there exist three distinct real numbers $\alpha, \beta, \gamma$ such that $\alpha+\beta+\gamma=\frac{2ST}{S+T}$ and $\alpha\beta+\alpha\gamma+\beta\gamma=\frac{S\tau+T\sigma}{S+T}$. For any three distinct real numbers, the inequality $(\alpha+\beta+\gamma)^2 > 3(\alpha\beta+\alpha\gamma+\beta\gamma)$ holds, as it is equivalent to $(\alpha-\beta)^2+(\beta-\gamma)^2+(\gamma-\alpha)^2 > 0$. Substituting the expressions for the sums of roots, we get $(\frac{2ST}{S+T})^2 > 3(\frac{S\tau+T\sigma}{S+T})$. This simplifies to $\frac{4S^2T^2}{(S+T)^2} > \frac{3(S\tau+T\sigma)}{S+T}$. Since $S+T > 0$, we multiply by $(S+T)^2$ to get $4S^2T^2 > 3(S+T)(S\tau+T\sigma)$. Taking the square root of both sides (since both are positive) yields the desired inequality.",,,,
2010c5,"$n \geq 4$ players participated in a tennis tournament. Any two players have played exactly one game, and there was no tie game. We call a company of four players bad if one player was defeated by the other three players, and each of these three players won a game and lost another game among themselves. Suppose that there is no bad company in this tournament. Let $w_{i}$ and $\ell_{i}$ be respectively the number of wins and losses of the $i$ th player. Prove that


\begin{equation*}
\sum_{i=1}^{n}\left(w_{i}-\ell_{i}\right)^{3} \geq 0 . \tag{1}
\end{equation*}","For any tournament $T$ satisfying the problem condition, denote by $S(T)$ sum under consideration, namely

$$
S(T)=\sum_{i=1}^{n}\left(w_{i}-\ell_{i}\right)^{3} .
$$

First, we show that the statement holds if a tournament $T$ has only 4 players. Actually, let $A=\left(a_{1}, a_{2}, a_{3}, a_{4}\right)$ be the number of wins of the players; we may assume that $a_{1} \geq a_{2} \geq a_{3} \geq a_{4}$. We have $a_{1}+a_{2}+a_{3}+a_{4}=\binom{4}{2}=6$, hence $a_{4} \leq 1$. If $a_{4}=0$, then we cannot have $a_{1}=a_{2}=a_{3}=2$, otherwise the company of all players is bad. Hence we should have $A=(3,2,1,0)$, and $S(T)=3^{3}+1^{3}+(-1)^{3}+(-3)^{3}=0$. On the other hand, if $a_{4}=1$, then only two possibilities, $A=(3,1,1,1)$ and $A=(2,2,1,1)$ can take place. In the former case we have $S(T)=3^{3}+3 \cdot(-2)^{3}>0$, while in the latter one $S(T)=1^{3}+1^{3}+(-1)^{3}+(-1)^{3}=0$, as desired.

Now we turn to the general problem. Consider a tournament $T$ with no bad companies and enumerate the players by the numbers from 1 to $n$. For every 4 players $i_{1}, i_{2}, i_{3}, i_{4}$ consider a ""sub-tournament"" $T_{i_{1} i_{2} i_{3} i_{4}}$ consisting of only these players and the games which they performed with each other. By the abovementioned, we have $S\left(T_{i_{1} i_{2} i_{3} i_{4}}\right) \geq 0$. Our aim is to prove that


\begin{equation*}
S(T)=\sum_{i_{1}, i_{2}, i_{3}, i_{4}} S\left(T_{i_{1} i_{2} i_{3} i_{4}}\right), \tag{2}
\end{equation*}


where the sum is taken over all 4 -tuples of distinct numbers from the set $\{1, \ldots, n\}$. This way the problem statement will be established.

We interpret the number $\left(w_{i}-\ell_{i}\right)^{3}$ as following. For $i \neq j$, let $\varepsilon_{i j}=1$ if the $i$ th player wins against the $j$ th one, and $\varepsilon_{i j}=-1$ otherwise. Then

$$
\left(w_{i}-\ell_{i}\right)^{3}=\left(\sum_{j \neq i} \varepsilon_{i j}\right)^{3}=\sum_{j_{1}, j_{2}, j_{3} \neq i} \varepsilon_{i j_{1}} \varepsilon_{i j_{2}} \varepsilon_{i j_{3}} .
$$

Hence,

$$
S(T)=\sum_{i \notin\left\{j_{1}, j_{2}, j_{3}\right\}} \varepsilon_{i j_{1}} \varepsilon_{i j_{2}} \varepsilon_{i j_{3}} .
$$

To simplify this expression, consider all the terms in this sum where two indices are equal. If, for instance, $j_{1}=j_{2}$, then the term contains $\varepsilon_{i j_{1}}^{2}=1$, so we can replace this term by $\varepsilon_{i j_{3}}$. Make such replacements for each such term; obviously, after this change each term of the form $\varepsilon_{i j_{3}}$ will appear $P(T)$ times, hence

$$
S(T)=\sum_{\left|\left\{i, j_{1}, j_{2}, j_{3}\right\}\right|=4} \varepsilon_{i j_{1}} \varepsilon_{i j_{2}} \varepsilon_{i j_{3}}+P(T) \sum_{i \neq j} \varepsilon_{i j}=S_{1}(T)+P(T) S_{2}(T) .
$$

We show that $S_{2}(T)=0$ and hence $S(T)=S_{1}(T)$ for each tournament. Actually, note that $\varepsilon_{i j}=-\varepsilon_{j i}$, and the whole sum can be split into such pairs. Since the sum in each pair is 0 , so is $S_{2}(T)$.

Thus the desired equality (2) rewrites as


\begin{equation*}
S_{1}(T)=\sum_{i_{1}, i_{2}, i_{3}, i_{4}} S_{1}\left(T_{i_{1} i_{2} i_{3} i_{4}}\right) \tag{3}
\end{equation*}


Now, if all the numbers $j_{1}, j_{2}, j_{3}$ are distinct, then the set $\left\{i, j_{1}, j_{2}, j_{3}\right\}$ is contained in exactly one 4 -tuple, hence the term $\varepsilon_{i j_{1} 1} \varepsilon_{i j_{2}} \varepsilon_{i j_{3}}$ appears in the right-hand part of (3) exactly once, as well as in the left-hand part. Clearly, there are no other terms in both parts, so the equality is established.",3,"For a tournament with $n=4$ players and no bad company, prove that $\sum_{i=1}^{4}(w_i - \ell_i)^3 \ge 0$.","Let the number of wins for the 4 players be $(w_1, w_2, w_3, w_4)$. The total number of games is $\binom{4}{2}=6$, so $\sum w_i = 6$. The number of losses for player $i$ is $\ell_i = 3-w_i$, which means $w_i - \ell_i = 2w_i - 3$. The condition of no bad company excludes the win sequence $(2,2,2,0)$. The possible sorted win sequences are $(3,2,1,0)$, $(3,1,1,1)$, and $(2,2,1,1)$.
For $(3,2,1,0)$, the sum is $(2\cdot3-3)^3 + (2\cdot2-3)^3 + (2\cdot1-3)^3 + (2\cdot0-3)^3 = 3^3+1^3+(-1)^3+(-3)^3 = 0$.
For $(3,1,1,1)$, the sum is $(2\cdot3-3)^3 + 3(2\cdot1-3)^3 = 3^3 + 3(-1)^3 = 24 > 0$.
For $(2,2,1,1)$, the sum is $2(2\cdot2-3)^3 + 2(2\cdot1-3)^3 = 2(1)^3 + 2(-1)^3 = 0$.
In all possible cases, the sum is non-negative.","For a tournament $T$ with $n$ players, let $S(T) = \sum_{i=1}^n(w_i-\ell_i)^3$. Let $T_{i_1i_2i_3i_4}$ be the sub-tournament on players $\{i_1, i_2, i_3, i_4\}$. Prove the identity $S(T) = \sum_{\{i_1,i_2,i_3,i_4\}} S(T_{i_1i_2i_3i_4})$, where the sum is over all 4-element subsets of players.","Let $\varepsilon_{ij}=1$ if player $i$ beats $j$, and $\varepsilon_{ij}=-1$ otherwise. Then $w_i-\ell_i = \sum_{j\neq i} \varepsilon_{ij}$. The sum is $S(T) = \sum_i (\sum_{j\neq i} \varepsilon_{ij})^3 = \sum_i \sum_{j_1,j_2,j_3 \neq i} \varepsilon_{ij_1}\varepsilon_{ij_2}\varepsilon_{ij_3}$. If any two indices in $\{j_1,j_2,j_3\}$ are equal (e.g., $j_1=j_2$), the term contains $\varepsilon_{ij_1}^2=1$ and simplifies. The sum of all such terms with repeated indices is a multiple of $\sum_{i\neq j} \varepsilon_{ij}$. This sum is zero, since $\varepsilon_{ij} = -\varepsilon_{ji}$. Therefore, only terms where $i, j_1, j_2, j_3$ are all distinct contribute to $S(T)$. So, $S(T) = \sum_{|\{i,j_1,j_2,j_3\}|=4} \varepsilon_{ij_1}\varepsilon_{ij_2}\varepsilon_{ij_3}$. For any 4-player sub-tournament $T_{abcd}$, $S(T_{abcd})$ is similarly composed of such products over the set $\{a,b,c,d\}$. Each term $\varepsilon_{ij_1}\varepsilon_{ij_2}\varepsilon_{ij_3}$ involves a unique set of 4 players and thus appears exactly once in the expansion of $S(T)$ and exactly once on the right-hand side in the term $S(T_{\{i,j_1,j_2,j_3\}})$. Hence, the identity holds.","$n \geq 4$ players participated in a tennis tournament. Any two players have played exactly one game, and there was no tie game. We call a company of four players bad if one player was defeated by the other three players, and each of these three players won a game and lost another game among themselves. Suppose that there is no bad company in this tournament. Let $w_{i}$ and $\ell_{i}$ be respectively the number of wins and losses of the $i$ th player. Prove that $\sum_{i=1}^{n}\left(w_{i}-\ell_{i}\right)^{3} \geq 0$.","From the second sub-problem, we established the identity $\sum_{i=1}^{n}(w_i - \ell_i)^3 = \sum_{\{i_1,i_2,i_3,i_4\}} \sum_{j \in \{i_1,i_2,i_3,i_4\}} (w'_j - \ell'_j)^3$, where $w'_j$ and $\ell'_j$ are wins and losses within the sub-tournament on players $\{i_1,i_2,i_3,i_4\}$. The condition of no bad company for the tournament implies that no 4-player sub-tournament can form a bad company. From the first sub-problem, we know that for any 4-player tournament with no bad company, the sum $\sum_{j=1}^4 (w_j - \ell_j)^3 \ge 0$. Since the total sum is a sum of non-negative terms (one for each 4-player sub-tournament), the total sum must also be non-negative. Therefore, $\sum_{i=1}^{n}\left(w_{i}-\ell_{i}\right)^{3} \geq 0$.",,
2010c6,"Given a positive integer $k$ and other two integers $b>w>1$. There are two strings of pearls, a string of $b$ black pearls and a string of $w$ white pearls. The length of a string is the number of pearls on it.

One cuts these strings in some steps by the following rules. In each step:\\
(i) The strings are ordered by their lengths in a non-increasing order. If there are some strings of equal lengths, then the white ones precede the black ones. Then $k$ first ones (if they consist of more than one pearl) are chosen; if there are less than $k$ strings longer than 1 , then one chooses all of them.\\
(ii) Next, one cuts each chosen string into two parts differing in length by at most one.\\
(For instance, if there are strings of $5,4,4,2$ black pearls, strings of $8,4,3$ white pearls and $k=4$, then the strings of 8 white, 5 black, 4 white and 4 black pearls are cut into the parts $(4,4),(3,2),(2,2)$ and $(2,2)$, respectively.)

The process stops immediately after the step when a first isolated white pearl appears. Prove that at this stage, there will still exist a string of at least two black pearls.","Denote the situation after the $i$ th step by $A_{i}$; hence $A_{0}$ is the initial situation, and $A_{i-1} \rightarrow A_{i}$ is the $i$ th step. We call a string containing $m$ pearls an $m$-string; it is an $m$-w-string or a $m$ - $b$-string if it is white or black, respectively.

We continue the process until every string consists of a single pearl. We will focus on three moments of the process: (a) the first stage $A_{s}$ when the first 1-string (no matter black or white) appears; (b) the first stage $A_{t}$ where the total number of strings is greater than $k$ (if such moment does not appear then we put $t=\infty$ ); and (c) the first stage $A_{f}$ when all black pearls are isolated. It is sufficient to prove that in $A_{f-1}$ (or earlier), a 1-w-string appears.

We start with some easy properties of the situations under consideration. Obviously, we have $s \leq f$. Moreover, all b-strings from $A_{f-1}$ become single pearls in the $f$ th step, hence all of them are 1 - or 2 -b-strings.

Next, observe that in each step $A_{i} \rightarrow A_{i+1}$ with $i \leq t-1$, all $(>1)$-strings were cut since there are not more than $k$ strings at all; if, in addition, $i<s$, then there were no 1-string, so all the strings were cut in this step.

Now, let $B_{i}$ and $b_{i}$ be the lengths of the longest and the shortest b-strings in $A_{i}$, and let $W_{i}$ and $w_{i}$ be the same for w -strings. We show by induction on $i \leq \min \{s, t\}$ that (i) the situation $A_{i}$ contains exactly $2^{i}$ black and $2^{i}$ white strings, (ii) $B_{i} \geq W_{i}$, and (iii) $b_{i} \geq w_{i}$. The base case $i=0$ is obvious. For the induction step, if $i \leq \min \{s, t\}$ then in the $i$ th step, each string is cut, thus the claim (i) follows from the induction hypothesis; next, we have $B_{i}=\left\lceil B_{i-1} / 2\right\rceil \geq\left\lceil W_{i-1} / 2\right\rceil=W_{i}$ and $b_{i}=\left\lfloor b_{i-1} / 2\right\rfloor \geq\left\lfloor w_{i-1} / 2\right\rfloor=w_{i}$, thus establishing (ii) and (iii).

For the numbers $s, t, f$, two cases are possible.\\
Case 1. Suppose that $s \leq t$ or $f \leq t+1$ (and hence $s \leq t+1$ ); in particular, this is true when $t=\infty$. Then in $A_{s-1}$ we have $B_{s-1} \geq W_{s-1}, b_{s-1} \geq w_{s-1}>1$ as $s-1 \leq \min \{s, t\}$. Now, if $s=f$, then in $A_{s-1}$, there is no 1 -w-string as well as no ( $>2$ )-b-string. That is, $2=B_{s-1} \geq W_{s-1} \geq b_{s-1} \geq w_{s-1}>1$, hence all these numbers equal 2 . This means that in $A_{s-1}$, all strings contain 2 pearls, and there are $2^{s-1}$ black and $2^{s-1}$ white strings, which means $b=2 \cdot 2^{s-1}=w$. This contradicts the problem conditions.

Hence we have $s \leq f-1$ and thus $s \leq t$. Therefore, in the $s$ th step each string is cut into two parts. Now, if a 1-b-string appears in this step, then from $w_{s-1} \leq b_{s-1}$ we see that a

1-w-string appears as well; so, in each case in the $s$ th step a 1 -w-string appears, while not all black pearls become single, as desired.

Case 2. Now assume that $t+1 \leq s$ and $t+2 \leq f$. Then in $A_{t}$ we have exactly $2^{t}$ white and $2^{t}$ black strings, all being larger than 1 , and $2^{t+1}>k \geq 2^{t}$ (the latter holds since $2^{t}$ is the total number of strings in $A_{t-1}$ ). Now, in the $(t+1)$ st step, exactly $k$ strings are cut, not more than $2^{t}$ of them being black; so the number of w-strings in $A_{t+1}$ is at least $2^{t}+\left(k-2^{t}\right)=k$. Since the number of w-strings does not decrease in our process, in $A_{f-1}$ we have at least $k$ white strings as well.

Finally, in $A_{f-1}$, all b-strings are not larger than 2, and at least one 2-b-string is cut in the $f$ th step. Therefore, at most $k-1$ white strings are cut in this step, hence there exists a w-string $\mathcal{W}$ which is not cut in the $f$ th step. On the other hand, since a 2 -b-string is cut, all $(\geq 2)$-w-strings should also be cut in the $f$ th step; hence $\mathcal{W}$ should be a single pearl. This is exactly what we needed.\\",4,"Let $s$ be the first step index where a 1-pearl string appears, and $t$ be the first step index where the total number of strings exceeds $k$. For any step $i < \min(s, t)$, prove that after step $i$, there are $2^i$ black and $2^i$ white strings, and the lengths of the longest and shortest black strings are greater than or equal to the lengths of the longest and shortest white strings, respectively ($B_i \ge W_i$ and $b_i \ge w_i$).","We use induction on $i$. The base case $i=0$ holds as we start with one string of each color, and $B_0=b>w=W_0$ and $b_0=b>w=w_0$. For the inductive step, assume the properties hold for $i-1 < \min(s, t)$. Since $i-1 < t$, the total number of strings is $\le k$. Since $i-1 < s$, all strings have length $>1$. Thus, all $2 \cdot 2^{i-1} \le k$ strings are cut in step $i$. This doubles the number of strings of each color to $2^i$. From the induction hypotheses $B_{i-1} \ge W_{i-1}$ and $b_{i-1} \ge w_{i-1}$, and the fact that $x \ge y \implies \lceil x/2 \rceil \ge \lceil y/2 \rceil$ and $\lfloor x/2 \rfloor \ge \lfloor y/2 \rfloor$, we get $B_i = \lceil B_{i-1}/2 \rceil \ge \lceil W_{i-1}/2 \rceil = W_i$ and $b_i = \lfloor b_{i-1}/2 \rfloor \ge \lfloor w_{i-1}/2 \rfloor = w_i$.","Let $s$ be the first step where a 1-pearl string appears and $t$ be the first step where the total number of strings exceeds $k$. Prove that if $s \le t$, the process stops at step $s$ with at least one black string of length $\ge 2$.","If $s \le t$, then at step $s-1$ the total number of strings is $\le k$, so all strings are cut at step $s$. By Sub-problem 1, the shortest strings at step $s-1$ satisfy $b_{s-1} \ge w_{s-1} > 1$. Since a 1-pearl string appears at step $s$, some string of length 2 or 3 must have been cut. The shortest string at $s-1$ has length $w_{s-1}$, so $w_{s-1}$ must be 2 or 3. Cutting this string produces a 1-w-string since $\lfloor w_{s-1}/2 \rfloor = 1$. Thus, the process stops at step $s$. If all black pearls became single at this step, all b-strings at step $s-1$ must have been of length 2. The condition $b_{s-1} \ge w_{s-1} > 1$ would then imply all w-strings were also of length 2. This means the initial total lengths were equal, $b=w$, a contradiction. Therefore, a b-string of length $\ge 2$ must remain.","Let $t$ be the first step index after which the total number of strings is greater than $k$ (i.e., state $A_t$). If $t$ is finite, prove that in state $A_{t+1}$ and all subsequent states, the number of white strings is at least $k$.","At step $t$, the state $A_{t-1}$ has $2^t \le k$ strings, which are all cut, so state $A_t$ has $2^t$ white and $2^t$ black strings, totaling $2^{t+1} > k$. In the next step ($t+1$), exactly $k$ strings from $A_t$ are cut. Let $n_w$ and $n_b$ be the number of white and black strings cut, with $n_w+n_b=k$. Since there are $2^t$ black strings in $A_t$, $n_b \le 2^t$. This implies $n_w = k - n_b \ge k-2^t$. The number of white strings in $A_{t+1}$ is $(2^t - n_w) + 2n_w = 2^t + n_w \ge 2^t + (k-2^t) = k$. Since cutting strings only increases their count, the number of white strings remains at least $k$ thereafter.","Prove that at the stage when a first isolated white pearl appears, there will still exist a string of at least two black pearls.","Let the process stop at step $S$. We need to show that at state $A_S$, not all black pearls are isolated. We consider two cases based on $s$ (first 1-pearl) and $t$ (first time strings > k). 
Case 1: $s \le t$. By Sub-problem 2, the process stops at step $s$ ($S=s$), and at this stage, a black string of length $\ge 2$ exists. The claim holds. 
Case 2: $s > t$. Let $f$ be the step when all black pearls become single. We show a 1-w-string must exist at or before step $f-1$. In state $A_{f-1}$, all b-strings have length 1 or 2, and at least one 2-b-string is cut in step $f$. By Sub-problem 3, since $f-1 \ge t+1 > t$, there are at least $k$ white strings. In step $f$, at least one b-string is cut, so at most $k-1$ white strings are cut. Thus, at least one white string, $\mathcal{W}$, is not cut. Because a 2-b-string is cut, the ordering rule implies any w-string of length $\ge 2$ must also be cut. Therefore, the uncut string $\mathcal{W}$ must have length 1. So a 1-w-string exists in $A_{f-1}$, meaning the process stops at or before this stage, where by definition, not all black pearls are single."
2010c7,"Let $P_{1}, \ldots, P_{s}$ be arithmetic progressions of integers, the following conditions being satisfied:\\
(i) each integer belongs to at least one of them;\\
(ii) each progression contains a number which does not belong to other progressions.

Denote by $n$ the least common multiple of steps of these progressions; let $n=p_{1}^{\alpha_{1}} \ldots p_{k}^{\alpha_{k}}$ be its prime factorization. Prove that

$$
s \geq 1+\sum_{i=1}^{k} \alpha_{i}\left(p_{i}-1\right) .
$$","First, we prove the key lemma, and then we show how to apply it to finish the solution.

Let $n_{1}, \ldots, n_{k}$ be positive integers. By an $n_{1} \times n_{2} \times \cdots \times n_{k}$ grid we mean the set $N=$ $\left\{\left(a_{1}, \ldots, a_{k}\right): a_{i} \in \mathbb{Z}, 0 \leq a_{i} \leq n_{i}-1\right\}$; the elements of $N$ will be referred to as points. In this grid, we define a subgrid as a subset of the form


\begin{equation*}
L=\left\{\left(b_{1}, \ldots, b_{k}\right) \in N: b_{i_{1}}=x_{i_{1}}, \ldots, b_{i_{t}}=x_{i_{t}}\right\}, \tag{1}
\end{equation*}


where $I=\left\{i_{1}, \ldots, i_{t}\right\}$ is an arbitrary nonempty set of indices, and $x_{i_{j}} \in\left[0, n_{i_{j}}-1\right](1 \leq j \leq t)$ are fixed integer numbers. Further, we say that a subgrid (1) is orthogonal to the $i$ th coordinate axis if $i \in I$, and that it is parallel to the $i$ th coordinate axis otherwise.\\
Lemma. Assume that the grid $N$ is covered by subgrids $L_{1}, L_{2}, \ldots, L_{s}$ (this means $N=\bigcup_{i=1}^{s} L_{i}$ ) so that\\
(ii') each subgrid contains a point which is not covered by other subgrids;\\
(iii) for each coordinate axis, there exists a subgrid $L_{i}$ orthogonal to this axis.

Then

$$
s \geq 1+\sum_{i=1}^{k}\left(n_{i}-1\right) .
$$

Proof. Assume to the contrary that $s \leq \sum_{i}\left(n_{i}-1\right)=s^{\prime}$. Our aim is to find a point that is not covered by $L_{1}, \ldots, L_{s}$.

The idea of the proof is the following. Imagine that we expand each subgrid to some maximal subgrid so that for the $i$ th axis, there will be at most $n_{i}-1$ maximal subgrids orthogonal to this axis. Then the desired point can be found easily: its $i$ th coordinate should be that not covered by the maximal subgrids orthogonal to the $i$ th axis. Surely, the conditions for existence of such expansion are provided by Hall's lemma on matchings. So, we will follow this direction, although we will apply Hall's lemma to some subgraph instead of the whole graph.

Construct a bipartite graph $G=\left(V \cup V^{\prime}, E\right)$ as follows. Let $V=\left\{L_{1}, \ldots, L_{s}\right\}$, and let $V^{\prime}=\left\{v_{i j}: 1 \leq i \leq s, 1 \leq j \leq n_{i}-1\right\}$ be some set of $s^{\prime}$ elements. Further, let the edge ( $L_{m}, v_{i j}$ ) appear iff $L_{m}$ is orthogonal to the $i$ th axis.

For each subset $W \subset V$, denote

$$
f(W)=\left\{v \in V^{\prime}:(L, v) \in E \text { for some } L \in W\right\} .
$$

Notice that $f(V)=V^{\prime}$ by (iii).\\
Now, consider the set $W \subset V$ containing the maximal number of elements such that $|W|>$ $|f(W)|$; if there is no such set then we set $W=\varnothing$. Denote $W^{\prime}=f(W), U=V \backslash W, U^{\prime}=V^{\prime} \backslash W^{\prime}$.

By our assumption and the Lemma condition, $|f(V)|=\left|V^{\prime}\right| \geq|V|$, hence $W \neq V$ and $U \neq \varnothing$. Permuting the coordinates, we can assume that $U^{\prime}=\left\{v_{i j}: 1 \leq i \leq \ell\right\}, W^{\prime}=\left\{v_{i j}: \ell+1 \leq i \leq k\right\}$.

Consider the induced subgraph $G^{\prime}$ of $G$ on the vertices $U \cup U^{\prime}$. We claim that for every $X \subset U$, we get $\left|f(X) \cap U^{\prime}\right| \geq|X|$ (so $G^{\prime}$ satisfies the conditions of Hall's lemma). Actually, we have $|W| \geq|f(W)|$, so if $|X|>\left|f(X) \cap U^{\prime}\right|$ for some $X \subset U$, then we have

$$
|W \cup X|=|W|+|X|>|f(W)|+\left|f(X) \cap U^{\prime}\right|=\left|f(W) \cup\left(f(X) \cap U^{\prime}\right)\right|=|f(W \cup X)|
$$

This contradicts the maximality of $|W|$.\\
Thus, applying Hall's lemma, we can assign to each $L \in U$ some vertex $v_{i j} \in U^{\prime}$ so that to distinct elements of $U$, distinct vertices of $U^{\prime}$ are assigned. In this situation, we say that $L \in U$ corresponds to the $i$ th axis, and write $g(L)=i$. Since there are $n_{i}-1$ vertices of the form $v_{i j}$, we get that for each $1 \leq i \leq \ell$, not more than $n_{i}-1$ subgrids correspond to the $i$ th axis.

Finally, we are ready to present the desired point. Since $W \neq V$, there exists a point $b=\left(b_{1}, b_{2}, \ldots, b_{k}\right) \in N \backslash\left(\cup_{L \in W} L\right)$. On the other hand, for every $1 \leq i \leq \ell$, consider any subgrid $L \in U$ with $g(L)=i$. This means exactly that $L$ is orthogonal to the $i$ th axis, and hence all its elements have the same $i$ th coordinate $c_{L}$. Since there are at most $n_{i}-1$ such subgrids, there exists a number $0 \leq a_{i} \leq n_{i}-1$ which is not contained in a set $\left\{c_{L}: g(L)=i\right\}$. Choose such number for every $1 \leq i \leq \ell$. Now we claim that point $a=\left(a_{1}, \ldots, a_{\ell}, b_{\ell+1}, \ldots, b_{k}\right)$ is not covered, hence contradicting the Lemma condition.

Surely, point $a$ cannot lie in some $L \in U$, since all the points in $L$ have $g(L)$ th coordinate $c_{L} \neq a_{g(L)}$. On the other hand, suppose that $a \in L$ for some $L \in W$; recall that $b \notin L$. But the points $a$ and $b$ differ only at first $\ell$ coordinates, so $L$ should be orthogonal to at least one of the first $\ell$ axes, and hence our graph contains some edge $\left(L, v_{i j}\right)$ for $i \leq \ell$. It contradicts the definition of $W^{\prime}$. The Lemma is proved.

Now we turn to the problem. Let $d_{j}$ be the step of the progression $P_{j}$. Note that since $n=$ l.c.m. $\left(d_{1}, \ldots, d_{s}\right)$, for each $1 \leq i \leq k$ there exists an index $j(i)$ such that $p_{i}^{\alpha_{i}} \mid d_{j(i)}$. We assume that $n>1$; otherwise the problem statement is trivial.

For each $0 \leq m \leq n-1$ and $1 \leq i \leq k$, let $m_{i}$ be the residue of $m$ modulo $p_{i}^{\alpha_{i}}$, and let $m_{i}=\overline{r_{i \alpha_{i}} \ldots r_{i 1}}$ be the base $p_{i}$ representation of $m_{i}$ (possibly, with some leading zeroes). Now, we put into correspondence to $m$ the sequence $r(m)=\left(r_{11}, \ldots, r_{1 \alpha_{1}}, r_{21}, \ldots, r_{k \alpha_{k}}\right)$. Hence $r(m)$ lies in a $\underbrace{p_{1} \times \cdots \times p_{1}}_{\alpha_{1} \text { times }} \times \cdots \times \underbrace{p_{k} \times \cdots \times p_{k}}_{\alpha_{k} \text { times }}$ grid $N$.

Surely, if $r(m)=r\left(m^{\prime}\right)$ then $p_{i}^{\alpha_{i}} \mid m_{i}-m_{i}^{\prime}$, which follows $p_{i}^{\alpha_{i}} \mid m-m^{\prime}$ for all $1 \leq i \leq k$; consequently, $n \mid m-m^{\prime}$. So, when $m$ runs over the set $\{0, \ldots, n-1\}$, the sequences $r(m)$ do not repeat; since $|N|=n$, this means that $r$ is a bijection between $\{0, \ldots, n-1\}$ and $N$. Now we will show that for each $1 \leq i \leq s$, the set $L_{i}=\left\{r(m): m \in P_{i}\right\}$ is a subgrid, and that for each axis there exists a subgrid orthogonal to this axis. Obviously, these subgrids cover $N$, and the condition (ii') follows directly from (ii). Hence the Lemma provides exactly the estimate we need.

Consider some $1 \leq j \leq s$ and let $d_{j}=p_{1}^{\gamma_{1}} \ldots p_{k}^{\gamma_{k}}$. Consider some $q \in P_{j}$ and let $r(q)=$ $\left(r_{11}, \ldots, r_{k \alpha_{k}}\right)$. Then for an arbitrary $q^{\prime}$, setting $r\left(q^{\prime}\right)=\left(r_{11}^{\prime}, \ldots, r_{k \alpha_{k}}^{\prime}\right)$ we have

$$
q^{\prime} \in P_{j} \quad \Longleftrightarrow \quad p_{i}^{\gamma_{i}} \mid q-q^{\prime} \text { for each } 1 \leq i \leq k \quad \Longleftrightarrow \quad r_{i, t}=r_{i, t}^{\prime} \text { for all } t \leq \gamma_{i}
$$

Hence $L_{j}=\left\{\left(r_{11}^{\prime}, \ldots, r_{k \alpha_{k}}^{\prime}\right) \in N: r_{i, t}=r_{i, t}^{\prime}\right.$ for all $\left.t \leq \gamma_{i}\right\}$ which means that $L_{j}$ is a subgrid containing $r(q)$. Moreover, in $L_{j(i)}$, all the coordinates corresponding to $p_{i}$ are fixed, so it is orthogonal to all of their axes, as desired.",4,"Establish a bijection between the set of integers modulo $n$, $\mathbb{Z}_n = \{0, \dots, n-1\}$, and the points of a grid $N = \prod_{i=1}^k (\{0, \dots, p_i-1\})^{\alpha_i}$. The total number of coordinate axes is $K = \sum_{i=1}^k \alpha_i$.","For any integer $m \in \mathbb{Z}_n$, consider its residue $m_i = m \pmod{p_i^{\alpha_i}}$ for each $i=1,\dots,k$. Each $m_i$ has a unique base-$p_i$ representation $m_i = \sum_{j=1}^{\alpha_i} r_{ij}p_i^{j-1}$, where $0 \le r_{ij} < p_i$. Define the map $r: \mathbb{Z}_n \to N$ by $r(m) = (r_{11}, \dots, r_{1\alpha_1}, \dots, r_{k\alpha_k})$. This map is a bijection. If $r(m)=r(m')$, then $m \equiv m' \pmod{p_i^{\alpha_i}}$ for all $i$. Since the moduli $p_i^{\alpha_i}$ are pairwise coprime, by the Chinese Remainder Theorem, $m \equiv m' \pmod n$. For $m, m' \in \mathbb{Z}_n$, this implies $m=m'$. As $|\mathbb{Z}_n| = |N| = n$, the map is a bijection.","Show that under the bijection $r$, each arithmetic progression $P_j$ (restricted to $\mathbb{Z}_n$) maps to a subgrid $L_j \subset N$. Further, show that for each of the $K=\sum \alpha_i$ coordinate axes, there is at least one subgrid $L_j$ that is orthogonal to it.","An integer $m$ is in $P_j$ (with first term $a_j$ and step $d_j = \prod p_i^{\gamma_{ij}}$) if and only if $m \equiv a_j \pmod{d_j}$. This is equivalent to $m \equiv a_j \pmod{p_i^{\gamma_{ij}}}$ for all $i$. This condition fixes the first $\gamma_{ij}$ base-$p_i$ digits of $m \pmod{p_i^{\alpha_i}}$. Thus, the set $L_j = r(P_j \cap \mathbb{Z}_n)$ is a subgrid. For the second part, since $n = \text{lcm}(d_1, \ldots, d_s)$, for each $i \in \{1, \ldots, k\}$, there exists a $j$ such that $p_i^{\alpha_i}$ divides $d_j$. For this $j$, all $\alpha_i$ coordinates corresponding to the prime $p_i$ are fixed in the subgrid $L_j$. Therefore, $L_j$ is orthogonal to all axes associated with $p_i$, and this holds for all $i=1, \dots, k$.","Let a grid $N$ of size $n_1 \times \cdots \times n_K$ be covered by $s$ subgrids $L_1, \ldots, L_s$ such that: (i) each subgrid has a point not in any other, and (ii) for each coordinate axis, there is a subgrid orthogonal to it. Prove that $s \ge 1 + \sum_{i=1}^K (n_i - 1)$.","Assume for contradiction that $s \le \sum_{i=1}^K(n_i-1)$. Construct a bipartite graph $G$ between subgrids $V=\{L_j\}$ and 'axis-slots' $V'=\{v_{ij} : 1\le i\le K, 1\le j\le n_i-1\}$, with an edge $(L_m, v_{ij})$ if $L_m$ is orthogonal to axis $i$. Let $W \subseteq V$ be a maximal set with $|W| > |f(W)|$, where $f(W)$ is the neighborhood of $W$. The subgraph on $U=V\setminus W$ and $U'=V'\setminus f(W)$ satisfies Hall's condition $|f(X)\cap U'| \ge |X|$ for all $X \subseteq U$, by the maximality of $W$. By Hall's theorem, there is a matching from $U$ into $U'$. This allows us to construct a point $a$ not covered by any $L_j$. Let $b$ be a point not in $\cup_{L \in W} L$. For each axis $i$ corresponding to a vertex in $U'$, choose a coordinate $a_i$ not fixed by any matched subgrid in $U$. For other axes, use the coordinates of $b$. The resulting point $a$ is not in any subgrid in $U$ or $W$, contradicting the covering assumption.","Let $P_{1}, \ldots, P_{s}$ be arithmetic progressions of integers, satisfying: (i) each integer belongs to at least one of them; (ii) each progression contains a number which does not belong to other progressions. Denote by $n$ the least common multiple of steps of these progressions, with prime factorization $n=p_{1}^{\alpha_{1}} \ldots p_{k}^{\alpha_{k}}$. Prove that $s \geq 1+\sum_{i=1}^{k} \alpha_{i}(p_{i}-1)$.","From Sub-problem 1, $\mathbb{Z}_n$ is in bijection with a grid $N$ with $\sum \alpha_i$ axes, where for each $i$, there are $\alpha_i$ axes of size $p_i$. Condition (i) implies the corresponding sets $L_j$ cover $N$. From Sub-problem 2, these $L_j$ are subgrids, and for each axis, some $L_j$ is orthogonal to it. Condition (ii) implies each $L_j$ has a unique point. The conditions of the lemma in Sub-problem 3 are met for the grid $N$ and subgrids $L_j$. The sum in the lemma's conclusion is $\sum_{\text{axes}} (\text{size}-1) = \sum_{i=1}^k \alpha_i(p_i-1)$. Applying the lemma's result, we get $s \ge 1 + \sum_{i=1}^k \alpha_i(p_i-1)$."
2010g1,"G1. Let $A B C$ be an acute triangle with $D, E, F$ the feet of the altitudes lying on $B C, C A, A B$ respectively. One of the intersection points of the line $E F$ and the circumcircle is $P$. The lines $B P$ and $D F$ meet at point $Q$. Prove that $A P=A Q$.","The line $E F$ intersects the circumcircle at two points. Depending on the choice of $P$, there are two different cases to consider.

Case 1: The point $P$ lies on the ray $E F$ (see Fig. 1).\\
Let $\angle C A B=\alpha, \angle A B C=\beta$ and $\angle B C A=\gamma$. The quadrilaterals $B C E F$ and $C A F D$ are cyclic due to the right angles at $D, E$ and $F$. So,

$$
\begin{aligned}
& \angle B D F=180^{\circ}-\angle F D C=\angle C A F=\alpha, \\
& \angle A F E=180^{\circ}-\angle E F B=\angle B C E=\gamma, \\
& \angle D F B=180^{\circ}-\angle A F D=\angle D C A=\gamma .
\end{aligned}
$$

Since $P$ lies on the arc $A B$ of the circumcircle, $\angle P B A<\angle B C A=\gamma$. Hence, we have

$$
\angle P B D+\angle B D F=\angle P B A+\angle A B D+\angle B D F<\gamma+\beta+\alpha=180^{\circ},
$$

and the point $Q$ must lie on the extensions of $B P$ and $D F$ beyond the points $P$ and $F$, respectively.

From the cyclic quadrilateral $A P B C$ we get

$$
\angle Q P A=180^{\circ}-\angle A P B=\angle B C A=\gamma=\angle D F B=\angle Q F A .
$$

Hence, the quadrilateral $A Q P F$ is cyclic. Then $\angle A Q P=180^{\circ}-\angle P F A=\angle A F E=\gamma$.\\
We obtained that $\angle A Q P=\angle Q P A=\gamma$, so the triangle $A Q P$ is isosceles, $A P=A Q$.\\

Case 2: The point $P$ lies on the ray $F E$ (see Fig. 2). In this case the point $Q$ lies inside the segment $F D$.

Similarly to the first case, we have

$$
\angle Q P A=\angle B C A=\gamma=\angle D F B=180^{\circ}-\angle A F Q
$$

Hence, the quadrilateral $A F Q P$ is cyclic.\\
Then $\angle A Q P=\angle A F P=\angle A F E=\gamma=\angle Q P A$. The triangle $A Q P$ is isosceles again, $\angle A Q P=\angle Q P A$ and thus $A P=A Q$.\\",3,"Let $ABC$ be an acute triangle with altitudes $AD, BE, CF$. Let $\gamma = \angle BCA$. Prove that $\angle AFE = \gamma$ and $\angle DFB = \gamma$.","In quadrilateral $BCEF$, angles $\angle BEC$ and $\angle BFC$ are both $90^\circ$. Thus, $B, C, E, F$ are concyclic, lying on the circle with diameter $BC$. In a cyclic quadrilateral, the exterior angle equals the interior opposite angle, so $\angle AFE = \angle BCE = \gamma$. Similarly, in quadrilateral $AFDC$, angles $\angle AFC$ and $\angle ADC$ are both $90^\circ$. Thus, $A, F, D, C$ are concyclic, lying on the circle with diameter $AC$. The sum of opposite angles is $180^\circ$, so $\angle DFB = 180^\circ - \angle AFD = \angle ACD = \gamma$.","Using the setup from the original problem, prove that the quadrilateral $AQPF$ is cyclic.","Let $\gamma = \angle BCA$. To prove $AQPF$ is cyclic, we show that points $P$ and $F$ subtend equal angles at segment $AQ$. Since $P$ is on the circumcircle of $\triangle ABC$, the quadrilateral $APBC$ is cyclic, which implies $\angle APB = 180^\circ - \gamma$. The point $Q$ is on line $BP$, so $\angle APQ = 180^\circ - \angle APB = \gamma$ (assuming one case for the configuration of points, the other is similar). From the previous sub-problem, we know $\angle DFB = \gamma$. The point $Q$ is on the line $DF$. For the same configuration, $\angle AFQ = \angle DFB = \gamma$. Since $\angle APQ = \angle AFQ = \gamma$, the points $A, Q, P, F$ are concyclic.","Let $A B C$ be an acute triangle with $D, E, F$ the feet of the altitudes lying on $B C, C A, A B$ respectively. One of the intersection points of the line $E F$ and the circumcircle is $P$. The lines $B P$ and $D F$ meet at point $Q$. Prove that $A P=A Q$.","From the second sub-problem, we know that $A, Q, P, F$ are concyclic. In a cyclic quadrilateral, angles subtended by the same arc are equal. Therefore, $\angle AQP = \angle AFP$. The angle $\angle AFP$ is the same as $\angle AFE$. From the first sub-problem, we established that $\angle AFE = \gamma$. Thus, $\angle AQP = \gamma$. In the proof of the second sub-problem, we also showed that $\angle APQ = \gamma$. Since two angles of the triangle $AQP$ are equal, $\angle AQP = \angle APQ} = \gamma$, the triangle is isosceles. Therefore, $AP=AQ$.",,
2010g2,"Point $P$ lies inside triangle $A B C$. Lines $A P, B P, C P$ meet the circumcircle of $A B C$ again at points $K, L, M$, respectively. The tangent to the circumcircle at $C$ meets line $A B$ at $S$. Prove that $S C=S P$ if and only if $M K=M L$.","We assume that $C A>C B$, so point $S$ lies on the ray $A B$.\\
From the similar triangles $\triangle P K M \sim \triangle P C A$ and $\triangle P L M \sim \triangle P C B$ we get $\frac{P M}{K M}=\frac{P A}{C A}$ and $\frac{L M}{P M}=\frac{C B}{P B}$. Multiplying these two equalities, we get

$$
\frac{L M}{K M}=\frac{C B}{C A} \cdot \frac{P A}{P B} .
$$

Hence, the relation $M K=M L$ is equivalent to $\frac{C B}{C A}=\frac{P B}{P A}$.\\
Denote by $E$ the foot of the bisector of angle $B$ in triangle $A B C$. Recall that the locus of points $X$ for which $\frac{X A}{X B}=\frac{C A}{C B}$ is the Apollonius circle $\Omega$ with the center $Q$ on the line $A B$, and this circle passes through $C$ and $E$. Hence, we have $M K=M L$ if and only if $P$ lies on $\Omega$, that is $Q P=Q C$.\\

Now we prove that $S=Q$, thus establishing the problem statement. We have $\angle C E S=$ $\angle C A E+\angle A C E=\angle B C S+\angle E C B=\angle E C S$, so $S C=S E$. Hence, the point $S$ lies on $A B$ as well as on the perpendicular bisector of $C E$ and therefore coincides with $Q$.",2,"Prove that $MK=ML$ if and only if the ratio of distances from $P$ to $A$ and $B$ is equal to the ratio of the side lengths $CA$ and $CB$, i.e., $\frac{PA}{PB} = \frac{CA}{CB}$.","Since points $A,B,C,K,L,M$ lie on the circumcircle, we can identify similar triangles. We have $\angle PKM = \angle AKM = \angle ACM$ and $\angle PMK = \angle CAK = \angle CAP$, which implies $\triangle PKM \sim \triangle PCA$. Similarly, $\angle PLM = \angle BLM = \angle BCM$ and $\angle PML = \angle CBL = \angle CBP$, which implies $\triangle PLM \sim \triangle PCB$. From these similarities, we get $\frac{PM}{KM} = \frac{PA}{CA}$ and $\frac{LM}{PM} = \frac{CB}{PB}$. Multiplying these two equalities gives $\frac{LM}{KM} = \frac{PA \cdot CB}{CA \cdot PB}$. Therefore, $MK=ML$ is equivalent to $1 = \frac{PA \cdot CB}{CA \cdot PB}$, which rearranges to $\frac{PA}{PB} = \frac{CA}{CB}$.",Prove that $S C=S P$ if and only if $M K=M L$.,"From the first sub-problem, $MK=ML$ is equivalent to $\frac{PA}{PB} = \frac{CA}{CB}$. This condition means that $P$ lies on the Apollonius circle $\Omega$ of points $A, B$ with the ratio $k=CA/CB$. Since $C$ also satisfies this ratio condition for itself, $C$ lies on $\Omega$. Let $Q$ be the center of $\Omega$. The condition $P \in \Omega$ is equivalent to $QP=QC$. To prove the problem statement, we show that $S$ is the center of this circle, i.e., $S=Q$. The center $Q$ lies on the line $AB$. $S$ also lies on $AB$ by definition. Let $E$ be the foot of the angle bisector of $\angle C$ on $AB$. $E$ lies on $\Omega$, so $Q$ lies on the perpendicular bisector of $CE$. By the tangent-chord theorem, $\angle SCB = \angle CAB$. In $\triangle SCE$, $\angle SEC = \angle EAC + \angle ACE$ and $\angle SCE = \angle SCB + \angle BCE$. As $CE$ is the angle bisector and $\angle SCB = \angle EAC$, we have $\angle SEC = \angle SCE$. So $\triangle SCE$ is isosceles with $SC=SE$, meaning $S$ lies on the perpendicular bisector of $CE$. Since $S$ and $Q$ both lie on line $AB$ and on the perpendicular bisector of $CE$, they must coincide. Thus $S=Q$, so the condition $MK=ML \iff P \in \Omega$ is equivalent to $SP=SC$.",,,,
2010g3,"Let $A_{1} A_{2} \ldots A_{n}$ be a convex polygon. Point $P$ inside this polygon is chosen so that its projections $P_{1}, \ldots, P_{n}$ onto lines $A_{1} A_{2}, \ldots, A_{n} A_{1}$ respectively lie on the sides of the polygon. Prove that for arbitrary points $X_{1}, \ldots, X_{n}$ on sides $A_{1} A_{2}, \ldots, A_{n} A_{1}$ respectively,

$$
\max \left\{\frac{X_{1} X_{2}}{P_{1} P_{2}}, \ldots, \frac{X_{n} X_{1}}{P_{n} P_{1}}\right\} \geq 1
$$","Denote $P_{n+1}=P_{1}, X_{n+1}=X_{1}, A_{n+1}=A_{1}$.\\
Lemma. Let point $Q$ lies inside $A_{1} A_{2} \ldots A_{n}$. Then it is contained in at least one of the circumcircles of triangles $X_{1} A_{2} X_{2}, \ldots, X_{n} A_{1} X_{1}$.

Proof. If $Q$ lies in one of the triangles $X_{1} A_{2} X_{2}, \ldots, X_{n} A_{1} X_{1}$, the claim is obvious. Otherwise $Q$ lies inside the polygon $X_{1} X_{2} \ldots X_{n}$ (see Fig. 1). Then we have

$$
\begin{aligned}
& \left(\angle X_{1} A_{2} X_{2}+\angle X_{1} Q X_{2}\right)+\cdots+\left(\angle X_{n} A_{1} X_{1}+\angle X_{n} Q X_{1}\right) \\
& \quad=\left(\angle X_{1} A_{1} X_{2}+\cdots+\angle X_{n} A_{1} X_{1}\right)+\left(\angle X_{1} Q X_{2}+\cdots+\angle X_{n} Q X_{1}\right)=(n-2) \pi+2 \pi=n \pi
\end{aligned}
$$

hence there exists an index $i$ such that $\angle X_{i} A_{i+1} X_{i+1}+\angle X_{i} Q X_{i+1} \geq \frac{\pi n}{n}=\pi$. Since the quadrilateral $Q X_{i} A_{i+1} X_{i+1}$ is convex, this means exactly that $Q$ is contained the circumcircle of $\triangle X_{i} A_{i+1} X_{i+1}$, as desired.

Now we turn to the solution. Applying lemma, we get that $P$ lies inside the circumcircle of triangle $X_{i} A_{i+1} X_{i+1}$ for some $i$. Consider the circumcircles $\omega$ and $\Omega$ of triangles $P_{i} A_{i+1} P_{i+1}$ and $X_{i} A_{i+1} X_{i+1}$ respectively (see Fig. 2); let $r$ and $R$ be their radii. Then we get $2 r=A_{i+1} P \leq 2 R$ (since $P$ lies inside $\Omega$ ), hence

$$
P_{i} P_{i+1}=2 r \sin \angle P_{i} A_{i+1} P_{i+1} \leq 2 R \sin \angle X_{i} A_{i+1} X_{i+1}=X_{i} X_{i+1}
$$

QED.\\",2,"Let $A_1 A_2 \ldots A_n$ be a convex polygon. For $i=1, \ldots, n$, let $X_i$ be an arbitrary point on side $A_i A_{i+1}$ (where indices are taken modulo $n$, so $A_{n+1}=A_1$). Prove that any point $Q$ inside the polygon $A_1 A_2 \ldots A_n$ is contained in at least one of the circumcircles of the triangles $\triangle X_i A_{i+1} X_{i+1}$ for $i=1, \ldots, n$.","If $Q$ lies in one of the triangles $\triangle X_i A_{i+1} X_{i+1}$, the claim is obvious. Otherwise, $Q$ lies inside the polygon $X_1 X_2 \ldots X_n$. Consider the sum of angles $\sum_{i=1}^n (\angle X_i A_{i+1} X_{i+1} + \angle X_i Q X_{i+1})$. This sum is equal to the sum of the interior angles of the polygon $A_1 \ldots A_n$, which is $(n-2)\pi$, plus the sum of the angles around point $Q$, which is $2\pi$. The total sum is $n\pi$. By the pigeonhole principle, there must be at least one index $i$ for which $\angle X_i A_{i+1} X_{i+1} + \angle X_i Q X_{i+1} \geq \pi$. Since the quadrilateral $Q X_i A_{i+1} X_{i+1}$ is convex, this condition implies that $Q$ is contained in the circumcircle of $\triangle X_i A_{i+1} X_{i+1}$.","Let $A_{1} A_{2} \ldots A_{n}$ be a convex polygon. Point $P$ inside this polygon is chosen so that its projections $P_{1}, \ldots, P_{n}$ onto lines $A_{1} A_{2}, \ldots, A_{n} A_{1}$ respectively lie on the sides of the polygon. Prove that for arbitrary points $X_{1}, \ldots, X_{n}$ on sides $A_{1} A_{2}, \ldots, A_{n} A_{1}$ respectively,\n\n$$ \max \\left\\{\frac{X_{1} X_{2}}{P_{1} P_{2}}, \\ldots, \frac{X_{n} X_{1}}{P_{n} P_{1}}\right\\} \\geq 1 $$","Applying the result from the first sub-problem with $Q=P$, we find that for some index $i$, $P$ lies inside the circumcircle of $\triangle X_i A_{i+1} X_{i+1}$. Let this circle be $\Omega$ with radius $R$. Since $A_{i+1}$ is on $\Omega$ and $P$ is inside or on $\Omega$, the distance $PA_{i+1}$ is at most the diameter $2R$. Now, consider points $P_i$ and $P_{i+1}$, the projections of $P$ onto lines $A_iA_{i+1}$ and $A_{i+1}A_{i+2}$ respectively. The quadrilateral $P P_i A_{i+1} P_{i+1}$ has right angles at $P_i$ and $P_{i+1}$, so these four points lie on a circle $\omega$ with diameter $PA_{i+1}$. Let its radius be $r$, so $2r = PA_{i+1}$. It follows that $2r \le 2R$, or $r \le R$. By the Law of Sines in $\triangle P_i A_{i+1} P_{i+1}$ and $\triangle X_i A_{i+1} X_{i+1}$, we have $P_i P_{i+1} = 2r \sin(\angle P_i A_{i+1} P_{i+1})$ and $X_i X_{i+1} = 2R \sin(\angle X_i A_{i+1} X_{i+1})$. Since $\angle P_i A_{i+1} P_{i+1} = \angle X_i A_{i+1} X_{i+1} = \angle A_{i+1}$, and $r \le R$, we conclude that $P_i P_{i+1} \le X_i X_{i+1}$. This implies $\frac{X_i X_{i+1}}{P_i P_{i+1}} \geq 1$ for this $i$, which proves the claim.",,,,
2010g4,"Let $I$ be the incenter of a triangle $A B C$ and $\Gamma$ be its circumcircle. Let the line $A I$ intersect $\Gamma$ at a point $D \neq A$. Let $F$ and $E$ be points on side $B C$ and arc $B D C$ respectively such that $\angle B A F=\angle C A E<\frac{1}{2} \angle B A C$. Finally, let $G$ be the midpoint of the segment $I F$. Prove that the lines $D G$ and $E I$ intersect on $\Gamma$.","Let $X$ be the second point of intersection of line $E I$ with $\Gamma$, and $L$ be the foot of the bisector of angle $B A C$. Let $G^{\prime}$ and $T$ be the points of intersection of segment $D X$ with lines $I F$ and $A F$, respectively. We are to prove that $G=G^{\prime}$, or $I G^{\prime}=G^{\prime} F$. By the Menelaus theorem applied to triangle AIF and line $D X$, it means that we need the relation

$$
1=\frac{G^{\prime} F}{I G^{\prime}}=\frac{T F}{A T} \cdot \frac{A D}{I D}, \quad \text { or } \quad \frac{T F}{A T}=\frac{I D}{A D} .
$$

Let the line $A F$ intersect $\Gamma$ at point $K \neq A$ (see Fig. 1); since $\angle B A K=\angle C A E$ we have $\widehat{B K}=\widehat{C E}$, hence $K E \| B C$. Notice that $\angle I A T=\angle D A K=\angle E A D=\angle E X D=\angle I X T$, so the points $I, A, X, T$ are concyclic. Hence we have $\angle I T A=\angle I X A=\angle E X A=\angle E K A$, so $I T\|K E\| B C$. Therefore we obtain $\frac{T F}{A T}=\frac{I L}{A I}$.

Since $C I$ is the bisector of $\angle A C L$, we get $\frac{I L}{A I}=\frac{C L}{A C}$. Furthermore, $\angle D C L=\angle D C B=$ $\angle D A B=\angle C A D=\frac{1}{2} \angle B A C$, hence the triangles $D C L$ and $D A C$ are similar; therefore we get $\frac{C L}{A C}=\frac{D C}{A D}$. Finally, it is known that the midpoint $D$ of arc $B C$ is equidistant from points $I$, $B, C$, hence $\frac{D C}{A D}=\frac{I D}{A D}$.

Summarizing all these equalities, we get

$$
\frac{T F}{A T}=\frac{I L}{A I}=\frac{C L}{A C}=\frac{D C}{A D}=\frac{I D}{A D}
$$

as desired.\\",3,Let $X$ be the second point of intersection of line $EI$ with the circumcircle $\Gamma$. Let $T$ be the intersection of line $DX$ with line $AF$. Prove that the line segment $IT$ is parallel to $BC$.,"Let $K$ be the second intersection of line $AF$ with $\Gamma$. Since $\angle BAF = \angle CAE$, we have that arcs $\widehat{BK}$ and $\widehat{CE}$ are equal, which implies $KE \| BC$. We want to show $IT \| KE$. The points $A,I,D$ are collinear. We have the following chain of equalities: $\angle IAT = \angle DAF = \angle DAB + \angle BAF = \frac{1}{2}\angle BAC + \angle CAE = \angle CAD + \angle CAE = \angle EAD$. On the other hand, since $A, D, E, X$ lie on $\Gamma$, $\angle EAD = \angle EXD$. As $E,I,X$ are collinear and $D,T,X$ are collinear, $\angle EXD = \angle IXT$. Thus, $\angle IAT = \angle IXT$, which implies that the points $I, A, X, T$ are concyclic. From this concyclicity, $\angle ITA = \angle IXA$. As $I,E,X$ are collinear, $\angle IXA = \angle EXA$. Since $A,E,X,K$ lie on $\Gamma$, $\angle EXA = \angle EKA$. Therefore, $\angle ITA = \angle EKA$. Since $A,T,K$ are collinear, this implies $IT \| KE$. As $KE \| BC$, we conclude $IT \| BC$.",Let $L$ be the foot of the angle bisector from vertex $A$ on side $BC$. Prove the relation $\frac{IL}{AI} = \frac{ID}{AD}$.,"In $\triangle ACL$, $CI$ is the angle bisector of $\angle C$. By the Angle Bisector Theorem, $\frac{IL}{AI} = \frac{CL}{AC}$. Now, consider $\triangle DAC$ and $\triangle DCL$. Since $A,L,D$ are collinear, $\angle ADC$ is common to both triangles. Also, $\angle DCL = \angle DCB = \angle DAB$ (angles subtended by arc $DB$). As $AD$ is the angle bisector of $\angle A$, $\angle DAB = \angle CAD$. Thus, $\angle DCL = \angle CAD$. By AA similarity, $\triangle DCL \sim \triangle DAC$. This similarity implies $\frac{CL}{AC} = \frac{DC}{AD}$. A well-known property of point $D$ (the intersection of the angle bisector of $A$ with the circumcircle) is that it is the center of the circle passing through $B, I, C$, which gives $DC = DI$. Substituting this into the previous relation, we get $\frac{CL}{AC} = \frac{DI}{AD}$. Combining the equalities, we have $\frac{IL}{AI} = \frac{CL}{AC} = \frac{DI}{AD}$, which proves the desired relation.","Let $I$ be the incenter of a triangle $A B C$ and $\Gamma$ be its circumcircle. Let the line $A I$ intersect $\Gamma$ at a point $D \neq A$. Let $F$ and $E$ be points on side $B C$ and arc $B D C$ respectively such that $\angle B A F=\angle C A E<\frac{1}{2} \angle B A C$. Finally, let $G$ be the midpoint of the segment $I F$. Prove that the lines $D G$ and $E I$ intersect on $\Gamma$.","Let $X$ be the second point of intersection of line $EI$ with $\Gamma$. We need to prove that $D, G, X$ are collinear. Let $T$ be the intersection of line $DX$ with $AF$. Consider the triangle $\triangle AIF$ and the transversal line $D-T-X$. By Menelaus's Theorem, for $D, G, X$ to be collinear, its intersection with $IF$ must be $G$. If we name this intersection $G'$, we need to show that $G'$ is the midpoint of $IF$. The theorem states $\frac{AT}{TF} \cdot \frac{FG'}{G'I} \cdot \frac{ID}{DA} = 1$. For $G'=G$, we must have $FG'=G'I$, so the condition simplifies to proving $\frac{AT}{TF} = \frac{DA}{ID}$, or equivalently $\frac{TF}{AT} = \frac{ID}{AD}$.
From Sub-problem 1, we have $IT \| BC$. Let $L$ be the foot of the angle bisector from $A$. Since $IT \| FL$, considering $\triangle AFL$ and line $IT$, by Thales' Theorem we get $\frac{TF}{AT} = \frac{IL}{AI}$.
From Sub-problem 2, we have $\frac{IL}{AI} = \frac{ID}{AD}$.
Combining these two results, we get $\frac{TF}{AT} = \frac{ID}{AD}$, satisfying the condition from Menelaus's Theorem. Thus, $D, G, X$ are collinear, meaning the lines $DG$ and $EI$ intersect at point $X$ on the circumcircle $\Gamma$.",,
2010g5,"Let $A B C D E$ be a convex pentagon such that $B C \| A E, A B=B C+A E$, and $\angle A B C=$ $\angle C D E$. Let $M$ be the midpoint of $C E$, and let $O$ be the circumcenter of triangle $B C D$. Given that $\angle D M O=90^{\circ}$, prove that $2 \angle B D A=\angle C D E$.","Let $\angle C B D=\alpha, \angle B D C=\beta, \angle A D E=\gamma$, and $\angle A B C=\angle C D E=2 \varphi$. Then we have $\angle A D B=2 \varphi-\beta-\gamma, \angle B C D=180^{\circ}-\alpha-\beta, \angle A E D=360^{\circ}-\angle B C D-\angle C D E=$ $180^{\circ}-2 \varphi+\alpha+\beta$, and finally $\angle D A E=180^{\circ}-\angle A D E-\angle A E D=2 \varphi-\alpha-\beta-\gamma$.\\

Let $N$ be the midpoint of $C D$; then $\angle D N O=90^{\circ}=\angle D M O$, hence points $M, N$ lie on the circle with diameter $O D$. Now, if points $O$ and $M$ lie on the same side of $C D$, we have $\angle D M N=\angle D O N=\frac{1}{2} \angle D O C=\alpha ;$ in the other case, we have $\angle D M N=180^{\circ}-\angle D O N=\alpha ;$\\
so, in both cases $\angle D M N=\alpha$ (see Figures). Next, since $M N$ is a midline in triangle $C D E$, we have $\angle M D E=\angle D M N=\alpha$ and $\angle N D M=2 \varphi-\alpha$.

Now we apply the sine rule to the triangles $A B D, A D E$ (twice), $B C D$ and $M N D$ obtaining

$$
\begin{gathered}
\frac{A B}{A D}=\frac{\sin (2 \varphi-\beta-\gamma)}{\sin (2 \varphi-\alpha)}, \quad \frac{A E}{A D}=\frac{\sin \gamma}{\sin (2 \varphi-\alpha-\beta)}, \quad \frac{D E}{A D}=\frac{\sin (2 \varphi-\alpha-\beta-\gamma)}{\sin (2 \varphi-\alpha-\beta)} \\
\frac{B C}{C D}=\frac{\sin \beta}{\sin \alpha}, \quad \frac{C D}{D E}=\frac{C D / 2}{D E / 2}=\frac{N D}{N M}=\frac{\sin \alpha}{\sin (2 \varphi-\alpha)}
\end{gathered}
$$

which implies

$$
\frac{B C}{A D}=\frac{B C}{C D} \cdot \frac{C D}{D E} \cdot \frac{D E}{A D}=\frac{\sin \beta \cdot \sin (2 \varphi-\alpha-\beta-\gamma)}{\sin (2 \varphi-\alpha) \cdot \sin (2 \varphi-\alpha-\beta)}
$$

Hence, the condition $A B=A E+B C$, or equivalently $\frac{A B}{A D}=\frac{A E+B C}{A D}$, after multiplying by the common denominator rewrites as

$$
\begin{gathered}
\sin (2 \varphi-\alpha-\beta) \cdot \sin (2 \varphi-\beta-\gamma)=\sin \gamma \cdot \sin (2 \varphi-\alpha)+\sin \beta \cdot \sin (2 \varphi-\alpha-\beta-\gamma) \\
\Longleftrightarrow \cos (\gamma-\alpha)-\cos (4 \varphi-2 \beta-\alpha-\gamma)=\cos (2 \varphi-\alpha-2 \beta-\gamma)-\cos (2 \varphi+\gamma-\alpha) \\
\Longleftrightarrow \cos (\gamma-\alpha)+\cos (2 \varphi+\gamma-\alpha)=\cos (2 \varphi-\alpha-2 \beta-\gamma)+\cos (4 \varphi-2 \beta-\alpha-\gamma) \\
\Longleftrightarrow \cos \varphi \cdot \cos (\varphi+\gamma-\alpha)=\cos \varphi \cdot \cos (3 \varphi-2 \beta-\alpha-\gamma) \\
\Longleftrightarrow \cos \varphi \cdot(\cos (\varphi+\gamma-\alpha)-\cos (3 \varphi-2 \beta-\alpha-\gamma))=0 \\
\Longleftrightarrow \cos \varphi \cdot \sin (2 \varphi-\beta-\alpha) \cdot \sin (\varphi-\beta-\gamma)=0
\end{gathered}
$$

Since $2 \varphi-\beta-\alpha=180^{\circ}-\angle A E D<180^{\circ}$ and $\varphi=\frac{1}{2} \angle A B C<90^{\circ}$, it follows that $\varphi=\beta+\gamma$, hence $\angle B D A=2 \varphi-\beta-\gamma=\varphi=\frac{1}{2} \angle C D E$, as desired.",3,"Let $M$ be the midpoint of $CE$ in $\triangle CDE$, $N$ be the midpoint of $CD$, and $O$ be the circumcenter of $\triangle BCD$. Given $\angle D M O=90^{\circ}$, show that $\angle MDE = \angle CBD$.","Let $\angle CBD = \alpha$. As $O$ is the circumcenter of $\triangle BCD$ and $N$ is the midpoint of chord $CD$, $ON \perp CD$ and $\angle DON = \angle DBC = \alpha$. The condition $\angle D M O=90^{\circ}$ along with $\angle DNO=90^\circ$ implies that points $M$ and $N$ lie on the circle with diameter $OD$. Thus, $\angle DMN = \angle DON = \alpha$. Since $M$ and $N$ are midpoints of $CE$ and $CD$ respectively, $MN$ is a midline in $\triangle CDE$, meaning $MN \| DE$. Therefore, the alternate interior angles are equal: $\angle MDE = \angle DMN = \alpha$. This proves $\angle MDE = \angle CBD$.","Let $\angle CBD = \alpha, \angle BDC = \beta, \angle ADE = \gamma$, and $\angle ABC = \angle CDE = 2\varphi$. Using the result from Sub-problem 1 that $\angle MDE = \alpha$, and the given conditions $AB = BC + AE$ and $BC \| AE$, derive the trigonometric equation: $\sin(2\varphi-\alpha-\beta)\sin(2\varphi-\beta-\gamma) = \sin\gamma\sin(2\varphi-\alpha) + \sin\beta\sin(2\varphi-\alpha-\beta-\gamma)$.","The condition $AB=BC+AE$ is rewritten as $\frac{AB}{AD}=\frac{BC}{AD}+\frac{AE}{AD}$. Using the Law of Sines on $\triangle ABD$, $\triangle ADE$, $\triangle BCD$ and the midline properties in $\triangle CDE$, we find the ratios: $\frac{AB}{AD}=\frac{\sin(2\varphi-\beta-\gamma)}{\sin(2\varphi-\alpha)}$, $\frac{AE}{AD}=\frac{\sin\gamma}{\sin(2\varphi-\alpha-\beta)}$, and $\frac{BC}{AD}=\frac{\sin\beta \sin(2\varphi-\alpha-\beta-\gamma)}{\sin(2\varphi-\alpha)\sin(2\varphi-\alpha-\beta)}$. Substituting these into the length equation and multiplying by the common denominator $\sin(2\varphi-\alpha)\sin(2\varphi-\alpha-\beta)$ gives the desired trigonometric relation: $\sin(2\varphi-\alpha-\beta)\sin(2\varphi-\beta-\gamma) = \sin\gamma\sin(2\varphi-\alpha) + \sin\beta\sin(2\varphi-\alpha-\beta-\gamma)$.","Let $A B C D E$ be a convex pentagon such that $B C \| A E, A B=B C+A E$, and $\angle A B C=$ $\angle C D E$. Let $M$ be the midpoint of $C E$, and let $O$ be the circumcenter of triangle $B C D$. Given that $\angle D M O=90^{\circ}$, prove that $2 \angle B D A=\angle C D E$.","Let $\angle CBD=\alpha, \angle BDC=\beta, \angle ADE=\gamma, \angle ABC=\angle CDE=2\varphi$. From the previous steps, we have the relation $\sin(2\varphi-\alpha-\beta)\sin(2\varphi-\beta-\gamma) = \sin\gamma\sin(2\varphi-\alpha) + \sin\beta\sin(2\varphi-\alpha-\beta-\gamma)$. Applying product-to-sum trigonometric identities, this equation simplifies to $\cos\varphi \cdot \sin(2\varphi-\beta-\alpha) \cdot \sin(\varphi-\beta-\gamma) = 0$. Since $A B C D E$ is a convex pentagon, $\varphi = \frac{1}{2}\angle ABC < 90^{\circ}$, so $\cos\varphi \neq 0$. Also, $2\varphi-\beta-\alpha = 180^{\circ} - \angle AED$, so its sine is non-zero. Therefore, we must have $\sin(\varphi-\beta-\gamma)=0$, which implies $\varphi = \beta + \gamma$. The angle to be determined is $\angle BDA = 2\varphi - \beta - \gamma$. Substituting $\varphi=\beta+\gamma$, we get $\angle BDA = 2\varphi - \varphi = \varphi$. Since $\angle CDE = 2\varphi$, we have $\angle BDA = \frac{1}{2}\angle CDE$, which is equivalent to $2\angle BDA = \angle CDE$.",,
2010g6,"The vertices $X, Y, Z$ of an equilateral triangle $X Y Z$ lie respectively on the sides $B C$, $C A, A B$ of an acute-angled triangle $A B C$. Prove that the incenter of triangle $A B C$ lies inside triangle $X Y Z$.\\","We will prove a stronger fact; namely, we will show that the incenter $I$ of triangle $A B C$ lies inside the incircle of triangle $X Y Z$ (and hence surely inside triangle $X Y Z$ itself). We denote by $d(U, V W)$ the distance between point $U$ and line $V W$.

Denote by $O$ the incenter of $\triangle X Y Z$ and by $r, r^{\prime}$ and $R^{\prime}$ the inradii of triangles $A B C, X Y Z$ and the circumradius of $X Y Z$, respectively. Then we have $R^{\prime}=2 r^{\prime}$, and the desired inequality is $O I \leq r^{\prime}$. We assume that $O \neq I$; otherwise the claim is trivial.

Let the incircle of $\triangle A B C$ touch its sides $B C, A C, A B$ at points $A_{1}, B_{1}, C_{1}$ respectively. The lines $I A_{1}, I B_{1}, I C_{1}$ cut the plane into 6 acute angles, each one containing one of the points $A_{1}, B_{1}, C_{1}$ on its border. We may assume that $O$ lies in an angle defined by lines $I A_{1}$, $I C_{1}$ and containing point $C_{1}$ (see Fig. 1). Let $A^{\prime}$ and $C^{\prime}$ be the projections of $O$ onto lines $I A_{1}$ and $I C_{1}$, respectively.

Since $O X=R^{\prime}$, we have $d(O, B C) \leq R^{\prime}$. Since $O A^{\prime} \| B C$, it follows that $d\left(A^{\prime}, B C\right)=$ $A^{\prime} I+r \leq R^{\prime}$, or $A^{\prime} I \leq R^{\prime}-r$. On the other hand, the incircle of $\triangle X Y Z$ lies inside $\triangle A B C$, hence $d(O, A B) \geq r^{\prime}$, and analogously we get $d(O, A B)=C^{\prime} C_{1}=r-I C^{\prime} \geq r^{\prime}$, or $I C^{\prime} \leq r-r^{\prime}$.\\

Finally, the quadrilateral $I A^{\prime} O C^{\prime}$ is circumscribed due to the right angles at $A^{\prime}$ and $C^{\prime}$ (see Fig. 2). On its circumcircle, we have $\widehat{A^{\prime} O C^{\prime}}=2 \angle A^{\prime} I C^{\prime}<180^{\circ}=\widehat{O C^{\prime} I \text {, hence } 180^{\circ} \geq}$ $\overline{I C^{\prime}}>\widehat{A^{\prime} O}$. This means that $I C^{\prime}>A^{\prime} O$. Finally, we have $O I \leq I A^{\prime}+A^{\prime} O<I A^{\prime}+I C^{\prime} \leq$ $\left(R^{\prime}-r\right)+\left(r-r^{\prime}\right)=R^{\prime}-r^{\prime}=r^{\prime}$, as desired.",3,"Let $I$ be the incenter and $r$ the inradius of $\triangle ABC$. Let $O$ be the incenter, $r'$ the inradius, and $R'$ the circumradius of the equilateral $\triangle XYZ$. Let $A_1$ and $C_1$ be the tangency points of the incircle of $\triangle ABC$ with sides $BC$ and $AB$ respectively. Let $A'$ and $C'$ be the projections of $O$ onto the lines $IA_1$ and $IC_1$. Show that $IA' \le R' - r$ and $IC' \le r - r'$.","Since vertex $X$ lies on side $BC$ and $O$ is the circumcenter of $\triangle XYZ$, the distance from $O$ to line $BC$ is at most $OX=R'$. The lines $OA'$ and $BC$ are parallel, so the distance between them is $d(O,BC) = IA' + d(I,BC) = IA' + r$. This gives $IA' + r \le R'$, so $IA' \le R' - r$. The incircle of $\triangle XYZ$ lies within $\triangle ABC$, so the distance from $O$ to side $AB$ must be at least $r'$, i.e., $d(O, AB) \ge r'$. The lines $OC'$ and $AB$ are parallel, so the distance between them is $d(O,AB) = d(I,AB) - IC' = r - IC'$. This gives $r - IC' \ge r'$, so $IC' \le r - r'$.","With the same setup, show that the distance $OI$ between the incenters of $\triangle ABC$ and $\triangle XYZ$ satisfies the inequality $OI < R' - r'$.","The quadrilateral $IA'OC'$ has right angles at $A'$ and $C'$, so it is cyclic with diameter $OI$. By the triangle inequality in the right-angled $\triangle OIA'$, $OI \le IA' + A'O$. A further geometric property of the cyclic quadrilateral shows that chord $A'O$ is shorter than chord $IC'$. Thus, $OI < IA' + IC'$. Using the results from the previous sub-problem, we substitute the inequalities for $IA'$ and $IC'$: $IA' + IC' \le (R' - r) + (r - r') = R' - r'$. Combining these results yields $OI < R' - r'$.","The vertices $X, Y, Z$ of an equilateral triangle $X Y Z$ lie respectively on the sides $B C$, $C A, A B$ of an acute-angled triangle $A B C$. Prove that the incenter of triangle $A B C$ lies inside triangle $X Y Z$.","Let $I$ be the incenter of $\triangle ABC$, and let $O$, $r'$, and $R'$ be the incenter, inradius, and circumradius of $\triangle XYZ$. We will prove the stronger statement that $I$ lies inside the incircle of $\triangle XYZ$ by showing $OI < r'$. From the previous sub-problem, we established the inequality $OI < R' - r'$. For an equilateral triangle, the circumradius is twice the inradius, so $R' = 2r'$. Substituting this relation, we get $OI < 2r' - r'$, which simplifies to $OI < r'$. Since the distance from $I$ to the center $O$ is less than the inradius $r'$, $I$ must lie inside the incircle of $\triangle XYZ$, and therefore inside $\triangle XYZ$ itself.",,
2010g7,"Three circular arcs $\gamma_{1}, \gamma_{2}$, and $\gamma_{3}$ connect the points $A$ and $C$. These arcs lie in the same half-plane defined by line $A C$ in such a way that arc $\gamma_{2}$ lies between the arcs $\gamma_{1}$ and $\gamma_{3}$. Point $B$ lies on the segment $A C$. Let $h_{1}, h_{2}$, and $h_{3}$ be three rays starting at $B$, lying in the same half-plane, $h_{2}$ being between $h_{1}$ and $h_{3}$. For $i, j=1,2,3$, denote by $V_{i j}$ the point of intersection of $h_{i}$ and $\gamma_{j}$ (see the Figure below).\\
\includegraphics[max width=\textwidth]{2025_05_04_3fd3d9bd7a00de872656g-61} and arcs $V_{i j} V_{k j}$ and $V_{i \ell} V_{k \ell}$. We say that this quadrilateral is circumscribed if there exists a circle touching these two segments and two arcs.

Prove that if the curved quadrilaterals $\sqrt{V_{11} V_{21}} \sqrt{22} V_{12}, \sqrt{12} V_{22} \sqrt{23} V_{13}, \sqrt{21} \sqrt{31} \sqrt{32 V_{22}}$ are circumscribed, then the curved quadrilateral $\widehat{V_{22} V_{32}} \sqrt{3_{33} V_{23}}$ is circumscribed, too.","Solution. Denote by $O_{i}$ and $R_{i}$ the center and the radius of $\gamma_{i}$, respectively. Denote also by $H$ the half-plane defined by $A C$ which contains the whole configuration. For every point $P$ in the half-plane $H$, denote by $d(P)$ the distance between $P$ and line $A C$. Furthermore, for any $r>0$, denote by $\Omega(P, r)$ the circle with center $P$ and radius $r$.\\
Lemma 1. For every $1 \leq i<j \leq 3$, consider those circles $\Omega(P, r)$ in the half-plane $H$ which are tangent to $h_{i}$ and $h_{j}$.\\
(a) The locus of the centers of these circles is the angle bisector $\beta_{i j}$ between $h_{i}$ and $h_{j}$.\\
(b) There is a constant $u_{i j}$ such that $r=u_{i j} \cdot d(P)$ for all such circles.

Proof. Part (a) is obvious. To prove part (b), notice that the circles which are tangent to $h_{i}$ and $h_{j}$ are homothetic with the common homothety center $B$ (see Fig. 2). Then part (b) also becomes trivial.

Lemma 2. For every $1 \leq i<j \leq 3$, consider those circles $\Omega(P, r)$ in the half-plane $H$ which are externally tangent to $\gamma_{i}$ and internally tangent to $\gamma_{j}$.\\
(a) The locus of the centers of these circles is an ellipse arc $\varepsilon_{i j}$ with end-points $A$ and $C$.\\
(b) There is a constant $v_{i j}$ such that $r=v_{i j} \cdot d(P)$ for all such circles.

Proof. (a) Notice that the circle $\Omega(P, r)$ is externally tangent to $\gamma_{i}$ and internally tangent to $\gamma_{j}$ if and only if $O_{i} P=R_{i}+r$ and $O_{j}=R_{j}-r$. Therefore, for each such circle we have

$$
O_{i} P+O_{j} P=O_{i} A+O_{j} A=O_{i} C+O_{j} C=R_{i}+R_{j} .
$$

Such points lie on an ellipse with foci $O_{i}$ and $O_{j}$; the diameter of this ellipse is $R_{i}+R_{j}$, and it passes through the points $A$ and $C$. Let $\varepsilon_{i j}$ be that arc $A C$ of the ellipse which runs inside the half plane $H$ (see Fig. 3.)

This ellipse arc lies between the arcs $\gamma_{i}$ and $\gamma_{j}$. Therefore, if some point $P$ lies on $\varepsilon_{i j}$, then $O_{i} P>R_{i}$ and $O_{j} P<R_{j}$. Now, we choose $r=O_{i} P-R_{i}=R_{j}-O_{j} P>0$; then the\\
\includegraphics[max width=\textwidth, center]{2025_05_04_3fd3d9bd7a00de872656g-62}

Fig. 2\\
\includegraphics[max width=\textwidth, center]{2025_05_04_3fd3d9bd7a00de872656g-62(1)}

Fig. 3\\
circle $\Omega(P, r)$ touches $\gamma_{i}$ externally and touches $\gamma_{j}$ internally, so $P$ belongs to the locus under investigation.\\
(b) Let $\vec{\rho}=\overrightarrow{A P}, \vec{\rho}_{i}=\overrightarrow{A O_{i}}$, and $\vec{\rho}_{j}=\overrightarrow{A O_{j}}$; let $d_{i j}=O_{i} O_{j}$, and let $\vec{v}$ be a unit vector orthogonal to $A C$ and directed toward $H$. Then we have $\left|\vec{\rho}_{i}\right|=R_{i},\left|\vec{\rho}_{j}\right|=R_{j},\left|\overrightarrow{O_{i} P}\right|=$ $\left|\vec{\rho}-\vec{\rho}_{i}\right|=R_{i}+r,\left|\overrightarrow{O_{j} P}\right|=\left|\vec{\rho}-\vec{\rho}_{j}\right|=R_{j}-r$, hence

$$
\begin{gathered}
\left(\vec{\rho}-\vec{\rho}_{i}\right)^{2}-\left(\vec{\rho}-\vec{\rho}_{j}\right)^{2}=\left(R_{i}+r\right)^{2}-\left(R_{j}-r\right)^{2}, \\
\left(\vec{\rho}_{i}^{2}-\vec{\rho}_{j}^{2}\right)+2 \vec{\rho} \cdot\left(\vec{\rho}_{j}-\vec{\rho}_{i}\right)=\left(R_{i}^{2}-R_{j}^{2}\right)+2 r\left(R_{i}+R_{j}\right), \\
d_{i j} \cdot d(P)=d_{i j} \vec{v} \cdot \vec{\rho}=\left(\vec{\rho}_{j}-\vec{\rho}_{i}\right) \cdot \vec{\rho}=r\left(R_{i}+R_{j}\right) .
\end{gathered}
$$

Therefore,

$$
r=\frac{d_{i j}}{R_{i}+R_{j}} \cdot d(P),
$$

and the value $v_{i j}=\frac{d_{i j}}{R_{i}+R_{j}}$ does not depend on $P$.\\
Lemma 3. The curved quadrilateral $\mathcal{Q}_{i j}=\sqrt{i, j V_{i+1, j}} V_{i+1, j+1} V_{i, j+1}$ is circumscribed if and only if $u_{i, i+1}=v_{j, j+1}$.\\
Proof. First suppose that the curved quadrilateral $\mathcal{Q}_{i j}$ is circumscribed and $\Omega(P, r)$ is its inscribed circle. By Lemma 1 and Lemma 2 we have $r=u_{i, i+1} \cdot d(P)$ and $r=v_{j, j+1} \cdot d(P)$ as well. Hence, $u_{i, i+1}=v_{j, j+1}$.

To prove the opposite direction, suppose $u_{i, i+1}=v_{j, j+1}$. Let $P$ be the intersection of the angle bisector $\beta_{i, i+1}$ and the ellipse arc $\varepsilon_{j, j+1}$. Choose $r=u_{i, i+1} \cdot d(P)=v_{j, j+1} \cdot d(P)$. Then the circle $\Omega(P, r)$ is tangent to the half lines $h_{i}$ and $h_{i+1}$ by Lemma 1 , and it is tangent to the arcs $\gamma_{j}$ and $\gamma_{j+1}$ by Lemma 2. Hence, the curved quadrilateral $\mathcal{Q}_{i j}$ is circumscribed.

By Lemma 3, the statement of the problem can be reformulated to an obvious fact: If the equalities $u_{12}=v_{12}, u_{12}=v_{23}$, and $u_{23}=v_{12}$ hold, then $u_{23}=v_{23}$ holds as well.

Comment 1. Lemma 2(b) (together with the easy Lemma 1(b)) is the key tool in this solution. If one finds this fact, then the solution can be finished in many ways. That is, one can find a circle touching three of $h_{2}, h_{3}, \gamma_{2}$, and $\gamma_{3}$, and then prove that it is tangent to the fourth one in either synthetic or analytical way. Both approaches can be successful.

Here we present some discussion about this key Lemma.

\begin{enumerate}
  \item In the solution above we chose an analytic proof for Lemma 2(b) because we expect that most students will use coordinates or vectors to examine the locus of the centers, and these approaches are less case-sensitive.
\end{enumerate}

Here we outline a synthetic proof. We consider only the case when $P$ does not lie in the line $O_{i} O_{j}$. The other case can be obtained as a limit case, or computed in a direct way.

Let $S$ be the internal homothety center between the circles of $\gamma_{i}$ and $\gamma_{j}$, lying on $O_{i} O_{j}$; this point does not depend on $P$. Let $U$ and $V$ be the points of tangency of circle $\sigma=\Omega(P, r)$ with $\gamma_{i}$ and $\gamma_{j}$, respectively (then $r=P U=P V$ ); in other words, points $U$ and $V$ are the intersection points of rays $O_{i} P, O_{j} P$ with arcs $\gamma_{i}, \gamma_{j}$ respectively (see Fig. 4).

Due to the theorem on three homothety centers (or just to the Menelaus theorem applied to triangle $O_{i} O_{j} P$ ), the points $U, V$ and $S$ are collinear. Let $T$ be the intersection point of line $A C$ and the common tangent to $\sigma$ and $\gamma_{i}$ at $U$; then $T$ is the radical center of $\sigma, \gamma_{i}$ and $\gamma_{j}$, hence $T V$ is the common tangent to $\sigma$ and $\gamma_{j}$.

Let $Q$ be the projection of $P$ onto the line $A C$. By the right angles, the points $U, V$ and $Q$ lie on the circle with diameter $P T$. From this fact and the equality $P U=P V$ we get $\angle U Q P=\angle U V P=$ $\angle V U P=\angle S U O_{i}$. Since $O_{i} S \| P Q$, we have $\angle S O_{i} U=\angle Q P U$. Hence, the triangles $S O_{i} U$ and $U P Q$ are similar and thus $\frac{r}{d(P)}=\frac{P U}{P Q}=\frac{O_{i} S}{O_{i} U}=\frac{O_{i} S}{R_{i}}$; the last expression is constant since $S$ is a constant point.\\
\includegraphics[max width=\textwidth, center]{2025_05_04_3fd3d9bd7a00de872656g-63(1)}

Fig. 4\\
\includegraphics[max width=\textwidth, center]{2025_05_04_3fd3d9bd7a00de872656g-63}

Fig. 5\\
2. Using some known facts about conics, the same statement can be proved in a very short way. Denote by $\ell$ the directrix of ellipse of $\varepsilon_{i j}$ related to the focus $O_{j}$; since $\varepsilon_{i j}$ is symmetrical about $O_{i} O_{j}$, we have $\ell \| A C$. Recall that for each point $P \in \varepsilon_{i j}$, we have $P O_{j}=\epsilon \cdot d_{\ell}(P)$, where $d_{\ell}(P)$ is the distance from $P$ to $\ell$, and $\epsilon$ is the eccentricity of $\varepsilon_{i j}$ (see Fig. 5).

Now we have

$$
r=R_{j}-\left(R_{j}-r\right)=A O_{j}-P O_{j}=\epsilon\left(d_{\ell}(A)-d_{\ell}(P)\right)=\epsilon(d(P)-d(A))=\epsilon \cdot d(P)
$$

and $\epsilon$ does not depend on $P$.

Comment 2. One can find a spatial interpretations of the problem and the solution.\\
For every point $(x, y)$ and radius $r>0$, represent the circle $\Omega((x, y), r)$ by the point $(x, y, r)$ in space. This point is the apex of the cone with base circle $\Omega((x, y), r)$ and height $r$. According to Lemma 1, the circles which are tangent to $h_{i}$ and $h_{j}$ correspond to the points of a half line $\beta_{i j}^{\prime}$, starting at $B$.

Now we translate Lemma 2. Take some $1 \leq i<j \leq 3$, and consider those circles which are internally tangent to $\gamma_{j}$. It is easy to see that the locus of the points which represent these circles is a subset of a cone, containing $\gamma_{j}$. Similarly, the circles which are externally tangent to $\gamma_{i}$ correspond to the points on the extension of another cone, which has its apex on the opposite side of the base plane $\Pi$. (See Fig. 6; for this illustration, the $z$-coordinates were multiplied by 2.)

The two cones are symmetric to each other (they have the same aperture, and their axes are parallel). As is well-known, it follows that the common points of the two cones are co-planar. So the intersection of the two cones is a a conic section - which is an ellipse, according to Lemma 2(a). The points which represent the circles touching $\gamma_{i}$ and $\gamma_{j}$ is an ellipse arc $\varepsilon_{i j}^{\prime}$ with end-points $A$ and $C$.\\
\includegraphics[max width=\textwidth, center]{2025_05_04_3fd3d9bd7a00de872656g-64(1)}

Fig. 6\\
\includegraphics[max width=\textwidth, center]{2025_05_04_3fd3d9bd7a00de872656g-64}

Fig. 7

Thus, the curved quadrilateral $\mathcal{Q}_{i j}$ is circumscribed if and only if $\beta_{i, i+1}^{\prime}$ and $\varepsilon_{j, j+1}^{\prime}$ intersect, i.e. if they are coplanar. If three of the four curved quadrilaterals are circumscribed, it means that $\varepsilon_{12}^{\prime}, \varepsilon_{23}^{\prime}$, $\beta_{12}^{\prime}$ and $\beta_{23}^{\prime}$ lie in the same plane $\Sigma$, and the fourth intersection comes to existence, too",4,"For any two rays $h_i, h_j$ starting from a point $B$ on a line $AC$, consider the family of circles tangent to both rays. Show that for any such circle with center $P$ and radius $r$, the radius is proportional to the distance $d(P)$ from $P$ to the line $AC$. That is, $r = u_{ij} \cdot d(P)$ for some constant $u_{ij}$ that depends only on the rays.","The locus of centers P of circles tangent to two intersecting rays $h_i, h_j$ is their angle bisector. All such circles are homothetic with respect to the rays' origin B. This homothety implies a constant ratio between the circle's radius $r$ and the distance $d(P)$ of its center from the line AC. Hence, $r = u_{ij} \cdot d(P)$ for a constant $u_{ij}$ determined by the angle between the rays.","For any two circular arcs $\\gamma_j, \\gamma_k$ with common endpoints $A, C$, consider the family of circles that are externally tangent to $\\gamma_j$ and internally tangent to $\\gamma_k$. Show that for any such circle with center $P$ and radius $r$, the radius is proportional to the distance $d(P)$ from $P$ to the line $AC$. That is, $r = v_{jk} \cdot d(P)$ for some constant $v_{jk}$ that depends only on the arcs.","Let $\\gamma_j$ and $\\gamma_k$ have centers $O_j, O_k$ and radii $R_j, R_k$. For a circle with center P and radius $r$ to be externally tangent to $\\gamma_j$ and internally to $\\gamma_k$, its center must satisfy $O_jP + O_kP = (R_j+r) + (R_k-r) = R_j+R_k$, defining an ellipse. A vector-based calculation shows that the radius $r$ and the distance $d(P)$ are linearly related by $r = v_{jk} \cdot d(P)$, where the constant $v_{jk} = \frac{O_jO_k}{R_j+R_k}$ depends only on the two arcs.","A curved quadrilateral is formed by segments on two rays $h_i, h_{i+1}$ and two circular arcs $\\gamma_j, \\gamma_{j+1}$. Show that this quadrilateral is circumscribed (i.e., admits an inscribed circle tangent to all four sides) if and only if the proportionality constants from the previous sub-problems are equal, i.e., $u_{i,i+1} = v_{j,j+1}$.","A curved quadrilateral is circumscribed if there exists a circle $\\Omega(P, r)$ tangent to its four sides. This circle's center P must lie on the locus of centers of circles tangent to the rays and on the locus of centers of circles tangent to the arcs. Its radius $r$ must simultaneously satisfy $r = u_{i,i+1} \cdot d(P)$ and $r = v_{j,j+1} \cdot d(P)$. This implies $u_{i,i+1} = v_{j,j+1}$ (since $d(P) \neq 0$). Conversely, if the constants are equal, the intersection of the two loci provides the center for an inscribed circle, proving the quadrilateral is circumscribed.","Three circular arcs $\\gamma_{1}, \\gamma_{2}$, and $\\gamma_{3}$ connect the points $A$ and $C$. These arcs lie in the same half-plane defined by line $A C$ in such a way that arc $\\gamma_{2}$ lies between the arcs $\\gamma_{1}$ and $\\gamma_{3}$. Point $B$ lies on the segment $A C$. Let $h_{1}, h_{2}$, and $h_{3}$ be three rays starting at $B$, lying in the same half-plane, $h_{2}$ being between $h_{1}$ and $h_{3}$. For $i, j=1,2,3$, denote by $V_{i j}$ the point of intersection of $h_{i}$ and $\\gamma_{j}$. We say that a curved quadrilateral formed by two segments on rays and two circular arcs is circumscribed if there exists a circle touching these two segments and two arcs. Prove that if the curved quadrilaterals $\\sqrt{V_{11} V_{21}} \\sqrt{22} V_{12}, \\sqrt{12} V_{22} \\sqrt{23} V_{13}, \\sqrt{21} \\sqrt{31} \\sqrt{32 V_{22}}$ are circumscribed, then the curved quadrilateral $\\widehat{V_{22} V_{32}} \\sqrt{3_{33} V_{23}}$ is circumscribed, too.","Let $u_{i,i+1}$ be the constant for rays $h_i, h_{i+1}$ and $v_{j,j+1}$ for arcs $\\gamma_j, \\gamma_{j+1}$. A quadrilateral bounded by these is circumscribed if and only if $u_{i,i+1} = v_{j,j+1}$. The three given conditions are interpreted as: 1. The quadrilateral on rays $(h_1, h_2)$ and arcs $(\\gamma_1, \\gamma_2)$ is circumscribed $\\implies u_{12} = v_{12}$. 2. The quadrilateral on rays $(h_1, h_2)$ and arcs $(\\gamma_2, \\gamma_3)$ is circumscribed $\\implies u_{12} = v_{23}$. 3. The quadrilateral on rays $(h_2, h_3)$ and arcs $(\\gamma_1, \\gamma_2)$ is circumscribed $\\implies u_{23} = v_{12}$. From these equalities, we deduce $u_{23} = v_{12} = u_{12} = v_{23}$. This implies $u_{23} = v_{23}$. This is the condition for the quadrilateral on rays $(h_2, h_3)$ and arcs $(\\gamma_2, \\gamma_3)$ to be circumscribed. Thus, the statement is proved."
2010n6,"The rows and columns of a $2^{n} \times 2^{n}$ table are numbered from 0 to $2^{n}-1$. The cells of the table have been colored with the following property being satisfied: for each $0 \leq i, j \leq 2^{n}-1$, the $j$ th cell in the $i$ th row and the $(i+j)$ th cell in the $j$ th row have the same color. (The indices of the cells in a row are considered modulo $2^{n}$.)

Prove that the maximal possible number of colors is $2^{n}$.","Solution. Throughout the solution we denote the cells of the table by coordinate pairs; $(i, j)$ refers to the $j$ th cell in the $i$ th row.

Consider the directed graph, whose vertices are the cells of the board, and the edges are the arrows $(i, j) \rightarrow(j, i+j)$ for all $0 \leq i, j \leq 2^{n}-1$. From each vertex $(i, j)$, exactly one edge passes (to $\left(j, i+j \bmod 2^{n}\right)$ ); conversely, to each cell $(j, k)$ exactly one edge is directed (from the cell $\left.\left(k-j \bmod 2^{n}, j\right)\right)$. Hence, the graph splits into cycles.

Now, in any coloring considered, the vertices of each cycle should have the same color by the problem condition. On the other hand, if each cycle has its own color, the obtained coloring obviously satisfies the problem conditions. Thus, the maximal possible number of colors is the same as the number of cycles, and we have to prove that this number is $2^{n}$.

Next, consider any cycle $\left(i_{1}, j_{1}\right),\left(i_{2}, j_{2}\right), \ldots$; we will describe it in other terms. Define a sequence $\left(a_{0}, a_{1}, \ldots\right)$ by the relations $a_{0}=i_{1}, a_{1}=j_{1}, a_{n+1}=a_{n}+a_{n-1}$ for all $n \geq 1$ (we say that such a sequence is a Fibonacci-type sequence). Then an obvious induction shows that $i_{k} \equiv a_{k-1}\left(\bmod 2^{n}\right), j_{k} \equiv a_{k}\left(\bmod 2^{n}\right)$. Hence we need to investigate the behavior of Fibonacci-type sequences modulo $2^{n}$.

Denote by $F_{0}, F_{1}, \ldots$ the Fibonacci numbers defined by $F_{0}=0, F_{1}=1$, and $F_{n+2}=$ $F_{n+1}+F_{n}$ for $n \geq 0$. We also set $F_{-1}=1$ according to the recurrence relation.

For every positive integer $m$, denote by $\nu(m)$ the exponent of 2 in the prime factorization of $m$, i.e. for which $2^{\nu(m)} \mid m$ but $2^{\nu(m)+1} \nmid m$.\\
Lemma 1. For every Fibonacci-type sequence $a_{0}, a_{1}, a_{2}, \ldots$, and every $k \geq 0$, we have $a_{k}=$ $F_{k-1} a_{0}+F_{k} a_{1}$.\\
Proof. Apply induction on $k$. The base cases $k=0,1$ are trivial. For the step, from the induction hypothesis we get

$$
a_{k+1}=a_{k}+a_{k-1}=\left(F_{k-1} a_{0}+F_{k} a_{1}\right)+\left(F_{k-2} a_{0}+F_{k-1} a_{1}\right)=F_{k} a_{0}+F_{k+1} a_{1} .
$$

Lemma 2. For every $m \geq 3$,\\
(a) we have $\nu\left(F_{3.2^{m-2}}\right)=m$;\\
(b) $d=3 \cdot 2^{m-2}$ is the least positive index for which $2^{m} \mid F_{d}$;\\
(c) $F_{3 \cdot 2^{m-2}+1} \equiv 1+2^{m-1}\left(\bmod 2^{m}\right)$.

Proof. Apply induction on $m$. In the base case $m=3$ we have $\nu\left(F_{3 \cdot 2^{m-2}}\right)=F_{6}=8$, so $\nu\left(F_{3 \cdot 2^{m-2}}\right)=\nu(8)=3$, the preceding Fibonacci-numbers are not divisible by 8, and indeed $F_{3 \cdot 2^{m-2}+1}=F_{7}=13 \equiv 1+4(\bmod 8)$.

Now suppose that $m>3$ and let $k=3 \cdot 2^{m-3}$. By applying Lemma 1 to the Fibonacci-type sequence $F_{k}, F_{k+1}, \ldots$ we get

$$
\begin{gathered}
F_{2 k}=F_{k-1} F_{k}+F_{k} F_{k+1}=\left(F_{k+1}-F_{k}\right) F_{k}+F_{k+1} F_{k}=2 F_{k+1} F_{k}-F_{k}^{2}, \\
F_{2 k+1}=F_{k} \cdot F_{k}+F_{k+1} \cdot F_{k+1}=F_{k}^{2}+F_{k+1}^{2} .
\end{gathered}
$$

By the induction hypothesis, $\nu\left(F_{k}\right)=m-1$, and $F_{k+1}$ is odd. Therefore we get $\nu\left(F_{k}^{2}\right)=$ $2(m-1)>(m-1)+1=\nu\left(2 F_{k} F_{k+1}\right)$, which implies $\nu\left(F_{2 k}\right)=m$, establishing statement (a).

Moreover, since $F_{k+1}=1+2^{m-2}+a 2^{m-1}$ for some integer $a$, we get

$$
F_{2 k+1}=F_{k}^{2}+F_{k+1}^{2} \equiv 0+\left(1+2^{m-2}+a 2^{m-1}\right)^{2} \equiv 1+2^{m-1} \quad\left(\bmod 2^{m}\right),
$$

as desired in statement (c).\\
We are left to prove that $2^{m} \nmid F_{\ell}$ for $\ell<2 k$. Assume the contrary. Since $2^{m-1} \mid F_{\ell}$, from the induction hypothesis it follows that $\ell>k$. But then we have $F_{\ell}=F_{k-1} F_{\ell-k}+F_{k} F_{\ell-k+1}$, where the second summand is divisible by $2^{m-1}$ but the first one is not (since $F_{k-1}$ is odd and $\ell-k<k$ ). Hence the sum is not divisible even by $2^{m-1}$. A contradiction.

Now, for every pair of integers $(a, b) \neq(0,0)$, let $\mu(a, b)=\min \{\nu(a), \nu(b)\}$. By an obvious induction, for every Fibonacci-type sequence $A=\left(a_{0}, a_{1}, \ldots\right)$ we have $\mu\left(a_{0}, a_{1}\right)=\mu\left(a_{1}, a_{2}\right)=\ldots$; denote this common value by $\mu(A)$. Also denote by $p_{n}(A)$ the period of this sequence modulo $2^{n}$, that is, the least $p>0$ such that $a_{k+p} \equiv a_{k}\left(\bmod 2^{n}\right)$ for all $k \geq 0$.\\
Lemma 3. Let $A=\left(a_{0}, a_{1}, \ldots\right)$ be a Fibonacci-type sequence such that $\mu(A)=k<n$. Then $p_{n}(A)=3 \cdot 2^{n-1-k}$.\\
Proof. First, we note that the sequence $\left(a_{0}, a_{1}, \ldots\right)$ has period $p$ modulo $2^{n}$ if and only if the sequence $\left(a_{0} / 2^{k}, a_{1} / 2^{k}, \ldots\right)$ has period $p$ modulo $2^{n-k}$. Hence, passing to this sequence we can assume that $k=0$.

We prove the statement by induction on $n$. It is easy to see that for $n=1,2$ the claim is true; actually, each Fibonacci-type sequence $A$ with $\mu(A)=0$ behaves as $0,1,1,0,1,1, \ldots$ modulo 2 , and as $0,1,1,2,3,1,0,1,1,2,3,1, \ldots$ modulo 4 (all pairs of residues from which at least one is odd appear as a pair of consecutive terms in this sequence).

Now suppose that $n \geq 3$ and consider an arbitrary Fibonacci-type sequence $A=\left(a_{0}, a_{1}, \ldots\right)$ with $\mu(A)=0$. Obviously we should have $p_{n-1}(A) \mid p_{n}(A)$, or, using the induction hypothesis, $s=3 \cdot 2^{n-2} \mid p_{n}(A)$. Next, we may suppose that $a_{0}$ is even; hence $a_{1}$ is odd, and $a_{0}=2 b_{0}$, $a_{1}=2 b_{1}+1$ for some integers $b_{0}, b_{1}$.

Consider the Fibonacci-type sequence $B=\left(b_{0}, b_{1}, \ldots\right)$ starting with $\left(b_{0}, b_{1}\right)$. Since $a_{0}=$ $2 b_{0}+F_{0}, a_{1}=2 b_{1}+F_{1}$, by an easy induction we get $a_{k}=2 b_{k}+F_{k}$ for all $k \geq 0$. By the induction hypothesis, we have $p_{n-1}(B) \mid s$, hence the sequence $\left(2 b_{0}, 2 b_{1}, \ldots\right)$ is $s$-periodic modulo $2^{n}$. On the other hand, by Lemma 2 we have $F_{s+1} \equiv 1+2^{n-1}\left(\bmod 2^{n}\right), F_{2 s} \equiv 0$ $\left(\bmod 2^{n}\right), F_{2 s+1} \equiv 1\left(\bmod 2^{n}\right)$, hence

$$
\begin{gathered}
a_{s+1}=2 b_{s+1}+F_{s+1} \equiv 2 b_{1}+1+2^{n-1} \not \equiv 2 b_{1}+1=a_{1} \quad\left(\bmod 2^{n}\right), \\
a_{2 s}=2 b_{2 s}+F_{2 s} \equiv 2 b_{0}+0=a_{0} \quad\left(\bmod 2^{n}\right) \\
a_{2 s+1}=2 b_{2 s+1}+F_{2 s+1} \equiv 2 b_{1}+1=a_{1} \quad\left(\bmod 2^{n}\right) .
\end{gathered}
$$

The first line means that $A$ is not $s$-periodic, while the other two provide that $a_{2 s} \equiv a_{0}$, $a_{2 s+1} \equiv a_{1}$ and hence $a_{2 s+t} \equiv a_{t}$ for all $t \geq 0$. Hence $s\left|p_{n}(A)\right| 2 s$ and $p_{n}(A) \neq s$, which means that $p_{n}(A)=2 s$, as desired.

Finally, Lemma 3 provides a straightforward method of counting the number of cycles. Actually, take any number $0 \leq k \leq n-1$ and consider all the cells $(i, j)$ with $\mu(i, j)=k$. The total number of such cells is $2^{2(n-k)}-2^{2(n-k-1)}=3 \cdot 2^{2 n-2 k-2}$. On the other hand, they are split into cycles, and by Lemma 3 the length of each cycle is $3 \cdot 2^{n-1-k}$. Hence the number of cycles consisting of these cells is exactly $\frac{3 \cdot 2^{2 n-2 k-2}}{3 \cdot 2^{n-1-k}}=2^{n-k-1}$. Finally, there is only one cell $(0,0)$ which is not mentioned in the previous computation, and it forms a separate cycle. So the total number of cycles is

$$
1+\sum_{k=0}^{n-1} 2^{n-1-k}=1+\left(1+2+4+\cdots+2^{n-1}\right)=2^{n}
$$

Comment. We outline a different proof for the essential part of Lemma 3. That is, we assume that $k=0$ and show that in this case the period of $\left(a_{i}\right)$ modulo $2^{n}$ coincides with the period of the Fibonacci numbers modulo $2^{n}$; then the proof can be finished by the arguments from Lemma 2 ..

Note that $p$ is a (not necessarily minimal) period of the sequence $\left(a_{i}\right)$ modulo $2^{n}$ if and only if we have $a_{0} \equiv a_{p}\left(\bmod 2^{n}\right), a_{1} \equiv a_{p+1}\left(\bmod 2^{n}\right)$, that is,


\begin{align*}
& a_{0} \equiv a_{p} \equiv F_{p-1} a_{0}+F_{p} a_{1}=F_{p}\left(a_{1}-a_{0}\right)+F_{p+1} a_{0} \quad\left(\bmod 2^{n}\right) \\
& a_{1} \equiv a_{p+1}=F_{p} a_{0}+F_{p+1} a_{1} \quad\left(\bmod 2^{n}\right) \tag{1}
\end{align*}


Now, If $p$ is a period of $\left(F_{i}\right)$ then we have $F_{p} \equiv F_{0}=0\left(\bmod 2^{n}\right)$ and $F_{p+1} \equiv F_{1}=1\left(\bmod 2^{n}\right)$, which by (1) implies that $p$ is a period of $\left(a_{i}\right)$ as well.

Conversely, suppose that $p$ is a period of $\left(a_{i}\right)$. Combining the relations of (1) we get

$$
\begin{aligned}
0=a_{1} \cdot a_{0}-a_{0} \cdot a_{1} & \equiv a_{1}\left(F_{p}\left(a_{1}-a_{0}\right)+F_{p+1} a_{0}\right)-a_{0}\left(F_{p} a_{0}+F_{p+1} a_{1}\right) \\
& =F_{p}\left(a_{1}^{2}-a_{1} a_{0}-a_{0}^{2}\right) \quad\left(\bmod 2^{n}\right) \\
a_{1}^{2}-a_{1} a_{0}-a_{0}^{2}=\left(a_{1}-a_{0}\right) a_{1}-a_{0} \cdot a_{0} & \equiv\left(a_{1}-a_{0}\right)\left(F_{p} a_{0}+F_{p+1} a_{1}\right)-a_{0}\left(F_{p}\left(a_{1}-a_{0}\right)+F_{p+1} a_{0}\right) \\
& =F_{p+1}\left(a_{1}^{2}-a_{1} a_{0}-a_{0}^{2}\right) \quad\left(\bmod 2^{n}\right) .
\end{aligned}
$$

Since at least one of the numbers $a_{0}, a_{1}$ is odd, the number $a_{1}^{2}-a_{1} a_{0}-a_{0}^{2}$ is odd as well. Therefore the previous relations are equivalent with $F_{p} \equiv 0\left(\bmod 2^{n}\right)$ and $F_{p+1} \equiv 1\left(\bmod 2^{n}\right)$, which means exactly that $p$ is a period of $\left(F_{0}, F_{1}, \ldots\right)$ modulo $2^{n}$.

So, the sets of periods of $\left(a_{i}\right)$ and $\left(F_{i}\right)$ coincide, and hence the minimal periods coincide as well.",4,"Relate the maximum number of colors to the number of cycles in a specific directed graph, and show that these cycles correspond to periodic Fibonacci-type sequences modulo $2^n$.","The problem states that cell $(i, j)$ has the same color as cell $(j, i+j \pmod{2^n})$. We can model this with a directed graph where the vertices are the cells $(i,j)$ and edges are $(i, j) \to (j, i+j \pmod{2^n})$. The transformation is a permutation of the cells, so the graph decomposes into disjoint cycles. The coloring condition implies all cells in a cycle must have the same color. Thus, the maximum number of colors is the number of cycles. A cycle starting at $(a_0, a_1)$ consists of cells $(a_{k-1}, a_k \pmod{2^n})$ for $k \ge 1$, where $a_{k+1} = a_k + a_{k-1}$, which is a periodic Fibonacci-type sequence modulo $2^n$.","Let $A = (a_0, a_1, \dots)$ be a Fibonacci-type sequence. Let $\nu(m)$ be the exponent of 2 in the prime factorization of $m$, and let $k = \\min(\nu(a_0), \nu(a_1))$. For $k < n$, determine the period of sequence $A$ modulo $2^n$ in terms of $n$ and $k$.","The period $p$ of a Fibonacci-type sequence $A=(a_0, a_1, \dots)$ modulo $2^n$ depends on $k = \\min(\nu(a_0), \nu(a_1))$. The sequence $(a_i/2^k)$ modulo $2^{n-k}$ has $\\min(\nu(a_0/2^k), \nu(a_1/2^k))=0$ and its period is the same as $A$'s period. For the case $k=0$, the period of $(a_i)$ is the same as the period of the standard Fibonacci sequence $(F_i)$, which can be shown to be $3 \\cdot 2^{n-1}$ for $n \\ge 1$. Therefore, for a general $k<n$, the period of sequence $A$ modulo $2^n$ is $3 \\cdot 2^{n-1-k}$.","Using the period length, calculate the number of distinct cycles formed by the cells $(i, j)$ for which $\\min(\nu(i), \nu(j)) = k$, for a fixed integer $k$ where $0 \\le k < n$.","For a fixed $k \\in \\{0, \\dots, n-1\\}$, we count the cells $(i,j)$ where $\\min(\nu(i), \nu(j))=k$. The number of such cells is the number of pairs $(i,j)$ where $i,j$ are divisible by $2^k$ minus the number where they are both divisible by $2^{k+1}$. This gives $(2^{n-k})^2 - (2^{n-k-1})^2 = 3 \\cdot 2^{2n-2k-2}$ cells. From the previous sub-problem, the length of each cycle containing these cells is $3 \\cdot 2^{n-1-k}$. Thus, the number of such cycles is $\frac{3 \\cdot 2^{2n-2k-2}}{3 \\cdot 2^{n-1-k}} = 2^{n-k-1}$.",Prove that the maximal possible number of colors is $2^{n}$.,"The maximum number of colors equals the total number of cycles. The cell $(0,0)$ forms a single cycle. For each $k$ from $0$ to $n-1$, there are $2^{n-k-1}$ cycles formed by cells $(i,j)$ with $\\min(\nu(i),\nu(j))=k$. Summing these up gives the total number of cycles: $1 + \\sum_{k=0}^{n-1} 2^{n-k-1} = 1 + (2^{n-1} + 2^{n-2} + \\dots + 2^0) = 1 + (2^n-1) = 2^n$. Therefore, the maximal possible number of colors is $2^n$."
2009a2,"Let $a, b, c$ be positive real numbers such that $\frac{1}{a}+\frac{1}{b}+\frac{1}{c}=a+b+c$. Prove that

$$
\frac{1}{(2 a+b+c)^{2}}+\frac{1}{(2 b+c+a)^{2}}+\frac{1}{(2 c+a+b)^{2}} \leq \frac{3}{16} .
$$","For positive real numbers $x, y, z$, from the arithmetic-geometric-mean inequality,

$$
2 x+y+z=(x+y)+(x+z) \geq 2 \sqrt{(x+y)(x+z)},
$$

we obtain

$$
\frac{1}{(2 x+y+z)^{2}} \leq \frac{1}{4(x+y)(x+z)}
$$

Applying this to the left-hand side terms of the inequality to prove, we get


\begin{align*}
\frac{1}{(2 a+b+c)^{2}} & +\frac{1}{(2 b+c+a)^{2}}+\frac{1}{(2 c+a+b)^{2}} \\
& \leq \frac{1}{4(a+b)(a+c)}+\frac{1}{4(b+c)(b+a)}+\frac{1}{4(c+a)(c+b)} \\
& =\frac{(b+c)+(c+a)+(a+b)}{4(a+b)(b+c)(c+a)}=\frac{a+b+c}{2(a+b)(b+c)(c+a)} . \tag{1}
\end{align*}


A second application of the inequality of the arithmetic-geometric mean yields

$$
a^{2} b+a^{2} c+b^{2} a+b^{2} c+c^{2} a+c^{2} b \geq 6 a b c
$$

or, equivalently,


\begin{equation*}
9(a+b)(b+c)(c+a) \geq 8(a+b+c)(a b+b c+c a) . \tag{2}
\end{equation*}


The supposition $\frac{1}{a}+\frac{1}{b}+\frac{1}{c}=a+b+c$ can be written as


\begin{equation*}
a b+b c+c a=a b c(a+b+c) . \tag{3}
\end{equation*}


Applying the arithmetic-geometric-mean inequality $x^{2} y^{2}+x^{2} z^{2} \geq 2 x^{2} y z$ thrice, we get

$$
a^{2} b^{2}+b^{2} c^{2}+c^{2} a^{2} \geq a^{2} b c+a b^{2} c+a b c^{2}
$$

which is equivalent to


\begin{equation*}
(a b+b c+c a)^{2} \geq 3 a b c(a+b+c) \tag{4}
\end{equation*}


Combining (1), (2), (3), and (4), we will finish the proof:

$$
\begin{aligned}
\frac{a+b+c}{2(a+b)(b+c)(c+a)} & =\frac{(a+b+c)(a b+b c+c a)}{2(a+b)(b+c)(c+a)} \cdot \frac{a b+b c+c a}{a b c(a+b+c)} \cdot \frac{a b c(a+b+c)}{(a b+b c+c a)^{2}} \\
& \leq \frac{9}{2 \cdot 8} \cdot 1 \cdot \frac{1}{3}=\frac{3}{16}
\end{aligned}
$$",2,"For positive real numbers $a, b, c$, prove that $\frac{1}{(2a+b+c)^2} + \frac{1}{(2b+c+a)^2} + \frac{1}{(2c+a+b)^2} \leq \frac{a+b+c}{2(a+b)(b+c)(c+a)}$.","By the Arithmetic Mean-Geometric Mean inequality, for positive real numbers $x, y, z$, we have $2x+y+z = (x+y)+(x+z) \geq 2\sqrt{(x+y)(x+z)}$. Squaring and taking the reciprocal gives $\frac{1}{(2x+y+z)^2} \leq \frac{1}{4(x+y)(x+z)}$. Applying this inequality for $(x,y,z)$ as cyclic permutations of $(a,b,c)$ and summing them up, we get:\n$\sum_{cyc} \frac{1}{(2a+b+c)^2} \leq \frac{1}{4(a+b)(a+c)} + \frac{1}{4(b+c)(b+a)} + \frac{1}{4(c+a)(c+b)} = \frac{(b+c)+(c+a)+(a+b)}{4(a+b)(b+c)(c+a)} = \frac{2(a+b+c)}{4(a+b)(b+c)(c+a)} = \frac{a+b+c}{2(a+b)(b+c)(c+a)}$.","Let $a, b, c$ be positive real numbers such that $\frac{1}{a}+\frac{1}{b}+\frac{1}{c}=a+b+c$. Prove that $\frac{1}{(2 a+b+c)^{2}}+\frac{1}{(2 b+c+a)^{2}}+\frac{1}{(2 c+a+b)^{2}} \leq \frac{3}{16}$.","From the first sub-problem, we know the left-hand side is less than or equal to $\frac{a+b+c}{2(a+b)(b+c)(c+a)}$. The given condition $\frac{1}{a}+\frac{1}{b}+\frac{1}{c}=a+b+c$ is equivalent to $ab+bc+ca=abc(a+b+c)$. We use two inequalities: (1) $9(a+b)(b+c)(c+a) \geq 8(a+b+c)(ab+bc+ca)$ and (2) $(ab+bc+ca)^2 \geq 3abc(a+b+c)$. We can rewrite our expression and apply these bounds: \begin{align*} \frac{a+b+c}{2(a+b)(b+c)(c+a)} &= \frac{(a+b+c)(ab+bc+ca)}{2(a+b)(b+c)(c+a)} \cdot \frac{ab+bc+ca}{abc(a+b+c)} \cdot \frac{abc(a+b+c)}{(ab+bc+ca)^2} \\ &\leq \left(\frac{1}{2} \cdot \frac{9}{8}\right) \cdot (1) \cdot \left(\frac{1}{3}\right) = \frac{3}{16} \end{align*} Here, the first factor is bounded using inequality (1), the second factor is 1 by the given condition, and the third factor is bounded using inequality (2).",,,,
2009a4,"Let $a, b, c$ be positive real numbers such that $a b+b c+c a \leq 3 a b c$. Prove that

$$
\sqrt{\frac{a^{2}+b^{2}}{a+b}}+\sqrt{\frac{b^{2}+c^{2}}{b+c}}+\sqrt{\frac{c^{2}+a^{2}}{c+a}}+3 \leq \sqrt{2}(\sqrt{a+b}+\sqrt{b+c}+\sqrt{c+a}) .
$$","Solution. Starting with the terms of the right-hand side, the quadratic-arithmetic-mean inequality yields

$$
\begin{aligned}
\sqrt{2} \sqrt{a+b} & =2 \sqrt{\frac{a b}{a+b}} \sqrt{\frac{1}{2}\left(2+\frac{a^{2}+b^{2}}{a b}\right)} \\
& \geq 2 \sqrt{\frac{a b}{a+b}} \cdot \frac{1}{2}\left(\sqrt{2}+\sqrt{\frac{a^{2}+b^{2}}{a b}}\right)=\sqrt{\frac{2 a b}{a+b}}+\sqrt{\frac{a^{2}+b^{2}}{a+b}}
\end{aligned}
$$

and, analogously,

$$
\sqrt{2} \sqrt{b+c} \geq \sqrt{\frac{2 b c}{b+c}}+\sqrt{\frac{b^{2}+c^{2}}{b+c}}, \quad \sqrt{2} \sqrt{c+a} \geq \sqrt{\frac{2 c a}{c+a}}+\sqrt{\frac{c^{2}+a^{2}}{c+a}} .
$$

Applying the inequality between the arithmetic mean and the squared harmonic mean will finish the proof:

$$\sqrt{\frac{2 a b}{a+b}}+\sqrt{\frac{2 b c}{b+c}}+\sqrt{\frac{2 c a}{c+a}} \geq 3 \cdot \sqrt{\frac{3}{{\sqrt{\frac{a+b}{2 a b}^2}+\sqrt{\frac{b+c}{2 b c}}+\sqrt{\frac{c+a}{2 c a}}}^2}}=3 \cdot \sqrt{\frac{3 a b c}{a b+b c+c a}} \geq 3 $$",1,"Let $a, b, c$ be positive real numbers such that $a b+b c+c a \leq 3 a b c$. Prove that

$$
\sqrt{\frac{a^{2}+b^{2}}{a+b}}+\sqrt{\frac{b^{2}+c^{2}}{b+c}}+\sqrt{\frac{c^{2}+a^{2}}{c+a}}+3 \leq \sqrt{2}(\sqrt{a+b}+\sqrt{b+c}+\sqrt{c+a}) .
$$","Solution. Starting with the terms of the right-hand side, the quadratic-arithmetic-mean inequality yields

$$
\begin{aligned}
\sqrt{2} \sqrt{a+b} & =2 \sqrt{\frac{a b}{a+b}} \sqrt{\frac{1}{2}\left(2+\frac{a^{2}+b^{2}}{a b}\right)} \\
& \geq 2 \sqrt{\frac{a b}{a+b}} \cdot \frac{1}{2}\left(\sqrt{2}+\sqrt{\frac{a^{2}+b^{2}}{a b}}\right)=\sqrt{\frac{2 a b}{a+b}}+\sqrt{\frac{a^{2}+b^{2}}{a+b}}
\end{aligned}
$$

and, analogously,

$$
\sqrt{2} \sqrt{b+c} \geq \sqrt{\frac{2 b c}{b+c}}+\sqrt{\frac{b^{2}+c^{2}}{b+c}}, \quad \sqrt{2} \sqrt{c+a} \geq \sqrt{\frac{2 c a}{c+a}}+\sqrt{\frac{c^{2}+a^{2}}{c+a}} .
$$

Applying the inequality between the arithmetic mean and the squared harmonic mean will finish the proof:

$$\sqrt{\frac{2 a b}{a+b}}+\sqrt{\frac{2 b c}{b+c}}+\sqrt{\frac{2 c a}{c+a}} \geq 3 \cdot \sqrt{\frac{3}{{\sqrt{\frac{a+b}{2 a b}^2}+\sqrt{\frac{b+c}{2 b c}}+\sqrt{\frac{c+a}{2 c a}}}^2}}=3 \cdot \sqrt{\frac{3 a b c}{a b+b c+c a}} \geq 3 $$",,,,,,
2009a5,"Let $f$ be any function that maps the set of real numbers into the set of real numbers. Prove that there exist real numbers $x$ and $y$ such that

$$
f(x-f(y))>y f(x)+x .
$$","Assume that

\begin{equation*}
f(x-f(y)) \leq y f(x)+x \quad \text { for all real } x, y \tag{1}
\end{equation*}

Let $a=f(0)$. Setting $y=0$ in (1) gives $f(x-a) \leq x$ for all real $x$ and, equivalently,

\begin{equation*}
f(y) \leq y+a \quad \text { for all real } y \tag{2}
\end{equation*}

Setting $x=f(y)$ in (1) yields in view of (2)

$$
a=f(0) \leq y f(f(y))+f(y) \leq y f(f(y))+y+a
$$

This implies $0 \leq y(f(f(y))+1)$ and thus

\begin{equation*}
f(f(y)) \geq-1 \quad \text { for all } y>0 \tag{3}
\end{equation*}

From (2) and (3) we obtain $-1 \leq f(f(y)) \leq f(y)+a$ for all $y>0$, so

\begin{equation*}
f(y) \geq-a-1 \quad \text { for all } y>0 \tag{4}
\end{equation*}

Now we show that

\begin{equation*}
f(x) \leq 0 \quad \text { for all real } x \tag{5}
\end{equation*}

Assume the contrary, i.e. there is some $x$ such that $f(x)>0$. Take any $y$ such that

$$
y<x-a \quad \text { and } \quad y<\frac{-a-x-1}{f(x)}
$$

Then in view of (2)

$$
x-f(y) \geq x-(y+a)>0
$$

and with (1) and (4) we obtain

$$
y f(x)+x \geq f(x-f(y)) \geq-a-1,
$$

whence

$$
y \geq \frac{-a-x-1}{f(x)}
$$

contrary to our choice of $y$. Thereby, we have established (5).\\
Setting $x=0$ in (5) leads to $a=f(0) \leq 0$ and (2) then yields

\begin{equation*}
f(x) \leq x \quad \text { for all real } x \tag{6}
\end{equation*}

Now choose $y$ such that $y>0$ and $y>-f(-1)-1$ and set $x=f(y)-1$. From (1), (5) and\\
(6) we obtain

$$
f(-1)=f(x-f(y)) \leq y f(x)+x=y f(f(y)-1)+f(y)-1 \leq y(f(y)-1)-1 \leq-y-1,
$$

i.e. $y \leq-f(-1)-1$, a contradiction to the choice of $y$.",3,"Assume for contradiction that $f(x-f(y)) \leq y f(x)+x$ for all $x, y$. Let $a = f(0)$. Prove that for all real numbers $y$, $f(y) \leq y+a$, and for all $y>0$, $f(y) \geq -a-1$.","Let $a=f(0)$. Setting $y=0$ in the assumed inequality gives $f(x-a) \leq x$, so by a change of variable, $f(y) \leq y+a$ for all $y$. Now, setting $x=f(y)$ in the assumption gives $a = f(0) \leq y f(f(y)) + f(y)$. Using the first result, we have $a \leq y f(f(y)) + y+a$, which implies $0 \leq y(f(f(y))+1)$. For $y>0$, this means $f(f(y)) \geq -1$. Combining this with $f(f(y)) \leq f(y)+a$ gives $-1 \leq f(y)+a$, so $f(y) \geq -a-1$ for $y>0$.","Assuming $f(x-f(y)) \leq y f(x)+x$ for all $x, y$, prove that $f(x) \leq 0$ for all real $x$.","Assume for contradiction there is an $x_0$ with $f(x_0)>0$. Let $a=f(0)$. From the bounds established in sub-problem 1, we know $f(y) \leq y+a$ and $f(z) \geq -a-1$ for $z>0$. Choose $y$ such that $y < x_0-a$ and $y < (-a-x_0-1)/f(x_0)$. Then $x_0-f(y) \geq x_0-(y+a)>0$. Using the assumed inequality at $x_0$ and the derived bounds, we have $y f(x_0)+x_0 \geq f(x_0-f(y)) \geq -a-1$. Since $f(x_0)>0$, this implies $y \geq (-a-x_0-1)/f(x_0)$, a contradiction. Therefore, $f(x) \leq 0$ for all $x$.",Let $f$ be any function that maps the set of real numbers into the set of real numbers. Prove that there exist real numbers $x$ and $y$ such that $f(x-f(y))>y f(x)+x$.,"Assume for contradiction that $f(x-f(y)) \leq y f(x)+x$ for all $x, y$. From the previous sub-problem, this implies $f(x) \leq 0$ for all $x$. This also implies $a=f(0)\leq0$. The bound $f(z) \leq z+a$ becomes $f(z) \leq z$. Choose $y$ such that $y>0$ and $y > -f(-1)-1$. Let $x=f(y)-1$. The assumption gives $f(x-f(y)) \leq y f(x)+x$, so $f(-1) \leq y f(f(y)-1)+f(y)-1$. Using $f(z)\leq z$ and $f(z)\leq 0$, we get $f(-1) \leq y(f(y)-1)+f(y)-1 = (y+1)f(y)-y-1 \leq -y-1$. This implies $y \leq -f(-1)-1$, which contradicts the choice of $y$. Thus, the assumption is false.",,
2009a6,"Suppose that $s_{1}, s_{2}, s_{3}, \ldots$ is a strictly increasing sequence of positive integers such that the subsequences

$$
s_{s_{1}}, s_{s_{2}}, s_{s_{3}}, \ldots \quad \text { and } \quad s_{s_{1}+1}, s_{s_{2}+1}, s_{s_{3}+1}, \ldots
$$

are both arithmetic progressions. Prove that $s_{1}, s_{2}, s_{3}, \ldots$ is itself an arithmetic progression.","Let $D$ be the common difference of the progression $s_{s_{1}}, s_{s_{2}}, \ldots$. Let for $n=$ $1,2, \ldots$

$$
d_{n}=s_{n+1}-s_{n} .
$$

We have to prove that $d_{n}$ is constant. First we show that the numbers $d_{n}$ are bounded. Indeed, by supposition $d_{n} \geq 1$ for all $n$. Thus, we have for all $n$

$$
d_{n}=s_{n+1}-s_{n} \leq d_{s_{n}}+d_{s_{n}+1}+\cdots+d_{s_{n+1}-1}=s_{s_{n+1}}-s_{s_{n}}=D .
$$

The boundedness implies that there exist

$$
m=\min \left\{d_{n}: n=1,2, \ldots\right\} \quad \text { and } \quad M=\max \left\{d_{n}: n=1,2, \ldots\right\} .
$$

It suffices to show that $m=M$. Assume that $m<M$. Choose $n$ such that $d_{n}=m$. Considering a telescoping sum of $m=d_{n}=s_{n+1}-s_{n}$ items not greater than $M$ leads to


\begin{equation*}
D=s_{s_{n+1}}-s_{s_{n}}=s_{s_{n}+m}-s_{s_{n}}=d_{s_{n}}+d_{s_{n}+1}+\cdots+d_{s_{n}+m-1} \leq m M \tag{1}
\end{equation*}


and equality holds if and only if all items of the sum are equal to $M$. Now choose $n$ such that $d_{n}=M$. In the same way, considering a telescoping sum of $M$ items not less than $m$ we obtain


\begin{equation*}
D=s_{s_{n+1}}-s_{s_{n}}=s_{s_{n}+M}-s_{s_{n}}=d_{s_{n}}+d_{s_{n}+1}+\cdots+d_{s_{n}+M-1} \geq M m \tag{2}
\end{equation*}


and equality holds if and only if all items of the sum are equal to $m$. The inequalities (1) and (2) imply that $D=M m$ and that

$$
\begin{array}{cl}
d_{s_{n}}=d_{s_{n}+1}=\cdots=d_{s_{n+1}-1}=M & \text { if } d_{n}=m, \\
d_{s_{n}}=d_{s_{n}+1}=\cdots=d_{s_{n+1}-1}=m & \text { if } d_{n}=M .
\end{array}
$$

Hence, $d_{n}=m$ implies $d_{s_{n}}=M$. Note that $s_{n} \geq s_{1}+(n-1) \geq n$ for all $n$ and moreover $s_{n}>n$ if $d_{n}=n$, because in the case $s_{n}=n$ we would have $m=d_{n}=d_{s_{n}}=M$ in contradiction to the assumption $m<M$. In the same way $d_{n}=M$ implies $d_{s_{n}}=m$ and $s_{n}>n$. Consequently, there is a strictly increasing sequence $n_{1}, n_{2}, \ldots$ such that

$$
d_{s_{n_{1}}}=M, \quad d_{s_{n_{2}}}=m, \quad d_{s_{n_{3}}}=M, \quad d_{s_{n_{4}}}=m, \quad \ldots
$$

The sequence $d_{s_{1}}, d_{s_{2}}, \ldots$ is the sequence of pairwise differences of $s_{s_{1}+1}, s_{s_{2}+1}, \ldots$ and $s_{s_{1}}, s_{s_{2}}, \ldots$, hence also an arithmetic progression. Thus $m=M$.",3,Let $d_n = s_{n+1} - s_n$. Let $D$ be the common difference of the arithmetic progression $\{s_{s_n}\}_{n \\ge 1}$. Show that the sequence $\{d_n\}$ is bounded.,"Since $\{s_n\}$ is a strictly increasing sequence of positive integers, $d_n = s_{n+1} - s_n \\ge 1$ for all $n$. The common difference of $\{s_{s_n}\}$ is $D = s_{s_{n+1}} - s_{s_n}$. We can express this difference as a sum: $D = \\sum_{i=s_n}^{s_{n+1}-1} (s_{i+1} - s_i) = \\sum_{i=s_n}^{s_{n+1}-1} d_i$. The number of terms in this sum is $s_{n+1} - s_n = d_n$. Since each $d_i \\ge 1$, we have $D = \\sum_{i=s_n}^{s_{n+1}-1} d_i \\ge d_n \\cdot 1 = d_n$. Thus, for all $n$, $1 \\le d_n \\le D$, so the sequence $\{d_n\}$ is bounded.","Let $m = \\min\\{d_n\\}$ and $M = \\max\\{d_n\\}$. Show that the sequence $\{d_{s_n}\}_{n \\ge 1}$ is an arithmetic progression and that $D = mM$, where $D$ is the common difference of $\{s_{s_n}\}$.","Let $\{s_{s_n}\}$ and $\{s_{s_n+1}\}$ be arithmetic progressions with common differences $D$ and $D'$, respectively. Their difference sequence, $\{s_{s_n+1} - s_{s_n}\}_{n \\ge 1} = \{d_{s_n}\}_{n \\ge 1}$, is also an arithmetic progression. Let $k$ be an index such that $d_k=m$. Then $D = s_{s_{k+1}} - s_{s_k} = s_{s_k+m} - s_{s_k} = \\sum_{i=s_k}^{s_k+m-1} d_i$. Since each $d_i \\le M$, we have $D \\le mM$. Let $j$ be an index such that $d_j=M$. Then $D = s_{s_{j+1}} - s_{s_j} = s_{s_j+M} - s_{s_j} = \\sum_{i=s_j}^{s_j+M-1} d_i$. Since each $d_i \\ge m$, we have $D \\ge Mm$. Combining these gives $D = mM$.","Prove that $s_{1}, s_{2}, s_{3}, \\ldots$ is itself an arithmetic progression.","From sub-problem 2, $\{d_{s_n}\}$ is an arithmetic progression. From sub-problem 1, $\{d_n\}$ is bounded, so it takes a finite set of values. Thus, $\{d_{s_n}\}$ also takes a finite set of values. An arithmetic progression that takes on a finite number of values must be constant. So, $d_{s_n}=c$ for some constant $c$. Assume for contradiction that $\{s_n\}$ is not an AP, so $m < M$. From the proof of $D=mM$ in sub-problem 2, for an index $k$ with $d_k=m$, the equality $D=mM$ implies $d_{s_k}=d_{s_k+1}=\\dots=d_{s_k+m-1}=M$. In particular, $d_{s_k}=M$. Similarly, for an index $j$ with $d_j=M$, we must have $d_{s_j}=m$. Thus the sequence $\{d_{s_n}\}$ takes at least two distinct values, $M$ and $m$. This contradicts that $\{d_{s_n}\}$ is constant. Therefore, the assumption $m < M$ is false. We must have $m=M$, which means $d_n$ is constant, and $\{s_n\}$ is an arithmetic progression.",,
2009c3,"Let $n$ be a positive integer. Given a sequence $\varepsilon_{1}, \ldots, \varepsilon_{n-1}$ with $\varepsilon_{i}=0$ or $\varepsilon_{i}=1$ for each $i=1, \ldots, n-1$, the sequences $a_{0}, \ldots, a_{n}$ and $b_{0}, \ldots, b_{n}$ are constructed by the following rules:

$$
\begin{gathered}
a_{0}=b_{0}=1, \quad a_{1}=b_{1}=7, \\
a_{i+1}=\left\{\begin{array}{ll}
2 a_{i-1}+3 a_{i}, & \text { if } \varepsilon_{i}=0, \\
3 a_{i-1}+a_{i}, & \text { if } \varepsilon_{i}=1,
\end{array} \text { for each } i=1, \ldots, n-1,\right. \\
b_{i+1}=\left\{\begin{array}{ll}
2 b_{i-1}+3 b_{i}, & \text { if } \varepsilon_{n-i}=0, \\
3 b_{i-1}+b_{i}, & \text { if } \varepsilon_{n-i}=1,
\end{array} \text { for each } i=1, \ldots, n-1 .\right.
\end{gathered}
$$

Prove that $a_{n}=b_{n}$.","Solution. For a binary word $w=\sigma_{1} \ldots \sigma_{n}$ of length $n$ and a letter $\sigma \in\{0,1\}$ let $w \sigma=$ $\sigma_{1} \ldots \sigma_{n} \sigma$ and $\sigma w=\sigma \sigma_{1} \ldots \sigma_{n}$. Moreover let $\bar{w}=\sigma_{n} \ldots \sigma_{1}$ and let $\emptyset$ be the empty word (of length 0 and with $\bar{\emptyset}=\emptyset$ ). Let $(u, v)$ be a pair of two real numbers. For binary words $w$ we define recursively the numbers $(u, v)^{w}$ as follows:

$$
\begin{gathered}
(u, v)^{\natural}=v, \quad(u, v)^{0}=2 u+3 v, \quad(u, v)^{1}=3 u+v, \\
(u, v)^{w \sigma \varepsilon}= \begin{cases}2(u, v)^{w}+3(u, v)^{w \sigma}, & \text { if } \varepsilon=0, \\
3(u, v)^{w}+(u, v)^{w \sigma}, & \text { if } \varepsilon=1 .\end{cases}
\end{gathered}
$$

It easily follows by induction on the length of $w$ that for all real numbers $u_{1}, v_{1}, u_{2}, v_{2}, \lambda_{1}$ and $\lambda_{2}$


\begin{equation*}
\left(\lambda_{1} u_{1}+\lambda_{2} u_{2}, \lambda_{1} v_{1}+\lambda_{2} v_{2}\right)^{w}=\lambda_{1}\left(u_{1}, v_{1}\right)^{w}+\lambda_{2}\left(u_{2}, v_{2}\right)^{w} \tag{1}
\end{equation*}


and that for $\varepsilon \in\{0,1\}$


\begin{equation*}
(u, v)^{\varepsilon w}=\left(v,(u, v)^{\varepsilon}\right)^{w} \text {. } \tag{2}
\end{equation*}


Obviously, for $n \geq 1$ and $w=\varepsilon_{1} \ldots \varepsilon_{n-1}$, we have $a_{n}=(1,7)^{w}$ and $b_{n}=(1,7)^{\bar{w}}$. Thus it is sufficient to prove that


\begin{equation*}
(1,7)^{w}=(1,7)^{\bar{w}} \tag{3}
\end{equation*}


for each binary word $w$. We proceed by induction on the length of $w$. The assertion is obvious if $w$ has length 0 or 1 . Now let $w \sigma \varepsilon$ be a binary word of length $n \geq 2$ and suppose that the assertion is true for all binary words of length at most $n-1$.\\
Note that $(2,1)^{\sigma}=7=(1,7)^{\emptyset}$ for $\sigma \in\{0,1\},(1,7)^{0}=23$, and $(1,7)^{1}=10$.\\
First let $\varepsilon=0$. Then in view of the induction hypothesis and the equalities (1) and (2), we obtain

$$
\begin{aligned}
&(1,7)^{w \sigma 0}=2(1,7)^{w}+3(1,7)^{w \sigma}=2(1,7)^{\bar{w}}+3(1,7)^{\sigma \bar{w}}=2(2,1)^{\sigma \bar{w}}+3(1,7)^{\sigma \bar{w}} \\
&=(7,23)^{\sigma \bar{w}}=(1,7)^{0 \sigma \bar{w}} .
\end{aligned}
$$

Now let $\varepsilon=1$. Analogously, we obtain

$$
\begin{aligned}
& (1,7)^{w \sigma 1}=3(1,7)^{w}+(1,7)^{w \sigma}=3(1,7)^{\bar{w}}+(1,7)^{\sigma \bar{w}}=3(2,1)^{\sigma \bar{w}}+(1,7)^{\sigma \bar{w}} \\
& =(7,10)^{\sigma \bar{w}}=(1,7)^{1 \sigma \bar{w}} .
\end{aligned}
$$

Thus the induction step is complete, (3) and hence also $a_{n}=b_{n}$ are proved.

Comment. The original solution uses the relation

$$
(1,7)^{\alpha \beta w}=\left((1,7)^{w},(1,7)^{\beta w}\right)^{\alpha}, \quad \alpha, \beta \in\{0,1\},
$$

which can be proved by induction on the length of $w$. Then (3) also follows by induction on the length of $w$ :

$$
(1,7)^{\alpha \beta w}=\left((1,7)^{w},(1,7)^{\beta w}\right)^{\alpha}=\left((1,7)^{\bar{w}},(1,7)^{\bar{w} \beta}\right)^{\alpha}=(1,7)^{\bar{w} \beta \alpha} .
$$

Here $w$ may be the empty word.",3,"Introduce a notation $(u,v)^w$ for a pair of numbers $(u,v)$ and a binary word $w$, and show that the original problem is equivalent to proving $(1,7)^w=(1,7)^{\bar{w}}$, where $w = \varepsilon_1 \ldots \varepsilon_{n-1}$ and $\bar{w}$ is the reverse of $w$.","Define a function on pairs of numbers and binary words as follows: $(u, v)^{\emptyset}=v$, $(u, v)^{0}=2u+3v$, $(u, v)^{1}=3u+v$, and for a word $w$ and bits $\sigma, \varepsilon$, let $(u, v)^{w \sigma \varepsilon}=2(u, v)^{w}+3(u, v)^{w \sigma}$ if $\varepsilon=0$, and $3(u, v)^{w}+(u, v)^{w \sigma}$ if $\varepsilon=1$. For the sequence $a_i$, we have $a_0=1, a_1=7$. The recurrence implies $a_{i+1}=(1,7)^{\varepsilon_1 \dots \varepsilon_i}$. For $i=n-1$, we get $a_n=(1,7)^{\varepsilon_1 \dots \varepsilon_{n-1}}$. The sequence $b_i$ follows the same recurrence but with the sequence of bits $\delta_i = \varepsilon_{n-i}$. Thus, $b_n=(1,7)^{\delta_1 \dots \delta_{n-1}}=(1,7)^{\varepsilon_{n-1} \dots \varepsilon_1}$. Letting $w=\varepsilon_1 \dots \varepsilon_{n-1}$, we have $\bar{w}=\varepsilon_{n-1} \dots \varepsilon_1$. The problem is thus equivalent to proving $(1,7)^w=(1,7)^{\bar{w}}$.","Prove the identity $(1,7)^u = (2,1)^{\sigma u}$ for any binary word $u$ and any $\sigma \in \{0,1\}$, using the notation defined in the first sub-problem.","First, establish the property $(x,y)^{\varepsilon z} = (y, (x,y)^\varepsilon)^z$ for any $\varepsilon \in \{0,1\}$ and word $z$. This is done by induction on the length of $z$. The base case $z=\emptyset$ is trivial. The inductive step follows directly from the recursive definition. Now, apply this property with $(x,y)=(2,1)$, $\varepsilon=\sigma$, and $z=u$. We get $(2,1)^{\sigma u} = (1, (2,1)^\sigma)^u$. By direct computation, $(2,1)^0 = 2(2)+3(1)=7$ and $(2,1)^1 = 3(2)+1=7$. Since $(2,1)^\sigma = 7$ for any $\sigma \in \{0,1\}$, we can substitute this value back, yielding $(2,1)^{\sigma u} = (1, 7)^u$, which proves the identity.","Let $n$ be a positive integer. Given a sequence $\varepsilon_{1}, \ldots, \varepsilon_{n-1}$ with $\varepsilon_{i}=0$ or $\varepsilon_{i}=1$ for each $i=1, \ldots, n-1$, the sequences $a_{0}, \ldots, a_{n}$ and $b_{0}, \ldots, b_{n}$ are constructed by the rules given in the problem. Prove that $a_{n}=b_{n}$.","From Sub-problem 1, we must prove $(1,7)^w=(1,7)^{\bar{w}}$ for $w=\varepsilon_1 \dots \varepsilon_{n-1}$. We use induction on the length of $w$. Base cases for length 0 and 1 are trivial. Assume the property holds for all words shorter than $w\sigma\varepsilon$. We need to show $(1,7)^{w\sigma\varepsilon}=(1,7)^{\overline{w\sigma\varepsilon}}=(1,7)^{\varepsilon\bar{\sigma}\bar{w}}$.\nCase $\varepsilon=0$: By definition, $(1,7)^{w\sigma 0}=2(1,7)^w+3(1,7)^{w\sigma}$. By I.H., this is $2(1,7)^{\bar{w}}+3(1,7)^{\bar{\sigma}\bar{w}}$. Using the identity from Sub-problem 2, $(1,7)^{\bar{w}}=(2,1)^{\bar{\sigma}\bar{w}}$, the expression becomes $2(2,1)^{\bar{\sigma}\bar{w}}+3(1,7)^{\bar{\sigma}\bar{w}}=(7,23)^{\bar{\sigma}\bar{w}}$. This is equal to $(1,7)^{0\bar{\sigma}\bar{w}}$ because $(1,7)^{0\bar{\sigma}\bar{w}}=(7,(1,7)^0)^{\bar{\sigma}\bar{w}}=(7,23)^{\bar{\sigma}\bar{w}}$.\nCase $\varepsilon=1$: A similar calculation shows $(1,7)^{w\sigma 1}=(7,10)^{\bar{\sigma}\bar{w}}=(1,7)^{1\bar{\sigma}\bar{w}}$. The induction is complete, thus $a_n=b_n$.",,
2009c7,"A grasshopper jumps along the real axis. He starts at point 0 and makes 2009 jumps to the right with lengths $1,2, \ldots, 2009$ in an arbitrary order. Let $M$ be a set of 2008 positive integers less than $1005 \cdot 2009$. Prove that the grasshopper can arrange his jumps in such a way that he never lands on a point from $M$.","We construct the set of landing points of the grasshopper.\\
Case 1. $M$ does not contain numbers divisible by 2009.\\
We fix the numbers $2009 k$ as landing points, $k=1,2, \ldots, 1005$. Consider the open intervals $I_{k}=(2009(k-1), 2009 k), k=1,2, \ldots, 1005$. We show that we can choose exactly one point outside of $M$ as a landing point in 1004 of these intervals such that all lengths from 1 to 2009 are realized. Since there remains one interval without a chosen point, the length 2009 indeed will appear. Each interval has length 2009, hence a new landing point in an interval yields with a length $d$ also the length $2009-d$. Thus it is enough to implement only the lengths from $D=\{1,2, \ldots, 1004\}$. We will do this in a greedy way. Let $n_{k}, k=1,2, \ldots, 1005$, be the number of elements of $M$ that belong to the interval $I_{k}$. We order these numbers in a decreasing way, so let $p_{1}, p_{2}, \ldots, p_{1005}$ be a permutation of $\{1,2, \ldots, 1005\}$ such that $n_{p_{1}} \geq n_{p_{2}} \geq \cdots \geq n_{p_{1005}}$. In $I_{p_{1}}$ we do not choose a landing point. Assume that landing points have already been chosen in the intervals $I_{p_{2}}, \ldots, I_{p_{m}}$ and the lengths $d_{2}, \ldots, d_{m}$ from $D$ are realized, $m=1, \ldots, 1004$. We show that there is some $d \in D \backslash\left\{d_{2}, \ldots, d_{m}\right\}$ that can be implemented with a new landing point in $I_{p_{m+1}}$. Assume the contrary. Then the $1004-(m-1)$ other lengths are obstructed by the $n_{p_{m+1}}$ points of $M$ in $I_{p_{m+1}}$. Each length $d$ can be realized by two landing points, namely $2009\left(p_{m+1}-1\right)+d$ and $2009 p_{m+1}-d$, hence


\begin{equation*}
n_{p_{m+1}} \geq 2(1005-m) . \tag{1}
\end{equation*}


Moreover, since $|M|=2008=n_{1}+\cdots+n_{1005}$,


\begin{equation*}
2008 \geq n_{p_{1}}+n_{p_{2}}+\cdots+n_{p_{m+1}} \geq(m+1) n_{p_{m+1}} . \tag{2}
\end{equation*}


Consequently, by (1) and (2),

$$
2008 \geq 2(m+1)(1005-m) .
$$

The right hand side of the last inequality obviously attains its minimum for $m=1004$ and this minimum value is greater than 2008, a contradiction.

Case 2. $M$ does contain a number $\mu$ divisible by 2009 .\\
By the pigeonhole principle there exists some $r \in\{1, \ldots, 2008\}$ such that $M$ does not contain numbers with remainder $r$ modulo 2009. We fix the numbers $2009(k-1)+r$ as landing points, $k=1,2, \ldots, 1005$. Moreover, $1005 \cdot 2009$ is a landing point. Consider the open intervals\\
$I_{k}=(2009(k-1)+r, 2009 k+r), k=1,2, \ldots, 1004$. Analogously to Case 1 , it is enough to show that we can choose in 1003 of these intervals exactly one landing point outside of $M \backslash\{\mu\}$ such that each of the lengths of $D=\{1,2, \ldots, 1004\} \backslash\{r\}$ are implemented. Note that $r$ and $2009-r$ are realized by the first and last jump and that choosing $\mu$ would realize these two differences again. Let $n_{k}, k=1,2, \ldots, 1004$, be the number of elements of $M \backslash\{\mu\}$ that belong to the interval $I_{k}$ and $p_{1}, p_{2}, \ldots, p_{1004}$ be a permutation of $\{1,2, \ldots, 1004\}$ such that $n_{p_{1}} \geq n_{p_{2}} \geq \cdots \geq n_{p_{1004}}$. With the same reasoning as in Case 1 we can verify that a greedy choice of the landing points in $I_{p_{2}}, I_{p_{3}}, \ldots, I_{p_{1004}}$ is possible. We only have to replace (1) by

$$
n_{p_{m+1}} \geq 2(1004-m)
$$

( $D$ has one element less) and (2) by

$$
2007 \geq n_{p_{1}}+n_{p_{2}}+\cdots+n_{p_{m+1}} \geq(m+1) n_{p_{m+1}} .
$$

Comment. The cardinality 2008 of $M$ in the problem is the maximum possible value. For $M=\{1,2, \ldots, 2009\}$, the grasshopper necessarily lands on a point from $M$.",4,Consider the case where M contains no integer divisible by 2009. Formulate a strategy for constructing a valid sequence of jumps by defining a specific structure for the landing points.,"We construct a set of landing points that avoids M. This set includes all points of the form $k \cdot 2009$ for $k=1, 2, \ldots, 1005$. By assumption, none of these are in M. This structure defines 1005 intervals of the form $I_k = ((k-1)2009, k \cdot 2009)$. We select one of these intervals to be traversed with a single jump of length 2009. In each of the other 1004 intervals, we place one additional landing point. Placing a point $(k-1)2009+d$ in interval $I_k$ creates jumps of lengths $d$ and $2009-d$. To obtain all required jump lengths, the set of these $d$ values must be $\{1, 2, \ldots, 1004\}$. The task reduces to showing that we can always choose these 1004 intermediate landing points to be outside of M.",Prove that a valid jump sequence exists if M contains no multiples of 2009.,"Let $I_k = ((k-1)2009, k \cdot 2009)$ and let $n_k = |M \cap I_k|$. Order the 1005 intervals such that $n_{p_1} \ge n_{p_2} \ge \cdots \ge n_{p_{1005}}$. We reserve interval $I_{p_1}$ for the jump of length 2009. For the remaining 1004 intervals ($m=1, \ldots, 1004$), we greedily select an unused jump length $d \in \{1, \ldots, 1004\}$ to place a landing point in $I_{p_{m+1}}$. Assume this is impossible at step $m$. Then for each of the $1005-m$ available lengths $d$, both points $2009(p_{m+1}-1)+d$ and $2009p_{m+1}-d$ are in $M$. This implies $n_{p_{m+1}} \ge 2(1005-m)$. Since $|M|=2008$, we have $2008 \ge \sum_{j=1}^{m+1} n_{p_j} \ge (m+1)n_{p_{m+1}}$. Combining these gives $2008 \ge 2(m+1)(1005-m)$. The minimum value of the right-hand side for $m \in [1, 1004]$ is $2(1005)(1) = 2010$ (at $m=1004$), which leads to the contradiction $2008 \ge 2010$. Thus, a greedy choice is always possible.","Consider the case where M contains a multiple of 2009. Show that there exists a residue $r \in \{1, \ldots, 2008\}$ modulo 2009 that is not represented in M, and formulate a strategy based on this fact.","Since $|M|=2008$, by the Pigeonhole Principle on the 2009 residues modulo 2009, there exists a residue class not represented in M. As M contains a multiple of 2009 (residue 0), this missed residue $r$ must be in $\{1, \ldots, 2008\}$. Our strategy is to use a set of base landing points $\{k \cdot 2009 + r \mid k=0, \ldots, 1004\} \cup \{1005 \cdot 2009\}$, which are guaranteed to be outside M. The jumps between these consecutive points generate lengths $r$ and $2009-r$. The remaining jumps must be formed in pairs $\{d, 2009-d\}$ by placing one additional landing point in 1003 of the 1004 intervals $I_k = ((k-1)2009+r, k \cdot 2009+r)$, leaving one interval for a jump of length 2009.",Prove that the grasshopper can arrange his jumps in such a way that he never lands on a point from M.,"The proof is divided into two cases. Case 1: M contains no multiples of 2009. As proven in the second sub-problem, a valid path exists. Case 2: M contains a multiple of 2009. Following the strategy from the third sub-problem, let $r$ be a residue modulo 2009 missed by M. Let $I_k = ((k-1)2009+r, k \cdot 2009+r)$ and $n_k = |M \cap I_k|$. Note that $\sum n_k \le 2007$ because at least one point of M is not in any $I_k$. We order the 1004 intervals by non-increasing $n_k$ and reserve the first for the jump of length 2009. For the other 1003 intervals, we greedily select jumps. If the process fails at step $m \in \{1, ..., 1003\}$, then for the $(m+1)$-th interval, $n_{p_{m+1}} \ge 2(1004-m)$. This leads to the inequality $2007 \ge \sum_{j=1}^{m+1}n_{p_j} \ge (m+1)n_{p_{m+1}} \ge 2(m+1)(1004-m)$. The minimum of the right-hand side for $m \in [1, 1003]$ is $2(1004)(1) = 2008$ (at $m=1003$), yielding the contradiction $2007 \ge 2008$. Therefore, a valid path can be constructed in both cases."
2009c8,"For any integer $n \geq 2$, we compute the integer $h(n)$ by applying the following procedure to its decimal representation. Let $r$ be the rightmost digit of $n$.\\
(1) If $r=0$, then the decimal representation of $h(n)$ results from the decimal representation of $n$ by removing this rightmost digit 0 .\\
(2) If $1 \leq r \leq 9$ we split the decimal representation of $n$ into a maximal right part $R$ that solely consists of digits not less than $r$ and into a left part $L$ that either is empty or ends with a digit strictly smaller than $r$. Then the decimal representation of $h(n)$ consists of the decimal representation of $L$, followed by two copies of the decimal representation of $R-1$. For instance, for the number $n=17,151,345,543$, we will have $L=17,151, R=345,543$ and $h(n)=17,151,345,542,345,542$.\\
Prove that, starting with an arbitrary integer $n \geq 2$, iterated application of $h$ produces the integer 1 after finitely many steps.","We identify integers $n \geq 2$ with the digit-strings, briefly strings, of their decimal representation and extend the definition of $h$ to all non-empty strings with digits from 0 to 9. We recursively define ten functions $f_{0}, \ldots, f_{9}$ that map some strings into integers for $k=$ $9,8, \ldots, 1,0$. The function $f_{9}$ is only defined on strings $x$ (including the empty string $\varepsilon$ ) that entirely consist of nines. If $x$ consists of $m$ nines, then $f_{9}(x)=m+1, m=0,1, \ldots$. For $k \leq 8$, the domain of $f_{k}(x)$ is the set of all strings consisting only of digits that are $\geq k$. We write $x$ in the form $x_{0} k x_{1} k x_{2} k \ldots x_{m-1} k x_{m}$ where the strings $x_{s}$ only consist of digits $\geq k+1$. Note that some of these strings might equal the empty string $\varepsilon$ and that $m=0$ is possible, i.e. the digit $k$ does not appear in $x$. Then we define

$$
f_{k}(x)=\sum_{s=0}^{m} 4^{f_{k+1}\left(x_{s}\right)} .
$$

We will use the following obvious fact:\\
Fact 1. If $x$ does not contain digits smaller than $k$, then $f_{i}(x)=4^{f_{i+1}(x)}$ for all $i=0, \ldots, k-1$. In particular, $f_{i}(\varepsilon)=4^{9-i}$ for all $i=0,1, \ldots, 9$.\\
Moreover, by induction on $k=9,8, \ldots, 0$ it follows easily:\\
Fact 2. If the nonempty string $x$ does not contain digits smaller than $k$, then $f_{i}(x)>f_{i}(\varepsilon)$ for all $i=0, \ldots, k$.\\
We will show the essential fact:\\
Fact 3. $f_{0}(n)>f_{0}(h(n))$.\\
Then the empty string will necessarily be reached after a finite number of applications of $h$. But starting from a string without leading zeros, $\varepsilon$ can only be reached via the strings $1 \rightarrow 00 \rightarrow 0 \rightarrow \varepsilon$. Hence also the number 1 will appear after a finite number of applications of $h$.\\
Proof of Fact 3. If the last digit $r$ of $n$ is 0 , then we write $n=x_{0} 0 \ldots 0 x_{m-1} 0 \varepsilon$ where the $x_{i}$ do not contain the digit 0 . Then $h(n)=x_{0} 0 \ldots 0 x_{m-1}$ and $f_{0}(n)-f_{0}(h(n))=f_{0}(\varepsilon)>0$.\\
So let the last digit $r$ of $n$ be at least 1 . Let $L=y k$ and $R=z r$ be the corresponding left and right parts where $y$ is some string, $k \leq r-1$ and the string $z$ consists only of digits not less\\
than $r$. Then $n=y k z r$ and $h(n)=y k z(r-1) z(r-1)$. Let $d(y)$ be the smallest digit of $y$. We consider two cases which do not exclude each other.

Case 1. $d(y) \geq k$.\\
Then

$$
f_{k}(n)-f_{k}(h(n))=f_{k}(z r)-f_{k}(z(r-1) z(r-1)) .
$$

In view of Fact 1 this difference is positive if and only if

$$
f_{r-1}(z r)-f_{r-1}(z(r-1) z(r-1))>0 .
$$

We have, using Fact 2,

$$
f_{r-1}(z r)=4^{f_{r}(z r)}=4^{f_{r}(z)+4^{f_{r+1}(\varepsilon)}} \geq 4 \cdot 4^{f_{r}(z)}>4^{f_{r}(z)}+4^{f_{r}(z)}+4^{f_{r}(\varepsilon)}=f_{r-1}(z(r-1) z(r-1)) .
$$

Here we use the additional definition $f_{10}(\varepsilon)=0$ if $r=9$. Consequently, $f_{k}(n)-f_{k}(h(n))>0$ and according to Fact $1, f_{0}(n)-f_{0}(h(n))>0$.\\
Case 2. $d(y) \leq k$.\\
We prove by induction on $d(y)=k, k-1, \ldots, 0$ that $f_{i}(n)-f_{i}(h(n))>0$ for all $i=0, \ldots, d(y)$. By Fact 1 , it suffices to do so for $i=d(y)$. The initialization $d(y)=k$ was already treated in Case 1. Let $t=d(y)<k$. Write $y$ in the form $u t v$ where $v$ does not contain digits $\leq t$. Then, in view of the induction hypothesis,

$$
f_{t}(n)-f_{t}(h(n))=f_{t}(v k z r)-f_{t}(v k z(r-1) z(r-1))=4^{f_{t+1}(v k z r)}-4^{f_{t+1}(v k z(r-1) z(r-1))}>0 .
$$

Thus the inequality $f_{d(y)}(n)-f_{d(y)}(h(n))>0$ is established and from Fact 1 it follows that $f_{0}(n)-f_{0}(h(n))>0$.",4,"To measure the 'size' of an integer $n$ under the operation $h$, define a family of functions $f_k(x)$ for $k \in \\{0, \\dots, 9\\}$, which map decimal strings $x$ to integers.","We identify integers with their decimal strings. For $k=9$, the domain of $f_9$ is strings $x$ composed only of nines. If $x$ has $m$ nines, $f_9(x)=m+1$. For $k \\le 8$, the domain of $f_k$ is strings with digits $\\ge k$. A string $x$ in this domain can be written as $x = x_0 k x_1 k \\dots k x_m$, where each substring $x_s$ consists only of digits $>k$. We define $f_k(x)=\\sum_{s=0}^{m} 4^{f_{k+1}(x_s)}$. This includes the empty string $\\varepsilon$. For convenience, we also define $f_{10}(\\varepsilon)=0$.","Establish two key properties of the functions $f_k(x)$. First, relate $f_i(x)$ to $f_{i+1}(x)$ for strings $x$ without small digits. Second, show that for non-empty strings, $f_i(x)$ is larger than its value on the empty string.","1. If a string $x$ does not contain any digit smaller than $k$, then for any $i < k$, the digit $i$ does not appear in $x$. According to the definition of $f_i$, this means $x$ is treated as a single block between non-existent occurrences of $i$, so $f_i(x) = 4^{f_{i+1}(x)}$.\n2. By induction on $k=9, 8, \\dots, 0$, we can show that if a non-empty string $x$ contains no digits smaller than $k$, then $f_i(x) > f_i(\\varepsilon)$ for all $i=0, \\dots, k$. The base case $k=9$ is clear, as $f_9(x)=m+1 > 1=f_9(\\varepsilon)$. The inductive step follows from the recursive definition of $f_k$ and the first property.","Prove that for any integer $n \\geq 2$, the value of the function $f_0$ is strictly decreasing after one application of $h$, i.e., $f_0(n) > f_0(h(n))$.","Let $r$ be the rightmost digit of $n$. \nCase 1: $r=0$. Then $n=L0$ for some string $L$, and $h(n)=L$. By definition, $f_0(n) = f_0(L) + 4^{f_1(\\varepsilon)} > f_0(L) = f_0(h(n))$.\nCase 2: $r \\ge 1$. Let $n=LR$ where $R$ is the maximal suffix of digits $\\ge r$. Then $h(n)=L(R-1)(R-1)$. A proof by induction on the smallest digit in $n$ shows the result. The core of this proof is to show $f_{r-1}(R) > f_{r-1}((R-1)(R-1))$. Let $R=zr$. Then $f_{r-1}(zr) = 4^{f_r(zr)} = 4^{f_r(z)+4^{f_{r+1}(\\varepsilon)}}$. Meanwhile, $h(R)=(R-1)(R-1)=z(r-1)z(r-1)$, so $f_{r-1}(z(r-1)z(r-1))=4^{f_r(z)}+4^{f_r(z)}+4^{f_r(\\varepsilon)}$. The inequality $4^{f_r(z)+4^{f_{r+1}(\\varepsilon)}} > 2 \\cdot 4^{f_r(z)} + 4^{f_r(\\varepsilon)}$ holds because $4^{f_{r+1}(\\varepsilon)} \\ge 1$ implies $4^{f_r(z)+4^{f_{r+1}(\\varepsilon)}} \\ge 4 \\cdot 4^{f_r(z)}$, and $4 \\cdot 4^{f_r(z)} > 2 \\cdot 4^{f_r(z)} + 4^{f_r(\\varepsilon)}$ as $2 \\cdot 4^{f_r(z)} > 4^{f_r(\\varepsilon)}$.","Prove that, starting with an arbitrary integer $n \\geq 2$, iterated application of $h$ produces the integer 1 after finitely many steps.","For any integer $n \\ge 2$, $f_0(n)$ is a positive integer. From the previous sub-problem, we established that $f_0(n) > f_0(h(n))$. This means the sequence $n, h(n), h(h(n)), \\dots$ corresponds to a strictly decreasing sequence of positive integers $f_0(n), f_0(h(n)), f_0(h(h(n))), \\dots$. Any such sequence must be finite. Therefore, the process of applying $h$ must terminate. Termination occurs when the string becomes empty. For an integer $n \\ge 2$ (which doesn't have leading zeros), the process can only reach the empty string $\\varepsilon$ by first reaching a single-digit number. The path to $\\varepsilon$ is $1 \to h(1)=00 \to h(00)=0 \to h(0)=\\varepsilon$. Since the process must terminate, it must eventually produce a string that leads to this terminal sequence. Therefore, the integer 1 must be produced after a finite number of steps."
2009g2,"Let $A B C$ be a triangle with circumcenter $O$. The points $P$ and $Q$ are interior points of the sides $C A$ and $A B$, respectively. The circle $k$ passes through the midpoints of the segments $B P$, $C Q$, and $P Q$. Prove that if the line $P Q$ is tangent to circle $k$ then $O P=O Q$.","Let $K, L, M, B^{\prime}, C^{\prime}$ be the midpoints of $B P, C Q, P Q, C A$, and $A B$, respectively (see Figure 1). Since $C A \| L M$, we have $\angle L M P=\angle Q P A$. Since $k$ touches the segment $P Q$ at $M$, we find $\angle L M P=\angle L K M$. Thus $\angle Q P A=\angle L K M$. Similarly it follows from $A B \| M K$ that $\angle P Q A=\angle K L M$. Therefore, triangles $A P Q$ and $M K L$ are similar, hence

\begin{equation*}
\frac{A P}{A Q}=\frac{M K}{M L}=\frac{\frac{Q B}{2}}{\frac{P C}{2}}=\frac{Q B}{P C} . \tag{1}
\end{equation*}

Now (1) is equivalent to $A P \cdot P C=A Q \cdot Q B$ which means that the power of points $P$ and $Q$ with respect to the circumcircle of $\triangle A B C$ are equal, hence $O P=O Q$.\\",2,"Let $A B C$ be a triangle. Let $P$ and $Q$ be interior points of the sides $C A$ and $A B$ respectively. Let $k$ be the circle passing through the midpoints of the segments $B P$, $C Q$, and $P Q$. Prove that if the line $P Q$ is tangent to circle $k$, then $A P \cdot P C=A Q \cdot Q B$.","Let $K, L, M$ be the midpoints of $BP, CQ, PQ$ respectively. Since $PQ$ is tangent to circle $k$ at $M$, the tangent-chord theorem gives $\\angle LMP = \\angle LKM$ and $\\angle PMK = \\angle KLM$. By the midpoint theorem, $LM \\parallel CA$ and $KM \\parallel AB$. Thus, $\\angle QPA = \\angle LMP$ (corresponding angles) and $\\angle PQA = \\angle PMK$ (corresponding angles). Combining these equalities, we get $\\angle QPA = \\angle LKM$ and $\\angle PQA = \\angle KLM$. This shows that $\triangle APQ$ and $\triangle MKL$ are similar. From this similarity, we have the ratio $\frac{AP}{AQ} = \frac{MK}{ML}$. The midpoint theorem also gives $MK = BQ/2$ and $ML = PC/2$. Substituting these into the ratio gives $\frac{AP}{AQ} = \frac{BQ/2}{PC/2} = \frac{BQ}{PC}$, which rearranges to $AP \\cdot PC = AQ \\cdot QB$.","Let $A B C$ be a triangle with circumcenter $O$. The points $P$ and $Q$ are interior points of the sides $C A$ and $A B$, respectively. The circle $k$ passes through the midpoints of the segments $B P$, $C Q$, and $P Q$. Prove that if the line $P Q$ is tangent to circle $k$ then $O P=O Q$.","The condition that the line $PQ$ is tangent to circle $k$ implies the relation $AP \\cdot PC = AQ \\cdot QB$. The power of point $P$ with respect to the circumcircle of $\triangle ABC$ is $-AP \\cdot PC$, as $P$ lies on the chord $AC$. This power is also equal to $OP^2 - R^2$, where $R$ is the circumradius. Similarly, the power of point $Q$ with respect to the circumcircle is $-AQ \\cdot QB = OQ^2 - R^2$. The established equality $AP \\cdot PC = AQ \\cdot QB$ implies that the powers of $P$ and $Q$ are equal. Therefore, $OP^2 - R^2 = OQ^2 - R^2$, which leads to $OP^2 = OQ^2$. Since $OP$ and $OQ$ are distances, they must be equal, so $OP=OQ$.",,,,
2009g3,"Let $A B C$ be a triangle. The incircle of $A B C$ touches the sides $A B$ and $A C$ at the points $Z$ and $Y$, respectively. Let $G$ be the point where the lines $B Y$ and $C Z$ meet, and let $R$ and $S$ be points such that the two quadrilaterals $B C Y R$ and $B C S Z$ are parallelograms.\\
Prove that $G R=G S$.","Denote $x=A Z=A Y, y=B Z=B X, z=C X=C Y, p=Z G, q=G C$. Several lengthy calculations (Menelaos' theorem in triangle $A Z C$, law of Cosines in triangles $A B C$ and $A Z C$ and Stewart's theorem in triangle $Z C S$ ) give four equations for $p, q, \cos \alpha$\\
and $G S$ in terms of $x, y$, and $z$ that can be resolved for $G S$. The result is symmetric in $y$ and $z$, so $G R=G S$. More in detail this means:\\
The line $B Y$ intersects the sides of triangle $A Z C$, so Menelaos' theorem yields $\frac{p}{q} \cdot \frac{z}{x} \cdot \frac{x+y}{y}=1$, hence

\begin{equation*}
\frac{p}{q}=\frac{x y}{y z+z x} . \tag{1}
\end{equation*}

Since we only want to show that the term for $G S$ is symmetric in $y$ and $z$, we abbreviate terms that are symmetric in $y$ and $z$ by capital letters, starting with $N=x y+y z+z x$. So (1) implies

\begin{equation*}
\frac{p}{p+q}=\frac{x y}{x y+y z+z x}=\frac{x y}{N} \quad \text { and } \quad \frac{q}{p+q}=\frac{y z+z x}{x y+y z+z x}=\frac{y z+z x}{N} . \tag{2}
\end{equation*}

Now the law of Cosines in triangle $A B C$ yields

$$
\cos \alpha=\frac{(x+y)^{2}+(x+z)^{2}-(y+z)^{2}}{2(x+y)(x+z)}=\frac{2 x^{2}+2 x y+2 x z-2 y z}{2(x+y)(x+z)}=1-\frac{2 y z}{(x+y)(x+z)} .
$$

We use this result to apply the law of Cosines in triangle $A Z C$ :

\begin{align*}
(p+q)^{2} & =x^{2}+(x+z)^{2}-2 x(x+z) \cos \alpha \\
& =x^{2}+(x+z)^{2}-2 x(x+z) \cdot\left(1-\frac{2 y z}{(x+y)(x+z)}\right) \\
& =z^{2}+\frac{4 x y z}{x+y} . \tag{3}
\end{align*}

Now in triangle $Z C S$ the segment $G S$ is a cevian, so with Stewart's theorem we have $p y^{2}+q(y+z)^{2}=(p+q)\left(G S^{2}+p q\right)$, hence

$$
G S^{2}=\frac{p}{p+q} \cdot y^{2}+\frac{q}{p+q} \cdot(y+z)^{2}-\frac{p}{p+q} \cdot \frac{q}{p+q} \cdot(p+q)^{2} .
$$

Replacing the $p$ 's and $q$ 's herein by (2) and (3) yields

$$
\begin{aligned}
G S^{2} & =\frac{x y}{N} y^{2}+\frac{y z+z x}{N}(y+z)^{2}-\frac{x y}{N} \cdot \frac{y z+z x}{N} \cdot\left(z^{2}+\frac{4 x y z}{x+y}\right) \\
& =\frac{x y^{3}}{N}+\underbrace{\frac{y z(y+z)^{2}}{N}}_{M_{1}}+\frac{z x(y+z)^{2}}{N}-\frac{x y z^{3}(x+y)}{N^{2}}-\underbrace{\frac{4 x^{2} y^{2} z^{2}}{N^{2}}}_{M_{2}} \\
& =\frac{x y^{3}+z x(y+z)^{2}}{N}-\frac{x y z^{3}(x+y)}{N^{2}}+M_{1}-M_{2} \\
& =\underbrace{\frac{x\left(y^{3}+y^{2} z+y z^{2}+z^{3}\right)}{N}+\frac{x y z^{2} N}{N^{2}}-\frac{x y z^{3}(x+y)}{N^{2}}+M_{1}-M_{2}}_{M_{3}} \\
& =\frac{x^{2} y^{2} z^{2}+x y^{2} z^{3}+x^{2} y z^{3}-x^{2} y z^{3}-x y^{2} z^{3}}{N^{2}}+M_{1}-M_{2}+M_{3} \\
& =\frac{x^{2} y^{2} z^{2}}{N^{2}}+M_{1}-M_{2}+M_{3},
\end{aligned}
$$

a term that is symmetric in $y$ and $z$, indeed.",3,"Let $x=AZ=AY$, $y=BZ$, and $z=CY$. Let $G$ be the intersection of $BY$ and $CZ$, and set $p=ZG$ and $q=GC$. Express the ratios $\frac{p}{p+q}$ and $\frac{q}{p+q}$, and the squared length of the segment $CZ$, in terms of $x, y, z$.","Applying Menelaus' theorem to $\triangle AZC$ with transversal $BGY$ gives $\frac{AB}{BZ} \cdot \frac{ZG}{GC} \cdot \frac{CY}{YA} = 1$, which leads to $\frac{p}{q} = \frac{xy}{z(x+y)} = \frac{xy}{xz+yz}$. From this, we derive the ratios $\frac{p}{p+q} = \frac{xy}{xy+yz+zx}$ and $\frac{q}{p+q} = \frac{yz+zx}{xy+yz+zx}$. To find $CZ^2$, we use the Law of Cosines. First, in $\triangle ABC$, $\cos A = 1 - \frac{2yz}{(x+y)(x+z)}$. Then, in $\triangle AZC$, $CZ^2 = AZ^2+AC^2-2AZ \cdot AC \cos A = x^2+(x+z)^2 - 2x(x+z)\cos A$. Substituting for $\cos A$ yields $CZ^2 = (p+q)^2 = z^2+\frac{4xyz}{x+y}$.","Given that $BCSZ$ is a parallelogram, express $GS^2$ using Stewart's theorem on an appropriate triangle, in terms of $y, z$ and the quantities $p=ZG$ and $q=GC$.","Since $BCSZ$ is a parallelogram, its sides satisfy $CS=BZ=y$ and $SZ=BC=y+z$. The point $G$ lies on the side $ZC$ of $\triangle ZCS$. Applying Stewart's theorem to $\triangle ZCS$ with cevian $GS$, we have $CS^2 \cdot ZG + SZ^2 \cdot GC = ZC (GS^2 + ZG \cdot GC)$. Substituting the known lengths ($ZG=p, GC=q, ZC=p+q$), we get $y^2 p + (y+z)^2 q = (p+q)(GS^2 + pq)$. Solving for $GS^2$ gives $GS^2 = \frac{p}{p+q}y^2 + \frac{q}{p+q}(y+z)^2 - pq$.",Prove that $G R=G S$.,"We substitute the expressions for the ratios and for $(p+q)^2=CZ^2$ from the first sub-problem into the formula for $GS^2$ from the second sub-problem. This yields an expression for $GS^2$ in terms of $x, y, z$: $GS^2 = \frac{xy}{N} y^2 + \frac{yz+zx}{N}(y+z)^2 - \frac{xy(yz+zx)}{N^2} (z^2+\frac{4xyz}{x+y})$, where $N=xy+yz+zx$. This expression is symmetric with respect to $y$ and $z$. The point $R$ is defined by the parallelogram $BCYR$, which is the same definition as for $S$ but with the roles of $Y$ and $Z$ interchanged. In terms of side lengths, this corresponds to swapping $y$ and $z$. Since the expression for $GS^2$ is symmetric in $y$ and $z$, swapping them does not change its value. Thus, $GR^2 = GS^2$, which implies $GR=GS$.",,
2009g4,"Given a cyclic quadrilateral $A B C D$, let the diagonals $A C$ and $B D$ meet at $E$ and the lines $A D$ and $B C$ meet at $F$. The midpoints of $A B$ and $C D$ are $G$ and $H$, respectively. Show that $E F$ is tangent at $E$ to the circle through the points $E, G$, and $H$.","It suffices to show that $\angle H E F=\angle H G E$ (see Figure 1), since in circle $E G H$ the angle over the chord $E H$ at $G$ equals the angle between the tangent at $E$ and $E H$.\\
First, $\angle B A D=180^{\circ}-\angle D C B=\angle F C D$. Since triangles $F A B$ and $F C D$ have also a common interior angle at $F$, they are similar.\\

Denote by $\mathcal{T}$ the transformation consisting of a reflection at the bisector of $\angle D F C$ followed by a dilation with center $F$ and factor of $\frac{F A}{F C}$. Then $\mathcal{T}$ maps $F$ to $F, C$ to $A, D$ to $B$, and $H$ to $G$. To see this, note that $\triangle F C A \sim \triangle F D B$, so $\frac{F A}{F C}=\frac{F B}{F D}$. Moreover, as $\angle A D B=\angle A C B$, the image of the line $D E$ under $\mathcal{T}$ is parallel to $A C$ (and passes through $B$ ) and similarly the image of $C E$ is parallel to $D B$ and passes through $A$. Hence $E$ is mapped to the point $X$ which is the fourth vertex of the parallelogram $B E A X$. Thus, in particular $\angle H E F=\angle F X G$.\\
As $G$ is the midpoint of the diagonal $A B$ of the parallelogram $B E A X$, it is also the midpoint of $E X$. In particular, $E, G, X$ are collinear, and $E X=2 \cdot E G$.\\
Denote by $Y$ the fourth vertex of the parallelogram $D E C Y$. By an analogous reasoning as before, it follows that $\mathcal{T}$ maps $Y$ to $E$, thus $E, H, Y$ are collinear with $E Y=2 \cdot E H$. Therefore, by the intercept theorem, $H G \| X Y$.\\
From the construction of $\mathcal{T}$ it is clear that the lines $F X$ and $F E$ are symmetric with respect to the bisector of $\angle D F C$, as are $F Y$ and $F E$. Thus, $F, X, Y$ are collinear, which together with $H G \| X Y$ implies $\angle F X E=\angle H G E$. This completes the proof.",3,Consider a transformation $\mathcal{T}$ consisting of a reflection at the bisector of $\angle DFC$ followed by a dilation centered at $F$ that maps point $C$ to point $A$. Let $X = \mathcal{T}(E)$ and $Y = \mathcal{T}^{-1}(E)$. Prove that $G$ is the midpoint of the segment $EX$ and $H$ is the midpoint of the segment $EY$.,"Since $ABCD$ is a cyclic quadrilateral, $\triangle FAB \sim \triangle FCD$. This ensures that $\mathcal{T}$ maps $D$ to $B$. The transformation $\mathcal{T}$ maps the lines $CE$ and $DE$ to lines through $A$ and $B$ that are parallel to $BD$ and $AC$ respectively. Their intersection, $X = \mathcal{T}(E)$, must therefore form a parallelogram $AEBX$. Since $G$ is the midpoint of the diagonal $AB$, it is also the midpoint of the diagonal $EX$. A similar argument for the inverse transformation $\mathcal{T}^{-1}$ shows that $Y$ is the fourth vertex of a parallelogram $DECY$, and thus $H$ (the midpoint of $CD$) is also the midpoint of the diagonal $EY$.","Using the points $X, Y$ and transformation $\mathcal{T}$ from the previous sub-problem, prove that $\angle HGE = \angle FXE$.","From the previous sub-problem, in $\triangle EXY$, $G$ and $H$ are the midpoints of sides $EX$ and $EY$ respectively. By the Midpoint Theorem, $HG \parallel XY$. The transformation $\mathcal{T}$ is a reflection across the bisector of $\angle DFC$ (line $l$) followed by a dilation from $F$. Since $X = \mathcal{T}(E)$ and $E=\mathcal{T}(Y)$, the line $FX$ is the reflection of $FE$ across $l$, and $FE$ is the reflection of $FY$ across $l$. This implies $F, X, Y$ are collinear. Therefore, $HG \parallel FX$. As $E,G,X$ are collinear (from Part 1), the line $EX$ is a transversal to the parallel lines $HG$ and $FX$. The corresponding angles are equal: $\angle HGE = \angle YXE$. Since $F,X,Y$ are collinear, $\angle YXE = \angle FXE$, so $\angle HGE = \angle FXE$.","Show that $EF$ is tangent at $E$ to the circle through the points $E, G$, and $H$.","By the converse of the tangent-chord theorem, it suffices to prove $\angle HEF = \angle HGE$. The similarity transformation $\mathcal{T}$ maps $\triangle FEH$ to $\triangle FXG$. This similarity implies $\angle HEF = \angle GXF$. From Part 1, we know that $E, G, X$ are collinear, so $\angle GXF = \angle FXE$. From Part 2, we proved that $\angle HGE = \angle FXE$. Therefore, we can conclude that $\angle HEF = \angle HGE$, which proves that $EF$ is tangent to the circumcircle of $\triangle EGH$ at point $E$.",,
2009g5,"Let $P$ be a polygon that is convex and symmetric to some point $O$. Prove that for some parallelogram $R$ satisfying $P \subset R$ we have

$$
\frac{|R|}{|P|} \leq \sqrt{2}
$$

where $|R|$ and $|P|$ denote the area of the sets $R$ and $P$, respectively.","We will construct two parallelograms $R_{1}$ and $R_{3}$, each of them containing $P$, and prove that at least one of the inequalities $\left|R_{1}\right| \leq \sqrt{2}|P|$ and $\left|R_{3}\right| \leq \sqrt{2}|P|$ holds.\\
First we will construct a parallelogram $R_{1} \supseteq P$ with the property that the midpoints of the sides of $R_{1}$ are points of the boundary of $P$.\\
Choose two points $A$ and $B$ of $P$ such that the triangle $O A B$ has maximal area. Let $a$ be the line through $A$ parallel to $O B$ and $b$ the line through $B$ parallel to $O A$. Let $A^{\prime}, B^{\prime}, a^{\prime}$ and $b^{\prime}$ be the points or lines, that are symmetric to $A, B, a$ and $b$, respectively, with respect to $O$. Now let $R_{1}$ be the parallelogram defined by $a, b, a^{\prime}$ and $b^{\prime}$.\\

Obviously, $A$ and $B$ are located on the boundary of the polygon $P$, and $A, B, A^{\prime}$ and $B^{\prime}$ are midpoints of the sides of $R_{1}$. We note that $P \subseteq R_{1}$. Otherwise, there would be a point $Z \in P$ but $Z \notin R_{1}$, i.e., one of the lines $a, b, a^{\prime}$ or $b^{\prime}$ were between $O$ and $Z$. If it is $a$, we have $|O Z B|>|O A B|$, which is contradictory to the choice of $A$ and $B$. If it is one of the lines $b, a^{\prime}$ or $b^{\prime}$ almost identical arguments lead to a similar contradiction.\\
Let $R_{2}$ be the parallelogram $A B A^{\prime} B^{\prime}$. Since $A$ and $B$ are points of $P$, segment $A B \subset P$ and so $R_{2} \subset R_{1}$. Since $A, B, A^{\prime}$ and $B^{\prime}$ are midpoints of the sides of $R_{1}$, an easy argument yields

\begin{equation*}
\left|R_{1}\right|=2 \cdot\left|R_{2}\right| . \tag{1}
\end{equation*}

Let $R_{3}$ be the smallest parallelogram enclosing $P$ defined by lines parallel to $A B$ and $B A^{\prime}$. Obviously $R_{2} \subset R_{3}$ and every side of $R_{3}$ contains at least one point of the boundary of $P$. Denote by $C$ the intersection point of $a$ and $b$, by $X$ the intersection point of $A B$ and $O C$, and by $X^{\prime}$ the intersection point of $X C$ and the boundary of $R_{3}$. In a similar way denote by $D$\\
the intersection point of $b$ and $a^{\prime}$, by $Y$ the intersection point of $A^{\prime} B$ and $O D$, and by $Y^{\prime}$ the intersection point of $Y D$ and the boundary of $R_{3}$.\\
Note that $O C=2 \cdot O X$ and $O D=2 \cdot O Y$, so there exist real numbers $x$ and $y$ with $1 \leq x, y \leq 2$ and $O X^{\prime}=x \cdot O X$ and $O Y^{\prime}=y \cdot O Y$. Corresponding sides of $R_{3}$ and $R_{2}$ are parallel which yields

\begin{equation*}
\left|R_{3}\right|=x y \cdot\left|R_{2}\right| . \tag{2}
\end{equation*}

The side of $R_{3}$ containing $X^{\prime}$ contains at least one point $X^{*}$ of $P$; due to the convexity of $P$ we have $A X^{*} B \subset P$. Since this side of the parallelogram $R_{3}$ is parallel to $A B$ we have $\left|A X^{*} B\right|=\left|A X^{\prime} B\right|$, so $\left|O A X^{\prime} B\right|$ does not exceed the area of $P$ confined to the sector defined by the rays $O B$ and $O A$. In a similar way we conclude that $\left|O B^{\prime} Y^{\prime} A^{\prime}\right|$ does not exceed the area of $P$ confined to the sector defined by the rays $O B$ and $O A^{\prime}$. Putting things together we have $\left|O A X^{\prime} B\right|=x \cdot|O A B|,\left|O B D A^{\prime}\right|=y \cdot\left|O B A^{\prime}\right|$. Since $|O A B|=\left|O B A^{\prime}\right|$, we conclude that $|P| \geq 2 \cdot\left|A X^{\prime} B Y^{\prime} A^{\prime}\right|=2 \cdot\left(x \cdot|O A B|+y \cdot\left|O B A^{\prime}\right|\right)=4 \cdot \frac{x+y}{2} \cdot|O A B|=\frac{x+y}{2} \cdot R_{2}$; this is in short

\begin{equation*}
\frac{x+y}{2} \cdot\left|R_{2}\right| \leq|P| \text {. } \tag{3}
\end{equation*}

Since all numbers concerned are positive, we can combine (1)-(3). Using the arithmetic-geometric-mean inequality we obtain

$$
\left|R_{1}\right| \cdot\left|R_{3}\right|=2 \cdot\left|R_{2}\right| \cdot x y \cdot\left|R_{2}\right| \leq 2 \cdot\left|R_{2}\right|^{2}\left(\frac{x+y}{2}\right)^{2} \leq 2 \cdot|P|^{2} .
$$

This implies immediately the desired result $\left|R_{1}\right| \leq \sqrt{2} \cdot|P|$ or $\left|R_{3}\right| \leq \sqrt{2} \cdot|P|$.",4,"Let $A, B$ be points in a centrally symmetric convex polygon $P$ such that triangle $OAB$ has maximal area. Construct the parallelogram $R_1$ with sides parallel to $OA$ and $OB$ passing through $B$ and $A$ respectively (and their symmetric counterparts). Let $R_2$ be the parallelogram $ABA'B'$. Show that $P \subset R_1$ and $|R_1|=2|R_2|$.","The construction of $R_1$ makes the vertices of $R_2$ (A, B, A', B') the midpoints of the sides of $R_1$, which geometrically implies $|R_1|=2|R_2|$. To show $P \subset R_1$, assume for contradiction a point $Z \in P$ is outside $R_1$. Then $Z$ and $O$ are separated by one of the lines forming $R_1$. Let this line be the one through $A$ parallel to $OB$. Then the distance from $Z$ to the line $OB$ is greater than the distance from $A$ to $OB$. This means the area of triangle $OZB$ is greater than the area of triangle $OAB$, contradicting the maximality of $|OAB|$. A similar argument holds for the other three sides.","Let $R_3$ be the smallest parallelogram enclosing $P$ with sides parallel to $AB$ and $BA'$. Show that its area can be written as $|R_3|=xy|R_2|$ for some scalars $x,y \ge 1$, and that the area of $P$ is bounded by $|P| \ge \frac{x+y}{2}|R_2|$.","Since $R_3$ is an scaled version of $R_2$ (as their sides are parallel), its area can be expressed as $|R_3| = xy|R_2|$ for some scaling factors $x,y \ge 1$. Since $R_3$ is the minimum-area parallelogram of this orientation containing $P$, each side of $R_3$ must contain at least one point of $P$. Due to the convexity of $P$, the area of $P$ is at least the area of the hexagon formed by connecting the vertices of $R_2$ to points on the boundary of $R_3$. The area of this hexagon can be calculated as $\frac{x+y}{2}|R_2|$. Therefore, we have the inequality $|P| \\ge \frac{x+y}{2}|R_2|$.","Using the relations $|R_1|=2|R_2|$, $|R_3|=xy|R_2|$, and $|P| \ge \frac{x+y}{2}|R_2|$, prove that the product of the areas of the two enclosing parallelograms satisfies $|R_1||R_3| \le 2|P|^2$.","Start with the product $|R_1||R_3| = (2|R_2|)(xy|R_2|) = 2xy|R_2|^2$. By the Arithmetic Mean-Geometric Mean inequality, we know that $xy \le (\frac{x+y}{2})^2$. Substituting this into the equation gives $|R_1||R_3| \le 2(\frac{x+y}{2})^2|R_2|^2 = 2(\frac{x+y}{2}|R_2|)^2$. From the previous sub-problem, we know $|P| \ge \frac{x+y}{2}|R_2|$. Squaring this gives $|P|^2 \ge (\frac{x+y}{2}|R_2|)^2$. Combining these results, we conclude that $|R_1||R_3| \le 2|P|^2$.",Let $P$ be a polygon that is convex and symmetric to some point $O$. Prove that for some parallelogram $R$ satisfying $P \subset R$ we have $\frac{|R|}{|P|} \\leq \\sqrt{2}$.,"From the previous steps, we have constructed two parallelograms, $R_1$ and $R_3$, both of which contain $P$. We also proved the inequality $|R_1||R_3| \le 2|P|^2$. Assume, for the sake of contradiction, that for all parallelograms $R$ containing $P$, we have $|R| > \\sqrt{2}|P|$. This would mean $|R_1| > \\sqrt{2}|P|$ and $|R_3| > \\sqrt{2}|P|$. Multiplying these two inequalities gives $|R_1||R_3| > 2|P|^2$, which contradicts our established result. Therefore, the assumption must be false. At least one of the parallelograms, $R_1$ or $R_3$, must satisfy the condition $|R| \le \\sqrt{2}|P|$. This proves the existence of such a parallelogram $R$."
2009g6,"Let the sides $A D$ and $B C$ of the quadrilateral $A B C D$ (such that $A B$ is not parallel to $C D$ ) intersect at point $P$. Points $O_{1}$ and $O_{2}$ are the circumcenters and points $H_{1}$ and $H_{2}$ are the orthocenters of triangles $A B P$ and $D C P$, respectively. Denote the midpoints of segments $O_{1} H_{1}$ and $O_{2} H_{2}$ by $E_{1}$ and $E_{2}$, respectively. Prove that the perpendicular from $E_{1}$ on $C D$, the perpendicular from $E_{2}$ on $A B$ and the line $H_{1} H_{2}$ are concurrent.","We keep triangle $A B P$ fixed and move the line $C D$ parallel to itself uniformly, i.e. linearly dependent on a single parameter $\lambda$ (see Figure 1). Then the points $C$ and $D$ also move uniformly. Hence, the points $O_{2}, H_{2}$ and $E_{2}$ move uniformly, too. Therefore also the perpendicular from $E_{2}$ on $A B$ moves uniformly. Obviously, the points $O_{1}, H_{1}, E_{1}$ and the perpendicular from $E_{1}$ on $C D$ do not move at all. Hence, the intersection point $S$ of these two perpendiculars moves uniformly. Since $H_{1}$ does not move, while $H_{2}$ and $S$ move uniformly along parallel lines (both are perpendicular to $C D$ ), it is sufficient to prove their collinearity for two different positions of $C D$.\\

Let $C D$ pass through either point $A$ or point $B$. Note that by hypothesis these two cases are different. We will consider the case $A \in C D$, i.e. $A=D$. So we have to show that the perpendiculars from $E_{1}$ on $A C$ and from $E_{2}$ on $A B$ intersect on the altitude $A H$ of triangle $A B C$ (see Figure 2).\\

To this end, we consider the midpoints $A_{1}, B_{1}, C_{1}$ of $B C, C A, A B$, respectively. As $E_{1}$ is the center of Feuerbach's circle (nine-point circle) of $\triangle A B P$, we have $E_{1} C_{1}=E_{1} H$. Similarly, $E_{2} B_{1}=E_{2} H$. Note further that a point $X$ lies on the perpendicular from $E_{1}$ on $A_{1} C_{1}$ if and only if

$$
X C_{1}^{2}-X A_{1}^{2}=E_{1} C_{1}^{2}-E_{1} A_{1}^{2} .
$$

Similarly, the perpendicular from $E_{2}$ on $A_{1} B_{1}$ is characterized by

$$
X A_{1}^{2}-X B_{1}^{2}=E_{2} A_{1}^{2}-E_{2} B_{1}^{2} .
$$

The line $H_{1} H_{2}$, which is perpendicular to $B_{1} C_{1}$ and contains $A$, is given by

$$
X B_{1}^{2}-X C_{1}^{2}=A B_{1}^{2}-A C_{1}^{2} .
$$

The three lines are concurrent if and only if

$$
\begin{aligned}
0 & =X C_{1}^{2}-X A_{1}^{2}+X A_{1}^{2}-X B_{1}^{2}+X B_{1}^{2}-X C_{1}^{2} \\
& =E_{1} C_{1}^{2}-E_{1} A_{1}^{2}+E_{2} A_{1}^{2}-E_{2} B_{1}^{2}+A B_{1}^{2}-A C_{1}^{2} \\
& =-E_{1} A_{1}^{2}+E_{2} A_{1}^{2}+E_{1} H^{2}-E_{2} H^{2}+A B_{1}^{2}-A C_{1}^{2},
\end{aligned}
$$

i.e. it suffices to show that

$$
E_{1} A_{1}^{2}-E_{2} A_{1}^{2}-E_{1} H^{2}+E_{2} H^{2}=\frac{A C^{2}-A B^{2}}{4} .
$$

We have

$$
\frac{A C^{2}-A B^{2}}{4}=\frac{H C^{2}-H B^{2}}{4}=\frac{(H C+H B)(H C-H B)}{4}=\frac{H A_{1} \cdot B C}{2} .
$$

Let $F_{1}, F_{2}$ be the projections of $E_{1}, E_{2}$ on $B C$. Obviously, these are the midpoints of $H P_{1}$,\\
$H P_{2}$, where $P_{1}, P_{2}$ are the midpoints of $P B$ and $P C$ respectively. Then

$$
\begin{aligned}
& E_{1} A_{1}^{2}-E_{2} A_{1}^{2}-E_{1} H^{2}+E_{2} H^{2} \\
& =F_{1} A_{1}^{2}-F_{1} H^{2}-F_{2} A_{1}^{2}+F_{2} H^{2} \\
& =\left(F_{1} A_{1}-F_{1} H\right)\left(F_{1} A_{1}+F_{1} H\right)-\left(F_{2} A_{1}-F_{2} H\right)\left(F_{2} A_{1}+F_{2} H\right) \\
& =A_{1} H \cdot\left(A_{1} P_{1}-A_{1} P_{2}\right) \\
& =\frac{A_{1} H \cdot B C}{2} \\
& =\frac{A C^{2}-A B^{2}}{4},
\end{aligned}
$$

which proves the claim.",3,"Reduce the general problem to a specific degenerate case. Show that if the concurrency holds when the line CD passes through A, it holds for any general position of CD parallel to this line.","Fix triangle ABP. Let the line CD move parallel to itself, with its position determined by a parameter $\lambda$. The vertices C and D, and consequently the circumcenter $O_2$ and orthocenter $H_2$ of $\triangle DCP$, move linearly with $\lambda$. The nine-point center $E_2 = (O_2+H_2)/2$ also moves linearly. The perpendicular from $E_2$ to the fixed line $AB$ is a line whose position depends linearly on $\lambda$. The perpendicular from the fixed point $E_1$ to the line CD is a fixed line, as the direction of CD is fixed. Their intersection point $S$ therefore moves linearly with $\lambda$. For $S$ to be collinear with the fixed point $H_1$ and the linearly moving point $H_2$, the condition is linear in $\lambda$. A linear property that holds for two distinct cases must hold for all. Thus, it suffices to prove the claim for the degenerate configuration where D=A.","For the degenerate case where D=A, the problem concerns triangles $\triangle ABP$ and $\triangle ACP$, where B, C, P are collinear. Formulate the concurrency condition for the three relevant lines: the perpendicular from $E_1$ (nine-point center of $\triangle ABP$) to $AC$, the perpendicular from $E_2$ (nine-point center of $\triangle ACP$) to $AB$, and the line $H_1H_2$.","When D=A, the triangles are $\triangle ABP$ and $\triangle ACP$. The orthocenter $H_1$ of $\triangle ABP$ and the orthocenter $H_2$ of $\triangle ACP$ both lie on the altitude from vertex A to the line BC. Thus, the line $H_1H_2$ is this altitude. Let $A_1, B_1, C_1$ be the midpoints of the sides $BC, AC, AB$ of $\triangle ABC$. The three lines in question are perpendicular to the sides of the medial triangle $\triangle A_1B_1C_1$. By a known theorem (a generalization of the radical axis theorem), these three lines are concurrent if and only if the following condition holds: $(E_{1}C_{1}^{2}-E_{1}A_{1}^{2}) + (E_{2}A_{1}^{2}-E_{2}B_{1}^{2}) + (AB_{1}^{2}-AC_{1}^{2}) = 0$.","Let the sides $A D$ and $B C$ of the quadrilateral $A B C D$ (such that $A B$ is not parallel to $C D$ ) intersect at point $P$. Points $O_{1}$ and $O_{2}$ are the circumcenters and points $H_{1}$ and $H_{2}$ are the orthocenters of triangles $A B P$ and $D C P$, respectively. Denote the midpoints of segments $O_{1} H_{1}$ and $O_{2} H_{2}$ by $E_{1}$ and $E_{2}$, respectively. Prove that the perpendicular from $E_{1}$ on $C D$, the perpendicular from $E_{2}$ on $A B$ and the line $H_{1} H_{2}$ are concurrent.","Based on the previous steps, we prove the concurrency condition for the case D=A. Let $H$ be the foot of the altitude from A to BC. $E_1$, the nine-point center of $\triangle ABP$, is equidistant from $C_1$ (midpoint of AB) and $H$, so $E_1C_1 = E_1H$. Similarly, $E_2B_1 = E_2H$. The condition becomes $E_{1}H^{2}-E_{1}A_{1}^{2}+E_{2}A_{1}^{2}-E_{2}H^{2}+AB_{1}^{2}-AC_{1}^{2}=0$, which rearranges to $E_{1}A_{1}^{2}-E_{2}A_{1}^{2}-E_{1}H^{2}+E_{2}H^{2} = AB_{1}^{2}-AC_{1}^{2} = (AC^2-AB^2)/4$. Let $F_1, F_2$ be projections of $E_1, E_2$ on BC. The left side equals $F_{1}A_{1}^{2}-F_{1}H^{2} - (F_{2}A_{1}^{2}-F_{2}H^{2})$. This simplifies to $A_1H \cdot (P_2 - P_1)$ where $P_1, P_2$ are midpoints of PB, PC. This further simplifies to $A_1H \cdot BC/2$. The right side $(AC^2-AB^2)/4$ equals $(HC^2-HB^2)/4 = (BC \cdot 2A_1H)/4 = A_1H \cdot BC/2$. Since both sides are equal, the condition is satisfied, proving the concurrency.",,
2009g7,"Let $A B C$ be a triangle with incenter $I$ and let $X, Y$ and $Z$ be the incenters of the triangles $B I C, C I A$ and $A I B$, respectively. Let the triangle $X Y Z$ be equilateral. Prove that $A B C$ is equilateral too.","Solution. $A Z, A I$ and $A Y$ divide $\angle B A C$ into four equal angles; denote them by $\alpha$. In the same way we have four equal angles $\beta$ at $B$ and four equal angles $\gamma$ at $C$. Obviously $\alpha+\beta+\gamma=\frac{180^{\circ}}{4}=45^{\circ}$; and $0^{\circ}<\alpha, \beta, \gamma<45^{\circ}$.\\
\includegraphics[max width=\textwidth, center]{2025_05_05_fd167e6e88a82c9be624g-66}

Easy calculations in various triangles yield $\angle B I C=180^{\circ}-2 \beta-2 \gamma=180^{\circ}-\left(90^{\circ}-2 \alpha\right)=$ $90^{\circ}+2 \alpha$, hence (for $X$ is the incenter of triangle $B C I$, so $I X$ bisects $\angle B I C$ ) we have $\angle X I C=$ $\angle B I X=\frac{1}{2} \angle B I C=45^{\circ}+\alpha$ and with similar aguments $\angle C I Y=\angle Y I A=45^{\circ}+\beta$ and $\angle A I Z=\angle Z I B=45^{\circ}+\gamma$. Furthermore, we have $\angle X I Y=\angle X I C+\angle C I Y=\left(45^{\circ}+\alpha\right)+$ $\left(45^{\circ}+\beta\right)=135^{\circ}-\gamma, \angle Y I Z=135^{\circ}-\alpha$, and $\angle Z I X=135^{\circ}-\beta$.\\
Now we calculate the lengths of $I X, I Y$ and $I Z$ in terms of $\alpha, \beta$ and $\gamma$. The perpendicular from $I$ on $C X$ has length $I X \cdot \sin \angle C X I=I X \cdot \sin \left(90^{\circ}+\beta\right)=I X \cdot \cos \beta$. But $C I$ bisects $\angle Y C X$, so the perpendicular from $I$ on $C Y$ has the same length, and we conclude

$$
I X \cdot \cos \beta=I Y \cdot \cos \alpha
$$

To make calculations easier we choose a length unit that makes $I X=\cos \alpha$. Then $I Y=\cos \beta$ and with similar arguments $I Z=\cos \gamma$.\\
Since $X Y Z$ is equilateral we have $Z X=Z Y$. The law of Cosines in triangles $X Y I, Y Z I$ yields

$$
\begin{aligned}
& Z X^{2}=Z Y^{2} \\
\Longrightarrow & I Z^{2}+I X^{2}-2 \cdot I Z \cdot I X \cdot \cos \angle Z I X=I Z^{2}+I Y^{2}-2 \cdot I Z \cdot I Y \cdot \cos \angle Y I Z \\
\Longrightarrow & I X^{2}-I Y^{2}=2 \cdot I Z \cdot(I X \cdot \cos \angle Z I X-I Y \cdot \cos \angle Y I Z) \\
\Longrightarrow & \underbrace{\cos ^{2} \alpha-\cos ^{2} \beta}_{\text {L.H.S. }}=\underbrace{2 \cdot \cos \gamma \cdot\left(\cos \alpha \cdot \cos \left(135^{\circ}-\beta\right)-\cos \beta \cdot \cos \left(135^{\circ}-\alpha\right)\right)}_{\text {R.H.S. }} .
\end{aligned}
$$

A transformation of the left-hand side (L.H.S.) yields

$$
\begin{aligned}
\text { L.H.S. } & =\cos ^{2} \alpha \cdot\left(\sin ^{2} \beta+\cos ^{2} \beta\right)-\cos ^{2} \beta \cdot\left(\sin ^{2} \alpha+\cos ^{2} \alpha\right) \\
& =\cos ^{2} \alpha \cdot \sin ^{2} \beta-\cos ^{2} \beta \cdot \sin ^{2} \alpha
\end{aligned}
$$

$$
\begin{aligned}
& =(\cos \alpha \cdot \sin \beta+\cos \beta \cdot \sin \alpha) \cdot(\cos \alpha \cdot \sin \beta-\cos \beta \cdot \sin \alpha) \\
& =\sin (\beta+\alpha) \cdot \sin (\beta-\alpha)=\sin \left(45^{\circ}-\gamma\right) \cdot \sin (\beta-\alpha)
\end{aligned}
$$

whereas a transformation of the right-hand side (R.H.S.) leads to

$$
\begin{aligned}
\text { R.H.S. } & =2 \cdot \cos \gamma \cdot\left(\cos \alpha \cdot\left(-\cos \left(45^{\circ}+\beta\right)\right)-\cos \beta \cdot\left(-\cos \left(45^{\circ}+\alpha\right)\right)\right) \\
& =2 \cdot \frac{\sqrt{2}}{2} \cdot \cos \gamma \cdot(\cos \alpha \cdot(\sin \beta-\cos \beta)+\cos \beta \cdot(\cos \alpha-\sin \alpha)) \\
& =\sqrt{2} \cdot \cos \gamma \cdot(\cos \alpha \cdot \sin \beta-\cos \beta \cdot \sin \alpha) \\
& =\sqrt{2} \cdot \cos \gamma \cdot \sin (\beta-\alpha)
\end{aligned}
$$

Equating L.H.S. and R.H.S. we obtain

$$
\begin{aligned}
& \sin \left(45^{\circ}-\gamma\right) \cdot \sin (\beta-\alpha)=\sqrt{2} \cdot \cos \gamma \cdot \sin (\beta-\alpha) \\
\Longrightarrow & \sin (\beta-\alpha) \cdot\left(\sqrt{2} \cdot \cos \gamma-\sin \left(45^{\circ}-\gamma\right)\right)=0 \\
\Longrightarrow & \alpha=\beta \quad \text { or } \quad \sqrt{2} \cdot \cos \gamma=\sin \left(45^{\circ}-\gamma\right)
\end{aligned}
$$

But $\gamma<45^{\circ}$; so $\sqrt{2} \cdot \cos \gamma>\cos \gamma>\cos 45^{\circ}=\sin 45^{\circ}>\sin \left(45^{\circ}-\gamma\right)$. This leaves $\alpha=\beta$. With similar reasoning we have $\alpha=\gamma$, which means triangle $A B C$ must be equilateral.",4,"Let the angles of triangle $ABC$ be $4\alpha, 4\beta, 4\gamma$. Let $I$ be the incenter of $ABC$, and $X, Y, Z$ be the incenters of triangles $BIC, CIA, AIB$ respectively. Express the angles $\angle YIZ$, $\angle ZIX$, and $\angle XIY$ in terms of $\alpha, \beta, \gamma$.","The sum of angles in $\triangle ABC$ is $4\alpha+4\beta+4\gamma=180^\circ$, so $\alpha+\beta+\gamma=45^\circ$. In $\triangle BIC$, $\angle IBC=2\beta$ and $\angle ICB=2\gamma$, so $\angle BIC = 180^\circ-2\beta-2\gamma = 90^\circ+2\alpha$. As $IX$ bisects $\angle BIC$, $\angle XIC = 45^\circ+\alpha$. Similarly, $\angle CIY = 45^\circ+\beta$ and $\angle AIZ = 45^\circ+\gamma$. Then $\angle XIY = \angle XIC + \angle CIY = 90^\circ+\alpha+\beta = 90^\circ+(45^\circ-\gamma) = 135^\circ-\gamma$. By symmetry, $\angle YIZ = 135^\circ-\alpha$ and $\angle ZIX = 135^\circ-\beta$.","With the same setup as Sub-problem 1, show that the lengths of the segments $IX, IY, IZ$ satisfy the relations $IX:IY:IZ = \cos\alpha:\cos\beta:\cos\gamma$.","Line $CI$ bisects $\angle XCY$ since $\angle ICX = \gamma$ and $\angle ICY = \gamma$. Thus, the perpendicular distance from $I$ to line $CX$ is equal to the distance from $I$ to line $CY$. In $\triangle ICX$, the angle $\angle CXI = 180^\circ - \angle XIC - \angle ICX = 180^\circ - (45^\circ+\alpha) - \gamma = 135^\circ - (\alpha+\gamma) = 90^\circ+\beta$. The distance from $I$ to $CX$ is $IX \sin(\angle CXI) = IX \sin(90^\circ+\beta) = IX \cos\beta$. Similarly, the distance from $I$ to $CY$ is $IY \cos\alpha$. Equating the distances gives $IX \cos\beta = IY \cos\alpha$. By symmetry, $IY \cos\gamma = IZ \cos\beta$. From these relations, we have $IX:IY:IZ = \cos\alpha:\cos\beta:\cos\gamma$.","Given that triangle $XYZ$ is equilateral and using the results from the previous steps, show that for any pair of angles, say $\alpha$ and $\beta$, we must have $\alpha = \beta$.","Since $\triangle XYZ$ is equilateral, $ZX=ZY$. Applying the Law of Cosines to $\triangle ZIX$ and $\triangle ZIY$ yields $IZ^2+IX^2 - 2 \cdot IZ \cdot IX \cos(\angle ZIX) = IZ^2+IY^2 - 2 \cdot IZ \cdot IY \cos(\angle YIZ)$. We can set $IX=k\cos\alpha, IY=k\cos\beta, IZ=k\cos\gamma$ for a constant $k$. Substituting these and the angles from Sub-problem 1, we get $\cos^2\alpha - \cos^2\beta = 2\cos\gamma(\cos\alpha\cos(135^\circ-\beta) - \cos\beta\cos(135^\circ-\alpha))$. The LHS simplifies to $\sin(45^\circ-\gamma)\sin(\beta-\alpha)$, and the RHS to $\sqrt{2}\cos\gamma\sin(\beta-\alpha)$. This yields $\sin(\beta-\alpha)(\sin(45^\circ-\gamma)-\sqrt{2}\cos\gamma)=0$. Thus, either $\sin(\beta-\alpha)=0 \implies \alpha=\beta$, or $\sin(45^\circ-\gamma)=\sqrt{2}\cos\gamma$. The latter is impossible, as for $0<\gamma<45^\circ$, $\sqrt{2}\cos\gamma > 1$, while $\sin(45^\circ-\gamma) < 1$. Thus $\alpha=\beta$ must hold.","Let $A B C$ be a triangle with incenter $I$ and let $X, Y$ and $Z$ be the incenters of the triangles $B I C, C I A$ and $A I B$, respectively. Let the triangle $X Y Z$ be equilateral. Prove that $A B C$ is equilateral too.","From the previous step, the condition $ZX=ZY$ implies $\alpha=\beta$. Since triangle $XYZ$ is equilateral, all its sides are equal. By symmetry, the condition $XY=YZ$ implies $\gamma=\alpha$. Therefore, we must have $\alpha=\beta=\gamma$. The angles of triangle $ABC$ are $4\alpha, 4\beta, 4\gamma$. Since $\alpha=\beta=\gamma$, the angles of triangle $ABC$ are equal, which means $\triangle ABC$ is equilateral."
2009g8,"Let $A B C D$ be a circumscribed quadrilateral. Let $g$ be a line through $A$ which meets the segment $B C$ in $M$ and the line $C D$ in $N$. Denote by $I_{1}, I_{2}$, and $I_{3}$ the incenters of $\triangle A B M$, $\triangle M N C$, and $\triangle N D A$, respectively. Show that the orthocenter of $\triangle I_{1} I_{2} I_{3}$ lies on $g$.","Let $k_{1}, k_{2}$ and $k_{3}$ be the incircles of triangles $A B M, M N C$, and $N D A$, respectively (see Figure 1). We shall show that the tangent $h$ from $C$ to $k_{1}$ which is different from $C B$ is also tangent to $k_{3}$.\\

To this end, let $X$ denote the point of intersection of $g$ and $h$. Then $A B C X$ and $A B C D$ are circumscribed quadrilaterals, whence

$$
C D-C X=(A B+C D)-(A B+C X)=(B C+A D)-(B C+A X)=A D-A X,
$$

i.e.

$$
A X+C D=C X+A D
$$

which in turn reveals that the quadrilateral $A X C D$ is also circumscribed. Thus $h$ touches indeed the circle $k_{3}$.\\
Moreover, we find that $\angle I_{3} C I_{1}=\angle I_{3} C X+\angle X C I_{1}=\frac{1}{2}(\angle D C X+\angle X C B)=\frac{1}{2} \angle D C B=$ $\frac{1}{2}\left(180^{\circ}-\angle M C N\right)=180^{\circ}-\angle M I_{2} N=\angle I_{3} I_{2} I_{1}$, from which we conclude that $C, I_{1}, I_{2}, I_{3}$ are concyclic.\\
Let now $L_{1}$ and $L_{3}$ be the reflection points of $C$ with respect to the lines $I_{2} I_{3}$ and $I_{1} I_{2}$ respectively. Since $I_{1} I_{2}$ is the angle bisector of $\angle N M C$, it follows that $L_{3}$ lies on $g$. By analogous reasoning, $L_{1}$ lies on $g$.\\
Let $H$ be the orthocenter of $\triangle I_{1} I_{2} I_{3}$. We have $\angle I_{2} L_{3} I_{1}=\angle I_{1} C I_{2}=\angle I_{1} I_{3} I_{2}=180^{\circ}-\angle I_{1} H I_{2}$, which entails that the quadrilateral $I_{2} H I_{1} L_{3}$ is cyclic. Analogously, $I_{3} H L_{1} I_{2}$ is cyclic.

Then, working with oriented angles modulo $180^{\circ}$, we have

$$
\angle L_{3} H I_{2}=\angle L_{3} I_{1} I_{2}=\angle I_{2} I_{1} C=\angle I_{2} I_{3} C=\angle L_{1} I_{3} I_{2}=\angle L_{1} H I_{2},
$$

whence $L_{1}, L_{3}$, and $H$ are collinear. By $L_{1} \neq L_{3}$, the claim follows.",3,Let $k_1$ be the incircle of $\triangle ABM$ and $k_3$ be the incircle of $\triangle NDA$. Let $h$ be the tangent from point $C$ to $k_1$ that is different from the line $BC$. Show that $h$ is also tangent to $k_3$.,"Let $X$ be the intersection of line $g$ and line $h$. As $ABCD$ is a circumscribed quadrilateral, we have $AB+CD = BC+AD$. Since the incircle of $\triangle ABM$ is tangent to $AB, BM, MA$, the quadrilateral $ABCX$ is also circumscribed by construction of the tangent $h=CX$. Thus, $AB+CX = BC+AX$. Subtracting these two equations yields $CD-CX = AD-AX$, which can be rewritten as $AX+CD = CX+AD$. This is the condition for the quadrilateral $AXCD$ to be circumscribed. Its incircle must be tangent to its four sides, which are lines $AX (=g)$, $XC (=h)$, $CD$, and $DA$. Since the incircle of $\triangle NDA$, $k_3$, is tangent to $AD$, $DN$ (on line $CD$), and $NA$ (on line $g$), it must be this circle. Therefore, the line $h=CX$ is also tangent to $k_3$.","Prove that the points $C, I_1, I_2, I_3$ are concyclic.","Let $h=CX$ be the common tangent from $C$ to the incircles $k_1$ and $k_3$, as established in the previous part. Since $I_1$ and $I_3$ are the centers of these circles, $CI_1$ is the angle bisector of $\angle XCB$ and $CI_3$ is the angle bisector of $\angle DCX$. Thus, $\angle I_{3} C I_{1}=\angle I_{3} C X+\angle X C I_{1}=\frac{1}{2}(\angle D C X+\angle X C B)=\frac{1}{2} \angle D C B$. It can be shown that this angle is equal to $\angle I_3 I_2 I_1$. The equality $\angle I_3 C I_1 = \angle I_3 I_2 I_1$ proves that the four points $C, I_1, I_2, I_3$ lie on a common circle.","Let $A B C D$ be a circumscribed quadrilateral. Let $g$ be a line through $A$ which meets the segment $B C$ in $M$ and the line $C D$ in $N$. Denote by $I_{1}, I_{2}$, and $I_{3}$ the incenters of $\triangle A B M$, $\triangle M N C$, and $\triangle N D A$, respectively. Show that the orthocenter of $\triangle I_{1} I_{2} I_{3}$ lies on $g$.","Let $H$ be the orthocenter of $\triangle I_1 I_2 I_3$. Let $L_1$ and $L_3$ be the reflections of point $C$ with respect to the lines $I_2 I_3$ and $I_1 I_2$, respectively. It can be shown that $L_1$ and $L_3$ both lie on the line $g$. Since $C, I_1, I_2, I_3$ are concyclic, we have $\angle I_1 C I_2 = \angle I_1 I_3 I_2$. By reflection, $\angle I_2 L_3 I_1 = \angle I_1 C I_2$. For an orthocenter $H$, $\angle I_1 H I_2 = 180^\circ - \angle I_1 I_3 I_2$. This implies $\angle I_2 L_3 I_1 + \angle I_1 H I_2 = 180^\circ$, so $I_2 H I_1 L_3$ is a cyclic quadrilateral. Similarly, $I_3 H L_1 I_2$ is cyclic. Using oriented angles, we have $\angle L_3 H I_2 = \angle L_3 I_1 I_2 = \angle C I_1 I_2 = \angle C I_3 I_2 = \angle L_1 I_3 I_2 = \angle L_1 H I_2$. This equality implies that $H, L_1, L_3$ are collinear. As $L_1$ and $L_3$ lie on line $g$, the orthocenter $H$ must also lie on $g$.",,
2009n1,"A social club has $n$ members. They have the membership numbers $1,2, \ldots, n$, respectively. From time to time members send presents to other members, including items they have already received as presents from other members. In order to avoid the embarrassing situation that a member might receive a present that he or she has sent to other members, the club adds the following rule to its statutes at one of its annual general meetings:\\
""A member with membership number $a$ is permitted to send a present to a member with membership number $b$ if and only if $a(b-1)$ is a multiple of $n$.""

Prove that, if each member follows this rule, none will receive a present from another member that he or she has already sent to other members.","Suppose there is an edge from $v_{i}$ to $v_{j}$. Then $i(j-1)=i j-i=k n$ for some integer $k$, which implies $i=i j-k n$. If $\operatorname{gcd}(i, n)=d$ and $\operatorname{gcd}(j, n)=e$, then $e$ divides $i j-k n=i$ and thus $e$ also divides $d$. Hence, if there is an edge from $v_{i}$ to $v_{j}$, then $\operatorname{gcd}(j, n) \mid \operatorname{gcd}(i, n)$.\\
If there is a cycle in $G$, say $v_{i_{1}} \rightarrow v_{i_{2}} \rightarrow \cdots \rightarrow v_{i_{r}} \rightarrow v_{i_{1}}$, then we have

$$
\operatorname{gcd}\left(i_{1}, n\right)\left|\operatorname{gcd}\left(i_{r}, n\right)\right| \operatorname{gcd}\left(i_{r-1}, n\right)|\ldots| \operatorname{gcd}\left(i_{2}, n\right) \mid \operatorname{gcd}\left(i_{1}, n\right),
$$

which implies that all these greatest common divisors must be equal, say be equal to $t$.\\
Now we pick any of the $i_{k}$, without loss of generality let it be $i_{1}$. Then $i_{r}\left(i_{1}-1\right)$ is a multiple of $n$ and hence also (by dividing by $t$ ), $i_{1}-1$ is a multiple of $\frac{n}{t}$. Since $i_{1}$ and $i_{1}-1$ are relatively prime, also $t$ and $\frac{n}{t}$ are relatively prime. So, by the Chinese remainder theorem, the value of $i_{1}$ is uniquely determined modulo $n=t \cdot \frac{n}{t}$ by the value of $t$. But, as $i_{1}$ was chosen arbitrarily among the $i_{k}$, this implies that all the $i_{k}$ have to be equal, a contradiction.",2,"Let the members be represented by vertices $\{1, 2, \ldots, n\}$. A directed edge exists from vertex $a$ to vertex $b$ if and only if $a(b-1)$ is a multiple of $n$. Prove that if an edge exists from $a$ to $b$, then $\\gcd(b, n)$ must divide $\\gcd(a, n)$.","Suppose there is an edge from $a$ to $b$. By definition, $a(b-1) = kn$ for some integer $k$. We can rewrite this as $a = ab - kn$. Let $e = \\gcd(b, n)$. Since $e$ divides both $b$ and $n$, it must divide any integer linear combination of them. Therefore, $e$ divides $ab - kn$, which means $e$ divides $a$. Since $e$ divides both $a$ and $n$, it must also divide their greatest common divisor, $\\gcd(a, n)$. Thus, $\\gcd(b, n) \\mid \\gcd(a, n)$.","A social club has $n$ members, numbered $1,2, \\ldots, n$. A member with number $a$ is permitted to send a present to a member with number $b$ if and only if $a(b-1)$ is a multiple of $n$. Prove that, if each member follows this rule, none will receive a present from another member that he or she has already sent to other members.","The problem is equivalent to proving there are no cycles in the directed graph of present-sending. Assume for contradiction that a cycle $i_1 \to i_2 \to \\cdots \to i_r \to i_1$ exists, where all vertices are distinct. From the previous result, the existence of an edge $a \to b$ implies $\\gcd(b, n) \\mid \\gcd(a, n)$. Applying this to the cycle gives the divisibility chain $\\gcd(i_1, n) \\mid \\gcd(i_r, n) \\mid \\dots \\mid \\gcd(i_2, n) \\mid \\gcd(i_1, n)$. For positive integers, this implies all these GCDs are equal. Let their common value be $t$. For any member $i_k$ in the cycle, we have $i_{k-1}(i_k-1) \\equiv 0 \\pmod{n}$ (with $i_0 = i_r$). Since $t=\\gcd(i_{k-1}, n)$, it follows that $i_k-1$ is a multiple of $n/t$. Also, $t=\\gcd(i_k, n)$ implies $i_k$ is a multiple of $t$. As $\\gcd(t, n/t)=1$, the Chinese Remainder Theorem guarantees a unique solution for $i_k$ modulo $n$. Since this holds for all $k=1, \\ldots, r$, it implies $i_1 = i_2 = \\dots = i_r$. This contradicts that the vertices in a cycle are distinct. Therefore, no cycles exist.",,,,
2009n2,"A positive integer $N$ is called balanced, if $N=1$ or if $N$ can be written as a product of an even number of not necessarily distinct primes. Given positive integers $a$ and $b$, consider the polynomial $P$ defined by $P(x)=(x+a)(x+b)$.\\
(a) Prove that there exist distinct positive integers $a$ and $b$ such that all the numbers $P(1), P(2)$, $\ldots, P(50)$ are balanced.\\
(b) Prove that if $P(n)$ is balanced for all positive integers $n$, then $a=b$.","Solution. Define a function $f$ on the set of positive integers by $f(n)=0$ if $n$ is balanced and $f(n)=1$ otherwise. Clearly, $f(n m) \equiv f(n)+f(m) \bmod 2$ for all positive integers $n, m$.\\
(a) Now for each positive integer $n$ consider the binary sequence $(f(n+1), f(n+2), \ldots, f(n+$ $50)$ ). As there are only $2^{50}$ different such sequences there are two different positive integers $a$ and $b$ such that

$$
(f(a+1), f(a+2), \ldots, f(a+50))=(f(b+1), f(b+2), \ldots, f(b+50)) .
$$

But this implies that for the polynomial $P(x)=(x+a)(x+b)$ all the numbers $P(1), P(2)$, $\ldots, P(50)$ are balanced, since for all $1 \leq k \leq 50$ we have $f(P(k)) \equiv f(a+k)+f(b+k) \equiv$ $2 f(a+k) \equiv 0 \bmod 2$.\\
(b) Now suppose $P(n)$ is balanced for all positive integers $n$ and $a<b$. Set $n=k(b-a)-a$ for sufficiently large $k$, such that $n$ is positive. Then $P(n)=k(k+1)(b-a)^{2}$, and this number can only be balanced, if $f(k)=f(k+1)$ holds. Thus, the sequence $f(k)$ must become constant for sufficiently large $k$. But this is not possible, as for every prime $p$ we have $f(p)=1$ and for every square $t^{2}$ we have $f\left(t^{2}\right)=0$.\\
Hence $a=b$.

Comment. Given a positive integer $k$, a computer search for the pairs of positive integers $(a, b)$, for which $P(1), P(2), \ldots, P(k)$ are all balanced yields the following results with minimal sum $a+b$ and $a<b$ :

\begin{center}
\begin{tabular}{|l|c|c|c|c|c|}
\hline
$k$ & 3 & 4 & 5 & 10 & 20 \\
\hline
$(a, b)$ & $(2,4)$ & $(6,11)$ & $(8,14)$ & $(20,34)$ & $(1751,3121)$ \\
\hline
\end{tabular}
\end{center}

Therefore, trying to find $a$ and $b$ in part (a) of the problem cannot be done by elementary calculations.",3,"A positive integer $N$ is called balanced if $N=1$ or if $N$ can be written as a product of an even number of primes. Define a function $f(n)=0$ if $n$ is balanced and $f(n)=1$ otherwise. Prove that for any positive integers $n, m$, we have $f(nm) \equiv f(n) + f(m) \pmod 2$.","Let $\Omega(N)$ be the total number of prime factors of $N$ counted with multiplicity, with $\Omega(1)=0$. By definition, an integer $N$ is balanced if and only if $\Omega(N)$ is even. Thus, the function $f(n)$ is equivalent to $\Omega(n) \pmod 2$. The property that for any positive integers $n, m$, $\Omega(nm) = \Omega(n) + \Omega(m)$ implies that $\Omega(nm) \pmod 2 \equiv \Omega(n) \pmod 2 + \Omega(m) \pmod 2$. This is equivalent to $f(nm) \equiv f(n) + f(m) \pmod 2$.","Using the function $f(n)$ from the previous sub-problem, which indicates if a number is balanced, prove that the sequence $(f(n))_{n\ge 1}$ is not eventually constant.","A sequence is eventually constant if there exists an integer $N_0$ such that the sequence is constant for all $n > N_0$. There are infinitely many prime numbers. For any prime $p$, $\Omega(p)=1$, so $p$ is not balanced, meaning $f(p)=1$. There are also infinitely many perfect squares. For any integer $t>1$, $\Omega(t^2)=2\Omega(t)$ is even, so $t^2$ is balanced, meaning $f(t^2)=0$. Since the sequence $(f(n))_{n\ge 1}$ takes both values 0 and 1 for arbitrarily large integers, it cannot be eventually constant.","Given positive integers $a$ and $b$, consider the polynomial $P(x)=(x+a)(x+b)$.\n(a) Prove that there exist distinct positive integers $a$ and $b$ such that all the numbers $P(1), P(2), \ldots, P(50)$ are balanced.\n(b) Prove that if $P(n)$ is balanced for all positive integers $n$, then $a=b$.","(a) For each integer $n \ge 1$, consider the binary vector $v_n = (f(n+1), f(n+2), \ldots, f(n+50))$. There are at most $2^{50}$ distinct such vectors. By the Pigeonhole Principle, there must exist distinct positive integers $a$ and $b$ such that $v_a = v_b$. This implies $f(a+k) = f(b+k)$ for $k=1, \ldots, 50$. For these $a,b$ and for each $k \in \{1, \ldots, 50\}$, we have $f(P(k)) = f((a+k)(b+k)) \equiv f(a+k) + f(b+k) \equiv 2f(a+k) \equiv 0 \pmod 2$. This shows $P(k)$ is balanced.\n(b) Assume $a \neq b$ and $P(n)$ is balanced for all $n \ge 1$. For $n=k(b-a)-a$ (with $k$ large enough so $n>0$), $P(n) = k(k+1)(b-a)^2$. Since $P(n)$ is balanced, $f(P(n))=0$. We have $0 = f(P(n)) \equiv f(k) + f(k+1) + f((b-a)^2) \pmod 2$. As $(b-a)^2$ is a square, it is balanced, so $f((b-a)^2)=0$. This implies $f(k) = f(k+1)$ for all sufficiently large $k$, meaning the sequence $(f(n))_{n\ge 1}$ is eventually constant. This contradicts the result from the previous sub-problem. Thus, the assumption $a \neq b$ must be false, so $a=b$.",,
2009n3,"Let $f$ be a non-constant function from the set of positive integers into the set of positive integers, such that $a-b$ divides $f(a)-f(b)$ for all distinct positive integers $a, b$. Prove that there exist infinitely many primes $p$ such that $p$ divides $f(c)$ for some positive integer $c$.","Assume that there are only finitely many primes $p_{1}, p_{2}, \ldots, p_{m}$ that divide some function value of $f$. Since $f$ is not identically 1 , we must have $m \geq 1$.\\
Then there exist non-negative integers $\alpha_{1}, \ldots, \alpha_{m}$ such that

$$
f(1)=p_{1}^{\alpha_{1}} p_{2}^{\alpha_{2}} \ldots p_{m}^{\alpha_{m}} .
$$

We can pick a positive integer $r$ such that $f(r) \neq f(1)$. Let

$$
M=1+p_{1}^{\alpha_{1}+1} p_{2}^{\alpha_{2}+1} \ldots p_{m}^{\alpha_{m}+1} \cdot(f(r)+r) .
$$

Then for all $i \in\{1, \ldots, m\}$ we have that $p_{i}^{\alpha_{i}+1}$ divides $M-1$ and hence by the condition of the problem also $f(M)-f(1)$. This implies that $f(M)$ is divisible by $p_{i}^{\alpha_{i}}$ but not by $p_{i}^{\alpha_{i}+1}$ for all $i$ and therefore $f(M)=f(1)$.\\
Hence

$$
\begin{aligned}
M-r & >p_{1}^{\alpha_{1}+1} p_{2}^{\alpha_{2}+1} \ldots p_{m}^{\alpha_{m}+1} \cdot(f(r)+r)-r \\
& \geq p_{1}^{\alpha_{1}+1} p_{2}^{\alpha_{2}+1} \ldots p_{m}^{\alpha_{m}+1}+(f(r)+r)-r \\
& >p_{1}^{\alpha_{1}} p_{2}^{\alpha_{2}} \ldots p_{m}^{\alpha_{m}}+f(r) \\
& \geq|f(M)-f(r)| .
\end{aligned}
$$

But since $M-r$ divides $f(M)-f(r)$ this can only be true if $f(r)=f(M)=f(1)$, which contradicts the choice of $r$.",2,"Assume that the set of primes dividing the values of the function $f$ is finite, say $S=\{p_1, \\dots, p_m\}$. Let $f(1)=p_{1}^{\\alpha_{1}} \\ldots p_{m}^{\\alpha_{m}}$. For any positive integer $r$ with $f(r) \neq f(1)$, define $M=1+p_{1}^{\\alpha_{1}+1} \\ldots p_{m}^{\\alpha_{m}+1} \\cdot(f(r)+r)$. Show that $f(M)=f(1)$.","By construction, $M-1 = p_{1}^{\\alpha_{1}+1} \\ldots p_{m}^{\\alpha_{m}+1} \\cdot(f(r)+r)$. The condition on $f$ implies that $M-1$ divides $f(M)-f(1)$. For each $i \\in \\{1, \\ldots, m\\}$, $p_{i}^{\\alpha_{i}+1}$ divides $M-1$, and therefore $p_{i}^{\\alpha_{i}+1}$ divides $f(M)-f(1)$. This means $f(M) \\equiv f(1) \\pmod{p_{i}^{\\alpha_{i}+1}}$. The $p_i$-adic valuation of $f(1)$ is $v_{p_i}(f(1)) = \\alpha_i$. The congruence implies $v_{p_i}(f(M)-f(1)) \\geq \\alpha_i+1$. If $v_{p_i}(f(M)) \neq v_{p_i}(f(1))$, then $v_{p_i}(f(M)-f(1)) = \\min(v_{p_i}(f(M)), v_{p_i}(f(1))) \\leq \\alpha_i$, a contradiction. Thus, $v_{p_i}(f(M)) = v_{p_i}(f(1)) = \\alpha_i$ for all $i$. Since the only prime factors of $f(M)$ are in $S$, $f(M)$ and $f(1)$ must have the same prime factorization, so $f(M)=f(1)$.","Let $f$ be a non-constant function from the set of positive integers into the set of positive integers, such that $a-b$ divides $f(a)-f(b)$ for all distinct positive integers $a, b$. Prove that there exist infinitely many primes $p$ such that $p$ divides $f(c)$ for some positive integer $c$.","Assume for contradiction that the set of prime divisors of the values of $f$ is finite, $S=\\{p_1, \\ldots, p_m\\}$. Since $f$ is non-constant, $m \\ge 1$. Let $f(1)=p_{1}^{\\alpha_{1}} \\ldots p_{m}^{\\alpha_{m}}$. Since $f$ is non-constant, choose a positive integer $r$ such that $f(r) \neq f(1)$. Define $M=1+K(f(r)+r)$ where $K=p_{1}^{\\alpha_{1}+1} \\ldots p_{m}^{\\alpha_{m}+1}$. From the previous sub-problem, we have $f(M)=f(1)$. The condition $M-r$ divides $f(M)-f(r)$ holds. Since $f(M)=f(1)$, this means $M-r$ divides $f(1)-f(r)$. As $f(1) \neq f(r)$, $f(1)-f(r)$ is a non-zero integer. Divisibility implies $|M-r| \\le |f(1)-f(r)|$. However, $M-r = 1+K(f(r)+r)-r = 1+K f(r)+(K-1)r$. Since $K = \\prod p_i^{\\alpha_i+1} > \\prod p_i^{\\alpha_i} = f(1)$, and $f(r), r$ are positive integers, we have $M-r > K > f(1)$. Also, $M-r > K f(r) \\ge f(r)$. Thus, $M-r > \\max(f(1), f(r)) \\ge |f(1)-f(r)| = |f(M)-f(r)|$. The strict inequality $|M-r| > |f(M)-f(r)|$ contradicts the divisibility condition unless $f(M)-f(r)=0$. This would mean $f(M)=f(r)$, which implies $f(1)=f(r)$, contradicting the choice of $r$. Therefore, the initial assumption must be false.",,,,
2009n5,"Let $P(x)$ be a non-constant polynomial with integer coefficients. Prove that there is no function $T$ from the set of integers into the set of integers such that the number of integers $x$ with $T^{n}(x)=x$ is equal to $P(n)$ for every $n \geq 1$, where $T^{n}$ denotes the $n$-fold application of $T$.","Assume there is a polynomial $P$ of degree at least 1 with the desired property for a given function $T$. Let $A(n)$ denote the set of all $x \in \mathbb{Z}$ such that $T^{n}(x)=x$ and let $B(n)$ denote the set of all $x \in \mathbb{Z}$ for which $T^{n}(x)=x$ and $T^{k}(x) \neq x$ for all $1 \leq k<n$. Both sets are finite under the assumption made. For each $x \in A(n)$ there is a smallest $k \geq 1$ such that $T^{k}(x)=x$, i.e., $x \in B(k)$. Let $d=\operatorname{gcd}(k, n)$. There are positive integers $r, s$ such that $r k-s n=d$ and hence $x=T^{r k}(x)=T^{s n+d}(x)=T^{d}\left(T^{s n}(x)\right)=T^{d}(x)$. The minimality of $k$ implies $d=k$, i.e., $k \mid n$. On the other hand one clearly has $B(k) \subset A(n)$ if $k \mid n$ and thus we have $A(n)=\bigcup_{d \mid n} B(d)$ as a disjoint union and hence

$$
|A(n)|=\sum_{d \mid n}|B(d)| .
$$

Furthermore, for every $x \in B(n)$ the elements $x, T^{1}(x), T^{2}(x), \ldots, T^{n-1}(x)$ are $n$ distinct elements of $B(n)$. The fact that they are in $A(n)$ is obvious. If for some $k<n$ and some $0 \leq i<n$ we had $T^{k}\left(T^{i}(x)\right)=T^{i}(x)$, i.e. $\quad T^{k+i}(x)=T^{i}(x)$, that would imply $x=T^{n}(x)=T^{n-i}\left(T^{i}(x)\right)=T^{n-i}\left(T^{k+i}(x)\right)=T^{k}\left(T^{n}(x)\right)=T^{k}(x)$ contradicting the minimality of $n$. Thus $T^{i}(x) \in B(n)$ and $T^{i}(x) \neq T^{j}(x)$ for $0 \leq i<j \leq n-1$.\\
So indeed, $T$ permutes the elements of $B(n)$ in (disjoint) cycles of length $n$ and in particular one has $n||B(n)|$.\\
Now let $P(x)=\sum_{i=0}^{k} a_{i} x^{i}, a_{i} \in \mathbb{Z}, k \geq 1, a_{k} \neq 0$ and suppose that $|A(n)|=P(n)$ for all $n \geq 1$. Let $p$ be any prime. Then

$$
p^{2}| | B\left(p^{2}\right)\left|=\left|A\left(p^{2}\right)\right|-|A(p)|=a_{1}\left(p^{2}-p\right)+a_{2}\left(p^{4}-p^{2}\right)+\ldots\right.
$$

Hence $p \mid a_{1}$ and since this is true for all primes we must have $a_{1}=0$.\\
Now consider any two different primes $p$ and $q$. Since $a_{1}=0$ we have that

$$
\left|A\left(p^{2} q\right)\right|-|A(p q)|=a_{2}\left(p^{4} q^{2}-p^{2} q^{2}\right)+a_{3}\left(p^{6} q^{3}-p^{3} q^{3}\right)+\ldots
$$

is a multiple of $p^{2} q$. But we also have

$$
p^{2} q| | B\left(p^{2} q\right)\left|=\left|A\left(p^{2} q\right)\right|-|A(p q)|-\left|B\left(p^{2}\right)\right| .\right.
$$

This implies

$$
p^{2} q| | B\left(p^{2}\right)\left|=\left|A\left(p^{2}\right)\right|-|A(p)|=a_{2}\left(p^{4}-p^{2}\right)+a_{3}\left(p^{6}-p^{3}\right)+\cdots+a_{k}\left(p^{2 k}-p^{k}\right) .\right.
$$

Since this is true for every prime $q$ we must have $a_{2}\left(p^{4}-p^{2}\right)+a_{3}\left(p^{6}-p^{3}\right)+\cdots+a_{k}\left(p^{2 k}-p^{k}\right)=0$ for every prime $p$. Since this expression is a polynomial in $p$ of degree $2 k$ (because $a_{k} \neq 0$ ) this is a contradiction, as such a polynomial can have at most $2 k$ zeros.",3,Let $A(n) = \{x \in \mathbb{Z} \mid T^n(x)=x\}$ and $B(n) = \{x \in \mathbb{Z} \mid T^n(x)=x \text{ and } T^k(x) \neq x \text{ for } 1 \le k < n\}$. Prove that $|A(n)| = \sum_{d|n} |B(d)|$ and that $n$ must divide $|B(n)|$.,"For any $x \in A(n)$, let $k$ be the smallest positive integer such that $T^k(x)=x$. Then $k$ must divide $n$. This partitions $A(n)$ into the disjoint union $A(n) = \bigcup_{d|n} B(d)$, so $|A(n)| = \sum_{d|n} |B(d)|$. For any $x \in B(n)$, the elements $\{x, T(x), \dots, T^{n-1}(x)\}$ are $n$ distinct elements, all of which are in $B(n)$. Thus, the set $B(n)$ is partitioned into disjoint cycles of length $n$. Consequently, $|B(n)|$ must be a multiple of $n$.","Assume there exists a non-constant polynomial $P(x) = \sum_{i=0}^{k} a_i x^i$ with integer coefficients such that $|A(n)| = P(n)$ for all $n \ge 1$. Using the result from the previous sub-problem, prove that the coefficient $a_1$ must be zero.","From the first sub-problem, $n \mid |B(n)|$. For any prime $p$, let $n=p^2$. We have $|B(p^2)| = |A(p^2)| - |A(p)| = P(p^2) - P(p)$. Since $p^2$ must divide $|B(p^2)|$, we have $p^2 \mid P(p^2) - P(p)$. The expression is $P(p^2) - P(p) = \sum_{i=0}^k a_i(p^{2i} - p^i) = a_1(p^2-p) + a_2(p^4-p^2) + \dots$. Since $p^2$ divides $a_i(p^{2i} - p^i)$ for all $i \ge 2$, it must be that $p^2 \mid a_1(p^2-p) = a_1 p(p-1)$. This implies $p \mid a_1(p-1)$. As $p$ is prime and does not divide $p-1$, we must have $p \mid a_1$. Since this holds for every prime $p$, it follows that $a_1=0$.","Let $P(x)$ be a non-constant polynomial with integer coefficients. Prove that there is no function $T$ from the set of integers into the set of integers such that the number of integers $x$ with $T^{n}(x)=x$ is equal to $P(n)$ for every $n \geq 1$, where $T^{n}$ denotes the $n$-fold application of $T$.","Assume such a function $T$ and polynomial $P(x)$ exist. From sub-problem 1, $n \mid |B(n)|$, and from sub-problem 2, the coefficient $a_1$ of $P(x)$ is 0. Let $p$ and $q$ be distinct primes. We have $p^2q \mid |B(p^2q)|$. Also, $|B(p^2q)| = |A(p^2q)| - |A(pq)| - |B(p^2)|$. The term $|A(p^2q)| - |A(pq)| = P(p^2q) - P(pq) = \sum_{i=2}^k a_i((p^2q)^i - (pq)^i)$ is divisible by $(pq)^2$, and thus by $p^2q$. This implies $p^2q \mid |B(p^2)|$. As this holds for any prime $q \neq p$, $|B(p^2)|$ must be 0. So, for every prime $p$, we have $|B(p^2)| = P(p^2) - P(p) = 0$. The polynomial $Q(x) = P(x^2) - P(x) = \sum_{i=2}^k a_i(x^{2i} - x^i)$ is zero for infinitely many values (all primes), so it must be the zero polynomial. This implies $a_i=0$ for all $i \ge 2$. Combined with $a_1=0$, this means $P(x)=a_0$, a constant polynomial, which contradicts the problem statement.",,
2009n6,"Let $k$ be a positive integer. Show that if there exists a sequence $a_{0}, a_{1}, \ldots$ of integers satisfying the condition

$$
a_{n}=\frac{a_{n-1}+n^{k}}{n} \quad \text { for all } n \geq 1,
$$

then $k-2$ is divisible by 3 .","Part $A$. For each positive integer $k$, there exists a polynomial $P_{k}$ of degree $k-1$ with integer coefficients, i.e., $P_{k} \in \mathbb{Z}[x]$, and an integer $q_{k}$ such that the polynomial identity


\begin{equation*}
x P_{k}(x)=x^{k}+P_{k}(x-1)+q_{k} \tag{k}
\end{equation*}


is satisfied. To prove this, for fixed $k$ we write

$$
P_{k}(x)=b_{k-1} x^{k-1}+\cdots+b_{1} x+b_{0}
$$

and determine the coefficients $b_{k-1}, b_{k-2}, \ldots, b_{0}$ and the number $q_{k}$ successively. Obviously, we have $b_{k-1}=1$. For $m=k-1, k-2, \ldots, 1$, comparing the coefficients of $x^{m}$ in the identity ( $I_{k}$ ) results in an expression of $b_{m-1}$ as an integer linear combination of $b_{k-1}, \ldots, b_{m}$, and finally $q_{k}=-P_{k}(-1)$.\\
Part B. Let $k$ be a positive integer, and let $a_{0}, a_{1}, \ldots$ be a sequence of real numbers satisfying the recursion given in the problem. This recursion can be written as

$$
a_{n}-P_{k}(n)=\frac{a_{n-1}-P_{k}(n-1)}{n}-\frac{q_{k}}{n} \quad \text { for all } n \geq 1
$$

which by induction gives

$$
a_{n}-P_{k}(n)=\frac{a_{0}-P_{k}(0)}{n!}-q_{k} \sum_{i=0}^{n-1} \frac{i!}{n!} \quad \text { for all } n \geq 1 .
$$

Therefore, the numbers $a_{n}$ are integers for all $n \geq 1$ only if

$$
a_{0}=P_{k}(0) \quad \text { and } \quad q_{k}=0 .
$$

Part C. Multiplying the identity $\left(I_{k}\right)$ by $x^{2}+x$ and subtracting the identities $\left(I_{k+1}\right),\left(I_{k+2}\right)$ and $q_{k} x^{2}=q_{k} x^{2}$ therefrom, we obtain

$$
x T_{k}(x)=T_{k}(x-1)+2 x\left(P_{k}(x-1)+q_{k}\right)-\left(q_{k+2}+q_{k+1}+q_{k}\right),
$$

where the polynomials $T_{k} \in \mathbb{Z}[x]$ are defined by $T_{k}(x)=\left(x^{2}+x\right) P_{k}(x)-P_{k+1}(x)-P_{k+2}(x)-q_{k} x$. Thus

$$
x T_{k}(x) \equiv T_{k}(x-1)+q_{k+2}+q_{k+1}+q_{k} \bmod 2, \quad k=1,2, \ldots
$$

Comparing the degrees, we easily see that this is only possible if $T_{k}$ is the zero polynomial modulo 2 , and

$$
q_{k+2} \equiv q_{k+1}+q_{k} \bmod 2 \quad \text { for } k=1,2, \ldots
$$

Since $q_{1}=-1$ and $q_{2}=0$, these congruences finish the proof.",3,"For each positive integer $k$, show that there exists a polynomial $P_k(x)$ with integer coefficients of degree $k-1$ and an integer $q_k$ such that the identity $x P_k(x)=x^{k}+P_k(x-1)+q_{k}$ holds.","Let $P_k(x) = b_{k-1}x^{k-1} + \dots + b_0$. Substituting into the identity $xP_k(x) - P_k(x-1) = x^k + q_k$ and comparing coefficients of powers of $x$ from $k$ down to $0$ successively determines the integer coefficients $b_{k-1}, \dots, b_0$ and the integer $q_k$. Specifically, comparing the coefficients of $x^k$ gives $b_{k-1}=1$. For $m=k-1, \dots, 1$, comparing coefficients of $x^m$ expresses $b_{m-1}$ as an integer linear combination of $b_m, \dots, b_{k-1}$. Finally, the constant term gives $q_k = -P_k(-1)$, which is an integer.","Let $k$ be a positive integer and $P_k, q_k$ be as defined in the previous part. Show that if a sequence of integers $a_0, a_1, \ldots$ exists satisfying $a_n = \frac{a_{n-1} + n^k}{n}$ for $n \geq 1$, then it is necessary that $q_k = 0$.","The recurrence is $na_n = a_{n-1} + n^k$. Using the identity $n^k = nP_k(n) - P_k(n-1) - q_k$, we get $n(a_n - P_k(n)) = (a_{n-1} - P_k(n-1)) - q_k$. Let $c_n = a_n - P_k(n)$, which must be an integer. The relation is $nc_n = c_{n-1} - q_k$. Unfolding this gives $c_n = \frac{c_0}{n!} - q_k \sum_{j=0}^{n-1} \frac{j!}{n!}$. As $n \to \infty$, $c_n \to 0$. Since each $c_n$ must be an integer, we must have $c_n=0$ for all sufficiently large $n$. The relation $nc_n = c_{n-1} - q_k$ for large $n$ where $c_n=c_{n-1}=0$ implies $0=0-q_k$, so $q_k=0$.","Let $k$ be a positive integer. Show that if there exists a sequence $a_{0}, a_{1}, \ldots$ of integers satisfying the condition $a_{n}=\frac{a_{n-1}+n^{k}}{n}$ for all $n \geq 1$, then $k-2$ is divisible by 3.","From the previous part, the existence of the integer sequence implies $q_k=0$. By manipulating the polynomial identity for $k, k+1, k+2$, we can derive the recurrence relation $q_{k+2} \equiv q_{k+1} + q_k \pmod 2$ for $k \ge 1$. We compute the first two terms directly: $q_1 = -1$ and $q_2=0$. The sequence $q_k \pmod 2$ starts $1, 0, 1, 1, 0, 1, \ldots$, which is periodic with period 3. The condition $q_k=0$ implies $q_k \equiv 0 \pmod 2$. This occurs precisely when $k \equiv 2 \pmod 3$, which is equivalent to $k-2$ being divisible by 3.",,
2009n7,Let $a$ and $b$ be distinct integers greater than 1 . Prove that there exists a positive integer $n$ such that $\left(a^{n}-1\right)\left(b^{n}-1\right)$ is not a perfect square.,"At first we notice that

\begin{align*}
(1-\alpha)^{\frac{1}{2}}(1-\beta)^{\frac{1}{2}} & =\left(1-\frac{1}{2} \cdot \alpha-\frac{1}{8} \cdot \alpha^{2}-\cdots\right)\left(1-\frac{1}{2} \cdot \beta-\frac{1}{8} \cdot \beta^{2}-\cdots\right) \\
& =\sum_{k, \ell \geq 0} c_{k, \ell} \cdot \alpha^{k} \beta^{\ell} \quad \text { for all } \alpha, \beta \in(0,1), \tag{1}
\end{align*}

where $c_{0,0}=1$ and $c_{k, \ell}$ are certain coefficients.\\
For an indirect proof, we suppose that $x_{n}=\sqrt{\left(a^{n}-1\right)\left(b^{n}-1\right)} \in \mathbb{Z}$ for all positive integers $n$. Replacing $a$ by $a^{2}$ and $b$ by $b^{2}$ if necessary, we may assume that $a$ and $b$ are perfect squares, hence $\sqrt{a b}$ is an integer.\\
At first we shall assume that $a^{\mu} \neq b^{\nu}$ for all positive integers $\mu, \nu$. We have

\begin{equation*}
x_{n}=(\sqrt{a b})^{n}\left(1-\frac{1}{a^{n}}\right)^{\frac{1}{2}}\left(1-\frac{1}{b^{n}}\right)^{\frac{1}{2}}=\sum_{k, \ell \geq 0} c_{k, \ell}\left(\frac{\sqrt{a b}}{a^{k} b^{\ell}}\right)^{n} . \tag{2}
\end{equation*}

Choosing $k_{0}$ and $\ell_{0}$ such that $a^{k_{0}}>\sqrt{a b}, b^{\ell_{0}}>\sqrt{a b}$, we define the polynomial

$$
P(x)=\prod_{k=0, \ell=0}^{k_{0}-1, \ell_{0}-1}\left(a^{k} b^{\ell} x-\sqrt{a b}\right)=: \sum_{i=0}^{k_{0} \cdot \ell_{0}} d_{i} x^{i}
$$

with integer coefficients $d_{i}$. By our assumption, the zeros

$$
\frac{\sqrt{a b}}{a^{k} b^{\ell}}, \quad k=0, \ldots, k_{0}-1, \quad \ell=0, \ldots, \ell_{0}-1,
$$

of $P$ are pairwise distinct.\\
Furthermore, we consider the integer sequence

\begin{equation*}
y_{n}=\sum_{i=0}^{k_{0} \cdot \ell_{0}} d_{i} x_{n+i}, \quad n=1,2, \ldots \tag{3}
\end{equation*}

By the theory of linear recursions, we obtain

\begin{equation*}
y_{n}=\sum_{\substack{k, \ell \geq 0 \\ k \geq k_{0} \text { or } \ell \geq \ell_{0}}} e_{k, \ell}\left(\frac{\sqrt{a b}}{a^{k} b^{\ell}}\right)^{n}, \quad n=1,2, \ldots, \tag{4}
\end{equation*}

with real numbers $e_{k, \ell}$. We have

$$
\left|y_{n}\right| \leq \sum_{\substack{k, \ell \geq 0 \\ k \geq k_{0} \text { or } \ell \geq \ell_{0}}}\left|e_{k, \ell}\right|\left(\frac{\sqrt{a b}}{a^{k} b^{\ell}}\right)^{n}=: M_{n} .
$$

Because the series in (4) is obtained by a finite linear combination of the absolutely convergent series (11), we conclude that in particular $M_{1}<\infty$. Since

$$
\frac{\sqrt{a b}}{a^{k} b^{\ell}} \leq \lambda:=\max \left\{\frac{\sqrt{a b}}{a^{k_{0}}}, \frac{\sqrt{a b}}{b^{\ell_{0}}}\right\} \quad \text { for all } k, \ell \geq 0 \text { such that } k \geq k_{0} \text { or } \ell \geq \ell_{0}
$$

we get the estimates $M_{n+1} \leq \lambda M_{n}, n=1,2, \ldots$ Our choice of $k_{0}$ and $\ell_{0}$ ensures $\lambda<1$, which implies $M_{n} \rightarrow 0$ and consequently $y_{n} \rightarrow 0$ as $n \rightarrow \infty$. It follows that $y_{n}=0$ for all sufficiently large $n$.\\
So, equation (3) reduces to $\sum_{i=0}^{k_{0} \cdot \ell_{0}} d_{i} x_{n+i}=0$.\\
Using the theory of linear recursions again, for sufficiently large $n$ we have

$$
x_{n}=\sum_{k=0, \ell=0}^{k_{0}-1, \ell_{0}-1} f_{k, \ell}\left(\frac{\sqrt{a b}}{a^{k} b^{\ell}}\right)^{n}
$$

for certain real numbers $f_{k, \ell}$.\\
Comparing with (2), we see that $f_{k, \ell}=c_{k, \ell}$ for all $k, \ell \geq 0$ with $k<k_{0}, \ell<\ell_{0}$, and $c_{k, \ell}=0$ if $k \geq k_{0}$ or $\ell \geq \ell_{0}$, since we assumed that $a^{\mu} \neq b^{\nu}$ for all positive integers $\mu, \nu$.\\
In view of (1), this means

\begin{equation*}
(1-\alpha)^{\frac{1}{2}}(1-\beta)^{\frac{1}{2}}=\sum_{k=0, \ell=0}^{k_{0}-1, \ell_{0}-1} c_{k, \ell} \cdot \alpha^{k} \beta^{\ell} \tag{5}
\end{equation*}

for all real numbers $\alpha, \beta \in(0,1)$. We choose $k^{*}<k_{0}$ maximal such that there is some $i$ with $c_{k^{*}, i} \neq 0$. Squaring (5) and comparing coefficients of $\alpha^{2 k^{*}} \beta^{2 i^{*}}$, where $i^{*}$ is maximal with $c_{k^{*}, i^{*}} \neq 0$, we see that $k^{*}=0$. This means that the right hand side of (5) is independent of $\alpha$, which is clearly impossible.\\
We are left with the case that $a^{\mu}=b^{\nu}$ for some positive integers $\mu$ and $\nu$. We may assume that $\mu$ and $\nu$ are relatively prime. Then there is some positive integer $c$ such that $a=c^{\nu}$ and $b=c^{\mu}$. Now starting with the expansion (2), i. e.,

$$
x_{n}=\sum_{j \geq 0} g_{j}\left(\frac{\sqrt{c^{\mu+\nu}}}{c^{j}}\right)^{n}
$$

for certain coefficients $g_{j}$, and repeating the arguments above, we see that $g_{j}=0$ for sufficiently large $j$, say $j>j_{0}$. But this means that

$$
\left(1-x^{\mu}\right)^{\frac{1}{2}}\left(1-x^{\nu}\right)^{\frac{1}{2}}=\sum_{j=0}^{j_{0}} g_{j} x^{j}
$$

for all real numbers $x \in(0,1)$. Squaring, we see that

$$
\left(1-x^{\mu}\right)\left(1-x^{\nu}\right)
$$

is the square of a polynomial in $x$. In particular, all its zeros are of order at least 2 , which implies $\mu=\nu$ by looking at roots of unity. So we obtain $\mu=\nu=1$, i. e., $a=b$, a contradiction.",4,"Let $a=c^\nu$ and $b=c^\mu$ for an integer $c>1$ and distinct, coprime positive integers $\mu, \nu$. Prove that there exists a positive integer $n$ such that $(a^n-1)(b^n-1)$ is not a perfect square.","Assume for contradiction that $(c^{\nu n}-1)(c^{\mu n}-1)$ is a perfect square for all $n$. This would imply that the polynomial $P(x) = (1-x^\nu)(1-x^\mu)$ is the square of a polynomial in $x$. For this to be true, all roots of $P(x)$ must have even multiplicity. The roots of $P(x)$ are the $\nu$-th and $\mu$-th roots of unity. Since $\mu$ and $\nu$ are distinct and coprime, any primitive $\mu$-th root of unity (for $\mu>1$) is a root of $P(x)$ of multiplicity 1, a contradiction. Therefore, we must have $\mu=\nu$. As they are coprime, $\mu=\nu=1$, which implies $a=b$, contradicting that they are distinct.","Let $a, b$ be distinct integers greater than 1 such that $a^\mu \neq b^\nu$ for all positive integers $\mu, \nu$. If $x_n = \sqrt{(a^n-1)(b^n-1)}$ is an integer for all $n \in \mathbb{Z}^+$, show that the sequence ${x_n}$ must satisfy a non-trivial linear recurrence relation with constant coefficients for all sufficiently large $n$.","We can assume $ab$ is a perfect square (by replacing $a,b$ with $a^2, b^2$ if needed). Expand $x_n = (\sqrt{ab})^n (1-a^{-n})^{1/2}(1-b^{-n})^{1/2}$ into a power series $x_n = \sum_{k, \ell \ge 0} c_{k, \ell} \lambda_{k,\ell}^n$, where $\lambda_{k,\ell} = \frac{\sqrt{ab}}{a^k b^\ell}$. Choose $k_0, \ell_0$ large enough such that $|\lambda_{k,\ell}| < 1$ for all $(k, \ell)$ where $k \ge k_0$ or $\ell \ge \ell_0$. Construct a polynomial $P(z) = \sum d_i z^i$ with integer coefficients whose roots are ${\lambda_{k,\ell} : 0 \le k < k_0, 0 \le \ell < \ell_0}$. The integer sequence $y_n = \sum d_i x_{n+i}$ is a linear combination of terms $\lambda_{k,\ell}^n$ where $k \ge k_0$ or $\ell \ge \ell_0$. These terms decay exponentially, so $y_n \to 0$ as $n \to \infty$. Since $y_n$ are integers, $y_n=0$ for all large $n$, which means $x_n$ satisfies a linear recurrence relation.","Let $a, b$ be as in the previous sub-problem. Show that if the integer sequence $x_n = \sqrt{(a^n-1)(b^n-1)}$ satisfies a linear recurrence relation, then the Maclaurin series for $f(\alpha, \beta) = (1-\alpha)^{1/2}(1-\beta)^{1/2}$ must be a finite polynomial.","A sequence satisfying a linear recurrence can be expressed as a finite sum of terms of the form $P(n)\lambda^n$. Here, $x_n$ can be expressed as an infinite series $x_n = \sum_{k, \ell \ge 0} c_{k, \ell} \lambda_{k,\ell}^n$, where $c_{k,\ell}$ are the Maclaurin coefficients of $(1-\alpha)^{1/2}(1-\beta)^{1/2}$ and $\lambda_{k,\ell} = \frac{\sqrt{ab}}{a^k b^\ell}$. The condition $a^\mu \neq b^\nu$ ensures the bases $\lambda_{k,\ell}$ are distinct. The recurrence implies $x_n$ must be a finite sum of such terms for large $n$. By comparing the two expressions for $x_n$, the coefficients $c_{k, \ell}$ must be zero beyond a certain point. This means the Maclaurin series is a finite polynomial.",Let $a$ and $b$ be distinct integers greater than 1. Prove that there exists a positive integer $n$ such that $(a^n-1)(b^n-1)$ is not a perfect square.,"Assume for contradiction that $(a^n-1)(b^n-1)$ is a perfect square for all positive integers $n$. We consider two exhaustive cases. Case 1: $a^\mu = b^\nu$ for some positive integers $\mu, \nu$. As shown in sub-problem 1, this leads to the contradiction $a=b$. Case 2: $a^\mu \neq b^\nu$ for all positive integers $\mu, \nu$. As shown in sub-problems 2 and 3, the assumption implies that the Maclaurin series for $(1-\alpha)^{1/2}(1-\beta)^{1/2}$ is a finite polynomial. This is false, as the expansion of $(1-\alpha)^{1/2}$ is an infinite series, which means the product is not a finite polynomial in $\alpha$. This is a contradiction. Since both cases lead to a contradiction, the initial assumption is false."
2008a2,"(a) Prove the inequality

$$
\frac{x^{2}}{(x-1)^{2}}+\frac{y^{2}}{(y-1)^{2}}+\frac{z^{2}}{(z-1)^{2}} \geq 1
$$

for real numbers $x, y, z \neq 1$ satisfying the condition $x y z=1$.\\
(b) Show that there are infinitely many triples of rational numbers $x, y, z$ for which this inequality turns into equality.","(a) We start with the substitution

$$
\frac{x}{x-1}=a, \quad \frac{y}{y-1}=b, \quad \frac{z}{z-1}=c, \quad \text { i.e., } \quad x=\frac{a}{a-1}, \quad y=\frac{b}{b-1}, \quad z=\frac{c}{c-1} .
$$

The inequality to be proved reads $a^{2}+b^{2}+c^{2} \geq 1$. The new variables are subject to the constraints $a, b, c \neq 1$ and the following one coming from the condition $x y z=1$,

$$
(a-1)(b-1)(c-1)=a b c .
$$

This is successively equivalent to

$$
\begin{aligned}
a+b+c-1 & =a b+b c+c a, \\
2(a+b+c-1) & =(a+b+c)^{2}-\left(a^{2}+b^{2}+c^{2}\right), \\
a^{2}+b^{2}+c^{2}-2 & =(a+b+c)^{2}-2(a+b+c), \\
a^{2}+b^{2}+c^{2}-1 & =(a+b+c-1)^{2}
\end{aligned}
$$

Thus indeed $a^{2}+b^{2}+c^{2} \geq 1$, as desired.\\
(b) From the equation $a^{2}+b^{2}+c^{2}-1=(a+b+c-1)^{2}$ we see that the proposed inequality becomes an equality if and only if both sums $a^{2}+b^{2}+c^{2}$ and $a+b+c$ have value 1 . The first of them is equal to $(a+b+c)^{2}-2(a b+b c+c a)$. So the instances of equality are described by the system of two equations

$$
a+b+c=1, \quad a b+b c+c a=0
$$

plus the constraint $a, b, c \neq 1$. Elimination of $c$ leads to $a^{2}+a b+b^{2}=a+b$, which we regard as a quadratic equation in $b$,

$$
b^{2}+(a-1) b+a(a-1)=0,
$$

with discriminant

$$
\Delta=(a-1)^{2}-4 a(a-1)=(1-a)(1+3 a) .
$$

We are looking for rational triples $(a, b, c)$; it will suffice to have $a$ rational such that $1-a$ and $1+3 a$ are both squares of rational numbers (then $\Delta$ will be so too). Set $a=k / m$. We want $m-k$ and $m+3 k$ to be squares of integers. This is achieved for instance by taking $m=k^{2}-k+1$ (clearly nonzero); then $m-k=(k-1)^{2}, m+3 k=(k+1)^{2}$. Note that distinct integers $k$ yield distinct values of $a=k / m$.

And thus, if $k$ is any integer and $m=k^{2}-k+1, a=k / m$ then $\Delta=\left(k^{2}-1\right)^{2} / m^{2}$ and the quadratic equation has rational roots $b=\left(m-k \pm k^{2} \mp 1\right) /(2 m)$. Choose e.g. the larger root,

$$
b=\frac{m-k+k^{2}-1}{2 m}=\frac{m+(m-2)}{2 m}=\frac{m-1}{m} .
$$

Computing $c$ from $a+b+c=1$ then gives $c=(1-k) / m$. The condition $a, b, c \neq 1$ eliminates only $k=0$ and $k=1$. Thus, as $k$ varies over integers greater than 1 , we obtain an infinite family of rational triples ( $a, b, c$ ) -and coming back to the original variables ( $x=a /(a-1)$ etc.) -an infinite family of rational triples $(x, y, z)$ with the needed property. (A short calculation shows that the resulting triples are $x=-k /(k-1)^{2}, y=k-k^{2}, z=(k-1) / k^{2}$; but the proof was complete without listing them.)",3,"Let $a = \frac{x}{x-1}, b = \frac{y}{y-1}, c = \frac{z}{z-1}$ for $x, y, z \neq 1$. If $xyz=1$, derive the relationship between $a, b, c$.","The substitution implies $x=\frac{a}{a-1}, y=\frac{b}{b-1}, z=\frac{c}{c-1}$. The condition $xyz=1$ becomes $\frac{a}{a-1} \frac{b}{b-1} \frac{c}{c-1} = 1$, which is equivalent to $abc = (a-1)(b-1)(c-1)$. Expanding the right side gives $abc = abc - (ab+bc+ca) + (a+b+c) - 1$. This simplifies to the relationship $ab+bc+ca = a+b+c-1$.","Using the substitution $a = \frac{x}{x-1}, b = \frac{y}{y-1}, c = \frac{z}{z-1}$ and the derived relationship from the condition $xyz=1$, prove the inequality $\frac{x^{2}}{(x-1)^{2}}+\frac{y^{2}}{(y-1)^{2}}+\frac{z^{2}}{(z-1)^{2}} \geq 1$.","The inequality transforms into $a^2+b^2+c^2 \geq 1$. From Sub-problem 1, we know $ab+bc+ca = a+b+c-1$. Using the identity $(a+b+c)^2 = a^2+b^2+c^2+2(ab+bc+ca)$, we substitute the condition to get $(a+b+c)^2 = a^2+b^2+c^2 + 2(a+b+c-1)$. Rearranging gives $a^2+b^2+c^2 = (a+b+c)^2 - 2(a+b+c) + 2 = (a+b+c-1)^2+1$. Since $(a+b+c-1)^2 \geq 0$, it follows that $a^2+b^2+c^2 \geq 1$.","(a) Prove the inequality $\frac{x^{2}}{(x-1)^{2}}+\frac{y^{2}}{(y-1)^{2}}+\frac{z^{2}}{(z-1)^{2}} \geq 1$ for real numbers $x, y, z \neq 1$ satisfying the condition $x y z=1$. (b) Show that there are infinitely many triples of rational numbers $x, y, z$ for which this inequality turns into equality.","Part (a) is proven in Sub-problem 2. For part (b), equality holds if and only if $a^2+b^2+c^2=1$. From the proof in Sub-problem 2, this occurs if and only if $(a+b+c-1)^2=0$, which implies $a+b+c=1$. The condition from Sub-problem 1 then becomes $ab+bc+ca=0$. We need to find infinitely many rational solutions to the system $a+b+c=1$ and $ab+bc+ca=0$. Eliminating $c$ yields a quadratic in $b$: $b^2+(a-1)b+a(a-1)=0$. For rational solutions in $b$, the discriminant $\Delta=(1-a)(1+3a)$ must be a square of a rational number. Let $a=\frac{k}{k^2-k+1}$ for an integer $k$. Then $1-a = \frac{(k-1)^2}{k^2-k+1}$ and $1+3a = \frac{(k+1)^2}{k^2-k+1}$, making $\Delta$ a rational square. As $k$ varies over integers greater than 1, we get an infinite number of distinct rational values for $a$, which in turn generate an infinite number of rational triples $(a,b,c)$ and thus $(x,y,z)$ satisfying the equality.",,
2008a5,"Let $a, b, c, d$ be positive real numbers such that

$$
a b c d=1 \quad \text { and } \quad a+b+c+d>\frac{a}{b}+\frac{b}{c}+\frac{c}{d}+\frac{d}{a} .
$$","Prove that

$$
a+b+c+d<\frac{b}{a}+\frac{c}{b}+\frac{d}{c}+\frac{a}{d} .
$$

Solution. We show that if $a b c d=1$, the sum $a+b+c+d$ cannot exceed a certain weighted mean of the expressions $\frac{a}{b}+\frac{b}{c}+\frac{c}{d}+\frac{d}{a}$ and $\frac{b}{a}+\frac{c}{b}+\frac{d}{c}+\frac{a}{d}$.

By applying the AM-GM inequality to the numbers $\frac{a}{b}, \frac{a}{b}, \frac{b}{c}$ and $\frac{a}{d}$, we obtain

$$
a=\sqrt[4]{\frac{a^{4}}{a b c d}}=\sqrt[4]{\frac{a}{b} \cdot \frac{a}{b} \cdot \frac{b}{c} \cdot \frac{a}{d}} \leq \frac{1}{4}\left(\frac{a}{b}+\frac{a}{b}+\frac{b}{c}+\frac{a}{d}\right)
$$

Analogously,

$$
b \leq \frac{1}{4}\left(\frac{b}{c}+\frac{b}{c}+\frac{c}{d}+\frac{b}{a}\right), \quad c \leq \frac{1}{4}\left(\frac{c}{d}+\frac{c}{d}+\frac{d}{a}+\frac{c}{b}\right) \quad \text { and } \quad d \leq \frac{1}{4}\left(\frac{d}{a}+\frac{d}{a}+\frac{a}{b}+\frac{d}{c}\right)
$$

Summing up these estimates yields

$$
a+b+c+d \leq \frac{3}{4}\left(\frac{a}{b}+\frac{b}{c}+\frac{c}{d}+\frac{d}{a}\right)+\frac{1}{4}\left(\frac{b}{a}+\frac{c}{b}+\frac{d}{c}+\frac{a}{d}\right) .
$$

In particular, if $a+b+c+d>\frac{a}{b}+\frac{b}{c}+\frac{c}{d}+\frac{d}{a}$ then $a+b+c+d<\frac{b}{a}+\frac{c}{b}+\frac{d}{c}+\frac{a}{d}$.\\
Comment. The estimate in the above solution was obtained by applying the AM-GM inequality to each column of the $4 \times 4$ array

$$
\begin{array}{llll}
a / b & b / c & c / d & d / a \\
a / b & b / c & c / d & d / a \\
b / c & c / d & d / a & a / b \\
a / d & b / a & c / b & d / c
\end{array}
$$

and adding up the resulting inequalities. The same table yields a stronger bound: If $a, b, c, d>0$ and $a b c d=1$ then

$$
\left(\frac{a}{b}+\frac{b}{c}+\frac{c}{d}+\frac{d}{a}\right)^{3}\left(\frac{b}{a}+\frac{c}{b}+\frac{d}{c}+\frac{a}{d}\right) \geq(a+b+c+d)^{4} .
$$

It suffices to apply H锟斤拷lder's inequality to the sequences in the four rows, with weights $1 / 4$ :

$$
\begin{gathered}
\left(\frac{a}{b}+\frac{b}{c}+\frac{c}{d}+\frac{d}{a}\right)^{1 / 4}\left(\frac{a}{b}+\frac{b}{c}+\frac{c}{d}+\frac{d}{a}\right)^{1 / 4}\left(\frac{b}{c}+\frac{c}{d}+\frac{d}{a}+\frac{a}{b}\right)^{1 / 4}\left(\frac{a}{d}+\frac{b}{a}+\frac{c}{b}+\frac{d}{c}\right)^{1 / 4} \\
\geq\left(\frac{a a b a}{b b c d}\right)^{1 / 4}+\left(\frac{b b c b}{c c d a}\right)^{1 / 4}+\left(\frac{c c d c}{d d a b}\right)^{1 / 4}+\left(\frac{d d a d}{a a b c}\right)^{1 / 4}=a+b+c+d
\end{gathered}
$$",3,"Let $a, b, c, d$ be positive real numbers such that $abcd=1$. Prove that for each variable, for instance $a$, the following inequality holds: $a \le \frac{1}{4}(2\frac{a}{b} + \frac{b}{c} + \frac{a}{d})$.","Using the condition $abcd=1$, we can write $a = \sqrt[4]{a^4} = \sqrt[4]{a^4/abcd}$. We express the term under the radical as a product of four ratios: $a = \sqrt[4]{\frac{a}{b} \cdot \frac{a}{b} \cdot \frac{b}{c} \cdot \frac{a}{d}}$. Applying the AM-GM inequality to these four terms gives $a \le \frac{1}{4}(\frac{a}{b} + \frac{a}{b} + \frac{b}{c} + \frac{a}{d}) = \frac{1}{4}(2\frac{a}{b} + \frac{b}{c} + \frac{a}{d})$.","Let $a, b, c, d$ be positive real numbers with $abcd=1$. Prove that $a+b+c+d \le \frac{3}{4}(\frac{a}{b}+\frac{b}{c}+\frac{c}{d}+\frac{d}{a}) + \frac{1}{4}(\frac{b}{a}+\frac{c}{b}+\frac{d}{c}+\frac{a}{d})$.","By applying the AM-GM based method from the first sub-problem to each of the variables $a, b, c, d$, we derive four analogous inequalities:
$a \le \frac{1}{4}(2\frac{a}{b} + \frac{b}{c} + \frac{a}{d})$
$b \le \frac{1}{4}(2\frac{b}{c} + \frac{c}{d} + \frac{b}{a})$
$c \le \frac{1}{4}(2\frac{c}{d} + \frac{d}{a} + \frac{c}{b})$
$d \le \frac{1}{4}(2\frac{d}{a} + \frac{a}{b} + \frac{d}{c})$
Summing these four inequalities and collecting terms yields $a+b+c+d \le \frac{1}{4} [3(\frac{a}{b}+\frac{b}{c}+\frac{c}{d}+\frac{d}{a}) + (\frac{b}{a}+\frac{c}{b}+\frac{d}{c}+\frac{a}{d})]$, which is the desired result.","Let $a, b, c, d$ be positive real numbers such that $abcd=1$ and $a+b+c+d > \frac{a}{b}+\frac{b}{c}+\frac{c}{d}+\frac{d}{a}$. Prove that $a+b+c+d < \frac{b}{a}+\frac{c}{b}+\frac{d}{c}+\frac{a}{d}$.","Let $S=a+b+c+d$, $S_1=\frac{a}{b}+\frac{b}{c}+\frac{c}{d}+\frac{d}{a}$, and $S_2=\frac{b}{a}+\frac{c}{b}+\frac{d}{c}+\frac{a}{d}$. From the previous sub-problem, $S \le \frac{3}{4}S_1 + \frac{1}{4}S_2$. The given condition $S > S_1$ implies that $a,b,c,d$ are not all equal to 1, so the AM-GM inequalities used are strict. Thus, $S < \frac{3}{4}S_1 + \frac{1}{4}S_2$, which implies $4S < 3S_1 + S_2$. Rearranging gives $S_2 > 4S - 3S_1 = S + 3(S - S_1)$. Since we are given $S > S_1$, the term $S - S_1$ is positive. Therefore, $S_2 > S$, which completes the proof.",,
2008a6,"Let $f: \mathbb{R} \rightarrow \mathbb{N}$ be a function which satisfies


\begin{equation*}
f\left(x+\frac{1}{f(y)}\right)=f\left(y+\frac{1}{f(x)}\right) \quad \text { for all } x, y \in \mathbb{R} \tag{1}
\end{equation*}


Prove that there is a positive integer which is not a value of $f$.","Solution. Suppose that the statement is false and $f(\mathbb{R})=\mathbb{N}$. We prove several properties of the function $f$ in order to reach a contradiction.

To start with, observe that one can assume $f(0)=1$. Indeed, let $a \in \mathbb{R}$ be such that $f(a)=1$, and consider the function $g(x)=f(x+a)$. By substituting $x+a$ and $y+a$ for $x$ and $y$ in (1), we have

$$
g\left(x+\frac{1}{g(y)}\right)=f\left(x+a+\frac{1}{f(y+a)}\right)=f\left(y+a+\frac{1}{f(x+a)}\right)=g\left(y+\frac{1}{g(x)}\right) .
$$

So $g$ satisfies the functional equation (1), with the additional property $g(0)=1$. Also, $g$ and $f$ have the same set of values: $g(\mathbb{R})=f(\mathbb{R})=\mathbb{N}$. Henceforth we assume $f(0)=1$.\\
Claim 1. For an arbitrary fixed $c \in \mathbb{R}$ we have $\left\{f\left(c+\frac{1}{n}\right): n \in \mathbb{N}\right\}=\mathbb{N}$.\\
Proof. Equation (1) and $f(\mathbb{R})=\mathbb{N}$ imply\\
$f(\mathbb{R})=\left\{f\left(x+\frac{1}{f(c)}\right): x \in \mathbb{R}\right\}=\left\{f\left(c+\frac{1}{f(x)}\right): x \in \mathbb{R}\right\} \subset\left\{f\left(c+\frac{1}{n}\right): n \in \mathbb{N}\right\} \subset f(\mathbb{R})$.\\
The claim follows.\\
We will use Claim 1 in the special cases $c=0$ and $c=1 / 3$ :


\begin{equation*}
\left\{f\left(\frac{1}{n}\right): n \in \mathbb{N}\right\}=\left\{f\left(\frac{1}{3}+\frac{1}{n}\right): n \in \mathbb{N}\right\}=\mathbb{N} . \tag{2}
\end{equation*}


Claim 2. If $f(u)=f(v)$ for some $u, v \in \mathbb{R}$ then $f(u+q)=f(v+q)$ for all nonnegative rational $q$. Furthermore, if $f(q)=1$ for some nonnegative rational $q$ then $f(k q)=1$ for all $k \in \mathbb{N}$.\\
Proof. For all $x \in \mathbb{R}$ we have by (1)

$$
f\left(u+\frac{1}{f(x)}\right)=f\left(x+\frac{1}{f(u)}\right)=f\left(x+\frac{1}{f(v)}\right)=f\left(v+\frac{1}{f(x)}\right) .
$$

Since $f(x)$ attains all positive integer values, this yields $f(u+1 / n)=f(v+1 / n)$ for all $n \in \mathbb{N}$. Let $q=k / n$ be a positive rational number. Then $k$ repetitions of the last step yield

$$
f(u+q)=f\left(u+\frac{k}{n}\right)=f\left(v+\frac{k}{n}\right)=f(v+q) .
$$

Now let $f(q)=1$ for some nonnegative rational $q$, and let $k \in \mathbb{N}$. As $f(0)=1$, the previous conclusion yields successively $f(q)=f(2 q), f(2 q)=f(3 q), \ldots, f((k-1) q)=f(k q)$, as needed.\\
Claim 3. The equality $f(q)=f(q+1)$ holds for all nonnegative rational $q$.\\
Proof. Let $m$ be a positive integer such that $f(1 / m)=1$. Such an $m$ exists by (2). Applying the second statement of Claim 2 with $q=1 / m$ and $k=m$ yields $f(1)=1$.

Given that $f(0)=f(1)=1$, the first statement of Claim 2 implies $f(q)=f(q+1)$ for all nonnegative rational $q$.

Claim 4. The equality $f\left(\frac{1}{n}\right)=n$ holds for every $n \in \mathbb{N}$.\\
Proof. For a nonnegative rational $q$ we set $x=q, y=0$ in (1) and use Claim 3 to obtain

$$
f\left(\frac{1}{f(q)}\right)=f\left(q+\frac{1}{f(0)}\right)=f(q+1)=f(q) .
$$

By (2), for each $n \in \mathbb{N}$ there exists a $k \in \mathbb{N}$ such that $f(1 / k)=n$. Applying the last equation with $q=1 / k$, we have

$$
n=f\left(\frac{1}{k}\right)=f\left(\frac{1}{f(1 / k)}\right)=f\left(\frac{1}{n}\right) .
$$

Now we are ready to obtain a contradiction. Let $n \in \mathbb{N}$ be such that $f(1 / 3+1 / n)=1$. Such an $n$ exists by (2). Let $1 / 3+1 / n=s / t$, where $s, t \in \mathbb{N}$ are coprime. Observe that $t>1$ as $1 / 3+1 / n$ is not an integer. Choose $k, l \in \mathbb{N}$ so that that $k s-l t=1$.

Because $f(0)=f(s / t)=1$, Claim 2 implies $f(k s / t)=1$. Now $f(k s / t)=f(1 / t+l)$; on the other hand $f(1 / t+l)=f(1 / t)$ by $l$ successive applications of Claim 3. Finally, $f(1 / t)=t$ by Claim 4, leading to the impossible $t=1$. The solution is complete.",4,"Show that we may assume $f(0)=1$ without loss of generality. Then, assuming $f(\\mathbb{R}) = \\mathbb{N}$, show that for any $c \\in \\mathbb{R}$, the set of values $\{f(c+1/n) : n \\in \\mathbb{N}\}$ is $\\mathbb{N}$.","If $f(\\mathbb{R})=\\mathbb{N}$, there is an $a \\in \\mathbb{R}$ with $f(a)=1$. Define $g(x)=f(x+a)$. $g(x)$ satisfies the same functional equation as $f(x)$, with $g(0)=1$ and $g(\\mathbb{R})=f(\\mathbb{R})=\\mathbb{N}$. Thus, we can assume $f(0)=1$ without loss of generality. For the second part, substitute $y=c$ into the given equation: $f(x+1/f(c)) = f(c+1/f(x))$. The set of values of the LHS as $x$ ranges over $\\mathbb{R}$ is $f(\\mathbb{R})=\\mathbb{N}$. The set of values of the RHS is $\{f(c+1/f(x)) \\mid x \\in \\mathbb{R}\}$. Since $f(\\mathbb{R})=\\mathbb{N}$, this set is $\{f(c+1/n) \\mid n \\in \\mathbb{N}\}$. Therefore, $\{f(c+1/n) \\mid n \\in \\mathbb{N}\}=\\mathbb{N}$.","Assume $f(\\mathbb{R})=\\mathbb{N}$ and $f(0)=1$. Prove that if $f(u)=f(v)$, then $f(u+q)=f(v+q)$ for all non-negative rational numbers $q$. Furthermore, prove that if $f(q)=1$ for a non-negative rational $q$, then $f(kq)=1$ for all $k \\in \\mathbb{N}$.","Given $f(u)=f(v)$, the functional equation implies $f(u+1/f(x))=f(x+1/f(u))=f(x+1/f(v))=f(v+1/f(x))$. As $f(\\mathbb{R})=\\mathbb{N}$, $\{1/f(x) : x \\in \\mathbb{R}\} = \{1/n : n \\in \\mathbb{N}\}$. So $f(u+1/n)=f(v+1/n)$ for all $n \\in \\mathbb{N}$. Any non-negative rational $q=k/n$ can be formed by adding $1/n$ for $k$ times. Thus $f(u+q)=f(v+q)$. For the second part, assume $f(q)=1$ for a rational $q \\ge 0$. Since $f(0)=1$, the first part implies $f(0+r)=f(q+r)$ for any rational $r \\ge 0$. Setting $r=q$ gives $f(q)=f(2q)=1$. Setting $r=2q$ gives $f(2q)=f(3q)=1$. By induction, $f(kq)=1$ for all $k \\in \\mathbb{N}$.","Assuming $f(\\mathbb{R})=\\mathbb{N}$ and $f(0)=1$, prove that $f(1/n)=n$ for every $n \\in \\mathbb{N}$.","First, we show $f(q)=f(q+1)$ for any non-negative rational $q$. From Sub-problem 1, $\{f(1/k) : k \\in \\mathbb{N}\} = \\mathbb{N}$, so there exists $m \\in \\mathbb{N}$ with $f(1/m)=1$. From Sub-problem 2, since $f(1/m)=1$, we get $f(m \\cdot 1/m) = f(1)=1$. Now we have $f(0)=1$ and $f(1)=1$. Applying the result from Sub-problem 2 again gives $f(0+q)=f(1+q)$, so $f(q)=f(q+1)$ for all non-negative rationals $q$. Now, set $y=0$ and $x=q$ (a non-negative rational) in the original equation: $f(q+1/f(0)) = f(0+1/f(q))$, which is $f(q+1) = f(1/f(q))$. Since $f(q+1)=f(q)$, we have $f(q)=f(1/f(q))$. For any $n \\in \\mathbb{N}$, there is a $k \\in \\mathbb{N}$ such that $f(1/k)=n$. Letting $q=1/k$ gives $n=f(1/k)=f(1/f(1/k))=f(1/n)$.","Let $f: \\mathbb{R} \rightarrow \\mathbb{N}$ be a function which satisfies $f\\left(x+\frac{1}{f(y)}\right)=f\\left(y+\frac{1}{f(x)}\right)$ for all $x, y \\in \\mathbb{R}$. Prove that there is a positive integer which is not a value of $f$.","We prove by contradiction, assuming $f(\\mathbb{R})=\\mathbb{N}$. From Sub-problem 1, we can assume $f(0)=1$ and for any $c$, $\{f(c+1/n) : n \\in \\mathbb{N}\} = \\mathbb{N}$. Specifically, for $c=1/3$, there is an $n \\in \\mathbb{N}$ with $f(1/3+1/n)=1$. Let $q=1/3+1/n=s/t$ for coprime integers $s,t$. Since $q$ is not an integer, $t>1$. We have $f(0)=1$ and $f(s/t)=1$. From Sub-problem 2, $f(k \\cdot s/t)=1$ for any $k \\in \\mathbb{N}$. By Bézout's identity, we can find positive integers $k,l$ such that $ks-lt=1$. This implies $ks/t=l+1/t$. Then $f(l+1/t)=1$. From Sub-problem 3, we know $f(r)=f(r+1)$ for rational $r \\ge 0$, which implies $f(l+1/t)=f(1/t)$. Also from Sub-problem 3, $f(1/t)=t$. Thus we have $t=1$. This contradicts $t>1$. So the assumption $f(\\mathbb{R})=\\mathbb{N}$ is false."
2008a7,"Prove that for any four positive real numbers $a, b, c, d$ the inequality

$$
\frac{(a-b)(a-c)}{a+b+c}+\frac{(b-c)(b-d)}{b+c+d}+\frac{(c-d)(c-a)}{c+d+a}+\frac{(d-a)(d-b)}{d+a+b} \geq 0
$$

holds. Determine all cases of equality.","Denote the four terms by

$$
A=\frac{(a-b)(a-c)}{a+b+c}, \quad B=\frac{(b-c)(b-d)}{b+c+d}, \quad C=\frac{(c-d)(c-a)}{c+d+a}, \quad D=\frac{(d-a)(d-b)}{d+a+b} .
$$

The expression $2 A$ splits into two summands as follows,

$$
2 A=A^{\prime}+A^{\prime \prime} \quad \text { where } \quad A^{\prime}=\frac{(a-c)^{2}}{a+b+c}, \quad A^{\prime \prime}=\frac{(a-c)(a-2 b+c)}{a+b+c} ;
$$

this is easily verified. We analogously represent $2 B=B^{\prime}+B^{\prime \prime}, 2 C=C^{\prime}+C^{\prime \prime}, 2 B=D^{\prime}+D^{\prime \prime}$ and examine each of the sums $A^{\prime}+B^{\prime}+C^{\prime}+D^{\prime}$ and $A^{\prime \prime}+B^{\prime \prime}+C^{\prime \prime}+D^{\prime \prime}$ separately.

Write $s=a+b+c+d$; the denominators become $s-d, s-a, s-b, s-c$. By the CauchySchwarz inequality,

$$
\begin{aligned}
& \left(\frac{|a-c|}{\sqrt{s-d}} \cdot \sqrt{s-d}+\frac{|b-d|}{\sqrt{s-a}} \cdot \sqrt{s-a}+\frac{|c-a|}{\sqrt{s-b}} \cdot \sqrt{s-b}+\frac{|d-b|}{\sqrt{s-c}} \cdot \sqrt{s-c}\right)^{2} \\
& \quad \leq\left(\frac{(a-c)^{2}}{s-d}+\frac{(b-d)^{2}}{s-a}+\frac{(c-a)^{2}}{s-b}+\frac{(d-b)^{2}}{s-c}\right)(4 s-s)=3 s\left(A^{\prime}+B^{\prime}+C^{\prime}+D^{\prime}\right) .
\end{aligned}
$$

Hence


\begin{equation*}
A^{\prime}+B^{\prime}+C^{\prime}+D^{\prime} \geq \frac{(2|a-c|+2|b-d|)^{2}}{3 s} \geq \frac{16 \cdot|a-c| \cdot|b-d|}{3 s} . \tag{1}
\end{equation*}


Next we estimate the absolute value of the other sum. We couple $A^{\prime \prime}$ with $C^{\prime \prime}$ to obtain

$$
\begin{aligned}
A^{\prime \prime}+C^{\prime \prime} & =\frac{(a-c)(a+c-2 b)}{s-d}+\frac{(c-a)(c+a-2 d)}{s-b} \\
& =\frac{(a-c)(a+c-2 b)(s-b)+(c-a)(c+a-2 d)(s-d)}{(s-d)(s-b)} \\
& =\frac{(a-c)(-2 b(s-b)-b(a+c)+2 d(s-d)+d(a+c))}{s(a+c)+b d} \\
& =\frac{3(a-c)(d-b)(a+c)}{M}, \quad \text { with } \quad M=s(a+c)+b d .
\end{aligned}
$$

Hence by cyclic shift

$$
B^{\prime \prime}+D^{\prime \prime}=\frac{3(b-d)(a-c)(b+d)}{N}, \quad \text { with } \quad N=s(b+d)+c a .
$$

Thus


\begin{equation*}
A^{\prime \prime}+B^{\prime \prime}+C^{\prime \prime}+D^{\prime \prime}=3(a-c)(b-d)\left(\frac{b+d}{N}-\frac{a+c}{M}\right)=\frac{3(a-c)(b-d) W}{M N} \tag{2}
\end{equation*}


where


\begin{equation*}
W=(b+d) M-(a+c) N=b d(b+d)-a c(a+c) . \tag{3}
\end{equation*}


Note that


\begin{equation*}
M N>(a c(a+c)+b d(b+d)) s \geq|W| \cdot s . \tag{4}
\end{equation*}


Now (2) and (4) yield


\begin{equation*}
\left|A^{\prime \prime}+B^{\prime \prime}+C^{\prime \prime}+D^{\prime \prime}\right| \leq \frac{3 \cdot|a-c| \cdot|b-d|}{s} . \tag{5}
\end{equation*}


Combined with (1) this results in

$$
\begin{aligned}
& 2(A+B+C+D)=\left(A^{\prime}+B^{\prime}+C^{\prime}+D^{\prime}\right)+\left(A^{\prime \prime}+B^{\prime \prime}+C^{\prime \prime}+D^{\prime \prime}\right) \\
& \quad \geq \frac{16 \cdot|a-c| \cdot|b-d|}{3 s}-\frac{3 \cdot|a-c| \cdot|b-d|}{s}=\frac{7 \cdot|a-c| \cdot|b-d|}{3(a+b+c+d)} \geq 0 .
\end{aligned}
$$

This is the required inequality. From the last line we see that equality can be achieved only if either $a=c$ or $b=d$. Since we also need equality in (1), this implies that actually $a=c$ and $b=d$ must hold simultaneously, which is obviously also a sufficient condition.",3,"Let $a,b,c,d$ be positive real numbers and $s=a+b+c+d$. Define the sum $S_2 = \frac{(a-c)(a+c-2b)}{a+b+c}+\frac{(b-d)(b+d-2c)}{b+c+d}+\frac{(c-a)(c+a-2d)}{c+d+a}+\frac{(d-b)(d+b-2a)}{d+a+b}$. Prove that $|S_2| \leq \frac{3|a-c||b-d|}{s}$.","Let the four terms of the sum $S_2$ be $A'', B'', C'', D''$. We pair the terms as $(A''+C'')$ and $(B''+D'')$. We have $A''+C'' = \frac{3(a-c)(d-b)(a+c)}{M}$ where $M=s(a+c)+bd$, and by cyclic shift, $B''+D'' = \frac{3(b-d)(a-c)(b+d)}{N}$ where $N=s(b+d)+ca$. Summing these gives $S_2 = 3(a-c)(b-d)(\frac{b+d}{N}-\frac{a+c}{M}) = \frac{3(a-c)(b-d)W}{MN}$, where $W = (b+d)M-(a+c)N = bd(b+d)-ac(a+c)$. Since all variables are positive, $M=s(a+c)+bd$ and $N=s(b+d)+ca$, we have $MN > s(ac(a+c)+bd(b+d)) \ge s|ac(a+c)-bd(b+d)| = s|W|$. Therefore, $|S_2| = \frac{3|a-c||b-d||W|}{MN} \le \frac{3|a-c||b-d||W|}{s|W|} = \frac{3|a-c||b-d|}{s}$.","Let $a,b,c,d$ be positive real numbers and $s=a+b+c+d$. Define the sum $S_1 = \frac{(a-c)^2}{a+b+c}+\frac{(b-d)^2}{b+c+d}+\frac{(c-a)^2}{c+d+a}+\frac{(d-b)^2}{d+a+b}$. Prove that $S_1 \geq \frac{16|a-c||b-d|}{3s}$.","The denominators can be written in terms of $s$, so the sum is $S_1 = \frac{(a-c)^2}{s-d}+\frac{(b-d)^2}{s-a}+\frac{(c-a)^2}{s-b}+\frac{(d-b)^2}{s-c}$. By the Cauchy-Schwarz inequality, $(\sum x_i^2)(\sum y_i^2) \ge (\sum x_i y_i)^2$. Let $x_i = (\frac{|a-c|}{\sqrt{s-d}}, \frac{|b-d|}{\sqrt{s-a}}, \frac{|c-a|}{\sqrt{s-b}}, \frac{|d-b|}{\sqrt{s-c}})$ and $y_i=(\sqrt{s-d}, \sqrt{s-a}, \sqrt{s-b}, \sqrt{s-c})$. Then $\sum x_i^2 = S_1$, $\sum y_i^2 = (s-d)+(s-a)+(s-b)+(s-c) = 3s$, and $\sum x_i y_i = |a-c|+|b-d|+|c-a|+|d-b| = 2|a-c|+2|b-d|$. The inequality becomes $S_1 \cdot 3s \ge (2|a-c|+2|b-d|)^2$. By the AM-GM inequality, $(x+y)^2 \ge 4xy$, so $(2|a-c|+2|b-d|)^2 \ge 4(2|a-c|)(2|b-d|) = 16|a-c||b-d|$. Thus, $S_1 \ge \frac{(2|a-c|+2|b-d|)^2}{3s} \ge \frac{16|a-c||b-d|}{3s}$.","Prove that for any four positive real numbers $a, b, c, d$ the inequality

$$ \frac{(a-b)(a-c)}{a+b+c}+\frac{(b-c)(b-d)}{b+c+d}+\frac{(c-d)(c-a)}{c+d+a}+\frac{(d-a)(d-b)}{d+a+b} \geq 0 $$ 

holds. Determine all cases of equality.","Let the expression be $L$. Each term can be decomposed, e.g., $2\frac{(a-b)(a-c)}{a+b+c} = \frac{(a-c)^2}{a+b+c} + \frac{(a-c)(a+c-2b)}{a+b+c}$. Summing over all four terms gives $2L = S_1+S_2$, where $S_1$ and $S_2$ are the sums defined in the previous sub-problems. Using the established bounds, $2L = S_1+S_2 \ge S_1-|S_2| \ge \frac{16|a-c||b-d|}{3s} - \frac{3|a-c||b-d|}{s} = \frac{(16-9)|a-c||b-d|}{3s} = \frac{7|a-c||b-d|}{3s} \ge 0$, where $s=a+b+c+d>0$. This proves the inequality $L \ge 0$. Equality holds when all intermediate inequalities are equalities. The final expression $\frac{7|a-c||b-d|}{3s}$ is zero if and only if $a=c$ or $b=d$. For the Cauchy-Schwarz inequality to be an equality, we need $|a-c|=|b-d|$. If $a=c$, this implies $b=d$. If $b=d$, this implies $a=c$. Thus, equality holds if and only if $a=c$ and $b=d$.",,
2008c5,"Let $S=\left\{x_{1}, x_{2}, \ldots, x_{k+\ell}\right\}$ be a $(k+\ell)$-element set of real numbers contained in the interval $[0,1] ; k$ and $\ell$ are positive integers. A $k$-element subset $A \subset S$ is called nice if

$$
\left|\frac{1}{k} \sum_{x_{i} \in A} x_{i}-\frac{1}{\ell} \sum_{x_{j} \in S \backslash A} x_{j}\right| \leq \frac{k+\ell}{2 k \ell} .
$$

Prove that the number of nice subsets is at least $\frac{2}{k+\ell}\binom{k+\ell}{k}$.","Solution. For a $k$-element subset $A \subset S$, let $f(A)=\frac{1}{k} \sum_{x_{i} \in A} x_{i}-\frac{1}{\ell} \sum_{x_{j} \in S \backslash A} x_{j}$. Denote $\frac{k+\ell}{2 k \ell}=d$.\\
By definition a subset $A$ is nice if $|f(A)| \leq d$.\\
To each permutation $\left(y_{1}, y_{2}, \ldots, y_{k+\ell}\right)$ of the set $S=\left\{x_{1}, x_{2}, \ldots, x_{k+\ell}\right\}$ we assign $k+\ell$ subsets of $S$ with $k$ elements each, namely $A_{i}=\left\{y_{i}, y_{i+1}, \ldots, y_{i+k-1}\right\}, i=1,2, \ldots, k+\ell$. Indices are taken modulo $k+\ell$ here and henceforth. In other words, if $y_{1}, y_{2}, \ldots, y_{k+\ell}$ are arranged around a circle in this order, the sets in question are all possible blocks of $k$ consecutive elements.\\
Claim. At least two nice sets are assigned to every permutation of $S$.\\
Proof. Adjacent sets $A_{i}$ and $A_{i+1}$ differ only by the elements $y_{i}$ and $y_{i+k}, i=1, \ldots, k+\ell$. By the definition of $f$, and because $y_{i}, y_{i+k} \in[0,1]$,

$$
\left|f\left(A_{i+1}\right)-f\left(A_{i}\right)\right|=\left|\left(\frac{1}{k}+\frac{1}{\ell}\right)\left(y_{i+k}-y_{i}\right)\right| \leq \frac{1}{k}+\frac{1}{\ell}=2 d .
$$

Each element $y_{i} \in S$ belongs to exactly $k$ of the sets $A_{1}, \ldots, A_{k+\ell}$. Hence in $k$ of the expressions $f\left(A_{1}\right), \ldots, f\left(A_{k+\ell}\right)$ the coefficient of $y_{i}$ is $1 / k$; in the remaining $\ell$ expressions, its coefficient is $-1 / \ell$. So the contribution of $y_{i}$ to the sum of all $f\left(A_{i}\right)$ equals $k \cdot 1 / k-\ell \cdot 1 / \ell=0$. Since this holds for all $i$, it follows that $f\left(A_{1}\right)+\cdots+f\left(A_{k+\ell}\right)=0$.

If $f\left(A_{p}\right)=\min f\left(A_{i}\right), f\left(A_{q}\right)=\max f\left(A_{i}\right)$, we obtain in particular $f\left(A_{p}\right) \leq 0, f\left(A_{q}\right) \geq 0$. Let $p<q$ (the case $p>q$ is analogous; and the claim is true for $p=q$ as $f\left(A_{i}\right)=0$ for all $i$ ).

We are ready to prove that at least two of the sets $A_{1}, \ldots, A_{k+\ell}$ are nice. The interval $[-d, d]$ has length $2 d$, and we saw that adjacent numbers in the circular arrangement $f\left(A_{1}\right), \ldots, f\left(A_{k+\ell}\right)$ differ by at most $2 d$. Suppose that $f\left(A_{p}\right)<-d$ and $f\left(A_{q}\right)>d$. Then one of the numbers $f\left(A_{p+1}\right), \ldots, f\left(A_{q-1}\right)$ lies in $[-d, d]$, and also one of the numbers $f\left(A_{q+1}\right), \ldots, f\left(A_{p-1}\right)$ lies there. Consequently, one of the sets $A_{p+1}, \ldots, A_{q-1}$ is nice, as well as one of the sets $A_{q+1}, \ldots, A_{p-1}$. If $-d \leq f\left(A_{p}\right)$ and $f\left(A_{q}\right) \leq d$ then $A_{p}$ and $A_{q}$ are nice.

Let now $f\left(A_{p}\right)<-d$ and $f\left(A_{q}\right) \leq d$. Then $f\left(A_{p}\right)+f\left(A_{q}\right)<0$, and since $\sum f\left(A_{i}\right)=0$, there is an $r \neq q$ such that $f\left(A_{r}\right)>0$. We have $0<f\left(A_{r}\right) \leq f\left(A_{q}\right) \leq d$, so the sets $f\left(A_{r}\right)$ and $f\left(A_{q}\right)$ are nice. The only case remaining, $-d \leq f\left(A_{p}\right)$ and $d<f\left(A_{q}\right)$, is analogous.

Apply the claim to each of the $(k+\ell)$ ! permutations of $S=\left\{x_{1}, x_{2}, \ldots, x_{k+\ell}\right\}$. This gives at least $2(k+\ell)$ ! nice sets, counted with repetitions: each nice set is counted as many times as there are permutations to which it is assigned.

On the other hand, each $k$-element set $A \subset S$ is assigned to exactly $(k+\ell) k!\ell!$ permutations. Indeed, such a permutation $\left(y_{1}, y_{2}, \ldots, y_{k+\ell}\right)$ is determined by three independent choices: an in$\operatorname{dex} i \in\{1,2, \ldots, k+\ell\}$ such that $A=\left\{y_{i}, y_{i+1}, \ldots, y_{i+k-1}\right\}$, a permutation $\left(y_{i}, y_{i+1}, \ldots, y_{i+k-1}\right)$ of the set $A$, and a permutation $\left(y_{i+k}, y_{i+k+1}, \ldots, y_{i-1}\right)$ of the set $S \backslash A$.

In summary, there are at least $\frac{2(k+\ell)!}{(k+\ell) k!\ell!}=\frac{2}{k+\ell}\binom{k+\ell}{k}$ nice sets.",4,"For a permutation $(y_{1}, \ldots, y_{k+\ell})$ of $S$, let sets $A_i = \{y_i, \ldots, y_{i+k-1}\}$ (indices mod $k+\ell$) be formed. Let $f(A) = \frac{1}{k}\sum_{x \in A} x - \frac{1}{\ell}\sum_{x \in S \setminus A} x$. Prove that $|f(A_{i+1}) - f(A_i)| \leq \frac{1}{k} + \frac{1}{\ell}$.","The set $A_{i+1}$ is obtained from $A_i$ by removing $y_i$ and adding $y_{i+k}$. Thus, $S \setminus A_{i+1}$ is obtained from $S \setminus A_i$ by adding $y_i$ and removing $y_{i+k}$. The change in $f(A)$ is $f(A_{i+1}) - f(A_i) = \frac{1}{k}(-y_i + y_{i+k}) - \frac{1}{\ell}(y_i - y_{i+k}) = (\frac{1}{k} + \frac{1}{\ell})(y_{i+k} - y_i)$. Since all $y_j \in [0,1]$, we have $|y_{i+k}-y_i| \leq 1$. Therefore, $|f(A_{i+1}) - f(A_i)| \leq \frac{1}{k} + \frac{1}{\ell}$.","With the same definitions as in the first sub-problem, prove that $\sum_{i=1}^{k+\ell} f(A_i) = 0$.","Consider the contribution of an arbitrary element $y_j \in S$ to the total sum $\sum_{i=1}^{k+\ell} f(A_i)$. The element $y_j$ is a member of exactly $k$ of the sets $A_1, \ldots, A_{k+\ell}$, and thus a member of the complement $S \setminus A_i$ for the remaining $\ell$ sets. So, the total coefficient of $y_j$ in the sum is $k \cdot (\frac{1}{k}) + \ell \cdot (-\frac{1}{\ell}) = 1 - 1 = 0$. Since this holds for every $y_j \in S$, the entire sum is zero.","For any permutation of $S$, prove that at least two of the associated sets $A_1, \ldots, A_{k+\ell}$ are nice. A set $A$ is nice if $|f(A)| \leq d$, where $d = \frac{k+\ell}{2k\ell}$.","From the previous sub-problem, $\sum f(A_i)=0$, so there must exist indices $p,q$ such that $f(A_p) \leq 0 \leq f(A_q)$. From the first sub-problem, $|f(A_{i+1})-f(A_i)| \leq \frac{1}{k} + \frac{1}{\ell} = 2d$. This bound means the sequence of values cannot jump over the entire interval $[-d, d]$. If $f(A_p) < -d$ and $f(A_q) > d$, the sequence from $f(A_p)$ to $f(A_q)$ must contain a value in $[-d,d]$, and similarly for the sequence from $f(A_q)$ to $f(A_p)$, yielding two nice sets. If $-d \leq f(A_p)$ and $f(A_q) \leq d$, then $A_p$ and $A_q$ are nice. If one is inside $[-d,d]$ and the other is outside (e.g., $f(A_p) < -d$ and $0 \leq f(A_q) \leq d$), then $A_q$ is nice, and the sequence from $f(A_q)$ to $f(A_p)$ must contain another nice set. Thus, in all cases, at least two sets are nice.","Let $S=\left\{x_{1}, x_{2}, \ldots, x_{k+\ell}\right\}$ be a $(k+\ell)$-element set of real numbers contained in the interval $[0,1] ; k$ and $\ell$ are positive integers. A $k$-element subset $A \subset S$ is called nice if

$$
\left|\frac{1}{k} \sum_{x_{i} \in A} x_{i}-\frac{1}{\ell} \sum_{x_{j} \in S \backslash A} x_{j}\right| \leq \frac{k+\ell}{2 k \ell} .
$$

Prove that the number of nice subsets is at least $\frac{2}{k+\ell}\binom{k+\ell}{k}$.","Consider all $(k+\ell)!$ permutations of $S$. For each permutation, we form the $k+\ell$ cyclically consecutive $k$-element subsets $A_1, \dots, A_{k+\ell}$. From the previous step, at least two of these subsets are nice. Summing over all permutations, we count at least $2(k+\ell)!$ nice sets, with repetitions. Now, let's count how many permutations correspond to a specific $k$-element subset $A$. The elements of $A$ can be arranged as a contiguous block in $k!$ ways, the elements of $S \setminus A$ can be arranged in $\ell!$ ways, and the starting position of the block for $A$ can be any of the $k+\ell$ positions. So, each subset $A$ is counted in $(k+\ell)k!\ell!$ permutations. If $N$ is the number of nice subsets, then $N \cdot (k+\ell)k!\ell! \geq 2(k+\ell)!$. Solving for $N$ gives $N \geq \frac{2(k+\ell)!}{(k+\ell)k!\ell!} = \frac{2}{k+\ell}\frac{(k+\ell)!}{k!\ell!} = \frac{2}{k+\ell}\binom{k+\ell}{k}$."
2008c6,"For $n \geq 2$, let $S_{1}, S_{2}, \ldots, S_{2^{n}}$ be $2^{n}$ subsets of $A=\left\{1,2,3, \ldots, 2^{n+1}\right\}$ that satisfy the following property: There do not exist indices $a$ and $b$ with $a<b$ and elements $x, y, z \in A$ with $x<y<z$ such that $y, z \in S_{a}$ and $x, z \in S_{b}$. Prove that at least one of the sets $S_{1}, S_{2}, \ldots, S_{2^{n}}$ contains no more than $4 n$ elements.","We prove that there exists a set $S_{a}$ with at most $3 n+1$ elements.\\
Given a $k \in\{1, \ldots, n\}$, we say that an element $z \in A$ is $k$-good to a set $S_{a}$ if $z \in S_{a}$ and $S_{a}$ contains two other elements $x$ and $y$ with $x<y<z$ such that $z-y<2^{k}$ and $z-x \geq 2^{k}$. Also, $z \in A$ will be called good to $S_{a}$ if $z$ is $k$-good to $S_{a}$ for some $k=1, \ldots, n$.

We claim that each $z \in A$ can be $k$-good to at most one set $S_{a}$. Indeed, suppose on the contrary that $z$ is $k$-good simultaneously to $S_{a}$ and $S_{b}$, with $a<b$. Then there exist $y_{a} \in S_{a}$, $y_{a}<z$, and $x_{b} \in S_{b}, x_{b}<z$, such that $z-y_{a}<2^{k}$ and $z-x_{b} \geq 2^{k}$. On the other hand, since $z \in S_{a} \cap S_{b}$, by the condition of the problem there is no element of $S_{a}$ strictly between $x_{b}$ and $z$. Hence $y_{a} \leq x_{b}$, implying $z-y_{a} \geq z-x_{b}$. However this contradicts $z-y_{a}<2^{k}$ and $z-x_{b} \geq 2^{k}$. The claim follows.

As a consequence, a fixed $z \in A$ can be good to at most $n$ of the given sets (no more than one of them for each $k=1, \ldots, n)$.

Furthermore, let $u_{1}<u_{2}<\cdots<u_{m}<\cdots<u_{p}$ be all elements of a fixed set $S_{a}$ that are not good to $S_{a}$. We prove that $u_{m}-u_{1}>2\left(u_{m-1}-u_{1}\right)$ for all $m \geq 3$.

Indeed, assume that $u_{m}-u_{1} \leq 2\left(u_{m-1}-u_{1}\right)$ holds for some $m \geq 3$. This inequality can be written as $2\left(u_{m}-u_{m-1}\right) \leq u_{m}-u_{1}$. Take the unique $k$ such that $2^{k} \leq u_{m}-u_{1}<2^{k+1}$. Then $2\left(u_{m}-u_{m-1}\right) \leq u_{m}-u_{1}<2^{k+1}$ yields $u_{m}-u_{m-1}<2^{k}$. However the elements $z=u_{m}, x=u_{1}$, $y=u_{m-1}$ of $S_{a}$ then satisfy $z-y<2^{k}$ and $z-x \geq 2^{k}$, so that $z=u_{m}$ is $k$-good to $S_{a}$.

Thus each term of the sequence $u_{2}-u_{1}, u_{3}-u_{1}, \ldots, u_{p}-u_{1}$ is more than twice the previous one. Hence $u_{p}-u_{1}>2^{p-1}\left(u_{2}-u_{1}\right) \geq 2^{p-1}$. But $u_{p} \in\left\{1,2,3, \ldots, 2^{n+1}\right\}$, so that $u_{p} \leq 2^{n+1}$. This yields $p-1 \leq n$, i. e. $p \leq n+1$.

In other words, each set $S_{a}$ contains at most $n+1$ elements that are not good to it.\\
To summarize the conclusions, mark with red all elements in the sets $S_{a}$ that are good to the respective set, and with blue the ones that are not good. Then the total number of red elements, counting multiplicities, is at most $n \cdot 2^{n+1}$ (each $z \in A$ can be marked red in at most $n$ sets). The total number of blue elements is at most $(n+1) 2^{n}$ (each set $S_{a}$ contains at most $n+1$ blue elements). Therefore the sum of cardinalities of $S_{1}, S_{2}, \ldots, S_{2^{n}}$ does not exceed $(3 n+1) 2^{n}$. By averaging, the smallest set has at most $3 n+1$ elements.",3,"Define an element $z \in S_{a}$ to be *k-good* to $S_a$ if there exist $x, y \in S_a$ with $x<y<z$ such that $z-y<2^{k}$ and $z-x \ge 2^{k}$. An element is *good* if it is $k$-good for some $k \in \{1, \ldots, n\}$. Prove that any element $z \in A$ can be *good* to at most $n$ of the sets $S_1, \ldots, S_{2^n}$.","First, we prove that for a fixed $k$, an element $z$ can be $k$-good to at most one set. Assume $z$ is $k$-good to both $S_a$ and $S_b$ with $a<b$. Then there exists $y_a \in S_a$ with $y_a<z$ and $z-y_a < 2^k$, and there exists $x_b \in S_b$ with $x_b<z$ and $z-x_b \ge 2^k$. The problem condition for $a<b$ with $z \in S_a \cap S_b$ implies there is no element of $S_a$ strictly between $x_b$ and $z$. Thus, $y_a \le x_b$, which implies $z-y_a \ge z-x_b$. This contradicts $z-y_a < 2^k \le z-x_b$. Since this holds for each $k \in \{1, \ldots, n\}$, $z$ can be good to at most $n$ sets in total.","Let $u_1 < u_2 < \dots < u_p$ be the elements of a fixed set $S_a$ that are not *good* to $S_a$. Prove that $S_a$ contains at most $n+1$ such elements (i.e., $p \le n+1$).","Assume for contradiction that for some $m \ge 3$, $u_m-u_1 \le 2(u_{m-1}-u_1)$. Let $k$ be the unique integer such that $2^k \le u_m-u_1 < 2^{k+1}$. The assumption implies $2(u_m-u_{m-1}) \le u_m-u_1$, which gives $u_m-u_{m-1} < 2^k$. Setting $x=u_1, y=u_{m-1}, z=u_m$, we have $x,y,z \in S_a$ with $z-y < 2^k$ and $z-x \ge 2^k$. This means $u_m$ is $k$-good to $S_a$, a contradiction. Therefore, $u_m-u_1 > 2(u_{m-1}-u_1)$ for all $m \ge 3$. This implies the sequence $u_2-u_1, u_3-u_1, \ldots, u_p-u_1$ more than doubles at each step, so $u_p-u_1 > 2^{p-1}(u_2-u_1) \ge 2^{p-1}$. Since $u_p, u_1 \in A$, $u_p-u_1 < 2^{n+1}$. Thus, $2^{p-1} < 2^{n+1}$, which implies $p-1 < n+1$, so $p \le n+1$.","For $n \geq 2$, let $S_{1}, S_{2}, \ldots, S_{2^{n}}$ be $2^{n}$ subsets of $A=\left\{1,2,3, \ldots, 2^{n+1}\right\}$ that satisfy the following property: There do not exist indices $a$ and $b$ with $a<b$ and elements $x, y, z \in A$ with $x<y<z$ such that $y, z \in S_{a}$ and $x, z \in S_{b}$. Prove that at least one of the sets $S_{1}, S_{2}, \ldots, S_{2^{n}}$ contains no more than $4 n$ elements.","We count the total number of elements in all sets, $\sum_{a=1}^{2^n} |S_a|$, by partitioning the elements of each set into those that are *good* and those that are not. From sub-problem 1, each element $z \in A$ can be *good* to at most $n$ sets, so the total number of *good* elements across all sets is at most $n|A| = n \cdot 2^{n+1}$. From sub-problem 2, each set $S_a$ has at most $n+1$ elements that are not *good*, so the total number of non-*good* elements is at most $(n+1)2^n$. The sum of cardinalities is therefore bounded: $\sum |S_a| \le n \cdot 2^{n+1} + (n+1)2^n = 2n \cdot 2^n + (n+1)2^n = (3n+1)2^n$. By the averaging principle, there is at least one set $S_a$ with $|S_a| \le \frac{(3n+1)2^n}{2^n} = 3n+1$. As $n \ge 2$, $3n+1 \le 4n$, so the claim holds.",,
2008g1,"In an acute-angled triangle $A B C$, point $H$ is the orthocentre and $A_{0}, B_{0}, C_{0}$ are the midpoints of the sides $B C, C A, A B$, respectively. Consider three circles passing through $H$ : $\omega_{a}$ around $A_{0}, \omega_{b}$ around $B_{0}$ and $\omega_{c}$ around $C_{0}$. The circle $\omega_{a}$ intersects the line $B C$ at $A_{1}$ and $A_{2} ; \omega_{b}$ intersects $C A$ at $B_{1}$ and $B_{2} ; \omega_{c}$ intersects $A B$ at $C_{1}$ and $C_{2}$. Show that the points $A_{1}, A_{2}, B_{1}, B_{2}, C_{1}, C_{2}$ lie on a circle.","The perpendicular bisectors of the segments $A_{1} A_{2}, B_{1} B_{2}, C_{1} C_{2}$ are also the perpendicular bisectors of $B C, C A, A B$. So they meet at $O$, the circumcentre of $A B C$. Thus $O$ is the only point that can possibly be the centre of the desired circle.

From the right triangle $O A_{0} A_{1}$ we get


\begin{equation*}
O A_{1}^{2}=O A_{0}^{2}+A_{0} A_{1}^{2}=O A_{0}^{2}+A_{0} H^{2} . \tag{1}
\end{equation*}


Let $K$ be the midpoint of $A H$ and let $L$ be the midpoint of $C H$. Since $A_{0}$ and $B_{0}$ are the midpoints of $B C$ and $C A$, we see that $A_{0} L \| B H$ and $B_{0} L \| A H$. Thus the segments $A_{0} L$ and $B_{0} L$ are perpendicular to $A C$ and $B C$, hence parallel to $O B_{0}$ and $O A_{0}$, respectively. Consequently $O A_{0} L B_{0}$ is a parallelogram, so that $O A_{0}$ and $B_{0} L$ are equal and parallel. Also, the midline $B_{0} L$ of triangle $A H C$ is equal and parallel to $A K$ and $K H$.

It follows that $A K A_{0} O$ and $H A_{0} O K$ are parallelograms. The first one gives $A_{0} K=O A=R$, where $R$ is the circumradius of $A B C$. From the second one we obtain


\begin{equation*}
2\left(O A_{0}^{2}+A_{0} H^{2}\right)=O H^{2}+A_{0} K^{2}=O H^{2}+R^{2} . \tag{2}
\end{equation*}


(In a parallelogram, the sum of squares of the diagonals equals the sum of squares of the sides).\\
From (1) and (2) we get $O A_{1}^{2}=\left(O H^{2}+R^{2}\right) / 2$. By symmetry, the same holds for the distances $O A_{2}, O B_{1}, O B_{2}, O C_{1}$ and $O C_{2}$. Thus $A_{1}, A_{2}, B_{1}, B_{2}, C_{1}, C_{2}$ all lie on a circle with centre at $O$ and radius $\left(O H^{2}+R^{2}\right) / 2$.\\",3,Let $O$ be the circumcentre and $R$ be the circumradius of an acute-angled triangle $ABC$. Let $H$ be the orthocentre and $A_{0}$ be the midpoint of side $BC$. Show that $2(OA_{0}^{2} + A_{0}H^{2}) = OH^{2} + R^{2}$.,"Let $K$ be the midpoint of the segment $AH$. It is a known property that the quadrilaterals $AKA_0O$ and $HA_0OK$ are parallelograms. Since $AKA_0O$ is a parallelogram, we have $A_0K = OA = R$. Applying the parallelogram law to $HA_0OK$ (the sum of the squares of the diagonals equals the sum of the squares of the sides), we get $OH^2 + A_0K^2 = 2(OA_0^2 + A_0H^2)$. Substituting $A_0K=R$ yields the desired result: $OH^2 + R^2 = 2(OA_0^2 + A_0H^2)$.",The circle $\omega_{a}$ with center $A_{0}$ passes through $H$ and intersects the line $BC$ at $A_{1}$ and $A_{2}$. Show that the squared distance from the circumcenter $O$ to $A_1$ is given by $OA_{1}^{2} = \frac{1}{2}(OH^{2} + R^{2})$.,"Since $O$ is the circumcenter and $A_0$ is the midpoint of $BC$, the line $OA_0$ is perpendicular to $BC$. As $A_1$ lies on the line $BC$, triangle $OA_0A_1$ is a right-angled triangle. By the Pythagorean theorem, $OA_1^2 = OA_0^2 + A_0A_1^2$. The circle $\omega_a$ is centered at $A_0$ and its radius is $A_0H$ (since it passes through $H$). As $A_1$ is on this circle, $A_0A_1 = A_0H$. Thus, $OA_1^2 = OA_0^2 + A_0H^2$. Using the result from the previous sub-problem, $2(OA_0^2 + A_0H^2) = OH^2 + R^2$, we conclude that $OA_1^2 = \frac{1}{2}(OH^2 + R^2)$.","Show that the points $A_{1}, A_{2}, B_{1}, B_{2}, C_{1}, C_{2}$ lie on a circle.","The perpendicular bisector of the segment $A_1A_2$ passes through its midpoint $A_0$ and is perpendicular to the line $BC$. This is precisely the perpendicular bisector of the side $BC$. Similarly, the perpendicular bisectors of $B_1B_2$ and $C_1C_2$ are the perpendicular bisectors of sides $CA$ and $AB$. These three lines intersect at the circumcenter $O$. Thus, if the six points lie on a circle, its center must be $O$. From the previous sub-problem, the squared distance from $O$ to $A_1$ is $OA_1^2 = \frac{1}{2}(OH^2 + R^2)$. Since $A_0$ is the midpoint of $A_1A_2$, $OA_1 = OA_2$. The expression for the squared distance is symmetric and depends only on triangle-wide properties ($O, H, R$). Therefore, the distances from $O$ to all six points $A_1, A_2, B_1, B_2, C_1, C_2$ are equal to the same value. All six points are equidistant from $O$, so they lie on a circle centered at $O$ with radius $\sqrt{\frac{OH^2+R^2}{2}}$.",,
2008g2,"Given trapezoid $A B C D$ with parallel sides $A B$ and $C D$, assume that there exist points $E$ on line $B C$ outside segment $B C$, and $F$ inside segment $A D$, such that $\angle D A E=\angle C B F$. Denote by $I$ the point of intersection of $C D$ and $E F$, and by $J$ the point of intersection of $A B$ and $E F$. Let $K$ be the midpoint of segment $E F$; assume it does not lie on line $A B$.","Prove that $I$ belongs to the circumcircle of $A B K$ if and only if $K$ belongs to the circumcircle of $C D J$.

Solution. Assume that the disposition of points is as in the diagram.\\
Since $\angle E B F=180^{\circ}-\angle C B F=180^{\circ}-\angle E A F$ by hypothesis, the quadrilateral $A E B F$ is cyclic. Hence $A J \cdot J B=F J \cdot J E$. In view of this equality, $I$ belongs to the circumcircle of $A B K$ if and only if $I J \cdot J K=F J \cdot J E$. Expressing $I J=I F+F J, J E=F E-F J$, and $J K=\frac{1}{2} F E-F J$, we find that $I$ belongs to the circumcircle of $A B K$ if and only if

$$
F J=\frac{I F \cdot F E}{2 I F+F E} .
$$

Since $A E B F$ is cyclic and $A B, C D$ are parallel, $\angle F E C=\angle F A B=180^{\circ}-\angle C D F$. Then $C D F E$ is also cyclic, yielding $I D \cdot I C=I F \cdot I E$. It follows that $K$ belongs to the circumcircle of $C D J$ if and only if $I J \cdot I K=I F \cdot I E$. Expressing $I J=I F+F J, I K=I F+\frac{1}{2} F E$, and $I E=I F+F E$, we find that $K$ is on the circumcircle of $C D J$ if and only if

$$
F J=\frac{I F \cdot F E}{2 I F+F E} .
$$

The conclusion follows.\\
\includegraphics[max width=\textwidth, center]{2025_05_05_fa6d5698664bd1bc5558g-32}

Comment. While the figure shows $B$ inside segment $C E$, it is possible that $C$ is inside segment $B E$. Consequently, $I$ would be inside segment $E F$ and $J$ outside segment $E F$. The position of point $K$ on line $E F$ with respect to points $I, J$ may also vary.

Some case may require that an angle $\varphi$ be replaced by $180^{\circ}-\varphi$, and in computing distances, a sum may need to become a difference. All these cases can be covered by the proposed solution if it is clearly stated that signed distances and angles are used.",3,Prove that the quadrilateral $A E B F$ is cyclic.,"Given $\angle D A E=\angle C B F$. Since $F$ is on segment $AD$, $\angle FAE = \angle DAE$. As $E$ is on line $BC$ outside segment $BC$, the angle $\angle EBF$ is supplementary to $\angle CBF$, so $\angle EBF = 180^\circ - \angle CBF$. In quadrilateral $AEBF$, the sum of opposite angles is $\angle FAE + \angle EBF = \angle DAE + (180^\circ - \angle CBF) = 180^\circ$. Therefore, $A E B F$ is a cyclic quadrilateral.",Prove that the quadrilateral $C D F E$ is cyclic.,"Since $AEBF$ is cyclic, the exterior angle at vertex $E$ is equal to the interior opposite angle, so $\angle FEC = \angle FAB$. As trapezoid $ABCD$ has parallel sides $AB$ and $CD$, the interior angles on the same side of the transversal $AD$ are supplementary, meaning $\angle DAB + \angle ADC = 180^\circ$. Since $F$ lies on $AD$, this implies $\angle FAB + \angle FDC = 180^\circ$. Combining these facts, we get $\angle FEC = 180^\circ - \angle FDC$, which means $\angle FEC + \angle FDC = 180^\circ$. Therefore, $CDFE$ is a cyclic quadrilateral.",Prove that $I$ belongs to the circumcircle of $A B K$ if and only if $K$ belongs to the circumcircle of $C D J$.,"By the power of a point theorem, $I$ lies on the circumcircle of $ABK$ if and only if $JA \cdot JB = JI \cdot JK$. Since $AEBF$ is cyclic, $JA \cdot JB = JF \cdot JE$. Thus, the first condition is equivalent to $JI \cdot JK = JF \cdot JE$. Similarly, $K$ lies on the circumcircle of $CDJ$ if and only if $IC \cdot ID = IK \cdot IJ$. Since $CDFE$ is cyclic, $IC \cdot ID = IF \cdot IE$. Thus, the second condition is equivalent to $IK \cdot IJ = IF \cdot IE$. Both conditions $JI \cdot JK = JF \cdot JE$ and $IK \cdot IJ = IF \cdot IE$ can be shown to be equivalent to the same algebraic relation between the lengths of segments on line $EF$. Therefore, the two initial statements are equivalent.",,
2008g3,Let $A B C D$ be a convex quadrilateral and let $P$ and $Q$ be points in $A B C D$ such that $P Q D A$ and $Q P B C$ are cyclic quadrilaterals. Suppose that there exists a point $E$ on the line segment $P Q$ such that $\angle P A E=\angle Q D E$ and $\angle P B E=\angle Q C E$. Show that the quadrilateral $A B C D$ is cyclic.,"Let $F$ be the point on the line $A D$ such that $E F \| P A$. By hypothesis, the quadrilateral $P Q D A$ is cyclic. So if $F$ lies between $A$ and $D$ then $\angle E F D=\angle P A D=180^{\circ}-\angle E Q D$; the points $F$ and $Q$ are on distinct sides of the line $D E$ and we infer that $E F D Q$ is a cyclic quadrilateral. And if $D$ lies between $A$ and $F$ then a similar argument shows that $\angle E F D=\angle E Q D$; but now the points $F$ and $Q$ lie on the same side of $D E$, so that $E D F Q$ is a cyclic quadrilateral.

In either case we obtain the equality $\angle E F Q=\angle E D Q=\angle P A E$ which implies that $F Q \| A E$. So the triangles $E F Q$ and $P A E$ are either homothetic or parallel-congruent. More specifically, triangle $E F Q$ is the image of $P A E$ under the mapping $f$ which carries the points $P, E$ respectively to $E, Q$ and is either a homothety or translation by a vector. Note that $f$ is uniquely determined by these conditions and the position of the points $P, E, Q$ alone.

Let now $G$ be the point on the line $B C$ such that $E G \| P B$. The same reasoning as above applies to points $B, C$ in place of $A, D$, implying that the triangle $E G Q$ is the image of $P B E$ under the same mapping $f$. So $f$ sends the four points $A, P, B, E$ respectively to $F, E, G, Q$.

If $P E \neq Q E$, so that $f$ is a homothety with a centre $X$, then the lines $A F, P E, B G$-i.e. the lines $A D, P Q, B C$-are concurrent at $X$. And since $P Q D A$ and $Q P B C$ are cyclic quadrilaterals, the equalities $X A \cdot X D=X P \cdot X Q=X B \cdot X C$ hold, showing that the quadrilateral $A B C D$ is cyclic.

Finally, if $P E=Q E$, so that $f$ is a translation, then $A D\|P Q\| B C$. Thus $P Q D A$ and $Q P B C$ are isosceles trapezoids. Then also $A B C D$ is an isosceles trapezoid, hence a cyclic quadrilateral.\\",3,"Let $PQDA$ be a cyclic quadrilateral and $E$ be a point on the line $PQ$. Let $F$ be a point on the line $AD$ such that $EF \| PA$. If $\angle PAE = \angle QDE$, prove that $FQ \| AE$.","Since $PQDA$ is cyclic and $EF \| PA$, we have $\angle EFD = \angle PAD = 180^{\circ} - \angle PQD$. This implies that the quadrilateral $EFDQ$ is cyclic. Therefore, $\angle EFQ = \angle EDQ$. Given the condition $\angle QDE = \angle PAE$, it follows that $\angle EFQ = \angle PAE$. As $EF$ and $PA$ are parallel by construction, this equality of alternating interior angles (or corresponding angles, depending on configuration) implies that $FQ \| AE$.","Let $f$ be the unique similarity transformation (a homothety or a translation) that maps segment $PE$ to $EQ$. Show that under the conditions of the original problem, there exist a point $F$ on line $AD$ and a point $G$ on line $BC$ such that triangle $EFQ$ is the image of triangle $PAE$ under $f$, and triangle $EGQ$ is the image of triangle $PBE$ under $f$.","Let $F$ be a point on line $AD$ such that $EF \| PA$. From the previous sub-problem, the condition $\angle PAE = \angle QDE$ implies $FQ \| AE$. The two pairs of parallel sides ($EF \| PA$ and $FQ \| AE$) mean that $\triangle EFQ$ is the image of $\triangle PAE$ under the transformation $f$ that maps $P \to E$ and $E \to Q$. Similarly, let $G$ be a point on line $BC$ such that $EG \| PB$. Since $QPBC$ is cyclic, $EGQC$ is cyclic. Thus $\angle EGQ = \angle ECQ$. Given $\angle PBE = \angle QCE$, we have $\angle EGQ = \angle PBE$. As $EG \| PB$, this implies $GQ \| BE$. Therefore, $\triangle EGQ$ is the image of $\triangle PBE$ under the same transformation $f$.",Let $A B C D$ be a convex quadrilateral and let $P$ and $Q$ be points in $A B C D$ such that $P Q D A$ and $Q P B C$ are cyclic quadrilaterals. Suppose that there exists a point $E$ on the line segment $P Q$ such that $\angle P A E=\angle Q D E$ and $\angle P B E=\angle Q C E$. Show that the quadrilateral $A B C D$ is cyclic.,"Let $f$ be the similarity transformation mapping $PE$ to $EQ$. From the previous result, $f$ maps point $A$ to a point $F$ on line $AD$, and point $B$ to a point $G$ on line $BC$. There are two cases for $f$. Case 1: $f$ is a homothety with a center $X$. Then the lines connecting pre-images to images must all pass through $X$. Thus, lines $AD$ (as line $AF$), $BC$ (as line $BG$), and $PQ$ (as line $PE$) are concurrent at $X$. By the power of point $X$ with respect to the two circles, $XA \cdot XD = XP \cdot XQ$ and $XB \cdot XC = XP \cdot XQ$. It follows that $XA \cdot XD = XB \cdot XC$, which implies that $A, B, C, D$ are concyclic. Case 2: $f$ is a translation. Then $AD \| BC \| PQ$. Since $PQDA$ and $QPBC$ are cyclic, they must be isosceles trapezoids. This implies $ABCD$ is also an isosceles trapezoid, which is a cyclic quadrilateral.",,
2008g4,In an acute triangle $A B C$ segments $B E$ and $C F$ are altitudes. Two circles passing through the points $A$ and $F$ are tangent to the line $B C$ at the points $P$ and $Q$ so that $B$ lies between $C$ and $Q$. Prove that the lines $P E$ and $Q F$ intersect on the circumcircle of triangle $A E F$.,"To approach the desired result we need some information about the slopes of the lines $P E$ and $Q F$; this information is provided by formulas (1) and (2) which we derive below.

The tangents $B P$ and $B Q$ to the two circles passing through $A$ and $F$ are equal, as $B P^{2}=B A \cdot B F=B Q^{2}$. Consider the altitude $A D$ of triangle $A B C$ and its orthocentre $H$. From the cyclic quadrilaterals $C D F A$ and $C D H E$ we get $B A \cdot B F=B C \cdot B D=B E \cdot B H$. Thus $B P^{2}=B E \cdot B H$, or $B P / B H=B E / B P$, implying that the triangles $B P H$ and $B E P$ are similar. Hence


\begin{equation*}
\angle B P E=\angle B H P . \tag{1}
\end{equation*}


The point $P$ lies between $D$ and $C$; this follows from the equality $B P^{2}=B C \cdot B D$. In view of this equality, and because $B P=B Q$,

$$
D P \cdot D Q=(B P-B D) \cdot(B P+B D)=B P^{2}-B D^{2}=B D \cdot(B C-B D)=B D \cdot D C .
$$

Also $A D \cdot D H=B D \cdot D C$, as is seen from the similar triangles $B D H$ and $A D C$. Combining these equalities we obtain $A D \cdot D H=D P \cdot D Q$. Therefore $D H / D P=D Q / D A$, showing that the triangles $H D P$ and $Q D A$ are similar. Hence $\angle H P D=\angle Q A D$, which can be rewritten as $\angle B P H=\angle B A D+\angle B A Q$. And since $B Q$ is tangent to the circumcircle of triangle $F A Q$,


\begin{equation*}
\angle B Q F=\angle B A Q=\angle B P H-\angle B A D . \tag{2}
\end{equation*}


From (1) and (2) we deduce

$$
\begin{aligned}
\angle B P E+\angle B Q F & =(\angle B H P+\angle B P H)-\angle B A D
\end{aligned}=\left(180^{\circ}-\angle P B H\right)-\angle B A D .
$$

Thus $\angle B P E+\angle B Q F<180^{\circ}$, which means that the rays $P E$ and $Q F$ meet. Let $S$ be the point of intersection. Then $\angle P S Q=180^{\circ}-(\angle B P E+\angle B Q F)=\angle C A B=\angle E A F$.

If $S$ lies between $P$ and $E$ then $\angle P S Q=180^{\circ}-\angle E S F$; and if $E$ lies between $P$ and $S$ then $\angle P S Q=\angle E S F$. In either case the equality $\angle P S Q=\angle E A F$ which we have obtained means that $S$ lies on the circumcircle of triangle $A E F$.\\",3,"Let $H$ be the orthocenter of triangle $ABC$. Show that triangles $BPH$ and $BEP$ are similar, and consequently, prove that $\angle BPE = \angle BHP$.","By the power of a point theorem for point $B$ and the circle passing through $A, F, P$, we have $BP^2 = BA \cdot BF$. Since $CF$ and $BE$ are altitudes, the quadrilateral $AFDC$ is cyclic (angles on $AC$ are $90^\circ$), so by power of point $B$, $BA \cdot BF = BC \cdot BD$. Also, quadrilateral $CDHE$ is cyclic (angles on $CH$ are $90^\circ$), so by power of point $B$, $BE \cdot BH = BC \cdot BD$. Thus, $BP^2 = BE \cdot BH$, which implies $BP/BH = BE/BP$. As they share $\angle HBP$, triangles $BPH$ and $BEP$ are similar by SAS. Therefore, $\angle BPE = \angle BHP$.","Let $AD$ be the altitude from $A$. Show that triangles $HDP$ and $QDA$ are similar, and use this to prove that $\angle BQF = \angle BPH - \angle BAD$.","From $BP^2 = BC \cdot BD$ and $BP=BQ$, we get $DP \cdot DQ = (BP-BD)(BP+BD) = BP^2-BD^2 = BC \cdot BD - BD^2 = BD \cdot DC$. From the similarity of triangles $BDH$ and $ADC$, we have $AD \cdot DH = BD \cdot DC$. Thus, $DP \cdot DQ = AD \cdot DH$, which implies $DH/DP = DQ/DA$. Since $\angle PDH = \angle ADQ = 90^\circ$, triangles $HDP$ and $QDA$ are similar (SAS). This gives $\angle HPD = \angle QAD$, which is $\angle BPH = \angle QAB + \angle BAD$. From the tangency condition, $BQ^2=BA \cdot BF$, which implies $\triangle BQF \sim \triangle BAQ$, so $\angle BQF = \angle BAQ$. Substituting this into the previous equation gives $\angle BPH = \angle BQF + \angle BAD$, or $\angle BQF = \angle BPH - \angle BAD$.",In an acute triangle $A B C$ segments $B E$ and $C F$ are altitudes. Two circles passing through the points $A$ and $F$ are tangent to the line $B C$ at the points $P$ and $Q$ so that $B$ lies between $C$ and $Q$. Prove that the lines $P E$ and $Q F$ intersect on the circumcircle of triangle $A E F$.,"Let $S$ be the intersection of lines $PE$ and $QF$. In the triangle formed by these lines and line $BC$, the angle $\angle PSQ = 180^\circ - (\angle BPE + \angle BQF)$. Using the results from the previous parts, $\angle BPE + \angle BQF = (\angle BHP) + (\angle BPH - \angle BAD) = (\angle BHP + \angle BPH) - \angle BAD$. In $\triangle BPH$, this is $(180^\circ - \angle HBP) - \angle BAD$. In $\triangle ABC$, $\angle HBP = \angle EBC = 90^\circ - \angle C$ and $\angle BAD = 90^\circ - \angle B$. So, $\angle BPE + \angle BQF = 180^\circ - (90^\circ - \angle C) - (90^\circ - \angle B) = \angle B + \angle C = 180^\circ - \angle A$. Thus, $\angle PSQ = 180^\circ - (180^\circ - \angle A) = \angle A = \angle EAF$. This equality of angles implies that $S$ must lie on the circumcircle of triangle $AEF$.",,
2008g5,"Let $k$ and $n$ be integers with $0 \leq k \leq n-2$. Consider a set $L$ of $n$ lines in the plane such that no two of them are parallel and no three have a common point. Denote by $I$ the set of intersection points of lines in $L$. Let $O$ be a point in the plane not lying on any line of $L$.

A point $X \in I$ is colored red if the open line segment $O X$ intersects at most $k$ lines in $L$. Prove that $I$ contains at least $\frac{1}{2}(k+1)(k+2)$ red points.","Solution. There are at least $\frac{1}{2}(k+1)(k+2)$ points in the intersection set $I$ in view of the condition $n \geq k+2$.

For each point $P \in I$, define its order as the number of lines that intersect the open line segment $O P$. By definition, $P$ is red if its order is at most $k$. Note that there is always at least one point $X \in I$ of order 0 . Indeed, the lines in $L$ divide the plane into regions, bounded or not, and $O$ belongs to one of them. Clearly any corner of this region is a point of $I$ with order 0 .\\
Claim. Suppose that two points $P, Q \in I$ lie on the same line of $L$, and no other line of $L$ intersects the open line segment $P Q$. Then the orders of $P$ and $Q$ differ by at most 1 .\\
Proof. Let $P$ and $Q$ have orders $p$ and $q$, respectively, with $p \geq q$. Consider triangle $O P Q$. Now $p$ equals the number of lines in $L$ that intersect the interior of side $O P$. None of these lines intersects the interior of side $P Q$, and at most one can pass through $Q$. All remaining lines must intersect the interior of side $O Q$, implying that $q \geq p-1$. The conclusion follows.

We prove the main result by induction on $k$. The base $k=0$ is clear since there is a point of order 0 which is red. Assuming the statement true for $k-1$, we pass on to the inductive step. Select a point $P \in I$ of order 0 , and consider one of the lines $\ell \in L$ that pass through $P$. There are $n-1$ intersection points on $\ell$, one of which is $P$. Out of the remaining $n-2$ points, the $k$ closest to $P$ have orders not exceeding $k$ by the Claim. It follows that there are at least $k+1$ red points on $\ell$.

Let us now consider the situation with $\ell$ removed (together with all intersection points it contains). By hypothesis of induction, there are at least $\frac{1}{2} k(k+1)$ points of order not exceeding $k-1$ in the resulting configuration. Restoring $\ell$ back produces at most one new intersection point on each line segment joining any of these points to $O$, so their order is at most $k$ in the original configuration. The total number of points with order not exceeding $k$ is therefore at least $(k+1)+\frac{1}{2} k(k+1)=\frac{1}{2}(k+1)(k+2)$. This completes the proof.

Comment. The steps of the proof can be performed in reverse order to obtain a configuration of $n$ lines such that equality holds simultaneously for all $0 \leq k \leq n-2$.",3,"Let $P, Q \in I$ be two intersection points that lie on the same line $\ell \in L$. If no other line from $L$ intersects the open line segment $PQ$, prove that the number of lines intersecting the open segment $OP$ and the number of lines intersecting the open segment $OQ$ differ by at most 1.","Let $p$ be the number of lines intersecting the open segment $OP$ and $q$ be the number of lines intersecting the open segment $OQ$. Assume $p \geq q$. Consider the triangle $OPQ$. The $p$ lines that intersect the interior of segment $OP$ must also intersect the boundary of triangle $OPQ$ at another point. By hypothesis, none of these lines intersect the interior of segment $PQ$. At most one of these lines can pass through the point $Q$. All the other $p-1$ or more lines must intersect the interior of segment $OQ$. Therefore, $q \geq p-1$. Since we assumed $p \ge q$, this implies $|p-q| \leq 1$.",A point $X \in I$ is colored red if the open line segment $OX$ intersects at most $k$ lines in $L$. Prove that there exists a line $\ell \in L$ which contains at least $k+1$ red points.,"The lines in $L$ partition the plane into regions, and the point $O$ lies in one of them. Any vertex $P$ of this region is an intersection point such that the segment $OP$ intersects zero lines. As $k \ge 0$, $P$ is a red point. Let $\ell$ be a line in $L$ passing through $P$. Let $Q_1, Q_2, \dots$ be the other intersection points on $\ell$, ordered by their distance from $P$. For any two adjacent points in this sequence, say $Q_{i-1}$ and $Q_i$ (with $Q_0=P$), no other line intersects the segment $Q_{i-1}Q_i$. By the result of Sub-problem 1, the number of lines intersecting $OQ_i$ is at most one more than the number of lines intersecting $OQ_{i-1}$. Since $OP$ intersects 0 lines, an induction shows the number of lines intersecting $OQ_i$ is at most $i$. Therefore, the points $P, Q_1, \dots, Q_k$ are all red, giving $k+1$ red points on line $\ell$.",Let $k$ and $n$ be integers with $0 \leq k \leq n-2$. Consider a set $L$ of $n$ lines in the plane such that no two of them are parallel and no three have a common point. Denote by $I$ the set of intersection points of lines in $L$. Let $O$ be a point in the plane not lying on any line of $L$. A point $X \in I$ is colored red if the open line segment $O X$ intersects at most $k$ lines in $L$. Prove that $I$ contains at least $\frac{1}{2}(k+1)(k+2)$ red points.,"We use induction on $k$. For the base case $k=0$, there exists at least one point $P$ for which $OP$ intersects zero lines. This point is red, and $\frac{1}{2}(0+1)(0+2)=1$, so the claim holds. Assume the statement is true for $k-1$. By Sub-problem 2, there exists a line $\ell \in L$ containing at least $k+1$ red points. Consider the set of lines $L' = L \\setminus \\{\ell\\}$. This set has $n-1$ lines, and $k-1 \leq (n-1)-2$. By the induction hypothesis for $k-1$, there are at least $\frac{1}{2}k(k+1)$ points in the intersection set of $L'$ which are red with respect to $L'$ (i.e., their segment to $O$ is crossed by at most $k-1$ lines from $L'$). When $\ell$ is reintroduced, the number of line crossings for these points increases by at most 1, so they are crossed by at most $k$ lines from $L$. Thus, they are red in the original configuration. These points are not on $\ell$, so they are distinct from the first set of points. The total number of red points is at least $(k+1) + \frac{1}{2}k(k+1) = \frac{1}{2}(k+1)(k+2)$. This completes the induction.",,
2008g6,"There is given a convex quadrilateral $A B C D$. Prove that there exists a point $P$ inside the quadrilateral such that


\begin{equation*}
\angle P A B+\angle P D C=\angle P B C+\angle P A D=\angle P C D+\angle P B A=\angle P D A+\angle P C B=90^{\circ} \tag{1}
\end{equation*}


if and only if the diagonals $A C$ and $B D$ are perpendicular.","For a point $P$ in $A B C D$ which satisfies (1), let $K, L, M, N$ be the feet of perpendiculars from $P$ to lines $A B, B C, C D, D A$, respectively. Note that $K, L, M, N$ are interior to the sides as all angles in (1) are acute. The cyclic quadrilaterals $A K P N$ and $D N P M$ give

$$
\angle P A B+\angle P D C=\angle P N K+\angle P N M=\angle K N M
$$

Analogously, $\angle P B C+\angle P A D=\angle L K N$ and $\angle P C D+\angle P B A=\angle M L K$. Hence the equalities (1) imply $\angle K N M=\angle L K N=\angle M L K=90^{\circ}$, so that $K L M N$ is a rectangle. The converse also holds true, provided that $K, L, M, N$ are interior to sides $A B, B C, C D, D A$.\\
(i) Suppose that there exists a point $P$ in $A B C D$ such that $K L M N$ is a rectangle. We show that $A C$ and $B D$ are parallel to the respective sides of $K L M N$.

Let $O_{A}$ and $O_{C}$ be the circumcentres of the cyclic quadrilaterals $A K P N$ and $C M P L$. Line $O_{A} O_{C}$ is the common perpendicular bisector of $L M$ and $K N$, therefore $O_{A} O_{C}$ is parallel to $K L$ and $M N$. On the other hand, $O_{A} O_{C}$ is the midline in the triangle $A C P$ that is parallel to $A C$. Therefore the diagonal $A C$ is parallel to the sides $K L$ and $M N$ of the rectangle. Likewise, $B D$ is parallel to $K N$ and $L M$. Hence $A C$ and $B D$ are perpendicular.\\
\includegraphics[max width=\textwidth, center]{2025_05_05_fa6d5698664bd1bc5558g-38}\\
(ii) Suppose that $A C$ and $B D$ are perpendicular and meet at $R$. If $A B C D$ is a rhombus, $P$ can be chosen to be its centre. So assume that $A B C D$ is not a rhombus, and let $B R<D R$ without loss of generality.

Denote by $U_{A}$ and $U_{C}$ the circumcentres of the triangles $A B D$ and $C D B$, respectively. Let $A V_{A}$ and $C V_{C}$ be the diameters through $A$ and $C$ of the two circumcircles. Since $A R$ is an altitude in triangle $A D B$, lines $A C$ and $A V_{A}$ are isogonal conjugates, i. e. $\angle D A V_{A}=\angle B A C$. Now $B R<D R$ implies that ray $A U_{A}$ lies in $\angle D A C$. Similarly, ray $C U_{C}$ lies in $\angle D C A$. Both diameters $A V_{A}$ and $C V_{C}$ intersect $B D$ as the angles at $B$ and $D$ of both triangles are acute. Also $U_{A} U_{C}$ is parallel to $A C$ as it is the perpendicular bisector of $B D$. Hence $V_{A} V_{C}$ is parallel to $A C$, too. We infer that $A V_{A}$ and $C V_{C}$ intersect at a point $P$ inside triangle $A C D$, hence inside $A B C D$.

Construct points $K, L, M, N, O_{A}$ and $O_{C}$ in the same way as in the introduction. It follows from the previous paragraph that $K, L, M, N$ are interior to the respective sides. Now $O_{A} O_{C}$ is a midline in triangle $A C P$ again. Therefore lines $A C, O_{A} O_{C}$ and $U_{A} U_{C}$ are parallel.

The cyclic quadrilateral $A K P N$ yields $\angle N K P=\angle N A P$. Since $\angle N A P=\angle D A U_{A}=$ $\angle B A C$, as specified above, we obtain $\angle N K P=\angle B A C$. Because $P K$ is perpendicular to $A B$, it follows that $N K$ is perpendicular to $A C$, hence parallel to $B D$. Likewise, $L M$ is parallel to $B D$.

Consider the two homotheties with centres $A$ and $C$ which transform triangles $A B D$ and $C D B$ into triangles $A K N$ and $C M L$, respectively. The images of points $U_{A}$ and $U_{C}$ are $O_{A}$ and $O_{C}$, respectively. Since $U_{A} U_{C}$ and $O_{A} O_{C}$ are parallel to $A C$, the two ratios of homothety are the same, equal to $\lambda=A N / A D=A K / A B=A O_{A} / A U_{A}=C O_{C} / C U_{C}=C M / C D=C L / C B$. It is now straightforward that $D N / D A=D M / D C=B K / B A=B L / B C=1-\lambda$. Hence $K L$ and $M N$ are parallel to $A C$, implying that $K L M N$ is a rectangle and completing the proof.\\",4,"Let $P$ be a point inside a convex quadrilateral $A B C D$, and let $K, L, M, N$ be the feet of the perpendiculars from $P$ to the sides $A B, B C, C D, D A$ respectively. Show that the four angle equalities $\angle P A B+\angle P D C=90^{\circ}$, $\angle P B C+\angle P A D=90^{\circ}$, $\angle P C D+\angle P B A=90^{\circ}$, and $\angle P D A+\angle P C B=90^{\circ}$ hold if and only if $K L M N$ is a rectangle.","The quadrilaterals $A K P N$, $B L P K$, $C M P L$, and $D N P M$ are cyclic since they each have two opposite right angles at the feet of the perpendiculars. From these cyclic quadrilaterals, we can express the angles in the given equalities in terms of the angles of the quadrilateral $K L M N$. Specifically, $\angle P A B+\angle P D C = \angle P N K + \angle P N M = \angle K N M$. Similarly, $\angle P B C+\angle P A D = \angle L K N$, $\angle P C D+\angle P B A = \angle M L K$, and $\angle P D A+\angle P C B = \angle N M L$. Therefore, the four angle equalities are equivalent to the condition that all four angles of $K L M N$ are $90^{\circ}$, which means $K L M N$ is a rectangle.",Assume there exists a point $P$ inside the convex quadrilateral $A B C D$ satisfying the angle equalities from the main problem statement. Show that the diagonals $A C$ and $B D$ are perpendicular.,"By Sub-problem 1, the quadrilateral $K L M N$ formed by the feet of the perpendiculars from $P$ to the sides is a rectangle. Let $O_A$ and $O_C$ be the circumcenters of the cyclic quadrilaterals $AKPN$ and $CMPL$. $O_A$ is the midpoint of $AP$ and $O_C$ is the midpoint of $CP$. Thus, $O_A O_C$ is a midline in $\triangle APC$ and is parallel to $AC$. Also, $O_A O_C$ is the common perpendicular bisector of the parallel sides $KN$ and $LM$ of the rectangle, so it is parallel to $KL$. Hence, $AC \parallel KL$. Similarly, by considering the circumcenters of $BLPK$ and $DNPM$, we find that $BD \parallel KN$. Since $KLMN$ is a rectangle, $KL \perp KN$, which implies $AC \perp BD$.","Let $A B C D$ be a convex quadrilateral with perpendicular diagonals $A C \perp B D$. Let $P$ be the intersection of the line containing the circumdiameter of $\triangle ABD$ from vertex $A$, and the line containing the circumdiameter of $\triangle CBD$ from vertex $C$. Show that for the feet of the perpendiculars $K, N$ from $P$ to $AB, AD$, the line segment $KN$ is parallel to the diagonal $BD$.","Since $AC \perp BD$, the line $AC$ contains the altitude from vertex $A$ in $\triangle ABD$. The line $AP$ contains the circumdiameter from $A$. By the property of isogonal conjugates, the altitude and the circumdiameter from a vertex are isogonal with respect to the angle at that vertex. Thus, for $\angle DAB$, lines $AC$ and $AP$ are isogonal conjugates, which means $\angle PAB = \angle DAC$. Let $K$ and $N$ be the feet of perpendiculars from $P$ to $AB$ and $AD$. Then $AK = AP \cos(\angle PAB)$ and $AN = AP \cos(\angle PAD)$. From the isogonal property, we have $\angle PAB = \angle DAC$ and $\angle PAD = \angle BAC$. Let $R=AC \cap BD$. In right triangles $\triangle ARB$ and $\triangle ARD$, $AR = AB \cos(\angle BAC)$ and $AR = AD \cos(\angle DAC)$. Therefore, $AK/AN = \cos(\angle DAC)/\cos(\angle BAC) = (AR/AD)/(AR/AB) = AB/AD$, which implies $AK/AB = AN/AD$. By Thales' theorem, this means $KN \parallel BD$.",There is given a convex quadrilateral $A B C D$. Prove that there exists a point $P$ inside the quadrilateral such that $\angle P A B+\angle P D C=\angle P B C+\angle P A D=\angle P C D+\angle P B A=\angle P D A+\angle P C B=90^{\circ}$ if and only if the diagonals $A C$ and $B D$ are perpendicular.,"The 'only if' part was proven in Sub-problem 2. For the 'if' part, assume $AC \perp BD$. Let $P$ be the point constructed in Sub-problem 3 and let $K,L,M,N$ be the feet of perpendiculars from $P$ to the sides. By Sub-problem 3, $KN \parallel BD$. A similar argument shows $LM \parallel BD$. To complete the proof, we show $KL \parallel AC$. The ratio of the homothety at $A$ mapping $\triangle ABD \to \triangle AKN$ is $\lambda_A = AK/AB$. The ratio of the homothety at $C$ mapping $\triangle CDB \to \triangle CLM$ is $\lambda_C = CL/CB$. The circumcenters $U_A, U_C$ of $\triangle ABD, \triangle CDB$ are mapped to $O_A, O_C$, the midpoints of $AP, CP$. Since $U_A U_C \parallel AC$ and $O_A O_C \parallel AC$, the homothety ratios must be equal: $\lambda_A = \lambda_C = \lambda$. Thus $AK/AB = CL/CB = \lambda$, which implies $BK/AB = 1-\lambda$ and $BL/BC = 1-\lambda$. From $BK/BA = BL/BC$ in $\triangle ABC$, we conclude $KL \parallel AC$. Since $KN \parallel BD$ and $KL \parallel AC$, and $AC \perp BD$, it follows that $KLMN$ is a rectangle. By Sub-problem 1, point $P$ satisfies the required angle equalities."
2008g7,"Let $A B C D$ be a convex quadrilateral with $A B \neq B C$. Denote by $\omega_{1}$ and $\omega_{2}$ the incircles of triangles $A B C$ and $A D C$. Suppose that there exists a circle $\omega$ inscribed in angle $A B C$, tangent to the extensions of line segments $A D$ and $C D$. Prove that the common external tangents of $\omega_{1}$ and $\omega_{2}$ intersect on $\omega$.","Solution. The proof below is based on two known facts.\\
Lemma 1. Given a convex quadrilateral $A B C D$, suppose that there exists a circle which is inscribed in angle $A B C$ and tangent to the extensions of line segments $A D$ and $C D$. Then $A B+A D=C B+C D$.\\
Proof. The circle in question is tangent to each of the lines $A B, B C, C D, D A$, and the respective points of tangency $K, L, M, N$ are located as with circle $\omega$ in the figure. Then

$$
A B+A D=(B K-A K)+(A N-D N), \quad C B+C D=(B L-C L)+(C M-D M)
$$

Also $B K=B L, D N=D M, A K=A N, C L=C M$ by equalities of tangents. It follows that $A B+A D=C B+C D$.\\
\includegraphics[max width=\textwidth, center]{2025_05_05_fa6d5698664bd1bc5558g-41}

For brevity, in the sequel we write ""excircle $A C$ "" for the excircle of a triangle with side $A C$ which is tangent to line segment $A C$ and the extensions of the other two sides.\\
Lemma 2. The incircle of triangle $A B C$ is tangent to its side $A C$ at $P$. Let $P P^{\prime}$ be the diameter of the incircle through $P$, and let line $B P^{\prime}$ intersect $A C$ at $Q$. Then $Q$ is the point of tangency of side $A C$ and excircle $A C$.\\
Proof. Let the tangent at $P^{\prime}$ to the incircle $\omega_{1}$ meet $B A$ and $B C$ at $A^{\prime}$ and $C^{\prime}$. Now $\omega_{1}$ is the excircle $A^{\prime} C^{\prime}$ of triangle $A^{\prime} B C^{\prime}$, and it touches side $A^{\prime} C^{\prime}$ at $P^{\prime}$. Since $A^{\prime} C^{\prime} \| A C$, the homothety with centre $B$ and ratio $B Q / B P^{\prime}$ takes $\omega_{1}$ to the excircle $A C$ of triangle $A B C$. Because this homothety takes $P^{\prime}$ to $Q$, the lemma follows.

Recall also that if the incircle of a triangle touches its side $A C$ at $P$, then the tangency point $Q$ of the same side and excircle $A C$ is the unique point on line segment $A C$ such that $A P=C Q$.

We pass on to the main proof. Let $\omega_{1}$ and $\omega_{2}$ touch $A C$ at $P$ and $Q$, respectively; then $A P=(A C+A B-B C) / 2, C Q=(C A+C D-A D) / 2$. Since $A B-B C=C D-A D$ by Lemma 1 , we obtain $A P=C Q$. It follows that in triangle $A B C$ side $A C$ and excircle $A C$ are tangent at $Q$. Likewise, in triangle $A D C$ side $A C$ and excircle $A C$ are tangent at $P$. Note that $P \neq Q$ as $A B \neq B C$.

Let $P P^{\prime}$ and $Q Q^{\prime}$ be the diameters perpendicular to $A C$ of $\omega_{1}$ and $\omega_{2}$, respectively. Then Lemma 2 shows that points $B, P^{\prime}$ and $Q$ are collinear, and so are points $D, Q^{\prime}$ and $P$.

Consider the diameter of $\omega$ perpendicular to $A C$ and denote by $T$ its endpoint that is closer to $A C$. The homothety with centre $B$ and ratio $B T / B P^{\prime}$ takes $\omega_{1}$ to $\omega$. Hence $B, P^{\prime}$ and $T$ are collinear. Similarly, $D, Q^{\prime}$ and $T$ are collinear since the homothety with centre $D$ and ratio $-D T / D Q^{\prime}$ takes $\omega_{2}$ to $\omega$.

We infer that points $T, P^{\prime}$ and $Q$ are collinear, as well as $T, Q^{\prime}$ and $P$. Since $P P^{\prime} \| Q Q^{\prime}$, line segments $P P^{\prime}$ and $Q Q^{\prime}$ are then homothetic with centre $T$. The same holds true for circles $\omega_{1}$ and $\omega_{2}$ because they have $P P^{\prime}$ and $Q Q^{\prime}$ as diameters. Moreover, it is immediate that $T$ lies on the same side of line $P P^{\prime}$ as $Q$ and $Q^{\prime}$, hence the ratio of homothety is positive. In particular $\omega_{1}$ and $\omega_{2}$ are not congruent.

In summary, $T$ is the centre of a homothety with positive ratio that takes circle $\omega_{1}$ to circle $\omega_{2}$. This completes the solution, since the only point with the mentioned property is the intersection of the the common external tangents of $\omega_{1}$ and $\omega_{2}$.",4,Let $A B C D$ be a convex quadrilateral. Suppose there exists a circle $\omega$ inscribed in angle $A B C$ and tangent to the extensions of line segments $A D$ and $C D$. Prove that $A B+A D=C B+C D$.,"Let the circle $\omega$ be tangent to the lines $AB, BC, CD, DA$ at points $K, L, M, N$ respectively. By the property of tangents from a vertex to a circle, we have $BK=BL, DM=DN, AK=AN, CL=CM$. We can express the side lengths as differences of tangent segments: $AB = BK - AK$ and $AD = AN - DN$. Thus, $AB+AD = BK-AK+AN-DN = BK-DN$. Similarly, $CB = BL - CL$ and $CD = CM - DM$. Thus, $CB+CD = BL-CL+CM-DM = BL-DM$. Since $BK=BL$ and $DN=DM$, we conclude that $AB+AD=CB+CD$.","Let $\omega_1$ and $\omega_2$ be the incircles of $\triangle ABC$ and $\triangle ADC$ respectively, touching the common side $AC$ at points $P$ and $Q$. Given that $AB+AD=CB+CD$, prove that $AP=CQ$.","The distance from vertex $A$ to the tangency point of the incircle of $\triangle ABC$ on side $AC$ is given by the formula $AP = (AC+AB-BC)/2$. Similarly, the distance from vertex $C$ to the tangency point of the incircle of $\triangle ADC$ on side $AC$ is given by $CQ = (CA+CD-AD)/2$. The given condition $AB+AD=CB+CD$ can be rearranged to $AB-BC = CD-AD$. Substituting this into the expression for $AP$ gives $AP = (AC+CD-AD)/2$, which is equal to the expression for $CQ$.","Let $P, Q$ be the tangency points of $\omega_1, \omega_2$ on $AC$. Let $PP'$ and $QQ'$ be diameters of $\omega_1, \omega_2$ perpendicular to $AC$. Let $T$ be the endpoint, closer to $AC$, of the diameter of $\omega$ perpendicular to $AC$. Assuming $AP=CQ$, prove that $T$ is the center of the homothety that maps segment $PP'$ to segment $QQ' стан.","The condition $AP=CQ$ implies that $Q$ is the tangency point of the excircle of $\triangle ABC$ on side $AC$. A known result then implies that points $B, P', Q$ are collinear. Symmetrically, $D, Q', P$ are collinear. There is a homothety centered at $B$ that maps $\omega_1$ to $\omega$, which takes $P'$ to $T$, so $B, P', T$ are collinear. This implies $T, P', Q$ are collinear. Similarly, a homothety centered at $D$ maps $\omega_2$ to $\omega$, taking $Q'$ to $T$, so $D, Q', T$ are collinear. This implies $T, Q', P$ are collinear. Thus, $T$ is the intersection of lines $P'Q$ and $PQ'$. As $PP' \parallel QQ'$, this intersection point $T$ is the center of homothety mapping segment $PP'$ to $QQ'$.","Let $A B C D$ be a convex quadrilateral with $A B \neq B C$. Denote by $\omega_{1}$ and $\omega_{2}$ the incircles of triangles $A B C$ and $A D C$. Suppose that there exists a circle $\omega$ inscribed in angle $A B C$, tangent to the extensions of line segments $A D$ and $C D$. Prove that the common external tangents of $\omega_{1}$ and $\omega_{2}$ intersect on $\omega$.","The existence of $\omega$ implies $AB+AD=CB+CD$ (Sub-problem 1), which in turn implies $AP=CQ$ (Sub-problem 2). From this, we showed that a specific point $T$ on $\omega$ is the center of the homothety that maps diameter $PP'$ of $\omega_1$ to diameter $QQ'$ of $\omega_2$ (Sub-problem 3). This homothety consequently maps circle $\omega_1$ to circle $\omega_2$. Since $AB \neq BC$, the radii of $\omega_1$ and $\omega_2$ are different, and the homothety is well-defined. The point $T$ is external to the strip between the parallel lines containing the diameters, so the ratio of homothety is positive. The center of a homothety with a positive ratio between two circles is the intersection of their common external tangents. Therefore, the common external tangents of $\omega_1$ and $\omega_2$ intersect at point $T$, which lies on the circle $\omega$."
2008n1,"Let $n$ be a positive integer and let $p$ be a prime number. Prove that if $a, b, c$ are integers (not necessarily positive) satisfying the equations

$$
a^{n}+p b=b^{n}+p c=c^{n}+p a,
$$

then $a=b=c$.","If two of $a, b, c$ are equal, it is immediate that all the three are equal. So we may assume that $a \neq b \neq c \neq a$. Subtracting the equations we get $a^{n}-b^{n}=-p(b-c)$ and two cyclic copies of this equation, which upon multiplication yield


\begin{equation*}
\frac{a^{n}-b^{n}}{a-b} \cdot \frac{b^{n}-c^{n}}{b-c} \cdot \frac{c^{n}-a^{n}}{c-a}=-p^{3} . \tag{1}
\end{equation*}


If $n$ is odd then the differences $a^{n}-b^{n}$ and $a-b$ have the same sign and the product on the left is positive, while $-p^{3}$ is negative. So $n$ must be even.

Let $d$ be the greatest common divisor of the three differences $a-b, b-c, c-a$, so that $a-b=d u, b-c=d v, c-a=d w ; \quad \operatorname{gcd}(u, v, w)=1, u+v+w=0$.

From $a^{n}-b^{n}=-p(b-c)$ we see that $(a-b) \mid p(b-c)$, i.e., $u \mid p v$; and cyclically $v|p w, w| p u$. As $\operatorname{gcd}(u, v, w)=1$ and $u+v+w=0$, at most one of $u, v, w$ can be divisible by $p$. Supposing that the prime $p$ does not divide any one of them, we get $u|v, v| w, w \mid u$, whence $|u|=|v|=|w|=1$; but this quarrels with $u+v+w=0$.

Thus $p$ must divide exactly one of these numbers. Let e.g. $p \mid u$ and write $u=p u_{1}$. Now we obtain, similarly as before, $u_{1}|v, v| w, w \mid u_{1}$ so that $\left|u_{1}\right|=|v|=|w|=1$. The equation $p u_{1}+v+w=0$ forces that the prime $p$ must be even; i.e. $p=2$. Hence $v+w=-2 u_{1}= \pm 2$, implying $v=w(= \pm 1)$ and $u=-2 v$. Consequently $a-b=-2(b-c)$.

Knowing that $n$ is even, say $n=2 k$, we rewrite the equation $a^{n}-b^{n}=-p(b-c)$ with $p=2$ in the form

$$
\left(a^{k}+b^{k}\right)\left(a^{k}-b^{k}\right)=-2(b-c)=a-b .
$$

The second factor on the left is divisible by $a-b$, so the first factor $\left(a^{k}+b^{k}\right)$ must be $\pm 1$. Then exactly one of $a$ and $b$ must be odd; yet $a-b=-2(b-c)$ is even. Contradiction ends the proof.",3,"Assuming $a,b,c$ are distinct integers satisfying the given equations, prove that the integer $n$ must be even.","Assume $a, b, c$ are distinct. The equations $a^{n}+p b=b^{n}+p c=c^{n}+p a$ yield $a^n - b^n = p(c-b)$, $b^n - c^n = p(a-c)$, and $c^n - a^n = p(b-a)$. Multiplying these gives $(a^n - b^n)(b^n - c^n)(c^n - a^n) = -p^3 (a-b)(b-c)(c-a)$. As $a,b,c$ are distinct, we divide by $(a-b)(b-c)(c-a)$ to get $\frac{a^{n}-b^{n}}{a-b} \cdot \frac{b^{n}-c^{n}}{b-c} \cdot \frac{c^{n}-a^{n}}{c-a}=-p^{3}$. If $n$ is odd, for distinct integers $x,y$, the term $\frac{x^n-y^n}{x-y} = x^{n-1} + x^{n-2}y + \dots + y^{n-1}$ is always positive. Thus, the left side of the equation is positive, while the right side, $-p^3$, is negative. This is a contradiction, so $n$ must be even.","Assuming $a,b,c$ are distinct, show that $p=2$ and that the differences $a-b, b-c, c-a$ are proportional to a permutation of $(-2, 1, 1)$.","From $a^n - b^n = -p(b-c)$, we have $(a-b) | p(b-c)$. Cyclically, $(b-c) | p(c-a)$ and $(c-a) | p(a-b)$. Let $a-b=du, b-c=dv, c-a=dw$ where $d=\gcd(a-b,b-c,c-a)$ and $\gcd(u,v,w)=1$. The conditions become $u|pv, v|pw, w|pu$. As $u,v,w$ are pairwise coprime and sum to 0, $p$ must divide exactly one of them, say $p|u$. Let $u=pu_1$. The divisibility conditions imply $u_1|v, v|w, w|u_1$, which gives $|u_1|=|v|=|w|=1$. The equation $u+v+w=0$ becomes $pu_1+v+w=0$. As $v,w \in \{-1,1\}$, $v+w$ must be $\pm 2$, which implies $v=w$. Then $pu_1 = -2v$. Since $|u_1|=|v|=1$ and $p$ is prime, this forces $p=2$. Consequently, $(u,v,w)$ is a permutation of $(\mp 2, \pm 1, \pm 1)$, meaning $(a-b, b-c, c-a)$ is proportional to a permutation of $(-2,1,1)$.","Let $n$ be a positive integer and let $p$ be a prime number. Prove that if $a, b, c$ are integers (not necessarily positive) satisfying the equations $a^{n}+p b=b^{n}+p c=c^{n}+p a$, then $a=b=c$.","If any two of $a,b,c$ are equal, say $a=b$, the equation $a^n+pb=b^n+pc$ implies $pa=pc$, so $a=c$. Thus $a=b=c$. Assume $a,b,c$ are distinct. From sub-problem 1, $n$ is even, say $n=2k$. From sub-problem 2, $p=2$ and, without loss of generality, $a-b = -2(b-c)$. Substituting this into the initial relation $a^n-b^n=-p(b-c)$ gives $a^n-b^n = a-b$. As $a \neq b$, dividing by $(a-b)$ yields $\frac{a^{2k}-b^{2k}}{a-b}=1$, which implies $(a^k+b^k) \frac{a^k-b^k}{a-b} = 1$. Since both factors are integers, we must have $a^k+b^k = \pm 1$. This implies that one of $a,b$ is $\pm 1$ and the other is $0$. Therefore, one is even and one is odd, so their difference $a-b$ must be odd. However, the relation $a-b = -2(b-c)$ shows $a-b$ is even. This contradiction proves the assumption that $a,b,c$ are distinct is false. Thus, $a=b=c$.",,
2008n2,"Let $a_{1}, a_{2}, \ldots, a_{n}$ be distinct positive integers, $n \geq 3$. Prove that there exist distinct indices $i$ and $j$ such that $a_{i}+a_{j}$ does not divide any of the numbers $3 a_{1}, 3 a_{2}, \ldots, 3 a_{n}$.","Solution. Without loss of generality, let $0<a_{1}<a_{2}<\cdots<a_{n}$. One can also assume that $a_{1}, a_{2}, \ldots, a_{n}$ are coprime. Otherwise division by their greatest common divisor reduces the question to the new sequence whose terms are coprime integers.

Suppose that the claim is false. Then for each $i<n$ there exists a $j$ such that $a_{n}+a_{i}$ divides $3 a_{j}$. If $a_{n}+a_{i}$ is not divisible by 3 then $a_{n}+a_{i}$ divides $a_{j}$ which is impossible as $0<a_{j} \leq a_{n}<a_{n}+a_{i}$. Thus $a_{n}+a_{i}$ is a multiple of 3 for $i=1, \ldots, n-1$, so that $a_{1}, a_{2}, \ldots, a_{n-1}$ are all congruent (to $-a_{n}$ ) modulo 3 .

Now $a_{n}$ is not divisible by 3 or else so would be all remaining $a_{i}$ 's, meaning that $a_{1}, a_{2}, \ldots, a_{n}$ are not coprime. Hence $a_{n} \equiv r(\bmod 3)$ where $r \in\{1,2\}$, and $a_{i} \equiv 3-r(\bmod 3)$ for all $i=1, \ldots, n-1$.

Consider a sum $a_{n-1}+a_{i}$ where $1 \leq i \leq n-2$. There is at least one such sum as $n \geq 3$. Let $j$ be an index such that $a_{n-1}+a_{i}$ divides $3 a_{j}$. Observe that $a_{n-1}+a_{i}$ is not divisible by 3 since $a_{n-1}+a_{i} \equiv 2 a_{i} \not \equiv 0(\bmod 3)$. It follows that $a_{n-1}+a_{i}$ divides $a_{j}$, in particular $a_{n-1}+a_{i} \leq a_{j}$. Hence $a_{n-1}<a_{j} \leq a_{n}$, implying $j=n$. So $a_{n}$ is divisible by all sums $a_{n-1}+a_{i}, 1 \leq i \leq n-2$. In particular $a_{n-1}+a_{i} \leq a_{n}$ for $i=1, \ldots, n-2$.

Let $j$ be such that $a_{n}+a_{n-1}$ divides $3 a_{j}$. If $j \leq n-2$ then $a_{n}+a_{n-1} \leq 3 a_{j}<a_{j}+2 a_{n-1}$. This yields $a_{n}<a_{n-1}+a_{j}$; however $a_{n-1}+a_{j} \leq a_{n}$ for $j \leq n-2$. Therefore $j=n-1$ or $j=n$.

For $j=n-1$ we obtain $3 a_{n-1}=k\left(a_{n}+a_{n-1}\right)$ with $k$ an integer, and it is straightforward that $k=1\left(k \leq 0\right.$ and $k \geq 3$ contradict $0<a_{n-1}<a_{n} ; k=2$ leads to $\left.a_{n-1}=2 a_{n}>a_{n-1}\right)$. Thus $3 a_{n-1}=a_{n}+a_{n-1}$, i. e. $a_{n}=2 a_{n-1}$.

Similarly, if $j=n$ then $3 a_{n}=k\left(a_{n}+a_{n-1}\right)$ for some integer $k$, and only $k=2$ is possible. Hence $a_{n}=2 a_{n-1}$ holds true in both cases remaining, $j=n-1$ and $j=n$.

Now $a_{n}=2 a_{n-1}$ implies that the sum $a_{n-1}+a_{1}$ is strictly between $a_{n} / 2$ and $a_{n}$. But $a_{n-1}$ and $a_{1}$ are distinct as $n \geq 3$, so it follows from the above that $a_{n-1}+a_{1}$ divides $a_{n}$. This provides the desired contradiction.",3,"Let $a_1 < a_2 < \dots < a_n$ be distinct positive integers. Suppose that for every pair of distinct indices $i, j$, there exists an index $k$ such that $a_i+a_j$ divides $3a_k$. Show that for all $i \in \{1, \dots, n-1\}$, $a_i$ and $a_{n-1}$ are congruent modulo 3, while $a_n$ has a different non-zero residue modulo 3.","For any $i \in \{1, \ldots, n-1\}$, by hypothesis, $a_n+a_i | 3a_j$ for some $j$. Since $a_n+a_i > a_n \geq a_j$, it's impossible for $a_n+a_i$ to divide $a_j$. Thus, $a_n+a_i$ must be a multiple of 3. This holds for all $i=1, \ldots, n-1$, which implies $a_i \equiv -a_n \pmod 3$ for these $i$. Assuming the numbers are coprime (WLOG), $a_n$ cannot be a multiple of 3. So if $a_n \equiv r \pmod 3$ with $r \in \{1,2\}$, then $a_i \equiv 3-r \pmod 3$ for all $i=1, \ldots, n-1$.","Under the same hypothesis as the previous sub-problem, and using its conclusion about the residues modulo 3, prove that $a_n = 2a_{n-1}$.","Consider a sum $a_{n-1}+a_i$ for $1 \leq i \leq n-2$. Since $a_{n-1}$ and $a_i$ have the same non-zero residue mod 3, their sum is not divisible by 3. By hypothesis, $a_{n-1}+a_i | 3a_j$ for some $j$, so $a_{n-1}+a_i | a_j$. As $a_{n-1} < a_{n-1}+a_i \leq a_j$, we must have $j=n$. So, $a_{n-1}+a_i$ divides $a_n$ for all $1 \leq i \leq n-2$. Now consider $a_n+a_{n-1}$, which must divide $3a_j$ for some $j$. Analysis shows $j$ must be $n-1$ or $n$. If $a_n+a_{n-1} | 3a_{n-1}$, then $a_n=2a_{n-1}$. If $a_n+a_{n-1} | 3a_n$, then $a_n=2a_{n-1}$. Thus, $a_n=2a_{n-1}$ must hold.","Let $a_{1}, a_{2}, \ldots, a_{n}$ be distinct positive integers, $n \geq 3$. Prove that there exist distinct indices $i$ and $j$ such that $a_{i}+a_{j}$ does not divide any of the numbers $3 a_{1}, 3 a_{2}, \ldots, 3 a_{n}$.","Assume for contradiction that for any distinct $i,j$, there is a $k$ such that $a_i+a_j | 3a_k$. Let $0<a_1<\cdots<a_n$. This assumption implies that $a_n=2a_{n-1}$ and that for $1 \le i \le n-2$, the sum $a_{n-1}+a_i$ must divide $a_n$. Since $n \ge 3$, we take $i=1$. Then $a_{n-1}+a_1$ must divide $a_n=2a_{n-1}$. However, as $0 < a_1 < a_{n-1}$, we have $a_{n-1} < a_{n-1}+a_1 < 2a_{n-1}$. This implies $2a_{n-1}=k(a_{n-1}+a_1)$ for some integer $k$, which must satisfy $1 < k < 2$. No such integer $k$ exists. This contradiction proves the original statement.",,
2008n3,"Let $a_{0}, a_{1}, a_{2}, \ldots$ be a sequence of positive integers such that the greatest common divisor of any two consecutive terms is greater than the preceding term; in symbols, $\operatorname{gcd}\left(a_{i}, a_{i+1}\right)>a_{i-1}$. Prove that $a_{n} \geq 2^{n}$ for all $n \geq 0$.","Solution. Since $a_{i} \geq \operatorname{gcd}\left(a_{i}, a_{i+1}\right)>a_{i-1}$, the sequence is strictly increasing. In particular $a_{0} \geq 1, a_{1} \geq 2$. For each $i \geq 1$ we also have $a_{i+1}-a_{i} \geq \operatorname{gcd}\left(a_{i}, a_{i+1}\right)>a_{i-1}$, and consequently $a_{i+1} \geq a_{i}+a_{i-1}+1$. Hence $a_{2} \geq 4$ and $a_{3} \geq 7$. The equality $a_{3}=7$ would force equalities in the previous estimates, leading to $\operatorname{gcd}\left(a_{2}, a_{3}\right)=\operatorname{gcd}(4,7)>a_{1}=2$, which is false. Thus $a_{3} \geq 8$; the result is valid for $n=0,1,2,3$. These are the base cases for a proof by induction.

Take an $n \geq 3$ and assume that $a_{i} \geq 2^{i}$ for $i=0,1, \ldots, n$. We must show that $a_{n+1} \geq 2^{n+1}$. Let $\operatorname{gcd}\left(a_{n}, a_{n+1}\right)=d$. We know that $d>a_{n-1}$. The induction claim is reached immediately in the following cases:

$$
\begin{aligned}
& \text { if } a_{n+1} \geq 4 d \text { then } a_{n+1}>4 a_{n-1} \geq 4 \cdot 2^{n-1}=2^{n+1} \\
& \text { if } a_{n} \geq 3 d \quad \text { then } a_{n+1} \geq a_{n}+d \geq 4 d>4 a_{n-1} \geq 4 \cdot 2^{n-1}=2^{n+1} ; \\
& \text { if } a_{n}=d \quad \text { then } a_{n+1} \geq a_{n}+d=2 a_{n} \geq 2 \cdot 2^{n}=2^{n+1} .
\end{aligned}
$$

The only remaining possibility is that $a_{n}=2 d$ and $a_{n+1}=3 d$, which we assume for the sequel. So $a_{n+1}=\frac{3}{2} a_{n}$.

Let now $\operatorname{gcd}\left(a_{n-1}, a_{n}\right)=d^{\prime}$; then $d^{\prime}>a_{n-2}$. Write $a_{n}=m d^{\prime}$ ( $m$ an integer). Keeping in mind that $d^{\prime} \leq a_{n-1}<d$ and $a_{n}=2 d$, we get that $m \geq 3$. Also $a_{n-1}<d=\frac{1}{2} m d^{\prime}$, $a_{n+1}=\frac{3}{2} m d^{\prime}$. Again we single out the cases which imply the induction claim immediately:

$$
\begin{aligned}
& \text { if } m \geq 6 \text { then } a_{n+1}=\frac{3}{2} m d^{\prime} \geq 9 d^{\prime}>9 a_{n-2} \geq 9 \cdot 2^{n-2}>2^{n+1} ; \\
& \text { if } 3 \leq m \leq 4 \text { then } a_{n-1}<\frac{1}{2} \cdot 4 d^{\prime}, \text { and hence } a_{n-1}=d^{\prime}, \\
& \qquad a_{n+1}=\frac{3}{2} m a_{n-1} \geq \frac{3}{2} \cdot 3 a_{n-1} \geq \frac{9}{2} \cdot 2^{n-1}>2^{n+1} .
\end{aligned}
$$

So we are left with the case $m=5$, which means that $a_{n}=5 d^{\prime}, \quad a_{n+1}=\frac{15}{2} d^{\prime}, \quad a_{n-1}<d=\frac{5}{2} d^{\prime}$. The last relation implies that $a_{n-1}$ is either $d^{\prime}$ or $2 d^{\prime}$. Anyway, $a_{n-1} \mid 2 d^{\prime}$.

The same pattern repeats once more. We denote $\operatorname{gcd}\left(a_{n-2}, a_{n-1}\right)=d^{\prime \prime}$; then $d^{\prime \prime}>a_{n-3}$. Because $d^{\prime \prime}$ is a divisor of $a_{n-1}$, hence also of $2 d^{\prime}$, we may write $2 d^{\prime}=m^{\prime} d^{\prime \prime} \quad$ ( $m^{\prime}$ an integer). Since $d^{\prime \prime} \leq a_{n-2}<d^{\prime}$, we get $m^{\prime} \geq 3$. Also, $a_{n-2}<d^{\prime}=\frac{1}{2} m^{\prime} d^{\prime \prime}, a_{n+1}=\frac{15}{2} d^{\prime}=\frac{15}{4} m^{\prime} d^{\prime \prime}$. As before, we consider the cases:

$$
\begin{aligned}
& \text { if } m^{\prime} \geq 5 \quad \text { then } a_{n+1}=\frac{15}{4} m^{\prime} d^{\prime \prime} \geq \frac{75}{4} d^{\prime \prime}>\frac{75}{4} a_{n-3} \geq \frac{75}{4} \cdot 2^{n-3}>2^{n+1} ; \\
& \text { if } 3 \leq m^{\prime} \leq 4 \text { then } a_{n-2}<\frac{1}{2} \cdot 4 d^{\prime \prime}, \text { and hence } a_{n-2}=d^{\prime \prime}, \\
& \qquad a_{n+1}=\frac{15}{4} m^{\prime} a_{n-2} \geq \frac{15}{4} \cdot 3 a_{n-2} \geq \frac{45}{4} \cdot 2^{n-2}>2^{n+1} .
\end{aligned}
$$

Both of them have produced the induction claim. But now there are no cases left. Induction is complete; the inequality $a_{n} \geq 2^{n}$ holds for all $n$.",4,"Show that the sequence $(a_n)$ is strictly increasing and verify that $a_n \geq 2^n$ for $n=0, 1, 2, 3$.","For $i \geq 1$, we have $a_i \geq \operatorname{gcd}(a_i, a_{i+1}) > a_{i-1}$, so the sequence of positive integers is strictly increasing. For the base cases: $a_0$ is a positive integer, so $a_0 \geq 1 = 2^0$. Then $a_1 > a_0 \geq 1$, so $a_1 \geq 2 = 2^1$. From the problem statement, $a_{i+1} \geq a_i + \operatorname{gcd}(a_i, a_{i+1}) > a_i + a_{i-1}$. Thus $a_2 > a_1+a_0 \geq 2+1=3$, so $a_2 \geq 4=2^2$. Then $a_3 > a_2+a_1 \geq 4+2=6$, so $a_3 \geq 7$. If $a_1=2, a_2=4, a_3=7$, we get $\operatorname{gcd}(a_2,a_3)=\operatorname{gcd}(4,7)=1$, but we require $\operatorname{gcd}(a_2, a_3) > a_1=2$, a contradiction. Thus $a_3 \geq 8=2^3$. The statement holds for $n=0,1,2,3$.","Assume $a_i \geq 2^i$ for $0 \leq i \leq n$ with $n \geq 3$. Let $d=\operatorname{gcd}(a_n, a_{n+1})$. Show that if it's not the case that ($a_n = 2d$ and $a_{n+1} = 3d$), then $a_{n+1} \geq 2^{n+1}$.","By the inductive hypothesis and the problem statement, $d = \operatorname{gcd}(a_n, a_{n+1}) > a_{n-1} \geq 2^{n-1}$. Since $a_n$ and $a_{n+1}$ are multiples of $d$ and $a_{n+1} > a_n$, let $a_n=kd, a_{n+1}=ld$ for integers $l>k \geq 1$. We examine cases:
1. If $l \geq 4$, then $a_{n+1} \geq 4d > 4a_{n-1} \geq 4 \cdot 2^{n-1} = 2^{n+1}$.
2. If $k \geq 3$, then $a_n \geq 3d$, so $a_{n+1} \geq a_n+d \geq 4d$, which reduces to the first case.
3. If $k=1$, then $a_n=d$. Then $a_{n+1} \geq a_n+d=2a_n \geq 2 \cdot 2^n = 2^{n+1}$.
The only remaining possibility not covered is $k=2$ and $l=3$, which corresponds to $a_n=2d$ and $a_{n+1}=3d$. Thus, if this specific case does not hold, the inductive step is complete.","Continuing the induction, assume $a_n=2d$ and $a_{n+1}=3d$, where $d=\operatorname{gcd}(a_n, a_{n+1})$. Let $d' = \operatorname{gcd}(a_{n-1}, a_n)$ and $a_n = md'$. Show that if $m \neq 5$, then $a_{n+1} \geq 2^{n+1}$.","From the assumptions, we have $a_{n+1} = \frac{3}{2}a_n$. We are given $d' = \operatorname{gcd}(a_{n-1}, a_n) > a_{n-2} \geq 2^{n-2}$. Also, $d' \leq a_{n-1} < d = a_n/2$. With $a_n = md'$, this means $d' < md'/2$, so $m>2$. We analyze integer values of $m \geq 3$:
1. If $m \geq 6$, then $a_{n+1} = \frac{3}{2}a_n = \frac{3}{2}md' \geq 9d' > 9a_{n-2} \geq 9 \cdot 2^{n-2} > 2^{n+1}$.
2. If $m=3$ or $m=4$, then $d' \leq a_{n-1} < d = \frac{m}{2}d' \leq 2d'$. Since $a_{n-1}$ is a multiple of $d'$, we must have $a_{n-1}=d'$. Then $a_{n+1} = \frac{3}{2}ma_{n-1} \geq \frac{3}{2}(3)a_{n-1} = \frac{9}{2}a_{n-1} \geq \frac{9}{2} \cdot 2^{n-1} > 2^{n+1}$.
Thus, the claim holds for all cases except $m=5$.",Prove that $a_n \geq 2^n$ for all $n \geq 0$.,"We use strong induction. Part 1 establishes the base cases $n=0,1,2,3$. Assume $a_i \geq 2^i$ for $0 \leq i \leq n$ where $n \geq 3$. From Parts 2 and 3, the inductive step $a_{n+1} \geq 2^{n+1}$ holds unless we are in the specific case where $a_n=2d$ (with $d=\operatorname{gcd}(a_n,a_{n+1})$) and $a_n=5d'$ (with $d'=\operatorname{gcd}(a_{n-1},a_n)$). In this last case, $a_{n+1}=\frac{3}{2}a_n = \frac{15}{2}d'$. We have $a_{n-1} < d = \frac{5}{2}d'$, so $a_{n-1}$ is $d'$ or $2d'$. Let $d'' = \operatorname{gcd}(a_{n-2}, a_{n-1}) > a_{n-3}$. Since $d''|a_{n-1}$ and $a_{n-1}|2d'$, we have $d''|2d'$. Let $2d' = m'd''$. As $d'' \leq a_{n-2} < d'$, we have $m'>2$. Then $a_{n+1} = \frac{15}{2}d' = \frac{15}{4}m'd''$. If $m' \geq 5$, $a_{n+1} \geq \frac{75}{4}d'' > \frac{75}{4}a_{n-3} \geq \frac{75}{4} 2^{n-3} > 2^{n+1}$. If $m'=3$ or $m'=4$, then $a_{n-2} < d' = \frac{m'}{2}d'' \leq 2d''$, which implies $a_{n-2}=d''$. So $a_{n+1} = \frac{15}{4}m'a_{n-2} \geq \frac{15}{4}(3)a_{n-2} = \frac{45}{4}a_{n-2} \geq \frac{45}{4}2^{n-2} > 2^{n+1}$. Since all possible cases have been exhausted and lead to the desired conclusion, the induction is complete. Therefore, $a_n \geq 2^n$ for all $n \geq 0$."
2008n4,"Let $n$ be a positive integer. Show that the numbers

$$
\binom{2^{n}-1}{0}, \quad\binom{2^{n}-1}{1}, \quad\binom{2^{n}-1}{2}, \quad \ldots, \quad\binom{2^{n}-1}{2^{n-1}-1}
$$

are congruent modulo $2^{n}$ to $1,3,5, \ldots, 2^{n}-1$ in some order.","It is well-known that all these numbers are odd. So the assertion that their remainders $\left(\bmod 2^{n}\right)$ make up a permutation of $\left\{1,3, \ldots, 2^{n}-1\right\}$ is equivalent just to saying that these remainders are all distinct. We begin by showing that


\begin{equation*}
\binom{2^{n}-1}{2 k}+\binom{2^{n}-1}{2 k+1} \equiv 0\left(\bmod 2^{n}\right) \quad \text { and } \quad\binom{2^{n}-1}{2 k} \equiv(-1)^{k}\binom{2^{n-1}-1}{k}\left(\bmod 2^{n}\right) \tag{1}
\end{equation*}


The first relation is immediate, as the sum on the left is equal to $\binom{2^{n}}{2 k+1}=\frac{2^{n}}{2 k+1}\binom{2^{n}-1}{2 k}$, hence is divisible by $2^{n}$. The second relation:

$$
\binom{2^{n}-1}{2 k}=\prod_{j=1}^{2 k} \frac{2^{n}-j}{j}=\prod_{i=1}^{k} \frac{2^{n}-(2 i-1)}{2 i-1} \cdot \prod_{i=1}^{k} \frac{2^{n-1}-i}{i} \equiv(-1)^{k}\binom{2^{n-1}-1}{k} \quad\left(\bmod 2^{n}\right) .
$$

This prepares ground for a proof of the required result by induction on $n$. The base case $n=1$ is obvious. Assume the assertion is true for $n-1$ and pass to $n$, denoting $a_{k}=\binom{2^{n-1}-1}{k}$, $b_{m}=\binom{2^{n}-1}{m}$. The induction hypothesis is that all the numbers $a_{k}\left(0 \leq k<2^{n-2}\right)$ are distinct $\left(\bmod 2^{n-1}\right)$; the claim is that all the numbers $b_{m}\left(0 \leq m<2^{n-1}\right)$ are distinct $\left(\bmod 2^{n}\right)$.

The congruence relations (1) are restated as


\begin{equation*}
b_{2 k} \equiv(-1)^{k} a_{k} \equiv-b_{2 k+1} \quad\left(\bmod 2^{n}\right) \tag{2}
\end{equation*}


Shifting the exponent in the first relation of (1) from $n$ to $n-1$ we also have the congruence $a_{2 i+1} \equiv-a_{2 i}\left(\bmod 2^{n-1}\right)$. We hence conclude:


\begin{equation*}
\text { If, for some } j, k<2^{n-2}, a_{k} \equiv-a_{j}\left(\bmod 2^{n-1}\right), \text { then }\{j, k\}=\{2 i, 2 i+1\} \text { for some } i \text {. } \tag{3}
\end{equation*}


This is so because in the sequence $\left(a_{k}: k<2^{n-2}\right)$ each term $a_{j}$ is complemented to $0\left(\bmod 2^{n-1}\right)$ by only one other term $a_{k}$, according to the induction hypothesis.

From (2) we see that $b_{4 i} \equiv a_{2 i}$ and $b_{4 i+3} \equiv a_{2 i+1}\left(\bmod 2^{n}\right)$. Let

$$
M=\left\{m: 0 \leq m<2^{n-1}, m \equiv 0 \text { or } 3(\bmod 4)\right\}, \quad L=\left\{l: 0 \leq l<2^{n-1}, l \equiv 1 \text { or } 2(\bmod 4)\right\} .
$$

The last two congruences take on the unified form


\begin{equation*}
b_{m} \equiv a_{\lfloor m / 2\rfloor} \quad\left(\bmod 2^{n}\right) \quad \text { for all } \quad m \in M \tag{4}
\end{equation*}


Thus all the numbers $b_{m}$ for $m \in M$ are distinct $\left(\bmod 2^{n}\right)$ because so are the numbers $a_{k}$ (they are distinct $\left(\bmod 2^{n-1}\right)$, hence also $\left(\bmod 2^{n}\right)$ ).

Every $l \in L$ is paired with a unique $m \in M$ into a pair of the form $\{2 k, 2 k+1\}$. So (2) implies that also all the $b_{l}$ for $l \in L$ are distinct $\left(\bmod 2^{n}\right)$. It remains to eliminate the possibility that $b_{m} \equiv b_{l}\left(\bmod 2^{n}\right)$ for some $m \in M, l \in L$.

Suppose that such a situation occurs. Let $m^{\prime} \in M$ be such that $\left\{m^{\prime}, l\right\}$ is a pair of the form $\{2 k, 2 k+1\}$, so that $($ see $(2)) \quad b_{m^{\prime}} \equiv-b_{l}\left(\bmod 2^{n}\right)$. Hence $b_{m^{\prime}} \equiv-b_{m}\left(\bmod 2^{n}\right)$. Since both $m^{\prime}$ and $m$ are in $M$, we have by (4) $b_{m^{\prime}} \equiv a_{j}, b_{m} \equiv a_{k}\left(\bmod 2^{n}\right)$ for $j=\left\lfloor m^{\prime} / 2\right\rfloor, k=\lfloor m / 2\rfloor$.

Then $a_{j} \equiv-a_{k}\left(\bmod 2^{n}\right)$. Thus, according to (3), $j=2 i, k=2 i+1$ for some $i$ (or vice versa). The equality $a_{2 i+1} \equiv-a_{2 i}\left(\bmod 2^{n}\right)$ now means that $\binom{2^{n-1}-1}{2 i}+\binom{2^{n-1}-1}{2 i+1} \equiv 0\left(\bmod 2^{n}\right)$. However, the sum on the left is equal to $\binom{2^{n-1}}{2 i+1}$. A number of this form cannot be divisible by $2^{n}$. This is a contradiction which concludes the induction step and proves the result.",4,"Let $b_k = \binom{2^n-1}{k}$ and $a_k = \binom{2^{n-1}-1}{k}$. Prove the following congruences modulo $2^n$:
1. $b_{2k} + b_{2k+1} \equiv 0 \pmod{2^n}$
2. $b_{2k} \equiv (-1)^k a_k \pmod{2^n}$","1. The sum is given by Pascal's identity: $\binom{2^n-1}{2k} + \binom{2^n-1}{2k+1} = \binom{2^n}{2k+1} = \frac{2^n}{2k+1}\binom{2^n-1}{2k}$. Since $2k+1$ is odd, this expression is an integer multiple of $2^n$, so it is congruent to $0 \pmod{2^n}$.
2. We expand the binomial coefficient: $\binom{2^n-1}{2k} = \prod_{j=1}^{2k} \frac{2^n-j}{j} = \left(\prod_{i=1}^{k} \frac{2^n-(2i-1)}{2i-1}\right) \left(\prod_{i=1}^{k} \frac{2^n-2i}{2i}\right)$. Modulo $2^n$, the first product becomes $\prod_{i=1}^{k} \frac{-(2i-1)}{2i-1} = (-1)^k$. The second product is $\prod_{i=1}^{k} \frac{2^{n-1}-i}{i} = \binom{2^{n-1}-1}{k} = a_k$. Thus, $b_{2k} \equiv (-1)^k a_k \pmod{2^n}$.","Let $M = \{m \mid 0 \le m < 2^{n-1}, m \equiv 0 \text{ or } 3 \pmod 4\}$. Show that for any $m \in M$, we have the congruence $\binom{2^n-1}{m} \equiv \binom{2^{n-1}-1}{\lfloor m/2 \rfloor} \pmod{2^n}$.","Let $b_m = \binom{2^n-1}{m}$ and $a_k = \binom{2^{n-1}-1}{k}$. From the relations $b_{2k} \equiv (-1)^k a_k \pmod{2^n}$ and $b_{2k+1} \equiv -b_{2k} \pmod{2^n}$, we have $b_{2k+1} \equiv -(-1)^k a_k \pmod{2^n}$.
If $m = 4i$ for some integer $i$, then $m=2k$ with $k=2i$ (even). Thus, $b_{4i} \equiv (-1)^{2i} a_{2i} \equiv a_{2i} \pmod{2^n}$. Since $\lfloor m/2 \rfloor = 2i$, the relation holds.
If $m = 4i+3$ for some integer $i$, then $m=2k+1$ with $k=2i+1$ (odd). Thus, $b_{4i+3} \equiv -(-1)^{2i+1} a_{2i+1} \equiv a_{2i+1} \pmod{2^n}$. Since $\lfloor m/2 \rfloor = 2i+1$, the relation holds. In both cases, $b_m \equiv a_{\lfloor m/2 \rfloor} \pmod{2^n}$ for $m \in M$.","Assume the numbers $a_k = \binom{2^{n-1}-1}{k}$ for $k=0, \ldots, 2^{n-2}-1$ are distinct modulo $2^{n-1}$. Let $b_m = \binom{2^n-1}{m}$. Show that the sets of residues $\{b_m \pmod{2^n} \mid 0 \le m < 2^{n-1}, m \equiv 0 \text{ or } 3 \pmod 4\}$ and $\{b_l \pmod{2^n} \mid 0 \le l < 2^{n-1}, l \equiv 1 \text{ or } 2 \pmod 4\}$ each contain distinct elements.","Let $M = \{m \mid m \equiv 0,3 \pmod 4\}$ and $L = \{m \mid m \equiv 1,2 \pmod 4\}$. By assumption, the $a_k$ are distinct mod $2^{n-1}$. Since all $a_k$ are odd, they must also be distinct mod $2^n$. For $m \in M$, we have $b_m \equiv a_{\lfloor m/2 \rfloor} \pmod{2^n}$. The map $m \mapsto \lfloor m/2 \rfloor$ is a bijection from $M$ to $\{0, \ldots, 2^{n-2}-1\}$. Thus, the numbers $\{b_m \mid m \in M\}$ are distinct modulo $2^n$. For any $l \in L$, there is a unique $m' \in M$ such that $\{l,m'\} = \{2k, 2k+1\}$ for some $k$. We have $b_l \equiv -b_{m'} \pmod{2^n}$. Since the values $\{b_{m'} \mid m' \in M\}$ are distinct mod $2^n$ and are all odd, their negatives $\{-b_{m'}\}$ are also distinct mod $2^n$. Therefore, the numbers $\{b_l \mid l \in L\}$ are distinct modulo $2^n$.","Let $n$ be a positive integer. Show that the numbers

$$\binom{2^{n}-1}{0}, \quad\binom{2^{n}-1}{1}, \quad\binom{2^{n}-1}{2}, \quad \ldots, \quad\binom{2^{n}-1}{2^{n-1}-1}$$

are congruent modulo $2^{n}$ to $1,3,5, \ldots, 2^{n}-1$ in some order.","All these binomial coefficients are odd. We prove by induction on $n$ that they are distinct modulo $2^n$. The base case $n=1$ is trivial. Assume the assertion holds for $n-1$. Let $b_m = \binom{2^n-1}{m}$ and $a_k = \binom{2^{n-1}-1}{k}$. Let $M = \{m \mid m \equiv 0,3 \pmod 4\}$ and $L = \{m \mid m \equiv 1,2 \pmod 4\}$. The sets $\{b_m \pmod{2^n} \mid m \in M\}$ and $\{b_l \pmod{2^n} \mid l \in L\}$ each consist of distinct values. Suppose for contradiction $b_m \equiv b_l \pmod{2^n}$ for some $m \in M, l \in L$. Let $m' \in M$ be such that $\{l, m'\}$ forms a pair $\{2k, 2k+1\}$. Then $b_l \equiv -b_{m'} \pmod{2^n}$, so $b_m \equiv -b_{m'} \pmod{2^n}$. As $m, m' \in M$, this implies $a_{\lfloor m/2 \rfloor} \equiv -a_{\lfloor m'/2 \rfloor} \pmod{2^n}$. By the induction hypothesis for $n-1$, the only pairs whose sum is zero mod $2^{n-1}$ are of the form $\{a_{2i}, a_{2i+1}\}$. So we must have $\{\lfloor m/2 \rfloor, \lfloor m'/2 \rfloor\} = \{2i, 2i+1\}$ for some $i$. This requires $\binom{2^{n-1}-1}{2i} + \binom{2^{n-1}-1}{2i+1} = \binom{2^{n-1}}{2i+1} \equiv 0 \pmod{2^n}$. But the highest power of 2 dividing $\binom{2^{n-1}}{2i+1}$ is $2^{n-1}$, which contradicts the congruence. Thus, the two sets of values are disjoint, and all $b_m$ for $m=0, \dots, 2^{n-1}-1$ are distinct modulo $2^n$."
2008n6,Prove that there exist infinitely many positive integers $n$ such that $n^{2}+1$ has a prime divisor greater than $2 n+\sqrt{2 n}$.,"Solution. Let $p \equiv 1(\bmod 8)$ be a prime. The congruence $x^{2} \equiv-1(\bmod p)$ has two solutions in $[1, p-1]$ whose sum is $p$. If $n$ is the smaller one of them then $p$ divides $n^{2}+1$ and $n \leq(p-1) / 2$. We show that $p>2 n+\sqrt{10 n}$.

Let $n=(p-1) / 2-\ell$ where $\ell \geq 0$. Then $n^{2} \equiv-1(\bmod p)$ gives

$$
\left(\frac{p-1}{2}-\ell\right)^{2} \equiv-1 \quad(\bmod p) \quad \text { or } \quad(2 \ell+1)^{2}+4 \equiv 0 \quad(\bmod p) .
$$

Thus $(2 \ell+1)^{2}+4=r p$ for some $r \geq 0$. As $(2 \ell+1)^{2} \equiv 1 \equiv p(\bmod 8)$, we have $r \equiv 5(\bmod 8)$, so that $r \geq 5$. Hence $(2 \ell+1)^{2}+4 \geq 5 p$, implying $\ell \geq(\sqrt{5 p-4}-1) / 2$. Set $\sqrt{5 p-4}=u$ for clarity; then $\ell \geq(u-1) / 2$. Therefore

$$
n=\frac{p-1}{2}-\ell \leq \frac{1}{2}(p-u) .
$$

Combined with $p=\left(u^{2}+4\right) / 5$, this leads to $u^{2}-5 u-10 n+4 \geq 0$. Solving this quadratic inequality with respect to $u \geq 0$ gives $u \geq(5+\sqrt{40 n+9}) / 2$. So the estimate $n \leq(p-u) / 2$ leads to

$$
p \geq 2 n+u \geq 2 n+\frac{1}{2}(5+\sqrt{40 n+9})>2 n+\sqrt{10 n}
$$

Since there are infinitely many primes of the form $8 k+1$, it follows easily that there are also infinitely many $n$ with the stated property.

Comment. By considering the prime factorization of the product $\prod_{n=1}^{N}\left(n^{2}+1\right)$, it can be obtained that its greatest prime divisor is at least $c N \log N$. This could improve the statement as $p>n \log n$.

However, the proof applies some advanced information about the distribution of the primes of the form $4 k+1$, which is inappropriate for high schools contests.",3,"Let $p$ be a prime such that $p \equiv 1 \pmod 8$. Let $n$ be the smallest positive integer such that $p$ divides $n^2+1$. Show that if we write $n = \frac{p-1}{2} - \ell$ for some $\ell \ge 0$, then there exists an integer $r \ge 5$ such that $(2\ell+1)^2 + 4 = rp$.","Since $p \equiv 1 \pmod 4$, the congruence $x^2 \equiv -1 \pmod p$ has a solution. Let $n$ be the smaller solution in $[1, p-1]$, so $n \le (p-1)/2$. Substituting $n = (p-1)/2 - \ell$ into $n^2 \equiv -1 \pmod p$ gives $( (p-1)/2 - \ell )^2 \equiv (-1/2 - \ell)^2 \equiv (2\ell+1)^2/4 \equiv -1 \pmod p$. This implies $(2\ell+1)^2 + 4 \equiv 0 \pmod p$, so $(2\ell+1)^2+4 = rp$ for some integer $r>0$. As $p \equiv 1 \pmod 8$ and $(2\ell+1)^2 \equiv 1 \pmod 8$ for any integer $\ell$, we have $rp = (2\ell+1)^2+4 \equiv 1+4 \equiv 5 \pmod 8$. This implies $r \equiv 5 \pmod 8$. Thus, the smallest positive value for $r$ is 5.","For a prime $p \equiv 1 \pmod 8$ and the corresponding integer $n$ (the smallest positive integer such that $p | n^2+1$), prove that $p > 2n + \sqrt{10n}$.","From the previous result, $(2\ell+1)^2+4 = rp$ with $r \ge 5$, which implies $(2\ell+1)^2+4 \ge 5p$. This gives $\ell \ge (\sqrt{5p-4}-1)/2$. As $n = (p-1)/2 - \ell$, we have $n \le (p-\sqrt{5p-4})/2$. Let $u=\sqrt{5p-4}$. The inequality can be written as $p \ge 2n+u$. Also, substituting $p=(u^2+4)/5$ into $n \le (p-u)/2$ yields $10n \le u^2-5u+4$, which rearranges to $u^2-5u-(10n-4) \ge 0$. Solving this quadratic inequality for $u$ gives $u \ge (5+\sqrt{40n+9})/2$. Thus, $p \ge 2n+u \ge 2n + \frac{1}{2}(5+\sqrt{40n+9}) > 2n+\sqrt{10n}$.",Prove that there exist infinitely many positive integers $n$ such that $n^{2}+1$ has a prime divisor greater than $2 n+\sqrt{2 n}$.,"By Dirichlet's theorem, there are infinitely many primes $p$ such that $p \equiv 1 \pmod 8$. For each such prime, let $n$ be the smallest positive integer such that $p$ divides $n^2+1$. From the previous sub-problem, this prime divisor $p$ satisfies $p > 2n + \sqrt{10n}$. Since $\sqrt{10n} > \sqrt{2n}$ for $n>0$, the prime divisor $p$ of $n^2+1$ is greater than $2n+\sqrt{2n}$. As we choose a sequence of distinct primes $p_k \to \infty$, the corresponding values $n_k \le (p_k-1)/2$ must also be unbounded. This process generates an infinite set of distinct integers $n$ with the desired property.",,
2007a1,"A1. Given a sequence $a_1, a_2, \ldots, a_n$ of real numbers. For each $i(1 \leq i \leq n)$ define
$$
d_i=\max \left\{a_j: 1 \leq j \leq i\right\}-\min \left\{a_j: i \leq j \leq n\right\}
$$
and let
$$
d=\max \left\{d_i: 1 \leq i \leq n\right\} .
$$
(a) Prove that for arbitrary real numbers $x_1 \leq x_2 \leq \ldots \leq x_n$,
$$
\max \left\{\left|x_i-a_i\right|: 1 \leq i \leq n\right\} \geq \frac{d}{2} .
$$
(b) Show that there exists a sequence $x_1 \leq x_2 \leq \ldots \leq x_n$ of real numbers such that we have equality in (1).","(a) Let $1 \leq p \leq q \leq r \leq n$ be indices for which
$$
d=d_q, \quad a_p=\max \left\{a_j: 1 \leq j \leq q\right\}, \quad a_r=\min \left\{a_j: q \leq j \leq n\right\}
$$
and thus $d=a_p-a_r$. (These indices are not necessarily unique.)

For arbitrary real numbers $x_1 \leq x_2 \leq \ldots \leq x_n$, consider just the two quantities $\left|x_p-a_p\right|$ and $\left|x_r-a_r\right|$. Since
$$
\left(a_p-x_p\right)+\left(x_r-a_r\right)=\left(a_p-a_r\right)+\left(x_r-x_p\right) \geq a_p-a_r=d
$$
we have either $a_p-x_p \geq \frac{d}{2}$ or $x_r-a_r \geq \frac{d}{2}$. Hence,
$$
\max \left\{\left|x_i-a_i\right|: 1 \leq i \leq n\right\} \geq \max \left\{\left|x_p-a_p\right|,\left|x_r-a_r\right|\right\} \geq \max \left\{a_p-x_p, x_r-a_r\right\} \geq \frac{d}{2}
$$

(b) Define the sequence $\left(x_k\right)$ as
$$
x_1=a_1-\frac{d}{2}, \quad x_k=\max \left\{x_{k-1}, a_k-\frac{d}{2}\right\} \quad \text { for } 2 \leq k \leq n .
$$

We show that we have equality in (1) for this sequence.
By the definition, sequence $\left(x_k\right)$ is non-decreasing and $x_k-a_k \geq-\frac{d}{2}$ for all $1 \leq k \leq n$. Next we prove that
$$
x_k-a_k \leq \frac{d}{2} \quad \text { for all } 1 \leq k \leq n
$$

Consider an arbitrary index $1 \leq k \leq n$. Let $\ell \leq k$ be the smallest index such that $x_k=x_{\ell}$. We have either $\ell=1$, or $\ell \geq 2$ and $x_{\ell}>x_{\ell-1}$. In both cases,
$$
x_k=x_{\ell}=a_{\ell}-\frac{d}{2} .
$$

Since
$$
a_{\ell}-a_k \leq \max \left\{a_j: 1 \leq j \leq k\right\}-\min \left\{a_j: k \leq j \leq n\right\}=d_k \leq d
$$
equality (3) implies
$$
x_k-a_k=a_{\ell}-a_k-\frac{d}{2} \leq d-\frac{d}{2}=\frac{d}{2} .
$$

We obtained that $-\frac{d}{2} \leq x_k-a_k \leq \frac{d}{2}$ for all $1 \leq k \leq n$, so
$$
\max \left\{\left|x_i-a_i\right|: 1 \leq i \leq n\right\} \leq \frac{d}{2} .
$$

We have equality because $\left|x_1-a_1\right|=\frac{d}{2}$.",3,"Let $d = d_q = a_p - a_r$ for some indices $p \leq q \leq r$ where $a_p = \max\left\{a_j: 1 \leq j \leq q\right\}$ and $a_r = \min\left\{a_j: q \leq j \leq n\right\}$. Prove that for any non-decreasing sequence of real numbers $x_1 \leq x_2 \leq \ldots \leq x_n$, we have $\max\left\{\left|x_p - a_p\right|, \left|x_r - a_r\right|\right\} \geq \frac{d}{2}$.","For any non-decreasing sequence $x_1 \leq \ldots \leq x_n$, we have $x_p \leq x_r$ since $p \leq r$. Consider the sum $(a_p - x_p) + (x_r - a_r) = (a_p - a_r) + (x_r - x_p)$. Since $a_p - a_r = d$ and $x_r - x_p \geq 0$, this sum is at least $d$. Therefore, at least one of the terms must be greater than or equal to $d/2$. That is, either $a_p - x_p \geq d/2$ or $x_r - a_r \geq d/2$. Since $|x_p - a_p| \geq a_p - x_p$ and $|x_r - a_r| \geq x_r - a_r$, we conclude that $\max\left\{\left|x_p - a_p\right|, \left|x_r - a_r\right|\right\} \geq \frac{d}{2}$.","Construct a non-decreasing sequence $x_1 \leq x_2 \leq \ldots \leq x_n$ of real numbers such that for all $k \in \{1, \ldots, n\}$, we have $\left|x_k - a_k\right| \leq \frac{d}{2}$.","Define the sequence by $x_1 = a_1 - \frac{d}{2}$ and $x_k = \max\left\{x_{k-1}, a_k - \frac{d}{2}\right\}$ for $k=2, \ldots, n$. By construction, the sequence is non-decreasing and $x_k \geq a_k - \frac{d}{2}$, so $x_k - a_k \geq -\frac{d}{2}$. To show the other side, $x_k - a_k \leq \frac{d}{2}$, let $\ell \leq k$ be an index such that $x_k = a_\ell - \frac{d}{2}$. Then $x_k - a_k = a_\ell - a_k - \frac{d}{2}$. Since $\ell \leq k$, $a_\ell - a_k \leq \max\left\{a_j: 1 \leq j \leq k\right\} - \min\left\{a_j: k \leq j \leq n\right\} = d_k \leq d$. Thus, $x_k - a_k \leq d - \frac{d}{2} = \frac{d}{2}$. Combining both inequalities, $\left|x_k - a_k\right| \leq \frac{d}{2}$ for all $k$.","Given a sequence $a_1, a_2, \ldots, a_n$ of real numbers, define $d_i=\max\left\{a_j: 1 \leq j \leq i\right\}-\min\left\{a_j: i \leq j \leq n\right\}$ and $d=\max\left\{d_i: 1 \leq i \leq n\right\}$. (a) Prove that for arbitrary real numbers $x_1 \leq x_2 \leq \ldots \leq x_n$, $\max\left\{\left|x_i-a_i\right|: 1 \leq i \leq n\right\} \geq \frac{d}{2}$. (b) Show that there exists a sequence $x_1 \leq x_2 \leq \ldots \leq x_n$ of real numbers such that $\max\left\{\left|x_i-a_i\right|: 1 \leq i \leq n\right\} = \frac{d}{2}$.","(a) Let $d = d_q$ and choose indices $p \leq q \leq r$ such that $a_p = \max\left\{a_j: 1 \leq j \leq q\right\}$ and $a_r = \min\left\{a_j: q \leq j \leq n\right\}$, so $d = a_p-a_r$. From Sub-problem 1, for any non-decreasing sequence $x_i$, we have $\max\left\{\left|x_p - a_p\right|, \left|x_r - a_r\right|\right\} \geq \frac{d}{2}$. Since $\max_{1 \leq i \leq n}\left\{\left|x_i - a_i\right|\right\}$ is taken over a larger set of indices, it must be at least this value. Thus, $\max\left\{\left|x_i - a_i\right|: 1 \leq i \leq n\right\} \geq \frac{d}{2}$.
(b) The sequence constructed in Sub-problem 2 is non-decreasing and satisfies $\left|x_k - a_k\right| \leq \frac{d}{2}$ for all $k$, which implies $\max\left\{\left|x_k - a_k\right|: 1 \leq k \leq n\right\} \leq \frac{d}{2}$. Combining this with the inequality from part (a), we must have $\max\left\{\left|x_k - a_k\right|: 1 \leq k \leq n\right\} = \frac{d}{2}$. Thus, such a sequence exists, and equality is achieved.",,
2007a3,"A3. Let $n$ be a positive integer, and let $x$ and $y$ be positive real numbers such that $x^n+y^n=1$. Prove that
$$
\left(\sum_{k=1}^n \frac{1+x^{2 k}}{1+x^{4 k}}\right)\left(\sum_{k=1}^n \frac{1+y^{2 k}}{1+y^{4 k}}\right)<\frac{1}{(1-x)(1-y)} .
$$
(Estonia)","For each real $t \in(0,1)$,
$$
\frac{1+t^2}{1+t^4}=\frac{1}{t}-\frac{(1-t)\left(1-t^3\right)}{t\left(1+t^4\right)}<\frac{1}{t}
$$

Substituting $t=x^k$ and $t=y^k$,
$$
0<\sum_{k=1}^n \frac{1+x^{2 k}}{1+x^{4 k}}<\sum_{k=1}^n \frac{1}{x^k}=\frac{1-x^n}{x^n(1-x)} \quad \text { and } \quad 0<\sum_{k=1}^n \frac{1+y^{2 k}}{1+y^{4 k}}<\sum_{k=1}^n \frac{1}{y^k}=\frac{1-y^n}{y^n(1-y)} .
$$

Since $1-y^n=x^n$ and $1-x^n=y^n$,
$$
\frac{1-x^n}{x^n(1-x)}=\frac{y^n}{x^n(1-x)}, \quad \frac{1-y^n}{y^n(1-y)}=\frac{x^n}{y^n(1-y)}
$$
and therefore
$$
\left(\sum_{k=1}^n \frac{1+x^{2 k}}{1+x^{4 k}}\right)\left(\sum_{k=1}^n \frac{1+y^{2 k}}{1+y^{4 k}}\right)<\frac{y^n}{x^n(1-x)} \cdot \frac{x^n}{y^n(1-y)}=\frac{1}{(1-x)(1-y)} .
$$",1,"A3. Let $n$ be a positive integer, and let $x$ and $y$ be positive real numbers such that $x^n+y^n=1$. Prove that
$$
\left(\sum_{k=1}^n \frac{1+x^{2 k}}{1+x^{4 k}}\right)\left(\sum_{k=1}^n \frac{1+y^{2 k}}{1+y^{4 k}}\right)<\frac{1}{(1-x)(1-y)} .
$$
(Estonia)","For each real $t \in(0,1)$,
$$
\frac{1+t^2}{1+t^4}=\frac{1}{t}-\frac{(1-t)\left(1-t^3\right)}{t\left(1+t^4\right)}<\frac{1}{t}
$$

Substituting $t=x^k$ and $t=y^k$,
$$
0<\sum_{k=1}^n \frac{1+x^{2 k}}{1+x^{4 k}}<\sum_{k=1}^n \frac{1}{x^k}=\frac{1-x^n}{x^n(1-x)} \quad \text { and } \quad 0<\sum_{k=1}^n \frac{1+y^{2 k}}{1+y^{4 k}}<\sum_{k=1}^n \frac{1}{y^k}=\frac{1-y^n}{y^n(1-y)} .
$$

Since $1-y^n=x^n$ and $1-x^n=y^n$,
$$
\frac{1-x^n}{x^n(1-x)}=\frac{y^n}{x^n(1-x)}, \quad \frac{1-y^n}{y^n(1-y)}=\frac{x^n}{y^n(1-y)}
$$
and therefore
$$
\left(\sum_{k=1}^n \frac{1+x^{2 k}}{1+x^{4 k}}\right)\left(\sum_{k=1}^n \frac{1+y^{2 k}}{1+y^{4 k}}\right)<\frac{y^n}{x^n(1-x)} \cdot \frac{x^n}{y^n(1-y)}=\frac{1}{(1-x)(1-y)} .
$$",,,,,,
2007a5,"A5. Let $c>2$, and let $a(1), a(2), \ldots$ be a sequence of nonnegative real numbers such that
$$
a(m+n) \leq 2 a(m)+2 a(n) \quad \text { for all } m, n \geq 1
$$
and
$$
a\left(2^k\right) \leq \frac{1}{(k+1)^c} \quad \text { for all } k \geq 0
$$
Prove that the sequence $a(n)$ is bounded.","For convenience, define $a(0)=0$; then condition (1) persists for all pairs of nonnegative indices.
Lemma 1. For arbitrary nonnegative indices $n_1, \ldots, n_k$, we have
$$
a\left(\sum_{i=1}^k n_i\right) \leq \sum_{i=1}^k 2^i a\left(n_i\right)
$$
and
$$
a\left(\sum_{i=1}^k n_i\right) \leq 2 k \sum_{i=1}^k a\left(n_i\right) .
$$

Proof. Inequality (3) is proved by induction on $k$. The base case $k=1$ is trivial, while the induction step is provided by
$$
a\left(\sum_{i=1}^{k+1} n_i\right)=a\left(n_1+\sum_{i=2}^{k+1} n_i\right) \leq 2 a\left(n_1\right)+2 a\left(\sum_{i=1}^k n_{i+1}\right) \leq 2 a\left(n_1\right)+2 \sum_{i=1}^k 2^i a\left(n_{i+1}\right)=\sum_{i=1}^{k+1} 2^i a\left(n_i\right) .
$$

To establish (4), first the inequality
$$
a\left(\sum_{i=1}^{2^d} n_i\right) \leq 2^d \sum_{i=1}^{2^d} a\left(n_i\right)
$$
can be proved by an obvious induction on $d$. Then, turning to (4), we find an integer $d$ such that $2^{d-1}<k \leq 2^d$ to obtain
$$
a\left(\sum_{i=1}^k n_i\right)=a\left(\sum_{i=1}^k n_i+\sum_{i=k+1}^{2^d} 0\right) \leq 2^d\left(\sum_{i=1}^k a\left(n_i\right)+\sum_{i=k+1}^{2^d} a(0)\right)=2^d \sum_{i=1}^k a\left(n_i\right) \leq 2 k \sum_{i=1}^k a\left(n_i\right) .
$$

Fix an increasing unbounded sequence $0=M_0<M_1<M_2<\ldots$ of real numbers; the exact values will be defined later. Let $n$ be an arbitrary positive integer and write
$$
n=\sum_{i=0}^d \varepsilon_i \cdot 2^i, \quad \text { where } \varepsilon_i \in\{0,1\}
$$

Set $\varepsilon_i=0$ for $i>d$, and take some positive integer $f$ such that $M_f>d$. Applying (3), we get
$$
a(n)=a\left(\sum_{k=1}^f \sum_{M_{k-1} \leq i<M_k} \varepsilon_i \cdot 2^i\right) \leq \sum_{k=1}^f 2^k a\left(\sum_{M_{k-1} \leq i<M_k} \varepsilon_i \cdot 2^i\right) .
$$

Note that there are less than $M_k-M_{k-1}+1$ integers in interval $\left[M_{k-1}, M_k\right.$ ); hence, using (4) we have
$$
\begin{aligned}
a(n) & \leq \sum_{k=1}^f 2^k \cdot 2\left(M_k-M_{k-1}+1\right) \sum_{M_{k-1} \leq i<M_k} \varepsilon_i \cdot a\left(2^i\right) \\
& \leq \sum_{k=1}^f 2^k \cdot 2\left(M_k-M_{k-1}+1\right)^2 \max _{M_{k-1} \leq i<M_k} a\left(2^i\right) \\
& \leq \sum_{k=1}^f 2^{k+1}\left(M_k+1\right)^2 \cdot \frac{1}{\left(M_{k-1}+1\right)^c}=\sum_{k=1}^f\left(\frac{M_k+1}{M_{k-1}+1}\right)^2 \frac{2^{k+1}}{\left(M_{k-1}+1\right)^{c-2}} .
\end{aligned}
$$

Setting $M_k=4^{k /(c-2)}-1$, we obtain
$$
a(n) \leq \sum_{k=1}^f 4^{2 /(c-2)} \frac{2^{k+1}}{\left(4^{(k-1) /(c-2)}\right)^{c-2}}=8 \cdot 4^{2 /(c-2)} \sum_{k=1}^f\left(\frac{1}{2}\right)^k<8 \cdot 4^{2 /(c-2)}
$$
and the sequence $a(n)$ is bounded.",3,"Let the sequence $a(n)$ satisfy $a(m+n) \leq 2 a(m)+2 a(n)$ for all $m, n \geq 1$, and define $a(0)=0$. Prove the following two inequalities for any non-negative integers $n_1, \ldots, n_k$:
1. $a\left(\sum_{i=1}^k n_i\right) \leq \sum_{i=1}^k 2^i a\left(n_i\right)$
2. $a\left(\sum_{i=1}^k n_i\right) \leq 2k \sum_{i=1}^k a\left(n_i\right)$","1. We prove this by induction on $k$. The base case $k=1$ is trivial. For the induction step, $a\left(\sum_{i=1}^{k+1} n_i\right)=a\left(n_1+\sum_{i=2}^{k+1} n_i\right) \leq 2 a\left(n_1\right)+2 a\left(\sum_{i=1}^k n_{i+1}\right) \leq 2 a\left(n_1\right)+2 \sum_{i=1}^k 2^i a\left(n_{i+1}\right)=\sum_{i=1}^{k+1} 2^i a\left(n_i\right)$.
2. First, we prove by induction on $d$ that $a\left(\sum_{i=1}^{2^d} n_i\right) \leq 2^d \sum_{i=1}^{2^d} a\left(n_i\right)$. The base case $d=1$ is the given condition. The inductive step is $a(\sum_{i=1}^{2^{d+1}} n_i) \leq 2a(\sum_{i=1}^{2^d} n_i) + 2a(\sum_{i=2^d+1}^{2^{d+1}} n_i) \leq 2(2^d \sum_{i=1}^{2^d} a(n_i)) + 2(2^d \sum_{i=2^d+1}^{2^{d+1}} a(n_i)) = 2^{d+1}\sum_{i=1}^{2^{d+1}} a(n_i)$. For a general $k$, choose an integer $d$ such that $2^{d-1} < k \leq 2^d$. Let $n_i = 0$ for $i > k$. Then $a(\sum_{i=1}^k n_i) = a(\sum_{i=1}^{2^d} n_i) \leq 2^d \sum_{i=1}^{2^d} a(n_i) = 2^d \sum_{i=1}^k a(n_i) \leq 2k \sum_{i=1}^k a(n_i)$.","For an integer $n$ with binary expansion $n=\sum_{i=0}^d \varepsilon_i 2^i$, partition the indices of the sum using an increasing sequence of integers $0=M_0<M_1<\ldots$. Show that $a(n)$ is bounded by the series $\sum_{k=1}^\infty \left(\frac{M_k+1}{M_{k-1}+1}\right)^2 \frac{2^{k+1}}{\left(M_{k-1}+1\right)^{c-2}}$.","Let $n = \sum_{k=1}^f N_k$, where $N_k = \sum_{i=M_{k-1}}^{M_k-1} \varepsilon_i 2^i$ and $M_f > d$. Using the first inequality from Sub-problem 1, $a(n) \le \sum_{k=1}^f 2^k a(N_k)$. The sum for $N_k$ has at most $p_k = M_k - M_{k-1}$ non-zero terms. Using the second inequality from Sub-problem 1, $a(N_k) \le 2 p_k \sum_{i=M_{k-1}}^{M_k-1} \varepsilon_i a(2^i) \le 2 p_k^2 \max_{i \in [M_{k-1}, M_k-1]} a(2^i)$. With $a(2^i) \le \frac{1}{(i+1)^c}$, the maximum is at most $\frac{1}{(M_{k-1}+1)^c}$. Thus $a(n) \le \sum_{k=1}^f 2^{k+1} (M_k-M_{k-1})^2 \frac{1}{(M_{k-1}+1)^c}$. Using the looser bound $(M_k-M_{k-1})^2 \le (M_k+1)^2$, we get $a(n) \le \sum_{k=1}^f 2^{k+1}(M_k+1)^2 \frac{1}{(M_{k-1}+1)^c} = \sum_{k=1}^f \left(\frac{M_k+1}{M_{k-1}+1}\right)^2 \frac{2^{k+1}}{(M_{k-1}+1)^{c-2}}$. This finite sum is bounded by the corresponding infinite series.","Let $c>2$, and let $a(1), a(2), \ldots$ be a sequence of nonnegative real numbers such that
$a(m+n) \leq 2 a(m)+2 a(n) \quad \text{ for all } m, n \geq 1$
and
$a\left(2^k\right) \leq \frac{1}{(k+1)^c} \quad \text{ for all } k \geq 0$.
Prove that the sequence $a(n)$ is bounded.","From Sub-problem 2, we have the bound $a(n) \le \sum_{k=1}^\infty \left(\frac{M_k+1}{M_{k-1}+1}\right)^2 \frac{2^{k+1}}{\left(M_{k-1}+1\right)^{c-2}}$. We choose $M_k = 4^{k/(c-2)} - 1$, so $M_k+1 = 4^{k/(c-2)}$. The ratio $\frac{M_k+1}{M_{k-1}+1} = 4^{1/(c-2)}$. Substituting this into the series gives the general term as $(4^{1/(c-2)})^2 \frac{2^{k+1}}{(4^{(k-1)/(c-2)})^{c-2}} = 4^{2/(c-2)} \frac{2^{k+1}}{4^{k-1}} = 8 \cdot 4^{2/(c-2)} (\frac{1}{2})^k$. Thus, $a(n)$ is bounded by the sum of a convergent geometric series $8 \cdot 4^{2/(c-2)} \sum_{k=1}^\infty (\frac{1}{2})^k = 8 \cdot 4^{2/(c-2)}$, which is a finite constant. Therefore, the sequence $a(n)$ is bounded.",,
2007a6,"A6. Let $a_1, a_2, \ldots, a_{100}$ be nonnegative real numbers such that $a_1^2+a_2^2+\ldots+a_{100}^2=1$. Prove that
$$
a_1^2 a_2+a_2^2 a_3+\ldots+a_{100}^2 a_1<\frac{12}{25} .
$$","Solution. Let $S=\sum_{k=1}^{100} a_k^2 a_{k+1}$. (As usual, we consider the indices modulo 100, e.g. we set $a_{101}=a_1$ and $a_{102}=a_2$.)

Applying the Cauchy-Schwarz inequality to sequences $\left(a_{k+1}\right)$ and $\left(a_k^2+2 a_{k+1} a_{k+2}\right)$, and then the AM-GM inequality to numbers $a_{k+1}^2$ and $a_{k+2}^2$,
$$
\begin{aligned}
(3 S)^2 & =\left(\sum_{k=1}^{100} a_{k+1}\left(a_k^2+2 a_{k+1} a_{k+2}\right)\right)^2 \leq\left(\sum_{k=1}^{100} a_{k+1}^2\right)\left(\sum_{k=1}^{100}\left(a_k^2+2 a_{k+1} a_{k+2}\right)^2\right) \\
& =1 \cdot \sum_{k=1}^{100}\left(a_k^2+2 a_{k+1} a_{k+2}\right)^2=\sum_{k=1}^{100}\left(a_k^4+4 a_k^2 a_{k+1} a_{k+2}+4 a_{k+1}^2 a_{k+2}^2\right) \\
& \leq \sum_{k=1}^{100}\left(a_k^4+2 a_k^2\left(a_{k+1}^2+a_{k+2}^2\right)+4 a_{k+1}^2 a_{k+2}^2\right)=\sum_{k=1}^{100}\left(a_k^4+6 a_k^2 a_{k+1}^2+2 a_k^2 a_{k+2}^2\right) .
\end{aligned}
$$

Applying the trivial estimates
$$
\sum_{k=1}^{100}\left(a_k^4+2 a_k^2 a_{k+1}^2+2 a_k^2 a_{k+2}^2\right) \leq\left(\sum_{k=1}^{100} a_k^2\right)^2 \quad \text { and } \quad \sum_{k=1}^{100} a_k^2 a_{k+1}^2 \leq\left(\sum_{i=1}^{50} a_{2 i-1}^2\right)\left(\sum_{j=1}^{50} a_{2 j}^2\right)
$$
we obtain that
$$
(3 S)^2 \leq\left(\sum_{k=1}^{100} a_k^2\right)^2+4\left(\sum_{i=1}^{50} a_{2 i-1}^2\right)\left(\sum_{j=1}^{50} a_{2 j}^2\right) \leq 1+\left(\sum_{i=1}^{50} a_{2 i-1}^2+\sum_{j=1}^{50} a_{2 j}^2\right)^2=2,
$$
hence
$$
S \leq \frac{\sqrt{2}}{3} \approx 0.4714<\frac{12}{25}=0.48 .
$$

Comment 1. By applying the Lagrange multiplier method, one can see that the maximum is attained at values of $a_i$ satisfying
$$
a_{k-1}^2+2 a_k a_{k+1}=2 \lambda a_k
$$
for all $k=1,2, \ldots, 100$. Though this system of equations seems hard to solve, it can help to find the estimate above; it may suggest to have a closer look at the expression $a_{k-1}^2 a_k+2 a_k^2 a_{k+1}$.

Moreover, if the numbers $a_1, \ldots, a_{100}$ satisfy (2), we have equality in (1). (See also Comment 3.)
Comment 2. It is natural to ask what is the best constant $c_n$ in the inequality
$$
a_1^2 a_2+a_2^2 a_3+\ldots+a_n^2 a_1 \leq c_n\left(a_1^2+a_2^2+\ldots+a_n^2\right)^{3 / 2}
$$

For $1 \leq n \leq 4$ one may prove $c_n=1 / \sqrt{n}$ which is achieved when $a_1=a_2=\ldots=a_n$. However, the situation changes completely if $n \geq 5$. In this case we do not know the exact value of $c_n$. By computer search it can be found that $c_n \approx 0.4514$ and it is realized for example if
$$
a_1 \approx 0.5873, \quad a_2 \approx 0.6771, \quad a_3 \approx 0.4224, \quad a_4 \approx 0.1344, \quad a_5 \approx 0.0133
$$
and $a_k \approx 0$ for $k \geq 6$. This example also proves that $c_n>0.4513$.Let $a_1, a_2, \ldots, a_{100}$ be nonnegative real numbers such that $a_1^2+a_2^2+\ldots+a_{100}^2=1$. Prove that
$$
a_1^2 a_2+a_2^2 a_3+\ldots+a_{100}^2 a_1<\frac{12}{25} .
$$
(Poland)
Solution. Let $S=\sum_{k=1}^{100} a_k^2 a_{k+1}$. (As usual, we consider the indices modulo 100, e.g. we set $a_{101}=a_1$ and $a_{102}=a_2$.)

Applying the Cauchy-Schwarz inequality to sequences $\left(a_{k+1}\right)$ and $\left(a_k^2+2 a_{k+1} a_{k+2}\right)$, and then the AM-GM inequality to numbers $a_{k+1}^2$ and $a_{k+2}^2$,
$$
\begin{aligned}
(3 S)^2 & =\left(\sum_{k=1}^{100} a_{k+1}\left(a_k^2+2 a_{k+1} a_{k+2}\right)\right)^2 \leq\left(\sum_{k=1}^{100} a_{k+1}^2\right)\left(\sum_{k=1}^{100}\left(a_k^2+2 a_{k+1} a_{k+2}\right)^2\right) \\
& =1 \cdot \sum_{k=1}^{100}\left(a_k^2+2 a_{k+1} a_{k+2}\right)^2=\sum_{k=1}^{100}\left(a_k^4+4 a_k^2 a_{k+1} a_{k+2}+4 a_{k+1}^2 a_{k+2}^2\right) \\
& \leq \sum_{k=1}^{100}\left(a_k^4+2 a_k^2\left(a_{k+1}^2+a_{k+2}^2\right)+4 a_{k+1}^2 a_{k+2}^2\right)=\sum_{k=1}^{100}\left(a_k^4+6 a_k^2 a_{k+1}^2+2 a_k^2 a_{k+2}^2\right) .
\end{aligned}
$$

Applying the trivial estimates
$$
\sum_{k=1}^{100}\left(a_k^4+2 a_k^2 a_{k+1}^2+2 a_k^2 a_{k+2}^2\right) \leq\left(\sum_{k=1}^{100} a_k^2\right)^2 \quad \text { and } \quad \sum_{k=1}^{100} a_k^2 a_{k+1}^2 \leq\left(\sum_{i=1}^{50} a_{2 i-1}^2\right)\left(\sum_{j=1}^{50} a_{2 j}^2\right)
$$
we obtain that
$$
(3 S)^2 \leq\left(\sum_{k=1}^{100} a_k^2\right)^2+4\left(\sum_{i=1}^{50} a_{2 i-1}^2\right)\left(\sum_{j=1}^{50} a_{2 j}^2\right) \leq 1+\left(\sum_{i=1}^{50} a_{2 i-1}^2+\sum_{j=1}^{50} a_{2 j}^2\right)^2=2,
$$
hence
$$
S \leq \frac{\sqrt{2}}{3} \approx 0.4714<\frac{12}{25}=0.48 .
$$

Comment 1. By applying the Lagrange multiplier method, one can see that the maximum is attained at values of $a_i$ satisfying
$$
a_{k-1}^2+2 a_k a_{k+1}=2 \lambda a_k
$$
for all $k=1,2, \ldots, 100$. Though this system of equations seems hard to solve, it can help to find the estimate above; it may suggest to have a closer look at the expression $a_{k-1}^2 a_k+2 a_k^2 a_{k+1}$.

Moreover, if the numbers $a_1, \ldots, a_{100}$ satisfy (2), we have equality in (1). (See also Comment 3.)
Comment 2. It is natural to ask what is the best constant $c_n$ in the inequality
$$
a_1^2 a_2+a_2^2 a_3+\ldots+a_n^2 a_1 \leq c_n\left(a_1^2+a_2^2+\ldots+a_n^2\right)^{3 / 2}
$$

For $1 \leq n \leq 4$ one may prove $c_n=1 / \sqrt{n}$ which is achieved when $a_1=a_2=\ldots=a_n$. However, the situation changes completely if $n \geq 5$. In this case we do not know the exact value of $c_n$. By computer search it can be found that $c_n \approx 0.4514$ and it is realized for example if
$$
a_1 \approx 0.5873, \quad a_2 \approx 0.6771, \quad a_3 \approx 0.4224, \quad a_4 \approx 0.1344, \quad a_5 \approx 0.0133
$$
and $a_k \approx 0$ for $k \geq 6$. This example also proves that $c_n>0.4513$.

Comment 3. The solution can be improved in several ways to give somewhat better bounds for $c_n$. Here we show a variant which proves $c_n<0.4589$ for $n \geq 5$.

The value of $c_n$ does not change if negative values are also allowed in (3). So the problem is equivalent to maximizing
$$
f\left(a_1, a_2, \ldots, a_n\right)=a_1^2 a_2+a_2^2 a_3+\ldots+a_n^2 a_1
$$
on the unit sphere $a_1^2+a_2^2+\ldots+a_n^2=1$ in $\mathbb{R}^n$. Since the unit sphere is compact, the function has a maximum and we can apply the Lagrange multiplier method; for each maximum point there exists a real number $\lambda$ such that
$$
a_{k-1}^2+2 a_k a_{k+1}=\lambda \cdot 2 a_k \quad \text { for all } k=1,2, \ldots, n .
$$

Then
$$
3 S=\sum_{k=1}^n\left(a_{k-1}^2 a_k+2 a_k^2 a_{k+1}\right)=\sum_{k=1}^n 2 \lambda a_k^2=2 \lambda
$$
and therefore
$$
a_{k-1}^2+2 a_k a_{k+1}=3 S a_k \quad \text { for all } k=1,2, \ldots, n
$$

From (4) we can derive
$$
9 S^2=\sum_{k=1}^n\left(3 S a_k\right)^2=\sum_{k=1}^n\left(a_{k-1}^2+2 a_k a_{k+1}\right)^2=\sum_{k=1}^n a_k^4+4 \sum_{k=1}^n a_k^2 a_{k+1}^2+4 \sum_{k=1}^n a_k^2 a_{k+1} a_{k+2}
$$
and
$$
3 S^2=\sum_{k=1}^n 3 S a_{k-1}^2 a_k=\sum_{k=1}^n a_{k-1}^2\left(a_{k-1}^2+2 a_k a_{k+1}\right)=\sum_{k=1}^n a_k^4+2 \sum_{k=1}^n a_k^2 a_{k+1} a_{k+2} .
$$

Let $p$ be a positive number. Combining (5) and (6) and applying the AM-GM inequality,
$$
\begin{aligned}
(9+3 p) S^2 & =(1+p) \sum_{k=1}^n a_k^4+4 \sum_{k=1}^n a_k^2 a_{k+1}^2+(4+2 p) \sum_{k=1}^n a_k^2 a_{k+1} a_{k+2} \\
& \leq(1+p) \sum_{k=1}^n a_k^4+4 \sum_{k=1}^n a_k^2 a_{k+1}^2+\sum_{k=1}^n\left(2(1+p) a_k^2 a_{k+2}^2+\frac{(2+p)^2}{2(1+p)} a_k^2 a_{k+1}^2\right) \\
& =(1+p) \sum_{k=1}^n\left(a_k^4+2 a_k^2 a_{k+1}^2+2 a_k^2 a_{k+2}^2\right)+\left(4+\frac{(2+p)^2}{2(1+p)}-2(1+p)\right) \sum_{k=1}^n a_k^2 a_{k+1}^2 \\
& \leq(1+p)\left(\sum_{k=1}^n a_k^2\right)^2+\frac{8+4 p-3 p^2}{2(1+p)} \sum_{k=1}^n a_k^2 a_{k+1}^2 \\
& =(1+p)+\frac{8+4 p-3 p^2}{2(1+p)} \sum_{k=1}^n a_k^2 a_{k+1}^2 .
\end{aligned}
$$

Setting $p=\frac{2+2 \sqrt{7}}{3}$ which is the positive root of $8+4 p-3 p^2=0$, we obtain
$$
S \leq \sqrt{\frac{1+p}{9+3 p}}=\sqrt{\frac{5+2 \sqrt{7}}{33+6 \sqrt{7}}} \approx 0.458879
$$",4,"Let $S = \sum_{k=1}^{100} a_k^2 a_{k+1}$ with indices modulo 100, and given $\sum_{k=1}^{100} a_k^2=1$. Prove that $(3S)^2 \le \sum_{k=1}^{100} (a_k^2+2 a_{k+1} a_{k+2})^2$.","We can write $3S = \sum_{k=1}^{100} (a_k^2 a_{k+1} + 2 a_k^2 a_{k+1})$. By re-indexing the second part (i.e., $k \to k+1$), we get $2 \sum a_k^2 a_{k+1} = 2 \sum a_{k+1}^2 a_{k+2}$. Thus, $3S = \sum_{k=1}^{100} (a_k^2 a_{k+1} + 2 a_{k+1}^2 a_{k+2}) = \sum_{k=1}^{100} a_{k+1}(a_k^2 + 2 a_{k+1} a_{k+2})$. By the Cauchy-Schwarz inequality, $(3S)^2 = (\sum_{k=1}^{100} a_{k+1}(a_k^2 + 2 a_{k+1} a_{k+2}))^2 \le (\sum_{k=1}^{100} a_{k+1}^2)(\sum_{k=1}^{100} (a_k^2+2 a_{k+1} a_{k+2})^2)$. Since $\sum a_{k+1}^2 = \sum a_k^2=1$, the inequality $(3S)^2 \le \sum_{k=1}^{100} (a_k^2+2 a_{k+1} a_{k+2})^2$ holds.",Prove the inequality $\sum_{k=1}^{100} (a_k^2+2 a_{k+1} a_{k+2})^2 \le \sum_{k=1}^{100}(a_k^4+6 a_k^2 a_{k+1}^2+2 a_k^2 a_{k+2}^2)$.,"Expanding the left side gives $\sum_{k=1}^{100} (a_k^4 + 4 a_k^2 a_{k+1} a_{k+2} + 4 a_{k+1}^2 a_{k+2}^2)$. By the AM-GM inequality, $2a_{k+1}a_{k+2} \le a_{k+1}^2 + a_{k+2}^2$ for non-negative $a_k$. Thus, $4a_k^2 a_{k+1} a_{k+2} \le 2a_k^2(a_{k+1}^2+a_{k+2}^2)$. Substituting this into the sum gives an upper bound: $\sum_{k=1}^{100} (a_k^4 + 2a_k^2(a_{k+1}^2+a_{k+2}^2) + 4a_{k+1}^2 a_{k+2}^2)$. We can separate this sum and re-index: $\sum a_k^4 + 2\sum a_k^2 a_{k+1}^2 + 2\sum a_k^2 a_{k+2}^2 + 4\sum a_{k+1}^2 a_{k+2}^2$. Using cyclic indices, $\sum a_{k+1}^2 a_{k+2}^2 = \sum a_k^2 a_{k+1}^2$. The expression simplifies to $\sum_{k=1}^{100}(a_k^4+6 a_k^2 a_{k+1}^2+2 a_k^2 a_{k+2}^2)$.",Prove that $\sum_{k=1}^{100}(a_k^4+6 a_k^2 a_{k+1}^2+2 a_k^2 a_{k+2}^2) \le 2$.,"We rewrite the expression as $\sum_{k=1}^{100}(a_k^4+2 a_k^2 a_{k+1}^2+2 a_k^2 a_{k+2}^2) + 4\sum_{k=1}^{100} a_k^2 a_{k+1}^2$. The first sum is a subsum of the non-negative terms in the expansion of $(\sum a_k^2)^2 = \sum a_k^4 + \sum_{i \ne j} a_i^2 a_j^2$. Therefore, $\sum(a_k^4+2 a_k^2 a_{k+1}^2+2 a_k^2 a_{k+2}^2) \le (\sum a_k^2)^2 = 1^2 = 1$. For the second term, let $O = \sum_{i=1}^{50} a_{2i-1}^2$ and $E = \sum_{j=1}^{50} a_{2j}^2$. We have $O+E=1$. The sum $\sum a_k^2 a_{k+1}^2$ is a subsum of the terms in the expansion of $OE$. Thus $\sum a_k^2 a_{k+1}^2 \le OE$. By AM-GM, $OE \le ((O+E)/2)^2 = (1/2)^2=1/4$. Combining these results, the original expression is bounded by $1 + 4(OE) \le 1 + 4(1/4) = 2$.","Let $a_1, a_2, \ldots, a_{100}$ be nonnegative real numbers such that $a_1^2+a_2^2+\ldots+a_{100}^2=1$. Prove that $a_1^2 a_2+a_2^2 a_3+\ldots+a_{100}^2 a_1 < \frac{12}{25}$.","Let $S = a_1^2 a_2+a_2^2 a_3+\ldots+a_{100}^2 a_1$. Combining the results from the previous sub-problems, we have $(3S)^2 \le \sum (a_k^2+2 a_{k+1} a_{k+2})^2 \le \sum(a_k^4+6 a_k^2 a_{k+1}^2+2 a_k^2 a_{k+2}^2) \le 2$. This implies $9S^2 \le 2$, so $S^2 \le 2/9$. Since $a_k \ge 0$, we have $S \ge 0$, so $S \le \sqrt{2}/3$. To prove the final strict inequality, we compare $\sqrt{2}/3$ with $12/25$. The inequality $\sqrt{2}/3 < 12/25$ is equivalent to $25\sqrt{2} < 36$. Squaring both positive sides gives $625 \times 2 < 36^2$, which is $1250 < 1296$. This is true, so we conclude that $S < 12/25$."
2007c2,"C2. A unit square is dissected into $n>1$ rectangles such that their sides are parallel to the sides of the square. Any line, parallel to a side of the square and intersecting its interior, also intersects the interior of some rectangle. Prove that in this dissection, there exists a rectangle having no point on the boundary of the square.","Call the directions of the sides of the square horizontal and vertical. A horizontal or vertical line, which intersects the interior of the square but does not intersect the interior of any rectangle, will be called a splitting line. A rectangle having no point on the boundary of the square will be called an interior rectangle.

Suppose, to the contrary, that there exists a dissection of the square into more than one rectangle, such that no interior rectangle and no splitting line appear. Consider such a dissection with the least possible number of rectangles. Notice that this number of rectangles is greater than 2 , otherwise their common side provides a splitting line.

If there exist two rectangles having a common side, then we can replace them by their union (see Figure 1). The number of rectangles was greater than 2, so in a new dissection it is greater than 1. Clearly, in the new dissection, there is also no splitting line as well as no interior rectangle. This contradicts the choice of the original dissection.

Denote the initial square by $A B C D$, with $A$ and $B$ being respectively the lower left and lower right vertices. Consider those two rectangles $a$ and $b$ containing vertices $A$ and $B$, respectively. (Note that $a \neq b$, otherwise its top side provides a splitting line.) We can assume that the height of $a$ is not greater than that of $b$. Then consider the rectangle $c$ neighboring to the lower right corner of $a$ (it may happen that $c=b$ ). By aforementioned, the heights of $a$ and $c$ are distinct. Then two cases are possible.

Case 1. The height of $c$ is less than that of $a$. Consider the rectangle $d$ which is adjacent to both $a$ and $c$, i. e. the one containing the angle marked in Figure 2. This rectangle has no common point with $B C$ (since $a$ is not higher than $b$ ), as well as no common point with $A B$ or with $A D$ (obviously). Then $d$ has a common point with $C D$, and its left side provides a splitting line. Contradiction.

Case 2. The height of $c$ is greater than that of $a$. Analogously, consider the rectangle $d$ containing the angle marked on Figure 3. It has no common point with $A D$ (otherwise it has a common side with $a$ ), as well as no common point with $A B$ or with $B C$ (obviously). Then $d$ has a common point with $C D$. Hence its right side provides a splitting line, and we get the contradiction again.",3,"Assume for contradiction that there is a dissection satisfying the problem's conditions but with no interior rectangle. Show that in such a dissection with the minimum possible number of rectangles, no two rectangles can share a full common side.","Let the dissection be minimal. Suppose two rectangles, R1 and R2, share a full common side. We can merge them into a single rectangle, R_union. The new dissection has one fewer rectangle. Any line intersecting the square's interior must have intersected some rectangle's interior in the original dissection; it will still do so in the new one (intersecting R_union if it previously intersected R1 or R2). So, there are no splitting lines. Since R1 and R2 were not interior, they both touched the square's boundary, and so their union R_union must also touch the boundary. The new dissection thus has no interior rectangles and fewer total rectangles, contradicting the minimality of the original dissection.","In a minimal dissection (as per sub-problem 1), let 'a' be the rectangle at the lower-left corner and 'b' be the one at the lower-right. Assume height(a) ≤ height(b). Let 'c' be the rectangle adjacent to the upper-right corner of 'a'. Show that the case height(c) < height(a) leads to a contradiction.","Consider the rectangle 'd' that must exist adjacent to both 'a' (on its right) and 'c' (on its top). Rectangle 'd' cannot have a point on the bottom side (blocked by 'a' and 'c') or the left side (blocked by 'a'). Since height(a) ≤ height(b), the horizontal path from 'd' to the right side of the square is blocked, so 'd' cannot touch the right side. By our main assumption that no rectangle is interior, 'd' must touch the top side of the square. But then the vertical line containing the left side of 'd' (which is an upward extension of the right side of 'a') does not intersect the interior of any rectangle below 'd', contradicting the condition that there are no splitting lines.","A unit square is dissected into n>1 rectangles such that their sides are parallel to the sides of the square. Any line, parallel to a side of the square and intersecting its interior, also intersects the interior of some rectangle. Prove that in this dissection, there exists a rectangle having no point on the boundary of the square.","Assume for contradiction that no interior rectangle exists. By Sub-Problem 1, we can analyze a minimal dissection where no two rectangles share a full side. Let 'a' and 'b' be the rectangles in the lower-left and lower-right corners. WLOG, assume height(a) ≤ height(b). Let 'c' be the rectangle adjacent to the upper-right corner of 'a'. Since they don't share a full side, height(c) ≠ height(a). Sub-Problem 2 shows that height(c) < height(a) leads to a contradiction. Now, consider height(c) > height(a). Let 'd' be the rectangle adjacent to 'a' on its top and 'c' on its left. Rectangle 'd' cannot touch the left side (blocked by 'a'), bottom side (blocked by 'a'), or right side (blocked by 'c'). So, 'd' must touch the top side of the square. The vertical line containing the right side of 'd' is an upward extension of part of the right side of 'c'. This line does not intersect any rectangle's interior below the top of rectangle 'a', creating a splitting line. This is a contradiction. Since all possibilities lead to a contradiction, the initial assumption is false, and an interior rectangle must exist.",,
2007c4,"C4. Let $A_0=\left(a_1, \ldots, a_n\right)$ be a finite sequence of real numbers. For each $k \geq 0$, from the sequence $A_k=\left(x_1, \ldots, x_n\right)$ we construct a new sequence $A_{k+1}$ in the following way.
1. We choose a partition $\{1, \ldots, n\}=I \cup J$, where $I$ and $J$ are two disjoint sets, such that the expression
$$
\left|\sum_{i \in I} x_i-\sum_{j \in J} x_j\right|
$$
attains the smallest possible value. (We allow the sets $I$ or $J$ to be empty; in this case the corresponding sum is 0 .) If there are several such partitions, one is chosen arbitrarily.
2. We set $A_{k+1}=\left(y_1, \ldots, y_n\right)$, where $y_i=x_i+1$ if $i \in I$, and $y_i=x_i-1$ if $i \in J$.

Prove that for some $k$, the sequence $A_k$ contains an element $x$ such that $|x| \geq n / 2$.","Solution.
Lemma. Suppose that all terms of the sequence $\left(x_1, \ldots, x_n\right)$ satisfy the inequality $\left|x_i\right|<a$. Then there exists a partition $\{1,2, \ldots, n\}=I \cup J$ into two disjoint sets such that
$$
\left|\sum_{i \in I} x_i-\sum_{j \in J} x_j\right|<a .
$$

Proof. Apply an induction on $n$. The base case $n=1$ is trivial. For the induction step, consider a sequence $\left(x_1, \ldots, x_n\right)(n>1)$. By the induction hypothesis there exists a splitting $\{1, \ldots, n-1\}=I^{\prime} \cup J^{\prime}$ such that
$$
\left|\sum_{i \in I^{\prime}} x_i-\sum_{j \in J^{\prime}} x_j\right|<a .
$$

For convenience, suppose that $\sum_{i \in I^{\prime}} x_i \geq \sum_{j \in J^{\prime}} x_j$. If $x_n \geq 0$ then choose $I=I^{\prime}, J=J \cup\{n\}$; otherwise choose $I=I^{\prime} \cup\{n\}, J=J^{\prime}$. In both cases, we have $\sum_{i \in I^{\prime}} x_i-\sum_{j \in J^{\prime}} x_j \in[0, a)$ and $\left|x_n\right| \in[0, a) ;$ hence
$$
\sum_{i \in I} x_i-\sum_{j \in J} x_j=\sum_{i \in I^{\prime}} x_i-\sum_{j \in J^{\prime}} x_j-\left|x_n\right| \in(-a, a),
$$
as desired.
Let us turn now to the problem. To the contrary, assume that for all $k$, all the numbers in $A_k$ lie in interval $(-n / 2, n / 2)$. Consider an arbitrary sequence $A_k=\left(b_1, \ldots, b_n\right)$. To obtain the term $b_i$, we increased and decreased number $a_i$ by one several times. Therefore $b_i-a_i$ is always an integer, and there are not more than $n$ possible values for $b_i$. So, there are not more than $n^n$ distinct possible sequences $A_k$, and hence two of the sequences $A_1, A_2, \ldots, A_{n^n+1}$ should be identical, say $A_p=A_q$ for some $p<q$.

For any positive integer $k$, let $S_k$ be the sum of squares of elements in $A_k$. Consider two consecutive sequences $A_k=\left(x_1, \ldots, x_n\right)$ and $A_{k+1}=\left(y_1, \ldots, y_n\right)$. Let $\{1,2, \ldots, n\}=I \cup J$ be the partition used in this step - that is, $y_i=x_i+1$ for all $i \in I$ and $y_j=x_j-1$ for all $j \in J$. Since the value of $\left|\sum_{i \in I} x_i-\sum_{j \in J} x_j\right|$ is the smallest possible, the Lemma implies that it is less than $n / 2$. Then we have
$$
S_{k+1}-S_k=\sum_{i \in I}\left(\left(x_i+1\right)^2-x_i^2\right)+\sum_{j \in J}\left(\left(x_j-1\right)^2-x_j^2\right)=n+2\left(\sum_{i \in I} x_i-\sum_{j \in J} x_j\right)>n-2 \cdot \frac{n}{2}=0 .
$$

Thus we obtain $S_q>S_{q-1}>\cdots>S_p$. This is impossible since $A_p=A_q$ and hence $S_p=S_q$.",3,"Prove that for any sequence of real numbers $(x_1, \ldots, x_n)$ with $|x_i| < a$ for all $i=1, \ldots, n$, there exists a partition of $\{1, \ldots, n\}$ into two disjoint sets $I$ and $J$ such that $|\sum_{i \in I} x_i - \sum_{j \in J} x_j| < a$.","We use induction on $n$. The base case $n=1$ is trivial, as for the partition $I=\{1\}, J=\emptyset$, we have $|\sum_{i \in I} x_i - \sum_{j \in J} x_j| = |x_1| < a$. For the induction step, assume the statement holds for $n-1$. Given a sequence $(x_1, \ldots, x_n)$ with $|x_i| < a$, there is a partition $\{1, \ldots, n-1\} = I' \cup J'$ such that $|\sum_{i \in I'} x_i - \sum_{j \in J'} x_j| < a$. Let $D = \sum_{i \in I'} x_i - \sum_{j \in J'} x_j$. Without loss of generality, assume $D \ge 0$, so $D \in [0, a)$. If $x_n \ge 0$, we set $I=I', J=J'\cup\{n\}$. The new difference is $D - x_n$. Since $D \in [0, a)$ and $x_n \in [0, a)$, the difference is in $(-a, a)$. If $x_n < 0$, we set $I=I'\cup\{n\}, J=J'$. The new difference is $D + x_n$. Since $D \in [0, a)$ and $x_n \in (-a, 0)$, the difference is in $(-a, a)$. In all cases, we find a suitable partition for $n$ elements.","Assume that for all $k \geq 0$, every element $x_i$ in the sequence $A_k$ satisfies $|x_i| < n/2$. Let $S_k = \sum_{i=1}^n x_i^2$ where $A_k=(x_1, \ldots, x_n)$. Prove that $S_{k+1} > S_k$ for all $k \geq 0$.","Let $A_k = (x_1, \ldots, x_n)$ and $A_{k+1} = (y_1, \ldots, y_n)$. Let $\{1, \ldots, n\} = I \cup J$ be the partition used to generate $A_{k+1}$. By the assumption $|x_i| < n/2$ and the result of sub-problem 1, a partition exists such that the expression $|\sum_{i \in I} x_i - \sum_{j \in J} x_j|$ is less than $n/2$. Since the chosen partition minimizes this value, it must also satisfy this inequality. Let $D_k = \sum_{i \in I} x_i - \sum_{j \in J} x_j$, so $|D_k| < n/2$. We have $y_i = x_i+1$ for $i \in I$ and $y_i = x_i-1$ for $i \in J$. The change in the sum of squares is $S_{k+1} - S_k = \sum_{i \in I}((x_i+1)^2 - x_i^2) + \sum_{j \in J}((x_j-1)^2 - x_j^2) = \sum_{i \in I}(2x_i+1) + \sum_{j \in J}(-2x_j+1) = n + 2(\sum_{i \in I} x_i - \sum_{j \in J} x_j) = n + 2D_k$. Since $|D_k| < n/2$, we have $-n < 2D_k < n$. Therefore, $S_{k+1} - S_k = n+2D_k > n-n = 0$, which means $S_{k+1} > S_k$.","Prove that for some $k$, the sequence $A_k$ contains an element $x$ such that $|x| \geq n / 2$.","Assume for contradiction that for all $k \geq 0$, every element $x_i$ in $A_k=(x_1, \ldots, x_n)$ satisfies $|x_i| < n/2$. From sub-problem 2, this implies that the sequence of sums of squares, $S_k = \sum_{i=1}^n x_i^2$, is strictly increasing: $S_0 < S_1 < S_2 < \dots$. However, the set of possible sequences $A_k$ is finite. For any element $b_i$ in a sequence $A_k$, the value $b_i - a_i$ must be an integer, where $a_i$ is from the initial sequence $A_0$. The condition $|b_i| < n/2$ thus limits each $b_i$ to a finite set of possible values. Consequently, there are only a finite number of distinct sequences $A_k$. By the Pigeonhole Principle, the sequence of sequences $(A_k)_{k \ge 0}$ must eventually repeat. So, there exist integers $p < q$ such that $A_p = A_q$. This implies $S_p = S_q$, which contradicts the fact that the sequence $(S_k)$ is strictly increasing ($S_q > S_p$). Therefore, the initial assumption must be false.",,
2007c5,"C5. In the Cartesian coordinate plane define the strip $S_n=\{(x, y) \mid n \leq x<n+1\}$ for every integer $n$. Assume that each strip $S_n$ is colored either red or blue, and let $a$ and $b$ be two distinct positive integers. Prove that there exists a rectangle with side lengths $a$ and $b$ such that its vertices have the same color.","Solution. If $S_n$ and $S_{n+a}$ have the same color for some integer $n$, then we can choose the rectangle with vertices $(n, 0) \in S_n,(n, b) \in S_n,(n+a, 0) \in S_{n+a}$, and $(n+a, b) \in S_{n+a}$, and we are done. So it can be assumed that $S_n$ and $S_{n+a}$ have opposite colors for each $n$.

Similarly, it also can be assumed that $S_n$ and $S_{n+b}$ have opposite colors. Then, by induction on $|p|+|q|$, we obtain that for arbitrary integers $p$ and $q$, strips $S_n$ and $S_{n+p a+q b}$ have the same color if $p+q$ is even, and these two strips have opposite colors if $p+q$ is odd.

Let $d=\operatorname{gcd}(a, b), a_1=a / d$ and $b_1=b / d$. Apply the result above for $p=b_1$ and $q=-a_1$. The strips $S_0$ and $S_{0+b_1 a-a_1 b}$ are identical and therefore they have the same color. Hence, $a_1+b_1$ is even. By the construction, $a_1$ and $b_1$ are coprime, so this is possible only if both are odd.

Without loss of generality, we can assume $a>b$. Then $a_1>b_1 \geq 1$, so $a_1 \geq 3$.
Choose integers $k$ and $\ell$ such that $k a_1-\ell b_1=1$ and therefore $k a-\ell b=d$. Since $a_1$ and $b_1$ are odd, $k+\ell$ is odd as well. Hence, for every integer $n$, strips $S_n$ and $S_{n+k a-\ell b}=S_{n+d}$ have opposite colors. This also implies that the coloring is periodic with period $2 d$, i.e. strips $S_n$ and $S_{n+2 d}$ have the same color for every $n$.

Figure 1
We will construct the desired rectangle $A B C D$ with $A B=C D=a$ and $B C=A D=b$ in a position such that vertex $A$ lies on the $x$-axis, and the projection of side $A B$ onto the $x$-axis is of length $2 d$ (see Figure 1). This is possible since $a=a_1 d>2 d$. The coordinates of the vertices will have the forms
$$
A=(t, 0), \quad B=\left(t+2 d, y_1\right), \quad C=\left(u+2 d, y_2\right), \quad D=\left(u, y_3\right)
$$

Let $\varphi=\sqrt{a_1^2-4}$. By Pythagoras' theorem,
$$
y_1=B B_0=\sqrt{a^2-4 d^2}=d \sqrt{a_1^2-4}=d \varphi .
$$

So, by the similar triangles $A D D_0$ and $B A B_0$, we have the constraint
$$
u-t=A D_0=\frac{A D}{A B} \cdot B B_0=\frac{b d}{a} \varphi
$$

for numbers $t$ and $u$. Computing the numbers $y_2$ and $y_3$ is not required since they have no effect to the colors.

Observe that the number $\varphi$ is irrational, because $\varphi^2$ is an integer, but $\varphi$ is not: $a_1>\varphi \geq$ $\sqrt{a_1^2-2 a_1+2}>a_1-1$.

By the periodicity, points $A$ and $B$ have the same color; similarly, points $C$ and $D$ have the same color. Furthermore, these colors depend only on the values of $t$ and $u$. So it is sufficient to choose numbers $t$ and $u$ such that vertices $A$ and $D$ have the same color.

Let $w$ be the largest positive integer such that there exist $w$ consecutive strips $S_{n_0}, S_{n_0+1}, \ldots$, $S_{n_0+w-1}$ with the same color, say red. (Since $S_{n_0+d}$ must be blue, we have $w \leq d$.) We will choose $t$ from the interval $\left(n_0, n_0+w\right)$.

Figure 2
Consider the interval $I=\left(n_0+\frac{b d}{a} \varphi, n_0+\frac{b d}{a} \varphi+w\right)$ on the $x$-axis (see Figure 2). Its length is $w$, and the end-points are irrational. Therefore, this interval intersects $w+1$ consecutive strips. Since at most $w$ consecutive strips may have the same color, interval $I$ must contain both red and blue points. Choose $u \in I$ such that the line $x=u$ is red and set $t=u-\frac{b d}{a} \varphi$, according to the constraint (1). Then $t \in\left(n_0, n_0+w\right)$ and $A=(t, 0)$ is red as well as $D=\left(u, y_3\right)$.

Hence, variables $u$ and $t$ can be set such that they provide a rectangle with four red vertices.
Comment. The statement is false for squares, i.e. in the case $a=b$. If strips $S_{2 k a}, S_{2 k a+1}, \ldots$, $S_{(2 k+1) a-1}$ are red, and strips $S_{(2 k+1) a}, S_{(2 k+1) a+1}, \ldots, S_{(2 k+2) a-1}$ are blue for every integer $k$, then each square of size $a \times a$ has at least one red and at least one blue vertex as well.",4,"Suppose the coloring of strips $S_n$ is such that for all integers $n$, $S_n$ and $S_{n+a}$ have opposite colors, and $S_n$ and $S_{n+b}$ have opposite colors. Prove that for any integers $p, q$, the strips $S_n$ and $S_{n+pa+qb}$ have the same color if $p+q$ is even, and opposite colors if $p+q$ is odd.","We prove this by induction on $|p|+|q|$. The base cases $|p|+|q|=1$ (i.e., $(p,q) = (\pm 1, 0)$ or $(0, \pm 1)$) hold by assumption. For the inductive step, assume the statement holds for $|p|+|q|=k$. Consider a pair $(p',q')$ with $|p'|+|q'|=k+1$. We can write $(p',q') = (p,q) + (\delta_p, \delta_q)$ where $|p|+|q|=k$ and $|\delta_p|+|\delta_q|=1$. For instance, let $p'=p+1, q'=q$. The strip $S_{n+(p+1)a+qb}$ has the opposite color of $S_{n+pa+qb}$. By the inductive hypothesis, the color of $S_{n+pa+qb}$ relative to $S_n$ depends on the parity of $p+q$. The color of $S_{n+(p+1)a+qb}$ relative to $S_n$ will thus depend on the parity of $(p+1)+q$, which is opposite to the parity of $p+q$. This completes the induction.","Let $d = \\operatorname{gcd}(a, b)$, $a=da_1$, $b=db_1$. Assuming the coloring property from the previous sub-problem, show that $a_1$ and $b_1$ must both be odd, and that for any integer $n$, strips $S_n$ and $S_{n+d}$ have opposite colors, which implies $S_n$ and $S_{n+2d}$ have the same color.","Since $\\operatorname{gcd}(a_1,b_1)=1$, by the Euclidean algorithm, we can find integers $p=b_1$ and $q=-a_1$. Then $pa+qb = b_1(da_1) - a_1(db_1) = 0$. The strips $S_n$ and $S_{n+0}$ are identical and thus have the same color. By the previous result, this means $p+q=b_1-a_1$ must be even. Since $a_1$ and $b_1$ are coprime, they cannot both be even. Thus, they must both be odd. Now, let $k, \\ell$ be integers such that $ka-\\ell b=d$, which means $ka_1-\\ell b_1=1$. Since $a_1$ and $b_1$ are odd, $k$ and $\\ell$ must have opposite parity, so $k-\\ell$ is odd. Applying the previous result again with $p=k, q=-\\ell$, the strips $S_n$ and $S_{n+d}$ must have opposite colors. Consequently, $S_{n+2d}$ has the opposite color to $S_{n+d}$, meaning it has the same color as $S_n$.","Assume the coloring is periodic with period $2d$ and that $S_n, S_{n+d}$ have opposite colors. Show that if there exist real numbers $t$ and $u$ such that $u-t = \frac{b}{a}\\sqrt{a^2-4d^2}$ and the strips $S_{\\lfloor t \rfloor}$ and $S_{\\lfloor u \rfloor}$ have the same color, then a rectangle with side lengths $a$ and $b$ and monochromatic vertices exists.","Construct a rectangle with vertices $A, B, C, D$. Let $A=(t, 0)$ and $B=(t+2d, \\sqrt{a^2-4d^2})$. The distance $|AB| = \\sqrt{(2d)^2 + a^2-4d^2} = a$. Let the other two vertices be $D$ and $C$ such that $\\vec{AD}$ is perpendicular to $\\vec{AB}$ and has length $b$. This fixes the geometry, including the relation $u-t = \frac{b}{a}\\sqrt{a^2-4d^2}$ where $u$ is the x-coordinate of $D$. The x-coordinates of $A$ and $B$ are $t$ and $t+2d$. Since the coloring has period $2d$, $S_{\\lfloor t \rfloor}$ and $S_{\\lfloor t+2d \rfloor}$ have the same color, so $A$ and $B$ have the same color. Similarly, the x-coordinates of $D$ and $C$ are $u$ and $u+2d$, so they have the same color. If we can choose $t$ and $u$ such that $S_{\\lfloor t \rfloor}$ and $S_{\\lfloor u \rfloor}$ have the same color, then $A$ and $D$ have the same color, and thus all four vertices will have the same color.","In the Cartesian coordinate plane define the strip $S_n=\\{(x, y) \\mid n \\leq x<n+1\\}$ for every integer $n$. Assume that each strip $S_n$ is colored either red or blue, and let $a$ and $b$ be two distinct positive integers. Prove that there exists a rectangle with side lengths $a$ and $b$ such that its vertices have the same color.","If for some $n$, $S_n$ and $S_{n+a}$ have the same color, a rectangle with vertices $(n,0), (n,b), (n+a,0), (n+a,b)$ works. A similar argument holds for $S_n$ and $S_{n+b}$. Otherwise, the assumptions of the previous sub-problems hold. We need to find $t, u$ as described in sub-problem 3. Let $K = \frac{b}{a}\\sqrt{a^2-4d^2}$. Since $a/d, b/d$ are distinct odd integers, $a/d \\ge 3$, so $(a/d)^2-4$ is not a perfect square, making $K$ irrational. Let $w$ be the maximum number of consecutive strips with the same color, say red, from $S_{n_0}$ to $S_{n_0+w-1}$. Choose $t$ in the interval $(n_0, n_0+w)$, so $A$ is in a red strip. Then $u=t+K$ must be in the interval $I=(n_0+K, n_0+w+K)$. This interval has length $w$ and irrational endpoints, so it intersects $w+1$ consecutive strips. By the maximality of $w$, these strips are not all of the same color. Thus, $I$ contains regions of both red and blue strips. We can choose a value for $u$ in $I$ such that $S_{\\lfloor u \rfloor}$ is red. This choice of $t$ and $u$ satisfies the conditions of sub-problem 3, guaranteeing a monochromatic rectangle."
2007c6,"In a mathematical competition some competitors are friends; friendship is always mutual. 
Call a group of competitors a \textit{clique} if each two of them are friends. 
The number of members in a clique is called its \textit{size}.

It is known that the largest size of cliques is even. Prove that the competitors can be arranged in two rooms such that the largest size of cliques in one room is the same as the largest size of cliques in the other room.","\textbf{Solution.} We present an algorithm to arrange the competitors. Let the two rooms be \textit{Room A} and \textit{Room B}. We start with an initial arrangement, then we modify it several times by sending one person to the other room. At any state of the algorithm, $A$ and $B$ denote the sets of the competitors in the rooms, and $c(A)$ and $c(B)$ denote the largest sizes of cliques in the rooms, respectively.

\textbf{Step 1.} \textit{Let $M$ be one of the cliques of largest size, $|M| = 2m$. Send all members of $M$ to Room A and all other competitors to Room B.}

Since $M$ is a clique of the largest size, we have $c(A) = |M| \ge c(B)$.

\textbf{Step 2.} \textit{While $c(A) > c(B)$, send one person from Room A to Room B.}

\begin{center}
\includegraphics[width=0.5\textwidth]{diagram_step2.png}
\end{center}

Note that $c(A) > c(B)$ implies that Room A is not empty.

In each step, $c(A)$ decreases by one and $c(B)$ increases by at most one. So at the end we have $c(A) \le c(B) \le c(A) + 1$.

We also have $c(A) = |A| \ge m$ at the end. Otherwise we would have at least $m+1$ members of $M$ in Room B and at most $m-1$ in Room A, implying $c(B) - c(A) \ge (m+1)-(m-1) = 2$.

\textbf{Step 3.} Let $k = c(A)$. \textit{If $c(B) = k$ then STOP.}

If we reached $c(A) = c(B) = k$ then we have found the desired arrangement.

In all other cases we have $c(B) = k + 1$.

From the estimate above we also know that $k = |A| = |A \cap M| \ge m$ and $|B \cap M| \le m$.

\textbf{Step 4.} \textit{If there exists a competitor $x \in B \cap M$ and a clique $C \subseteq B$ such that $|C| = k + 1$ and $x \notin C$, then move $x$ to Room A and STOP.}

\begin{center}
\includegraphics[width=0.5\textwidth]{diagram_step4.png}
\end{center}

After moving $x$ back to Room A, we will have $k + 1$ members of $M$ in Room A, thus $c(A) = k + 1$. Due to $x \notin C$, $c(B) = |C|$ is not decreased, and after this step we have $c(A) = c(B) = k + 1$.

If there is no such competitor $x$, then in Room B, all cliques of size $k + 1$ contain $B \cap M$ as a subset.

\textbf{Step 5.} \textit{While $c(B) = k + 1$, choose a clique $C \subseteq B$ such that $|C| = k + 1$ and move one member of $C \setminus M$ to Room A.}

\begin{center}
\includegraphics[width=0.5\textwidth]{diagram_step5.png}
\end{center}

Note that $|C| = k + 1 > m \ge |B \cap M|$, so $C \setminus M$ cannot be empty.

Every time we move a single person from Room B to Room A, so $c(B)$ decreases by at most 1. Hence, at the end of this loop we have $c(B) = k$.

In Room A we have the clique $A \cap M$ with size $|A \cap M| = k$ thus $c(A) \ge k$. We prove that there is no clique of larger size there. Let $Q \subseteq A$ be an arbitrary clique. We show that $|Q| \le k$.

\begin{center}
\includegraphics[width=0.5\textwidth]{diagram_step5_proof.png}
\end{center}

In Room A, and especially in set $Q$, there can be two types of competitors:
\begin{itemize}
    \item Some members of $M$. Since $M$ is a clique, they are friends with all members of $B \cap M$.
    \item Competitors who were moved to Room A in Step 5. Each of them has been in a clique with $B \cap M$ so they are also friends with all members of $B \cap M$.
\end{itemize}

Hence, all members of $Q$ are friends with all members of $B \cap M$. Sets $Q$ and $B \cap M$ are cliques themselves, so $Q \cup (B \cap M)$ is also a clique. Since $M$ is a clique of the largest size,

\[
|M| \ge |Q \cup (B \cap M)| = |Q| + |B \cap M| = |Q| + |M| - |A \cap M|,
\]

therefore
\[
|Q| \le |A \cap M| = k.
\]

Finally, after Step 5 we have $c(A) = c(B) = k$.

\textbf{Comment.} Obviously, the statement is false without the assumption that the largest clique size is even.",4,"Show that there exists an arrangement of competitors into two rooms, A and B, such that their largest clique sizes, c(A) and c(B), satisfy c(A) ≤ c(B) ≤ c(A) + 1.","Let M be a clique of the largest size, 2m. Initially, place all members of M in Room A and everyone else in Room B. Thus c(A) = 2m ≥ c(B). While c(A) > c(B), move one person from A to B. Since A starts as M and people only leave it, A is always a subclique of M, so c(A) is its size. Each move decreases c(A) by one and increases c(B) by at most one. The difference c(A) - c(B) strictly decreases, so the process terminates when c(A) ≤ c(B). The last move was from a state c(A_old) > c(B_old) to c(A_new) = c(A_old) - 1 and c(B_new) ≤ c(B_old) + 1. Thus c(B_new) - c(A_new) ≤ (c(B_old)+1) - (c(A_old)-1) = c(B_old) - c(A_old) + 2. Since c(A_old) > c(B_old), c(B_old) - c(A_old) is at most -1. Thus, c(B_new) - c(A_new) ≤ 1. So at the end, c(A) ≤ c(B) ≤ c(A) + 1.","Assume an arrangement where c(A) = k and c(B) = k+1, and A is a subclique of an original maximum clique M. Prove that if there is a competitor x ∈ B ∩ M and a clique C ⊆ B of size k+1 with x ∉ C, then moving x to Room A equalizes the largest clique sizes.","Let the new rooms be A' = A ∪ {x} and B' = B \ {x}. Since A is a k-sized subclique of M and x is in M, A' is a (k+1)-sized subclique of M. Thus, c(A') = k+1. The clique C ⊆ B has size k+1 and x ∉ C, so C is also a subset of B'. This means c(B') ≥ k+1. Since removing a person cannot increase the maximum clique size, c(B') ≤ c(B) = k+1. Therefore, c(B') = k+1. The new arrangement has c(A') = c(B') = k+1.","Assume an arrangement where c(A) = k, c(B) = k+1, A is a k-sized subclique of an original maximum clique M, and every (k+1)-clique in B contains the set B ∩ M. Prove that moving any competitor y from a (k+1)-clique C ⊆ B with y ∉ M to Room A results in a new room A' where c(A') = k.","Let A' = A ∪ {y} and let Q be any clique in A'. Every person in A is in M and is friends with everyone in B ∩ M. By assumption, y is in a clique C with B ∩ M, so y is friends with everyone in B ∩ M. Thus, every member of Q is friends with every member of B ∩ M, which means Q ∪ (B ∩ M) is a clique. The maximum clique size is |M| = 2m. Also, |B ∩ M| = |M| - |A| = 2m - k. So, |Q ∪ (B ∩ M)| = |Q| + |B ∩ M| = |Q| + 2m - k ≤ 2m. This implies |Q| ≤ k. Since A is a k-clique within A', c(A') must be at least k. Therefore, we conclude that c(A') = k.",It is known that the largest size of cliques is even. Prove that the competitors can be arranged in two rooms such that the largest size of cliques in one room is the same as the largest size of cliques in the other room.,"By sub-problem 1, we can arrange competitors into rooms A and B such that c(A) = k and c(B) is either k or k+1. If c(B) = k, we are done. If c(B) = k+1, we check the condition of sub-problem 2. If it holds, one move solves the problem, resulting in clique sizes of k+1 in both rooms. If it fails, then every (k+1)-clique C in B must contain B ∩ M. As the initial arrangement ensures k ≥ m and |B ∩ M| ≤ m, we have |C|=k+1 > |B ∩ M|, so C \ M is not empty. We can then repeatedly move a person from C \ M to room A. Each move may decrease c(B). We continue until c(B) becomes k. By sub-problem 3, c(A) remains k throughout this process. We thus arrive at a state where c(A) = c(B) = k."
2007c7,"Let $\alpha < \dfrac{3 - \sqrt{5}}{2}$ be a positive real number. Prove that there exist positive integers $n$ and $p > \alpha \cdot 2^n$ for which one can select $2p$ pairwise distinct subsets $S_1, \dots, S_p, T_1, \dots, T_p$ of the set $\{1, 2, \dots, n\}$ such that $S_i \cap T_j \ne \emptyset$ for all $1 \le i, j \le p$.","\textbf{Solution.} Let $k$ and $m$ be positive integers (to be determined later) and set $n = km$. Decompose the set $\{1, 2, \dots, n\}$ into $k$ disjoint subsets, each of size $m$; denote these subsets by $A_1, \dots, A_k$. Define the following families of sets:

\[
\mathcal{S} = \left\{ S \subseteq \{1,2,\dots,n\} : \forall i,\; S \cap A_i \ne \emptyset \right\}, \quad 
\mathcal{T}_1 = \left\{ T \subseteq \{1,2,\dots,n\} : \exists i,\; A_i \subseteq T \right\}, \quad 
\mathcal{T} = \mathcal{T}_1 \setminus \mathcal{S}.
\]

For each set $T \in \mathcal{T}$, there exists an index $1 \le i \le k$ such that $A_i \subseteq T$. Then for all $S \in \mathcal{S}$, $S \cap T \supseteq S \cap A_i \ne \emptyset$. Hence, each $S \in \mathcal{S}$ and each $T \in \mathcal{T}$ have at least one common element.

Below we show that the numbers $m$ and $k$ can be chosen such that $|\mathcal{S}|, |\mathcal{T}| > \alpha \cdot 2^n$. Then, choosing $p = \min\{|\mathcal{S}|, |\mathcal{T}|\}$, one can select the desired $2p$ sets $S_1, \dots, S_p$ and $T_1, \dots, T_p$ from families $\mathcal{S}$ and $\mathcal{T}$, respectively. Since families $\mathcal{S}$ and $\mathcal{T}$ are disjoint, sets $S_i$ and $T_j$ will be pairwise distinct.

To count the sets $\mathcal{S} \in \mathcal{S}$, observe that each $A_i$ has $2^m - 1$ nonempty subsets so we have $2^m - 1$ choices for $S \cap A_i$. These intersections uniquely determine set $S$, so

\[
|\mathcal{S}| = (2^m - 1)^k. \tag{1}
\]

Similarly, if a set $H \subset \{1,2,\dots,n\}$ does not contain a certain set $A_i$, then we have $2^m - 1$ choices for $H \cap A_i$: all subsets of $A_i$ except $A_i$ itself. Therefore, the complement of $\mathcal{T}_1$ contains $(2^m - 1)^k$ sets and

\[
|\mathcal{T}_1| = 2^{km} - (2^m - 1)^k. \tag{2}
\]

Next consider the family $\mathcal{S} \setminus \mathcal{T}_1$. If a set $S$ intersects all $A_i$ but does not contain any of them, then there exists $2^m - 2$ possible values for each $S \cap A_i$: all subsets of $A_i$ except $\emptyset$ and $A_i$. Therefore the number of such sets $S$ is $(2^m - 2)^k$, so

\[
|\mathcal{S} \setminus \mathcal{T}_1| = (2^m - 2)^k. \tag{3}
\]

From (1), (2), and (3) we obtain
\[
|\mathcal{T}| = |\mathcal{T}_1| - |\mathcal{S} \cap \mathcal{T}_1| = |\mathcal{T}_1| - (|\mathcal{S}| - |\mathcal{S} \setminus \mathcal{T}_1|) = 2^{km} - 2(2^m - 1)^k + (2^m - 2)^k.
\]

Let $\delta = \dfrac{3 - \sqrt{5}}{2}$ and $k = k(m) = \left\lfloor \dfrac{2^m \log \tfrac{1}{\delta}}{m} \right\rfloor$. Then
\[
\lim_{m \to \infty} \frac{|\mathcal{S}|}{2^{km}} = \lim_{m \to \infty} \left( 1 - \frac{1}{2^m} \right)^k = \exp \left( -\lim_{m \to \infty} \frac{k}{2^m} \right) = \delta
\]
and similarly
\[
\lim_{m \to \infty} \frac{|\mathcal{T}|}{2^{km}} = 1 - 2 \lim_{m \to \infty} \left( 1 - \frac{1}{2^m} \right)^k + \lim_{m \to \infty} \left( 1 - \frac{2}{2^m} \right)^k = 1 - 2\delta + \delta^2 = \delta.
\]

Hence, if $m$ is sufficiently large then $\dfrac{|\mathcal{S}|}{2^{km}}$ and $\dfrac{|\mathcal{T}|}{2^{km}}$ are greater than $\alpha$ (since $\alpha < \delta$). So $|\mathcal{S}|, |\mathcal{T}| > \alpha \cdot 2^{km} = \alpha \cdot 2^n$.

\textbf{Comment.} It can be proved that the constant $\dfrac{3 - \sqrt{5}}{2}$ is sharp. Actually, if $S_1, \dots, S_p, T_1, \dots, T_p$ are distinct subsets of $\{1,2,\dots,n\}$ such that each $S_i$ intersects each $T_j$, then",4,"For integers $k,m \\ge 1$, let $n=km$. Partition the set $\{1, \\dots, n\}$ into $k$ disjoint subsets $A_1, \\dots, A_k$, each of size $m$. Construct two disjoint families of subsets, $\\mathcal{S}$ and $\\mathcal{T}$, such that every set in $\\mathcal{S}$ has a non-empty intersection with every set in $\\mathcal{T}$.","Define $\\mathcal{S} = \\{ S \\subseteq \\{1,..,n\\} : \forall i, S \\cap A_i \ne \\emptyset \\}$ and $\\mathcal{T}_1 = \\{ T \\subseteq \\{1,..,n\\} : \\exists j, A_j \\subseteq T \\}$. Let $\\mathcal{T} = \\mathcal{T}_1 \\setminus \\mathcal{S}$. For any $S \\in \\mathcal{S}$ and $T \\in \\mathcal{T}$, there must be some index $j$ such that $A_j \\subseteq T$ (since $T \\in \\mathcal{T}_1$). As $S \\in \\mathcal{S}$, we have $S \\cap A_j \ne \\emptyset$. Thus $S \\cap T \\supseteq S \\cap A_j \ne \\emptyset$. The families $\\mathcal{S}$ and $\\mathcal{T}$ are disjoint by the definition of $\\mathcal{T}$ as a subset of the complement of $\\mathcal{S}$.","With the definitions from the previous step, derive expressions for the cardinalities $|\\mathcal{S}|$ and $|\\mathcal{T}|$ in terms of $k$ and $m$.","A set $S$ is in $\\mathcal{S}$ if for each $i \\in \\{1, \\dots, k\\}$, its intersection $S \\cap A_i$ is a non-empty subset of $A_i$. There are $2^m-1$ such choices for each $A_i$, so $|\\mathcal{S}| = (2^m-1)^k$. To find $|\\mathcal{T}| = |\\mathcal{T}_1| - |\\mathcal{S} \\cap \\mathcal{T}_1|$, we first calculate $|\\mathcal{T}_1| = 2^{km} - (2^m-1)^k$ and $|\\mathcal{S} \\setminus \\mathcal{T}_1| = (2^m-2)^k$. This implies $|\\mathcal{S} \\cap \\mathcal{T}_1| = |\\mathcal{S}| - |\\mathcal{S} \\setminus \\mathcal{T}_1| = (2^m-1)^k - (2^m-2)^k$. Combining these results yields $|\\mathcal{T}| = 2^{km} - 2(2^m - 1)^k + (2^m - 2)^k$.","Let $\\delta = \frac{3 - \\sqrt{5}}{2}$. Show that for any given positive constant $\\alpha < \\delta$, it is possible to choose integers $k$ and $m$ such that, with $n=km$, the families $\\mathcal{S}$ and $\\mathcal{T}$ satisfy both $|\\mathcal{S}| > \\alpha \\cdot 2^n$ and $|\\mathcal{T}| > \\alpha \\cdot 2^n$.","Consider the ratios $\frac{|\\mathcal{S}|}{2^n} = \\left(1-\frac{1}{2^m}\right)^k$ and $\frac{|\\mathcal{T}|}{2^n} = 1 - 2\\left(1-\frac{1}{2^m}\right)^k + \\left(1-\frac{2}{2^m}\right)^k$. Let $c = -\\log\\delta$. For any sufficiently large $m$, we can choose an integer $k$ such that $c \\cdot 2^m - 1 < k \\le c \\cdot 2^m$, which implies $k/2^m \to c$ as $m \to \\infty$. Then $\\lim_{m\to\\infty} \frac{|\\mathcal{S}|}{2^n} = e^{-c} = \\delta$. Similarly, $\\lim_{m\to\\infty} \frac{|\\mathcal{T}|}{2^n} = 1 - 2e^{-c} + e^{-2c} = 1 - 2\\delta + \\delta^2 = \\delta$, since $\\delta$ is a root of $x^2 - 3x + 1 = 0$. As both ratios converge to $\\delta > \\alpha$, for a sufficiently large $m$ and its corresponding $k$, both $|\\mathcal{S}|/2^n$ and $|\\mathcal{T}|/2^n$ will be greater than $\\alpha$.","Let $\\alpha < \\dfrac{3 - \\sqrt{5}}{2}$ be a positive real number. Prove that there exist positive integers $n$ and $p > \\alpha \\cdot 2^n$ for which one can select $2p$ pairwise distinct subsets $S_1, \\dots, S_p, T_1, \\dots, T_p$ of the set $\\{1, 2, \\dots, n\\}$ such that $S_i \\cap T_j \ne \\emptyset$ for all $1 \\le i, j \\le p$.","From the previous steps, we can find an integer $n$ and construct two disjoint families of subsets, $\\mathcal{S}$ and $\\mathcal{T}$, such that any set in $\\mathcal{S}$ intersects any set in $\\mathcal{T}$. We also showed that for any $\\alpha < (3 - \\sqrt{5})/2$, we can choose $n$ large enough such that $|\\mathcal{S}| > \\alpha \\cdot 2^n$ and $|\\mathcal{T}| > \\alpha \\cdot 2^n$. Let $p = \\min(|\\mathcal{S}|, |\\mathcal{T}|)$. Then $p > \\alpha \\cdot 2^n$. We can select $p$ distinct subsets $S_1, \\dots, S_p$ from $\\mathcal{S}$ and $p$ distinct subsets $T_1, \\dots, T_p$ from $\\mathcal{T}$. Since $\\mathcal{S}$ and $\\mathcal{T}$ are disjoint, these $2p$ subsets are all pairwise distinct, and they satisfy the intersection property by construction."
2007c8,"Given a convex $n$-gon $P$ in the plane. For every three vertices of $P$, consider the triangle determined by them. Call such a triangle \textit{good} if all its sides are of unit length.\\
Prove that there are not more than $\dfrac{2}{3}n$ good triangles.","\textbf{Solution.} Consider all good triangles containing a certain vertex $A$. The other two vertices of any such triangle lie on the circle $\omega_A$ with unit radius and center at $A$. Since $P$ is convex, all these vertices lie on an arc of angle less than $180^\circ$. Let $L_A R_A$ be the shortest such arc, oriented clockwise (see Figure 1). Each of segments $AL_A$ and $AR_A$ belongs to a unique good triangle. 

We say that the good triangle with side $AL_A$ is \textit{assigned counterclockwise} to $A$, and the second one, with side $AR_A$, is \textit{assigned clockwise} to $A$. In those cases when there is a single good triangle containing vertex $A$, this triangle is assigned to $A$ twice.

There are at most two assignments to each vertex of the polygon. (Vertices which do not belong to any good triangle have no assignment.) So the number of assignments is at most $2n$.

Consider an arbitrary good triangle $ABC$, with vertices arranged clockwise. We prove that $ABC$ is assigned to its vertices at least three times. Then, denoting the number of good triangles by $t$, we obtain that the number $K$ of all assignments is at most $2n$, while it is not less than $3t$. Then $3t \le K \le 2n$, as required.

Actually, we prove that triangle $ABC$ is assigned either counterclockwise to $C$ or clockwise to $B$. Then, by the cyclic symmetry of the vertices, we obtain that triangle $ABC$ is assigned either counterclockwise to $A$ or clockwise to $C$, and either counterclockwise to $B$ or clockwise to $A$, providing the claim.

\begin{center}
\includegraphics[width=0.4\textwidth]{figure1.png}
\hspace{2em}
\includegraphics[width=0.4\textwidth]{figure2.png}

Figure 1 \hspace{12em} Figure 2
\end{center}

Assume, to the contrary, that $L_C \ne A$ and $R_B \ne A$. Denote by $A', B', C'$ the intersection points of circles $\omega_A, \omega_B$ and $\omega_C$, distinct from $A, B, C$ (see Figure 2). Let $CL_C L'_C$ be the good triangle containing $CL_C$. Observe that the angle of arc $L_C A$ is less than $120^\circ$. Then one of the points $L_C$ and $L'_C$ belongs to arc $B'A$ of $\omega_C$; let this point be $X$. In the case when $L_C = B'$ and $L'_C = A$, choose $X = B'$.

Analogously, considering the good triangle $B R'_B R_B$ which contains $BR_B$ as an edge, we see that one of the points $R_B$ and $R'_B$ lies on arc $AC'$ of $\omega_B$. Denote this point by $Y$, $Y \ne A$. Then angles $XAY, YAB, BAC$ and $CAX$ (oriented clockwise) are not greater than $180^\circ$. Hence, point $A$ lies in quadrilateral $XYBC$ (either in its interior or on segment $XY$). This is impossible, since all these five points are vertices of $P$.

Hence, each good triangle has at least three assignments, and the statement is proved.

\textbf{Comment 1.} Considering a diameter $AB$ of the polygon, one can prove that every good triangle containing either $A$ or $B$ has at least four assignments. This observation leads to $t \le \left\lfloor \dfrac{2}{3}(n - 1) \right\rfloor$.

\textbf{Comment 2.} The result $t \le \left\lfloor \dfrac{2}{3}(n - 1) \right\rfloor$ is sharp. To construct a polygon with $n = 3k + 1$ vertices and $t = 2k$ triangles, take a rhombus $AB_1C_1D_1$ with unit side length and $\angle B_1 = 60^\circ$. Then rotate it around $A$ by small angles obtaining rhombi $AB_2C_2D_2, \dots, AB_kC_kD_k$ (see Figure 3). The polygon $AB_1\dots B_kC_1 \dots C_kD_1 \dots D_k$ has $3k + 1$ vertices and contains $2k$ good triangles.

The construction for $n = 3k$ and $n = 3k - 1$ can be obtained by deleting vertices $D_n$ and $D_{n-1}$.",4,Define a rule for 'assigning' good triangles to the vertices of the polygon $P$ such that each vertex is assigned at most two triangles.,"For any vertex $A$, all other vertices of good triangles containing $A$ lie on a circle $\omega_A$ of radius 1 centered at $A$. Due to the polygon's convexity, these vertices lie on an arc of less than $180^\circ$. Let the endpoints of the minimal such arc be $L_A$ (most counterclockwise) and $R_A$ (most clockwise). The good triangle with side $AL_A$ is assigned 'counterclockwise' to $A$. The good triangle with side $AR_A$ is assigned 'clockwise' to $A$. If only one good triangle contains $A$, it receives both assignments.",Let $K$ be the total number of assignments over all vertices. Show that $K \le 2n$.,"By the assignment rule, each vertex $A$ has at most one counterclockwise assignment (corresponding to $L_A$) and at most one clockwise assignment (corresponding to $R_A$). Since there are $n$ vertices in the polygon, the total number of assignments $K$ across all vertices is at most $2n$.",Prove that each good triangle is assigned to its vertices at least three times in total.,"Let $\triangle ABC$ be a good triangle with vertices ordered clockwise. Assume for contradiction it is not assigned counterclockwise to $C$ and not assigned clockwise to $B$. This implies the existence of other good triangles involving vertices $C$ and $B$, which in turn implies the existence of other vertices of the polygon, say $X$ and $Y$. The geometric constraints imposed by the circles and the convexity of $P$ would force vertex $A$ to lie inside the quadrilateral $XYBC$. This is impossible, as all five points must be vertices of the convex polygon. Thus, the assumption is false. By cyclic symmetry, this ensures at least one assignment between any two vertices, leading to a total of at least 3 assignments for $\triangle ABC$.",Prove that there are not more than $\dfrac{2}{3}n$ good triangles.,"Let $t$ be the number of good triangles and $K$ be the total number of assignments. From the previous steps, we have established two inequalities: 1) The total number of assignments is at most twice the number of vertices, $K \le 2n$. 2) Each good triangle receives at least three assignments, so the total number of assignments is at least three times the number of good triangles, $K \ge 3t$. Combining these inequalities, we get $3t \le K \le 2n$, which implies $t \le \dfrac{2}{3}n$."
2007g1,"In triangle $ABC$, the angle bisector at vertex $C$ intersects the circumcircle and the perpendicular bisectors of sides $BC$ and $CA$ at points $R$, $P$, and $Q$, respectively. The midpoints of $BC$ and $CA$ are $S$ and $T$, respectively. Prove that triangles $RQT$ and $RPS$ have the same area.","If $AC = BC$ then triangle $ABC$ is isosceles, triangles $RQT$ and $RPS$ are symmetric about the bisector $CR$ and the statement is trivial. If $AC \ne BC$ then it can be assumed without loss of generality that $AC < BC$.

Denote the circumcenter by $O$. The right triangles $CTQ$ and $CSP$ have equal angles at vertex $C$, so they are similar, $\angle CPS = \angle CQT = \angle OQP$ and
\[
\frac{QT}{PS} = \frac{CQ}{CP}. \tag{1}
\]

Let $\ell$ be the perpendicular bisector of chord $CR$; of course, $\ell$ passes through the circumcenter $O$. Due to the equal angles at $P$ and $Q$, triangle $OPQ$ is isosceles with $OP = OQ$. Then line $\ell$ is the axis of symmetry in this triangle as well. Therefore, points $P$ and $Q$ lie symmetrically on line segment $CR$,
\[
RP = CQ \quad \text{and} \quad RQ = CP. \tag{2}
\]

Triangles $RQT$ and $RPS$ have equal angles at vertices $Q$ and $P$, respectively. Then
\[
\frac{\text{area}(RQT)}{\text{area}(RPS)} = \frac{\frac{1}{2} \cdot RQ \cdot QT \cdot \sin \angle RQT}{\frac{1}{2} \cdot RP \cdot PS \cdot \sin \angle RPS} = \frac{RQ}{RP} \cdot \frac{QT}{PS}.
\]

Substituting (1) and (2),
\[
\frac{\text{area}(RQT)}{\text{area}(RPS)} = \frac{RQ}{RP} \cdot \frac{QT}{PS} = \frac{CP}{CQ} \cdot \frac{CQ}{CP} = 1.
\]

Hence, $\text{area}(RQT) = \text{area}(RPS)$.",2,"With points defined as in the original problem, prove the following geometric relationships: (i) QT/PS = CQ/CP, (ii) RP = CQ, and (iii) RQ = CP.","Triangles CTQ and CSP are right-angled at T and S. Since CR is the angle bisector of ∠C, ∠TCQ = ∠SCP. Therefore, △CTQ ~ △CSP. This similarity implies QT/PS = CQ/CP and ∠CQT = ∠CPS. Let O be the circumcenter. P lies on the perpendicular bisector of BC (line OS) and Q lies on the perpendicular bisector of CA (line OT). The angle ∠OPQ is the angle between line OS and line CR, which is ∠CPS. Similarly, ∠OQP is ∠CQT. Thus, ∠OPQ = ∠OQP, which means △OPQ is isosceles with OP = OQ. The perpendicular bisector of chord CR passes through O and must also be the perpendicular bisector of segment PQ. Reflection across this common perpendicular bisector maps C to R and P to Q. Since reflections preserve distance, it follows that CP = RQ and CQ = RP.","In triangle $ABC$, the angle bisector at vertex $C$ intersects the circumcircle and the perpendicular bisectors of sides $BC$ and $CA$ at points $R$, $P$, and $Q$, respectively. The midpoints of $BC$ and $CA$ are $S$ and $T$, respectively. Prove that triangles $RQT$ and $RPS$ have the same area.","The ratio of the areas of triangles RQT and RPS is given by (Area(RQT))/(Area(RPS)) = (1/2 * RQ * QT * sin(∠RQT)) / (1/2 * RP * PS * sin(∠RPS)). From the similarity of △CTQ and △CSP established in the previous step, we have ∠CQT = ∠CPS. Since ∠RQT and ∠RPS are the supplements of ∠CQT and ∠CPS respectively, we have ∠RQT = ∠RPS, and thus sin(∠RQT) = sin(∠RPS). The ratio simplifies to (RQ * QT) / (RP * PS). Using the relationships from the first sub-problem (RQ = CP, RP = CQ, and QT/PS = CQ/CP), we substitute into the ratio: (CP * QT) / (CQ * PS) = (CP/CQ) * (QT/PS) = (CP/CQ) * (CQ/CP) = 1. Therefore, the areas are equal.",,,,
2007g2,"Given an isosceles triangle $ABC$ with $AB = AC$. The midpoint of side $BC$ is denoted by $M$. Let $X$ be a variable point on the shorter arc $MA$ of the circumcircle of triangle $ABM$. Let $T$ be the point in the angle domain $BMA$, for which $\angle TMX = 90^\circ$ and $TX = BX$. Prove that $\angle MTB - \angle CTM$ does not depend on $X$.","Let $N$ be the midpoint of segment $BT$ (see Figure 1). Line $XN$ is the axis of symmetry in the isosceles triangle $BXT$, thus $\angle TNX = 90^\circ$ and $\angle BXN = \angle NXT$. Moreover, in triangle $BCT$, line $MN$ is the midline parallel to $CT$; hence $\angle CTM = \angle NMT$.

Due to the right angles at points $M$ and $N$, these points lie on the circle with diameter $XT$. Therefore,
\[
\angle MTB = \angle MTN = \angle MXN \quad \text{and} \quad \angle CTM = \angle NMT = \angle NXT = \angle BXN.
\]
Hence
\[
\angle MTB - \angle CTM = \angle MXN - \angle BXN = \angle MXB = \angle MAB,
\]
which does not depend on $X$.",2,Let N be the midpoint of segment BT. Show that $\angle MTB = \angle MXN$ and $\angle CTM = \angle BXN$.,"Since $TX = BX$, triangle $BXT$ is isosceles. As N is the midpoint of the base $BT$, $XN$ is the axis of symmetry, which implies $XN \perp BT$ and $XN$ bisects $\angle BXT$. Thus, $\angle TNX = 90^\circ$ and $\angle BXN = \angle NXT$. We are given $\angle TMX = 90^\circ$. The right angles at $M$ and $N$ subtend the segment $XT$, so the points $M, N, X, T$ are concyclic (lie on a circle with diameter $XT$). In this circle, angles subtended by the same arc are equal, so $\angle MTB = \angle MTN = \angle MXN$. In triangle $BCT$, since $M$ and $N$ are midpoints of $BC$ and $BT$ respectively, $MN$ is a midline parallel to $CT$. Therefore, $\angle CTM = \angle NMT$. Back in the cyclic quadrilateral $MNXT$, we have $\angle NMT = \angle NXT$. Combining our angle equalities, we get $\angle CTM = \angle NMT = \angle NXT = \angle BXN$.",Prove that $\angle MTB - \angle CTM$ does not depend on $X$.,"From the first sub-problem, we established that $\angle MTB = \angle MXN$ and $\angle CTM = \angle BXN$. Subtracting the second equality from the first gives $\angle MTB - \angle CTM = \angle MXN - \angle BXN = \angle MXB$. The point $X$ lies on the circumcircle of triangle $ABM$. Therefore, the inscribed angle $\angle MXB$ subtends the fixed arc $MB$. Its measure is equal to the measure of any other inscribed angle subtending the same arc, for instance, $\angle MAB$. Since the points A, B, and M are fixed, the angle $\angle MAB$ is constant. Thus, $\angle MTB - \angle CTM$ is constant and does not depend on $X$.",,,,
2007g3,"The diagonals of a trapezoid $ABCD$ intersect at point $P$. Point $Q$ lies between the parallel lines $BC$ and $AD$ such that $\angle AQD = \angle CQB$, and line $CD$ separates points $P$ and $Q$. Prove that $\angle BQP = \angle DAQ$.","\textbf{Solution.} Let $t = \frac{AD}{BC}$. Consider the homothety $h$ with center $P$ and scale $-t$. Triangles $PDA$ and $PBC$ are similar with ratio $t$, hence $h(B) = D$ and $h(C) = A$.

\begin{center}
\includegraphics[width=0.6\textwidth]{figure_g3_main.png}
\end{center}

Let $Q' = h(Q)$ (see Figure 1). Then points $Q$, $P$ and $Q'$ are obviously collinear. Points $Q$ and $P$ lie on the same side of $AD$, as well as on the same side of $BC$; hence $Q'$ and $P$ are also on the same side of $h(BC) = AD$, and therefore $Q$ and $Q'$ are on the same side of $AD$. Moreover, points $Q$ and $C$ are on the same side of $BD$, while $Q'$ and $A$ are on the opposite side (see Figure above).

By the homothety, $\angle AQ'D = \angle CQB = \angle AQD$, hence quadrilateral $AQ'QD$ is cyclic. Then
\[
\angle DAQ = \angle DQ'Q = \angle DQ'P = \angle BQP
\]
(the latter equality is valid by the homothety again).

\vspace{1em}
\textbf{Comment.} The statement of the problem is a limit case of the following result.\\

\textit{In an arbitrary quadrilateral $ABCD$, let $p = AC \cap BD$, $I = AD \cap BC$, and let $Q$ be an arbitrary point which is not collinear with any two of points $A, B, C, D$. Then $\angle AQD = \angle CQB$ if and only if $\angle BQP = \angle DQA$ (angles are oriented; see Figure below to the left).}

In the special case of the trapezoid, $I$ is an ideal point and $\angle DAQ = \angle IQA = \angle BQP$.

\begin{center}
\includegraphics[width=0.45\textwidth]{figure_g3_comment1.png}
\hfill
\includegraphics[width=0.45\textwidth]{figure_g3_comment2.png}

\small Left: general quadrilateral case \hspace{0.25\textwidth} Right: proof with bisectors
\end{center}

Let $a = QA$, $b = QB$, $c = QC$, $d = QD$, $i = QI$ and $p = QP$. Let line $QA$ intersect lines $BC$ and $BD$ at points $U$ and $V$, respectively. On lines $BC$ and $BD$ we have
\[
(abci) = (UBCI) \quad \text{and} \quad (badp) = (abpd) = (VBPD).
\]

Projecting from $A$, we get
\[
(abci) = (UBCI) = (VBPD) = (badp).
\]

Suppose that $\angle AQD = \angle CQB$. Let line $p'$ be the reflection of line $i$ about the bisector of angle $\angle AQB$. Then by symmetry we have $(badp') = (abci) = (badp)$. Hence $p = p'$, as desired.

The converse statement can be proved analogously.",3,"Let $P$ be the intersection of the diagonals of a trapezoid $ABCD$ with $AD \parallel BC$. Define a homothety $h$ with center $P$ that maps point $B$ to $D$. For any point $Q$, let $Q' = h(Q)$. Show that $\angle AQ'D = \angle CQB$.","Since $AD \parallel BC$, triangles $PDA$ and $PBC$ are similar. The homothety $h$ with center $P$ that maps $B$ to $D$ must have a scale factor of $k = -PD/PB = -AD/BC$. This homothety also maps $C$ to $A$. Therefore, triangle $CQB$ is mapped to triangle $AQ'D$ under $h$. Homothety preserves angles, so the corresponding angles are equal. Thus, $\angle AQ'D = \angle CQB$.","Using the setup from the first problem, let $Q'$ be the image of $Q$ under the homothety $h$. Given that $\angle AQD = \angle CQB$, prove that the quadrilateral $AQ'QD$ is cyclic.","From the previous sub-problem, we established that $\angle AQ'D = \angle CQB$. We are given that $\angle AQD = \angle CQB$. This implies $\angle AQ'D = \angle AQD$. Since point $Q$ is between the parallel lines containing $AD$ and $BC$, and $P$ is the center of homothety, it can be shown that $Q$ and $Q'$ lie on the same side of the line $AD$. The equality of angles $\angle AQ'D$ and $\angle AQD$ therefore proves that the points $A, Q', Q, D$ lie on a circle, meaning $AQ'QD$ is a cyclic quadrilateral.","The diagonals of a trapezoid $ABCD$ intersect at point $P$. Point $Q$ lies between the parallel lines $BC$ and $AD$ such that $\angle AQD = \angle CQB$, and line $CD$ separates points $P$ and $Q$. Prove that $\angle BQP = \angle DAQ$.","Let $h$ be the homothety with center $P$ mapping $B$ to $D$ and $C$ to $A$, and let $Q' = h(Q)$. As established in the previous step, the given conditions imply that $AQ'QD$ is a cyclic quadrilateral. By the definition of homothety, points $Q, P, Q'$ are collinear. Since $AQ'QD$ is cyclic, we have $\angle DAQ = \angle DQ'Q$ as they subtend the same arc $DQ$. Because $Q, P, Q'$ are collinear, $\angle DQ'Q = \angle DQ'P$. The homothety $h$ maps the angle $\angle BQP$ to the angle $\angle DQ'P$, so they are equal. Chaining these equalities gives $\angle DAQ = \angle DQ'Q = \angle DQ'P = \angle BQP$.",,
2007g4,"Consider five points $A, B, C, D, E$ such that $ABCD$ is a parallelogram and $BCED$ is a cyclic quadrilateral. Let $\ell$ be a line passing through $A$, and let $\ell$ intersect segment $DC$ and line $BC$ at points $F$ and $G$, respectively. Suppose that $EF = EG = EC$. Prove that $\ell$ is the bisector of angle $\angle DAB$.","\textbf{Solution.} If $CF = CG$, then $\angle FGC = \angle CGF$, hence $\angle GAB = \angle GFC = \angle FGC = \angle FAD$, and $\ell$ is a bisector.

Assume that $CF < GC$. Let $EK$ and $EL$ be the altitudes in the isosceles triangles $ECF$ and $EGC$, respectively. Then in the right triangles $EKF$ and $ELC$ we have $EF = EC$ and
\[
KF = \frac{CF}{2} < \frac{GC}{2} = LC,
\]
so
\[
KE = \sqrt{EF^2 - KF^2} > \sqrt{EC^2 - LC^2} = LE.
\]

Since quadrilateral $BCED$ is cyclic, we have $\angle EDC = \angle EBC$, so the right triangles $BEL$ and $DEK$ are similar. Then $KE > LE$ implies $DK > BL$, and hence
\[
DF = DK - KF > BL - LC = BC = AD.
\]

But triangles $ADF$ and $GCF$ are similar, so we have 
\[
1 > \frac{AD}{DF} = \frac{GC}{CF};
\]
this contradicts our assumption.

The case $CF > GC$ is completely similar. We consequently obtain the converse inequalities
\[
KF > LC,\quad KE < LE,\quad DK < BL,\quad DF < AD,\quad \text{hence } 1 < \frac{AD}{DF} = \frac{GC}{CF},
\]
a contradiction.",2,"Given that $ABCD$ is a parallelogram, $BCED$ is a cyclic quadrilateral, line $\ell$ passes through A intersecting segment $DC$ at $F$ and line $BC$ at $G$, and $EF=EG=EC$, prove that $CF=CG$.","We prove this by contradiction. Assume $CF \neq CG$, for instance $CF < GC$. Let $EK$ and $EL$ be the altitudes from $E$ in the isosceles triangles $ECF$ and $EGC$. Then $K$ and $L$ are the midpoints of $CF$ and $GC$ respectively. So, $KF = CF/2 < GC/2 = LC$. From the right triangles $EKF$ and $ELC$, since $EF = EC$, we have $KE = \sqrt{EF^2 - KF^2} > \sqrt{EC^2 - LC^2} = LE$. As $BCED$ is a cyclic quadrilateral, $\angle EDC = \angle EBC$, which implies that the right triangles $DEK$ and $BEL$ are similar. From $KE > LE$, it follows that $DK > BL$. This leads to $DF > AD$. However, since $AD \parallel BC$, triangles $ADF$ and $GCF$ are similar, so $AD/DF = GC/CF$. Since $DF > AD$, this implies $GC/CF < 1$, which contradicts our assumption $CF < GC$. A similar argument for $CF > GC$ also leads to a contradiction. Therefore, we must have $CF = CG$.","Consider five points $A, B, C, D, E$ such that $ABCD$ is a parallelogram and $BCED$ is a cyclic quadrilateral. Let $\ell$ be a line passing through $A$, and let $\ell$ intersect segment $DC$ and line $BC$ at points $F$ and $G$, respectively. Suppose that $EF = EG = EC$. Prove that $\ell$ is the bisector of angle $\angle DAB$.","From the first sub-problem, we established that $CF = CG$. This implies that triangle $FGC$ is isosceles, and thus its base angles are equal: $\angle CFG = \angle CGF$. Since $ABCD$ is a parallelogram, we have parallel sides: $AB \parallel DC$ and $AD \parallel BC$. Because $AB \parallel DC$, the alternate interior angles are equal: $\angle GAB = \angle CFG$. Because $AD \parallel BC$, we also have $\angle FAD = \angle CGF$. Combining these equalities, we get $\angle GAB = \angle CFG = \angle CGF = \angle FAD$. Therefore, $\angle GAB = \angle FAD$, which means that the line $\ell$ is the bisector of $\angle DAB$.",,,,
2007g5,"Let $ABC$ be a fixed triangle, and let $A_1, B_1, C_1$ be the midpoints of sides $BC$, $CA$, $AB$, respectively. Let $P$ be a variable point on the circumcircle. Let lines $PA_1$, $PB_1$, $PC_1$ meet the circumcircle again at $A'$, $B'$, $C'$ respectively. Assume that the points $A$, $B$, $C$, $A'$, $B'$, $C'$ are distinct, and lines $A'A''$, $B'B''$, $C'C''$ form a triangle. Prove that the area of this triangle does not depend on $P$.","Let $A_0$, $B_0$, $C_0$ be the points of intersection of the lines $A'A_1$, $B'B_1$ and $C'C_1$ (see Figure). We claim that $\text{area}(A_0B_0C_0) = \frac{1}{2} \text{area}(ABC)$, hence it is constant.

Consider the inscribed hexagon $ABCC'PA'$. By Pascal's theorem, the points of intersection of its opposite sides (or their extensions) are collinear. These points are $AB \cap C'P = C_1$, $BC \cap PA' = A_1$, $CC' \cap A'A = B_0$. So point $B_0$ lies on the midline $A_1C_1$ of triangle $ABC$. Analogously, points $A_0$ and $C_0$ lie on lines $B_1C_1$ and $A_1B_1$, respectively.

Lines $AC$ and $A_1C_1$ are parallel, so triangles $B_0C_0A_1$ and $AC_0B_1$ are similar; hence we have
\[
\frac{B_0C_0}{AC_0} = \frac{A_1C_0}{B_1C_0}.
\]
Analogously, from $B_0 \in B_1C_1$ we obtain
\[
\frac{A_1C_0}{B_1C_0} = \frac{B_0C_0}{A_0C_0}.
\]
Combining these equalities, we get
\[
A_0C_0 \cdot B_0C_0 = AC_0 \cdot BC_0.
\]

Hence we have
\[
\text{area}(A_0B_0C_0) = \frac{1}{2} A_0C_0 \cdot B_0C_0 \sin \angle A_0C_0B_0 = \frac{1}{2} AC_0 \cdot BC_0 \sin \angle AC_0B = \text{area}(ABC_0).
\]

Since $C_0$ lies on the midline, we have $d(C_0, AB) = \frac{1}{2} d(C, AB)$ (we denote by $d(X,YZ)$ the distance between point $X$ and line $YZ$). Then we obtain
\[
\text{area}(A_0B_0C_0) = \text{area}(ABC_0) = \frac{1}{2} AB \cdot d(C_0, AB) = \frac{1}{4} AB \cdot d(C, AB) = \frac{1}{2} \text{area}(ABC).
\]",2,"Let the triangle in question be formed by the lines $A'A, B'B, C'C$. Let its vertices be $A_0 = B'B \cap C'C$, $B_0 = C'C \cap A'A$, and $C_0 = A'A \cap B'B$. Prove that the vertices $A_0, B_0, C_0$ lie on the midlines of triangle $ABC$.","Consider the hexagon $ABCC'PA'$ inscribed in the circumcircle. By Pascal's theorem, the intersections of its three pairs of opposite sides are collinear. These intersection points are $AB \cap PC' = C_1$, $BC \cap PA' = A_1$, and $CC' \cap A'A = B_0$. The collinearity of $A_1, C_1, B_0$ implies that vertex $B_0$ lies on the midline $A_1C_1$ of $\triangle ABC$. By applying Pascal's theorem to hexagons $BCAA'PB'$ and $CABB'PC'$ in a similar manner, we can show that vertex $C_0$ lies on midline $A_1B_1$ and vertex $A_0$ lies on midline $B_1C_1$.","Let $ABC$ be a fixed triangle, and let $A_1, B_1, C_1$ be the midpoints of sides $BC$, $CA$, $AB$, respectively. Let $P$ be a variable point on the circumcircle. Let lines $PA_1$, $PB_1$, $PC_1$ meet the circumcircle again at $A'$, $B'$, $C'$ respectively. Assume that the points $A$, $B$, $C$, $A'$, $B'$, $C'$ are distinct, and lines $A'A$, $B'B$, $C'C$ form a triangle. Prove that the area of this triangle does not depend on $P$.","Let the triangle be $\triangle A_0B_0C_0$. From the previous sub-problem, its vertices lie on the midlines of $\triangle ABC$. Consider vertex $C_0 = A'A \cap B'B$, which lies on the midline $A_1B_1$. Since $A_1B_1$ is parallel to side $AB$, the distance from $C_0$ to line $AB$ is constant and equal to half the altitude from $C$ to $AB$, denoted $h_c/2$. The provided proof establishes the equality $\text{area}(A_0B_0C_0) = \text{area}(ABC_0)$ using similarity arguments based on the parallel lines. Therefore, the area of the triangle is $\text{area}(A_0B_0C_0) = \text{area}(ABC_0) = \frac{1}{2} AB \\cdot d(C_0, AB) = \frac{1}{2} AB \\cdot \frac{h_c}{2} = \frac{1}{2} \text{area}(ABC)$. This value is constant as it depends only on the area of the fixed triangle $ABC$.",,,,
2007g7,"Given an acute triangle $ABC$ with angles $\alpha$, $\beta$ and $\gamma$ at vertices $A$, $B$ and $C$, respectively, such that $\beta > \gamma$. Point $I$ is the incenter, and $R$ is the circumradius. Point $D$ is the foot of the altitude from vertex $A$. Point $K$ lies on line $AD$ such that $AK = 2R$, and $D$ separates $A$ and $K$. Finally, lines $DI$ and $KI$ meet sides $AC$ and $BC$ at $E$ and $F$, respectively.

Prove that if $IE = IF$ then $\beta \le 3\gamma$.","We first prove that
\[
\angle KID = \frac{\beta - \gamma}{2} \tag{1}
\]
even without the assumption that $IE = IF$. Then we will show that the statement of the problem is a consequence of this fact.

Denote the circumcenter by $O$. On the circumcircle, let $P$ be the point opposite to $A$, and let the angle bisector $AI$ intersect the circle again at $M$. Since $AK = AP = 2R$, triangle $AKP$ is isosceles. It is known that $\angle BAD = \angle CAO$, hence
\[
\angle DAI = \angle BAI - \angle BAD = \angle CAI - \angle CAO = \angle OAI,
\]
and $AM$ is the bisector line in triangle $AKP$. Therefore, points $K$ and $P$ are symmetrical about $AM$, and $\angle AMK = \angle AMP = 90^\circ$. Thus, $M$ is the midpoint of $KP$, and $AM$ is the perpendicular bisector of $KP$.

Denote the perpendicular feet of incenter $I$ on lines $BC$, $AC$, and $AD$ by $A_1$, $B_1$, and $T$, respectively. Quadrilateral $DA_1IT$ is a rectangle, hence $TD = IA_1 = IB_1$.

Due to the right angles at $T$ and $B_1$, quadrilateral $AB_1IT$ is cyclic. Hence
\[
\angle B_1TI = \angle B_1AI = \angle CAM = \angle BAM = \angle BPM,
\]
and
\[
\angle IB_1T = \angle IAT = \angle MAK = \angle MAP = \angle MBP.
\]
Therefore, triangles $B_1TI$ and $BPM$ are similar and
\[
\frac{IT}{TD} = \frac{IT}{IB_1} = \frac{MP}{MB} = \frac{KM}{MI}.
\]
Hence, $\angle KIM = \angle IDT = \angle IDA$, and
\[
\angle KID = \angle MID - \angle KIM = (\angle IAD + \angle IDA) - \angle IDA = \angle IAD.
\]

From triangle $ADB$ we compute:
\[
\angle KID = \angle IAD = \angle IAB - \angle DAB = \frac{\alpha}{2} - (90^\circ - \beta) = \frac{\alpha + \beta + \gamma}{2} + \beta = \frac{\beta - \gamma}{2}.
\]

Now suppose that $IE = IF$. Since $IA_1 = IB_1$, the right triangles $IEB_1$ and $IFA_1$ are congruent, and $\angle IEB_1 = \angle IFA_1$. Since $\beta > \gamma$, $A_1$ lies in the interior of segment $CD$ and $F$ lies in the interior of $AD$. Hence, $\angle IFC$ is acute. There are two possible cases based on the order of points $A$, $C$, $B_1$, and $E$:

- If $E$ lies between $C$ and $B_1$, then $\angle IFC = \angle IEA$, and quadrilateral $CEIF$ is cyclic:
\[
\angle FCE = 180^\circ - \angle EIF = \angle KID.
\]
Using (1), we get $\angle FCE = \gamma = \angle KID = \frac{\beta - \gamma}{2} \Rightarrow \beta = 3\gamma$.

- If $E$ lies between $A$ and $B_1$, then $CEIF$ is a deltoid with $\angle IEC = \angle IFC < 90^\circ$:
\[
\angle FCE > 180^\circ - \angle EIF = \angle KID \Rightarrow \gamma > \frac{\beta - \gamma}{2} \Rightarrow \beta < 3\gamma.
\]
",1,"Given an acute triangle $ABC$ with angles $\alpha$, $\beta$ and $\gamma$ at vertices $A$, $B$ and $C$, respectively, such that $\beta > \gamma$. Point $I$ is the incenter, and $R$ is the circumradius. Point $D$ is the foot of the altitude from vertex $A$. Point $K$ lies on line $AD$ such that $AK = 2R$, and $D$ separates $A$ and $K$. Finally, lines $DI$ and $KI$ meet sides $AC$ and $BC$ at $E$ and $F$, respectively.

Prove that if $IE = IF$ then $\beta \le 3\gamma$.","We first prove that
\[
\angle KID = \frac{\beta - \gamma}{2} \tag{1}
\]
even without the assumption that $IE = IF$. Then we will show that the statement of the problem is a consequence of this fact.

Denote the circumcenter by $O$. On the circumcircle, let $P$ be the point opposite to $A$, and let the angle bisector $AI$ intersect the circle again at $M$. Since $AK = AP = 2R$, triangle $AKP$ is isosceles. It is known that $\angle BAD = \angle CAO$, hence
\[
\angle DAI = \angle BAI - \angle BAD = \angle CAI - \angle CAO = \angle OAI,
\]
and $AM$ is the bisector line in triangle $AKP$. Therefore, points $K$ and $P$ are symmetrical about $AM$, and $\angle AMK = \angle AMP = 90^\circ$. Thus, $M$ is the midpoint of $KP$, and $AM$ is the perpendicular bisector of $KP$.

Denote the perpendicular feet of incenter $I$ on lines $BC$, $AC$, and $AD$ by $A_1$, $B_1$, and $T$, respectively. Quadrilateral $DA_1IT$ is a rectangle, hence $TD = IA_1 = IB_1$.

Due to the right angles at $T$ and $B_1$, quadrilateral $AB_1IT$ is cyclic. Hence
\[
\angle B_1TI = \angle B_1AI = \angle CAM = \angle BAM = \angle BPM,
\]
and
\[
\angle IB_1T = \angle IAT = \angle MAK = \angle MAP = \angle MBP.
\]
Therefore, triangles $B_1TI$ and $BPM$ are similar and
\[
\frac{IT}{TD} = \frac{IT}{IB_1} = \frac{MP}{MB} = \frac{KM}{MI}.
\]
Hence, $\angle KIM = \angle IDT = \angle IDA$, and
\[
\angle KID = \angle MID - \angle KIM = (\angle IAD + \angle IDA) - \angle IDA = \angle IAD.
\]

From triangle $ADB$ we compute:
\[
\angle KID = \angle IAD = \angle IAB - \angle DAB = \frac{\alpha}{2} - (90^\circ - \beta) = \frac{\alpha + \beta + \gamma}{2} + \beta = \frac{\beta - \gamma}{2}.
\]

Now suppose that $IE = IF$. Since $IA_1 = IB_1$, the right triangles $IEB_1$ and $IFA_1$ are congruent, and $\angle IEB_1 = \angle IFA_1$. Since $\beta > \gamma$, $A_1$ lies in the interior of segment $CD$ and $F$ lies in the interior of $AD$. Hence, $\angle IFC$ is acute. There are two possible cases based on the order of points $A$, $C$, $B_1$, and $E$:

- If $E$ lies between $C$ and $B_1$, then $\angle IFC = \angle IEA$, and quadrilateral $CEIF$ is cyclic:
\[
\angle FCE = 180^\circ - \angle EIF = \angle KID.
\]
Using (1), we get $\angle FCE = \gamma = \angle KID = \frac{\beta - \gamma}{2} \Rightarrow \beta = 3\gamma$.

- If $E$ lies between $A$ and $B_1$, then $CEIF$ is a deltoid with $\angle IEC = \angle IFC < 90^\circ$:
\[
\angle FCE > 180^\circ - \angle EIF = \angle KID \Rightarrow \gamma > \frac{\beta - \gamma}{2} \Rightarrow \beta < 3\gamma.
\]
",,,,,,
2007g8,"Point $P$ lies on side $AB$ of a convex quadrilateral $ABCD$. Let $\omega$ be the incircle of triangle $CPD$, and let $I$ be its incenter. Suppose that $\omega$ is tangent to the incircles of triangles $APD$ and $BPC$ at points $K$ and $L$, respectively. Let lines $AC$ and $BD$ meet at $E$, and let lines $AK$ and $BL$ meet at $F$. Prove that points $E$, $I$, and $F$ are collinear.","\textbf{Solution.} Let $\Omega$ be the circle tangent to segment $AB$ and to rays $AD$ and $BC$; let $J$ be its center. We prove that points $E$ and $F$ lie on line $IJ$.

\begin{center}
\includegraphics[width=0.55\textwidth]{figure_g8_main.png}
\end{center}

Denote the incircles of triangles $ADP$ and $BCP$ by $\omega_A$ and $\omega_B$. Let $h_1$ be the homothety with a negative scale taking $\omega$ to $\Omega$. Consider this homothety as the composition of two homotheties: one taking $\omega$ to $\omega_A$ (with a negative scale and center $K$), and another one taking $\omega_A$ to $\Omega$ (with a positive scale and center $A$). It is known that in such a case the three centers of homothety are collinear (this theorem is also referred to as the theorem on the three similitude centers). Hence, the center of $h_1$ lies on line $AK$. Analogously, it also lies on $BL$, so this center is $F$. Hence, $F$ lies on the line of centers of $\omega$ and $\Omega$, i.e. on $IJ$ (if $I = J$, then $F = I$ as well, and the claim is obvious).

Consider the homothety $h_2$ with a positive scale taking $\omega$ to $\Omega$. Consider $h_2$ as the composition of two homotheties: taking $\omega$ to $\Omega_A$ (with a positive scale and center $C$), and taking $\Omega_A$ to $\Omega$ (with a positive scale and center $A$), respectively. So the center of $h_2$ lies on line $AC$. By analogous reasoning, it lies also on $BD$, hence this center is $E$. Thus, $E$ also lies on the line of centers $IJ$, and the claim is proved.

\vspace{1em}
\textbf{Comment.} In both main steps of the solution, there can be several different reasonings for the same claims. For instance, one can mostly use Desargues锟斤拷锟?theorem instead of the three homotheties theorem. Namely, if $I_A$ and $I_B$ are the centers of $\omega_A$ and $\omega_B$, then lines $I_AI_B$, $KL$ and $AB$ are concurrent (by the theorem on three similitude centers applied to $\omega$, $\omega_A$ and $\omega_B$). Then Desargues锟斤拷锟?theorem, applied to triangles $AI_AK$ and $BI_BL$, yields that the points $J = AI_A \cap BI_B$, $I = I_AK \cap I_BL$ and $F = AK \cap BL$ are collinear.

For the second step, let $J_A$ and $J_B$ be the centers of $\Omega_A$ and $\Omega_B$. Then lines $J_AJ_B$, $AB$ and $CD$ are concurrent, since they appear to be the two common tangents and the line of centers of $\Omega_A$ and $\Omega_B$. Applying Desargues锟斤拷锟?theorem to triangles $AJ_AC$ and $BJ_BD$, we obtain that the points $J = AJ_A \cap BJ_B$, $I = CJ_A \cap DJ_B$ and $E = AC \cap BD$ are collinear.",3,"Let $\omega$ be the incircle of $\triangle CPD$ with incenter $I$. Let $\Omega$ be a circle tangent to segment $AB$ and rays $AD$ and $BC$, with center $J$. Let lines $AK$ and $BL$ meet at $F$. Prove that $F$ lies on the line $IJ$.","Let $\omega_A$ and $\omega_B$ be the incircles of $\triangle APD$ and $\triangle BPC$ respectively. Consider the homothety with a negative scale taking $\omega$ to $\Omega$. This homothety can be decomposed as a composition of a homothety centered at $K$ taking $\omega$ to $\omega_A$, and a homothety centered at $A$ taking $\omega_A$ to $\Omega$. By the theorem on three similitude centers, the center of the composite homothety lies on line $AK$. Similarly, it can be decomposed using $\omega_B$, with centers $L$ and $B$, which implies the center also lies on $BL$. Thus, the center of homothety is $F = AK \cap BL$. Since this homothety maps $\omega$ to $\Omega$, its center $F$ must lie on the line of centers $IJ$.","Let $\omega$ be the incircle of $\triangle CPD$ with incenter $I$, and $\Omega$ be the circle from the previous problem with center $J$. Let lines $AC$ and $BD$ meet at $E$. Prove that $E$ lies on the line $IJ$.","Consider the homothety with a positive scale taking $\omega$ to $\Omega$. This can be expressed as a composition of a homothety centered at $C$ (taking $\omega$ to an intermediate circle) and a homothety centered at $A$ (taking the intermediate circle to $\Omega$). By the theorem on three similitude centers, the center of this composite homothety lies on line $AC$. Analogously, by composing homotheties centered at $D$ and $B$, the center must also lie on line $BD$. Therefore, the center of the homothety taking $\omega$ to $\Omega$ is $E = AC \cap BD$. As the center of a homothety mapping two circles, $E$ must lie on the line of centers $IJ$.","Point $P$ lies on side $AB$ of a convex quadrilateral $ABCD$. Let $\omega$ be the incircle of triangle $CPD$, and let $I$ be its incenter. Suppose that $\omega$ is tangent to the incircles of triangles $APD$ and $BPC$ at points $K$ and $L$, respectively. Let lines $AC$ and $BD$ meet at $E$, and let lines $AK$ and $BL$ meet at $F$. Prove that points $E$, $I$, and $F$ are collinear.","Let $\Omega$ be the circle tangent to segment $AB$ and rays $AD$ and $BC$, and let its center be $J$. From sub-problem 1, point $F$ lies on the line $IJ$. From sub-problem 2, point $E$ lies on the line $IJ$. By definition, point $I$ also lies on the line $IJ$. Since points $E$, $I$, and $F$ all lie on the same line $IJ$, they are collinear.",,
2007n3,"Let $X$ be a set of 10,000 integers, none of them is divisible by 47. Prove that there exists a 2007-element subset $Y$ of $X$ such that $a - b + c - d + e$ is not divisible by 47 for any $a, b, c, d, e \in Y$.","\textbf{Solution.} Call a set $M$ of integers \textit{good} if $47 \nmid a - b + c - d + e$ for any $a, b, c, d, e \in M$.

Consider the set $J = \{-9, -7, -5, -3, -1, 1, 3, 5, 7, 9\}$. We claim that $J$ is good. Actually, for any $a, b, c, d, e \in J$ the number $a - b + c - d + e$ is odd and
\[
-45 = (-9) - 9 + (-9) - 9 + (-9) \le a - b + c - d + e \le 9 - (-9) + 9 - (-9) + 9 = 45.
\]
But there is no odd number divisible by 47 between $-45$ and $45$.

For any $k = 1, \ldots, 46$ consider the set
\[
A_k = \{x \in X \mid \exists j \in J : kx \equiv j \pmod{47}\}.
\]
If $A_k$ is not good, then $47 \mid a - b + c - d + e$ for some $a, b, c, d, e \in A_k$, hence $47 \mid ka - kb + kc - kd + ke$. But set $J$ contains numbers with the same residues modulo 47, so $J$ also is not good. This is a contradiction; therefore, each $A_k$ is a good subset of $X$.

Then it suffices to prove that there exists a number $k$ such that $|A_k| \ge 2007$. Note that each $x \in X$ is contained in exactly 10 sets $A_k$. Then
\[
\sum_{k=1}^{46} |A_k| = 10|X| = 100{,}000,
\]
hence for some value of $k$ we have
\[
|A_k| \ge \frac{100{,}000}{46} > 2173 > 2007.
\]
This completes the proof.

\vspace{1em}
\textbf{Comment.} For the solution, it is essential to find a good set consisting of 10 different residues. Actually, consider a set $X$ containing almost uniform distribution of the nonzero residues (i.e., each residue occurs 217 or 218 times). Let $Y \subset X$ be a good subset containing 2007 elements. Then the set $K$ of all residues appearing in $Y$ contains not less than 10 residues, and obviously this set is good.

On the other hand, there is no good set $K$ consisting of 11 different residues. The Cauchy锟斤拷锟紻avenport theorem claims that for any sets $A$, $B$ of residues modulo a prime $p$,
\[
|A + B| \ge \min\{p, |A| + |B| - 1\}.
\]

Hence, if $|K| \ge 11$, then $|K + K| \ge 21$, $|K + K + K| \ge 31 > 47 - |K + K|$, hence $|K + K + K + (-K) + (-K)| = 47$, and $0 \equiv a + c + e - b - d \pmod{47}$ for some $a, b, c, d, e \in K$.

From this reasoning alone, one can see that a good set $K$ containing 10 residues should satisfy equalities $|K + K| = 19 = 2|K| - 1$ and $|K + K + K| = 28 = |K + K| + |K| - 1$. It can be proved that in this case set $K$ consists of 10 residues forming an arithmetic progression. As an easy consequence, one obtains that set $K$ has the form $aJ$ for some nonzero residue $a$.",4,"Let $J = \{-9, -7, -5, -3, -1, 1, 3, 5, 7, 9\}$. Prove that for any choice of $a, b, c, d, e \in J$, the value $a - b + c - d + e$ is not divisible by 47.","For any $a, b, c, d, e \in J$, the sum $S = a - b + c - d + e$ is an odd integer. The range of S is bounded by its minimum value, $(-9)-9+(-9)-9+(-9) = -45$, and its maximum value, $9-(-9)+9-(-9)+9 = 45$. There is no odd multiple of 47 in the interval $[-45, 45]$, so $S$ is not divisible by 47.","A set $M$ is called 'good' if $a - b + c - d + e$ is not divisible by 47 for any $a, b, c, d, e \in M$. Let $J$ be the set from the previous step. For each $k \in \{1, ..., 46\}$, define $A_k = \{x \in X \mid kx \pmod{47} \in J\}$. Prove that each set $A_k$ is good.","Assume for contradiction that some $A_k$ is not good. Then there exist $a, b, c, d, e \in A_k$ such that $a - b + c - d + e \equiv 0 \pmod{47}$. Since $k$ is not a multiple of 47, we can multiply by $k$ to get $k(a - b + c - d + e) \equiv 0 \pmod{47}$. By the definition of $A_k$, for each $x \in \{a,b,c,d,e\}$, there is a $j_x \in J$ such that $kx \equiv j_x \pmod{47}$. Thus, $j_a - j_b + j_c - j_d + j_e \equiv 0 \pmod{47}$, which contradicts that no such sum for elements in $J$ is divisible by 47. Therefore, each $A_k$ must be good.","Let $X$ be a set of 10,000 integers not divisible by 47. Let $J$ be a set of 10 distinct non-zero residues modulo 47. For $k \in \{1, ..., 46\}$, define $A_k = \{x \in X \mid kx \pmod{47} \in J\}$. Prove that the sum of the sizes of these sets is $\sum_{k=1}^{46} |A_k| = 10 \cdot |X|$.","We compute the sum by changing the order of summation: $\sum_{k=1}^{46} |A_k| = \sum_{k=1}^{46} \sum_{x \in X} \mathbf{1}_{A_k}(x) = \sum_{x \in X} \sum_{k=1}^{46} \mathbf{1}_{kx \pmod{47} \in J}$. For any fixed $x \in X$ (where $47 \nmid x$), the set of products $\{kx \pmod{47} \mid k=1, ..., 46\}$ covers all 46 non-zero residues modulo 47 exactly once. Since $|J|=10$, for each $x$, the condition $kx \pmod{47} \in J$ is met for exactly 10 values of $k$. Thus, the inner sum is 10 for every $x \in X$. The total sum is $\sum_{x \in X} 10 = 10 \cdot |X| = 100,000$.","Let $X$ be a set of 10,000 integers, none of them is divisible by 47. Prove that there exists a 2007-element subset $Y$ of $X$ such that $a - b + c - d + e$ is not divisible by 47 for any $a, b, c, d, e \in Y$.","From the previous steps, we have 46 'good' sets $A_k$, and the sum of their sizes is $\sum_{k=1}^{46} |A_k| = 100,000$. By the pigeonhole principle, there must be at least one set, say $A_{k_0}$, with size at least the average size: $|A_{k_0}| \ge \frac{100,000}{46} > 2173$. Since $2173 > 2007$, this set $A_{k_0}$ contains a 2007-element subset, let's call it $Y$. As $A_{k_0}$ is a good set, any of its subsets, including $Y$, must also be good. This completes the proof."
2007n4,"For every integer $k \ge 2$, prove that $2^{3k}$ divides the number
\[
\binom{2^{k+1}}{2^k} - \binom{2^k}{2^{k-1}}
\tag{1}
\]
but $2^{3k+1}$ does not. \hfill \textit{(Poland)}","\textbf{Solution.} We use the notation $(2n - 1)!! = 1 \cdot 3 \cdots (2n - 1)$ and $(2n)!! = 2 \cdot 4 \cdots (2n) = 2^n n!$ for any positive integer $n$. Observe that
\[
(2n)! = (2n)!! \cdot (2n - 1)!! = 2^n n! \cdot (2n - 1)!!.
\]

For any positive integer $n$ we have
\[
\binom{4n}{2n} = \frac{(4n)!}{(2n)!^2} = \frac{2^{2n}(2n)! \cdot (4n - 1)!!}{2^{2n}(n!)^2} = \frac{2^{2n}(2n)! \cdot (4n - 1)!!}{(2n)!^2} = \frac{2^{2n}}{(2n)!} \cdot (4n - 1)!!,
\]
\[
\binom{2n}{n} = \frac{(2n)!}{(n!)^2} = \frac{(2n)!! \cdot (2n - 1)!!}{(n!)^2} = \frac{2^n n! \cdot (2n - 1)!!}{(n!)^2} = \frac{2^n \cdot (2n - 1)!!}{n!}.
\]

Then expression (1) can be rewritten as follows:
\[
\binom{2^{k+1}}{2^k} - \binom{2^k}{2^{k-1}} = \frac{2^{2^k}}{(2^k)!} \cdot (2^{k+1} - 1)!! - \frac{2^{2^{k-1}}}{(2^{k-1})!} \cdot (2^k - 1)!!.
\]

We simplify further:
\[
= \frac{2^{2^k} (2^{k+1} - 1)!!}{(2^k)!} - \frac{2^{2^{k-1}} (2^k - 1)!!}{(2^{k-1})!}
= \frac{2^{2^k} (2^{k+1} - 1)!!}{(2^k)!} - \text{[smaller term]}.
\]

We compute the exponent of 2 in the prime decomposition of each factor. First, we show by induction on $n$ that the exponent of 2 in $(2n)!$ is $2n - 1$. The base case $n = 1$ is trivial.

Suppose that $(2n)! = 2^{2n - 1}(2d + 1)$ for some integer $d$. Then:
\[
(2n + 1)! = (2n + 1) \cdot (2n)! = (2n + 1) \cdot 2^{2n - 1}(2d + 1) = 2^{2n - 1} \cdot (2n + 1)(2d + 1).
\]

So the exponent increases by 1 for each increment of $n$.

Hence, the exponent of 2 in the first factor in (2) is $2^k - (2^k - 1) = 1$.

The second factor in (2) is a polynomial
\[
P(x) = (x + 1)(x + 3) \cdots (x + 2^k - 1) - (x - 1)(x - 3) \cdots (x - 2^k + 1),
\tag{3}
\]
evaluated at $x = 2^k$.

Note: $P(-x) = -P(x)$ so $P(x)$ is odd and has only odd powers of $x$. Hence,
\[
P(x) = x^3 Q(x) + cx,
\]
where $Q(x)$ has integer coefficients. To find the exponent of 2 in $c$, we compute:
\[
c = 2(2^k - 1)!! \sum_{i=1}^{2^{k-1}} \frac{1}{2i - 1} \cdot \frac{1}{2^k - 2i + 1}.
\]

This simplifies to:
\[
c = (2^k - 1)!! \sum_{i=1}^{2^{k-1}} \frac{2^k}{(2i - 1)(2^k - 2i + 1)} = 2^k (2^k - 1)!! \sum_{i=1}^{2^{k-1}} \frac{1}{(2i - 1)(2^k - 2i + 1)}.
\]

Let
\[
S = \sum_{i=1}^{2^{k-1}} \frac{(2^k - 1)!!}{(2i - 1)(2^k - 2i + 1)}.
\]

Set $a_{2i - 1}$ to be the inverse of $2i - 1$ modulo $2^k$.

Then:
\[
S = \sum_{i=1}^{2^{k-1}} \frac{(2^k - 1)!! a_{2i - 1}^2}{(2i - 1)^2} = - (2^k - 1)!! \sum_{i=1}^{2^{k-1}} (2i - 1)^2 = - (2^k - 1)!! \cdot \frac{2^{k-1}(2^k - 1)}{3} \pmod{2^k}.
\]

Hence, the exponent of 2 in $S$ is $k - 1$, so $c = 2^k \cdot 2^{k - 1} (2t + 1) = 2^{2k - 1}(2t + 1)$.

Finally,
\[
P(2^k) = 2^k Q(2^k)^3 + 2^k c = 2^k Q(2^k)^3 + 2^k \cdot 2^{2k - 1}(2t + 1),
\]
so
\[
P(2^k) \text{ is divisible by } 2^{3k}, \text{ but not by } 2^{3k + 1}.
\]

\vspace{1em}
\textbf{Comment.} The fact that (1) is divisible by $2^{2k}$ is known; but it does not help in solving this problem.
",1,"For every integer $k \ge 2$, prove that $2^{3k}$ divides the number
\[
\binom{2^{k+1}}{2^k} - \binom{2^k}{2^{k-1}}
\tag{1}
\]
but $2^{3k+1}$ does not. \hfill \textit{(Poland)}","\textbf{Solution.} We use the notation $(2n - 1)!! = 1 \cdot 3 \cdots (2n - 1)$ and $(2n)!! = 2 \cdot 4 \cdots (2n) = 2^n n!$ for any positive integer $n$. Observe that
\[
(2n)! = (2n)!! \cdot (2n - 1)!! = 2^n n! \cdot (2n - 1)!!.
\]

For any positive integer $n$ we have
\[
\binom{4n}{2n} = \frac{(4n)!}{(2n)!^2} = \frac{2^{2n}(2n)! \cdot (4n - 1)!!}{2^{2n}(n!)^2} = \frac{2^{2n}(2n)! \cdot (4n - 1)!!}{(2n)!^2} = \frac{2^{2n}}{(2n)!} \cdot (4n - 1)!!,
\]
\[
\binom{2n}{n} = \frac{(2n)!}{(n!)^2} = \frac{(2n)!! \cdot (2n - 1)!!}{(n!)^2} = \frac{2^n n! \cdot (2n - 1)!!}{(n!)^2} = \frac{2^n \cdot (2n - 1)!!}{n!}.
\]

Then expression (1) can be rewritten as follows:
\[
\binom{2^{k+1}}{2^k} - \binom{2^k}{2^{k-1}} = \frac{2^{2^k}}{(2^k)!} \cdot (2^{k+1} - 1)!! - \frac{2^{2^{k-1}}}{(2^{k-1})!} \cdot (2^k - 1)!!.
\]

We simplify further:
\[
= \frac{2^{2^k} (2^{k+1} - 1)!!}{(2^k)!} - \frac{2^{2^{k-1}} (2^k - 1)!!}{(2^{k-1})!}
= \frac{2^{2^k} (2^{k+1} - 1)!!}{(2^k)!} - \text{[smaller term]}.
\]

We compute the exponent of 2 in the prime decomposition of each factor. First, we show by induction on $n$ that the exponent of 2 in $(2n)!$ is $2n - 1$. The base case $n = 1$ is trivial.

Suppose that $(2n)! = 2^{2n - 1}(2d + 1)$ for some integer $d$. Then:
\[
(2n + 1)! = (2n + 1) \cdot (2n)! = (2n + 1) \cdot 2^{2n - 1}(2d + 1) = 2^{2n - 1} \cdot (2n + 1)(2d + 1).
\]

So the exponent increases by 1 for each increment of $n$.

Hence, the exponent of 2 in the first factor in (2) is $2^k - (2^k - 1) = 1$.

The second factor in (2) is a polynomial
\[
P(x) = (x + 1)(x + 3) \cdots (x + 2^k - 1) - (x - 1)(x - 3) \cdots (x - 2^k + 1),
\tag{3}
\]
evaluated at $x = 2^k$.

Note: $P(-x) = -P(x)$ so $P(x)$ is odd and has only odd powers of $x$. Hence,
\[
P(x) = x^3 Q(x) + cx,
\]
where $Q(x)$ has integer coefficients. To find the exponent of 2 in $c$, we compute:
\[
c = 2(2^k - 1)!! \sum_{i=1}^{2^{k-1}} \frac{1}{2i - 1} \cdot \frac{1}{2^k - 2i + 1}.
\]

This simplifies to:
\[
c = (2^k - 1)!! \sum_{i=1}^{2^{k-1}} \frac{2^k}{(2i - 1)(2^k - 2i + 1)} = 2^k (2^k - 1)!! \sum_{i=1}^{2^{k-1}} \frac{1}{(2i - 1)(2^k - 2i + 1)}.
\]

Let
\[
S = \sum_{i=1}^{2^{k-1}} \frac{(2^k - 1)!!}{(2i - 1)(2^k - 2i + 1)}.
\]

Set $a_{2i - 1}$ to be the inverse of $2i - 1$ modulo $2^k$.

Then:
\[
S = \sum_{i=1}^{2^{k-1}} \frac{(2^k - 1)!! a_{2i - 1}^2}{(2i - 1)^2} = - (2^k - 1)!! \sum_{i=1}^{2^{k-1}} (2i - 1)^2 = - (2^k - 1)!! \cdot \frac{2^{k-1}(2^k - 1)}{3} \pmod{2^k}.
\]

Hence, the exponent of 2 in $S$ is $k - 1$, so $c = 2^k \cdot 2^{k - 1} (2t + 1) = 2^{2k - 1}(2t + 1)$.

Finally,
\[
P(2^k) = 2^k Q(2^k)^3 + 2^k c = 2^k Q(2^k)^3 + 2^k \cdot 2^{2k - 1}(2t + 1),
\]
so
\[
P(2^k) \text{ is divisible by } 2^{3k}, \text{ but not by } 2^{3k + 1}.
\]

\vspace{1em}
\textbf{Comment.} The fact that (1) is divisible by $2^{2k}$ is known; but it does not help in solving this problem.
",,,,,,
2007n6,Let $k$ be a positive integer. Prove that the number $(4k^2 - 1)^2$ has a positive divisor of the form $8kn - 1$ if and only if $k$ is even.,"\textbf{Solution.} The statement follows from the following fact.

\textbf{Lemma.} For arbitrary positive integers $x$ and $y$, the number $4xy - 1$ divides $(4x^2 - 1)^2$ if and only if $x = y$.

\textit{Proof.} If $x = y$ then $4xy - 1 = 4x^2 - 1$ obviously divides $(4x^2 - 1)^2$ so it is sufficient to consider the opposite direction.

Call a pair $(x, y)$ of positive integers \textit{bad} if $4xy - 1$ divides $(4x^2 - 1)^2$ but $x \ne y$. In order to prove that bad pairs do not exist, we present two properties of them which provide an infinite descent.

\textbf{Property (i).} If $(x, y)$ is a bad pair and $x < y$, then there exists a positive integer $z < x$ such that $(x, z)$ is also bad.

Let 
\[
r = \frac{(4x^2 - 1)^2}{4xy - 1}.
\]
Then
\[
r \equiv -r \cdot (-1) \equiv -r(4xy - 1) = -(4x^2 - 1)^2 \equiv -1 \pmod{4x},
\]
and $r = 4xz - 1$ with some positive integer $z$. From $x < y$ we obtain that
\[
4xz - 1 = \frac{(4x^2 - 1)^2}{4xy - 1} < 4x^2 - 1,
\]
and therefore $z < x$. By the construction, the number $4xz - 1$ is a divisor of $(4x^2 - 1)^2$ so $(x, z)$ is a bad pair.

\textbf{Property (ii).} If $(x, y)$ is a bad pair then $(y, x)$ is also bad.

Since $1 = 1^2 \equiv (4xy)^2 \pmod{4xy - 1}$, we have
\[
(4y^2 - 1)^2 \equiv (4y^2 - (4xy)^2)^2 = 16y^4(4x^2 - 1)^2 \equiv 0 \pmod{4xy - 1}.
\]

Hence, the number $4xy - 1$ divides $(4y^2 - 1)^2$ as well.

Now suppose that there exists at least one bad pair. Take a bad pair $(x, y)$ such that $2x + y$ attains its smallest possible value. If $x < y$ then property (i) provides a bad pair $(x, z)$ with $z < y$ and thus $2x + z < 2x + y$. Otherwise, if $y < x$, property (ii) yields that pair $(y, x)$ is also bad while $2y + x < 2x + y$. Both cases contradict the assumption that $2x + y$ is minimal; the Lemma is proved.

To prove the problem statement, apply the Lemma for $x = k$ and $y = 2n$; the number $8kn - 1$ divides $(4k^2 - 1)^2$ if and only if $k = 2n$. Hence, there is no such $n$ if $k$ is odd and $n = k/2$ is the only solution if $k$ is even.

\vspace{1em}
\textbf{Comment.} The constant $4$ in the Lemma can be replaced with an arbitrary integer greater than 1: if $a > 1$ and $axy - 1$ divides $(ax^2 - 1)^2$ then $x = y$.",3,"Let $x, y$ be positive integers. Show that if $4xy-1$ divides $(4x^2-1)^2$, then $4xy-1$ also divides $(4y^2-1)^2$.","Assume $4xy-1$ divides $(4x^2-1)^2$. This implies $(4x^2-1)^2 \equiv 0 \\pmod{4xy-1}$. We know that $4xy \equiv 1 \\pmod{4xy-1}$. Using this, we can write $(4y^2 - 1)^2 \equiv (4y^2 - (4xy)^2)^2 = (y^2(4 - 16x^2))^2 = 16y^4 (1-4x^2)^2 = 16y^4 (4x^2-1)^2 \\pmod{4xy-1}$. Since $(4x^2-1)^2$ is a multiple of $4xy-1$, so is $16y^4 (4x^2-1)^2$. Therefore, $(4y^2-1)^2 \equiv 0 \\pmod{4xy-1}$, which means $4xy-1$ divides $(4y^2-1)^2$.","For arbitrary positive integers $x$ and $y$, prove that $4xy - 1$ divides $(4x^2 - 1)^2$ if and only if $x = y$.","If $x=y$, then $4xy-1 = 4x^2-1$, which trivially divides $(4x^2-1)^2$. For the other direction, assume for contradiction that there exists a pair of distinct positive integers $(x,y)$ such that $4xy-1$ divides $(4x^2-1)^2$. Among all such pairs, choose one, say $(x_0, y_0)$, that minimizes the sum $x+y$. By the result of Sub-problem 1, the property is symmetric, so we can assume $x_0 < y_0$. Let $r = \frac{(4x_0^2-1)^2}{4x_0y_0-1}$. This is a positive integer. Considering the equation modulo $4x_0$, we have $r(4x_0y_0-1) = (4x_0^2-1)^2$, which implies $r(-1) \\equiv (-1)^2 \\pmod{4x_0}$, so $r \\equiv -1 \\pmod{4x_0}$. Thus, $r = 4x_0z-1$ for some positive integer $z$. Since $x_0 < y_0$, we have $4x_0y_0-1 > 4x_0^2-1$, so $r < 4x_0^2-1$. This gives $4x_0z-1 < 4x_0^2-1$, which implies $z < x_0$. Thus, $(x_0, z)$ is another pair satisfying the property, but $x_0+z < x_0+y_0$, contradicting the minimality of the sum. Therefore, we must have $x=y$.",Let $k$ be a positive integer. Prove that the number $(4k^2 - 1)^2$ has a positive divisor of the form $8kn - 1$ if and only if $k$ is even.,"We need to determine when there exists a positive integer $n$ such that $8kn - 1$ divides $(4k^2 - 1)^2$. The divisor can be written as $4k(2n) - 1$. Let $x=k$ and $y=2n$. The condition is that for positive integers $x, y$ (where $y$ is even), $4xy-1$ divides $(4x^2-1)^2$. From the result of Sub-problem 2, this divisibility condition holds if and only if $x=y$. Substituting back, the condition is equivalent to the existence of a positive integer $n$ such that $k = 2n$. This equation has a positive integer solution for $n$ if and only if $k$ is an even number. If $k$ is even, $n=k/2$ is a positive integer. If $k$ is odd, there is no integer solution for $n$.",,
2007n7,"For a prime $p$ and a positive integer $n$, denote by $\nu_p(n)$ the exponent of $p$ in the prime factorization of $n!$. Given a positive integer $d$ and a finite set $\{p_1, \dots, p_k\}$ of primes. Show that there are infinitely many positive integers $n$ such that $d \mid \nu_{p_i}(n)$ for all $1 \le i \le k$.","For arbitrary prime $p$ and positive integer $n$, denote by $\operatorname{ord}_p(n)$ the exponent of $p$ in $n$. Thus,
\[
\nu_p(n) = \sum_{i=1}^{n} \operatorname{ord}_p(i).
\]

\textbf{Lemma.} Let $p$ be a prime number, $q$ a positive integer, and $k$ and $r$ be positive integers such that $p^k > r$. Then
\[
\nu_p(qp^k + r) = \nu_p(qp^k) + \nu_p(r).
\]

\textit{Proof.} We claim that $\operatorname{ord}_p(qp^k + i) = \operatorname{ord}_p(i)$ for all $0 < i < p^k$. Actually, if $d = \operatorname{ord}_p(i)$ then $d < k$, so $qp^k + i$ is divisible by $p^d$, but only the first term is divisible by $p^{d+1}$; hence the sum is not.

Using this claim, we obtain:
\[
\nu_p(qp^k + r) = \sum_{i=1}^{qp^k} \operatorname{ord}_p(i) + \sum_{i=qp^k+1}^{qp^k+r} \operatorname{ord}_p(i)
= \sum_{i=1}^{qp^k} \operatorname{ord}_p(i) + \sum_{i=1}^{r} \operatorname{ord}_p(i) = \nu_p(qp^k) + \nu_p(r).
\]

Let $f(n) = (\nu_{p_1}(n), \dots, \nu_{p_k}(n))$. Define the sequence $n_1 = 1$, $n_{t+1} = (p_1p_2 \cdots p_k)^{n_t}$. We claim that
\[
f(n_{\ell_1} + \cdots + n_{\ell_m}) = f(n_{\ell_1}) + \cdots + f(n_{\ell_m})
\]
for any $\ell_1 < \cdots < \ell_m$.

\textit{Proof by induction.} Base case $m = 1$ is trivial.

Suppose that $m > 1$. Then $p_i^{n_{\ell_1}} > n_{\ell_t}$ for all $t$, and by the Lemma,
\[
f_i(n_{\ell_1} + n_{\ell_2} + \cdots + n_{\ell_m}) = f_i(n_{\ell_1}) + f_i(n_{\ell_2} + \cdots + n_{\ell_m}),
\]
and by the induction hypothesis, the result follows.

Now, consider the values $f(n_1), f(n_2), \dots$. There exist finitely many possible values of $f$. So there exists an infinite sequence $\ell_1 < \ell_2 < \cdots$ such that $f(n_{\ell_1}) = f(n_{\ell_2}) = \cdots$, and thus
\[
f(n_{\ell_1} + n_{\ell_2} + \cdots + n_{\ell_d}) = d \cdot f(n_{\ell_1}) = (0, \dots, 0)
\]
for all $m$. Hence we have found infinitely many suitable numbers.",3,"Let $p$ be a prime, and $k, q, r$ be positive integers such that $p^k > r$. Prove that $\nu_p(qp^k + r) = \nu_p(qp^k) + \nu_p(r)$, where $\nu_p(n)$ is the exponent of $p$ in the prime factorization of $n!$.","For $1 \le i \le r$, since $i < p^k$, we have $\operatorname{ord}_p(i) < k$. Let $d=\operatorname{ord}_p(i)$. Then $qp^k+i = p^d(qp^{k-d} + i/p^d)$. Since $k>d$, $p$ divides the term $qp^{k-d}$ but does not divide $i/p^d$, so $\operatorname{ord}_p(qp^k+i) = d = \operatorname{ord}_p(i)$. Using the identity $\nu_p(n) = \sum_{j=1}^n \operatorname{ord}_p(j)$, we get $\nu_p(qp^k+r) = \nu_p(qp^k) + \sum_{i=1}^r \operatorname{ord}_p(qp^k+i) = \nu_p(qp^k) + \sum_{i=1}^r \operatorname{ord}_p(i) = \nu_p(qp^k) + \nu_p(r)$.","Let $\{p_1, \dots, p_k\}$ be a set of primes and let $P = p_1 \cdots p_k$. Define a sequence by $n_1=1$ and $n_{t+1} = P^{n_t}$ for $t \ge 1$. Let the vector function $f(n) = (\nu_{p_1}(n), \dots, \nu_{p_k}(n))$. Show that for any indices $\ell_1 < \ell_2 < \dots < \ell_m$, the function $f$ is additive, i.e., $f(\sum_{j=1}^m n_{\ell_j}) = \sum_{j=1}^m f(n_{\ell_j})$.","We prove by induction on $m$. The case $m=1$ is trivial. For $m>1$, let $N = \sum_{j=2}^m n_{\ell_j}$. For any $p_i$ in the set and any $j \ge 2$, $n_{\ell_j} = P^{n_{\ell_j-1}}$ is a multiple of $p_i^{n_{\ell_j-1}}$. Since $\ell_1 < \ell_2$, we have $n_{\ell_1} < n_{\ell_2-1} \le n_{\ell_j-1}$ for all $j \ge 2$. Thus, each $n_{\ell_j}$ (for $j \ge 2$) is a multiple of $p_i^{n_{\ell_1}}$, and so is their sum $N$. Let $N = q \cdot p_i^{n_{\ell_1}}$. Since $p_i^{n_{\ell_1}} > n_{\ell_1}$, we can apply the result from Sub-problem 1 to get $\nu_{p_i}(N + n_{\ell_1}) = \nu_{p_i}(N) + \nu_{p_i}(n_{\ell_1})$. This holds for all $i=1, \dots, k$, so $f(N+n_{\ell_1}) = f(N) + f(n_{\ell_1})$. By the induction hypothesis, $f(N) = \sum_{j=2}^m f(n_{\ell_j})$, which completes the proof.","For a prime $p$ and a positive integer $n$, denote by $\nu_p(n)$ the exponent of $p$ in the prime factorization of $n!$. Given a positive integer $d$ and a finite set $\{p_1, \dots, p_k\}$ of primes. Show that there are infinitely many positive integers $n$ such that $d \mid \nu_{p_i}(n)$ for all $1 \le i \le k$.","Consider the sequence $n_t$ from Sub-problem 2 and the vector sequence $f(n_t) = (\nu_{p_1}(n_t), \dots, \nu_{p_k}(n_t))$. Reducing each component modulo $d$, we obtain a sequence in the finite set $(\mathbb{Z}/d\mathbb{Z})^k$. By the pigeonhole principle, there exists an infinite subsequence of indices $\ell_1 < \ell_2 < \dots$ such that $f(n_{\ell_j})$ is constant modulo $d$. Let $N = n_{\ell_1} + \dots + n_{\ell_d}$. By the additivity property from Sub-problem 2, $f(N) = \sum_{j=1}^d f(n_{\ell_j})$. Modulo $d$, this gives $f(N) \equiv \sum_{j=1}^d f(n_{\ell_1}) \equiv d \cdot f(n_{\ell_1}) \equiv (0, \dots, 0) \pmod d$. This shows $d \mid \nu_{p_i}(N)$ for all $i$. We can construct an infinite sequence of such integers by taking sums of disjoint sets of $d$ elements from the infinite subsequence $\{n_{\ell_j}\}$.",,
2006a1,"A sequence of real numbers $a_0, a_1, a_2, \dots$ is defined by the formula
\[
a_{i+1} = \lfloor a_i \rfloor \cdot \langle a_i \rangle \quad \text{for } i \geq 0;
\]
here $a_0$ is an arbitrary real number, $\lfloor \cdot \rfloor$ denotes the greatest integer not exceeding $a_i$, and $\langle a_i \rangle = a_i - \lfloor a_i \rfloor$. Prove that $a_i = a_{i+2}$ for $i$ sufficiently large.","\textbf{Solution.} First note that if $a_0 \geq 0$, then all $a_i \geq 0$. For $a_i \geq 1$ we have (in view of $\langle a_i \rangle < 1$ and $\lfloor a_i \rfloor > 0$),
\[
\lfloor a_i \rfloor \cdot \langle a_i \rangle < \lfloor a_i \rfloor.
\]
Hence $a_{i+1} < \lfloor a_i \rfloor$, so the sequence $\lfloor a_i \rfloor$ is strictly decreasing as long as $a_i \geq 1$. Eventually it must reach the interval $[0, 1)$, after which $a_i = 0$ for all large $i$.

Now suppose the more interesting case $a_0 < 0$, so all $a_i \leq 0$. Suppose the sequence never hits 0. Then $\lfloor a_i \rfloor \leq -1$ for all $i$, and so:
\[
1 + a_{i+1} > a_{i+1} = \lfloor a_i \rfloor \cdot \langle a_i \rangle > \lfloor a_i \rfloor,
\]
which means the sequence $\lfloor a_i \rfloor$ is nondecreasing. Since all its terms are integers in $( -\infty, -1 ]$, this implies the sequence is eventually constant:
\[
\lfloor a_i \rfloor = c \quad \text{for } i \geq i_0, \quad c \text{ a negative integer}.
\]

Then the defining formula becomes:
\[
a_{i+1} = c \cdot \langle a_i \rangle = c(a_i - c) = ca_i - c^2.
\]

Now define:
\[
b_i = a_i - \frac{c^2}{c - 1}. \tag{1}
\]
Then:
\[
b_{i+1} = a_{i+1} - \frac{c^2}{c - 1} = ca_i - c^2 - \frac{c^2}{c - 1} = cb_i. \tag{2}
\]

Hence:
\[
b_i = c^{i - i_0} b_{i_0}, \quad \text{for } i \geq i_0.
\]

Now since $a_i \in [c, c + 1)$ for $i \geq i_0$, the sequence $(b_i)$ is bounded. The recursion (2) then implies $b_i = 0$ or $|c| = 1$.

\textbf{Case 1:} $b_i = 0$ for $i \geq i_0$. Then from (1),
\[
a_i = \frac{c^2}{c - 1} \quad \text{for } i \geq i_0.
\]

\textbf{Case 2:} $c = -1$. Then equations (1) and (2) yield:
\[
a_i = -\frac{1}{2} + (-1)^{i - i_0} b_{i_0} =
\begin{cases}
a_{i_0}, & \text{for } i = i_0, i_0 + 2, i_0 + 4, \dots \\
1 - a_{i_0}, & \text{for } i = i_0 + 1, i_0 + 3, i_0 + 5, \dots
\end{cases}
\]

\textbf{Conclusion:} From some point onward, the sequence $(a_i)$ either is constant or takes alternately two values from the interval $(-1, 0)$. Thus, $a_i = a_{i+2}$ for $i$ sufficiently large.

\vspace{1em}
\textbf{Comment.} There is nothing mysterious in introducing the sequence $(b_i)$. The sequence $(a_i)$ arises by iterating the function $x \mapsto cx - c^2$ whose unique fixed point is $c^2/(c - 1)$.",3,"Show that for any initial value $a_0$, the sequence of integer parts $\lfloor a_i \rfloor$ is eventually constant.","If $a_0 \geq 0$, then all $a_i \geq 0$. As long as $a_i \geq 1$, we have $a_{i+1} = \lfloor a_i \rfloor \langle a_i \rangle < \lfloor a_i \rfloor$, which implies $\lfloor a_{i+1} \rfloor < \lfloor a_i \rfloor$. Since $(\lfloor a_i \rfloor)$ is a strictly decreasing sequence of non-negative integers, it must eventually reach 0 and stay there. If $a_0 < 0$ and the sequence never reaches 0, then $a_i < 0$ and $\lfloor a_i \rfloor \leq -1$ for all $i$. We have $a_{i+1} = \lfloor a_i \rfloor \langle a_i \rangle > \lfloor a_i \rfloor$ because $\lfloor a_i \rfloor$ is negative and $\langle a_i \rangle \in [0, 1)$. This implies $\lfloor a_{i+1} \rfloor \geq \lfloor a_i \rfloor$. So, $(\lfloor a_i \rfloor)$ is a non-decreasing sequence of integers bounded above by -1, which must eventually become constant.","Suppose $\lfloor a_i \rfloor = c$ for some constant integer $c$ for all $i \ge i_0$. Show that either the sequence $(a_i)_{i \ge i_0}$ becomes constant, or $c=-1$ and $a_{i+1} = -a_i - 1$ for $i \ge i_0$.","For $i \ge i_0$, the recurrence is $a_{i+1} = c(a_i - c) = ca_i - c^2$. This is a linear recurrence. Since $a_i \in [c, c+1)$, the sequence $(a_i)$ is bounded for $i \ge i_0$. Let $b_i = a_i - \frac{c^2}{c-1}$ for $c \neq 1$. The recurrence becomes $b_{i+1} = cb_i$, so $b_i = c^{i-i_0} b_{i_0}$. For $(b_i)$ to be bounded, we must have either $b_{i_0}=0$ or $|c| \le 1$. Since $c$ is an integer, $|c| \le 1$ implies $c \in \{-1, 0, 1\}$. The case $c=1$ is impossible, as $a_i \in [1,2)$ would yield $a_{i+1} = a_i-1 \in [0,1)$, so $\lfloor a_{i+1} \rfloor = 0 \neq 1$. If $b_{i_0}=0$ or $c=0$, the sequence $(a_i)_{i \ge i_0}$ is constant (or becomes constant). If $c=-1$, the recurrence is $a_{i+1} = -a_i - 1$.",Prove that $a_i = a_{i+2}$ for $i$ sufficiently large.,"From sub-problem 1, there exists an integer $i_0$ such that $\lfloor a_i \rfloor = c$ for all $i \geq i_0$. From sub-problem 2, we have two cases for $i \ge i_0$. Case 1: The sequence $(a_i)_{i \ge i_0}$ becomes constant. If $a_i = K$ for $i$ sufficiently large, then $a_i = a_{i+2} = K$. This covers the cases where $c \geq 0$ and $c \leq -2$. Case 2: For $i \ge i_0$, $c=-1$ and $a_{i+1} = -a_i - 1$. Then we compute $a_{i+2} = -a_{i+1} - 1 = -(-a_i - 1) - 1 = a_i + 1 - 1 = a_i$. In all possible scenarios, we conclude that $a_i = a_{i+2}$ for sufficiently large $i$.",,
2006a2,"\textbf{A2.} The sequence of real numbers $a_0, a_1, a_2, \dots$ is defined recursively by
\[
a_0 = -1, \qquad \sum_{k=0}^{n} \frac{a_{n-k}}{k+1} = 0 \quad \text{for } n \ge 1.
\]
Show that $a_n > 0$ for $n \ge 1$.","\textbf{Solution.} The proof goes by induction. For $n = 1$ the formula yields $a_1 = 1/2$. Take $n \ge 1$, assume $a_1, \dots, a_n > 0$ and write the recurrence formula for $n$ and $n+1$ as:
\[
\sum_{k=0}^{n} \frac{a_k}{n - k + 1} = 0 \quad \text{and} \quad \sum_{k=0}^{n+1} \frac{a_k}{n - k + 2} = 0.
\]

Subtracting the first from the second:
\[
0 = (n + 2)\sum_{k=0}^{n+1} \frac{a_k}{n - k + 2} - (n + 1)\sum_{k=0}^{n} \frac{a_k}{n - k + 1}
\]
\[
= (n + 2)a_{n+1} + \sum_{k=0}^{n} \left( \frac{n + 2}{n - k + 2} - \frac{n + 1}{n - k + 1} \right) a_k.
\]

The coefficient of $a_0$ vanishes, so we have:
\[
a_{n+1} = \frac{1}{n + 2} \sum_{k=1}^{n} \left( \frac{n + 1}{n - k + 1} - \frac{n + 2}{n - k + 2} \right) a_k 
= \frac{1}{n + 2} \sum_{k=1}^{n} \frac{k}{(n - k + 1)(n - k + 2)} a_k.
\]

The coefficients of $a_1, \dots, a_n$ are all positive. Therefore, $a_1, \dots, a_n > 0$ implies $a_{n+1} > 0$.

\vspace{1em}
\textbf{Comment.} Students familiar with the technique of generating functions will immediately recognise $\sum a_n x^n$ as the power series expansion of $x / \ln(1 - x)$ (with value $-1$ at $0$). But this can be a trap; attempts along these lines lead to unpleasant differential equations and integrals hard to handle. Using only tools from real analysis (e.g., computing the coefficients from the derivatives) seems very difficult.

On the other hand, the coefficients can be approached applying complex contour integrals and some other techniques from complex analysis and an attractive formula can be obtained for the coefficients:
\[
a_n = \int_1^{\infty} \frac{dx}{x^n (\pi^2 + \log^2(x - 1))}, \quad (n \ge 1)
\]
which is evidently positive.",3,Let the sequence of real numbers $a_n$ be defined by $a_0 = -1$ and $\sum_{k=0}^{n} \frac{a_{n-k}}{k+1} = 0$ for $n \ge 1$. Calculate $a_1$ and show it is positive.,"For $n=1$, the given recurrence relation is $\sum_{k=0}^{1} \frac{a_{1-k}}{k+1} = 0$. This expands to $\frac{a_1}{0+1} + \frac{a_0}{1+1} = 0$. Substituting the given value $a_0 = -1$, we get $a_1 + \frac{-1}{2} = 0$, which implies $a_1 = 1/2$. Thus, $a_1 > 0$.","Let the sequence $a_n$ be defined by $a_0 = -1$ and $\sum_{k=0}^{n} \frac{a_{n-k}}{k+1} = 0$ for $n \ge 1$. Show that for $n \ge 1$, the following recurrence relation holds: $$a_{n+1} = \frac{1}{n+2} \sum_{k=1}^{n} \frac{k}{(n-k+1)(n-k+2)} a_k.$$","The defining recurrence can be rewritten by changing the index of summation to $j=n-k$, which gives $\sum_{j=0}^{n} \frac{a_j}{n-j+1} = 0$ for $n \ge 1$. Writing this for $n$ and $n+1$, we have $\sum_{k=0}^{n} \frac{a_k}{n-k+1}=0$ and $\sum_{k=0}^{n+1} \frac{a_k}{n-k+2}=0$. Consider the linear combination $(n+2)\sum_{k=0}^{n+1} \frac{a_k}{n-k+2} - (n+1)\sum_{k=0}^{n} \frac{a_k}{n-k+1} = 0$. This simplifies to $(n+2)a_{n+1} + \sum_{k=0}^{n} a_k \left( \frac{n+2}{n-k+2} - \frac{n+1}{n-k+1} \right) = 0$. The coefficient of $a_0$ is $\frac{n+2}{n+2} - \frac{n+1}{n+1} = 0$. For $k \ge 1$, the coefficient of $a_k$ is $\frac{-k}{(n-k+1)(n-k+2)}$. Rearranging the equation gives $(n+2)a_{n+1} = \sum_{k=1}^{n} \frac{k}{(n-k+1)(n-k+2)} a_k$, which yields the desired formula.","The sequence of real numbers $a_0, a_1, a_2, \dots$ is defined recursively by
\[
a_0 = -1, \qquad \sum_{k=0}^{n} \frac{a_{n-k}}{k+1} = 0 \quad \text{for } n \ge 1.
\]
Show that $a_n > 0$ for $n \ge 1$.","We proceed by induction on $n$. 
\textbf{Base case (n=1):} The relation for $n=1$ is $\frac{a_1}{1} + \frac{a_0}{2} = 0$. With $a_0=-1$, we find $a_1=1/2 > 0$.
\textbf{Inductive step:} Assume $a_k > 0$ for $1 \le k \le n$ for some $n \ge 1$. For $n \ge 1$, we can use the identity $a_{n+1} = \frac{1}{n+2} \sum_{k=1}^{n} \frac{k}{(n-k+1)(n-k+2)} a_k$. In this sum, for $1 \le k \le n$, the coefficients $\frac{k}{(n-k+1)(n-k+2)}$ are positive, since $k>0$, $n-k+1 > 0$, and $n-k+2 > 0$. By the inductive hypothesis, each $a_k$ is also positive. Thus, the sum is a sum of positive terms and is itself positive. Since $n+2>0$, it follows that $a_{n+1} > 0$. By the principle of induction, $a_n > 0$ for all $n \ge 1$.",,
2006a3,"The sequence $c_0, c_1, \dots, c_n, \dots$ is defined by $c_0 = 1$, $c_1 = 0$ and $c_{n+2} = c_{n+1} + c_n$ for $n \ge 0$. Consider the set $S$ of ordered pairs $(x, y)$ for which there is a finite set $J$ of positive integers such that $x = \sum_{j \in J} c_j$, $y = \sum_{j \in J} c_{j-1}$. Prove that there exist real numbers $\alpha, \beta$ and $m, M$ with the following property: An ordered pair of nonnegative integers $(x, y)$ satisfies the inequality
\[
m < \alpha x + \beta y < M
\]
if and only if $(x, y) \in S$.","\textbf{Solution.} Let $\varphi = \frac{1 + \sqrt{5}}{2}$ and $\psi = \frac{1 - \sqrt{5}}{2}$ be the roots of $t^2 - t - 1 = 0$. Note that $\varphi \psi = -1$, $\varphi + \psi = 1$, and $1 + \psi = \psi^2$.

An easy induction shows that the general term of the sequence satisfies:
\[
c_n = \frac{\varphi^{n-1} - \psi^{n-1}}{\varphi - \psi}, \quad \text{for } n \ge 0.
\]

Suppose the numbers $\alpha$ and $\beta$ have the required property. Since $(c_n, c_{n-1}) \in S$, we consider:
\[
\alpha c_n + \beta c_{n-1} = \frac{\alpha}{\sqrt{5}} (\varphi^{n-1} - \psi^{n-1}) + \frac{\beta}{\sqrt{5}} (\varphi^{n-2} - \psi^{n-2})
= \frac{1}{\sqrt{5}} [(\alpha \varphi + \beta)\varphi^{n-2} - (\alpha \psi + \beta)\psi^{n-2}].
\]

As $n \to \infty$, this is bounded only if $\alpha \varphi + \beta = 0$, so choose $\alpha = \psi$, $\beta = 1$.

With this choice, the above expression becomes:
\[
\psi c_n + c_{n-1} = \sum_{j \in J} \psi c_j + c_{j-1} = \sum_{j \in J} \psi^j, \quad \text{for } (a_J, b_J) \in S. \tag{1}
\]

Since $-1 < \psi < 0$, we have:
\[
-1 = \frac{\psi}{1 - \psi^2} < \sum_{j \in J} \psi^{2j+1} < \sum_{j \in J} \psi^j < \sum_{j=0}^\infty \psi^{2j} = \frac{1}{1 - \psi^2} = 1 - \psi = \varphi.
\]

So,
\[
-1 < \psi a_J + b_J < \varphi. \tag{2}
\]

Let $(x, y)$ satisfy $-1 < \psi x + y < \varphi$.

\textbf{Lemma.} If $x, y$ are nonnegative integers such that $-1 < \psi x + y < \varphi$, then there exists a finite subset $J$ of $\mathbb{N}$ such that
\[
\psi x + y = \sum_{j \in J} \psi^j. \tag{3}
\]

\textit{Proof.} If $x = y = 0$, use the empty set. If not, write:
\[
\psi x + y = \psi^{i_1} + \dots + \psi^{i_k}, \quad i_1 \le \cdots \le i_k.
\]
Take the one with minimal $i_1$ among shortest length $k$, and among them, minimal $i_2$, etc., yielding $i_1 < i_2 < \cdots < i_k$.

If $j_r = j_{r+1}$, then replacing $j_r, j_{r+1}$ with $j_r - 2, j_r + 1$ leads to a smaller minimal index:
\[
\psi^{j_r} + \psi^{j_r+1} = \psi^{j_r-2}(1 + \psi^3) = \psi^{j_r-2} + \psi^{j_r+1}.
\]
So $j_1, \dots, j_k$ must be distinct.

If $j_r = j_{r+1} - 1 = 1$, then the sum exceeds $\varphi$:
\[
\sum_{r=1}^k \psi^{j_r} \ge \psi + \psi^2 + \dots > 2 - \psi^2 = \varphi.
\]
Or if $j_r = 0$, then sum includes at least two $\psi^0 = 1$, so exceeds $-1$.

Therefore, there exists $J$ such that $\psi x + y = \sum_{j \in J} \psi^j$.

Hence, $(x, y) \in S$ and the inequality
\[
-1 < \psi x + y < \varphi
\]
characterizes the set $S$, with $\alpha = \psi$, $\beta = 1$, $m = -1$, and $M = \varphi$.

\textbf{Alternate proof of lemma:} Let $n = 3x + 2y$, and induct on $n$.

Suppose that $\frac{\psi x + y}{\psi} \in (-1, \varphi)$. Then
\[
\frac{\psi x + y}{\psi} = x + (\psi - 1)y = \psi y + (x - y),
\]
set $x' = y$, $y' = x - y$. Then
\[
\psi x' + y' = \psi y + (x - y) = \frac{\psi x + y}{\psi} \in (-1, \varphi),
\]
and $3x' + 2y' = 3y + 2(x - y) = 2x + y < n$, so apply induction.

Likewise, consider $\frac{\psi x + y - 1}{\psi} = x + (\psi - 1)(y - 1) + (x - y + 1) = \psi(y - 1) + (x - y + 1)$.

Set $x' = y - 1$, $y' = x - y + 1$. Again, $x', y' \ge 0$, and
\[
3x' + 2y' = 3(y - 1) + 2(x - y + 1) = 3y + 2x - 3 - 2y + 2 = 2x + y - 1 < n,
\]
so the induction applies.

Finally,
\[
(-1, -\psi) \cup (0, \varphi) = (-1, \varphi),
\]
so one of the two intervals always applies.

This completes the proof.",4,"Let $\\varphi = \frac{1+\\sqrt{5}}{2}$ and $\\psi = \frac{1-\\sqrt{5}}{2}$. For the inequality $m < \\alpha x + \beta y < M$ to hold for all $(x,y) \\in S$, the expression must be bounded for all pairs $(c_n, c_{n-1}) \\in S$. Use this condition to determine a suitable choice for the real numbers $\\alpha$ and $\beta$.","The pairs $(c_n, c_{n-1})$ for $n \\ge 1$ are in $S$. The closed form for $c_n$ is $c_n = \frac{\\varphi^{n-1} - \\psi^{n-1}}{\\sqrt{5}}$. The expression $\\alpha c_n + \beta c_{n-1}$ is proportional to $\\varphi^{n-2}(\\alpha\\varphi + \beta) - \\psi^{n-2}(\\alpha\\psi + \beta)$. As $n \to \\infty$, $|\varphi^{n-2}| \to \\infty$ while $|\\psi^{n-2}| \to 0$. For the expression to remain bounded, the coefficient of the growing term must be zero, so we must have $\\alpha\\varphi + \beta = 0$. A convenient choice satisfying this condition is $\\alpha = \\psi$ and $\beta = 1$.","Using the chosen values $\\alpha = \\psi$ and $\beta = 1$, find a simplified expression for $\\psi x + y$ where $(x, y) \\in S$.","For any $(x, y) \\in S$, we have $x = \\sum_{j \\in J} c_j$ and $y = \\sum_{j \\in J} c_{j-1}$ for some finite set of positive integers $J$. The expression is $\\psi x + y = \\sum_{j \\in J} (\\psi c_j + c_{j-1})$. We can prove by induction that $\\psi c_j + c_{j-1} = \\psi^{j-1}$ for all $j \\ge 1$. For the base case $j=1$, $\\psi c_1 + c_0 = \\psi(0) + 1 = 1 = \\psi^0$. For the inductive step, assume $\\psi c_k + c_{k-1} = \\psi^{k-1}$. Then $\\psi c_{k+1} + c_k = \\psi(c_k+c_{k-1})+c_k = (\\psi+1)c_k+\\psi c_{k-1} = \\psi^2 c_k + \\psi c_{k-1} = \\psi(\\psi c_k+c_{k-1}) = \\psi(\\psi^{k-1}) = \\psi^k$. Thus, $\\psi x + y = \\sum_{j \\in J} \\psi^{j-1}$.","For any $(x, y) \\in S$, establish lower and upper bounds, $m$ and $M$, for the expression $\\psi x + y$. This will prove one direction of the equivalence.","From the previous step, for any $(x, y) \\in S$, we have $\\psi x + y = \\sum_{j \\in J} \\psi^{j-1}$. Let $K = \\{j-1 \\mid j \\in J\\}$, which is a finite set of non-negative integers. The sum is $\\sum_{k \\in K} \\psi^k$. Since $\\psi \\in (-1, 0)$, the sum of any finite number of distinct powers of $\\psi$ is strictly bounded above by the sum of all even powers, $\\sum_{i=0}^\\infty \\psi^{2i} = \frac{1}{1-\\psi^2} = \\varphi$, and strictly bounded below by the sum of all odd powers, $\\sum_{i=0}^\\infty \\psi^{2i+1} = \frac{\\psi}{1-\\psi^2} = -1$. Therefore, for any $(x,y) \\in S$, we have $-1 < \\psi x + y < \\varphi$. We can set $m=-1$ and $M=\\varphi$.","Prove that there exist real numbers $\\alpha, \beta$ and $m, M$ with the following property: An ordered pair of nonnegative integers $(x, y)$ satisfies the inequality $m < \\alpha x + \beta y < M$ if and only if $(x, y) \\in S$.","From the previous steps, we choose $\\alpha=\\psi, \beta=1, m=-1, M=\\varphi$. We have shown that if $(x,y) \\in S$, then $-1 < \\psi x + y < \\varphi$. For the converse, assume $x, y$ are non-negative integers such that $-1 < \\psi x + y < \\varphi$. It can be shown that any such number can be represented as a finite sum $\\psi x + y = \\sum_{k \\in K} \\psi^k$ for some set $K$ of non-negative integers. Let $J = \\{k+1 \\mid k \\in K\\}$. Using the identity from the second sub-problem, $\\sum_{k \\in K} \\psi^k = \\sum_{j \\in J} \\psi^{j-1} = \\sum_{j \\in J} (\\psi c_j + c_{j-1}) = \\psi(\\sum_{j \\in J} c_j) + (\\sum_{j \\in J} c_{j-1})$. Let $x' = \\sum_{j \\in J} c_j$ and $y' = \\sum_{j \\in J} c_{j-1}$. Then $(x', y') \\in S$. We have $\\psi x + y = \\psi x' + y'$, which implies $\\psi(x-x') = y'-y$. Since $x,y,x',y'$ are integers and $\\psi$ is irrational, this requires $x-x'=0$ and $y'-y=0$. Thus $(x,y)=(x',y') \\in S$."
2006a4,"Prove the inequality
\[
\sum_{i<j} \frac{a_i a_j}{a_i + a_j} \le \frac{n}{2(a_1 + a_2 + \cdots + a_n)} \sum_{i<j} a_i a_j
\]
for positive real numbers $a_1, a_2, \dots, a_n$.","Let $S = \sum_i a_i$. Denote by $L$ and $R$ the expressions on the left and right-hand sides, respectively. Use the identity:
\[
\sum_{i<j}(a_i + a_j) = (n - 1)\sum_i a_i. \tag{1}
\]
Then:
\[
L = \sum_{i<j} \frac{a_i a_j}{a_i + a_j} = \sum_{i<j} \frac{1}{4}\left(a_i + a_j - \frac{(a_i - a_j)^2}{a_i + a_j}\right)
= \frac{n - 1}{4} \cdot S - \frac{1}{4} \sum_{i<j} \frac{(a_i - a_j)^2}{a_i + a_j}. \tag{2}
\]

To represent $R$, note:
\[
\sum_{i<j} a_i a_j = \frac{1}{2} \left(S^2 - \sum_i a_i^2 \right),
\]
and:
\[
\sum_{i<j} a_i a_j = \frac{1}{2} \sum_{i<j} \left(a_i^2 + a_j^2 - (a_i - a_j)^2 \right)
= \frac{n - 1}{2} \sum_i a_i^2 - \frac{1}{2} \sum_{i<j} (a_i - a_j)^2.
\]

Multiply both identities by $n - 1$, add them, and simplify:
\[
n \sum_{i<j} a_i a_j = \frac{n - 1}{2} S^2 - \frac{1}{2} \sum_{i<j} (a_i - a_j)^2.
\]
Then:
\[
R = \frac{n}{2S} \sum_{i<j} a_i a_j = \frac{n - 1}{4} \cdot S - \frac{1}{4} \sum_{i<j} \frac{(a_i - a_j)^2}{S}. \tag{3}
\]

Now compare (2) and (3). Since $S \ge a_i + a_j$ for all $i < j$, we conclude $L \le R$.",2,"Let $S = \sum_{i=1}^n a_i$. Let $L = \sum_{i<j} \frac{a_i a_j}{a_i + a_j}$ and $R = \frac{n}{2S} \sum_{i<j} a_i a_j$. Prove the following identities:
$L = \frac{n - 1}{4} S - \frac{1}{4} \sum_{i<j} \frac{(a_i - a_j)^2}{a_i + a_j}$
$R = \frac{n - 1}{4} S - \frac{1}{4S} \sum_{i<j} (a_i - a_j)^2$","For $L$, we use the identity $a_i a_j/(a_i+a_j) = \frac{1}{4}(a_i+a_j - (a_i-a_j)^2/(a_i+a_j))$ and the fact that $\sum_{i<j}(a_i+a_j)=(n-1)S$. Summing over $i<j$ yields $L = \frac{1}{4}(n-1)S - \frac{1}{4}\sum_{i<j}\frac{(a_i-a_j)^2}{a_i+a_j}$.
For $R$, we use the identity $n \sum_{i<j} a_i a_j = \frac{n - 1}{2} S^2 - \frac{1}{2} \sum_{i<j} (a_i - a_j)^2$, which can be derived by eliminating $\sum a_i^2$ from the standard expansions of $S^2$ and $\sum_{i<j}(a_i-a_j)^2$. Then we have $R = \frac{n}{2S}\sum_{i<j} a_i a_j = \frac{1}{2S} (n\sum_{i<j} a_i a_j) = \frac{1}{2S} (\frac{n - 1}{2} S^2 - \frac{1}{2} \sum_{i<j} (a_i - a_j)^2) = \frac{n-1}{4}S - \frac{1}{4S}\sum_{i<j}(a_i-a_j)^2$.","Prove the inequality
\[
\sum_{i<j} \frac{a_i a_j}{a_i + a_j} \le \frac{n}{2(a_1 + a_2 + \cdots + a_n)} \sum_{i<j} a_i a_j
\]
for positive real numbers $a_1, a_2, \dots, a_n$.","Let $L$ and $R$ be the left and right sides of the inequality, and $S = \sum_i a_i$. From the first sub-problem, we have the expressions:
$L = \frac{n - 1}{4} S - \frac{1}{4} \sum_{i<j} \frac{(a_i - a_j)^2}{a_i + a_j}$
$R = \frac{n - 1}{4} S - \frac{1}{4S} \sum_{i<j} (a_i - a_j)^2$
The inequality $L \le R$ is thus equivalent to:
$-\frac{1}{4} \sum_{i<j} \frac{(a_i - a_j)^2}{a_i + a_j} \le -\frac{1}{4S} \sum_{i<j} (a_i - a_j)^2$
which simplifies to
$\sum_{i<j} \frac{(a_i - a_j)^2}{a_i + a_j} \ge \sum_{i<j} \frac{(a_i - a_j)^2}{S}$
This holds because for each term in the sums, since $a_k>0$ for all $k$, we have $S = \sum_k a_k \ge a_i + a_j$. Therefore, $\frac{1}{a_i + a_j} \ge \frac{1}{S}$. Multiplying by the non-negative term $(a_i - a_j)^2$ gives $\frac{(a_i - a_j)^2}{a_i + a_j} \ge \frac{(a_i - a_j)^2}{S}$. Summing over all $i<j$ completes the proof.",,,,
2006a5,"Let $a, b, c$ be the sides of a triangle. Prove that
\[
\frac{\sqrt{b + c - a}}{\sqrt{b + \sqrt{c - \sqrt{a}}}} + \frac{\sqrt{c + a - b}}{\sqrt{c + \sqrt{a - \sqrt{b}}}} + \frac{\sqrt{a + b - c}}{\sqrt{a + \sqrt{b - \sqrt{c}}}} \le 3.
\]","Note that the denominators are all positive. Let
\[
x = \sqrt{b + \sqrt{c - \sqrt{a}}}, \quad y = \sqrt{c + \sqrt{a - \sqrt{b}}}, \quad z = \sqrt{a + \sqrt{b - \sqrt{c}}}.
\]
Then
\[
b + c - a = \left( \frac{z + x}{2} \right)^2 + \left( \frac{x + y}{2} \right)^2 - \left( \frac{y + z}{2} \right)^2 = \frac{x^2 + xy + xz - yz}{2} = x^2 - \frac{1}{2}(x - y)(x - z),
\]
and
\[
\frac{\sqrt{b + c - a}}{\sqrt{b + \sqrt{c - \sqrt{a}}}} = \sqrt{1 - \frac{(x - y)(x - z)}{2x^2}} \le 1 - \frac{(x - y)(x - z)}{4x^2},
\]
by applying $\sqrt{1 + u} \le 1 + \frac{u}{2}$.

Similarly:
\[
\frac{\sqrt{c + a - b}}{\sqrt{c + \sqrt{a - \sqrt{b}}}} \le 1 - \frac{(z - x)(z - y)}{4z^2}, \quad
\frac{\sqrt{a + b - c}}{\sqrt{a + \sqrt{b - \sqrt{c}}}} \le 1 - \frac{(y - z)(y - x)}{4y^2}.
\]

So the inequality becomes:
\[
\frac{(x - y)(x - z)}{x^2} + \frac{(y - z)(y - x)}{y^2} + \frac{(z - x)(z - y)}{z^2} \ge 0. \tag{1}
\]

Assume $x \le y \le z$. Then:
\[
\frac{(x - y)(x - z)}{x^2} = \frac{(y - x)(z - x)}{x^2} \ge \frac{(y - x)(z - y)}{y^2}, \quad \frac{(z - x)(z - y)}{z^2} \ge 0.
\]

Hence inequality (1) follows.",2,"Let $x, y, z$ be positive real numbers corresponding to the denominators in the original inequality. Assuming the relations $b+c-a = x^2 - \frac{1}{2}(x-y)(x-z)$, $c+a-b = y^2 - \frac{1}{2}(y-z)(y-x)$, and $a+b-c = z^2 - \frac{1}{2}(z-x)(z-y)$, use the inequality $\sqrt{1+u} \le 1+u/2$ to show that the original inequality can be reduced to proving $\frac{(x-y)(x-z)}{x^2} + \frac{(y-z)(y-x)}{y^2} + \frac{(z-x)(z-y)}{z^2} \ge 0$.","Let the left-hand side of the original inequality be $LHS$. The first term is $\frac{\sqrt{b+c-a}}{x} = \sqrt{\frac{x^2 - \frac{1}{2}(x-y)(x-z)}{x^2}} = \sqrt{1 - \frac{(x-y)(x-z)}{2x^2}}$. Using the inequality $\sqrt{1+u} \le 1+u/2$, this term is less than or equal to $1 - \frac{(x-y)(x-z)}{4x^2}$. Applying this approximation to all three terms, we find that the sum is bounded above: $LHS \le \left(1 - \frac{(x-y)(x-z)}{4x^2}\right) + \left(1 - \frac{(y-z)(y-x)}{4y^2}\right) + \left(1 - \frac{(z-x)(z-y)}{4z^2}\right) = 3 - \frac{1}{4} \left( \frac{(x-y)(x-z)}{x^2} + \frac{(y-z)(y-x)}{y^2} + \frac{(z-x)(z-y)}{z^2} \right)$. For the original inequality $LHS \le 3$ to hold, it is sufficient that the parenthesized expression is non-negative.","Let $a, b, c$ be the sides of a triangle. Prove that
\[
\frac{\sqrt{b + c - a}}{\sqrt{b + \sqrt{c - \sqrt{a}}}} + \frac{\sqrt{c + a - b}}{\sqrt{c + \sqrt{a - \sqrt{b}}}} + \frac{\sqrt{a + b - c}}{\sqrt{a + \sqrt{b - \sqrt{c}}}} \le 3.
\]","From Part 1, the problem reduces to proving that for positive $x, y, z$, the inequality $\frac{(x-y)(x-z)}{x^2} + \frac{(y-z)(y-x)}{y^2} + \frac{(z-x)(z-y)}{z^2} \ge 0$ holds. Assume without loss of generality that $x \le y \le z$. The inequality can be written as $\frac{(y-x)(z-x)}{x^2} - \frac{(y-x)(z-y)}{y^2} + \frac{(z-x)(z-y)}{z^2} \ge 0$. We can group the terms as $\left(\frac{(y-x)(z-x)}{x^2} - \frac{(y-x)(z-y)}{y^2}\right) + \frac{(z-x)(z-y)}{z^2} \ge 0$. Since $x \le y \le z$, the term $\frac{(z-x)(z-y)}{z^2}$ is non-negative. For the first group, the inequality $\frac{(y-x)(z-x)}{x^2} \ge \frac{(y-x)(z-y)}{y^2}$ is equivalent to $(z-x)y^2 \ge (z-y)x^2$ (since $y-x \ge 0$). This simplifies to $z(y^2-x^2) \ge xy(y-x)$, and further to $z(y+x) \ge xy$, which is true as $z \ge y$. Thus, the expression is a sum of two non-negative terms, which is itself non-negative. The inequality is proven.",,,,
2006c1,"We have $n \ge 2$ lamps $L_1, \ldots, L_n$ in a row, each of them being either \textit{on} or \textit{off}. Every second we simultaneously modify the state of each lamp as follows:

\begin{itemize}
\item If the lamp $L_i$ and its neighbours (only one neighbour for $i = 1$ or $i = n$, two neighbours for other $i$) are in the same state, then $L_i$ is switched off;
\item otherwise, $L_i$ is switched on.
\end{itemize}

Initially all the lamps are off except the leftmost one which is on.

\begin{enumerate}
\item[(a)] Prove that there are infinitely many integers $n$ for which all the lamps will eventually be off.
\item[(b)] Prove that there are infinitely many integers $n$ for which the lamps will never be all off.
\end{enumerate}","\textbf{Solution.}

(a) Let us define $A_k$ to be the $2^k \times 2^k$ matrix whose rows represent the evolution of the system of $n = 2^k$ lamps. The first row of $A_k$ is $[1, 0, 0, \ldots, 0]$, the initial configuration. The claim is:

\textit{The bottom row of $A_k$ is} $[1, 1, \ldots, 1]$.

This is sufficient, because applying the rule one more time gives $[0, 0, \ldots, 0]$.

\textit{Proof by induction.} Base case $k=1$ is clear. For the inductive step, consider $A_{k+1}$ as:
\[
A_{k+1} = \begin{pmatrix} A_k & O_k \\ B_k & C_k \end{pmatrix},
\]
where $O_k$ is a zero matrix. After $2^k$ steps, the right part is untouched, so we can focus on the symmetry:

The row after the bottom of $[A_k\ O_k]$ becomes:
\[
[0,\ldots,0,\ 1,\ 1,\ 0,\ldots,0],
\]
with $2^{k-1}$ zeros on each side. This row is symmetric, and the update rule is symmetric, so this symmetry is preserved. Therefore $B_k$ mirrors $C_k$.

Since $C_k$ evolves identically to $A_k$ (due to same neighbourhoods from $B_k$), we get that $C_k = A_k$. So the bottom row of $A_{k+1}$ is all $1$'s, completing the induction.

(b) Let $n = 2^k + 1$ for $k \ge 1$. Consider a matrix $\mathcal{A}$ of width $2^k + 1$, where the first $2^k$ columns form $A_k$, and the last column is zeros.

The next row (after $A_k$'s last row) is $[0, 0, \ldots, 0, 1, 1]$, which is the reverse of the second row of $A_k$. This reversal continues, making rows of $\mathcal{A}$ mirror the earlier ones.

Hence the pattern $[1, 1, 0, \ldots, 0, 0]$ reappears and repeats. Therefore, the state $[0, 0, \ldots, 0]$ never appears. So there are infinitely many such $n = 2^k + 1$ for which the lamps are never all off.",3,"For $n=2^k$ lamps ($k \ge 1$), starting with the leftmost lamp on and all others off, prove that the state at time $t=2^k-1$ is all lamps on.","We use induction on $k$. Base case $k=1, n=2$: The initial state $[1,0]$ evolves to $[1,1]$ at $t=1=2^1-1$. The claim holds. For the inductive step, assume the claim holds for $k$. For $n=2^{k+1}$, the first $2^k$ lamps evolve as an $n=2^k$ system for $2^k-1$ steps, while the other lamps remain off. So at $t=2^k-1$, the state is $[1, \dots, 1, 0, \dots, 0]$ (first $2^k$ lamps are on). At $t=2^k$, the state becomes $[0, \dots, 0, 1, 1, 0, \dots, 0]$, with ones at positions $2^k$ and $2^k+1$. This state is symmetric, and since the rules are symmetric, the evolution remains symmetric. This implies that the state of lamp $L_{2^k}$ is always the same as lamp $L_{2^k+1}$ for $t \ge 2^k$. This makes the right half of the lamps ($L_{2^k+1}, \dots, L_{2^{k+1}}$) evolve identically to an $n=2^k$ system. By the inductive hypothesis, this right half becomes all ones after another $2^k-1$ steps, i.e., at total time $t=(2^k-1)+2^k=2^{k+1}-1$. By symmetry, the left half is also all ones. The induction is complete.","For $n=2^k+1$ lamps ($k \ge 1$), starting with the leftmost lamp on, prove that the sequence of states becomes periodic and never reaches the all-off state.","Consider the evolution for $n=2^k+1$. For the first $2^k-1$ steps, the state of the first $2^k$ lamps evolves almost as in the $n=2^k$ case. At time $t=2^k-1$, the state is $[1, \dots, 1, 0]$ where the first $2^k$ lamps are on. At time $t=2^k$, the state becomes $[0, \dots, 0, 1, 1]$. Notice that the state at $t=1$ is $[1, 1, 0, \dots, 0]$. The state at $t=2^k$ is the reverse of the state at $t=1$. Since the update rule is symmetric with respect to a left-right reversal of the lamps, the sequence of states starting from $t=2^k$ will be the time-reversed sequence of the states from $t=1$ to $t=2^k-1$. This implies the state configuration will eventually return to that of $t=1$, forming a cycle. This cycle does not contain the initial state $[1, 0, \ldots, 0]$ nor the all-off state $[0, 0, \ldots, 0]$. Thus, the lamps will never be all off.",Initially all the lamps are off except the leftmost one which is on. (a) Prove that there are infinitely many integers $n$ for which all the lamps will eventually be off. (b) Prove that there are infinitely many integers $n$ for which the lamps will never be all off.,"(a) Consider the infinite set of integers $n=2^k$ for $k \ge 1$. By Sub-problem 1, the system reaches the state where all lamps are on at time $t=2^k-1$. At the next step, $t=2^k$, every lamp $L_i$ and its neighbors are in the same state (on). According to the rule, each lamp is switched off. Thus, the system reaches the all-off state. \n(b) Consider the infinite set of integers $n=2^k+1$ for $k \ge 1$. By Sub-problem 2, the system of lamps enters a periodic sequence of states. This periodic cycle does not contain the all-off state. Therefore, for these values of $n$, the lamps will never be all off.",,
2006c3,"Let $S$ be a finite set of points in the plane such that no three of them are on a line. For each convex polygon $P$ whose vertices are in $S$, let $a(P)$ be the number of vertices of $P$, and let $b(P)$ be the number of points of $S$ which are outside $P$. Prove that for every real number $x$,
\[
\sum_P x^{a(P)} (1 - x)^{b(P)} = 1,
\]
where the sum is taken over all convex polygons with vertices in $S$.

\textit{NB.} A line segment, a point and the empty set are considered as convex polygons of 2, 1 and 0 vertices, respectively.","For each convex polygon $P$ whose vertices are in $S$, let $c(P)$ be the number of points of $S$ which are \textit{inside} $P$, so that $a(P) + b(P) + c(P) = n$, where $n = |S|$.

Denote $1 - x = y$, then
\[
\sum_P x^{a(P)} y^{b(P)} = \sum_P x^{a(P)} y^{b(P)} (x + y)^{c(P)} = \sum_P \sum_{i=0}^{c(P)} \binom{c(P)}{i} x^{a(P)+i} y^{b(P)+c(P)-i}.
\]

This expression is a homogeneous polynomial of degree $n$ in $x$ and $y$. The term $x^r y^{n-r}$ counts the number of ways to choose a convex polygon $P$ and a subset of $r - a(P)$ points inside $P$ such that the total chosen size is $r$.

But this corresponds bijectively to choosing any $r$-element subset of $S$, since any such subset uniquely splits into vertices of a convex hull $P$ and points inside $P$.

Therefore, the coefficient of $x^r y^{n-r}$ is $\binom{n}{r}$ and
\[
\sum_P x^{a(P)} y^{b(P)} = \sum_{r=0}^n \binom{n}{r} x^r y^{n-r} = (x + y)^n = 1.
\]",2,"Let $S$ be a finite set of $n$ points in the plane with no three collinear. For a convex polygon $P$ with vertices in $S$, let $a(P)$ be the number of its vertices and $c(P)$ be the number of points of $S$ in its interior. Prove that for any integer $r$ where $0 \le r \le n$, the binomial coefficient $\binom{n}{r}$ can be expressed as the sum $\sum_P \binom{c(P)}{r-a(P)}$ over all convex polygons $P$ with vertices in $S$.","We establish the identity by counting the number of $r$-element subsets of $S$ in two different ways. The first way is by definition, which gives $\binom{n}{r}$. For the second way, consider any $r$-element subset $R \subseteq S$. The convex hull of $R$, denoted $P=CH(R)$, has a set of vertices $V(P) \subseteq R$. The remaining points, $R \setminus V(P)$, lie in the interior of $P$. This gives a unique partition of $R$. Conversely, any pair $(P, A)$, where $P$ is a convex polygon with vertices $V(P) \subset S$ and $A$ is a set of points from $S$ in the interior of $P$, defines a unique subset $R = V(P) \cup A$. To form an $r$-element subset $R$ this way, we must have $|A| = r-a(P)$. For a fixed polygon $P$, the number of ways to choose $A$ is $\binom{c(P)}{r-a(P)}$. Summing over all possible polygons $P$ gives the total number of $r$-element subsets of $S$. Therefore, $\sum_P \binom{c(P)}{r-a(P)} = \binom{n}{r}$.","Let $S$ be a finite set of points in the plane such that no three of them are on a line. For each convex polygon $P$ whose vertices are in $S$, let $a(P)$ be the number of vertices of $P$, and let $b(P)$ be the number of points of $S$ which are outside $P$. Prove that for every real number $x$,
\[
\sum_P x^{a(P)} (1 - x)^{b(P)} = 1,
\]
where the sum is taken over all convex polygons with vertices in $S$.","Let $n = |S|$ and $c(P)$ be the number of points of $S$ inside $P$. We have $a(P)+b(P)+c(P)=n$. Let $y=1-x$. The sum is $\sum_P x^{a(P)} y^{b(P)}$. As $x+y=1$, we can write this as $\sum_P x^{a(P)} y^{b(P)} (x+y)^{c(P)}$. Expanding $(x+y)^{c(P)}$ using the binomial theorem gives $\sum_P x^{a(P)} y^{b(P)} \sum_{i=0}^{c(P)} \binom{c(P)}{i} x^i y^{c(P)-i} = \sum_P \sum_{i=0}^{c(P)} \binom{c(P)}{i} x^{a(P)+i} y^{n-a(P)-i}$. This is a homogeneous polynomial of degree $n$. The coefficient of $x^r y^{n-r}$ is found by setting $a(P)+i=r$, so it is $\sum_P \binom{c(P)}{r-a(P)}$. From the first sub-problem, this coefficient is $\binom{n}{r}$. Thus, the sum is equivalent to $\sum_{r=0}^n \binom{n}{r} x^r y^{n-r}$, which by the binomial theorem is $(x+y)^n = (x+1-x)^n = 1^n = 1$.",,,,
2006c4,"A cake has the form of an $n \times n$ square composed of $n^2$ unit squares. Strawberries lie on some of the unit squares so that each row or column contains exactly one strawberry; call this arrangement $\mathcal{A}$.

Let $\mathcal{B}$ be another such arrangement. Suppose that every grid rectangle with one vertex at the top left corner of the cake contains no fewer strawberries of arrangement $\mathcal{B}$ than of arrangement $\mathcal{A}$. Prove that arrangement $\mathcal{B}$ can be obtained from $\mathcal{A}$ by performing a number of \emph{switches}, defined as follows:

A \emph{switch} consists in selecting a grid rectangle with only two strawberries, situated at its top right corner and bottom left corner, and moving these two strawberries to the other two corners of that rectangle.","\textbf{Solution.} We use capital letters to denote unit squares; $O$ is the top left corner square. For any two squares $X$ and $Y$ let $[XY]$ be the smallest grid rectangle containing these two squares.

Strawberries lie on some squares in arrangement $\mathcal{A}$. Put a plum on each square of the target configuration $\mathcal{B}$. For a square $X$ denote by $a(X)$ and $b(X)$ respectively the number of strawberries and the number of plums in $[OX]$. By hypothesis $a(X) \leq b(X)$ for each $X$, with strict inequality for some $X$ (otherwise the two arrangements coincide and there is nothing to prove).

The idea is to show that by a legitimate switch one can obtain an arrangement $\mathcal{A}'$ such that
\[
a(X) \leq a'(X) \leq b(X) \quad \text{for each } X; \qquad \sum_X a(X) < \sum_X a'(X) \tag{1}
\]
(with $a'(X)$ defined analogously to $a(X)$; the sums range over all unit squares $X$). This will be enough because the same reasoning then applies to $\mathcal{A}'$, giving rise to a new arrangement $\mathcal{A}''$, and so on (induction). Since the sum increases but is bounded above by $\sum b(X)$, we eventually attain equality and thus match plums to strawberries.

Consider the uppermost row in which the plum and the strawberry lie on different squares $P$ and $S$ respectively; clearly $P$ must be situated left to $S$. In the column passing through $P$, let $T$ be the top square and $B$ the bottom square. The strawberry in that column lies below the plum. (There is no plum in that column above $P$, otherwise it contradicts choice of $P$.)

Hence there is at least one strawberry in the region $[BS]$ below $[PS]$. Let $V$ be the position of the lowest such strawberry in that region.

Denote by $W$ the square at the intersection of the row through $V$ with the column through $S$ and let $R$ be the square vertex-adjacent to $W$ up-left. We claim that
\[
a(X) < b(X) \qquad \text{for all } X \in [PR]. \tag{2}
\]
This is so because if $X \in [PR]$ then the portion of $[OX]$ left to column $[TB]$ contains at least as many plums as strawberries (by hypothesis); in the portion above the row through $P$ and $S$ we have perfect balance; and in the remaining portion (rectangle $[PX]$), we have a plum at $P$ and no strawberry.

Now we can perform the required switch. Let $U$ be the square at the intersection of the row through $P$ with the column through $V$ (some of $P, U, R$ can coincide). We move strawberries from squares $S$ and $V$ to squares $U$ and $W$. Then
\[
a'(X) = a(X) + 1 \quad \text{for } X \in [UR]; \qquad a'(X) = a(X) \quad \text{for other } X.
\]
And since the rectangle $[UR]$ is contained in $[PR]$, we still have $a'(X) \leq b(X)$ for all $X$, by (2); conditions (1) are satisfied and the proof is complete.",3,"Establish an inductive framework. Let arrangements $\mathcal{A}$ and $\mathcal{B}$ be represented by functions $a(X)$ and $b(X)$ counting items in any top-left rectangle $[OX]$. Given $a(X) \le b(X)$ for all squares $X$, show that if any arrangement $\mathcal{A} \neq \mathcal{B}$ can be transformed by one switch into an arrangement $\mathcal{A}'$ such that $a(X) \le a'(X) \le b(X)$ for all $X$ and $\sum_X a(X) < \sum_X a'(X)$, then $\mathcal{B}$ is obtainable from $\mathcal{A}$ by a sequence of switches.","Define a potential function $\Phi(\mathcal{A}) = \sum_{X} a(X)$, where the sum is over all $n^2$ unit squares $X$. The condition that a switch transforms $\mathcal{A}$ to $\mathcal{A}'$ such that $a(X) \le a'(X)$ for all $X$ and the sum strictly increases means $\Phi(\mathcal{A}) < \Phi(\mathcal{A}')$. Since $\Phi(\mathcal{A})$ is an integer bounded above by $\Phi(\mathcal{B})$, any sequence of such switches must be finite. The process terminates only when no such switch can be found, which can only happen if $a(X) = b(X)$ for all $X$, implying $\mathcal{A}=\mathcal{B}$. Thus, proving the existence of such a switch for any $\mathcal{A} \neq \mathcal{B}$ is sufficient.","For any arrangement $\mathcal{A} \ne \mathcal{B}$ satisfying $a(X) \le b(X)$, identify a pair of strawberries in $\mathcal{A}$ suitable for a switch, i.e., located at the top-right and bottom-left corners of some rectangle.","Since $\mathcal{A} \ne \mathcal{B}$, let $r_1$ be the uppermost row where they differ. Let the strawberry $S$ of $\mathcal{A}$ be at $(r_1, c_S)$ and the plum $P$ of $\mathcal{B}$ be at $(r_1, c_P)$. The condition $a(X) \le b(X)$ for a rectangle ending in row $r_1$ between columns $c_P$ and $c_S$ implies $c_P < c_S$. Let the strawberry in column $c_P$ be $V$ at position $(r_V, c_P)$. In all rows above $r_1$, the strawberry and plum positions are identical, so $V$ cannot be in a row $r_V < r_1$. Since $S$ is the strawberry in row $r_1$, we must have $r_V > r_1$. Thus, the strawberries $S$ at $(r_1, c_S)$ and $V$ at $(r_V, c_P)$ are at the top-right and bottom-left corners of a rectangle.","A cake has the form of an $n \times n$ square composed of $n^2$ unit squares. Strawberries lie on some of the unit squares so that each row or column contains exactly one strawberry; call this arrangement $\mathcal{A}$. Let $\mathcal{B}$ be another such arrangement. Suppose that every grid rectangle with one vertex at the top left corner of the cake contains no fewer strawberries of arrangement $\mathcal{B}$ than of arrangement $\mathcal{A}$. Prove that arrangement $\mathcal{B}$ can be obtained from $\mathcal{A}$ by performing a number of \emph{switches}, defined as follows:

A \emph{switch} consists in selecting a grid rectangle with only two strawberries, situated at its top right corner and bottom left corner, and moving these two strawberries to the other two corners of that rectangle.","If $\mathcal{A} = \mathcal{B}$, we are done. Otherwise, per sub-problem 2, we can find strawberries $S(r_1, c_S)$ and $V(r_V, c_P)$ with $r_1 < r_V$ and $c_P < c_S$, where a plum $P$ is at $(r_1, c_P)$. A switch moves $S$ and $V$ to $U(r_1, c_P)$ and $W(r_V, c_S)$, yielding arrangement $\mathcal{A}'$. This change increases the strawberry count $a'(X)$ by 1 if and only if $X$ is in the rectangle with corners $(r_1, c_P)$ and $(r_V-1, c_S-1)$. This ensures $a(X) \le a'(X)$ and $\sum a(X) < \sum a'(X)$. For any such $X$, we must verify $a'(X) \le b(X)$, which requires $a(X) < b(X)$. This strict inequality holds because in the rectangle $[OX]$, the plum at $P$ is counted in $b(X)$, but the strawberry $S$ is not in $[OX]$, while in all rows above $r_1$ counts are balanced. Thus, the switch is valid. By the inductive argument from sub-problem 1, a finite sequence of such switches transforms $\mathcal{A}$ into $\mathcal{B}$.",,
2006c6,"\textit{A holey triangle} is an upward equilateral triangle of side length $n$ with $n$ upward unit triangular holes cut out. A \textit{diamond} is a $60^\circ$锟斤拷锟?120^\circ$ unit rhombus. Prove that a holey triangle $T$ can be tiled with diamonds if and only if the following condition holds: Every upward equilateral triangle of side length $k$ in $T$ contains at most $k$ holes, for $1 \leq k \leq n$.","\textbf{Solution.} Let $T$ be a holey triangle. The unit triangles in it will be called \textit{cells}. We say simply ``triangle'' instead of ``upward equilateral triangle'' and ``size'' instead of ``side length.''

The necessity will be proven first. Assume that a holey triangle $T$ can be tiled with diamonds and consider such a tiling. Let $T'$ be a triangle of size $k$ in $T$ containing $h$ holes. Focus on the diamonds which cover (one or two) cells in $T'$. Let them form a figure $R$. The boundary of $T'$ consists of upward cells, so $R$ is a triangle of size $k$ with $h$ upward holes cut out and possibly some downward cells sticking out. Hence there are exactly $(k^2 + k)/2 - h$ upward cells in $R$, and at least $(k^2 - k)/2$ downward cells (not counting those sticking out). On the other hand each diamond covers one upward and one downward cell, which implies $(k^2 + k)/2 - h \ge (k^2 - k)/2$. It follows that $h \le k$, as needed.

We pass on to the sufficiency. For brevity, let us say that a set of holes in a given triangle $T$ is \textit{spread out} if every triangle of size $k$ in $T$ contains at most $k$ holes. For any set $S$ of spread out holes, a triangle of size $k$ will be called \textit{full} of $S$ if it contains exactly $k$ holes of $S$. The proof is based on the following observation.

\textbf{Lemma.} Let $S$ be a set of spread out holes in $T$. Suppose that two triangles $T'$ and $T''$ are full of $S$, and that they touch or intersect. Let $T' + T''$ denote the smallest triangle in $T$ containing them. Then $T' + T''$ is also full of $S$.

\textit{Proof.} Let triangles $T'$, $T''$, $T' \cap T''$ and $T' + T''$ have sizes $a$, $b$, $c$ and $d$, and let them contain $a$, $b$, $x$ and $y$ holes of $S$, respectively. (Note that $T' \cap T''$ could be a point, in which case $c = 0$.) Since $S$ is spread out, we have $x \le c$ and $y \le d$. The geometric configuration of triangles clearly satisfies $a + b = c + d$. Furthermore, $a + b \le x + y$, since $a + b$ counts twice the holes in $T' \cap T''$. These conclusions imply $x = c$ and $y = d$, as we wished to show. \hfill $\square$

Now let $T_n$ be a holey triangle of size $n$, and let the set $H$ of its holes be spread out. We show by induction on $n$ that $T_n$ can be tiled with diamonds. The base $n = 1$ is trivial. Suppose that $n \ge 2$ and that the claim holds for holey triangles of size less than $n$.

Denote by $B$ the bottom row of $T_n$ and by $T'$ the triangle formed by its top $n - 1$ rows. There is at least one hole in $B$ as $T'$ contains at most $n - 1$ holes. If this hole is only one, there is a unique way to tile $B$ with diamonds. Also, $T'$ contains exactly $n - 1$ holes, making it a holey triangle of size $n - 1$, and these holes are spread out. Hence it remains to apply the induction hypothesis.

So suppose that there are $m \ge 2$ holes in $B$ and label them $a_1, \dots, a_m$ from left to right. Let $\ell$ be the line separating $B$ from $T'$. For each $i = 1, \dots, m - 1$, pick an upward cell $b_i$ between $a_i$ and $a_{i+1}$ with base on $\ell$. Place a diamond to cover $b_i$ and its lower neighbour, a downward cell in $B$. The remaining part of $B$ can be tiled uniquely with diamonds. Remove from $T_n$ row $B$ and the cells $b_1, \dots, b_{m-1}$ to obtain a holey triangle $T_{n-1}$ of size $n - 1$. The conclusion will follow by induction if the choice of $b_1, \dots, b_{m-1}$ guarantees that the following condition is satisfied: If the holes $a_1, \dots, a_m$ are replaced by $b_1, \dots, b_{m-1}$ then the new set of holes is spread out again.

We show that such a choice is possible. The cells $b_1, \dots, b_{m-1}$ can be defined one at a time in this order, making sure that the above condition holds at each step. Thus it suffices to prove that there is an appropriate choice for $b_1$, and we set $a_1 = u$, $a_2 = v$ for clarity.

Let $\Delta$ be the triangle of maximum size which is full of $H$, contains the top vertex of the hole $u$, and has base on line $\ell$. Call $\Delta$ the \textit{associate} of $u$. Observe that $\Delta$ does not touch $v$. Indeed, if $\Delta$ has size $r$ then it contains $r$ holes of $T_n$. Extending its slanted sides downwards produces a triangle $\Delta'$ of size $r + 1$ containing at least one more hole, namely $u$. Since there are at most $r + 1$ holes in $\Delta'$, it cannot contain $v$. Consequently, $\Delta$ does not contain the top vertex of $v$.

Let $w$ be the upward cell with base on $\ell$ which is to the right of $\Delta$ and shares a common vertex with it. The observation above shows that $w$ is to the left of $v$. Note that $w$ is not a hole, or else $\Delta$ could be extended to a larger triangle full of $H$.

We prove that if the hole $u$ is replaced by $w$ then the new set of holes is spread out again. To verify this, we only need to check that if a triangle $\Gamma$ in $T_n$ contains $w$ but not $u$ then $\Gamma$ is not full of $H$. Suppose to the contrary that $\Gamma$ is full of $H$. Consider the minimum triangle $\Gamma + \Delta$ containing $\Gamma$ and the associate $\Delta$ of $u$. Clearly $\Gamma + \Delta$ is larger than $\Delta$, because $\Gamma$ contains $w$ but $\Delta$ does not. Next, $\Gamma + \Delta$ is full of $H \setminus \{u\}$ by the lemma, since $\Gamma$ and $\Delta$ have a common point and neither of them contains $u$.

If $\Gamma$ is above line $\ell$ then so is $\Gamma + \Delta$, which contradicts the maximum choice of $\Delta$. If $\Gamma$ contains cells from row $B$, observe that $\Gamma + \Delta$ contains $u$. Let $s$ be the size of $\Gamma + \Delta$. Being full of $H \setminus \{u\}$, $\Gamma + \Delta$ contains $s$ holes other than $u$. But it also contains $u$, contradicting the assumption that $H$ is spread out.

The claim follows, showing that $b_1 = w$ is an appropriate choice for $a_1 = u$ and $a_2 = v$. As explained above, this is enough to complete the induction.",4,"Prove that if a holey triangle $T$ of side length $n$ can be tiled with diamonds, then every upward equilateral triangle of side length $k$ in $T$ contains at most $k$ holes, for $1 \leq k \leq n$.","Assume a tiling exists. Let $T'$ be an upward equilateral triangle of size $k$ within $T$ containing $h$ holes. An upward equilateral triangle of size $k$ has $(k^2+k)/2$ upward unit triangles (cells) and $(k^2-k)/2$ downward unit cells. With $h$ holes, $T'$ contains $(k^2+k)/2 - h$ upward cells. The diamonds covering $T'$ cover these upward cells. Since each diamond covers one upward and one downward cell, the number of upward cells must be greater than or equal to the number of downward cells covered inside $T'$. Thus, $(k^2+k)/2 - h \geq (k^2-k)/2$, which simplifies to $h \leq k$.","Let a set of holes in a triangle be *spread out* if every upward equilateral triangle of size $k$ contains at most $k$ holes. A triangle is *full* if it has size $k$ and contains exactly $k$ holes. Prove that if two full triangles $T'$ and $T''$ touch or intersect, the smallest upward triangle containing them, $T' + T''$, is also full.","Let the sizes of $T'$, $T''$, $T' \cap T''$, and $T' + T''$ be $a, b, c, d$ respectively. Let them contain $a, b, x, y$ holes. The geometry of the triangles implies $a+b = c+d$. The number of holes in the union is $|H(T') \cup H(T'')| = |H(T')| + |H(T'')| - |H(T' \cap T'')|$, so $y = a+b-x$. Since the holes are spread out, we have $x \le c$ and $y \le d$. The total number of holes counted is $a+b = |H(T')|+|H(T'')| \le |H(T'\cup T'')| + |H(T' \cap T'')| = y+x$. Combining these, we get $c+d = a+b \le x+y \le c+d$. This forces all inequalities to be equalities, so $x=c$ and $y=d$. Thus, $T' + T''$ is full.","Let $H$ be a spread out set of holes in a triangle $T_n$. Let $u$ be one of the holes in the bottom row. Show that we can replace $u$ with a specific upward cell $w$ in the row immediately above, such that the new set of holes $H' = (H \setminus \{u\}) \cup \{w\}$ is also spread out.","Let $\ell$ be the line separating the bottom row from the triangle above it. Let $\Delta$ be the largest full triangle with its base on $\ell$ that contains the top vertex of hole $u$. Let $w$ be the upward cell on $\ell$ immediately to the right of $\Delta$. The maximality of $\Delta$ ensures $w$ is not a hole. Assume for contradiction that the new set of holes $H'$ is not spread out. Then there must be a triangle $\Gamma$ that is full with respect to $H \setminus \{u\}$ and contains $w$. By the lemma in sub-problem 2, $\Gamma + \Delta$ is full of $H \setminus \{u\}$. If $\Gamma$ is above $\ell$, then $\Gamma+\Delta$ is also above $\ell$, contradicting the maximality of $\Delta$. If $\Gamma$ intersects the bottom row, then $\Gamma+\Delta$ contains the original hole $u$. If $\Gamma+\Delta$ has size $s$, it contains $s$ holes from $H\setminus\{u\}$ plus the hole $u$, for a total of $s+1$ holes. This violates the condition that the original set of holes $H$ is spread out. Therefore, no such $\Gamma$ exists and $H'$ is spread out.","Prove that a holey triangle $T$ can be tiled with diamonds if and only if every upward equilateral triangle of side length $k$ in $T$ contains at most $k$ holes, for $1 \leq k \leq n$.","The 'only if' direction is proven in Sub-problem 1. For the 'if' direction, we use induction on the side length $n$. The base case $n=1$ is trivial. For $n>1$, assume the statement holds for triangles of size less than $n$. Let $T_n$ have a spread out set of holes $H$. The bottom row must contain $m \ge 1$ holes $a_1, \dots, a_m$. By repeatedly applying the result of Sub-problem 3, we can replace the holes $a_1, \dots, a_m$ with $m-1$ new holes $b_1, \dots, b_{m-1}$ in the row above, such that the new set of holes remains spread out in the remaining triangle of size $n-1$. The bottom row and the cells $b_i$ can be tiled with diamonds. The remaining holey triangle of size $n-1$ can be tiled by the induction hypothesis. Combining these tilings gives a valid tiling for $T_n$."
2006g1,"Let $ABC$ be a triangle with incenter $I$. A point $P$ in the interior of the triangle satisfies
\[
\angle PBA + \angle PCA = \angle PBC + \angle PCB.
\]
Show that $AP \geq AI$ and that equality holds if and only if $P$ coincides with $I$.","\textbf{Solution.} Let $\angle A = \alpha$, $\angle B = \beta$, $\angle C = \gamma$. Since $\angle PBA + \angle PCA + \angle PBC + \angle PCB = \beta + \gamma$, the condition from the problem statement is equivalent to $\angle PBC + \angle PCB = (\beta + \gamma)/2$, i.e.\ $\angle BPC = 90^\circ + \alpha/2$.

On the other hand $\angle BIC = 180^\circ - (\beta + \gamma)/2 = 90^\circ + \alpha/2$. Hence $\angle BPC = \angle BIC$, and since $P$ and $I$ are on the same side of $BC$, the points $B$, $C$, $I$ and $P$ are concyclic. In other words, $P$ lies on the circumcircle $\omega$ of triangle $BCI$.

Let $\Omega$ be the circumcircle of triangle $ABC$. It is a well-known fact that the centre of $\omega$ is the midpoint $M$ of the arc $BC$ of $\Omega$. This is also the point where the angle bisector $AI$ intersects $\Omega$.

From triangle $APM$ we have
\[
AP + PM \geq AM = AI + IM = AI + PM.
\]
Therefore $AP \geq AI$. Equality holds if and only if $P$ lies on the line segment $AI$, which occurs if and only if $P = I$.",2,"Let $ABC$ be a triangle with incenter $I$. If a point $P$ in the interior of the triangle satisfies $\angle PBA + \angle PCA = \angle PBC + \angle PCB$, show that $P$ lies on the circumcircle of triangle $BCI$.","Let $\angle B = \beta$ and $\angle C = \gamma$. The condition $\angle PBA + \angle PCA = \angle PBC + \angle PCB$ and the fact that $(\angle PBA + \angle PBC) + (\angle PCA + \angle PCB) = \beta + \gamma$ together imply that $2(\angle PBC + \angle PCB) = \beta + \gamma$, so $\angle PBC + \angle PCB = (\beta+\gamma)/2$. In $\triangle BPC$, this means $\angle BPC = 180^\circ - (\beta+\gamma)/2 = 90^\circ + \angle A/2$. For the incenter $I$, we have $\angle IBC = \beta/2$ and $\angle ICB = \gamma/2$, so $\angle BIC = 180^\circ - (\beta+\gamma)/2 = 90^\circ + \angle A/2$. Since $\angle BPC = \angle BIC$ and $P$ and $I$ are on the same side of $BC$, the points $B, C, I, P$ are concyclic. Thus $P$ lies on the circumcircle of $\triangle BCI$.","Let $ABC$ be a triangle with incenter $I$. A point $P$ in the interior of the triangle satisfies
\[
\angle PBA + \angle PCA = \angle PBC + \angle PCB.
\]
Show that $AP \geq AI$ and that equality holds if and only if $P$ coincides with $I$.","From the first sub-problem, the condition on $P$ implies that $P$ lies on the circumcircle $\omega$ of $\triangle BCI$. The center of $\omega$ is the point $M$ where the angle bisector of $\angle A$ intersects the circumcircle of $\triangle ABC$. Thus, $A, I, M$ are collinear. Since $P$ and $I$ are on $\omega$ with center $M$, we have $MP=MI$. By the triangle inequality in $\triangle APM$, we have $AP + PM \geq AM$. As $A, I, M$ are collinear, $AM = AI + IM$. Substituting this and $PM=IM$ into the inequality gives $AP + IM \geq AI + IM$, which simplifies to $AP \geq AI$. Equality holds if and only if $P$ lies on the line segment $AM$. Since $P$ must also lie on the circle $\omega$ and is inside $\triangle ABC$, the only possibility is $P=I$.",,,,
2006g2,"Let $ABCD$ be a trapezoid with parallel sides $AB > CD$. Points $K$ and $L$ lie on the line segments $AB$ and $CD$, respectively, so that $AK/KB = DL/LC$. Suppose that there are points $P$ and $Q$ on the line segment $KL$ satisfying
\[
\angle APB = \angle BCD \quad \text{and} \quad \angle CQD = \angle ABC.
\]
Prove that the points $P$, $Q$, $B$ and $C$ are concyclic.","Because $AB \parallel CD$, the relation $AK/KB = DL/LC$ readily implies that the lines $AD$, $BC$ and $KL$ have a common point $S$.

\medskip

Consider the second intersection points $X$ and $Y$ of the line $SK$ with the circles $(ABP)$ and $(CDQ)$, respectively. Since $APBX$ is a cyclic quadrilateral and $AB \parallel CD$, one has
\[
\angle AXB = 180^\circ - \angle APB = 180^\circ - \angle BCD = \angle ABC.
\]
This shows that $BC$ is tangent to the circle $(ABP)$ at $B$. Likewise, $BC$ is tangent to the circle $(CDQ)$ at $C$. Therefore $SP \cdot SX = SB^2$ and $SQ \cdot SY = SC^2$.

Let $h$ be the homothety with centre $S$ and ratio $SC/SB$. Since $h(B) = C$, the above conclusion about tangency implies that $h$ takes circle $(ABP)$ to circle $(CDQ)$. Also, $h$ takes $AB$ to $CD$, and it easily follows that $h(P) = Y$, $h(X) = Q$, yielding $SP/SY = SB/SC = SX/SQ$.

Equalities $SP \cdot SX = SB^2$ and $SQ \cdot SX = SC/SB$ imply $SP \cdot SQ = SB \cdot SC$, which is equivalent to $P$, $Q$, $B$ and $C$ being concyclic.",2,"Let $(APB)$ denote the circumcircle of triangle $APB$ and $(CDQ)$ denote the circumcircle of triangle $CDQ$. Prove that line $BC$ is tangent to circle $(APB)$ at point $B$, and also tangent to circle $(CDQ)$ at point $C$.","The condition $AK/KB = DL/LC$ on the parallel sides of the trapezoid implies that the lines $AD$, $BC$, and $KL$ are concurrent at a point, let's call it $S$. Let the circle $(APB)$ intersect the line $SKL$ at a second point $X$. In the cyclic quadrilateral $APBX$, we have $\angle AXB = 180^\circ - \angle APB$. From the problem statement, $\angle APB = \angle BCD$. Since $ABCD$ is a trapezoid with $AB \parallel CD$, $\angle ABC + \angle BCD = 180^\circ$. Therefore, $\angle AXB = 180^\circ - \angle BCD = \angle ABC$. By the converse of the tangent-secant theorem, this means line $BC$ is tangent to circle $(APB)$ at $B$. A similar argument, using the condition $\angle CQD = \angle ABC$, shows that line $BC$ is tangent to circle $(CDQ)$ at $C$.","Prove that the points $P$, $Q$, $B$ and $C$ are concyclic.","Let $S$ be the point of concurrency of lines $AD, BC, KL$. From the first sub-problem, we know that $SB$ is tangent to the circle $(APB)$ at $B$. By the power of a point theorem, $SB^2 = SP \cdot SX$, where $X$ is the second intersection of line $SKL$ with circle $(APB)$. Consider the homothety $h$ with center $S$ mapping $B$ to $C$. This homothety maps line $AB$ to $CD$ and, due to the tangency property, circle $(APB)$ to circle $(CDQ)$. It also maps the line $SKL$ to itself. Therefore, $h$ maps the intersection point $X$ to the intersection point $Q$. This implies the ratio of distances from the center $S$ is constant: $SQ/SX = SC/SB$. From the power of a point relation, we have $SX = SB^2/SP$. Substituting this into the homothety relation gives $SQ / (SB^2/SP) = SC/SB$, which simplifies to $SP \cdot SQ = SB \cdot SC$. By the converse of the power of a point theorem, as $S, B, C$ and $S, P, Q$ are sets of collinear points, this means points $P, Q, B, C$ are concyclic.",,,,
2006g3,"\textbf{G3.} Let $ABCDE$ be a convex pentagon such that
\[
\angle BAC = \angle CAD = \angle DAE \quad \text{and} \quad \angle ABC = \angle ACD = \angle ADE.
\]
The diagonals $BD$ and $CE$ meet at $P$. Prove that the line $AP$ bisects the side $CD$.","\textbf{Solution.} Let the diagonals $AC$ and $BD$ meet at $Q$, the diagonals $AD$ and $CE$ meet at $R$, and let the ray $AP$ meet the side $CD$ at $M$. We want to prove that $CM = MD$ holds.

The idea is to show that $Q$ and $R$ divide $AC$ and $AD$ in the same ratio, or more precisely
\[
\frac{AQ}{QC} = \frac{AR}{RD} \tag{1}
\]
(which is equivalent to $QR \parallel CD$). The given angle equalities imply that the triangles $ABC$, $ACD$ and $ADE$ are similar. We therefore have
\[
\frac{AB}{AC} = \frac{AC}{AD} = \frac{AD}{AE}.
\]
Since $\angle BAD = \angle BAC + \angle CAD = \angle CAD + \angle DAE = \angle CAE$, it follows from $AB/AC = AD/AE$ that the triangles $ABD$ and $ACE$ are also similar. Their angle bisectors in $A$ are $AQ$ and $AR$, respectively, so that
\[
\frac{AB}{AC} = \frac{AQ}{AR}.
\]
Because $AB/AC = AC/AD$, we obtain $AQ/AR = AC/AD$, which is equivalent to (1). Now Ceva锟斤拷锟絪 theorem for the triangle $ACD$ yields
\[
\frac{AQ}{QC} \cdot \frac{CM}{MD} \cdot \frac{DR}{RA} = 1.
\]
In view of (1), this reduces to $CM = MD$, which completes the proof.

\textbf{Comment.} Relation (1) immediately follows from the fact that quadrilaterals $ABCD$ and $ACDE$ are similar.",2,"Let $Q$ be the intersection of diagonals $AC$ and $BD$, and $R$ be the intersection of diagonals $AD$ and $CE$. Prove that $\frac{AQ}{QC} = \frac{AR}{RD}$.","The given angle equalities $\angle BAC = \angle CAD = \angle DAE$ and $\angle ABC = \angle ACD = \angle ADE$ imply the similarity of triangles $\triangle ABC \sim \triangle ACD \sim \triangle ADE$. From this, we have the ratio of corresponding sides $\frac{AB}{AC} = \frac{AC}{AD} = \frac{AD}{AE}$. Also, $\angle BAD = \angle BAC + \angle CAD$ and $\angle CAE = \angle CAD + \angle DAE$, so $\angle BAD = \angle CAE$. From the side ratios, we have $\frac{AB}{AC} = \frac{AD}{AE}$, which rearranges to $\frac{AB}{AD} = \frac{AC}{AE}$. By SAS similarity, $\triangle ABD \sim \triangle ACE$. In this similarity, point $Q$ (intersection of cevian $AC$ and side $BD$ in $\triangle ABD$) corresponds to point $R$ (intersection of the corresponding cevian $AD$ and side $CE$ in $\triangle ACE$). Therefore, the ratio of distances from vertex A is equal to the similarity ratio: $\frac{AQ}{AR} = \frac{AB}{AC}$. Since we know $\frac{AB}{AC} = \frac{AC}{AD}$, we get $\frac{AQ}{AR} = \frac{AC}{AD}$, which implies $\frac{AQ}{AC} = \frac{AR}{AD}$. This states that $Q$ and $R$ divide segments $AC$ and $AD$ proportionally, which is equivalent to $\frac{AQ}{QC} = \frac{AR}{RD}$.",Let $ABCDE$ be a convex pentagon such that $\angle BAC = \angle CAD = \angle DAE$ and $\angle ABC = \angle ACD = \angle ADE$. The diagonals $BD$ and $CE$ meet at $P$. Prove that the line $AP$ bisects the side $CD$.,"Let $Q = AC \cap BD$, $R = AD \cap CE$, and let the line $AP$ intersect the side $CD$ at $M$. Consider the triangle $ACD$. The lines $AM$, $CR$ (which is a segment of $CE$), and $DQ$ (which is a segment of $BD$) are cevians. Since $P = BD \cap CE$, the lines $DQ$ and $CR$ intersect at $P$. As $AM$ also passes through $P$, the three cevians $AM$, $CR$, and $DQ$ are concurrent at $P$. By Ceva's theorem on $\triangle ACD$, we have $\frac{AQ}{QC} \cdot \frac{CM}{MD} \cdot \frac{DR}{RA} = 1$. From the first sub-problem, we know that $\frac{AQ}{QC} = \frac{AR}{RD}$. Substituting this into the Ceva equation yields $\frac{AR}{RD} \cdot \frac{CM}{MD} \cdot \frac{DR}{RA} = 1$. This simplifies to $\frac{CM}{MD} = 1$, which means $CM = MD$. Therefore, the line $AP$ bisects the side $CD$.",,,,
2006g4,"\textbf{G4.} A point $D$ is chosen on the side $AC$ of a triangle $ABC$ with $\angle C < \angle A < 90^\circ$ in such a way that $BD = BA$. The incircle of $ABC$ is tangent to $AB$ and $AC$ at points $K$ and $L$, respectively. Let $J$ be the incenter of triangle $BCD$. Prove that the line $KL$ intersects the line segment $AJ$ at its midpoint.","\textbf{Solution.} Denote by $P$ the common point of $AJ$ and $KL$. Let the parallel to $KL$ through $J$ meet $AC$ at $M$. Then $P$ is the midpoint of $AJ$ if and only if $AM = 2 \cdot AL$, which we are about to show.

\medskip

Denoting $\angle BAC = 2\alpha$, the equalities $BA = BD$ and $AK = AL$ imply $\angle ADB = 2\alpha$ and $\angle ALK = 90^\circ - \alpha$. Since $DJ$ bisects $\angle BDC$, we obtain
\[
\angle CDJ = \tfrac{1}{2}(180^\circ - \angle ADB) = 90^\circ - \alpha.
\]
Also $\angle DMJ = \angle ALK = 90^\circ - \alpha$ since $JM \parallel KL$. It follows that $JD = JM$.

Let the incircle of triangle $BCD$ touch its side $CD$ at $T$. Then $JT \perp CD$, meaning that $JT$ is the altitude to the base $DM$ of the isosceles triangle $DMJ$. It now follows that $DT = MT$, and we have
\[
DM = 2 \cdot DT = BD + CD - BC.
\]
Therefore
\begin{align*}
AM &= AD + (BD + CD - BC) \\
   &= AD + AB + DC - BC \\
   &= AC + AB - BC \\
   &= 2 \cdot AL,
\end{align*}
which completes the proof.",2,Let J be the incenter of triangle BCD. A line through J parallel to KL meets AC at M. Prove that AM = AC + AB - BC.,"Let ∠BAC = 2α. Since BA=BD and AK=AL, we have ∠ADB = 2α and ∠ALK = 90°-α. As J is the incenter of ΔBCD, DJ bisects ∠BDC, which gives ∠CDJ = (180°-∠ADB)/2 = 90°-α. The line JM is parallel to KL, so ∠DMJ = ∠ALK = 90°-α. Thus, ΔDJM is isosceles with JD=JM. Let the incircle of ΔBCD touch CD at T. JT is the altitude to base DM, so T is the midpoint of the segment DM, giving DM = 2DT. We know DT = (BD+CD-BC)/2, so DM = BD+CD-BC. Then AM = AD+DM = AD+BD+CD-BC. Since AD+CD=AC and BD=BA, we have AM = AC+AB-BC.","A point D is chosen on the side AC of a triangle ABC with ∠C < ∠A < 90° in such a way that BD = BA. The incircle of ABC is tangent to AB and AC at points K and L, respectively. Let J be the incenter of triangle BCD. Prove that the line KL intersects the line segment AJ at its midpoint.","Let P be the intersection of AJ and KL. Let a line through J parallel to KL meet AC at M. In ΔAJM, the line segment PL is parallel to the side JM. By Thales' theorem, P is the midpoint of AJ if and only if L is the midpoint of AM, which is equivalent to AM = 2AL. The distance from vertex A to the tangent point L of the incircle of ΔABC is given by the formula AL = (AB+AC-BC)/2. From the first sub-problem, we established that AM = AC+AB-BC. Therefore, AM = 2 * ((AB+AC-BC)/2) = 2AL. This proves that P is the midpoint of AJ.",,,,
2006g6,"Circles $\omega_1$ and $\omega_2$ with centres $O_1$ and $O_2$ are externally tangent at point $D$ and internally tangent to a circle $\omega$ at points $E$ and $F$, respectively. Line $t$ is the common tangent of $\omega_1$ and $\omega_2$ at $D$. Let $AB$ be the diameter of $\omega$ perpendicular to $t$, so that $A$, $E$ and $O_1$ are on the same side of $t$. Prove that lines $AO_1$, $BO_2$, $EF$ and $t$ are concurrent.","Point $E$ is the centre of a homothety $h$ which takes circle $\omega_1$ to circle $\omega$. The radii $O_1D$ and $OB$ of these circles are parallel as both are perpendicular to line $t$. Also, $O_1D$ and $OB$ are on the same side of line $EO$, hence $h$ takes $O_1D$ to $OB$. Consequently, points $E$, $D$ and $B$ are collinear. Likewise, points $F$, $D$ and $A$ are collinear as well.

Let lines $AE$ and $BF$ intersect at $C$. Since $AF$ and $BE$ are altitudes in triangle $ABC$, their common point $D$ is the orthocentre of this triangle. So $CD$ is perpendicular to $AB$, implying that $C$ lies on line $t$. Note that triangle $ABC$ is acute-angled. We mention the well-known fact that triangles $FEC$ and $ABC$ are similar in ratio $\cos \gamma$, where $\gamma = \angle ACB$. In addition, points $C$, $E$, $D$ and $F$ lie on the circle with diameter $CD$.

Let $P$ be the common point of lines $EF$ and $t$. We are going to prove that $P$ lies on line $AO_1$. Denote by $N$ the second common point of circle $\omega_1$ and $AC$; this is the point of $\omega_1$ diametrically opposite to $D$. By Menelaus锟斤拷锟?theorem for triangle $DCN$, points $A$, $O_1$ and $P$ are collinear if and only if
\[
\frac{CA}{AN} \cdot \frac{NO_1}{O_1D} \cdot \frac{DP}{PC} = 1.
\]
Because $NO_1 = O_1D$, this reduces to $CA/AN = CP/PD$. Let line $t$ meet $AB$ at $K$. Then $CA/AN = CK/KD$, so it suffices to show that
\[
\frac{CP}{PD} = \frac{CK}{KD}. \tag{1}
\]

To verify (1), consider the circumcircle $\Omega$ of triangle $ABC$. Draw its diameter $CU$ through $C$, and let $CU$ meet $AB$ at $V$. Extend $CK$ to meet $\Omega$ at $L$. Since $AB$ is parallel to $UL$, we have $\angle ACU = \angle BCL$. On the other hand $\angle EFC = \angle BAC$, $\angle FEC = \angle ABC$ and $EF/AB = \cos \gamma$, as stated above. So reflection in the bisector of $\angle ACB$ followed by a homothety with centre $C$ and ratio $1/\cos \gamma$ takes triangle $FEC$ to triangle $ABC$. Consequently, this transformation takes $CD$ to $CU$, which implies $CP/PD = CV/VU$. Next, we have $KL = KD$, because $D$ is the orthocentre of triangle $ABC$. Hence $CK/KD = CK/KL$. Finally, $CV/VU = CK/KL$ because $AB$ is parallel to $UL$. Relation (1) follows, proving that $P$ lies on line $AO_1$. By symmetry, $P$ also lies on line $AO_2$ which completes the solution.",3,"Prove that points A, F, D are collinear, and points B, E, D are collinear.","Consider the homothety centered at E that maps circle ω₁ to ω. It maps point D on ω₁ to a point on ω where the tangent is parallel to line t. The only such points on ω are the endpoints A and B of the diameter perpendicular to t. Based on the given condition that A, E, O₁ are on the same side of t, it can be shown that D is mapped to B. Thus, E, D, B are collinear. Symmetrically, the homothety centered at F mapping ω₂ to ω maps D to A, so F, D, A are collinear.",Let C be the intersection of lines AE and BF. Prove that D is the orthocenter of triangle ABC and that C lies on the line t.,"From Sub-problem 1, lines AD and BD are the same as lines AF and BE. Since AB is a diameter of ω and E, F are on ω, we have ∠AFB = 90° and ∠AEB = 90°. With C defined as the intersection of AE and BF, this means AF ⊥ BC and BE ⊥ AC. Thus, AF and BE are altitudes of ΔABC. Their intersection, D, is the orthocenter. The third altitude, from C to AB, must pass through D, so CD ⊥ AB. By definition, line t also passes through D and is perpendicular to AB. Hence, C must lie on line t.","Prove that lines AO₁, BO₂, EF and t are concurrent.","Let P be the intersection of line EF and line t. We will prove that P lies on AO₁; the proof for BO₂ is symmetric. From Sub-problem 2, the intersection of AE and BF, point C, lies on t, and D is the orthocenter of ΔABC. To show that A, O₁, P are collinear, we can apply Menelaus's theorem to a suitably chosen triangle (e.g., ΔDCN where N is diametrically opposite to D on ω₁). The collinearity condition can be reduced to a ratio equality involving lengths of segments on lines AC and CD. This equality can be established using properties of the orthocenter configuration. As P lies on t and EF by definition, and is also proven to lie on AO₁ and (by symmetry) BO₂, the four lines are concurrent at P.",,
2006g7,"In a triangle $ABC$, let $M_a, M_b, M_c$ be respectively the midpoints of the sides $BC$, $CA$, $AB$ and $T_a, T_b, T_c$ be the midpoints of the arcs $BC$, $CA$, $AB$ of the circumcircle of $ABC$, not containing the opposite vertices. For $i \in \{a,b,c\}$, let $\omega_i$ be the circle with $M_iT_i$ as diameter. Let $p_i$ be the common external tangent to $\omega_j$, $\omega_k$ ($\{i,j,k\} = \{a,b,c\}$) such that $\omega_i$ lies on the opposite side of $p_i$ than $\omega_j$, $\omega_k$ do. Prove that the lines $p_a, p_b, p_c$ form a triangle similar to $ABC$ and find the ratio of similitude.","\textbf{Solution.} Let $T_aT_b$ intersect circle $\omega_b$ at $T_b$ and $U$, and let $T_aT_c$ intersect circle $\omega_c$ at $T_c$ and $V$. Further, let $UX$ be the tangent to $\omega_b$ at $U$, with $X$ on $AC$, and let $VY$ be the tangent to $\omega_c$ at $V$, with $Y$ on $AB$. The homothety with centre $T_b$ and ratio $T_bT_a/T_bU$ maps the circle $\omega_b$ onto the circumcircle of $ABC$ and the line $UX$ onto the line tangent to the circumcircle at $T_a$, which is parallel to $BC$; thus $UX \parallel BC$. The same is true of $VY$, so that $UX \parallel BC \parallel VY$.

Let $T_aT_b$ cut $AC$ at $P$ and let $T_aT_c$ cut $AB$ at $Q$. The point $X$ lies on the hypotenuse $PM_b$ of the right triangle $PUM_b$ and is equidistant from $U$ and $M_b$. So $X$ is the midpoint of $M_bP$. Similarly $Y$ is the midpoint of $M_cQ$.

Denote the incenter of triangle $ABC$ as usual by $I$. It is a known fact that $T_aI = T_aB$ and $T_cI = T_cB$. Therefore the points $B$ and $I$ are symmetric across $T_aT_c$, and consequently
\[
\angle QIB = \angle QBI = \angle IBC.
\]
This implies that $BC$ is parallel to the line $IQ$, and likewise, to $IP$. In other words, $PQ$ is the line parallel to $BC$ passing through $I$.

Clearly $M_bM_c \parallel BC$. So $PM_bM_cQ$ is a trapezoid and the segment $XY$ connects the midpoints of its nonparallel sides; hence $XY \parallel BC$. This combined with the previously established relations $UX \parallel BC \parallel VY$ shows that all the four points $U, X, Y, V$ lie on a line which is the common tangent to circles $\omega_b$, $\omega_c$. Since it leaves these two circles on one side and the circle $\omega_a$ on the other, this line is just the line $p_a$ from the problem statement.

Line $p_a$ runs midway between $I$ and $M_bM_c$. Analogous conclusions hold for the lines $p_b$ and $p_c$. So these three lines form a triangle homothetic from centre $I$ to triangle $M_aM_bM_c$ in ratio $1/2$, hence similar to $ABC$ in ratio $1/4$.",3,Let $I$ be the incenter of triangle $ABC$. Show that the common external tangent $p_a$ to circles $\omega_b$ and $\omega_c$ is the line parallel to $BC$ that lies midway between the line $M_bM_c$ and the line through $I$ parallel to $BC$.,"It is a known property that the points $T_a, T_b, T_c$ are centers of circles passing through pairs of vertices and the incenter $I$; for instance $T_aI=T_aB=T_aC$. This implies that the line $PQ$, where $P = T_aT_b \cap AC$ and $Q = T_aT_c \cap AB$, passes through $I$ and is parallel to $BC$. Using homothety, one can show that the tangent line $p_a$ is parallel to $BC$. Further geometric considerations show that the points of tangency of $p_a$ with the lines $AB$ and $AC$ are the midpoints of the segments $QM_c$ and $PM_b$. This implies that $p_a$ is the midline of the trapezoid $PM_bM_cQ$. Therefore, $p_a$ is the line parallel to $BC$ that is midway between the line $M_bM_c$ and the line $PQ$ (the line through $I$ parallel to $BC$).","Let $\\Delta_p$ be the triangle formed by the lines $p_a, p_b, p_c$. Show that $\\Delta_p$ is homothetic to the medial triangle $M_aM_bM_c$ with the incenter $I$ as the center of homothety and a ratio of $1/2$.","From the previous result, the line $p_a$ is the line midway between the line segment $M_bM_c$ and the incenter $I$. By symmetry, $p_b$ is midway between $M_aM_c$ and $I$, and $p_c$ is midway between $M_aM_b$ and $I$. Let the lines containing the sides of the medial triangle $M_aM_bM_c$ be $l_a, l_b, l_c$. The lines $p_a, p_b, p_c$ are the mid-parallels between the sides of the medial triangle and the incenter $I$. This configuration implies that the triangle $\\Delta_p$ formed by $p_a, p_b, p_c$ is the image of the medial triangle $M_aM_bM_c$ under a homothety centered at $I$ with a ratio of $1/2$.","Prove that the lines $p_a, p_b, p_c$ form a triangle similar to $ABC$ and find the ratio of similitude.","From the second sub-problem, the triangle $\\Delta_p$ formed by lines $p_a, p_b, p_c$ is homothetic to the medial triangle $\triangle M_aM_bM_c$ with ratio $1/2$. Thus, $\\Delta_p$ is similar to $\triangle M_aM_bM_c$ with a ratio of similitude of $1/2$. The medial triangle $\triangle M_aM_bM_c$ is itself similar to $\triangle ABC$, with a ratio of similitude of $1/2$. By transitivity of similarity, $\\Delta_p$ is similar to $\triangle ABC$. The ratio of similitude is the product of the individual ratios, which is $(1/2) \times (1/2) = 1/4$.",,
2006g8,"Let $ABCD$ be a convex quadrilateral. A circle passing through the points $A$ and $D$ and a circle passing through the points $B$ and $C$ are externally tangent at a point $P$ inside the quadrilateral. Suppose that
\[
\angle PAB + \angle PDC \leq 90^\circ \quad \text{and} \quad \angle PBA + \angle PCD \leq 90^\circ.
\]
Prove that $AB + CD \geq BC + AD$.","\textbf{Solution.} We start with a preliminary observation. Let $T$ be a point inside the quadrilateral $ABCD$. Then:
\[
\text{Circles } (BCT) \text{ and } (DAT) \text{ are tangent at } T \quad \text{if and only if} \quad \angle ADT + \angle BCT = \angle ATB. \tag{1}
\]
Indeed, if the two circles touch each other then their common tangent at $T$ intersects the segment $AB$ at a point $Z$, and so $\angle ADT = \angle ATZ$, $\angle BCT = \angle BTZ$, by the tangent-chord theorem. Thus $\angle ADT + \angle BCT = \angle ATZ + \angle BTZ = \angle ATB$.

And conversely, if $\angle ADT + \angle BCT = \angle ATB$ then one can draw from $T$ a ray $TZ$ with $Z$ on $AB$ so that $\angle ADT = \angle ATZ$, $\angle BCT = \angle BTZ$. The first of these equalities implies that $TZ$ is tangent to the circle $(DAT)$; by the second equality, $TZ$ is tangent to the circle $(BCT)$, so the two circles are tangent at $T$.

\medskip

So the equivalence (1) is settled. It will be used later on. Now pass to the actual solution. Its key idea is to introduce the circumcircles of triangles $ABP$ and $CDP$ and to consider their second intersection $Q$ (assume for the moment that they indeed meet at two distinct points $P$ and $Q$).

Since the point $A$ lies outside the circle $(BCP)$, we have $\angle BCP + \angle BAP < 180^\circ$. Therefore the point $C$ lies outside the circle $(DAP)$. Analogously, $D$ also lies outside that circle. It follows that $P$ and $Q$ lie on the same arc $CD$ of the circle $(BCP)$.

By symmetry, $P$ and $Q$ lie on the same arc $AB$ of the circle $(ABP)$. Thus the point $Q$ lies either inside the angle $BPC$ or inside the angle $APD$. Without loss of generality assume that $Q$ lies inside the angle $BPC$. Then
\[
\angle AQD = \angle PQA + \angle PQD = \angle PBA + \angle PCD \leq 90^\circ, \tag{2}
\]
by the condition of the problem.

In the cyclic quadrilaterals $APQB$ and $DPQC$, the angles at vertices $A$ and $D$ are acute. So their angles at $Q$ are obtuse. This implies that $Q$ lies not only inside the angle $BPC$ but in fact inside the triangle $BPC$, hence also inside the quadrilateral $ABCD$.

Now an argument similar to that used in deriving (2) shows that
\[
\angle BQC = \angle PAB + \angle PDC \leq 90^\circ. \tag{3}
\]
Moreover, since $\angle PCQ = \angle PDQ$, we get
\begin{align*}
\angle ADQ + \angle BCQ &= \angle ADP + \angle PDQ + \angle BCP - \angle PCQ \\
&= \angle ADP + \angle BCP.
\end{align*}
The last sum is equal to $\angle APB$, according to the observation (1) applied to $T = P$. And because $\angle APB = \angle AQB$, we obtain
\[
\angle ADQ + \angle BCQ = \angle AQB.
\]
Applying now (1) to $T = Q$ we conclude that the circles $(BCQ)$ and $(DAQ)$ are externally tangent at $Q$. (We have assumed $P \ne Q$; but if $P = Q$ then the last conclusion holds trivially.)

Finally consider the halfdiscs with diameters $BC$ and $DA$ constructed inwardly to the quadrilateral $ABCD$. They have centres at $M$ and $N$, the midpoints of $BC$ and $DA$ respectively. In view of (2) and (3), these two halfdiscs lie entirely inside the circles $(BQC)$ and $(AQD)$; and since these circles are tangent, the two halfdiscs cannot overlap. Hence
\[
MN \geq \tfrac{1}{2} BC + \tfrac{1}{2} DA.
\]
On the other hand, since $\overrightarrow{MN} = \tfrac{1}{2}(\overrightarrow{BA} + \overrightarrow{CD})$, we have
\[
MN \leq \tfrac{1}{2}(AB + CD).
\]
Thus indeed
\[
AB + CD \geq BC + DA,
\]
as claimed.",4,Let T be a point inside a convex quadrilateral ABCD. Prove that the circumcircles of △DAT and △BCT are tangent at T if and only if ∠ADT + ∠BCT = ∠ATB.,"Let the line tangent to the circumcircle of △DAT at T intersect AB at a point Z. By the tangent-chord theorem, this tangency is equivalent to ∠ADT = ∠ATZ. Similarly, the circumcircle of △BCT is tangent to the line TZ at T if and only if ∠BCT = ∠BTZ. The two circles are tangent at T if and only if they share a common tangent line at T, which means both conditions hold. Summing them gives ∠ADT + ∠BCT = ∠ATZ + ∠BTZ = ∠ATB. This establishes the equivalence.",Let P be as in the original problem statement. Let Q be the second point of intersection of the circumcircles of △ABP and △CDP. Prove that ∠AQD ≤ 90° and ∠BQC ≤ 90°.,"Since Q is on the circumcircles of △ABP and △CDP, the quadrilaterals APQB and DPQC are cyclic. From cyclic quadrilateral APQB, we have ∠PQA = ∠PBA. From cyclic quadrilateral DPQC, we have ∠PQD = ∠PCD. Therefore, ∠AQD = ∠PQA + ∠PQD = ∠PBA + ∠PCD ≤ 90° by the problem's condition. Similarly, from the same cyclic quadrilaterals, ∠BQP = ∠BAP and ∠CQP = ∠CDP. Thus, ∠BQC = ∠BQP + ∠CQP = ∠PAB + ∠PDC ≤ 90° by the given conditions.","With Q defined as the second intersection of the circumcircles of △ABP and △CDP, prove that the circumcircles of △DAQ and △BCQ are externally tangent at Q.","From the problem statement, circles (ADP) and (BCP) are tangent at P. By the result of the first sub-problem, this means ∠ADP + ∠BCP = ∠APB. Since A, P, Q, B are concyclic, ∠APB = ∠AQB. Now consider the sum ∠ADQ + ∠BCQ = (∠ADP + ∠PDQ) + (∠BCP - ∠PCQ). Since D, P, Q, C are concyclic, ∠PDQ = ∠PCQ. Therefore, ∠ADQ + ∠BCQ = ∠ADP + ∠BCP = ∠APB = ∠AQB. Again, by the criterion from the first sub-problem, the circles (DAQ) and (BCQ) are tangent at Q.",Let ABCD be a convex quadrilateral. A circle passing through the points A and D and a circle passing through the points B and C are externally tangent at a point P inside the quadrilateral. Suppose that ∠PAB + ∠PDC ≤ 90° and ∠PBA + ∠PCD ≤ 90°. Prove that AB + CD ≥ BC + AD.,"From the previous sub-problems, we established the existence of a point Q such that the circles (DAQ) and (BCQ) are tangent at Q, and that ∠AQD ≤ 90° and ∠BQC ≤ 90°. Let M and N be the midpoints of BC and DA respectively. The condition ∠BQC ≤ 90° implies that the half-disc with diameter BC is contained in the circle (BQC). Similarly, the half-disc with diameter DA is contained in the circle (DAQ). Since these circles are externally tangent, the two half-discs do not overlap. The distance between their centers must be at least the sum of their radii, so MN ≥ (1/2)BC + (1/2)DA. By the triangle inequality for vectors, MN = |(1/2)(→BA + →CD)| ≤ (1/2)(AB + CD). Combining the inequalities gives (1/2)(AB+CD) ≥ (1/2)(BC+AD), which implies AB + CD ≥ BC + AD."
2006g9,"Points $A_1, B_1, C_1$ are chosen on the sides $BC$, $CA$, $AB$ of a triangle $ABC$, respectively. The circumcircles of triangles $AB_1C_1$, $BC_1A_1$, $CA_1B_1$ intersect the circumcircle of triangle $ABC$ again at points $A_2, B_2, C_2$, respectively ($A_2 \ne A$, $B_2 \ne B$, $C_2 \ne C$). Points $A_3, B_3, C_3$ are symmetric to $A_1, B_1, C_1$ with respect to the midpoints of the sides $BC$, $CA$, $AB$ respectively. Prove that the triangles $A_2B_2C_2$ and $A_3B_3C_3$ are similar.","\textbf{Solution.} We will work with oriented angles between lines. For two straight lines $\ell, m$ in the plane, $\angle(\ell, m)$ denotes the angle of counterclockwise rotation which transforms line $\ell$ into a line parallel to $m$ (the choice of the rotation centre is irrelevant). This is a signed quantity; values differing by a multiple of $\pi$ are identified, so that
\[
\angle(\ell, m) = -\angle(m, \ell), \qquad \angle(\ell, m) + \angle(m, n) = \angle(\ell, n).
\]

If $\ell$ is the line through points $K, L$ and $m$ is the line through $M, N$, one writes $\angle(KL, MN)$ for $\angle(\ell, m)$; the characters $K, L$ are freely interchangeable; and so are $M, N$.

The counterpart of the classical theorem about cyclic quadrilaterals is the following:

\textit{If $K, L, M, N$ are four noncollinear points in the plane, then}
\[
K, L, M, N \text{ are concyclic if and only if } \angle(KM, LM) = \angle(KN, LN). \tag{1}
\]

Passing to the solution proper, we first show that the three circles $(AB_1C_1)$, $(BC_1A_1)$, $(CA_1B_1)$ have a common point. So, let $(AB_1C_1)$ and $(BC_1A_1)$ intersect at the points $C_1$ and $P$. Then by (1)
\[
\angle(PA_1, CA_1) = \angle(PA_1, BA_1) = \angle(PC_1, BC_1)
= \angle(PC_1, AC_1) = \angle(PB_1, AB_1) = \angle(PB_1, CB_1).
\]
Denote this angle by $\varphi$.

The equality between the outer terms shows, again by (1), that the points $A_1, B_1, P, C$ are concyclic. Thus $P$ is the common point of the three mentioned circles.

Now from the basic property (1) we will use without explicit reference. We have
\[
\varphi = \angle(PA_1, BC) = \angle(PB_1, CA) = \angle(PC_1, AB). \tag{2}
\]

Let lines $A_2P, B_2P, C_2P$ meet the circle $(ABC)$ again at $A_4, B_4, C_4$, respectively. As
\[
\angle(A_4A_2, AA_2) = \angle(PA_2, AA_2) = \angle(PC_1, AC_1) = \angle(PC_1, AB) = \varphi,
\]
we see that line $A_2A$ is the image of line $A_2A_4$ under rotation about $A_2$ by the angle $\varphi$. Hence the point $A$ is the image of $A_4$ under rotation by $2\varphi$ about $O$, the centre of $(ABC)$. The same rotation sends $B_4$ to $B$ and $C_4$ to $C$. Triangle $ABC$ is the image of $A_4B_4C_4$ in this map. Thus
\[
\angle(A_4B_4, AB) = \angle(B_4C_4, BC) = \angle(C_4A_4, CA) = 2\varphi. \tag{3}
\]
Since the rotation by $2\varphi$ about $O$ takes $B_4$ to $B$, we have $\angle(AB_4, AB) = \varphi$. Hence by (2)
\[
\angle(AB_4, PC_1) = \angle(AB_4, AB) + \angle(AB, PC_1) = \varphi + (-\varphi) = 0,
\]
which means that $AB_4 \parallel PC_1$.

Let $C_5$ be the intersection of lines $PC_1$ and $A_4B_4$; define $A_5, B_5$ analogously. So $AB_4 \parallel C_1C_5$ and, by (3) and (2),
\[
\angle(A_4B_4, PC_1) = \angle(A_4B_4, AB) + \angle(AB, PC_1) = 2\varphi + (-\varphi) = \varphi; \tag{4}
\]
i.e., $\angle(B_4C_5, C_5C_1) = \varphi$. This combined with $\angle(C_5C_1, C_1A) = \angle(PC_1, AB) = \varphi$ (see (2)) proves that the quadrilateral $AB_4C_5C_1$ is an isosceles trapezoid with $AC_1 = B_4C_5$.

Interchanging the roles of $A$ and $B$ we infer that also $BC_1 = A_4C_5$. And since $AC_1 + BC_1 = AB = A_4B_4$, it follows that the point $C_5$ lies on the line segment $A_4B_4$ and partitions it into segments $A_4C_5$, $B_4C_5$ of lengths $BC_1 (= AC_3)$ and $AC_1 (= BC_3)$. In other words, the rotation which maps triangle $A_4B_4C_4$ onto $ABC$ carries $C_5$ onto $C_3$. Likewise, it sends $A_5$ to $A_3$ and $B_5$ to $B_3$. So the triangles $A_3B_3C_3$ and $A_5B_5C_5$ are congruent. It now suffices to show that the latter is similar to $A_2B_2C_2$.

Lines $B_4C_5$ and $PC_5$ coincide respectively with $A_4B_4$ and $PC_1$. Thus by (4)
\[
\angle(B_4C_5, PC_5) = \varphi.
\]
Analogously (by cyclic shift) $\varphi = \angle(C_4A_5, PA_5)$, which rewrites as
\[
\varphi = \angle(B_4A_5, PA_5).
\]
These relations imply that the points $P, B_4, C_5, A_5$ are concyclic. Analogously, $P, C_4, A_5, B_5$ and $P, A_4, B_5, C_5$ are concyclic quadruples. Therefore
\[
\angle(A_5B_5, C_5B_5) = \angle(A_5B_5, PB_5) + \angle(PB_5, C_5B_5) = \angle(A_5C_4, PC_4) + \angle(PA_4, C_5A_4). \tag{5}
\]

On the other hand, since the points $A_2, B_2, C_2, A_4, B_4, C_4$ all lie on the circle $(ABC)$, we have
\[
\angle(A_2B_2, C_2B_2) = \angle(A_2B_2, B_4B_2) + \angle(B_4B_2, C_2B_2) = \angle(A_2A_4, B_4A_4) + \angle(B_4C_4, C_2C_4). \tag{6}
\]

But the lines $A_2A_4$, $B_4A_4$, $B_4C_4$, $C_2C_4$ coincide respectively with $PA_4$, $C_5A_4$, $A_5C_4$, $PC_4$. So the sums on the right-hand sides of (5) and (6) are equal, leading to equality between their left-hand sides:
\[
\angle(A_5B_5, C_5B_5) = \angle(A_2B_2, C_2B_2).
\]
Hence (by cyclic shift, once more) also
\[
\angle(B_5C_5, A_5C_5) = \angle(B_2C_2, A_2C_2) \quad \text{and} \quad \angle(C_5A_5, B_5A_5) = \angle(C_2A_2, B_2A_2).
\]
This means that the triangles $A_5B_5C_5$ and $A_2B_2C_2$ have their corresponding angles equal, and consequently they are similar.

\bigskip

\textbf{Comment 1.} This is the way in which the proof has been presented by the proposer. Trying to work it out in the language of classical geometry, so as to avoid oriented angles, one is led to difficulties due to the fact that the reasoning becomes heavily case-dependent. Disposition of relevant points can vary in many respects. Angles which are equal in one case become supplementary in another. Although it seems not hard to translate all formulas from the shapes they have in one situation to the one they have in another, the real trouble is to identify all cases possible and rigorously verify that the key conclusions retain validity in each case.

The use of oriented angles is a very efficient method to omit this trouble. It seems to be the most appropriate environment in which the solution can be elaborated.

\bigskip

\textbf{Comment 2.} Actually, the fact that the circles $(AB_1C_1)$, $(BC_1A_1)$ and $(CA_1B_1)$ have a common point does not require a proof; it is known as Miquel锟斤拷锟絪 theorem.",4,"Let $P$ be the second intersection of the circumcircles of triangles $AB_1C_1$ and $BC_1A_1$. Show that $P$ also lies on the circumcircle of triangle $CA_1B_1$, and that there is a constant angle $\varphi$ such that $\\varphi = \\angle(PA_1, BC) = \\angle(PB_1, CA) = \\angle(PC_1, AB)$, using oriented angles.","Let the circumcircles of $\triangle AB_1C_1$ and $\triangle BC_1A_1$ intersect at $C_1$ and $P$. Using oriented angles for concyclic points, we have the chain of equalities: $\\angle(PA_1, BC) = \\angle(PC_1, AB) = \\angle(PB_1, AC)$. Let this common angle be $\\varphi$. From the same properties, we also get $\\angle(PA_1, CA_1) = \\angle(PB_1, CB_1)$, which shows that points $A_1, B_1, P, C$ are concyclic. Therefore, $P$ is the common intersection of the three circles $(AB_1C_1)$, $(BC_1A_1)$, and $(CA_1B_1)$.","Let $O$ be the circumcenter of $\triangle ABC$. Let the lines $A_2P, B_2P, C_2P$ meet the circumcircle of $\triangle ABC$ again at $A_4, B_4, C_4$ respectively. Prove that $\triangle ABC$ is the image of $\triangle A_4B_4C_4$ under a rotation about $O$ by an angle of $2\\varphi$.","Points $A, P, C_1, A_2$ lie on circle $(AB_1C_1)$. Using oriented angles, $\\angle(PA_2, AA_2) = \\angle(PC_1, AC_1)$. Since $A, C_1, B$ are collinear, this equals $\\angle(PC_1, AB)$, which is $\\varphi$ from the previous step. The line $PA_2$ is the same as $A_4A_2$. So the angle subtended by arc $A_4A$ at point $A_2$ on the circumcircle is $\\varphi$. The central angle $\\angle A_4OA$ is $2\\varphi$. Therefore, a rotation about the circumcenter $O$ by $2\\varphi$ maps $A_4$ to $A$. Similarly, it maps $B_4$ to $B$ and $C_4$ to $C$, hence it maps $\triangle A_4B_4C_4$ to $\triangle ABC$.","Let lines $PC_1, PA_1, PB_1$ intersect the sides $A_4B_4, B_4C_4, C_4A_4$ of $\triangle A_4B_4C_4$ at $C_5, A_5, B_5$ respectively. Prove that $\triangle A_3B_3C_3$ is congruent to $\triangle A_5B_5C_5$.","The rotation from the previous step maps $\triangle A_4B_4C_4$ to $\triangle ABC$. We show it maps $C_5$ to $C_3$. From the rotation, $\\angle(A_4B_4, AB) = 2\\varphi$. Using this and $\\angle(AB, PC_1) = -\\varphi$, we get $\\angle(A_4B_4, PC_1) = \\varphi$. Also $\\angle(PC_1, AC_1) = \\varphi$. This implies $AB_4C_5C_1$ is an isosceles trapezoid, so $AC_1 = B_4C_5$. Similarly, $BC_1 = A_4C_5$. By definition of $C_3$, $AC_3 = BC_1$ and $BC_3 = AC_1$. Thus, point $C_5$ on segment $A_4B_4$ satisfies $A_4C_5=AC_3$ and $B_4C_5=BC_3$. The rotation mapping $A_4 \to A$ and $B_4 \to B$ must map $C_5$ to $C_3$. Similarly, it maps $A_5 \to A_3$ and $B_5 \to B_3$. Therefore, $\triangle A_5B_5C_5 \\cong \triangle A_3B_3C_3$.",Prove that the triangles $A_2B_2C_2$ and $A_3B_3C_3$ are similar.,"From the previous step, $\triangle A_3B_3C_3 \\cong \triangle A_5B_5C_5$, so we prove $\triangle A_2B_2C_2 \\sim \triangle A_5B_5C_5$. We show their angles are equal. First, we establish that quadruples $(P, B_4, C_5, A_5)$, $(P, C_4, A_5, B_5)$, and $(P, A_4, B_5, C_5)$ are concyclic using angle chasing. Using these cyclic quadrilaterals, we express an angle of $\triangle A_5B_5C_5$: $\\angle(A_5B_5, C_5B_5) = \\angle(A_5C_4, PC_4) + \\angle(PA_4, C_5A_4)$. For $\triangle A_2B_2C_2$, $\\angle(A_2B_2, C_2B_2) = \\angle(A_2A_4, B_4A_4) + \\angle(B_4C_4, C_2C_4)$. By construction, the lines in these two sums are identical pairs (e.g., $A_2A_4$ is $PA_4$, $B_4A_4$ is $C_5A_4$). Thus, $\\angle(A_5B_5, C_5B_5) = \\angle(A_2B_2, C_2B_2)$. By cyclic permutation of indices, the triangles have equal corresponding angles and are similar, completing the proof."
2006n2,"\textbf{N2.} For $x \in (0,1)$ let $y \in (0,1)$ be the number whose $n$th digit after the decimal point is the $(2^n)$th digit after the decimal point of $x$. Show that if $x$ is rational then so is $y$.","\textbf{Solution.} Since $x$ is rational, its digits repeat periodically starting at some point. We wish to show that this is also true for the digits of $y$, implying that $y$ is rational.

Let $d$ be the length of the period of $x$ and let $d = 2^u \cdot v$, where $v$ is odd. There is a positive integer $w$ such that
\[
2^w \equiv 1 \pmod{v}.
\]
(For instance, one can choose $w$ to be $\varphi(v)$, the value of Euler锟斤拷锟絪 totient function at $v$.) Therefore
\[
2^{n+w} = 2^n \cdot 2^w \equiv 2^n \pmod{v}
\]
for each $n$. Also, for $n \geq u$ we have
\[
2^{n+w} \equiv 2^n \pmod{2^u}.
\]
It follows that, for all $n \geq u$, the relation
\[
2^{n+w} \equiv 2^n \pmod{d}
\]
holds. Thus, for $n$ sufficiently large, the $2^{n+w}$th digit of $x$ is in the same spot in the cycle of $x$ as its $2^n$th digit, and so these digits are equal. Hence the $(n+w)$th digit of $y$ is equal to its $n$th digit. This means that the digits of $y$ repeat periodically with period $w$ from some point on, as required.",2,"Let $d$ be a positive integer. Show that there exists a positive integer $w$ such that for all sufficiently large integers $n$, we have $2^{n+w} \equiv 2^n \\pmod{d}$.","Let the prime factorization of $d$ be $d = 2^u \cdot v$, where $v$ is odd. Since $\\gcd(2, v)=1$, by Euler's totient theorem, there exists a positive integer $w$ (e.g., $w=\\varphi(v)$) such that $2^w \\equiv 1 \\pmod{v}$. This implies $2^{n+w} = 2^n \\cdot 2^w \\equiv 2^n \\pmod{v}$ for all integers $n \\ge 0$. Also, for any $n \\ge u$, both $2^n$ and $2^{n+w}$ are divisible by $2^u$, so $2^{n+w} \\equiv 2^n \\equiv 0 \\pmod{2^u}$. Since $2^{n+w} - 2^n$ is a multiple of both $v$ and $2^u$, and $\\gcd(2^u, v) = 1$, it must be a multiple of their product $d$. Thus, for all $n \\ge u$, we have $2^{n+w} \\equiv 2^n \\pmod{d}$.","For $x \\in (0,1)$ let $y \\in (0,1)$ be the number whose $n$th digit after the decimal point is the $(2^n)$th digit after the decimal point of $x$. Show that if $x$ is rational then so is $y$.","A number is rational if and only if its decimal expansion is eventually periodic. Since $x$ is rational, its decimal expansion is eventually periodic with some period $d$ after some initial block of digits. This means that for sufficiently large indices $k_1, k_2$, if $k_1 \\equiv k_2 \\pmod{d}$, the $k_1$-th digit of $x$ equals the $k_2$-th digit. From the previous sub-problem, there exist integers $w>0$ and $N_1$ such that for all $n \\ge N_1$, we have $2^{n+w} \\equiv 2^n \\pmod{d}$. For $n$ large enough, both $2^n$ and $2^{n+w}$ will be indices within the periodic part of $x$'s decimal expansion. Therefore, for all sufficiently large $n$, the $(2^n)$-th digit of $x$ is equal to the $(2^{n+w})$-th digit of $x$. By definition of $y$, this means the $n$-th digit of $y$ is equal to the $(n+w)$-th digit of $y$. This shows that the decimal expansion of $y$ is eventually periodic, and thus $y$ is rational.",,,,
2006n3,"The sequence $f(1), f(2), f(3), \dots$ is defined by
\[
f(n) = \frac{1}{n} \left( \left\lfloor \frac{n}{1} \right\rfloor + \left\lfloor \frac{n}{2} \right\rfloor + \cdots + \left\lfloor \frac{n}{n} \right\rfloor \right),
\]
where $\lfloor x \rfloor$ denotes the integer part of $x$.

\begin{itemize}
\item[(a)] Prove that $f(n+1) > f(n)$ infinitely often.
\item[(b)] Prove that $f(n+1) < f(n)$ infinitely often.
\end{itemize}","\textbf{Solution.} Let $g(n) = n f(n)$ for $n \geq 1$ and $g(0) = 0$. We note that, for $k = 1, \dots, n$,
\[
\left\lfloor \frac{n}{k} \right\rfloor - \left\lfloor \frac{n - 1}{k} \right\rfloor =
\begin{cases}
0 & \text{if } k \nmid n, \\
1 & \text{if } k \mid n.
\end{cases}
\]
It therefore follows that if $d(n)$ is the number of positive divisors of $n \geq 1$, then
\[
g(n) = \left\lfloor \frac{n}{1} \right\rfloor + \left\lfloor \frac{n}{2} \right\rfloor + \cdots + \left\lfloor \frac{n}{n} \right\rfloor
= \left( \left\lfloor \frac{n-1}{1} \right\rfloor + \cdots + \left\lfloor \frac{n-1}{n} \right\rfloor \right) + d(n)
= g(n - 1) + d(n).
\]

Hence,
\[
g(n) = g(n-1) + d(n) = g(n-2) + d(n-1) + d(n) = \cdots = d(1) + d(2) + \cdots + d(n),
\]
meaning that
\[
f(n) = \frac{d(1) + d(2) + \cdots + d(n)}{n}.
\]

In other words, $f(n)$ is equal to the arithmetic mean of $d(1), d(2), \ldots, d(n)$. In order to prove the claims, it is therefore sufficient to show that $d(n + 1) > f(n)$ and $d(n + 1) < f(n)$ both hold infinitely often.

We note that $d(1) = 1$. For $n > 1$, $d(n) \geq 2$ holds, with equality if and only if $n$ is prime. Since $f(6) = 7/3 > 2$, it follows that $f(n) > 2$ holds for all $n \geq 6$.

Since there are infinitely many primes, $d(n + 1) = 2$ holds for infinitely many values of $n$, and for each such $n \geq 6$ we have $d(n + 1) = 2 < f(n)$. This proves claim (b).

To prove (a), notice that the sequence $d(1), d(2), d(3), \dots$ is unbounded (e.g., $d(2^k) = k + 1$ for all $k$). Hence $d(n+1) > \max\{d(1), d(2), \dots, d(n)\}$ for infinitely many $n$. For all such $n$, we have $d(n + 1) > f(n)$. This completes the solution.",3,"Let $d(k)$ be the number of positive divisors of an integer $k$. Prove that $f(n)$ is the arithmetic mean of the number of divisors of the first $n$ integers, i.e., $f(n) = \frac{1}{n} \sum_{k=1}^{n} d(k)$.","Let $g(n) = n f(n) = \sum_{k=1}^{n} \lfloor \frac{n}{k} \rfloor$. Consider the difference $g(n) - g(n-1) = \sum_{k=1}^{n} (\lfloor \frac{n}{k} \rfloor - \lfloor \frac{n-1}{k} \rfloor)$. The term $\lfloor \frac{n}{k} \rfloor - \lfloor \frac{n-1}{k} \rfloor$ is 1 if $k$ divides $n$ and 0 otherwise. Thus, the sum counts the number of divisors of $n$, so $g(n) - g(n-1) = d(n)$. Since $g(1)=d(1)=1$, it follows by induction that $g(n) = \sum_{k=1}^{n} d(k)$. Therefore, $f(n) = \frac{g(n)}{n} = \frac{1}{n} \sum_{k=1}^{n} d(k)$.","Show that $f(n+1) > f(n)$ is equivalent to $d(n+1) > f(n)$, and $f(n+1) < f(n)$ is equivalent to $d(n+1) < f(n)$.","Using the result from the previous sub-problem, we have $f(n+1) = \frac{1}{n+1} \sum_{k=1}^{n+1} d(k) = \frac{(\sum_{k=1}^{n} d(k)) + d(n+1)}{n+1} = \frac{n f(n) + d(n+1)}{n+1}$. The inequality $f(n+1) > f(n)$ is equivalent to $\frac{n f(n) + d(n+1)}{n+1} > f(n)$. Multiplying by $n+1$ gives $n f(n) + d(n+1) > (n+1) f(n) = n f(n) + f(n)$, which simplifies to $d(n+1) > f(n)$. The argument for $f(n+1) < f(n)$ being equivalent to $d(n+1) < f(n)$ is analogous.",Prove that $f(n+1) > f(n)$ infinitely often and $f(n+1) < f(n)$ infinitely often.,"Using the equivalences from the previous sub-problem, we need to show that $d(n+1) < f(n)$ and $d(n+1) > f(n)$ each hold for infinitely many $n$. 
(a) For $f(n+1) < f(n)$: Let $n+1 = p$, where $p$ is a prime number. Then $d(n+1)=2$. For $n \ge 6$, $f(n) = \frac{1}{n}\sum_{k=1}^n d(k) > \frac{d(1)+d(2)+d(3)+d(4)+d(5)+d(6)}{6} = \frac{1+2+2+3+2+4}{6} = \frac{14}{6} > 2$. Since there are infinitely many primes, there are infinitely many $n$ such that $n+1$ is prime and $n \ge 6$. For these $n$, $d(n+1) = 2 < f(n)$.
(b) For $f(n+1) > f(n)$: The sequence of divisor counts $d(k)$ is unbounded (e.g., $d(2^k) = k+1$). Thus, there are infinitely many integers $m$ such that $d(m) > \max\{d(1), \dots, d(m-1)\}$. Let $n+1=m$ for such an integer. Since $f(n)$ is the average of $d(1), \dots, d(n)$, we have $f(n) \le \max\{d(1), \dots, d(n)\}$. Therefore, for these infinitely many $n$, $d(n+1) > f(n)$.",,
2006n4,"Let $P$ be a polynomial of degree $n > 1$ with integer coefficients and let $k$ be any positive integer. Consider the polynomial $Q(x) = P(P(\ldots P(P(x)) \ldots ))$, with $k$ pairs of parentheses. Prove that $Q$ has no more than $n$ integer fixed points, i.e. integers satisfying the equation $Q(x) = x$.","\textbf{Solution.} The claim is obvious if every integer fixed point of $Q$ is a fixed point of $P$ itself.

For the sequel assume that this is not the case. Take any integer $x_0$ such that $Q(x_0) = x_0$, $P(x_0) \neq x_0$ and define inductively $x_{i+1} = P(x_i)$ for $i = 0,1,2,\dots$ then $x_k = x_0$.

It is evident that
\[
P(u) - P(v) \text{ is divisible by } u - v \text{ for distinct integers } u, v. \tag{1}
\]
(Indeed, if $P(x) = \sum a_i x^i$ then each $a_i(u^i - v^i)$ is divisible by $u - v$.) Therefore each term in the chain of (nonzero) differences
\[
x_0 - x_1,\quad x_1 - x_2,\quad \dots,\quad x_{k-1} - x_k,\quad x_k - x_{k+1} \tag{2}
\]
is a divisor of the next one; and since $x_k - x_{k+1} = x_0 - x_1$, all these differences have equal absolute values. For $x_m = \min(x_1, \dots, x_k)$ this means that $x_{m-1} - x_m = -(x_m - x_{m+1})$. Thus $x_{m-1} = x_{m+1} (\neq x_m)$. It follows that consecutive differences in the sequence (2) have opposite signs. Consequently, $x_0, x_1, x_2, \dots$ is an alternating sequence of two distinct values. In other words, every integer fixed point of $Q$ is a fixed point of the polynomial $P(P(x))$. Our task is to prove that there are at most $n$ such points.

Let $a$ be one of them so that $b = P(a) \ne a$ (we have assumed that such an $a$ exists); then $a = P(b)$. Take any other integer fixed point $\alpha$ of $P(P(x))$ and let $P(\alpha) = \beta$, so that $P(\beta) = \alpha$; the numbers $\alpha$ and $\beta$ need not be distinct ($\alpha$ can be a fixed point of $P$), but each of $\alpha, \beta$ is different from each of $a, b$.

Applying property (1) to the four pairs of integers $(\alpha, a)$, $(\beta, b)$, $(\alpha, b)$, $(\beta, a)$ we get that the numbers $\alpha - a$ and $\beta - b$ divide each other, and also $\alpha - b$ and $\beta - a$ divide each other. Consequently
\[
\alpha - b = \pm (\beta - a), \qquad \alpha - a = \pm (\beta - b). \tag{3}
\]

Suppose we have a plus in both instances: $\alpha - b = \beta - a$ and $\alpha - a = \beta - b$. Subtraction yields $a - b = b - a$, a contradiction, as $a \ne b$. Therefore at least one equality in (3) holds with a minus sign. For each of them this means that $\alpha + \beta = a + b$; equivalently $a + b - \alpha - P(\alpha) = 0$.

Denote $a + b$ by $C$. We have shown that every integer fixed point of $Q$ other than $a$ and $b$ is a root of the polynomial $F(x) = C - x - P(x)$. This is of course true for $a$ and $b$ as well. And since $P$ has degree $n > 1$, the polynomial $F$ has the same degree, so it cannot have more than $n$ roots. Hence the result.

\medskip

\textbf{Comment.} The first part of the solution, showing that integer fixed points of any iterate of $P$ are in fact fixed points of the second iterate $P \circ P$ is standard; moreover, this fact has already appeared in contests. We ho",4,"Let $P(x)$ be a polynomial with integer coefficients. Prove that for any distinct integers $u$ and $v$, the difference $u-v$ divides $P(u)-P(v)$.","Let $P(x) = \\sum_{i=0}^n a_i x^i$ with $a_i \\in \\mathbb{Z}$. Then $P(u) - P(v) = \\sum_{i=1}^n a_i (u^i - v^i)$. For each $i \\ge 1$, we can factor $u^i - v^i = (u-v)(u^{i-1} + u^{i-2}v + \\dots + v^{i-1})$. Since $u$ and $v$ are integers, the second factor is an integer. Thus, $u-v$ divides $u^i-v^i$ for each $i \\ge 1$. As all coefficients $a_i$ are integers, $u-v$ must divide the sum $\\sum_{i=1}^n a_i (u^i - v^i)$, which is equal to $P(u)-P(v)$.","Let $x_0$ be an integer fixed point of $Q(x)$, the $k$-th iterate of $P$. Prove that $x_0$ must also be a fixed point of the second iterate, i.e., $P(P(x_0))=x_0$.","Define a sequence by $x_{i+1}=P(x_i)$ for $i \\ge 0$. Since $Q(x_0)=x_0$, we have $x_k=x_0$. If $x_1=x_0$, then $P(x_0)=x_0$, and $P(P(x_0))=P(x_0)=x_0$. Now, assume $x_1 \neq x_0$. From the property that $u-v$ divides $P(u)-P(v)$, we have that $x_i-x_{i+1}$ divides $P(x_i)-P(x_{i+1}) = x_{i+1}-x_{i+2}$ for all $i \\ge 0$. This implies a chain of divisibility $x_0-x_1 \\mid x_1-x_2 \\mid \\dots \\mid x_{k-1}-x_k$. As $x_k=x_0$ and $x_{k+1}=P(x_k)=P(x_0)=x_1$, the chain closes with $x_{k-1}-x_k \\mid x_k-x_{k+1}=x_0-x_1$. Thus, all differences $|x_i-x_{i+1}|$ must be equal. Let $x_m$ be a term of minimum value in the cycle $\{x_0, ..., x_{k-1}\}$. Then $x_{m-1}-x_m > 0$ and $x_m-x_{m+1} < 0$. Since their absolute values are equal, we must have $x_{m-1}-x_m = -(x_m-x_{m+1})$, which simplifies to $x_{m-1}=x_{m+1}$. This implies the sequence has period 2. In particular, $x_2=x_0$, which means $P(P(x_0))=x_0$.",Assume there exists an integer $a$ such that $P(a) = b$ and $P(b) = a$ with $a \neq b$. Let $\\alpha$ be any integer satisfying $P(P(\\alpha)) = \\alpha$. Prove that $\\alpha + P(\\alpha) = a+b$.,"Let $\beta = P(\\alpha)$, so $P(\beta)=\\alpha$. Using the property that $u-v$ divides $P(u)-P(v)$, we have that $\\alpha-a$ divides $P(\\alpha)-P(a)=\beta-b$, and $\beta-b$ divides $P(\beta)-P(b)=\\alpha-a$. This implies $|\\alpha-a|=|\beta-b|$, so $\\alpha-a = \\pm(\beta-b)$. Similarly, $\\alpha-b$ divides $P(\\alpha)-P(b)=\beta-a$, and $\beta-a$ divides $P(\beta)-P(a)=\\alpha-b$. This implies $|\\alpha-b|=|\beta-a|$, so $\\alpha-b = \\pm(\beta-a)$. Suppose both relations hold with a plus sign: $\\alpha-a = \beta-b$ and $\\alpha-b = \beta-a$. Subtracting the second equation from the first gives $b-a = a-b$, implying $2a=2b$, which contradicts $a \neq b$. Therefore, at least one relation must hold with a minus sign. If $\\alpha-a = -(\beta-b)$ or $\\alpha-b = -(\beta-a)$, both simplify to $\\alpha+\beta = a+b$. Thus, $\\alpha+P(\\alpha) = a+b$.","Let $P$ be a polynomial of degree $n > 1$ with integer coefficients and let $k$ be any positive integer. Consider the polynomial $Q(x) = P(P(\\ldots P(P(x)) \\ldots ))$, with $k$ pairs of parentheses. Prove that $Q$ has no more than $n$ integer fixed points.","Let $x$ be an integer fixed point of $Q$, i.e., $Q(x)=x$. By the result of sub-problem 2, any such $x$ must also satisfy $P(P(x))=x$. We count the integer solutions to this equation. Case 1: All integer solutions to $P(P(x))=x$ are also solutions to $P(x)=x$. These are the integer roots of $P(x)-x=0$. Since $P(x)$ has degree $n > 1$, $P(x)-x$ is a polynomial of degree $n$ and has at most $n$ roots. Case 2: There exists an integer $a$ such that $P(P(a))=a$ but $P(a) \neq a$. Let $b=P(a)$, so $a \neq b$ and $P(b)=a$. By the result of sub-problem 3, any integer solution $\\alpha$ to $P(P(\\alpha))=\\alpha$ must satisfy $\\alpha+P(\\alpha)=a+b$. This means every integer fixed point of $Q$ is a root of the polynomial $F(x) = P(x)+x-(a+b)$. Since $P(x)$ has degree $n>1$, $F(x)$ is a polynomial of degree $n$, which has at most $n$ roots. In both cases, the number of integer fixed points is at most $n$."
2006n7,"Prove that, for every positive integer $n$, there exists an integer $m$ such that $2^m + m$ is divisible by $n$.","\textbf{Solution.} We will prove by induction on $d$ that, for every positive integer $N$, there exist positive integers $b_0, b_1, \dots, b_{d-1}$ such that, for each $i = 0, 1, 2, \dots, d - 1$, we have $b_i > N$ and
\[
2^{b_i} + b_i \equiv i \pmod{d}.
\]
This yields the claim for $m = b_0$.

The base case $d = 1$ is trivial. Take an $a > 1$ and assume that the statement holds for all $d < a$. Note that the remainders of $2^i$ modulo $a$ repeat periodically starting with some exponent $M$. Let $k$ be the length of the period; this means that $2^{M + k'} \equiv 2^M \pmod{a}$ holds only for those $k'$ which are multiples of $k$. Note further that the period cannot contain all the $a$ remainders, since 0 either is missing or is the only number in the period. Thus $k < a$.

Let $d = \gcd(a, k)$ and take $a' = a/d$, $k' = k/d$. Since $0 < k < a$, we also have $0 < d < a$. By the induction hypothesis, there exist positive integers $b_0, b_1, \dots, b_{d-1}$ such that $b_i > \max(2^M, N)$ and
\[
2^{b_i} + b_i \equiv i \pmod{d}, \quad \text{for } i = 0, 1, \dots, d - 1. \tag{1}
\]

For each $i = 0, 1, \dots, d - 1$ consider the sequence
\[
2^{b_i} + b_i,\quad 2^{b_i + k} + (b_i + k),\quad \dots,\quad 2^{b_i + (a' - 1)k} + (b_i + (a' - 1)k). \tag{2}
\]

Modulo $a$, these numbers are congruent to
\[
2^{b_i} + b_i,\quad 2^{b_i} + (b_i + k),\quad \dots,\quad 2^{b_i} + (b_i + (a' - 1)k),
\]
respectively. The $d$ sequences contain $a'd = a$ numbers altogether. We shall now prove that no two of these numbers are congruent modulo $a$.

Suppose that
\[
2^{b_i} + (b_i + mk) \equiv 2^{b_j} + (b_j + nk) \pmod{a} \tag{3}
\]
for some values of $i, j \in \{0, 1, \dots, d - 1\}$ and $m, n \in \{0, 1, \dots, a' - 1\}$. Since $d$ is a divisor of $a$, we also have
\[
2^{b_i} + (b_i + mk) \equiv 2^{b_j} + (b_j + nk) \pmod{d}.
\]
Because $d$ is a divisor of $k$ and in view of (1), we obtain $i \equiv j \pmod{d}$. As $i, j \in \{0, 1, \dots, d - 1\}$, this just means that $i = j$. Substituting this into (3) yields $mk \equiv nk \pmod{a}$. Therefore $mk' \equiv nk' \pmod{a'}$; and since $a'$ and $k'$ are coprime, we get $m \equiv n \pmod{a'}$. Hence also $m = n$.

It follows that the $a$ numbers that make up the $d$ sequences (2) satisfy all the requirements; they are certainly all greater than $N$ because we chose each $b_i > \max(2^M, N)$. So the statement holds for $a$, completing the induction.",3,"Let $a > 1$ be an integer and let $k$ be the eventual period of the sequence $2^i \pmod a$. Prove that $d = \gcd(a, k) < a$.","The sequence of remainders $2^i \pmod a$ becomes periodic for sufficiently large $i$. Let the period be $k$. The set of values in the periodic part cannot include all $a$ residues modulo $a$. This is because the residue 0 either never appears, or if it does (only possible if $a$ is a power of 2), the sequence remains 0 forever, so the period is $k=1$. In neither case can the periodic part contain all $a$ residues. Thus, the number of distinct values in the period is less than $a$, which implies the period length $k$ must be less than $a$. Since $d = \gcd(a, k)$, it follows that $d \le k < a$.","Let $a > 1$, $k$ be the eventual period of $2^i \pmod a$, and $d = \gcd(a, k) < a$. Assume that for any integer $N$, there exist $d$ integers $b_0, \dots, b_{d-1} > N$ such that $2^{b_i} + b_i \equiv i \pmod d$ for each $i=0, \dots, d-1$. Show that the set of values $\{2^m+m \pmod a\}$, for suitably chosen $m$, forms a complete residue system modulo $a$.","Let $a' = a/d$. By assumption, we can choose $b_0, \dots, b_{d-1}$ large enough such that $2^{b_i+jk} \equiv 2^{b_i} \pmod a$ for any integer $j \ge 0$. Consider the $a'd = a$ numbers $m_{i,j} = b_i + jk$ for $i \in \{0, \dots, d-1\}$ and $j \in \{0, \dots, a'-1\}$. For these numbers, $2^{m_{i,j}} + m_{i,j} \equiv 2^{b_i} + b_i + jk \pmod a$. Suppose $2^{b_i} + b_i + j_1k \equiv 2^{b_l} + b_l + j_2k \pmod a$. Reducing this modulo $d$ gives $2^{b_i}+b_i \equiv 2^{b_l}+b_l \pmod d$, which means $i \equiv l \pmod d$, so $i=l$. The congruence simplifies to $j_1k \equiv j_2k \pmod a$. Since $\gcd(k/d, a/d)=1$, this implies $j_1 \equiv j_2 \pmod{a/d}$, so $j_1=j_2$. Thus, the $a$ values $\{2^{m_{i,j}}+m_{i,j} \pmod a\}$ are all distinct, forming a complete residue system modulo $a$.","Prove that, for every positive integer $n$, there exists an integer $m$ such that $2^m + m$ is divisible by $n$.","We prove by strong induction on $n$ the stronger claim that for any $n \ge 1$, the set of values $\{2^m+m \pmod n\}$ for sufficiently large $m$ covers all residues modulo $n$. The base case $n=1$ is trivial. Assume the claim holds for all integers less than $n$. Let $k$ be the eventual period of $2^i \pmod n$. From the result of the first sub-problem, $d = \gcd(n,k) < n$. By the inductive hypothesis, the claim holds for $d$. The second sub-problem provides the inductive step, showing that if the claim holds for $d$, it also holds for $n$. By induction, the claim is true for all $n$. This means for any $n$, the set of residues $\{2^m+m \pmod n\}$ includes $0$, so there exists an $m$ such that $2^m+m \equiv 0 \pmod n$.",,
2005p1,"Six points are chosen on the sides of an equilateral triangle $ABC$: $A_1, A_2$ on $BC$, $B_1$, $B_2$ on $CA$ and $C_1$, $C_2$ on $AB$, such that they are the vertices of a convex hexagon $A_1A_2B_1B_2C_1C_2$ with equal side lengths. Prove that the lines $A_1B_2, B_1C_2$ and $C_1A_2$ are concurrent.","Let $D = C_2A_1 \cap A_2B_1$, and similarly define $E$ and $F$. We claim that $DEF$ is equilateral.

Proof: Note that the vectors $\overrightarrow{A_1A_2}$, $\overrightarrow{A_2B_1}$, $\overrightarrow{B_1B_2}$, $\overrightarrow{B_2C_1}$, $\overrightarrow{C_1C_2}$, $\overrightarrow{C_2A_1}$ add to 0. But we also have: \[\overrightarrow{A_1A_2}+\overrightarrow{B_1B_2}+\overrightarrow{C_1C_2}=0\] since these are at the sides of an equilateral triangle. This means that \[\overrightarrow{A_2B_1}+\overrightarrow{B_2C_1}+\overrightarrow{C_2A_1}=0.\] These three unit vectors thus form an equilateral triangle.

Now $\angle A_1DB_1 = 60^{\circ} = \angle A_1CB_1$, so quadrilateral $A_1DCB_1$ is cyclic. So $\angle CA_1D = \angle CB_1D$ and $\angle C_2A_1A_2 = \angle A_2B_1B_2$. This means that triangles $C_2A_1A_2$ and $A_2B_1B_2$ are congruent, so $C_2A_2 = A_2B_2$. But also, $C_2C_1 = C_1B_2$, so $C_1A_2$ is the perpendicular bisector of $A_1B_1C_1$. Similarly, $A_1B_2$ and $B_1C_2$ are also perpendicular bisectors. Therefore, they concur.",2,"Prove that the triangle with vertices $A_2, B_2, C_2$ is equilateral.","Let $s$ be the side length of the hexagon. The sum of the vectors of the hexagon's sides is zero. The sum of vectors along the sides of $\triangle ABC$, $\overrightarrow{A_1A_2} + \overrightarrow{B_1B_2} + \overrightarrow{C_1C_2}$, is also zero because $A_1A_2=B_1B_2=C_1C_2=s$ and the unit vectors for the directions of an equilateral triangle's sides sum to zero. This implies $\overrightarrow{A_2B_1} + \overrightarrow{B_2C_1} + \overrightarrow{C_2A_1} = 0$. Since these three vectors have equal length $s$, the angle between any two is $120^\circ$. Let $D$ be the intersection of the lines $C_2A_1$ and $A_2B_1$. The angle between these lines is $60^\circ$, so $\angle A_1DB_1 = 60^\circ$. As $\angle A_1CB_1 = 60^\circ$, the quadrilateral $A_1DCB_1$ is cyclic. This implies that $\triangle C_2A_1A_2$ and $\triangle A_2B_1B_2$ are congruent, which gives $C_2A_2 = A_2B_2$. By symmetry, $A_2B_2 = B_2C_2$, and thus $\triangle A_2B_2C_2$ is equilateral.","Six points are chosen on the sides of an equilateral triangle $ABC$: $A_1, A_2$ on $BC$, $B_1$, $B_2$ on $CA$ and $C_1$, $C_2$ on $AB$, such that they are the vertices of a convex hexagon $A_1A_2B_1B_2C_1C_2$ with equal side lengths. Prove that the lines $A_1B_2, B_1C_2$ and $C_1A_2$ are concurrent.","From the first sub-problem, we know that $\triangle A_2B_2C_2$ is equilateral. Consider the line $C_1A_2$. The hexagon has equal side lengths, so $C_1B_2 = s$ and $C_1C_2 = s$. This means $\triangle C_1B_2C_2$ is isosceles, and $C_1$ must lie on the perpendicular bisector of the segment $B_2C_2$. Since $\triangle A_2B_2C_2$ is equilateral, $A_2B_2 = A_2C_2$, which means $A_2$ also lies on the perpendicular bisector of $B_2C_2$. Therefore, the line $C_1A_2$ is the perpendicular bisector of the side $B_2C_2$ of $\triangle A_2B_2C_2$. By a symmetrical argument, the lines $A_1B_2$ and $B_1C_2$ are the perpendicular bisectors of sides $C_2A_2$ and $A_2B_2$ respectively. The three perpendicular bisectors of the sides of a triangle are concurrent at its circumcenter.",,,,
2005p2,"Let $a_1, a_2, \dots$ be a sequence of integers with infinitely many positive and negative terms. Suppose that for every positive integer $n$ the numbers $a_1, a_2, \dots, a_n$ leave $n$ different remainders upon division by $n$. Prove that every integer occurs exactly once in the sequence.","Solution
${a_n}$ satisfies the conditions if and only if ${a_n-a_1}$ does. Therefore we can assume that $a_1=0$

First of all, $|a_n|<n$ Otherwise, $a_n = 0$ mod $a_{a_n}$


Claim: $a_{k+1}$ is either the smallest positive number not in ${a_1, a_2, ..., a_k}$ or the largest negative number not in this set.

Proof by induction: the induction hypothesis implies that $a_1, a_2, ..., a_k$ are consecutive. Let m and M be the smallest and largest numbers in this consecutive set, respectively. It is clear that $a_{k+1}=m-1=M+1$ mod $k+1$. But since $|a_n|<n$, $a_{k+1}=m-1$ or $M+1$

This proves that if ${a_n}$ contains an infinite number of positive and negative numbers, it must contain each integer exactly once.",2,"Prove that for any positive integer $n$, the set of numbers $\{a_1, a_2, \dots, a_n\}$ is a set of $n$ consecutive integers.","We prove this by induction on $n$. The base case $n=1$ is trivial, as $\{a_1\}$ is a set of 1 consecutive integer. Assume for induction that $\{a_1, \dots, a_k\}$ is a set of $k$ consecutive integers, say $S_k = \{m, m+1, \dots, M\}$, where $M-m+1=k$. By the problem's condition for $n=k+1$, the set $\{a_1, \dots, a_{k+1}\}$ must have distinct remainders modulo $k+1$. Since the numbers in $S_k$ are $k$ consecutive integers, their remainders modulo $k+1$ are distinct. Therefore, $a_{k+1} \pmod{k+1}$ must be the unique remainder in $\{0, 1, \dots, k\}$ that is not taken by any element of $S_k$. This unique remainder is congruent to both $m-1$ and $M+1$ modulo $k+1$. It can be shown that $|a_n| < n$ for $n>1$. Applying this property, $|a_{k+1}| \le k$. The only candidates for $a_{k+1}$ congruent to $m-1 \pmod{k+1}$ that could extend the consecutive block and satisfy this bound are $m-1$ and $M+1$. Thus, $a_{k+1}$ must be one of these two values. In either case, the new set $\{a_1, \dots, a_{k+1}\}$ is a set of $k+1$ consecutive integers, completing the induction.","Let $a_1, a_2, \dots$ be a sequence of integers with infinitely many positive and negative terms. Suppose that for every positive integer $n$ the numbers $a_1, a_2, \dots, a_n$ leave $n$ different remainders upon division by $n$. Prove that every integer occurs exactly once in the sequence.","From the first sub-problem, we know that for each $n$, the set $S_n = \{a_1, \dots, a_n\}$ consists of $n$ consecutive integers. This immediately implies that all terms in the sequence are distinct, otherwise $S_n$ for a sufficiently large $n$ would have fewer than $n$ elements. Let $m_n = \\min(S_n)$ and $M_n = \\max(S_n)$. The proof of the first part shows that $a_{n+1}$ is either $m_n - 1$ or $M_n + 1$. So at each step, the block of consecutive integers is extended by one at either its minimum or maximum end. The condition that the sequence has infinitely many positive and negative terms implies that both cases must occur infinitely often. This means that as $n \to \infty$, $m_n \to -\infty$ and $M_n \to \infty$. The set of all terms in the sequence is the union $\bigcup_{n=1}^{\\infty} S_n$. Since $S_n = [m_n, M_n]$ is an expanding interval of integers whose bounds go to $-\\infty$ and $+\\infty$, this union is the set of all integers, $\\mathbb{Z}$. As all terms are distinct and their union is $\\mathbb{Z}$, every integer appears exactly once in the sequence.",,,,
2005p3,"Let $x, y, z > 0$ satisfy $xyz\ge 1$. Prove that \[\frac{x^5-x^2}{x^5+y^2+z^2} + \frac{y^5-y^2}{x^2+y^5+z^2} + \frac{z^5-z^2}{x^2+y^2+z^5} \ge 0.\]",,1,"Let $x, y, z > 0$ satisfy $xyz\ge 1$. Prove that \[\frac{x^5-x^2}{x^5+y^2+z^2} + \frac{y^5-y^2}{x^2+y^5+z^2} + \frac{z^5-z^2}{x^2+y^2+z^5} \ge 0.\]",,,,,,,
2005p5,"Let $ABCD$ be a fixed convex quadrilateral with $BC = DA$ and $BC \nparallel DA$. Let two variable points $E$ and $F$ lie of the sides $BC$ and $DA$, respectively, and satisfy $BE = DF$. The lines $AC$ and $BD$ meet at $P$, the lines $BD$ and $EF$ meet at $Q$, the lines $EF$ and $AC$ meet at $R$. Prove that the circumcircles of the triangles $PQR$, as $E$ and $F$ vary, have a common point other than $P$.","Let $M$ be the Miquel point of complete quadrilateral $ADBC$; in other words, let $M$ be the second intersection point of the circumcircles of $\triangle APD$ and $\triangle BPC$. (A good diagram should betray this secret; all the points are given in the picture.) This makes lots of sense since we know $E$ and $F$ will be sent to each other under the spiral similarity too.

Thus $M$ is the Miquel point of complete quadrilateral $FACE$. As $R = \overline{FE} \cap \overline{AC}$ we deduce $FARM$ is a cyclic quadrilateral (among many others, but we锟斤拷锟絣l only need one).

Now look at complete quadrilateral $AFQP$. Since $M$ lies on $(DFQ)$ and $(RAF)$, it follows that $M$ is in fact the Miquel point of $AFQP$ as well. So $M$ lies on $(PQR)$.

Thus $M$ is the fixed point that we wanted.",2,"Let $P = AC \cap BD$, and let $M$ be the second point of intersection of the circumcircles of $\triangle APD$ and $\triangle BPC$. Show that $M$ lies on the circumcircles of $\triangle ARF$ and $\triangle QDF$, where $Q=BD \cap EF$ and $R=AC \cap EF$.","The point $M$ is the center of a spiral similarity that maps $\triangle MAD$ to $\triangle MCB$. Since $DA=BC$, this similarity is a rotation. This rotation maps the segment $DA$ to $BC$, and because $DF=BE$, it also maps point $F$ to point $E$. Consequently, there are two further spiral similarities (which are also rotations) centered at $M$: one mapping the pair of points $(D, B)$ to $(F, E)$ and another mapping $(A, C)$ to $(F, E)$. From a key property of spiral similarities, if the center is $M$ and it maps $(X, Y)$ to $(X', Y')$, then $M$ is concyclic with $X, X'$ and the intersection of lines $XY$ and $X'Y'$. Applying this to our case, since $Q = DB \cap FE$, the points $M, Q, D, F$ are concyclic. Similarly, since $R = AC \cap FE$, the points $M, R, A, F$ are concyclic. Thus, $M$ lies on the circumcircles of $\triangle QDF$ and $\triangle ARF$.","Let $ABCD$ be a fixed convex quadrilateral with $BC = DA$ and $BC \nparallel DA$. Let two variable points $E$ and $F$ lie of the sides $BC$ and $DA$, respectively, and satisfy $BE = DF$. The lines $AC$ and $BD$ meet at $P$, the lines $BD$ and $EF$ meet at $Q$, the lines $EF$ and $AC$ meet at $R$. Prove that the circumcircles of the triangles $PQR$, as $E$ and $F$ vary, have a common point other than $P$.","Consider the complete quadrilateral formed by the four lines $AD, AC, BD, EF$. The circumcircles of the four triangles $(\triangle APD, \triangle ARF, \triangle QDF, \triangle PQR)$ formed by these lines are concurrent at a single point, the Miquel point. Let $M$ be the point defined in the first sub-problem. By its definition, $M$ lies on the circumcircle of $\triangle APD$. From the result of the first sub-problem, $M$ also lies on the circumcircles of $\triangle ARF$ and $\triangle QDF$. Since $M$ lies on three of these four concurrent circles, it must be their common Miquel point. Therefore, $M$ must also lie on the fourth circle, the circumcircle of $\triangle PQR$. The definition of $M$ depends only on the fixed quadrilateral $ABCD$, so $M$ is a fixed point. Thus, as $E$ and $F$ vary, all circumcircles of $\triangle PQR$ pass through the fixed point $M$.",,,,
2005p6,"In a mathematical competition, in which 6 problems were posed to the participants, every two of these problems were solved by more than 2/5 of the contestants. Moreover, no contestant solved all the 6 problems. Show that there are at least 2 contestants who solved exactly 5 problems each.","Assume not and at most one contestant solved five problems. By adding in solves, we can assume WLOG that one contestant solved problems one through five, and every other contestant solved four of the six problems.

We split the remaining contestants based on whether they solved P6. Let $a_i$ denote the number of contestants who solved $\{1, 2, \dots, 5\} \setminus \{i\}$ (and missed P6). Let $b_{ij}$ denote the number of contestants who solved $\{1, 2, \dots, 5, 6\} \setminus \{i,j\}$ for $1 \le i < j \le 5$ (thus in particular they solved P6). Thus
\[
n = 1 + \sum_{1 \le i \le 5} a_i + \sum_{1 \le i < j \le 5} b_{ij}
\]
denotes the total number of contestants.

Considering contestants who solved P1/P6 we have
\[
t_1 := b_{23} + b_{24} + b_{25} + b_{34} + b_{35} + b_{45} \ge \frac{2}{5}n + \frac{1}{5}
\]
and we similarly define $t_2, t_3, t_4, t_5$. (We have written $\frac{2}{5}n + \frac{1}{5}$ since we know the left-hand side is an integer strictly larger than $\frac{2}{5}n$.) Also, by considering contestants who solved P1/P2 we have
\[
t_{12} = 1 + a_3 + a_4 + a_5 + b_{34} + b_{35} + b_{45} \ge \frac{2}{5}n + \frac{1}{5}
\]
and we similarly define $t_{ij}$ for $1 \le i < j \le 5$.

\textbf{Claim 锟斤拷锟絵 The number $\frac{2n+1}{5}$ is equal to some integer $k$, fourteen of the $t$锟斤拷锟絪 are equal to $k$, and the last one is equal to $k+1$.

\textbf{Proof.} First, summing all fifteen equations gives
\begin{align*}
6n + 4 &= 10 + 6(n - 1) = 10 + \sum_{1 \le i \le 5} 6a_i + \sum_{1 \le i < j \le 5} 6b_{ij} \\
&= \sum_{1 \le i \le 5} t_i + \sum_{1 \le i < j \le 5} t_{ij}.
\end{align*}
Thus the sum of the 15 $t$锟斤拷锟絪 is $6n + 4$. But since all the $t$锟斤拷锟絪 are integers at least $\frac{2n+1}{5} = \frac{6n + 3}{15}$, the conclusion follows. \qed

We however will also manipulate the equations to get the following.

\textbf{Claim 锟斤拷锟絵 We have 
\[
t_{45} \equiv 1 + t_1 + t_2 + t_3 + t_{12} + t_{23} + t_{31} \pmod{3}.
\]

\textbf{Proof.} This follows directly by computing the coefficient of the $a$锟斤拷锟絪 and $b$锟斤拷锟絪. We will nonetheless write out a derivation of this equation, to motivate it, but the proof stands without it.

Let $B = \sum_{1 \le i < j \le 5} b_{ij}$ be the sum of all $b$锟斤拷锟絪. First, note that
\begin{align*}
t_1 + t_2 &= B + b_{34} + b_{45} + b_{35} - b_{12} \\
&= B + (t_{12} - 1 - a_3 - a_4 - a_5) - b_{12} \\
\implies b_{12} &= B - (t_1 + t_2) + t_{12} - 1 - (a_3 + a_4 + a_5).
\end{align*}
This means we have more or less solved for each $b_{ij}$ in terms of only $t$ and $a$ variables.

Now
\begin{align*}
t_{45} &= 1 + a_1 + a_2 + a_3 + b_{12} + b_{23} + b_{31} \\
&= 1 + a_1 + a_2 + a_3 \\
&\quad + [B - (t_1 + t_2) + t_{12} - 1 - (a_3 + a_4 + a_5)] \\
&\quad + [B - (t_2 + t_3) + t_{23} - 1 - (a_1 + a_4 + a_5)] \\
&\quad + [B - (t_3 + t_1) + t_{13} - 1 - (a_2 + a_4 + a_5)] \\
&\equiv 1 + t_1 + t_2 + t_3 + t_{12} + t_{23} + t_{31} \pmod{3}
\end{align*}
as desired. \qed

However, we now show the two claims are incompatible (and this is easy, many ways to do this). There are two cases.
\begin{itemize}
\item Say $t_5 = k + 1$ and the others are $k$. Then the equation for $t_{45}$ gives that $k \equiv 6k + 1 \pmod{3}$. But now the equation for $t_{12}$ gives $k \equiv 6k \pmod{3}$.
\item Say $t_{45} = k + 1$ and the others are $k$. Then the equation for $t_{45}$ gives that $k + 1 \equiv 6k \pmod{3}$. But now the equation for $t_{12}$ gives $k \equiv 6k + 1 \pmod{3}$.
\end{itemize}",4,"Assume for contradiction that at most one contestant solved 5 problems. Let n be the total number of contestants and t_1, ..., t_15 be the integer counts of contestants solving each of the 15 pairs of problems. Establish a lower bound for each t_i.","Assume at most one contestant solved 5 problems. The condition that for each pair of problems more than 2/5 of contestants solved them translates to t_i > 2n/5 for i=1, ..., 15. Since each t_i must be an integer, we have the strict lower bound t_i >= floor(2n/5) + 1.","Under the assumption of at most one 5-problem solver, calculate the sum of the number of solvers over all 15 pairs of problems, sum(t_i), and show that this implies 2n+1 is a multiple of 5.","To establish a tight bound, we assume one contestant solved 5 problems and the other n-1 contestants each solved exactly 4 problems. The contestant with 5 solved problems contributes to C(5,2)=10 pairs. Each of the n-1 contestants with 4 solved problems contributes to C(4,2)=6 pairs. The total sum is sum(t_i) = 10 + 6(n-1) = 6n+4. Combining with t_i >= floor(2n/5) + 1, let 2n = 5q+r. The sum inequality 6n+4 >= 15(q+1) implies 3(5q+r)+4 >= 15q+15, which simplifies to 3r >= 11. The only possible integer value for r in {0,1,2,3,4} is r=4. Thus, 2n = 5q+4, which means 2n+1 is a multiple of 5.","Given that 2n+1 is a multiple of 5, let k=(2n+1)/5. Determine the exact values of the 15 counts t_1, ..., t_15.","From Part 2, 2n+1=5k for some integer k. The inequality t_i > 2n/5 is equivalent to t_i > (5k-1)/5 = k - 1/5. Since t_i is an integer, this implies t_i >= k. We also know from Part 2 that sum(t_i) = 6n+4. The minimum possible sum is 15k = 15(2n+1)/5 = 3(2n+1) = 6n+3. As the actual sum is 6n+4, which is one greater than the minimum, exactly one of the t_i values must be k+1 and the other fourteen must be k.",Show that there are at least 2 contestants who solved exactly 5 problems each.,"A linear congruence can be established between different t_i values by expressing them in terms of the number of contestants in each subgroup. For example, t_{45} is congruent to 1 + t_1 + t_2 + t_3 + t_{12} + t_{23} + t_{31} (mod 3). The set of values for the t variables is {k, k, ..., k, k+1}, as found in Part 3. Substituting these values into the congruence relation and its permutations leads to a contradiction. Depending on whether the term with value k+1 is included in a specific instance of the congruence, we obtain contradictory requirements on the value of k mod 3. This contradiction proves the initial assumption (of at most one 5-problem solver) was false. Therefore, there must be at least two contestants who solved exactly 5 problems."
2004p1,Let $ABC$ be an acute-angled triangle with $AB\neq AC$. The circle with diameter $BC$ intersects the sides $AB$ and $AC$ at $M$ and $N$ respectively. Denote by $O$ the midpoint of the side $BC$. The bisectors of the angles $\angle BAC$ and $\angle MON$ intersect at $R$. Prove that the circumcircles of the triangles $BMR$ and $CNR$ have a common point lying on the side $BC$.,"Let $\angle{ACB} = a$, $\angle{CBA} = b$, and $\angle{ONR} = k$. Call $\omega$ the circle with diameter $BC$ and $\odot{AMN}$ the circumcircle of $\triangle{AMN}$.

Our ultimate goal is to show that $\angle{CNR} + \angle{RMB} = 180^\circ$. To show why this solves the problem, assume this statement holds true. Call $K$ the intersection point of the circumcircle of $\triangle{CNR}$ with side $BC$. Then, $\angle{RKC} = 180^\circ - \angle{CNR}$, and $\angle{RKB} = \angle{CNR}$. Since $\angle{RMB} = 180^\circ - \angle{CNR}$, $\angle{RKB} + \angle{RMB}  = 180^\circ$, implying $K$ also lies on the circumcircle of $\triangle{BMR}$, thereby solving the problem.

We now prove that $\angle{CNR} + \angle{RMB} = 180^\circ$. Note that $ON$ and $OM$ are radii of $\omega$, so $\triangle{MON}$ is isosceles. The bisector of $\angle{MON}$ is thus the perpendicular bisector of $MN$. Since $R$ lies on the bisector of $\angle{MON}$, $\angle{ONR} = \angle{RMO} = k$. Angle computations yield that \[\angle{RMN} = 180^\circ - \angle{BMO} - \angle{RMO} - \angle{AMN}\]\[= 180^\circ - b - k - a,\] from $\angle{AMN} = 180^\circ - \angle{BMN} = 180^\circ - (180^\circ - \angle{ACB}) = \angle{ACB}$ and from $\angle{BMO} = \angle{MBO} =$ $\angle{ABC}$.

The bisector of $\angle{BAC}$ hits $\odot{AMN}$ at the midpoint of the arc $MN$ not containing $A$. This point must lie on the perpendicular bisector of segment $MN$, which is the bisector of $\angle{MON}$. It follows that $R$ is indeed the midpoint of arc $MN$, so $A$, $M$, $R$, $N$, are concyclic. Since $\angle{RAN}$ and $\angle{RMN}$ subtend the same arc $NR$, $\angle{RAN}$ = $\angle{RMN}$. With $AR$ being the bisector of $\angle{BAC}$, we have \[\angle{RAN} = \angle{RMN} = \tfrac{\angle{CAB}}{2} = \tfrac{180^\circ - a - b}{2} = 90^\circ - \tfrac{a}{2} - \tfrac{b}{2}.\] We know that $\angle{RMN} = 180^\circ - b - k - a$. so we have $180^\circ - b - k - a = 90^\circ - \tfrac{a}{2} - \tfrac{b}{2}$. Since $\angle{CNR} = \angle{CNO} + \angle{ONR} = a + k$, and $\angle{RMB} = \angle{OMB} + \angle{RMO} = b + k$, we have \[\angle{CNR} + \angle{RMB} = a + k + b + k = a + b + 180^\circ - a - b = 180^\circ.\]

The problem is solved.

$\textbf{NOTE:}$ We have $\angle{RKB} + \angle{KBA} + \angle{BAK} = 180^\circ \implies \angle{BAK} = 180^\circ - (180^\circ - \angle{RMB})  - \angle{KBA}$. Noting that $180^\circ - \angle{RMB} = 180^\circ - b - k = 180^\circ - (90^\circ - \tfrac{a}{2} + \tfrac{b}{2}) = 90^\circ + \tfrac{a}{2} - \tfrac{b}{2}$, we then have \[\angle{BAK} = 180^\circ - (90^\circ + \tfrac{a}{2} - \tfrac{b}{2}) - b = 90^\circ - \tfrac{a}{2} - \tfrac{b}{2}\] which is indeed the measure of $\angle{BAR}$. This implies that $K$ lies on the bisector of $\angle{BAC}$, and from this, it is clear that $K$ must lie on the interior of segment $BC$. Not proving that $K$ had to lie in the interior of $BC$ was a reason that a large portion of students who submitted a solution received a 1-point deduction.",3,"Let R be the intersection of the bisectors of angles $\angle BAC$ and $\angle MON$. Prove that the points A, M, R, N are concyclic.","The angle bisector of $\angle BAC$ intersects the circumcircle of $\triangle AMN$ at the midpoint of the arc $MN$ not containing $A$. The line $OR$ is the bisector of the angle $\angle MON$ in the isosceles triangle $\triangle MON$ (since $OM=ON$ are radii of the circle with diameter $BC$). Therefore, $OR$ is also the perpendicular bisector of the segment $MN$. The perpendicular bisector of a chord $MN$ also passes through the midpoint of the arc $MN$. Since both angle bisectors pass through the same point on the circumcircle of $\triangle AMN$, their intersection $R$ must lie on this circle. Thus, $A, M, R, N$ are concyclic.",Prove that the sum of the angles $\angle RMB$ and $\angle CNR$ is $180^\circ$.,"Let $\angle ABC = \beta$ and $\angle ACB = \gamma$. Since $O$ is the center of the circle on diameter $BC$, $\triangle OBM$ and $\triangle OCN$ are isosceles, giving $\angle OMB = \beta$ and $\angle ONC = \gamma$. As $R$ is on the angle bisector of $\angle MON$ in the isosceles $\triangle MON$, let $\angle RMO = \angle RNO = k$. From the concyclicity of A, M, R, N and the fact that AR bisects $\angle BAC$, it follows that $\angle RMN = \angle RAN = \angle BAC/2$. A key intermediate step is to show that $k = \angle BAC/2$. With this, we can write the required angles as $\angle RMB = \angle OMB + \angle RMO = \beta + k$ and $\angle CNR = \angle ONC + \angle RNO = \gamma + k$. The sum is $\angle RMB + \angle CNR = \beta + \gamma + 2k = \beta + \gamma + \angle BAC = 180^\circ$.",Let $ABC$ be an acute-angled triangle with $AB\neq AC$. The circle with diameter $BC$ intersects the sides $AB$ and $AC$ at $M$ and $N$ respectively. Denote by $O$ the midpoint of the side $BC$. The bisectors of the angles $\angle BAC$ and $\angle MON$ intersect at $R$. Prove that the circumcircles of the triangles $BMR$ and $CNR$ have a common point lying on the side $BC$.,"Let the circumcircle of $\triangle CNR$ intersect the side $BC$ at a point $K$. Since $C, N, R, K$ are concyclic, the quadrilateral $CNRK$ is cyclic. Therefore, $\angle RKB = 180^\circ - \angle RKC = \angle CNR$. From the previous sub-problem, we have shown that $\angle CNR + \angle RMB = 180^\circ$. Substituting, we get $\angle RKB + \angle RMB = 180^\circ$. This condition implies that the quadrilateral $BMRK$ is also cyclic. Thus, $K$ lies on the circumcircle of $\triangle BMR$. Since $K$ was defined to be on the side $BC$, this common point lies on $BC$, completing the proof.",,
2004p4,"Let $n \geq 3$ be an integer. Let $t_1, t_2, \dots , t_n$ be positive real numbers such that

\[n^2 + 1 > \left( t_1 + t_2 + ... + t_n \right) \left( \frac {1}{t_1} + \frac {1}{t_2} + ... + \frac {1}{t_n} \right).\]

Show that $t_i$, $t_j$, $t_k$ are side lengths of a triangle for all $i$, $j$, $k$ with $1 \leq i < j < k \leq n$.","For $n=3$, suppose (for sake of contradiction) that $t_3 = t_2 + t_1 + k$ for $k \ge 0$; then (by Cauchy-Schwarz Inequality)

\begin{align*}10 &> [2(t_1 + t_2) + k]\left(\frac {1}{t_1} + \frac {1}{t_2} + \frac 1{t_1 + t_2 + k}\right) = 2(t_1+t_2)\left(\frac 1{t_1} + \frac{1}{t_2}\right) + \left(\frac{k}{t_1} + \frac k{t_2}\right) + \frac{2t_1 + 2t_2 + k}{t_1 + t_2 + k}\\ &\ge 8 + \left(\frac{k}{t_1} + \frac k{t_2}\right) + 2 - \frac{k}{t_1 + t_2 + k}\\ &= 10 + k\left(\frac{1}{t_1} + \frac {1}{t_2} - \frac{1}{t_1 + t_2+k}\right) \ge 10\end{align*}

so it is true for $n=3$. We now claim the result by induction; for $n \ge 4$, we have

\begin{align*}f(n) &:= \left( t_1 + t_2 + ... + t_n \right) \left( \frac {1}{t_1} + \frac {1}{t_2} + ... + \frac {1}{t_n} \right) \\ &= \left( t_1 + t_2 + ... + t_{n-1} \right) \left( \frac {1}{t_1} + \frac {1}{t_2} + ... + \frac {1}{t_{n-1}} \right) + t_n \sum_{i=1}^{n-1} \frac 1{t_i} + \frac{1}{t_n} \sum_{i=1}^{n-1} t_i + 1\end{align*}

By AM-GM, $\frac{t_n}{t_i} + \frac{t_i}{t_n} \ge 2$, so $f(n) \ge f(n-1) + 2(n-1) + 1 = f(n-1) + 2n - 1$. Then the problem is reduced to proving the statement true for $n-1$ numbers, as desired.",2,"Let $t_1, t_2, t_3$ be positive real numbers such that $10 > (t_1+t_2+t_3)(\frac{1}{t_1}+\frac{1}{t_2}+\frac{1}{t_3})$. Show that $t_1, t_2, t_3$ are the side lengths of a triangle.","Assume for the sake of contradiction that $t_1, t_2, t_3$ do not form a triangle. Without loss of generality, let $t_3 \ge t_1 + t_2$. We can write $t_3 = t_1 + t_2 + k$ for some $k \ge 0$. The given expression is $(t_1+t_2+t_1+t_2+k)(\frac{1}{t_1}+\frac{1}{t_2}+\frac{1}{t_1+t_2+k}) = (2(t_1+t_2)+k)(\frac{1}{t_1}+\frac{1}{t_2}+\frac{1}{t_1+t_2+k})$. Expanding this, we get $2(t_1+t_2)(\frac{1}{t_1}+\frac{1}{t_2}) + k(\frac{1}{t_1}+\frac{1}{t_2}) + \frac{2(t_1+t_2)+k}{t_1+t_2+k}$. By Cauchy-Schwarz, $(t_1+t_2)(\frac{1}{t_1}+\frac{1}{t_2}) \\ge 4$. The expression is then $\\ge 8 + k(\frac{1}{t_1}+\frac{1}{t_2}) + \frac{2(t_1+t_2+k)-k}{t_1+t_2+k} = 10 + k(\frac{1}{t_1}+\frac{1}{t_2} - \frac{1}{t_1+t_2+k})$. Since $t_1, t_2 > 0$, we have $\frac{1}{t_1} > \frac{1}{t_1+t_2+k}$, so the term multiplying $k$ is positive. Thus the whole expression is $\\ge 10$, which contradicts the given condition. Therefore, $t_1, t_2, t_3$ must form a triangle.","Let $n \\geq 3$ be an integer. Let $t_1, t_2, \\dots , t_n$ be positive real numbers such that $n^2 + 1 > \\left( t_1 + t_2 + ... + t_n \right) \\left( \frac {1}{t_1} + \frac {1}{t_2} + ... + \frac {1}{t_n} \right)$. Show that $t_i$, $t_j$, $t_k$ are side lengths of a triangle for all $i$, $j$, $k$ with $1 \\leq i < j < k \\leq n$.","Let $f(S) = (\\sum_{t \\in S} t)(\\sum_{t \\in S} \frac{1}{t})$. We are given $f(\\{t_1, \\dots, t_n\\}) < n^2+1$. Consider any subset of $n-1$ elements, say $S' = \\{t_1, \\dots, t_{n-1}\\}$. We can write $f(\\{t_1, \\dots, t_n\\}) = f(S') + \\sum_{i=1}^{n-1}(\frac{t_n}{t_i} + \frac{t_i}{t_n}) + 1$. By AM-GM, $\frac{t_n}{t_i} + \frac{t_i}{t_n} \\ge 2$ for each $i$. Thus, $f(\\{t_1, \\dots, t_n\\}) \\ge f(S') + 2(n-1) + 1 = f(S') + 2n - 1$. This implies $f(S') < (n^2+1) - (2n-1) = (n-1)^2+1$. So any subset of $n-1$ numbers satisfies the condition. By repeatedly applying this reduction, any subset of 3 numbers, say $\\{t_i, t_j, t_k\\}$, must satisfy $(t_i+t_j+t_k)(\frac{1}{t_i}+\frac{1}{t_j}+\frac{1}{t_k}) < 3^2+1=10$. From the first sub-problem, this implies $t_i, t_j, t_k$ form a triangle. Since $i, j, k$ are arbitrary, the statement holds for all such triplets.",,,,
2004p5,"In a convex quadrilateral $ABCD$, the diagonal $BD$ bisects neither the angle $ABC$ nor the angle $CDA$. The point $P$ lies inside $ABCD$ and satisfies \[\angle PBC = \angle DBA \text{ and } \angle PDC = \angle BDA.\]

Prove that $ABCD$ is a cyclic quadrilateral if and only if $AP = CP.$","Let $a = t_1$, $b = t_2$, $c = t_3$. Expand:
\[
n^2 + 1 > (t_1 + t_2 + \cdots + t_n) \left( \frac{1}{t_1} + \cdots + \frac{1}{t_n} \right)
\]
\[
= n + \sum_{1 \le i < j \le n} \left( \frac{t_i}{t_j} + \frac{t_j}{t_i} \right)
\]
\[
= n + \sum_{1 \le i < j \le n} \left( \frac{t_i}{t_j} + \frac{t_j}{t_i} \right)
\]
\[
\ge n + \sum_{1 \le i < j \le 3} \left( \frac{t_i}{t_j} + \frac{t_j}{t_i} \right) + \sum_{\substack{1 \le i < j \le n\\ j > 3}} 2
\]
\[
= n + 2\left( \binom{n}{2} - 3 \right) + \left( \frac{a}{b} + \frac{b}{a} \right) + \frac{a + b}{c} + \frac{c}{b} + \frac{c}{a}
\]
\[
\ge n + 2\left( \binom{n}{2} - 3 \right) + 2 + \frac{a + b}{c} + c \cdot \frac{4}{a + b}
\]

So, we conclude that
\[
\frac{a + b}{c} + \frac{4c}{a + b} < 5
\]

which rearranges to
\[
(4c - (a + b))(c - (a + b)) < 0.
\]

This is enough to imply $c \le a + b$.

\textbf{Remark.} A variant of the same argument allows one to improve the left-hand side to $(n + \sqrt{10} - 3)^2$. One does so by writing
\[
\text{RHS} \ge \left( \sqrt{(a + b + c) \left( \frac{1}{a} + \frac{1}{b} + \frac{1}{c} \right)} + (n - 3) \right)^2
\]
and estimating the square root as in the previous approach.

In addition, $(n + \sqrt{10} - 3)^2$ is best possible, as seen by taking $(a,b,c) = (2,1,1)$ and $t_4 = t_5 = \cdots = \frac{2}{5}\sqrt{10}$.",1,"In a convex quadrilateral $ABCD$, the diagonal $BD$ bisects neither the angle $ABC$ nor the angle $CDA$. The point $P$ lies inside $ABCD$ and satisfies \[\angle PBC = \angle DBA \text{ and } \angle PDC = \angle BDA.\]

Prove that $ABCD$ is a cyclic quadrilateral if and only if $AP = CP.$","Let $a = t_1$, $b = t_2$, $c = t_3$. Expand:
\[
n^2 + 1 > (t_1 + t_2 + \cdots + t_n) \left( \frac{1}{t_1} + \cdots + \frac{1}{t_n} \right)
\]
\[
= n + \sum_{1 \le i < j \le n} \left( \frac{t_i}{t_j} + \frac{t_j}{t_i} \right)
\]
\[
= n + \sum_{1 \le i < j \le n} \left( \frac{t_i}{t_j} + \frac{t_j}{t_i} \right)
\]
\[
\ge n + \sum_{1 \le i < j \le 3} \left( \frac{t_i}{t_j} + \frac{t_j}{t_i} \right) + \sum_{\substack{1 \le i < j \le n\\ j > 3}} 2
\]
\[
= n + 2\left( \binom{n}{2} - 3 \right) + \left( \frac{a}{b} + \frac{b}{a} \right) + \frac{a + b}{c} + \frac{c}{b} + \frac{c}{a}
\]
\[
\ge n + 2\left( \binom{n}{2} - 3 \right) + 2 + \frac{a + b}{c} + c \cdot \frac{4}{a + b}
\]

So, we conclude that
\[
\frac{a + b}{c} + \frac{4c}{a + b} < 5
\]

which rearranges to
\[
(4c - (a + b))(c - (a + b)) < 0.
\]

This is enough to imply $c \le a + b$.

\textbf{Remark.} A variant of the same argument allows one to improve the left-hand side to $(n + \sqrt{10} - 3)^2$. One does so by writing
\[
\text{RHS} \ge \left( \sqrt{(a + b + c) \left( \frac{1}{a} + \frac{1}{b} + \frac{1}{c} \right)} + (n - 3) \right)^2
\]
and estimating the square root as in the previous approach.

In addition, $(n + \sqrt{10} - 3)^2$ is best possible, as seen by taking $(a,b,c) = (2,1,1)$ and $t_4 = t_5 = \cdots = \frac{2}{5}\sqrt{10}$.",,,,,,
2003p1,"$S$ is the set  $\{1, 2, 3, \dots ,1000000\}$. Show that for any subset $A$ of $S$ with $101$ elements we can find $100$ distinct elements $x_i$ of $S$, such that the sets $\{a + x_i \mid a \in A\}$ are all pairwise disjoint.","A greedy algorithm works: suppose we have picked
\[
T = \{t_1, \dots, t_n\}
\]
as large as possible, meaning it锟斤拷锟絪 impossible to add any more elements to $T$. That means, for each $t \in \{1, \dots, 10^6\}$ either $t \in T$ already or there exist two distinct elements $a, b \in A$ and $t_i \in T$ such that
\[
t = t_i + b - a \tag{$\star$}.
\]

There are at most $|T| \cdot |A| \cdot (|A| - 1) = n \cdot 101 \cdot 100$ possible values for the right-hand side of $(\star)$. So we therefore must have
\[
101 \cdot 100 \cdot n + n \ge 10^6
\]
which implies $n > 99$, as desired.",2,"Let $S = \{1, 2, \dots, 10^6\}$ and $A \subset S$ with $|A|=101$. Let $X$ be a subset of $S$ of size $n$ with the property that for any two distinct $x_i, x_j \in X$, the sets $A+x_i = \{a+x_i \mid a \in A\}$ and $A+x_j = \{a+x_j \mid a \in A\}$ are disjoint. If $X$ is a maximal such set (i.e., no more elements from $S$ can be added to $X$ without violating the property), show that $|S| \le n(1 + |A|(|A|-1))$.","Let $X = \{x_1, \dots, x_n\}$ be a maximal set with the given property. By maximality, for any element $y \in S \setminus X$, the set $X \cup \{y\}$ does not have the property. This means that for any $y \in S \setminus X$, there exists some $x_i \in X$ such that $(A+y) \cap (A+x_i) \neq \emptyset$. This implies there exist $a, b \in A$ such that $y+a = x_i+b$, so $y = x_i+b-a$. Since $y \notin X$, we must have $a \neq b$. Therefore, every element of $S$ is either in $X$ or in the set $\{x_i+b-a \mid x_i \in X, a,b \in A, a \neq b\}$. By the union bound, $|S| \le |X| + |\{x_i+b-a \mid x_i \in X, a,b \in A, a \neq b\}|$. The size of the second set is at most $n \cdot |A| \cdot (|A|-1)$. So, $|S| \le n + n|A|(|A|-1) = n(1+|A|(|A|-1))$.","$S$ is the set  $\{1, 2, 3, \dots ,1000000\}$. Show that for any subset $A$ of $S$ with $101$ elements we can find $100$ distinct elements $x_i$ of $S$, such that the sets $\{a + x_i \mid a \in A\}$ are all pairwise disjoint.","Let $X$ be a maximal subset of $S$ with the property that the sets $\{a+x \mid a \in A\}$ are pairwise disjoint for all $x \in X$. Let $n=|X|$. From the first sub-problem, we have the inequality $|S| \le n(1+|A|(|A|-1))$. Plugging in the values $|S|=1000000$ and $|A|=101$, we get $1000000 \le n(1+101(100)) = 10101n$. Solving for $n$ gives $n \ge 1000000/10101 \approx 99.000...$. Since $n$ must be an integer, $n \ge 100$. This shows that any maximal set with the property has at least 100 elements. Thus, we can find a set of 100 such elements by taking any 100 elements from a maximal set.",,,,
2003p3,Each pair of opposite sides of convex hexagon has the property that the distance between their midpoints is $\frac{\sqrt{3}}{2}$ times the sum of their lengths. Prove that the hexagon is equiangular.,"Unsurprisingly, this is a geometric inequality. Denote the hexagon by $ABCDEF$. Then we have that
\[
\left| \frac{\vec{D} + \vec{E}}{2} - \frac{\vec{A} + \vec{B}}{2} \right| = \sqrt{3} \cdot \left| \frac{\vec{B} - \vec{A}}{2} + \frac{\vec{E} - \vec{D}}{2} \right| \ge \sqrt{3} \cdot \left| \frac{(\vec{B} - \vec{A}) - (\vec{E} - \vec{D})}{2} \right|
\]
and cyclic variations. Suppose we define the right-hand sides as variables
\[
\vec{x} = (\vec{B} - \vec{A}) - (\vec{E} - \vec{D})
\]
\[
\vec{y} = (\vec{D} - \vec{C}) - (\vec{A} - \vec{F})
\]
\[
\vec{z} = (\vec{F} - \vec{E}) - (\vec{C} - \vec{B}).
\]

Then we now have
\[
|\vec{y} - \vec{z}| \ge \sqrt{3} |\vec{x}|,\quad
|\vec{z} - \vec{x}| \ge \sqrt{3} |\vec{y}|,\quad
|\vec{x} - \vec{y}| \ge \sqrt{3} |\vec{z}|.
\]

We square all sides (using $|\vec{v}|^2 = \vec{v} \cdot \vec{v}$) and then sum to get
\[
\sum_{\text{cyc}} (\vec{y} - \vec{z}) \cdot (\vec{y} - \vec{z}) \ge 3 \sum_{\text{cyc}} \vec{x} \cdot \vec{x}
\]
which rearranges to
\[
-|\vec{x} + \vec{y} + \vec{z}|^2 \ge 0.
\]

This can only happen if $\vec{x} + \vec{y} + \vec{z} = 0$, and moreover all the inequalities above were actually equalities. That means that our triangle inequalities above were actually sharp (and already we have $\overline{AB} \parallel \overline{DE}$ and so on).

Working with just $\vec{x}$ and $\vec{y}$ now we have
\begin{align*}
3(\vec{x} \cdot \vec{x}) &= (2\vec{y} - \vec{x}) \cdot (2\vec{y} - \vec{x}) \\
&= \vec{x} \cdot \vec{x} - 4\vec{y} \cdot \vec{x} + 4\vec{y} \cdot \vec{y} \\
\implies -\vec{x} \cdot \vec{x} + 2(\vec{y} \cdot \vec{y}) &= 2\vec{x} \cdot \vec{y} \\
2(\vec{x} \cdot \vec{x}) - \vec{y} \cdot \vec{y} &= 2\vec{x} \cdot \vec{y}.
\end{align*}

which implies $\vec{x} \cdot \vec{x} = \vec{y} \cdot \vec{y}$, that is, $\vec{x}$ and $\vec{y}$ have the same magnitude. In this way we find $\vec{x}, \vec{y}, \vec{z}$ all have the same magnitude, and since $\vec{x} + \vec{y} + \vec{z} = 0$ they are related by $120^\circ$ rotations, as desired.",3,"Let the vertices of the hexagon be represented by vectors $\vec{A}, \vec{B}, \dots, \vec{F}$. Define $\vec{x} = (\vec{B}-\vec{A}) - (\vec{E}-\vec{D})$, $\vec{y} = (\vec{D}-\vec{C}) - (\vec{A}-\vec{F})$, and $\vec{z} = (\vec{F}-\vec{E}) - (\vec{C}-\vec{B})$. Using the given condition that the distance between the midpoints of any pair of opposite sides is $\frac{\sqrt{3}}{2}$ times the sum of their lengths, derive the inequalities $|\vec{y}-\vec{z}| \ge \sqrt{3}|\vec{x}|$, $|\vec{z}-\vec{x}| \ge \sqrt{3}|\vec{y}|$, and $|\vec{x}-\vec{y}| \ge \sqrt{3}|\vec{z}|$.","The distance between the midpoints of opposite sides $AB$ and $DE$ is $|\frac{\vec{D}+\vec{E}}{2} - \frac{\vec{A}+\vec{B}}{2}|$. It can be shown that this equals $|\frac{\vec{y}-\vec{z}}{2}|$. The problem states this distance is $\frac{\sqrt{3}}{2}(|\vec{B}-\vec{A}| + |\vec{E}-\vec{D}|)$. By the triangle inequality, $|\vec{B}-\vec{A}| + |\vec{E}-\vec{D}| \ge |(\vec{B}-\vec{A}) - (\vec{E}-\vec{D})| = |\vec{x}|$. Combining these, we get $|\frac{\vec{y}-\vec{z}}{2}| \ge \frac{\sqrt{3}}{2}|\vec{x}|$, which simplifies to $|\vec{y}-\vec{z}| \ge \sqrt{3}|\vec{x}|$. The other two inequalities are derived by cyclic permutation of the sides.","Given three vectors $\vec{x}, \vec{y}, \vec{z}$ in a plane satisfying the inequalities $|\vec{y}-\vec{z}| \ge \sqrt{3}|\vec{x}|$, $|\vec{z}-\vec{x}| \ge \sqrt{3}|\vec{y}|$, and $|\vec{x}-\vec{y}| \ge \sqrt{3}|\vec{z}|$, prove that these must be equalities, that $\vec{x}+\vec{y}+\vec{z}=\vec{0}$, and that $|\vec{x}|=|\vec{y}|=|\vec{z}|$.","Squaring the given inequalities yields $|\vec{y}|^2 - 2\vec{y}\cdot\vec{z} + |\vec{z}|^2 \ge 3|\vec{x}|^2$ and its cyclic permutations. Summing these three inequalities gives $2(|\vec{x}|^2+|\vec{y}|^2+|\vec{z}|^2) - 2(\vec{x}\cdot\vec{y}+\vec{y}\cdot\vec{z}+\vec{z}\cdot\vec{x}) \ge 3(|\vec{x}|^2+|\vec{y}|^2+|\vec{z}|^2)$. This simplifies to $-(|\vec{x}|^2+|\vec{y}|^2+|\vec{z}|^2) - 2(\vec{x}\cdot\vec{y}+\vec{y}\cdot\vec{z}+\vec{z}\cdot\vec{x}) \ge 0$, which is equivalent to $-|\vec{x}+\vec{y}+\vec{z}|^2 \ge 0$. Since a squared magnitude cannot be negative, we must have $\vec{x}+\vec{y}+\vec{z}=\vec{0}$ and all three initial inequalities must be equalities. Using $\vec{z}=-(\vec{x}+\vec{y})$ in the equality $|\vec{x}-\vec{y}|^2 = 3|\vec{z}|^2$ and its cyclic permutations leads to a system of equations which implies $|\vec{x}|=|\vec{y}|=|\vec{z}|$.",Each pair of opposite sides of convex hexagon has the property that the distance between their midpoints is $\frac{\sqrt{3}}{2}$ times the sum of their lengths. Prove that the hexagon is equiangular.,"From sub-problem 1 and 2, the given condition implies that the triangle inequality used, $|\vec{B}-\vec{A}| + |\vec{E}-\vec{D}| \ge |(\vec{B}-\vec{A}) - (\vec{E}-\vec{D})|$, must be an equality. This holds if and only if the vectors $\vec{B}-\vec{A}$ and $\vec{E}-\vec{D}$ are collinear and point in opposite directions. Thus, all pairs of opposite sides are parallel. From sub-problem 2, the vectors $\vec{x}, \vec{y}, \vec{z}$ (which are differences of opposite side vectors) have equal magnitude and sum to zero, meaning they are separated by $120^\circ$ angles. These two conditions combined imply that the vectors representing the sides of the hexagon must all have the same length, and the angle between consecutive side vectors (e.g., $\vec{A}-\vec{B}$ and $\vec{C}-\vec{B}$) is $120^\circ$. This means every internal angle of the hexagon is $120^\circ$, so the hexagon is equiangular.",,
2003p4,"Let $ABCD$ be a cyclic quadrilateral. Let $P$, $Q$, and $R$ be the feet of perpendiculars from $D$ to lines $\overline{BC}$, $\overline{CA}$, and $\overline{AB}$, respectively. Show that $PQ=QR$ if and only if the bisectors of angles $ABC$ and $ADC$ meet on segment $\overline{AC}$.","Let $\gamma$ denote the circumcircle of $ABCD$. The condition on bisectors is equivalent to 
\[
(AC;BD)_\gamma = -1.
\]
Meanwhile if $\infty$ denotes the point at infinity along Simson line $\overline{PQR}$ then $PQ = QR$ if and only if 
\[
(PR;Q\infty) = -1.
\]
Let rays $BQ$ and $DQ$ meet the circumcircle again at $F$ and $E$.

\textbf{Lemma (EGMO Proposition 4.1)} \quad Then $\overline{BE} \parallel \overline{PQR}$.

\textit{Proof.} Since $\angle DPR = \angle DAR = \angle DAB = \angle DEB$.

\[
\text{Now we have} \quad (PR;Q\infty) \overset{B}{=} (CA;FE)_\gamma \overset{Q}{=} (AC;BD)_\gamma
\]
as desired. \qed",1,"Let $ABCD$ be a cyclic quadrilateral. Let $P$, $Q$, and $R$ be the feet of perpendiculars from $D$ to lines $\overline{BC}$, $\overline{CA}$, and $\overline{AB}$, respectively. Show that $PQ=QR$ if and only if the bisectors of angles $ABC$ and $ADC$ meet on segment $\overline{AC}$.","Let $\gamma$ denote the circumcircle of $ABCD$. The condition on bisectors is equivalent to 
\[
(AC;BD)_\gamma = -1.
\]
Meanwhile if $\infty$ denotes the point at infinity along Simson line $\overline{PQR}$ then $PQ = QR$ if and only if 
\[
(PR;Q\infty) = -1.
\]
Let rays $BQ$ and $DQ$ meet the circumcircle again at $F$ and $E$.

\textbf{Lemma (EGMO Proposition 4.1)} \quad Then $\overline{BE} \parallel \overline{PQR}$.

\textit{Proof.} Since $\angle DPR = \angle DAR = \angle DAB = \angle DEB$.

\[
\text{Now we have} \quad (PR;Q\infty) \overset{B}{=} (CA;FE)_\gamma \overset{Q}{=} (AC;BD)_\gamma
\]
as desired. \qed",,,,,,
2003p5,"Let $n$ be a positive integer and let $x_1 \le x_2 \le \cdots \le x_n$ be real numbers. Prove that

\[\left( \sum_{i=1}^{n}\sum_{j=i}^{n} |x_i-x_j|\right)^2 \le \frac{2(n^2-1)}{3}\sum_{i=1}^{n}\sum_{j=i}^{n}(x_i-x_j)^2\]

with equality if and only if $x_1, x_2, ..., x_n$ form an arithmetic sequence.","Let $d_1 = x_2 - x_1, \dots, d_{n-1} = x_n - x_{n-1}$. The inequality in question becomes:
\[
\left( \sum_i i(n-i)d_i \right)^2 \leq \frac{n^2 - 1}{3} \cdot \left( \sum_i i(n-i)d_i^2 + 2\sum_{i<j} i(n-j)d_i d_j \right).
\]

Clearing the square on the right-hand side we want to show
\[
\sum_{i<j} \left( 3ij(n-i)(n-j) - (n^2 - 1)i(n-j) \right) \cdot 2 d_i d_j \le \sum_i \left(n^2 - 1 - 3i(n - i) \right) \cdot i(n - i) d_i^2.
\]

We use AM-GM directly on $2d_i d_j \le d_i^2 + d_j^2$: this actually solves the problem. The annoying part is to check that the coefficients actually match:

\textbf{Claim (Big bash)} 锟斤拷锟?For an index $1 \le k \le n-1$, we have
\[
\sum_{i<k} \left( 3ik(n-i)(n-k) - (n^2 - 1)i(n-k) \right)
+ \sum_{j>k} \left( 3kj(n-k)(n-j) - (n^2 - 1)k(n-j) \right)
= (n^2 - 1 - 3k(n-k)) \cdot k(n-k).
\]

\textit{Proof.} Rewrite as:
\[
3k(n-k) \left( -k(n-k) + \sum_i i(n-i) \right)
= (n^2 - 1)\left( (n-k) \sum_{i<k} i + k \sum_{j>k} (n-j) \right)
\]
\[
\Longleftrightarrow 3k(n-k) \sum_i i(n-i)
= (n^2 - 1)\left( (n-k) \sum_{i<k} i + k \sum_{j>k} (n-j) \right)
+ (n^2 - 1)k(n-k) - 3k^2(n-k)^2
\]
\[
\Longleftrightarrow 3k(n-k) \left( \sum_i i(n-i) \right)
= (n^2 - 1)\left( (n-k) \sum_{i<k} i + k \sum_{i<n-k} i \right)
\]

\[
\Longleftrightarrow 3k(n-k) \cdot \frac{(n-1)n(n+1)}{6}
= (n^2 - 1)k(n-k) \cdot \frac{n}{2}
\]

which is visibly true. \qed

Equality occurs only if all $d_i$ are equal because the coefficient of $d_i d_j$ is nonzero for any $i \le n/2$ and $j \ge n/2$.",1,"Let $n$ be a positive integer and let $x_1 \le x_2 \le \cdots \le x_n$ be real numbers. Prove that

\[\left( \sum_{i=1}^{n}\sum_{j=i}^{n} |x_i-x_j|\right)^2 \le \frac{2(n^2-1)}{3}\sum_{i=1}^{n}\sum_{j=i}^{n}(x_i-x_j)^2\]

with equality if and only if $x_1, x_2, ..., x_n$ form an arithmetic sequence.","Let $d_1 = x_2 - x_1, \dots, d_{n-1} = x_n - x_{n-1}$. The inequality in question becomes:
\[
\left( \sum_i i(n-i)d_i \right)^2 \leq \frac{n^2 - 1}{3} \cdot \left( \sum_i i(n-i)d_i^2 + 2\sum_{i<j} i(n-j)d_i d_j \right).
\]

Clearing the square on the right-hand side we want to show
\[
\sum_{i<j} \left( 3ij(n-i)(n-j) - (n^2 - 1)i(n-j) \right) \cdot 2 d_i d_j \le \sum_i \left(n^2 - 1 - 3i(n - i) \right) \cdot i(n - i) d_i^2.
\]

We use AM-GM directly on $2d_i d_j \le d_i^2 + d_j^2$: this actually solves the problem. The annoying part is to check that the coefficients actually match:

\textbf{Claim (Big bash)} 锟斤拷锟?For an index $1 \le k \le n-1$, we have
\[
\sum_{i<k} \left( 3ik(n-i)(n-k) - (n^2 - 1)i(n-k) \right)
+ \sum_{j>k} \left( 3kj(n-k)(n-j) - (n^2 - 1)k(n-j) \right)
= (n^2 - 1 - 3k(n-k)) \cdot k(n-k).
\]

\textit{Proof.} Rewrite as:
\[
3k(n-k) \left( -k(n-k) + \sum_i i(n-i) \right)
= (n^2 - 1)\left( (n-k) \sum_{i<k} i + k \sum_{j>k} (n-j) \right)
\]
\[
\Longleftrightarrow 3k(n-k) \sum_i i(n-i)
= (n^2 - 1)\left( (n-k) \sum_{i<k} i + k \sum_{j>k} (n-j) \right)
+ (n^2 - 1)k(n-k) - 3k^2(n-k)^2
\]
\[
\Longleftrightarrow 3k(n-k) \left( \sum_i i(n-i) \right)
= (n^2 - 1)\left( (n-k) \sum_{i<k} i + k \sum_{i<n-k} i \right)
\]

\[
\Longleftrightarrow 3k(n-k) \cdot \frac{(n-1)n(n+1)}{6}
= (n^2 - 1)k(n-k) \cdot \frac{n}{2}
\]

which is visibly true. \qed

Equality occurs only if all $d_i$ are equal because the coefficient of $d_i d_j$ is nonzero for any $i \le n/2$ and $j \ge n/2$.",,,,,,
2003p6,"Let $p$ be a prime number. Prove that there exists a prime number $q$ such that for every integer $n$, the number $n^p-p$ is not divisible by $q$.","By orders, we must have \( q = pk + 1 \) for this to be possible (since if \( q \not\equiv 1 \pmod{p} \), then \( n^p \) can be any residue modulo \( q \)). Since \( p \equiv n^p \pmod{q} \Longrightarrow p^k \equiv 1 \pmod{q} \), it suffices to prevent the latter situation from happening.

So we need a prime \( q \equiv 1 \pmod{p} \) such that \( p^k \not\equiv 1 \pmod{q} \). To do this, we first recall the following lemma.

\begin{center}
\begin{tcolorbox}[colback=white!95!blue, colframe=blue, sharp corners=south]
\textbf{Lemma} \\
Let \( \Phi_p(X) = 1 + X + X^2 + \cdots + X^{p-1} \). For any integer \( a \), if \( q \) is a prime divisor of \( \Phi_p(a) \) other than \( p \), then \( a \pmod{q} \) has order \( p \). (In particular, \( q \equiv 1 \pmod{p} \).)
\end{tcolorbox}
\end{center}

\textit{Proof.} We have \( a^p - 1 \equiv 0 \pmod{q} \), so either the order is 1 or \( p \). If it is 1, then \( a \equiv 1 \pmod{q} \), so \( q \mid \Phi_p(1) = p \), hence \( q = p \). \qed

Now the idea is to extract a prime factor \( q \) from the cyclotomic polynomial
\[
\Phi_p(p) = \frac{p^p - 1}{p - 1} \equiv 1 + p \pmod{p^2}
\]
such that \( q \not\equiv 1 \pmod{p^2} \); hence \( k \not\equiv 0 \pmod{p} \), and as \( p \pmod{q} \) has order \( p \) we have \( p^k \not\equiv 1 \pmod{q} \).",3,Let $p$ and $q$ be primes with $q \equiv 1 \pmod p$. Show that the condition '$n^p-p$ is not divisible by $q$ for any integer $n$' is equivalent to the condition $p^{(q-1)/p} \not\equiv 1 \pmod q$.,"The condition that $n^p-p$ is not divisible by $q$ for any integer $n$ is equivalent to $p$ not being a $p$-th power residue modulo $q$. Since $q \equiv 1 \pmod p$, we have $q>p$, so $q \nmid p$. The criterion for an integer $a \not\equiv 0 \pmod q$ to be a $p$-th power residue modulo $q$ is $a^{(q-1)/p} \equiv 1 \pmod q$. Therefore, the desired condition is equivalent to $p^{(q-1)/p} \not\equiv 1 \pmod q$.",Let $p$ be a prime and let $\Phi_p(x) = \frac{x^p-1}{x-1}$. Prove that any prime divisor $q$ of $\Phi_p(p)$ satisfies $q \equiv 1 \pmod p$ and that the multiplicative order of $p$ modulo $q$ is exactly $p$.,"Let $q$ be a prime divisor of $\Phi_p(p)$. Then $p^p - 1 = (p-1)\Phi_p(p) \equiv 0 \pmod q$. The order of $p$ modulo $q$ must divide $p$, so it is 1 or $p$. If the order were 1, then $p \equiv 1 \pmod q$. This would imply $\Phi_p(p) \equiv \Phi_p(1) = p \pmod q$. Since $q \mid \Phi_p(p)$, it would follow that $q \mid p$, so $q=p$. But this leads to the contradiction $p \equiv 1 \pmod p$. Thus, the order of $p$ modulo $q$ must be $p$. By Fermat's Little Theorem, the order $p$ must divide $q-1$, which means $q \equiv 1 \pmod p$.","Let $p$ be a prime number. Prove that there exists a prime number $q$ such that for every integer $n$, the number $n^p-p$ is not divisible by $q$.","Consider $N = \Phi_p(p) = 1+p+\dots+p^{p-1}$. We have $N \equiv 1+p \pmod{p^2}$, so $N \not\equiv 1 \pmod{p^2}$. Assume all prime factors of $N$ are congruent to $1 \pmod{p^2}$. Then $N$ itself must be congruent to $1 \pmod{p^2}$, a contradiction. Thus, there exists a prime factor $q$ of $N$ such that $q \not\equiv 1 \pmod{p^2}$. By sub-problem 2, this $q$ satisfies $q \equiv 1 \pmod p$ and the order of $p$ mod $q$ is $p$. Since the order is $p$, the condition $p^{(q-1)/p} \not\equiv 1 \pmod q$ is equivalent to $p \nmid (q-1)/p$, which is $q \not\equiv 1 \pmod{p^2}$. Our chosen $q$ satisfies this. By sub-problem 1, this prime $q$ has the desired property.",,
2002p1,"$S$ is the set of all $(h,k)$ with $h,k$ non-negative integers such that $h + k < n$. Each element of $S$ is colored red or blue, so that if $(h,k)$ is red and $h' \le h,k' \le k$, then $(h',k')$ is also red. A type $1$ subset of $S$ has $n$ blue elements with different first member and a type $2$ subset of $S$ has $n$ blue elements with different second member. Show that there are the same number of type $1$ and type $2$ subsets.","Let \( a_i \) be the number of blue members \( (h,k) \) in \( S \) with \( h = i \), and let \( b_i \) be the number of blue members \( (h,k) \) with \( k = i \). It is sufficient to show that \( b_0, b_1, \ldots, b_{n-1} \) is a rearrangement of \( a_0, a_1, \ldots, a_{n-1} \) (because the number of type 1 subsets is the product of the \( a_i \) and the number of type 2 subsets is the product of the \( b_i \)).

Let \( c_i \) be the largest \( k \) such that \( (i,k) \) is red. If \( (i,k) \) is blue for all \( k \) then we put \( c_i = -1 \). Note that if \( i < j \), then \( c_i \geq c_j \), since if \( (j, c_i) \) is red, then so is \( (i, c_i) \). Note also that \( (i,k) \) is red for \( k \leq c_i \), so the sequence \( c_0, c_1, \ldots, c_{n-1} \) completely defines the coloring of \( S \).

Let \( S_i \) be the set with the sequence \( c_0, c_1, \ldots, c_i, -1, \ldots, -1 \), so that \( S_{n-1} = S \). We also take \( S_{-1} \) as the set with the sequence \( -1, -1, \ldots, -1 \), so that all its members are blue. We show that the rearrangement result is true for \( S_{-1} \) and that if it is true for \( S_i \) then it is true for \( S_{i+1} \). It is obvious for \( S_{-1} \), because both \( a_i \) and \( b_i \) are \( n, n-1, \ldots, 2, 1 \). So suppose it is true for \( S_i \) (where \( i < n-1 \)). The only difference between the \( a_j \) for \( S_i \) and for \( S_{i+1} \) is that \( a_{i+1} = n - i - 1 \) for \( S_i \) and \( (n - i - 1) - (c_{i+1} + 1) \) for \( S_{i+1} \). In other words, the number \( n - i - 1 \) is replaced by the number \( n - i - c - 2 \), where \( c = c_{i+1} \). The difference in the \( b_j \) is that 1 is deducted from each of \( b_0, b_1, \ldots, b_c \). But these numbers are just \( n - i - 1, n - i - 1, n - i - 2, \ldots, n - i - c - 1 \). So the effect of deducting 1 from each is to replace \( n - i - 1 \) by \( n - i - c - 2 \), which is the same change as was made to the \( a_j \). So the rearrangement result also holds for \( S_{i+1} \). Hence it holds for \( S \).",3,"Let $a_i$ be the number of blue elements $(h,k)$ with $h=i$, and $b_k$ be the number of blue elements with $k=j$. Show that the problem is equivalent to proving that the multiset $\{a_0, a_1, \ldots, a_{n-1}\}$ is a permutation of the multiset $\{b_0, b_1, \ldots, b_{n-1}\}$.","A type 1 subset is formed by choosing one blue element for each distinct first member $h=0, \ldots, n-1$. There are $a_i$ choices for each $h=i$, so the total number of type 1 subsets is $\prod_{i=0}^{n-1} a_i$. Similarly, the number of type 2 subsets is $\prod_{k=0}^{n-1} b_k$. If the multiset $\{a_0, \ldots, a_{n-1}\}$ is a permutation of $\{b_0, \ldots, b_{n-1}\}$, their products are equal, proving the original statement.","Characterize any valid coloring by a non-increasing sequence of integers $c_0, \ldots, c_{n-1}$. Then, establish the base case for an inductive proof by showing that for the 'all blue' coloring, the multisets $\{a_i\}$ and $\{b_k\}$ are identical.","Let $c_i$ be the largest $k$ such that $(i,k)$ is red, or $c_i=-1$ if no such $k$ exists. The coloring rule implies $c_0 \ge c_1 \ge \dots \ge c_{n-1}$. We proceed by induction. The base case is when all $c_i = -1$, meaning all elements of $S$ are blue. In this case, $a_i$ is the total number of points with first member $i$, which is $n-i$. Similarly, $b_k$ is the total number of points with second member $k$, which is $n-k$. The multisets $\{a_0, \dots, a_{n-1}\}$ and $\{b_0, \dots, b_{n-1}\}$ are both $\{n, n-1, \dots, 1\}$ and thus are permutations of each other.","S is the set of all $(h,k)$ with $h,k$ non-negative integers such that $h + k < n$. Each element of $S$ is colored red or blue, so that if $(h,k)$ is red and $h' \le h,k' \le k$, then $(h',k')$ is also red. A type $1$ subset of $S$ has $n$ blue elements with different first member and a type $2$ subset of $S$ has $n$ blue elements with different second member. Show that there are the same number of type $1$ and type $2$ subsets.","We prove by induction on the coloring sequence $c_i$. Assume for a coloring defined by $(c_0, \ldots, c_i, -1, \ldots, -1)$ that the multisets of counts $\{a_j'\}$ and $\{b_j'\}$ are permutations. Consider changing $c_{i+1}$ from $-1$ to its final value $c$. The multiset of $a_j$ values changes by replacing $a'_{i+1}=n-i-1$ with $a''_{i+1}=n-i-c-2$. The multiset of $b_j$ values changes because for each $k \in \{0, \ldots, c\}$, $b_k$ is reduced by 1. For the coloring with $c_{i+1}=-1$, the values of $\{b'_0, \ldots, b'_c\}$ were $\{n-i-1, n-i-2, \ldots, n-i-c-1\}$. After changing $c_{i+1}$ to $c$, these become $\{n-i-2, \ldots, n-i-c-2\}$. This corresponds to removing $n-i-1$ and adding $n-i-c-2$ to the multiset. The change is identical for both multisets. Since they were permutations before the change, they remain so after. The base case was established in the previous step. By induction, the property holds for any valid coloring.",,
2002p2,$BC$ is a diameter of a circle center $O$. $A$ is any point on the circle with $\angle AOC \not\le 60^\circ$. $EF$ is the chord which is the perpendicular bisector of $AO$. $D$ is the midpoint of the minor arc $AB$. The line through $O$ parallel to $AD$ meets $AC$ at $J$. Show that $J$ is the incenter of triangle $CEF$.,"F is equidistant from \( A \) and \( O \). But \( OF = OA \), so \( \triangle OFA \) is equilateral and hence \( \angle AOF = 60^\circ \). Since \( \angle AOC > 60^\circ \), \( F \) lies between \( A \) and \( C \). Hence the ray \( CJ \) lies between \( CE \) and \( CF \).

\( D \) is the midpoint of the arc \( AB \), so \( \angle DOB = \frac{1}{2} \angle AOB = \angle ACB \). Hence \( DO \) is parallel to \( AC \). But \( OJ \) is parallel to \( AD \), so \( AJOD \) is a parallelogram. Hence \( AJ = OD \). So \( AJ = AE = AF \), so \( J \) lies on the opposite side of \( EF \) to \( A \) and hence on the same side as \( C \). So \( J \) must lie inside the triangle \( \triangle CEF \).

Also, since \( EF \) is the perpendicular bisector of \( AO \), we have \( AE = AF = OE \), so \( A \) is the center of the circle through \( E, F \) and \( J \). Hence \( \angle EFJ = \frac{1}{2} \angle EAJ \). But \( \angle EAJ = \angle EAC \) (same angle) \( = \angle EFC \). Hence \( J \) lies on the bisector of angle \( \angle EFC \).

Since \( EF \) is perpendicular to \( AO \), \( A \) is the midpoint of the arc \( EF \). Hence \( \angle ACE = \angle ACF \), so \( J \) lies on the bisector of angle \( \angle ECF \). Hence \( J \) is the incenter.",3,Show that the line AC bisects the angle ∠ECF.,"Since EF is the perpendicular bisector of radius AO, and F is on the circle, triangle AOF has AF=OF. As OF=OA (both radii), ΔAOF is equilateral, so the central angle ∠AOF = 60°. Similarly, ΔAOE is equilateral, and ∠AOE = 60°. This means arc AE is equal to arc AF. In a circle, angles subtended by equal arcs from a point on the circumference are equal. Therefore, ∠ACE = ∠ACF, which proves that AC bisects ∠ECF.","Show that A is the center of a circle passing through E, F, and J.","As D is the midpoint of arc AB, the central angle ∠DOB = 1/2 * ∠AOB. By the inscribed angle theorem, ∠ACB = 1/2 * ∠AOB. Thus, ∠DOB = ∠ACB. These are corresponding angles with respect to transversal BC, so OD || AC. We are given OJ || AD. Since both pairs of opposite sides are parallel, AJOD is a parallelogram, which implies AJ = OD. As OD is a radius, AJ=OA. From the proof that ΔAOE and ΔAOF are equilateral, we have AE = AF = OA. Therefore, AE = AF = AJ, which means E, F, and J are equidistant from A and lie on a circle centered at A.",Show that J is the incenter of triangle CEF.,"The incenter is the intersection of the angle bisectors. Since J lies on AC, and AC has been shown to bisect ∠ECF, the line CJ is an angle bisector of ΔCEF. It has also been shown that E, F, J lie on a circle centered at A. By the inscribed angle theorem for this circle, ∠EFJ = 1/2 * ∠EAJ. Since J is on AC, ∠EAJ is the same as ∠EAC. In the original circle, ∠EAC and ∠EFC both subtend arc EC, so ∠EAC = ∠EFC. Combining these facts gives ∠EFJ = 1/2 * ∠EFC, which means FJ bisects ∠EFC. Since J is the intersection of two angle bisectors, CJ and FJ, it is the incenter of ΔCEF.",,
2002p4,Let $n>1$ be an integer and let $1=d_{1}<d_{2}<d_{3} \cdots <d_{r}=n$ be all of its positive divisors in increasing order. Show that \[d=d_1d_2+d_2d_3+ \cdots +d_{r-1}d_r <n^2\],,1,Let $n>1$ be an integer and let $1=d_{1}<d_{2}<d_{3} \cdots <d_{r}=n$ be all of its positive divisors in increasing order. Show that \[d=d_1d_2+d_2d_3+ \cdots +d_{r-1}d_r <n^2\],,,,,,,
2002p6,"Let $n \ge 3$ be a positive integer. Let $C_1,C_2,...,C_n$ be unit circles in the plane, with centers $O_1,O_2,...,O_n$ respectively. If no line meets more than two of the circles, prove that

\[\sum_{1\le i< j \le n}^{}\frac{1}{O_iO_j}\le\frac{(n-1)\pi}{4}\]","For brevity, let \( d_{ij} \) be the length of \( O_iO_j \) and let \( \angle(ijk) \) be shorthand for \( \angle O_iO_jO_k \) (or its measure in radians).

First, we eliminate the circles completely and reduce the problem to angles using the following fact (which is in part motivated by the mysterious presence of \( \pi \) on the right-hand side, and also brings \( d_{ij}^{-1} \) into the picture).

\begin{lemma}
For any indices \( i, j, m \) we have the inequalities
\[
\angle(imj) \ge \max\left( \frac{2}{d_{mi}}, \frac{2}{d_{mj}} \right) \quad \text{and} \quad \pi - \angle(imj) \ge \max\left( \frac{2}{d_{mi}}, \frac{2}{d_{mj}} \right).
\]
\end{lemma}

\begin{proof}
We first prove the former line. Consider the altitude from \( O_i \) to \( O_mO_j \). The altitude must have length at least 2, otherwise its perpendicular bisector passes/intersects all of \( C_i, C_m, C_j \). Thus
\[
2 \le d_{mi} \sin \angle(imj) \le \angle(imj)
\]
proving the first line. The second line follows by considering the external angle formed by lines \( O_mO_i \) and \( O_mO_j \) instead of the internal one.
\end{proof}

Our idea now is for any index \( m \) we will make an estimate on \( \sum_{1 \le i \le n, i \ne b} \frac{1}{d_{bi}} \) for each index \( b \). If the centers formed a convex polygon, this would be much simpler, but because we do not have this assumption some more care is needed.

\begin{claim}
Suppose \( O_a, O_b, O_c \) are consecutive vertices of the convex hull. Then
\[
\frac{n-1}{n-2} \angle(abc) \ge \frac{2}{d_{1b}} + \frac{2}{d_{2b}} + \cdots + \frac{2}{d_{nb}}
\]
where the term \( \frac{2}{d_{bb}} \) does not appear (obviously).
\end{claim}

\begin{proof}
WLOG let锟斤拷锟絪 suppose \( (a,b,c) = (2,1,n) \) and that rotating ray \( O_2O_1 \) hits \( O_3, O_4, \dots, O_n \) in that order. We have
\[
\frac{2}{d_{12}} \le \angle(213), \quad
\frac{2}{d_{13}} \le \min \{ \angle(213), \angle(314) \}, \quad \dots, \quad
\frac{2}{d_{1n}} \le \angle((n-1)1n).
\]
Of the \( n-1 \) distinct angles appearing on the right-hand side, we let \( \kappa \) denote the smallest of them. We have \( \kappa \le \frac{1}{n-2} \angle(21n) \) by pigeonhole principle. Then we pick the minimums on the right-hand side in the unique way such that summing gives
\[
\sum_{i=2}^{n} \frac{2}{d_{1i}} \le \angle(213) + \angle(314) + \cdots + \angle((n-1)1n) + \kappa \le \angle(21n) + \frac{1}{n-2} \angle(21n) = \frac{n-1}{n-2} \angle(21n)
\]
as desired.
\end{proof}

Next we show a bound that works for any center, even if it does not lie on the convex hull \( \mathcal{H} \).

\begin{claim}
For any index \( b \) we have
\[
\frac{n-1}{n-2} \pi \ge \frac{2}{d_{1b}} + \frac{2}{d_{2b}} + \cdots + \frac{2}{d_{nb}}
\]
where the term \( \frac{2}{d_{bb}} \) does not appear (obviously).
\end{claim}

\begin{proof}
This is the same argument as in the previous proof, with the modification that because \( O_b \) could lie inside the convex hull now, our rotation argument should use lines instead of rays (in order for the angle to be \( \pi \) rather than \( 2\pi \)). This is why the first lemma is stated with two cases; we need it now.

Again WLOG \( b = 1 \). Consider line \( O_1O_2 \) (rather than just the ray) and imagine rotating it counterclockwise through \( O_2 \); suppose that this line passes through \( O_3, O_4, \dots, O_n \) in that order before returning to \( O_2 \) again. We let \( \angle(i1j) \in \{ \angle(i1j), \pi - \angle(i1j) \} \in [0, \pi) \) be the counterclockwise rotations obtained in this way, so that
\[
\angle(21n) = \angle(213) + \angle(314) + \cdots + \angle((n-1)1n).
\]
Then we get bounds
\[
\frac{2}{d_{1i}} \le \angle(i-1,1,i), \quad \text{for } i = 2, \dots, n.
\]
so as before we get
\[
\sum_{i=1}^n \frac{2}{d_{1i}} \le \frac{n-1}{n-2} \angle(21n)
\]
which is certainly less than \( \frac{n-1}{n-2} \pi \).
\end{proof}

Now suppose there were \( r \) vertices in the convex hull. If we sum the first claim across all \( b \) on the hull, and the second across all \( b \) not on the hull (inside it), we get
\[
\sum_{1 \le i < j \le n} \frac{2}{d_{ij}} = \frac{1}{2} \sum_{b} \sum_{i \ne b} \frac{2}{d_{bi}} \le \frac{1}{2} \cdot \frac{n-1}{n-2} \left( (r-2)\pi + (n-r)\pi \right) = \frac{(n-1)\pi}{4}
\]
as needed (with \( (r-2)\pi \) being the sum of angles in the hull).",4,"For any distinct indices $i, j, m$, prove that the angle $\angle O_i O_m O_j$ satisfies $\angle O_i O_m O_j \ge 2/O_mO_i$. This also holds for the external angle at $O_m$ between lines $O_mO_i$ and $O_mO_j$.","The condition that no line intersects more than two circles implies that the distance from any center $O_i$ to the line connecting two other centers $O_m$ and $O_j$ must be at least 2. This distance is $O_mO_i \sin(\angle O_iO_mO_j)$. Thus, $O_mO_i \sin(\angle O_iO_mO_j) \ge 2$. Since $\theta \ge \sin\theta$ for any angle $\theta \in [0, \pi]$, we conclude that $\angle O_iO_mO_j \ge \sin(\angle O_iO_mO_j) \ge 2/O_mO_i$. This argument applies to any angle formed by the lines, so it holds for the external angle as well.","Let $O_b$ be a center on the convex hull of \{$O_1, \dots, O_n\}$. Let $\angle_b$ be the interior angle of the convex hull at vertex $O_b$. Show that $\sum_{i \ne b} \frac{2}{O_bO_i} \le \frac{n-1}{n-2} \angle_b$.","Order the other centers angularly around $O_b$. Let the angles between consecutive rays $O_bO_i$ be $\theta_1, \dots, \theta_{n-2}$, which sum to $\angle_b$. From Sub-problem 1, for each $i \ne b$, $2/O_bO_i$ is bounded by the one or two adjacent angles $\theta_k$. Summing these inequalities carefully yields $\sum_{i\ne b} \frac{2}{O_bO_i} \le \sum_{k=1}^{n-2} \theta_k + \kappa$, where $\kappa$ is the smallest of these angles. Since $\kappa \le \frac{1}{n-2} \sum \theta_k = \frac{\angle_b}{n-2}$, the sum is bounded by $\angle_b + \frac{\angle_b}{n-2} = \frac{n-1}{n-2} \angle_b$.","For any center $O_b$, whether or not it is on the convex hull, show that $\sum_{i \ne b} \frac{2}{O_bO_i} \le \frac{n-1}{n-2} \pi$.","The argument is analogous to that of Sub-problem 2. We order the other centers $O_i$ ($i \ne b$) by the angle of the line $O_b O_i$. As we rotate a line through $O_b$, it sweeps through all other points in a rotation of $\pi$ radians. The sum of the angles between consecutive lines is $\pi$. Using the inequalities from Sub-problem 1, which apply to any angle between the lines, the same summation technique yields the bound $\sum_{i \ne b} \frac{2}{O_bO_i} \le \frac{n-1}{n-2} \pi$.",Prove that $\sum_{1\le i< j \le n}^{}\frac{1}{O_iO_j}\le\frac{(n-1)\pi}{4}$.,"Let $S = \sum_{1\le i< j \le n} \frac{1}{O_iO_j}$. Summing the results from Sub-problems 2 and 3 over all centers $b=1, \dots, n$, we get $4S = \sum_{b=1}^n \sum_{i \ne b} \frac{2}{O_bO_i}$. Let $r$ be the number of centers on the convex hull $\mathcal{H}$. The sum is bounded by $\sum_{b \in \mathcal{H}} \frac{n-1}{n-2}\angle_b + \sum_{b \notin \mathcal{H}} \frac{n-1}{n-2}\pi$. The sum of interior angles of the convex hull is $(r-2)\pi$, and there are $n-r$ points inside. Thus, $4S \le \frac{n-1}{n-2}((r-2)\pi + (n-r)\pi) = \frac{n-1}{n-2}(n-2)\pi = (n-1)\pi$. Therefore, $S \le \frac{(n-1)\pi}{4}$."
2001p1,"Consider an acute triangle $\triangle ABC$. Let $P$ be the foot of the altitude of triangle $\triangle ABC$ issuing from the vertex $A$, and let $O$ be the circumcenter of triangle $\triangle ABC$. Assume that $\angle C \geq \angle B+30^{\circ}$. Prove that $\angle A+\angle COP < 90^{\circ}$.","The conclusion rewrites as
\[
\angle COP < 90^\circ - \angle A = \angle OCP
\iff PC < PO
\iff PC^2 < PO^2
\iff PC^2 < R^2 - PB \cdot PC
\iff PC \cdot BC < R^2
\iff ab \cos C < R^2
\iff \sin A \sin B \cos C < \frac{1}{4}.
\]

Now
\[
\cos C \sin B = \frac{1}{2} (\sin(C + B) - \sin(C - B)) \le \frac{1}{2} \left(1 - \frac{1}{2} \right) = \frac{1}{4}
\]
which finishes when combined with \( \sin A < 1 \).",1,"Consider an acute triangle $\triangle ABC$. Let $P$ be the foot of the altitude of triangle $\triangle ABC$ issuing from the vertex $A$, and let $O$ be the circumcenter of triangle $\triangle ABC$. Assume that $\angle C \geq \angle B+30^{\circ}$. Prove that $\angle A+\angle COP < 90^{\circ}$.","The conclusion rewrites as
\[
\angle COP < 90^\circ - \angle A = \angle OCP
\iff PC < PO
\iff PC^2 < PO^2
\iff PC^2 < R^2 - PB \cdot PC
\iff PC \cdot BC < R^2
\iff ab \cos C < R^2
\iff \sin A \sin B \cos C < \frac{1}{4}.
\]

Now
\[
\cos C \sin B = \frac{1}{2} (\sin(C + B) - \sin(C - B)) \le \frac{1}{2} \left(1 - \frac{1}{2} \right) = \frac{1}{4}
\]
which finishes when combined with \( \sin A < 1 \).",,,,,,
2001p2,"Let $a,b,c$ be positive real numbers. Prove that $\frac{a}{\sqrt{a^{2}+8bc}}+\frac{b}{\sqrt{b^{2}+8ca}}+\frac{c}{\sqrt{c^{2}+8ab}}\ge 1$.","Firstly, $a^{2}+8bc=(a^{2}+2bc)+6bc \leq^{AG} (a^{2}+b^{2}+c^{2})+6bc=S+6bc$ (where $S=a^{2}+b^{2}+c^{2}$) and its cyclic variations. Next note that $(a,b,c)$ and $\left( \frac{1}{\sqrt{S+6bc}}, \frac{1}{\sqrt{S+6ca}}, \frac{1}{\sqrt{S+6ab}} \right)$ are similarly oriented sequences. Thus \[\sum_{cyc} \frac{a}{\sqrt{a^{2}+8bc}} \ge \sum_{cyc} \frac{a}{\sqrt{S+6bc}}\]\[\geq ^{Cheff} \frac{1}{3}(a+b+c)\left( \frac{1}{\sqrt{S+6bc}}+\frac{1}{\sqrt{S+6ca}}+\frac{1}{\sqrt{S+6ab}} \right)\]\[\geq^{AH}\frac{1}{3}(a+b+c) \left( \frac{9}{\sqrt{S+6bc}+\sqrt{S+6ca}+\sqrt{S+6ab}} \right)\]\[\geq^{QA} (a+b+c) \sqrt{\frac{3}{(S+6bc)+(S+6ca)+(S+6ab)}}\]\[=(a+b+c)\sqrt{\frac{3}{3(a+b+c)^{2}}}=1\] Hence the inequality has been established. Equality holds if $a=b=c$.",1,"Let $a,b,c$ be positive real numbers. Prove that $\frac{a}{\sqrt{a^{2}+8bc}}+\frac{b}{\sqrt{b^{2}+8ca}}+\frac{c}{\sqrt{c^{2}+8ab}}\ge 1$.","Firstly, $a^{2}+8bc=(a^{2}+2bc)+6bc \leq^{AG} (a^{2}+b^{2}+c^{2})+6bc=S+6bc$ (where $S=a^{2}+b^{2}+c^{2}$) and its cyclic variations. Next note that $(a,b,c)$ and $\left( \frac{1}{\sqrt{S+6bc}}, \frac{1}{\sqrt{S+6ca}}, \frac{1}{\sqrt{S+6ab}} \right)$ are similarly oriented sequences. Thus \[\sum_{cyc} \frac{a}{\sqrt{a^{2}+8bc}} \ge \sum_{cyc} \frac{a}{\sqrt{S+6bc}}\]\[\geq ^{Cheff} \frac{1}{3}(a+b+c)\left( \frac{1}{\sqrt{S+6bc}}+\frac{1}{\sqrt{S+6ca}}+\frac{1}{\sqrt{S+6ab}} \right)\]\[\geq^{AH}\frac{1}{3}(a+b+c) \left( \frac{9}{\sqrt{S+6bc}+\sqrt{S+6ca}+\sqrt{S+6ab}} \right)\]\[\geq^{QA} (a+b+c) \sqrt{\frac{3}{(S+6bc)+(S+6ca)+(S+6ab)}}\]\[=(a+b+c)\sqrt{\frac{3}{3(a+b+c)^{2}}}=1\] Hence the inequality has been established. Equality holds if $a=b=c$.",,,,,,
2001p3,"Twenty-one girls and twenty-one boys took part in a mathematical competition. It turned out that each contestant solved at most six problems, and for each pair of a girl and a boy, there was at least one problem that was solved by both the girl and the boy. Show that there is a problem that was solved by at least three girls and at least three boys.","For each girl, we know that there is a boy who solved a problem in common with her. Since a girl solves at most six problems, for a girl and her set of six problems there are at least 11 boys who solved a problem in common with the girl such that at least three boys solved that common problem. (This is a simple application of the pigeon hole principle where the problems solved by the girl are the holes and the boys are the pigeons, and the guy/pigeon enters a hole/problem which he solved in common with the girl).

The boys have solved a total of at most $21\times 6$ problems.We view this as a set with repeated elements i.e. if a problem is solved by more than one boy it appears as many times as the number of boys who have solved it. Let this set of problems be A. Clearly, A has size $21\times 6$.

We mark each problem in A which has been solved by at least three boys and a girl. And we mark it the number of times that is the same as the number of girls that has solved it. Since there are a total of $21\times 11$ marks (since there are at least 11 marks for each girl, by the discussion above), either a problem is marked at least thrice, in which case we're done since then it has been solved by at least three boys and three girls. Or each problem has been marked at most twice. In this case it is clear that more than $21\times 5$ problems in A have been marked since $21\times 5 \times 2<21\times 11$ (there are a total of $21\times 11$ marks. This means that there is a boy such that all six of his problems have been marked. But then by our discussion in the first paragraph we know there must a problem that this boy has solved which has been solved by at least three girls. Therefore it must be true that there is a problem such that it has been solved by at least three people of each gender.",3,"For any given girl, show that she shares a problem with at least 11 boys, where each such shared problem was solved by at least three boys.","Let g be a girl. Partition the (at most 6) problems she solved, P_g, into P_h (solved by ≥3 boys) and P_l (solved by <3 boys). Let B_h be the set of boys who share a problem from P_h with g. Every boy must share a problem with g from either P_h or P_l. The set of boys who share *only* problems from P_l is a subset of the union of boys who solved problems in P_l, which has a maximum size of 2 * |P_l| ≤ 12. If we assume |B_h| < 11 (i.e., |B_h| ≤ 10), then at least 21 - 10 = 11 boys must share problems *only* from P_l. This requires 11 ≤ 2 * |P_l|, so |P_l| must be 6. If |P_l|=6, then P_h is empty and B_h is empty. Then all 21 boys must share problems only from P_l, requiring 21 ≤ 2 * |P_l| = 12, a contradiction. Thus, for each girl, |B_h| ≥ 11.",Assume that no problem was solved by at least three girls and at least three boys. Show that there must be a boy who solved at least 6 problems that were each solved by at least three boys.,"Let P_sp be the set of problems solved by at least 3 boys. The assumption means that for any p in P_sp, it is solved by fewer than 3 girls (g(p) ≤ 2). Let's count the number of pairs (g, b) where girl g and boy b share a problem in P_sp. From sub-problem 1, each of the 21 girls contributes at least 11 such pairs, for a total of at least 21 * 11 = 231. This count is also less than or equal to the sum over all problems p in P_sp of g(p)b(p). Using our assumption, this sum is at most Σ 2*b(p) = 2 * N, where N is the total number of times a boy solved a problem from P_sp. Thus, 231 ≤ 2N, so N ≥ 116. If every boy solved at most 5 problems from P_sp, the total N would be at most 21 * 5 = 105. This is a contradiction. Therefore, at least one boy must have solved at least 6 problems from P_sp.","Twenty-one girls and twenty-one boys took part in a mathematical competition. It turned out that each contestant solved at most six problems, and for each pair of a girl and a boy, there was at least one problem that was solved by both the girl and the boy. Show that there is a problem that was solved by at least three girls and at least three boys.","Assume for contradiction that no such problem exists. From sub-problem 2, this assumption implies there is a boy, b_0, who solved a set of k ≤ 6 problems, P_b0, all of which were solved by at least 3 boys. For each of the 21 girls, she must share at least one problem with b_0 from his set P_b0. By the Pigeonhole Principle, with 21 girls (pigeons) and k ≤ 6 problems (holes), at least one problem in P_b0 must have been solved by at least ⌈21/k⌉ ≥ ⌈21/6⌉ = 4 girls. Let this problem be p. We have found a problem p that was solved by at least 4 girls (and thus at least 3 girls) and is in P_b0, meaning it was also solved by at least 3 boys. This contradicts our initial assumption. Therefore, such a problem must exist.",,
2001p4,"\textbf{Let } n > 1 \text{ be an odd integer and let } c_1, c_2, \ldots, c_n \text{ be integers. For each permutation } a = (a_1, a_2, \ldots, a_n) \text{ of } \{1,2,\ldots,n\}, \text{ define } S(a) = \sum_{i=1}^{n} c_i a_i. \text{ Prove that there exist two permutations } a \ne b \text{ of } \{1,2,\ldots,n\} \text{ such that } n! \text{ is a divisor of } S(a) - S(b).","Assume for contradiction that all the \( S(a) \) are distinct modulo \( n! \). Then summing across all permutations gives
\[
1 + 2 + \cdots + n! = \sum_a S(a)
= \sum_a \sum_{i=1}^n c_i a_i
= \sum_{i=1}^n c_i \sum_a a_i
= \sum_{i=1}^n c_i \cdot ((n-1)! \cdot (1 + \cdots + n))
= (n-1)! \cdot \frac{n(n+1)}{2} \sum_{i=1}^n c_i
= n! \cdot \frac{n+1}{2} \sum_{i=1}^n c_i
\equiv 0 \pmod{n!}
\]
since \( \frac{1}{2}(n+1) \) is an integer. But on the other hand 
\[
1 + 2 + \cdots + n! = \frac{n!(n!+1)}{2}
\]
which is not divisible by \( n! \) if \( n > 1 \), as the quotient is the non-integer \( \frac{n!+1}{2} \). This is a contradiction.",2,"Let n > 1 be an integer, c_1, \ldots, c_n be integers, and for each permutation a = (a_1, \ldots, a_n) of \{1, \ldots, n\}, let S(a) = \sum_{i=1}^{n} c_i a_i. Calculate the sum of S(a) over all n! permutations, \sum_a S(a).","We can swap the order of summation: \sum_a S(a) = \sum_a \sum_{i=1}^{n} c_i a_i = \sum_{i=1}^{n} c_i \left(\sum_a a_i\right). For any fixed position i, each number k \in \{1, \ldots, n\} appears as a_i in exactly (n-1)! permutations. Thus, the inner sum is \sum_a a_i = (n-1)! \sum_{k=1}^{n} k = (n-1)! \frac{n(n+1)}{2} = n! \frac{n+1}{2}. Substituting this back, we get \sum_a S(a) = \sum_{i=1}^{n} c_i \left(n! \frac{n+1}{2}\right) = n! \frac{n+1}{2} \sum_{i=1}^{n} c_i.","Let n > 1 be an odd integer and let c_1, c_2, \ldots, c_n be integers. For each permutation a = (a_1, a_2, \ldots, a_n) of \{1,2,\ldots,n\}, define S(a) = \sum_{i=1}^{n} c_i a_i. Prove that there exist two permutations a \ne b of \{1,2,\ldots,n\} such that n! is a divisor of S(a) - S(b).","Assume for contradiction that all S(a) are distinct modulo n!. Then the set of S(a) values over all n! permutations forms a complete residue system modulo n!. The sum of these values is congruent to the sum of \{1, 2, \ldots, n!\} modulo n!, which is \frac{n!(n!+1)}{2}. From the previous sub-problem, \sum_a S(a) = n! \frac{n+1}{2} \sum_{i=1}^{n} c_i. Since n is odd, n+1 is even, so \frac{n+1}{2} is an integer. This implies \sum_a S(a) is a multiple of n!, so \sum_a S(a) \equiv 0 \pmod{n!}. This leads to the congruence \frac{n!(n!+1)}{2} \equiv 0 \pmod{n!}, which implies n! divides \frac{n!(n!+1)}{2}. This is only possible if \frac{n!+1}{2} is an integer. But for n > 1, n! is even, so n!+1 is odd, and \frac{n!+1}{2} is not an integer. This is a contradiction. Therefore, there must exist two distinct permutations a and b such that S(a) \equiv S(b) \pmod{n!}.",,,,
2001p6,$K > L > M > N$ are positive integers such that $KM + LN = (K + L - M + N)(-K + L + M + N)$. Prove that $KL + MN$ is not prime.,"First, $(KL+MN)-(KM+LN)=(K-N)(L-M)>0$ as $K>N$ and $L>M$. Thus, $KL+MN>KM+LN$.

Similarly, $(KM+LN)-(KN+LM)=(K-L)(M-N)>0$ since $K>L$ and $M>N$. Thus, $KM+LN>KN+LM$.

Putting the two together, we have \[KL+MN>KM+LN>KN+LM\]

Now, we have: \[(K+L-M+N)(-K+L+M+N)=KM+LN\]\[-K^2+KM+L^2+LN+KM-M^2+LN+N^2=KM+LN\]\[L^2+LN+N^2=K^2-KM+M^2\] So, we have: \[(KM+LN)(L^2+LN+N^2)=KM(L^2+LN+N^2)+LN(L^2+LN+N^2)\]\[=KM(L^2+LN+N^2)+LN(K^2-KM+M^2)\]\[=KML^2+KMN^2+K^2LN+LM^2N\]\[=(KL+MN)(KN+LM)\] Thus, it follows that \[(KM+LN) \mid (KL+MN)(KN+LM).\] Now, since $KL+MN>KM+LN$ if $KL+MN$ is prime, then there are no common factors between the two. So, in order to have \[(KM+LN)\mid (KL+MN)(KN+LM),\] we would have to have \[(KM+LN) \mid (KN+LM).\] This is impossible as $KM+LN>KN+LM$. Thus, $KL+MN$ must be composite.",1,$K > L > M > N$ are positive integers such that $KM + LN = (K + L - M + N)(-K + L + M + N)$. Prove that $KL + MN$ is not prime.,"First, $(KL+MN)-(KM+LN)=(K-N)(L-M)>0$ as $K>N$ and $L>M$. Thus, $KL+MN>KM+LN$.

Similarly, $(KM+LN)-(KN+LM)=(K-L)(M-N)>0$ since $K>L$ and $M>N$. Thus, $KM+LN>KN+LM$.

Putting the two together, we have \[KL+MN>KM+LN>KN+LM\]

Now, we have: \[(K+L-M+N)(-K+L+M+N)=KM+LN\]\[-K^2+KM+L^2+LN+KM-M^2+LN+N^2=KM+LN\]\[L^2+LN+N^2=K^2-KM+M^2\] So, we have: \[(KM+LN)(L^2+LN+N^2)=KM(L^2+LN+N^2)+LN(L^2+LN+N^2)\]\[=KM(L^2+LN+N^2)+LN(K^2-KM+M^2)\]\[=KML^2+KMN^2+K^2LN+LM^2N\]\[=(KL+MN)(KN+LM)\] Thus, it follows that \[(KM+LN) \mid (KL+MN)(KN+LM).\] Now, since $KL+MN>KM+LN$ if $KL+MN$ is prime, then there are no common factors between the two. So, in order to have \[(KM+LN)\mid (KL+MN)(KN+LM),\] we would have to have \[(KM+LN) \mid (KN+LM).\] This is impossible as $KM+LN>KN+LM$. Thus, $KL+MN$ must be composite.",,,,,,
2000p1,"Two circles $G_1$ and $G_2$ intersect at two points $M$ and $N$. Let $AB$ be the line tangent to these circles at $A$ and $B$, respectively, so that $M$ lies closer to $AB$ than $N$. Let $CD$ be the line parallel to $AB$ and passing through the point $M$, with $C$ on $G_1$ and $D$ on $G_2$. Lines $AC$ and $BD$ meet at $E$; lines $AN$ and $CD$ meet at $P$; lines $BN$ and $CD$ meet at $Q$. Show that $EP=EQ$.","$\textbf{Lemma:}$ Given a triangle, $ABC$ and a point $P$ in its interior, assume that the circumcircles of $\triangle{ACP}$ and    $\triangle{ABP}$ are tangent to $BC$. Prove that ray $AP$ bisects $BC$.
$\textbf{Proof:}$ Let the intersection of $AP$ and $BC$ be $D$. By power of a point, $BD^2=AD(PD)$ and $CD^2=AD(PD)$, so $BD=CD$.
$\textbf{Proof of problem:}$ Let ray $NM$ intersect $AB$ at $X$. By our lemma, $\textit{(the two circles are tangent to AB)}$, $X$ bisects $AB$. Since $\triangle{NAX}$ and $\triangle{NPM}$ are similar, and $\triangle{NBX}$ and $\triangle{NQM}$ are similar implies $M$ bisects $PQ$.

Now, $\angle{ABM} = \angle{BMD}$ since $CD$ is parallel to $AB$. But $AB$ is tangent to the circumcircle of $\triangle{BMD}$ hence $\angle{ABM} = \angle{BDM}$ and that implies $\angle{BMD} = \angle{BDM} .$So$\triangle{BMD}$ is isosceles and $BM=BD$.

By simple parallel line rules, $\angle{EBA}=\angle{BDM}=\angle{ABM}$. Similarly, $\angle{BAM}=\angle{EAB}$, so by $\textit{ASA}$ criterion, $\triangle{ABM}$ and $\triangle{ABE}$ are congruent.

We know that $BE=BM=BD$ so a circle with diameter $ED$ can be circumscribed around $\triangle{EMD}$. Join points $E$ and $M$, $EM$ is perpendicular on $PQ$, previously we proved $MP = MQ$, hence $\triangle{EPQ}$ is isoscles and $EP = EQ$ .",2,Let the line $CD$ intersect lines $AN$ and $BN$ at $P$ and $Q$ respectively. Prove that $M$ is the midpoint of the segment $PQ$.,"Let the line containing the common chord $MN$ intersect the tangent line $AB$ at $X$. By the power of a point theorem with respect to circle $G_1$, we have $XA^2 = XM \cdot XN$. Similarly, for circle $G_2$, $XB^2 = XM \cdot XN$. This implies $XA^2 = XB^2$, so $XA=XB$, meaning $X$ is the midpoint of $AB$. Since $CD$ is parallel to $AB$, triangles $\triangle NMP$ and $\triangle NXA$ are similar, as are triangles $\triangle NMQ$ and $\triangle NXB$. From these similarities, we get the proportions $\frac{MP}{XA} = \frac{NM}{NX}$ and $\frac{MQ}{XB} = \frac{NM}{NX}$. As $XA=XB$, it follows that $MP=MQ$. Thus, $M$ is the midpoint of $PQ$.",Show that $EP=EQ$.,"We first prove that the point $E$ coincides with the point $M$. Since $AB \parallel CD$, triangles $\triangle EAB$ and $\triangle ECD$ are similar. This implies $\angle EAB = \angle ECD$ and $\angle EBA = \angle EDC$. By the alternate segment theorem on $G_1$, $\angle BAM = \angle ANM$. As $A,C,M,N$ are concyclic, $\angle ANM = \angle ACM$. Thus, $\angle BAM = \angle ACM$, which is the same as $\angle ECD$. Combining this with the similarity result, we get $\angle EAB = \angle BAM$, which implies that $A, M, E$ are collinear. Similarly, for $G_2$, $\angle ABM = \angle BNM = \angle BDM$. $\angle BDM$ is the same as $\angle EDC$. As $\angle EBA = \angle EDC$, we have $\angle EBA = \angle ABM$, implying $B, M, E$ are collinear. Since $M$ lies on both line $AE$ and line $BE$, and $A, B, M$ are not collinear, it must be that $E=M$. The problem then becomes showing $MP=MQ$. This was proven in the first sub-problem. Thus, $EP=EQ$.",,,,
2000p2,"Let $a, b, c$ be positive real numbers with $abc=1$. Show that

\[\left( a-1+\frac{1}{b} \right)\left( b-1+\frac{1}{c} \right)\left( c-1+\frac{1}{a} \right) \le 1\]","Let \( a = x/y, \, b = y/z, \, c = z/x \) for \( x, y, z > 0 \). Then the inequality rewrites as
\[
(-x + y + z)(x - y + z)(x + y - z) \le xyz
\]
which when expanded is equivalent to Schur锟斤拷锟絪 inequality. Alternatively, if one wants to avoid appealing to Schur, then the following argument works:

\begin{itemize}
  \item At most one term on the left-hand side is negative; if that occurs we are done from \( xyz > 0 > (-x + y + z)(x - y + z)(x + y - z) \).
  
  \item If all terms in the left-hand side are nonnegative, let us denote \( m = -x + y + z \ge 0 \), \( n = x - y + z \ge 0 \), \( p = x + y - z \ge 0 \). Then it becomes
  \[
  mnp \le \frac{(m+n)(n+p)(p+m)}{8}
  \]
  which follows by AM-GM.
\end{itemize}",2,"Let $a, b, c$ be positive real numbers with $abc=1$. Show that the inequality $\left( a-1+\frac{1}{b} \right)\left( b-1+\frac{1}{c} \right)\left( c-1+\frac{1}{a} \right) \le 1$ can be rewritten as $(y+z-x)(z+x-y)(x+y-z) \le xyz$ by using the substitution $a = x/y, b = y/z, c = z/x$ for some positive real numbers $x, y, z$.","The condition $abc=1$ is automatically satisfied by the substitution $a = x/y, b = y/z, c = z/x$. Substituting these into the left-hand side of the inequality gives:
\[\left( \frac{x}{y}-1+\frac{z}{y} \right)\left( \frac{y}{z}-1+\frac{x}{z} \right)\left( \frac{z}{x}-1+\frac{y}{x} \right)\]
\[= \left( \frac{x-y+z}{y} \right)\left( \frac{y-z+x}{z} \right)\left( \frac{z-x+y}{x} \right) = \frac{(x-y+z)(y-z+x)(z-x+y)}{xyz}\]
So the original inequality is equivalent to $\frac{(x-y+z)(y-z+x)(z-x+y)}{xyz} \le 1$. Since $x,y,z>0$, this is equivalent to $(y+z-x)(z+x-y)(x+y-z) \le xyz$.","Let $a, b, c$ be positive real numbers with $abc=1$. Show that
\[\left( a-1+\frac{1}{b} \right)\left( b-1+\frac{1}{c} \right)\left( c-1+\frac{1}{a} \right) \le 1\]","From the first sub-problem, we need to prove $(y+z-x)(z+x-y)(x+y-z) \le xyz$ for some positive $x,y,z$. Let $u = y+z-x$, $v = z+x-y$, $w = x+y-z$. If one of these quantities is negative, the left-hand side is negative (at most one can be negative) while the right-hand side $xyz$ is positive, so the inequality holds. If all quantities $u,v,w$ are non-negative, then we have $u+v=2z, v+w=2x, w+u=2y$. By AM-GM, we have $2x = v+w \ge 2\sqrt{vw}$, $2y = w+u \ge 2\sqrt{wu}$, and $2z = u+v \ge 2\sqrt{uv}$. Multiplying these three inequalities yields $(2x)(2y)(2z) \ge (2\sqrt{vw})(2\sqrt{wu})(2\sqrt{uv})$, which simplifies to $8xyz \ge 8\sqrt{u^2v^2w^2} = 8uvw$. Therefore, $xyz \ge uvw$, proving the inequality.",,,,
2000p6,"Let $\overline{AH_1}$, $\overline{BH_2}$, and $\overline{CH_3}$ be the altitudes of an acute triangle $ABC$. The incircle $\omega$ of triangle $ABC$ touches the sides $BC$, $CA$, and $AB$ at $T_1$, $T_2$, and $T_3$, respectively. Consider the reflections of the lines $H_1H_2$, $H_2H_3$, and $H_3H_1$ with respect to the lines $T_1T_2$, $T_2T_3$, and $T_3T_1$. Prove that these images form a triangle whose vertices line on $\omega$.","We use complex numbers with \( \omega \) the unit circle. Let \( T_1 = a, T_2 = b, T_3 = c \). The main content of the problem is to show that the triangle in question has vertices \( ab/c, bc/a, ca/b \) (which is evident from a good diagram).

\[
\text{Since } A = \frac{2bc}{b+c}, \text{ we have}
\]

\[
H_1 = \frac{1}{2} \left( \frac{2bc}{b+c} + a + a - a^2 \cdot \frac{2}{b+c} \right) = \frac{ab + bc + ca - a^2}{b + c}.
\]

The reflection of \( H_1 \) over \( \overline{T_1T_2} \) is

\[
H_1^C = a + b - ab \overline{H_1} = a + b - b \cdot \frac{ac + ab + a^2 - bc}{a(b + c)}
\]

\[
= \frac{a(a + b)(b + c) - b(a^2 + ab + ac - bc)}{a(b + c)} = \frac{c(a^2 + b^2)}{a(b + c)}.
\]

Now, we claim that \( H_1^C \) lies on the chord joining \( \frac{ca}{b} \) and \( \frac{cb}{a} \); by symmetry so will \( H_2^C \) and this will imply the problem (it means that the desired triangle has vertices \( ab/c, bc/a, ca/b \)). A cartoon of this is shown below.

To see this, it suffices to compute

\[
H_1^C + \left( \frac{ca}{b} \right)\left( \frac{cb}{a} \right) \overline{H_1^C}
= \frac{c(a^2 + b^2)}{a(b + c)} + c^2 \cdot \frac{1}{c} \cdot \frac{a^2 + b^2}{a^2 b^2} \cdot \frac{1}{a} \cdot \left( \frac{b + c}{bc} \right)
\]

\[
= \frac{c(a^2 + b^2)}{a(b + c)} + \frac{c(a^2 + b^2)}{abc^{-1}(b + c)}
\]

\[
= \frac{c(a^2 + b^2)}{a(b + c)} \left( \frac{b + c}{b} \right)
= \frac{c(a^2 + b^2)}{ab} = \frac{ca}{b} + \frac{cb}{a}
\]

as desired.",3,"Let the incircle $\omega$ of $\triangle ABC$ be the unit circle in the complex plane, with tangency points $T_1, T_2, T_3$ at complex coordinates $a, b, c$ respectively. If $H_1$ is the foot of the altitude from vertex $A$ to side $BC$, find the coordinate of $H_1$ in terms of $a, b, c$.","The vertex $A$ is the intersection of tangents at $b$ and $c$, so its coordinate is $A = \frac{2bc}{b+c}$. The side $BC$ is the tangent to the unit circle at $a$. The foot of the altitude $H_1$ is the projection of $A$ onto this tangent line. Its coordinate is given by the formula $H_1 = \frac{1}{2}(A + a + a - a^2 \bar{A})$. Substituting the expressions for $A$ and $\bar{A}=\frac{2}{b+c}$, we calculate $H_1 = \frac{ab+bc+ca-a^2}{b+c}$.","Using the complex number setup and the coordinate for $H_1$ from the previous step, show that the reflection of the point $H_1$ with respect to the line $T_1T_2$ lies on the line passing through the points $ca/b$ and $cb/a$ on the incircle $\omega$.","The line $T_1T_2$ passes through $a$ and $b$ on the unit circle. The reflection of a point $z$ across this line is $z' = a+b-ab\bar{z}$. For $z=H_1$, the reflection is $H_1' = a+b-ab\overline{H_1} = \frac{c(a^2+b^2)}{a(b+c)}$. A point $p$ lies on the line through unit-modulus points $z_1, z_2$ if $p+z_1z_2\bar{p} = z_1+z_2$. For the line through $ca/b$ and $cb/a$, we must check if $H_1' + c^2\overline{H_1'} = ca/b+cb/a$. The calculation $H_1' + c^2\overline{H_1'} = \frac{c(a^2+b^2)}{a(b+c)} + c^2 \frac{a^2+b^2}{ab(b+c)} = \frac{c(a^2+b^2)}{ab} = \frac{ca}{b}+\frac{cb}{a}$ confirms this.","Let $\overline{AH_1}$, $\overline{BH_2}$, and $\overline{CH_3}$ be the altitudes of an acute triangle $ABC$. The incircle $\omega$ of triangle $ABC$ touches the sides $BC$, $CA$, and $AB$ at $T_1$, $T_2$, and $T_3$, respectively. Consider the reflections of the lines $H_1H_2$, $H_2H_3$, and $H_3H_1$ with respect to the lines $T_1T_2$, $T_2T_3$, and $T_3T_1$. Prove that these images form a triangle whose vertices line on $\omega$.","Let $\omega$ be the unit circle and $T_1,T_2,T_3$ be $a,b,c$. The reflection of $H_1$ across line $T_1T_2$ lies on the line $L_1$ through $ca/b$ and $cb/a$. A symmetric argument holds for $H_2$, so the reflection of line $H_1H_2$ is $L_1$. By cyclic permutation of $(a,b,c)$, the reflected line of $H_2H_3$ w.r.t. $T_2T_3$ is $L_2$ through $ab/c$ and $ac/b$, and the reflected line of $H_3H_1$ w.r.t. $T_3T_1$ is $L_3$ through $bc/a$ and $ba/c$. The vertices of the new triangle are the intersections of these lines. The equations for $L_1$ and $L_2$ are $z+c^2\bar{z} = c(a/b+b/a)$ and $z+a^2\bar{z} = a(b/c+c/b)$. Solving this system yields the intersection point $z=ac/b$. By symmetry, the other vertices are $ab/c$ and $bc/a$. These three vertices have modulus 1, and therefore lie on $\omega$.",,
1999p5,"Two circles $G_{1}$ and $G_{2}$ are contained inside the circle $G$, and are tangent to $G$ at the distinct points $M$ and $N$, respectively. $G_{1}$ passes through the center of $G_{2}$. The line passing through the two points of intersection of $G_{1}$ and $G_{2}$ meets $G$ at $A$ and $B$. The lines $MA$ and $MB$ meet $G_{1}$ at $C$ and $D$, respectively.

Prove that $CD$ is tangent to $G_{2}$.","Two circles \( G_1 \) and \( G_2 \) are contained inside the circle \( G \), and are tangent to \( G \) at the distinct points \( M \) and \( N \), respectively. \( G_1 \) passes through the center of \( G_2 \). The line passing through the two points of intersection of \( G_1 \) and \( G_2 \) meets \( G \) at \( A \) and \( B \). The lines \( MA \) and \( MB \) meet \( G_1 \) at \( C \) and \( D \), respectively.

Prove that \( CD \) is tangent to \( G_2 \).

Let \( P \) and \( Q \) be the centers of \( G_1 \) and \( G_2 \). Let line \( MQ \) meet \( G_1 \) again at \( W \), the homothetic image of \( Q \) under \( G_1 \to G \). Meanwhile, let \( T \) be the intersection of segment \( PQ \) with \( G_2 \), and let \( L \) be its homothetic image on \( G \). Since \( PTQ \perp AB \), it follows \( LW \) is a diameter of \( G \). Let \( O \) be its center.

\textbf{Claim 锟斤拷锟絵 \( MNTQ \) is cyclic.

\textit{Proof.} By Reim: 
\[
\angle TQM = \angle LWM = \angle LNM = \angle TNM.
\]
\hfill\qedsymbol

Let \( E \) be the midpoint of \( AB \).

\textbf{Claim 锟斤拷锟絵 \( OEMN \) is cyclic.

\textit{Proof.} By radical axis, the lines \( MM, NN, AEB \) meet at a point \( R \). Then \( OEMN \) lies on the circle with diameter \( OR \).
\hfill\qedsymbol

\textbf{Claim 锟斤拷锟絵 \( MTE \) are collinear.

\textit{Proof.} 
\[
\angle NMT = \angle TQN = \angle LON = \angle NOE = \angle NME.
\]
\hfill\qedsymbol

Now consider the homothety mapping \( \triangle WAB \) to \( \triangle QCD \). It should map \( E \) to a point on line \( ME \) which is also on the line through \( Q \) perpendicular to \( AB \); that is, to point \( T \). Hence \( TCD \) are collinear, and it锟斤拷锟絪 immediate that \( T \) is the desired tangency point.
",1,"Two circles $G_{1}$ and $G_{2}$ are contained inside the circle $G$, and are tangent to $G$ at the distinct points $M$ and $N$, respectively. $G_{1}$ passes through the center of $G_{2}$. The line passing through the two points of intersection of $G_{1}$ and $G_{2}$ meets $G$ at $A$ and $B$. The lines $MA$ and $MB$ meet $G_{1}$ at $C$ and $D$, respectively.

Prove that $CD$ is tangent to $G_{2}$.","Two circles \( G_1 \) and \( G_2 \) are contained inside the circle \( G \), and are tangent to \( G \) at the distinct points \( M \) and \( N \), respectively. \( G_1 \) passes through the center of \( G_2 \). The line passing through the two points of intersection of \( G_1 \) and \( G_2 \) meets \( G \) at \( A \) and \( B \). The lines \( MA \) and \( MB \) meet \( G_1 \) at \( C \) and \( D \), respectively.

Prove that \( CD \) is tangent to \( G_2 \).

Let \( P \) and \( Q \) be the centers of \( G_1 \) and \( G_2 \). Let line \( MQ \) meet \( G_1 \) again at \( W \), the homothetic image of \( Q \) under \( G_1 \to G \). Meanwhile, let \( T \) be the intersection of segment \( PQ \) with \( G_2 \), and let \( L \) be its homothetic image on \( G \). Since \( PTQ \perp AB \), it follows \( LW \) is a diameter of \( G \). Let \( O \) be its center.

\textbf{Claim 锟斤拷锟絵 \( MNTQ \) is cyclic.

\textit{Proof.} By Reim: 
\[
\angle TQM = \angle LWM = \angle LNM = \angle TNM.
\]
\hfill\qedsymbol

Let \( E \) be the midpoint of \( AB \).

\textbf{Claim 锟斤拷锟絵 \( OEMN \) is cyclic.

\textit{Proof.} By radical axis, the lines \( MM, NN, AEB \) meet at a point \( R \). Then \( OEMN \) lies on the circle with diameter \( OR \).
\hfill\qedsymbol

\textbf{Claim 锟斤拷锟絵 \( MTE \) are collinear.

\textit{Proof.} 
\[
\angle NMT = \angle TQN = \angle LON = \angle NOE = \angle NME.
\]
\hfill\qedsymbol

Now consider the homothety mapping \( \triangle WAB \) to \( \triangle QCD \). It should map \( E \) to a point on line \( ME \) which is also on the line through \( Q \) perpendicular to \( AB \); that is, to point \( T \). Hence \( TCD \) are collinear, and it锟斤拷锟絪 immediate that \( T \) is the desired tangency point.
",,,,,,
1998p1,"In the convex quadrilateral $ABCD$, the diagonals $AC$ and $BD$ are perpendicular and the opposite sides $AB$ and $DC$ are not parallel. Suppose that the point $P$, where the perpendicular bisectors of $AB$ and $DC$ meet, is inside $ABCD$. Prove that $ABCD$ is a cyclic quadrilateral if and only if the triangles $ABP$ and $CDP$ have equal areas.","If \(ABCD\) is cyclic, then \(P\) is the circumcenter, and \(\angle APB + \angle PCD = 180^\circ\). The hard part is the converse.

Let \(M\) and \(N\) be the midpoints of \(\overline{AB}\) and \(\overline{CD}\).

\textbf{Claim 锟斤拷锟絵 Unconditionally, we have \(\angle NEM = \angle MPN\).

\textit{Proof.} Note that \(\overline{EN}\) is the median of right triangle \(\triangle ECD\), and similarly for \(\overline{EM}\). Hence \(\angle NED = \angle EDN = \angle BDC\), while \(\angle AEM = \angle ACB\). Since \(\angle DEA = 90^\circ\), by looking at quadrilateral \(XDEA\) where \(X = \overline{CD} \cap \overline{AB}\), we derive that \(\angle NED + \angle AEM + \angle DXA = 90^\circ\), so
\[
\angle NEM = \angle NED + \angle AEM + 90^\circ = -\angle DXA = -\angle NXM = -\angle NPM
\]
as needed. \(\square\)

However, the area condition in the problem tells us
\[
\frac{EN}{EM} = \frac{CN}{CM} = \frac{PM}{PN}.
\]

Finally, we have \(\angle MEN > 90^\circ\) from the configuration. These properties uniquely determine the point \(E\): it is the reflection of \(P\) across the midpoint of \(\overline{MN}\).

So \(EMPN\) is a parallelogram, and thus \(\overline{ME} \perp \overline{CD}\). This implies \(\angle BAE = \angle CEM = \angle EDC\), giving \(ABCD\) cyclic.",2,Let $E$ be the intersection of the diagonals $AC$ and $BD$. Let $M$ and $N$ be the midpoints of the sides $AB$ and $DC$ respectively. Show that the condition Area($\triangle ABP$) = Area($\triangle CDP$) is equivalent to the geometric condition $EM \cdot PM = EN \cdot PN$.,"By definition, $P$ is the intersection of the perpendicular bisectors of $AB$ and $DC$. Let $M$ and $N$ be the midpoints of $AB$ and $DC$. Then $PM$ is the altitude from $P$ to $AB$, and $PN$ is the altitude from $P$ to $DC$. The areas of the triangles are Area($\triangle ABP$) = $\frac{1}{2}AB \cdot PM$ and Area($\triangle CDP$) = $\frac{1}{2}DC \cdot PN$. The equality of areas is thus equivalent to $AB \cdot PM = DC \cdot PN$. Since the diagonals $AC$ and $BD$ are perpendicular at $E$, the triangles $\triangle AEB$ and $\triangle CED$ are right-angled. In a right-angled triangle, the median to the hypotenuse is half the length of the hypotenuse. Thus, $EM = \frac{1}{2}AB$ and $EN = \frac{1}{2}DC$. Substituting these into the area equality gives $(2EM) \cdot PM = (2EN) \cdot PN$, which simplifies to $EM \cdot PM = EN \cdot PN$.","In the convex quadrilateral $ABCD$, the diagonals $AC$ and $BD$ are perpendicular and the opposite sides $AB$ and $DC$ are not parallel. Suppose that the point $P$, where the perpendicular bisectors of $AB$ and $DC$ meet, is inside $ABCD$. Prove that $ABCD$ is a cyclic quadrilateral if and only if the triangles $ABP$ and $CDP$ have equal areas.","From sub-problem 1, the condition of equal areas is equivalent to $EM \cdot PM = EN \cdot PN$. We now prove this condition is equivalent to $ABCD$ being cyclic.\n($\Leftarrow$) Assume $ABCD$ is cyclic. For a cyclic quadrilateral with perpendicular diagonals, a consequence of Brahmagupta's theorem is that the perpendicular from the diagonal intersection $E$ to any side bisects the opposite side. Thus, the line through $E$ perpendicular to $AB$ passes through $N$ (so $EN \perp AB$), and the line through $E$ perpendicular to $DC$ passes through $M$ (so $EM \perp DC$). Since $PM \perp AB$ and $PN \perp DC$ by definition of $P$, we have $PM \parallel EN$ and $PN \parallel EM$. Therefore, $EMPN$ is a parallelogram. This implies $EM = PN$ and $EN = PM$. Hence, $EM \cdot PM = EN \cdot PN$, which means the areas are equal.\n($\Rightarrow$) Assume the areas are equal, so $EM \cdot PM = EN \cdot PN$. It can be shown that in this configuration, the directed angles satisfy $\angle MEN = -\angle MPN$. The area condition can be written as the ratio equality $\frac{EM}{PN} = \frac{EN}{PM}$. Together with the angle relation, this implies that $\triangle MEN$ is oppositely congruent to $\triangle PNM$. Thus $EM=PN$ and $EN=PM$, which means $EMPN$ is a parallelogram. From $EM \parallel PN$ and $PN \perp DC$, we get $EM \perp DC$. In right $\triangle AEB$, $EM=AM$, so $\triangle AEM$ is isosceles and $\angle AEM = \angle EAM = \angle CAB$. The condition $EM \perp DC$ implies that $\angle CAB = \angle BDC$. This is the condition for $A, B, C, D$ to lie on a circle, so $ABCD$ is cyclic.",,,,
1998p2,"In a competition, there are $a$ contestants and $b$ judges, where $b\ge3$ is an odd integer. Each judge rates each contestant as either 锟斤拷锟絧ass锟斤拷锟?or 锟斤拷锟絝ail锟斤拷锟? Suppose $k$ is a number such that, for any two judges, their ratings coincide for at most $k$ contestants. Prove that $\frac{k}{a}\ge\frac{b-1}{2b}$.","Let $c_i$ stand for the number of judges who pass the $i$th candidate. The number of pairs of judges who agree on the $i$th contestant is then given by
\[
\binom{c_i}{2} + \binom{b - c_i}{2}
= \frac{1}{2} \left( c_i(c_i - 1) + (b - c_i)(b - c_i - 1) \right) \\
= \frac{1}{2} \left( c_i^2 + (b - c_i)^2 - b \right) \\
\ge \frac{1}{2} \left( \frac{b^2}{2} - b \right) \\
= \frac{b^2 - 2b}{4}
\]
where the inequality follows from AM-QM. Since $b$ is odd, $b^2 - 2b$ is not divisible by $4$ and we can strengthen the inequality to

\[{c_i \choose 2} + {{b - c_i} \choose 2} \geq \frac{b^2 - 2b + 1}{4} = \left(\frac{b - 1}{2}\right)^2.\]

Letting $N$ stand for the number of instances where two judges agreed on a candidate, it follows that

\[N = \sum_{i = 1}^a {c_i \choose 2} + {{b - c_i} \choose 2} \geq a \cdot \left( \frac{b - 1}{2} \right)^2.\]

The given condition on $k$ implies that

\[N \leq k \cdot {b \choose 2} = \frac{kb(b - 1)}{2}.\]

Therefore

\[a \cdot \left( \frac{b - 1}{2} \right)^2 \leq \frac{kb(b - 1)}{2},\]

which simplifies to

\[\frac{k}{a} \geq \frac{b - 1}{2b}.\]",2,"Let $N$ be the total number of instances of agreement between any two judges on any single contestant's rating. Establish a lower bound for $N$ in terms of $a$ and $b$. Specifically, prove that $N \ge a \left( \frac{b-1}{2} \right)^2$.","For any given contestant, let $c$ be the number of judges who pass them. Then $b-c$ judges fail them. The number of pairs of judges who agree on this contestant's rating is $\binom{c}{2} + \binom{b-c}{2}$. This is a quadratic function of $c$, $f(c) = \frac{1}{2}(2c^2 - 2bc + b^2 - b)$, which is minimized when $c$ is as close to $b/2$ as possible. Since $b$ is an odd integer, the minimum is achieved when $c = (b-1)/2$ or $c = (b+1)/2$. The minimum number of agreements for one contestant is $\binom{(b-1)/2}{2} + \binom{(b+1)/2}{2} = \frac{(b-1)^2}{4}$. Summing over all $a$ contestants, the total number of agreements $N$ satisfies $N \ge a \frac{(b-1)^2}{4} = a \left(\frac{b-1}{2}\right)^2$.",Prove that $\frac{k}{a}\ge\frac{b-1}{2b}$.,"From the previous step, a lower bound for the total number of agreements $N$ is $N \ge a \left( \frac{b-1}{2} \right)^2$. An upper bound can be derived from the problem statement: there are $\binom{b}{2}$ pairs of judges, and each pair agrees on at most $k$ contestants, so $N \le k \binom{b}{2} = k\frac{b(b-1)}{2}$. Combining these two inequalities gives $a \left( \frac{b-1}{2} \right)^2 \le k\frac{b(b-1)}{2}$. This simplifies to $a \frac{(b-1)^2}{4} \le k\frac{b(b-1)}{2}$. As $b \ge 3$, we can divide by $a(b-1)$ and rearrange the terms to obtain the desired result: $\frac{k}{a} \ge \frac{b-1}{2b}$.",,,,
1997p2,"The angle at $A$ is the smallest angle of triangle $ABC$. The points $B$ and $C$ divide the circumcircle of the triangle into two arcs. Let $U$ be an interior point of the arc between $B$ and $C$ which does not contain $A$. The perpendicular bisectors of $AB$ and $AC$ meet the line $AU$ and $V$ and $W$, respectively. The lines $BV$ and $CW$ meet at $T$. Show that.

$AU=TB+TC$","Let $\overline{BTV}$ meet the circle again at $U_1$, so that $AU_1UB$ is an isosceles trapezoid. Define $U_2$ similarly.

Now from the isosceles trapezoids we get
\[
AU = BU_1 = BT + TU_1 = BT + TC
\]
as desired.",1,"The angle at $A$ is the smallest angle of triangle $ABC$. The points $B$ and $C$ divide the circumcircle of the triangle into two arcs. Let $U$ be an interior point of the arc between $B$ and $C$ which does not contain $A$. The perpendicular bisectors of $AB$ and $AC$ meet the line $AU$ and $V$ and $W$, respectively. The lines $BV$ and $CW$ meet at $T$. Show that.

$AU=TB+TC$","Let $\overline{BTV}$ meet the circle again at $U_1$, so that $AU_1UB$ is an isosceles trapezoid. Define $U_2$ similarly.

Now from the isosceles trapezoids we get
\[
AU = BU_1 = BT + TU_1 = BT + TC
\]
as desired.",,,,,,
1997p3,"Let $x_{1}$, $x_{2}$,...,$x_{n}$ be real numbers satisfying the conditions

$|x_{1}+x_{2}+...+x_{n}|=1$

and

$|x_{i}| \le \frac{n+1}{2}$, for $i=1,2,...,n$

Show that there exists a permutation $y_{1}$, $y_{2}$,...,$y_{n}$ of $x_{1}$, $x_{2}$,...,$x_{n}$ such that

$|y_{1}+2y_{2}+...+ny_{n}|\le \frac{n+1}{2}$","WLOG $\sum x_i = 1$ (by negating $x_i$) and $x_1 \le x_2 \le \cdots \le x_n$. Notice that
\begin{itemize}
  \item The largest possible value of the sum in question is
  \[
  A = x_1 + 2x_2 + 3x_3 + \cdots + nx_n,
  \]
  while the smallest value is
  \[
  B = nx_1 + (n - 1)x_2 + \cdots + x_n.
  \]
  \item Meanwhile, the \textit{average} value across all permutations is
  \[
  1 \cdot \frac{1}{n} + 2 \cdot \frac{1}{n} + \cdots + n \cdot \frac{1}{n}
  = \frac{n+1}{2}.
  \]
\end{itemize}

Now imagine we transform the sum $A$ to the sum $B$, one step at a time, by swapping adjacent elements. Every time we do a swap of two neighboring $u \le v$, the sum decreases by
\[
(iu + (i+1)v) - (iv + (i+1)u) = v - u \le n + 1.
\]

We want to prove we land in the interval
\[
I = \left[ \frac{n+1}{2}, \frac{n+1}{2} \right]
\]
at some point during this transformation. But since $B \le \frac{n+1}{2} \le A$ (since $\frac{n+1}{2}$ was the average) and our step sizes were at most the length of the interval $I$, this is clear.",2,"Let $x_1, \dots, x_n$ be real numbers such that $\sum_{i=1}^n x_i = 1$ and they are sorted as $x_1 \le x_2 \le \dots \le x_n$. Define the sums $A = \sum_{i=1}^n i x_i$ and $B = \sum_{i=1}^n i x_{n-i+1}$. Show that $B \le \frac{n+1}{2} \le A$.","We can express the sums relative to the value $\frac{n+1}{2}$. Since $\sum x_i = 1$, we have $\frac{n+1}{2} = \frac{n+1}{2} \sum x_i = \sum \frac{n+1}{2} x_i$. Then, $A - \frac{n+1}{2} = \sum_{i=1}^n i x_i - \sum_{i=1}^n \frac{n+1}{2} x_i = \sum_{i=1}^n (i - \frac{n+1}{2}) x_i$. The sequence $(i - \frac{n+1}{2})$ for $i=1, \dots, n$ is non-decreasing, and by assumption, the sequence $(x_i)$ is also non-decreasing. The sum of products of two similarly sorted sequences is non-negative, so $A - \frac{n+1}{2} \ge 0$, which means $A \ge \frac{n+1}{2}$.
Similarly, $B - \frac{n+1}{2} = \sum_{i=1}^n (i - \frac{n+1}{2}) x_{n-i+1}$. Here, the sequence $(i - \frac{n+1}{2})$ is non-decreasing, while the sequence $(x_{n-i+1})$ is non-increasing. The sum of products of two oppositely sorted sequences is non-positive, so $B - \frac{n+1}{2} \le 0$, which means $B \le \frac{n+1}{2}$. Thus, we have $B \le \frac{n+1}{2} \le A$.","Let $x_{1}$, $x_{2}$,...,$x_{n}$ be real numbers satisfying the conditions $|x_{1}+x_{2}+...+x_{n}|=1$ and $|x_{i}| \le \frac{n+1}{2}$, for $i=1,2,...,n$. Show that there exists a permutation $y_{1}$, $y_{2}$,...,$y_{n}$ of $x_{1}$, $x_{2}$,...,$x_{n}$ such that $|y_{1}+2y_{2}+...+ny_{n}|\le \frac{n+1}{2}$.","Without loss of generality, assume $\sum x_i = 1$ (if it is -1, we can negate all $x_i$ and the final sum). Sort the numbers such that $x_1 \le x_2 \le \dots \le x_n$. Let $S(\pi) = \sum_{i=1}^n i y_i$ for a permutation $\pi=(y_1, \dots, y_n)$. Consider the permutation $\pi_A = (x_1, \dots, x_n)$ and the reverse permutation $\pi_B = (x_n, \dots, x_1)$. From the previous sub-problem, we have $S(\pi_B) \le \frac{n+1}{2} \le S(\pi_A)$.
Any permutation can be reached from another by a sequence of adjacent swaps. Swapping two adjacent elements $y_k$ and $y_{k+1}$ changes the sum $S$ by $y_k - y_{k+1}$. The magnitude of this change is $|y_k - y_{k+1}| \le |y_k| + |y_{k+1}| \le \frac{n+1}{2} + \frac{n+1}{2} = n+1$. Consider a sequence of permutations from $\pi_A$ to $\pi_B$ using single adjacent swaps. This generates a sequence of sums $S_0, S_1, \dots, S_m$, where $S_0 = S(\pi_A) \ge \frac{n+1}{2}$ and $S_m = S(\pi_B) \le \frac{n+1}{2}$. There must be a first index $j$ such that $S_j \le \frac{n+1}{2}$. If $S_0$ satisfies this, we are done. Otherwise, $S_{j-1} > \frac{n+1}{2}$. Since $|S_j - S_{j-1}| \le n+1$, we have $S_j \ge S_{j-1} - (n+1) > \frac{n+1}{2} - (n+1) = -\frac{n+1}{2}$. Thus, we have $-\frac{n+1}{2} < S_j \le \frac{n+1}{2}$, which proves the claim.",,,,
1997p6,"For each positive integer $n$, let $f(n)$ denote the number of ways of representing $n$ as a sum of powers of $2$ with nonnegative integer exponents. Representations which differ only in the ordering of their summands are considered to be the same. For instance, $f(4)=4$, because the number 4 can be represented in the following four ways:

$4;2+2;2+1+1;1+1+1+1$

Prove that, for any integer $n \ge 3$,

$2^{n^{2}/4}<f(2^{n})<2^{n^{2}/2}$.","It's clear that $f$ is non-decreasing. By sorting by the number of $1$锟斤拷锟絪 we used, we have the equation
\[
f(N) = f\left( \left\lfloor \frac{N}{2} \right\rfloor \right) + f\left( \left\lfloor \frac{N}{2} \right\rfloor - 1 \right) + f\left( \left\lfloor \frac{N}{2} \right\rfloor - 2 \right) + \cdots + f(1) + f(0). \tag{$\star$}
\]

Upper bound. We now prove the upper bound by induction. Indeed, the base case is trivial and for the inductive step we simply use ($\star$):
\[
f(2^n) = f(2^{n-1}) + f(2^{n-1}-1) + \cdots < 2^{n-1}f(2^{n-1}) < 2^{n-1} \cdot 2^{\frac{(n-1)^2}{2}} = 2^{\frac{n^2}{2} - \frac{1}{2}}.
\]

Lower bound. First, we contend that $f$ is convex. We'll first prove this in the even case to save ourselves some annoyance:

\[
\textbf{Claim (}f \text{ is basically convex)} \quad \text{If } 2 \mid a + b \text{ then we have } f(2a) + f(2b) \ge 2f(a + b).
\]

\textit{Proof.} Since $f(2k + 1) = f(2k)$, we will only prove the first equation. Assume WLOG $a \ge b$ and use ($\star$) on all three $f$ expressions here; after subtracting repeated terms, the inequality then rewrites as
\[
\sum_{\frac{(a + b)}{2} \le x \le a} f(x) \ge \sum_{b \le x \le \frac{(a + b)}{2}} f(x).
\]
This is true since there are an equal number of terms on each side and $f$ is nondecreasing. \qed

\textbf{Claim 锟斤拷锟絵 For each $1 \le k < 2^{n-1}$, we have
\[
f(2^{n-1} - k) + f(k + 1) \ge 2f(2^{n-2})
\]

\textit{Proof.} Use the fact that $f(2t + 1) = f(2t)$ for all $t$ and then apply convexity as above. \qed

Now we can carry out the induction:
\[
f(2^n) = f(2^{n-1}) + f(2^{n-1} - 1) + \cdots > 2^{n - 1}f(2^{n - 2}) + f(0) > 2^{n - 1}2^{\frac{(n - 2)^2}{4}} = 2^{\frac{n^2}{4}}.
\]",3,"Establish the recurrence relation for $f(n)$, the number of ways to represent $n$ as a sum of powers of 2. Use this to prove the upper bound $f(2^n) < 2^{n^2/2}$ for $n \ge 3$.","A representation of $N$ is obtained by choosing the number of 1s, say $k_0$, and partitioning the even remainder $(N-k_0)/2$ into powers of 2. Summing over all valid choices for $k_0$ gives the recurrence $f(N) = \sum_{j=0}^{\lfloor N/2 \rfloor} f(j)$. This implies $f$ is non-decreasing. For the upper bound, we use induction. The base case $n=3$ holds. Assume $f(2^{n-1}) < 2^{(n-1)^2/2}$. Then $f(2^n) = \sum_{j=0}^{2^{n-1}} f(j) \le (2^{n-1}+1)f(2^{n-1}) < (2^{n-1}+1)2^{(n-1)^2/2}$. Since $2^{n-1}+1 < 2^{(2n-1)/2}$ for $n \ge 3$, we have $f(2^n) < 2^{(2n-1)/2} \cdot 2^{(n^2-2n+1)/2} = 2^{n^2/2}$.","Prove that the function $f$ has a convexity-like property: for any non-negative integers $a, b$ such that $a+b$ is even, $f(2a)+f(2b) \ge 2f(a+b)$.","Using the recurrence $f(2k) = \sum_{j=0}^k f(j)$, the inequality is equivalent to $\sum_{j=0}^a f(j) + \sum_{j=0}^b f(j) \ge 2\sum_{j=0}^{(a+b)/2} f(j)$. Assume WLOG $a \ge b$. Let $m=(a+b)/2$. The inequality can be rewritten as $\sum_{j=m+1}^a f(j) \ge \sum_{j=b+1}^m f(j)$. The number of terms on both sides is equal to $(a-b)/2$. Since $f$ is non-decreasing, for each $i$ from $1$ to $(a-b)/2$, we have $f(m+i) \ge f(b+i)$, because $m \ge b$. Summing these term-wise inequalities proves the claim.","Prove that, for any integer $n \ge 3$, $2^{n^{2}/4}<f(2^{n})<2^{n^{2}/2}$.","The upper bound was proven in Part 1. For the lower bound $f(2^n) > 2^{n^2/4}$, we use induction. Base cases hold. Assume $f(2^{n-2}) > 2^{(n-2)^2/4}$. From Part 1, $f(2^n) = f(0) + \sum_{j=1}^{2^{n-1}} f(j)$. We pair terms in the sum: $\sum_{j=1}^{2^{n-1}} f(j) = \frac{1}{2}\sum_{k=0}^{2^{n-1}-1} [f(k+1) + f(2^{n-1}-k)]$. For each pair, since $f(2t+1)=f(2t)$, we can reduce the arguments to be even and apply the convexity from Part 2 to show $f(k+1)+f(2^{n-1}-k) \ge 2f(2^{n-2})$. This implies $\sum_{j=1}^{2^{n-1}} f(j) \ge 2^{n-1}f(2^{n-2})$. Therefore, $f(2^n) > 2^{n-1}f(2^{n-2}) > 2^{n-1} \cdot 2^{(n-2)^2/4} = 2^{n^2/4}$.",,
1996p2,"Let $P$ be a point inside triangle $ABC$ such that

\[\angle APB-\angle ACB = \angle APC-\angle ABC\]

Let $D$, $E$ be the incenters of triangles $APB$, $APC$, respectively. Show that $AP$, $BD$, $CE$ meet at a point.","let $CF$, $BG$ be the angle bisectors of $\angle ABP$ and $\angle ACP$, respectively. Notice that they coincide with line $BD$ and $CE$. Therefore, it suffices to show $CF,BG,AP$ are concurrent. Let $CF \cap AP = X_{1}$, and $BG\cap AP = X_{2}$. Notice that by angle bisector theorem, we have\[\frac{AX_{1}}{PX_{1}}=\frac{AC}{PC},\; \frac{AX_{2}}{PX_{2}}=\frac{AB}{PB}\]

Therefore, it suffices to show\[\frac{AC}{PC} =\frac{AB}{PB}\]

Now, construct $\triangle AQC \sim \triangle APB$. Connect $PQ$. We notice that $\angle BAC = \angle PAQ$, $\frac{AB}{AP}=\frac{AC}{AQ}$. Therefore $\triangle ABC \sim \triangle APQ$. 

Therefore, we have\begin{align*} \angle PQC &= \angle AQC -\angle AQP \\ &=\angle APB-\angle ACB \\ &=\angle APC-\angle ABC \\ &=\angle QPC \end{align*}Therefore,\[CP=CQ=\frac{AC}{AB} \cdot BP \Longrightarrow \frac{AC}{PC} =\frac{AB}{PB} \quad  \blacksquare\]",2,"Let D and E be the incenters of triangles APB and APC, respectively. Show that the lines AP, BD, CE are concurrent if and only if the ratio of sides $\frac{AB}{PB} = \frac{AC}{PC}$ holds.","Since D is the incenter of $\triangle APB$, the line BD is the angle bisector of $\angle ABP$. Let BD intersect AP at a point X. By the Angle Bisector Theorem in $\triangle ABP$, we have $\frac{AX}{PX} = \frac{AB}{PB}$. Similarly, since E is the incenter of $\triangle APC$, the line CE is the angle bisector of $\angle ACP$. Let CE intersect AP at a point Y. By the Angle Bisector Theorem in $\triangle APC$, we have $\frac{AY}{PY} = \frac{AC}{PC}$. The lines AP, BD, CE are concurrent if and only if the points X and Y coincide, which requires $\frac{AX}{PX} = \frac{AY}{PY}$. Therefore, the concurrency condition is equivalent to showing $\frac{AB}{PB} = \frac{AC}{PC}$.","Let $P$ be a point inside triangle $ABC$ such that $\angle APB-\angle ACB = \angle APC-\angle ABC$. Let $D$, $E$ be the incenters of triangles $APB$, $APC$, respectively. Show that $AP$, $BD$, $CE$ meet at a point.","From the first sub-problem, it suffices to show $\frac{AB}{PB} = \frac{AC}{PC}$. Construct a point $Q$ outside $\triangle APC$ such that $\triangle AQC \sim \triangle APB$. This implies $\angle AQC = \angle APB$ and $\frac{AC}{AB} = \frac{AQ}{AP} = \frac{QC}{PB}$. The condition $\frac{AC}{AB} = \frac{AQ}{AP}$ and $\angle QAC = \angle PAB$ (which implies $\angle QAP = \angle CAB$) leads to $\triangle APQ \sim \triangle ABC$. This second similarity gives $\angle AQP = \angle ACB$ and $\angle APQ = \angle ABC$. Now consider angles in $\triangle PQC$: $\angle PQC = \angle AQC - \angle AQP = \angle APB - \angle ACB$, and $\angle QPC = \angle APC - \angle APQ = \angle APC - \angle ABC$. The given condition, $\angle APB-\angle ACB = \angle APC-\angle ABC$, thus implies $\angle PQC = \angle QPC$. Therefore, $\triangle PQC$ is isosceles with $PC = QC$. Substituting $PC$ for $QC$ in the ratio from the first similarity, $\frac{QC}{PB} = \frac{AC}{AB}$, gives $\frac{PC}{PB} = \frac{AC}{AB}$. This rearranges to $\frac{AB}{PB} = \frac{AC}{PC}$, which satisfies the condition for concurrency.",,,,
1996p5,"Let $ABCDEF$ be a convex hexagon such that $AB$ is parallel to $DE$, $BD$ is parallel to $EF$, and $CD$ is parallel to $FA$. Let $R_{A}$, $R_{C}$, $R_{E}$ denote the circumradii of triangles $FAB$, $BCD$, $DEF$, respectively, and let $P$ denote the perimeter of the hexagon. Prove that

$R_{A}+R_{C}+R_{E} \ge \frac{P}{2}$","Let $s_{1}=\left| AB \right|,\;s_{2}=\left| BC \right|,\;s_{3}=\left| CD \right|,\;s_{4}=\left| DE \right|,\;s_{5}=\left| EF \right|,\;s_{6}=\left| FA \right|$

Let $d_{1}=\left| FB \right|,\;d_{2}=\left| BD \right|,\;d_{1}=\left| DF \right|$

Let $\alpha_{1}=\angle FAB,\;\alpha_{2}=\angle ABC,\;\alpha_{3}=\angle BCD,\;\alpha_{4}=\angle CDE,\;\alpha_{5}=\angle DEF,\;\alpha_{6}=\angle EFA\;$

From the parallel lines on the hexagon we get:

$\alpha_{1}=\alpha_{4},\;\alpha_{2}=\alpha_{5},\;\alpha_{3}=\alpha_{6}$ [Equations 1]

So now we look at $\Delta FAB$. We construct a perpendicular from $A$ to $FE$ and a perpendicular from $A$ to $BC$.

We find out the length of these two perpendiculars and add them to get the distance between parallel lines $FE$ and $BC$ and because of the triangle inequality the distance $\left| FB \right|$ is greater or equal to tha the distance between parallel lines $FE$ and $BC$:

This provides the following inequality:

$d_{1} \ge s_{6}sin(\alpha{6})+s_{1}sin(\alpha{2})$

Using the [Equations 1] we simplify to:

$d_{1} \ge s_{6}sin(\alpha{3})+s_{1}sin(\alpha{2})$ [Equation 2]

We now construct a perpendicular from $D$ to $FE$ and a perpendicular from $D$ to $BC$. Then we find out the length of these two perpendiculars and add them to get the distance between parallel lines $FE$ and $BC$ and get:

$d_{1} \ge s_{3}sin(\alpha{3})+s_{4}sin(\alpha{5})$

Using the [Equations 1] we simplify to:

$d_{1} \ge s_{3}sin(\alpha{3})+s_{4}sin(\alpha{2})$ [Equation 3]

We now add [Equation 2] and [Equation 3] to get:

$2d_{1} \ge (s_{3}+s_{6})sin(\alpha_{3})+(s_{1}+s_{4})sin(\alpha_{2})$ [Equation 4]

We now use the Extended law of sines on $\Delta FAB$ with $R_{A}$ to get:

$\frac{d_{1}}{sin(\alpha_{1})}=2R_{A}$

$d_{1}=2R_{A}sin(\alpha_{1})$ [Equation 5]

Substitute [Equation 5] into [Equation 4]:

$4R_{A}sin(\alpha_{1}) \ge (s_{3}+s_{6})sin(\alpha_{3})+(s_{1}+s_{4})sin(\alpha_{2})$

$4R_{A} \ge (s_{3}+s_{6})\frac{sin(\alpha_{3})}{sin(\alpha_{1})}+(s_{1}+s_{4})\frac{sin(\alpha_{2})}{sin(\alpha_{1})}$ [Equation 6]

To find the equivalent inequality for $4R_{C}$ and $4R_{E}$ we just need shift the indexes by two. That is to add $2$ to each of the indexes of $s_{i}$ and $\alpha_{i}$ and adjust the indexes so that for $s$ the indexes are 1 through 6, and for $\alpha$ the indexes are 1 through 3.

$4R_{C} \ge (s_{2}+s_{5})\frac{sin(\alpha_{2})}{sin(\alpha_{3})}+(s_{3}+s_{6})\frac{sin(\alpha_{1})}{sin(\alpha_{3})}$ [Equation 7]

$4R_{E} \ge (s_{1}+s_{4})\frac{sin(\alpha_{1})}{sin(\alpha_{2})}+(s_{2}+s_{5})\frac{sin(\alpha_{3})}{sin(\alpha_{2})}$ [Equation 8]

Adding [Equation 6], [Equation 7], and [Equation 8] we get:

$4\left( R_{A}+R_{C}+R_{E} \right) \ge (s_{1}+s_{4})\left( \frac{sin(\alpha_{2})}{sin(\alpha_{1})}+ \frac{sin(\alpha_{1})}{sin(\alpha_{2})}\right)+(s_{2}+s_{5})\left( \frac{sin(\alpha_{2})}{sin(\alpha_{3})}+ \frac{sin(\alpha_{3})}{sin(\alpha_{2})}\right)+(s_{3}+s_{6})\left( \frac{sin(\alpha_{3})}{sin(\alpha_{1})}+ \frac{sin(\alpha_{1})}{sin(\alpha_{3})}\right)$

From AM-GM inequality we get:

$x+\frac{1}{x} \ge 2\;$ Therefore, $\left( \frac{sin(\alpha_{a})}{sin(\alpha_{b})}+ \frac{sin(\alpha_{b})}{sin(\alpha_{a})}\right) \ge 2\;$ for any index $a$ and $b$

Therefore,

$4\left( R_{A}+R_{C}+R_{E} \right) \ge 2(s_{1}+s_{4})+2(s_{2}+s_{5})+2(s_{3}+s_{6})$

$4\left( R_{A}+R_{C}+R_{E} \right) \ge 2\sum_{i=1}^{6}s_{i}$

$R_{A}+R_{C}+R_{E} \ge \frac{1}{2}\sum_{i=1}^{6}s_{i}$

Since $P=\sum_{i=1}^{6}s_{i}$, then $R_{A}+R_{C}+R_{E} \ge \frac{P}{2}$",3,"Let $s_i$ be the side lengths and $\alpha_i$ be the internal angles of the hexagon, for $i=1,..,6$. For triangle $FAB$ with circumradius $R_A$, prove the inequality $4R_{A} \ge (s_{3}+s_{6})\frac{\sin(\alpha_{3})}{\sin(\alpha_{1})}+(s_{1}+s_{4})\frac{\sin(\alpha_{2})}{\sin(\alpha_{1})}$.","The hexagon's parallel side conditions ($AB \parallel DE$, $BD \parallel EF$, $CD \parallel FA$) imply that its opposite internal angles are equal: $\alpha_1=\alpha_4, \alpha_2=\alpha_5, \alpha_3=\alpha_6$. Let $d_1 = |FB|$. The diagonal length is bounded by sums of projections of sides, leading to inequalities $d_1 \ge s_6\sin(\alpha_6)+s_1\sin(\alpha_2)$ and $d_1 \ge s_3\sin(\alpha_3)+s_4\sin(\alpha_5)$. Using the angle equalities, these become $d_1 \ge s_6\sin(\alpha_3)+s_1\sin(\alpha_2)$ and $d_1 \ge s_3\sin(\alpha_3)+s_4\sin(\alpha_2)$. Summing them yields $2d_1 \ge (s_3+s_6)\sin(\alpha_3)+(s_1+s_4)\sin(\alpha_2)$. By the extended sine rule in $\triangle FAB$, $d_1 = 2R_A\sin(\alpha_1)$. Substituting this and rearranging gives the desired inequality.","By summing the inequality for $R_A$ with the analogous inequalities for $R_C$ and $R_E$, establish the lower bound: $4(R_A+R_C+R_E) \ge (s_1+s_4)(\frac{\sin(\alpha_2)}{\sin(\alpha_1)} + \frac{\sin(\alpha_1)}{\sin(\alpha_2)}) + (s_2+s_5)(\frac{\sin(\alpha_3)}{\sin(\alpha_2)} + \frac{\sin(\alpha_2)}{\sin(\alpha_3)}) + (s_3+s_6)(\frac{\sin(\alpha_1)}{\sin(\alpha_3)} + \frac{\sin(\alpha_3)}{\sin(\alpha_1)})$.","The inequality from the first sub-problem is $4R_{A} \ge (s_{3}+s_{6})\frac{\sin(\alpha_{3})}{\sin(\alpha_{1})}+(s_{1}+s_{4})\frac{\sin(\alpha_{2})}{\sin(\alpha_{1})}$. By cyclic symmetry, the corresponding inequalities for the circumradii $R_C$ of $\triangle BCD$ and $R_E$ of $\triangle DEF$ are: $4R_{C} \ge (s_{5}+s_{2})\frac{\sin(\alpha_{2})}{\sin(\alpha_{3})}+(s_{3}+s_{6})\frac{\sin(\alpha_{1})}{\sin(\alpha_{3})}$ and $4R_{E} \ge (s_{1}+s_{4})\frac{\sin(\alpha_{1})}{\sin(\alpha_{2})}+(s_{5}+s_{2})\frac{\sin(\alpha_{3})}{\sin(\alpha_{2})}$. Summing these three inequalities and grouping terms by the factors $(s_1+s_4)$, $(s_2+s_5)$, and $(s_3+s_6)$ yields the stated result.","Let $ABCDEF$ be a convex hexagon such that $AB$ is parallel to $DE$, $BD$ is parallel to $EF$, and $CD$ is parallel to $FA$. Let $R_{A}$, $R_{C}$, $R_{E}$ denote the circumradii of triangles $FAB$, $BCD$, $DEF$, respectively, and let $P$ denote the perimeter of the hexagon. Prove that $R_{A}+R_{C}+R_{E} \ge \frac{P}{2}$.","From the second sub-problem's result, we apply the AM-GM inequality, $x + \frac{1}{x} \ge 2$ for $x>0$. Since the hexagon is convex, its internal angles $\alpha_i$ are in $(0, \pi)$, so their sines are positive. Thus, each term of the form $(\frac{\sin(\alpha_a)}{\sin(\alpha_b)} + \frac{\sin(\alpha_b)}{\sin(\alpha_a)})$ is at least 2. This simplifies the inequality to $4(R_A+R_C+R_E) \ge 2(s_1+s_4) + 2(s_2+s_5) + 2(s_3+s_6)$. The right-hand side is $2(s_1+s_2+s_3+s_4+s_5+s_6) = 2P$. Therefore, $4(R_A+R_C+R_E) \ge 2P$. Dividing by 4 gives the final inequality, $R_A+R_C+R_E \ge \frac{P}{2}$.",,
1995p1,"Let $A,B,C,D$ be four distinct points on a line, in that order. The circles with diameters $AC$ and $BD$ intersect at $X$ and $Y$. The line $XY$ meets $BC$ at $Z$. Let $P$ be a point on the line $XY$ other than $Z$. The line $CP$ intersects the circle with diameter $AC$ at $C$ and $M$, and the line $BP$ intersects the circle with diameter $BD$ at $B$ and $N$. Prove that the lines $AM,DN,XY$ are concurrent.","Since $M$ is on the circle with diameter $AC$, we have $\angle AMC=90$ and so $\angle MCA=90-A$. We similarly find that $\angle BND=90$. Also, notice that the line $XY$ is the radical axis of the two circles with diameters $AC$ and $BD$. Thus, since $P$ is on $XY$, we have $PN\cdot PB=PM\cdot PC$ and so by the converse of Power of a Point, the quadrilateral $MNBC$ is cyclic. Thus, $90-A=\angle MCA=\angle BNM$. Thus, $\angle MND=180-A$ and so quadrilateral $AMND$ is cyclic. Let the name of the circle $AMND$ be $O$ . Then, the radical axis of $O$ and the circle with diameter $AC$ is line $AM$. Also, the radical axis of $O$ and the circle with diameter $BD$ is line $DN$. Since the pairwise radical axes of 3 circles are concurrent, we have $AM,DN,XY$ are concurrent as desired.",2,"Let $A,B,C,D$ be four distinct points on a line, in that order. The circles with diameters $AC$ and $BD$ intersect at $X$ and $Y$. Let $P$ be a point on the line $XY$. The line $CP$ intersects the circle with diameter $AC$ at $C$ and $M$, and the line $BP$ intersects the circle with diameter $BD$ at $B$ and $N$. Prove that the points $A, M, N, D$ are concyclic.","The line $XY$ is the radical axis of the two circles with diameters $AC$ and $BD$. Since $P$ lies on $XY$, its power with respect to both circles is equal, which means $PM \cdot PC = PN \cdot PB$. By the converse of the Power of a Point theorem, the points $M, N, B, C$ are concyclic. From this cyclic quadrilateral, we have $\angle BNM = \angle BCM = \angle ACM$. Since $M$ is on the circle with diameter $AC$, $\angle AMC = 90^\circ$, so $\angle MAC + \angle ACM = 90^\circ$. Since $N$ is on the circle with diameter $BD$, $\angle BND=90^\circ$. In quadrilateral $AMND$, the sum of opposite angles is $\angle DAM + \angle MND = \angle MAC + (\angle MNB + \angle BND) = \angle MAC + \angle ACM + 90^\circ = 90^\circ + 90^\circ = 180^\circ$. Therefore, $AMND$ is a cyclic quadrilateral.","Let $A,B,C,D$ be four distinct points on a line, in that order. The circles with diameters $AC$ and $BD$ intersect at $X$ and $Y$. The line $XY$ meets $BC$ at $Z$. Let $P$ be a point on the line $XY$ other than $Z$. The line $CP$ intersects the circle with diameter $AC$ at $C$ and $M$, and the line $BP$ intersects the circle with diameter $BD$ at $B$ and $N$. Prove that the lines $AM,DN,XY$ are concurrent.","Let $C_1$ be the circle with diameter $AC$ and $C_2$ be the circle with diameter $BD$. From the previous sub-problem, we know that $A, M, N, D$ are concyclic; let $C_3$ be the circle passing through them. The line $XY$ is the radical axis of $C_1$ and $C_2$. The line $AM$ is the radical axis of $C_1$ and $C_3$, as it passes through their intersection points $A$ and $M$. The line $DN$ is the radical axis of $C_2$ and $C_3$, as it passes through their intersection points $D$ and $N$. By the Radical Axis Theorem, the three pairwise radical axes of three circles are concurrent. Thus, the lines $AM, DN, XY$ are concurrent.",,,,
1995p2,"Let $a, b, c$ be positive real numbers such that $abc = 1$. Prove that\[\frac{1}{a^3(b+c)} + \frac{1}{b^3(c+a)} + \frac{1}{c^3(a+b)} \geq \frac{3}{2}.\]","We make the substitution $x= 1/a$, $y=1/b$, $z=1/c$. Then\begin{align*} \frac{1}{a^3(b+c)} + \frac{1}{b^3(c+a)} + \frac{1}{c^3(a+b)} &= \frac{x^3}{xyz(1/y+1/z)} + \frac{y^3}{xyz(1/z+1/x)} + \frac{z^3}{xyz(1/x+1/z)} \\ &= \frac{x^2}{y+z} + \frac{y^2}{z+x} + \frac{z^2}{x+y} . \end{align*}Since $(x^2,y^2,z^2)$ and $\bigl( 1/(y+z), 1/(z+x), 1/(x+y) \bigr)$ are similarly sorted sequences, it follows from the Rearrangement Inequality that\[\frac{x^2}{y+z} + \frac{y^2}{z+x} + \frac{z^2}{x+y} \ge \frac{1}{2} \left( \frac{y^2+z^2}{y+z} + \frac{z^2+x^2}{z+x} + \frac{x^2+y^2}{x+y} \right) .\]By the Power Mean Inequality,\[\frac{y^2+z^2}{y+z} \ge \frac{(y+z)^2}{2(x+y)} = \frac{x+y}{2} .\]Symmetric application of this argument yields\[\frac{1}{2}\left( \frac{y^2+z^2}{y+z} + \frac{z^2+x^2}{z+x} + \frac{x^2+y^2}{x+y} \right) \ge \frac{1}{2}(x+y+z) .\]Finally, AM-GM gives us\[\frac{1}{2}(x+y+z) \ge \frac{3}{2}xyz = \frac{3}{2},\] as desired.",1,"Let $a, b, c$ be positive real numbers such that $abc = 1$. Prove that\[\frac{1}{a^3(b+c)} + \frac{1}{b^3(c+a)} + \frac{1}{c^3(a+b)} \geq \frac{3}{2}.\]","We make the substitution $x= 1/a$, $y=1/b$, $z=1/c$. Then\begin{align*} \frac{1}{a^3(b+c)} + \frac{1}{b^3(c+a)} + \frac{1}{c^3(a+b)} &= \frac{x^3}{xyz(1/y+1/z)} + \frac{y^3}{xyz(1/z+1/x)} + \frac{z^3}{xyz(1/x+1/z)} \\ &= \frac{x^2}{y+z} + \frac{y^2}{z+x} + \frac{z^2}{x+y} . \end{align*}Since $(x^2,y^2,z^2)$ and $\bigl( 1/(y+z), 1/(z+x), 1/(x+y) \bigr)$ are similarly sorted sequences, it follows from the Rearrangement Inequality that\[\frac{x^2}{y+z} + \frac{y^2}{z+x} + \frac{z^2}{x+y} \ge \frac{1}{2} \left( \frac{y^2+z^2}{y+z} + \frac{z^2+x^2}{z+x} + \frac{x^2+y^2}{x+y} \right) .\]By the Power Mean Inequality,\[\frac{y^2+z^2}{y+z} \ge \frac{(y+z)^2}{2(x+y)} = \frac{x+y}{2} .\]Symmetric application of this argument yields\[\frac{1}{2}\left( \frac{y^2+z^2}{y+z} + \frac{z^2+x^2}{z+x} + \frac{x^2+y^2}{x+y} \right) \ge \frac{1}{2}(x+y+z) .\]Finally, AM-GM gives us\[\frac{1}{2}(x+y+z) \ge \frac{3}{2}xyz = \frac{3}{2},\] as desired.",,,,,,
1995p5,"Let $ABCDEF$ be a convex hexagon with $AB=BC=CD$ and $DE=EF=FA$, such that $\angle BCD=\angle EFA=\frac{\pi}{3}$. Suppose $G$ and $H$ are points in the interior of the hexagon such that $\angle AGB=\angle DHE=\frac{2\pi}{3}$. Prove that $AG+GB+GH+DH+HE\ge CF$.","Draw $AE$ and $BD$ to make equilateral $\triangle EFA$ and $\triangle BCD$, and draw points $I$ and $J$ such that $IA=IB$, $JD=JE$, directed angle $\measuredangle IAB=-\measuredangle CDB$, and directed angle $\measuredangle JDE=-\measuredangle FAE$ to make equilateral $\triangle AIB$ and $\triangle DJE$. Notice that $G$ is on the circumcircle of $\triangle AIB$ and $H$ is on the circumcircle of $\triangle DJE$. By Ptolemy, $GA+GB=GI$ and $HD+HE=HJ$. So,\[AG+GB+GH+DH+HE=IG+GH+HJ.\]Notice that octagon $AIBCDJEF$ is symmetric about $\overline{BE}$. So, $IG+GH+HJ\ge IJ=CF$",1,"Let $ABCDEF$ be a convex hexagon with $AB=BC=CD$ and $DE=EF=FA$, such that $\angle BCD=\angle EFA=\frac{\pi}{3}$. Suppose $G$ and $H$ are points in the interior of the hexagon such that $\angle AGB=\angle DHE=\frac{2\pi}{3}$. Prove that $AG+GB+GH+DH+HE\ge CF$.","Draw $AE$ and $BD$ to make equilateral $\triangle EFA$ and $\triangle BCD$, and draw points $I$ and $J$ such that $IA=IB$, $JD=JE$, directed angle $\measuredangle IAB=-\measuredangle CDB$, and directed angle $\measuredangle JDE=-\measuredangle FAE$ to make equilateral $\triangle AIB$ and $\triangle DJE$. Notice that $G$ is on the circumcircle of $\triangle AIB$ and $H$ is on the circumcircle of $\triangle DJE$. By Ptolemy, $GA+GB=GI$ and $HD+HE=HJ$. So,\[AG+GB+GH+DH+HE=IG+GH+HJ.\]Notice that octagon $AIBCDJEF$ is symmetric about $\overline{BE}$. So, $IG+GH+HJ\ge IJ=CF$",,,,,,
1994p1,"Let $m$ and $n$ be two positive integers. Let $a_1$, $a_2$, $\ldots$, $a_m$ be $m$ different numbers from the set $\{1, 2,\ldots, n\}$ such that for any two indices $i$ and $j$ with $1\leq i \leq j \leq m$ and $a_i + a_j \leq n$, there exists an index $k$ such that $a_i + a_j = a_k$. Show that\[\frac{a_1+a_2+...+a_m}{m} \ge \frac{n+1}{2}\]","Let $a_1, a_2, \dots a_m$ satisfy the given conditions. We will prove that for all $j, 1 \le j \le m,$

\[a_j+a_{m-j+1} \ge n+1\]

WLOG, let $a_1 < a_2 < \dots < a_m$. Assume that for some $j, 1 \le j \le m,$

\[a_j + a_{m-j+1} \le n\]

This implies, for each $i, 1 \le i \le j,$\[a_i + a_{m-j+1} \le n\]because $a_i \le a_j$

For each of these values of i, we must have $a_i + a_{m-j+1} = a_{k_i}$ such that $a_{k_i}$ is a member of the sequence for each $i$. Because $a_i > 0, a_{k_i} > a_{m-j+1}$. Combining all of our conditions we have that each of $k_i$ must be distinct integers such that\[m-j+1 < k_i \le m\]

However, there are $j$ distinct $k_i$, but only $j-1$ integers satisfying the above inequality, so we have a contradiction. Our assumption that $a_j + a_{m-j+1} \le n$ was false, so $a_j + a_{m-j+1} \ge n+1$ for all $j$ such that $1 \le j \le m$ Summing these inequalities together for $1 \le j \le m$ gives\[2(a_1+a_2+ \dots a_m) \ge m(n+1)\]which rearranges to\[\frac{a_1+a_2+ \dots a_m}{m} \ge \frac{n+1}{2}\]",2,"Let the set of numbers be $A = \{a_1, a_2, \\ldots, a_m\}$, sorted such that $a_1 < a_2 < \\dots < a_m$. Show that for all integers $j$ with $1 \\le j \\le m$, the inequality $a_j + a_{m-j+1} \\ge n+1$ holds.","Assume for contradiction that for some $j \\in \\{1, \\ldots, m\\}$, we have $a_j + a_{m-j+1} \\le n$. Since $a_1 < a_2 < \\dots < a_j$, it follows that for each $i \\in \\{1, \\ldots, j\\}$, $a_i + a_{m-j+1} \\le a_j + a_{m-j+1} \\le n$. By the given property, each of these $j$ sums must be an element of the set $A$. Let $a_i + a_{m-j+1} = a_{k_i}$. Since $a_i > 0$, we have $a_{k_i} > a_{m-j+1}$, which implies $k_i > m-j+1$. The $a_i$ are distinct, so the sums $a_{k_i}$ are distinct, and thus the indices $k_i$ are distinct. This gives $j$ distinct indices \\{k_1, \\ldots, k_j\\} from the set \\{m-j+2, \\ldots, m\\}. This latter set has only $j-1$ elements, a contradiction. Therefore, the assumption is false, and $a_j + a_{m-j+1} \\ge n+1$ for all $j$.","Let $m$ and $n$ be two positive integers. Let $a_1$, $a_2$, $\\ldots$, $a_m$ be $m$ different numbers from the set $\\{1, 2,\\ldots, n\\}$ such that for any two indices $i$ and $j$ with $1\\leq i \\leq j \\leq m$ and $a_i + a_j \\leq n$, there exists an index $k$ such that $a_i + a_j = a_k$. Show that\\[\frac{a_1+a_2+...+a_m}{m} \\ge \frac{n+1}{2}\\]","Let the numbers be sorted, $a_1 < a_2 < \\dots < a_m$. Using the result from the first sub-problem, we have the inequality $a_j + a_{m-j+1} \\ge n+1$ for each $j \\in \\{1, \\ldots, m\\}$. Summing these $m$ inequalities from $j=1$ to $m$ gives $\\sum_{j=1}^{m} (a_j + a_{m-j+1}) \\ge m(n+1)$. The sum on the left is $2 \\sum_{j=1}^{m} a_j$, since $\\sum_{j=1}^{m} a_{m-j+1}$ is a reordering of $\\sum_{j=1}^{m} a_j$. Thus, $2(a_1 + \\dots + a_m) \\ge m(n+1)$. Dividing by $2m$ yields the final result: $\frac{a_1+\\dots+a_m}{m} \\ge \frac{n+1}{2}$.",,,,
1994p2,"Let $ABC$ be an isosceles triangle with $AB = AC$. $M$ is the midpoint of $BC$ and $O$ is the point on the line $AM$ such that $OB$ is perpendicular to $AB$. $Q$ is an arbitrary point on $BC$ different from $B$ and $C$. $E$ lies on the line $AB$ and $F$ lies on the line $AC$ such that $E, Q, F$ are distinct and collinear. Prove that $OQ$ is perpendicular to $EF$ if and only if $QE = QF$.","Assume $OQ$ is perpendicular to $EF$. Then $\angle EBO = \angle EQO = 90^\circ$, so $EBOQ$ is cyclic. Hence $\angle OEQ = \angle OBQ$. Also $\angle OQF = \angle OCF = 90^\circ$, so $OQCF$ is cyclic. Hence $\angle OFQ = \angle OCQ$. But $\angle OCQ = \angle OBQ$ since $\triangle ABC$ is isosceles. Hence $\angle OEQ = \angle OFQ$, so $OE = OF$, so triangles $OEQ$ and $OFQ$ are congruent and $QE = QF$.

Assume $QE = QF$. If $OQ$ is not perpendicular to $EF$, then take $E'F'$ through $Q$ perpendicular to $OQ$ with $E'$ on $AB$ and $F'$ on $AC$. Then $QE' = QF'$, so triangles $QEE'$ and $QFF'$ are congruent. Hence $\angle QEE' = \angle QFF'$. So $CA$ and $AB$ make the same angles with $EF$ and hence are parallel. Contradiction. So $OQ$ is perpendicular to $EF$.",2,"Let $ABC$ be an isosceles triangle with $AB = AC$. $M$ is the midpoint of $BC$ and $O$ is the point on the line $AM$ such that $OB$ is perpendicular to $AB$. $Q$ is an arbitrary point on $BC$ different from $B$ and $C$. $E$ lies on the line $AB$ and $F$ lies on the line $AC$ such that $E, Q, F$ are distinct and collinear. Prove that if $OQ$ is perpendicular to $EF$, then $QE = QF$.","Assume $OQ \perp EF$. Since $O$ is on the symmetry axis $AM$ of isosceles $\triangle ABC$, $OB\perp AB$ implies $OC\perp AC$, and $\triangle OBC$ is isosceles giving $\angle OBQ=\angle OCQ$. The condition $\angle EBO = \angle EQO = 90^\circ$ implies the quadrilateral $EBOQ$ is cyclic, so $\angle OEQ = \angle OBQ$. Similarly, $\angle OCF = \angle OQF = 90^\circ$ implies the quadrilateral $OQCF$ is cyclic, so $\angle OFQ = \angle OCQ$. Combining these, $\angle OEQ = \angle OBQ = \angle OCQ = \angle OFQ$. Thus $\triangle OEF$ is isosceles with $OE=OF$. The right-angled triangles $\triangle OEQ$ and $\triangle OFQ$ are congruent (RHS: common side $OQ$, equal hypotenuses $OE=OF$), which gives $QE=QF$.","Let $ABC$ be an isosceles triangle with $AB = AC$. $M$ is the midpoint of $BC$ and $O$ is the point on the line $AM$ such that $OB$ is perpendicular to $AB$. $Q$ is an arbitrary point on $BC$ different from $B$ and $C$. $E$ lies on the line $AB$ and $F$ lies on the line $AC$ such that $E, Q, F$ are distinct and collinear. Prove that $OQ$ is perpendicular to $EF$ if and only if $QE = QF$.","The proof is in two parts. The forward direction ($OQ \perp EF \implies QE = QF$) is proven in the first sub-problem. For the reverse direction, assume $QE=QF$. Suppose for contradiction that $OQ$ is not perpendicular to $EF$. Let the line through $Q$ perpendicular to $OQ$ be $E'F'$, with $E'$ on line $AB$ and $F'$ on line $AC$. By the first sub-problem, we must have $QE'=QF'$. We are given $QE=QF$. Since $QE=QF$, $QE'=QF'$ and $\angle E'QE=\angle F'QF$ (vertically opposite angles), $\triangle QEE' \cong \triangle QFF'$ (SAS). This congruence implies $\angle QEE' = \angle QFF'$, meaning the line $EF$ makes equal angles with lines $AB$ and $AC$. This forces $AB$ and $AC$ to be parallel, which is a contradiction. Therefore, the assumption is false and $OQ \perp EF$ must hold.",,,,
1994p6,Show that there exists a set $A$ of positive integers with the following property: For any infinite set $S$ of primes there exist two positive integers $m \in A$ and $n \not\in A$ each of which is a product of $k$ distinct elements of $S$ for some $k \ge 2$.,"Let the primes be $p_1 < p_2 < p_3 < \dots$. Let $A$ consist of all products of $n$ distinct primes such that the smallest is greater than $p_n$. For example: all primes except $2$ are in $A$; $21$ is not in $A$ because it is a product of two distinct primes and the smallest is greater than $3$. Now let $S = \{p_{i_1}, p_{i_2}, \dots\}$ be any infinite set of primes. Assume that $p_{i_1} < p_{i_2} < \dots$. Let $n = i_1$. Then $p_{i_1}p_{i_2} \dots p_{i_n}$ is not in $A$ because it is a product of $n$ distinct primes, but the smallest is not greater than $p_n$. But $p_{i_2}p_{i_3} \dots p_{i_{n+1}}$ is in $A$, because it is a product of $n$ distinct primes and the smallest is greater than $p_n$. But both numbers are products of $n$ distinct elements of $S$.",2,"Define a set $A$ of positive integers whose membership rule for an integer $x$, being a product of $k$ distinct primes, depends on a comparison between its smallest prime factor and the $k$-th prime number $p_k$.","Let the primes in increasing order be $p_1 < p_2 < p_3 < \dots$. Define the set $A$ to be the set of all positive integers which are products of $k$ distinct primes, for some integer $k \ge 1$, where the smallest prime factor of the product is strictly greater than $p_k$.",Show that there exists a set $A$ of positive integers with the following property: For any infinite set $S$ of primes there exist two positive integers $m \\in A$ and $n \notin A$ each of which is a product of $k$ distinct elements of $S$ for some $k \\ge 2$.,"Let $A$ be the set defined in the first part. Let $S = \\{p_{i_1}, p_{i_2}, \\dots\\}$ be an infinite set of primes, with $p_{i_1} < p_{i_2} < \\dots$. Let $k = i_1$. We can assume $k \\ge 2$, since if $p_1 \\in S$, we can instead analyze the infinite set $S \\setminus \\{p_1\\}$ for which the smallest prime has an index of at least 2. Let $n = p_{i_1}p_{i_2} \\dots p_{i_k}$. This is a product of $k$ primes from $S$, and its smallest prime factor is $p_{i_1} = p_k$. By definition, $n \notin A$. Now let $m = p_{i_2}p_{i_3} \\dots p_{i_{k+1}}$. This is also a product of $k$ primes from $S$. Its smallest prime factor is $p_{i_2}$. Since $i_2 > i_1 = k$, we have $p_{i_2} > p_k$. Therefore, by definition, $m \\in A$.",,,,
1993p1,"Let $f\left(x\right)=x^n+5x^{n-1}+3$, where $n>1$ is an integer. Prove that $f\left(x\right)$ cannot be expressed as the product of two non-constant polynomials with integer coefficients.","For the sake of contradiction, assume that $f\left(x\right)=g\left(x\right)h\left(x\right)$ for polynomials $g\left(x\right)$ and $h\left(x\right)$ in $\mathbb{R}$. Furthermore, let $g\left(x\right)=b_mx^m+b_{m-1}x^{m-1}+\ldots+b_1x+b_0$ with $b_i=0$ if $i>m$ and $h\left(x\right)=c_{n-m}x^{n-m}+c_{n-m-1}x^{n-m-1}+\ldots+c_1x+c_0$ with $c_i=0$ if $i>n-m$. This gives that $f\left(x\right)=\sum_{i=0}^{n}\left(\sum_{j=0}^{i}b_jc_{i-j}\right)x^i$.

We have that $3=b_0c_0$, or $3|b_0c_0$. WLOG, let $3|b_0$ (and thus $3\not|c_0$). Since $b_0c_1+b_1c_0=0$ and $3$ divides $b_0$ but not $c_0$, we need that $3|b_1$. We can keep on going up the chain until we get that $3|b_{n-2}$. Then, by equating coefficients once more, we get that $b_0c_{n-1}+b_1c_{n-2}+\ldots+b_{n-2}c_1+b_{n-1}c_0=5$. Taking the equation $\pmod3$ gives that $b_{n-1}c_0\equiv2\pmod3$. This implies that $b_{n-1}\neq0$. Thus, the degree of $g\left(x\right)$ is at least $n-1$. However, because $h\left(x\right)$ is a non-constant factor of $f\left(x\right)$, we have that the degree of $g\left(x\right)$ is at most $n-1$. Thus, the degree of $g\left(x\right)$ is $n-1$, implying that the degree of $h\left(x\right)$ is $1$.

From this fact, we have that there must exist an integer root of $f\left(x\right)$. However, when $x$ is an integer, $x^n + 5x^{n - 1} \equiv x^{n - 2}x(x + 1) \equiv 0 \pmod{2}$, meaning $f(x)$ is odd, so $x$ cannot be a root of $f$.

Hence, $f\left(x\right)$ cannot be expressed as $g\left(x\right)h\left(x\right)$ for polynomials $g\left(x\right)$ and $h\left(x\right)$ in $\mathbb{R}$. This means that $f\left(x\right)$ cannot be expressed as the product of two non-constant polynomials with integer coefficients.",2,"Let $f(x) = x^n + 5x^{n-1} + 3$, where $n > 1$ is an integer. Assume $f(x) = g(x)h(x)$, where $g(x)$ and $h(x)$ are non-constant polynomials with integer coefficients. Prove that one of $g(x)$ or $h(x)$ must have degree 1.","Let $g(x) = \sum_{i=0}^m b_i x^i$ and $h(x) = \sum_{j=0}^{n-m} c_j x^j$. The constant term of $f(x)$ is $3=b_0c_0$. Since 3 is prime, one of $b_0$ or $c_0$ must be divisible by 3. Without loss of generality, assume $3|b_0$ and $3 \nmid c_0$. The coefficients of $x^k$ for $1 \le k < n-1$ are all 0. For $k=1$, we have $b_0c_1+b_1c_0=0$. Since $3|b_0$ and $3 \nmid c_0$, it must be that $3|b_1$. Inductively, we can show $3|b_k$ for all $k \le n-2$. The coefficient of $x^{n-1}$ is $5 = b_0c_{n-1}+b_1c_{n-2}+\ldots+b_{n-2}c_1+b_{n-1}c_0$. Taking this modulo 3 gives $2 \equiv b_{n-1}c_0 \pmod 3$. As $3 \nmid c_0$, we must have $b_{n-1} \not\equiv 0 \pmod 3$, which implies $b_{n-1} \neq 0$. Thus, the degree of $g(x)$ is at least $n-1$. Since $h(x)$ is non-constant, its degree is at least 1, so the degree of $g(x)$ is at most $n-1$. Therefore, $\\deg(g)=n-1$ and $\\deg(h)=1$.","Let $f\\left(x\right)=x^n+5x^{n-1}+3$, where $n>1$ is an integer. Prove that $f\\left(x\right)$ cannot be expressed as the product of two non-constant polynomials with integer coefficients.","Assume for contradiction that $f(x)=g(x)h(x)$ where $g(x)$ and $h(x)$ are non-constant polynomials with integer coefficients. From the previous step, one of these factors must have degree 1. This implies that $f(x)$ must have a linear factor $(x-r)$ where $r$ is an integer root (by the Rational Root Theorem, since the leading coefficient is 1). However, for any integer $x$, we can analyze $f(x)$ modulo 2: $f(x) = x^n + 5x^{n-1} + 3 \\equiv x^n + x^{n-1} + 1 \\equiv x^{n-1}(x+1) + 1 \\pmod 2$. Since for any integer $x$, either $x$ or $x+1$ is even, $x^{n-1}(x+1) \\equiv 0 \\pmod 2$. Thus, $f(x) \\equiv 1 \\pmod 2$ for all integers $x$. This means $f(x)$ is always odd and can never be zero for any integer $x$. This contradicts the conclusion that $f(x)$ has an integer root. Therefore, $f(x)$ cannot be factored into two non-constant polynomials with integer coefficients.",,,,
1993p4,"For three points $A,B,C$ in the plane, we define $m(ABC)$ to be the smallest length of the three heights of the triangle $ABC$, where in the case $A$, $B$, $C$ are collinear, we set $m(ABC) = 0$. Let $A$, $B$, $C$ be given points in the plane. Prove that for any point $X$ in the plane,

$m(ABC) \leq m(ABX) + m(AXC) + m(XBC)$.","First we prove the claim for all points $X$ within or on the triangle $ABC$: In this specific case, suppose without loss of generality that $a\ge b\ge c$. Then the length of the smallest height of $ABC$ is that of the height from vertex $A$. This has a value of $\frac{2[ABC]}{a}$. Similarly, for triangles $ABX,BCX,CAX$ we have that the length of the smallest height is twice the area of the respective triangle divided by the longest side of that triangle. It is clear that since $a$ is the longest side of $ABC$, no two points within $ABC$ have distance exceeding $a$. Thus, since $X$ is within $ABC$, the longest side of any of the triangles $ABX,BCX,CAX$ does not exceed $a$. So, we have

$m(ABX)+m(BCX)+m(CAX)\ge\frac{2[ABX]}{a}+\frac{2[BCX]}{a}+\frac{2[CAX]}{a}$

$=\frac{2[ABC]}{a}=m(ABC)$

as desired.

Now on to prove the assertion for $X$ outside the triangle $ABC$. We shall assume without loss of generality that out of the points $A,B,C$ point $A$ is that farthest from $X$.

If $ABCX$ is concave or a degenerate quadrilateral, assume without loss of generality that $B$ inside or on triangle $ACX$. We shall prove that $m(ACX)\ge m(ABC)$ to prove the main claim. If the shortest height of $ACX$ was from vertex $A$ then it is clear that the height of $ABC$ from $A$ is smaller than that since ray $CB$ is closer to $A$ than ray $CX$. The case of the height from $C$ being the smallest of triangle $ACX$ is analogous, so we move on to the case of the height from $X$ is the smallest. If this is the case, then it is clear that the height of $ABC$ from $B$ is smaller than $m(ABC)$ since $\angle XAC\ge \angle BAC$. Thus the claim is proved.

If, instead, $ABCX$ is convex, we can assign the letter $D$ to represent to point of intersection of $AX$ and $BC$. Before proving the main claim, we shall prove that for triangle $ABX$ we have $m(ABX)\ge m(ABD)$. We prove this by considering each of the vertices that the shortest height of $ABX$ is on. If the shortest height is that from $X$, then it is obvious that the height from $D$ to side $AB$ is smaller than that from $X$ since $D$ is closer to $A$ than $X$ is and so $m(ABX)\ge m(ABD)$. If the shortest height of $ABX$ was from $B$, then since the height from $B$ to $XD$ is equal to the height from $B$ to $AD$, we have $m(ABX)\ge m(ABD)$. If instead the shortest height of $ABX$ was from $A$, the it is clear that $\angle B<90$. Thus, the projection of $A$ onto $BD$ is on the same side of $B$ as $C$. Now it is obvious that the height of $ABD$ from $A$ is smaller than that of $ABX$ from $A$ since the ray $BD$ is closer to $A$ than the ray $BX$. Thus, we have $m(ABX)\ge m(ABD)$ in all cases. Notice that the case for triangle $ACX$ is analogous. Therefore, we have $m(ABX)+m(ACX)\ge m(ABD)+m(ACD)$. But, this is the case of $D$ on the triangle $ABC$, and this case was shown in the first part of this proof.

So, we have that $m(ABC) \leq m(ABX) + m(AXC) + m(XBC)$ is true in all cases, as desired.",4,"Prove that for a triangle $ABC$ and any point $X$ inside or on its boundary, $m(ABC) \leq m(ABX) + m(AXC) + m(XBC)$.","Assume without loss of generality that $a=BC$ is the longest side of $\triangle ABC$. Then the smallest height is $m(ABC) = 2[ABC]/a$. Since $X$ is within or on $\triangle ABC$, the longest side of any of the triangles $ABX$, $BCX$, or $CAX$ cannot exceed $a$. Thus, $m(ABX) \\ge 2[ABX]/a$, $m(BCX) \\ge 2[BCX]/a$, and $m(CAX) \\ge 2[CAX]/a$. As areas add up for an internal point, $[ABC] = [ABX] + [BCX] + [CAX]$, so summing the inequalities gives $m(ABX)+m(BCX)+m(CAX) \\ge 2([ABX]+[BCX]+[CAX])/a = 2[ABC]/a = m(ABC)$.","Let $ABCX$ be a convex quadrilateral, and let $D$ be the intersection of the diagonal $AX$ and the side $BC$. Prove the helper lemma $m(ABX) \ge m(ABD)$.","We prove this by a case-by-case analysis on which height of $\triangle ABX$ is the minimum. Let $h_V(S)$ denote the height from vertex $V$ in triangle $S$. 1) If $m(ABX) = h_X(ABX)$, then $m(ABX) > h_D(ABD) \\ge m(ABD)$ since $D$ lies on the segment $AX$. 2) If $m(ABX) = h_B(ABX)$, then $m(ABX) = h_B(ABD) \\ge m(ABD)$ since the height is to the same line $ADX$. 3) If $m(ABX) = h_A(ABX)$, then $m(ABX) \\ge h_A(ABD) \\ge m(ABD)$ because the line segment $BD$ is closer to vertex $A$ than the line segment $BX$. In all cases, the inequality holds.",Prove the inequality $m(ABC) \leq m(ABX) + m(AXC) + m(XBC)$ for any point $X$ outside triangle $ABC$.,"A point $X$ outside $\triangle ABC$ results in a quadrilateral $ABCX$ that is either convex or concave. If $ABCX$ is convex, let $D$ be the intersection of $AX$ and $BC$. By the lemma in Sub-problem 2, $m(ABX) \\ge m(ABD)$ and similarly $m(ACX) \\ge m(ACD)$. Point $D$ lies on the boundary of $\triangle ABC$, so from Sub-problem 1, $m(ABC) \\le m(ABD)+m(ACD)$ (since $m(DBC)=0$). Thus $m(ABC) \\le m(ABD)+m(ACD) \\le m(ABX)+m(ACX) \\le m(ABX)+m(ACX)+m(XBC)$. If $ABCX$ is concave, assume WLOG that vertex $B$ is inside $\triangle ACX$. The inequality holds if $m(ABC) \\le m(ACX)$, as other terms are non-negative. This is true because $\triangle ABC$ is contained within $\triangle ACX$, and it can be shown that each height of $\triangle ABC$ is less than or equal to a corresponding height in $\triangle ACX$.","For three points $A,B,C$ in the plane, we define $m(ABC)$ to be the smallest length of the three heights of the triangle $ABC$. Let $A, B, C$ be given points in the plane. Prove that for any point $X$ in the plane, $m(ABC) \leq m(ABX) + m(AXC) + m(XBC)$.","The location of point $X$ relative to $\triangle ABC$ can be divided into two exhaustive and mutually exclusive cases: (1) $X$ is inside or on the boundary of $\triangle ABC$, and (2) $X$ is outside $\triangle ABC$. Sub-problem 1 proves the inequality for the first case. Sub-problem 3 proves the inequality for the second case, building upon the results of the previous sub-problems. Since these two cases cover all possible locations for $X$ in the plane, the inequality is proven to be true for any point $X$."
1992p5,"Let $S$ be a finite set of points in three-dimensional space. Let $S_x$, $S_y$, $S_z$ be the sets consisting of the orthogonal projections of the points of $S$ onto the $yz$-plane, $zx$-plane, $xy$-plane respectively. Prove that:
\[
|S|^2 \leq |S_x| \cdot |S_y| \cdot |S_z|,
\]
where $|A|$ denotes the number of points in the set $A$.

\textit{[The orthogonal projection of a point onto a plane is the foot of the perpendicular from the point to the plane.]}","Induction on the number of different $z$-coordinates in $S$.

For 1, it is sufficient to note that $S = S_z$ and $|S| \leq |S_x| |S_y|$ (at most $|S_x|$ points of $S$ project onto each of the points of $S_y$).

In the general case, take a horizontal (constant $z$) plane dividing $S$ into two non-empty parts $T$ and $U$. Clearly, $|S| = |T| + |U|$, $|S_x| = |T_x| + |U_x|$, and $|S_y| = |T_y| + |U_y|$.

By induction,
\[
|S| = |T| + |U| \leq \left( |T_x| |T_y| |T_z| \right)^{1/2} + \left( |U_x| |U_y| |U_z| \right)^{1/2}.
\]
But $|T_z|, |U_z| \leq |S_z|$, and for any positive $a, b, c, d$ we have
\[
\sqrt{ab} + \sqrt{cd} \leq \sqrt{(a+c)(b+d)} \quad \text{(Cauchy-Schwarz)}.
\]

Hence,
\[
|S| \leq |S_z|^{1/2} \left( (|T_x| + |U_x|)(|T_y| + |U_y|) \right)^{1/2} = \left( |S_x| |S_y| |S_z| \right)^{1/2}.
\]",2,"For any non-negative real numbers $a, b, c, d$, prove the inequality $\sqrt{ab} + \sqrt{cd} \leq \sqrt{(a+c)(b+d)}$.","This is a form of the Cauchy-Schwarz inequality. Consider the vectors $\mathbf{u} = (\sqrt{a}, \sqrt{c})$ and $\mathbf{v} = (\sqrt{b}, \sqrt{d})$ in $\mathbb{R}^2$. The Cauchy-Schwarz inequality states that $(\mathbf{u} \cdot \mathbf{v})^2 \leq (\mathbf{u} \cdot \mathbf{u})(\mathbf{v} \cdot \mathbf{v})$. Substituting the components gives $(\sqrt{a}\sqrt{b} + \sqrt{c}\sqrt{d})^2 \leq (a+c)(b+d)$. Taking the square root of both sides, which are non-negative, yields the desired result: $\sqrt{ab} + \sqrt{cd} \leq \sqrt{(a+c)(b+d)}$.","Let $S$ be a finite set of points in three-dimensional space. Let $S_x$, $S_y$, $S_z$ be the sets consisting of the orthogonal projections of the points of $S$ onto the $yz$-plane, $zx$-plane, $xy$-plane respectively. Prove that $|S|^2 \leq |S_x| \cdot |S_y| \cdot |S_z|$.","We use induction on the number of distinct z-coordinates in $S$. The base case, where all points have the same z-coordinate, is straightforward as $|S_z|=|S|$ and $|S| \le |S_x||S_y|$. For the inductive step, assume the inequality holds for sets with fewer than $k$ distinct z-coordinates. Let $S$ have $k$ distinct z-coordinates. Split $S$ by a horizontal plane into two non-empty subsets $T$ and $U$. By the inductive hypothesis, $|T| \le (|T_x||T_y||T_z|)^{1/2}$ and $|U| \le (|U_x||U_y||U_z|)^{1/2}$. Since $T$ and $U$ have disjoint sets of z-coordinates, their projections onto the yz and zx planes are disjoint, so $|S_x|=|T_x|+|U_x|$ and $|S_y|=|T_y|+|U_y|$. Also, $|T_z| \le |S_z|$ and $|U_z| \le |S_z|$. Thus, $|S| = |T|+|U| \le (|T_x||T_y||S_z|)^{1/2} + (|U_x||U_y||S_z|)^{1/2} = |S_z|^{1/2}(\sqrt{|T_x||T_y|} + \sqrt{|U_x||U_y|})$. Using the inequality from the first sub-problem, this is $\le |S_z|^{1/2} \sqrt{(|T_x|+|U_x|)(|T_y|+|U_y|)} = |S_z|^{1/2} \sqrt{|S_x||S_y|}$. Squaring both sides yields $|S|^2 \le |S_x||S_y||S_z|$.",,,,
1991p1,"Given a triangle $ABC$ let $I$ be the center of its inscribed circle. The internal bisectors of the angles $A,B,C$ meet the opposite sides in $A^\prime,B^\prime,C^\prime$ respectively. Prove that

$\frac {1}{4} < \frac {AI\cdot BI\cdot CI}{AA^{\prime }\cdot BB^{\prime }\cdot CC^{\prime }} \leq \frac {8}{27}$","We have $\prod\frac{AI}{AA^\prime}=\prod\frac{1}{1+\frac{IA^\prime}{IA}}$. From Van Aubel's Theorem, we have $\frac{IA}{IA^\prime}=\frac{AB^\prime}{B^\prime C}+\frac{AC^\prime}{C^\prime B}$ which from the Angle Bisector Theorem reduces to $\frac{b+c}{a}$. We find similar expressions for the other terms in the product so that the product simplifies to $\prod\frac{1}{1+\frac{a}{b+c}}=\prod\frac{b+c}{a+b+c}$. Letting $a=x+y,b=y+z,c=z+x$ for positive reals $x,y,z$, the product becomes $\frac{1}{8}\prod\frac{x+2y+z}{x+y+z}=\frac{1}{8}\prod\left(1+\frac{y}{x+y+z}\right)$. To prove the right side of the inequality, we simply apply AM-GM to the product to get

$\frac{1}{8}\prod\left(1+\frac{y}{x+y+z}\right)\le\frac{1}{8}\left(\frac{\sum1+\frac{y}{x+y+z}}{3}\right)^3=\frac{8}{27}$

To prove the left side of the inequality, simply multiply out the product to get

$\frac{1}{8}\left(1+\sum\frac{y}{x+y+z}+\sum\frac{yz}{(x+y+z)^2}+\frac{xyz}{(x+y+z)^3}\right)$

$>\frac{1}{8}\left(1+\sum\frac{y}{x+y+z}\right)=\frac{1}{4}$

as desired.",1,"Given a triangle $ABC$ let $I$ be the center of its inscribed circle. The internal bisectors of the angles $A,B,C$ meet the opposite sides in $A^\prime,B^\prime,C^\prime$ respectively. Prove that

$\frac {1}{4} < \frac {AI\cdot BI\cdot CI}{AA^{\prime }\cdot BB^{\prime }\cdot CC^{\prime }} \leq \frac {8}{27}$","We have $\prod\frac{AI}{AA^\prime}=\prod\frac{1}{1+\frac{IA^\prime}{IA}}$. From Van Aubel's Theorem, we have $\frac{IA}{IA^\prime}=\frac{AB^\prime}{B^\prime C}+\frac{AC^\prime}{C^\prime B}$ which from the Angle Bisector Theorem reduces to $\frac{b+c}{a}$. We find similar expressions for the other terms in the product so that the product simplifies to $\prod\frac{1}{1+\frac{a}{b+c}}=\prod\frac{b+c}{a+b+c}$. Letting $a=x+y,b=y+z,c=z+x$ for positive reals $x,y,z$, the product becomes $\frac{1}{8}\prod\frac{x+2y+z}{x+y+z}=\frac{1}{8}\prod\left(1+\frac{y}{x+y+z}\right)$. To prove the right side of the inequality, we simply apply AM-GM to the product to get

$\frac{1}{8}\prod\left(1+\frac{y}{x+y+z}\right)\le\frac{1}{8}\left(\frac{\sum1+\frac{y}{x+y+z}}{3}\right)^3=\frac{8}{27}$

To prove the left side of the inequality, simply multiply out the product to get

$\frac{1}{8}\left(1+\sum\frac{y}{x+y+z}+\sum\frac{yz}{(x+y+z)^2}+\frac{xyz}{(x+y+z)^3}\right)$

$>\frac{1}{8}\left(1+\sum\frac{y}{x+y+z}\right)=\frac{1}{4}$

as desired.",,,,,,
1991p2,"Let $\,n > 6\,$ be an integer and $\,a_{1},a_{2},\cdots ,a_{k}\,$ be all the natural numbers less than $n$ and relatively prime to $n$. If\[a_{2} - a_{1} = a_{3} - a_{2} = \cdots = a_{k} - a_{k - 1} > 0,\]prove that $\,n\,$ must be either a prime number or a power of $\,2$.","We use Bertrand's Postulate: for $u\ge 2$ is a positive integer, there is a prime in the interval $(u,2u)$.

Clearly, $a_2$ must be equal to the smallest prime $p$ which does not divide $n$. If $p=2$, then $n$ is a prime since the common difference $a_{i+1}-a_i$ is equal to $1$, i.e. all positive integers less than $n$ are coprime to $n$. If, on the ther hand, $p=3$, we find $n$ to be a power of $2$: the positive integers less than $n$ and coprime to it are precisely the odd ones. We may thus assume that $p\ge 5$. Furthermore, since $n>6$, the positive integers less than $n$ and coprime to it cannot be $a_1,a_2$ alone, i.e. $k=\varphi(n)\ge 3$.

By Bertrand's Postulate, the largest prime less than $p$ is strictly larger than $\frac{p-1}2$, so it cannot divide $p-1$. We will denote this prime by $q$. We know that $q|n$. It's easy to check that for $p\le 31$ there is a prime $r$ strictly between $a_2=p,\ a_3=2p-1$. $rq|n$, so, in particular, $pq<rq\le n$. On the other hand, if $p>32$, the two largest primes $r_1<r_2$ which are smaller than $q$ satisfy $r_2\ge\frac p4,\ r_1\ge\frac{r_2}2\ge\frac p8$ (again, Bertrand's Postulate), so $pq<\frac{p^2}{32}q\le r_1r_2q\le n$ so, once again, we have $pq<n$ (this is what I wanted to prove here).

Now, $q\not|p-1$, and all the numbers $1,1+p-1,\ldots,1+(q-1)(p-1)$ are smaller than $n$ (they are smaller than $pq$, which is smaller than $n$, according to the paragraph above). One of these numbers, however, must be divisible by $q|n$. Since our hypothesis tells us that all of them must be coprime to $n$, we have a contradiction.",3,"Let $a_1, \ldots, a_k$ be the natural numbers less than $n$ and relatively prime to $n$, forming an arithmetic progression. Show that the first term is $a_1=1$ and the common difference is $d=p-1$, where $p$ is the smallest prime number that does not divide $n$.","The first term $a_1$ must be the smallest positive integer coprime to $n$, which is $1$. The integers $2, 3, \ldots, a_2-1$ are not coprime to $n$, which means that every prime number less than $a_2$ must be a prime factor of $n$. Consequently, $a_2$ must be the smallest prime number, which we denote by $p$, that does not divide $n$. The common difference is therefore $d = a_2 - a_1 = p - 1$.",Let $p$ be the smallest prime not dividing $n$. Show that the assumption $p \ge 5$ leads to a contradiction.,"Let $q$ be the largest prime less than $p$. Since all primes smaller than $p$ must divide $n$, we have $q|n$. Using Bertrand's Postulate, it can be established that $pq < n$. Consider the terms of the progression $a_j = 1+(j-1)(p-1)$ for $j=1, \ldots, q$. All these terms are less than $1+(q-1)(p-1) < pq < n$. For $p \ge 5$, Bertrand's Postulate implies $p/2 < q < p$, so $q$ does not divide $p-1$. As $q$ is prime, the values $a_j \pmod q$ for $j=1,\ldots,q$ are all distinct and thus cover all residues modulo $q$. Therefore, one term, say $a_{j_0}$, must be divisible by $q$. Since $q|n$, this implies $\gcd(a_{j_0}, n) \ge q > 1$, which contradicts the condition that $a_{j_0}$ is relatively prime to $n$.","Let $\,n > 6\,$ be an integer and $\,a_{1},a_{2},\cdots ,a_{k}\,$ be all the natural numbers less than $n$ and relatively prime to $n$. If\[a_{2} - a_{1} = a_{3} - a_{2} = \cdots = a_{k} - a_{k - 1} > 0,\]prove that $\,n\,$ must be either a prime number or a power of $\,2$.","From Sub-problem 1, the common difference of the arithmetic progression of coprime numbers is $p-1$, where $p$ is the smallest prime not dividing $n$. We analyze the cases for $p$. 
Case 1: $p=2$. The common difference is 1. The coprime numbers are $1, 2, 3, \ldots, n-1$. This is only possible if $n$ is a prime number. 
Case 2: $p=3$. The common difference is 2. The coprime numbers are the odd integers $1, 3, 5, \ldots$ less than $n$. This means $n$ has no odd prime factors. Since $p=3$ is the smallest prime not dividing $n$, $2$ must divide $n$. Therefore, $n$ must be a power of 2. 
Case 3: $p \ge 5$. From Sub-problem 2, this case leads to a contradiction. 
Combining these cases, $n$ must be either a prime number or a power of 2.",,
1991p4,"Suppose $\,G\,$ is a connected graph with $\,k\,$ edges. Prove that it is possible to label the edges $1,2,\ldots ,k\,$ in such a way that at each vertex which belongs to two or more edges, the greatest common divisor of the integers labeling those edges is equal to 1.","We provide an algorithmic approach for labelling the edges: We start off with the set $V$ of all vertices in $G$. For each step in the process we remove a number of vertices from the set $V$ if their exists an edge sorrounding it which is labelled. Additionally, we shall use up the numbers $1,2,...,k$ in the order from least to greatest.

Here is the process: Let $u$ be the least number not used yet. Take the longest path that uses any vertex once formed solely by vertices from $V$ and call it path $P=(v_1,v_2,...,v_n)$. If $v_1$ has more than one edge, then since $P$ is maximal, it must be connected to some other edge $v_0$ which could be one of the vertices $v_i$ or one of the vertices not in $V$. Similarly, if $v_n$ has more than one edge, it must be connected to a vertex $v_{n+1}$ which is either one of the $v_i$ or one of the vertices not in $V$. Notice that since $v_1,v_n\in V$ the edge connecting $v_0$ and $v_1$ and the edge connecting $v_n$ and $v_{n+1}$ are not labelled. Now, if $v_0$ exists, we shall label the edge joining $v_i$ and $v_{i+1}$ with the number $u+i$. If $v_0$ does not exist then we shall label the edge joining $v_i$ and $v_{i+1}$ with the number $u+i-1$.

If $v_0$ or $v_{n+1}$ does not exist, then the vertex they should have been connected to has degree 1, and so the labels of the edges sorrounding it do not matter. Otherwise and the case of any other vertex in the path, our process garuntees that the vertex will be sorrounded by two edges labelled by 2 consecutive numbers. Thus, that vertex will be sorrounded by edges whose greates common factor is 1, no matter how the other edges sorrounding it are labelled. Notice that from our definition of $V$, the edges $v_1,v_2,...,v_n$ are removed from $V$. Thus, it is clear that all vertices not in $V$, at any time, have edges sorrounding them that are relatively prime.

We repeat the process described until the only vertices in $V$ are those which are not connected to any other vertices in $V$. Let the least number we have not yet used by $u$. If any of them are of degree 1, we do not care. If there is a vertex $v$ of degree at least 2, then we simply label 2 of its edges $u$ and $u+1$ and now its edges are relatively prime, and we can remove it from $V$. Notice that this doesn't remove any other vertices from $V$ since $v$ is not connected to any vertices from $V$. We continue like this for the other vertices in $V$.

Now, all the vertices in $V$ are those whose edges do not matter, while all vertices not in $V$ are those with edges relatively prime. Thus we have the desired configuration, and we simply distribute the remaining numbers in any way we wish.",3,"Show that for any vertex v with degree at least 2, if two of its incident edges are labeled with consecutive integers, the greatest common divisor of the labels of all edges incident to v is 1.","Let the labels of the edges incident to vertex v be $l_1, l_2, \ldots, l_d$, where $d \ge 2$. Suppose two of these labels are consecutive integers, say $l_i = n$ and $l_j = n+1$ for some integer $n$. The greatest common divisor of all the labels, $\text{gcd}(l_1, \ldots, l_d)$, must divide every label in the set. In particular, it must divide both $n$ and $n+1$. Any common divisor of $n$ and $n+1$ must also divide their difference, which is $(n+1) - n = 1$. The only positive integer that divides 1 is 1. Therefore, $\text{gcd}(l_1, \ldots, l_d) = 1$.","Describe an algorithm to label the edges of any path $P=(v_1, v_2, \ldots, v_n)$ with $n-1$ available consecutive integers, say $u, u+1, \ldots, u+n-2$, such that the GCD condition is satisfied for all internal vertices of the path ($v_2, \ldots, v_{n-1}$).","Let the path be $P = (v_1, v_2, \ldots, v_n)$. Label the edge $(v_i, v_{i+1})$ with the integer $u+i-1$ for $i = 1, 2, \ldots, n-1$. Consider any internal vertex $v_j$ where $2 \le j \le n-1$. This vertex is incident to two edges on the path: $(v_{j-1}, v_j)$ and $(v_j, v_{j+1})$. The label of edge $(v_{j-1}, v_j)$ is $u+(j-1)-1 = u+j-2$, and the label of edge $(v_j, v_{j+1})$ is $u+j-1$. Since these are consecutive integers, based on the first sub-problem, the greatest common divisor of all edge labels incident to $v_j$ is 1.","Suppose $G$ is a connected graph with $k$ edges. Prove that it is possible to label the edges $1,2,\ldots ,k$ in such a way that at each vertex which belongs to two or more edges, the greatest common divisor of the integers labeling those edges is equal to 1.","We construct the labeling algorithmically. Let $U = \{1, 2, \ldots, k\}$ be the set of available labels and let $G_U$ be the subgraph of unlabeled edges, initially $G$. While $G_U$ contains a path, find a maximal path $P$ in $G_U$. Let $u$ be the smallest integer in $U$. Label the edges of $P$ with consecutive integers starting from $u$, as described in the second sub-problem. This satisfies the GCD condition for all internal vertices of $P$. The maximality of the path ensures its endpoints are also handled correctly with respect to other labeled edges. Remove the used labels from $U$ and the labeled edges from $G_U$. Repeat until $G_U$ has no paths left. For any remaining vertex $v$ with degree $\ge 2$ that still has unlabeled incident edges, pick two such edges and label them with the next two available consecutive integers from $U$. Finally, assign any remaining labels to any remaining unlabeled edges arbitrarily. This process ensures the GCD condition is met for all vertices of degree at least 2.",,
1991p5,"Let $\,ABC\,$ be a triangle and $\,P\,$ an interior point of $\,ABC\,$. Show that at least one of the angles $\,\angle PAB,\;\angle PBC,\;\angle PCA\,$ is less than or equal to $30^{\circ }$.","Let $A_{1}$ , $A_{2}$, and $A_{3}$ be $\angle CAB$, $\angle ABC$, $\angle BCA$, respectively.

Let $\alpha_{1}$ , $\alpha_{2}$, and $\alpha_{3}$ be $\angle PAB$, $\angle PBC$, $\angle PCA$, respcetively.

Using law of sines on $\Delta PAB$ we get: $\frac{\left| PA \right|}{sin(A_{2}-\alpha_{2})}=\frac{\left| PB \right|}{sin(\alpha_{1})}$, therefore, $\frac{\left| PA \right|}{\left| PB \right|}=\frac{sin(A_{2}-\alpha_{2})}{sin(\alpha_{1})}$

Using law of sines on $\Delta PBC$ we get: $\frac{\left| PB \right|}{sin(A_{3}-\alpha_{3})}=\frac{\left| PC \right|}{sin(\alpha_{2})}$, therefore, $\frac{\left| PB \right|}{\left| PC \right|}=\frac{sin(A_{3}-\alpha_{3})}{sin(\alpha_{2})}$

Using law of sines on $\Delta PCA$ we get: $\frac{\left| PC \right|}{sin(A_{1}-\alpha_{1})}=\frac{\left| PA \right|}{sin(\alpha_{3})}$, therefore, $\frac{\left| PC \right|}{\left| PA \right|}=\frac{sin(A_{1}-\alpha_{1})}{sin(\alpha_{3})}$

Multiply all three equations we get: $\frac{\left| PA \right|}{\left| PB \right|}\frac{\left| PB \right|}{\left| PC \right|}\frac{\left| PC \right|}{\left| PA \right|}=\frac{sin(A_{2}-\alpha_{2})}{sin(\alpha_{1})}\frac{sin(A_{3}-\alpha_{3})}{sin(\alpha_{2})}\frac{sin(A_{1}-\alpha_{1})}{sin(\alpha_{3})}$

$1=\frac{sin(A_{2}-\alpha_{2})}{sin(\alpha_{1})}\frac{sin(A_{3}-\alpha_{3})}{sin(\alpha_{2})}\frac{sin(A_{1}-\alpha_{1})}{sin(\alpha_{3})}$

$\prod_{i=1}^{3}\frac{sin(A_{i}-\alpha_{i})}{sin(\alpha_{i})}=1$

Using AM-GM we get:

$\frac{1}{3}\sum_{i=1}^{3}\frac{sin(A_{i}-\alpha_{i})}{sin(\alpha_{i})}\ge \sqrt[3]{\prod_{i=1}^{3}\frac{sin(A_{i}-\alpha_{i})}{sin(\alpha_{i})}}$

$\frac{1}{3}\sum_{i=1}^{3}\frac{sin(A_{i}-\alpha_{i})}{sin(\alpha_{i})}\ge 1$

$\sum_{i=1}^{3}\frac{sin(A_{i}-\alpha_{i})}{sin(\alpha_{i})}\ge 3$. [Inequality 1]

$\sum_{i=1}^{3}\frac{sin(A_{i})cos(\alpha_{i})-cos(A_{i})sin(\alpha_{i})}{sin(\alpha_{i})}\ge 3$

$\sum_{i=1}^{3}\left[ sin(A_{i})cot(\alpha_{i})-cos(A_{i})\right]\ge 3$

Note that for $0<\alpha_{i}<180^{\circ}$, $cot(\alpha_{i})$ decreases with increasing $\alpha_{i}$ and fixed $A_{i}$

Therefore, $\left[ sin(A_{i})cot(\alpha_{i})-cos(A_{i})\right]$ decreases with increasing $\alpha_{i}$ and fixed $A_{i}$

From trigonometric identity:

$sin(x)+sin(y)=2sin\left( \frac{x+y}{2} \right)cos\left( \frac{x-y}{2} \right)$,

since $-1\le cos\left( \frac{x-y}{2} \right) \le 1$, then:

$sin(x)+sin(y) \le 2sin\left( \frac{x+y}{2} \right)$

Therefore,

$sin(A_{1}-30^{\circ})+sin(A_{2}-30^{\circ}) \le 2sin\left( \frac{A_{1}+A_{2}-60^{\circ}}{2} \right)$

and also,

$sin(A_{3}-30^{\circ})+sin(30^{\circ}) \le 2sin\left( \frac{A_{3}}{2} \right)$

Adding these two inequalities we get:

$sin(30^{\circ})+\sum_{i=1}^{3}sin(A_{i}-30^{\circ})\le 2\left[ sin\left( \frac{A_{1}+A_{2}-60^{\circ}}{2} \right)+sin\left( \frac{A_{3}}{2} \right) \right]$

$\frac{1}{2}+\sum_{i=1}^{3}sin(A_{i}-30^{\circ})\le 2\left[ 2sin\left( \frac{A_{1}+A_{2}+A_{3}-60^{\circ}}{4} \right) \right]$

$\frac{1}{2}+\sum_{i=1}^{3}sin(A_{i}-30^{\circ})\le 2\left[ 2sin\left( \frac{180^{\circ}-60^{\circ}}{4} \right) \right]$

$\frac{1}{2}+\sum_{i=1}^{3}sin(A_{i}-30^{\circ})\le 4sin\left( 30^{\circ} \right)$

$\sum_{i=1}^{3}sin(A_{i}-30^{\circ})\le \frac{3}{2}$

$2\sum_{i=1}^{3}sin(A_{i}-30^{\circ})\le 3$.

$\sum_{i=1}^{3}\frac{sin(A_{i}-30^{\circ})}{sin(30^{\circ})}\le 3$. [Inequality 2]

Combining [Inequality 1] and [Inequality 2] we see the following:

$\sum_{i=1}^{3}\frac{sin(A_{i}-30^{\circ})}{sin(30^{\circ})}\le \sum_{i=1}^{3}\frac{sin(A_{i}-\alpha_{i})}{sin(\alpha_{i})}$

This implies that for at least one of the values of $i=1$,$2$,or $3$, the following is true:

$\frac{sin(A_{i}-30^{\circ})}{sin(30^{\circ})}\le \frac{sin(A_{i}-\alpha_{i})}{sin(\alpha_{i})}$

or

$\frac{sin(\alpha_{i})}{sin(A_{i}-\alpha_{i})}\le \frac{sin(30^{\circ})}{sin(A_{i}-30^{\circ})}$

Which means that for at least one of the values of $i=1$,$2$,or $3$, the following is true:

$\alpha_{i} \le 30^{\circ}$

Therefore, at least one of the angles $\,\angle PAB,\;\angle PBC,\;\angle PCA\,$ is less than or equal to $30^{\circ }$.",3,"Let $\,ABC\,$ be a triangle with angles $A_1, A_2, A_3$. Let $P$ be an interior point. Let $\alpha_1 = \angle PAB$, $\alpha_2 = \angle PBC$, $\alpha_3 = \angle PCA$. Prove that $\sum_{i=1}^{3}\frac{\sin(A_{i}-\alpha_{i})}{\sin(\alpha_{i})} \ge 3$.","Applying the Law of Sines on $\Delta PAB$, $\Delta PBC$, and $\Delta PCA$ respectively gives $\frac{|PA|}{|PB|} = \frac{\sin(A_2-\alpha_2)}{\sin(\alpha_1)}$, $\frac{|PB|}{|PC|} = \frac{\sin(A_3-\alpha_3)}{\sin(\alpha_2)}$, and $\frac{|PC|}{|PA|} = \frac{\sin(A_1-\alpha_1)}{\sin(\alpha_3)}$. Multiplying these three equations yields the trigonometric form of Ceva's Theorem for the concurrent lines AP, BP, CP: $1 = \prod_{i=1}^{3} \frac{\sin(A_i-\alpha_i)}{\sin(\alpha_i)}$. By the AM-GM inequality, $\frac{1}{3}\sum_{i=1}^{3}\frac{\sin(A_i-\alpha_i)}{\sin(\alpha_i)} \ge \sqrt[3]{\prod_{i=1}^{3} \frac{\sin(A_i-\alpha_i)}{\sin(\alpha_i)}} = 1$. Therefore, $\sum_{i=1}^{3}\frac{\sin(A_{i}-\alpha_{i})}{\sin(\alpha_{i})} \ge 3$.","For any triangle with angles $A_1, A_2, A_3$, prove the inequality $\sum_{i=1}^{3}\frac{\sin(A_{i}-30^{\circ})}{\sin(30^{\circ})} \le 3$.","We use the sum-to-product inequality $\sin(x)+\sin(y) \le 2\sin(\frac{x+y}{2})$, which follows from Jensen's inequality for the concave sine function. Applying this, we get $\sin(A_1-30^{\circ})+\sin(A_2-30^{\circ}) \le 2\sin(\frac{A_1+A_2-60^{\circ}}{2})$ and $\sin(A_3-30^{\circ})+\sin(30^{\circ}) \le 2\sin(\frac{A_3}{2})$. Adding them yields $\sum_{i=1}^{3}\sin(A_{i}-30^{\circ}) + \sin(30^{\circ}) \le 2[\sin(\frac{180^{\circ}-A_3-60^{\circ}}{2}) + \sin(\frac{A_3}{2})] = 2[\sin(60^{\circ}-\frac{A_3}{2}) + \sin(\frac{A_3}{2})]$. The right side is $2[2\sin(30^{\circ})\cos(30^{\circ}-\frac{A_3}{2})] \le 4\sin(30^{\circ}) = 2$. Thus, $\sum_{i=1}^{3}\sin(A_{i}-30^{\circ}) + \frac{1}{2} \le 2$, which means $\sum_{i=1}^{3}\sin(A_{i}-30^{\circ}) \le \frac{3}{2}$. Dividing by $\sin(30^{\circ})=\frac{1}{2}$ gives the desired result: $\sum_{i=1}^{3}\frac{\sin(A_{i}-30^{\circ})}{\sin(30^{\circ})} \le 3$.","Let $\,ABC\,$ be a triangle and $\,P\,$ an interior point of $\,ABC\,$. Show that at least one of the angles $\,\angle PAB,\;\angle PBC,\;\angle PCA\,$ is less than or equal to $30^{\circ }$.","Let $\alpha_1 = \angle PAB, \alpha_2 = \angle PBC, \alpha_3 = \angle PCA$, and let $A_1, A_2, A_3$ be the angles of $\triangle ABC$. From the first sub-problem, we have $\sum_{i=1}^{3}\frac{\sin(A_{i}-\alpha_{i})}{\sin(\alpha_{i})} \ge 3$. From the second sub-problem, we have $\sum_{i=1}^{3}\frac{\sin(A_{i}-30^{\circ})}{\sin(30^{\circ})} \le 3$. Combining these inequalities, we get $\sum_{i=1}^{3}\frac{\sin(A_{i}-30^{\circ})}{\sin(30^{\circ})} \le \sum_{i=1}^{3}\frac{\sin(A_{i}-\alpha_{i})}{\sin(\alpha_{i})}$. This implies that for at least one index $i \in \{1, 2, 3\}$, we must have $\frac{\sin(A_{i}-30^{\circ})}{\sin(30^{\circ})} \le \frac{\sin(A_{i}-\alpha_{i})}{\sin(\alpha_{i})}$. The function $f(x) = \frac{\sin(A-x)}{\sin(x)} = \sin(A)\cot(x) - \cos(A)$ is a strictly decreasing function for $x \in (0, A)$. Therefore, the inequality $f(30^{\circ}) \le f(\alpha_i)$ implies $\alpha_i \le 30^{\circ}$ for at least one $i$.",,
1990p6,"Prove that there exists a convex $1990\text{-gon}$ with the following two properties: (a) All angles are equal. (b) The lengths of the $1990$ sides are the numbers $1^2, 2^2,3^2,\dots, 1990^2$ in some order.","Let $\{a_1,a_2,\cdots,a_{1990}\}=\{1,2,\cdots,1990\}$ and $\theta=\frac{\pi}{995}$. Then the problem is equivalent to that there exists a way to assign $a_1,a_2,\cdots,a_{1990}$ such that $\sum_{i=1}^{1990}a_i^2e^{i\theta}=0$. Note that $e^{i\theta}+e^{i\theta+\pi}=0$, then if we can find a sequence $\{b_n\}$ such that $b_i=a_p^2-a_q^2, (p\not=q)$ and $\sum_{i=1}^{995}b_ie^{i\theta}=0$, the problem will be solved. Note that $2^2-1^2=3,4^2-3^2=7,\cdots,1990^2-1989^2=3979$, then $3,7,\cdots,3979$ can be written as a sum from two elements in sets $A=\{3,3+4\times199,3+4\times398,3+4\times597,3+4\times796\}$ and $B=\{0,4\times1,4\times2,\cdots,4\times 198\}$. If we assign the elements in $A$ in the way that $l_{a1}=3,l_{a2}=3+4\times199,l_{a3}=3+4\times398,l_{a4}=3+4\times597,l_{a5}=3+4\times796$, then clearly $\sum_{i=1}^{199}l_{aj}e^{i\frac{2\pi}{199}}=0, (j\in\{1,2,3,4,5\})$ Similarly, we could assign elements in $B$ in that way ($l_{b1}=0,l_{b2}=4,\cdots$) to $e^{i\frac{2\pi}{5}}$. Then we make $b_i$ according to the previous steps. Let $i\equiv j$ (mod 5), $i\equiv k$ (mod 199), and $b_i=l_{aj}+l_{bk}$, then each $b_i$ will be some $a_ p^2-a_q^2$ and $\sum_{i=1}^{995}b_ie^{i\theta}=\sum_{j=1}^5\sum_{i=1}^{199}l_{aj}e^{i\frac{2\pi}{199}}+\sum_{k=1}^{199}\sum_{i=1}^{5}l_{bk}e^{i\frac{2\pi}{5}}=0$ And we are done.",1,"Prove that there exists a convex $1990\text{-gon}$ with the following two properties: (a) All angles are equal. (b) The lengths of the $1990$ sides are the numbers $1^2, 2^2,3^2,\dots, 1990^2$ in some order.","Let $\{a_1,a_2,\cdots,a_{1990}\}=\{1,2,\cdots,1990\}$ and $\theta=\frac{\pi}{995}$. Then the problem is equivalent to that there exists a way to assign $a_1,a_2,\cdots,a_{1990}$ such that $\sum_{i=1}^{1990}a_i^2e^{i\theta}=0$. Note that $e^{i\theta}+e^{i\theta+\pi}=0$, then if we can find a sequence $\{b_n\}$ such that $b_i=a_p^2-a_q^2, (p\not=q)$ and $\sum_{i=1}^{995}b_ie^{i\theta}=0$, the problem will be solved. Note that $2^2-1^2=3,4^2-3^2=7,\cdots,1990^2-1989^2=3979$, then $3,7,\cdots,3979$ can be written as a sum from two elements in sets $A=\{3,3+4\times199,3+4\times398,3+4\times597,3+4\times796\}$ and $B=\{0,4\times1,4\times2,\cdots,4\times 198\}$. If we assign the elements in $A$ in the way that $l_{a1}=3,l_{a2}=3+4\times199,l_{a3}=3+4\times398,l_{a4}=3+4\times597,l_{a5}=3+4\times796$, then clearly $\sum_{i=1}^{199}l_{aj}e^{i\frac{2\pi}{199}}=0, (j\in\{1,2,3,4,5\})$ Similarly, we could assign elements in $B$ in that way ($l_{b1}=0,l_{b2}=4,\cdots$) to $e^{i\frac{2\pi}{5}}$. Then we make $b_i$ according to the previous steps. Let $i\equiv j$ (mod 5), $i\equiv k$ (mod 199), and $b_i=l_{aj}+l_{bk}$, then each $b_i$ will be some $a_ p^2-a_q^2$ and $\sum_{i=1}^{995}b_ie^{i\theta}=\sum_{j=1}^5\sum_{i=1}^{199}l_{aj}e^{i\frac{2\pi}{199}}+\sum_{k=1}^{199}\sum_{i=1}^{5}l_{bk}e^{i\frac{2\pi}{5}}=0$ And we are done.",,,,,,
1989p1,"Prove that in the set $\{1,2, \ldots, 1989\}$ can be expressed as the disjoint union of subsets $A_i, \{i = 1,2, \ldots, 117\}$ such that

i.) each $A_i$ contains 17 elements

ii.) the sum of all the elements in each $A_i$ is the same.","Let us start pairing numbers in the following fashion, where each pair sums to $1990$: $(1, 1990-1), (2, 1990-2), \ldots (936, 1054)$

There are a total of $117*8$ pairs above. Let us start putting these pairs into each of the $117$ subsets starting with the first pair $(1, 1990-1)$ going into $A_1$, $(2, 1990-2)$ into $A_2$ and so on $\ldots$ with $(k, 1990-k)$ going into $A_{k(mod 117)}$.

Now we have $16$ numbers present in each of the $117$ subsets all of which have the same total sum. We need $1$ more number to be filled in each subset from the remaining $117$ numbers $(937, 938, ... 1053)$.

Let us arrange these $117$ numbers in the following manner: $995-58, 995-57,  \ldots, 995-1, 995, 995+1, 995+2, \ldots, 995+57, 995+58$ $==> (1)$

Now notice that for each number that's off by $x$ from $995$, there's a counter number off by $x$ from $995$ in the opposite direction.

So we need to create similar imbalances in the Subsets $A_1$ to $A_{117}$, so that we could add the above $117$ numbers to those imbalances to keep the total sum unchanged.

Now start swapping the $1st$ number of each pair that we added to subsets $A_1$ to $A_{117}$ to create the above imbalances:

Swap $1$ from $A_1$ with $59$ from $A_{59}$ - this creates an imbalance of $+58$ and $-58$

Swap $2$ from $A_2$ with $58$ from $A_{58}$ - this creates an imbalance of $+56$ and $-56$

$\ldots$

Swap $29$ from $A_{29}$ with $31$ from $A_{31}$ - creates an imbalance of $+2$ and $-2$

Leave $30$ in $A_{30}$ as it is - $0$ imbalance.

Similarly,

Swap $60$ from $A_{60}$ with $117$ from $A_{117}$ - this creates an imbalance of $+57$ and $-57$

Swap $61$ from $A_{61}$ with $116$ from $A_{116}$ - this creates an imbalance of $+55$ and $-55$

$\ldots$

Swap $88$ from $A_{88}$ with $89$ from $A_{89}$ - this creates an imbalance of $+1$ and $-1$

Now start adding the $117$ numbers from $(1)$ to the subsets $A_1$ to $A_{117}$ to counter the imbalances $-58$ to $+58$ so that the sum remains unchanged. Notice that each subset now has $17$ elements with total sum = $8*1990 + 995 = 16915$.",3,"Determine the required sum for each of the 117 subsets. Then, partition the set $S=\{1, 2, \\ldots, 1989\}$ into a collection of pairs with a constant sum and a set of remaining single numbers.","The total sum of elements in $S$ is $\frac{1989 \times 1990}{2} = 1979055$. For 117 subsets with equal sums, each must sum to $1979055 / 117 = 16915$. We partition $S$ by forming $936$ pairs $(k, 1990-k)$ for $k \\in \\{1, \\ldots, 936\\}$. Each pair sums to 1990. These pairs use numbers from $\\{1, \\ldots, 936\\} \\cup \\{1054, \\ldots, 1989\\}$. The $1989 - 2 \times 936 = 117$ remaining numbers are $R = \\{937, 938, \\ldots, 1053\\}$.","Construct 117 disjoint subsets, each containing 16 elements, such that the sum of elements in each subset is a constant value $K$.","The set of numbers $\\{1, \\ldots, 936\\} \\cup \\{1054, \\ldots, 1989\\}$ can be partitioned into 936 pairs of the form $(k, 1990-k)$. We distribute these pairs evenly among 117 subsets $A'_i$. Since $936 = 117 \times 8$, each subset receives 8 pairs. For instance, we can assign the 8 pairs $\{(i+117j, 1990-(i+117j)) \\mid j=0, \\ldots, 7\}$ to the set $A'_i$ for $i=1, \\ldots, 117$. Each resulting subset $A'_i$ has $16$ elements, and the sum of elements is constant for all subsets: $K = 8 \times 1990 = 15920$.","Prove that in the set $\\{1,2, \\ldots, 1989\\}$ can be expressed as the disjoint union of subsets $A_i, \\{i = 1,2, \\ldots, 117\\}$ such that i.) each $A_i$ contains 17 elements and ii.) the sum of all the elements in each $A_i$ is the same.","We start with 117 disjoint sets $A'_i$, each with 16 elements and sum 15920, constructed from pairs $(k, 1990-k)$. The remaining numbers are $R=\\{937, \\ldots, 1053\\}$, which can be written as $\\{995+d \\mid d \\in \\{-58, \\ldots, 58\\}\}$. The target sum is $16915 = 15920+995$. We systematically swap elements between the sets $A'_i$ to create a set of sum imbalances $\\{d'_i\\}_{i=1}^{117}$ that is a permutation of $\\{-58, \\ldots, 58\\}$. Let $A''_i$ be the set $A'_i$ after these swaps, with sum $15920+d'_i$. We then form the final sets $A_i$ by adding the remaining number $r_i = 995-d'_i \\in R$ to the corresponding set $A''_i$. The final sum of each set $A_i$ is $(15920+d'_i) + (995-d'_i) = 16915$. Each $A_i$ now has 17 elements, and the construction ensures they form a disjoint partition of $\\{1, \\ldots, 1989\\}$ with the required equal sum property.",,
1989p2,"$ABC$ is a triangle, the bisector of angle $A$ meets the circumcircle of triangle $ABC$ in $A_1$, points $B_1$ and $C_1$ are defined similarly. Let $AA_1$ meet the lines that bisect the two external angles at $B$ and $C$ in $A_0$. Define $B_0$ and $C_0$ similarly. Prove that the area of triangle $A_0B_0C_0 = 2 \cdot$ area of hexagon $AC_1BA_1CB_1 \geq 4 \cdot$ area of triangle $ABC$.","Notice that since $A_1C$ and $A_1B$ substend the same angle in the circle, and so are equal. Thus $A_1BC$ is iscoceles, and similarly for triangles $AB_1C$ and $ABC_1$. Also, since $AA_1BC$ is a cyclic quadrilatera, $\angle A_1BC=\angle A_1AC=\frac{A}{2}$, and similarly for the other triangles. Thus, the area of triangle $A_1BC=\frac{1}{4}a^2\tan\frac{A}{2}=\frac{1}{4}a^2\left(\frac{2r}{b+c-a}\right)$ and similarly for the other triangles. Thus, the area of the hexagon is equal to $[ABC]+\sum\frac{1}{4}a^2\left(\frac{2r}{b+c-a}\right)$.

Now we shall find the area of triangle $A_0B_0C_0$. It is obvious that the points $A_1,B,C_1$ are collinear since the angle the make at $B$ is $\frac{1}{2}(180-B)+\frac{1}{2}(180-B)+B=180$, and similarly for the other points. Thus, it suffices to find the area of each of the triangles $A_0BC$. It is well known that $A_0$ is the center of the excircle $O_a$ with radius $R_a=r\left(\frac{a+b+c}{b+c-a}\right)$. Thus the area of triangle $A_0BC$ is $\frac{1}{2}ar\left(\frac{a+b+c}{b+c-a}\right)$ and so the area of triangel $A_0B_0C_0$ is $\sum\frac{1}{2}ar\left(\frac{a+b+c}{b+c-a}\right)$.

Now we can prove that $A_0B_0C_0 = 2 \cdot$ area of hexagon $AC_1BA_1CB_1$ by simplifying. We have

$A_0B_0C_0 -2 \cdot$ area of hexagon $AC_1BA_1CB_1$

$=-[ABC]+\sum\left(\frac{1}{2}ar\left(\frac{a+b+c}{b+c-a}\right)-\frac{1}{2}a^2\left(\frac{2r}{b+c-a}\right)\right)$

$=-[ABC]+\sum\left(\frac{1}{2}ar\left(\frac{a+b+c-2a}{b+c-a}\right)\right)$

$=-[ABC]+\sum\left(\frac{1}{2}ar\right)$

$=0$

as desired.

As for the inequality, notice that it is equivalent to

$[ABC]+\sum\frac{1}{2}ar\left(\frac{a+b+c}{b+c-a}\right)\ge 4[ABC]$

$\Leftrightarrow \sum\frac{1}{2}ar\left(\frac{a+b+c}{b+c-a}\right)\ge \frac{3}{2}r(a+b+c)$

$\Leftrightarrow \sum\frac{a}{b+c-a}\ge 3$

Letting $a=x+y,b=y+z,c=z+x$ for $x,y,z$ positive reals, the inequality becomes

$\sum\frac{x+y}{2z}\ge 3$

$\Leftrightarrow \sum\frac{x+y+z}{z}\ge 9$

which is true by AM-HM.",2,"Let $\triangle ABC$ be a triangle. Let $A_0, B_0, C_0$ be the centers of the excircles opposite to vertices $A, B, C$ respectively. Let the angle bisector of $A$ meet the circumcircle of $\triangle ABC$ at $A_1$, and define $B_1, C_1$ similarly. Prove that the area of $\triangle A_0B_0C_0$ is twice the area of the hexagon $AC_1BA_1CB_1$.","The point $A_0$ is the excenter $I_a$, and similarly $B_0=I_b, C_0=I_c$. The area of the excentral triangle is $[A_0B_0C_0] = [ABC] + [A_0BC] + [B_0CA] + [C_0AB]$. The area of $\triangle A_0BC$ is $\frac{1}{2}ar_a$, where $r_a$ is the exradius. Using $r_a=r\frac{a+b+c}{b+c-a}$, we have $[A_0B_0C_0] = [ABC] + \sum_{cyc} \frac{ar}{2}\frac{a+b+c}{b+c-a}$. The area of hexagon $AC_1BA_1CB_1$ is $[ABC] + [A_1BC] + [B_1CA] + [C_1AB]$. Since $A_1$ is on the circumcircle and the angle bisector of $A$, $\triangle A_1BC$ is isosceles with base angles $A/2$, so its area is $\frac{a^2}{4}\tan(A/2)$. Using $\tan(A/2) = \frac{2r}{b+c-a}$, the hexagon's area is $[ABC] + \sum_{cyc} \frac{a^2r}{2(b+c-a)}$. The equality $[A_0B_0C_0] = 2[\text{Hexagon}]$ is equivalent to $[ABC] + \sum\frac{ar}{2}\frac{a+b+c}{b+c-a} = 2[ABC] + \sum\frac{a^2r}{b+c-a}$, which simplifies to $\sum \frac{ar}{2(b+c-a)}(a+b+c-2a) = [ABC]$. The sum becomes $\sum \frac{ar}{2} = \frac{r(a+b+c)}{2} = rs = [ABC]$, which confirms the equality.","$ABC$ is a triangle, the bisector of angle $A$ meets the circumcircle of triangle $ABC$ in $A_1$, points $B_1$ and $C_1$ are defined similarly. Let $AA_1$ meet the lines that bisect the two external angles at $B$ and $C$ in $A_0$. Define $B_0$ and $C_0$ similarly. Prove that the area of triangle $A_0B_0C_0 = 2 \cdot$ area of hexagon $AC_1BA_1CB_1 \geq 4 \cdot$ area of triangle $ABC$.","From the previous sub-problem, we have established the equality: Area($\triangle A_0B_0C_0$) = 2 * Area(Hexagon $AC_1BA_1CB_1$). We now prove the inequality: $2 \cdot$ Area(Hexagon) $\geq 4 \cdot$ Area($\triangle ABC$). Using the equality, this is equivalent to showing Area($\triangle A_0B_0C_0$) $\geq 4 \cdot$ Area($\triangle ABC$). We have Area($\triangle A_0B_0C_0$) = $[ABC] + \sum_{cyc} \frac{1}{2}ar_a$. The inequality becomes $[ABC] + \sum_{cyc} \frac{1}{2}ar_a \geq 4[ABC]$, or $\sum_{cyc} \frac{1}{2}ar_a \geq 3[ABC]$. Substituting $r_a = \frac{[ABC]}{s-a}$, we get $\sum_{cyc} \frac{a[ABC]}{2(s-a)} \geq 3[ABC]$. Dividing by $[ABC]/2$ gives $\sum_{cyc} \frac{a}{s-a} \geq 6$. Using the Ravi substitution $a=y+z, b=z+x, c=x+y$, where $x,y,z$ are positive reals, $s=x+y+z$, and the inequality becomes $\frac{y+z}{x} + \frac{z+x}{y} + \frac{x+y}{z} \geq 6$. The left side is $(\frac{y}{x}+\frac{x}{y}) + (\frac{z}{y}+\frac{y}{z}) + (\frac{x}{z}+rac{z}{x})$. By the AM-GM inequality, each term in parentheses is at least 2, so their sum is at least 6. This completes the proof.",,,,
1989p3,"Let $n$ and $k$ be positive integers and let $S$ be a set of $n$ points in the plane such that

i.) no three points of $S$ are collinear, and

ii.) for every point $P$ of $S$ there are at least $k$ points of $S$ equidistant from $P.$

Prove that:\[k < \frac {1}{2} + \sqrt {2 \cdot n}\]","Let $\{A_i\}_{i=1}^n$ be our set of points. We count the pairs $(A_i,\{A_j,A_\ell\}),\ i\ne j\ne \ell\ne i$ such that $A_iA_j=A_iA_\ell$. There are $n$ choices for $A_i$, and for each $A_i$ there are $\ge\frac{k(k-1)}2$ choices for $\{A_j,A_\ell\}$, so the number of such pairs is $\ge\frac{nk(k-1)}2$. On the other hand, there are $\frac{n(n-1)}2$ choices for $\{A_j,A_\ell\}$, and for each $\{A_j,A_\ell\}$ there are at most two choices for $A_i$ (because we can't have $\ge 3$ points on the perpendicular bisector of $A_jA_\ell$). This means that the number of pairs is $\le n(n-1)$. We have thus found $n(n-1)\ge\frac{nk(k-1)}2\Rightarrow 2(n-1)\ge k(k-1)\ (*)$. If $k\ge \sqrt{2n}+\frac 12$, then $k(k-1)\ge 2n-\frac 14>2n-2$, contradicting the last inequality in $(*)$, so we're done.",2,"Let $S$ be a set of $n$ points satisfying the given conditions. By counting the number of triples of distinct points $(P, Q, R)$ from $S$ such that $d(P,Q)=d(P,R)$ in two different ways, prove that the inequality $k(k-1) \le 2(n-1)$ must hold.","Consider the set of triples $(P, \{Q, R\})$ where $P, Q, R$ are distinct points in $S$ and $P$ is equidistant from $Q$ and $R$. For each point $P \in S$, there are at least $k$ points equidistant from it, so there are at least $\binom{k}{2}$ pairs $\{Q, R\}$. This gives a total of at least $n \binom{k}{2}$ such triples. On the other hand, for any pair of points $\{Q, R\}$, the points $P$ equidistant from them lie on the perpendicular bisector of the segment $QR$. Since no three points in $S$ are collinear, there are at most two such points $P$ in $S$. With $\binom{n}{2}$ total pairs, this gives an upper bound of $2\binom{n}{2}$ triples. Combining these, we get $n \frac{k(k-1)}{2} \le 2 \frac{n(n-1)}{2}$, which simplifies to $k(k-1) \le 2(n-1)$.","Let $n$ and $k$ be positive integers and let $S$ be a set of $n$ points in the plane such that i.) no three points of $S$ are collinear, and ii.) for every point $P$ of $S$ there are at least $k$ points of $S$ equidistant from $P.$ Prove that:\[k < \frac {1}{2} + \sqrt {2 \cdot n}\]","From the previous step, we have the inequality $k(k-1) \le 2(n-1)$. Assume for contradiction that $k \ge \frac{1}{2} + \sqrt{2n}$. Then $k - \frac{1}{2} \ge \sqrt{2n}$. As $k \ge 1$, both sides are positive, so we can square to get $(k - \frac{1}{2})^2 \ge 2n$, which expands to $k^2 - k + \frac{1}{4} \ge 2n$, or $k(k-1) \ge 2n - \frac{1}{4}$. Combining this with our derived inequality gives $2n - \frac{1}{4} \le k(k-1) \le 2(n-1) = 2n-2$. This implies $2n - \frac{1}{4} \le 2n-2$, which simplifies to $2 \le \frac{1}{4}$, a contradiction. Therefore, the assumption is false, and we must have $k < \frac{1}{2} + \sqrt{2n}$.",,,,
1989p4,"Let $ABCD$ be a convex quadrilateral such that the sides $AB,AD,BC$ satisfy $AB=AD+BC$. There exists a point $P$ inside the quadrilateral at a distance $h$ from the line $CD$ such that $AP=h+AD$ and $BP=h+BC$. Show that:

$\frac{1}{\sqrt{h}}\ge\frac{1}{\sqrt{AD}}+\frac{1}{\sqrt{BC}}$","Without loss of generality, assume $AD\ge BC$.

Draw the circle with center $A$ and radius $AD$ as well as the circle with center $B$ and radius $BC$. Since $AB=AD+BC$, the intersection of circle $A$ with the line $AB$ is the same as the intersection of circle $B$ with the line $AB$. Thus, the two circles are externally tangent to each other.

Now draw the circle with center $P$ and radius $h$. Since $h$ is the shortest distance from $P$ to $CD$, we have that the circle $P$ is tangent to $CD$. From the conditions $AP=h+AD$ and $BP=h+BC$, by the same reasoning that we found circles $A,B$ are tangent, we find that circles $P,A$ and $P,B$ are externally tangent also.

Fix the two externally tangent circles with centers $A$ and $B$ and let the points $C$ and $D$ vary about their respective circles (without loss of generality, assume that one can read the letters $ABCD$ in counter clockwise order). Notice that the value $\frac{1}{\sqrt{AD}}+\frac{1}{\sqrt{BC}}$ is fixed. Thus, in order to prove the claim presented in the problem, we must maximize the value of $h$. It is clear that all possible circles $P$ are contained within the region created by circles $A,B$ as well as their common tangent line. Now it is clear that $h$ is maximized when circle $P$ is tangent to the common tangent of circles $A,B$ as well as to the circles $A,B$. We shall prove that the value of $h$ at this point is $\frac{1}{\sqrt{AD}}+\frac{1}{\sqrt{BC}}$.

Fix $C,D$ so that $CD$ is the common tangent to circles $A,B$. Since $\angle ADC,\angle BCD$ are right, the length $CD$ is equal to the length of the segment from $B$ to the projection of $B$ onto $AD$ which by the Pythagorean Theorem is $\sqrt{(BC+AD)^2-(AD-BC)^2}=2\sqrt{BC\cdot AD}$. Let the projection of $P$ onto $CD$ be $x$ units away from $D$. Then, as we found the length of $CD$, we find

$x^2+(AD-h)^2=(AD+h)^2\Rightarrow x^2=4AD\cdot h$

$(2\sqrt{BC\cdot AD}-x)^2+(BC-h)^2=(BC+h)^2\Rightarrow (2\sqrt{BC\cdot AD}-x)^2=4BC\cdot h$

Subtracting the second equation from the first yields

$4x\sqrt{BC\cdot AD}-4BC\cdot AD=4AD\cdot h-4BC\cdot h$

$\Rightarrow x=h\left(\sqrt{\frac{AD}{BC}}-\sqrt{\frac{BC}{AD}}\right)+\sqrt{BC\cdot AD}$

Since $x^2=2AD\cdot h$, we have

$0=h\left(\sqrt{\frac{AD}{BC}}-\sqrt{\frac{BC}{AD}}\right)-2\sqrt{AD\cdot h}+\sqrt{BC\cdot AD}$

Solving for $\sqrt{h}$ yields

$\sqrt{h}=\frac{2\sqrt{AD}\pm\sqrt{4AD-4(AD-BC)}}{2\left(\sqrt{\frac{AD}{BC}}-\sqrt{\frac{BC}{AD}}\right)}$

$\Rightarrow \sqrt{h}=\frac{\sqrt{AD}\pm\sqrt{BC}}{\sqrt{\frac{AD}{BC}}-\sqrt{\frac{BC}{AD}}}$

Since $\sqrt{h}\ne \frac{\sqrt{AD}+\sqrt{BC}}{\sqrt{\frac{AD}{BC}}-\sqrt{\frac{BC}{AD}}}$, we have

$\sqrt{h}=\frac{\sqrt{AD}-\sqrt{BC}}{\sqrt{\frac{AD}{BC}}-\sqrt{\frac{BC}{AD}}}$

$=\frac{\sqrt{AD\cdot BC}}{\sqrt{AD}+\sqrt{BC}}$

And since this is the maximimal value of $\sqrt{h}$, the minimal value of $\frac{1}{\sqrt{h}}$ is $\frac{1}{\sqrt{AD}}+\frac{1}{\sqrt{BC}}$ as desired.",3,"Let circle $C_A$ be centered at A with radius $r_A=AD$, circle $C_B$ be centered at B with radius $r_B=BC$, and circle $C_P$ be centered at P with radius $r_P=h$. Based on the problem's conditions $AB=AD+BC$, $AP=h+AD$, and $BP=h+BC$, describe the geometric relationship between these three circles and the line $CD$.","The condition $AB = AD+BC$ implies the distance between the centers of $C_A$ and $C_B$ is the sum of their radii, so they are externally tangent. Similarly, $AP=h+AD$ implies $C_A$ and $C_P$ are externally tangent, and $BP=h+BC$ implies $C_B$ and $C_P$ are externally tangent. Therefore, the three circles $C_A, C_B, C_P$ are mutually externally tangent. The condition that $P$ is at a distance $h$ from line $CD$ means that circle $C_P$ is tangent to the line $CD$.","To find an upper bound for $h$, consider the specific configuration where the line $CD$ is a common external tangent to circles $C_A$ and $C_B$. Calculate the value of $\sqrt{h}$ in this arrangement.","When $CD$ is the common external tangent to $C_A$ and $C_B$, the points where $C_A$, $C_P$, and $C_B$ touch the line $CD$ are collinear. The distance along the tangent line between the tangency points of $C_A$ and $C_B$ is $2\sqrt{AD \cdot BC}$. This distance must be the sum of the distances between the tangency points of $C_A$ and $C_P$ ($2\sqrt{AD \cdot h}$) and of $C_P$ and $C_B$ ($2\sqrt{BC \cdot h}$). Thus, we have the relation $2\sqrt{AD \cdot BC} = 2\sqrt{AD \cdot h} + 2\sqrt{BC \cdot h}$. Dividing by 2 and factoring gives $\sqrt{AD \cdot BC} = \sqrt{h}(\sqrt{AD} + \sqrt{BC})$. Solving for $\sqrt{h}$ yields $\sqrt{h} = \frac{\sqrt{AD \cdot BC}}{\sqrt{AD}+\sqrt{BC}}$.","Show that for any point $P$ inside the quadrilateral satisfying the given conditions, it holds that $\frac{1}{\sqrt{h}}\ge\frac{1}{\sqrt{AD}}+\frac{1}{\sqrt{BC}}$.","The quantity $\frac{1}{\sqrt{AD}}+\frac{1}{\sqrt{BC}}$ is fixed. To prove the inequality, we must find the maximum possible value for $h$. The value of $h$ is maximized when circle $C_P$ is as large as possible, which occurs when the line $CD$ is the common external tangent to circles $C_A$ and $C_B$. Any other line $CD$ passing through a point on $C_A$ and a point on $C_B$ would further constrain the position of $P$, leading to a smaller $h$. Thus, for any valid configuration, $h \le h_{max}$, where $h_{max}$ is the value from the previous sub-problem. This implies $\sqrt{h} \le \sqrt{h_{max}} = \frac{\sqrt{AD \cdot BC}}{\sqrt{AD}+\sqrt{BC}}$. Taking the reciprocal reverses the inequality: $\frac{1}{\sqrt{h}} \ge \frac{\sqrt{AD}+\sqrt{BC}}{\sqrt{AD \cdot BC}}$. Splitting the fraction on the right gives $\frac{1}{\sqrt{h}} \ge \frac{\sqrt{AD}}{\sqrt{AD \cdot BC}} + \frac{\sqrt{BC}}{\sqrt{AD \cdot BC}}$, which simplifies to the desired result: $\frac{1}{\sqrt{h}} \ge \frac{1}{\sqrt{BC}} + \frac{1}{\sqrt{AD}}$.",,
1989p5,Prove that for each positive integer $n$ there exist $n$ consecutive positive integers none of which is an integral power of a prime number.,"There are at most $1+\sqrt[2]{n}+\sqrt[3]{n}+\sqrt[4]{n}+...+\sqrt[\left\lfloor \log_2(n)\right\rfloor]{n} \leq 1+ \sqrt n log_2(n)$ 'true' powers $m^k , k\geq 2$ in the set $\{1,2,...,n\}$. So when $p(n)$ gives the amount of 'true' powers $\leq n$ we get that $\lim_{n \to \infty} \frac{p(n)}{n} = 0$.

Since also $\lim_{n \to \infty} \frac{\pi(n)}{n} = 0$, we get that $\lim_{n \to \infty} \frac{p(n)+\pi(n)}{n} = 0$. Now assume that there is no 'gap' of lenght at least $k$ into the set of 'true' powers and the primes. Then this would give that $\frac{p(n)+\pi(n)}{n} \geq \frac{1}{k}$ for all $n$ in contrary to the above (at east this proves a bit more).

Edit: to elementarize the $\lim_{n \to \infty} \frac{\pi(n)}{n} = 0$ part: Look $\mod (k+1)!$. Then all numbers in the residue classes $2,3,4,...,k+1$ are not primes (except the smallest representants sometimes). So when there wouldn't exist a gap of length $k$, there has to be a 'true' power in each of these gaps of the prime numbers, so at least one power each $(k+1)!$ numbers, again contradicting $\lim_{n \to \infty} \frac{p(n)}{n} = 0$.",2,"Let $S$ be the set of integers that are an integral power of a prime number (i.e., of the form $p^k$ for a prime $p$ and integer $k \ge 1$). Let $C(N)$ be the number of elements in $S$ that are less than or equal to $N$. Prove that the density of $S$ is zero, i.e., $\lim_{N \to \infty} \frac{C(N)}{N} = 0$.","The set $S$ is the union of the set of primes $P = \{p^1\}$ and the set of higher prime powers $S' = \{p^k : p \text{ is prime}, k \ge 2\}$. Let $\pi(N)$ be the number of primes $\le N$, and let $C'(N)$ be the number of elements of $S'$ that are $\le N$. We have $C(N) \le \pi(N) + C'(N)$.
From the Prime Number Theorem, we know that $\lim_{N \to \infty} \frac{\pi(N)}{N} = 0$. 
To bound $C'(N)$, we can count all perfect powers $m^k$ for $k \ge 2$ and $m^k \le N$. The number of $k$-th powers $\le N$ is at most $N^{1/k}$. The possible exponents $k$ range from $2$ to $\lfloor\log_2 N\rfloor$. 
So, $C'(N) \le \sum_{k=2}^{\lfloor\log_2 N\rfloor} N^{1/k} \le N^{1/2} + \sum_{k=3}^{\lfloor\log_2 N\rfloor} N^{1/3} \le N^{1/2} + (\log_2 N) N^{1/3}$.
Dividing by $N$, we get $\frac{C'(N)}{N} \le \frac{N^{1/2}}{N} + \frac{(\log_2 N) N^{1/3}}{N} = \frac{1}{N^{1/2}} + \frac{\log_2 N}{N^{2/3}}$. As $N \to \infty$, both terms approach 0. Thus, $\lim_{N \to \infty} \frac{C'(N)}{N} = 0$.
Since $\frac{C(N)}{N} \le \frac{\pi(N)}{N} + \frac{C'(N)}{N}$, and both terms on the right go to 0, we conclude $\lim_{N \to \infty} \frac{C(N)}{N} = 0$.",Prove that for each positive integer $n$ there exist $n$ consecutive positive integers none of which is an integral power of a prime number.,"Let $S$ be the set of integral powers of prime numbers. From the previous sub-problem, we know that the density of $S$ is zero, i.e., $\lim_{N \to \infty} \frac{|S \cap \{1, \dots, N\}|}{N} = 0$. 
Assume for contradiction that there is a positive integer $n$ such that every sequence of $n$ consecutive positive integers contains at least one element from $S$. This implies that the gap between any two consecutive elements of $S$ is at most $n-1$. 
Let the elements of $S$ be $s_1 < s_2 < s_3 < \dots$. The assumption implies $s_{i+1} - s_i \le n$ for all $i \ge 1$. This means that for any integer $N$, the number of elements of $S$ up to $N$, denoted $C(N)$, must be at least $\lfloor N/n \rfloor$. 
Therefore, $\frac{C(N)}{N} \ge \frac{\lfloor N/n \rfloor}{N}$. As $N \to \infty$, the right side approaches $1/n$. So, $\liminf_{N \to \infty} \frac{C(N)}{N} \ge \frac{1}{n}$. 
This contradicts our result that the limit is 0, since $1/n > 0$. Thus, the assumption must be false. For any $n$, there must exist a gap of length at least $n$ in the set $S$, which proves the existence of $n$ consecutive integers, none of which is an integral power of a prime.",,,,
1989p6,"A permutation $\{x_1, \ldots, x_{2n}\}$ of the set$\{1,2, \ldots, 2n\}$ where $\mbox{n}$ is a positive integer, is said to have property $T$ if $|x_i - x_{i + 1}| = n$ for at least one $i \in \{1,2, \ldots, 2n - 1\}$. Show that, for each $\mbox{n}$, there are more permutations with property $T$ than without.","Let $F$ be the number of permutations with property $T$, and $F_i$ be the set of permutations $\{ x_1, x_2, \ldots, x_{2n} \}$ such that $|x_i - x_{i+1}| = n$. By the inclusion-exclusion principle,

\[|F| = \bigg|\bigcup_{i=1}^n F_i \bigg| = \sum_{i=1}^{2n-1} |F_i| - \sum_{1\leq i<j \leq 2n-1} |F_i \cap F_j| + E \tag{1}\]

for some $E \geq 0$. Let锟斤拷锟絪 calculate the first two sums on the far right.

For any $i$, $|F_i| = 2n \cdot (2n - 2)!$, since there are are $2n$ choices for $x_i$, which fixes $x_{i+1}$, and $(2n-2)!$ choices for the remaining elements. Thus

\[\sum_{i=1}^{2n - 1}|F_i| = 2n \cdot (2n - 2)! \cdot (2n - 1) = (2n)!\]

Now let锟斤拷锟絪 compute $|F_i \cap F_j|$, where $1 \leq i < j \leq 2n - 1$. It锟斤拷锟絪 not possible that $|x_i - x_{i+1}| = |x_{i+1}- x_{i+2}| = n$, since that would imply $x_i = x_{i+2}$. So $|F_i \cap F_j| = 0$ if $j = i + 1$. If $j > i + 1$, then $|F_i \cap F_j| = 2n \cdot (2n - 2) \cdot (2n - 4)!$ (there are $2n$ choices for $x_i, x_{i+1}$, $2n - 2$ for $x_j, x_{j+1}$, and $(2n - 4)!$ for everything else.)

How often is $|F_i \cap F_j| \neq 0$? We know $i$ is at least $1$ and at most $2n - 3$, and for any value of $i$, there are $2n - 2 - i$ possible values for $j$. So the number of non-empty intersections $|F_i \cap F_j|$ is\[\sum_{i=1}^{2n-3} 2n - 2 - i = \sum_{i=1}^{2n-3}i = \frac{(2n-3)(2n-2)}{2}.\]Now we can compute\begin{align*} \sum_{1\leq i < j \leq 2n-1} |F_i \cap F_j| &= 2n \cdot (2n - 2) \cdot (2n - 4)! \cdot \frac{(2n - 3)(2n - 2)}{2} \\ &= \frac{2n \cdot (2n-2)^2 \cdot (2n - 3)!}{2} = \frac{(2n)!}{2} \cdot \frac{2n - 2}{2n - 1} \\ &< \frac{(2n)!}{2}. \end{align*}

Let锟斤拷锟絪 plug this into $(1)$:

\[|F| = \sum_{i=1}^{2n - 1} |F_i| - \sum_{1\leq i < j \leq 2n-1} |F_i \cap F_j| + E > (2n)! - \frac{(2n)!}{2} + E \geq \frac{(2n)!}{2}.\]

So more than half of the $(2n)!$ permutations of $\{1, \ldots, 2n\}$ have property $T$.",3,"Let $F_i$ be the set of permutations $\{x_1, \ldots, x_{2n}\}$ of $\{1, \ldots, 2n\}$ such that $|x_i - x_{i+1}| = n$. Calculate the sum $\sum_{i=1}^{2n-1} |F_i|$.","For any given $i$, there are $n$ pairs of values $(k, k+n)$ that can be chosen for $(x_i, x_{i+1})$. Each pair can be ordered in 2 ways, so there are $2n$ choices for the ordered pair $(x_i, x_{i+1})$. The remaining $2n-2$ numbers can be arranged in $(2n-2)!$ ways. Thus, $|F_i| = 2n \cdot (2n-2)!$. Summing over the $2n-1$ possible values for $i$, we get $\sum_{i=1}^{2n-1} |F_i| = (2n-1) \cdot 2n \cdot (2n-2)! = (2n)!$.",Let $F_i$ be defined as in the previous sub-problem. Show that $\sum_{1 \le i < j \le 2n-1} |F_i \cap F_j| < \frac{(2n)!}{2}$.,"The intersection $F_i \cap F_j$ is non-empty only if $j > i+1$, as $j=i+1$ implies $x_i=x_{i+2}$, which is impossible in a permutation. For such a pair $(i,j)$, $|F_i \cap F_j| = 2n(2n-2)(2n-4)!$. The number of such pairs $(i,j)$ is $\frac{(2n-2)(2n-3)}{2}$. The total sum is $\sum |F_i \cap F_j| = \frac{(2n-2)(2n-3)}{2} \cdot 2n(2n-2)(2n-4)! = \frac{(2n)!}{2} \cdot \frac{2n-2}{2n-1}$. Since $\frac{2n-2}{2n-1} < 1$ for $n \ge 1$, the sum is strictly less than $\frac{(2n)!}{2}$.","A permutation $\{x_1, \ldots, x_{2n}\}$ of the set $\{1,2, \ldots, 2n\}$ where $n$ is a positive integer, is said to have property $T$ if $|x_i - x_{i + 1}| = n$ for at least one $i \in \{1,2, \ldots, 2n - 1\}$. Show that, for each $n$, there are more permutations with property $T$ than without.","Let $F$ be the set of permutations with property $T$, so $F = \bigcup_{i=1}^{2n-1} F_i$. By a Bonferroni inequality, $|F| \ge \sum_{i=1}^{2n-1} |F_i| - \sum_{1 \le i < j \le 2n-1} |F_i \cap F_j|$. From sub-problem 1, the first sum is $(2n)!$. From sub-problem 2, the second sum is strictly less than $\frac{(2n)!}{2}$. Therefore, $|F| > (2n)! - \frac{(2n)!}{2} = \frac{(2n)!}{2}$. As the total number of permutations is $(2n)!$, this proves that more than half of the permutations have property $T$.",,
1988p4,"Show that the solution set of the inequality

$\sum_{k=1}^{70}\frac{k}{x-k}\ge\frac{5}{4}$

is a union of disjoint intervals, the sum of whose length is $1988$.","Consider the graph of $f(x)=\sum_{k=1}^{70}\frac{k}{x-k}\ge\frac{5}{4}$. On the values of $x$ between $n$ and $n+1$ for $n\in\mathbb{N}$ $1\le n\le 69$, the terms of the form $\frac{k}{x-k}$ for $k\ne n,n+1$ have a finite range. In contrast, the term $\frac{n}{x-n}$ has an infinite range, from $+\infty$ to $n$. Similarly, the term $\frac{n+1}{x-n-1}$ has infinite range from $-n-1$ to $-\infty$. Thus, since the two undefined values occur at the distinct endpoints, we can deduce that $f(x)$ takes on all values between $+\infty$ and $-\infty$ for $x\in(n,n+1)$. Thus, by the Intermediate Value Theorem, we are garunteed a $n<r_n<n+1$ such that $f(r_n)=\frac{5}{4}$. Additionally, we have that for $x>70$, the value of $f(x)$ goes from $+\infty$ to $0$, since as $x$ increases, all the terms go to $0$. Thus, there exists some $r_{70}>70$ such that $f(r_{70})=\frac{5}{4}$ and so $f(x)\ge\frac{5}{4}$ for $x\in(70,r_{70})$.

So, we have $70$ $r_i$ such that $f(r_i)=\frac{5}{4}$. There are obviously no other such $r_i$ since $f(x)=\frac{5}{4}$ yields a polynomial of degree $70$ when combining fractions. Thus, we have that the solution set to the inequality $f(x)\ge\frac{5}{4}$ is the union of the intervals $(n,r_n]$ (since if $f(x)<\frac{5}{4}$ for $x\in(n,r_n)$ then there would exist another solution to the equation $f(x)=\frac{5}{4}$.

Thus we have proven that the solution set is the union of disjoint intervals. Now we are to prove that the sum of their lengths is $1988$.

The sum of their lengths is $r_1+r_2+\cdots+r_{70}-(1+2+\cdots+70)=r_1+r_2+\cdots+r_{70}-35\cdot71$. We have that the equation $f(x)=\frac{5}{4}$ yields a polynomial with roots $r_i$. Thus, opposite of the coeficient of $x^{69}$ divided by the leading coefficient is the sum of the $r_i$. It is easy to see that the coefficient of $x^{69}$ is $-5(1+2+\cdots+70)-4(1+2+\cdots+70)=-9\cdot35\cdot 71$. Thus, since the leading coefficient is $5$ we have $r_1+r_2+\cdots+r_{70}=9\cdot7\cdot71$. Thus, the sum of the lengths of the intervals is $63\cdot71-35\cdot71=28\cdot71=1988$ as desired.",3,"Let $f(x)=\sum_{k=1}^{70}\frac{k}{x-k}$. Show that the solution set of the inequality $f(x) \\ge \frac{5}{4}$ is a union of 70 disjoint intervals, $(k, r_k]$ for $k=1, \\dots, 70$, where $r_k$ are the roots of the equation $f(x) = \frac{5}{4}$.","The function $f(x)$ has vertical asymptotes at $x=k$ for $k=1, \\dots, 70$. The derivative $f'(x) = -\\sum_{k=1}^{70}\frac{k}{(x-k)^2}$ is always negative, so $f(x)$ is strictly decreasing on each interval where it is defined. For each $k \\in \\{1, \\dots, 69\\}$, on the interval $(k, k+1)$, $f(x)$ decreases from $+\\infty$ to $-\\infty$. On $(70, \\infty)$, $f(x)$ decreases from $+\\infty$ to $0$. By the Intermediate Value Theorem, the equation $f(x) = 5/4$ must have exactly one root, $r_k$, in each of the 70 intervals $(k, k+1)$ for $k=1,...,69$ and $(70, \\infty)$. Since $f(x)$ is decreasing, the inequality $f(x) \\ge 5/4$ holds on the union of the 70 disjoint intervals $(k, r_k]$ for $k=1, \\dots, 70$.","Let $r_1, r_2, \\ldots, r_{70}$ be the roots of the equation $\\sum_{k=1}^{70}\frac{k}{x-k} = \frac{5}{4}$. Find the sum of these roots, $\\sum_{k=1}^{70} r_k$.","Clearing denominators, the equation becomes $4 \\sum_{k=1}^{70} k \\prod_{j \ne k} (x-j) = 5 \\prod_{j=1}^{70} (x-j)$. This can be rearranged into a polynomial equation $P(x) = 5 \\prod_{j=1}^{70} (x-j) - 4 \\sum_{k=1}^{70} k \\prod_{j \ne k} (x-j) = 0$. This is a polynomial of degree 70. The coefficient of $x^{70}$ is $5$. The coefficient of $x^{69}$ is $5(-\\sum_{j=1}^{70} j) - 4(\\sum_{k=1}^{70} k) = -9 \\sum_{k=1}^{70} k$. By Vieta's formulas, the sum of the roots is $\\sum_{k=1}^{70} r_k = - \frac{-9 \\sum_{k=1}^{70} k}{5} = \frac{9}{5} \\sum_{k=1}^{70} k = \frac{9}{5} \frac{70 \\cdot 71}{2} = 4473$.","Show that the solution set of the inequality\n\n$\\sum_{k=1}^{70}\frac{k}{x-k}\\ge\frac{5}{4}$\n\nis a union of disjoint intervals, the sum of whose length is $1988$.","From the first part, the solution set is a union of disjoint intervals $\bigcup_{k=1}^{70} (k, r_k]$. The total length of these intervals is $L = \\sum_{k=1}^{70} (r_k - k) = (\\sum_{k=1}^{70} r_k) - (\\sum_{k=1}^{70} k)$. From the second part, the sum of the roots is $\\sum_{k=1}^{70} r_k = 4473$. The sum of the first 70 integers is $\\sum_{k=1}^{70} k = \frac{70 \\cdot 71}{2} = 2485$. Therefore, the sum of the lengths is $L = 4473 - 2485 = 1988$.",,
1988p5,"In a right-angled triangle $ABC$ let $AD$ be the altitude drawn to the hypotenuse and let the straight line joining the incentres of the triangles $ABD, ACD$ intersect the sides $AB, AC$ at the points $K,L$ respectively. If $E$ and $E_1$ dnote the areas of triangles $ABC$ and $AKL$ respectively, show that\[\frac {E}{E_1} \geq 2.\]","Lemma: Through the incenter $I$ of $\triangle{ABC}$ draw a line that meets the sides $AB$ and $AC$ at $P$ and $Q$, then:\[\frac{AB}{AP} \cdot AC + \frac{AC}{AQ} \cdot AB = AB+BC+AC\]Proof of the lemma: Consider the general case: $M$ is any point on side $BC$ and $PQ$ is a line cutting AB, AM, AC at P, N, Q. Then:

$\frac{AM}{AN}=\frac{S_{APMQ}}{\triangle{APQ}}=\frac{\triangle{APM}+\triangle{AQM}}{\triangle{PQA}}=\frac{\frac{AP}{AB}\triangle{ABM}+\frac{AQ}{AC}\triangle{ACM}}{\frac{AP\cdot AQ}{AB \cdot AC}}=$

$=\frac{AC}{AQ}\cdot \frac{BM}{BC}+\frac{AB}{AP}\cdot \frac{CM}{BC}$

If $N$ is the incentre then $\frac{AM}{AN}=\frac{AB+BC+CA}{AB+AC}$, $\frac{BM}{BC}=\frac{AB}{AB+AC}$ and $\frac{CM}{BC}=\frac{AC}{AC+AB}$. Plug them in we get:\[\frac{AB}{AP} \cdot AC + \frac{AC}{AQ} \cdot AB = AB+BC+AC\]

Back to the problem Let $I_1$ and $I_2$ be the areas of $\triangle{ABD}$ and $\triangle{ACD}$ and $E$ be the intersection of $KL$ and $AD$. Thus apply our formula in the two triangles we get:\[\frac{AD}{AE} \cdot AB + \frac{AB}{AK} \cdot AD = AB+BD+AD\]and\[\frac{AD}{AE} \cdot AC + \frac{AC}{AL} \cdot AD = AC+CD+AD\]Cancel out the term $\frac{AD}{AE}$, we get:\[\frac{AB+BD+AD-\frac{AB}{AK} \cdot AD }{AC+CD+AD- \frac{AC}{AL} \cdot AD }=\frac{AB}{AC}\]\[AB \cdot CD + AB \cdot AD - \frac{AB \cdot AC \cdot AD}{AL}=AC \cdot BD+ AC \cdot AD -\frac{AB \cdot AC \cdot AD}{AK}\]\[AB+AB \cdot \frac{CD}{AD}-\frac{AB \cdot AC}{AL}=AC+ AC \cdot \frac{BD}{AD} - \frac{AB \cdot AC}{AK}\]\[AB+AC - \frac{AB \cdot AC}{AL}=AB+AC - \frac{AB \cdot AC}{AK}\]\[\frac{AB \cdot AC}{AK} = \frac{AB \cdot AC}{AL}\]So we conclude $AK=AL$.

Hence $\angle{AKI_1}=45^o=\angle{ADI_1}$ and $\angle{ALI_2}=45^o=\angle{ADI_2}$, thus $\triangle{AK_1} \cong \triangle{ADI_1}$ and $\triangle{ALI_2} \cong \triangle{ADI_2}$. Thus $AK=AD=AL$. So the area ratio is:\[\frac{E}{E_1}=\frac{AB \cdot AC}{AD^2} = \frac{BC}{AD} =\frac{BD+CD}{\sqrt{BD \cdot CD}}\geq 2\]",2,"In a right-angled triangle $ABC$ with the right angle at $A$, let $AD$ be the altitude to the hypotenuse $BC$. Let the line joining the incentres $I_1, I_2$ of the triangles $ABD, ACD$ intersect the sides $AB, AC$ at the points $K,L$ respectively. Show that $AK=AD=AL$.","Let $E$ be the intersection of the line $KL$ and the altitude $AD$. A known property for a line passing through the incenter of a triangle, when applied to $\triangle ABD$ (with incenter $I_1$) and $\triangle ACD$ (with incenter $I_2$), yields two equations:
$\frac{AB}{AK} \cdot AD + \frac{AD}{AE} \cdot AB = AB+BD+AD$
$\frac{AC}{AL} \cdot AD + \frac{AD}{AE} \cdot AC = AC+CD+AD$
By eliminating the term containing $AE$ and simplifying using identities for right-angled triangles (such as $AC \cdot BD - AB \cdot CD = AD(AB-AC)$), we deduce that $AK=AL$. Since $\angle BAC = 90^\circ$, $\triangle AKL$ is an isosceles right-angled triangle, which implies $\angle AKL = 45^\circ$. In the right-angled $\triangle ABD$, the bisector of $\angle ADB$ is $DI_1$, so $\angle ADI_1 = 45^\circ$. Now consider $\triangle AKD$. Since $AI_1$ is the angle bisector of $\angle KAD$, we have $\angle KAI_1 = \angle DAI_1$. With $\angle AKI_1 = \angle AKL = 45^\circ$ and $\angle ADI_1 = 45^\circ$, and the common side $AI_1$, we find $\triangle AKI_1 \cong \triangle ADI_1$ by AAS congruence. Therefore, $AK=AD$. Combined with $AK=AL$, we have $AK=AD=AL$.","In a right-angled triangle $ABC$ let $AD$ be the altitude drawn to the hypotenuse and let the straight line joining the incentres of the triangles $ABD, ACD$ intersect the sides $AB, AC$ at the points $K,L$ respectively. If $E$ and $E_1$ dnote the areas of triangles $ABC$ and $AKL$ respectively, show that\[\frac {E}{E_1} \geq 2.\]","From the result of the previous sub-problem, we have $AK=AL=AD$. The area of $\triangle ABC$ is $E = \frac{1}{2}AB \cdot AC$. The area of $\triangle AKL$ is $E_1 = \frac{1}{2}AK \cdot AL = \frac{1}{2}AD^2$. The ratio of the areas is $\frac{E}{E_1} = \frac{\frac{1}{2}AB \cdot AC}{\frac{1}{2}AD^2} = \frac{AB \cdot AC}{AD^2}$. In a right-angled triangle, we have the geometric relations $AB \cdot AC = BC \cdot AD$ and $AD^2 = BD \cdot CD$. Substituting these into the ratio expression gives: \[\frac{E}{E_1} = \frac{BC \cdot AD}{AD^2} = \frac{BC}{AD} = \frac{BD+CD}{\sqrt{BD \cdot CD}}.\]By the Arithmetic Mean-Geometric Mean (AM-GM) inequality, $BD+CD \geq 2\sqrt{BD \cdot CD}$. Therefore, \[\frac{E}{E_1} \geq \frac{2\sqrt{BD \cdot CD}}{\sqrt{BD \cdot CD}} = 2.\]",,,,
1988p6,Let $a$ and $b$ be positive integers such that $ab + 1$ divides $a^{2} + b^{2}$. Show that $\frac {a^{2} + b^{2}}{ab + 1}$ is the square of an integer.,"Choose integers $a,b,k$ such that $a^2+b^2=k(ab+1)$ Now, for fixed $k$, out of all pairs $(a,b)$ choose the one with the lowest value of $\min(a,b)$. Label $b'=\min(a,b), a'=\max(a,b)$. Thus, $a'^2-kb'a'+b'^2-k=0$ is a quadratic in $a'$. Should there be another root, $c'$, the root would satisfy: $b'c'\leq a'c'=b'^2-k<b'^2\implies c'<b'$ Thus, $c'$ isn't a positive integer (if it were, it would contradict the minimality condition). But $c'=kb'-a'$, so $c'$ is an integer; hence, $c'\leq 0$. In addition, $(a'+1)(c'+1)=a'c'+a'+c'+1=b'^2-k+b'k+1=b'^2+(b'-1)k+1\geq 1$ so that $c'>-1$. We conclude that $c'=0$ so that $b'^2=k$.

This construction works whenever there exists a solution $(a,b)$ for a fixed $k$, hence $k$ is always a perfect square.",2,"Let $k = \frac{a^2+b^2}{ab+1}$ be a positive integer for some positive integers $a, b$. Among all pairs of positive integers $(x,y)$ for which $\frac{x^2+y^2}{xy+1}=k$, let $(a,b)$ be one that minimizes the sum $x+y$, with $a \ge b$. Show that the quadratic equation $x^2 - kbx + (b^2-k)=0$, which has $a$ as a root, must have $0$ as its other root.","Let the quadratic be $f(x)=x^2 - kbx + (b^2-k)$. Since $(a,b)$ is a solution to the original problem, $a^2-kba+b^2-k=0$, so $a$ is a root of $f(x)=0$. Let the other root be $x_2$. By Vieta's formulas, $x_2 = kb-a$, which means $x_2$ is an integer. If $x_2>0$, then $(x_2, b)$ is another solution pair. But $x_2 = \frac{b^2-k}{a} < \frac{b^2}{a} \le \frac{a^2}{a} = a$. Thus $x_2+b < a+b$, contradicting the minimality of $(a,b)$. So we must have $x_2 \le 0$. Now, consider $f(-1) = (-1)^2-kb(-1)+b^2-k = 1+kb+b^2-k = b^2+1+k(b-1)$. Since $b\ge 1$ and $k>0$, $f(-1)>0$. As $f(x)$ is an upward-opening parabola with a positive root $a$, the other root $x_2$ must be greater than $-1$. The only integer satisfying $x_2 \le 0$ and $x_2 > -1$ is $x_2=0$.",Let $a$ and $b$ be positive integers such that $ab + 1$ divides $a^{2} + b^{2}$. Show that $\frac {a^{2} + b^{2}}{ab + 1}$ is the square of an integer.,"Let $k = \frac{a^2+b^2}{ab+1}$. We are given that $k$ is an integer. Let $(a,b)$ be a pair of positive integers satisfying this equation for which the sum $a+b$ is minimal, and assume $a \ge b$. From the first sub-problem, we know that for this minimal pair, the quadratic equation $x^2 - kbx + (b^2 - k) = 0$ has roots $a$ and $0$. By Vieta's formulas, the product of the roots is given by $a \cdot 0 = b^2-k$. This implies $b^2-k=0$, or $k=b^2$. Since $b$ is an integer, $k$ is the square of an integer.",,,,
1987p1,"Let $p_n (k)$ be the number of permutations of the set $\{ 1, \ldots , n \} , \; n \ge 1$, which have exactly $k$ fixed points. Prove that

$\sum_{k=0}^{n} k \cdot p_n (k) = n!$.

(Remark: A permutation $f$ of a set $S$ is a one-to-one mapping of $S$ onto itself. An element $i$ in $S$ is called a fixed point of the permutation $f$ if $f(i) = i$.)","The sum in question simply counts the total number of fixed points in all permutations of the set. But for any element $i$ of the set, there are $(n-1)!$ permutations which have $i$ as a fixed point. Therefore

$\sum_{k=0}^{n} k \cdot p_n (k) = n!$,

as desired.

Slightly Clearer Solution

For any $k$, if there are $p_n(k)$ permutations that have $k$ fixed points, then we know that each fixed point is counted once in the product $k \cdot p_n{k}$. Therefore the given sum is simply the number of fixed points among all permutations of $\{ 1, \ldots , n \}$. However, if we take any $x$ such that $1 \le x \le n$ and $x$ is a fixed point, there are $(n-1)!$ ways to arrange the other numbers in the set. Therefore our desired sum becomes $n \cdot (n-1)! = n!$, so we are done.",2,"Let $S_n$ be the set of all permutations of $\{1, \\ldots, n\}$. Show that the sum $S = \\sum_{k=0}^{n} k \\cdot p_n (k)$ represents the total number of fixed points over all permutations in $S_n$.",The term $p_n(k)$ is the number of permutations that have exactly $k$ fixed points. The product $k \\cdot p_n(k)$ therefore counts the total number of fixed points contributed by this specific group of permutations. Summing this product over all possible values of $k$ (from 0 to $n$) gives the grand total of all fixed points across all permutations in $S_n$.,"Let $p_n (k)$ be the number of permutations of the set $\{ 1, \\ldots , n \\}$, which have exactly $k$ fixed points. Prove that $\\sum_{k=0}^{n} k \\cdot p_n (k) = n!$.","The sum represents the total number of fixed points over all permutations. We can also count this total by summing, for each element $i \\in \\{1, \\ldots, n\\}$, the number of permutations that fix $i$. For any specific element $i$, the number of permutations that fix $i$ is $(n-1)!$, as the remaining $n-1$ elements can be permuted freely. Since there are $n$ choices for the element $i$ to be fixed, the total count of fixed points is $n \times (n-1)! = n!$.",,,,
1987p2,"In an acute-angled triangle $ABC$ the interior bisector of the angle $A$ intersects $BC$ at $L$ and intersects the circumcircle of $ABC$ again at $N$. From point $L$ perpendiculars are drawn to $AB$ and $AC$, the feet of these perpendiculars being $K$ and $M$ respectively. Prove that the quadrilateral $AKNM$ and the triangle $ABC$ have equal areas.","We are to prove that $[AKNM]=[ABC]$ or equivilently, $[ABC]+[BNC]-[KNC]-[BMN]=[ABC]$. Thus, we are to prove that $[BNC]=[KNC]+[BMN]$. It is clear that since $\angle BAN=\angle NAC$, the segments $BN$ and $NC$ are equal. Thus, we have $[BNC]=\frac{1}{2}BN^2\sin BNC=\frac{1}{2}BN^2\sin A$ since cyclic quadrilateral $ABNC$ gives $\angle BNC=180-\angle A$. Thus, we are to prove that

$\frac{1}{2}BN^2\sin A=[KNC]+[BMN]$

$\Leftrightarrow \frac{1}{2}BN^2\sin A=\frac{1}{2}CN\cdot CK\sin NCA+\frac{1}{2}BN\cdot BM\sin NBA$

$\Leftrightarrow BN\sin A=CK\sin NCA+BM\sin NBA$

From the fact that $\angle BNC=180-\angle A$ and that $BNC$ is iscoceles, we find that $\angle NBC=\angle NCB=\frac{1}{2}A$. So, we have $BN\cos\frac{1}{2}A=\frac{1}{2}BC\Rightarrow BN=\frac{BC}{2\cos \frac{1}{2}A}$. So we are to prove that

$\frac{BC\sin A}{2\cos \frac{1}{2}A}=CK\sin NCA+BM\sin NBA$

$\Leftrightarrow BC\sin \frac{1}{2}A=CK\sin (C+ \frac{1}{2}A)+BM\sin (C+ \frac{1}{2}A)$

$\Leftrightarrow BC=CK(\sin C\cot\frac{1}{2}A+\cos C)+BM(\sin B\cot\frac{1}{2}A+\cos B)$

We have $\sin C=\frac{KL}{CL}$,$\cos C=\frac{CK}{CL}$, $\cot\frac{1}{2}A=\frac{AK}{KL}=\frac{AM}{LM}$, $\sin B=\frac{LM}{BL}$,$\cos B=\frac{BM}{ML}$, and so we are to prove that

$BC=CK(\frac{KL}{CL}\frac{AK}{KL})+\frac{CK}{CL})+BM(\frac{LM}{BL}\frac{AM}{LM}+\frac{BM}{ML})$

$\Leftrightarrow BC=CK(\frac{AK}{CL}+\frac{CK}{CL})+BM(\frac{AM}{BL}+\frac{BM}{ML})$

$\Leftrightarrow BC=\frac{CK\cdot AC}{CL}+\frac{BM\cdot AB}{BL}$

$\Leftrightarrow BC=AC\cos C+AB\cos B$

We shall show that this is true: Let the altitude from $A$ touch $BC$ at $A^\prime$. Then it is obvious that $AC\cos C=CA^\prime$ and $AB\cos B=A^\prime B$ and thus $AC\cos C+AB\cos B=BC$.

Thus we have proven that $[AKNM]=[ABC]$.",2,Show that the area equality $[AKNM] = [ABC]$ is equivalent to the projection formula $BC = AB \cos B + AC \cos C$.,"The proof first establishes that the area equality $[AKNM]=[ABC]$ is equivalent to the relation $[BNC]=[KNC]+[BMN]$. This second relation is expressed using trigonometry: $\frac{1}{2}BN^2\sin(\angle BNC) = \frac{1}{2}CN \cdot CK\sin(\angle KCN)+\frac{1}{2}BN \cdot BM\sin(\angle MBN)$. Since $AN$ is an angle bisector meeting the circumcircle at $N$, we have $BN=CN$, $\angle BNC = 180^\circ - A$, and $\angle NBC = \angle NCB = A/2$. The equation simplifies to $BN \sin A = CK \sin(C+A/2) + BM \sin(B+A/2)$. Using the sine rule in $\triangle BNC$, we have $BN=\frac{BC}{2\cos(A/2)}$. Substituting this, expanding the sine terms, and replacing trigonometric functions with ratios of lengths from the right-angled triangles $\triangle BKL$, $\triangle CLM$, and $\triangle AKL$ shows this is equivalent to $BC=AC\cos C+AB\cos B$.","In an acute-angled triangle $ABC$ the interior bisector of the angle $A$ intersects $BC$ at $L$ and intersects the circumcircle of $ABC$ again at $N$. From point $L$ perpendiculars are drawn to $AB$ and $AC$, the feet of these perpendiculars being $K$ and $M$ respectively. Prove that the quadrilateral $AKNM$ and the triangle $ABC$ have equal areas.","Let $A'$ be the foot of the altitude from vertex $A$ to the side $BC$. Since $\triangle ABC$ is acute-angled, $A'$ lies between $B$ and $C$. In the right-angled triangle $AA'B$, we have $A'B = AB \cos B$. In the right-angled triangle $AA'C$, we have $A'C = AC \cos C$. Therefore, $BC = A'B + A'C = AB \cos B + AC \cos C$. As established in the first sub-problem, this identity is equivalent to the area equality $[AKNM] = [ABC]$. Thus, the quadrilateral $AKNM$ and the triangle $ABC$ have equal areas.",,,,
1987p3,"Let $x_1 , x_2 , \ldots , x_n$ be real numbers satisfying $x_1^2 + x_2^2 + \cdots + x_n^2 = 1$. Prove that for every integer $k \ge 2$ there are integers $a_1, a_2, \ldots a_n$, not all 0, such that $| a_i | \le k-1$ for all $i$ and

$|a_1x_1 + a_2x_2 + \cdots + a_nx_n| \le \frac{ (k-1) \sqrt{n} }{ k^n - 1 }$.","We first note that by the Power Mean Inequality, $\sum_{i=1}^{n} x_i \le \sqrt{n}$. Therefore all sums of the form $\sum_{i=1}^{n} b_i x_i$, where the $b_i$ is a non-negative integer less than $k$, fall in the interval $[ 0 , (k-1)\sqrt{n} ]$. We may partition this interval into $k^n - 1$ subintervals of length $\frac{ (k-1)\sqrt{n} }{k^n - 1}$. But since there are $k^n$ such sums, by the pigeonhole principle, two must fall into the same subinterval. It is easy to see that their difference will form a sum with the desired properties.",1,"Let $x_1 , x_2 , \ldots , x_n$ be real numbers satisfying $x_1^2 + x_2^2 + \cdots + x_n^2 = 1$. Prove that for every integer $k \ge 2$ there are integers $a_1, a_2, \ldots a_n$, not all 0, such that $| a_i | \le k-1$ for all $i$ and

$|a_1x_1 + a_2x_2 + \cdots + a_nx_n| \le \frac{ (k-1) \sqrt{n} }{ k^n - 1 }$.","We first note that by the Power Mean Inequality, $\sum_{i=1}^{n} x_i \le \sqrt{n}$. Therefore all sums of the form $\sum_{i=1}^{n} b_i x_i$, where the $b_i$ is a non-negative integer less than $k$, fall in the interval $[ 0 , (k-1)\sqrt{n} ]$. We may partition this interval into $k^n - 1$ subintervals of length $\frac{ (k-1)\sqrt{n} }{k^n - 1}$. But since there are $k^n$ such sums, by the pigeonhole principle, two must fall into the same subinterval. It is easy to see that their difference will form a sum with the desired properties.",,,,,,
1987p4,Prove that there is no function $f$ from the set of non-negative integers into itself such that $f(f(n)) = n + 1987$ for every $n$.,"We prove that if $f(f(n)) = n + k$ for all $n$, where $k$ is a fixed positive integer, then $k$ must be even. If $k = 2h$, then we may take $f(n) = n + h$.

Suppose $f(m) = n$ with $m \equiv n \mod k$. Then by an easy induction on $r$ we find $f(m + kr) = n + kr$, $f(n + kr) = m + k(r+1)$. We show this leads to a contradiction. Suppose $m < n$, so $n = m + ks$ for some $s > 0$. Then $f(n) = f(m + ks) = n + ks$. But $f(n) = m + k$, so $m = n + k(s - 1) \ge n$. Contradiction. So we must have $m \ge n$, so $m = n + ks$ for some $s \ge 0$. But now $f(m + k) = f(n + k(s+1)) = m + k(s + 2)$. But $f(m + k) = n + k$, so $n = m + k(s + 1) > n$. Contradiction.

So if $f(m) = n$, then $m$ and $n$ have different residues $\pmod k$. Suppose they have $r_1$ and $r_2$ respectively. Then the same induction shows that all sufficiently large $s \equiv r_1 \pmod k$ have $f(s) \equiv r_2 \pmod k$, and that all sufficiently large $s \equiv r_2 \pmod k$ have $f(s) \equiv r_1 \pmod k$. Hence if $m$ has a different residue $r \mod k$, then $f(m)$ cannot have residue $r_1$ or $r_2$. For if $f(m)$ had residue $r_1$, then the same argument would show that all sufficiently large numbers with residue $r_1$ had $f(m) \equiv r \pmod k$. Thus the residues form pairs, so that if a number is congruent to a particular residue, then $f$ of the number is congruent to the pair of the residue. But this is impossible for $k$ odd.",3,"Let $f$ be a function from the set of non-negative integers into itself such that $f(f(n)) = n + k$ for some fixed positive integer $k$. Prove that if $f(m)=n$, then $m$ and $n$ cannot have the same residue modulo $k$.","Assume for contradiction that $m \equiv n \pmod k$. Since $f$ is injective ($f(a)=f(b) \implies a+k=b+k \implies a=b$), we must have $m \neq n$. So, we can write $n = m+ks$ or $m = n+ks$ for some positive integer $s$. Assume $n=m+ks$. An induction shows $f(x+kr) = f(x)+kr$ for any integer $r \ge 1$. The base case $r=1$ holds since $f(x+k) = f(f(f(x))) = f(x)+k$. Using this property, $f(n) = f(m+ks) = f(m)+ks = n+ks$. But by definition, $f(n) = f(f(m)) = m+k$. Equating the two expressions for $f(n)$ gives $m+k = n+ks$. Substituting $n=m+ks$, we get $m+k = (m+ks)+ks = m+2ks$. This implies $k=2ks$, so $1=2s$, which is impossible for an integer $s$. A similar contradiction arises if we assume $m=n+ks$. Therefore, $m \not\equiv n \pmod k$.","Let $f$ be a function from the set of non-negative integers into itself such that $f(f(n)) = n + k$ for a fixed positive integer $k$. Show that $f$ induces a permutation on the set of residues modulo $k$, $Z_k = \{0, 1, \dots, k-1\}$, which consists entirely of disjoint 2-cycles (pairs).","For any $n$, $f(n+k) = f(f(f(n))) = f(n)+k$. This implies that if $n_1 \equiv n_2 \pmod k$, then $f(n_1) \equiv f(n_2) \pmod k$. Thus, $f$ induces a well-defined map $\pi$ on the residues $Z_k$. From $f(f(n)) = n+k \equiv n \pmod k$, it follows that $\pi(\pi(r)) = r$ for any residue $r \in Z_k$. This means $\pi$ is a permutation of $Z_k$ which is its own inverse. Such a permutation can be decomposed into disjoint cycles of length 1 (fixed points) and 2 (transpositions). A fixed point would mean $\pi(r)=r$ for some $r$. This would imply that for an integer $n \equiv r \pmod k$, we have $f(n) \equiv r \pmod k$. This contradicts the result from Sub-problem 1. Therefore, $\pi$ has no fixed points and must be composed entirely of disjoint 2-cycles.",Prove that there is no function $f$ from the set of non-negative integers into itself such that $f(f(n)) = n + 1987$ for every $n$.,"Let $k=1987$. Suppose such a function $f$ exists. According to Sub-problem 2, this function must induce a permutation on the set of residues modulo 1987, $Z_{1987} = \{0, 1, \dots, 1986\}$, which consists entirely of disjoint 2-cycles. For the set $Z_{1987}$ to be partitioned into disjoint pairs (2-cycles), the total number of elements in the set must be even. The size of $Z_{1987}$ is $k=1987$, which is an odd number. An odd number of elements cannot be partitioned into pairs. This is a contradiction, so no such function $f$ can exist.",,
1987p5,Let $n$ be an integer greater than or equal to 3. Prove that there is a set of $n$ points in the plane such that the distance between any two points is irrational and each set of three points determines a non-degenerate triangle with rational area.,"Consider the set of points $S = \{ (x,x^2) \mid 1 \le x \le n , x \in \mathbb{N} \}$ in the $xy$-plane.


The distance between any two distinct points $(x_1,x^2_1)$ and $(x_2,x^2_2)$ in $S$ (with $x_1 \neq x_2$) is:

$d = \sqrt{(x_1-x_2)^2+\left(x^2_1-x^2_2\right)^2} =$ $\sqrt{(x_1-x_2)^2+(x_1-x_2)^2(x_1+x_2)^2} = |x_1-x_2|\sqrt{1+(x_1+x_2)^2}$.

Since $1+(x_1+x_2)^2$ is an integer and not a perfect square, $\sqrt{1+(x_1+x_2)^2}$ is irrational. Since $|x_1-x_2|$ is a non-zero integer, $d$ is irrational as desired.


All the points in $S$ lie on the parabola $y = x^2$. Thus, it is impossible of any set of three points to be collinear, since no line can intersect a parabola at more than two points. Therefore, any triangle with all vertices in $S$ must be non-degenerate as desired.


Since all the points in $S$ are lattice points, by Pick's Theorem, the area of any triangle with all vertices in $S$ must be in the form $A = I + \dfrac{B}{2} - 1$ where $I$ and $B$ are integers. Thus, the area of the triangle must be rational as desired.",2,"Let $n \ge 3$ be an integer. Consider the set of points $S = \{ (k, k^2) \mid k=1, 2, \dots, n \}$. Prove that the distance between any two distinct points in $S$ is irrational, and that no three points in $S$ are collinear.","The distance between two distinct points $(x_1, x_1^2)$ and $(x_2, x_2^2)$ in $S$ is $d = \sqrt{(x_1-x_2)^2 + (x_1^2 - x_2^2)^2} = |x_1-x_2|\sqrt{1+(x_1+x_2)^2}$. Since $x_1, x_2$ are distinct integers, $x_1+x_2$ is an integer, and $1+(x_1+x_2)^2$ is an integer that is not a perfect square. Thus, its square root is irrational. The product of a non-zero integer and an irrational number is irrational. All points in $S$ lie on the parabola $y=x^2$. A line can intersect a parabola at most at two points, so no three points in $S$ can be collinear.",Let $n$ be an integer greater than or equal to 3. Prove that there is a set of $n$ points in the plane such that the distance between any two points is irrational and each set of three points determines a non-degenerate triangle with rational area.,"Consider the set of points $S = \{ (k, k^2) \mid k=1, 2, \dots, n \}$. From the previous sub-problem, the distance between any two points in $S$ is irrational, and no three points are collinear, which implies they form a non-degenerate triangle. All points in $S$ have integer coordinates (they are lattice points). By Pick's Theorem, the area of a triangle with lattice point vertices is $A = I + B/2 - 1$, where $I$ is the number of interior lattice points and $B$ is the number of boundary lattice points. Since $I$ and $B$ are integers, the area $A$ must be a rational number. Thus, the set $S$ satisfies all the required conditions.",,,,
1987p6,"Let $n$ be an integer greater than or equal to 2. Prove that if $k^2 + k + n$ is prime for all integers $k$ such that $0 \leq k \leq \sqrt{n/3}$, then $k^2 + k + n$ is prime for all integers $k$ such that $0 \leq k \leq n - 2$.","First observe that if $m$ is relatively prime to $b+1$, $b+2$, $\cdots$, $2b$, then $m$ is relatively prime to any number less than $2b$. Since if $c\leq b$, then we can choose some $i$ to make $2^ic$ lies in range $b+1,b+2,\cdots,2b$, so $2^ic$ is relatively prime to $m$. Hence $c$ is also. If we also have $(2b+1)^2>m$, then we can conclude that $m$ is a prime. Since there must be a factor of $m$ less than $\sqrt{m}$.

Let $n=3r^2+h$ where $0\leq h<6r+3$, so $r$ is the greatest integer less than or equal to $\sqrt{n/3}$.(to see this, just let $r=\lfloor\sqrt{n/3}\rfloor$, then we can write $n=3(r+\epsilon)^2(0\leq\epsilon< 1)$, so $h=6r\epsilon+3\epsilon^2\leq 6r+3$).

Assume that $n+k(k+1)$ is prime for $k=1,2,3\cdots,r$. We show that $N=n+(r+s)(r+s+1)$ is prime for $s=0,1,2,\cdots,n-r-2$. By our observation above, it is sufficient to show that $(2s+2r+t)^2>N$ and $N$ is relatively prime to all of $r+s+1,r+s+2,\cdots,2r+2s$. We have $(2r+2s+1)^2=4r^2+4s^2+8rs+4r+4s+1$. Since $s,t\ge1$, we have $4s+1>s+2$, $4s^2>s^2$ and $6rs>3r$. Hence\[(2s+2r+1)^2>4r^2+2rs+s^2+7r+s+2=3r^2+6r+2+(r+s)(r+s+1)\ge N\]Now if $N$ has a factor which divides $2r-i$ in the range $-2s$ to $r-s-1$, then so does $N-(i+2s+1)(2r-i)=n+(r-i-s-1)(r-i-s)$ which have the form $n+s'(s'+1)$ with $s'$ in range $0$ to $r$.",2,"Prove the following primality criterion: Let $m$ be an odd integer greater than 1. If for some integer $b \ge 1$, we have $(2b+1)^2 > m$ and $\gcd(m, j) = 1$ for all integers $j$ such that $b+1 \le j \le 2b$, then $m$ is prime.","Assume $m$ is composite and let $p$ be its smallest prime factor. Then $p \le \sqrt{m}$. The condition $(2b+1)^2 > m$ implies $\sqrt{m} < 2b+1$, so $p \le 2b$. Since $m$ is odd, $p$ is an odd prime. If $b+1 \le p \le 2b$, then $\gcd(m, p) = p > 1$, contradicting the hypothesis. If $p \le b$, there exists an integer $i \ge 0$ such that $b+1 \le 2^i p \le 2b$. To see this, note that repeated multiplication of $p$ by 2 will eventually yield a number greater than $b$. Let $2^{i-1}p \le b$ and $2^i p > b$. Then $2^i p \le 2b$. Let $j = 2^i p$. Since $p|m$ and $p|j$, we have $\gcd(m, j) \ge p > 1$, which again contradicts the hypothesis. Thus, $m$ cannot be composite and must be prime.","Let $n$ be an integer greater than or equal to 2. Prove that if $k^2 + k + n$ is prime for all integers $k$ such that $0 \leq k \leq \sqrt{n/3}$, then $k^2 + k + n$ is prime for all integers $k$ such that $0 \leq k \leq n - 2$.","Let $P_k = k^2+k+n$ and $r = \lfloor \sqrt{n/3} \rfloor$. By hypothesis, $P_k$ is prime for $0 \le k \le r$. We prove by strong induction that $P_k$ is prime for $r < k \le n-2$. Assume $P_i$ is prime for all $0 \le i < k$. We use the criterion from sub-problem 1 to prove $P_k$ is prime, with $m=P_k$ and $b=k$. Note $P_k$ is odd for prime $n>2$ (if $n=2$, the statement is trivial). We verify the two conditions:
1. $(2k+1)^2 > P_k$: This is equivalent to $3k^2+3k+1 > n$. Since $k > r$, we have $k \ge r+1$. Also, by definition of floor, $r+1 > \sqrt{n/3}$, so $(r+1)^2 > n/3$, which implies $3(r+1)^2 > n$. As $k \ge r+1$, we have $3k^2+3k+1 > 3k^2 \ge 3(r+1)^2 > n$. The condition holds.
2. $\gcd(P_k, j) = 1$ for $k+1 \le j \le 2k$: Let $j=k+a$ with $1 \le a \le k$. Let $d=\gcd(P_k, j)$. From $k \equiv -a \pmod d$, it follows that $d$ divides $P_{a-1} = (a-1)^2+(a-1)+n$. Let $k'=a-1$, so $0 \le k' \le k-1$. By the induction hypothesis, $P_{k'}$ is prime. Thus $d=1$ or $d=P_{k'}$. If $d=P_{k'}$, then $P_{k'} | j$, so $P_{k'} \le j$. This means $k'^2+k'+n \le k+k'+1$, or $k'^2+n-1 \le k$. However, for $k \le n-2$ and $k' \ge 0$, we have $k \le n-2 < n-1 \le k'^2+n-1$. This is a contradiction. Thus, $d$ must be 1.
Both conditions hold, so $P_k$ is prime. By induction, the statement is proven.",,,,
1986p1,"Let $d$ be any positive integer not equal to $2, 5$ or $13$. Show that one can find distinct $a,b$ in the set $\{2,5,13,d\}$ such that $ab-1$ is not a perfect square.","Suppose $p^2=2d-1$, $q^2=5d-1$ and $r^2=13d-1$. From the first equation, $p$ is an odd integer. Let $p=2k-1$. We have $d=2k^2-2k+1$, which is an odd integer. Then $q^2$ and $r^2$ must be even integers, denoted by $4n^2$ and $4m^2$ respectively, and thus $r^2-q^2=4m^2-4n^2=8d$, from which\[2d=m^2-n^2=(m+n)(m-n)\]can be deduced. Since $m^2-n^2$ is even, $m$ and $n$ have the same parity, so $(m+n)(m-n)$ is divisible by $4$. It follows that the odd integer $d$ must be divisible by $2$, leading to a contradiction. We are done.",1,"Let $d$ be any positive integer not equal to $2, 5$ or $13$. Show that one can find distinct $a,b$ in the set $\{2,5,13,d\}$ such that $ab-1$ is not a perfect square.","Suppose $p^2=2d-1$, $q^2=5d-1$ and $r^2=13d-1$. From the first equation, $p$ is an odd integer. Let $p=2k-1$. We have $d=2k^2-2k+1$, which is an odd integer. Then $q^2$ and $r^2$ must be even integers, denoted by $4n^2$ and $4m^2$ respectively, and thus $r^2-q^2=4m^2-4n^2=8d$, from which\[2d=m^2-n^2=(m+n)(m-n)\]can be deduced. Since $m^2-n^2$ is even, $m$ and $n$ have the same parity, so $(m+n)(m-n)$ is divisible by $4$. It follows that the odd integer $d$ must be divisible by $2$, leading to a contradiction. We are done.",,,,,,
1986p2,"Given a point $P_0$ in the plane of the triangle $A_1A_2A_3$. Define $A_s=A_{s-3}$ for all $s\ge4$. Construct a set of points $P_1,P_2,P_3,...$ such that $P_{k+1}$ is the image of $P_k$ under a rotation center $A_{k+1}$ through an angle $120^\circ$ clockwise for $k=0,1,2,...$. Prove that if $P_{1986}=P_0$, then the triangle $A_1A_2A_3$ is equilateral.","Consider the triangle and the points on the complex plane. Without loss of generality, let $A_1=0$, $A_2=1$, and $A_3=a$ for some complex number $a$. Then, a rotation about $A_1$ of $120^\circ$ sends point $P$ to point $e^{\frac{4i\pi}{3}}P$. For $A_2$, the rotation sends $P$ to $e^{\frac{4i\pi}{3}}(P-1)+1$ and for $A_3$ the rotation sends $P$ to $e^{\frac{4i\pi}{3}}(P-a)+a$. Thus the result of all three rotations sends $P$ to

$e^{\frac{4i\pi}{3}}(e^{\frac{4i\pi}{3}}(e^{\frac{4i\pi}{3}}P-1)+1-a)+a$

$=P-e^{\frac{2i\pi}{3}}+e^{\frac{4i\pi}{3}}-ae^{\frac{4i\pi}{3}}+a$

$=P-i\sqrt{3}-ae^{\frac{4i\pi}{3}}+a$

Since the transformation $P\to P-i\sqrt{3}-ae^{\frac{4i\pi}{3}}+a$ occurs $1986/3=662$ times, to obtain $P_{1986}$. But, we have $P_{1986}=P_0$ and so we have

$P_0=P_0+662(-i\sqrt{3}-ae^{\frac{4i\pi}{3}}+a)$

$\Rightarrow -i\sqrt{3}-ae^{\frac{4i\pi}{3}}+a=0$

$\Rightarrow a(-e^{\frac{4i\pi}{3}}+1)=i\sqrt{3}$

$\Rightarrow a=\frac{i\sqrt{3}}{-e^{\frac{4i\pi}{3}}+1}$

$\Rightarrow a=\frac{1}{2}+i\frac{\sqrt{3}}{2}$

Now it is clear that the triangle $A_1A_2A_3$ is equilateral.",2,"Let the vertices of the triangle be $A_1, A_2, A_3$ and a point $P_0$ be represented by complex numbers. A sequence of points $P_k$ is generated by rotating $P_{k-1}$ about $A_k$ by an angle of $120^\circ$ clockwise. Show that the composition of the first three rotations, mapping $P_0$ to $P_3$, is a translation, and that the condition $P_{1986}=P_0$ implies that this translation is by a zero vector.","Let $\omega = e^{-2i\pi/3}$ represent the rotation. The transformation from a point $p$ to $p'$ by rotation about a center $c$ is $p' = \omega(p-c)+c$. The composite transformation for three steps ($p_0 \to p_3$) is $p_3 = \omega(\omega(\omega(p_0-a_1)+a_1-a_2)+a_2-a_3)+a_3$. Since $\omega^3=1$, this simplifies to $p_3 = p_0 + T$, where $T$ is a translation vector independent of $p_0$. This transformation is a translation. The transformation from $P_0$ to $P_{1986}$ consists of $1986/3 = 662$ such translations. Thus, $p_{1986} = p_0 + 662T$. The given condition $p_{1986}=p_0$ implies $662T=0$, so the translation vector $T$ must be zero.","Given a point $P_0$ in the plane of the triangle $A_1A_2A_3$. Define $A_s=A_{s-3}$ for all $s\ge4$. Construct a set of points $P_1,P_2,P_3,...$ such that $P_{k+1}$ is the image of $P_k$ under a rotation center $A_{k+1}$ through an angle $120^\circ$ clockwise for $k=0,1,2,...$. Prove that if $P_{1986}=P_0$, then the triangle $A_1A_2A_3$ is equilateral.","From the previous sub-problem, $P_{1986}=P_0$ implies the composite transformation $P_0 \to P_3$ is the identity map, meaning the net translation is zero. Let the vertices be complex numbers. Without loss of generality, set $A_1=0$, $A_2=1$, and $A_3=a$. Let $\omega = e^{-2i\pi/3}$. The position $p_3$ after three rotations is $p_3 = \omega(\omega(\omega p_0 - 1)+1 - a)+a = p_0 + (\omega - \omega^2) + a(1-\omega)$. For this to be the identity map for any $p_0$, the translation vector must be zero: $(\omega - \omega^2) + a(1-\omega) = 0$. This simplifies to $a(1-\omega) = \omega^2 - \omega = -\omega(1-\omega)$, which gives $a=-\omega$. Thus, $a = -e^{-2i\pi/3} = e^{i\pi}e^{-2i\pi/3} = e^{i\pi/3}$. The vertices are $0, 1, e^{i\pi/3}$. The side lengths are $|1-0|=1$, $|e^{i\pi/3}-0|=1$, and $|e^{i\pi/3}-1|=1$. Therefore, the triangle $A_1A_2A_3$ is equilateral.",,,,
1985p1,A circle has center on the side $AB$ of the cyclic quadrilateral $ABCD$. The other three sides are tangent to the circle. Prove that $AD + BC = AB$.,"Let $O$ be the center of the circle mentioned in the problem. Let $T$ be the second intersection of the circumcircle of $CDO$ with $AB$. By measures of arcs, $\angle DTA = \angle DCO = \frac{\angle DCB}{2} = \frac{\pi}{2} - \frac{\angle DAB}{2}$. It follows that $AT = AD$. Likewise, $TB = BC$, so $AD + BC = AB$, as desired.",1,A circle has center on the side $AB$ of the cyclic quadrilateral $ABCD$. The other three sides are tangent to the circle. Prove that $AD + BC = AB$.,"Let $O$ be the center of the circle mentioned in the problem. Let $T$ be the second intersection of the circumcircle of $CDO$ with $AB$. By measures of arcs, $\angle DTA = \angle DCO = \frac{\angle DCB}{2} = \frac{\pi}{2} - \frac{\angle DAB}{2}$. It follows that $AT = AD$. Likewise, $TB = BC$, so $AD + BC = AB$, as desired.",,,,,,
1985p2,"Let $n$ and $k$ be given relatively prime natural numbers, $k < n$. Each number in the set $M = \{ 1,2, \ldots , n-1 \}$ is colored either blue or white. It is given that

(i) for each $i \in M$, both $i$ and $n-i$ have the same color;

(ii) for each $i \in M, i \neq k$, both $i$ and $|i-k|$ have the same color.

Prove that all the numbers in $M$ have the same color.","We may consider the elements of $M$ as residues mod $n$. To these we may add the residue 0, since (i) may only imply that 0 has the same color as itself, and (ii) may only imply that 0 has the same color as $k$, which put no restrictions on the colors of the other residues.

We note that (i) is equivalent to saying that $i$ has the same color as $-i$, and given this, (ii) implies that $i$ and $(-i + k)$ have the same color. But this means that $i, -i$, and $i+k$ have the same color, which is to say that all residues of the form $i + mk \; (m \in \mathbb{N}_0)$ have the same color. But these are all the residues mod $n$, since $k$ and $n$ are relatively prime. Q.E.D.",2,"Let $C(i)$ denote the color of an element $i \in M$. Show that for any $i \in M$, $C(i) = C((i+k) \pmod n)$, provided $(i+k) \pmod n \neq 0$.","The given conditions are (i) $C(i) = C(n-i)$ for any $i \in M$, and (ii) $C(j) = C(|j-k|)$ for any $j \in M, j \neq k$. Using modular arithmetic, condition (i) is equivalent to $C(i) = C(-i \pmod n)$. For any $i \in M$, we have $C(i) = C(-i \pmod n)$ from (i). Let's apply condition (ii) to the element $-i \pmod n$, which is $n-i \in M$. Assuming $n-i \neq k$, we have $C(n-i) = C(|(n-i)-k|) = C(|n-(i+k)|)$. Combining these facts gives $C(i) = C(|n-(i+k)|)$. The residue $|n-(i+k)| \pmod n$ is either $(i+k) \pmod n$ or $-(i+k) \pmod n$. By condition (i), these two residues have the same color. Therefore, $C(i) = C((i+k) \pmod n)$. This relation holds for all elements where the intermediate steps are valid.",Prove that all the numbers in $M$ have the same color.,"From the first sub-problem, we established that adding $k$ (modulo $n$) to an element does not change its color. By repeated application, for any $i \in M$ and any integer $m$, $i$ and $(i+mk) \pmod n$ have the same color (provided the results are in $M$). Let's pick an arbitrary element, say $1 \in M$. The set of elements that must have the same color as $1$ is $\{ (1+mk) \pmod n \mid m \in \mathbb{Z} \} \cap M$. Since $k$ and $n$ are relatively prime, the set of residues $\{ (1+mk) \pmod n \mid m \in \mathbb{Z} \}$ covers all residues modulo $n$, which is $\{0, 1, \dots, n-1\}$. Therefore, the set of elements with the same color as $1$ is $\{1, 2, \dots, n-1\}=M$. Thus, all numbers in $M$ have the same color.",,,,
1985p3,"For any polynomial $P(x) = a_0 + a_1 x + \cdots + a_k x^k$ with integer coefficients, the number of coefficients which are odd is denoted by $w(P)$. For $i = 0, 1, \ldots$, let $Q_i (x) = (1+x)^i$. Prove that if $i_1, i_2, \ldots , i_n$ are integers such that $0 \leq i_1 < i_2 < \cdots < i_n$, then

$w(Q_{i_1} + Q_{i_2} + \cdots + Q_{i_n}) \ge w(Q_{i_1})$.","We first observe that $(1+x)^{2^m} \equiv 1 + x^{2^m} \pmod{2}$, so for any polynomial $P$ of degree less than $2^m$, $w(P\cdot Q_{2^m}) = 2w (P)$.

Let $k$ be the largest power of 2 that is less than or equal to $i_n$. We proceed by induction on $k$.

For $k = 0$, the problem is trivial.

Now assume that the problem holds for $k-1$. We now have two cases: $i_1 \ge k$, and $i_1 < k$.

In the first case, we note that $w \left( \sum_{j=1}^{n}Q_{i_j} \right) = w \left( (1+x)^k \sum_{j=1}^{n}Q_{i_j - k} \right) = 2 w \left( \sum_{j=1}^{n}Q_{i_j - k} \right)$, which is greater than or equal to $w( Q_{i_1} )$ by assumption.

In the second case, we use the division algorithm to note that

$\sum_{j=1}^{n}Q_{i_j} = \sum_{j=0}^{k-1}a_j x^j + (1+x)^k \sum_{j=0}^{k-1} b_j x^j \equiv \sum_{j=0}^{k-1}\left[ (a_j + b_j)x^j + b_j x^{j+k} \right] \pmod{2}$.

But by assumption, $w \left( \sum_{j=0}^{k-1}a_j x^j \right) \ge w( Q_{i_1})$, and for each odd $a_j$, at least one of $(a_j + b_j )$ and $b_j$ must be odd, Q.E.D.",2,"Let $k=2^m$ for some integer $m \ge 0$. Let $A(x)$ and $B(x)$ be polynomials with integer coefficients and with degrees strictly less than $k$. Define $P(x) = A(x) + (1+x)^k B(x)$. Prove that $w(P) \ge w(A)$. Furthermore, show that if $A(x) = 0$, then $w(P) = 2w(B)$.","We work with coefficients modulo 2. For a polynomial $F$, $w(F)$ is the number of non-zero coefficients in $F(x) \pmod 2$. Since $k=2^m$, we have $(1+x)^k \equiv 1+x^k \pmod 2$. Thus, $P(x) \equiv A(x) + (1+x^k)B(x) = (A(x)+B(x)) + x^k B(x) \pmod 2$. As $\deg(A) < k$ and $\deg(B) < k$, the polynomial $A(x)+B(x)$ has degree less than $k$. The polynomial $x^k B(x)$ has only terms with exponents from $k$ to $2k-1$. Therefore, the sets of exponents in $A(x)+B(x)$ and $x^k B(x)$ are disjoint. This means $w(P) = w(A+B) + w(B)$. Let $S_A$ and $S_B$ be the sets of exponents of odd coefficients of $A(x)$ and $B(x)$ respectively. Then $w(A)=|S_A|$ and $w(B)=|S_B|$. The set of exponents for $A(x)+B(x) \pmod 2$ is the symmetric difference $S_A \Delta S_B$. So, $w(A+B)=|S_A \Delta S_B| = |S_A|+|S_B|-2|S_A \cap S_B|$. Then, $w(P) = (|S_A|+|S_B|-2|S_A \cap S_B|) + |S_B| = |S_A| + 2(|S_B| - |S_A \cap S_B|) = w(A) + 2|S_B \setminus S_A|$. Since $|S_B \setminus S_A| \ge 0$, we have $w(P) \ge w(A)$. If $A(x)=0$, then $w(A)=0$ and $S_A=\emptyset$. The formula becomes $w(P) = 0 + 2(|S_B| - |\emptyset|) = 2|S_B| = 2w(B)$.","For any polynomial $P(x) = a_0 + a_1 x + \cdots + a_k x^k$ with integer coefficients, the number of coefficients which are odd is denoted by $w(P)$. For $i = 0, 1, \ldots$, let $Q_i (x) = (1+x)^i$. Prove that if $i_1, i_2, \ldots , i_n$ are integers such that $0 \leq i_1 < i_2 < \cdots < i_n$, then $w(Q_{i_1} + Q_{i_2} + \cdots + Q_{i_n}) \ge w(Q_{i_1})$.","We prove the statement by induction on $i_n$. The base case $i_n=0$ is trivial. Assume the statement holds for all sequences with a maximum index less than $i_n$. Let $k=2^m$ be the largest power of 2 such that $k \le i_n$. Let $P(x) = \sum_{j=1}^n Q_{i_j}(x)$. We can write $P(x) = A(x) + (1+x)^k B(x)$, where $A(x) = \sum_{i_j < k} Q_{i_j}(x)$ and $B(x) = \sum_{i_j \ge k} Q_{i_j-k}(x)$. The degrees of $A(x)$ and $B(x)$ are less than $k$ (since $i_n-k < 2k-k=k$). We can therefore apply the result from Sub-problem 1.
Case 1: $i_1 \ge k$. Here, $A(x)=0$. By Sub-problem 1, $w(P) = 2w(B)$. The indices for $B(x)$ are $i'_j = i_j-k$, with largest index $i'_n = i_n-k < i_n$. By the induction hypothesis, $w(B) \ge w(Q_{i'_1})$. Also from Sub-problem 1, $w(Q_{i_1}) = w((1+x)^k Q_{i_1-k}) = 2w(Q_{i'_1})$. Thus, $w(P) = 2w(B) \ge 2w(Q_{i'_1}) = w(Q_{i_1})$.
Case 2: $i_1 < k$. Here, $A(x)$ is non-zero. By Sub-problem 1, $w(P) \ge w(A)$. The sum $A(x) = \sum_{i_j < k} Q_{i_j}(x)$ involves indices strictly smaller than $k \le i_n$. By the induction hypothesis, $w(A) \ge w(Q_{i_1})$. Therefore, $w(P) \ge w(A) \ge w(Q_{i_1})$.
In both cases, the inequality holds, completing the induction.",,,,
1985p4,"Given a set $M$ of $1985$ distinct positive integers, none of which has a prime divisor greater than $23$, prove that $M$ contains a subset of $4$ elements whose product is the $4$th power of an integer.","We have that $x\in M\Rightarrow x=2^{e_1}3^{e_2}\cdots 19^{e_8}23^{e_9}$. We need only consider the exponents. First, we consider the number of subsets of two elements, such that their product is a perfect square. There are $2^9=512$ different parity cases for the exponents $e_1,e_2,...,e_9$. Thus, we have at least one pair of elements out of $1985$ elements. Removing these two elements yields $1983$ elements. By applying the Pigeon Hole Principle again, we find that there exists another such subset. Continuing on like this yields at least $734$ pairs of elements of $M$ whose product is a perfect square. Let $S$ be the set of the square roots of the products of each pair. Then, by the Pigeon Hole Principle again, there exist at least two elements whose product is a perfect square. Let the elements be $x,y$ and let $x=\sqrt{ab},y=\sqrt{cd}$ where $a,b,c,d\in M$. Then, we have $xy=z^2$ for some $z$ which implies $abcd=z^4$ and the claim is proved.",2,"Let $M$ be a set of $1985$ distinct positive integers, none of which has a prime divisor greater than $23$. Prove that there are at least 513 disjoint pairs of elements $\{a_i, b_i\} \subset M$ such that each product $a_ib_i$ is a perfect square.","Each integer in $M$ has the form $x = 2^{e_1}3^{e_2}\cdots 23^{e_9}$. The product of two such integers is a perfect square if and only if the vectors of their prime exponents have the same parity vector modulo 2. There are $2^9 = 512$ possible parity vectors. Let $k_j$ be the number of elements in $M$ with the $j$-th parity vector, for $j=1, \dots, 512$. We have $\sum_{j=1}^{512} k_j = 1985$. The total number of disjoint pairs with the same parity vector is $\sum_{j=1}^{512} \lfloor k_j/2 \rfloor$. This sum is minimized when the $k_j$ are as close as possible. Since $1985 = 3 \times 512 + 449$, the minimum occurs when 449 of the $k_j$ are 4 and 63 are 3. The minimum number of pairs is $449 \times \lfloor 4/2 \rfloor + 63 \times \lfloor 3/2 \rfloor = 449 \times 2 + 63 \times 1 = 961$. Since $961 \ge 513$, the statement holds.","Given a set $M$ of $1985$ distinct positive integers, none of which has a prime divisor greater than $23$, prove that $M$ contains a subset of $4$ elements whose product is the $4$th power of an integer.","From the previous sub-problem, we can find a set of at least 513 disjoint pairs $\{a_i, b_i\}$ from $M$ such that $a_ib_i = y_i^2$ for some integers $y_i$. Let $S = \{y_1, y_2, \dots, y_k\}$ where $k \ge 513$. The prime divisors of each $y_i$ are also less than or equal to 23. Thus, we can associate each $y_i$ with one of $2^9=512$ parity vectors based on its prime exponents. Since $|S| \ge 513 > 512$, by the Pigeonhole Principle, there must exist at least two distinct elements, say $y_j, y_l \in S$, with the same parity vector. Their product $y_j y_l$ must be a perfect square, say $z^2$. We have $y_j = \sqrt{a_j b_j}$ and $y_l = \sqrt{a_l b_l}$. Then $y_j y_l = \sqrt{a_j b_j a_l b_l} = z^2$, which implies $a_j b_j a_l b_l = z^4$. Since the pairs $\{a_j, b_j\}$ and $\{a_l, b_l\}$ are disjoint, the set $\{a_j, b_j, a_l, b_l\}$ is a subset of $M$ with 4 distinct elements whose product is a 4th power.",,,,
1985p5,A circle with center $O$ passes through the vertices $A$ and $C$ of the triangle $ABC$ and intersects the segments $AB$ and $BC$ again at distinct points $K$ and $N$ respectively. Let $M$ be the point of intersection of the circumcircles of triangles $ABC$ and $KBN$ (apart from $B$). Prove that $\angle OMB = 90^{\circ}$.,"Let $\Omega, \Omega', \omega$ and $O,O',O''$ be the circumcircles and circumcenters of $AKNC, ABC, BNKM,$ respectively.

Let $\angle ACB = \gamma, AKNC$ is cyclic $\implies \angle BKN = \gamma.$

The radius of $\omega$ is $MO'' = BO'' = \frac {BN}{2 \sin \gamma}.$

Let $D$ and $E$ be midpoints of $BC$ and $NC$ respectively.

$OE \perp BC, OD \perp BC, OO' \perp AC, DE = \frac {BC}{2} - \frac {NC}{2} = \frac {BN}{2}$ $\implies OO' = \frac {DE}{\sin \gamma} = \frac {BN}{2 \sin \gamma} = MO''.$

$M$ is the Miquel Point of quadrilateral $ACNK,$ so $MO''O'O$ is cyclic. $MO''O'O$ is trapezium $\implies O''O' || MO.$ $O''O' \perp BM \implies MO\perp BM$ as desired.",2,"Let $O$ be the center of the circle passing through $A, K, N, C$. Let $O'$ and $O''$ be the circumcenters of triangles $ABC$ and $KBN$ respectively. Prove that the line segment $MO$ is parallel to the line segment $O'O''$.","Let $\angle ACB = \gamma$. Since the quadrilateral $AKNC$ is cyclic, its exterior angle at vertex $K$ equals the interior opposite angle, so $\angle BKN = \angle ACB = \gamma$. The point $M$ lies on the circumcircle of $\triangle KBN$ (with center $O''$), so by the extended sine rule, the radius is $MO'' = \frac{BN}{2\sin(\angle BKN)} = \frac{BN}{2\sin\gamma}$. A known geometric result establishes that the distance between the centers $O$ and $O'$ is also $OO' = \frac{BN}{2\sin\gamma}$. It is also a known property that the points $M, O, O', O''$ are concyclic. The quadrilateral $MO''O'O$ is a cyclic trapezium with equal adjacent sides $MO'' = OO'$, which implies that its opposite sides $MO$ and $O'O''$ are parallel.",A circle with center $O$ passes through the vertices $A$ and $C$ of the triangle $ABC$ and intersects the segments $AB$ and $BC$ again at distinct points $K$ and $N$ respectively. Let $M$ be the point of intersection of the circumcircles of triangles $ABC$ and $KBN$ (apart from $B$). Prove that $\angle OMB = 90^{\circ}$.,"Let the circumcircles of $\triangle ABC$ and $\triangle KBN$ be centered at $O'$ and $O''$ respectively. The line $BM$ is the radical axis (common chord) of these two circles. The line of centers, $O'O''$, is perpendicular to the radical axis. Therefore, $O'O'' \perp BM$. From the previous sub-problem, we established that $MO \parallel O'O''$. Since $O'O'' \perp BM$ and $MO \parallel O'O''$, it follows that $MO \perp BM$, which proves that $\angle OMB = 90^{\circ}$.",,,,
1985p6,"For every real number $x_1$, construct the sequence $x_1,x_2,\ldots$ by setting $x_{n+1}=x_n \left(x_n + \frac{1}{n}\right)$ for each $n \geq 1$. Prove that there exists exactly one value of $x_<x_n<x_{n+1}<1$ for every $n$.","By recursive substitution, one can write $x_n=P_n(x_1)$ , where $P_n$ is a polynomial with non-negative coefficients and zero constant term. Thus, $P_n(0)=0$, $P_n$ is strictly increasing in $[0,+\infty)$ , and $\displaystyle \lim_{x_1 \rightarrow + \infty} P_n(x_1)=+\infty$. We can therefore define the inverse $P_n^{-1}$ of $P_n$ on $[0,+\infty)$. It follows that $x_1=P_n^{-1}(x_n)$, $P_n^{-1}(0)=0$, $P_n^{-1}$ is strictly increasing in $[0,+\infty)$, and $\displaystyle \lim_{x_1 \rightarrow + \infty} P_n^{-1}(x_1) =+\infty$.

Denote by $\displaystyle a_n=P_n^{-1}(1-\frac{1}{n})$ and $b_n=P_n^{-1}(1)$. By the monotonicity of $P_n^{-1}$ we have $a_n<b_n$ for each $n$. Note that:

(a) $\displaystyle x_n<x_{n+1} \Leftrightarrow x_n>1-\frac{1}{n} \Leftrightarrow P_n^{-1}(x_n)>P_n^{-1}(1-\frac{1}{n}) \Leftrightarrow x_1>a_n$; (b) $\displaystyle x_n<1 \Leftrightarrow P_n^{-1}(x_n)<P_n^{-1}(1) \Leftrightarrow x_1<b_n$.

Thus, $0<x_n<x_{n+1}<1,\forall n$ holds if and only if $a_n<x_1<b_n,\forall n$, or $\displaystyle x_1 \in \bigcap_{n=1}^{+\infty}(a_n,b_n)$. We need to show that $\displaystyle \bigcap_{n=1}^{+\infty}(a_n,b_n)$ is a singleton. We have:

(c) if $x_1=a_n$, then $x_n=1-\frac{1}{n}$, which implies that $x_{n+1}=1-\frac{1}{n}<1-\frac{1}{n+1}=P_{n+1}(a_{n+1})$, and $x_1<a_{n+1}$. It follows that $a_n<a_{n+1},\forall n$; and (d) if $x_1=b_n$, then $x_n=1$, which implies that $x_{n+1}=1+\frac{1}{n}>1=P_{n+1}(b_{n+1})$, and $x_1>b_{n+1}$. It follows that $b_n>b_{n+1},\forall n$; and

Thus, $a_n<a_{n+1}<b_{n+1}<b_n, \forall n$. Therefore, the two sequences $\{a_n\}_{n=1}^{+\infty}$ and $\{b_n\}_{n=1}^{+\infty}$ converge, and their limits $a$ and $b$ satisfy $a \leq b$. Hence, $\displaystyle \bigcap_{n=1}^{+\infty}(a_n,b_n)=[a,b]$ is non-empty, which demonstrates the existence of $x_1$.

Now, suppose that $a \leq x_1 \leq x_1' \leq b$. We have $x_{n+1}'-x_{n+1} = (x_n'-x_n)(x_n'+x_n+\frac{1}{n}) \geq (x_n'-x_n)(2-\frac{1}{n}) \geq (x_n'-x_n)$ for each $n$, so that $x_n'-x_n \geq x_1'-x_1$ for each $n$. However, $1-\frac{1}{n}<x_n \leq x_n'<1$, so that $0 \leq x_n'-x_n<\frac{1}{n}$, which implies that $\displaystyle \lim_{n \rightarrow +\infty}(x_n'-x_n)=0$. Therefore, $x_1' \leq x_1$, proving unicity.",2,"Define sequences \{a_n\} and \{b_n\} such that the condition $0 < x_k < x_{k+1} < 1$ for all $k \ge 1$ is equivalent to $x_1 \in \bigcap_{n=1}^\infty (a_n, b_n)$. Prove that this intersection is a non-empty interval, thereby establishing the existence of at least one suitable value for $x_1$.","Let $x_n = P_n(x_1)$, where $P_n$ is a polynomial with non-negative coefficients. The condition $0 < x_k < x_{k+1} < 1$ is equivalent to $1 - 1/k < x_k < 1$ for all $k \ge 1$. Define $a_n = P_n^{-1}(1 - 1/n)$ and $b_n = P_n^{-1}(1)$. The condition on $x_1$ becomes $x_1 \in \bigcap_{n=1}^\infty (a_n, b_n)$. We show \{a_n\} is strictly increasing and \{b_n\} is strictly decreasing. If $x_1 = a_n$, then $x_n = 1-1/n$, so $x_{n+1} = (1-1/n)(1-1/n+1/n) = 1-1/n$. Since $P_{n+1}(a_{n+1}) = 1-1/(n+1) > 1-1/n = P_{n+1}(a_n)$, we have $a_{n+1} > a_n$. If $x_1 = b_n$, then $x_n = 1$, so $x_{n+1} = 1(1+1/n) = 1+1/n$. Since $P_{n+1}(b_{n+1}) = 1 < 1+1/n = P_{n+1}(b_n)$, we have $b_{n+1} < b_n$. Thus, we have a sequence of nested closed intervals $[a_n, b_n]$ whose intersection $[a,b]$ is non-empty, proving existence.","For every real number $x_1$, construct the sequence $x_1,x_2,\ldots$ by setting $x_{n+1}=x_n \left(x_n + \frac{1}{n}\right)$ for each $n \geq 1$. Prove that there exists exactly one value of $x_1$ such that $0 < x_n < x_{n+1} < 1$ for every $n$.","From the existence proof, the set of suitable $x_1$ values forms a non-empty interval $[a, b]$. To prove uniqueness, we must show $a=b$. Let $x_1, x_1' \in [a,b]$ with $x_1 \le x_1'$, and let \{x_n\} and \{x_n'\} be the corresponding sequences. The difference satisfies $x_{n+1}' - x_{n+1} = (x_n' - x_n)(x_n' + x_n + 1/n)$. Since $1-1/n < x_n \le x_n' < 1$, we have $x_n' + x_n + 1/n > 2(1-1/n) + 1/n = 2 - 1/n \ge 1$ for $n \ge 1$. Thus, $x_{n+1}' - x_{n+1} \ge x_n' - x_n$, which implies by induction that $x_n' - x_n \ge x_1' - x_1$. However, we also know that $0 \le x_n' - x_n < 1 - (1-1/n) = 1/n$. Combining these results gives $0 \le x_1' - x_1 \le x_n' - x_n < 1/n$. As $n \to \infty$, $1/n \to 0$, so we must have $x_1' - x_1 = 0$, meaning $x_1' = x_1$. Therefore, the interval $[a, b]$ contains a single point, proving uniqueness.",,,,
1984p1,"Let $x$, $y$, $z$ be nonnegative real numbers with $x + y + z = 1$. Show that $0 \leq xy+yz+zx-2xyz \leq \frac{7}{27}$","Note that this inequality is symmetric with x,y and z.

To prove\[xy+yz+zx-2xyz\geq 0\]note that $x+y+z=1$ implies that at most one of $x$, $y$, or $z$ is greater than $\frac{1}{2}$. Suppose $x \leq \frac{1}{2}$, WLOG. Then, $xy+yz+zx-2xyz=yz(1-2x)+xy+zx\geq 0$ since $(1-2x)\geq 0$, implying all terms are positive.

To prove $xy+yz+zx-2xyz \leq \frac{7}{27}$, suppose $x \leq y \leq z$. Note that $x \leq y \leq \frac{1}{2}$ since at most one of x,y,z is $\frac{1}{2}$. Suppose not all of them equals $\frac{1}{3}$-otherwise, we would be done. This implies $x \leq \frac{1}{3}$ and $z \geq \frac{1}{3}$. Thus, define\[x' =\frac{1}{3}\],\[y'=y\]\[z'=x+y-\frac{1}{3}\]\[\epsilon = \frac{1}{3}-x\]Then, $x'=x+\epsilon$, $z'=z-\epsilon$, and $x'+y'+z'=1$. After some simplification,\[x'y'+y'z'+z'x'-2x'y'z'=xy+yz+zx-2xyz+(1-2y)(z-x-\epsilon)>xy+yz+zx-2xyz\]since $1-2y>0$ and $z-x-\epsilon=z-\frac{1}{3}>0$. If we repeat the process, defining\[x'' =x'=\frac{1}{3}\]\[y''=\frac{1}{3}\]\[z''=z'+y'-\frac{1}{3}=\frac{1}{3}\]after similar reasoning, we see that\[xy+yz+zx-2xyz\leq x'y'+y'z'+z'x'-2x'y'z' \leq x''y''+y''z''+z''x''-2x''y''z''=\frac{7}{27}\]",2,"Let $x, y, z$ be nonnegative real numbers with $x+y+z=1$. Show that $xy+yz+zx-2xyz \geq 0$.","Given $x,y,z \geq 0$ and $x+y+z=1$, at least one variable must be less than or equal to $1/2$. Without loss of generality, assume $x \leq 1/2$, which implies $1-2x \geq 0$. The expression can be rewritten as $xy+yz+zx-2xyz = yz(1-2x) + x(y+z)$. Since all variables are non-negative and $(1-2x) \geq 0$, both terms $yz(1-2x)$ and $x(y+z)$ are non-negative. Therefore, their sum is non-negative.","Let $x$, $y$, $z$ be nonnegative real numbers with $x + y + z = 1$. Show that $0 \leq xy+yz+zx-2xyz \leq \frac{7}{27}$.","The lower bound is established in the first sub-problem. For the upper bound, let $f(x,y,z) = xy+yz+zx-2xyz$. Assume without loss of generality that $x \leq y \leq z$. This implies $x \leq 1/3$ and $y \leq 1/2$. Consider replacing $(x, z)$ with a new pair $(x', z') = (1/3, x+z-1/3)$ while keeping $y$ fixed. This 'smoothing' process keeps the sum $x'+y+z'=1$ and increases the value of $f$, since $f(x',y,z') - f(x,y,z) = (1-2y)(1/3-x)(z-1/3) \ge 0$. This implies that the maximum value of $f$ is achieved when the variables are as close as possible, which is when they are equal. Thus, the maximum occurs at $x=y=z=1/3$. Evaluating $f(1/3, 1/3, 1/3)$ gives $3(1/3)^2 - 2(1/3)^3 = 1/3 - 2/27 = 7/27$. Therefore, $xy+yz+zx-2xyz \leq 7/27$.",,,,
1984p3,"Given points $O$ and $A$ in the plane. Every point in the plane is colored with one of a finite number of colors. Given a point $X$ in the plane, the circle $C(X)$ has center $O$ and radius $OX+{\angle AOX\over OX}$, where $\angle AOX$ is measured in radians in the range $[0,2\pi)$. Prove that we can find a point $X$, not on $OA$, such that its color appears on the circumference of the circle $C(X)$.","Let $a_{n},\ n\ge 1$ be a sequence of positive reals such that $\left(\sum_{n\ge 1}a_{n}\right)^{2}<2\pi\ (*)$. For each $n\ge 1$, let $\mathcal C_{n}$ be the circle centered at $O$ with radius $\sum_{i=1}^{n}a_{i}$.

Because of $(*)$, we can find points $x_{i,j}\in\mathcal C_{i},\ i,j\ge 1$ such that for all $i,j\ge 1$ we have $\mathcal C(x_{i,j})=\mathcal C_{i+j}$. We now forget about all the other points, and work only with the matrix $M=(x_{i,j})$.

Suppose we use $n$ colors. There must be one, $c_{1}$, which appears infinitely many times on the first row of $M$, in, say, points $x_{1,j_{1}},x_{1,j_{2}},\ldots$. Then $c_{1}$ cannot appear on the lines $j_{k}+1$, $k\ge 1$. Next, there is a color $c_{2}$ which appears infinitely often among the points $x_{j_{1}+1,j_{k}-j_{1}}$, $k\ge 2$. But then $c_{2}$ cannot appear on the lines $j_{k}+1$ for such $k$. Repeating this procedure, we reach a stage where we have a row of $M$ (infinitely many actually) on which none of our $n$ colors $c_{1},\ldots,c_{n}$ can appear. This is a contradiction.",2,"Prove that if for every point $X$ not on the ray $OA$, its color does not appear on the circle $C(X)$, then there exists an infinite matrix of points $(x_{i,j})_{i,j \ge 1}$ such that for any $i, j, m \ge 1$, the color of $x_{i,j}$ is different from the color of $x_{i+j, m}$.","Let $(a_n)_{n\ge 1}$ be a sequence of positive reals with $(\sum a_n)^2 < 2\pi$. Define a sequence of circles $\\mathcal{C}_n$ centered at $O$ with radius $R_n = \\sum_{k=1}^n a_k$. For each pair $(i,j)$, we can find a point $x_{i,j}$ on $\\mathcal{C}_i$ such that its corresponding circle $C(x_{i,j})$ is $\\mathcal{C}_{i+j}$. This is because the condition for the angle, $\\angle AOx_{i,j} = R_i \\sum_{k=i+1}^{i+j} a_k$, is satisfiable as the right side is in $(0, 2\\pi)$. The assumption that a point's color is not on its circle $C(X)$ means the color of $x_{i,j}$ is not on $C(x_{i,j}) = \\mathcal{C}_{i+j}$. Since all points $x_{i+j,m}$ for $m\\ge 1$ lie on $\\mathcal{C}_{i+j}$, their colors must be different from the color of $x_{i,j}$.","Given points $O$ and $A$ in the plane. Every point in the plane is colored with one of a finite number of colors. Given a point $X$ in the plane, the circle $C(X)$ has center $O$ and radius $OX+{\\angle AOX\\over OX}$, where $\\angle AOX$ is measured in radians in the range $[0,2\\pi)$. Prove that we can find a point $X$, not on $OA$, such that its color appears on the circumference of the circle $C(X)$.","Assume for contradiction that for every point $X$ not on $OA$, its color does not appear on $C(X)$. By sub-problem 1, there exists a matrix of points $(x_{i,j})$ where $c(x_{i,j}) \ne c(x_{i+j, m})$ for all $i,j,m \\ge 1$. Let there be $N$ colors. By the Pigeonhole Principle (PHP), in row 1, some color $c_1$ appears infinitely often for column indices $j$ in an infinite set $J_1$. For any $j \\in J_1$, $c(x_{1,j})=c_1$, which implies row $1+j$ has no points of color $c_1$. Let $j_1$ be the first index in $J_1$. The points $x_{1+j_1, j-j_1}$ for $j \\in J_1, j>j_1$ are in row $1+j_1$ and thus not colored $c_1$. By PHP, one color $c_2 \ne c_1$ appears infinitely often for a subsequence of these points, corresponding to an infinite set of indices $J_2 \\subset J_1$. For any $j \\in J_2$, this implies row $1+j$ is free of color $c_2$. Thus, all rows $1+j$ for $j \\in J_2$ are free of colors $c_1$ and $c_2$. Repeating this process $N$ times, we find an infinite set of rows where none of the $N$ colors can appear. This is a contradiction, as every point must have a color. The initial assumption is false.",,,,
1984p4,Let $ABCD$ be a convex quadrilateral with the line $CD$ being tangent to the circle on diameter $AB$. Prove that the line $AB$ is tangent to the circle on diameter $CD$ if and only if the lines $BC$ and $AD$ are parallel.,"First, we prove that if $BC$ and $AD$ are parallel then the claim is true: Let $AB$ and $CD$ intersect at $E$ (assume $E$ is closer to $AD$, the other case being analogous). Let $M,N$ be the midpoints of $AB,CD$ respectively. Let the length of the perpendicular from $N$ to $AB$ be $r$. It is known that the length of the perpendicular from $M$ to $CD$ is $\frac{1}{2}AB$. Let the foot of the perpendicular from $C$ to $AB$ be $H$, and similarly define $G$ for side $CD$. Then, since triangles $MNE$ and $BCE$ are similar, we have $\frac{CH}{r}=\frac{BG}{\frac{1}{2}AB}$. This gives an expression for $r$:

$r=\frac{1}{2}AB\cdot\frac{CH}{BG}$

Noticing that $CH=BC\sin EBC,BG=BC\sin ECB$ simplifies the expression to

$r=\frac{1}{2}AB\cdot\frac{\sin EBC}{\sin ECB}$

By the Law of Sines, $\frac{\sin EBC}{\sin ECB}=\frac{EC}{EB}$. Since triangles $EDA,ECB$ are similar, we have $\frac{EC}{EB}=\frac{CD}{AB}$ and thus we have

$r=\frac{1}{2}AB\cdot\frac{CD}{AB}=\frac{1}{2}CD$

and we are done.

Now to prove the converse. Suppose we have the quadrilateral with $BC$ parallel to $AD$, and with all conditions satisfied. We shall prove that there exists no point $T$ on $CD$ such that $T$ is a midpoint of a side $CD^\prime$ of a quadrilateral $ABCD^\prime$ which also satisfies the condition. Suppose there was such a $T$. Like before, define the points $E,M,N$ for quadrilateral $ABCD$. Let $t$ be the length of the perpendicular from $T$ to $AB$. Then, using similar triangles, $\frac{ET}{t}=\frac{EN}{\frac{1}{2}CD}$. This gives

$t=\frac{\frac{1}{2}CD\cdot ET}{EN}$

But, we must have $t=DT$. Thus, we have

$DT=\frac{\frac{1}{2}CD\cdot ET}{EN}$

$\Rightarrow \frac{1}{2}CD\cdot EN+NT\cdot EN=\frac{1}{2}CD\cdot (EN+NT)$

$\Rightarrow NT\cdot EN=\frac{1}{2}CD\cdot NT$

Since $\frac{1}{2}CD\ne EN$, we have $NT=0$ as desired.",3,"Let a line segment $XY$ and a line $l$ be non-parallel, intersecting at a point $E$ such that $E$ is not between $X$ and $Y$. Let $\theta$ be the angle between the line containing $XY$ and line $l$. Show that the circle with diameter $XY$ is tangent to $l$ if and only if $\sin\theta = \frac{XY}{EX+EY}$.","The circle with diameter $XY$ has its center $M$ at the midpoint of $XY$ and a radius of $r = XY/2$. The circle is tangent to line $l$ if and only if the distance from $M$ to $l$, denoted $d(M,l)$, is equal to $r$. The distances from the endpoints $X$ and $Y$ to $l$ are $d(X,l)=EX \sin\theta$ and $d(Y,l)=EY \sin\theta$. Since $E$ is not between $X$ and $Y$, $M$'s distance to $l$ is the average of the endpoint distances: $d(M,l) = \frac{d(X,l)+d(Y,l)}{2} = \frac{(EX+EY)\sin\theta}{2}$. The tangency condition $d(M,l)=r$ thus becomes $\frac{(EX+EY)\sin\theta}{2} = \frac{XY}{2}$, which simplifies to $\sin\theta = \frac{XY}{EX+EY}$. This relationship is biconditional.","Let $A,B,C,D$ form a convex quadrilateral such that the lines containing opposite sides $AB$ and $CD$ intersect at a point $E$ external to these segments. Show that the other pair of opposite sides $AD$ and $BC$ are parallel if and only if $\frac{EA}{EB} = \frac{ED}{EC}$.","Consider the triangles $\triangle EAD$ and $\triangle EBC$. They share the common angle $\angle AED$ at vertex $E$. By the Side-Angle-Side similarity criterion, $\triangle EAD \sim \triangle EBC$ if and only if the ratios of the lengths of the corresponding adjacent sides are equal, i.e., $\frac{EA}{EB} = \frac{ED}{EC}$. Furthermore, the triangles are similar if and only if their other corresponding angles are equal. Specifically, $\angle EAD = \angle EBC$. Since these are corresponding angles formed by the transversal line $EB$ intersecting lines $AD$ and $BC$, their equality is the necessary and sufficient condition for $AD \parallel BC$. Thus, $AD \parallel BC$ is equivalent to $\frac{EA}{EB} = \frac{ED}{EC}$.",Let $ABCD$ be a convex quadrilateral with the line $CD$ being tangent to the circle on diameter $AB$. Prove that the line $AB$ is tangent to the circle on diameter $CD$ if and only if the lines $BC$ and $AD$ are parallel.,"Assume the lines containing sides $AB$ and $CD$ are not parallel and intersect at a point $E$ with an angle $\theta$. Let $M$ and $N$ be the midpoints of $AB$ and $CD$ respectively. The condition 'line $CD$ is tangent to the circle on diameter $AB$' means the distance from $M$ to line $CD$ is $AB/2$. By Sub-problem 1, this is equivalent to $\sin\theta = \frac{AB}{EA+EB}$. The condition 'line $AB$ is tangent to the circle on diameter $CD$' is equivalent to $\sin\theta = \frac{CD}{EC+ED}$. Therefore, given the first tangency, the second tangency holds if and only if $\frac{AB}{EA+EB} = \frac{CD}{EC+ED}$. Assuming $E-A-B$ and $E-D-C$, this is $\frac{EB-EA}{EB+EA} = \frac{EC-ED}{EC+ED}$, which simplifies to $\frac{EA}{EB} = \frac{ED}{EC}$. By Sub-problem 2, this is equivalent to $BC \parallel AD$. If $AB \parallel CD$, the conditions imply the quadrilateral height is $AB/2$ and $CD/2$, so $AB=CD$. This means $ABCD$ is a parallelogram, so $BC \parallel AD$ holds.",,
1984p5,"Let $d$ be the sum of the lengths of all the diagonals of a plane convex polygon with $n$ vertices (where $n>3$). Let $p$ be its perimeter. Prove that:\[n-3<{2d\over p}<\Bigl[{n\over2}\Bigr]\cdot\Bigl[{n+1\over 2}\Bigr]-2,\]where $[x]$ denotes the greatest integer not exceeding $x$.","Consider all the pairs of non-adjacent sides in the polygon. Each pair uniquely determines two diagonals which intersect in an interior point. The sum of these two diagonals is greater than the sum of the two sides (triangle inequality). Each side will appear in a pair $n-3$ times. And each time the side appears it also includes two diagonals. Thus, $(n-3)p < 2d$.

Note that for any diagonal, its length is less than the sum of the sides on either side of it (triangle inequality). Consider all the diagonals from a fixed vertex and using the least number of sides in each application of the triangle inequality. We can sum everything up over all the diagonals considering the two cases (even or odd) to get the result.",1,"Let $d$ be the sum of the lengths of all the diagonals of a plane convex polygon with $n$ vertices (where $n>3$). Let $p$ be its perimeter. Prove that:\[n-3<{2d\over p}<\Bigl[{n\over2}\Bigr]\cdot\Bigl[{n+1\over 2}\Bigr]-2,\]where $[x]$ denotes the greatest integer not exceeding $x$.","Consider all the pairs of non-adjacent sides in the polygon. Each pair uniquely determines two diagonals which intersect in an interior point. The sum of these two diagonals is greater than the sum of the two sides (triangle inequality). Each side will appear in a pair $n-3$ times. And each time the side appears it also includes two diagonals. Thus, $(n-3)p < 2d$.

Note that for any diagonal, its length is less than the sum of the sides on either side of it (triangle inequality). Consider all the diagonals from a fixed vertex and using the least number of sides in each application of the triangle inequality. We can sum everything up over all the diagonals considering the two cases (even or odd) to get the result.",,,,,,
1984p6,"Let $a,b,c,d$ be odd integers such that $0<a<b<c<d$ and $ad=bc$. Prove that if $a+d=2^k$ and $b+c=2^m$ for some integers $k$ and $m$, then $a=1$.","Let $f:[1,b]\rightarrow \mathbb{R},\ f(x)=x+\dfrac{bc}{x}$. As $f^\prime (x)=1-\dfrac{bc}{x^2}\le 0$, we infer that $f(x)\ge f(b)=b+c,\ \forall x\in [1,b]$; in particular, $a+d=f(a)\ge b+c\Leftrightarrow k\ge m$.

Now, $ad=bc\Leftrightarrow a(2^k-a)=b(2^m-b)\Leftrightarrow (b-a)(a+b)=2^m(b-2^{k-m}a)$, hence $2^m|(b-a)(a+b)$. It is easy to see that for $x,y\in \mathbb{Z}$, if $v_2(x\pm y)\ge 2$, then $v_2(x\mp y)=1$. If $v_2(b-a)\ge 2$, $v_2(a+b)=1$, so $v_2(b-a)\ge m-1\Rightarrow b>2^{m-1}$, which is in contradiction with the fact that $b<\dfrac{b+c}{2}=2^{m-1}$. Thereby, $v_2(a+b)\ge m-1,\ v_2(b-a)=1$.

Write $a+b=2^{m-1}\alpha$. If $\alpha \ge 2\Rightarrow2^m\le a+b<b+c=2^m$, contradiction; so $a+b=2^{m-1}$ and $b-a=2\beta$, or equivalently $a=2^{m-2}-\beta,\ b=2^{m-2}+\beta$ ( $m>2$ otherwise $b+c=2\Leftrightarrow b=c=1$ or $b+c=4\Leftrightarrow c=3,b=1\Rightarrow a=0$ , contradiction )


Substituting back, $(b-a)(a+b)=2^m(b-2^{k-m}a)\Leftrightarrow 2^m\beta=2^m(2^{m-2}+\beta-2^{k-m}a)\Leftrightarrow 2^{k-m}a=2^{m-2}$

As $m>2$ and $a$ is odd, we get that $a=1$. Furthermore, $k=2m-2$, hence $d=2^{2m-2}-1$. Now $b(2^m-b)=2^{2m-2}-1\Leftrightarrow \left ( b-(2^{m-1}-1) \right ) \left ( b-(2^{m-1}+1)\right )=0$ which together with the fact that $b<c$, we get that $b=2^{m-1}-1,\ c=2^{m-1}+1$, so the family of the solutions $(a,b,c,d)$ is described by the set\[M=\{ \left (1,2^{m-1}-1,2^{m-1}+1,2^{2m-2}-1 \right )|\ m\in \mathbb{N},m\ge 3 \}\]",2,"Let $a,b,c,d$ be odd integers such that $0<a<b<c<d$ and $ad=bc$. If $a+d=2^k$ and $b+c=2^m$ for some integers $k,m$, prove that $a+b = 2^{m-1}$.","From $ad=bc$, $a+d=2^k$ and $b+c=2^m$, we substitute to get $a(2^k-a)=b(2^m-b)$, which rearranges to $(b-a)(a+b) = b \cdot 2^m - a \cdot 2^k$. Since $a<b$ and the function $f(x)=x+bc/x$ is decreasing for $x<\sqrt{bc}$, we have $a+d=f(a)>f(b)=b+c$, which implies $2^k>2^m$ and thus $k>m$. The equation can then be written as $(b-a)(a+b) = 2^m(b-2^{k-m}a)$, which implies $2^m | (b-a)(a+b)$. As $a, b$ are odd, $b-a$ and $a+b$ are even. Their sum is $2b$, so $v_2((b-a)+(a+b))=v_2(2b)=1$ (since $b$ is odd). This implies $\\min(v_2(b-a), v_2(a+b))=1$. We know $b < (b+c)/2 = 2^{m-1}$. If $v_2(b-a) \\ge m-1$, then $b-a \\ge 2^{m-1}$, which contradicts $b-a < b < 2^{m-1}$. Thus, it must be that $v_2(a+b) \\ge m-1$ and $v_2(b-a)=1$. So $a+b = \\alpha \\cdot 2^{m-1}$ for some integer $\\alpha$. Since $a+b < b+c = 2^m$, we have $\\alpha \\cdot 2^{m-1} < 2^m$, so $\\alpha < 2$. As $a,b>0$, $\\alpha$ must be 1. Therefore, $a+b=2^{m-1}$.","Let $a,b,c,d$ be odd integers such that $0<a<b<c<d$ and $ad=bc$. Prove that if $a+d=2^k$ and $b+c=2^m$ for some integers $k$ and $m$, then $a=1$.","From the given conditions, we can establish two key relations: $(b-a)(a+b) = 2^m(b-2^{k-m}a)$ and, as shown in the previous step, $a+b=2^{m-1}$. Substituting the second relation into the first gives $(b-a)2^{m-1} = 2^m(b-2^{k-m}a)$. Dividing by $2^{m-1}$ yields $b-a = 2(b-2^{k-m}a)$, which simplifies to $b+a = 2 \\cdot 2^{k-m}a = 2^{k-m+1}a$. We now have two expressions for $a+b$, so we can equate them: $2^{m-1} = 2^{k-m+1}a$. Since $a$ is an odd integer, this equality can only hold if the non-power-of-2 parts are equal, which means $a=1$. This in turn implies the powers of two must be equal, $2^{m-1}=2^{k-m+1}$, but the conclusion $a=1$ is reached regardless.",,,,
1983p2,"Let $A$ be one of the two distinct points of intersection of two unequal coplanar circles $C_1$ and $C_2$ with centers $O_1$ and $O_2$ respectively. One of the common tangents to the circles touches $C_1$ at $P_1$ and $C_2$ at $P_2$, while the other touches $C_1$ at $Q_1$ and $C_2$ at $Q_2$. Let $M_1$ be the midpoint of $P_1Q_1$ and $M_2$ the midpoint of $P_2Q_2$. Prove that $\angle O_1AO_2=\angle M_1AM_2$.","Let $A$ be one of the two distinct points of intersection of two unequal coplanar circles $C_1$ and $C_2$ with centers $O_1$ and $O_2$ respectively. Let $S$ be such point on line $O_1O_2$ so that tangents on $C_1$ touches it at $P_1$ and $Q_1$ and tangents on $C_2$ touches it at $P_2$ and $Q_2$. Let $M_1$ be the midpoint of $P_1Q_1$ and $M_2$ the midpoint of $P_2Q_2$. Prove that $\angle O_1AO_2 = \angle M_1AM_2$.

Proof: Since $S$ is image of $M_1$ under inversion wrt circle $C_1$ we have:\[\angle O_1AM_1 = \angle O_1M_1'A'= \angle O_1SA\]Since $S$ is image of $M_2$ under inversion wrt circle $C_2$ we have:\[\angle O_2SA= \angle O_2A'S'= \angle O_2AM_2\]Image of $A$ is in both cases $A$ itself, since it lies on both circles. Since $\angle O_1SA = \angle O_2SA$ we have:\[\angle M_1AO_1=\angle M_2AO_2\]Now:\[\angle O_1AO_2 = \angle M_1AM_2-\angle M_1AO_1+\angle M_2AO_2 = \angle M_1AM_2\]",2,Let $S$ be the intersection point of the common tangents. Prove that $\angle O_1AM_1 = \angle O_2AM_2$.,"Let S be the intersection of the common tangents, which lies on the line of centers $O_1O_2$. With respect to circle $C_1$, the point $S$ is the pole of the line containing the chord of contact $P_1Q_1$. The inverse of $S$ is $M_1$, the midpoint of $P_1Q_1$. Since $A$ is on circle $C_1$, it is its own inverse. A property of inversion on $\triangle O_1AM_1$ implies that $\angle O_1AM_1 = \angle O_1SA$. Similarly, for circle $C_2$, the inverse of $S$ is $M_2$ and the inverse of $A$ is $A$, which implies $\angle O_2AM_2 = \angle O_2SA$. As $S$, $O_1$, and $O_2$ are collinear, $\angle O_1SA = \angle O_2SA$. Therefore, $\angle O_1AM_1 = \angle O_2AM_2$.",Prove that $\angle O_1AO_2=\angle M_1AM_2$.,"From the first sub-problem, we have the equality $\angle O_1AM_1 = \angle O_2AM_2$. By considering the composition of angles around point A, we can write the identity $\angle O_1AO_2 = \angle M_1AM_2 - \angle M_1AO_1 + \angle O_2AM_2$. Using the equality $\angle O_1AM_1 = \angle O_2AM_2$ established previously, the last two terms cancel out. This simplifies the expression to $\angle O_1AO_2 = \angle M_1AM_2$.",,,,
1983p3,"Let $a$, $b$ and $c$ be positive integers, no two of which have a common divisor greater than $1$. Show that $2abc - ab - bc- ca$ is the largest integer which cannot be expressed in the form $xbc + yca + zab$, where $x$, $y$ and $z$ are non-negative integers.","First off, I prove $2abc-ab-bc-ca$ is un-achievable. Also, assume WLOG $a\ge b\ge c$.

Assume $2abc-bc-ca=xbc+yca+zab$, then take the equation $\pmod{ab}$ to give us $(x+1)bc+(y+1)ac\equiv 0\pmod{ab}$. By CRT and $\gcd(a,b)=1$, we take this equation mod a and mod b to give us $y+1\equiv 0\pmod{b}$, and $x+1\equiv 0\pmod{a}$ (and using all numbers are relatively prime pairwise). Substituting this back into the original equation gives us $z\le -1$, contradiction (this is where the $2abc$ part comes in).

Now, let $2abc-bc-ca-ab+k=xbc+yca+zab$, and if a solution exists where $bc-1\ge k\ge 1$ then we are done because we can add $1$ to $x$ always.

Consider the set $x=a-m$, where $m\in \{1,2,\cdots, a-1, a\}$ and $y=b-n$ where $n\in \{1,2,\cdots, b-1, b\}$.

Therefore, we get $2abc-bc-ca-ab+k=(a-m)bc+(b-n)ca+zab$. This is the same as $bc(m-1)+ca(n-1)+k=(z+1)ab$ after doing some simplifying. By CRT, this must hold mod a and mod b and because $\gcd(a,b)=1$. Mod $a$ gives us $bc(m-1)+k\equiv 0\pmod{a}$, for which a value of $m-1$ obviously exists mod $a$, which can be chosen from the set of values we have assigned for $m$. Similar method shows a value of $n-1$ exists mod $b$ from the set we have given to $n$.

Now, we already know that $x,y\ge 0$. Also, the LHS of the equation $bc(m-1)+ca(n-1)+k$ is at least $1$, therefore $z\ge 0$ and we are done.",2,"Show that $2abc - ab - bc - ca$ cannot be expressed in the form $xbc + yca + zab$, where $x$, $y$, and $z$ are non-negative integers.","Assume for contradiction that $2abc - ab - bc - ca = xbc + yca + zab$ for some non-negative integers $x, y, z$. Taking the equation modulo $a$, we have $-bc - ca \equiv xbc + yca + zab \pmod a$. This simplifies to $-bc \equiv xbc \pmod a$. Since $a, b, c$ are pairwise coprime, $\gcd(a, bc)=1$, so we can divide by $bc$ to get $x \equiv -1 \pmod a$. As $x$ must be non-negative, $x+1$ is a positive multiple of $a$, so $x = k_1a - 1$ for some integer $k_1 \ge 1$. Similarly, taking the equation modulo $b$ gives $y \equiv -1 \pmod b$, which implies $y = k_2b - 1$ for some integer $k_2 \ge 1$. Substituting these expressions for $x$ and $y$ back into the original equation gives $2abc - ab - bc - ca = (k_1a - 1)bc + (k_2b - 1)ca + zab$. Simplifying, we get $2abc - ab = k_1abc + k_2abc + zab$. Dividing by $ab$ yields $2c - 1 = (k_1+k_2)c + z$. This implies $z = (2 - k_1 - k_2)c - 1$. Since $k_1 \ge 1$ and $k_2 \ge 1$, their sum $k_1+k_2 \ge 2$. Thus, $z \le (2-2)c - 1 = -1$. This contradicts the condition that $z$ is a non-negative integer. Therefore, the assumption is false and $2abc - ab - bc - ca$ cannot be expressed in the given form.","Let $a$, $b$ and $c$ be positive integers, no two of which have a common divisor greater than $1$. Show that $2abc - ab - bc- ca$ is the largest integer which cannot be expressed in the form $xbc + yca + zab$, where $x$, $y$ and $z$ are non-negative integers.","From the first sub-problem, we know that $N = 2abc - ab - bc - ca$ cannot be represented in the given form. We now show that any integer $K > N$ can be represented. Let $K = N+k$ for some integer $k \ge 1$. We seek non-negative integers $x, y, z$ such that $xbc + yca + zab = 2abc - ab - bc - ca + k$. Let's seek a solution with $x=a-m$ and $y=b-n$ for integers $m \in \{1, ..., a\}$ and $n \in \{1, ..., b\}$. This ensures $x \in \{0, ..., a-1\}$ and $y \in \{0, ..., b-1\}$ are non-negative. Substituting these into the equation gives $(a-m)bc + (b-n)ca + zab = 2abc - ab - bc - ca + k$. After simplification, this becomes $(m-1)bc + (n-1)ca + k = (z+1)ab$. We need to find appropriate $m, n, z$. Considering this equation modulo $a$, we get $(m-1)bc + k \equiv 0 \pmod a$. Since $\gcd(a, bc)=1$, there is a unique solution for $m-1$ modulo $a$. We can choose this solution to be in $\{0, ..., a-1\}$, which corresponds to a unique $m \in \{1, ..., a\}$. Similarly, modulo $b$, we have $(n-1)ca + k \equiv 0 \pmod b$. Since $\gcd(b, ca)=1$, there is a unique solution for $n-1$ in $\{0, ..., b-1\}$, which gives a unique $n \in \{1, ..., b\}$. For these specific values of $m$ and $n$, the left-hand side, $(m-1)bc + (n-1)ca + k$, is divisible by both $a$ and $b$. Since $\gcd(a,b)=1$, it must be divisible by $ab$. Thus, $z+1 = \frac{(m-1)bc + (n-1)ca + k}{ab}$ is an integer. Since $m \ge 1, n \ge 1, k \ge 1$, the numerator is at least $1$. As the numerator is a positive integer divisible by $ab$, we must have $(z+1)ab \ge ab$, which implies $z+1 \ge 1$, so $z \ge 0$. We have found non-negative integers $x,y,z$ for any integer greater than $N$, so $N$ is the largest such non-representable integer.",,,,
1982p2,"A non-isosceles triangle $A_{1}A_{2}A_{3}$ has sides $a_{1}$, $a_{2}$, $a_{3}$ with the side $a_{i}$ lying opposite to the vertex $A_{i}$. Let $M_{i}$ be the midpoint of the side $a_{i}$, and let $T_{i}$ be the point where the inscribed circle of triangle $A_{1}A_{2}A_{3}$ touches the side $a_{i}$. Denote by $S_{i}$ the reflection of the point $T_{i}$ in the interior angle bisector of the angle $A_{i}$. Prove that the lines $M_{1}S_{1}$, $M_{2}S_{2}$ and $M_{3}S_{3}$ are concurrent.","Rename the vertices so that $A_1=A,A_2=B$ and $A_3=C$. Let $I$ be the incenter of $\triangle ABC$.

Claim 1: $S_1, S_2, S_3$ all lie on the incircle. Proof: By construction, $IS_1$ is the reflection of $IT_1$ with respect to the $A$ angle bisector since $I$ lies on the angle bisector of $A$. So, $IS_1=IT_1$ so $S_1$ lies on the incircle. Similarly, $S_2$ and $S_3$ lie on the incircle. $\Box$


Note that $I$ is the circumcenter of $\triangle S_1S_2S_3$ because of equal radii due to Claim 1.


Claim 2: $\angle S_1IS_2=2\angle C.$ Proof: In cyclic quadrilateral $T_1IT_2C$, $\angle T_1IT_2=180^{\circ}-\angle C$. Let $D$ be the point where the $A$ angle bisector intersects $BC$. Due to the construction of $S_1$, $\angle S_1IT_1=2\angle DIT_1.$ But, $\angle ADC=180^{\circ}-\angle C-\frac{1}{2}\angle A$ so $\angle DIT_1=\frac{1}{2}\angle A+\angle C-90^{\circ}.$ Thus,\[\angle S_1IT_1=\angle A+2\angle C-180^{\circ}.\]Similarly, $\angle S_2IT_2=\angle B+2\angle C-180^{\circ}.$ Therefore, $\angle S_1IS_2=\angle S_1IT_1+\angle T_1IT_2+\angle T_2IS_2=2\angle C.$$\Box$


Hence, we use Claim 2 to get $\angle S_1S_3S_2=\frac{1}{2}\angle S_1IS_2=\angle C$ and we similarly get $\angle S_3S_1S_2=\angle A$ and $\angle S_1S_2S_3=\angle B.$


Claim 3: Let $X_1$ be the midpoint of $S_2S_3.$ Then, $T_1IX_1$ is collinear. Proof: We already derived that $\angle T_1IT_2=180^{\circ}-\angle C$ and $\angle S_2IT_2=\angle B+2\angle C-180^{\circ}.$ Recall that a radius is perpendicular to the midpoint of a chord so $S_2S_3\perp IX_1.$ Then, $\angle X_1IS_2=90^{\circ}-\angle X_1S_2I=90^{\circ}-(90^{\circ}-\angle A)=\angle A.$ Thus,\[\angle T_1IX_1=\angle X_1IS_2+\angle S_2IT_2+\angle T_2IT_1=\angle A+\angle B+2\angle C-180^{\circ}+180^{\circ}-\angle C=180^{\circ},\]as desired.$\Box$


Then, $T_1IX_1\perp S_2S_3$ because a diameter is perpendicular to a chord at its midpoint and because $T_1IX_1$ is part of a diameter, by Claim 3. Hence, $S_2S_3\parallel BC.$ But, $M_2M_3\parallel BC$ so $S_2S_3\parallel M_2M_3$. Similarly, we get $S_1S_2\parallel M_1M_2$ and $S_1S_3\parallel M_1M_3$ so $\triangle M_1M_2M_3\sim \triangle S_1S_2S_3$ with corresponding parallel sides. Thus, there exists a homothety that maps $M_1M_2M_3$ to $S_1S_2S_3$ and $M_1S_1, M_2S_2,$ and $M_3S_3$ intersect at the center of the homothety. $\blacksquare$",3,"Show that the points $S_1, S_2, S_3$ lie on the incircle of $\triangle A_1A_2A_3$ and that $\triangle S_1S_2S_3$ is similar to $\triangle A_1A_2A_3$, with $\angle S_i = \angle A_i$ for $i=1,2,3$.","Let $I$ be the incenter of $\triangle A_1A_2A_3$. Since $I$ lies on the angle bisector of $A_i$, which is the line of reflection for $T_i$ to $S_i$, we have $IS_i = IT_i$. As $IT_i$ is the inradius, all points $S_i$ lie on the incircle. Thus, the incircle of $\triangle A_1A_2A_3$ is the circumcircle of $\triangle S_1S_2S_3$. By calculating the central angles subtended by the sides of $\triangle S_1S_2S_3$ at the center $I$, we find $\angle S_2IS_3 = 2\angle A_1$, $\angle S_3IS_1 = 2\angle A_2$, and $\angle S_1IS_2 = 2\angle A_3$. The inscribed angles in $\triangle S_1S_2S_3$ are half of these central angles, so $\angle S_2S_1S_3 = \angle A_1$, $\angle S_3S_2S_1 = \angle A_2$, and $\angle S_1S_3S_2 = \angle A_3$. Therefore, $\triangle S_1S_2S_3$ is similar to $\triangle A_1A_2A_3$.","Prove that the sides of $\triangle S_1S_2S_3$ are parallel to the corresponding sides of $\triangle A_1A_2A_3$. That is, show $S_2S_3 \parallel A_2A_3$, $S_3S_1 \parallel A_3A_1$, and $S_1S_2 \parallel A_1A_2$.","Let $I$ be the incenter. The radius $IT_1$ is perpendicular to the side $a_1 = A_2A_3$. Let $X_1$ be the midpoint of the chord $S_2S_3$ of the incircle. Then the radius $IX_1$ is perpendicular to the chord $S_2S_3$. A detailed angle calculation shows that the points $T_1$, $I$, and $X_1$ are collinear, meaning $\angle T_1IX_1 = 180^\circ$. This is because $\angle T_1IX_1 = \angle T_1IT_2 + \angle T_2IS_2 + \angle S_2IX_1 = (180^\circ - \angle A_3) + (\angle A_2 + 2\angle A_3 - 180^\circ) + (\angle A_1) = \angle A_1+\angle A_2+\angle A_3 = 180^\circ$. Since $T_1, I, X_1$ are collinear, the line through them is perpendicular to both $A_2A_3$ (at $T_1$) and $S_2S_3$ (at $X_1$). Therefore, $A_2A_3 \parallel S_2S_3$. By cyclic permutation of indices, we also get $A_3A_1 \parallel S_3S_1$ and $A_1A_2 \parallel S_1S_2$.","Prove that the lines $M_1S_1$, $M_2S_2$ and $M_3S_3$ are concurrent.","The triangle $\triangle M_1M_2M_3$ is the medial triangle of $\triangle A_1A_2A_3$. Its sides are parallel to the sides of $\triangle A_1A_2A_3$. For example, $M_2M_3$ connects the midpoints of sides $a_2$ and $a_3$, so $M_2M_3 \parallel a_1 = A_2A_3$. From the previous sub-problem, we have $S_2S_3 \parallel A_2A_3$. Thus, $M_2M_3 \parallel S_2S_3$. Similarly, $M_3M_1 \parallel S_3S_1$ and $M_1M_2 \parallel S_1S_2$. Since the corresponding sides of $\triangle M_1M_2M_3$ and $\triangle S_1S_2S_3$ are parallel, the two triangles are homothetic. The lines connecting corresponding vertices, namely $M_1S_1$, $M_2S_2$, and $M_3S_3$, must all pass through the center of this homothety, and are therefore concurrent.",,
1982p4,"Prove that if $n$ is a positive integer such that the equation $x^3-3xy^2+y^3=n$ has a solution in integers $x,y$, then it has at least three such solutions. Show that the equation has no solutions in integers for $n=2891$.","Suppose the equation $x^3-3xy^2+y^3=n$ has solution in integers $(x,y)$ with $y=x+k$. Then, completing the cube yields $(y-x)^3-3x^2y+2x^3$. Using the substitution $y=x+k$ yields $k^3-3kx^2-x^3=n$. Notice that equality directly implies that $(k,-x)$ is also a solution to the original equation. Applying the transformation again yields that $(-x-k,-k)$ is also a solution. We show that these three solutions are indeed distinct: If $(x,y)=(k,-x)$ then $x=k,x+k=-x$ which only has solution $x=k=0$ which implies that $n$ is not a positive integer, a contradiction. Similarly, since the transformation from $(k,-x)$ to $(-x-k,-k)$ and $(-x-k,-k)$ to $(x,y)$ is the same as the transformation from $(x,y)$ to $(k,-x)$, we have that the three solutions are pairwise distinct.

For the case $n=2891$, notice that $7|n$. Considering all solutions modulo $7$ of the equation $x^3-3xy^2+y^3\equiv0\pmod{7}$ yields only $x\equiv y\equiv 0\pmod{7}$. But, this implies that $7^3$ divides $2891$ which is clearly not true.",2,"Let the equation be $x^3-3xy^2+y^3=n$. Show that if $(x,y)$ is an integer solution, then by letting $k=y-x$, the pair $(k, -x)$ is also an integer solution.","Substituting $y=x+k$ into the expression $x^3-3xy^2+y^3$ transforms the equation to $k^3-3kx^2-x^3=n$. Now, we evaluate the expression for the pair $(k, -x)$: it is $k^3 - 3k(-x)^2 + (-x)^3 = k^3 - 3kx^2 - x^3$. Since this expression is equal to $n$, the pair $(k,-x)$ is also a solution.","Prove that if $n$ is a positive integer such that the equation $x^3-3xy^2+y^3=n$ has a solution in integers $x,y$, then it has at least three such solutions. Show that the equation has no solutions in integers for $n=2891$.","If $(x,y)$ is a solution, Sub-problem 1 shows that $(y-x, -x)$ is another solution. Applying the same transformation to $(y-x, -x)$ yields a third solution, $(-y, x-y)$. These three solutions are distinct for positive $n$, because any equality between two of them (e.g., $(x,y)=(y-x,-x)$) implies $x=y=0$ and thus $n=0$, contradicting that $n$ is a positive integer. For $n=2891$, note that $2891 \equiv 0 \pmod 7$. Any solution must satisfy $x^3-3xy^2+y^3 \equiv 0 \pmod 7$, which holds only if $x \equiv y \equiv 0 \pmod 7$. Let $x=7a, y=7b$. Substituting into the original equation gives $343(a^3-3ab^2+b^3)=2891$. This is a contradiction, as $2891 = 7^2 \cdot 59$ is not divisible by $7^3=343$. Thus, no integer solution exists.",,,,
1982p6,"Let $S$ be a square with sides length $100$. Let $L$ be a path within $S$ which does not meet itself and which is composed of line segments $A_0A_1,A_1A_2,A_2A_3,\ldots,A_{n-1}A_n$ with $A_0=A_n$. Suppose that for every point $P$ on the boundary of $S$ there is a point of $L$ at a distance from $P$ no greater than $\frac {1} {2}$. Prove that there are two points $X$ and $Y$ of $L$ such that the distance between $X$ and $Y$ is not greater than $1$ and the length of the part of $L$ which lies between $X$ and $Y$ is not smaller than $198$.","Let the square be A'B'C'D'. The idea is to find points of L close to a particular point of A'D' but either side of an excursion to B'.

We say L approaches a point P' on the boundary of the square if there is a point P on L with PP' 锟斤拷锟?1/2. We say L approaches P' before Q' if there is a point P on L which is nearer to A0 (the starting point of L) than any point Q with QQ' 锟斤拷锟?1/2.

Let A' be the first vertex of the square approached by L. L must subsequently approach both B' and D'. Suppose it approaches B' first. Let B be the first point on L with BB' 锟斤拷锟?1/2. We can now divide L into two parts L1, the path from A0 to B, and L2, the path from B to An.

Take X' to be the point on A'D' closest to D' which is approached by L1. Let X be the corresponding point on L1. Now every point on X'D' must be approached by L2 (and X'D' is non-empty, because we know that D' is approached by L but not by L1). So by compactness X' itself must be approached by L2. Take Y to be the corresponding point on L2. XY 锟斤拷锟?XX' + X'Y 锟斤拷锟?1/2 + 1/2 = 1. Also BB' 锟斤拷锟?1/2, so XB 锟斤拷锟?X'B' - XX' - BB' 锟斤拷锟?X'B' - 1 锟斤拷锟?A'B' - 1 = 99. Similarly YB 锟斤拷锟?99, so the path XY 锟斤拷锟?198.",3,"Let the square's vertices be $A', B', C', D'$ in order. Show that the path $L$ can be divided at a point $B$ into two sub-paths, $L_1$ and $L_2$, such that $L_1$ approaches two adjacent vertices (e.g., $A'$ and $B'$), while another vertex ($D'$) is only approached by $L_2$.","Order the points on the path $L$ by their distance from the start $A_0$. Let $A'$ be the first vertex of the square approached by $L$. Assume without loss of generality that its neighbor $B'$ is approached before its other neighbor $D'$. Let $B$ be the first point on $L$ with distance $d(B, B') \le 1/2$. This point $B$ splits $L$ into $L_1$ (from $A_0$ to $B$) and $L_2$ (from $B$ to $A_n$). By construction, $L_1$ approaches $A'$ and $B'$. Since $D'$ is approached later than $B'$, no point on $L_1$ can be within $1/2$ of $D'$. Therefore, any point on $L$ that approaches $D'$ must lie on $L_2$.","Using the path partition from the previous step, prove that there exist a point $X'$ on the side $A'D'$ and points $X$ on $L_1$ and $Y$ on $L_2$ such that $d(X, X') \le 1/2$ and $d(Y, X') \le 1/2$.","Let $S_1$ be the set of points on side $A'D'$ approached by $L_1$. $S_1$ is non-empty (as $A'$ is in it) and closed. Let $X'$ be the point in $S_1$ closest to $D'$. By definition, there is a point $X \in L_1$ with $d(X, X') \le 1/2$. Any point on the boundary segment $(X', D']$ must be approached by $L_2$. Since the set of points approached by $L_2$ is closed, $X'$ must also be approached by $L_2$. Therefore, there exists a point $Y \in L_2$ such that $d(Y, X') \le 1/2$.","Let $S$ be a square with sides length $100$. Let $L$ be a path within $S$ which does not meet itself and which is composed of line segments $A_0A_1,A_1A_2,A_2A_3,\ldots,A_{n-1}A_n$ with $A_0=A_n$. Suppose that for every point $P$ on the boundary of $S$ there is a point of $L$ at a distance from $P$ no greater than $\frac {1} {2}$. Prove that there are two points $X$ and $Y$ of $L$ such that the distance between $X$ and $Y$ is not greater than $1$ and the length of the part of $L$ which lies between $X$ and $Y$ is not smaller than $198$.","From the previous steps, there exist points $X \in L_1$, $Y \in L_2$, and a point $X'$ on side $A'D'$ such that $d(X, X') \le 1/2$ and $d(Y, X') \le 1/2$. The Euclidean distance is $d(X, Y) \le d(X, X') + d(X', Y) \le 1/2 + 1/2 = 1$. The path segment between $X$ and $Y$ that contains $B$ has length $l(X,B) + l(B,Y)$. Since path length is greater than or equal to Euclidean distance, $l(X,B) \ge d(X,B) \ge d(X',B') - d(X,X') - d(B,B')$. As $X'$ is on $A'D'$, $d(X',B') \ge 100$. Thus, $l(X,B) \ge 100 - 1/2 - 1/2 = 99$. Similarly, $l(Y,B) \ge 99$. The total path length is at least $99 + 99 = 198$.",,
1981p2,"Let $1 \le r \le n$ and consider all subsets of $r$ elements of the set $\{ 1, 2, \ldots , n \}$. Each of these subsets has a smallest member. Let $F(n,r)$ denote the arithmetic mean of these smallest numbers; prove that

$F(n,r) = \frac{n+1}{r+1}.$","Clearly, the sum of the desired least elements is $\sum_{k=1}^{n} k {n-k \choose r-1} = \sum_{k=1}^{n} {k \choose 1}{n-k \choose r-1}$, which we claim to be equal to ${n+1 \choose r+1}$ by virtue of the following argument.

Consider a binary string of length $n+1$ which contains $r+1$ 1s. For some value of $k$ between 1 and $n$, inclusive, we say that the second 1 will occur in the $(k+1)$th place. Clearly, there are ${k \choose 1}$ ways to arrange the bits coming before the second 1, and ${n-k \choose r-1}$ ways to arrange the bits after the second 1. Our identity follows.

Since the sum of the least elements of the sets is ${n+1 \choose r+1}$, the mean of the least elements is $\frac{{n+1 \choose r+1}}{{n \choose r}} = \frac{n+1}{r+1}$",2,"Let $S$ be the sum of the smallest members of all $r$-element subsets of $\{1, 2, \ldots, n\}$. Prove that $S = \binom{n+1}{r+1}$.","The number of $r$-element subsets of $\{1, 2, \ldots, n\}$ whose smallest member is $k$ is given by $\binom{n-k}{r-1}$, as the other $r-1$ elements must be chosen from the $n-k$ elements larger than $k$. The sum of all smallest members is therefore $S = \sum_{k=1}^{n} k \binom{n-k}{r-1}$. We prove this sum equals $\binom{n+1}{r+1}$ via a combinatorial argument. The number of binary strings of length $n+1$ with $r+1$ ones is $\binom{n+1}{r+1}$. Alternatively, if we condition on the position of the second '1' being at index $k+1$, there are $\binom{k}{1}=k$ choices for the first '1' (at an index from $1$ to $k$) and $\binom{n-k}{r-1}$ choices for the remaining $r-1$ ones (at indices from $k+2$ to $n+1$). Summing over all possible $k$ from $1$ to $n$ gives $\sum_{k=1}^{n} k \binom{n-k}{r-1}$. Equating the two counting methods gives $S = \binom{n+1}{r+1}$.","Let $1 \le r \le n$ and consider all subsets of $r$ elements of the set $\{ 1, 2, \ldots , n \}$. Each of these subsets has a smallest member. Let $F(n,r)$ denote the arithmetic mean of these smallest numbers; prove that\n\n$F(n,r) = \frac{n+1}{r+1}.$","The total number of $r$-element subsets is $\binom{n}{r}$. The sum of the smallest members of all these subsets is $S = \binom{n+1}{r+1}$, as established in the previous step. The arithmetic mean $F(n,r)$ is the total sum divided by the number of subsets. Therefore, $F(n,r) = \frac{S}{\binom{n}{r}} = \frac{\binom{n+1}{r+1}}{\binom{n}{r}} = \frac{(n+1)!/((r+1)!(n-r)!)}{n!/(r!(n-r)!)} = \frac{(n+1)!}{(r+1)!(n-r)!} \\cdot \frac{r!(n-r)!}{n!} = \frac{n+1}{r+1}$.",,,,
1981p5,Three congruent circles have a common point $O$ and lie inside a given triangle. Each circle touches a pair of sides of the triangle. Prove that the incenter and the circumcenter of the triangle and the point $O$ are collinear.,"Let the triangle have vertices $A,B,C$, and sides $a,b,c$, respectively, and let the centers of the circles inscribed in the angles $A,B,C$ be denoted $O_A, O_B, O_C$, respectively.

The triangles $O_A O_B O_C$ and $ABC$ are homothetic, as their corresponding sides are parallel. Furthermore, since $O_A$ lies on the bisector of angle $A$ and similar relations hold for the triangles' other corresponding points, the center of homothety is the incenter of both the triangles. Since $O$ is clearly the circumcenter of $O_A O_B O_C$, $O$ is collinear with the incenter and circumcenter of $ABC$, as desired.",1,Three congruent circles have a common point $O$ and lie inside a given triangle. Each circle touches a pair of sides of the triangle. Prove that the incenter and the circumcenter of the triangle and the point $O$ are collinear.,"Let the triangle have vertices $A,B,C$, and sides $a,b,c$, respectively, and let the centers of the circles inscribed in the angles $A,B,C$ be denoted $O_A, O_B, O_C$, respectively.

The triangles $O_A O_B O_C$ and $ABC$ are homothetic, as their corresponding sides are parallel. Furthermore, since $O_A$ lies on the bisector of angle $A$ and similar relations hold for the triangles' other corresponding points, the center of homothety is the incenter of both the triangles. Since $O$ is clearly the circumcenter of $O_A O_B O_C$, $O$ is collinear with the incenter and circumcenter of $ABC$, as desired.",,,,,,
1979p1,"If $p$ and $q$ are natural numbers so that\[\frac{p}{q}=1-\frac{1}{2}+\frac{1}{3}-\frac{1}{4}+ \ldots -\frac{1}{1318}+\frac{1}{1319},\]prove that $p$ is divisible with $1979$.","We first write \begin{align*} \frac{p}{q} &=1-\frac{1}{2}+\frac{1}{3}-\frac{1}{4}+\cdots-\frac{1}{1318}+\frac{1}{1319}\\ &=1+\frac{1}{2}+\cdots+\frac{1}{1319}-2\cdot\left(\frac{1}{2}+\frac{1}{4}+\cdots+\frac{1}{1318}\right)\\ &=1+\frac{1}{2}+\cdots+\frac{1}{1319}-\left(1+\frac{1}{2}+\cdots+\frac{1}{659}\right)\\ &=\frac{1}{660}+\frac{1}{661}+\cdots+\frac{1}{1319} \end{align*}Now, observe that \begin{align*} \frac{1}{660}+\frac{1}{1319}=\frac{660+1319}{660\cdot 1319}=\frac{1979}{660\cdot 1319} \end{align*}and similarly $\frac{1}{661}+\frac{1}{1318}=\frac{1979}{661\cdot 1318}$ and $\frac{1}{662}+\frac{1}{1317}=\frac{1979}{662\cdot 1317}$, and so on. We see that the original equation becomes \begin{align*} \frac{p}{q} =\frac{1979}{660\cdot 1319}+\frac{1979}{661\cdot 1318}+\cdots+\frac{1979}{989\cdot 990}=1979\cdot\frac{r}{s} \end{align*}where $s=660\cdot 661\cdots 1319$ and $r=\frac{s}{660\cdot 1319}+\frac{s}{661\cdot 1318}+\cdots+\frac{s}{989\cdot 990}$ are two integers. Finally consider $p=1979\cdot\frac{qr}{s}$, and observe that $s\nmid 1979$ because $1979$ is a prime, it follows that $\frac{qr}{s}\in\mathbb{Z}$. Hence we deduce that $p$ is divisible with $1979$.",1,"If $p$ and $q$ are natural numbers so that\[\frac{p}{q}=1-\frac{1}{2}+\frac{1}{3}-\frac{1}{4}+ \ldots -\frac{1}{1318}+\frac{1}{1319},\]prove that $p$ is divisible with $1979$.","We first write \begin{align*} \frac{p}{q} &=1-\frac{1}{2}+\frac{1}{3}-\frac{1}{4}+\cdots-\frac{1}{1318}+\frac{1}{1319}\\ &=1+\frac{1}{2}+\cdots+\frac{1}{1319}-2\cdot\left(\frac{1}{2}+\frac{1}{4}+\cdots+\frac{1}{1318}\right)\\ &=1+\frac{1}{2}+\cdots+\frac{1}{1319}-\left(1+\frac{1}{2}+\cdots+\frac{1}{659}\right)\\ &=\frac{1}{660}+\frac{1}{661}+\cdots+\frac{1}{1319} \end{align*}Now, observe that \begin{align*} \frac{1}{660}+\frac{1}{1319}=\frac{660+1319}{660\cdot 1319}=\frac{1979}{660\cdot 1319} \end{align*}and similarly $\frac{1}{661}+\frac{1}{1318}=\frac{1979}{661\cdot 1318}$ and $\frac{1}{662}+\frac{1}{1317}=\frac{1979}{662\cdot 1317}$, and so on. We see that the original equation becomes \begin{align*} \frac{p}{q} =\frac{1979}{660\cdot 1319}+\frac{1979}{661\cdot 1318}+\cdots+\frac{1979}{989\cdot 990}=1979\cdot\frac{r}{s} \end{align*}where $s=660\cdot 661\cdots 1319$ and $r=\frac{s}{660\cdot 1319}+\frac{s}{661\cdot 1318}+\cdots+\frac{s}{989\cdot 990}$ are two integers. Finally consider $p=1979\cdot\frac{qr}{s}$, and observe that $s\nmid 1979$ because $1979$ is a prime, it follows that $\frac{qr}{s}\in\mathbb{Z}$. Hence we deduce that $p$ is divisible with $1979$.",,,,,,
1979p2,"We consider a prism which has the upper and inferior basis the pentagons: $A_{1}A_{2}A_{3}A_{4}A_{5}$ and $B_{1}B_{2}B_{3}B_{4}B_{5}$. Each of the sides of the two pentagons and the segments $A_{i}B_{j}$ with $i,j=1,\ldots$,5 is colored in red or blue. In every triangle which has all sides colored there exists one red side and one blue side. Prove that all the 10 sides of the two basis are colored in the same color.","Let us prove first that the edges $A_1A_2,A_2A_3,\cdots ,A_5A_1$ are of the same color. Assume the contrary, and let w.l.o.g. $A_1A_2$ be red and $A_2A_3$ be green. Three of the segments $A_2B_l, (l = 1, 2, 3, 4, 5)$, say $A_2B_i,A_2B_j,A_2B_k$,have to be of the same color, let it w.l.o.g. be red. Then $A_1B_i,A_1B_j,A_1B_k$ must be green. At least one of the sides of triangle $B_iB_jB_k$, say $B_iB_j$ ,must be an edge of the prism. Then looking at the triangles $A_1B_iB_j$ and $A_2B_iB_j$ we deduce that $B_iB_j$ can be neither green nor red, which is acontradiction. Hence all five edges of the pentagon $A_1A_2A_3A_4A_5$ have thesame color. Similarly, all five edges of $B_1B_2B_3B_4B_5$ have the same color.We now show that the two colors are the same. Assume otherwise, i.e.,that w.l.o.g. the $A$ edges are painted red and the $B$ edges green. Let us call segments of the form $A_iB_j$ diagonal ($i$ and $j$ may be equal). We now count the diagonal segments by grouping the red segments based on their $A$ point, and the green segments based on their $B$ point. As above, the assumption that three of $A_iB_j$ for fixed $i$ are red leads to a contradiction. Hence at most two diagonal segments out of each $A_i$ may be red, which counts up to at most $10$ red segments. Similarly, at most $10$ diagonal segments can be green. But then we can paint at most $20$ diagonal segments out of $25$, which is a contradiction. Hence all edges in the pentagons $A_1A_2A_3A_4A_5$ and $B_1B_2B_3B_4B_5$ have the same color.",3,"Prove that for each pentagonal base, all five of its sides must be the same color.","Assume for contradiction that a pentagonal base, say $A_1A_2A_3A_4A_5$, has sides of different colors. Let $A_1A_2$ be red and $A_2A_3$ be blue. By the Pigeonhole Principle, among the five segments connecting $A_2$ to the other base ($A_2B_1, ..., A_2B_5$), at least three must have the same color. Let's assume $A_2B_i, A_2B_j, A_2B_k$ are red. In triangle $\triangle A_1A_2B_i$, sides $A_1A_2$ and $A_2B_i$ are red, so to avoid a monochromatic triangle, side $A_1B_i$ must be blue. The same logic applies to $A_1B_j$ and $A_1B_k$, which must also be blue. Now consider $\triangle A_1B_iB_j$. Its sides $A_1B_i$ and $A_1B_j$ are both blue, so $B_iB_j$ must be red. However, in $\triangle A_2B_iB_j$, sides $A_2B_i$ and $A_2B_j$ are both red, so $B_iB_j$ must be blue. A segment cannot be both red and blue, which is a contradiction. Therefore, all five sides of any base must have the same color.","Assume the sides of pentagon $A_1...A_5$ are all one color (e.g., red) and the sides of pentagon $B_1...B_5$ are all the other color (e.g., blue). Show that this assumption leads to a contradiction by analyzing the coloring of the segments $A_iB_j$.","Assume the sides of pentagon A are red and pentagon B are blue. Consider the $5 \times 5 = 25$ segments $A_iB_j$. For any vertex $A_i$, assume three segments, say $A_iB_j, A_iB_k, A_iB_l$, are red. The side $A_{i-1}A_i$ is also red. In $\triangle A_{i-1}A_iB_j$, two sides are red, so $A_{i-1}B_j$ must be blue. This holds for $k,l$ too. Then in $\triangle A_{i-1}B_jB_k$, sides $A_{i-1}B_j$ and $A_{i-1}B_k$ are blue, so $B_jB_k$ must be red. However, in $\triangle A_iB_jB_k$, sides $A_iB_j$ and $A_iB_k$ are red, so $B_jB_k$ must be blue. This is a contradiction. Therefore, at most two segments $A_iB_j$ from any given $A_i$ can be red, limiting the total number of red $A_iB_j$ segments to $5 \times 2 = 10$. A symmetric argument shows at most two segments $A_iB_j$ to any given $B_j$ can be blue, limiting the total number of blue segments to $5 \times 2 = 10$. This allows for at most $10+10=20$ colored segments, but there are 25 segments in total, which is a contradiction.",Prove that all the 10 sides of the two basis are colored in the same color.,"From the first sub-problem, we know that all 5 sides of pentagon A must have the same color, and all 5 sides of pentagon B must have the same color. Let's assume for contradiction that these two colors are different, for instance, all sides of A are red and all sides of B are blue. From the second sub-problem, this assumption leads to a contradiction because it's impossible to color all 25 segments $A_iB_j$ while respecting the no-monochromatic-triangle rule. Specifically, we showed there could be at most 10 red segments and at most 10 blue segments of type $A_iB_j$, totaling at most 20 colored segments out of 25. Therefore, the initial assumption that the bases have different colors must be false. Hence, all 10 sides of the two bases must be the same color.",,
1979p3,"Two circles in a plane intersect. $A$ is one of the points of intersection. Starting simultaneously from $A$ two points move with constant speed, each travelling along its own circle in the same sense. The two points return to $A$ simultaneously after one revolution. Prove that there is a fixed point $P$ in the plane such that the two points are always equidistant from $P.$","Let $O_1, O_2$ be the centers of the 2 circles and let the points B, C move on the circles $(O_1), (O_2)$, recpectively. Let A' be the other intersection of the 2 circles different from the point A. Since the angles $\angle BO_1A = \angle CO_2A$ are equal, the isosceles triangles $\triangle AO_1B \sim \triangle AO_2C$ are similar. Consequently, the angles $\angle BAO_1 = \angle CAO_2$ are equal and the angles

$\angle BAC = BAO_1 + \angle O_1AO_2 + \angle O_2AC =$

$= BAO_1 + \angle O_1AO_2 - \angle CAO_2 = \angle O_1AO_2$

are also equal. The angles $\angle A'BA = \frac{\angle A'O_1A}{2} = \angle O_2O_1A$ are equal and the angles $\angle A'CA = \frac{\angle A'O_2A}{2} = \angle O_1O_2A$ are also equal. As a result, the point A' is on the side BC of the triangle $\triangle ABC$, which is always similar to the fixed triangle $\triangle O_1AO_2$.

Lemma (Yaglom's Geometric Transformations II, pp 68-69). Assume that a figure F' (the triangle $\triangle ABC$) moves in such a way that it remains at all times similar to a fixed figure F (the triangle $\triangle O_1AO_2$) and in addition, some point of the figure F' does not move at all (the point A). If a point B of the figure F' describes a curve $\Gamma$ (the circle $(O_1)$), then any other point M of the figure F' describes a curve $\Gamma'$ similar to the curve $\Gamma$.

Consequently, the midpoint M of the segment BC decribes a circle (Q). When the points B, C, become identical with the point A, the midpoint M of BC also becomes identical with A. Hence, the circle (Q) passes through the point A. The line BC always passes through A'. Just after the start of motion counter-clockwise, the points B, C, A' follow on the line BC in this order. The points B, C both pass through the point A' one after another and just before the end of one period of motion, the points A', B, C follow on the line BC In this order. From the continuity principle, the midpoint M of BC also passes through the point A' and consequently, the circle (Q), the locus of the midpoints M, also passes through the point A'. Thus the circle (Q) belongs to the same pencil with the circles $(O_1), (O_2)$ and it is centered on their center line $O_1O_2$. Let p be the perpendicular bisector of the segment BC intersectong the circle (Q) at a point P different from the point M. The point A' and the circle (Q) passing through this point are fixed and the angle $\angle A'MP = 90^\circ$ is right. Therefore, A'P is a fixed diameter of the circle (Q), which means that the point P is also fixed. Q.E.D.

When the points B, C are both diametrally opposite to the point A on their respective circles, the segment $O_1O_2$ is the midline of the triangle $\triangle ABC$, i.e., $BC \parallel O_1O_2$, $BC \perp AA'$. The cyclic quadrilateral AA'MP inscribed in the circle (Q) is then a rectangle. Its circumcenter Q is the intersection of its diagonals AM, A'P intersecting at their midpoint and the midpoint of AM is identical with the midpoint of $O_1O_2$. Thus the fixed point P is the reflection of the intersection A' of the circles $(O_1), (O_2)$ in the midpoint Q of the segment $O_1O_2$.",4,"Let the two circles be $(O_1)$ and $(O_2)$ intersecting at A. Let points B on $(O_1)$ and C on $(O_2)$ move such that they complete a revolution in the same time and in the same sense, starting from A. Show that the triangle $\triangle ABC$ is always similar to the fixed triangle $\triangle O_1AO_2$.","The condition that the points complete a revolution in the same time means their angular velocities are equal. Let this be $\omega$. At any time $t$, the angles swept are $\angle AO_1B = \angle AO_2C = \omega t$. Since $\triangle AO_1B$ and $\triangle AO_2C$ are isosceles triangles ($O_1A=O_1B$, $O_2A=O_2C$) with equal vertex angles, they are similar. This similarity implies $\angle BAO_1 = \angle CAO_2$ and the ratio of sides $AB/AC = AO_1/AO_2 = r_1/r_2$ is constant. The angle $\angle BAC = \angle BAO_1 + \angle O_1AO_2 - \angle CAO_2 = \angle O_1AO_2$. Since $\triangle ABC$ has a fixed angle $\angle BAC$ and a fixed ratio of adjacent sides $AB/AC$, all triangles $\triangle ABC$ are similar to the fixed triangle $\triangle O_1AO_2$.",Let A' be the other intersection point of the two circles $(O_1)$ and $(O_2)$. Show that the line BC connecting the moving points B and C always passes through the fixed point A'.,"From the previous step, it was established that the angle $\angle BAC$ is constant and equal to $\angle O_1AO_2$. It is a known geometric theorem that if B and C are variable points on two circles intersecting at A and A', and the angle $\angle BAC$ remains constant, then the line BC must pass through the other fixed intersection point A'. This is the converse of the theorem that for any line through A' intersecting the circles at B and C, the angle $\angle BAC$ is constant.",Let M be the midpoint of the segment BC. Show that the locus of M is a fixed circle that passes through the intersection points A and A'.,"Let the points be represented by complex numbers in a plane. The motion of B and C can be described as $b(t) = o_1 + (a-o_1)e^{i\omega t}$ and $c(t) = o_2 + (a-o_2)e^{i\omega t}$. The midpoint M is given by $m(t) = \frac{b(t)+c(t)}{2} = \frac{o_1+o_2}{2} + \frac{(a-o_1)+(a-o_2)}{2} e^{i\omega t}$. This equation describes a circle with a fixed center $Q = \frac{o_1+o_2}{2}$ and a fixed radius. When $t=0$, $B=C=A$, so $M=A$. Thus, the circle passes through A. The center Q lies on the line $O_1O_2$, which is the perpendicular bisector of the common chord AA'. Since the circle passes through A and its center lies on the perpendicular bisector of AA', it must also pass through A'.",Prove that there is a fixed point P in the plane such that the two points are always equidistant from P.,"A point P is equidistant from B and C if and only if it lies on the perpendicular bisector of the segment BC. Let M be the midpoint of BC. The perpendicular bisector of BC is the line through M perpendicular to BC. From sub-problem 2, the line BC always passes through the fixed point A'. From sub-problem 3, the locus of M is a fixed circle $(Q)$ that also passes through A'. Let P be the point diametrically opposite to A' on the circle $(Q)$. Since A' and the circle $(Q)$ are fixed, P is a fixed point. For any position of M on the circle $(Q)$, the angle $\angle A'MP$ is a right angle because it is inscribed in a semicircle. This means the line PM is always perpendicular to the line A'M (which is the line BC). As PM passes through the midpoint M of BC and is perpendicular to BC, it is the perpendicular bisector of BC. Therefore, the fixed point P is always equidistant from B and C."
1979p6,"Let $A$ and $E$ be opposite vertices of an octagon. A frog starts at vertex $A.$ From any vertex except $E$ it jumps to one of the two adjacent vertices. When it reaches $E$ it stops. Let $a_n$ be the number of distinct paths of exactly $n$ jumps ending at $E$. Prove that:\[a_{2n-1}=0, \quad a_{2n}={(2+\sqrt2)^{n-1} - (2-\sqrt2)^{n-1} \over\sqrt2}.\]","First the part $a_{2n-1}=0$ It's pretty obvious. Let's make a sequence $b$ of 1 and -1, setting 1 when the frog jumps left and -1 when it jumps right. If the frog would want to come to vertex E from vertex A, then $\sum b_{i}$ from $i =1$ to $i =2n-1$ should be equal to either 4 or -4. But this sum is odd, so we have $a_{2n-1}= 0$

Now the less obvious part. Let's name $f(X,y)$ the number of ways, in which we can come to vertex X in y moves.

Then $f(E,2n) = f(F,2n-1)+f(D, 2n-1) = f(C, 2n-2)+f(G, 2n-2) =$ $f(D, 2n-3)+f(B, 2n-3)+f(F, 2n-3)+f(H, 2n-3) =$ $2f(D, 2n-5)+2f(F, 2n-5)+4f(H,2n-5)+4f(B, 2n-5) =$ $4[ f(B,2n-5)+f(D, 2n-5)+f(F,2n-5)+f(H, 2n-5) ]-2 [ f(F,2n-5)+f(D,2n-5)] =$ $4f(E,2n-2)-2f(E,2n-4)$

Now we can find a solution to this recurrence or simply prove by induction the given answer.",2,"Show that the number of paths of odd length is zero, i.e., $a_{2n-1}=0$. Further, show that $a_{2n}$ satisfies the linear recurrence relation $a_{2n} = 4a_{2n-2} - 2a_{2n-4}$ for $n \ge 3$.","Let the vertices be labeled $V_0, ..., V_7$ with the starting vertex $A=V_0$ and the ending vertex $E=V_4$. To reach $E$ from $A$, the net displacement in vertex number must be $\pm 4 \pmod 8$. Each jump changes the vertex number by $\pm 1$. The total number of jumps, $n$, must have the same parity as the net displacement. Since 4 is even, $n$ must be even. Thus, $a_{2n-1}=0$. For the recurrence, let $x_k(j)$ be the number of paths of length $k$ to vertex $V_j$. By symmetry, $x_k(j)=x_k(8-j)$. Let $C_k = x_k(2)$ and $D_k = x_k(3)$. The number of paths to $E$ is $a_k=x_k(4)=2x_{k-1}(3)=2D_{k-1}$. Since a path to $V_3$ can only come from $V_2$ (as it stops at $E=V_4$), we have $D_k=C_{k-1}$, so $a_k=2C_{k-2}$. The path counts are related by the system of recurrences: $C_k = x_k(1)+x_k(3)$, $x_k(1) = x_{k-1}(0)+x_{k-1}(2)$, $x_k(0) = 2x_{k-1}(1)$. Combining these leads to a recurrence for $C_k$: $C_k = 4C_{k-2}-2C_{k-4}$. Substituting $k=2n-2$ and using $a_{2n}=2C_{2n-2}$, we obtain the relation $a_{2n} = 4a_{2n-2}-2a_{2n-4}$ for $n \ge 3$.","Prove that: $a_{2n-1}=0, \quad a_{2n}={(2+\sqrt2)^{n-1} - (2-\sqrt2)^{n-1} \over\sqrt2}$.","From the first sub-problem, we know $a_{2n-1}=0$. Let $b_n = a_{2n}$. The sequence satisfies the recurrence $b_n = 4b_{n-1} - 2b_{n-2}$ for $n \ge 3$. The characteristic equation is $r^2 - 4r + 2 = 0$, which has roots $r_{1,2} = 2 \pm \sqrt{2}$. The general solution is of the form $b_n = c_1(2+\sqrt{2})^{n-1} + c_2(2-\sqrt{2})^{n-1}$. We find the initial conditions by direct counting: a path of length 2 cannot reach $E$, so $a_2=0$, hence $b_1=0$. Paths of length 4 are A-B-C-D-E and A-H-G-F-E, so $a_4=2$, hence $b_2=2$. Using these values to solve for the constants: 
For $n=1$: $b_1 = c_1 + c_2 = 0 \implies c_2 = -c_1$. 
For $n=2$: $b_2 = c_1(2+\sqrt{2}) + c_2(2-\sqrt{2}) = c_1((2+\sqrt{2}) - (2-\sqrt{2})) = c_1(2\sqrt{2}) = 2$. 
This gives $c_1 = 1/\sqrt{2}$ and $c_2 = -1/\sqrt{2}$. Substituting these constants into the general solution gives the required formula: $a_{2n} = b_n = {(2+\sqrt2)^{n-1} - (2-\sqrt2)^{n-1} \over\sqrt2}$.",,,,
1978p4,"n a triangle $ABC$ we have $AB = AC.$ A circle which is internally tangent with the circumscribed circle of the triangle is also tangent to the sides $AB, AC$ in the points $P,$ respectively $Q.$ Prove that the midpoint of $PQ$ is the center of the inscribed circle of the triangle $ABC.$","Denote $a = BC, b = AB = AC$ the triangle sides, $r, R$ the triangle inradius and circumradius and $s$, $\triangle$ the triangle semiperimeter and area. Let $S, T$ be the tangency points of the incircle (I) with the sides $AB, AC$. Let $K, L$ be the midpoints of of $BC, PQ$ and $M$ the midpoint of the arc $BC$ of the circumcircle (O) opposite to the vertex $A$. The isosceles triangles $\triangle AST \sim \triangle APQ \sim \triangle ABC$ are all centrally similar with the homothety center $a$. The homothety coefficient for the triangles $\triangle AST \sim \triangle ABC$ is $h_{13} = \frac{AS}{AB} = \frac{s - a}{b}$. The homothety coefficient for the triangles $\triangle AST \sim \triangle APQ$ is $h_{12} = \frac{AS}{AP}$. The point K is the tangency point of the incircle (I) with the side BC, while the point M is the tangency point of the given circle with the triangle circumcircle (O). It follows that the triangles $\triangle ASK \sim \triangle APM$ are also centrally similar with the homothety center A and the same homothety coefficient as the triangles $\triangle AST \sim \triangle APQ$: $h_{12} = \frac{AS}{AP} = \frac{AK}{AM} = \frac{h}{2R}$, where h = AK is the A-altitude of the triangle $\triangle ABC$. The homothety coefficient of the triangles $\triangle APQ \sim \triangle ABC$ is then $h_{23} = \frac{h_{12}}{h_{13}} = \frac{s - a}{b} \cdot \frac{2R}{h}$ Denote $h' = AL$ the $A$-altitude of the triangle $\triangle APQ$. Then

$\frac{h'}{h} = h_{23} = \frac{s - a}{b} \cdot \frac{2R}{h}$

$KL = h - h' = h - 2R\ \frac{s - a}{b}$

Substituting $h = \frac{2 \triangle}{a}$, $2R = \frac{ab^2}{2 \triangle}$ and $s - a = \frac{\triangle^2}{s(s - b)^2}$, we get

$KL = \frac{2 \triangle}{a} - \frac{ab^2}{2 \triangle} \cdot \frac{\triangle^2}{bs(s - b)^2} =$

(substituting 2s = 2b + a and $s - b = \frac a 2$ for an isosceles triangle)

$= \frac{\triangle}{s}\left(\frac{2s}{a} - \frac{ab}{2(s - b)^2}\right) = \frac{\triangle}{s} \left(\frac{2b}{a} + 1 - \frac{2b}{a}\right) = \frac{\triangle}{s} = r$

which means that the point $L \equiv I$ is identical with the incenter of the triangle $\triangle ABC$.",3,"In an isosceles triangle ABC with AB=AC, let a circle be tangent to AB and AC at P and Q, and internally tangent to the circumcircle of ABC. Show that the ratio of similarity `k = AP/AB` between $\triangle APQ$ and $\triangle ABC$ is given by `k = (2R(s-a))/(bh)`, where R is the circumradius, s is the semi-perimeter, h is the altitude from A, and a, b are the side lengths BC, AC.","The triangles APQ and ABC are similar, related by a homothety centered at A. Let `k = AP/AB` be the ratio of similarity. Let the incircle of $\triangle ABC$ be tangent to AB at S. The triangles $\triangle AST$ (where T is the incircle tangency point on AC) and $\triangle APM$ are also related by a homothety centered at A, where M is the tangency point of the given circle with the circumcircle. This implies `AS/AP = AK/AM`, where AK=h is the altitude from A. Since the triangle is isosceles, the line AK is the axis of symmetry, and M must lie on this axis, so `AM=2R`. We know `AS = s-a`. Thus, `(s-a)/AP = h/(2R)`, which gives `AP = 2R(s-a)/h`. The ratio of similarity is `k = AP/AB = (2R(s-a))/(bh)`.","Let K be the midpoint of BC and L be the midpoint of PQ. Using the result from Part 1, show that the distance KL is equal to the inradius `r` of triangle ABC.","L lies on the altitude AK. The distance AL is `k * AK = k * h`. Using the value of k from Part 1, `AL = ((2R(s-a))/(bh)) * h = 2R(s-a)/b`. The distance `KL = AK - AL = h - 2R(s-a)/b`. We express h and R in terms of side lengths and area $\triangle$: `h = 2\triangle/a` and `2R = ab^2/(2\triangle)`. Substituting these gives: `KL = 2\triangle/a - (ab(s-a))/(2\triangle)`. Factoring out `\triangle/s = r`, we get `KL = r * [2s/a - abs(s-a)/(2\triangle^2)]`. Using `\triangle^2 = s(s-a)(s-b)^2`, this simplifies to `KL = r * [2s/a - ab/(2(s-b)^2)]`. For an isosceles triangle, `2s = 2b+a` and `s-b = a/2`. The term in the bracket becomes `(2b+a)/a - ab/(2(a/2)^2) = (2b/a + 1) - 2b/a = 1`. Therefore, `KL = r`.",Prove that the midpoint of PQ is the center of the inscribed circle of the triangle ABC.,"Let I be the incenter of $\triangle ABC$ and L be the midpoint of PQ. In an isosceles triangle ABC with AB=AC, the incenter I lies on the altitude AK from A. The incircle is tangent to the side BC at its midpoint, K. The distance from the incenter I to this point of tangency is the inradius, so `IK = r`. From Part 2, we showed that L, the midpoint of PQ, which also lies on AK, is at a distance `r` from K, i.e., `KL = r`. Since both I and L lie on the line segment AK and are the same distance from K, they must be the same point. Thus, the midpoint of PQ is the incenter of $\triangle ABC$.",,
1978p5,"Let $f$ be an injective function from ${1,2,3,\ldots}$ in itself. Prove that for any $n$ we have: $\sum_{k=1}^{n} f(k)k^{-2} \geq \sum_{k=1}^{n} k^{-1}.$","We know that all the unknowns are integers, so the smallest one must greater or equal to 1.

Let me denote the permutations of $(k_1,k_2,...,k_n)$ with $(y_1,y_2,...,y_n)=y_i (*)$.

From the rearrangement's inequality we know that $\text{Random Sum} \geq \text{Reversed Sum}$.

We will denote we permutations of $y_i$ in this form $y_n \geq ...\geq y_1$.

So we have $\frac{k_1}{1^2}+\frac{k_2}{2^2}+...+\frac{k_n}{n^2} \geq \frac{y_1}{1^2}+ \frac{y_2}{2^2}+...+ \frac{y_n}{n^2} \geq 1+\frac{1}{2}+...+\frac{1}{n}$.

Let's denote $\frac{y_1}{1^2}+ \frac{y_2}{2^2}+...+ \frac{y_n}{n^2}=T$ and $1+\frac{1}{2}+...+\frac{1}{n}=S$.

We have $T \geq S$. Which comes from $y_1 \geq1, y_2 \geq2, ...,y_n \geq n$.

So we are done.",1,"Let $f$ be an injective function from ${1,2,3,\ldots}$ in itself. Prove that for any $n$ we have: $\sum_{k=1}^{n} f(k)k^{-2} \geq \sum_{k=1}^{n} k^{-1}.$","We know that all the unknowns are integers, so the smallest one must greater or equal to 1.

Let me denote the permutations of $(k_1,k_2,...,k_n)$ with $(y_1,y_2,...,y_n)=y_i (*)$.

From the rearrangement's inequality we know that $\text{Random Sum} \geq \text{Reversed Sum}$.

We will denote we permutations of $y_i$ in this form $y_n \geq ...\geq y_1$.

So we have $\frac{k_1}{1^2}+\frac{k_2}{2^2}+...+\frac{k_n}{n^2} \geq \frac{y_1}{1^2}+ \frac{y_2}{2^2}+...+ \frac{y_n}{n^2} \geq 1+\frac{1}{2}+...+\frac{1}{n}$.

Let's denote $\frac{y_1}{1^2}+ \frac{y_2}{2^2}+...+ \frac{y_n}{n^2}=T$ and $1+\frac{1}{2}+...+\frac{1}{n}=S$.

We have $T \geq S$. Which comes from $y_1 \geq1, y_2 \geq2, ...,y_n \geq n$.

So we are done.",,,,,,
1978p6,"An international society has its members from six different countries. The list of members has 1978 names, numbered $1, 2, \ldots, 1978$. Prove that there is at least one member whose number is the sum of the numbers of two (not necessarily distinct) members from his own country.","Suppose the contrary. Then there exists a partition of $\{1,2,3,\ldots, 1978\}$ into 6 difference-free subsets $A,B,C,D,E,F$. A set S is difference-free if there are not $x,y,z \in S$ such that x = y - z.

By the Pigeonhole principle, one of these subsets, say $A$, has a minimum of $\left \lfloor \frac{1978}{6}\right \rfloor +1 = 330$ members, $a_1 < a_2 < \ldots < a_{330}$. Since $A$ is difference-free, each of the $329$ differences $a_{330} - a_1, a_{330} - a_2, \ldots, a_{330} - a_{329}$ cannot belong to $A$, and so must belong to one of $B, C, D, E, F$.

One of these subsets, say $B$, has a minimum of $\left \lfloor \frac{329}{5}\right \rfloor +1 = 66$ members, $b_1 < b_2 < \ldots < b_{66}$. Since $A$ and $B$ are difference-free, each of the $65$ differences $b_{66} - b_1, b_{66} - b_2, \ldots, b_{66} - b_{65}$ cannot belong to one of $A, B$, and so must belong to one of $C, D, E, F$.

One of these subsets, say $C$, has a minimum of $\left \lfloor \frac{65}{4}\right \rfloor +1 = 17$ members, $c_1 < c_2 < \ldots < c_{17}$. Since $A, B, C$ are difference-free, each of the $16$ differences $c_{17} - c_1, c_{17} - c_2, \ldots, c_{17} - c_{16}$ cannot belong to one of $A, B, C$, and so must belong to one of $D, E, F$.

One of these subsets, say $D$, has a minimum of $\left \lfloor \frac{16}{3}\right \rfloor +1 = 6$ members, $d_1 < d_2 < \ldots < d_6$. Since $A, B, C, D$ are difference-free, each of the $5$ differences $d_6 - d_1, d_6 - d_2, \ldots, d_6 - d_5$ cannot belong to one of $A, B, C, D$, and so must belong to one of $E, F$.

One of these subsets, say $E$, has a minimum of $\left \lfloor \frac{5}{2}\right \rfloor +1 = 3$ members, $e_1 < e_2 < e_3$. Since $A, B, C, D, E$ are difference-free, each of the $2$ differences $e_3 - e_1, e_3 - e_2$ cannot belong to one of $A, B, C, D, E$, and so must belong to $F$.

Then $F$ has at least two members, $f_1 < f_2$. The difference $g = f_2 - f_1$ cannot belong to one of $A, B, C, D, E, F$, a contradiction!",3,"Let the set of member numbers $\{1, 2, \ldots, 1978\}$ be partitioned into 6 sets $C_1, \ldots, C_6$ based on country. Assume each set $C_i$ is 'sum-free', meaning for any $x, y \in C_i$, their sum $x+y$ is not in $C_i$. If one set, say $C_1$, has at least 330 members, show that there exists a set $D_1$ of at least 329 integers, formed by differences of elements in $C_1$, such that no element of $D_1$ can be in $C_1$.","Let $C_1 = \{a_1, a_2, \ldots, a_k\}$ with $k \ge 330$ and $a_1 < a_2 < \ldots < a_k$. Consider the set of differences $D_1 = \{a_k - a_1, a_k - a_2, \ldots, a_k - a_{k-1}\}$. This set has $k-1 \ge 329$ distinct positive integers. Suppose, for the sake of contradiction, that an element $d \in D_1$ is also in $C_1$. By definition of $D_1$, $d = a_k - a_i$ for some $i \in \{1, \ldots, k-1\}$. This implies $a_k = a_i + d$. Since $a_k, a_i, d$ are all in $C_1$, this contradicts the assumption that $C_1$ is sum-free. Therefore, all elements of $D_1$ cannot be in $C_1$.","Following the setup from Sub-problem 1, the set $D_1$ (with at least 329 elements) must be partitioned among the remaining 5 sets $C_2, \ldots, C_6$. Show that by repeatedly taking difference sets and applying the Pigeonhole Principle, we can conclude that one of the sets, say $C_6$, must contain at least 2 elements from the fifth-generated set of differences.","The set $D_1$ has at least 329 elements which must belong to $C_2, \ldots, C_6$. By the Pigeonhole Principle (PHP), one set, say $C_2$, contains at least $\lceil 329/5 \rceil = 66$ elements from $D_1$. Let $D_2$ be the difference set of these elements. $|D_2| \ge 65$, and its elements cannot be in $C_1$ or $C_2$. We iterate this process: a set $C_3$ must contain $\ge \lceil 65/4 \rceil = 17$ elements from $D_2$; a set $C_4$ must contain $\ge \lceil (17-1)/3 \rceil = 6$ elements from the next difference set $D_3$; a set $C_5$ must contain $\ge \lceil (6-1)/2 \rceil = 3$ elements from $D_4$. Finally, the last set $C_6$ must contain at least $\lceil (3-1)/1 \rceil = 2$ elements from the last difference set $D_5$.","An international society has its members from six different countries. The list of members has 1978 names, numbered $1, 2, \ldots, 1978$. Prove that there is at least one member whose number is the sum of the numbers of two (not necessarily distinct) members from his own country.","Assume for contradiction that no such member exists. This is equivalent to partitioning the set $S = \{1, \ldots, 1978\}$ into 6 sum-free sets $C_1, \ldots, C_6$. By the Pigeonhole Principle, at least one set, say $C_1$, must contain at least $\lceil 1978/6 \rceil = 330$ members. From Sub-problem 2, this implies that one set, say $C_6$, must contain at least two elements, $f_1 < f_2$, from a specially constructed set of differences. Consider their difference $g = f_2 - f_1$. By the logic established in the previous steps, $g$ cannot belong to any of $C_1, \ldots, C_5$. Furthermore, if $g$ were in $C_6$, it would imply $f_2 = f_1 + g$, which contradicts $C_6$ being sum-free. Thus, $g$ cannot be in any of the six sets. But $g$ is a positive integer, so it must belong to $S$. This is a contradiction, so the initial assumption must be false.",,
1977p1,"In the interior of a square $ABCD$ we construct the equilateral triangles $ABK, BCL, CDM, DAN.$ Prove that the midpoints of the four segments $KL, LM, MN, NK$ and the midpoints of the eight segments $AK, BK, BL, CL, CM, DM, DN, AN$ are the 12 vertices of a regular dodecagon.","Just use complex numbers, with $a = 1$, $b = i$, $c = - 1$ and $d = - i$. With some calculations, we have $k = \frac {\sqrt {3} - 1}{2}( - 1 - i)$, $l = \frac {\sqrt {3} - 1}{2}(1 - i)$, $m = \frac {\sqrt {3} - 1}{2}(1 + i)$ and $n = \frac {\sqrt {3} - 1}{2}( - 1 + i)$. Now it's an easy job to calculate the twelve midpoints and to find out they are all of the form $\frac {\sqrt {3} - 1}{2}e^{\frac {k\pi}{6}i}$, with $k\in\mathbb{N}: 0\le k\le 11$, and the result follows.",2,"Let the vertices of the square $ABCD$ be represented by the complex numbers $a=1, b=i, c=-1, d=-i$. Determine the complex coordinates of the vertices $K, L, M, N$ of the interior equilateral triangles $ABK, BCL, CDM, DAN$.","The vertex $K$ of the equilateral triangle $ABK$ inside the square is obtained by rotating the vector $b-a$ by $60^\circ$ around $a$, so $k = a + (b-a)e^{i\pi/3}$. This calculation gives $k = \frac{\sqrt{3}-1}{2}(-1-i)$. The other vertices $L, M, N$ are found by rotating the setup by successive $90^\circ$ turns around the origin, yielding $l = \frac{\sqrt{3}-1}{2}(1-i)$, $m = \frac{\sqrt{3}-1}{2}(1+i)$, and $n = \frac{\sqrt{3}-1}{2}(-1+i)$.","Prove that the midpoints of the four segments $KL, LM, MN, NK$ and the midpoints of the eight segments $AK, BK, BL, CL, CM, DM, DN, AN$ are the 12 vertices of a regular dodecagon.","Let $S = (\sqrt{3}-1)/2$. Using the coordinates for $A, B, C, D$ and $K, L, M, N$, we calculate the 12 specified midpoints by averaging the complex numbers of the endpoints. For example, the midpoint of $LM$ is $(l+m)/2 = S$, and the midpoint of $AN$ is $(a+n)/2 = S(\frac{\sqrt{3}}{2} + \frac{i}{2})$. Calculating all 12 points reveals that they can all be expressed in the form $S \cdot e^{i k\pi/6}$ for $k \in \{0, 1, \dots, 11\}$. These are the vertices of a regular dodecagon centered at the origin with radius $S$.",,,,
1977p3,"Let $n$ be a given number greater than 2. We consider the set $V_n$ of all the integers of the form $1 + kn$ with $k = 1, 2, \ldots$ A number $m$ from $V_n$ is called indecomposable in $V_n$ if there are not two numbers $p$ and $q$ from $V_n$ so that $m = pq.$ Prove that there exist a number $r \in V_n$ that can be expressed as the product of elements indecomposable in $V_n$ in more than one way. (Expressions which differ only in order of the elements of $V_n$ will be considered the same.)","Lemma: there are $\infty$ many prime numbers $p \not\equiv 1 \mod n$.

Proof:

Assume that there are only finitely many of them and let their product be $k$. Then all prime factors of $nk - 1$ must be $\equiv 1 \mod n$ since this number is coprime with $k$. But that would mean that $- 1 \equiv nk - 1 \equiv 1 \mod n$ which is impossible for $n > 2$.

Now we can tackle the problem: There are only finetely many residue classes $\mod n$, thus we can find two primes $p,q$ with $p \equiv q \not\equiv 1 \mod n$ and coprime with $n$. Let $s$ be the smallest positive integer with $p^s \equiv 1 \mod n$, then the same property holds for $q$ too. Now we have that $p^s, q^s, pq^{s - 1} , p^{s - 1}q \equiv 1 \mod n$ are all indecomposable since all their nontrivial divisors are $\not\equiv 1 \mod n$. But the product $p^sq^s = (pq^{s - 1})(p^{s - 1}q)$ gives a number that is represented in two ways.",2,"Prove that for any integer $n > 2$, there exist infinitely many prime numbers $p$ such that $p \not\equiv 1 \pmod n$.","Assume for contradiction that there are finitely many primes $p \not\equiv 1 \pmod n$. Let $k$ be their product. Consider the number $N = nk - 1$. Any prime factor $q$ of $N$ cannot be one of the primes in the product $k$, otherwise $q$ would divide both $nk$ and $nk-1$, implying $q|1$, a contradiction. Thus, any prime factor $q$ of $N$ must satisfy $q \equiv 1 \pmod n$. This implies $N$ itself, as a product of such primes, must be congruent to $1 \pmod n$. However, by construction, $N = nk - 1 \equiv -1 \pmod n$. This leads to $1 \equiv -1 \pmod n$, meaning $n|2$, which contradicts the given $n > 2$. Therefore, there must be infinitely many such primes.","Let $n$ be a given number greater than 2. We consider the set $V_n$ of all the integers of the form $1 + kn$ with $k = 1, 2, \ldots$ A number $m$ from $V_n$ is called indecomposable in $V_n$ if there are not two numbers $p$ and $q$ from $V_n$ so that $m = pq.$ Prove that there exist a number $r \in V_n$ that can be expressed as the product of elements indecomposable in $V_n$ in more than one way. (Expressions which differ only in order of the elements of $V_n$ will be considered the same.)","Since there are infinitely many primes not congruent to $1 \pmod n$ and finitely many residue classes, we can find two distinct primes $p, q$ such that $p \equiv q \equiv a \pmod n$ for some $a \not\equiv 1 \pmod n$ with $\gcd(a,n)=1$. Let $s$ be the multiplicative order of $a$ modulo $n$. The numbers $p^s, q^s, p^{s-1}q, pq^{s-1}$ are all congruent to $a^s \equiv 1 \pmod n$, so they belong to $V_n$. These four numbers are indecomposable in $V_n$. For example, any proper divisor of $p^s$ is of the form $p^k$ with $k<s$, so $p^k \equiv a^k \not\equiv 1 \pmod n$ by the minimality of $s$. Similarly, any proper divisor of $p^{s-1}q$ is of the form $p^i q^j$ where $i+j < s$, so it is not in $V_n$. Now, consider the number $r = p^s q^s$. It has two distinct decompositions into indecomposable elements: $r = (p^s)(q^s)$ and $r = (p^{s-1}q)(pq^{s-1})$. Thus, such a number $r$ exists.",,,,
1977p4,"Let $a,b,A,B$ be given reals. We consider the function defined by\[f(x) = 1 - a \cdot \cos(x) - b \cdot \sin(x) - A \cdot \cos(2x) - B \cdot \sin(2x).\]Prove that if for any real number $x$ we have $f(x) \geq 0$ then $a^2 + b^2 \leq 2$ and $A^2 + B^2 \leq 1.$","$f(x) = 1-\sqrt{a^2+b^2}\sin (x+\arctan\frac{a}{b}) - \sqrt{A^2+B^2}\sin (2x+\arctan\frac{A}{B}) \geq 0$. $f(x+\pi) = 1+\sqrt{a^2+b^2}\sin (x+\arctan\frac{a}{b}) - \sqrt{A^2+B^2}\sin (2x+\arctan\frac{A}{B}) \geq 0$

Therefore, $\sqrt{A^2+B^2}\sin (2x+\arctan\frac{A}{B}) \leq 1$. Since this identity is true for any real $x$, let the sine term be one, $\longrightarrow A^2+B^2 \leq 1$.

To get cancellation on the rightmost terms, note $\sin (x+\pi/2) = \cos x, \sin (x-\pi/2) = -\cos x$.

$f(x+\pi/4) = 1-\sqrt{a^2+b^2}\sin (x+\pi/4+\arctan\frac{a}{b}) - \sqrt{A^2+B^2}\cos2x+\arctan\frac{A}{B}) \geq 0$. $f(x-\pi/4) = 1-\sqrt{a^2+b^2}\sin (x-\pi/4+\arctan\frac{a}{b}) + \sqrt{A^2+B^2}\cos2x+\arctan\frac{A}{B}) \geq 0$.

Let $x+\arctan\frac{a}{b} = y$. Then $\sqrt{a^2+b^2}(\sin (y+\pi/4) + \sin (y-\pi/4)) \leq 2$ $\sqrt{a^2+b^2} \leq \dfrac{2}{\sqrt{2}(\sin y)}$. Since it's valid for all real $x$ let $\sin y = 1$, and we are done.",2,"Let $f(x) = 1 - a \cdot \cos(x) - b \cdot \sin(x) - A \cdot \cos(2x) - B \cdot \sin(2x)$. If $f(x) \geq 0$ for all real $x$, show that for all $x$ we have $A \cos(2x) + B \sin(2x) \leq 1$ and $a \cos(x) + b \sin(x) \leq \sqrt{2}$.","Let $S_1(x) = a\cos x + b\sin x$ and $S_2(x) = A\cos 2x + B\sin 2x$. Since $f(x) \geq 0$ for all $x$, it must also hold for $x+\pi$. Adding the inequalities $f(x) = 1 - S_1(x) - S_2(x) \geq 0$ and $f(x+\pi) = 1 + S_1(x) - S_2(x) \geq 0$ eliminates $S_1(x)$ and yields $2 - 2S_2(x) \geq 0$, which implies $S_2(x) \leq 1$. Similarly, adding $f(x+\pi/4) \geq 0$ and $f(x-\pi/4) \geq 0$ eliminates $S_2(x)$, since $S_2(x+\pi/4) + S_2(x-\pi/4) = 0$. This yields $2 - (S_1(x+\pi/4)+S_1(x-\pi/4)) \geq 0$. Since $S_1(x+\pi/4)+S_1(x-\pi/4) = \sqrt{2}S_1(x)$, this simplifies to $2 - \sqrt{2}S_1(x) \geq 0$, which implies $S_1(x) \leq \sqrt{2}$.","Let $a,b,A,B$ be given reals. We consider the function defined by\[f(x) = 1 - a \cdot \cos(x) - b \cdot \sin(x) - A \cdot \cos(2x) - B \cdot \sin(2x).\]Prove that if for any real number $x$ we have $f(x) \geq 0$ then $a^2 + b^2 \leq 2$ and $A^2 + B^2 \leq 1.$","As a consequence of the condition $f(x) \ge 0$, we have established two key inequalities that hold for all $x$: (1) $A \cos(2x) + B \sin(2x) \leq 1$ and (2) $a \cos(x) + b \sin(x) \leq \sqrt{2}$. The maximum value of the expression $A \cos(2x) + B \sin(2x)$ is $\sqrt{A^2+B^2}$. For inequality (1) to hold for all $x$, this maximum value must be less than or equal to 1, so $\sqrt{A^2+B^2} \leq 1$, which implies $A^2+B^2 \leq 1$. Similarly, the maximum value of $a \cos(x) + b \sin(x)$ is $\sqrt{a^2+b^2}$. For inequality (2) to hold for all $x$, we must have $\sqrt{a^2+b^2} \leq \sqrt{2}$, which implies $a^2+b^2 \leq 2$.",,,,
1977p6,"Let $f(n)$ be a function $f: \mathbb{N}^{+}\to\mathbb{N}^{+}$. Prove that if \[f(n+1) > f(f(n))\] for each positive integer $n$, then $f(n)=n$.","We will prove this via induction. First we will prove there is a $t$ such that $f(t)=1$ and then that $t=1$ is the only such solution.

Define the sequence $a_n$ with $a_0>1$ for $a_0\in \mathbb{N}$ and $a_k=f(a_{k-1}-1)$. By the given inequality we have that $f(a_n)>f(a_{n+1})$, this can be used to form a inequality chain of decreasing positive integers: \[f(a_0)>f(a_1)>f(a_2)>...\] By Infinite Descent, this sequence must terminate, and the only way it can terminate is if we input something into $f$ that is outside of its range. This can only happen if $a_n=1$ since the range and domain of $f$ are the positive integers. Since $a_0\neq 1$, there is a integer $t$ ($a_{n-1}-1$) such that $f(t)=1$.

Now if $t\neq 1$, then $f(t)=1>f(f(t-1))$, which is impossible since $f(f(t-1))\ge 1$ by the range of $f$, so we have $t=1$ is the only time when $f(t)=1$.

Now for the inductive step.

Assume that $f(n)=n$ for all $n<k$ and these are the only times these values occur. We will prove that $f(k)=k$ and that this is the only time this value occurs. Define the sequence $a_n$ similarly, except that $a_0>k$, by the reasoning above, there is a $a_m$ such that $f(a_m)=1$, by the inductive assumption, this means that $a_m=f(a_{m-1}-1)=1$, we can repeat the inductive assumption to get that $a_{m-k+1}=k$. This implies that $f(a_{m-k}-1)=k$. Thus, there is a $t$ such that $f(t)=k$.

Now for that $t$, we have $k>f(f(t-1))$, which means that $k+1>t$ by the inductive assumption which implies $t=k$ since we must have $t>k-1$, otherwise $f(t)<k$. So $t=k$ is the only time when $f(t)=k$

So the inductive step is complete. Therefore, by induction $f(n)=n$ for all positive integers $n$.",3,Prove that there exists a positive integer $t$ such that $f(t)=1$.,"For any integer $a_0 > 1$, define the sequence $a_k = f(a_{k-1}-1)$ for $k \ge 1$. The given condition $f(n+1) > f(f(n))$ implies that for $n=a_{k-1}-1$, we have $f(a_{k-1}) > f(f(a_{k-1}-1)) = f(a_k)$. This creates a strictly decreasing sequence of positive integers $f(a_0) > f(a_1) > f(a_2) > \dots$. By the principle of infinite descent, this sequence must terminate. Termination can only occur if an input to $f$ is not in its domain $\mathbb{N}^{+}$, which requires $a_m-1=0$ for some $m$. This means $a_m=1$. Thus, for $t = a_{m-1}-1$, we have $f(t)=1$.",Prove that $f(1)=1$.,"From the first sub-problem, we know there exists a $t \in \mathbb{N}^{+}$ such that $f(t)=1$. Assume for contradiction that $t > 1$. Then $t-1 \in \mathbb{N}^{+}$. The given inequality for $n=t-1$ states $f(t) > f(f(t-1))$. Substituting $f(t)=1$ yields $1 > f(f(t-1))$. However, the codomain of $f$ is $\mathbb{N}^{+}$, so $f(x) \ge 1$ for any $x \in \mathbb{N}^{+}$. This implies $f(f(t-1)) \ge 1$, which is a contradiction. Therefore, the assumption $t > 1$ must be false, so $t=1$. Hence, $f(1)=1$.","Let $f(n)$ be a function $f: \\mathbb{N}^{+}\to\\mathbb{N}^{+}$. Prove that if $f(n+1) > f(f(n))$ for each positive integer $n$, then $f(n)=n$.","We prove $f(n)=n$ by strong induction. The base case $f(1)=1$ is established. Assume as the inductive hypothesis that $f(k)=k$ for all $1 \\le k < n$. First, we show that $n$ is in the range of $f$. The same infinite descent argument from the first sub-problem shows that there must exist a $t$ such that $f(t)=n$. Now we show $t=n$. The inequality for $n=t-1$ (assuming $t>1$) gives $f(t) > f(f(t-1))$, so $n > f(f(t-1))$. As the value $f(f(t-1))$ is an integer less than $n$, the inductive hypothesis implies $f(f(t-1)) = f(t-1)$. So $n > f(t-1)$. Again, since the value $f(t-1)$ is less than $n$, the inductive hypothesis implies $f(t-1) = t-1$. Therefore, $n > t-1$, or $t < n+1$. Now, if we assume $t < n$, the inductive hypothesis gives $f(t)=t$. But we know $f(t)=n$, which implies $t=n$, a contradiction. Thus, $t \\ge n$. Combining $t \\ge n$ and $t < n+1$ implies $t=n$. So $f(n)=n$. By induction, the statement holds for all $n \\in \\mathbb{N}^{+}$.",,
1976p2,"Let $P_{1}(x) = x^{2} - 2$ and $P_{j}(x) = P_{1}(P_{j - 1}(x))$ for $j= 2,\ldots$ Prove that for any positive integer n the roots of the equation $P_{n}(x) = x$ are all real and distinct.","I shall prove by induction that $P_n(x)$ has $2^n$ distinct real solutions, where $2^{n-1}$ are positive and $2^{n-1}$ are negative. Also, for ever root $r$, $|r|<2$.

Clearly, $P_1(x)$ has 2 real solutions, where 1 is positive and 1 is negative. The absolute values of these two solutions are also both less than 2. This proves the base case.

Now assume that for some positive integer $k$, $P_k(x)$ has $2^k$ distinct real solutions with absolute values less than 2, where $2^{k-1}$ are positive and $2^{k-1}$ are negative.

Choose a root $r$ of $P_{k+1}(x)$. Let $P_1(r)=s$, where $s$ is a real root of $P_k(x)$. We have that $-2<s<2$, so $0<r^2<4$, so $r$ is real and $|r|<2$. Therefore all of the roots of $P_{k+1}$ are real and have absolute values less than 2.

Note that the function $P_{k+1}(x)$ is an even function, since $P_1(x)$ is an even function. Therefore half of the roots of $P_{k+1}$ are positive, and half are negative.

Now assume for the sake of contradiction that $P_{k+1}(x)$ has a double root $r$. Let $P_1(r)=s$. Then there exists exactly one real number $r$ such that $r^2-2=s$. The only way that this could happen is when $s+2=0$, or $s=-2$. However, $|s|<2$ from our inductive hypothesis, so this is a contradiction. Therefore $P_{k+1}(x)$ has no double roots. This proves that that the roots of $P_{k+1}(x)$ are distinct.

This completes the inductive step, which completes the inductive proof.",2,"Let $P_{1}(x) = x^{2} - 2$ and $P_{j}(x) = P_{1}(P_{j - 1}(x))$. For any $x \in [-2, 2]$, let $x = 2\cos\theta$. Prove by induction that $P_n(x) = 2\cos(2^n\theta)$.","Base case (n=1): For $x=2\cos\theta$, we have $P_1(x) = (2\cos\theta)^2 - 2 = 4\cos^2\theta - 2 = 2(2\cos^2\theta - 1) = 2\cos(2\theta)$. The formula holds. \nInductive step: Assume the formula holds for $n=k$, so $P_k(2\cos\theta) = 2\cos(2^k\theta)$. Then $P_{k+1}(x) = P_1(P_k(x)) = P_1(2\cos(2^k\theta))$. From the base case, we know $P_1(2\cos\phi) = 2\cos(2\phi)$. Letting $\phi=2^k\theta$, we get $P_{k+1}(x) = 2\cos(2 \cdot 2^k\theta) = 2\cos(2^{k+1}\theta)$. By the principle of mathematical induction, the formula is true for all positive integers $n$.","Let $P_{1}(x) = x^{2} - 2$ and $P_{j}(x) = P_{1}(P_{j - 1}(x))$ for $j= 2,\ldots$ Prove that for any positive integer n the roots of the equation $P_{n}(x) = x$ are all real and distinct.","First, any real root $x$ must be in $[-2, 2]$, because if $|x|>2$, then $|P_1(x)|=|x^2-2|>|x|$, which implies by induction that $|P_n(x)|>|x|$, so $P_n(x) \neq x$. We can thus substitute $x=2\cos\theta$ for $\theta \in [0, \pi]$. Using the identity from the first sub-problem, $P_n(x)=x$ becomes $2\cos(2^n\theta)=2\cos\theta$. This implies $2^n\theta = \pm\theta + 2k\pi$ for an integer $k$. This leads to two families of solutions for $\theta$, which generate two disjoint sets of roots. The first, $\theta_k=\frac{2k\pi}{2^n-1}$, gives $2^{n-1}$ distinct roots for $k=0, ..., 2^{n-1}-1$. The second, $\theta'_j=\frac{2j\pi}{2^n+1}$, gives $2^{n-1}$ distinct roots for $j=1, ..., 2^{n-1}$. In total, we have $2^n$ distinct real roots. As $P_n(x)-x$ is a polynomial of degree $2^n$, these are all its roots.",,,,
1976p5,"We consider the following system with $q = 2p$:

$\begin{matrix} a_{11}x_{1} + \ldots + a_{1q}x_{q} = 0, \\ a_{21}x_{1} + \ldots + a_{2q}x_{q} = 0, \\ \ldots , \\ a_{p1}x_{1} + \ldots + a_{pq}x_{q} = 0, \\ \end{matrix}$

in which every coefficient is an element from the set $\{ - 1,0,1\}$$.$ Prove that there exists a solution $x_{1}, \ldots,x_{q}$ for the system with the properties:

a.) all $x_{j}, j = 1,\ldots,q$ are integers$;$

b.) there exists at least one j for which $x_{j} \neq 0;$

c.) $|x_{j}| \leq q$ for any $j = 1, \ldots ,q.$","First of all note that we have $(q + 1)^q - 1$ possible nonzero vectors $(x_1,\cdots,x_q)$ such that $0\leq x_i\leq q$ are integers.


But $a_{j1}x_1 + \cdots + a_{jq}x_q$ can only assume $q^2 + 1$ different values, because if it is maximized/minimized by $(M_1,M_2,\cdots,M_q)/(m_1,m_2,\cdots,m_q)$, we have that $\sum_{i = 1}^{q}a_{ji}(M_i - m_i)\leq q\times q = q^2$ (if $a_{ji} = 0$, it doesn't affect the sum, if it is $1$, $M_i = q,m_i = 0$, and if it is $- 1$, $M_i = 0,m_i = q$).


From this we conclude that there are at most $(q^2 + 1)^p = (q^2 + 1)^{q/2}$ possible values for the vector $(a_{11}x_{1} + \ldots + a_{1q}x_{q},\cdots,a_{p1}x_{1} + \ldots + a_{pq}x_{q})$. But we have that: $(q + 1)^q - 1 = (q^2 + 1 + 2q)^{q/2} - 1 =$ $= (q^2 + 1)^{q/2} + \left( - 1 + \sum_{j = 1}^{q/2}{{q/2}\choose j}(q^2 + 1)^{q/2 - j}(2q)^j\right) > (q^2 + 1)^{q/2}$

We conclude that by the pigeonhole principle there are two distinct vectors being mapped to the same vector. Taking their difference we have a vector with the desired properties.",2,"Let $S$ be the set of non-zero integer vectors $x = (x_1, \ldots, x_q)$ with $0 \le x_j \le q$. For any such $x$, let $y(x) = (\sum_{j=1}^q a_{1j}x_j, \ldots, \sum_{j=1}^q a_{pj}x_j)$. Show that the number of vectors in $S$ is greater than the number of distinct possible vectors $y(x)$.","The number of integer vectors $(x_1, \ldots, x_q)$ with $0 \le x_j \le q$ is $(q+1)^q$. The set $S$ excludes the zero vector, so its size is $|S| = (q+1)^q - 1$. For each component $y_i = \sum_{j=1}^q a_{ij}x_j$, the difference between its maximum and minimum possible value is at most $q^2$, so it can take at most $q^2+1$ distinct integer values. Consequently, the total number of distinct vectors $y(x)$ is at most $(q^2+1)^p$. Since $q=2p$, this is $(q^2+1)^{q/2}$. We have $(q+1)^q - 1 = (q^2+2q+1)^{q/2} - 1 = ((q^2+1)+2q)^{q/2} - 1$. By the binomial theorem, this is strictly greater than $(q^2+1)^{q/2}$. Thus, the number of vectors in $S$ is greater than the number of possible outcome vectors $y(x)$.","Prove that there exists a solution $x_{1}, \ldots,x_{q}$ for the system with the properties:

a.) all $x_{j}, j = 1,\ldots,q$ are integers$;$

b.) there exists at least one j for which $x_{j} \neq 0;$

c.) $|x_{j}| \leq q$ for any $j = 1, \ldots ,q.$","From the previous result, the number of non-zero integer vectors $x$ with $0 \le x_j \le q$ is greater than the number of possible values for the vector of sums $( \sum a_{1j}x_j, \ldots, \sum a_{pj}x_j)$. By the pigeonhole principle, there must be two distinct vectors, $x'$ and $x''$, from this set of vectors that produce the same outcome. That is, $A x' = A x''$. Let $x = x' - x''$. Then $A x = A(x' - x'') = Ax' - Ax'' = 0$. This vector $x$ is a solution. As $x' \neq x''$, $x$ is non-zero (property b). Its components $x_j = x'_j - x''_j$ are integers (property a). Since $0 \le x'_j, x''_j \le q$, we have $-q \le x_j \le q$, which implies $|x_j| \le q$ (property c). Thus, $x$ is a solution with all the required properties.",,,,
1976p6,"A sequence $(u_{n})$ is defined by

\[u_{0} = 2 \quad u_{1} = \frac {5}{2}, u_{n + 1} = u_{n}(u_{n - 1}^{2} - 2) - u_{1} \ \text{ for } n = 1,\cdots\]

Prove that for any positive integer $n$ we have

\[\lfloor u_{n} \rfloor = 2^{\frac {(2^{n} - ( - 1)^{n})}{3}}\]

(where $\lfloor x\rfloor$ denotes the smallest integer $\leq$ $x$)$.$","Let the sequence $(x_n)_{n \geq 0}$ be defined as \[ x_{0}=0,x_{1}=1, x_{n}=x_{n-1}+2x_{n-2} \] We notice \[x_n=\frac{2^n-(-1)^n}{3}\] Because the roots of the characteristic polynomial $x_{n}=x_{n-1}+2x_{n-2}$ are $-1$ and $2$. \newline We also see $\frac{2^1-(-1)^1}{3}=1=x_1$, $\frac{2^2-(-1)^2}{3}=1=x_2$ We want to prove \[2^{x_{n}-2x_{n-1}}+2^{-x_{n}+2x_{n-1}}=2^{x_1}+2^{-x_1}\] This is done by induction

Base Case: For $n=1$ ses det $2^{1-0}+2^{0-1}=2^{1}+2^{-1}$

Inductive step: Assume $2^{x_{n-1}-2x_{n-2}}+2^{-x_{n-1}+2x_{n-2}}=2^{x_1}+2^{-x_1}$ We notice \begin{align*}  2^{x_{n}-2x_{n-1}}+2^{-x_{n}+2x_{n-1}} &=2^{x_{n-1}+2x_{n-2}-2x_{n-1}}+2^{-(x_{n-1}+2x_{n-2})+2x_{n-1}}\\ &=2^{-x_{n-1}+2x_{n-2}}+2^{x_{n-1}-2x_{n-2}}\\ &=2^{x_1}+2^{-x_1} \end{align*} We then want to show \[a_n=2^{x_n}+2^{-x_n}\] This can be done using induction

Base Case

For $n=1$, it is clear that \[a_1=\frac{5}{2}\] and \[2^{x_1}+2^{-x_1}=2^1+2^{-1}=2+\frac{1}{2}=\frac{5}{2}\] Therefore, the base case is proved.

Inductive Step

Assume for all natural $k<n$ at $a_k=2^{x_k}+2^{-x_k}$\newline Then we have that: \begin{align*}  a_n &=  a_{n}(a_{n-1}^{2}-2)-a_{1} \\   &=  (2^{x_{n-1}}+2^{-x_{n-1}})((2^{x_{n-2}}+2^{-x_{n-2}})^2-2)-(2^{x_{1}}+2^{-x_{0}}) \\  &= (2^{x_{n-1}}+2^{-x_{n-1}})((2^{x_{n-2}})^2+(2^{-x_{n-2}})^2+2*2^{x_{n-2}}*2^{-x_{n-2}}-2)-(2^{x_{1}}+2^{-x_{0}}) \\  &=(2^{x_{n-1}}+2^{-x_{n-1}})((2^{2x_{n-2}})+(2^{-2x_{n-2}})+2*2^{x_{n-2}-x_{n-2}}-2)-(2^{x_{1}}+2^{-x_{0}}) \\  &=(2^{x_{n-1}}+2^{-x_{n-1}})((2^{2x_{n-2}})+(2^{-2x_{n-2}})+2-2)-(2^{x_{1}}+2^{-x_{0}}) \\ &=2^{x_{n-1}}*2^{2x_{n-2}}+2^{-x_{n-1}}2^{-2x_{n-2}}+2^{x_{n-1}}*2^{-2x_{n-2}}+2^{-x_{n-1}}*2^{2x_{n-2}}-2^{x_{1}}-2^{-x_{0}}\\ &=2^{x_{n-1}+2x_{n-2}}+2^{-(x_{n-1}+2x_{n-2}})+2^{x_{n-1}-2x_{n-2}}+2^{-x_{n-1}+2x_{n-2}}-2^{x_{1}}-2^{-x_{0}}\\ &=2^{x_{n}}+2^{-x_{n}}+2^{x_{n-1}-2x_{n-2}}+2^{-x_{n-1}+2x_{n-2}}-2^{x_{1}}-2^{-x_{0}} \end{align*} From our first induction proof we have that: \[2^{x_{n-1}-2x_{n-2}}+2^{-x_{n-1}+2x_{n-2}}=2^{x_1}+2^{-x_1}\] Then: \[a_n=2^{x_n}+2^{-x_n}+2^{x_1}+2^{-x_1}-(2^{x_1}+2^{-x_1})=2^{x_n}+2^{-x_n}\] We notice  $\left[a_n\right]=\left[2^{x_n}+2^{-x_n}\right]=2^{x_n}$, Because $2^{x_n} \in \mathbb{N}$ and $2^{-x_n}<1$, for all $n>0$ Finally we conclude \[\left[a_n\right]=2^{\frac{2^n-(-1)^n}{3}}\]",2,"Let a sequence $(x_n)$ be defined by $x_0=0, x_1=1$ and $x_{n+1} = x_n + 2x_{n-1}$ for $n \geq 1$. Prove that the sequence $(u_n)$ from the problem statement satisfies $u_n = 2^{x_n} + 2^{-x_n}$ for all integers $n \geq 0$.","We prove this by strong induction. \nBase cases: For $n=0$, $u_0=2$ and $2^{x_0}+2^{-x_0}=2^0+2^0=2$. For $n=1$, $u_1=5/2$ and $2^{x_1}+2^{-x_1}=2^1+2^{-1}=5/2$. The statement holds. \nInductive step: Assume $u_k = 2^{x_k} + 2^{-x_k}$ for all $k \leq n$, where $n \geq 1$. From the recurrence $u_{n+1} = u_n(u_{n-1}^2 - 2) - u_1$, we substitute the inductive hypothesis:\n$u_{n+1} = (2^{x_n} + 2^{-x_n})((2^{x_{n-1}} + 2^{-x_{n-1}})^2 - 2) - (2^{x_1} + 2^{-x_1})$.\nSince $(2^{x_{n-1}} + 2^{-x_{n-1}})^2 - 2 = 2^{2x_{n-1}} + 2^{-2x_{n-1}}$, this becomes:\n$u_{n+1} = (2^{x_n} + 2^{-x_n})(2^{2x_{n-1}} + 2^{-2x_{n-1}}) - (2^{x_1} + 2^{-x_1}) = 2^{x_n+2x_{n-1}} + 2^{-x_n-2x_{n-1}} + 2^{x_n-2x_{n-1}} + 2^{-x_n+2x_{n-1}} - (2^{x_1} + 2^{-x_1})$.\nUsing $x_{n+1} = x_n+2x_{n-1}$ and that $x_n-2x_{n-1}=-x_{n-1}+2x_{n-2} = -(x_{n-1}-2x_{n-2})$, this implies $x_n-2x_{n-1} = (-1)^{n-1}(x_1-2x_0)=(-1)^{n-1}$. So, $2^{x_n-2x_{n-1}}+2^{-(x_n-2x_{n-1})} = 2^{(-1)^{n-1}}+2^{-(-1)^{n-1}} = 2^1+2^{-1} = 2^{x_1}+2^{-x_1}$.\nThus, $u_{n+1} = 2^{x_{n+1}} + 2^{-x_{n+1}} + (2^{x_1}+2^{-x_1}) - (2^{x_1}+2^{-x_1}) = 2^{x_{n+1}} + 2^{-x_{n+1}}$. The induction holds.",Prove that for any positive integer $n$ we have $\lfloor u_{n} \rfloor = 2^{\frac {(2^{n} - ( - 1)^{n})}{3}}$.,"From the previous sub-problem, we have $u_n = 2^{x_n} + 2^{-x_n}$, where $x_n$ is defined by $x_0=0, x_1=1$ and $x_{n+1} = x_n + 2x_{n-1}$. The characteristic equation of this recurrence is $r^2 - r - 2 = 0$, with roots $r=2, -1$. The general solution is $x_n = A \cdot 2^n + B \cdot (-1)^n$. Using the initial conditions $x_0=0$ and $x_1=1$, we find $A=1/3$ and $B=-1/3$. Thus, the closed form is $x_n = \frac{2^n - (-1)^n}{3}$.\nFor any integer $n \ge 0$, since $2 \equiv -1 \pmod 3$, $2^n - (-1)^n$ is divisible by 3, so $x_n$ is an integer. For any positive integer $n \ge 1$, $2^n - (-1)^n \ge 2^1 - (-1)^1 = 3$, so $x_n \ge 1$.\nTherefore, for $n \ge 1$, $2^{x_n}$ is an integer and $0 < 2^{-x_n} \le 2^{-1} < 1$. Taking the floor of $u_n = 2^{x_n} + 2^{-x_n}$, we get $\lfloor u_n \rfloor = \lfloor 2^{x_n} + 2^{-x_n} \rfloor = 2^{x_n}$. Substituting the expression for $x_n$, we conclude that for any positive integer $n$, $\lfloor u_{n} \rfloor = 2^{\frac {(2^{n} - ( - 1)^{n})}{3}}$.",,,,
1975p1,"Let $x_i, y_i$ $(i=1,2,\cdots,n)$ be real numbers such that \[x_1\ge x_2\ge\cdots\ge x_n \text{ and } y_1\ge y_2\ge\cdots\ge y_n.\] Prove that, if $z_1, z_2,\cdots, z_n$ is any permutation of $y_1, y_2, \cdots, y_n,$ then \[\sum^n_{i=1}(x_i-y_i)^2\le\sum^n_{i=1}(x_i-z_i)^2.\]","We can expand and simplify the inequality a bit, and using the fact that $z$ is a permutation of $y$, we can cancel some terms. \[\sum^n_{i=1}x_i^2 + \sum^n_{i=1}y_i^2 - 2\sum^n_{i=1}x_iy_i \leq \sum^n_{i=1}x_i^2 + \sum^n_{i=1}z_i^2 - 2\sum^n_{i=1}x_iz_i\]\[\sum^n_{i=1}x_iy_i \geq \sum^n_{i=1}x_iz_i\] Consider the pairing $x_1 \rightarrow y_1$, $x_2 \rightarrow y_2$, ... $x_n \rightarrow y_n$. By switching around some of the $y$ values, we have obtained the pairing $x_1 \rightarrow z_1$, $x_2 \rightarrow z_2$, ... $x_n \rightarrow z_n$. Suppose that we switch around two $y$-values, $y_m$ and $y_n$, such that $y_m > y_n$. If $x_m > x_n$, call this a type 1 move. Otherwise, call this a type 2 move.

Type 2 moves only increase the sum of the products of the pairs. The sum is increased by $x_n \cdot y_m + x_m \cdot y_n - x_m \cdot y_m - x_n \cdot y_n$. This is equivalent to $(x_n - x_m)(y_m - y_n)$, which is clearly nonnegative since $y_m > y_n$ and $x_n > x_m$.

We will now consider switching from the $x$-$z$ pairing back to the $x$-$y$ pairing. We will prove that from any pairing of $x$ and $z$ values, you can use just type 2 moves to navigate back to the pairing of $x$ and $y$ values, which will complete the proof.

Suppose that $x_a$ is the biggest $x$-value that is not paired with its $y$-value in the $x$ and $z$ pairing. Then, switch this $y$-value with the $y$-value currently paired with $x_a$. This is obviously a type 2 move. Continue this process until you reach back to the $x$-$y$ pairing. All moves are type 2 moves, so the proof is complete.",3,"Let $z_1, \dots, z_n$ be a permutation of $y_1, \dots, y_n$. Show that the inequality $\\sum_{i=1}^n(x_i-y_i)^2 \\le \\sum_{i=1}^n(x_i-z_i)^2$ is equivalent to the rearrangement inequality $\\sum_{i=1}^n x_i y_i \\ge \\sum_{i=1}^n x_i z_i$.","Expanding the squares gives $\\sum_{i=1}^n (x_i^2 - 2x_iy_i + y_i^2) \\le \\sum_{i=1}^n (x_i^2 - 2x_iz_i + z_i^2)$. Since $\{z_i\}$ is a permutation of $\{y_i\}$, we have $\\sum_{i=1}^n y_i^2 = \\sum_{i=1}^n z_i^2$. Canceling the common terms $\\sum x_i^2$ and $\\sum y_i^2$ from both sides, we get $-2\\sum_{i=1}^n x_i y_i \\le -2\\sum_{i=1}^n x_i z_i$. Dividing by -2 reverses the inequality, yielding the equivalent statement $\\sum_{i=1}^n x_i y_i \\ge \\sum_{i=1}^n x_i z_i$.","Consider a permutation $z$ of $y$. Suppose for some indices $j < k$, we have $z_j < z_k$. Let $z'$ be the new permutation obtained by swapping $z_j$ and $z_k$. Given $x_j \\ge x_k$, prove that the sum of products does not decrease, i.e., $\\sum_{i=1}^n x_i z'_i \\ge \\sum_{i=1}^n x_i z_i$.","The sums $\\sum x_i z_i$ and $\\sum x_i z'_i$ only differ in the terms for indices $j$ and $k$. The difference is $(\\sum x_i z'_i) - (\\sum x_i z_i) = (x_j z_k + x_k z_j) - (x_j z_j + x_k z_k)$. Rearranging the terms, we get $x_j(z_k - z_j) - x_k(z_k - z_j) = (x_j - x_k)(z_k - z_j)$. Since $x_j \\ge x_k$ and $z_k > z_j$, both factors are non-negative. Therefore, their product is non-negative, which proves the inequality.","Let $x_i, y_i$ $(i=1,2,\\cdots,n)$ be real numbers such that $x_1\\ge x_2\\ge\\cdots\\ge x_n$ and $y_1\\ge y_2\\ge\\cdots\\ge y_n$. Prove that, if $z_1, z_2,\\cdots, z_n$ is any permutation of $y_1, y_2, \\cdots, y_n,$ then $\\sum^n_{i=1}(x_i-y_i)^2\\le\\sum^n_{i=1}(x_i-z_i)^2$.","From sub-problem 1, the inequality is equivalent to proving $\\sum_{i=1}^n x_i y_i \\ge \\sum_{i=1}^n x_i z_i$. Any permutation $z$ can be transformed into the sorted permutation $y$ by a finite sequence of swaps of elements $z_j, z_k$ where $j<k$ but $z_j < z_k$. By sub-problem 2, each such swap does not decrease the sum of products $\\sum x_i z_i$. Since any permutation $z$ can be sorted to become $y$ through such swaps, the sum is maximized when $z=y$. Therefore, $\\sum x_i y_i \\ge \\sum x_i z_i$ for any permutation $z$, which proves the original inequality.",,
1975p2,"Let $a_1, a_2, a_3, \cdots$ be an infinite increasing sequence of positive integers. Prove that for every $p \geq 1$ there are infinitely many $a_m$ which can be written in the form\[a_m = xa_p + ya_q\]with $x, y$ positive integers and $q > p$.","For every $p \ge 1$ we calculate the remainder of each term of the sequence modulo $a(p)$, obtaining $a(p)$ possible remainders, namely $1, \dots , a(p)$.  
Since there are infinitely many terms but only finitely many possible remainders, one remainder must occur for infinitely many terms.  
Let this remainder be $r$ with $1 \le r \le a(p)$; call the first term having this remainder $a(q)$ and denote any subsequent such term by $a(m)$, where $m \to \infty$.  
Clearly $a(m) > a(q) \ge a(p)+1$ and $m > q > p$.

Pick any $a(m) > a(q)$. We claim it can always be written in the form
\[
a(m)=x\,a(p)+y\,a(q).
\]

Write
\[
a(q)=k_1\,a(p)+r,\qquad 
a(m)=k_2\,a(p)+r,
\]
with $k_2>k_1$. Then
\[
a(m)-a(q)=(k_2-k_1)\,a(p),
\qquad\text{so}\qquad
a(m)=(k_2-k_1)\,a(p)+1\cdot a(q).
\]
Setting $x=k_2-k_1$ and $y=1$锟斤拷锟絙oth positive integers锟斤拷锟絞ives the desired representation.

Because there are infinitely many such $a(m)$, for every $p \ge 1$ there exist infinitely many $a(m)$ that can be expressed in the target form.",2,"For a given $p \\ge 1$ and an infinite increasing sequence of positive integers $\{a_n\}$, show that there exists an infinite subsequence of terms $\{a_{m_k}\}$ with indices $m_k > p$ that all have the same remainder when divided by $a_p$.","Consider the infinite number of terms in the sequence $\{a_n\}_{n > p}$. When each of these terms is divided by $a_p$, its remainder must belong to the finite set $\{0, 1, \\ldots, a_p-1\}$. By the Pigeonhole Principle, since there are infinitely many terms but only a finite number of possible remainders, at least one remainder, say $r$, must occur infinitely many times. The terms from $\{a_n\}_{n > p}$ that have this remainder $r$ form the desired infinite subsequence.","Let $a_1, a_2, a_3, \\cdots$ be an infinite increasing sequence of positive integers. Prove that for every $p \\geq 1$ there are infinitely many $a_m$ which can be written in the form $a_m = xa_p + ya_q$ with $x, y$ positive integers and $q > p$.","From the previous result, for any $p \\ge 1$, there exists an infinite subsequence of terms with indices greater than $p$ that are all congruent to some remainder $r$ modulo $a_p$. Let $a_q$ be the first term of such a subsequence, and let $a_m$ be any subsequent term in it. By construction, $m > q > p$. We can write $a_q = k_1 a_p + r$ and $a_m = k_2 a_p + r$ for some integers $k_1, k_2$. Since $\{a_n\}$ is an increasing sequence and $m > q$, we have $a_m > a_q$, which implies $k_2 > k_1$. Subtracting the two equations gives $a_m - a_q = (k_2 - k_1)a_p$. This can be rewritten as $a_m = (k_2 - k_1)a_p + 1 \\cdot a_q$. Setting $x = k_2 - k_1$ and $y=1$ gives the desired form with $x, y$ being positive integers. Since there are infinitely many choices for $a_m$ in the subsequence, the property holds for infinitely many $a_m$.",,,,
1975p3,"On the sides of an arbitrary triangle $ABC$, triangles $ABR, BCP, CAQ$ are constructed externally with $\angle CBP = \angle CAQ = 45^\circ, \angle BCP = \angle ACQ = 30^\circ, \angle ABR = \angle BAR = 15^\circ$. Prove that $\angle QRP = 90^\circ$ and $QR = RP$.","Consider $X$ and $Y$ so that $\triangle CQA\sim \triangle CPX$ and $\triangle CPB\sim \triangle CQY$. Furthermore, let $AX$ and $BY$ intersect at $F$. Now, this means that $\angle PBC = 45 = \angle QAC = \angle PXC$ and $\angle PCB = 15 = \angle QCA = \angle PCX$, so $\triangle BPC\cong \triangle XPC$. Thus, $XC = BC$ and $\angle BCX = 30 + 30 = 60$, so $\triangle BCX$ is equilateral. Similarly is $\triangle ACY$. Yet, it is well-known that the intersection of $BY$ and $AX$, which is $F$, must be the Fermat Point of $\triangle ABC$ if $\triangle AYC$ and $\triangle BXC$ are equilateral. Now, $\angle PBX = 60 - 45 = 15$. Similarly, $\angle PXB = 15$, so $\triangle BRA\sim \triangle BPX$, so a spiral similarity maps $\triangle BPR\sim \triangle BXA$. This implies that $\angle BRP = \angle FAB$. Similarly, $\angle ARQ = \angle FBA$, so $\angle BRP + \angle ARQ = \angle FBA + \angle FAB = 180 - \angle AFB = 60$. Then, $\angle PRQ = (180 - 15 - 15) - 60 = 90$. We also realize that $\frac {AX}{RP} = \frac {AB}{RB} = \frac {AB}{AR} = \frac {BY}{RQ}$. Now, $Y$ is a rotation of $A$ $60$ degrees around $C$ and $B$ is the same rotation of $X$ around $C$, so $AX$ maps to $YB$ from this rotation, so $AX = YB$. It follows that $RP = RQ$.",2,Construct a point $X$ such that $\triangle CPX$ is similar to $\triangle CQA$ constructed externally to $\triangle ABC$. Prove that this implies $\triangle BCX$ is an equilateral triangle and that $\triangle BPR$ is similar to $\triangle BXA$.,"The similarity $\triangle CPX \sim \triangle CQA$ gives $\angle PCX = \angle ACQ = 30^\circ$ and $\angle PXC = \angle CAQ = 45^\circ$. We are given $\angle BCP = 30^\circ$ and $\angle CBP = 45^\circ$. In $\triangle BCP$, $\angle BPC = 180^\circ - 45^\circ - 30^\circ = 105^\circ$. In $\triangle XCP$, $\angle XPC = 180^\circ - 30^\circ - 45^\circ = 105^\circ$. Since $\angle BCP = \angle XCP = 30^\circ$ and they share side $PC$, we have $\triangle BPC \cong \triangle XPC$ by ASA congruence. This yields $BC=XC$ and $BP=XP$. The angle $\angle BCX = \angle BCP + \angle PCX = 30^\circ + 30^\circ = 60^\circ$, so $\triangle BCX$ is equilateral. Since $BP=XP$, $\triangle BPX$ is isosceles. Its angle $\angle PBX = \angle CBX - \angle CBP = 60^\circ - 45^\circ = 15^\circ$. Since $\triangle ABR$ also has base angles of $15^\circ$, $\triangle ABR \sim \triangle PBX$. This similarity implies $BA/BR = BP/BX$. With $\angle PBR = \angle XBA$ (as both are $\angle PBA + 15^\circ$), we get $\triangle BPR \sim \triangle BXA$ by SAS similarity.",Prove that $\angle QRP = 90^\circ$ and $QR = RP$.,"From the first sub-problem, $\triangle BPR \sim \triangle BXA$, which implies $\angle BRP = \angle BAX$. By a symmetric argument, constructing an equilateral triangle $ACY$ on side $AC$ leads to $\triangle AQR \sim \triangle AYB$, which implies $\angle ARQ = \angle ABY$. Let $F$ be the intersection of $AX$ and $BY$. Then $\angle BRP + \angle ARQ = \angle FAX + \angle FBA$. Since $F$ is the Fermat point of $\triangle ABC$, $\angle AFB=120^\circ$. In $\triangle FAB$, $\angle FAB + \angle FBA = 180^\circ - 120^\circ = 60^\circ$. In $\triangle ABR$, $\angle ARB = 180^\circ - 2(15^\circ) = 150^\circ$. Thus, $\angle QRP = \angle ARB - (\angle BRP + \angle ARQ) = 150^\circ - 60^\circ = 90^\circ$. The similarities also give side ratios $RP/XA = BR/BA$ and $QR/YB = AR/AB$. Since $\triangle ABR$ is isosceles, $AR=BR$. A $60^\circ$ rotation about $C$ maps $A \to Y$ and $X \to B$, so segment $AX$ is mapped to $YB$. Rotations are isometries, so $AX=BY$. It follows that $RP=QR$.",,,,
1974p2,"In the triangle $ABC$, prove that there is a point $D$ on side $AB$ such that $CD$ is the geometric mean of $AD$ and $DB$ if and only if $\sin{A}\sin{B} \leq  \sin^2 (\frac{C}{2})$.","Let a point $D$ on the side $AB$. Let $CF$ the altitude of the triangle $\triangle ABC$, and $C'$ the symmetric point of $C$ through $F$. We bring a parallel line $L$ from $C'$ to $AB$. This line intersects the ray $CD$ at the point $E$, and we know that $DE=DC$.

The distance $d(L,AB)$ between the parallel lines $L$ and $AB$ is $CF$.

Let $w = (O,R)$ the circumscribed circle of $\triangle ABC$, and $MM'$ the perpendicular diameter to $AB$, such that $M,C$ are on difererent sides of the line $AB$.

In fact, the problem asks when the line $L$ intersects the circumcircle. Indeed:

Suppose that $DC$ is the geometric mean of $DA,DB$.

$DA \cdot DB = DC^{2}\Rightarrow DA \cdot DB = DC \cdot DE$

Then, from the power of $D$ we can see that $E$ is also a point of the circle $w$. Or else, the line $L$ intersects $w \Leftrightarrow$

$d(L,AB)\leq d(M,AB) \Leftrightarrow$

$CF \leq MN,$ where $MN$ is the altitude of the isosceles $\triangle MAB$.

$\Leftrightarrow \frac{1}{2}CF \cdot AB \leq \frac{1}{2}MN \cdot AB \Leftrightarrow$ $(ABC) \leq (MAB) \Leftrightarrow$ $\frac{AB \cdot BC \cdot AC}{4R}\leq \frac{AB \cdot MA^{2}}{4R}\Leftrightarrow$

$BC \cdot AC \leq MA^{2}$

We use the formulas:

$BC = 2R \cdot \sin A$ $AC = 2R \cdot \sin B$

and $\angle CMA = \frac{C}{2}\Rightarrow MA = 2R \cdot \sin\frac{C}{2}$

So we have $(2R \cdot \sin A)(2R \cdot \sin B) \leq (2R \cdot \sin\frac{C}{2})^{2}\Leftrightarrow$ $\sin A \cdot \sin B \leq \sin^{2}\frac{C}{2}$





For $(\Leftarrow)$

Suppose that $\sin A \cdot \sin B \leq \sin^{2}\frac{C}{2}$

Then we can go inversely and we find that $d(L,AB)\leq d(M,AB) \Leftrightarrow$ the line $L$ intersects the circle $w$ (without loss of generality; if $d(L,AB)=d(M,AB)$ then $L$ is tangent to $w$ at $M$)

So, if $E \in L \cap w$ then for the point $D = CE \cap AB$ we have $DC=DE$ and $AD \cdot AB = CD \cdot DE \Rightarrow$

$AD \cdot AB = CD^{2}$",3,Let $D$ be a point on side $AB$ of $\triangle ABC$. Let $E$ be a point on the line containing the segment $CD$ such that $D$ is the midpoint of $CE$. Show that the condition $CD^2 = AD \cdot DB$ is equivalent to the point $E$ lying on the circumcircle of $\triangle ABC$.,"The condition $CD^2 = AD \cdot DB$ can be rewritten as $CD \cdot DE = AD \cdot DB$, because $D$ is the midpoint of $CE$ and thus $CD=DE$. By the intersecting chords theorem (a specific case of the power of a point theorem), this equality holds if and only if the points $A, B, C, E$ are concyclic. As the circumcircle of $\triangle ABC$ is defined by points $A, B, C$, this condition is equivalent to $E$ lying on this circumcircle.","As the point $D$ moves along the segment $AB$, its corresponding point $E$ (the reflection of $C$ across $D$) traces a path. Show that there exists a point $D$ on $AB$ satisfying the condition from Sub-problem 1 if and only if $AC \cdot BC \leq MA^2$, where $M$ is the midpoint of the circular arc $AB$ on the opposite side of $AB$ from $C$.","The locus of $E$ as $D$ moves on the line segment $AB$ is a line segment on a line $L$ parallel to $AB$. This line $L$ is at the same distance from $AB$ as $C$, but on the opposite side. The existence of a suitable point $D$ requires that the line $L$ intersects the circumcircle $w$. This occurs if the altitude $h_c$ from $C$ to $AB$ is less than or equal to the altitude $h_m$ from $M$ to $AB$. The condition $h_c \le h_m$ is equivalent to Area$(\triangle ABC) \le$ Area$(\triangle MAB)$. Using the formula Area $= \frac{uvw}{4R}$, we get $\frac{AC \cdot BC \cdot AB}{4R} \le \frac{MA \cdot MB \cdot AB}{4R}$. Since $M$ is on the perpendicular bisector of $AB$, $MA=MB$. This simplifies the inequality to $AC \cdot BC \le MA^2$.","In the triangle $ABC$, prove that there is a point $D$ on side $AB$ such that $CD$ is the geometric mean of $AD$ and $DB$ if and only if $\sin{A}\sin{B} \leq  \sin^2 (\frac{C}{2})$.","From the previous sub-problems, the existence of such a point $D$ is equivalent to the inequality $AC \cdot BC \le MA^2$. We express these lengths using the circumradius $R$ and angles of $\triangle ABC$. By the extended sine rule, $AC = 2R\sin B$ and $BC = 2R\sin A$. The point $M$ is the midpoint of the arc $AB$ not containing $C$, so the angle subtended by the chord $MA$ at the circumference is $\angle MCA = C/2$. The chord length is given by $MA = 2R\sin(\angle MCA) = 2R\sin(C/2)$. Substituting these into the inequality gives $(2R\sin A)(2R\sin B) \le (2R\sin(C/2))^2$, which simplifies to $\sin A \sin B \le \sin^2(C/2)$. Since all the steps are equivalences, the proof is complete.",,
1974p3,Prove that the number $\sum^n_{k=0}\binom{2n+1}{2k+1}2^{3k}$ is not divisible by $5$ for any integer $n\ge0.$,"Everything that follows takes place in $\mathbb F_5(\sqrt 2)$, i.e. the field we get by adjoining a root of $x^2-2=0$ to $\mathbb F_5$, the field with $5$ elements.

We have $\sum_{k=0}^n\binom{2n+1}{2k+1}2^{3k}=\sum_{k=0}^n\binom{2n+1}{2n-2k}3^k=\sum_{k=0}^n\binom{2n+1}{2(n-k)}2^{-k}$. Now, this is zero iff it's zero when we multiply it by $2^n$, so we may as well prove that $\sum_{k=0}^n\binom{2n+1}{2(n-k)}\sqrt 2^{2(n-k)}\ne 0$. The LHS is $\alpha$ from $(1+\sqrt 2)^{2n+1}=\alpha+\beta\sqrt 2,\ \alpha,\beta\in\mathbb F_5$. We have $(1-\sqrt 2)^{2n+1}=\alpha-\beta\sqrt 2$, so by multiplying them we get $-1=\alpha^2-2\beta^2$. If we were to have $\alpha=0$, then we would get $1=2\beta^2,\ \beta\in\mathbb F_5$, and this is impossible, since it would make $3=2^{-1}$ a square $\beta^2$ in $\mathbb F_5$ (i.e. $3$ would be a quadratic residue modulo $5$, and it's not).",2,Let the integer sequences $\alpha_n$ and $\beta_n$ be defined by the expansion $(1+\sqrt{2})^{2n+1} = \alpha_n + \beta_n\sqrt{2}$ for $n \ge 0$. Prove that $\alpha_n^2 - 2\beta_n^2 = -1$.,"Consider the conjugate expression $(1-\sqrt{2})^{2n+1} = \alpha_n - \beta_n\sqrt{2}$. Multiplying these two equations gives $( (1+\sqrt{2})(1-\sqrt{2}) )^{2n+1} = (\alpha_n + \beta_n\sqrt{2})(\alpha_n - \beta_n\sqrt{2})$. The left side of the equation simplifies to $(1-2)^{2n+1} = (-1)^{2n+1} = -1$. The right side expands to the form $\alpha_n^2 - 2\beta_n^2$. Thus, we establish the identity $\alpha_n^2 - 2\beta_n^2 = -1$.",Prove that the number $\sum^n_{k=0}\binom{2n+1}{2k+1}2^{3k}$ is not divisible by $5$ for any integer $n\ge0$.,"Let $S_n$ be the given sum. We work in $\mathbb{F}_5$, the field with 5 elements. The sum is congruent to $\sum_{k=0}^n\binom{2n+1}{2(n-k)}2^{-k} \pmod 5$. Multiplying by $2^n$ (which is non-zero in $\mathbb{F}_5$), we see $S_n \equiv 0$ iff $2^nS_n \equiv \sum_{k=0}^n\binom{2n+1}{2(n-k)}2^{n-k} \equiv 0 \pmod 5$. Let $j=n-k$. The sum becomes $\sum_{j=0}^n\binom{2n+1}{2j}2^j$, which is the rational part $\alpha_n$ in the expansion $(1+\sqrt{2})^{2n+1} = \alpha_n + \beta_n\sqrt{2}$. From the first sub-problem, we have the relation $\alpha_n^2 - 2\beta_n^2 = -1$ in $\mathbb{F}_5$. If $\alpha_n=0$, this gives $-2\beta_n^2 = -1$, so $2\beta_n^2=1$, which implies $\beta_n^2=3$. This is a contradiction, as the quadratic residues modulo $5$ are $0, 1, 4$, and $3$ is not among them. Therefore, $\alpha_n \neq 0$, which implies $S_n$ is not divisible by $5$.",,,,
1974p6,"Let $P$ be a non-constant polynomial with integer coefficients. If $n(P)$ is the number of distinct integers $k$ such that $(P(k))^2=1,$ prove that $n(P)-\deg(P)\le2,$ where $\deg(P)$ denotes the degree of the polynomial $P.$","Lemma: Let $P(x)$ be a polynomial with integer coefficients which is not constant. Then if $P(x)$ obtains $1$ (or $-1$) as its values for at least four times then $P(x)\neq -1$ ( or $P(x)\neq 1$) for all $x$. Proof. Assume that $P(a)=P(b)=P(c)=P(d)=1$ for $a,b,c,d$ distince. Then if there's $u$ which $P(u)=-1$ then $2=P(a)-P(u)=...$ so $P(x)-P(u)-2=(x-a)(x-b)(x-c)(x-d)Q(x)$ where $Q(x)$ is a polynomial with the integer coefficients! So $-2=(u-a)(u-b)(u-c)(u-d)Q(u)$ which is impossible cause $-2$ can not presents as product of more than three distince numbers! This proved the lemma!

Back to our problem: For convinet put $m=n(P)$ and $n=\deg P$. Firstly if $n\leq 2$ then $m-n\leq2$. Assume $n\geq3$. If equation $P(x)=1$ with more than three integer points (ie.. at least $4$) then equation $(P(x))^2=1$ implies $P(x)=1$ so $m\leq n$, ie... $m-n\leq 0\leq2$. The same case for equation $P(x)=-1$. So $m\leq 6$. If $n\geq4$ then $m-n\leq 6-n\leq 2$. Now assume that $n=3$. In this case if $m\leq 5$ then $m-n\leq 2$.

So let us show that $m<6$. In fact if $m=6$ then $P(x)-1=0$ has three integers distince roots, and the same for $P(x)+1=0$. So $P(x)-1=k_1(x-a_1)(x-a_2)(x-a_3)$ and $P(x)+1=k_2(x-b_1)(x-b_2)(x-b_3)$ where $a_i$ distince and $b_j$ distince and all with $k_1,k_2$ are integers! Then $k_2(x-b_1)(x-b_2)(x-b_3)-k_1(x-a_1)(x-a_2)(x-a_3)=2$ for all $x$. So $k_1=k_2=k$. Finally, we have $2=k(a_i-b_1)(a_i-b_2)(a_i-b_3)$ for $i=1,2,3$ and because that $\pm1$ can not presents as products of three distince numbers so $k=\pm1$, we may assume $k=1$. Because $2=(-2)\cdot 1\cdot -1$ so $\{-2,1,-1\}=\{a_i-b_1,a_i-b_2,a_i-b_3\}$ This means $3a_i-(b_1+b_2+b_3)=-2+1-1=-2$. So we must have $3a_1=3a_2=3a_3$ which follows $a_1=a_2=a_3$, which contracts!. So $m\leq 5$ and we're done.",3,"Let $P(x)$ be a non-constant polynomial with integer coefficients. Show that if $P(x)=1$ for at least four distinct integers, then $P(x)=-1$ for no integer.","Let $a,b,c,d$ be four distinct integers where $P(x)=1$. This implies that $P(x)-1=(x-a)(x-b)(x-c)(x-d)Q(x)$ for some polynomial $Q(x)$ with integer coefficients. Assume for contradiction that there is an integer $k$ such that $P(k)=-1$. Substituting $x=k$ into the equation gives $P(k)-1 = -2 = (k-a)(k-b)(k-c)(k-d)Q(k)$. The terms $(k-a), (k-b), (k-c), (k-d)$ are four distinct non-zero integers, and $Q(k)$ is an integer. However, the number $-2$ cannot be expressed as a product of four distinct integers (the smallest magnitude of such a product is $|1 \cdot (-1) \cdot 2 \cdot (-2)| = 4$). This is a contradiction, so no such integer $k$ exists.",Let $P(x)$ be a polynomial of degree 3 with integer coefficients. Prove that the total number of distinct integer roots for both equations $P(x)=1$ and $P(x)=-1$ is at most 5.,"Let $n_1$ and $n_{-1}$ be the number of distinct integer roots of $P(x)=1$ and $P(x)=-1$. As $\deg(P)=3$, we have $n_1 \le 3$ and $n_{-1} \le 3$. Assume for contradiction that the total is 6, meaning $n_1=3$ and $n_{-1}=3$. Let the roots be $\{a_1,a_2,a_3\}$ and $\{b_1,b_2,b_3\}$. Then $P(x)-1 = c(x-a_1)(x-a_2)(x-a_3)$ and $P(x)+1=c(x-b_1)(x-b_2)(x-b_3)$ for some non-zero integer leading coefficient $c$. Subtracting the two identities gives $2 = c[(x-b_1)(x-b_2)(x-b_3) - (x-a_1)(x-a_2)(x-a_3)]$. Evaluating at $x=a_i$ for $i=1,2,3$ yields $2 = c(a_i-b_1)(a_i-b_2)(a_i-b_3)$. The product $(a_i-b_1)(a_i-b_2)(a_i-b_3)$ must be a product of three distinct integers whose value is $\pm 1$ or $\pm 2$. The only possibilities are $1 \cdot (-1) \cdot (-2)=2$ or $1 \cdot (-1) \cdot 2 = -2$. In either case, the sum of these three distinct factors is non-zero. Let this sum be $S$. Then for each $i$, $(a_i-b_1)+(a_i-b_2)+(a_i-b_3) = 3a_i-(b_1+b_2+b_3)=S$. This implies $3a_1=3a_2=3a_3$, which contradicts that $a_1,a_2,a_3$ are distinct. Thus, the total number of roots cannot be 6, so it is at most 5.","Let $P$ be a non-constant polynomial with integer coefficients. If $n(P)$ is the number of distinct integers $k$ such that $(P(k))^2=1,$ prove that $n(P)-\deg(P)\le2,$ where $\deg(P)$ denotes the degree of the polynomial $P.$","Let $n=\deg(P)$. Let $n_1$ and $n_{-1}$ be the number of distinct integer solutions to $P(k)=1$ and $P(k)=-1$ respectively. Then $n(P)=n_1+n_{-1}$. By Sub-problem 1, if $n_1 \ge 4$, then $n_{-1}=0$, so $n(P)=n_1$. Since $P(x)-1$ has $n_1$ roots, its degree $n$ must be at least $n_1$. Thus, $n(P)-n = n_1-n \le 0 \le 2$. The same logic applies if $n_{-1} \ge 4$. Now, consider the case where $n_1 \le 3$ and $n_{-1} \le 3$. This means $n(P) \le 6$. If $n \ge 4$, then $n(P)-n \le 6-n \le 2$. If $n \in \{1,2\}$, we have $n(P) = n_1+n_{-1} \le n+n = 2n$, so $n(P)-n \le n \le 2$. Finally, if $n=3$, we use Sub-problem 2, which shows that $n(P) = n_1+n_{-1} \le 5$. Therefore, $n(P)-n \le 5-3=2$. The inequality holds in all cases.",,
1973p1,"Point $O$ lies on line $g;$ $\overrightarrow{OP_1}, \overrightarrow{OP_2},\cdots, \overrightarrow{OP_n}$ are unit vectors such that points $P_1, P_2, \cdots, P_n$ all lie in a plane containing $g$ and on one side of $g.$ Prove that if $n$ is odd, \[\left|\overrightarrow{OP_1}+\overrightarrow{OP_2}+\cdots+ \overrightarrow{OP_n}\right|\ge1.\] Here $\left|\overrightarrow{OM}\right|$ denotes the length of vector $\overrightarrow{OM}.$","We prove it by induction on the number $2n+1$ of vectors. The base step (when we have one vector) is clear, and for the induction step we use the hypothesis for the $2n-1$ vectors obtained by disregarding the outermost two vectors. We thus get a vector with norm $\ge 1$ betwen two with norm $1$. The sum of the two vectors of norm $1$ makes an angle of $\le\frac\pi 2$ with the vector of norm $\ge 1$, so their sum has norm $\ge 1$, and we're done.",1,"Point $O$ lies on line $g;$ $\overrightarrow{OP_1}, \overrightarrow{OP_2},\cdots, \overrightarrow{OP_n}$ are unit vectors such that points $P_1, P_2, \cdots, P_n$ all lie in a plane containing $g$ and on one side of $g.$ Prove that if $n$ is odd, \[\left|\overrightarrow{OP_1}+\overrightarrow{OP_2}+\cdots+ \overrightarrow{OP_n}\right|\ge1.\] Here $\left|\overrightarrow{OM}\right|$ denotes the length of vector $\overrightarrow{OM}.$","We prove it by induction on the number $2n+1$ of vectors. The base step (when we have one vector) is clear, and for the induction step we use the hypothesis for the $2n-1$ vectors obtained by disregarding the outermost two vectors. We thus get a vector with norm $\ge 1$ betwen two with norm $1$. The sum of the two vectors of norm $1$ makes an angle of $\le\frac\pi 2$ with the vector of norm $\ge 1$, so their sum has norm $\ge 1$, and we're done.",,,,,,
1973p5,"$G$ is a set of non-constant functions of the real variable $x$ of the form \[f(x) = ax + b, a \text{ and } b \text{ are real numbers,}\] and $G$ has the following properties:

(a) If $f$ and $g$ are in $G$, then $g \circ f$ is in $G$; here $(g \circ f)(x) = g[f(x)]$.

(b) If $f$ is in $G$, then its inverse $f^{-1}$ is in $G$; here the inverse of $f(x) = ax + b$ is $f^{-1}(x) = (x - b) / a$.

(c) For every $f$ in $G$, there exists a real number $x_f$ such that $f(x_f) = x_f$.

Prove that there exists a real number $k$ such that $f(k) = k$ for all $f$ in $G$.","First, observe that for each function $f(x)=ax+b$ in $G$, if $a=1$ then $b=0$. This is a result of (c); for example, $f(x)=x+1$ could not be in $G$ because it does not have a fixed point. Or if $f(x)=x$, then every point is a fixed point.

Also, for each function $f(x)=ax+b$ in $G$, if $a \neq 1$ then the fixed point of $f$ is where $y=ax+b$ intersects $y=x$, namely where $x=\frac{b}{a-1}$.

Now, take $f_1(x)=a_1 x+b_1$ and $f_2(x)=a_2 x+b_2$, both in $G$. By (a), $(f_1 \circ f_2)(x)=f_1(f_2(x))=f_1(a_2 x+b_2)=a_1 a_2 x + a_1 b_2 + b_1$ and $(f_2 \circ f_1)(x)=f_2(f_1(x))=f_2(a_1 x+b_1)=a_1 a_2 x + a_2 b_1 + b_2$ must also both be in $G$. By (b), $(f_1 \circ f_2)^{-1}(x)=\frac{x - a_1 b_2 - b_1}{a_1 a_2}$ must also be in $G$. Finally, by (a),

$((f_1 \circ f_2)^{-1} \circ (f_2 \circ f_1))(x)=\frac{a_1 a_2 x + a_2 b_1 + b_2 - a_1 b_2 - b_1}{a_1 a_2}$ $= x + \frac{a_2 b_1 + b_2 - a_1 b_2 - b_1}{a_1 a_2}$

must also be in $G$.

Using our first observation, $\frac{a_2 b_1 + b_2 - a_1 b_2 - b_1}{a_1 a_2}=0$. Rearranging, we get $\frac{b_1}{a_1-1}=\frac{b_2}{a_2-1}$. Therefore, the fixed point of $f_1$ equals the fixed point of $f_2$. Since we made no assumptions about $f_1$ and $f_2$, this is true for all $f$ in $G$.",2,Let $f_1(x) = a_1x + b_1$ and $f_2(x) = a_2x + b_2$ be any two functions in $G$. Prove that $b_1(1-a_2) = b_2(1-a_1)$.,"Let $f_1(x) = a_1x+b_1$ and $f_2(x) = a_2x+b_2$ be in $G$. By properties (a) and (b), the function $h = (f_1 \circ f_2)^{-1} \circ (f_2 \circ f_1)$ must be in $G$. The components are $f_2 \circ f_1(x) = a_1a_2x + a_2b_1 + b_2$ and $(f_1 \circ f_2)^{-1}(x) = \frac{x - (a_1b_2+b_1)}{a_1a_2}$. The composition is $h(x) = \frac{(a_1a_2x + a_2b_1+b_2) - (a_1b_2+b_1)}{a_1a_2} = x + \frac{a_2b_1+b_2-a_1b_2-b_1}{a_1a_2}$. Since $h \in G$, by property (c), it must have a fixed point. A function of the form $x+c$ has a fixed point if and only if $c=0$. Thus, $a_2b_1+b_2-a_1b_2-b_1=0$. Rearranging gives $b_1(a_2-1) = b_2(a_1-1)$, which is equivalent to $b_1(1-a_2) = b_2(1-a_1)$.",Prove that there exists a real number $k$ such that $f(k) = k$ for all $f$ in $G$.,"If all functions in $G$ have slope $a=1$, property (c) implies they are all the identity function $f(x)=x$, so any real number $k$ is a common fixed point. Otherwise, there exists at least one function $f_1(x)=a_1x+b_1$ in $G$ with $a_1 \neq 1$. Let its unique fixed point be $k = \frac{b_1}{1-a_1}$. For any other function $f_2(x)=a_2x+b_2$ in $G$, we use the result from Sub-problem 1: $b_1(1-a_2) = b_2(1-a_1)$. If $a_2 \neq 1$, the fixed point of $f_2$ is $x_2 = \frac{b_2}{1-a_2}$. The relation implies $\frac{b_2}{1-a_2} = \frac{b_1}{1-a_1}$, so $x_2=k$. If $a_2=1$, property (c) implies $b_2=0$, so $f_2(x)=x$, which fixes every point, including $k$. Thus, $k$ is a common fixed point for all functions in $G$.",,,,
1972p1,"Prove that from a set of ten distinct two-digit numbers (in the decimal system), it is possible to select two disjoint subsets whose members have the same sum.","There are $2^{10}-2=1022$ distinct subsets of our set of 10 two-digit numbers. The sum of the elements of any subset of our set of 10 two-digit numbers must be between $10$ and $90+91+92+93+94+95+96+97+98+99 < 10 \cdot 100 = 1000$. (There are fewer attainable sums.) As $1000 < 1022$, the Pigeonhole Principle implies there are two distinct subsets whose members have the same sum. Let these sets be $A$ and $B$. Now, let $A' = A - (A \cap B)$ and $B' = B - (A \cap B)$. Notice $A'$ and $B'$ are disjoint. They are also nonempty because if $A = A \cap B$ or $B = A \cap B$, then one of $A$ and $B$ is a subset of the other, so they are either not distinct or have different sums. Therefore $A'$ and $B'$ are disjoint subsets our set of 10 distinct two-digit numbers, which proves the claim. $\square$",2,"Let S be a set of ten distinct two-digit numbers. Prove that there exist two distinct subsets of S, say A and B, such that the sum of the elements in A is equal to the sum of the elements in B.","The number of subsets of the set S is $2^{10} = 1024$. The sum of elements for any subset of S is a non-negative integer. The maximum possible sum is the sum of the ten largest two-digit numbers: $99+98+...+90 = 945$. Therefore, there are at most 946 possible values for the sum of a subset (from 0 to 945). Since the number of subsets (1024) is greater than the number of possible sums (946), by the Pigeonhole Principle, there must be at least two distinct subsets, A and B, that have the same sum.","Prove that from a set of ten distinct two-digit numbers, it is possible to select two disjoint subsets whose members have the same sum.","From the previous result, we know there exist two distinct subsets, A and B, with the same sum. Let C be their intersection, $C = A \cap B$. Let $A' = A \setminus C$ and $B' = B \setminus C$. The sets A' and B' are disjoint by construction. The sum of elements in A can be written as sum(A') + sum(C), and the sum of elements in B is sum(B') + sum(C). Since sum(A) = sum(B), it follows that sum(A') = sum(B'). Since A and B are distinct and the numbers are positive, A' and B' must be non-empty. Therefore, A' and B' are two disjoint subsets with the same sum.",,,,
1972p2,"Prove that if $n \geq 4$, every quadrilateral that can be inscribed in a circle can be dissected into $n$ quadrilaterals each of which is inscribable in a circle.","First, let us remember that a quadrilateral $ABCD$ is inscribable if and only if a pair of opposing angles adds up to $\pi,$ in other words $\angle A + \angle C = \pi,$ or equivalently, $\angle B + \angle D = \pi$. In particular, any isosceles trapezoid is inscribable.

Let us assume that $\angle A$ is less or equal than all the other angles. We can assume this because otherwise, we would just need to re-label the vertices.

Choose a point $P$ inside $ABCD$, and draw the parallel $PH$ to $AB$, with $H \in DA$. There will be restrictions on the position of $P$, which we will discuss as we do the construction.

Choose $E \in AB$ so that $AEPH$ is an isosceles trapezoid. In order for this to be possible, $P$ has to be inside the angle $\angle ABB_1$ formed by drawing the line $BB_1$ such that $\angle ABB_1 = \angle A$.

Next, choose $F \in BC$ so that $\angle PFB = \angle A$. This will ensure that $EBFP$ is inscribable because $\angle PEB = \pi - \angle A$. In order for $F$ to exist in $BC$, $P$ has to be inside the angle $BCC_1$ formed by drawing the line $CC_1$ such that $\angle BCC_1 = \angle A$.

Next choose $G \in CD$ such that $PG \parallel BC$. This will ensure that $PFCG$ is an isosceles trapezoid because $\angle PFC = \pi - \angle A = \angle C$. In order for $G$ to exist in $CD$, $P$ has to be inside the angle $\angle CDD_1$ formed by drawing the line $DD_1$ such that $\angle CDD_1 = \angle A$.

With these choices, it is easy to see that $GDHP$ is inscribable. Indeed, $\angle PHD = \angle A$, and $\angle DGP = \pi - \angle CGP = \angle C = \pi - \angle A$.

We now just have to show that the intersection of the interiors of angles $\angle ABB_1, \angle BCC_1, \angle CDD_1$ is not $\O$. This follows immediately from noticing that $DD_1 \parallel BC$.

We now proceed by induction on $n$. For $n = 4$ we dissected the inscribable quadrilateral $ABCD$ in two inscribable rectangles, and $2 = 4 - 2$ isosceles trapezoids. Assume we dissected the inscribable quadrilateral $ABCD$ in two inscribable rectangles, and $k - 2$ isosceles trapezoids. Then we dissect one of the isosceles trapezoids in two isosceles trapezoids by a line parallel to the bases, thus obtaining the statement for $k + 1$.",3,Show that any inscribable quadrilateral can be dissected into four inscribable quadrilaterals.,"Let ABCD be an inscribable quadrilateral. It is possible to choose an interior point P and points E, F, G, H on sides AB, BC, CD, DA respectively, partitioning ABCD into four quadrilaterals. The construction involves setting PH parallel to AB, PG parallel to BC, and choosing E and F to make AEPH an isosceles trapezoid and to make angle PFB equal to angle A. With these choices, all four smaller quadrilaterals (AEPH, EBFP, PFCG, GDHP) are inscribable. Specifically, AEPH and PFCG are isosceles trapezoids, which are always inscribable. For EBFP and GDHP, it can be shown that their opposite angles sum to pi by using the properties of the construction and the fact that ABCD is inscribable.",Show that an isosceles trapezoid can be dissected into two smaller isosceles trapezoids.,"Let an isosceles trapezoid be defined by vertices PQRS, with PQ parallel to SR. Draw a line segment TU parallel to PQ, where T is on PS and U is on QR. This line divides the trapezoid PQRS into two smaller trapezoids, PQTU and TURS. Since the new line segment is parallel to the bases, the new quadrilaterals are also trapezoids. Because the original trapezoid PQRS was isosceles, the base angles are equal. This property is preserved in the smaller trapezoids, making them isosceles as well. Since all isosceles trapezoids are inscribable in a circle, this dissects one inscribable quadrilateral into two.","Prove that if n >= 4, every quadrilateral that can be inscribed in a circle can be dissected into n quadrilaterals each of which is inscribable in a circle.","We proceed by induction on n. The base case, n=4, is established by Sub-problem 1, which also provides a construction where some of the resulting quadrilaterals are isosceles trapezoids. For the inductive step, assume that any inscribable quadrilateral can be dissected into k inscribable quadrilaterals for some k >= 4, and that at least one of these is an isosceles trapezoid. Using the result from Sub-problem 2, we can take this isosceles trapezoid and dissect it into two smaller ones. This results in a new dissection of the original quadrilateral into k-1+2 = k+1 inscribable quadrilaterals. Therefore, by the principle of mathematical induction, the statement holds for all n >= 4.",,
1972p3,Let $m$ and $n$ be arbitrary non-negative integers. Prove that \[\frac{(2m)!(2n)!}{m!n!(m+n)!}\] is an integer. ($0! = 1$.),"This solution uses the fact that ${n \choose k} = \frac{n!}{k!(n - k)!}, k = 0, \dots n$ are the coefficients of the powers of $x$ in the expansion of $(1 + x)^n$ (see Binomial Theorem or https://en.wikipedia.org/wiki/Binomial_coefficient). Of course these coefficients, hence these expressions in $n, k$ are integers.

Without loss of generality, we can assume $m \le n$. We will use the identity

$S(m, n) = \frac{(2m)!(2n)!}{m!n!(m+n)!} = (-1)^m \sum_{k=0}^{k=2m} (-1)^k {2m \choose k} {2n \choose m + n - k}$.

This identity is attributed to K. von Szily (1894). Note that we could take the sum over all integers, using the convention that ${n \choose k} = 0$ when $k < 0$ or $k > n$.

The fact that $S(m, n)$ is integer follows immediately from this identity because the right hand side is integer.

Thus, we just need to prove this identity.

Start with $(1 - x^2)^{m + n} = (1 + x)^{m + n} (1 - x)^{m + n}$. Expand both sides and look at the coefficient of $x^{2m}$ in both expansions. Equate the two expressions giving the coefficient of $x^{2m}$ in the two sides. We get

$(-1)^m {m + n \choose m} = \sum_{k=0}^{2m} {m + n \choose k} \cdot (-1)^{2m - k} {m + n \choose 2m - k}$.

Write out the binomial coefficients in terms of factorials, and multiply both sides by $(-1)^m \frac{(2m)!(2n)!}{[(m + n)!]^2}$. We get

$\frac{(m + n)!}{m!n!} \cdot \frac{(2m)!(2n)!}{[(m + n)!]^2} = (-1)^m \sum_{k=0}^{2m} (-1)^k \frac{(m + n)!}{k!(m + n - k)!} \cdot \frac{(m + n)!}{(2m - k)!(n - m + k)!} \cdot \frac{(2m)!(2n)!}{[(m + n)!]^2}$

Simplifying and rearranging factors, we get

$\frac{(2m)!(2n)!}{m!n!(m + n)!} = (-1)^m \sum_{k=0}^{2m} (-1)^k \frac{(2m)!}{k!(2m - k)!} \cdot \frac{(2n)!}{(n + m - k)!(n - m + k)!} = (-1)^m \sum_{k=0}^{2m} (-1)^k {2m \choose k} {2n \choose n + m - k}$

This finishes the problem.",3,"By comparing the coefficient of $x^{2m}$ in the expansion of both sides of the identity $(1 - x^2)^{m + n} = (1 + x)^{m + n} (1 - x)^{m + n}$, prove that $(-1)^m \binom{m+n}{m} = \sum_{k=0}^{2m} (-1)^{k} \binom{m+n}{k} \binom{m+n}{2m-k}$.","The binomial expansion of the left side is $(1 - x^2)^{m + n} = \sum_{j=0}^{m+n} \binom{m+n}{j} (-x^2)^j$. The coefficient of $x^{2m}$ occurs when $j=m$, which is $(-1)^m \binom{m+n}{m}$. For the right side, we use the Cauchy product of the expansions of $(1+x)^{m+n} = \sum_{i=0}^{m+n} \binom{m+n}{i} x^i$ and $(1-x)^{m+n} = \sum_{j=0}^{m+n} \binom{m+n}{j} (-1)^j x^j$. The coefficient of $x^{2m}$ is $\sum_{k=0}^{2m} \binom{m+n}{k} \binom{m+n}{2m-k} (-1)^{2m-k}$. Since $(-1)^{2m-k} = (-1)^{-k} = (-1)^k$, equating coefficients gives the desired identity: $(-1)^m \binom{m+n}{m} = \sum_{k=0}^{2m} (-1)^{k} \binom{m+n}{k} \binom{m+n}{2m-k}$.","Starting with the identity from the previous step, prove the von Szily identity: $\frac{(2m)!(2n)!}{m!n!(m+n)!} = (-1)^m \sum_{k=0}^{2m} (-1)^k \binom{2m}{k} \binom{2n}{m+n-k}$.",Start with $(-1)^m \binom{m+n}{m} = \sum_{k=0}^{2m} (-1)^{k} \binom{m+n}{k} \binom{m+n}{2m-k}$. Express the binomial coefficients in factorial form: $(-1)^m \frac{(m+n)!}{m!n!} = \sum_{k=0}^{2m} (-1)^{k} \frac{(m+n)!}{k!(m+n-k)!} \frac{(m+n)!}{(2m-k)!(n-m+k)!}$. Multiply both sides by $(-1)^m \frac{(2m)!(2n)!}{[(m+n)!]^2}$. The left side simplifies to $\frac{(2m)!(2n)!}{m!n!(m+n)!}$. The general term on the right side simplifies to $(-1)^m (-1)^k \frac{(2m)!}{k!(2m-k)!} \frac{(2n)!}{(m+n-k)!(n-m+k)!}$. This is equal to $(-1)^m \sum_{k=0}^{2m} (-1)^k \binom{2m}{k} \binom{2n}{m+n-k}$.,Let $m$ and $n$ be arbitrary non-negative integers. Prove that $\frac{(2m)!(2n)!}{m!n!(m+n)!}$ is an integer.,"From the von Szily identity derived in the previous step, we have the expression $\frac{(2m)!(2n)!}{m!n!(m+n)!} = (-1)^m \sum_{k=0}^{2m} (-1)^k \binom{2m}{k} \binom{2n}{m+n-k}$. The binomial coefficients $\binom{a}{b}$ are integers for non-negative integers $a, b$. Therefore, each term in the summation, $(-1)^k \binom{2m}{k} \binom{2n}{m+n-k}$, is an integer. The finite sum of integers is an integer. Finally, multiplying this sum by $(-1)^m$ yields an integer. Thus, the original expression is an integer.",,
1972p5,"Let $f$ and $g$ be real-valued functions defined for all real values of $x$ and $y$, and satisfying the equation \[f(x + y) + f(x - y) = 2f(x)g(y)\] for all $x, y$. Prove that if $f(x)$ is not identically zero, and if $|f(x)| \leq 1$ for all $x$, then $|g(y)| \leq 1$ for all $y$.","Let $u>0$ be the least upper bound for $|f(x)|$ for all $x$. So, $|f(x)| \leq u$ for all $x$. Then, for all $x,y$,

$2u \geq |f(x+y)+f(x-y)| = |2f(x)g(y)|=2|f(x)||g(y)|$

Therefore, $u \geq |f(x)||g(y)|$, so $|f(x)| \leq u/|g(y)|$.

Since $u$ is the least upper bound for $|f(x)|$, $u/|g(y)| \geq u$. Therefore, $|g(y)| \leq 1$.",1,"Let $f$ and $g$ be real-valued functions defined for all real values of $x$ and $y$, and satisfying the equation \[f(x + y) + f(x - y) = 2f(x)g(y)\] for all $x, y$. Prove that if $f(x)$ is not identically zero, and if $|f(x)| \leq 1$ for all $x$, then $|g(y)| \leq 1$ for all $y$.","Let $u>0$ be the least upper bound for $|f(x)|$ for all $x$. So, $|f(x)| \leq u$ for all $x$. Then, for all $x,y$,

$2u \geq |f(x+y)+f(x-y)| = |2f(x)g(y)|=2|f(x)||g(y)|$

Therefore, $u \geq |f(x)||g(y)|$, so $|f(x)| \leq u/|g(y)|$.

Since $u$ is the least upper bound for $|f(x)|$, $u/|g(y)| \geq u$. Therefore, $|g(y)| \leq 1$.",,,,,,
1972p6,"Given four distinct parallel planes, prove that there exists a regular tetrahedron with a vertex on each plane.","Let's denote the (directed) distance between two parallel planes p and p' by d (p; p'), and the (directed) distance between two parallel lines g and g' by d (g; g'). (Directed distances are defined as follows: If $p_1$, $p_2$, $p_3$, ... is a family of parallel planes in space, then we choose a unit vector $\overrightarrow{v}_p$ perpendicular to all of these planes (there are two such unit vectors, and we have to choose one of them), and then, by the directed distance between two of these planes $p_i$ and $p_j$, we denote the real number k such that the translation with translation vector $k\cdot\overrightarrow{v}_p$ maps the plane $p_i$ to the plane $p_j$. Similarly, we define the directed distance between two of a family of parallel lines in a plane.)

The problem can be rewritten as follows: Given four distinct parallel planes $p_1$, $p_2$, $p_3$, $p_4$ in space, prove that there exists a regular tetrahedron XYZW such that $X\in p_1$, $Y\in p_2$, $Z\in p_3$, $W\in p_4$.

In order to do this, it is enough to find a regular tetrahedron ABCD somewhere in space and four parallel planes $q_1$, $q_2$, $q_3$, $q_4$ such that $A\in q_1$, $B\in q_2$, $C\in q_3$, $D\in q_4$ and $d\left(q_1;\;q_2\right): d\left(q_2;\;q_3\right): d\left(q_3;\;q_4\right)=d\left(p_1;\;p_2\right): d\left(p_2;\;p_3\right): d\left(p_3;\;p_4\right)$. In fact, once we have found such a tetrahedron ABCD and such planes $q_1$, $q_2$, $q_3$, $q_4$, then, because of $p_1\parallel p_2\parallel p_3\parallel p_4$, $q_1\parallel q_2\parallel q_3\parallel q_4$ and $d\left(q_1;\;q_2\right): d\left(q_2;\;q_3\right): d\left(q_3;\;q_4\right)=d\left(p_1;\;p_2\right): d\left(p_2;\;p_3\right): d\left(p_3;\;p_4\right)$, there exists a similitude transformation which maps the planes $q_1$, $q_2$, $q_3$, $q_4$ to the planes $p_1$, $p_2$, $p_3$, $p_4$; this similitude transformation will then obviously map the regular tetrahedron ABCD with $A\in q_1$, $B\in q_2$, $C\in q_3$, $D\in q_4$ to a regular tetrahedron XYZW with $X\in p_1$, $Y\in p_2$, $Z\in p_3$, $W\in p_4$; hence, the existence of such a tetrahedron XYZW will be proven, and the problem will be solved.

So consider a regular tetrahedron ABCD lying arbitrarily in space; we try to find four parallel planes $q_1$, $q_2$, $q_3$, $q_4$ such that $A\in q_1$, $B\in q_2$, $C\in q_3$, $D\in q_4$ and $d\left(q_1;\;q_2\right): d\left(q_2;\;q_3\right): d\left(q_3;\;q_4\right)=d\left(p_1;\;p_2\right): d\left(p_2;\;p_3\right): d\left(p_3;\;p_4\right)$.

In fact, we start working in the plane ABC. Let T be the point on the line AC such that $AT: TC=d\left(p_1;\;p_2\right): d\left(p_2;\;p_3\right)$ (where the segments AT and TC are directed). Let $g_2$ be the line BT, and let $g_1$ and $g_3$ be the parallels to the line $g_2=BT$ through the points A and C, respectively. Then, the lines $g_1$, $g_2$, $g_3$ are parallel and, by Thales, $d\left(g_1;\;g_2\right): d\left(g_2;\;g_3\right)=AT: TC$. Thus, $d\left(g_1;\;g_2\right): d\left(g_2;\;g_3\right)=d\left(p_1;\;p_2\right): d\left(p_2;\;p_3\right)$. Now, denote by $g_4$ the line in the plane ABC which is parallel to the lines $g_1$, $g_2$, $g_3$ and satisfies $d\left(g_1;\;g_2\right): d\left(g_2;\;g_3\right): d\left(g_3;\;g_4\right)=d\left(p_1;\;p_2\right): d\left(p_2;\;p_3\right): d\left(p_3;\;p_4\right)$.

Now, let $q_4$ be the plane passing through the line $g_4$ and the point D. Let $q_1$, $q_2$, $q_3$ be the planes parallel to $q_4$ and passing through the lines $g_1$, $g_2$, $g_3$, respectively (of course, we can construct such planes since the lines $g_1$, $g_2$, $g_3$ are parallel to $g_4$). Thus, we have found four parallel planes $q_1$, $q_2$, $q_3$, $q_4$ such that $A\in q_1$, $B\in q_2$, $C\in q_3$, $D\in q_4$, and these planes obviously satisfy $d\left(q_1;\;q_2\right): d\left(q_2;\;q_3\right): d\left(q_3;\;q_4\right)=d\left(g_1;\;g_2\right): d\left(g_2;\;g_3\right): d\left(g_3;\;g_4\right)$. Since $d\left(g_1;\;g_2\right): d\left(g_2;\;g_3\right): d\left(g_3;\;g_4\right)=d\left(p_1;\;p_2\right): d\left(p_2;\;p_3\right): d\left(p_3;\;p_4\right)$, we thus have $d\left(q_1;\;q_2\right): d\left(q_2;\;q_3\right): d\left(q_3;\;q_4\right)=d\left(p_1;\;p_2\right): d\left(p_2;\;p_3\right): d\left(p_3;\;p_4\right)$. Hence, according to the above, the problem is solved.",4,"Show that the existence of a regular tetrahedron with a vertex on each of four given parallel planes, $p_1, p_2, p_3, p_4$, is proven if one can find *any* regular tetrahedron ABCD and a corresponding set of parallel planes, $q_1, q_2, q_3, q_4$, passing through its vertices, whose inter-plane distance ratios match those of the given planes.","Let the given planes be $p_1, p_2, p_3, p_4$. Assume we can find a regular tetrahedron ABCD and four parallel planes $q_1, q_2, q_3, q_4$ with $A \in q_1, B \in q_2, C \in q_3, D \in q_4$ such that the ratio of distances $d(q_1, q_2) : d(q_2, q_3) : d(q_3, q_4)$ equals $d(p_1, p_2) : d(p_2, p_3) : d(p_3, p_4)$. Since both sets of planes are parallel and their distance ratios are equal, there exists a similitude transformation (a composition of scaling, rotation, and translation) that maps the set of planes \{$q_1, q_2, q_3, q_4$\} to \{$p_1, p_2, p_3, p_4$\}. This same similitude will map the regular tetrahedron ABCD to another regular tetrahedron XYZW, whose vertices will lie on the planes $p_1, p_2, p_3, p_4$. Thus, proving the existence of the constructed set is sufficient.","For an arbitrary triangle ABC (a face of a regular tetrahedron) and a given ratio $r_1 : r_2$, show it is possible to construct three parallel lines $g_1, g_2, g_3$ in the plane of the triangle, passing through A, B, and C respectively, such that the ratio of distances $d(g_1, g_2) : d(g_2, g_3)$ equals $r_1 : r_2$.","In the plane containing triangle ABC, choose a point T on the line AC such that the ratio of directed lengths $AT : TC = r_1 : r_2$. Define the line $g_2$ to be the line passing through B and T. Let $g_1$ be the line through A parallel to $g_2$, and let $g_3$ be the line through C parallel to $g_2$. By construction, $g_1, g_2, g_3$ are parallel. By Thales' theorem, using AC as a transversal, the ratio of the perpendicular distances between these parallel lines is equal to the ratio of the segments they cut on the transversal: $d(g_1, g_2) : d(g_2, g_3) = AT : TC = r_1 : r_2$.","For an arbitrary regular tetrahedron ABCD and a given ratio $r_1:r_2:r_3$, prove there exist four parallel planes $q_1, q_2, q_3, q_4$ passing through A, B, C, D respectively, such that the ratio of their directed distances $d(q_1, q_2) : d(q_2, q_3) : d(q_3, q_4)$ is equal to $r_1:r_2:r_3$.","Start with a regular tetrahedron ABCD. In the plane ABC, construct three parallel lines $g_1, g_2, g_3$ through A, B, C with distance ratio $d(g_1, g_2) : d(g_2, g_3) = r_1 : r_2$, as shown in the previous sub-problem. In the same plane, construct a fourth line $g_4$ parallel to the others such that the full ratio is satisfied: $d(g_1, g_2) : d(g_2, g_3) : d(g_3, g_4) = r_1:r_2:r_3$. Now, define the plane $q_4$ as the unique plane containing the line $g_4$ and the vertex D. Define planes $q_1, q_2, q_3$ to be parallel to $q_4$ and to pass through A, B, and C respectively. These planes will contain the lines $g_1, g_2, g_3$. The ratio of distances between these parallel planes $q_i$ is equal to the ratio of distances between the lines $g_i$, which was constructed to be $r_1:r_2:r_3$.","Given four distinct parallel planes, prove that there exists a regular tetrahedron with a vertex on each plane.","Let the four given planes be $p_1, p_2, p_3, p_4$ and let the ratio of their directed distances be $r_1:r_2:r_3 = d(p_1, p_2) : d(p_2, p_3) : d(p_3, p_4)$. From the previous sub-problem, we can take an arbitrary regular tetrahedron ABCD and construct a set of four parallel planes $q_1, q_2, q_3, q_4$ passing through its vertices, such that the ratio of their distances is also $r_1:r_2:r_3$. As established in the first sub-problem, the existence of this constructed tetrahedron and its associated planes implies, via a similitude transformation, the existence of a regular tetrahedron XYZW whose vertices lie on the given planes $p_1, p_2, p_3, p_4$. Therefore, such a tetrahedron exists."
1971p1,"Prove that the following assertion is true for $n=3$ and $n=5$, and that it is false for every other natural number $n>2:$

If $a_1, a_2,\cdots, a_n$ are arbitrary real numbers, then $(a_1-a_2)(a_1-a_3)\cdots (a_1-a_n)+(a_2-a_1)(a_2-a_3)\cdots (a_2-a_n)+\cdots+(a_n-a_1)(a_n-a_2)\cdots (a_n-a_{n-1})\ge 0.$","Let us note that the assumptions $a_1 \ge a_2 \ge a_3$ in case $n = 3$ and $a_1 \ge a_2 \ge a_3 \ge a_4 \ge a_5$ in case $n = 5$ are perfectly legitimate. A different ordering of these numbers could be reduced to this case by a simple change of notation: we would substitute $a_i$ by $b_j$ with the indexes for the $b$'s chosen in such a way that the inequalities above are true for the $b$'s.

The inequality $(a_1 - a_2)[(a_1 - a_3)(a_1 - a_4)(a_1 - a_5) - (a_2 - a_3)(a_2 - a_4)(a_2 - a_5)] \ge 0$ is true because $a_1 - a_2 \ge 0$, and $(a_1 - a_3)(a_1 - a_4)(a_1 - a_5) - (a_2 - a_3)(a_2 - a_4)(a_2 - a_5) \ge 0$. To see this latter inequality, just notice that $a_1 - a_3 \ge a_2 - a_3$, and similarly for the other pairs of factors. The difference of the products is $\ge 0$ as desired.

The argument for the sum of the last two terms in $E_5$ is similar.

The case $n = 3$ is very easy to prove in a different way. Note that

$(a_1 - a_2)(a_1 - a_3) + (a_2 - a_1)(a_2 - a_3) + (a_3 - a_1)(a_3 - a_2) = \frac{1}{2}[(a_1 - a_2)^2 + (a_2 - a_3)^2 + (a_3 - a_1)^2]$

I could not find an identity which would give such a simple proof in the case $n = 5$.

By looking at the proof above, we can also see that for $n = 3$ we have equality if and only if $a_1 = a_2 = a_3$. For $n = 5$, assuming that $a_1 \ge a_2 \ge a_3 \ge a_4 \ge a_5$, we have equality if and only if $a_1 = a_2$ and $a_3 = a_4 = a_5$, or $a_1 = a_2 = a_3$ and $a_4 = a_5$.

If we denote $P(x) = (x - a_1) \cdots (x - a_n)$, then the expression in the problem is $E_n = P'(a_1) + \cdots + P'(a_n)$, where $P'(x)$ is the derivative of $P(x)$. (This is easy to see by calculating $P'(x)$ when $P(x)$ is written as a product rather than as a sum of powers of $x$.)

The graph of $P(x)$ as $x$ goes from $-\infty$ to $\infty$ crosses the $x$-axis, or is tangent to the $x$-axis at every root $a_k$. If the graph is tangent to the $x$-axis, it crosses it, or it stays in the same half plane, depending on the multiplicity of the root. At a simple root $a_k, P'(a_k) > 0$ or $P'(a_k) < 0$ depending on the direction of the graph of $P(x)$ at $a_k$. At a multiple root $a_k = \cdots = a_{k+p}, P'(a_k) = 0$, and the graph of $P(x)$ crosses the $x$-axis or not, depending on $p$ being odd or even.

This way of looking at the problem makes it very easy to find examples which prove the problem for $n$ even, or $n \ge 7$ and odd, because we would be looking for polynomials whose graph crosses the $x$-axis once from the upper half plane to the lower half plane at a simple root $a_k$ (thus making $P'(a_k) < 0$), and is tangent to the $x$-axis at all the other roots. See the picture below for images showing the graphs of such polynomials.",4,"Prove that for any real numbers $a_1, a_2, a_3$, the inequality $(a_1-a_2)(a_1-a_3) + (a_2-a_1)(a_2-a_3) + (a_3-a_1)(a_3-a_2) \ge 0$ holds.","The expression is symmetric in $a_1, a_2, a_3$. Expanding the products gives $ (a_1^2 - a_1a_3 - a_1a_2 + a_2a_3) + (a_2^2 - a_2a_3 - a_1a_2 + a_1a_3) + (a_3^2 - a_2a_3 - a_1a_3 + a_1a_2) $. This simplifies to $a_1^2 + a_2^2 + a_3^2 - a_1a_2 - a_2a_3 - a_3a_1$. This expression is famously equivalent to $\frac{1}{2}[(a_1-a_2)^2 + (a_2-a_3)^2 + (a_3-a_1)^2]$. As a sum of squares, it is always greater than or equal to zero.","Let $E_n(a_1, \dots, a_n) = \sum_{i=1}^n \prod_{j \neq i} (a_i - a_j)$. Prove that for $n=5$, $E_5 \ge 0$ for any real numbers $a_1, \dots, a_5$.","Without loss of generality, assume $a_1 \ge a_2 \ge a_3 \ge a_4 \ge a_5$. The expression can be viewed as $E_5 = \sum_{i=1}^5 P'(a_i)$ where $P(x) = \prod_{k=1}^5 (x-a_k)$. We group terms of the sum. The sum of the first two terms is $(a_1-a_2)[\prod_{k=3}^5(a_1-a_k) - \prod_{k=3}^5(a_2-a_k)] \ge 0$ because $a_1-a_k \ge a_2-a_k \ge 0$ for $k\in\{3,4,5\}$. The middle term, $P'(a_3)=(a_3-a_1)(a_3-a_2)(a_3-a_4)(a_3-a_5)$, is a product of two non-positive and two non-negative terms, hence $P'(a_3) \ge 0$. The sum of the last two terms is $(a_4-a_5)[\prod_{k=1}^3(a_4-a_k) - \prod_{k=1}^3(a_5-a_k)] \ge 0$ because $a_4-a_5 \ge 0$ and the term in brackets is also non-negative, since $0 \ge a_4-a_k \ge a_5-a_k$ for $k\in\{1,2,3\}$. The total sum $E_5$ is a sum of non-negative quantities, so $E_5 \ge 0$.",Show that the assertion is false for any even integer $n > 2$ and any odd integer $n \ge 7$.,"Let the expression be $E_n$. We provide counterexamples by selecting non-distinct values for $a_i$, noting the expression is the limit of the distinct case. For any even $n > 2$, let $a_1 = -1$ and $a_2 = \dots = a_n = 0$. This corresponds to the polynomial $P(x)=(x+1)x^{n-1}$. The sum is $E_n = P'(-1) + (n-1)P'(0)$. $P'(x) = x^{n-2}(nx+n-1)$. Since $n>2$, $P'(0)=0$. $P'(-1) = (-1)^{n-2}(-n+n-1) = -1$. Thus $E_n=-1<0$. For any odd $n \ge 7$, let $a_1 = 1$, three of the $a_i$ be $0$, three be $2$, and the remaining $n-7$ be $3$. For $n=7$, let $a_1=1, a_2=a_3=a_4=0, a_5=a_6=a_7=2$. The sum is $E_7 = P'(1)$ for $P(x)=(x-1)x^3(x-2)^3$. As $0$ and $2$ are multiple roots, other terms are zero. $P'(1) = (1)^3(1-2)^3 = -1 < 0$. This construction provides counterexamples for all odd $n \ge 7$.","Prove that the following assertion is true for $n=3$ and $n=5$, and that it is false for every other natural number $n>2:$ If $a_1, a_2,\cdots, a_n$ are arbitrary real numbers, then $(a_1-a_2)(a_1-a_3)\cdots (a_1-a_n)+(a_2-a_1)(a_2-a_3)\cdots (a_2-a_n)+\cdots+(a_n-a_1)(a_n-a_2)\cdots (a_n-a_{n-1})\ge 0.$","The assertion's validity depends on the value of $n$. Sub-problem 1 proved the assertion is true for $n=3$. Sub-problem 2 proved the assertion is true for $n=5$. Sub-problem 3 provided explicit counterexamples demonstrating the assertion is false for all even integers $n > 2$ (i.e., $n=4, 6, 8, \dots$) and for all odd integers $n \ge 7$ (i.e., $n=7, 9, 11, \dots$). Combining these results, the assertion is true if and only if $n=3$ or $n=5$, and false for all other natural numbers $n>2$."
1971p2,"Consider a convex polyhedron $P_1$ with nine vertices $A_1, A_2, \cdots, A_9;$ let $P_i$ be the polyhedron obtained from $P_1$ by a translation that moves vertex $A_1$ to $A_i(i=2,3,\cdots, 9).$ Prove that at least two of the polyhedra $P_1, P_2,\cdots, P_9$ have an interior point in common.","WLOG let $A_1$ be the origin $0$. Take any point $A_i$, then $P_i=A_i+P_1$, lies in $2 P_1$, the polyhedron $P_1$ stretched by the factor $2$ on $P_1=0$. More general: take any $p,q$ in any convex shape $S$. Then $p+q \in 2S$. Prove: since $S$ is convex, $\frac{p+q}{2} \in S$, thus $p+q \in 2S$.

Now all these nine polyhedrons lie inside $2 P_1$. Let $V$ be the volume of $P_1$. Then some polyhedrons with total sum of volumes $9V$ lie in a shape of volume $8V$, thus they must overlap, meaning that they have an interior point in common.",1,"Consider a convex polyhedron $P_1$ with nine vertices $A_1, A_2, \cdots, A_9;$ let $P_i$ be the polyhedron obtained from $P_1$ by a translation that moves vertex $A_1$ to $A_i(i=2,3,\cdots, 9).$ Prove that at least two of the polyhedra $P_1, P_2,\cdots, P_9$ have an interior point in common.","WLOG let $A_1$ be the origin $0$. Take any point $A_i$, then $P_i=A_i+P_1$, lies in $2 P_1$, the polyhedron $P_1$ stretched by the factor $2$ on $P_1=0$. More general: take any $p,q$ in any convex shape $S$. Then $p+q \in 2S$. Prove: since $S$ is convex, $\frac{p+q}{2} \in S$, thus $p+q \in 2S$.

Now all these nine polyhedrons lie inside $2 P_1$. Let $V$ be the volume of $P_1$. Then some polyhedrons with total sum of volumes $9V$ lie in a shape of volume $8V$, thus they must overlap, meaning that they have an interior point in common.",,,,,,
1971p3,Prove that the set of integers of the form $2^k - 3(k = 2; 3; \cdots)$ contains an infinite subset in which every two members are relatively prime.,"Denote $A_n = 2^{a_n} - 3$. The plan is to construct recursively a sequence $a_1 < a_2 < \dots < a_n < \dots$ such that $A_n$ and $A_k$ are relatively prime for all $k < n$.

Let $a_1 = 3$. (Note that any other number $> 3$ would serve just as well.)

Let $p_{1,1}, \dots, p_{1,k_1}$ be all the prime factors of $A_1 = 2^{a_1} - 3$. (Note that we did not specify whether any prime factors are repeated or not. It does not matter for the proof, the important thing is to take all prime factors.) In our case, $k_1 = 1$ and $p_{1,1} = 5$ since we took $a_1 = 3$.

Define $a_2 = a_1 (p_{1,1} - 1) \dots (p_{1,k_1} - 1)$. In our case $a_2 = 3 (5 - 1) = 12$.

Define $\{a_n\}$ recursively: let $\{p_{(n-1),1}, \dots, p_{(n-1),k_{n-1}}\}$ be all the prime factors of $A_{n-1} = 2^{a_{n-1}} - 3$. (Note again that we don't care whether factors are repeated or not.) Let us take $a_n = a_{n-1} (p_{(n-1),1} - 1) \dots (p_{(n-1),k_{n-1}} - 1)$.

At this point, note for later use that if $p$ is a prime factor of any $A_k, k \in \{1, \dots, (n-1)\}$ then $(p - 1)$ is a factor of $a_n$. Also, note that all such factors $p$ are odd, because all $A_k$ are odd.

Let $B = A_n + 2 = 2^{a_n} - 1$. If $p$ is a prime factor of any of the $A_k, k \in \{1, \dots, n-1\}$, then $p$ is a factor of $B$. Indeed, note that $a_n = b \cdot (p - 1)$ for some $b$, so $B = 2^{a_n} - 1 = 2^{b \cdot (p - 1)} - 1 = (2^b)^{p-1} - 1$, which is divisible by $p$ according to Fermat's_Little_Theorem.

It follows that $A_n = 2^{a_n} - 3$ is coprime with all $A_k, k \in \{1, \dots, (n-1)\}$. This can be justified easily, by noting that if there were a common factor $b$ between $A_n$ and an $A_k$, there would exist a prime common factor $p$. But then this $p$ would be a common factor between two consecutive odd integers $A_n$ and $B$, which is impossible.",3,"Let a sequence of integers $\{a_n\}$ be defined by $a_1=3$ and for $n>1$, $a_n = a_{n-1} \prod_{p | (2^{a_{n-1}}-3)} (p-1)$, where the product is over the distinct prime factors of $2^{a_{n-1}}-3$. Let $A_m = 2^{a_m}-3$. Show that for any $n > 1$ and any prime factor $p$ of $A_k$ where $k < n$, we have $2^{a_n} \equiv 1 \pmod{p}$.","By construction, if $p$ is a prime factor of $A_k = 2^{a_k}-3$ for $k<n$, then $(p-1)$ divides $a_{k+1}$. Since $a_{k+1}$ divides $a_{k+2}$ and so on up to $a_n$, we have that $(p-1)$ divides $a_n$. Thus, $a_n = m(p-1)$ for some integer $m$. As $A_k$ is odd for $a_k \ge 2$, $p$ must be an odd prime. By Fermat's Little Theorem, $2^{p-1} \equiv 1 \pmod{p}$, so $2^{a_n} = (2^{p-1})^m \equiv 1^m \equiv 1 \pmod{p}$.","Let $\{A_n = 2^{a_n}-3\}$ be the sequence constructed in the previous sub-problem. Prove that for any $n > 1$, $A_n$ is relatively prime to $A_k$ for all $k < n$.","Let $p$ be a common prime factor of $A_n$ and $A_k$ for some $k < n$. Since $p$ divides $A_k$, from the previous sub-problem we know that $2^{a_n} \equiv 1 \pmod{p}$. This implies $A_n = 2^{a_n} - 3 \equiv 1 - 3 = -2 \pmod{p}$. Since $p$ also divides $A_n$, we have $A_n \equiv 0 \pmod{p}$. This implies $0 \equiv -2 \pmod{p}$, which means $p$ must divide 2, so $p=2$. However, for any $a_k \ge a_1=3$, $A_k = 2^{a_k} - 3$ is odd, so it cannot be divisible by 2. This is a contradiction, so no common prime factor exists. Therefore, $\gcd(A_n, A_k) = 1$.",Prove that the set of integers of the form $2^k - 3(k = 2; 3; \\cdots)$ contains an infinite subset in which every two members are relatively prime.,"We construct an infinite sequence of such integers that are pairwise relatively prime. Let $a_1=3$ and for $n>1$, define $a_n = a_{n-1} \prod_{p | (2^{a_{n-1}}-3)} (p-1)$, as in sub-problem 1. Since $2^{a_{n-1}}-3 > 1$ for $a_{n-1} \ge 2$, it has prime factors, and each such prime factor $p$ is odd, so $p-1 \ge 2$. Thus $a_n > a_{n-1}$, and the sequence $\{a_n\}$ is strictly increasing with $a_n \ge 3$ for all $n$. This generates an infinite sequence of distinct integers $A_n = 2^{a_n}-3$ from the specified set. From sub-problem 2, we know that these integers are pairwise relatively prime. Thus, the set $\{A_1, A_2, A_3, \dots\}$ is the required infinite subset.",,
1971p4,"All the faces of tetrahedron $ABCD$ are acute-angled triangles. We consider all closed polygonal paths of the form $XYZTX$ defined as follows: $X$ is a point on edge $AB$ distinct from $A$ and $B$; similarly, $Y, Z, T$ are interior points of edges $BC, CD, DA$, respectively. Prove:

(a) If $\angle DAB + \angle BCD \neq \angle CDA + \angle ABC$, then among the polygonal paths, there is none of minimal length.

(b) If $\angle DAB + \angle BCD = \angle CDA + \angle ABC$, then there are infinitely many shortest polygonal paths, their common length being $2AC \sin(\alpha / 2)$, where $\alpha = \angle BAC + \angle CAD + \angle DAB$.","The basic idea is to ""fold out"" the tetrahedron into a polygon in the plane. The path $XYZTX$ becomes a collection of connected segments $XY, YZ, ZT, TX'$ with the unconnected ends $X, X'$ on the two line segments $AB, A'B'$.

Specifically, we rotate the solid consisting of three faces around $BC$ so $\triangle BCD$ is in the same plane as $\triangle ABC$. Then we rotate the solid consisting of two faces around  $CD$ so that $\triangle CDA'$ is in the same plane with the previous triangles. (We denoted $A'$ the new ""copy"" of $A$, since the original $A$ is being used in the picture.) Finally, we rotate $\triangle A'BD$ around $A'D$, so that it is in the same plane with the other triangles. (We denote $B'$ the new ""copy"" of $B$, and $X'$ the new copy of $X$.)

The polygonal path $XYZTX$ becomes $XYZTX'$. It is clear that in order to minimize $XYZTX$, we should make $XYZTX'$ be a segment on a straight line. Furthermore, to minimize the segment $XX'$, we want to choose $X \in AB$ so that when we draw the line segment to its corresponding image $X' \in A'B'$, the length of $XX'$ is as short as possible.

This was the ""folding out"" done in the solution above. To continue, we will do a different ""folding out"", which will serve better for solving the problem. Specifically, we rotate $\triangle BCD$ around $BC$, then we rotate $\triangle ABD$ around $AB$ to obtain $\triangle ABD'$, and finally, we rotate $\triangle AD'C$ around $AD'$ to obtain $\triangle AD'C'$. Now $Z \in CD$ becomes $Z' \in C'D'$. The polygonal path becomes $ZYXTZ'$ going from $CD$ to $C'D'$. We need to make this as small as possible, to find its minimum, if it exists.

The idea of the solution to the problem is now easy to explain. First of all, $ZYXTZ'$ needs to be a segment on a straight line, in which case its length is the length of the segment $ZZ'$. Clearly $ZYXTZ' = ZZ'$ has a lower bound (after all, it is $> 0$), so we can think about its lower limit. If there is a position of $Z$ in which this lower limit is achieved, then this lower limit is a minimum. Otherwise, there is no minimum value for $ZYXTZ'$. (Pay attention to the subtle distinction between lower bound, lower limit, and minimum.)

In the picture above, $CD$ and $C'D'$ are not parallel. The segment $ZZ'$ would be shortest when $Z = D$ (and $Z' = D'$). But this is not an acceptable position for $ZYXTZ'$, because the problem stated that $Z$ is between $C$ and $D$, not equal to any of them. So in this picture, there is no minimum for the polygonal path. (In this case there is a lower limit for $ZZ'$, namely $DD'$, which is not a minimum.)

On the other hand, if $CD \parallel C'D'$ (see pictures below) then generally there are lots of points $Z \in CD$ yielding a minimum value for $ZYXTZ'$. Indeed, in this case $CC' \parallel ZZ' \parallel DD'$, so the only requirement is for all the points $X, Y, Z, T$ to be inside the respective segments. (In this case, $ZZ' = CC' = DD'$ is a lower limit, and it is a minimum.)

We will prove that $\angle DAB + \angle BCD = \angle CDA + \angle ABC$ if and only if $CD \parallel C'D'$. After this it will be easy to deduce all the statements of the problem.

Let $M, N, P$ be on $CA, BD', AC'$ be such that $CD \parallel MB \parallel AN \parallel PD'$. The equality $\angle DAB + \angle BCD = \angle CDA + \angle ABC$ becomes $\angle D'AB + \angle BCD = \angle C'D'A + \angle ABC$, and then it becomes $\angle D'AN + \angle NAB + \angle BCD = \angle C'D'P + \angle PD'A + \angle ABM + \angle MBC$. Because of the parallelism of $CD, MB, AN, PD'$ we have several equal angles on the two sides of this equality. This equality becomes $\angle C'D'P = 0$.

So, the original equality $\angle DAB + \angle BCD = \angle CDA + \angle ABC$ is true if and only if $\angle C'D'P = 0$, which is true if and only if $CD \parallel C'D'.$

Now it is obvious that when $\angle DAB + \angle BCD \neq \angle CDA + \angle ABC$ a lower limit exists (as expected), but it is not a minimum, and a minimum does not exist.

On the other hand, when $\angle DAB + \angle BCD = \angle CDA + \angle ABC$, in the typical, general case, $ZZ' = DD'$ is the minimum, and there are infinitely many segments $ZZ'$ of the same size (see Figure 2 below).

There is one delicate point we need to worry about: we have to be sure that $ZZ'$ intersects $CB, BA, AD'$. See Figure 3 for an example when this does not happen; note that in this example we have some obtuse angles. Formally, $A$ has to be on the same side of $DD'$ as $C, C'$ and $B$ has to be on the same side of $CC'$ as $D, D'$.

Let us concentrate on the position of $A$ vs. $DD'$ (the statement about $B$ is similar). We want $\angle DAB + \angle BAD' < \pi$. We have $\angle DAB < \angle CAD$ and $\angle BAD' = \text{the original } \angle BAD \text{ from the tetrahedron}$. Since both $\angle CAD, \angle BAD$ are acute, it follows that $\angle DAB + \angle BAD' < \pi$.

The last thing to do is to compute $ZZ'$. We have $ZZ' = CC'$, and from the isosceles triangle $\triangle CAC'$ we have $CM = \sin \angle CAM$, where $M$ is the midpoint of $CC'$. This gives $ZZ' = CC' = 2 AC \sin \frac{\alpha}{2}$, which is the formula we wanted.",4,"Unfold the tetrahedron's surface into a plane to represent the path's length. Let the faces containing the path edges be laid out contiguously in the plane by rotating around shared edges $DA, AB, BC$. Show that the length of the polygonal path $XYZTX$ is minimized when its unfolded representation is a straight line segment connecting the starting point $Z$ on edge $CD$ to its final image $Z'$ after the sequence of rotations.","The path consists of segments $TX, XY, YZ, ZT$. Let's trace the path starting from $Z$ on edge $CD$. We unfold the sequence of faces $CDA, DAB, ABC, BCD$ into a plane. The path $Z \to T \to X \to Y \to Z$ becomes a planar polyline from point $Z$ on the initial edge $CD$ to its final image $Z'$ on the image of the same edge. The length of the path is the length of this polyline. By the triangle inequality, the shortest distance between two points is a straight line. Thus, the minimum possible length of the path corresponds to the straight line segment $ZZ'$ in the unfolded plane.","In the planar unfolding from Sub-problem 1, let the line containing the original edge $CD$ be $L$ and the line containing its final image be $L'$. Prove that $L$ is parallel to $L'$ if and only if $\angle DAB + \angle BCD = \angle CDA + \angle ABC$.","The line $L'$ is obtained from $L$ by a sequence of rotations. The net angle of rotation determines whether $L'$ is parallel to $L$. The condition for parallelism is that the sum of the angles of the planar polygon formed by the vertices of the unfolded faces satisfies certain conditions. By analyzing the angles of this unfolded polygon, the sum of the vertex angles corresponding to tetrahedron vertices A and C must equal the sum of those corresponding to B and D. This translates to the condition that the sum of the angles of the faces meeting at opposite vertices of the tetrahedron are equal, which is precisely $\angle DAB + \angle BCD = \angle CDA + \angle ABC$.","If $\angle DAB + \angle BCD = \angle CDA + \angle ABC$, show that the length of the shortest path is $2AC \sin(\alpha/2)$, where $\alpha = \angle BAC + \angle CAD + \angle DAB$.","When the angle condition holds, the lines $CD$ and its image $C'D'$ are parallel. The shortest path length is the constant distance between these lines, for any point $Z$ on $CD$. This distance is equal to the length of the segment $CC'$. In the unfolded plane, consider the triangle $\triangle CAC'$. This is an isosceles triangle with two sides of length equal to the edge $AC$. The angle $\angle CAC'$ is the sum of the three face angles at vertex $A$ of the tetrahedron, so $\angle CAC' = \alpha$. Using trigonometry on the isosceles triangle, the length of the base $CC'$ is $2AC \sin(\alpha/2)$.","Prove: (a) If $\angle DAB + \angle BCD \neq \angle CDA + \angle ABC$, then among the polygonal paths, there is none of minimal length. (b) If $\angle DAB + \angle BCD = \angle CDA + \angle ABC$, then there are infinitely many shortest polygonal paths, their common length being $2AC \sin(\alpha / 2)$, where $\alpha = \angle BAC + \angle CAD + \angle DAB$.","(a) From Sub-problem 2, if the angle equality does not hold, the lines containing edge $CD$ and its image $C'D'$ are not parallel. The shortest path length is the length of the segment $ZZ'$, which varies as $Z$ moves along $CD$. The minimum distance between the non-parallel line segments $CD$ and $C'D'$ would occur at an endpoint ($C$ or $D$). Since $Z$ must be an interior point, the infimum length is not achieved, so no path of minimal length exists.\n(b) From Sub-problem 2, if the angle equality holds, the lines are parallel. The path length is minimized to a constant value, calculated in Sub-problem 3 as $2AC \sin(\alpha/2)$. The condition that all faces are acute-angled ensures that for any interior point $Z$ on $CD$, the straight-line path $ZZ'$ intersects the interior of the intermediate edges $DA, AB, BC$. Since $Z$ can be any of the infinitely many interior points of $CD$, there are infinitely many shortest paths."
1971p5,"Prove that for every natural number $m$, there exists a finite set $S$ of points in a plane with the following property: For every point $A$ in $S$, there are exactly $m$ points in $S$ which are at unit distance from $A$.","We will give a proof by induction on $m$. First some notation:

Given two finite sets of points $S, T$ in the complex plane, and given $\theta \in [0, 2\pi)$, define $U = S \oplus_\theta T = \{a + e^{i \theta} b, \text{\ for all\ } a \in S, b \in T\}$.

$\mathbf{Proposition}$: If $S$ is $m$-regular and $T$ is $n$-regular, and $S \cap T = \emptyset$, then we can choose $\theta$ so that $U = S \oplus_\theta T$ is $(m + n)$-regular.

$\mathbf{Proof}$: Let $a_i, i = 1, \dots, m$ be the neighboring points in $S$ at distance $1$ from $a$, and $b_j, j = 1, \dots, n$ be the neighboring points in $T$ at distance $1$ from $b.$ Clearly $a_i + e^{i \theta} b$ is at distance $1$ from $a + e^{i \theta} b$ and $a + e^{i \theta} b_j$ is at distance $1$ from $a + e^{i \theta} b$. So $a + e^{i \theta} b$ has $(m + n)$ neighbors at distance $1$ if we choose $\theta$ such that $a_i + e^{i \theta} b \neq a + e^{i \theta} b_j$ for all $i, j$.

But the equations $a_i + e^{i \theta} b = a + e^{i \theta} b_j$ are just a finite number of linear equations in $e^{i \theta}$, so we just have to avoid choosing $\theta$ giving a solution to any of these equations. Thus, with such a choice of $\theta$ there are definitely at least $(m + n)$ points in $U$ at distance $1$ from $a + e^{i \theta} b$.

We have to show that we can choose $\theta$ so that there are no more than $(m + n)$ points at distance $1$. If we had more points from $U$ at distance $1$ from $a + e^{i \theta} b$, we would have $\vert (a + e^{i \theta} b) - (c + e^{i \theta} d) \vert = 1$ for some $c \in S$ and $d \in T$.

This would imply $\vert (a + e^{i \theta} b) - (c + e^{i \theta} d) \vert^2 = 1$,

or $\vert (a - c) + e^{i \theta} (b - d) \vert^2 = 1$,

or $[(a - c) + e^{i \theta} (b - d)] [\overline{(a - c)} + e^{-i \theta} \overline{(b - d)}] = 1$,

or $\vert (a - c) \vert^2 + e^{i \theta} \overline{(a - c)}(b - d) + e^{-i \theta} (a - c) \overline{(b - d)} + \vert (b - d) \vert^2 = 1$.

This becomes an equation of degree $2$ in $e^{i \theta}$. So as long as we choose $\theta$ not to equal to any of the solutions of these equations, we can be sure that none of the points in $U$ are at distance $1$ from $a + e^{i \theta} b$.

This proves the proposition because we have to choose $\theta \in [0, 2\pi)$ different from finite number of values.

Now the problem is very simple to prove by induction.

For $m = 1$, take $S_1 = \{0, 1\}$, which is a $1$-regular set. For the induction step, assume we have $S_{m-1}$ an $(m-1)$-regular graph. Using the proposition, it follows that we can choose $\theta$ such that $S_m = S_{m-1} \oplus_{\theta} T_1$ is an $m$-regular graph, where $T_1$ consists of two points in the plane at distance $1$, none of which is in $S_{m-1}$.

(Just for the sake of completeness, let us mention that when we choose $\theta$, it is a value in $[0, 2\pi)$ which differs from a finite set of values modulo $2\pi$, dependent on the points in $S_{m-1}, T_1$.)",4,A set of points is called $k$-regular if every point in the set is at unit distance from exactly $k$ other points in the set. Prove that a 1-regular finite set of points exists.,"Consider the set $S_1 = \{0, 1\}$ in the complex plane. The distance between the two points is $|1-0|=1$. The point 0 is at unit distance from exactly one point in $S_1$ (the point 1), and the point 1 is at unit distance from exactly one point in $S_1$ (the point 0). Therefore, $S_1$ is a 1-regular set.","Let $S$ be an $m$-regular set and $T$ be an $n$-regular set. Define the operation $U = S \oplus_\theta T = \\{a + e^{i \theta} b \\mid a \\in S, b \\in T\\}$. Show that for any point $u = a + e^{i \theta} b \\in U$, there are at least $m+n$ distinct points in $U$ at unit distance from $u$, provided that $\theta$ avoids a finite set of values.","Let $u = a + e^{i \theta} b \\in U$. Let $a_1, \\dots, a_m$ be the neighbors of $a$ in $S$ and $b_1, \\dots, b_n$ be the neighbors of $b$ in $T$. The $m$ points $a_i + e^{i\theta}b$ and the $n$ points $a + e^{i\theta}b_j$ are in $U$. The distance from $u$ to $a_i + e^{i\theta}b$ is $|(a-a_i)|=1$. The distance from $u$ to $a + e^{i\theta}b_j$ is $|e^{i\theta}(b-b_j)|=|b-b_j|=1$. To ensure these $m+n$ neighbors are distinct, we must avoid $a_i + e^{i \theta} b = a + e^{i \theta} b_j$, which means $e^{i\theta}(b_j-b) \neq (a_i-a)$. Each such equation for $(i,j)$ forbids at most one value of $e^{i\theta}$. Since there are finitely many pairs $(i,j)$, we can choose $\theta$ to avoid this finite set of values, guaranteeing at least $m+n$ distinct neighbors.","Using the same definitions as the previous sub-problem, show that $\theta$ can be chosen such that for any point $u = a + e^{i \theta} b \\in U$, there are no more than $m+n$ points in $U$ at unit distance from $u$.","A new neighbor $v = c + e^{i \theta} d \\in U$ not accounted for in the previous step must have $c \neq a$ and $d \neq b$. The condition for a unit distance is $|(a+e^{i\theta}b) - (c+e^{i\theta}d)| = 1$, which is $|(a-c) + e^{i\theta}(b-d)| = 1$. Squaring this gives $|a-c|^2+|b-d|^2 + e^{i\theta}(a-c)\\overline{(b-d)} + e^{-i\theta}\\overline{(a-c)}(b-d) = 1$. For each of the finite choices of $a,b,c,d$ from the finite sets $S, T$, this is a trigonometric equation in $\theta$ which has at most a finite number of solutions for $\theta \\in [0, 2\\pi)$. By choosing $\theta$ to avoid the finite union of all these solution sets, we ensure no such 'accidental' unit distances are formed.","Prove that for every natural number $m$, there exists a finite set $S$ of points in a plane with the following property: For every point $A$ in $S$, there are exactly $m$ points in $S$ which are at unit distance from $A$.","We proceed by induction on $m$. The base case $m=1$ is established by the existence of a 1-regular set, as shown in the first sub-problem. For the inductive step, assume an $(m-1)$-regular set $S_{m-1}$ exists. Let $T_1$ be a 1-regular set, chosen to be disjoint from $S_{m-1}$. Based on the preceding sub-problems, there exists a value $\theta$ such that the set $S_m = S_{m-1} \\oplus_\theta T_1$ is $((m-1)+1)$-regular, i.e., $m$-regular. By the principle of mathematical induction, an $m$-regular set exists for all natural numbers $m$."
1971p6,"Let $A = (a_{ij})(i, j = 1, 2, \cdots, n)$ be a square matrix whose elements are non-negative integers. Suppose that whenever an element $a_{ij} = 0$, the sum of the elements in the $i$th row and the $j$th column is $\geq n$. Prove that the sum of all the elements of the matrix is $\geq n^2 / 2$.","As in the solution, choose a row or column such that the sum of its elements is minimal. We can assume this is a row (either notice that taking the transpose of $A$ changes neither the hypothesis, nor the conclusion; or notice that if we do the proof in the case of a row, the proof in the case of a column is analogous.) Let $S$ be the sum of the elements of this row, and $z$ be the number of zeros in this row.

For an element $a_{ij}$ of $A$, we denote $r_i, c_j$ the row and the column containing $a_{ij}$. We denote $sum(r_i), sum(c_j)$ the sum of the entries of the matrix in row $r_i$ and $c_j$ respectively.

If $S \ge \frac{n}{2}$, then each row $r_i$ has its sum of elements $sum(r_i) \ge S \ge \frac{n}{2}$, so $\sum_{i, j = 1}^n a_{ij} = \sum_{i=1}^n sum(r_i) \ge \frac{n^2}{2}$.

So, let us assume $S < \frac{n}{2}$. Let $r_i = \{a_{ij}, j = 1, \dots, n\}$ be the row we chose (now $i$ is fixed). For each $j$ consider the sum of the elements of the column $c_j$ containing $a_{ij}$. If $a_{ij} = 0$, we know that $sum(r_i) + sum(c_j) \ge n$ (by hypothesis), so $S + sum(c_j) \ge n$, so $sum(c_j) \ge n - S$. We have $z$ such columns.

If $a_{ij} \ne 0$, we know that $sum(c_j) \ge S$ because $S$ was minimal. We have $n - z$ such columns.

So, $\sum_{i, j = 1}^n a_{ij} = \sum_{j = 1}^n sum(c_j) \ge z(n - S) + (n - z)S$.

Let $S = n - z + E$. Here we split $S$ in two parts: $n - z$ represents the number of non-zeroes in $r_i$, and $E$ represents the sum of the ""excess"" amounts over $1$ of the non-zero entries. More explicitly, $E = \sum_{\substack{j = 1 \\ a_{ij} \ne 0}}^n (a_{ij} - 1)$. (To clarify: if all non-zero entries of $r_i$ would $= 1$, we would have $S = n - z$, and $E = 0$.) In general, $E \ge 0$.

Then, $\sum_{i, j = 1}^n a_{ij} \ge z(n - S) + (n - z)S = (n - S + E)(n - S) + (S - E)S = n^2 - 2nS + 2S^2 + nE - 2SE =$

$\frac{n^2}{2} + \frac{1}{2}\left(n^2 - 4nS + 4S^2\right) + E(n - 2S) = \frac{n^2}{2} + \frac{1}{2}(n - 2S)^2 + E(n - 2S)$.

The last term is $\ge 0$ since $E \ge 0$ and we assumed we are in the case $S < \frac{n}{2}$. It follows that $\sum_{i, j = 1}^n a_{ij} > \frac{n^2}{2}$.

Note: The strict inequality is not true in general. We obtained it assuming that $S < \frac{n}{2}$. When $S \ge \frac{n}{2}$ we have $\sum_{i, j = 1}^n a_{ij} \ge \frac{n^2}{2}$.

Note: We could have proven directly that $z(n - S) + (n - z)S = \frac{n^2}{2} + \frac{1}{2}(n - 2S)^2 + (S + z - n)(n - 2S)$ and note that the last term is the product of two non-negative factors. However, introducing $E$ gives better insight into the inequality.",4,"Let $S$ be the minimum sum among all row and column sums of the matrix $A$. Show that if $S \ge n/2$, the total sum of all elements of the matrix is $\ge n^2/2$.","Let $R_i$ be the sum of the elements in the $i$-th row. By the definition of $S$, we have $R_i \ge S$ for all $i=1, \dots, n$. If $S \ge n/2$, then each $R_i \ge n/2$. The sum of all elements in the matrix is $\sum_{i=1}^n R_i$. Therefore, the total sum is $\ge \sum_{i=1}^n (n/2) = n \cdot (n/2) = n^2/2$.","Assume the minimum sum $S$ among all row and column sums is less than $n/2$ and corresponds to a row, say row $k$. Let $z$ be the number of zero elements in row $k$. Show that the total sum of all elements of the matrix, $S_{total}$, satisfies $S_{total} \ge z(n-S) + (n-z)S$.","The total sum is the sum of all column sums, $S_{total} = \sum_{j=1}^n C_j$. For the $z$ columns $j$ where $a_{kj}=0$, the problem's hypothesis implies $R_k + C_j \ge n$. Since $R_k=S$, we have $C_j \ge n-S$. For the other $n-z$ columns $j$ where $a_{kj} \ne 0$, we know $C_j \ge S$ because $S$ is the minimum of all row and column sums. Summing these lower bounds for all columns gives $S_{total} \ge z(n-S) + (n-z)S$.","Let $S$ and $z$ be numbers such that $0 \le S < n/2$ and $z$ is an integer with $0 \le z \le n$. Given the constraint that $S \ge n-z$, prove the inequality $z(n-S) + (n-z)S \ge n^2/2$.","Let $E = S-(n-z)$. From the condition $S \ge n-z$, we have $E \ge 0$. Also, we can write $z=n-S+E$. Substitute this into the expression: $(n-S+E)(n-S) + (n-(n-S+E))S = (n-S+E)(n-S) + (S-E)S = (n-S)^2 + E(n-S) + S^2 - ES = n^2 - 2nS + 2S^2 + E(n-2S)$. This can be rewritten as $\frac{n^2}{2} + \frac{1}{2}(n^2 - 4nS + 4S^2) + E(n-2S) = \frac{n^2}{2} + \frac{1}{2}(n-2S)^2 + E(n-2S)$. Since $S < n/2$, we have $n-2S > 0$. As $E \ge 0$ and $(n-2S)^2 \ge 0$, the sum of the last two terms is non-negative. Therefore, the expression is $\ge n^2/2$.","Let $A = (a_{ij})(i, j = 1, 2, \cdots, n)$ be a square matrix whose elements are non-negative integers. Suppose that whenever an element $a_{ij} = 0$, the sum of the elements in the $i$th row and the $j$th column is $\ge n$. Prove that the sum of all the elements of the matrix is $\ge n^2 / 2$.","Let $S$ be the minimum sum among all row and column sums. We consider two cases. Case 1: $S \ge n/2$. By the result of Sub-problem 1, the total sum of elements is $\ge n^2/2$. Case 2: $S < n/2$. Assume without loss of generality that the minimum sum $S$ corresponds to a row. Let this row have $z$ zeros. By Sub-problem 2, the total sum is at least $z(n-S)+(n-z)S$. Since the matrix elements are non-negative integers, the sum $S$ is the sum of $n-z$ non-zero integer elements, thus each is at least 1, so $S \ge n-z$. With these conditions on $S$ and $z$, Sub-problem 3 shows that $z(n-S)+(n-z)S \ge n^2/2$. In both cases, the proof is complete."
1970p1,"Let $M$ be a point on the side $AB$ of $\triangle ABC$. Let $r_1, r_2$, and $r$ be the inscribed circles of triangles $AMC, BMC$, and $ABC$. Let $q_1, q_2$, and $q$ be the radii of the exscribed circles of the same triangles that lie in $\angle ACB$. Prove that

$\frac{r_1}{q_1} \cdot \frac{r_2}{q_2} = \frac{r}{q}$.","Let $I$ be the incenter, and $E$ be the excenter relative to C, and let $B_1, B_2$ be the points where the incircle and the excircle relative to $C$ touch $AC$.

The triangles $\triangle CIB_1$ and $\triangle CEB_2$ are similar, so $\frac{r}{q} = \frac{CI}{CE}.$

Let $I_1$ be the incenter, and $E_1$ be the excenter relative to C of the triangle $\triangle ACM$, and $I_2$ be the incenter, and $E_2$ be the excenter relative to C of the triangle $\triangle BCM$ ($E_2$ is not shown on the picture).

To solve the problem, we need to prove that $\frac{CI_1}{CE_1} \cdot \frac{CI_2}{CE_2} = \frac{CI}{CE}.$

Applying the law of sines (see Law of Sines or https://en.wikipedia.org/wiki/Law_of_sines) in triangle $\triangle ICA$ we get

$\frac{IC}{\sin \angle CAI} = \frac{AC}{\sin \angle CIA}$, or $IC = b\ \frac{\sin \frac{A}{2}}{\sin (\pi - (\frac{A}{2} + \frac{C}{2}))}$. Since $C = \pi - A - B$ this becomes $IC = b\ \frac{\sin \frac{A}{2}}{\cos \frac{B}{2}}.$

Similarly, using the law of sines in triangle $\triangle ECA$ and replacing some angles, we get $EC = b\ \frac{\cos \frac{A}{2}}{\sin \frac{B}{2}}.$

It follows that $\frac{r}{q} = \tan \frac{A}{2} \tan \frac{B}{2}.$

Now, we proceed like in the first solution: Apply the above to triangles $\triangle AMC$ and $\triangle MBC$.

We get that $\frac{r_1}{q_1} = \tan \frac{A}{2} \tan \frac{\angle AMC}{2}$ and $\frac{r_2}{q_2} = \tan \frac{\angle BMC}{2} \tan \frac{B}{2}.$

The desired equality follows from $\tan \frac{\angle AMC}{2} \cdot \tan \frac{\angle BMC}{2} = 1$ (since $\frac{\angle AMC}{2}$ and $\frac{\angle BMC}{2}$ are complementary).",2,"For any triangle with angles A, B, C, let r be the inradius and q be the radius of the excircle opposite to vertex C. Prove that the ratio r/q is given by the expression r/q = tan(A/2)tan(B/2).","Let K be the area and s be the semi-perimeter of the triangle. The inradius is given by the formula r = K/s, and the exradius opposite to vertex C is given by q = K/(s-c), where c is the length of the side opposite to C. The ratio is r/q = (s-c)/s. Using the half-angle formulas for a triangle, we have tan²(A/2) = (s-b)(s-c)/(s(s-a)) and tan²(B/2) = (s-a)(s-c)/(s(s-b)). Multiplying these two expressions gives tan²(A/2)tan²(B/2) = ((s-b)(s-c)/(s(s-a))) * ((s-a)(s-c)/(s(s-b))) = (s-c)²/s². Since A/2 and B/2 are acute angles, we can take the positive square root to get tan(A/2)tan(B/2) = (s-c)/s. Therefore, r/q = tan(A/2)tan(B/2).","Let M be a point on the side AB of a triangle ABC. Let r₁, r₂, and r be the radii of the inscribed circles of triangles AMC, BMC, and ABC. Let q₁, q₂, and q be the radii of the exscribed circles of the same triangles that lie in angle ACB. Prove that (r₁/q₁) * (r₂/q₂) = r/q.","Using the result from the first sub-problem, we can express the ratio r/q for each triangle. For ΔABC, the angles not at vertex C are A and B, so r/q = tan(A/2)tan(B/2). For ΔAMC, the angles not at C are A and ∠AMC, so r₁/q₁ = tan(A/2)tan(∠AMC/2). For ΔBMC, the angles not at C are B and ∠BMC, so r₂/q₂ = tan(B/2)tan(∠BMC/2). Multiplying the expressions for ΔAMC and ΔBMC gives (r₁/q₁) * (r₂/q₂) = (tan(A/2)tan(∠AMC/2)) * (tan(B/2)tan(∠BMC/2)) = (tan(A/2)tan(B/2)) * (tan(∠AMC/2)tan(∠BMC/2)). Since M lies on the segment AB, angles ∠AMC and ∠BMC are supplementary, so ∠AMC + ∠BMC = 180°. This implies ∠AMC/2 + ∠BMC/2 = 90°. For such complementary angles, tan(∠AMC/2)tan(∠BMC/2) = 1. Therefore, (r₁/q₁) * (r₂/q₂) = tan(A/2)tan(B/2), which is equal to r/q.",,,,
1970p2,"Let $a, b$, and $n$ be integers greater than 1, and let $a$ and $b$ be the bases of two number systems.  $A_{n-1}$ and $A_{n}$ are numbers in the system with base $a$ and $B_{n-1}$ and $B_{n}$ are numbers in the system with base $b$; these are related as follows:

$A_{n} = x_{n}x_{n-1}\cdots x_{0}, A_{n-1} = x_{n-1}x_{n-2}\cdots x_{0}$,

$B_{n} = x_{n}x_{n-1}\cdots x_{0}, B_{n-1} = x_{n-1}x_{n-2}\cdots x_{0}$,

$x_{n} \neq 0, x_{n-1} \neq 0$.

Prove:

$\frac{A_{n-1}}{A_{n}} < \frac{B_{n-1}}{B_{n}}$ if and only if $a > b$.","Rewrite inequality (1), and give a few steps in which we state equivalent inequalities:

$\frac{x_{n-1} a^{n-1} + \cdots + x_1 a + x_0}{x_n a^n + x_{n-1} a^{n-1} + \cdots + x_1 a + x_0} < \frac{x_{n-1} b^{n-1} + \cdots + x_1 b + x_0}{x_n b^n + x_{n-1} b^{n-1} + \cdots + x_1 b + x_0}$

$\frac{x_{n-1} a^{n-1} + \cdots + x_1 a + x_0}{x_n a^n} < \frac{x_{n-1} b^{n-1} + \cdots + x_1 b + x_0}{x_n b^n}$

$\frac{x_{n-1} a^{n-1} + \cdots + x_1 a + x_0}{a^n} < \frac{x_{n-1} b^{n-1} + \cdots + x_1 b + x_0}{b^n}$

$x_{n-1} \frac{1}{a} + \cdots + x_1 \frac{1}{a^{n-1}} + x_0 \frac{1}{a^n} < x_{n-1} \frac{1}{b} + \cdots + x_1 \frac{1}{b^{n-1}} + x_0 \frac{1}{b^n}\ \ \ \ \ \ \ \ (2)$

Now it is clear that if $a > b$ then (2) is true for any $x_n, x_{n-1}, \cdots, x_0$. This proves statement S2 from the Remarks.

(Note that the problem said $x_n, x_{n-1} > 0$. This is not necessary. All we need is that $x_n > 0$ and at least one of $x_{n-1}, \cdots, x_1, x_0$ is $\neq 0$.)

We prove statement S1 from the Remarks by contradiction. We want to show that if (1) is true for some $x_n, \cdots, x_1, x_0$, then $a > b$.

Assume $a \le b$. If we had $a = b$ then (1) would be an equality, not an inequality.

If $a < b$ then by S1, it would follow that $\frac{A_{n-1}}{A_{n}} > \frac{B_{n-1}}{B_{n}}$ for all values of  $x_n, \cdots, x_1, x_0$ which contradicts the hypothesis. Either way, we get a contradiction, which proves S1.",3,Show that the inequality $\frac{A_{n-1}}{A_{n}} < \frac{B_{n-1}}{B_{n}}$ is algebraically equivalent to the inequality $\sum_{i=0}^{n-1} x_i a^{i-n} < \sum_{i=0}^{n-1} x_i b^{i-n}$.,"The original inequality is $\frac{A_{n-1}}{x_n a^n + A_{n-1}} < \frac{B_{n-1}}{x_n b^n + B_{n-1}}$. Since both denominators and numerators are positive, we can cross-multiply to get $A_{n-1}(x_n b^n + B_{n-1}) < B_{n-1}(x_n a^n + A_{n-1})$. This expands to $A_{n-1}x_n b^n + A_{n-1}B_{n-1} < B_{n-1}x_n a^n + A_{n-1}B_{n-1}$, which simplifies to $A_{n-1}x_n b^n < B_{n-1}x_n a^n$. Since $x_n > 0$, we can divide by $x_n$ and rearrange to get $\frac{A_{n-1}}{a^n} < \frac{B_{n-1}}{b^n}$. Substituting the polynomial definitions $A_{n-1} = \sum_{i=0}^{n-1} x_i a^i$ and $B_{n-1} = \sum_{i=0}^{n-1} x_i b^i$ gives $\frac{\sum_{i=0}^{n-1} x_i a^i}{a^n} < \frac{\sum_{i=0}^{n-1} x_i b^i}{b^n}$, which simplifies to the desired form $\sum_{i=0}^{n-1} x_i a^{i-n} < \sum_{i=0}^{n-1} x_i b^{i-n}$.","Prove that if $a > b$, then $\frac{A_{n-1}}{A_{n}} < \frac{B_{n-1}}{B_{n}}$.","From sub-problem 1, the inequality is equivalent to $\sum_{i=0}^{n-1} x_i a^{i-n} < \sum_{i=0}^{n-1} x_i b^{i-n}$, which can be rewritten as $\sum_{k=1}^{n} x_{n-k} a^{-k} < \sum_{k=1}^{n} x_{n-k} b^{-k}$. Consider the function $f(y) = \sum_{k=1}^{n} x_{n-k} y^k$. The inequality is $f(1/a) < f(1/b)$. Since $a, b > 1$ and $a > b$, we have $0 < 1/a < 1/b$. The coefficients $x_{n-k}$ are non-negative, and at least one is positive (since $x_{n-1} \neq 0$). Thus, $f(y)$ is a strictly increasing function for $y > 0$. Since $1/a < 1/b$, it follows that $f(1/a) < f(1/b)$, which proves the statement.",Prove that $\frac{A_{n-1}}{A_{n}} < \frac{B_{n-1}}{B_{n}}$ if and only if $a > b$.,"The 'if' direction ($a > b \implies \frac{A_{n-1}}{A_{n}} < \frac{B_{n-1}}{B_{n}}$) was proven in the previous sub-problem. For the 'only if' direction, we assume $\frac{A_{n-1}}{A_{n}} < \frac{B_{n-1}}{B_{n}}$ holds and show $a > b$ by contradiction. Assume $a \le b$. If $a=b$, then $A_k = B_k$ for all $k$, which implies $\frac{A_{n-1}}{A_{n}} = \frac{B_{n-1}}{B_{n}}$, a contradiction. If $a < b$, then by the same logic used in the previous sub-problem (with the roles of $a$ and $b$ swapped), it would follow that $\frac{A_{n-1}}{A_{n}} > \frac{B_{n-1}}{B_{n}}$, which is also a contradiction. Since both $a \le b$ cases lead to a contradiction, we must conclude that $a > b$.",,
1970p6,"In a plane there are $100$ points, no three of which are collinear. Consider all possible triangles having these point as vertices. Prove that no more than $70 \%$ of these triangles are acute-angled.","Define a $n$-gon to be a configuration of $n$ points, no three of which are collinear. Given an $n$-gon draw all the triangles whose vertices are among the $n$ points. We say that a triangle $\triangle ABC$ is in the $n$-gon, or that the $n$-gon has $\triangle ABC$ in it, if $A, B, C$ are points in the $n$-gon.

We start by proving that a $4$-gon has $4$ triangles, out of which at most $3$ are acute.

Clearly there are exactly $4$ triangles. We have two cases. If the convex hull of the $4$-gon is a quadrilateral, then at least one of $\angle A, \angle B, \angle C, \angle D$ is $\ge \frac{\pi}{2}$ (if they were all $< \frac{\pi}{2}$ then $\angle A + \angle B + \angle C + \angle D < 2\pi$, which is false). Let us say that $\angle C \ge \frac{\pi}{2}$. Then $\triangle BCD$ is obtuse, so at most the other $3$ triangles are acute. (Note that it is possible to have $3$ acute triangles.)

If the convex hull of the $4$-gon is a triangle, let us say that $C$ is in the interior of $\triangle ABD$. Then at least two of $\angle ACB, \angle BCD, \angle DCA$ are $\ge \frac{2\pi}{3} > \frac{\pi}{2}$ (if they were all $< \frac{2\pi}{3}$ then their sum would be $< 2\pi$, which is false). So, at least two of $\triangle ACB, \triangle BCD, \triangle DCA$ are obtuse.

Note: We would be tempted to use this result, and the argument which follows below to prove the problem. But that would only yield the result that at most 75% of the triangles in an $n$-gon (in particular a $100$-gon) are acute. We need to do better.

Now, we will prove that a $5$-gon has $10$ triangles, out of which at most $7$ are acute. It is easy to see that there are $10$ triangles in a $5$-gon, either by counting, or by remembering that the number of triangles $= C(5, 3) = {5 \choose 3} = \frac{5 \cdot 4 \cdot 3}{1 \cdot 2 \cdot 3} = 10$. Now, we could proceed like in the case of a $4$-gon, by looking at many possible cases and chasing angle sizes. Instead, we will give a different argument, using an idea we will use again later.

A $5$-gon has $5$ $4$-gons in it. Each of these $4$-gons has $4$ triangles in it, of which at most $3$ are acute. Make a list $\mathcal{L}_1$ of all the triangles, and a sub-list $\mathcal{L}_2$ of all the acute triangles. The size of $\mathcal{L}_1 = 5 \cdot 4 = 20$, and the size of $\mathcal{L}_2 \le 5 \cdot 3 = 15$. These lists contain duplicates. Each triangle is counted exactly twice (corresponding to the two points which are not in the triangle; we can see this as $= C(5-3, 4-3) = C(2, 1) = {2 \choose 1} = 2$). Dividing by $2$ to eliminate duplicates, we get that out of the $\frac{20}{2} = 10$ triangles, at most $\frac{15}{2} = 7.5$ are acute. We conclude that at most $7$ out of the $10$ are acute.

Now we are ready to prove that given a $n$-gon with $n > 5$, at most $\frac{7}{10} = 70\%$ of its triangles are acute. Consider all the $5$-gons in the given $n$-gon, and consider all the triangles in each $5$-gon. Make a list $\mathcal{L}_1$ of all these triangles, and a sub-list $\mathcal{L}_2$ of all the acute triangles. We have that $\frac{\text{size of } \mathcal{L}_2}{\text{size of } \mathcal{L}_1} \le \frac{7}{10}$ (according to what we showed above). These lists contain duplicates. Each triangle is counted the same number of times, say $k$ times (in fact, $k = C(n-3, 5-3) = C(n-3, 2) = {n-3 \choose 2}$, but we don't need this). Dividing both the numerator and the denominator by $k$ to eliminate duplicates, we have that at most $\frac{7}{10} = 70\%$ of the triangles are acute.",4,"For any set of 4 points in a plane, no three collinear, prove that at most 3 of the $\binom{4}{3}=4$ possible triangles are acute-angled.","The convex hull of the 4 points is either a quadrilateral or a triangle. If it's a quadrilateral, the sum of its interior angles is $360^\circ$, so at least one angle must be $\ge 90^\circ$. The triangle containing this vertex is therefore not acute. If the convex hull is a triangle with the fourth point inside, the sum of the angles around the interior point is $360^\circ$. At least one of these angles must be $\ge 120^\circ$, making the corresponding triangle obtuse. In both cases, at least one triangle is non-acute, so at most 3 are acute.","For any set of 5 points in a plane, no three collinear, prove that at most 7 of the $\binom{5}{3}=10$ possible triangles are acute-angled.","A set of 5 points contains $\binom{5}{4}=5$ subsets of 4 points. From the previous result, each 4-point subset contains at most 3 acute triangles. Summing over all 5 subsets gives a maximum of $5 \times 3 = 15$ acute triangle instances. Each triangle is defined by 3 vertices, so it is contained in the $\binom{5-3}{4-3}=2$ subsets of 4 points that include its vertices. Therefore, the number of unique acute triangles is at most $15/2 = 7.5$. As the number of triangles must be an integer, it is at most 7.","For any set of $n \ge 5$ points with no three collinear, prove that the proportion of acute-angled triangles is no more than the maximum proportion for 5 points.","Consider an n-gon and all its $\binom{n}{5}$ sub-5-gons. Let's count the total number of triangles and acute triangles by summing over these 5-gons. The total count of acute triangles is at most $7 \times \binom{n}{5}$ and the total count of all triangles is $10 \times \binom{n}{5}$. Each specific triangle from the n-gon is contained in exactly $\binom{n-3}{5-3} = \binom{n-3}{2}$ of these 5-gons. Since every triangle is counted the same number of times, the ratio of unique acute triangles to total unique triangles is the same as the ratio of the summed counts, which is $\frac{7 \times \binom{n}{5}}{10 \times \binom{n}{5}} = \frac{7}{10}$.","In a plane there are $100$ points, no three of which are collinear. Consider all possible triangles having these point as vertices. Prove that no more than $70 \%$ of these triangles are acute-angled.","From sub-problem 2, we know that for 5 points, the maximum number of acute triangles is 7 out of 10, a proportion of $7/10$. From sub-problem 3, we know that for any $n \ge 5$, the maximum proportion of acute triangles does not exceed the proportion for $n=5$. Since $100 \ge 5$, the proportion of acute triangles among the 100 points is at most $7/10$, which is $70 \%$."
1969p1,Prove that there are infinitely many natural numbers $a$ with the following property: the number $z = n^4 + a$ is not prime for any natural number $n$.,"Suppose that $a = 4k^4$ for some $k$. We will prove that $a$ satisfies the property outlined above.

The polynomial $n^4 + 4k^4$ can be factored as follows:

\[n^4 + 4k^4\]\[= n^4 + 4n^2k^2 + 4k^4 - 4n^2k^2\]\[= (n^2 + 2k^2)^2 - (2nk)^2\]\[= (n^2 + 2k^2 - 2nk)(n^2 + 2k^2 + 2nk)\]

Both factors are positive, because if the left one is negative, then the right one would also negative, which is clearly false.

It is also simple to prove that $n^2 + 2k^2 - 2nk > 1$ when $k > 1$. Thus, for all $k > 1$, $4k^4$ is a valid value of $a$, completing the proof. $\square$",2,"For any natural numbers $n$ and $k$ where $k > 1$, prove that the number $z = n^4 + 4k^4$ is composite.","The expression $n^4 + 4k^4$ can be factored using the Sophie Germain identity by adding and subtracting $4n^2k^2$: $n^4 + 4n^2k^2 + 4k^4 - 4n^2k^2 = (n^2 + 2k^2)^2 - (2nk)^2 = (n^2 + 2k^2 - 2nk)(n^2 + 2k^2 + 2nk)$. Let the factors be $F_1 = (n-k)^2 + k^2$ and $F_2 = (n+k)^2 + k^2$. For $n \ge 1$ and $k > 1$, both factors are integers. $F_2 > 1$ is trivial. For $F_1$, since $k > 1$, we have $k^2 > 1$. As $(n-k)^2 \ge 0$, $F_1 = (n-k)^2 + k^2 \ge k^2 > 1$. Since $z$ is a product of two integers greater than 1, it is composite.",Prove that there are infinitely many natural numbers $a$ with the following property: the number $z = n^4 + a$ is not prime for any natural number $n$.,"Let us choose numbers $a$ of the form $a = 4k^4$ for any integer $k > 1$. From the result of the first sub-problem, for any such choice of $a$, the number $z = n^4 + a = n^4 + 4k^4$ is composite for all natural numbers $n$. Since there is an infinite number of integers $k > 1$ (i.e., $k=2, 3, 4, \dots$), we can generate an infinite set of distinct values for $a$ (e.g., $a=64, 324, 1024, \dots$). Each of these values of $a$ satisfies the required property.",,,,
1969p2,"Let $a_1, a_2,\cdots, a_n$ be real constants, $x$ a real variable, and \[f(x)=\cos(a_1+x)+\frac{1}{2}\cos(a_2+x)+\frac{1}{4}\cos(a_3+x)+\cdots+\frac{1}{2^{n-1}}\cos(a_n+x).\] Given that $f(x_1)=f(x_2)=0,$ prove that $x_2-x_1=m\pi$ for some integer $m.$","For simplicity of writing, denote $b_k = 1/2^{k - 1}$. $f(x) = b_1\cos{(a_1 + x)} + b_1\cos{(a_1 + x)} + \cdots + b_n\cos{(a_n + x)}$. First, we want to prove that it is not the case that $f(x) = 0$ for all $x$. To prove this, we will prove that the maximum value of $f$ is at least $b_n = 1/2^n$. This will ensure that $f \ne 0$.

We do this by induction. The statement is clear for $n = 1$: $f$ has a maximum value of $b_k = 1$. Assume that we have $n - 1$ terms in $f$, and the maximum value of $f$ is at lease $b_{n - 1} = 1/2^{n - 1}$. Now add the term $b_n\cos{(a_n + x)}$ (and remember that $b_n = 1/2^n$). This additional term has values in $[-1/2^n, 1/2^n]$, so it can decrease the maximum of $f$ by subtracting at most $1/2^n$ from the previous maximum, which was at least $1/2^{n - 1}$. So, the new maximum is at least $1/2^n$.

Now we will the formula $\cos{(\alpha + \beta)} = \cos{\alpha}\cos{\beta} - \sin{\alpha}\sin{\beta}$.

We get $f(x) = (b_1\cos{a_1} + b_2\cos{a_2} + \cdots + b_n\cos{a_n})\cos{x} - (b_1\sin{a_1} + b_2\sin{a_2} + \cdots + b_n\sin{a_n})\sin{x}$.

If both $b_1\sin{a_1} + b_2\sin{a_2} + \cdots + b_n\sin{a_n} = 0$ and $b_1\cos{a_1} + b_2\cos{a_2} + \cdots + b_n\cos{a_n} = 0$ then $f(x) = 0$ for all $x$. So at least one of these sums is $\ne 0$. I will give the proof for the case $b_1\cos{a_1} + b_2\cos{a_2} + \cdots + b_n\cos{a_n} \ne 0$. The other case is proven similarly.

Using $f(x_1) = 0$, we get $(b_1\cos{a_1} + b_2\cos{a_2} + \cdots + b_n\cos{a_n})\cos{x_1} = (b_1\sin{a_1} + b_2\sin{a_2} + \cdots + b_n\sin{a_n})\sin{x_1}$, and similarly for $x_2$.

If $b_1\sin{a_1} + b_2\sin{a_2} + \cdots + b_n\sin{a_n} = 0$, then $\cos{x_1} = 0$ and $\cos{x_2} = 0$. It follows that both $x_1$ and $x_2$ are odd multiples of $\pi/2$, so they differ by $m\pi$ for some integer $m$.

If $b_1\sin{a_1} + b_2\sin{a_2} + \cdots + b_n\sin{a_n} \ne 0$, then we can divide by this quantity, and we get

$\tan{x_1} = \tan{x_2} = \frac{b_1\cos{a_1} + b_2\cos{a_2} + \cdots + b_n\cos{a_n}} {b_1\sin{a_1} + b_2\sin{a_2} + \cdots + b_n\sin{a_n}}$.

Thinking of the graph of $y = \tan{x}$ would be enough for many people to conclude that $x_1 - x_2 = m\pi$ for some integer $m$. If we want to be more formal, we proceed by writing $\tan{x_1} - \tan{x_2} = 0$. Some easy computations yield $\tan{x_1} - \tan{x_2} = \frac{\sin{(x_1 - x_2)}} {\cos{x_1}\cos{x_2}} = 0$. It follows that $\sin{(x_1 - x_2)} = 0$, which implies that $x_1 - x_2 = m\pi$ for some integer $m$.",3,Show that the function $f(x)=\sum_{k=1}^{n}\frac{1}{2^{k-1}}\cos(a_k+x)$ can be expressed in the form $A\cos(x) - B\sin(x)$ for some constants $A$ and $B$ which are not both zero.,"Using the cosine angle addition formula, $f(x) = \sum_{k=1}^{n}\frac{1}{2^{k-1}}(\cos a_k \cos x - \sin a_k \sin x)$. Rearranging the summation gives $f(x) = (\sum_{k=1}^{n}\frac{1}{2^{k-1}}\cos a_k)\cos x - (\sum_{k=1}^{n}\frac{1}{2^{k-1}}\sin a_k)\sin x$. Let $A=\sum_{k=1}^{n}\frac{1}{2^{k-1}}\cos a_k$ and $B=\sum_{k=1}^{n}\frac{1}{2^{k-1}}\sin a_k$. If $A=B=0$, then the complex number $Z = \sum_{k=1}^n \frac{1}{2^{k-1}}e^{ia_k} = A+iB$ would be zero. However, by the reverse triangle inequality, $|Z| = |e^{ia_1} + \sum_{k=2}^n \frac{1}{2^{k-1}}e^{ia_k}| \ge |e^{ia_1}| - |\sum_{k=2}^n \frac{1}{2^{k-1}}e^{ia_k}|$. We have $|e^{ia_1}|=1$ and $|\sum_{k=2}^n \frac{1}{2^{k-1}}e^{ia_k}| \le \sum_{k=2}^n \frac{1}{2^{k-1}} = 1 - \frac{1}{2^{n-1}} < 1$. Thus, $|Z| > 1 - (1 - \frac{1}{2^{n-1}}) = \frac{1}{2^{n-1}} > 0$. So $Z$ cannot be zero, meaning $A$ and $B$ cannot both be zero.","Given $f(x_1)=f(x_2)=0$ and that $f(x)$ can be written as $A\cos(x) - B\sin(x)$ where $A$ and $B$ are not both zero, show that either $\cos(x_1)=\cos(x_2)=0$ or $\tan(x_1)=\tan(x_2)$.","From $f(x_1)=f(x_2)=0$, we have $A\cos(x_1) - B\sin(x_1) = 0$ and $A\cos(x_2) - B\sin(x_2) = 0$. We consider two cases. Case 1: $B=0$. Since $A$ and $B$ are not both zero, $A \neq 0$. The equations become $A\cos(x_1)=0$ and $A\cos(x_2)=0$, which implies $\cos(x_1)=0$ and $\cos(x_2)=0$. Case 2: $B \neq 0$. The equation $A\cos(x) = B\sin(x)$ must hold for $x=x_1, x_2$. If $\cos(x_1)=0$, then $0=B\sin(x_1)$. Since $B\neq 0$, this would mean $\sin(x_1)=0$, which is impossible as $\cos^2(x_1)+\sin^2(x_1)=1$. Thus, $\cos(x_1) \neq 0$ and similarly $\cos(x_2) \neq 0$. We can therefore divide by $\cos(x_1)$ and $\cos(x_2)$ to get $\tan(x_1)=A/B$ and $\tan(x_2)=A/B$, which implies $\tan(x_1)=\tan(x_2)$.","Let $a_1, a_2,\cdots, a_n$ be real constants, $x$ a real variable, and \[f(x)=\cos(a_1+x)+\frac{1}{2}\cos(a_2+x)+\frac{1}{4}\cos(a_3+x)+\cdots+\frac{1}{2^{n-1}}\cos(a_n+x).\] Given that $f(x_1)=f(x_2)=0,$ prove that $x_2-x_1=m\pi$ for some integer $m.$","From the previous sub-problem, the condition $f(x_1)=f(x_2)=0$ leads to two possibilities. Case 1: $\cos(x_1)=0$ and $\cos(x_2)=0$. This means $x_1 = k_1\pi + \pi/2$ and $x_2 = k_2\pi + \pi/2$ for some integers $k_1, k_2$. Their difference is $x_2-x_1 = (k_2-k_1)\pi$, which is an integer multiple of $\pi$. Case 2: $\tan(x_1)=\tan(x_2)$. The tangent function has a period of $\pi$. Therefore, $\tan(x_1)=\tan(x_2)$ implies that $x_2 = x_1 + m\pi$ for some integer $m$. This means $x_2-x_1 = m\pi$. In both cases, we conclude that $x_2-x_1 = m\pi$ for some integer $m$.",,
1969p4,"A semicircular arc $\gamma$ is drawn with $AB$ as diameter. $C$ is a point on $\gamma$ other than $A$ and $B$, and $D$ is the foot of the perpendicular from $C$ to $AB$. We consider three circles, $\gamma_1, \gamma_2, \gamma_3$, all tangent to the line $AB$. Of these, $\gamma_1$ is inscribed in $\triangle ABC$, while $\gamma_2$ and $\gamma_3$ are both tangent to $CD$ and $\gamma$, one on each side of $CD$. Prove that $\gamma_1, \gamma_2$, and $\gamma_3$ have a second tangent in common.","We start by stating a simple proposition. Let $L$ be a line and three circles with centers $C_1, C_2, C_3$ tangent to the line $L$, all on one side. Denote $A_1, A_2, A_3$ the points on the line where the circles touch it. Then there is a second line tangent to the three circles if and only if  $C_1, C_2, C_3$ are collinear, and this is the case if and only if $(\overline{C_1A_1} - \overline{C_2A_2})/(\overline{C_2A_2} - \overline{C_3A_3}) = (\overline{A_1A_2})/(\overline{A_2A_3})$

I will not give the full proof of this proposition, and in fact, we need to know only that if the equality of the two fractions holds, then a tangent to two circles is tangent to the third as well. The idea is that if the equality holds then triangles $\triangle{C_1A_1B}, \triangle{C_2A_2B}, \triangle{C_3A_3B}$ are similar, which implies that $C_1, C_2, C_3$ are collinear, which implies that a tangent to two of the circles is tangent to the third as well.

Now let us prove the problem. Look at the following figure:

We use the notation given in the problem, and we denote $O$ the center of the circle $\gamma$, $C_1, C_2, C_3$ the centers of the circles $\gamma_1, \gamma_2,\gamma_3$, and $A_1, A_2, A_3$ the points where the circles touch the line $AB$. Let $AB$ be the $x$-axis, $CD$ be the $y$-axis, $D$ be the origin, and the orientations of axes as shown in the picture. Let $a = \overline{OD}$. We think of $a$ as positive, $a > 0$. There is no loss of generality in assuming that the circle is of radius $1$, and that $D$ is to the right of $O$. This implies the following coordinates:

$D = (0, 0)$

$A = (-1 - a, 0)$

$B = (1 - a, 0)$

$O = (-a, 0)$

The circle has the equation $(x + a)^2 + y^2 = 1$

Then $C = (0, \sqrt{1 - a^2})$

We will also make use of the point $O_4 = (-a, -1)$ on the circle, vertically down from $O$.

The plan is to calculate the coordinates of $C_1, C_2, C_3$ (the centers of the circles $\gamma_1, \gamma_2,\gamma_3$) as expressions in $a$. Then we will be able to verify that $(\overline{C_1A_1} - \overline{C_2A_2})/(\overline{C_2A_2} - \overline{C_3A_3}) = (\overline{A_1A_2})/(\overline{A_2A_3})$, which will have solved the problem.

Calculating the coordinates of $C_2 = (x_2, y_2)$ is easy. Take in account that the distance from $C_2$ to line $AB$ has to be the same as the distance to the circle $\gamma$. In other words, $y_2 = ($the radius of $\gamma) - \overline{C_2O} = 1 - \sqrt{(x_2 + a)^2 + y_2^2}$. Also, take in account that $C_2$ is on the bisector of $\angle{ADC}$, which implies $x_2 + y_2 = 0$.

From this system of two equations with two unknowns we get

$-x_2 = 1 - \sqrt{(x_2 + a)^2 + x_2^2}$

Solve this, and get $x_2 = 1 - a \pm \sqrt{2 - 2a}$. Since $-1 < x_2 \le 0$, we see that only $x_2 = 1 - a - \sqrt{2 - 2a}$ is acceptable. Therefore

$C_2 = (1 - a - \sqrt{2 - 2a}, -(1 - a) + \sqrt{2 - 2a})$

By a similar computation, we get

$C_3 = (-1 - a + \sqrt{2 + 2a}, -1 - a + \sqrt{2 + 2a})$

Now we want to compute the coordinates of $C_1 = (x_1, y_1)$. We could look for the point on $CO_4$ such that the distance to $AB$, which is $y_1$, equals the distance to $AC$. But there is an easier way because we know classical formulas for computing the radius of the incircle of a triangle. Thus, if we denote by $A_r$ and $s$ the area and the semiperimeter of the triangle $\triangle{ABC}$, we know that

$y_1 =$ the radius of the incircle $= A_r/s = \frac{\overline{AB} \ \overline{DC}}{2} \ \frac{2}{\overline{AC} + \overline{BC} + \overline{AB}} = \cdots = \frac{\sqrt{2 + 2a} + \sqrt{2 - 2a} - 2}{2}$

(I skipped some obvious computations at the last equality).

An easy way to compute $x_1$ is to impose that $C, C_1, O_4$ are collinear.

Use that $M = (m_1, m_2), N = (n_1, n_2), P = (p_1, p_2)$ are collinear if and only if $\frac{n_1 - m_1}{n_2 - m_2} = \frac{p_1 - m_1}{p_2 - m_2}$.

Writing down the equality above for $C, C_1, O_4$, we get

$\frac{x_1 - 0}{\frac{\sqrt{2 + 2a} + \sqrt{2 - 2a} - 2}{2} - \sqrt{1 - a^2}} = \frac{-a - 0}{-1 - \sqrt{1 - a^2}}$

Solve for $x_1$ and simplify, after which we get

$C_1 = \left( \frac{\sqrt{2 + 2a} - \sqrt{2 - 2a} - 2a}{2}, \frac{\sqrt{2 + 2a} + \sqrt{2 - 2a} - 2}{2} \right)$

Now we can verify easily that $(\overline{C_1A_1} - \overline{C_2A_2})/(\overline{C_2A_2} - \overline{C_3A_3}) = (\overline{A_1A_2})/(\overline{A_2A_3})$. In fact, we can see that $A_1$ is the midpoint between $A_2$ and $A_3$, and the radius of $\gamma_1$ is the arithmetic mean of the radii of $\gamma_2$ and $\gamma_3$. This concludes the proof.",4,"In a suitable coordinate system, determine the radii and the coordinates of the centers of the circles $\gamma_2$ and $\gamma_3$.","Establish a coordinate system where D is the origin, AB is on the x-axis, and the semicircle $\gamma$ has radius 1 and center O=(-a, 0). Let the centers of $\gamma_2$ and $\gamma_3$ be $C_2=(x_2, r_2)$ and $C_3=(x_3, r_3)$. The conditions of tangency to AB, CD, and $\gamma$ lead to a system of equations for the coordinates of each center. Solving these yields the center of $\gamma_2$ as $C_2 = (1 - a - \sqrt{2 - 2a}, -1 + a + \sqrt{2 - 2a})$ and the center of $\gamma_3$ as $C_3 = (-1 - a + \sqrt{2 + 2a}, -1 - a + \sqrt{2 + 2a})$. The radii are the y-coordinates of the centers.","In the same coordinate system, determine the radius and the coordinates of the center of the incircle $\gamma_1$ of $\triangle ABC$.","The vertices of $\triangle ABC$ are $A=(-1-a,0)$, $B=(1-a,0)$, $C=(0, \sqrt{1-a^2})$. The radius $r_1$ of the incircle $\gamma_1$ is given by the formula Area/semiperimeter. This calculation gives $r_1 = \frac{\sqrt{2+2a}+\sqrt{2-2a}-2}{2}$. The incenter $C_1=(x_1, r_1)$ lies on the angle bisector of $\angle C$, which passes through C and the point $(-a,-1)$. Using the collinearity of these three points, we find the x-coordinate: $x_1 = \frac{\sqrt{2+2a}-\sqrt{2-2a}-2a}{2}$.",Show that the center of circle $\gamma_1$ is the midpoint of the segment connecting the centers of circles $\gamma_2$ and $\gamma_3$.,"We show that $C_1=(x_1, r_1)$ is the midpoint of the segment connecting $C_2=(x_2, r_2)$ and $C_3=(x_3, r_3)$ by averaging their coordinates. The average of the x-coordinates is $\frac{x_2+x_3}{2} = \frac{(1-a-\sqrt{2-2a})+(-1-a+\sqrt{2+2a})}{2} = \frac{-2a+\sqrt{2+2a}-\sqrt{2-2a}}{2}$, which equals $x_1$. The average of the y-coordinates (radii) is $\frac{r_2+r_3}{2} = \frac{(-1+a+\sqrt{2-2a})+(-1-a+\sqrt{2+2a})}{2} = \frac{-2+\sqrt{2+2a}+\sqrt{2-2a}}{2}$, which equals $r_1$. Thus, $C_1$ is the midpoint of the segment $C_2C_3$.","Prove that $\gamma_1, \gamma_2$, and $\gamma_3$ have a second tangent in common.","For three distinct circles all tangent to a line AB on the same side, a second common tangent exists if and only if their centers are collinear. In the previous step, it was shown that the center $C_1$ of circle $\gamma_1$ is the midpoint of the segment connecting the centers $C_2$ and $C_3$ of circles $\gamma_2$ and $\gamma_3$. This implies that the points $C_1, C_2, C_3$ are collinear. Therefore, the three circles $\gamma_1, \gamma_2, \gamma_3$ have a second tangent in common."
1969p5,"Given $n > 4$ points in the plane such that no three are collinear, prove that there are at least $C(n-3, 2) = {n-3 \choose 2} = \frac{(n-3)(n-4)}{2}$ convex quadrilaterals whose vertices are four of the given points.","We start by proving that given $5$ points, there is at least one convex quadrilateral formed by $4$ of them. Denote the $5$ points by $A, B, C, D, E$. Without loss of generality, we can chose to label the points so that $C, D, E$ are on one side of the line $line(AB)$. Further, we chose to label the point $C$ so that $D, E$ are on one side of $line(AC)$. It follows that $D, E$ are inside $\angle(BAC)$, with segments $AB$ and $AC$ extended beyond $B$ and $C$ respectively.

Note that from the choice of $A, B, C$ it follows that $\angle(BAC) < 2\pi$. Also, we could have chosen $A, B, C$ by considering the convex hull of the set of 5 points. It is either a triangle, or a convex quadrilateral, or a convex pentagon. We choose $A$ to be any of the vertices, and $B, C$ to be the adjacent vertices. (We don't need these notes in the proof, I just wanted to make things easier to visualize.)

The picture below shows this choice of labels.

The line $line(DE)$ must intersect at least one of $line(AB)$ and $line(AC)$. Without loss of generality, we can assume it intersects $line(AB)$. In general, it will also intersect $line(AC)$. The argument we are going to give is for the case when $line(DE)$ intersects both $line(AB)$ and $line(AC)$. The argument needed in the limiting case when $line(DE) \parallel line(AC)$ is identical, and is left as an exercise to the reader.

There are three cases:

Case 1, when $line(DE)$ intersects $segment(AB)$, but it does not intersect $segment(AC)$. This is shown on the first 3 pictures (one picture would have been enough, but I made all of them, for emphasis). In this case the quadrilateral formed by the points $A, D, E, C$ is convex. (Note that this also applies to the case when $line(DE) \parallel line(AC)$.)

Case 2, when $line(DE)$ intersects both $segment(AB)$ and $segment(AC)$. This is shown in the 4th picture. In this case the quadrilateral formed by the points $B, D, E, C$ is convex.

Case 3, when $line(DE)$ does not intersect either of $segment(AB)$ or $segment(AC)$. This is shown in the 5th picture. In this case the quadrilateral formed by the points $B, D, E, C$ is convex. (Note that this also applies to the case when $line(DE) \parallel line(AC)$.)

We thus proved that in any group of 5 points, there is a subgroup of 4 points which forms a convex quadrilateral. Note that in general, given a group of 5 points, more than one convex quadrilateral can be found by taking subgroups of 4 points.

Important remark: In fact, we proved more: if $D, E$ are inside the angle $\angle(BAC)$ formed by $line(AB)$ and $line(AC)$ (with segments $AB$ and $AC$ extended beyond $B$ and $C$ respectively), then we can choose the convex quadrilateral so that $D, E$ are both part of it.

Now the statement of the problem is easy to prove. Assume $n$ points are given. Choose $3$ of them, and label them $A, B, C$, so that all the other points are inside $\angle(BAC)$. There are $(n - 3)$ such points. Now choose all the groups of $2$ points from these $(n - 3)$ points. There are ${n-3 \choose 2} = \frac{(n-3)(n-4)}{2}$ ways of doing this. From what we proved before, we know that for each choice of 2 points, call them $D, E$, there is a group of $4$ points from among $A, B, C, D, E$ which forms a convex quadrilateral, such that $D, E$ are $2$ of the $4$ points. A different choice $D_1, E_1$ will yield a different quadrilateral because $\{D, E\} \ne \{D_1, E_1\}$.

This concludes the proof.",4,"Given a set of $n>4$ points in the plane with no three collinear, prove that there exist three points A, B, C from the set such that all other $n-3$ points lie inside the angle $\\angle BAC$.","Consider the convex hull of the given $n$ points. Let A be any vertex of the convex hull, and let B and C be the vertices adjacent to A on the convex hull. By the definition of a convex hull, all other $n-3$ points must lie on one side of the line BC and inside the cone formed by extending the segments AB and AC from A. Therefore, all other $n-3$ points lie inside the angle $\\angle BAC$.","Let A, B, C be three non-collinear points, and let D and E be two distinct points lying inside the angle $\\angle BAC$. Prove that among the five points {A, B, C, D, E}, there exists a convex quadrilateral that includes both D and E as vertices.","Consider the line passing through D and E. This line must intersect at least one of the lines AB or AC. A case analysis on where the line DE intersects the lines AB and AC reveals that a convex quadrilateral containing D and E can always be formed with two of the points from {A, B, C}. For instance, if the segment DE intersects both segments AB and AC, then BCED is a convex quadrilateral. If DE intersects segment AB but not segment AC, then ADEC is convex. In all cases, such a quadrilateral exists.","Let A, B, C be three points chosen such that the remaining $n-3$ points (forming a set $S'$) are inside $\\angle BAC$. Show that for each distinct pair of points $\{D, E\} \\subset S'$, we can associate a unique convex quadrilateral.","For any pair $\{D, E\} \\subset S'$, the previous sub-problem guarantees the existence of a convex quadrilateral formed by D, E and two points from {A, B, C}. Let this quadrilateral be $Q_{DE}$. Now, consider a different pair $\{D', E'\} \\subset S'$. The associated quadrilateral $Q_{D'E'}$ will have $\{D', E'\}$ as two of its vertices. Since $\{D, E\} \neq \{D', E'\}$, the set of vertices of $Q_{DE}$ is different from the set of vertices of $Q_{D'E'}$. Therefore, the quadrilaterals are distinct.","Given $n > 4$ points in the plane such that no three are collinear, prove that there are at least $C(n-3, 2) = \binom{n-3}{2}$ convex quadrilaterals whose vertices are four of the given points.","From Sub-problem 1, we can select three points A, B, C such that the remaining $n-3$ points lie inside the angle $\\angle BAC$. The number of ways to choose a pair of distinct points {D, E} from these $n-3$ points is $\binom{n-3}{2}$. From Sub-problem 3, each such pair corresponds to a unique convex quadrilateral constructed from the set {A, B, C, D, E}. Therefore, there are at least $\binom{n-3}{2}$ distinct convex quadrilaterals."
1969p6,"Prove that for all real numbers $x_1, x_2, y_1, y_2, z_1, z_2$, with $x_1 > 0, x_2 > 0, x_1y_1 - z_1^2 > 0, x_2y_2 - z_2^2 > 0$, the inequality \[\frac{8}{(x_1 + x_2)(y_1 + y_2) - (z_1 + z_2)^2} \leq \frac{1}{x_1y_1 - z_1^2} + \frac{1}{x_2y_2 - z_2^2}\] is satisfied. Give necessary and sufficient conditions for equality.","First, remark that given the conditions of the problem, it follows that $y_1 > 0, y_2 > 0$. Also, we can assume $z_1 \ge 0, z_2 \ge 0$. Indeed, if $z_1 < 0$, then $z_1 < -z_1$. It follows $z_1 + z_2 < -z_1 + z_2$, so \[\frac{1}{(x_1 + x_2)(y_1 + y_2) - (z_1 + z_2)^2} < \frac{1}{(x_1 + x_2)(y_1 + y_2) - (-z_1 + z_2)^2}\]

So, if we proved the inequality for positive $z_1$ it is also true for negative $z_1$.

Now consider the function $F$ of three variables \[F(x, y, z) = \frac{1}{xy - z^2}\] defined on the domain $x, y > 0, z \ge 0, z^2 < xy$. For simplicity, denote a point $(x, y, z)$ in the domain by $P$. The inequality in the problem can be rewritten as \[F \left( \frac{P_1 + P_2}{2} \right) \le \frac{1}{2}[F(P_1) + F(P_2)]\]

This follows immediately from the inequality expressing the fact that $F(x, y, z)$ is a convex function. (In fact, it is equivalent to the convexity of $F$, but this is not needed for our proof of the given inequality.) Therefore, it is enough to prove that the function $F(x, y, z)$ is convex.

We will prove that this function is convex. In fact, we will prove that the function is strictly convex. This will imply that equality holds only when $P_1 = P_2$, in other words, $x_1 = x_2, y_1 = y_2, z_1 = z_2$, which will give us the necessary and sufficient conditions for equality.

We use the theorem which says that a twice differentiable function defined on a convex set is convex if and only if its Hessian is positive definite. Furthermore, if the Hessian is strictly positive definite, then the function is strictly convex.

The Hessian of the function $F(x, y, z)$ is the 3x3 matrix $H$ formed by the second derivatives of $F$:

$\frac{\partial^2 F}{\partial x^2} \hspace{20pt} \frac{\partial^2 F}{\partial x \partial y} \hspace{20pt} \frac{\partial^2 F}{\partial x \partial z} \\ \\ \\ \frac{\partial^2 F}{\partial y \partial x} \hspace{20pt} \frac{\partial^2 F}{\partial y^2} \hspace{20pt} \frac{\partial^2 F}{\partial y \partial z} \\ \\ \\ \frac{\partial^2 F}{\partial z \partial x} \hspace{20pt} \frac{\partial^2 F}{\partial z \partial y} \hspace{20pt} \frac{\partial^2 F}{\partial z^2}$

$H$ is positive definite if for any 3x1 vector $v$ we have $v^t H v \ge 0$. ($v^t$ is the transpose of $v$, a matrix which is 1x3.) $H$ is strictly positive definite if $v^t H v > 0$ unless $v = 0$.

Explicitly, we need to show that if $a, b, c$ are three numbers, then

$a^2 \frac{\partial^2 F}{\partial x^2} + ab \frac{\partial^2 F}{\partial x \partial y} + ac \frac{\partial^2 F}{\partial x \partial z} + ab \frac{\partial^2 F}{\partial y \partial x} + b^2 \frac{\partial^2 F}{\partial y^2} + bc \frac{\partial^2 F}{\partial y \partial z} + ac \frac{\partial^2 F}{\partial z \partial x} + bc \frac{\partial^2 F}{\partial z \partial y} + c^2 \frac{\partial^2 F}{\partial z^2} \ge 0$

and that the expression is $= 0$ only when $a = b = c = 0$.

Before embarking on the computations proving the inequality expressing the positive definiteness of the Hessian of $F$, let us show that the domain of $F$ is convex. Let $P_1 = (x_1, y_1, z_1)$ and $P_2 = (x_2, y_2, z_2)$ be two points in the domain of $F$. This means that $x_1, y_1, x_2, y_2 > 0$, $z_1, z_2 \ge 0$, $z_1^2 < x_1 y_1$ and $z_2^2 < x_2 y_2$. We need to verify that the same is true for $P = t P_1 + (1 - t) P_2$ when $0 < t < 1$. The only thing which is not obvious is $[t z_1 + (1 - t) z_2]^2 < [t x_1 + (1 - t) x_2] [t y_1 + (1 - t) y_2]$. To see this, work out the multiplications, use what we already know about $z_1^2$ and $z_2^2$, simplify by $t(1-t)$ and we are left with showing that $2 z_1 z_2 < x_1 y_2 + x_2 y_1$. This can be seen as follows: $2 z_1 z_2 < 2 \sqrt{x_1 y_1} \sqrt{x_2 y_2} = 2 \sqrt{(x_1 y_2) (x_2 y_1)} \le x_1 y_2 + x_2 y_1$.

Now work towards proving the inequality expressing that the Hessian of $F$ is positive definite. Compute all the second derivatives of $F$; notice that they all have $(xy - z^2)^3$ at the denominator, so we can simplify with this factor. (The computation is made somewhat shorter by taking advantage of the fact that the order of taking the derivatives makes no difference in mixed derivatives (for example  $\frac{\partial^2 F}{\partial x \partial y} = \frac{\partial^2 F}{\partial y \partial x}$).)

We get (as the thing we have to prove) that

$2a^2y^2 + 2ab(xy + z^2) - 8acyz + 2b^2x^2 - 8bcxz + c^2(2xy + 6z^2) \ge 0$.

If $a = b = 0$ the expression equals $0$ if and only if $c = 0$ as well. So, assume that at least one of $a, b$ is $\ne 0$. We can assume $a \ne 0$. We will show that in this case, the expression is $> 0$.

Simplify by $2$, and rearrange the terms so we can think of the expression on the left as a polynomial in $c$:

$(xy + 3z^2)c^2 - 4(xb + ya)zc + [x^2b^2 + y^2a^2 + (xy + z^2)ab] > 0$.

Notice that this is a polynomial (in $c$) of degree $2$ of the type $AX^2 + BX + C$, whose leading coefficient is $> 0$. To show that its values are always $> 0$ we need to show that its discriminant is $< 0$, in other words, $B^2 - 4AC < 0$.

Therefore, we need to show that

$16[(xb + ya)z]^2 - 4(xy + 3z^2)[x^2b^2 + y^2a^2 + (xy + 3z^2)ab] < 0$

After factoring out $4$, and working out all multiplications, this becomes

$-x^3yb^2 + x^2z^2b^2 - xy^3a^2 + y^2z^2a^2 - x^2y^2ab + 4xyz^2ab - 3z^4ab < 0$

After some rearranging of terms, grouping, and factoring, this becomes

$-(xy - z^2)[x^2b^2 + (xy - 3z^2)ab + y^2a^2] < 0$

Since $x^2 < xy$, we need to show

$x^2b^2 + (xy - 3z^2)ab + y^2a^2 > 0$

Now, view the expression on the left hand side as a polynomial of degree $2$ in $b$, whose leading coefficient is $> 0$. To conclude that its values are $> 0$ we need to show that its discriminant is $< 0$. That is, we need to show that

$[(xy - 3z^2)a]^2 - 4x^2y^2a^2 < 0$

Work out the multiplications, and regroup terms to get

$-3a^2(xy - z^2)(xy + 3z^2) < 0$.

This is clearly true, which concludes the proof.",4,"Define the function $F(x, y, z) = \frac{1}{xy - z^2}$. Show that the original inequality is equivalent to $2F\left(\frac{P_1 + P_2}{2}\right) \le F(P_1) + F(P_2)$, where $P_1 = (x_1, y_1, z_1)$ and $P_2 = (x_2, y_2, z_2)$, which is the midpoint form of Jensen's inequality.","Let $P_1=(x_1, y_1, z_1)$ and $P_2=(x_2, y_2, z_2)$. The midpoint is $\frac{P_1+P_2}{2} = (\frac{x_1+x_2}{2}, \frac{y_1+y_2}{2}, \frac{z_1+z_2}{2})$. Evaluating $F$ at the midpoint gives $F\left(\frac{P_1+P_2}{2}\right) = \frac{1}{(\frac{x_1+x_2}{2})(\frac{y_1+y_2}{2}) - (\frac{z_1+z_2}{2})^2} = \frac{4}{(x_1+x_2)(y_1+y_2) - (z_1+z_2)^2}$. The inequality $2F\left(\frac{P_1 + P_2}{2}\right) \le F(P_1) + F(P_2)$ thus becomes $2 \cdot \frac{4}{(x_1+x_2)(y_1+y_2) - (z_1+z_2)^2} \le \frac{1}{x_1y_1-z_1^2} + \frac{1}{x_2y_2-z_2^2}$, which is the original inequality. Proving this inequality is therefore equivalent to proving that $F$ is a convex function.","Prove that the domain of $F(x, y, z)$, defined by $D = \{(x, y, z) \in \mathbb{R}^3 | x > 0, y > 0, xy - z^2 > 0\}$, is a convex set.","Let $P_1=(x_1, y_1, z_1)$ and $P_2=(x_2, y_2, z_2)$ be two points in $D$. For any $t \in (0, 1)$, consider the point $P_t = tP_1 + (1-t)P_2 = (x_t, y_t, z_t)$. Clearly $x_t>0$ and $y_t>0$. We check the third condition: $x_t y_t - z_t^2 = (tx_1+(1-t)x_2)(ty_1+(1-t)y_2) - (tz_1+(1-t)z_2)^2 = t^2(x_1y_1-z_1^2) + (1-t)^2(x_2y_2-z_2^2) + t(1-t)(x_1y_2+x_2y_1-2z_1z_2)$. The first two terms are positive. For the third term, by AM-GM and the domain conditions, $x_1y_2+x_2y_1 \ge 2\sqrt{x_1y_2x_2y_1} = 2\sqrt{x_1y_1}\sqrt{x_2y_2} > 2|z_1||z_2| \ge 2z_1z_2$. Thus $x_1y_2+x_2y_1-2z_1z_2 > 0$. Therefore, $x_t y_t - z_t^2 > 0$, which shows $P_t \in D$ and that the domain $D$ is convex.","Prove that the function $F(x, y, z) = \frac{1}{xy - z^2}$ is strictly convex on its domain by showing its Hessian matrix is positive definite.","The quadratic form associated with the Hessian of $F$ for a vector $v=(a,b,c)$ is $v^T H v = \frac{2}{(xy-z^2)^3} Q(a,b,c)$, where $Q(a,b,c) = a^2y^2+b^2x^2+c^2(xy+3z^2)+ab(xy+z^2)-4acyz-4bcxz$. To show $F$ is strictly convex, we must show $Q(a,b,c) > 0$ for $v \ne 0$. Viewing $Q$ as a quadratic in $c$, its discriminant is $\Delta_c = -4(xy-z^2)[a^2y^2+b^2x^2+ab(xy-3z^2)]$. Since $xy-z^2 > 0$, we need to show the second factor is positive for $(a,b) \ne (0,0)$. Viewing $R(a,b) = a^2y^2+b^2x^2+ab(xy-3z^2)$ as a quadratic in $a$, its discriminant is $\Delta_a = b^2(xy-3z^2)^2 - 4y^2(b^2x^2) = -3b^2(xy-z^2)(xy+3z^2) \le 0$. This implies $R(a,b) \ge 0$, with equality only if $a=b=0$. This in turn makes $\Delta_c \le 0$, with equality only if $a=b=0$. So $Q(a,b,c) \ge 0$, and is zero only if $a=b=c=0$. Thus, the Hessian is positive definite and $F$ is strictly convex.","Prove that for all real numbers $x_1, x_2, y_1, y_2, z_1, z_2$, with $x_1 > 0, x_2 > 0, x_1y_1 - z_1^2 > 0, x_2y_2 - z_2^2 > 0$, the inequality \[\frac{8}{(x_1 + x_2)(y_1 + y_2) - (z_1 + z_2)^2} \leq \frac{1}{x_1y_1 - z_1^2} + \frac{1}{x_2y_2 - z_2^2}\] is satisfied. Give necessary and sufficient conditions for equality.","From Sub-problem 1, the inequality is equivalent to Jensen's inequality for the midpoint, $F\left(\frac{P_1 + P_2}{2}\right) \le \frac{F(P_1) + F(P_2)}{2}$, for the function $F(x, y, z) = \frac{1}{xy - z^2}$ on its domain $D$. From Sub-problem 2, $D$ is a convex set. From Sub-problem 3, $F$ is a strictly convex function on $D$. By the definition of strict convexity, for any two points $P_1, P_2 \in D$, and $t \in (0,1)$, we have $F(tP_1 + (1-t)P_2) \le tF(P_1) + (1-t)F(P_2)$, with equality if and only if $P_1=P_2$. Choosing $t=1/2$ gives the desired inequality. The equality holds if and only if $P_1 = P_2$, which means $x_1=x_2$, $y_1=y_2$, and $z_1=z_2$."
1968p1,"Prove that there is one and only one triangle whose side lengths are consecutive integers, and one of whose angles is twice as large as another.","So, let us start by assuming that two angles are $\alpha, 2\alpha$ and the sides are $x, x + 1, x + 2$. We will want to apply the Law of Sines:

$\frac{x}{\sin A} = \frac{x + 1}{\sin B} = \frac{x + 2}{\sin C}$

The angles $A, B, C$ should be so that $\sin A \le \sin B \le \sin C$, but we don't know how to map $\{A, B, C\}$ to $\{\alpha, 2\alpha, \pi - 3\alpha\}$. One thing we know, is that  $\sin \alpha < \sin 2\alpha$. Indeed, if $\alpha \le \pi/4$ the inequality is true because $\sin$ is increasing on $[0, \pi/2]$. Now note that $\alpha < \pi/3$ since otherwise $\pi - 3\alpha$ could not be the angle of a triangle. So, if $\pi/4 < \alpha < \pi/3$ then $\pi/2 < 2\alpha < 2\pi/3$ and $\sin \alpha < \sqrt{3}/2 < \sin 2\alpha$.

That means we will have to consider three possibilities:

1: $\ \ \frac{x}{\sin \alpha} = \frac{x + 1}{\sin 2\alpha} = \frac{x + 2}{\sin (\pi - 3\alpha)}$

2: $\ \ \frac{x}{\sin \alpha} = \frac{x + 1}{\sin (\pi - 3\alpha)} = \frac{x + 2}{\sin 2\alpha}$

3: $\ \ \frac{x}{\sin (\pi - 3\alpha)} = \frac{x + 1}{\sin \alpha} = \frac{x + 2}{\sin 2\alpha}$

Using the identities $\sin (\pi - \theta) = \sin \theta, \sin 2\theta = 2\sin \theta \cos \theta$ and $\sin 3\theta = 3\sin \theta - 4\sin^3 \theta = \sin \theta\ (4\cos^2 \theta - 1)$ and simplifying by $\sin \alpha$ the three cases become

1: $\ \ x = \frac{x + 1}{2\cos \alpha} = \frac{x + 2}{4\cos^2 \alpha - 1}$

2: $\ \ x = \frac{x + 1}{4\cos^2 \alpha - 1} = \frac{x + 2}{2\cos \alpha}$

3: $\ \ \frac{x}{4\cos^2 \alpha - 1} = x + 1 = \frac{x + 2}{2\cos \alpha}$

Each case is a system of two equations in two unknowns, $x, \cos \alpha$. We will solve each system, obtain all possible solutions, and chose those values for which $x, x + 1, x + 2$ and $\alpha, 2\alpha, \pi - 3\alpha$ can be the sides and angles of a triangle.

Case 1: Compute $x$ from $x = \frac{x + 1}{2\cos \alpha}$. We get $x = \frac{1}{2\cos \alpha - 1}$. Substitute $x$ in $x = \frac{x + 2}{4\cos^2 \alpha - 1}$. After doing all the computations we get $4\cos^2 \alpha - 4\cos \alpha = 0$. The roots are $\cos \alpha = 0$ and $\cos \alpha = 1$. None are acceptable if $\alpha$ is an angle of a triangle. So case 1 yields no solutions.

Case 2: Compute $x$ from $x = \frac{x + 2}{2\cos \alpha}$. We get $x = \frac{2}{2\cos \alpha - 1}$. Substitute $x$ in $x = \frac{x + 1}{4\cos^2 \alpha - 1}$. After doing all the computations we get $8\cos^2 \alpha - 2\cos \alpha - 3 = 0$. The solutions are $\cos \alpha = \frac{3}{4}$ and $\cos \alpha = -\frac{1}{2}$. Only $\cos \alpha = \frac{3}{4}$ is acceptable, and it yields $x = \frac{2}{\frac{6}{4} - 1} = 4$. Thus $4, 5, 6$ is a possible solution to the problem.

Case 3: Compute $x$ from $x + 1 = \frac{x + 2}{2\cos \alpha}$. We get $x = \frac{2 - 2\cos \alpha}{2\cos \alpha - 1}$. Substitute $x$ in $x + 1 = \frac{x}{4\cos^2 \alpha - 1}$. After doing all the computations we get $4\cos^2 \alpha + 2\cos \alpha - 3 = 0$. The roots are $\cos \alpha = \frac{-1 \pm \sqrt{13}}{4} \approx 0.65, -1.15$. The positive value is for an $\alpha$ acceptable as an angle in a triangle (it is a little over $\pi/4$), and yields $x = \frac{\sqrt{13} + 1}{2}$. We can easily verify that $x, x + 1, x + 2$ can be the sides of a triangle. (Indeed, they are $\frac{\sqrt{13} + 1}{2}, \frac{\sqrt{13} + 3}{2}, \frac{\sqrt{13} + 5}{2}$ and $\frac{\sqrt{13} + 1}{2} + \frac{\sqrt{13} + 3}{2} > \frac{\sqrt{13} + 5}{2}$). However, they are not integer, so are not solutions to the problem.

The only solution to the problem is the triangle with sides $4, 5, 6$ from case 2.",4,"Let a triangle have side lengths that are consecutive integers $x, x+1, x+2$ and angles $\alpha, 2\alpha, \pi-3\alpha$. Use the Law of Sines to establish the possible systems of equations relating $x$ and $\cos \alpha$.","The sides $x, x+1, x+2$ must be opposite angles whose sines are in non-decreasing order. As $\sin \alpha < \sin 2\alpha$ for any valid triangle angle $\alpha$, there are three possible pairings of sides and angles. Using the Law of Sines and trigonometric identities $\sin(2\theta)=2\sin\theta\cos\theta$ and $\sin(3\theta)=\sin\theta(4\cos^2\theta-1)$, these three cases simplify to systems of equations in $x$ and $\cos\alpha$:
1. $\frac{x}{\sin \alpha} = \frac{x+1}{\sin 2\alpha} = \frac{x+2}{\sin(3\alpha)} \implies x = \frac{x+1}{2\cos\alpha} = \frac{x+2}{4\cos^2\alpha - 1}$
2. $\frac{x}{\sin \alpha} = \frac{x+1}{\sin(3\alpha)} = \frac{x+2}{\sin 2\alpha} \implies x = \frac{x+2}{2\cos\alpha} = \frac{x+1}{4\cos^2\alpha - 1}$
3. $\frac{x}{\sin(3\alpha)} = \frac{x+1}{\sin \alpha} = \frac{x+2}{\sin 2\alpha} \implies \frac{x}{4\cos^2\alpha - 1} = x+1 = \frac{x+2}{2\cos\alpha}$","Analyze the case where the sides $x, x+1, x+2$ are opposite the angles $\alpha, 2\alpha, \pi-3\alpha$ respectively. Show that this case yields no valid triangle.","From the system $x = \frac{x+1}{2\cos\alpha}$ and $x = \frac{x+2}{4\cos^2\alpha - 1}$, we first solve for $x$ in terms of $\cos\alpha$ from the first equation: $x = \frac{1}{2\cos\alpha - 1}$. Substituting this into the second equation and simplifying yields $4\cos^2\alpha - 4\cos\alpha = 0$. The solutions are $\cos\alpha=0$ or $\cos\alpha=1$. Neither is possible for an angle $\alpha$ in a triangle (as $\alpha$ must be in $(0, \pi)$), so this case yields no solutions.","Analyze the two remaining cases: (i) sides $x, x+1, x+2$ are opposite angles $\alpha, \pi-3\alpha, 2\alpha$; (ii) sides $x, x+1, x+2$ are opposite angles $\pi-3\alpha, \alpha, 2\alpha$. Find all possible triangles that satisfy these conditions and determine which have integer side lengths.","Case (i): The system is $x = \frac{x+2}{2\cos\alpha}$ and $x = \frac{x+1}{4\cos^2\alpha - 1}$. Solving this leads to the quadratic equation $8\cos^2\alpha - 2\cos\alpha - 3 = 0$, with valid solution $\cos\alpha = 3/4$. This gives $x = 4$. The side lengths are the integers 4, 5, 6.
Case (ii): The system is $x+1 = \frac{x+2}{2\cos\alpha}$ and $x+1 = \frac{x}{4\cos^2\alpha - 1}$. Solving this leads to $4\cos^2\alpha + 2\cos\alpha - 3 = 0$, with valid solution $\cos\alpha = \frac{-1+\sqrt{13}}{4}$. This gives $x = \frac{\sqrt{13}+1}{2}$, which is not an integer.","Prove that there is one and only one triangle whose side lengths are consecutive integers, and one of whose angles is twice as large as another.","The problem requires finding a triangle with integer side lengths $x, x+1, x+2$ and angles including $\alpha$ and $2\alpha$. An exhaustive analysis of the three possible arrangements of sides and angles was conducted. The first case yielded no solution. The second case yielded a unique triangle with integer side lengths 4, 5, and 6. The third case yielded a triangle with non-integer side lengths. Therefore, the triangle with sides 4, 5, and 6 is the one and only triangle satisfying the given conditions."
1968p4,Prove that in every tetrahedron there is a vertex such that the three edges meeting there have lengths which are the sides of a triangle.,"Let the edges of one of the faces of the tetrahedron have lengths $a$, $b$, and $c$. Let $d$, $e$, and $f$ be the lengths of the sides that are not adjacent to the sides with lengths $a$, $b$, and $c$, respectively.

Without loss of generality, assume that $\max(a,b,c,d,e,f)=a$. I shall now prove that either $b+f>a$ or $c+e>a$, by proving that if $b+f\leq a$, then $c+e>a$.

Assume that $b+f\leq a$. The triangle inequality gives us that $e+f>a$, so $e$ must be greater than $b$. We also have from the triangle inequality that $b+c>a$. Therefore $e+c>b+c>a$. Therefore either $b+f>a$ or $c+e>a$.

If $b+f>a$, then the vertex where the sides of length $a$, $b$, and $f$ meet satisfies the given condition. If $c+e>a$, then the vertex where the sides of length $a$, $c$, and $e$ meet satisfies the given condition. This proves the statement. $\blacksquare$",2,"Let $a$ be an edge of maximum length in a tetrahedron. Let the two faces containing edge $a$ have edge lengths $\{a, b, c\}$ and $\{a, e, f\}$, where $b, f$ and $c, e$ are the other edges incident at the two vertices of edge $a$ respectively. Prove that either $b+f > a$ or $c+e > a$.","The edges $\{a, b, c\}$ and $\{a, e, f\}$ each form a face of the tetrahedron, so the triangle inequality must hold for each set. This gives us $b+c > a$ and $e+f > a$. We want to show that it is not possible for both $b+f \le a$ and $c+e \le a$ to be true. Assume for argument that $b+f \le a$. From the second face inequality, we have $e+f > a$. Combining these, we get $e+f > a \ge b+f$, which implies $e > b$. Now, using the first face inequality $b+c > a$, since $e>b$, it follows that $c+e > c+b > a$. Thus, the assumption $b+f \le a$ leads to the conclusion $c+e > a$. Therefore, at least one of the statements ($b+f > a$ or $c+e > a$) must be true.",Prove that in every tetrahedron there is a vertex such that the three edges meeting there have lengths which are the sides of a triangle.,"Let $a$ be an edge of maximum length in the tetrahedron. Let the two vertices of edge $a$ be $V_1$ and $V_2$. Let the other edges incident at $V_1$ be $c$ and $e$, and at $V_2$ be $b$ and $f$. The faces containing $a$ are thus $\{a,b,c\}$ and $\{a,e,f\}$. From the result of the previous sub-problem, we know that either $b+f > a$ or $c+e > a$. \nCase 1: $b+f > a$. The edges meeting at vertex $V_2$ are $a, b, f$. Since $a$ is the longest edge, $a+b>f$ and $a+f>b$ are guaranteed. Combined with $b+f>a$, the three triangle inequalities hold, so these edges form a triangle. \nCase 2: $c+e > a$. The edges meeting at vertex $V_1$ are $a, c, e$. Since $a$ is the longest edge, $a+c>e$ and $a+e>c$ are guaranteed. Combined with $c+e>a$, these edges form a triangle. \nIn either case, a vertex with the required property exists.",,,,
1967p1,"Let $ABCD$ be a parallelogram with side lengths $AB = a$, $AD = 1$, and with $\angle BAD = \alpha$. If $\Delta ABD$ is acute, prove that the four circles of radius $1$ with centers $A$, $B$, $C$, $D$ cover the parallelogram if and only if

$a\leq \cos \alpha+\sqrt{3}\sin \alpha$","We can assume $a > 1$. Indeed, refer to Remark 2 above to see that if $a \le 1$ there is nothing to prove.

Note that instead of the statement $S1$ we can consider the following statement $S1'$:

$S1'$: the circles of radius $1$ centered at $A, B, D$ cover $\triangle ABD$.

This is equivalent to $S1$ because of the symmetry between $\triangle ABD$ and $\triangle BCD$.

Let $F$ be the intersection above $AB$ of the circles of radius $1$ centered at $A, B$. The three circles cover $\triangle ABD$ if an only if $F$ is inside the circle of radius 1 centered at $D$.

This needs an explanation: Let $H$ be the midpoint of $BD$, and consider $\triangle FHD$. All the vertices of this triangle are in the circle centered at $D$, so the whole triangle is inside this circle. It is obvious that $\triangle FHB$ is inside the circle centered at $B$, and that $\triangle FAD, \triangle FAB$ are inside the circles centered at $A, B$.

We will now show that $F$ is inside the circle of radius 1 centered at $D$ if an only if $DF \le 1$.

The plan is to calculate $DF$ in terms of $a, \alpha$ and impose this condition. Let $FG \perp AB$, $DE \perp AB$ and $FF' \parallel GE$. From the right triangle $\triangle AFG$ we have $FG = \sqrt{1 - \left( \frac{a}{2} \right)^2} = \frac{\sqrt{4 - a^2}}{2}$. From the right triangle $\triangle DFF'$ we have

$DF = \sqrt{(DF')^2 + (FF')^2} = \sqrt{(DE - FG)^2 + (AG - AE)^2} = \sqrt{\left( \sin \alpha - \frac{\sqrt{4 - a^2}}{2} \right)^2 + \left( \frac{a}{2} - \cos \alpha \right)^2}$

(Note that here we used the fact that $\alpha$ is acute. These equalities would look slightly differently otherwise.)

Now look at the condition $DF \le 1$, or equivalently $DF^2 \le 1$. Making all the computations and simplifications, we have $\sqrt{4 - a^2} \sin \alpha \ge 1 - a \cos \alpha$.

Now I would like to square both sides. In order to get an equivalent inequality, we need to know that $1 - a \cos \alpha \ge 0$. This follows from the fact that $\angle ADB$ is acute. Indeed, denote $\angle ADB = \beta$. From the law of sines in $\triangle ADB$ we have $\frac{1}{\sin \angle ABD} = \frac{a}{\sin \beta}$. Successively this becomes $\frac{1}{\sin (\pi - \alpha - \beta)} = \frac{a}{\sin \beta}$ or $\frac{1}{\sin (\alpha + \beta)} = \frac{a}{\sin \beta}$ or $(1 - a \cos \alpha) \sin \beta = a \sin \alpha \cos \beta$. From here we see that $\beta < \frac{\pi}{2}$ implies the right hand side is positive, so $1 - a \cos \alpha > 0$.

Going back to our inequality, we can square both sides, and after rearranging terms we get that $DF \le 1$ if and only if

$a^2 - 2a \cos \alpha + (1 - 4 \sin^2 \alpha) \le 0$.

View this as an equation of degree $2$ in $a$. The value of the polynomial in $a$ is $\le 0$ when $a$ is between its solutions, that is

$\cos \alpha - \sqrt{3} \sin \alpha \le a \le \cos \alpha + \sqrt{3} \sin \alpha$.

Note that $\cos \alpha - \sqrt{3} \sin \alpha = 2 \cos \left( \alpha + \frac{\pi}{3} \right)$. If $\alpha \in \left( 0, \frac{\pi}{2} \right)$ then $\left( \alpha + \frac{\pi}{3} \right) \in \left( \frac{\pi}{3}, \frac{5\pi}{6} \right)$, and it follows that $2 \cos \left( \alpha + \frac{\pi}{3} \right) \le 1$.

On the other hand, remember that we are in the case $a > 1$, so the left inequality is always true. It follows that

$DF \le 1$ (i.e. the three circles of radius $1$ centered at $A, B, D$ cover $\triangle ABD$) if an only if $a \le \cos \alpha + \sqrt{3} \sin \alpha$.",4,"Show that the four unit circles centered at the vertices of parallelogram $ABCD$ cover the parallelogram if and only if the three unit circles centered at $A$, $B$, $D$ cover the triangle $\Delta ABD$.","The parallelogram $ABCD$ is the union of two congruent triangles, $\Delta ABD$ and $\Delta CDB$. Due to the symmetry of the parallelogram, the condition for the circles centered at $A, B, D$ to cover $\Delta ABD$ is identical to the condition for the circles centered at $C, D, B$ to cover $\Delta CDB$. The union of these two sets of circles covers the entire parallelogram. Therefore, the parallelogram is covered if and only if $\Delta ABD$ is covered by the circles at its vertices.","Let $F$ be the intersection point of the unit circles centered at $A$ and $B$ (such that $F$ and $D$ are on the same side of line $AB$). Show that the three unit circles centered at $A, B, D$ cover $\Delta ABD$ if and only if $DF \le 1$.","The union of the disks centered at $A$ and $B$ covers all points in $\Delta ABD$ except possibly for a region near the vertex $D$. The point $F$ is on the boundary of the region covered by the first two circles. For the entire triangle to be covered, this point must also be covered by the third circle centered at $D$. Thus, the necessary and sufficient condition for the three circles to cover $\Delta ABD$ is that $F$ is within the circle centered at $D$, which is expressed as $DF \le 1$.","Using a coordinate system with $A=(0,0)$, $B=(a,0)$, and $D=(\cos\alpha, \sin\alpha)$, show that the condition $DF \le 1$ is equivalent to the inequality $\sqrt{4-a^2}\sin\alpha \ge 1-a\cos\alpha$.","The coordinates of $F$, the intersection of circles $x^2+y^2=1$ and $(x-a)^2+y^2=1$, are $(a/2, \sqrt{1 - (a/2)^2}) = (a/2, \frac{\sqrt{4-a^2}}{2})$. The squared distance is $DF^2 = (a/2 - \cos\alpha)^2 + (\frac{\sqrt{4-a^2}}{2} - \sin\alpha)^2$. The condition $DF^2 \le 1$ expands and simplifies to $2 - a\cos\alpha - \sqrt{4-a^2}\sin\alpha \le 1$. This rearranges to $\sqrt{4-a^2}\sin\alpha \ge 1-a\cos\alpha$.","Let $ABCD$ be a parallelogram with side lengths $AB = a$, $AD = 1$, and with $\angle BAD = \alpha$. If $\Delta ABD$ is acute, prove that the four circles of radius $1$ with centers $A$, $B$, $C$, $D$ cover the parallelogram if and only if $a\leq \cos \alpha+\sqrt{3}\sin \alpha$.","From the previous steps, the coverage condition is $\sqrt{4-a^2}\sin\alpha \ge 1-a\cos\alpha$. Since $\Delta ABD$ is acute, its angles are less than $\pi/2$, which implies $1-a\cos\alpha > 0$. We can square both sides to get $(4-a^2)\sin^2\alpha \ge (1-a\cos\alpha)^2$. This simplifies to the quadratic inequality $a^2 - 2a\cos\alpha + (1-4\sin^2\alpha) \le 0$. The roots of the corresponding quadratic equation are $a = \cos\alpha \pm \sqrt{3}\sin\alpha$. The inequality holds for $a$ between the roots: $\cos\alpha - \sqrt{3}\sin\alpha \le a \le \cos\alpha + \sqrt{3}\sin\alpha$. The lower bound is satisfied for $a>1$ (the case $a\le 1$ is trivial), as $\cos\alpha - \sqrt{3}\sin\alpha < 1$. Thus, the condition reduces to $a \le \cos\alpha + \sqrt{3}\sin\alpha$."
1967p2,"Prove that if one and only one edge of a tetrahedron is greater than $1$, then its volume is $\le \frac{1}{8}$.","Let $\mathcal{T}$ be the set of tetrahedrons with five edges $\le 1$. This proof will show that there is a $T \in \mathcal{T}$ with one edge $> 1$ and such that $\mathbf{volume} (T) = \frac{1}{8}$, and that for any $U \in \mathcal{T}$ either $U = T$ or there is a finite sequence of tetrahedrons $T_1, \dots, T_n$ such that

$\mathbf{volume} (U) = \mathbf{volume} (T_1) < \dots < \mathbf{volume} (T_n) = \mathbf{volume} (T)$.

The statement of the problem is a consequence of these facts.

We begin with two simple propositions.

Proposition

Let $ABCD$ be a tetrahedron, and consider the transformations which rotate $\triangle ABC$ around $AB$ while keeping $\triangle ABD$ fixed. We get a set of tetrahedrons, two of which, $ABC_1D$ and $ABC_2D$ are shown in the picture below. The lengths of all sides except $CD$ are constant through this transformation.

1. Assume that the angles between the planes $ABD$ and $ABC$, and $ABD$ and $ABC_1$ are both acute. If the perpendicular from $C_1$ to the plane $ABD$ is larger that the perpendicular from $C$ to the plane $ABD$ then the volume of $ABC_1D$ is larger than the volume of $ABCD$.

2. Furthermore, the tetrahedron $ABC_2D$ obtained when the position of $C_2$ is such that the planes $ABD$ and $ABC_2$ are perpendicular has the maximum volume of all tetrahedrons obtained from rotating $\triangle ABC$ around $AB$.

These statements are intuitively clear, since the volume $V$ of the tetrahedron $ABCD$ is given by

$V = \frac{1}{3} \cdot ($area of $\triangle ABD) \cdot ($height from $C)$.

A formal proof is very easy, and I will skip it.

Corollary

Given a tetrahedron $T$, and an edge $e_1$ of it, we can find another tetrahedron $U$ such that $\mathbf{volume}(U) > \mathbf{volume}(T)$, with an edge $f_1 > e_1$, and such that all the other edges of $U$ are equal to the corresponding edges of $T$, $\mathbf{unless}$ the edge $e_1$ stretches between sides of $T$ which are perpendicular. When we chose a bigger $f_1$, if $e_1 < 1$ we can choose $f_1 = 1$. Or, we can choose $f_1$ such that it stretches between sides which are perpendicular.

(By ""stretches between two sides"" I mean that the end points of the edge are the vertices on the two sides which are not common to the two sides. In the picture above, $DC_2$ stretches between the sides $ABD, AC_2B$ of $ABC_2D$.)

Lemma

Assume we have a tetrahedron $T$ with edges $e_1, \dots, e_6$, such that $e_2, \dots, e_6 \le 1$. If there is an edge $e_m < 1$ among $e_2, \dots, e_6$ then there is a tetrahedron $U$ with volume bigger than the volume of $T$, whose edges are equal to those of $T$, except for $e_m$, which is replaced by an edge of size $1$.

Proof

Case 1: If $T$ does not have any sides which are perpendicular, then the existence of $U$ follows from the corollary.

Case 2: Assume $T$ has exactly two sides which are perpendicular (like $ABC_2D$ in the picture above). If $C_2D < 1$ and it were the only edge $< 1$, then all the other edges are $= 1$ (because they were assumed to be $\le 1$). In this case $\triangle ABD, \triangle AC_2B$ are equilateral with sides $= 1$, and the planes can not be perpendicular since $C_2D < 1$. (Indeed, an easy computation shows that if we take two equilateral triangles $\triangle ABD, \triangle AC_2B$ and place them perpendicular to each other, then $CD = \frac{\sqrt{6}}{2} > 1$.) So $e_m$ must be one of the other sides. Then again, the existence of $U$ follows from the corollary.

Case 3: Assume that three sides are perpendicular.

Assume the perpendicular sides are the ones meeting at $A$, i.e. each pair of the planes meeting at $A$ are perpendicular. Since at least two of the edges $BD, BC, CD \le 1$ it follows that $AB, AC, AD < 1$ (the sides of the right angle in a right triangle are less than the hypotenuse). Just for the sake of notation, assume $e_m = AB < 1$. We can apply the corollary, and find a tetrahedron $U$ with volume bigger than the volume of $T$, with edges equal to those of $T$, except that $AB$ is replaced by an edge $= 1$.

Now the problem is very easy to prove. Let $T$ be a tetrahedron with edges $e_1, \dots, e_6$, such that $e_2, \dots, e_6 \le 1$. Apply the lemma as many times as necessary (up to five times), successively replacing each edge $< 1$ by an edge $= 1$. We obtain a tetrahedron $U$ with five edges $f_2, \dots, f_6 = 1$, and one edge $f_1 = e_1$. If $f_1$ stretches between two perpendicular sides, we are done. If not, apply the corollary one more time to obtain a bigger tetrahedron in which $f_1$ is replaced by a larger edge which stretches between two perpendicular sides.

We obtain the same result as in the first solution: the largest tetrahedron is the one formed by two equilateral triangles with sides $= 1$, having one side in common, with the two planes containing the triangles perpendicular. An easy calculation shows that the edge which is $> 1$ is in fact of length $\frac{\sqrt{6}}{2}$, and the volume of this tetrahedron is $\frac{1}{8}$.",4,Let ABCD be a tetrahedron. Consider the family of tetrahedra obtained by fixing the triangle ABD and rotating the triangle ABC around the edge AB. Show that the volume is maximized when the planes containing ABD and ABC are perpendicular.,"The volume of the tetrahedron is V = (1/3) * Area(ABD) * h_C, where h_C is the perpendicular distance from vertex C to the plane containing the fixed base ABD. Since Area(ABD) is constant under the rotation, the volume V is maximized when the height h_C is maximized. This occurs precisely when the plane containing ABC is perpendicular to the plane containing ABD.",Let T be a tetrahedron with one edge > 1 and the other five edges ≤ 1. Show that its volume is less than or equal to the maximum volume of a tetrahedron with five edges of length 1.,"Let T be a tetrahedron satisfying the conditions. If one of its five edges, say e_k, has length less than 1, we can perform a volume-increasing transformation. By rotating one face relative to another around a common edge (as in sub-problem 1), we can increase the tetrahedron's volume while increasing the length of e_k to 1. This process can be repeated for all of the five edges that are less than 1. Each step increases the volume. Therefore, the maximum volume for a tetrahedron under the given constraints must be achieved when these five edges are all of length 1.",Determine the maximum volume of a tetrahedron that has five edges of length 1.,"A tetrahedron with five edges of length 1 must consist of two equilateral triangles of side 1, say ∆ABC and ∆ABD, sharing a common edge AB. The sixth edge is CD. According to the principle from sub-problem 1, the volume is maximized when the planes of these two triangles are perpendicular. The area of the base ∆ABD is √3/4. The height of the tetrahedron relative to this base is the height of ∆ABC, which is √3/2. The maximum volume is V = (1/3) * Area(base) * height = (1/3) * (√3/4) * (√3/2) = 1/8. The sixth edge CD has length √6/2 > 1.","Prove that if one and only one edge of a tetrahedron is greater than 1, then its volume is ≤ 1/8.","Let T be any tetrahedron with exactly one edge longer than 1. The other five edges have lengths less than or equal to 1. From sub-problem 2, the volume of T is less than or equal to the maximum volume of a tetrahedron with five edges of length exactly 1. From sub-problem 3, this maximum volume is achieved by a specific configuration (two perpendicular equilateral triangles of side 1) and is calculated to be exactly 1/8. Therefore, the volume of the original tetrahedron T must be less than or equal to 1/8."
1967p3,"Let $k, m, n$ be natural numbers such that $m+k+1$ is a prime greater than $n+1.$ Let $c_s=s(s+1).$ Prove that the product \[(c_{m+1}-c_k)(c_{m+2}-c_k)\cdots (c_{m+n}-c_k)\] is divisible by the product $c_1c_2\cdots c_n$.","First, assume $m + 1 \le k \le m + n$. In this case, $(c_{m + 1} - c_k)(c_{m + 2} - c_k) \cdots (c_{m + n} - c_k) = 0$, and we can say that $0$ is divisible by anything.

Next, assume $m + n < k$. In this case, each factor of the first product is negative, and we will consider the product

$P = (c_k - c_{m + 1})(c_k - c_{m + 2}) \cdots (c_k - c_{m + n})$

for the sake of working with positive factors.  $P$ differs from the product in the problem by at most a sign, so it is enough to show that $P$ is divisible by $c_1c_2 \cdots c_n$.

The proof of this fact goes along the same lines as the proof when $m + 1 > k$. We will give the proof for the sake of having a complete, properly written proof.

Using $p(p + 1) - q(q + 1) = (p + q + 1)(p - q)$ we get that $c_1c_2 \cdots c_n = (n + 1)! \cdot n!$. We also get that $P = \prod_{p = 1}^n (k + m + p + 1) \cdot \prod_{p = 1}^n (k - m - p)$.

We have that $n!\ |\ \prod_{p = 1}^n (k - m - p)$ (i.e. the product is divisible by the factorial) because

$\frac{\prod_{p = 1}^n (k - m - p)}{n!} = \frac{(k - m - 1)!}{(k - m - 1 - n)! \cdot n!} = {k - m - 1 \choose n}$

which is an integer. (Note that this all makes sense because we are in the case when $m + n < k$.)

Let us now show that $(n + 1)!\ |\ \prod_{p = 1}^n (k + m + p + 1)$. Let $P_1 = \prod_{p = 1}^n (k + m + p + 1)$. We have that

$\frac{(k + m + 1) \cdot P_1}{(n + 1)!} = \frac{(k + m + 1) \cdot \prod_{p = 1}^n (k + m + p + 1)}{(n + 1)!} = \frac{\prod_{p = 0}^n (k + m + p + 1)}{(n + 1)!} = \frac{(k + m + n + 1)!}{(k + m)! \cdot (n + 1)!} = {k + m + n + 1 \choose n + 1}$

which is an integer. So $(n + 1)!\ |\ (k + m + 1) \cdot P_1$. But none of the factors of $(n + 1)!$ is a divisor of $(k + m + 1)$ because $(k + m + 1)$ is prime, and $n + 1 < k + m + 1$. So $P_1 = \prod_{p = 1}^n (k + m + p + 1)$ must be divisible by $(n + 1)!$.",3,"Let $P = \prod_{i=1}^{n} (c_{m+i}-c_k)$ and $D = \prod_{j=1}^{n} c_j$, where $c_s = s(s+1)$. Express $P$ and $D$ as products of linear factors and factorials.","Using the identity $c_a - c_b = a(a+1) - b(b+1) = (a-b)(a+b+1)$, the product $P$ can be factored as $P = \left(\prod_{i=1}^{n} (m+i-k)\right) \left(\prod_{i=1}^{n} (m+k+i+1)\right)$. The divisor $D$ can be factored as $D = \prod_{j=1}^{n} j(j+1) = \left(\prod_{j=1}^{n} j\right) \left(\prod_{j=1}^{n} (j+1)\right) = n! \cdot (n+1)!$.","Let $P_1 = \prod_{i=1}^{n} (m+k+i+1)$. Show that $P_1$ is divisible by $(n+1)!$, given that $m+k+1$ is a prime greater than $n+1$.","Consider the product $(m+k+1)P_1 = \prod_{i=0}^{n} (m+k+i+1)$. This is a product of $n+1$ consecutive integers, so it is divisible by $(n+1)!$. We are given that $p=m+k+1$ is a prime and $p > n+1$. This implies that $p$ shares no prime factors with $(n+1)!$, so $\gcd(m+k+1, (n+1)!) = 1$. Since $(n+1)!$ divides the product $(m+k+1)P_1$ and is coprime to the factor $m+k+1$, by Euclid's Lemma, $(n+1)!$ must divide the other factor $P_1$.","Let $k, m, n$ be natural numbers such that $m+k+1$ is a prime greater than $n+1.$ Let $c_s=s(s+1).$ Prove that the product $(c_{m+1}-c_k)(c_{m+2}-c_k)\cdots (c_{m+n}-c_k)$ is divisible by the product $c_1c_2\cdots c_n$.","Let the dividend be $P$ and the divisor be $D$. If a factor $(c_{m+i}-c_k)$ is zero, then $P=0$ and the statement holds. Otherwise, from sub-problem 1, we write $P = P_1 P_2$ where $P_1 = \prod_{i=1}^{n} (m+k+i+1)$ and $P_2 = \prod_{i=1}^{n} (m+i-k)$, and $D = n!(n+1)!$. From sub-problem 2, $P_1$ is divisible by $(n+1)!$. The product $P_2$ is a product of $n$ consecutive integers (up to ordering and sign), and any such product is divisible by $n!$. Since $(n+1)!$ divides $P_1$ and $n!$ divides $P_2$, their product $P = P_1 P_2$ is divisible by $n!(n+1)! = D$.",,
1966p2,"et $a$, $b$, and $c$ be the lengths of the sides of a triangle, and $\alpha,\beta,\gamma$ respectively, the angles opposite these sides. Prove that if

\[a+b=\tan{\frac{\gamma}{2}}(a\tan{\alpha}+b\tan{\beta}),\]

the triangle is isosceles.","First, we'll prove that both $\alpha$ and $\beta$ are acute. At least one of them has to be acute because these are angles of a triangle. We can assume that $\alpha$ is acute. We want to show that $\beta$ is acute as well. For a proof by contradiction, assume $\beta \ge \frac{\pi}{2}$.

From the hypothesis, it follows that $(a + b) \tan \frac{\alpha + \beta}{2} = a \tan \alpha + b \tan \beta$.

From $\alpha < \frac{\pi}{2} \le \beta$ it follows that $a < b$. So,

$b \tan \beta = (a + b) \tan \frac{\alpha + \beta}{2} - a \tan \alpha > 2a \tan \frac{\alpha + \beta}{2} - a \tan \alpha \ge a (2 \tan \left( \frac{\alpha}{2} + \frac{\pi}{4} \right) - \tan \alpha) =$

$2a \left( \frac{\tan \frac{\alpha}{2} + 1}{1 - \tan \frac{\alpha}{2}} - \frac{\tan \frac{\alpha}{2}}{1 - \tan^2 \frac{\alpha}{2}} \right) = 2a \cdot \frac{\tan^2 \frac{\alpha}{2} + \tan \frac{\alpha}{2} + 1} {1 - \tan^2 \frac{\alpha}{2}} > 0$

because the numerator is $> 0$ (because $Y^2 + Y + 1 > 0$ for any real $Y$), and the denominator is also $> 0$ (because $\alpha < \frac{\pi}{2}$, so $\tan \frac{\alpha}{2} < \tan \frac{\pi}{4} = 1$).

It follows that $\tan \beta > 0$, so it can not be that $\beta \ge \frac{\pi}{2}$.

Now, we will prove that $(a + b) \tan \frac{\alpha + \beta}{2} = a \tan \alpha + b \tan \beta$ implies $\alpha = \beta$.

Replace $a = \sin \alpha \cdot 2R$ and $b = \sin \beta \cdot 2R$ (in fact, we don't care that $R$ is the radius of the circumscribed circle), and simplify by $2R$. We get

$(\sin \alpha + \sin \beta) \tan \frac{\alpha + \beta}{2} = \sin \alpha \tan \alpha + \sin \beta \tan \beta$.

This becomes

$\left( \sin \frac{\alpha + \beta}{2} \tan \frac{\alpha + \beta}{2} \right) \cdot \cos \frac{\alpha - \beta}{2} = \frac{1}{2}(\sin \alpha \tan \alpha + \sin \beta \tan \beta)$

We will show that the function $f(x) = \tan x \sin x$ is convex on the interval $\left( 0, \frac{\pi}{2} \right)$. Indeed, the first derivative is $f'(x) = \frac{\sin x}{\cos^2 x} + \sin x$, and the second derivative is $f''(x) = \frac{\cos^4 x - \cos ^2 x + 2}{\cos^3 x}$.

We have $f''(x) > 0$ on $\left( 0, \frac{\pi}{2} \right)$ since the numerator is $> 0$ (because $Y^2 - Y + 1 > 0$ for any real $Y$), and the denominator is $> 0$ on the interval $\left( 0, \frac{\pi}{2} \right)$. It follows that $f(x) = \tan x \sin x$ is convex on the interval $\left( 0, \frac{\pi}{2} \right)$.

Using the convexity we have $f \left( \frac{x + y}{2} \right) \le \frac{1}{2} (f(x) + f(y))$. In our case, we have

$\frac{1}{2}(\sin \alpha \tan \alpha + \sin \beta \tan \beta) = \left( \sin \frac{\alpha + \beta}{2} \tan \frac{\alpha + \beta}{2} \right) \cdot \cos \frac{\alpha - \beta}{2} \le \frac{1}{2}(\sin \alpha \tan \alpha + \sin \beta \tan \beta) \cdot \cos \frac{\alpha - \beta}{2}$.

We can simplify by $\sin \alpha \tan \alpha + \sin \beta \tan \beta$ because it is positive (because both $\alpha, \beta$ are acute!), and we get

$1 \le \cos \frac{\alpha - \beta}{2}$. This is possible only when $\cos \frac{\alpha - \beta}{2} = 1$, i.e. $\alpha = \beta$.",4,Show that the given condition $a+b=\tan{\frac{\gamma}{2}}(a\tan{\alpha}+b\tan{\beta})$ is equivalent to the relation $(a+b)\tan\frac{\alpha+\beta}{2} = a\tan\alpha+b\tan\beta$.,"In a triangle, $\alpha+\beta+\gamma = \pi$, so $\frac{\gamma}{2} = \frac{\pi}{2} - \frac{\alpha+\beta}{2}$. Using the identity $\tan(\frac{\pi}{2} - x) = \cot x = 1/\tan x$, we get $\tan\frac{\gamma}{2} = 1/\tan\frac{\alpha+\beta}{2}$. Substituting this into the given equation yields $a+b = \frac{1}{\tan\frac{\alpha+\beta}{2}}(a\tan\alpha+b\tan\beta)$. Multiplying by $\tan\frac{\alpha+\beta}{2}$ gives the desired equivalent relation.","Using the relation from the previous step, prove that both angles $\alpha$ and $\beta$ must be acute.","In any triangle, at least two angles are acute. Assume $\alpha < \pi/2$. Suppose for contradiction that $\beta \ge \pi/2$. This implies $a < b$. The relation can be written as $b\tan\beta = (a+b)\tan\frac{\alpha+\beta}{2} - a\tan\alpha$. An inequality analysis shows that the right hand side is positive, which implies $b\tan\beta > 0$ and thus $\tan\beta > 0$. However, for a triangle angle $\beta \in [\pi/2, \pi)$, we must have $\tan\beta \le 0$. This is a contradiction, so $\beta$ must be acute.","Prove that the function $f(x) = \sin x \tan x$ is strictly convex on the interval $(0, \pi/2)$.","We compute the second derivative of $f(x)$. The first derivative is $f'(x) = \sin x + \frac{\sin x}{\cos^2 x}$. The second derivative is $f''(x) = \frac{\cos^4 x - \cos^2 x + 2}{\cos^3 x}$. For $x \in (0, \pi/2)$, the denominator $\cos^3 x$ is positive. The numerator, as a quadratic in $\cos^2 x$, is always positive. Therefore, $f''(x) > 0$ on $(0, \pi/2)$, which proves that $f(x)$ is strictly convex on this interval.","Prove that if $a+b=\tan{\frac{\gamma}{2}}(a\tan{\alpha}+b\tan{\beta})$, the triangle is isosceles.","From Part 1, the condition is $(a+b)\tan\frac{\alpha+\beta}{2} = a\tan\alpha+b\tan\beta$. By the Law of Sines, $a=k\sin\alpha, b=k\sin\beta$, so $(\sin\alpha+\sin\beta)\tan\frac{\alpha+\beta}{2} = \sin\alpha\tan\alpha+\sin\beta\tan\beta$. Let $f(x)=\sin x\tan x$. The equation becomes $2f(\frac{\alpha+\beta}{2})\cos\frac{\alpha-\beta}{2} = f(\alpha)+f(\beta)$. By Part 2, $\alpha,\beta \in (0,\pi/2)$. By Part 3, $f$ is strictly convex. Jensen's inequality states $\frac{f(\alpha)+f(\beta)}{2} \ge f(\frac{\alpha+\beta}{2})$. This implies $f(\alpha)+f(\beta) \ge 2f(\frac{\alpha+\beta}{2})$. Combining with our equation gives $2f(\frac{\alpha+\beta}{2})\cos\frac{\alpha-\beta}{2} \ge 2f(\frac{\alpha+\beta}{2})$. Since $f(x)>0$ for $x \in (0, \pi/2)$, we get $\cos\frac{\alpha-\beta}{2} \ge 1$. As $\cos x \le 1$, we must have $\cos\frac{\alpha-\beta}{2}=1$, which implies $\alpha=\beta$. Therefore, the triangle is isosceles."
1966p3,Prove that the sum of the distances of the vertices of a regular tetrahedron from the center of its circumscribed sphere is less than the sum of the distances of these vertices from any other point in space.,"We will first prove the problem in the 2-dimensional case. We do this to convey the idea of the proof, and because we will use this in one spot in proving the 3-dimensional case. So let us prove that:

The sum of the distances of the vertices of an equilateral triangle $\triangle ABC$ from the center $O$ of its circumscribed circle is less than the sum of the distances of these vertices from any other point $P$ in the plane.

We will do the proof in three steps:

$\mathbf{1.}$ We will show that if $P$ is in one of the exterior regions, then there is a point $P_1$ on the boundary of the triangle (a vertex, or on a side), such that $PA + PB + PC > P_1A + P_1B + P_1C$.

$\mathbf{2.}$ Then we will show that if $P$ is on the boundary, then $PA + PB + PC > OA + OB + OC$.

$\mathbf{3.}$ For the final step, we will show that if $P$ is a point of minimum for $PA + PB + PC$ inside the triangle, then the extensions of $PA, PB, PC$ are perpendicular to the opposite sides $BC, AC, AB$. This implies that $P = O$.

$\mathbf{Proof\ of\ 1:}$ If the point $P$ is outside the triangle, it can be in one of six regions as seen in the pictures below.

If $P$ is in a region delimited by extensions of two sides of the triangle, as in the picture on the left, we notice that by taking $P_1 = A$, $PA + PB + PC > P_1A + P_1B + P_1C$ (because $P_1A = 0$ and $P_1B < PB$ as sides in an obtuse triangles, and similarly $P_1C < PC$).

If $P$ is in a region delimited by a segment which is a side of the triangle and by the extensions of two sides, as in the picture on the right, take $P_1 =$ the foot of the perpendicular from $P$ to $AB$. Then $PA + PB + PC > P_1A + P_1B + P_1C$ (because the triangle $\triangle PP_1C$ is obtuse, and because the triangles $\triangle PP_1A, \triangle PP_1B$ are right triangles).

$\mathbf{Proof\ of\ 2:}$ Now assume that $P_1 = A$. A direct, simple computation shows that $P_1A + P_1B + P_1C > OA + OB + OC$ (indeed, if we take the side of the triangle to be $1$, then $P_1A + P_1B + P_1C = 2$, and $OA + OB + OC = 3 \cdot \frac{\sqrt{3}}{3} = \sqrt{3}$).

Now assume that $P_1$ is on $AB$. If $P_1$ is not the midpoint of $AB$, let $P_2$ be the midpoint. Then $P_1A + P_1B + P_1C > P_2A + P_2B + P_2C$ (because $P_1A + P_1B = P_2A + P_2B = AB$ and $P_1C > P_2C$). A direct, simple computation shows that $P_2A + P_2B + P_2C > OA + OB + OC$ (indeed, if we take the side of the triangle to be $1$, $P_2A + P_2B + P_2C = 1 + \frac{\sqrt{3}}{2}$ and $OA + OB + OC = \sqrt{3}$).

$\mathbf{Proof\ of\ 3:}$ Assume that $P$ is inside the triangle $\triangle ABC$. In this case, we make a proof by contradiction. We will show that if $P$ is a point where $PA + PB + PC$ is minimum, then the extensions of $PA, PB, PC$ are perpendicular to the opposite sides $BC, AC, AB$. (This statement implies that $P = O$.) If this were not true, at least one of $PA \perp BC, PB \perp AC, PC \perp AB$ would be false. We can assume that $PC$ is not perpendicular to $AB$. Then draw the ellipse with focal points $A, B$ which goes through $P$.

Now consider the point $P_1$ on the ellipse such that $CP_1 \perp AB$. Because of the properties of the ellipse, $CP_1 < CP$, and because of the definition of the ellipse $PA + PB = P_1A + P_1B$. We conclude that $PA + PB + PC > P_1A + P_1B + P_1C$, which contradicts the assumption that $P$ was such that $PA + PB + PC$ was minimum.

This proves the 2-dimensional case.

NOTE: a very picky reader might object that the proof used that a minimum of $PA + PB + PC$ exists, and is achieved at a point $P$ inside the triangle. This can be justified simply by noting that $PA + PB + PC > 0$ and quoting the theorem from calculus (or is it topology?) which says that a continuous function on a closed, bounded set has a minimum, and there is a point where the minimum is achieved. Because of the arguments in the proof, this point can not be on the boundary of the triangle, so it is inside.

Now we will give the proof in the 3-dimensional case. We will do the proof in three steps. It is extremely similar to the proof in the 2-dimensional case, we just need to go from 2D to 3D, so I will skip some details.

$\mathbf{1.}$ We will show that if $P$ is in one of the exterior regions, then there is a point $P_!$ on the boundary of the tetrahedron (a vertex, or on a edge, or on a side, such that $PA + PB + PC + PD > P_1A + P_1B + P_1C + P_1D$.

$\mathbf{2.}$ Then we will show that if $P$ is on the boundary, then $PA + PB + PC + PD > OA + OB + OC + OD$.

$\mathbf{3.}$ For the final step, consider the plane going through the edge $CD$ perpendicular to the edge $AB$, the plane going through $AB$ perpendicular to $CD$, the plane going through $CA$ perpendicular to $BD$, etc. There are six such planes, and they all contain $O$, the center of the circumscribed sphere. We will show that if $P$ is a point of minimum for $PA + PB + PC + PD$ inside the tetrahedron, then $P$ is in each of the six planes described above. This implies that $P = O$.

$\mathbf{Proof\ of\ 1:}$ Let $P$ be in one of the exterior regions. Assume $P$ is in a prism shaped region delimited by extensions of three sides meeting in a vertex (there are 4 of them). Assume it is at vertex $A$, the sides being the extensions of planes $ABC, ABD, ACD$. Then take $P_1 = A$. We have $PA + PB + PC + PD > P_1A + P_1B + P_1C + P_1D$ because of obtuse triangles formed with $PP_1$.

Now assume $P$ is in one of the wedge shaped regions, formed by an edge and the extensions of two sides going through them. (there are six such regions.) Assume this is the line $AB$ and the extensions of $ABC, ABD$. Then take $P_1$ to be the foot of the perpendicular from $P$ to $AB$. Again, we have the desired inequality because $PP_1$ formed some right and obtuse triangles.

Now assume $P$ is in the truncated prism region delimited by a side and the extensions of the faces going through the edges of this side. (There are four such regions.) Assume this is the side $ABC$, and extensions of the sides $DAB, DBC, DCA$. Then take $P_1$ to be the foot of the perpendicular from $P$ to the plane $ABC$. Again, we have the desired inequality because of right and obtuse triangles formed by $PP_1$.

$\mathbf{Proof\ of\ 2:}$ Assume $P_1 = A$. If we take the edge of the tetrahedron to be $1$, a direct computation gives us that $P_1A + P_1B + P_1C + P_1D = 3$, and $OA + OB + OC + OD = 4 \cdot \frac{\sqrt{6}}{4} = \sqrt{6}$.

Assume $P_1$ is on $AB$. If $P_1$ is not the midpoint of $AB$, take $P_2$ to be the midpoint of $AB$. Then $P_1A + P_1B + P_1C + P_1D > P_2A + P_2B + P_2C + P_2D$ because of right triangles formed by $P_2C, P_2D$. And, if we take the edge of the tetrahedron to be $1$, a direct computation yields that $P_2A + P_2B + P_2C + P_2D = 1 + 2 \cdot \frac{\sqrt{3}}{2} = 1 + \sqrt{3}$, which is bigger than $OA + OB + OC + OD = \sqrt{6}$.

Assume $P_1$ is on $ABC$. If $P_1$ is not the circumcenter of $\triangle ABC$ then take $P_2$ to be the circumcenter. We have $P_1D > P_2D$ because $P_2D \perp ABC$. We also have $P_1A + P_1B + P_1C > P_2A + P_2B + P_2C$ because we proved the 2-dimensional analogue of the problem. And, if we take the edge of the tetrahedron to be $1$, we have $P_2A + P_2B + P_2C + P_2D = \sqrt{3} + \frac{\sqrt{6}}{3}$, which is bigger than $OA + OB + OC + OD = \sqrt{6}$.

NOTE: In the above paragraph, we used that the similar result is true in the 2-dimensional case, with an equilateral triangle instead of a regular tetrahedron.

$\mathbf{Proof\ of\ 3:}$ Now consider the six planes going through one edge, perpendicular to the opposite edge. They intersect at the circumcenter of the tetrahedron. Assume $P$ is a point in the interior of the tetrahedron where $PA + PB + PC + PD$ achieves its minimum value. Then $P$ is in each of the six plane.

Prove this statement by contradiction. Assume that there is a plane among the six, so that $P$ is not on it. Assume the plane is the one going through $CD$, perpendicular to $AB$. To make it more explicit, this is the plane going through $C, D, E$, where $E$ is the midpoint of $AB$.

Consider the ellipsoid with focal points $A, B$ going through $P$. This can be obtained as the set of points $Q$ in space so that $QA + QB = PA + PB$. It can also be obtained as the surface obtained when we form the ellipse with focal points $A, B$ in the plane $ABC$ (as the set of points $Q$ so that $QA + QB = PA + PB$), and we rotate this ellipse from the plane $ABC$ around its axis $AB$. Let $P_1$ be the foot of the perpendicular from $P$ to the plane $CDE$. We have $PC > P_1C, PD > P_1D$ because $PP_1 \perp CDE$. We also have $PA + PB > P_1A + P_1B$ because $P_1$ is in the interior of the ellipsoid. (Indeed, the intersection of the plane $CDE$ and the ellipsoid is the circle generated by rotating the ends of the small axis of the ellipse in the plane $ABC$. Since the point $P$ is not on the plane CDE, it must be on a smaller circle, so its projection to the plane $CDE$ will be inside.)

This concludes the proof of the problem.",4,"Prove that for an equilateral triangle, the sum of the distances from its vertices to its circumcenter is less than the sum of the distances from its vertices to any other point in its plane.","Let the vertices be A, B, C and the circumcenter be O. For any point P outside the triangle, its projection onto the triangle's convex hull gives a smaller sum of distances. For any point P on the boundary, the sum is greater than at O. For an interior point P, an argument using an ellipse with foci A and B shows that if P is a minimum, the line PC must be perpendicular to AB (and similarly for other pairs). This property uniquely defines the circumcenter O.","Let S(P) be the sum of distances from the vertices of a regular tetrahedron to a point P. Show that for any point P outside the tetrahedron, there exists a point P1 on the boundary such that S(P) > S(P1).","If P is a point outside the tetrahedron, a point P1 on its boundary can be found such that the sum of distances is smaller. This point P1 is found by considering the region P lies in and projecting P onto the corresponding part of the tetrahedron's boundary (a face, edge, or vertex). The triangle inequality on the right or obtuse triangles formed by P, P1, and a vertex guarantees that the sum of distances decreases.","Let S(P) be the sum of distances from the vertices of a regular tetrahedron to a point P, and O be its circumcenter. Show that for any point P on the boundary of the tetrahedron, S(P) > S(O).","For any point P on the boundary, we show the sum of distances S(P) is greater than at the circumcenter O. If P is a vertex, direct calculation confirms this. If P is on an edge, the sum is minimized at the edge's midpoint, which is still greater than S(O) by calculation. If P is on a face (an equilateral triangle), the sum of distances to the three vertices of that face is minimized when P is the face's circumcenter (from Sub-problem 1), and a calculation for this point shows the total sum S(P) is greater than S(O).",Prove that the sum of the distances of the vertices of a regular tetrahedron from the center of its circumscribed sphere is less than the sum of the distances of these vertices from any other point in space.,"From sub-problems 2 and 3, the point P that minimizes the sum of distances must be in the interior of the tetrahedron. For such an interior point P to be a minimum, it must lie on the plane containing any edge (e.g., CD) and perpendicular to the opposite edge (AB). This is proven by contradiction using an ellipsoid with foci A and B. Since P must lie on all six such planes, it must be their unique intersection point, which is the circumcenter O. Thus, O is the unique point of minimum."
1966p4,"Prove that for every natural number $n$, and for every real number $x \neq \frac{k\pi}{2^t}$ ($t=0,1, \dots, n$; $k$ any integer) \[\frac{1}{\sin{2x}}+\frac{1}{\sin{4x}}+\dots+\frac{1}{\sin{2^nx}}=\cot{x}-\cot{2^nx}\]","First, we prove $\cot \theta - \cot 2\theta = \frac {1}{\sin 2\theta}$.

LHS$\ =\ \frac{\cos \theta}{\sin \theta}-\frac{\cos 2\theta}{\sin 2\theta}$

$= \frac{2\cos^2 \theta}{2\cos \theta \sin \theta}-\frac{2\cos^2 \theta -1}{\sin 2\theta}$

$=\frac{2\cos^2 \theta}{\sin 2\theta}-\frac{2\cos^2 \theta -1}{\sin 2\theta}$

$=\frac {1}{\sin 2\theta}$

Using the above formula, we can rewrite the original series as

$\cot x - \cot 2x + \cot 2x - \cot 4x + \cot 4x + \dots + \cot 2^{n-1} x - \cot 2^n x$.

Which gives us the desired answer of $\cot x - \cot 2^n x$.",1,"Prove that for every natural number $n$, and for every real number $x \neq \frac{k\pi}{2^t}$ ($t=0,1, \dots, n$; $k$ any integer) \[\frac{1}{\sin{2x}}+\frac{1}{\sin{4x}}+\dots+\frac{1}{\sin{2^nx}}=\cot{x}-\cot{2^nx}\]","First, we prove $\cot \theta - \cot 2\theta = \frac {1}{\sin 2\theta}$.

LHS$\ =\ \frac{\cos \theta}{\sin \theta}-\frac{\cos 2\theta}{\sin 2\theta}$

$= \frac{2\cos^2 \theta}{2\cos \theta \sin \theta}-\frac{2\cos^2 \theta -1}{\sin 2\theta}$

$=\frac{2\cos^2 \theta}{\sin 2\theta}-\frac{2\cos^2 \theta -1}{\sin 2\theta}$

$=\frac {1}{\sin 2\theta}$

Using the above formula, we can rewrite the original series as

$\cot x - \cot 2x + \cot 2x - \cot 4x + \cot 4x + \dots + \cot 2^{n-1} x - \cot 2^n x$.

Which gives us the desired answer of $\cot x - \cot 2^n x$.",,,,,,
1966p6,"In the interior of sides $BC, CA, AB$ of triangle $ABC$, any points $K, L,M$, respectively, are selected. Prove that the area of at least one of the triangles $AML, BKM, CLK$ is less than or equal to one quarter of the area of triangle $ABC$.","Let $\triangle ABC$ and $K, L, M$ be as in the problem. Denote $x = \frac{AM}{AB}, y = \frac{BK}{BC}, z = \frac{CL}{CA}$. Note that $x, y, z, \in (0, 1)$ because $K, L, M$ are in the interior of the respective sides.

Using the fact that the area of a triangle is half of the product of two sides and $\sin$ of the angle between them, we have that $\mathbf{area} AML = x(1 - z) \mathbf{area} ABC, \mathbf{area} BKM = y(1 - x) \mathbf{area} ABC, \mathbf{area} CLK = z(1 - y) \mathbf{area} ABC$.

Now the problem has nothing to do with geometry anymore: we just have to show that given three numbers $x, y, z, \in (0, 1)$, at least one of $x(1 - z), y(1 - x), z(1 - y)$ is $\le \frac{1}{4}$.

If $y(1 - x) \le \frac{1}{4}$, we are done. Otherwise, we have $y(1 - x) > \frac{1}{4}$. It follows that $y > \frac{1}{4(1 - x)}$ (recall that $0 < x, y, z < 1$). In particular, it follows that $\frac{1}{4(1 - x)} < 1$, which implies $3 - 4x > 0$.

If $z(1 - y) \le \frac{1}{4}$, we are done. Otherwise, we have $z(1 - y) > \frac{1}{4}$. Using the inequality on $y$ from the previous paragraph, we have $z \left( 1 - \frac{1}{4(1 - x)} \right) > \frac{1}{4}$, or after a few computations, $z \cdot \frac{3 - 4x}{1 - x} > 1$. Using the observation about $3 - 4x$ from the preceding paragraph, we get $z > \frac{1 - x}{3 - 4x}$.

Now consider $x(1 - z)$. Using the inequality on $z$ from the previous paragraph, we have that $x(1 - z) < x \left( 1 - \frac{1 - x}{3 - 4x} \right)$. To finish the solution to the problem, it is enough to show that $x \cdot \left( 1 - \frac{1 - x}{3 - 4x} \right) \le \frac{1}{4}$.

After some easy computations (and using again that $3 - 4x > 0$), this becomes $3(4x^2 - 4x + 1) \ge 0$, which is true because. $4x^2 - 4x + 1 = (2x - 1)^2$.",3,"Let S denote the area of triangle ABC. Let the points M, K, L be defined by the ratios x = AM/AB, y = BK/BC, and z = CL/CA, where x, y, z are in (0, 1). Express the areas of triangles AML, BKM, and CLK in terms of S and the ratios x, y, z.","Using the sine formula for triangle area, area(AML) = (1/2) * AM * AL * sin(A) = (1/2) * (x * AB) * ((1-z) * AC) * sin(A) = x(1-z) * ((1/2) * AB * AC * sin(A)) = x(1-z)S. Similarly, area(BKM) = y(1-x)S and area(CLK) = z(1-y)S.","Let x, y, z be real numbers in (0, 1). Prove that if y(1-x) > 1/4 and z(1-y) > 1/4, then z > (1-x)/(3-4x).","From y(1-x) > 1/4, we have y > 1/(4(1-x)). Since y < 1, it follows that 1 > 1/(4(1-x)), which implies 4(1-x) > 1, so 3-4x > 0. From z(1-y) > 1/4, we have z > 1/(4(1-y)). Using the first inequality, 1-y < 1 - 1/(4(1-x)) = (3-4x)/(4(1-x)). Since both sides are positive, taking reciprocals reverses the inequality: 1/(1-y) > 4(1-x)/(3-4x). Therefore, z > 1/(4(1-y)) > (1/4) * 4(1-x)/(3-4x) = (1-x)/(3-4x).","In the interior of sides BC, CA, AB of triangle ABC, any points K, L,M, respectively, are selected. Prove that the area of at least one of the triangles AML, BKM, CLK is less than or equal to one quarter of the area of triangle ABC.","Let the ratios x, y, z be as in sub-problem 1. The problem is equivalent to showing that at least one of x(1-z), y(1-x), z(1-y) is ≤ 1/4. Assume for contradiction that all three products are > 1/4. If y(1-x) > 1/4 and z(1-y) > 1/4, then from sub-problem 2, we have z > (1-x)/(3-4x). This implies 1-z < 1 - (1-x)/(3-4x) = (2-3x)/(3-4x). Thus, x(1-z) < x(2-3x)/(3-4x). The inequality x(2-3x)/(3-4x) ≤ 1/4 is equivalent to 4x(2-3x) ≤ 3-4x (as 3-4x > 0 from sub-problem 2), which simplifies to 0 ≤ 12x^2 - 12x + 3 = 3(2x-1)^2. This is always true. So, the assumptions y(1-x)>1/4 and z(1-y)>1/4 lead to x(1-z) ≤ 1/4, which contradicts our initial assumption. Hence, at least one of the products must be ≤ 1/4.",,
1965p2,"Consider the system of equations \[a_{11}x_1 + a_{12}x_2 + a_{13}x_3 = 0\]\[a_{21}x_1 + a_{22}x_2 + a_{23}x_3 = 0\]\[a_{31}x_1 + a_{32}x_2 + a_{33}x_3 = 0\] with unknowns $x_1$, $x_2$, $x_3$. The coefficients satisfy the conditions:

(a) $a_{11}$, $a_{22}$, $a_{33}$ are positive numbers;

(b) the remaining coefficients are negative numbers;

(c) in each equation, the sum of the coefficients is positive.

Prove that the given system has only the solution $x_1 = x_2 = x_3 = 0$.","Clearly if the $x_i$ are all equal, then they are equal to 0. Now let's assume WLOG that $x_1=0$. If $x_2$ or $x_3$ is 0, then the other is clearly zero, so let's consider the case where neither are 0. $a_{12}$ and $a_{21}$ are negative, so exactly one of $x_2$ or $x_3$ is positive. Unfortunately this means that one of $a_{22}x_2 + a_{23}x_3$ or $a_{32}x_2 + a_{33}x_3 = 0$ is positive and the other is negative, so the equation couldn't possibly be satisfied if $x_2$ or $x_3$ isn't 0. We have covered the case where one of the $x_i$ is 0, now let's assume that none of them are 0.

If two are positive and one is negative, then when the negative $x_i$ is paired with one of the positive $a_i$, the corresponding equation is negative. This is bad. If two are negative and one is positive, then when the positive $x_i$ is paired with one of the positive $a_i$, the corresponding equation is positive. This is also bad. Therefore the $x_i$ all have the same sign.

Case 1: The $x_i$ are all positive. WLOG $x_1\leq x_2\leq x_3$. Now consider the third equation, $a_{31}x_1 + a_{32}x_2 + a_{33}x_3 = 0$. Therefore $x_2(a_{31} +a_{32}+a_{33})+ a_{31}(x_1-x_2)+a_{33}(x_3-x_2)= 0$, but all of the terms on the LHS are non-negative and the first one is positive, so this is impossible.

Case 2: The $x_i$ are all negative. WLOG $x_1\geq x_2\geq x_3$. Consider the third equation, $a_{31}x_1 + a_{32}x_2 + a_{33}x_3 = 0$. Therefore $x_3(a_{31}+a_{32}+a_{33})+a_{31}(x_1-x_3)+a_{32}(x_2-x_3)=0$, but all of the terms on the LHS are non-positive and the first one is negative, so this is impossible.

Therefore at least one of the $x_i$ is 0, which implies all of them are 0.",3,"Prove that if the system has a non-trivial solution $(x_1, x_2, x_3)$, then all components must be non-zero and have the same sign.","Assume a non-trivial solution exists. First, suppose one component is zero, say $x_1=0$. The system includes $a_{22}x_2+a_{23}x_3=0$ and $a_{12}x_2+a_{13}x_3=0$. From the first, since $a_{22}>0$ and $a_{23}<0$, any non-zero $x_2, x_3$ must have the same sign. From the second, since $a_{12}<0$ and $a_{13}<0$, any non-zero $x_2, x_3$ must have opposite signs. This contradiction implies $x_2=x_3=0$. Thus, if one component is zero, all are zero. A non-trivial solution must therefore have all non-zero components. Next, assume the components do not all have the same sign. There are two cases (up to permutation of indices): (1) two positive, one negative, e.g., $x_1,x_2 > 0$ and $x_3 < 0$. The third equation is $a_{31}x_1+a_{32}x_2+a_{33}x_3=0$. Since $a_{31}<0, a_{32}<0, a_{33}>0$, every term is negative. Their sum cannot be zero, a contradiction. (2) one positive, two negative, e.g., $x_1 > 0$ and $x_2,x_3 < 0$. The first equation is $a_{11}x_1+a_{12}x_2+a_{13}x_3=0$. Since $a_{11}>0, a_{12}<0, a_{13}<0$, every term is positive. Their sum cannot be zero, a contradiction. Therefore, all components must have the same sign.","Prove that the system has no solution where all components $x_1, x_2, x_3$ are positive.","Assume for contradiction that a solution with $x_1, x_2, x_3 > 0$ exists. Without loss of generality, order the components such that $x_1 \le x_2 \le x_3$. Consider the third equation, $a_{31}x_1 + a_{32}x_2 + a_{33}x_3 = 0$. This can be rewritten as $x_2(a_{31} + a_{32} + a_{33}) + a_{31}(x_1 - x_2) + a_{33}(x_3 - x_2) = 0$. By condition (c), $(a_{31}+a_{32}+a_{33}) > 0$, so the first term is positive. The second term $a_{31}(x_1-x_2)$ is non-negative since $a_{31}<0$ and $x_1-x_2 \le 0$. The third term $a_{33}(x_3-x_2)$ is non-negative since $a_{33}>0$ and $x_3-x_2 \ge 0$. The sum of a positive number and two non-negative numbers must be positive and cannot be zero. This is a contradiction, so no solution with all positive components can exist.",Prove that the given system has only the solution $x_1 = x_2 = x_3 = 0$.,"Assume for contradiction that a non-trivial solution $(x_1, x_2, x_3)$ exists. From the first sub-problem, all components must be non-zero and have the same sign. This leaves two cases. Case 1: All components $x_1, x_2, x_3$ are positive. This case was shown to be impossible in the second sub-problem. Case 2: All components $x_1, x_2, x_3$ are negative. Let $y_i = -x_i$ for $i=1,2,3$. Then all $y_i$ are positive. Substituting $x_i = -y_i$ into the original system gives $\sum_j a_{ij}(-y_j) = 0$, which simplifies to the same system $\sum_j a_{ij}y_j = 0$. This would constitute a solution with all components positive, which was proven impossible in the second sub-problem. Since all possibilities for a non-trivial solution lead to a contradiction, no non-trivial solution exists. Therefore, the only solution is $x_1 = x_2 = x_3 = 0$.",,
1965p6,In a plane a set of $n$ points ($n\geq 3$) is given. Each pair of points is connected by a segment. Let $d$ be the length of the longest of these segments. We define a diameter of the set to be any connecting segment of length $d$. Prove that the number of diameters of the given set is at most $n$.,"$\mathbf{Definition:}$ For the purpose of this proof, let us define an $equilateral\ arc\ triangle$ as the shape we obtain when we take a triangle $\triangle ABC$ in which we replace the side $AB$ by the $\pi/6$ arc of the circle centered at $C$ with radius $CA = CB$, going from $A$ to $B$, and similarly for the other two sides $BC$ and $AC$.

See the picture below.

Note that if the sides of the original equilateral triangle were of length $d$, then the distance from a vertex to any point on the opposite arc is $d$. Also, the distance between any two points on the arcs, such that none of them are vertices is $< d$. And finally, the distance from a vertex to any point on the arcs adjacent to it (which is not another vertex) is $< d$.

$\mathbf{Lemma:}$ A configuration of $n$ points has exactly $n$ diameters if an only if $3$ of the points are the vertices of an equilateral arc triangle, and the other $n - 3$ are on the boundary of the triangle.

In the configuration shown above, we have $9$ points with $9$ diameters.

$\mathbf{Proof\ of\ the\ Lemma:}$ It is clear that if we have a configuration as described in the lemma then there are $n$ diameters. We will prove the converse by induction. We want to prove that if we have a configuration of $n$ points with $n$ diameters, then the points are in a configuration as described above.

If $n = 3$ it is clear that the $3$ points have to be the vertices of an equilateral triangle since the sides are equal (to $d$). Assume we know the statement to be true for $n$, and prove it for $n + 1$. Assume that we have $n + 1$ points with $n + 1$ diameters $d$. Consider $n$ of the points, and let $Q$ be the remaining point. It follows from the induction hypothesis that $3$ of the $n$ are the vertices of an equilateral arc triangle, and the other $n - 3$ are on the boundary.

Now let us examine where $Q$ may be. It can not be outside of the equilateral arc triangle because then the distance to at least one of the vertices would be $d' > d$, and the diameter of the set would be $d'$ rather than $d$. It can not be inside the triangle because then all the distances from $Q$ to the $n$ points considered are $< d$, and we would not have $n + 1$ diameters, as assumed. So $Q$ must be on the boundary of the equilateral arc triangle, which proves the induction step, and the lemma.

Now the solution to the problem is easy to finish. Assume we have $n$ points given, and the configuration has $m$ diameters. I claim that we can not have $m > n$. We prove this by contradiction. If we did, let us consider a set $S$ consisting of only $n$ of the diameters. Because of the lemma, this implies that the $n$ points form a configuration as described in the lemma, i.e. $3$ of them are the vertices of an equilateral arc triangle, and the other $n - 3$ are on the boundary. Now consider a diameter $D$ which is not in $S$. It is the distance of a segment between two of the points $P_1, P_2$ in the configuration. If one of $P_1, P_2$ is a vertex, then this diameter $D$ is in $S$, which is a contradiction. If none of $P_1, P_2$ are vertices, then the length of $P_1P_2 < d$, so $D = P_1P_2$ is not a diameter, which is again a contradiction.

It follows that $m \le n$ which proves the problem.",4,"An 'equilateral arc triangle' is a region bounded by three circular arcs connecting the vertices of an equilateral triangle $\triangle ABC$ of side length $d$, where each arc is on a circle of radius $d$ centered at the opposite vertex. Prove that a set of $n$ points consisting of the three vertices $A, B, C$ and $n-3$ other points on the boundary arcs has exactly $n$ diameters.","Let the vertices be $A, B, C$. By construction, the distance from a vertex to any point on the opposite arc is $d$. The distance between any other pair of points in the set (e.g., two non-vertices, or a vertex and a point on an adjacent arc) is strictly less than $d$. The diameters are therefore the three segments $AB, BC, CA$, plus for each of the $n-3$ points on the arcs, the single segment connecting it to the unique vertex opposite the arc it lies on. This gives a total of $3 + (n-3) = n$ diameters.","Prove that if a set of 3 points in a plane has 3 diameters, the points must form an equilateral triangle of side length $d$, where $d$ is the diameter length.","Let the points be $P_1, P_2, P_3$. A diameter is a segment of maximal length $d$. If the set has 3 diameters, the segments $P_1P_2, P_2P_3, P_3P_1$ must all be diameters. Therefore, their lengths are all equal to $d$. A triangle with three equal sides is an equilateral triangle. This forms the base case ($n=3$) for the characterization of point sets with $n$ diameters.","Assume that any set of $k$ points with exactly $k$ diameters must lie on an 'equilateral arc triangle' (3 as vertices, $k-3$ on the boundary). Now, consider a set of $k+1$ points with $k+1$ diameters, and assume a subset of $k$ of these points has exactly $k$ diameters. Prove that the $(k+1)$-th point must also lie on the boundary of the equilateral arc triangle defined by the subset.","Let the $k$ points of the subset lie on an equilateral arc triangle $T$ of diameter $d$. Let the $(k+1)$-th point be $Q$. If $Q$ were outside $T$, its distance to at least one vertex of $T$ would be greater than $d$, contradicting that $d$ is the maximum length. If $Q$ were in the interior of $T$, its distances to all other $k$ points would be less than $d$, so no new diameter involving $Q$ could be formed. This would mean the set of $k+1$ points has only $k$ diameters, a contradiction. Therefore, $Q$ must lie on the boundary of $T$.",In a plane a set of $n$ points ($n\geq 3$) is given. Each pair of points is connected by a segment. Let $d$ be the length of the longest of these segments. We define a diameter of the set to be any connecting segment of length $d$. Prove that the number of diameters of the given set is at most $n$.,"We prove by contradiction. Assume a set of $n$ points has $m > n$ diameters. Consider the subgraph formed by these $n$ points and any $n$ of their diameters. Based on the previous sub-problems, a set of $n$ points with exactly $n$ diameters must be arranged on an equilateral arc triangle. In this specific geometric configuration, we have established that there are exactly $n$ segments of length $d$. All other segments between pairs of points are strictly shorter than $d$. This contradicts the existence of an $(n+1)$-th diameter. Therefore, the assumption is false, and the number of diameters is at most $n$."
1964p2,"Suppose $a, b, c$ are the sides of a triangle. Prove that

\[a^2(b+c-a)+b^2(c+a-b)+c^2(a+b-c)\le{3abc}.\]","Let $b+c-a = x$, $c+a-b = y$, and $a+b-c = z$. Then, $a = \frac{y+z}{2}$, $b = \frac{x+z}{2}$, and $c = \frac{x+y}{2}$. By AM-GM, \[\frac{x+y}{2} \geq \sqrt{xy},\]\[\frac{y+z}{2} \geq \sqrt{yz},\]\[\textrm{and }\frac{x+z}{2} \geq \sqrt{xz}.\]

Multiplying these equations, we have \[\frac{x+y}{2} \cdot \frac{y+z}{2} \cdot \frac{x+z}{2} \geq xyz\]\[\therefore abc \geq (a+b-c)(b+c-a)(c+a-b).\] We can now simplify: \[(a+b-c)(b+c-a)(c+a-b) \leq abc\]\[(-a^2 + b^2 - c^2 + 2ac)(c+a-b) \leq abc\]\[a(-a^2 + b^2 - c^2 + 2ac) + c(-a^2 + b^2 - c^2 + 2ac) - b(-a^2 + b^2 - c^2 + 2ac) \leq abc\]\[-a^3 + ab^2 - ac^2 + 2a^2c - a^2c + b^2c - c^3 + 2ac^2 + a^2b - b^3 + bc^2 - 2abc \leq abc\]\[a^2b + a^2c - a^3 + b^2c + ab^2 - b^3 + ac^2 + bc^2 - c^3 - 2abc \leq abc\]\[a^2(b+c-a)+b^2(c+a-b)+c^2(a+b-c)\le{3abc}\textrm{. }\square\]",2,"Suppose $a, b, c$ are the sides of a triangle. Prove that $(b+c-a)(c+a-b)(a+b-c) \le abc$.","Let $x = b+c-a$, $y = c+a-b$, and $z = a+b-c$. Since $a, b, c$ are sides of a triangle, $x, y, z$ are all positive. We can express $a, b, c$ in terms of $x, y, z$: $a = \frac{y+z}{2}$, $b = \frac{x+z}{2}$, and $c = \frac{x+y}{2}$. By the AM-GM inequality, we have $\frac{y+z}{2} \ge \sqrt{yz}$, $\frac{x+z}{2} \ge \sqrt{xz}$, and $\frac{x+y}{2} \ge \sqrt{xy}$. Multiplying these three inequalities gives $(\frac{y+z}{2})(\frac{x+z}{2})(\frac{x+y}{2}) \ge \sqrt{y^2z^2x^2} = xyz$. Substituting back the expressions for $a, b, c$ and $x, y, z$, we get $abc \ge (b+c-a)(c+a-b)(a+b-c)$.","Suppose $a, b, c$ are the sides of a triangle. Prove that $a^2(b+c-a)+b^2(c+a-b)+c^2(a+b-c)\le{3abc}$.","Let the left-hand side be LHS. By expansion, we can verify the algebraic identity $a^2(b+c-a)+b^2(c+a-b)+c^2(a+b-c) = (b+c-a)(c+a-b)(a+b-c) + 2abc$. From the result of the previous sub-problem, we have the inequality $(b+c-a)(c+a-b)(a+b-c) \le abc$. Substituting this into our identity, we get $LHS \le abc + 2abc$, which simplifies to $LHS \le 3abc$. This completes the proof.",,,,
1964p4,Seventeen people correspond by mail with one another - each one with all the rest. In their letters only three different topics are discussed. Each pair of correspondents deals with only one of these topics. Prove that there are at least three people who write to each other about the same topic.,"Lemma: Consider a complete graph with 6 vertices colored with 2 colors. There exists a monochromatic triangle.

Proof: Consider one vertex and all connections leading out from it. Call it $V_1$. It has 5 edges coming out from it. By the Pigeonhole Principle, there are at least 3 of the same color. Call this color red. Call those vertices $V_2$, $V_3$ and $V_4$. If any of the segments $V_2V_3$, $V_2V_4$, or $V_3V_4$ are red, then we have a monochromatic triangle with vertices $V_1$ and the other two that are also red. If they are all the other color, then we have a monochromatic triangle with vertices $V_2$,$V_3$, and $V_4$. $\blacksquare$



Main Problem: Represent these people as vertices on a connected graph with 17 vertices and colored with 3 colors, one corresponding with each topic. So this problem is reduced to showing that on a connected graph with 17 vertices and colored with three colors, there exists some monochromatic triangle. Look at an arbitrary vertex. Call it $V_1$. Look at the 16 other vertices that it is connected to. By the Pigeonhole Principle, there are at least 6 vertices connected to $V_1$ that are all one color. Call this color 1. If any of the connections inbetween these six vertices are in color 1, then we are done. If none of them are color 1, we know that that there are only 2 colors in those 6 vertices. By Lemma 1, we know that there is a monochromatic triangle in those 6 vertices. So we are done.",3,Show that the problem of 17 people and 3 topics is equivalent to proving that any complete graph K_17 whose edges are colored with 3 colors must contain a monochromatic triangle.,"Represent the 17 people as vertices in a complete graph K_17. The three topics correspond to three colors. Since each pair of people discusses exactly one topic, the edge connecting the corresponding pair of vertices is colored with the color of their topic. A group of three people writing to each other about the same topic corresponds to a set of three vertices where the three edges connecting them all have the same color, which is a monochromatic triangle.",Prove that any 2-coloring of the edges of a complete graph on 6 vertices (K_6) contains a monochromatic triangle.,"Select an arbitrary vertex v in K_6. It is connected to 5 other vertices. By the Pigeonhole Principle, at least 3 of these edges must have the same color, say red. Let these edges connect v to vertices x, y, and z. If any of the edges (x,y), (y,z), or (z,x) are red, then a red triangle is formed with v. If none of these edges are red, they must all be the other color, say blue, forming a blue triangle (x,y,z). Thus, a monochromatic triangle must exist.",Seventeen people correspond by mail with one another - each one with all the rest. In their letters only three different topics are discussed. Each pair of correspondents deals with only one of these topics. Prove that there are at least three people who write to each other about the same topic.,"Using the model from the first sub-problem, we must find a monochromatic triangle in a 3-colored K_17. Select an arbitrary vertex v. It has 16 edges to the other vertices. By the Pigeonhole Principle, at least ceil(16/3) = 6 of these edges must have the same color, say C1. Let S be the set of 6 vertices connected to v by edges of color C1. Consider the K_6 subgraph on the vertices in S. If any edge in this K_6 is colored C1, it forms a C1-colored triangle with v. If no edge in this K_6 is colored C1, then its edges are colored with the remaining 2 colors. By the result of the second sub-problem, this 2-colored K_6 must contain a monochromatic triangle. Therefore, a monochromatic triangle is always present.",,
1963p3,"In an $n$-gon all of whose interior angles are equal, the lengths of consecutive sides satisfy the relation

$a_1\ge a_2\ge \cdots \ge a_n$.
Prove that $a_1=a_2=\cdots = a_n$.","Let $a_1 = p_1p_2$, $a_2 = p_2p_3$, etc.

Plot the $n$-gon on the cartesian plane such that $p_1p_2$ is on the $x$-axis and the entire shape is above the $x$-axis. There are two cases: the number of sides is even, and the number of sides is odd:

$\textbf{Case 1: Even}$

In this case, the side with the topmost points will be $p_{\frac{n}{2}+1}p_{\frac{n}{2}+2}$. To obtain the $y$-coordinate of this top side, we can multiply the lengths of the sides $a_1$, $a_2$, ... $a_{\frac{n}{2}}$ by the sine of the angle they make with the $x$-axis:

\[y\textrm{-coordinate} = \sum_{k = 1}^{\frac{n}{2}}a_k \cdot \sin \frac{2\pi(k-1)}{n}.\textbf{ (1)}\]

We can obtain the $y$-coordinate of the top side in a different way by multiplying the lengths of the sides $a_{\frac{n}{2}+1}$, $a_{\frac{n}{2}+2}$, ... $a_n$ by the sine of the angle they make with the $x$-axis to get the $\emph{negated}$ $y$-coordinate of the top side:

\[-y\textrm{-coordinate} = \sum_{k = \frac{n}{2}+1}^{n}a_k \cdot \sin \frac{2\pi(k-1)}{n}\]\[y\textrm{-coordinate} = \sum_{k = \frac{n}{2}+1}^{n}a_k \cdot -\sin \frac{2\pi(k-1)}{n}\]\[= \sum_{k = \frac{n}{2}+1}^{n}a_k \cdot \sin \frac{2\pi(k-\frac{n}{2}-1)}{n}\]\[= \sum_{k = 1}^{\frac{n}{2}}a_{k+\frac{n}{2}} \cdot \sin \frac{2\pi(k-1)}{n}.\textbf{ (2)}\]

It must be true that $\textbf{(1)} = \textbf{(2)}$. This implies that $a_k = a_{k+\frac{n}{2}}$ for all $1 \leq k \leq \frac{n}{2}$, and therefore $a_1=a_2=\cdots = a_n$.

$\textbf{Case 2: Odd}$

This case is very similar to before. We will compute the $y$-coordinate of the top point $p_{frac{n+3}{2}}$ two ways:

\[y\textrm{-coordinate} = \sum_{k = 2}^{\frac{n+1}{2}}a_k \cdot \sin \frac{2\pi(k-1)}{n}.\textbf{ (3)}\]\[-y\textrm{-coordinate} = \sum_{k = \frac{n+3}{2}}^{n}a_k \cdot \sin \frac{2\pi(k-1)}{n}\]\[y\textrm{-coordinate} = \sum_{k = \frac{n+3}{2}}^{n}a_k \cdot -\sin \frac{2\pi(k-1)}{n}\]\[= \sum_{k = \frac{n+3}{2}}^{n}a_k \cdot \sin \frac{2\pi(n - k + 1)}{n}\]\[= \sum_{k = 2}^{\frac{n+1}{2}}a_{n-k+2} \cdot \sin \frac{2\pi(k-1)}{n}.\textbf{ (4)}\]

It must be true that $\textbf{(3)} = \textbf{(4)}$. Then, we get $a_k = a_{n-k+2}$ for all $2 \leq k \leq \frac{n+1}{2}$. Therefore, $a_2=a_3=\cdots = a_n$. It is trivial that $a_1$ is then equal to the other values, so $a_1=a_2=\cdots = a_n$. This completes the proof. $\square$",3,"For an $n$-gon ($n$ even) with equal interior angles and side lengths satisfying $a_1 \ge a_2 \ge \cdots \ge a_n$, prove that $a_k = a_{k+n/2}$ for $k=1, \dots, n/2$.","Place the polygon on a Cartesian plane with side $a_1$ on the x-axis. The y-coordinate of the topmost side ($p_{n/2+1}p_{n/2+2}$) can be computed in two ways. Summing the vertical displacements of sides $a_1, \dots, a_{n/2}$ gives $\sum_{k=1}^{n/2}a_k \sin \frac{2\pi(k-1)}{n}$. Summing the displacements of sides $a_{n/2+1}, \dots, a_n$ and taking the negative, then using trigonometric identities, gives $\sum_{k=1}^{n/2}a_{k+n/2} \sin \frac{2\pi(k-1)}{n}$. Equating the two expressions yields $\sum_{k=1}^{n/2}(a_k - a_{k+n/2}) \sin \frac{2\pi(k-1)}{n} = 0$. Given $a_k \ge a_{k+n/2}$ and $\sin \frac{2\pi(k-1)}{n} \ge 0$ for $k \in [1, n/2]$, each term in the sum must be non-negative. For the sum to be zero, each term must be zero, which implies $a_k = a_{k+n/2}$ for $k=1, \dots, n/2$.","For an $n$-gon ($n$ odd) with equal interior angles and side lengths satisfying $a_1 \ge a_2 \ge \cdots \ge a_n$, prove that $a_k = a_{n-k+2}$ for $k=2, \dots, (n+1)/2$.","Place the polygon on a Cartesian plane with side $a_1$ on the x-axis. The y-coordinate of the topmost vertex ($p_{(n+3)/2}$) can be computed in two ways. Summing the vertical displacements from $a_2$ up to $a_{(n+1)/2}$ gives $\sum_{k=2}^{(n+1)/2}a_k \sin \frac{2\pi(k-1)}{n}$. Summing from the other side (from $a_{(n+3)/2}$ to $a_n$) and using trigonometric identities gives $\sum_{k=2}^{(n+1)/2}a_{n-k+2} \sin \frac{2\pi(k-1)}{n}$. Equating the two expressions yields $\sum_{k=2}^{(n+1)/2}(a_k - a_{n-k+2}) \sin \frac{2\pi(k-1)}{n} = 0$. Since $k < n-k+2$, we have $a_k \ge a_{n-k+2}$, and all sine terms are positive for the given range of $k$. Thus, each term must be zero, which implies $a_k = a_{n-k+2}$ for $k=2, \dots, (n+1)/2$.","In an $n$-gon all of whose interior angles are equal, the lengths of consecutive sides satisfy the relation $a_1\ge a_2\ge \cdots \ge a_n$. Prove that $a_1=a_2=\cdots = a_n$.","We consider two cases. Case 1: $n$ is even. From Sub-problem 1, $a_k = a_{k+n/2}$ for $k=1, \dots, n/2$. The given condition $a_k \ge a_{k+1} \ge \cdots \ge a_{k+n/2}$ forces this to be a chain of equalities, so $a_k = a_{k+1} = \cdots = a_{k+n/2}$. Since these segments of equal sides overlap for consecutive $k$, all side lengths must be equal. Case 2: $n$ is odd. From Sub-problem 2, $a_k = a_{n-k+2}$ for $k=2, \dots, (n+1)/2$. This implies $a_2=a_n, a_3=a_{n-1}$, etc. The condition $a_2 \ge a_3 \ge \cdots \ge a_n$ forces $a_2=a_3=\cdots=a_n$. To show $a_1=a_2$, we use the fact that the sum of the x-components of the side vectors is zero: $\sum_{k=1}^n a_k \cos\frac{2\pi(k-1)}{n}=0$. This simplifies to $a_1 - a_2=0$, so $a_1=a_2$. Therefore, all side lengths are equal.",,
1963p5,Prove that $\cos{\frac{\pi}{7}}-\cos{\frac{2\pi}{7}}+\cos{\frac{3\pi}{7}}=\frac{1}{2}$.,"Because the sum of the $x$-coordinates of the seventh roots of unity is $0$, we have

\[\cos{\frac{2\pi}{7}} + \cos{\frac{4\pi}{7}} + \cos{\frac{6\pi}{7}} + \cos{\frac{8\pi}{7}} + \cos{\frac{10\pi}{7}} + \cos{\frac{12\pi}{7}} + \cos{\frac{14\pi}{7}} = 0\]\[\cos{\frac{2\pi}{7}} + \cos{\frac{4\pi}{7}} + \cos{\frac{6\pi}{7}} + \cos{\frac{8\pi}{7}} + \cos{\frac{10\pi}{7}} + \cos{\frac{12\pi}{7}} = -1\]\[\cos{\frac{2\pi}{7}} + \cos{\frac{4\pi}{7}} + \cos{\frac{6\pi}{7}} + \cos{\left(-\frac{6\pi}{7}\right)} + \cos{\left(-\frac{4\pi}{7}\right)} + \cos{\left(-\frac{2\pi}{7}\right)} = -1.\]

Now, we can apply $\cos{x} = \cos{\left(-x\right)}$ to obtain

\[2\left(\cos{\frac{2\pi}{7}} + \cos{\frac{4\pi}{7}} + \cos{\frac{6\pi}{7}}\right) = -1\]\[\cos{\frac{2\pi}{7}} + \cos{\frac{4\pi}{7}} + \cos{\frac{6\pi}{7}} = -\frac{1}{2}.\]

Finally, since $\cos{x} = -\cos{(\pi-x)}$,

\[\cos{\frac{2\pi}{7}} - \cos{\frac{3\pi}{7}} - \cos{\frac{\pi}{7}} = -\frac{1}{2}\]\[\cos{\frac{\pi}{7}} - \cos{\frac{2\pi}{7}} + \cos{\frac{3\pi}{7}} = \frac{1}{2}\textrm{. }\square\]",1,Prove that $\cos{\frac{\pi}{7}}-\cos{\frac{2\pi}{7}}+\cos{\frac{3\pi}{7}}=\frac{1}{2}$.,"Because the sum of the $x$-coordinates of the seventh roots of unity is $0$, we have

\[\cos{\frac{2\pi}{7}} + \cos{\frac{4\pi}{7}} + \cos{\frac{6\pi}{7}} + \cos{\frac{8\pi}{7}} + \cos{\frac{10\pi}{7}} + \cos{\frac{12\pi}{7}} + \cos{\frac{14\pi}{7}} = 0\]\[\cos{\frac{2\pi}{7}} + \cos{\frac{4\pi}{7}} + \cos{\frac{6\pi}{7}} + \cos{\frac{8\pi}{7}} + \cos{\frac{10\pi}{7}} + \cos{\frac{12\pi}{7}} = -1\]\[\cos{\frac{2\pi}{7}} + \cos{\frac{4\pi}{7}} + \cos{\frac{6\pi}{7}} + \cos{\left(-\frac{6\pi}{7}\right)} + \cos{\left(-\frac{4\pi}{7}\right)} + \cos{\left(-\frac{2\pi}{7}\right)} = -1.\]

Now, we can apply $\cos{x} = \cos{\left(-x\right)}$ to obtain

\[2\left(\cos{\frac{2\pi}{7}} + \cos{\frac{4\pi}{7}} + \cos{\frac{6\pi}{7}}\right) = -1\]\[\cos{\frac{2\pi}{7}} + \cos{\frac{4\pi}{7}} + \cos{\frac{6\pi}{7}} = -\frac{1}{2}.\]

Finally, since $\cos{x} = -\cos{(\pi-x)}$,

\[\cos{\frac{2\pi}{7}} - \cos{\frac{3\pi}{7}} - \cos{\frac{\pi}{7}} = -\frac{1}{2}\]\[\cos{\frac{\pi}{7}} - \cos{\frac{2\pi}{7}} + \cos{\frac{3\pi}{7}} = \frac{1}{2}\textrm{. }\square\]",,,,,,
1962p6,"Consider an isosceles triangle. Let $r$ be the radius of its circumscribed circle and $\rho$ the radius of its inscribed circle. Prove that the distance $d$ between the centers of these two circles is

$d=\sqrt{r(r-2\rho)}$.","Instead of an isosceles triangle, let us consider an arbitrary triangle $ABC$. Let $ABC$ have circumcenter $O$ and incenter $I$. Extend $AI$ to meet the circumcircle again at $L$. Then extend $LO$ so it meets the circumcircle again at $M$. Consider the point where the incircle meets $AB$, and let this be point $D$. We have $\angle ADI = \angle MBL = 90^{\circ}, \angle IAD = \angle LMB$; thus, $\triangle ADI \sim \triangle MBL$, or $\frac {ID}{BL} = \frac {AI} {ML} \iff ID \cdot ML = 2r\rho = AI \cdot BL$. Now, drawing line $BI$, we see that $\angle BIL = \frac {1}{2}\angle A + \frac {1}{2}\angle ABC, \angle IBL = \frac {1}{2}\angle ABC + \angle CBL = \frac {1}{2}\angle ABC + \frac {1}{2}\angle A$. Therefore, $BIL$ is isosceles, and $IL = BL$. Substituting this back in, we have $2r\rho = AI\cdot IL$. Extending $OI$ to meet the circumcircle at $P,Q$, we see that $AI\cdot IL = PI\cdot QI$ by Power of a Point. Therefore, $2r\rho = PI \cdot QI = (PO + OI)(QO - OI) = (r + d)(r - d)$, and we have $2r\rho = r^2 - d^2 \iff d = \sqrt {r(r - 2\rho)}$, and we are done.",2,"Let $I$ be the incenter and $O$ be the circumcenter of a triangle $ABC$. Let $r$ be the circumradius and $\rho$ be the inradius. If the line $AI$ intersects the circumcircle at a point $L$ (distinct from $A$), prove that $AI \cdot IL = 2r\rho$.","Let the line $LO$ intersect the circumcircle at $M$. Let the incircle be tangent to side $AB$ at $D$. Then $ID = \rho$ and $\angle ADI = 90^\circ$. Since $LM$ is a diameter of the circumcircle, $ML=2r$ and $\angle MBL = 90^\circ$. We have $\angle IAD = \angle A/2$ and $\angle LMB = \angle MAB = \angle A/2$ (angles subtended by the same arc $LB$). Therefore, right triangles $\triangle ADI$ and $\triangle MBL$ are similar. From similarity, we have $\frac{ID}{BL} = \frac{AI}{ML}$, which implies $ID \cdot ML = AI \cdot BL$, or $2r\rho = AI \cdot BL$. Now we show $BL=IL$. By angle chasing, $\angle BIL = \angle BAI + \angle ABI = \frac{A}{2} + \frac{B}{2}$. Also, $\angle IBL = \angle IBC + \angle CBL = \frac{B}{2} + \angle CAL = \frac{B}{2} + \frac{A}{2}$. Since $\angle BIL = \angle IBL$, $\triangle BIL$ is isosceles with $IL = BL$. Substituting this into our previous equation gives $AI \cdot IL = 2r\rho$.",Consider an isosceles triangle. Let $r$ be the radius of its circumscribed circle and $\rho$ the radius of its inscribed circle. Prove that the distance $d$ between the centers of these two circles is $d=\sqrt{r(r-2\rho)}$.,"Let $O$ be the circumcenter and $I$ be the incenter, so the distance between them is $d=OI$. Let the line passing through $O$ and $I$ intersect the circumcircle at points $P$ and $Q$. By the Power of a Point theorem with respect to point $I$ and the circumcircle, the product of the lengths of the segments from $I$ along any chord is constant. For the chord passing through $A, I, L$ (where $L$ is on the circumcircle), this power is $AI \cdot IL$. For the chord passing through $P, I, Q$, the power is $PI \cdot IQ$. We can express $PI$ and $IQ$ in terms of $r$ and $d$: $PI = r+d$ and $IQ = r-d$. Thus, $AI \cdot IL = (r+d)(r-d) = r^2 - d^2$. From the previous sub-problem, we established that $AI \cdot IL = 2r\rho$. Equating the two expressions gives $r^2 - d^2 = 2r\rho$. Rearranging the terms, we get $d^2 = r^2 - 2r\rho$, which leads to $d = \sqrt{r(r-2\rho)}$. Since this proof holds for any triangle, it also holds for an isosceles triangle.",,,,
1962p7,"The tetrahedron $SABC$ has the following property: there exist five spheres, each tangent to the edges $SA, SB, SC, BC, CA, AB$, or to their extensions.

(a) Prove that the tetrahedron $SABC$ is regular.

(b) Prove conversely that for every regular tetrahedron five such spheres exist.","Part (a)

Let points $P_{SA}, P_{SB}, P_{SC}, P_{BC}, P_{CA}, P_{AB}$ be the points where the smallest sphere is tangent to the edges $SA,  SB,  SC,  BC,  CA,  AB$ respectively.

For each face of the tetrahedron there is a circular cross section of the smallest sphere. Since that circle also needs to be tangent to the edges, then that circle is the incircle of each triangular face.

From the properties of an incircle we know that:

$|AP_{AB}|=|AP_{AC}|$, $|BP_{BC}|=|BP_{BA}|$, and $|CP_{CA}|=|CP_{CB}|$ in $\Delta ABC$

There is a larger circle that is tangent to $AB$ and the extensions of $CA$ and $CB$.

This larger circle is a cross section of the sphere that's also tangent to the extension of $CS$ away from $S$ and the edges of $\Delta ABC$

Therefore, this larger circle and the incircle of $\Delta ABC$ are part of that same sphere.

In order for these two circles to be part of the same sphere and also tangent to line $AB$, then the point of the tangent of this larger circle needs to be the same as point $P_{AB}$

The only way these to circles can share the same tangent point on edge $AB$ is if $|AP_{AB}|=|BP_{AB}|$

Using the same argument with the larder circle of edge $BC$ then $|BP_{BC}|=|CP_{BC}|$

and with the larger circle of edge $AC$ then $|CP_{AC}|=|AP_{AC}|$

This results in:

$|AP_{AB}|=|AP_{AC}|=|BP_{BC}|=|BP_{BA}|=|CP_{CA}|=|CP_{CB}|$ in $\Delta ABC$

which means that

$|AB|=|BC|=|AC|$ in $\Delta ABC$, thus $\Delta ABC$ is an equilteral triangle.

Likewise,

$|AB|=|BS|=|AS|$ in $\Delta ABS$, thus $\Delta ABS$ is an equilteral triangle.

$|AS|=|SC|=|AC|$ in $\Delta ASC$, thus $\Delta ASC$ is an equilteral triangle.

$|SB|=|BC|=|SC|$ in $\Delta SBC$, thus $\Delta SBC$ is an equilteral triangle.

Since all four faces are equilateral triangles, then tetrahedron $ABCS$ is a regular tetrahedron.



Part (b)

Let's consider a regular tetrahedron in the cartesian space with center at $(0,0,0)$ with $r_c$ as the circumradius.

We can write the coordinates for the four vertices as:

$V_1=\left( \frac{2\sqrt{2}}{3}r_c ,\;0,\;-\frac{r_c}{3}\right)$

$V_2=\left( -\frac{\sqrt{2}}{3}r_c ,\;\frac{\sqrt{6}}{3}r_c,\;\frac{-r_c}{3}\right)$

$V_3=\left( -\frac{\sqrt{2}}{3}r_c ,\;-\frac{\sqrt{6}}{3}r_c,\;\frac{-r_c}{3}\right)$

$V_4=\left(0 ,\;0,\;r_c\right)$

And the midpoints of all edges as:

$M_{12}=\frac{V_1-V_2}{2}=\left( \frac{\sqrt{2}}{6}r_c ,\;\frac{\sqrt{6}}{6}r_c,\;-\frac{r_c}{3}\right)$

$M_{13}=\frac{V_1-V_3}{2}=\left( \frac{\sqrt{2}}{6}r_c ,\;-\frac{\sqrt{6}}{6}r_c,\;-\frac{r_c}{3}\right)$

$M_{23}=\frac{V_2-V_3}{2}=\left( -\frac{\sqrt{2}}{3}r_c ,\;0,\;-\frac{r_c}{3}\right)$

$M_{14}=\frac{V_1-V_4}{2}=\left( \frac{\sqrt{2}}{3}r_c ,\;0,\;\frac{r_c}{3}\right)$

$M_{24}=\frac{V_2-V_4}{2}=\left( -\frac{\sqrt{2}}{6}r_c ,\;\frac{\sqrt{6}}{6}r_c,\;\frac{r_c}{3}\right)$

$M_{34}=\frac{V_3-V_4}{2}=\left( -\frac{\sqrt{2}}{6}r_c ,\;-\frac{\sqrt{6}}{6}r_c,\;\frac{r_c}{3}\right)$

Now we calculate the following six dot products:

$(V_1-V_2) \bullet M_{12}=\left( -\sqrt{2}r_c \right)\left( \frac{\sqrt{2}}{6}r_c \right)+ \left(  \frac{\sqrt{6}}{3}r_c\right)\left( \frac{\sqrt{6}}{6}r_c \right)+ 0=-\frac{1}{3}r_c^2+\frac{1}{3}r_c^2=0$

$(V_1-V_3) \bullet M_{13}=\left( -\sqrt{2}r_c \right)\left( \frac{\sqrt{2}}{6}r_c \right)+ \left(-  \frac{\sqrt{6}}{3}r_c\right)\left( -\frac{\sqrt{6}}{6}r_c \right)+ 0=-\frac{1}{3}r_c^2+\frac{1}{3}r_c^2=0$

$(V_2-V_3) \bullet M_{23}=0+\left(-  \frac{\sqrt{6}}{6}r_c\right)\left( 0\right)+ 0=0$

$(V_1-V_4) \bullet M_{13}=\left( 2\frac{\sqrt{2}}{3}r_c \right)\left( \frac{\sqrt{2}}{3}r_c \right)+0+ \left(-  \frac{4}{3}r_c\right)\left( \frac{1}{3}r_c \right)=\frac{4}{9}r_c^2-\frac{4}{9}r_c^2=0$

$(V_2-V_4) \bullet M_{13}=\left( -\frac{\sqrt{2}}{3}r_c \right)\left( -\frac{\sqrt{2}}{6}r_c \right)+\left( \frac{\sqrt{6}}{3}r_c \right)\left( \frac{\sqrt{6}}{6}r_c \right)+ \left(-  \frac{4}{3}r_c\right)\left( \frac{1}{3}r_c \right)=\frac{1}{9}r_c^2+\frac{1}{3}r_c^2-\frac{4}{9}r_c^2=0$

$(V_3-V_4) \bullet M_{13}=\left( -\frac{\sqrt{2}}{3}r_c \right)\left( -\frac{\sqrt{2}}{6}r_c \right)+\left( -\frac{\sqrt{6}}{3}r_c \right)\left( -\frac{\sqrt{6}}{6}r_c \right)+ \left(-  \frac{4}{3}r_c\right)\left( \frac{1}{3}r_c \right)=\frac{1}{9}r_c^2+\frac{1}{3}r_c^2-\frac{4}{9}r_c^2=0$

Since all these dot producs equal to $0$ that means that the lines from the center to each of the midpoints are all perpendicular.

Now we calculate the distances from $(0,0,0)$ to all the midpoints:

$|M_{12}|=\sqrt{\left( \frac{\sqrt{2}}{6}r_c\right)^2+\left(\frac{\sqrt{6}}{6}r_c\right)^2+\left(-\frac{r_c}{3}\right)^2}=\frac{\sqrt{3}}{3}r_c$

$|M_{13}|=\sqrt{\left( \frac{\sqrt{2}}{6}r_c\right)^2+\left(-\frac{\sqrt{6}}{6}r_c\right)^2+\left(-\frac{r_c}{3}\right)^2}=\frac{\sqrt{3}}{3}r_c$

$|M_{23}|=\sqrt{\left( -\frac{\sqrt{2}}{3}r_c\right)^2+\left(0\right)^2+\left(-\frac{r_c}{3}\right)^2}=\frac{\sqrt{3}}{3}r_c$

$|M_{14}|=\sqrt{\left( \frac{\sqrt{2}}{3}r_c\right)^2+\left(0\right)^2+\left(\frac{r_c}{3}\right)^2}=\frac{\sqrt{3}}{3}r_c$

$|M_{24}|=\sqrt{\left( -\frac{\sqrt{2}}{6}r_c\right)^2+\left(\frac{\sqrt{6}}{6}r_c\right)^2+\left(\frac{r_c}{3}\right)^2}=\frac{\sqrt{3}}{3}r_c$

$|M_{34}|=\sqrt{\left( -\frac{\sqrt{2}}{6}r_c\right)^2+\left(-\frac{\sqrt{6}}{6}r_c\right)^2+\left(\frac{r_c}{3}\right)^2}=\frac{\sqrt{3}}{3}r_c$

Since all distances are all the same and all dot products are $0$, then we have our first sphere at $(0,0,0)$ with a radius of $\frac{\sqrt{3}}{3}r_c$

Now we will look at the other 4 spheres.

Let $E_{ij}$ be the point of tangent of the larger sphere on the extension of line $V{i}V{j}$ in the direction of $V{i}$ to $V{j}$ and beyond $V{j}$ for $i=1,2,3,4$; $j=1,2,3,4$; and $i \ne j$

Since $|V_j E_{ij}|=|V_j M_{ij}|=\frac{1}{2} |V_j V_i|$, then $\frac{1}{2}(V_j-V_i)=E_{ij}-V_j$, thus $E_{ij}=\frac{3V_j-V_i}{2}$

Using this formula we calculate the following:

$E_{41}=\left( \sqrt{2} r_c ,\;0,\;-r_c \right)$

$E_{42}=\left( -\frac{\sqrt{2}}{2}r_c ,\;\frac{\sqrt{6}}{2}r_c,\;-r_c \right)$

$E_{43}=\left( -\frac{\sqrt{2}}{2}r_c ,\;-\frac{\sqrt{6}}{2}r_c,\;-r_c \right)$

We will start with the sphere below the base of the tetrahedron opposite of vertex $V_{4}$ below $\Delta V{1}V{2}V{3}$

The center of this larger sphere is at $C_1=(0,0,-2r_c)$ and it is tangent at points $M_{12}, M_{13}, M_{23}, E_{41}, E_{42}, E_{43}$

We calculate the following dot products:

$(V_1-V_2) \bullet (M_{12}-C_1)=\left( -\sqrt{2}r_c \right)\left( \frac{\sqrt{2}}{6}r_c \right)+ \left(  \frac{\sqrt{6}}{3}r_c\right)\left( \frac{\sqrt{6}}{6}r_c \right)+ 0=-\frac{1}{3}r_c^2+\frac{1}{3}r_c^2=0$

$(V_1-V_3) \bullet (M_{13}-C_1)=\left( -\sqrt{2}r_c \right)\left( \frac{\sqrt{2}}{6}r_c \right)+ \left(-  \frac{\sqrt{6}}{3}r_c\right)\left( -\frac{\sqrt{6}}{6}r_c \right)+ 0=-\frac{1}{3}r_c^2+\frac{1}{3}r_c^2=0$

$(V_2-V_3) \bullet (M_{23}-C_1)=0+\left(-  \frac{\sqrt{6}}{6}r_c\right)\left( 0\right)+ 0=0$

$(E_{41}-V_4) \bullet (E_{41}-C_1) = \left( \sqrt{2}r_c \right)^2+0+\left( -2r_c \right)\left( -r_c+2r_c \right)=2r_c^2-2r_c^2=0$

$(E_{42}-V_4) \bullet (E_{42}-C_1) = \left( -\frac{\sqrt{2}}{2}r_c \right)^2+\left( \frac{\sqrt{6}}{2}r_c \right)^2+\left( -2r_c \right)\left( -r_c+2r_c \right)=2r_c^2-2r_c^2=0$

$(E_{43}-V_4) \bullet (E_{43}-C_1) = \left( -\frac{\sqrt{2}}{2}r_c \right)^2+\left( -\frac{\sqrt{6}}{2}r_c \right)^2+\left( -2r_c \right)\left( -r_c+2r_c \right)=2r_c^2-2r_c^2=0$

Since all these dot producs equal to $0$ that means that the lines from the center $C_1$ to each of the point $M_{12}, M_{13}, M_{23}, E_{41}, E_{42}, E_{43}$ are all perpendicular.

Now we calculate the distances from $C_1=(0,0,-2r_c)$ to points $M_{12}, M_{13}, M_{23}, E_{41}, E_{42}, E_{43}$

$|C_1M_{12}|=\sqrt{\left( \frac{\sqrt{2}}{6}r_c\right)^2+\left(\frac{\sqrt{6}}{6}r_c\right)^2+\left(-\frac{5}{3}r_c\right)^2}=\sqrt{3}r_c$

$|C_1M_{13}|=\sqrt{\left( \frac{\sqrt{2}}{6}r_c\right)^2+\left(-\frac{\sqrt{6}}{6}r_c\right)^2+\left(-\frac{5}{3}r_c\right)^2}=\sqrt{3}r_c$

$|C_1M_{23}|=\sqrt{\left( -\frac{\sqrt{2}}{3}r_c\right)^2+\left(0\right)^2+\left(-\frac{5}{3}r_c\right)^2}=\sqrt{3}r_c$

$|C_1E_{41}|=\sqrt{\left( \sqrt{2}r_c\right)^2+\left(0\right)^2+\left(-r_c\right)^2}=\sqrt{3}r_c$

$|C_1E_{42}|=\sqrt{\left( -\frac{\sqrt{2}}{2}r_c\right)^2+\left(\frac{\sqrt{6}}{2}r_c\right)^2+\left(-r_c\right)^2}=\sqrt{3}r_c$

$|C_1E_{43}|=\sqrt{\left( -\frac{\sqrt{2}}{2}r_c\right)^2+\left(-\frac{\sqrt{6}}{2}r_c\right)^2+\left(-r_c\right)^2}=\sqrt{3}r_c$

Since all distances are all the same and all dot products are $0$, then we have one of the larger spheres at $(0,0,-2r_c)$ with a radius of $\sqrt{3}r_c$

Then, the other three larger spheres which are the same size as the sphere with center at $C_1$ are congruent and tangent to their respective sides near the other faces of the tetrahedron.

and this proves that a tetrahedron with any circumradius $r_c$ will have these 5 spheres, one with radius $\frac{\sqrt{3}}{3}r_c$, at the center of the tetrahedron and the other 4 with radius $\sqrt{3}r_c$ at centers that are at a distance of $3r_c$ away from any of the vertices of the tetrahedron in the direction from that vertex to the center of its opposite face.

Thus these five spheres exist for any regular tetrahedron.",4,"Prove that if a tetrahedron $SABC$ has the property that there exist five spheres tangent to its edge lines, then each of its faces must be an equilateral triangle.","Consider a face, $\triangle ABC$. One of the five spheres intersects the plane of $ABC$ to form its incircle. Another sphere intersects this plane to form an excircle, for instance, one tangent to edge $AB$. For these two circles to arise from spheres tangent to the line containing edge $AB$, they must share the same tangent point. This implies the tangent point must be the midpoint of $AB$. From the properties of an incircle, if the tangent point on $AB$ is its midpoint, then the adjacent sides $AC$ and $BC$ must be equal. Applying this argument to all three edges of $\triangle ABC$ proves it is equilateral.","Prove that if all four faces of a tetrahedron $SABC$ are equilateral triangles, then the tetrahedron is regular.","Applying the result of the first sub-problem to all four faces ($\triangle ABC, \triangle SAB, \triangle SAC, \triangle SBC$), we conclude that each face is an equilateral triangle. Let the side length of $\triangle ABC$ be $l$. Then $|AB|=|BC|=|CA|=l$. Since $\triangle SAB$ is also equilateral, $|SA|=|SB|=|AB|=l$. Similarly, from the other faces, we find that all six edges of the tetrahedron have the same length $l$. A tetrahedron with all six edges of equal length is a regular tetrahedron.","For a regular tetrahedron, prove the existence of an inscribed sphere tangent to all six edges at their midpoints.","In a regular tetrahedron, by symmetry, the geometric center is equidistant from all six edges. The point on each edge closest to the center is the midpoint of that edge. Let this common distance be $r$. A sphere of radius $r$ centered at the geometric center will therefore pass through the midpoints of all six edges. The radius to any midpoint is perpendicular to the corresponding edge. Therefore, this sphere is tangent to each edge at its midpoint. This sphere is one of the five required spheres.","The tetrahedron $SABC$ has the following property: there exist five spheres, each tangent to the edges $SA, SB, SC, BC, CA, AB$, or to their extensions. (a) Prove that the tetrahedron $SABC$ is regular. (b) Prove conversely that for every regular tetrahedron five such spheres exist.","(a) From sub-problem 1, the existence of the five spheres implies each face is an equilateral triangle. From sub-problem 2, a tetrahedron with four equilateral faces is a regular tetrahedron. This proves that the condition implies the tetrahedron is regular. (b) From sub-problem 3, a regular tetrahedron has a central sphere tangent to all six edges. The other four spheres are the escribed spheres of the regular tetrahedron, which are tangent to one face and the extensions of the other three. The existence of these spheres can be confirmed by symmetry and construction, for instance using a coordinate system, thus proving that a regular tetrahedron has five such spheres."
