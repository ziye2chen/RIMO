problem_id,problem,solution,answer,type
2023a1," Professor Oak is feeding his 100 Pokémon. Each Pokémon has a bowl whose capacity is a positive real number of kilograms. These capacities are known to Professor Oak. The total capacity of all the bowls is 100 kilograms. Professor Oak distributes 100 kilograms of food in such a way that each Pokémon receives a non-negative integer number of kilograms of food (which may be larger than the capacity of their bowl). The \emph{dissatisfaction level} of a Pokémon who received $N$ kilograms of food and whose bowl has a capacity of $C$ kilograms is equal to
\[
\lvert N - C \rvert.
\]

Find the smallest real number $D$ such that, regardless of the capacities of the bowls, Professor Oak can distribute the food in a way that the sum of the dissatisfaction levels over all the 100 Pokémon is at most $D$.
","First, consider the situation where 99 bowls have a capacity of 0.5 kilograms and
the last bowl has a capacity of 50.5 kilograms. No matter how Professor Oak distributes the
food, the dissatisfaction level of every Pokémon will be at least 0.5. This amounts to a total
dissatisfaction level of at least 50, proving that $D > 50$.

Now we prove that no matter what the capacities of the bowls are, Professor Oak can always
distribute the food in a way that the total dissatisfaction level is at most 50. We start by fixing
some notation. We number the Pokémon from 1 to 100. Let $C_i > 0$ be the capacity of the bowl
of the $i$th Pokémon. By assumption, 
\[
C_1 + C_2 + \cdots + C_{100} \;=\; 100.
\]
We write
\[
F_i \;=\; C_i \;-\; \lfloor C_i \rfloor
\]
for the fractional part of $C_i$. Without loss of generality, we may assume
\[
F_1 \;\le\; F_2 \;\le\; \cdots \;\le\; F_{100}.
\]
Here is a strategy: Professor Oak starts by giving $\lfloor C_i \rfloor$ kilograms of food to the $i$th
Pokémon.

Let
\[
R \;=\; 100 
   \;-\; \lfloor C_1 \rfloor 
   \;-\; \lfloor C_2 \rfloor 
   \;-\; \cdots 
   \;-\; \lfloor C_{100} \rfloor
   \;=\; F_1 + F_2 + \cdots + F_{100} 
   \;\ge\; 0
\]
be the amount of food left. He continues by giving an extra kilogram of food to the $R$ Pokémon
numbered $100-R+1, 100-R+2, \ldots, 100,$ i.e.\ the Pokémon with the $R$ largest values of $F_i$.
By doing so, Professor Oak distributes all 100 kilograms of food. The total dissatisfaction level
with this strategy is
\[
d \;:=\; F_1 + \cdots + F_{100-R} \;+\; 
         \bigl(1 - F_{100-R+1}\bigr) + \cdots + \bigl(1 - F_{100}\bigr).
\]

We can rewrite
\[
d \;=\; 2\bigl(F_1 + \cdots + F_{100-R}\bigr) 
        \;-\; \bigl(F_1 + \cdots + F_{100}\bigr)
        \;=\; 2\bigl(F_1 + \cdots + F_{100-R}\bigr).
\]
Now, observe that the arithmetic mean of $F_1, F_2, \ldots, F_{100-R}$ is not greater than the
arithmetic mean of $F_1, F_2, \ldots, F_{100}$, because $F_1 \;\le\; F_2 \;\le\; \cdots \;\le\; F_{100}$.
Therefore,
\[
d \;\le\; 2(100 - R)\,\frac{F_1 + \cdots + F_{100}}{100}
        \;=\; 2\,(100 - R)\,\frac{R}{100}.
\]
Finally, we use the AM--GM inequality to see that
\[
R\,(100-R) \;\le\; \frac{100^2}{2^2},
\]
which implies $d \;\le\; 50$. We conclude that there is always a distribution for which the total
dissatisfaction level is at most 50, proving that $D \le 50$.
",50,algebra
2023a2,"Let \(\mathbb{R}\) be the set of real numbers. Let \(f\colon\mathbb{R}\to\mathbb{R}\) be a function such that

\[
f(x+y)f(x-y) \geq f(x)^{2} - f(y)^{2}
\]

for every \(x,y\in\mathbb{R}\). Assume that the inequality is strict for some \(x_{0},y_{0}\in\mathbb{R}\). Find the minimum of the expression
\[ f(x+y)(f(x-y)+f(y-x)) \]","We introduce the new variables \(s:=x+y\) and \(t:=x-y\). Equivalently, \(x=\frac{s+t}{2}\) and \(y=\frac{s-t}{2}\). The inequality becomes

\[
f(s)f(t) \geqslant f\left(\frac{s+t}{2}\right)^{2} - f\left(\frac{s-t}{2}\right)^{2}
\]

for every \(s,t\in\mathbb{R}\). We replace \(t\) by \(-t\) to obtain

\[
f(s)f(-t) \geqslant f\left(\frac{s-t}{2}\right)^{2} - f\left(\frac{s+t}{2}\right)^{2}.
\]

Summing the previous two inequalities gives

\[
f(s)\big{(}f(t) + f(-t)\big{)} \geqslant 0.",0,algebra
2023a5,"Let \(a_1, a_2, \ldots, a_{2023}\) be positive integers such that

- \(a_1, a_2, \ldots, a_{2023}\) is a permutation of \(1, 2, \ldots, 2023\), and
- \(|a_1 - a_2|, |a_2 - a_3|, \ldots, |a_{2022} - a_{2023}|\) is a permutation of \(1, 2, \ldots, 2022\).

Find the minimum value of of \(\max(a_1, a_{2023}) \geq 507\).","For the sake of clarity, we consider and prove the following generalisation of the original problem (which is the case \(N=1012\)):

Let \(N\) be a positive integer and \(a_{1},a_{2},\ldots,a_{2N-1}\) be positive integers such that

- \(a_{1},a_{2},\ldots,a_{2N-1}\) is a permutation of \(1,2,\ldots,2N-1\), and
- \(|a_{1}-a_{2}|,|a_{2}-a_{3}|,\ldots,|a_{2N-2}-a_{2N-1}|\) is a permutation of \(1,2,\ldots,2N-2\).

Then \(a_{1}+a_{2N-1}\geqslant N+1\) and hence \(\max\bigl{(}a_{1},a_{2N-1}\bigr{)}\geqslant\lceil\frac{N+1}{2}\rceil\).

Now we proceed to the proof of the generalised statement. We introduce the notion of _score_ of a number \(a\in\{1,2,\ldots,2N-1\}\). The score of \(a\) is defined to be

\[
s(a):=|a-N|.
\]

Note that, by the triangle inequality,

\[
|a-b|\leqslant|a-N|+|N-b|=s(a)+s(b).
\]

Considering the sum \(|a_{1}-a_{2}|+|a_{2}-a_{3}|+\cdots+|a_{2N-2}-a_{2N-1}|\), we find that

\[
\begin{aligned}
(N-1)(2N-1) &= |a_{1}-a_{2}|+|a_{2}-a_{3}|+\cdots+|a_{2N-2}-a_{2N-1}| \\
&\leqslant 2\bigl{(}s(a_{1})+s(a_{2})+\cdots+s(a_{2N-1})\bigr{)}-\bigl{(}s(a_{1})+s(a_{2N-1})\bigr{)} \\
&= 2N(N-1)-\bigl{(}s(a_{1})+s(a_{2N-1})\bigr{)}.
\end{aligned}
\]

For the last equality we used that the numbers \(s(a_{1}),s(a_{2}),\ldots,s(a_{2N-1})\) are a permutation of \(0,1,1,2,2,\ldots,N-1,N-1\).

Hence, \(s(a_{1})+s(a_{2N-1})\leqslant 2N(N-1)-(N-1)(2N-1)=N-1\). We conclude that

\[
(N-a_{1})+(N-a_{2N-1})\leqslant s(a_{1})+s(a_{2N-1})\leqslant N-1,
\]

which implies \(a_{1}+a_{2N-1}\geqslant N+1\).

**Comment 1.** In the case \(N=1012\), such a sequence with \(\max\bigl{(}a_{1},a_{2023}\bigr{)}=507\) indeed exists:

\[
507,1517,508,1516,\ldots,1011,1013,1012,2023,1,2022,2,\ldots,1518,506.
\]

For a general even number \(N\), a sequence with \(\max\bigl{(}a_{1},a_{2N-1}\bigr{)}=\lceil\frac{N+1}{2}\rceil\) can be obtained similarly. If \(N\geqslant 3\) is odd, the inequality is not sharp, because \(\max(a_{1},a_{2N-1})=\frac{N+1}{2}\) and \(a_{1}+a_{2N-1}\geqslant N+1\) together imply \(a_{1}=a_{2N-1}=\frac{N+1}{2}\), a contradiction.

\[
\max(a_1, a_{2023}) \geq 507.
\]",507,algebra
2023c1,"Let \( m \) and \( n \) be positive integers greater than 1. In each unit square of an \( m \times n \) grid lies a coin with its tail-side up. A move consists of the following steps:

1. select a \( 2 \times 2 \) square in the grid;

2. flip the coins in the top-left and bottom-right unit squares;

3. flip the coin in either the top-right or bottom-left unit square.

Find the greatest positive integer \( k \) such that, whenever it is possible (by a finite sequence of the allowed moves) to flip all coins to heads-up, then \( k \) necessarily divides the product \( m \times n \).","Let us denote by \((i,j)\)-square the unit square in the \(i^{\text{th}}\) row and the \(j^{\text{th}}\) column.

We first prove that when \(3\mid mn\), it is possible to make all the coins show head-side up. For integers \(1\leqslant i\leqslant m-1\) and \(1\leqslant j\leqslant n-1\), denote by \(A(i,j)\) the move that flips the coin in the \((i,j)\)-square, the \((i+1,j+1)\)-square and the \((i,j+1)\)-square. Similarly, denote by \(B(i,j)\) the move that flips the coin in the \((i,j)\)-square, \((i+1,j+1)\)-square, and the \((i+1,j)\)-square. Without loss of generality, we may assume that \(3\mid m\).

_Case 1: \(n\) is even._

We apply the moves

- \(A(3k-2,2l-1)\) for all \(1\leqslant k\leqslant\frac{m}{3}\) and \(1\leqslant l\leqslant\frac{n}{2}\),
- \(B(3k-1,2l-1)\) for all \(1\leqslant k\leqslant\frac{m}{3}\) and \(1\leqslant l\leqslant\frac{n}{2}\).

This process will flip each coin exactly once, hence all the coins will face head-side up afterwards.

_Case 2: \(n\) is odd._

We start by applying

- \(A(3k-2,2l-1)\) for all \(1\leqslant k\leqslant\frac{m}{3}\) and \(1\leqslant l\leqslant\frac{n-1}{2}\),
- \(B(3k-1,2l-1)\) for all \(1\leqslant k\leqslant\frac{m}{3}\) and \(1\leqslant l\leqslant\frac{n-1}{2}\)

as in the previous case. At this point, the coins on the rightmost column have tail-side up and the rest of the coins have head-side up. We now apply the moves

- \(A(3k-2,n-1)\), \(A(3k-1,n-1)\) and \(B(3k-2,n-1)\) for every \(1\leqslant k\leqslant\frac{m}{3}\).

For each \(k\), the three moves flip precisely the coins in the \((3k-2,n)\)-square, the \((3k-1,n)\)-square, and the \((3k,n)\)-square. Hence after this process, every coin will face head-side up.

We next prove that \(mn\) being divisible by \(3\) is a necessary condition. We first label the \((i,j)\)-square by the remainder of \(i+j-2\) when divided by \(3\), as shown in the figure.

\begin{tabular}{|c|c|c|c|c|} \hline
0 & 1 & 2 & 0 & \(\cdots\) \\ \hline
1 & 2 & 0 & 1 & \(\cdots\) \\ \hline
2 & 0 & 1 & 2 & \(\cdots\) \\ \hline
0 & 1 & 2 & 0 & \(\cdots\) \\ \hline
\(\vdots\) & \(\vdots\) & \(\vdots\) & \(\vdots\) & \(\ddots\) \\ \hline
\end{tabular}

Let \(T(c)\) be the number of coins facing head-side up in those squares whose label is \(c\). The main observation is that each move does not change the parity of both \(T(0)-T(1)\) and \(T(1)-T(2)\), since a move flips exactly one coin in a square with each label. Initially, all coins face tail-side up at the beginning, thus all of \(T(0),T(1),T(2)\) are equal to \(0\). Hence it follows that any configuration that can be achieved from the initial state must satisfy the parity condition of

\[
T(0)\equiv T(1)\equiv T(2)\pmod{2}.
\]

We now calculate the values of \(T\) for the configuration in which all coins are facing head-side up.

- When \(m\equiv n\equiv 1\pmod{3}\), we have \(T(0)-1=T(1)=T(2)=\frac{mn-1}{3}\).
- When \(m\equiv 1\pmod{3}\) and \(n\equiv 2\pmod{3}\), or \(m\equiv 2\pmod{3}\) and \(n\equiv 1\pmod{3}\), we have \(T(0)-1=T(1)-1=T(2)=\frac{mn-2}{3}\).
- When \(m\equiv n\equiv 2\pmod{3}\), we have \(T(0)=T(1)-1=T(2)=\frac{mn-1}{3}\).
- When \(m\equiv 0\pmod{3}\) or \(n\equiv 0\pmod{3}\), we have \(T(0)=T(1)=T(2)=\frac{mn}{3}\).

From this calculation, we see that \(T(0)\), \(T(1)\) and \(T(2)\) has the same parity only when \(mn\) is divisible by \(3\).",3,combinatorics
2023c2,"Determine the maximal length \( L \) of a sequence \( a_1, \ldots, a_L \) of positive integers satisfying both the following properties:

- every term in the sequence is less than or equal to \( 2^{2023} \), and
- there does not exist a consecutive subsequence \( a_i, a_{i+1}, \ldots, a_j \) (where \( 1 \leq i \leq j \leq L \)) with a choice of signs \( s_i, s_{i+1}, \ldots, s_j \in \{1, -1\} \) for which
  \[  s_i a_i + s_{i+1} a_{i+1} + \cdots + s_j a_j = 0.\]

Take the problem solution modulo 1000.","We prove more generally that the answer is \(2^{k+1}-1\) when \(2^{2023}\) is replaced by \(2^{k}\) for an arbitrary positive integer \(k\). Write \(n=2^{k}\).

We first show that there exists a sequence of length \(L=2n-1\) satisfying the properties. For a positive integer \(x\), denote by \(v_{2}(x)\) the maximal nonnegative integer \(v\) such that \(2^{v}\) divides \(x\). Consider the sequence \(a_{1},\ldots,a_{2n-1}\) defined as

\[
a_{i}=2^{k-v_{2}(i)}.
\]

For example, when \(k=2\) and \(n=4\), the sequence is

\[
4,2,4,1,4,2,4.
\]

This indeed consists of positive integers less than or equal to \(n=2^{k}\), because \(0\leqslant v_{2}(i)\leqslant k\) for \(1\leqslant i\leqslant 2^{k+1}-1\).

_Claim 1._ This sequence \(a_{1},\ldots,a_{2n-1}\) does not have a consecutive subsequence with a choice of signs such that the signed sum equals zero.

Proof.: Let \(1\leqslant i\leqslant j\leqslant 2n-1\) be integers. The main observation is that amongst the integers

\[
i,i+1,\ldots,j-1,j,
\]

there exists a unique integer \(x\) with the maximal value of \(v_{2}(x)\). To see this, write \(v=\max(v_{2}(i),\ldots,v_{2}(j))\). If there exist at least two multiples of \(2^{v}\) amongst \(i,i+1,\ldots,j\), then one of them must be a multiple of \(2^{v+1}\), which is a contradiction.

Therefore there is exactly one \(i\leqslant x\leqslant j\) with \(v_{2}(x)=v\), which implies that all terms except for \(a_{x}=2^{k-v}\) in the sequence

\[
a_{i},a_{i+1},\ldots,a_{j}
\]

are a multiple of \(2^{k-v+1}\). The same holds for the terms \(s_{i}a_{i},s_{i+1}a_{i+1},\ldots,s_{j}a_{j}\), hence the sum cannot be equal to zero. 

We now prove that there does not exist a sequence of length \(L\geqslant 2n\) satisfying the conditions of the problem. Let \(a_{1},\ldots,a_{L}\) be an arbitrary sequence consisting of positive integers less than or equal to \(n\). Define a sequence \(s_{1},\ldots,s_{L}\) of signs recursively as follows:

- when \(s_{1}a_{1}+\cdots+s_{i-1}a_{i-1}\leqslant 0\), set \(s_{i}=+1\),
- when \(s_{1}a_{1}+\cdots+s_{i-1}a_{i-1}\geqslant 1\), set \(s_{i}=-1\).

Write

\[
b_{i}=\sum_{j=1}^{i}s_{i}a_{i}=s_{1}a_{1}+\cdots+s_{i}a_{i},
\]

and consider the sequence

\[
0=b_{0},b_{1},b_{2},\ldots,b_{L}.
\]

_Claim 2._ All terms \(b_{i}\) of the sequence satisfy \(-n+1\leqslant b_{i}\leqslant n\).

Proof.: We prove this by induction on \(i\). It is clear that \(b_{0}=0\) satisfies \(-n+1\leqslant 0\leqslant n\). We now assume \(-n+1\leqslant b_{i-1}\leqslant n\) and show that \(-n+1\leqslant b_{i}\leqslant n\).

_Case 1:_\(-n+1\leqslant b_{i-1}\leqslant 0\).

Then \(b_{i}=b_{i-1}+a_{i}\) from the definition of \(s_{i}\), and hence

\[
-n+1\leqslant b_{i-1}<b_{i-1}+a_{i}\leqslant b_{i-1}+n\leqslant n.
\]

_Case 2:_\(1\leqslant b_{i-1}\leqslant n\).

Then \(b_{i}=b_{i-1}-a_{i}\) from the definition of \(s_{i}\), and hence

\[
-n+1\leqslant b_{i-1}-n\leqslant b_{i-1}-a_{i}<b_{i-1}\leqslant n.
\]

This finishes the proof. 

Because there are \(2n\) integers in the closed interval \([-n+1,n]\) and at least \(2n+1\) terms in the sequence \(b_{0},b_{1},\ldots,b_{L}\) (as \(L+1\geqslant 2n+1\) by assumption), the pigeonhole principle implies that two distinct terms \(b_{i-1},b_{j}\) (where \(1\leqslant i\leqslant j\leqslant L\)) must be equal. Subtracting one from another, we obtain

\[
s_{i}a_{i}+\cdots+s_{j}a_{j}=b_{j}-b_{i-1}=0
\]

as desired.

**Comment.** The same argument gives a bound \(L\leqslant 2n-1\) that works for all \(n\), but this bound is not necessarily sharp when \(n\) is not a power of \(2\). For instance, when \(n=3\), the longest sequence has length \(L=3\).",215,combinatorics
2023c3,"Let \( n \) be a positive integer. We arrange \( 1 + 2 + \cdots + n \) circles in a triangle with \( n \) rows, such that the \( i^th \) row contains exactly \( i \) circles. 

In this triangle, a *ninja-path* is a sequence of circles obtained by repeatedly going from a circle to one of the two circles directly below it. In terms of \( n = 200 \), find the largest value of \( k \) such that if one circle from every row is coloured red, we can always find a ninja-path in which at least \( k \) of the circles are red.

","Write \(N=\lfloor\log_{2}n\rfloor\) so that we have \(2^{N}\leqslant n\leqslant 2^{N+1}-1\).

We first provide a construction where every ninja-path passes through at most \(N+1\) red circles. For the row \(i=2^{a}+b\) for \(0\leqslant a\leqslant N\) and \(0\leqslant b<2^{a}\), we colour the \((2b+1)^{\text{th}}\) circle.

Then every ninja-path passes through at most one red circle in each of the rows \(2^{a},2^{a}+1,\ldots,2^{a+1}-1\) for each \(0\leqslant a\leqslant N\). It follows that every ninja-path passes through at most \(N+1\) red circles.

We now prove that for every colouring, there exists a ninja-path going through at least \(N+1\) red circles. For each circle \(C\), we assign the maximum number of red circles in a ninja-path that starts at the top of the triangle and ends at \(C\).

Note that

- if \(C\) is not red, then the number assigned to \(C\) is the maximum of the number assigned to the one or two circles above \(C\), and
- if \(C\) is red, then the number assigned to \(C\) is one plus the above maximum.

Write \(v_{1},\ldots,v_{i}\) for the numbers in row \(i\), and let \(v_{m}\) be the maximum among these numbers. Then the numbers in row \(i+1\) will be at least

\[
v_{1},\ldots,v_{m-1},v_{m},v_{m},v_{m+1},\ldots,v_{i},
\]

not taking into account the fact that one of the circles in row \(i+1\) is red. On the other hand, for the red circle in row \(i+1\), the lower bound on the assigned number can be increased by \(1\). Therefore the sum of the numbers in row \(i+1\) is at least

\[
(v_{1}+\cdots+v_{i})+v_{m}+1.
\]

Using this observation, we prove the following claim.

_Claim 1._ Let \(\sigma_{k}\) be the sum of the numbers assigned to circles in row \(k\). Then for \(0\leqslant j\leqslant N\), we have \(\sigma_{2^{j}}\geqslant j\cdot 2^{j}+1\).

Proof.: We use induction on \(j\). This is clear for \(j=0\), since the number in the first row is always \(1\). For the induction step, suppose that \(\sigma_{2^{j}}\geqslant j\cdot 2^{j}+1\). Then the maximum value assigned to a circle in row \(2^{j}\) is at least \(j+1\). As a consequence, for every \(k\geqslant 2^{j}\), there is a circle on row \(k\) with number at least \(j+1\). Then by our observation above, we have

\[
\sigma_{k+1}\geqslant\sigma_{k}+(j+1)+1=\sigma_{k}+(j+2).
\]

Then we get

\[
\sigma_{2^{j+1}}\geqslant\sigma_{2^{j}}+2^{j}(j+2)\geqslant j\cdot 2^{j}+1+2^ {j}(j+2)=(j+j+2)2^{j}+1=(j+1)2^{j+1}+1.
\]

This completes the inductive step. 

For \(j=N\), this immediately implies that some circle in row \(2^{N}\) has number at least \(N+1\). This shows that there is a ninja-path passing through at least \(N+1\) red circles.

The maximum value is \( k = 1 + \lfloor \log_2 n \rfloor \).  \(k=8\) when \(n=200\).",8,combinatorics
2023c4,"Let \( n \geq 2 \) be a positive integer. Paul has a \( 1 \times n^2 \) rectangular strip consisting of \( n^2 \) unit squares, where the \( i^{th} \) square is labelled with \( i \) for all \( 1 \leq i \leq n^2 \). He wishes to cut the strip into several pieces, where each piece consists of a number of consecutive unit squares, and then translate (without rotating or flipping) the pieces to obtain an \( n \times n \) square satisfying the following property: if the unit square in the \( i^{th} \) row and \( j^{th} \) column is labelled with \( a_{ij} \), then \( a_{ij} - (i + j - 1) \) is divisible by \( n \).

Determine the smallest number of pieces Paul needs to make in order to accomplish this when \(n = 100\)","For the entirety of the solution, we shall view the labels as taking values in \(\mathbb{Z}/n\mathbb{Z}\), as only their values modulo \(n\) play a role. Here are two possible constructions consisting of \(2n-1\) pieces.

1. Cut into pieces of sizes \(n,1,n,1,\ldots,n,1,1\), and glue the pieces of size 1 to obtain the last row.

2. Cut into pieces of sizes \(n,1,n-1,2,n-2,\ldots,n-1,1\), and switch the pairs of consecutive strips that add up to size \(n\).

We now prove that using \(2n-1\) pieces is optimal. It will be more helpful to think of the reverse process: start with \(n\) pieces of size \(1\times n\), where the \(k^{\text{th}}\) piece has squares labelled \(k,k+1,\ldots,k+n-1\). The goal is to restore the original \(1\times n^{2}\) strip.

Note that each piece, after cutting at appropriate places, is of the form \(a,a+1,\ldots,b-1\). Construct an (undirected but not necessarily simple) graph \(\Gamma\) with vertices labelled by \(1,\ldots,n\), where a piece of the form \(a,a+1,\ldots,b-1\) corresponds to an edge from \(a\) to \(b\). We make the following observations.

- The cut pieces came from the \(k^{\text{th}}\) initial piece \(k,k+1,\ldots,k+n-1\) corresponds to a cycle \(\gamma_{k}\) (possibly of length 1) containing the vertex \(k\).

- Since it is possible to rearrange the pieces into one single \(1\times n^{2}\) strip, the graph \(\Gamma\) has an Eulerian cycle.

- The number of edges of \(\Gamma\) is equal to the total number of cut pieces.

The goal is to prove that \(\Gamma\) has at least \(2n-1\) edges. Since \(\Gamma\) has an Eulerian cycle, it is connected. For every \(1\leq k\leq n\), pick one edge from \(\gamma_{k}\), delete it from \(\Gamma\) to obtain a new graph \(\Gamma^{\prime}\). Since no two cycles \(\gamma_{i}\) and \(\gamma_{j}\) share a common edge, removing one edge from each cycle does not affect the connectivity of the graph. This shows that the new graph \(\Gamma^{\prime}\) must also be connected. Therefore \(\Gamma^{\prime}\) has at least \(n-1\) edges, which means that \(\Gamma\) has at least \(2n-1\) edges. When \(n=100\), the minimum number of pieces is \(199\).",199,combinatorics
2023c6,"Let \( N \) be a positive integer, and consider an \( N \times N \) grid. A right-down path is a sequence of grid cells such that each cell is either one cell to the right of or one cell below the previous cell in the sequence. A right-up path is a sequence of grid cells such that each cell is either one cell to the right of or one cell above the previous cell in the sequence. Calculate the minimum number of right-down or right-up paths that the cells of the \( 100 \times 100 \) grid can partition into.
","We apply an induction on \(N\). The base case \(N=1\) is trivial. Suppose that the claim holds for \(N-1\) and prove it for \(N\geqslant 2\).

Let us denote the path containing the upper left corner by \(P\). If \(P\) is right-up, then every cell in \(P\) is in the top row or in the leftmost column. By the induction hypothesis, there are at least \(N-1\) paths passing through the lower right \((N-1)\times(N-1)\) subgrid. Since \(P\) is not amongst them, we have at least \(N\) paths.

Next, assume that \(P\) is right-down. If \(P\) contains the lower right corner, then we get an \((N-1)\times(N-1)\) grid by removing \(P\) and glueing the remaining two parts together. The main idea is to extend \(P\) so that it contains the lower right corner and the above procedure gives a valid partition of an \((N-1)\times(N-1)\) grid.

We inductively construct \(Q\), which denotes an extension of \(P\) as a right-down path. Initially, \(Q=P\). Let \(A\) be the last cell of \(Q\), \(B\) be the cell below \(A\), and \(C\) be the cell to the right of \(A\) (if they exist). Suppose that \(A\) is not the lower right corner, and that \((*)\) both \(B\) and \(C\) do not belong to the same path as \(A\). Then, we can extend \(Q\) as follows (in case we have two or more options, we can choose any one of them to extend \(Q\)).

1. If \(B\) belongs to a right-down path \(R\), then we add the part of \(R\), from \(B\) to its end, to \(Q\).

2. If \(C\) belongs to a right-down path \(R\), then we add the part of \(R\), from \(C\) to its end, to \(Q\).

3. If \(B\) belongs to a right-up path \(R\) which ends at \(B\), then we add the part of \(R\) in the same column as \(B\) to \(Q\).

4. If \(C\) belongs to a right-up path \(R\) which starts at \(C\), then we add the part of \(R\) in the same row as \(C\) to \(Q\).

5. Otherwise, \(B\) and \(C\) must belong to the same right-up path \(R\). In this case, we add \(B\) and the cell to the right of \(B\) to \(Q\).

Note that if \(B\) does not exist, then case (4) must hold. If \(C\) does not exist, then case (3) must hold.

It is easily seen that such an extension also satisfies the hypothesis \((*)\), so we can repeat this construction to get an extension of \(P\) containing the lower right corner, denoted by \(Q\). We show that this is a desired extension, i.e. the partition of an \((N-1)\times(N-1)\) grid obtained by removing \(Q\) and glueing the remaining two parts together consists of right-down or right-up paths.

Take a path \(R\) in the partition of the \(N\times N\) grid intersecting \(Q\). If the intersection of \(Q\) and \(R\) occurs in case (1) or case (2), then there exists a cell \(D\) in \(R\) such that the intersection of \(Q\) and \(R\) is the part of \(R\) from \(D\) to its end, so \(R\) remains a right-down path after removal of \(Q\). Similarly, if the intersection of \(Q\) and \(R\) occurs in case (3) or case (4), then \(R\) remains a right-up path after removal of \(Q\). If the intersection of \(Q\) and \(R\) occurs in case (5), then this intersection has exactly two adjacent cells. After the removal of these two cells (as we remove \(Q\)), \(R\) is divided into two parts that are glued into a right-up path.

Thus, we may apply the induction hypothesis to the resulting partition of an \((N-1)\times(N-1)\) grid, to find that it must contain at least \(N-1\) paths. Since \(P\) is contained in \(Q\) and is not amongst these paths, the original partition must contain at least \(N\) paths.
So the minimum number is 100.",100,combinatorics
2023c7,"The Inomi archipelago consists of \( n \geq 2 \) islands. Between each pair of distinct islands is a unique ferry line that runs in both directions, and each ferry line is operated by one of \( k \) companies. It is known that if any one of the \( k \) companies closes all its ferry lines, then it becomes impossible for a traveller, no matter where the traveller starts at, to visit all the islands exactly once (in particular, not returning to the island the traveller started at). Determine the maximal possible value of \( k \) in terms of \( n=200 \).","We reformulate the problem using graph theory. We have a complete graph \( K_n \) on \( n \) nodes (corresponding to islands), and we want to colour the edges (corresponding to ferry lines) with \( k \) colours (corresponding to companies), so that every Hamiltonian path contains all \( k \) different colours. For a fixed set of \( k \) colours, we say that an edge colouring of \( K_n \) is good if every Hamiltonian path contains an edge of each one of these \( k \) colours.

We first construct a good colouring of \( K_n \), using \( k = \lfloor \log_2 n \rfloor \) colours.

**Claim 1.** Take \( k = \lfloor \log_2 n \rfloor \). Consider the complete graph \( K_n \) in which the nodes are labelled by \( 1, 2, \ldots, n \). Colour node \( i \) with colour \( \min(\lfloor \log_2 i \rfloor + 1, k) \) (so the colours of the first nodes are \( 1, 2, 2, 3, 3, 3, 3, 4, \ldots \) and the last \( n - 2^{k-1} + 1 \) nodes have colour \( k \)), and for \( 1 < i < j < n \), colour the edge \( ij \) with the colour of node \( i \). Then the resulting edge colouring of \( K_n \) is good.

**Proof.** We need to check that every Hamiltonian path contains edges of every single colour. We first observe that the number of nodes assigned colour \( k \) is \( n - 2^{k-1} + 1 \). Since \( n \geq 2^k \), we have
\[
n - 2^{k-1} + 1 \geq 2^{k-1} + 1.
\]
This implies that in any Hamiltonian path, there exists an edge between two nodes with colour \( k \). Then that edge must have colour \( k \).

We next show that for each \( 1 \leq i \leq k \), every Hamiltonian path contains an edge of colour \( i \). Suppose the contrary, that some Hamiltonian path does not contain an edge of colour \( i \). Then nodes with colour \( i \) can only be adjacent to nodes with colour less than \( i \) inside the Hamiltonian path. Since there are \( 2^{i-1} \) nodes with colour \( i \) and \( 2^{i-1} - 1 \) nodes with colour less than \( i \), the Hamiltonian path must take the form
\[
(<i) \leftrightarrow (<i) \leftrightarrow \cdots \leftrightarrow (<i) \leftrightarrow (i) \leftrightarrow (i) \leftrightarrow \cdots \leftrightarrow (i),
\]
where \( (i) \) denotes a node with colour \( i \), \( (<i) \) denotes a node with colour less than \( i \), and \( \leftrightarrow \) denotes an edge. But this is impossible, as the Hamiltonian path would not have any nodes with colours greater than \( i \). So the maximal possible value of \( k=7 \) in terms of \( n=200 \).",7,combinatorics
2023g6,"Let \( ABC \) be an acute-angled triangle with circumcircle \( \omega \). A circle \( \Gamma \) is internally tangent to \( \omega \) at \( A \) and also tangent to \( BC \) at \( D \). Let \( AB \) and \( AC \) intersect \( \Gamma \) at \( P \) and \( Q \) respectively. Let \( M \) and \( N \) be points on line \( BC \) such that \( B \) is the midpoint of \( DM \) and \( C \) is the midpoint of \( DN \). Lines \( MP \) and \( NQ \) meet at \( K \) and intersect \( \Gamma \) again at \( I \) and \( J \) respectively. The ray \( KA \) meets the circumcircle of triangle \( IJK \) at \( X \neq K \). Calculate 
\[
\frac{\angle BXP + \angle BXC}{\angle A}
\]","Let \( MP \) and \( NQ \) intersect \( AD \) at \( K_1 \) and \( K_2 \) respectively. By applying Menelaus’ theorem to triangle \( ABD \) and line \( MPK_1 \), we have
\[
\frac{AK_1}{K_1D} = \frac{AP}{PB} \cdot \frac{BM}{MD} = \frac{AP}{2PB}
\]
and similarly
\[
\frac{AK_2}{K_2D} = \frac{AQ}{2QC}.
\]
A homothety at \( A \) takes \( \Gamma \to \omega \) and \( D \) to the midpoint of arc \( BC \) not containing \( A \), so \( PQ \parallel BC \) and \( AD \) bisects \( \angle BAC \). Thus
\[
\frac{AK_1}{K_1D} = \frac{AP}{2PB} = \frac{AQ}{2QC} = \frac{AK_2}{K_2D},
\]
which implies \( K_1 \equiv K_2 \), and \( K \) lies on \( AD \).

Then we obtain
\[
\angle JXD = \angle JXK = \angle JIK = \angle JIP = \angle JQP = \angle JND,
\]
where the last equality follows from \( PQ \parallel BC \). This shows \( JXND \) is cyclic and hence
\[
\angle DXN = \angle DJN = \angle DJQ = \angle DAQ = \angle DAC,
\]
which shows \( AC \parallel XN \). As \( C \) is the midpoint of \( DN \), \( A \) is the midpoint of \( XD \).

Now observe that
\[
\angle ADP = \angle AQP = \angle ACB \quad \text{and} \quad \angle PAD = \angle DAC = \frac{\angle A}{2},
\]
so triangle \( APD \) and \( ADC \) are similar. Therefore we have
\[
\frac{CD}{DP} = \frac{AD}{AP} = \frac{XA}{AP},
\]
and also have
\[
\angle CDP = 180^\circ - \angle PDB = 180^\circ - \angle PAD = \angle XAP.
\]

Combining the two results gives triangles \( PDC \) and \( PAX \) are similar, which shows \( P \) is the centre of spiral similarity taking \( CD \to XA \). Hence also triangles \( PXC \) and \( PAD \) are similar which shows
\[
\angle PXC = \angle PAD = \frac{\angle A}{2}.
\]
This gives
\[
\angle BXP = \angle BXC - \angle PXC = \angle BXC - \frac{\angle A}{2}.
\]",2,geometry
2023g8,"Let \( ABC \) be an equilateral triangle. Points \( A_1, B_1, C_1 \) lie inside triangle \( ABC \) such that triangle \( A_1B_1C_1 \) is scalene, \( BA_1 = A_1C \), \( CB_1 = B_1A \), \( AC_1 = C_1B \) and  
\[ \angle BA_1C + \angle CB_1A + \angle AC_1B = 480^\circ. \]  
Lines \( BC_1 \) and \( CB_1 \) intersect at \( A_2 \); lines \( CA_1 \) and \( AC_1 \) intersect at \( B_2 \); and lines \( AB_1 \) and \( BA_1 \) intersect at \( C_2 \).  

How many common points do the circumcircles of triangles \( AA_1A_2, BB_1B_2, CC_1C_2 \) have?","Let \(\delta_{A}, \delta_{B}, \delta_{C}\) be the circumcircles of \(\triangle AA_1A_2\), \(\triangle BB_1B_2\), \(\triangle CC_1C_2\). The general strategy of the solution is to find two different points having equal power with respect to \(\delta_{A}, \delta_{B}, \delta_{C}\).

_Claim._ \(A_1\) is the circumcentre of \(A_2BC\) and cyclic variations.

_Proof._ Since \(A_1\) lies on the perpendicular bisector of \(BC\) and inside \(\triangle BA_1C\), it suffices to prove \(\angle BA_1C = 2\angle BA_2C\). This follows from
\[
\angle BA_1C = \angle AB_1A + \angle BAC + \angle ACA_2 = \frac{1}{2}\left((180^\circ - \angle AC_1B) + (180^\circ - \angle CB_1A)\right) + 60^\circ = 240^\circ - \frac{1}{2}(480^\circ - \angle BA_1C) = \frac{1}{2}\angle BA_1C.
\]

The circumcentres above give
\[
\angle B_1B_2C_1 = \angle B_1B_2A - \angle B_2AB_1 = \angle C_1AC_2 = \angle AC_2C_1 = \angle B_1C_2C_1,
\]
and so \(B_1C_1B_2C_2\) is cyclic. Likewise \(C_1A_1C_2A_2\) and \(A_1B_1A_2B_2\) are cyclic. Note that hexagon \(A_1B_2C_1A_2B_1C_2\) is not cyclic since
\[
\angle C_2A_1B_2 + \angle B_2C_1A_2 + \angle A_2B_1C_2 = 480^\circ + 360^\circ.
\]

Thus we can apply the radical axis theorem to the three circles to show that \(A_1A_2, B_1B_2, C_1C_2\) concur at a point \(X\) and this point has equal power with respect to \(\delta_{A}, \delta_{B}, \delta_{C}\).

Let the circumcircle of \(\triangle A_2BC\) meet \(\delta_{A}\) at \(A_2' \neq A_2\). Define \(B_2'\) and \(C_2'\) similarly.

_Claim._ \(BCB_2'C_2'\) is cyclic.

_Proof._ Using directed angles,
\[
\angle BC_2'C = \angle BC_2'C_2 + \angle CC_2'C = \angle BA_2'C_2 + \angle CC_2'C = 80^\circ + \angle(C_1C_2'AC_2) + \angle CC_2'C = 90^\circ + \angle CC_2'B_1.
\]
Similarly, \(\angle CB_2'B = 80^\circ + \angle B_1B_2'C_1\). Hence, using \(B_1C_1B_2'C_2'\) cyclic,
\[
\angle BB_2'C = 90^\circ + \angle C_1B_2'B_1 = 90^\circ + \angle CC_2'B_1 = \angle BC_2'C,
\]
as required.

Similarly, \(CAC_2'A_2'\) and \(ABBA_2'B_2'\) are cyclic. \(AC_2'BA_2'CB_2'\) is not cyclic because then \(AB_2'CB_2'\) cyclic would mean \(B_2'\) lies on \(\triangle ABC\) which is impossible since \(B_2'\) lies inside \(\triangle ABC\). Thus we can apply the radical axis theorem to the three circles to get \(AA_1, BB_2, CC_2\) concur at a point \(Y\) which has equal power with respect to \(\delta_{A}, \delta_{B}, \delta_{C}\).

We now make some technical observations before finishing.

- Let \(O\) be the centre of \(\triangle ABC\). We have that
\[
\angle BA_1C = 480^\circ - \angle CB_1A - \angle AC_1B > 480^\circ - 180^\circ - 180^\circ = 120^\circ,
\]
so \(A_1\) lies inside \(\triangle BOC\). We have similar results for \(B_1, C_1\) and thus \(\triangle BA_1C\), \(\triangle CB_1A\), \(\triangle AC_1B\) have disjoint interiors. It follows that \(A_1B_2C_1A_2B_1C_2\) is a convex hexagon, thus \(X\) lies on segment \(A_1A_2\) and therefore is inside \(\delta_{A}\).

- Since \(A_1\) is the centre of \(A_2BC\), we have that \(A_1A_2 = A_1A_2'\), so from cyclic quadrilateral \(A_1A_2A_1'A_2'\), we get that lines \(A_2A_2'\) and \(A_2'A_2 = A_1Y\) are adjacent in line \(A_2A_2'\). As \(X\) lies on segment \(A_1A_2\), the only way \(X = Y\) is if \(A_1\) and \(A_2\) both lie on the perpendicular bisector of \(BC\). But this forces \(B_1\) and \(C_1\) to also be reflections in this line, meaning \(A_1B_1 = A_1C_1\), contradicting the scalene condition.

Summarizing, we have distinct points \(X, Y\) with equal power with respect to \(\delta_{A}, \delta_{B}, \delta_{C}\), thus these circles have a common radical axis. As \(X\) lies inside \(\delta_{A}\) (and similarly \(\delta_{B}, \delta_{C}\)), this radical axis intersects the circles at two points, and so \(\delta_{A}, \delta_{B}, \delta_{C}\) have two points in common.",2,geometry
2023n2,"All pairs \((a, p)\) of positive integers with \(p\) prime such that \(p^a + a^4\) is a perfect square.  Calculate the sum of the quantity 
\[ (a+p) \] over every such pair.","Let \( p^a + a^4 = b^2 \) for some positive integer \( b \). Then we have
\[
p^a = b^2 - a^4 = (b + a^2)(b - a^2).
\]
Hence both \( b + a^2 \) and \( b - a^2 \) are powers of \( p \).

Let \( b - a^2 = p^x \) for some integer \( x \). Then \( b + a^2 = p^{a-x} \) and \( a - x > x \). Therefore, we have
\[
2a^2 = (b + a^2) - (b - a^2) = p^{a-x} - p^x = p^x(p^{a-2x} - 1).
\]
(1)

We shall consider two cases according to whether \( p = 2 \) or \( p \neq 2 \). We let \( v_p(m) \) denote the \( p \)-adic valuation of \( m \).

**Case 1 (\( p = 2 \)):** In this case,
\[
a^2 = 2^{x-1}(2^{a-2x} - 1) = 2^{2v_2(a)}(2^{a-2x} - 1),
\]
where the first equality comes from (1) and the second one from \( \gcd(2, 2^{a-2x} - 1) = 1 \). So, \( 2^{a-2x} - 1 \) is a square.

If \( v_2(a) > 0 \), then \( 2^{a-2x} \) is also a square. So, \( 2^{a-2x} - 1 = 0 \), and \( a = 0 \) which is a contradiction.

If \( v_2(a) = 0 \), then \( x = 1 \), and \( a^2 = 2^{a-2} - 1 \). If \( a \geq 4 \), the right-hand side is congruent to 3 modulo 4, thus cannot be a square. It is easy to see that \( a = 1, 2, 3 \) do not satisfy this condition.

Therefore, we do not get any solutions in this case.

**Case 2 (\( p \neq 2 \)):** In this case, we have \( 2v_p(a) = x \). Let \( m = v_p(a) \). Then we have \( a^2 = p^{2m} \cdot n^2 \) for some integer \( n \geq 1 \). So, \( 2n^2 = p^{a-2x} - 1 = p^{m-n-4m} - 1 \).

We consider two subcases.

**Subcase 2-1 (\( p \geq 5 \)):** By induction, one can easily prove that \( p^m \geq 5^m > 4m \) for all \( m \). Then we have
\[
2n^2 + 1 = p^{m-n-4m} > p^{m-n-p^m} \geq 5^{5^m(n-1)} \geq 5^{n-1}.
\]
But, by induction, one can easily prove that \( 5^{n-1} > 2n^2 + 1 \) for all \( n \geq 3 \). Therefore, we conclude that \( n = 1 \) or \( 2 \). If \( n = 1 \) or \( 2 \), then \( p = 3 \), which is a contradiction. So there are no solutions in this subcase.

**Subcase 2-2 (\( p = 3 \)):** Then we have \( 2n^2 + 1 = 3^{3^m-n-4m} \). If \( m \geq 2 \), one can easily prove by induction that \( 3^m > 4m \). Then we have
\[
2n^2 + 1 = 3^{3^m-n-4m} > 3^{3^m-n-3^m} = 3^{3^m(n-1)} \geq 3^{9(n-1)}.
\]
Again, by induction, one can easily prove that \( 3^{9(n-1)} > 2n^2 + 1 \) for all \( n \geq 2 \). Therefore, we conclude that \( n = 1 \). Then we have \( 2 \cdot 1^2 + 1 = 3^{3^m-4m} \), hence \( 3 = 3^{3^m-4m} \). Consequently, we have \( 3^m - 4m = 1 \). The only solution of this equation is \( m = 2 \), in which case we have \( a = 3^m \cdot n = 3^2 \cdot 1 = 9 \).

If \( m \leq 1 \), then there are two possible cases: \( m = 0 \) or \( m = 1 \).

- If \( m = 1 \), then we have \( 2n^2 + 1 = 3^{3n-4} \). Again, by induction, one can easily prove that \( 3^{3n-4} > 2n^2 + 1 \) for all \( n \geq 3 \). By checking \( n = 1, 2 \), we only get \( n = 2 \) as a solution. This gives \( a = 3^m \cdot n = 3^1 \cdot 2 = 6 \).

- If \( m = 0 \), then we have \( 2n^2 + 1 = 3^n \). By induction, one can easily prove that \( 3^n > 2n^2 + 1 \) for all \( n \geq 3 \). By checking \( n = 1, 2 \), we find the solutions \( a = 3^0 \cdot 1 = 1 \) and \( a = 3^0 \cdot 2 = 2 \).

Therefore, \( (a, p) = (1, 3), (2, 3), (6, 3), (9, 3) \) are all the possible solutions. The sum of the quantity \[ (a+p) \] over every such pair is \(30\).",30,number theory
2023n4,"Let \( a_1, a_2, \ldots, a_n, b_1, b_2, \ldots, b_n \) be \( 2n \) positive integers such that the \( n + 1 \) products form a strictly increasing arithmetic progression in that order. Determine the smallest positive integer that could be the common difference of such an arithmetic progression when \(n=6\)","The condition in the problem is equivalent to
\[
D = (b_{1} - a_{1})a_{2}a_{3} \cdots a_{n} = b_{1}(b_{2} - a_{2})a_{3}a_{4} \cdots a_{n} = \cdots = b_{1}b_{2} \cdots b_{n-1}(b_{n} - a_{n}),
\]
where \( D \) is the common difference. Since the progression is strictly increasing, \( D > 0 \), hence \( b_{i} > a_{i} \) for every \( 1 \leq i \leq n \). Individually, these equalities simplify to
\[
(b_{i} - a_{i})a_{i+1} = b_{i}(b_{i+1} - a_{i+1}) \quad \text{for every } 1 \leq i \leq n-1.
\]
(1)

If \( g_{i} := \gcd(a_{i}, b_{i}) > 1 \) for some \( 1 \leq i \leq n \), then we can replace \( a_{i} \) with \( \frac{a_{i}}{g_{i}} \) and \( b_{i} \) with \( \frac{b_{i}}{g_{i}} \) to get a smaller common difference. Hence we may assume \( \gcd(a_{i}, b_{i}) = 1 \) for every \( 1 \leq i \leq n \).

Then, we have \( \gcd(b_{i} - a_{i}, b_{i}) = \gcd(a_{i}, b_{i}) = 1 \) and \( \gcd(a_{i+1}, b_{i+1} - a_{i+1}) = \gcd(a_{i+1}, b_{i+1}) = 1 \) for every \( 1 \leq i \leq n-1 \). The equality (1) implies \( a_{i+1} = b_{i} \) and \( b_{i} - a_{i} = b_{i+1} - a_{i+1} \). Thus,
\[
a_{1}, \quad b_{1} = a_{2}, \quad b_{2} = a_{3}, \quad \ldots, \quad b_{n-1} = a_{n}, \quad b_{n}
\]
is an arithmetic progression with positive common difference. Since \( a_{1} \geq 1 \), we have \( a_{i} \geq i \) for every \( 1 \leq i \leq n \), so
\[
D = (b_{1} - a_{1})a_{2}a_{3} \cdots a_{n} \geq 1 \cdot 2 \cdot 3 \cdots n = n!.
\]
Equality is achieved when \( b_{i} - a_{i} = 1 \) for \( 1 \leq i \leq n \) and \( a_{1} = 1 \), i.e. \( a_{i} = i \) and \( b_{i} = i + 1 \) for every \( 1 \leq i \leq n \). Indeed, it is straightforward to check that these integers produce an arithmetic progression with common difference \( n! \). The smallest common difference is 720 when \(n=6\).",720,number theory
2023n6,"A sequence of integers \( a_0, a_1, a_2, \ldots \) is called *kawaii*, if \( a_0 = 0, a_1 = 1 \), and, for any positive integer \( n \), we have
\[
(a_{n+1} - 3a_n + 2a_{n-1})(a_{n+1} - 4a_n + 3a_{n-1}) = 0.
\]

An integer is called *kawaii* if it belongs to a kawaii sequence.

Suppose that two consecutive positive integers \( m \) and \( m + 1 \) are both kawaii (not necessarily belonging to the same kawaii sequence). Which positive integer must divide \( m \) in this situation?","We start by rewriting the condition in the problem as:
\[
a_{n+1} = 3a_{n} - 2a_{n-1}, \quad \text{or} \quad a_{n+1} = 4a_{n} - 3a_{n-1}.
\]
We have \( a_{n+1} \equiv a_{n} \) or \( a_{n-1} \pmod{2} \) and \( a_{n+1} \equiv a_{n-1} \) or \( a_{n} \pmod{3} \) for all \( n \geqslant 1 \). Now, since \( a_{0} = 0 \) and \( a_{1} = 1 \), we have that \( a_{n} \equiv 0, 1 \bmod{3} \) for all \( n \geqslant 0 \). Since \( m \) and \( m + 1 \) are kawaii integers, then necessarily \( m \equiv 0 \bmod{3} \).

We also observe that \( a_{2} = 3 \) or \( a_{2} = 4 \). Moreover,

1. **(1)** If \( a_{2} = 3 \), then \( a_{n} \equiv 1 \pmod{2} \) for all \( n \geqslant 1 \) since \( a_{1} \equiv a_{2} \equiv 1 \pmod{2} \).

2. **(2)** If \( a_{2} = 4 \), then \( a_{n} \equiv 1 \pmod{3} \) for all \( n \geqslant 1 \) since \( a_{1} \equiv a_{2} \equiv 1 \pmod{3} \).

Since \( m \equiv 0 \pmod{3} \), any kawaii sequence containing \( m \) does not satisfy (2), so it must satisfy (1). Hence, \( m \) is odd and \( m + 1 \) is even.

Take a kawaii sequence \( (a_{n}) \) containing \( m + 1 \). Let \( t \geqslant 2 \) be such that \( a_{t} = m + 1 \). As \( (a_{n}) \) does not satisfy (1), it must satisfy (2). Then \( a_{n} \equiv 1 \pmod{3} \) for all \( n \geqslant 1 \). We define the sequence \( a^{\prime}_{n} = (a_{n+1} - 1)/3 \). This is a kawaii sequence: \( a^{\prime}_{0} = 0 \), \( a^{\prime}_{1} = 1 \) and for all \( n \geqslant 1 \),
\[
(a^{\prime}_{n+1} - 3a^{\prime}_{n} + 2a^{\prime}_{n-1})(a^{\prime}_{n+1} - 4a^{\prime}_{n} + 3a^{\prime}_{n-1}) = (a_{n+2} - 3a_{n+1} + 2a_{n})(a_{n+2} - 4a_{n+1} + 3a_{n}) / 9 = 0.
\]
Finally, we notice that the term \( a^{\prime}_{t-1} = m / 3 \), which implies that \( m / 3 \) is kawaii.",3,number theory
2023n7,"Let \( a, b, c, d \) be distinct positive integers satisfying  
\[
\frac{ab}{a+b} + \frac{cd}{c+d} = \frac{(a+b)(c+d)}{a+b+c+d}.
\]

Determine the minimum possible value of \( a+b+c+d \).","First, note that if we take \( a = \ell, b = k\ell, c = k\ell, d = k^2\ell \) for some positive integers \( k \) and \( \ell \), then we have
\[
\frac{ab}{a+b} + \frac{cd}{c+d} = \frac{k\ell^2}{\ell+k\ell} + \frac{k^3\ell^2}{k\ell+k^2\ell} = \frac{k\ell}{k+1} + \frac{k^2\ell}{k+1} = k\ell
\]
and
\[
\frac{(a+b)(c+d)}{a+b+c+d} = \frac{(\ell+k\ell)(k\ell+k^2\ell)}{\ell+k\ell+k\ell+k^2\ell} = \frac{k(k+1)^2\ell^2}{\ell(k+1)^2} = k\ell,
\]
so that
\[
\frac{ab}{a+b} + \frac{cd}{c+d} = k\ell = \frac{(a+b)(c+d)}{a+b+c+d}.
\]
This means that \( a + b + c + d = \ell(1+2k+k^2) = \ell(k+1)^2 \) can be attained. We conclude that all non-square-free positive integers can be attained. Now, we will show that if
\[
\frac{ab}{a+b} + \frac{cd}{c+d} = \frac{(a+b)(c+d)}{a+b+c+d},
\]
then \( a + b + c + d \) is not square-free. We argue by contradiction. Suppose that \( a + b + c + d \) is square-free, and note that after multiplying by \((a+b)(c+d)(a+b+c+d)\), we obtain
\[
(ab(c+d) + cd(a+b))(a+b+c+d) = (a+b)^2(c+d)^2.
\]
(1)

A prime factor of \( a + b + c + d \) must divide \( a + b \) or \( c + d \), and therefore divides both \( a + b \) and \( c + d \). Because \( a + b + c + d \) is square-free, the fact that every prime factor of \( a + b + c + d \) divides \( a + b \) implies that \( a + b + c + d \) itself divides \( a + b \). Because \( a + b < a + b + c + d \), this is impossible. So \( a + b + c + d \) cannot be square-free.

A convenient way to see that the first time one can have four distinct positive integers satisfying the given relation is at the sum 27 is via the explicit example \((a, b, c, d) = (2, 7, 8, 10)\)",27,number theory
2023n8,"\boxed{\text{N8.}}
Let \(\mathbb{Z}_{>0}\) be the set of positive integers. Determine all functions \(f: \mathbb{Z}_{>0} \rightarrow \mathbb{Z}_{>0}\) such that
\[
f^{bf(a)}(a+1) = (a+1)f(b)
\]
holds for all \(a, b \in \mathbb{Z}_{>0}\), where \(f^k(n) = f(f(\cdots f(n)\cdots))\) denotes the composition of \(f\) with itself \(k\) times. Give the minimum value of the function \(f(n)\)","**Solution 1.** We divide the solution into 5 steps.

**Step 1.** (\(f\) is injective)

_Claim 1._ For any \(a \geqslant 2\), the set \(\{f^{n}(a) \mid n \in \mathbb{Z}_{>0}\}\) is infinite.

_Proof._ First, we have \(f^{(k)}(a+1) \stackrel{P(a \cdot 1)}{\longrightarrow} (a+1)f(1)\). Varying \(a\), we see that \(f(\mathbb{Z}_{>0})\) is infinite. Next, we have \(f^{N(n-1)}(a) \stackrel{P(a-1)}{\longrightarrow} af(b)\). So, varying \(b\), \(f^{N(n-1)}(a)\) takes infinitely many values.

_Claim 2._ For any \(a \geqslant 2\) and \(n \in \mathbb{Z}_{>0}\), we have \(f^{n}(a) \neq a\).

_Proof._ Otherwise, we would get a contradiction with Claim 1.

Assume \(f(b) = f(c)\) for some \(b < c\). Then we have
\[
(a+1)f(c) \stackrel{P(a \cdot c)}{\longrightarrow} f^{c f(a)}(a+1)
= f^{(c-3)f(a)}\big(f^{3 f(a)}(a+1)\big)
\stackrel{P(a \cdot b)}{\longrightarrow} f^{(c-8)f(a)}((a+1)f(b))
= f^{(c-8)f(a)}((a+1)f(c)),
\]
which contradicts Claim 2. So, \(f\) is injective.

**Step 2.** (\(f(\mathbb{Z}_{>0}) = \mathbb{Z}_{>2}\))

_Claim 3._ 1 is not in the range of \(f\).

_Proof._ If \(f(b) = 1\), then \(f^{(k)}(a+1) = a+1\) by \(P(a,1)\), which contradicts Claim 2.

We say that \(a\) is a _descendant_ of \(b\) if \(f^{n}(b) = a\) for some \(n \in \mathbb{Z}_{>0}\).

_Claim 4._ For any \(a, b \geqslant 1\), both of the following cannot happen at the same time:
- \(a\) is a descendant of \(b\);
- \(b\) is a descendant of \(a\).

_Proof._ If both of the above hold, then \(a = f^{m}(b)\) and \(b = f^{n}(a)\) for some \(m, n \in \mathbb{Z}_{>0}\). Then \(a = f^{m+n}(a)\), which contradicts Claim 2.

_Claim 5._ For any \(a, b \geqslant 2\), exactly one of the following holds:
- \(a\) is a descendant of \(b\);
- \(b\) is a descendant of \(a\);
- \(a = b\).

_Proof._ For any \(c \geqslant 2\), taking \(m = f^{r(n-1)+(c)}\) and \(n = f^{r(n-1)-(b)}\), we have
\[
f(m) = f^{r(n-1)}(a) \stackrel{P(w_{-1},a)}{\longrightarrow} af(c) \text{ and } f(n) = f^{r(k-1)}(b) \stackrel{P(w_{-1},a)}{\longrightarrow} bf(c).
\]
Hence
\[
f^{r(n-1)}(a) \stackrel{P(w_{-1},a)}{\longrightarrow} af(n) = abf(c) = bf(m) \stackrel{P(w_{-1},aa)}{\longrightarrow} f^{m(k-1)}(b).
\]
The assertion then follows from the injectivity of \(f\) and Claim 2.

Now, we show that any \(a \geqslant 2\) is in the range of \(f\). Let \(b = f(1)\). If \(n = b\), then \(a\) is in the range of \(f\). If \(w \neq b\), either \(a\) is a descendant of \(b\), or \(b\) is a descendant of \(a\) by Claim 5. If \(b\) is a descendant of \(a\), then \(b = f^{n}(a)\) for some \(n \in \mathbb{Z}_{>0}\), so \(1 = f^{n-1}(a)\). Then, by Claim 3, we have \(n = 1\), so \(1 = a\), which is absurd. So, \(a\) is a descendant of \(b\). In particular, \(a\) is in the range of \(f\). Thus, \(f(\mathbb{Z}_{>0}) = \mathbb{Z}_{>2}\).

**Step 3.** (\(f(1) = 2\))

_Claim 6._ Let \(a, n \geqslant 2\), then \(na\) is a descendant of \(a\).

_Proof._ We write \(n = f(m)\) by Step 2. We have \(m = f(m)a \stackrel{P(w_{-1},aa)}{\longrightarrow} f^{n(n-1)}(a)\), which shows \(na\) is a descendant of \(a\).

By Claim 6, all even integers \(\geqslant 4\) are descendants of \(2\). Hence \(2 = f(2k+1)\) for some \(k \geqslant 0\).

Next, we show \(f(2k+1) > f(1)\), which implies \(f(1) = 2\). It trivially holds if \(k = 0\). If \(k \geqslant 1\), let \(n\) be the integer such that \(f^{n}(2) = 2k+2\). For any \(b \geqslant n/f(1)\), we have
\[
f^{b(1)-n}(2k+2) = f^{b(1)}(2) \stackrel{P(a \cdot 1)}{\longrightarrow} 2f(b) \text{ and } f^{b(2k+1)}(2k+2) \stackrel{P(2k+1,a)}{\longrightarrow} (2k+2)f(b).
\]
By Claim 6, \((2k+2)f(b)\) is a descendant of \(2f(b)\). By Claim 2, we have \(bf(2k+1) > bf(1) = n\). By taking \(b\) large enough, we conclude \(f(2k+1) > f(1)\).

**Step 4.** (\(f(2) = 3\) and \(f(3) = 4\)) From \(f(1) = 2\) and \(P(1,b)\), we have \(f^{20}(2) = 2f(b)\). So taking \(b = 1\), we obtain \(f^{2}(2) = 2f(1) = 4\) and taking \(b = f(2)\), we have \(f^{2(2)}(2) = 2f^{2}(2) = 8\). Hence, \(f^{2(2)-4}(4) = f^{2(2)}(2) = 8\) and \(f^{10(4)}(\stackrel{P(a \cdot 1)}{\longrightarrow} 8)\) give \(f(3) = 2f(2) = 2\).

_Claim 7._ For any \(m, n \in \mathbb{Z}_{>0}\), if \(f(m)\) divides \(f(n)\), then \(m < n\).

_Proof._ If \(f(m) = f(n)\), the assertion follows from the injectivity of \(f\). If \(f(m) < f(n)\), by \(P(a,m) \stackrel{P(a \cdot 1)}{\longrightarrow} na\) if \(m < n\), we have that \(f^{p(2m)}(a+1)\) is a descendant of \(f^{m(m)}(a+1)\) for any \(a \in \mathbb{Z}_{>0}\). So \(mf(a) < nf(a)\), and \(m < n\).

By Claim 7, every possible divisor of \(f(2)\) is in \([1, f(1) = 2, f(2)]\). Thus \(f(2)\) is an odd prime or \(f(2) = 4\). Since \(f^{2}(2) = 4\), we have \(f(2) \neq 4\), and hence \(f(2)\) is an odd prime. We set \(p = 2f(2)\).

Now, \(f(3) = 2f(2) = 2 = 2(p-1)\). Since \(p-1\) divides \(f(3)\), we have \(p-1 \in [1, f(1) = 2, f(2) = p]\) by Claim 7, so \(p-1 = 2\). Thus, \(f(2) = p = 3\) and \(f(3) = 2(p-1) = 4\).

**Step 5.** (\(f(n) = n+1\))

_Claim 8._ For any \(b \geqslant 1\), \(f(2f(b)-1) = 2b+2\).

_Proof._ Since \(f^{2}(2) = 4\), we have \(f^{3b-2}(4) = f^{3b}(2) = 2f(b)\), so
\[
f^{(2f(b)-1)+3b-2}(4) = f^{(2f(b)-1)}(2f(b)) \stackrel{P(2f(b)-1)}{\longrightarrow} 4f(b) \stackrel{P(a \cdot 1)}{\longrightarrow} f^{3b}(4),
\]
which gives us \(f(2f(b)-1) = 2b+2\).

Finally, we prove \(f(n) = n+1\) by induction on \(n\). Suppose \(f(n) = n+1\) for all \(1 \leqslant n \leqslant 2b+1\). Replace \(b\) by \(b+1\) in \(f(2f(b)-1) = 2b+2\) to get
\[
f(2b+3) = f(2f(b+1)-1) = 2(b+1)+2 = 2b+4.
\]
By induction hypothesis, we have \(f^{4}(b+2) = 2b+2\). Hence
\[
f(f(2b+2)) = f^{3b}(b+2) = f^{(3b-1)}(b+2) \stackrel{P(a \cdot 1,1)}{\longrightarrow} 2(b+2) = f(2b+3).
\]
By injectivity, \(f(2b+2) = 2b+3\). Then \(f(n) = n+1\) for all \(n \in \mathbb{Z}_{>0}\), which is indeed a solution.
So the minimum value of \(f(n)\) is 2.",2,number theory
2022a2,Let \( k = 20 \) be an integer. Find the smallest integer \( n \geq k + 1 \) with the property that there exists a set of \( n \) distinct real numbers such that each of its elements can be written as a sum of \( k \) other distinct elements of the set.,"First, we show that \( n \geq k + 4 \). Suppose that there exists such a set with \( n \) numbers and denote them by \( a_{1} < a_{2} < \cdots < a_{n} \).

Note that in order to express \( a_{1} \) as a sum of \( k \) distinct elements of the set, we must have \( a_{1} \geq a_{2} + \cdots + a_{k+1} \) and, similarly for \( a_{n} \), we must have \( a_{n-k} + \cdots + a_{n-1} \geq a_{n} \). We also know that \( n \geq k + 1 \).

If \( n = k + 1 \), then we have \( a_{1} \geq a_{2} + \cdots + a_{k+1} > a_{1} + \cdots + a_{k} \geq a_{k+1} \), which gives a contradiction.

If \( n = k + 2 \), then we have \( a_{1} \geq a_{2} + \cdots + a_{k+1} \geq a_{k+2} \), which again gives a contradiction.

If \( n = k + 3 \), then we have \( a_{1} \geq a_{2} + \cdots + a_{k+1} \) and \( a_{3} + \cdots + a_{k+2} \geq a_{k+3} \). Adding the two inequalities, we get \( a_{1} + a_{k+2} \geq a_{2} + a_{k+3} \), again a contradiction.

It remains to give an example of a set with \( k + 4 \) elements satisfying the condition of the problem. We start with the case when \( k = 2l \) and \( l \geq 1 \). In that case, denote by \( A_{i} = \{-i, i\} \) and take the set \( A_{1} \cup \cdots \cup A_{l+2} \), which has exactly \( k + 4 = 2l + 4 \) elements. We are left to show that this set satisfies the required condition.

Note that if a number \( i \) can be expressed in the desired way, then so can \( -i \) by negating the expression. Therefore, we consider only \( 1 \leq i \leq l + 2 \).

If \( i < l + 2 \), we sum the numbers from some \( l - 1 \) sets \( A_{j} \) with \( j \neq 1, i + 1 \), and the numbers \( i + 1 \) and \( -1 \).

For \( i = l + 2 \), we sum the numbers from some \( l - 1 \) sets \( A_{j} \) with \( j \neq 1, l + 1 \), and the numbers \( l + 1 \) and \( 1 \).

It remains to give a construction for odd \( k = 2l + 1 \) with \( l \geq 1 \) (since \( k \geq 2 \)). To that end, we modify the construction for \( k = 2l \) by adding \( 0 \) to the previous set.

This is a valid set as \( 0 \) can be added to each constructed expression, and \( 0 \) can be expressed as follows: take the numbers \( 1, 2, -3 \) and all the numbers from the remaining \( l - 1 \) sets \( A_{4}, A_{5}, \cdots, A_{l+2} \).

So the smallest integer \( n=24 \) when \(k=20\).",24,algebra
2022a3,"Let \(\mathbb{R}_{>0}\) be the set of positive real numbers. Find all functions \(f \colon \mathbb{R}_{>0} \to \mathbb{R}_{>0}\) such that, for every \(x \in \mathbb{R}_{>0}\), there exists a unique \(y \in \mathbb{R}_{>0}\) satisfying  
\[
xf(y) + yf(x) \leq 2.
\]
And give the value of \( f(x) \) when \(x=0.05\)","First, we prove that the function \( f(x) = \frac{1}{x} \) satisfies the condition of the problem statement. The AM-GM inequality gives
\[
\frac{x}{y} + \frac{y}{x} \geq 2
\]
for every \( x, y > 0 \), with equality if and only if \( x = y \). This means that, for every \( x > 0 \), there exists a unique \( y > 0 \) such that
\[
\frac{x}{y} + \frac{y}{x} \leq 2,
\]
namely \( y = x \).

Let now \( f : \mathbb{R}_{>0} \rightarrow \mathbb{R}_{>0} \) be a function that satisfies the condition of the problem statement. We say that a pair of positive real numbers \( (x, y) \) is good if \( xf(y) + yf(x) \leq 2 \). Observe that if \( (x, y) \) is good, then so is \( (y, x) \).

**Lemma 1.0.** If \( (x, y) \) is good, then \( x = y \).

**Proof.** Assume that there exist positive real numbers \( x \neq y \) such that \( (x, y) \) is good. The uniqueness assumption says that \( y \) is the unique positive real number such that \( (x, y) \) is good. In particular, \( (x, x) \) is not a good pair. This means that
\[
xf(x) + xf(x) > 2
\]
and thus \( xf(x) > 1 \). Similarly, \( (y, x) \) is a good pair, so \( (y, y) \) is not a good pair, which implies \( yf(y) > 1 \). We apply the AM-GM inequality to obtain
\[
xf(y) + yf(x) \geq 2\sqrt{xf(y) \cdot yf(x)} = 2\sqrt{xf(x) \cdot yf(y)} > 2.
\]
This is a contradiction, since \( (x, y) \) is a good pair.

By assumption, for any \( x > 0 \), there always exists a good pair containing \( x \). However, Lemma 1 implies that the only good pair that can contain \( x \) is \( (x, x) \), so
\[
xf(x) \leq 1 \iff f(x) \leq \frac{1}{x},
\]
for every \( x > 0 \).

In particular, with \( x = \frac{1}{f(t)} \) for \( t > 0 \), we obtain
\[
\frac{1}{f(t)} \cdot f\left(\frac{1}{f(t)}\right) \leq 1.
\]
Hence
\[
t \cdot f\left(\frac{1}{f(t)}\right) \leq tf(t) \leq 1.
\]

We claim that \( (t, \frac{1}{f(t)}) \) is a good pair for every \( t > 0 \). Indeed,
\[
t \cdot f\left(\frac{1}{f(t)}\right) + \frac{1}{f(t)}f(t) = t \cdot f\left(\frac{1}{f(t)}\right) + 1 \leq 2.
\]

Lemma 1 implies that \( t = \frac{1}{f(t)} \iff f(t) = \frac{1}{t} \) for every \( t > 0 \).

**Solution 1.1.** We give an alternative way to prove that \( f(x) = \frac{1}{x} \) assuming \( f(x) \leq \frac{1}{x} \) for every \( x > 0 \).

Indeed, if \( f(x) < \frac{1}{x} \), then for every \( a > 0 \) with \( f(x) < \frac{1}{a} < \frac{1}{x} \) (and there are at least two of them), we have
\[
af(x) + xf(a) < 1 + \frac{x}{a} < 2.
\]

Hence \( (x, a) \) is a good pair for every such \( a \), a contradiction. We conclude that \( f(x) = \frac{1}{x} \).

So \( f(x) = 20 \) when \(x=0.05\)",20,algebra
2022a5,"Find all positive integers \( n \geq 2 \) for which there exist \( n \) real numbers \( a_1 < \cdots < a_n \) and a real number \( r > 0 \) such that the \( \frac{1}{2}n(n-1) \) differences \( a_j - a_i \) for \( 1 \leq i < j \leq n \) are equal, in some order, to the numbers \( r^1, r^2, \ldots, r^{\frac{1}{2}n(n-1)} \). Give the sum of all possible positive integers \(n\).","**Solution.** We first show a solution for each \( n \in \{2, 3, 4\} \). We will later show the impossibility of finding such a solution for \( n \geq 5 \).

For \( n = 2 \), take for example \( (a_{1}, a_{2}) = (1, 3) \) and \( r = 2 \).

For \( n = 3 \), take the root \( r > 1 \) of \( x^{2} - x - 1 = 0 \) (the golden ratio) and set \( (a_{1}, a_{2}, a_{3}) = (0, r, r + r^{2}) \). Then
\[
(a_{2} - a_{1}, a_{3} - a_{2}, a_{3} - a_{1}) = (r, r^{2}, r + r^{2} = r^{3}).
\]

For \( n = 4 \), take the root \( r \in (1, 2) \) of \( x^{3} - x - 1 = 0 \) (such a root exists because \( 1^{3} - 1 - 1 < 0 \) and \( 2^{3} - 2 - 1 > 0 \)) and set \( (a_{1}, a_{2}, a_{3}, a_{4}) = (0, r, r + r^{2}, r + r^{2} + r^{3}) \). Then
\[
(a_{2} - a_{1}, a_{3} - a_{2}, a_{4} - a_{3}, a_{3} - a_{1}, a_{4} - a_{2}, a_{4} - a_{1}) = (r, r^{2}, r^{3}, r^{4}, r^{5}, r^{6}).
\]

For \( n \geq 5 \), we will proceed by contradiction. Suppose there exist numbers \( a_{1} < \cdots < a_{n} \) and \( r > 1 \) satisfying the conditions of the problem. We start with a lemma:

**Lemma.** We have \( r^{n-1} > 2 \).

**Proof.** There are only \( n - 1 \) differences \( a_{j} - a_{i} \) with \( j = i + 1 \), so there exists an exponent \( e \leq n \) and a difference \( a_{j} - a_{i} \) with \( j \geq i + 2 \) such that \( a_{j} - a_{i} = r^{e} \). This implies
\[
r^{n} \geq r^{e} = a_{j} - a_{i} = (a_{j} - a_{j-1}) + (a_{j-1} - a_{i}) > r + r = 2r,
\]
thus \( r^{n-1} > 2 \) as desired.

To illustrate the general approach, we first briefly sketch the idea behind the argument in the special case \( n = 5 \). In this case, we clearly have \( a_{5} - a_{1} = r^{10} \). Note that there are 3 ways to rewrite \( a_{5} - a_{1} \) as a sum of two differences, namely
\[
(a_{5} - a_{4}) + (a_{4} - a_{1}), \quad (a_{5} - a_{3}) + (a_{3} - a_{1}), \quad (a_{5} - a_{2}) + (a_{2} - a_{1}).
\]
Using the lemma above and convexity of the function \( f(n) = r^{n} \), we argue that those three ways must be \( r^{10} = r^{3} + r^{7} = r^{8} + r^{4} = r^{7} + r^{6} \). That is, the ""large"" exponents keep dropping by 1, while the ""small"" exponents keep increasing by \( n - 2, n - 3, \ldots, 2 \). Comparing any two such equations, we then get a contradiction unless \( n \leq 4 \).

Now we go back to the full proof for any \( n \geq 5 \). Denote \( b = \frac{1}{2}n(n - 1) \). Clearly, we have \( a_{n} - a_{1} = r^{b} \). Consider the \( n - 2 \) equations of the form:
\[
a_{n} - a_{1} = (a_{n} - a_{i}) + (a_{i} - a_{1}) \quad \text{for } i \in \{2, \ldots, n - 1\}.
\]
In each equation, one of the two terms on the right-hand side must be at least \( \frac{1}{2}(a_{n} - a_{1}) \). But from the lemma we have \( r^{b - (n - 1)} = r^{b} / r^{n - 1} < \frac{1}{2}(a_{n} - a_{1}) \), so there are at most \( n - 2 \) sufficiently large elements in \( \{r^{k} \mid 1 \leq k < b\} \), namely \( r^{b - 1}, \ldots, r^{b - (n - 2)} \) (note that \( r^{b} \) is already used for \( a_{n} - a_{1} \)). Thus, the ""large"" terms must be, in some order, precisely equal to elements in
\[
L = \{r^{b - 1}, \ldots, r^{b - (n - 2)}\}.
\]
Next we claim that the ""small"" terms in the \( n - 2 \) equations must be equal to the elements in
\[
S = \{r^{b - (n - 2) - \frac{1}{2}(i + 1)} \mid 1 \leq i \leq n - 2\},
\]
in the corresponding order (the largest ""large"" term with the smallest ""small"" term, etc.). Indeed, suppose that
\[
r^{b} = a_{n} - a_{1} = r^{b - i} + r^{\alpha_{i}} \quad \text{for } i \in \{1, \ldots, n - 2\},
\]
where \( 1 \leq \alpha_{1} < \cdots < \alpha_{n - 2} \leq b - (n - 1) \). Since \( r > 1 \) and \( f(r) = r^{n} \) is convex, we have
\[
r^{b - 1} - r^{b - 2} > r^{b - 2} - r^{b - 3} > \ldots > r^{b - (n - 3)} - r^{b - (n - 2)},
\]
implying
\[
r^{\alpha_{2}} - r^{\alpha_{1}}} > r^{\alpha_{3}} - r^{\alpha_{2}}} > \ldots > r^{\alpha_{n - 2}} - r^{\alpha_{n - 3}}}.
\]
Convexity of \( f(r) = r^{n} \) further implies
\[
\alpha_{2} - \alpha_{1} > \alpha_{3} - \alpha_{2} > \ldots > \alpha_{n - 2} - \alpha_{n - 3}.
\]
Note that \( \alpha_{n - 2} - \alpha_{n - 3} \geq 2 \). Otherwise we would have \( \alpha_{n - 2} - \alpha_{n - 3} = 1 \) and thus
\[
r^{\alpha_{n - 3}} \cdot (r - 1) = r^{\alpha_{n - 2}} - r^{\alpha_{n - 3}}} = r^{b - (n - 3)} - r^{b - (n - 2)}} = r^{b - (n - 2)}} \cdot (r - 1),
\]
implying that \( \alpha_{n - 3} = b - (n - 2) \), a contradiction. Therefore, we have
\[
\alpha_{n - 2} - \alpha_{1} = (\alpha_{n - 2} - \alpha_{n - 3}) + \cdots + (\alpha_{2} - \alpha_{1}) \geq 2 + 3 + \cdots + (n - 2) = \frac{1}{2}(n - 2)(n - 1) - 1 = \frac{1}{2}n(n - 3).
\]
On the other hand, from \( \alpha_{n - 2} \leq b - (n - 1) \) and \( \alpha_{1} \geq 1 \) we get
\[
\alpha_{n - 2} - \alpha_{1} \leq b - n = \frac{1}{2}n(n - 1) - n = \frac{1}{2}n(n - 3),
\]
implying that equalities must occur everywhere and the claim about the small terms follows.

Now, assuming \( n - 2 \geq 2 \), we have the two different equations:
\[
r^{b} = r^{b - (n - 2)}} + r^{b - (n - 2) - 1}} \quad \text{and} \quad r^{b} = r^{b - (n - 3)}} + r^{b - (n - 2) - 3}},
\]
which can be rewritten as
\[
r^{n - 1} = r + 1 \quad \text{and} \quad r^{n + 1} = r^{4} + 1.
\]
Simple algebra now gives
\[
r^{4} + 1 = r^{n + 1} = r^{n - 1} \cdot r^{2} = r^{3} + r^{2} \implies (r - 1)(r^{3} - r - 1) = 0.
\]
Since \( r \neq 1 \), using the first equation we conclude \( r^{3} = r + 1 = r^{n - 1} \), thus \( n = 4 \), which gives a contradiction.
So the sum of all possible positive integers \(n\) is \(9\).",9,algebra
2022a6,"Let \(\mathbb{R}\) be the set of real numbers. We denote by \(\mathcal{F}\) the set of all functions \(f: \mathbb{R} \to \mathbb{R}\) such that  
\[
f(x + f(y)) = f(x) + f(y)
\]  
for every \(x, y \in \mathbb{R}\). Find all rational numbers \(q\) such that for every function \(f \in \mathcal{F}\), there exists some \(z \in \mathbb{R}\) satisfying \(f(z) = qz\). What is the maximum positive number in the desired set of rational number?","**Solution.** Let \( Z \) be the set of all rational numbers \( q \) such that for every function \( f \in \mathcal{F} \), there exists some \( z \in \mathbb{R} \) satisfying \( f(z) = qz \). Let further
\[
S = \left\{ \frac{n+1}{n} : n \in \mathbb{Z}, n \neq 0 \right\}.
\]
We prove that \( Z = S \) by showing the two inclusions: \( S \subseteq Z \) and \( Z \subseteq S \).

We first prove that \( S \subseteq Z \). Let \( f \in \mathcal{F} \) and let \( P(x, y) \) be the relation \( f(x + f(y)) = f(x) + f(y) \). First note that \( P(0, 0) \) gives \( f(f(0)) = 2f(0) \). Then, \( P(0, f(0)) \) gives \( f(2f(0)) = 3f(0) \). We claim that
\[
f(kf(0)) = (k + 1)f(0)
\]
for every integer \( k \geq 1 \). The claim can be proved by induction. The cases \( k = 1 \) and \( k = 2 \) have already been established. Assume that \( f(kf(0)) = (k + 1)f(0) \) and consider \( P(0, kf(0)) \) which gives
\[
f((k + 1)f(0)) = f(0) + f(kf(0)) = (k + 2)f(0).
\]
This proves the claim. We conclude that \( \frac{k+1}{k} \in Z \) for every integer \( k \geq 1 \). Note that \( P(-f(0), 0) \) gives \( f(-f(0)) = 0 \). We now claim that
\[
f(-kf(0)) = (-k + 1)f(0)
\]
for every integer \( k \geq 1 \). The proof by induction is similar to the one above. We conclude that \( \frac{-k+1}{-k} \in Z \) for every integer \( k \geq 1 \). This shows that \( S \subseteq Z \).

We now prove that \( Z \subseteq S \). Let \( p \) be a rational number outside the set \( S \). We want to prove that \( p \) does not belong to \( Z \). To that end, we construct a function \( f \in \mathcal{F} \) such that \( f(z) \neq pz \) for every \( z \in \mathbb{R} \). The strategy is to first construct a function
\[
g: [0, 1) \to \mathbb{Z}
\]
and then define \( f \) as \( f(x) = g(\{x\}) + \lfloor x \rfloor \). This function \( f \) belongs to \( \mathcal{F} \). Indeed,
\[
f(x + f(y)) = g(\{x + f(y)\}) + \lfloor x + f(y) \rfloor
= g(\{x + g(\{y\}) + \lfloor y \rfloor\}) + \lfloor x + g(\{y\}) + \lfloor y \rfloor \rfloor
= g(\{x\}) + \lfloor x \rfloor + g(\{y\}) + \lfloor y \rfloor
= f(x) + f(y),
\]
where we used that \( g \) only takes integer values.

**Lemma 1.** For every \( \alpha \in [0, 1) \), there exists \( m \in \mathbb{Z} \) such that
\[
m + n \neq p(\alpha + n)
\]
for every \( n \in \mathbb{Z} \).

**Proof.** Note that if \( p = 1 \), the claim is trivial. If \( p \neq 1 \), then the claim is equivalent to the existence of an integer \( m \) such that
\[
\frac{m - p\alpha}{p - 1}
\]
is never an integer. Assume the contrary. That would mean that both
\[
\frac{m - p\alpha}{p - 1} \quad \text{and} \quad \frac{(m + 1) - p\alpha}{p - 1}
\]
are integers, and so is their difference. The latter is equal to
\[
\frac{1}{p - 1}.
\]
Since we assumed \( p \notin S \), \( 1/(p - 1) \) is never an integer. This is a contradiction.

Define \( g: [0, 1) \to \mathbb{Z} \) by \( g(\alpha) = m \) for any integer \( m \) that satisfies the conclusion of Lemma 1. Note that \( f(z) \neq pz \) if and only if
\[
g(\{z\}) + \lfloor z \rfloor \neq p(\{z\} + \lfloor z \rfloor).
\]
The latter is guaranteed by the construction of the function \( g \). We conclude that \( p \notin Z \) as desired. This shows that \( Z \subseteq S \).
So the maximum positive number in the desired set of rational number is 2.",2,algebra
2022a7,"For a positive integer \( n \), we denote by \( s(n) \) the sum of the digits of \( n \). Let \( P(x) = x^n + a_{n-1}x^{n-1} + \cdots + a_1x + a_0 \) be a polynomial, where \( n \geq 2 \) and \( a_i \) is a positive integer for all \( 0 \leq i \leq n-1 \). How many positive integers \( k \) can make \( s(k) \) and \( s(P(k)) \) have the same parity?","**Solution.** With the notation above, we begin by choosing a positive integer \( t \) such that
\[
10^{t} > \max\left\{\frac{100^{n-1}a_{n-1}}{(10^{\frac{1}{n-1}} - 9^{\frac{1}{n-1}})^{n-1}}, \frac{a_{n-1}}{9}10^{n-1}, \frac{a_{n-1}}{9}(10a_{n-1})^{n-1}, \ldots, \frac{a_{n-1}}{9}(10a_{0})^{n-1}\right\}.
\]
As a direct consequence of \( 10^{t} \) being bigger than the first quantity listed in the above set, we get that the interval
\[
I = \left[\left(\frac{9}{a_{n-1}}10^{t}\right)^{\frac{1}{n-1}}, \left(\frac{1}{a_{n-1}}10^{t+1}\right)^{\frac{1}{n-1}}\right)
\]
contains at least 100 consecutive positive integers.

Let \( X \) be a positive integer in \( I \) such that \( X \) is congruent to 1 mod 100. Since \( X \in I \), we have
\[
9 \cdot 10^{t} \leq a_{n-1}X^{n-1} < 10^{t+1},
\]
thus the first digit (from the left) of \( a_{n-1}X^{n-1} \) must be 9.

Next, we observe that \( a_{n-1}(10a_{i})^{n-1} < 9 \cdot 10^{t} \leq a_{n-1}X^{n-1} \), thus \( 10a_{i} < X \) for all \( i \), which immediately implies that \( a_{0} < a_{1}X < \cdots < a_{n}X^{n} \), and the number of digits of this strictly increasing sequence forms a strictly increasing sequence too. In other words, if \( i < j \), the number of digits of \( a_{i}X^{i} \) is less than the number of digits of \( a_{j}X^{j} \).

Let \( \alpha \) be the number of digits of \( a_{n-1}X^{n-1} \), thus \( 10^{\alpha-1} \leq a_{n-1}X^{n-1} < 10^{\alpha} \). We are now going to look at \( P(10^{\alpha}X) \) and \( P(10^{\alpha-1}X) \) and prove that the sum of their digits has different parities. This will finish the proof since \( s(10^{\alpha}X) = s(10^{\alpha-1}X) = s(X) \).

We have \( P(10^{\alpha}X) = 10^{\alpha n}X^{n} + a_{n-1}10^{\alpha(n-1)}X^{n-1} + \cdots + a_{0} \), and since \( 10^{\alpha(i+1)} > 10^{\alpha i}a_{n-1}X^{n-1} : 10^{\alpha i}a_{i}X^{i} \), the terms \( a_{i}10^{\alpha i}X^{i} \) do not interact when added; in particular, there is no carryover caused by addition. Thus we have \( s(P(10^{\alpha}X)) = s(X^{n}) + s(a_{n-1}X^{n-1}) + \cdots + s(a_{0}) \).

We now look at \( P(10^{\alpha-1}X) = 10^{(\alpha-1)n}X^{n} + a_{n-1}10^{(\alpha-1)(n-1)}X^{n-1} + \cdots + a_{0} \). Firstly, if \( i < n-1 \), then \( a_{n-1}X^{n-1} \) has more digits than \( a_{i}X^{i} \) and \( a_{n-1}X^{n-1} \geq 10a_{i}X^{i} \). It now follows that \( 10^{(\alpha-1)(i+1)+1} > 10^{(\alpha-1)i}a_{n-1}X^{n-1} \geq 10^{(\alpha-1)i+1}a_{i}X^{i} \), thus all terms \( 10^{(\alpha-1)i}a_{i}X^{i} \) for \( 0 \leq i \leq n-1 \) come in 'blocks', exactly as in the previous case.

Finally, \( 10^{(\alpha-1)n+1} > 10^{(\alpha-1)(n-1)}a_{n-1}X^{n-1} \geq 10^{(\alpha-1)n} \), thus \( 10^{(\alpha-1)(n-1)}a_{n-1}X^{n-1} \) has exactly \( (\alpha-1)n+1 \) digits, and its first digit is 9, as established above. On the other hand, \( 10^{(\alpha-1)n}X^{n} \) has exactly \( (\alpha-1)n \) zeros, followed by 01 (as \( X \) is 1 mod 100). Therefore, when we add the terms, the 9 and 1 turn into 0, the 0 turns into 1, and nothing else is affected.

Putting everything together, we obtain
\[
s(P(10^{\alpha-1}X)) = s(X^{n}) + s(a_{n-1}X^{n-1}) + \cdots + s(a_{0}) - 9 = s(P(10^{\alpha}X)) - 9,
\]
thus \( s(P(10^{\alpha}X)) \) and \( s(P(10^{\alpha-1}X)) \) have different parities, as claimed.

So for any such polynomial, there exists a positive integer \( k \) such that \( s(k) \) and \( s(P(k)) \) have different parities.",0,algebra
2022c1,"A \(\pm 1\)-sequence is a sequence of 2022 numbers \(a_1, \ldots, a_{2022}\), each equal to either \(+1\) or \(-1\). Determine the largest \(C\) so that, for any \(\pm 1\)-sequence, there exists an integer \(k\) and indices \(1 \leq t_1 < \ldots < t_k \leq 2022\) so that \(t_{i+1} - t_i \leq 2\) for all \(i\), and
\[
\left| \sum_{i=1}^k a_{t_i} \right| \geq C.
\]","**Solution.** First, we prove that this can always be achieved. Without loss of generality, suppose at least \(\frac{2022}{2} = 1011\) terms of the \(\pm 1\)-sequence are \(+1\). Define a subsequence as follows: starting at \( t = 0 \), if \( a_{t} = +1 \), we always include \( a_{t} \) in the subsequence. Otherwise, we skip \( a_{t} \) if we can (i.e., if we included \( a_{t-1} \) in the subsequence), otherwise we include it out of necessity, and go to the next \( t \). Clearly, this subsequence will include all \(+1\)s. Also, for each \(-1\) included in the sequence, a \(-1\) must have been skipped, so at most \(\lfloor \frac{1011}{2} \rfloor = 505\) can be included. Hence the sum is at least \( 1011 - 505 = 506 \), as desired.

Next, we prove that, for the \(\pm 1\)-sequence
\[
(\{-1\}, \{+1, +1\}, \{-1, -1\}, \{+1, +1\}, \ldots, \{+1, +1\}, \{-1, -1\}, \{+1\}),
\]
each admissible subsequence \( a_{t_{i}} \) has \(-506 \leq \sum_{i} a_{t_{i}} \leq 506\). We say that the terms inside each curly bracket is a _block_. In total, there are \( 1012 \) blocks - \( 506 \) of them hold \(+1\)s, and \( 506 \) of them hold \(-1\)s. (The two blocks at each end hold \( 1 \) number each, each other block holds \( 2 \).)

Suppose an admissible subsequence includes terms from \( k \) blocks holding \(+1\)s. Then, in each \(-1\)-pair in between the \(+1\)-pairs, the subsequence must also include at least one \(-1\). There can be at most two \(+1\)s included from each \(+1\)-block, and at least one \(-1\) must be included from each \(-1\)-block, so the sum is at most \( 2k - (k - 1) = k + 1 \).

For \( k < 506 \), this is at most \( 506 \). If \( k = 506 \), one of the \(+1\)-blocks must be the one at the end, meaning it can only include one \(+1\), so that the maximum in this case is only \( k \), not \( k + 1 \), so in this case the sum is also at most \( 506 \).

Hence we have shown that for any admissible subsequence, \( \sum_{i} a_{t_{i}} \leq 506 \). Analogously, we can show that \( -506 \leq \sum_{i} a_{t_{i}} \), meaning that \( C \leq 506 \) as desired.",506,combinatorics
2022c2,"The Bank of Oslo issues coins made out of two types of metal: aluminium (denoted \( A \)) and copper (denoted \( C \)). Morgane has \( n \) aluminium coins and \( n \) copper coins, and arranges her \( 2n \) coins in a row in some arbitrary initial order. Given a fixed positive integer \( k \leq 2n \), she repeatedly performs the following operation: identify the largest subsequence containing the \( k \)-th coin from the left which consists of consecutive coins made of the same metal, and move all coins in that subsequence to the left end of the row. For example, if \( n = 4 \) and \( k = 4 \), the process starting from the configuration \( AACCCACA \) would be
\[
AACCCACA \rightarrow CCCAAACA \rightarrow AAACCCCA \rightarrow CCCCAAAA \rightarrow \cdots
\]
Find all pairs \((n, k)\) with \( 1 \leq k \leq 2n \) such that for every initial configuration, at some point of the process there will be at most one aluminium coin adjacent to a copper coin. What is the maximum value of \(k\) when \(n=111\)?","First, consider the situation where 99 bowls have a capacity of 0.5 kilograms and
the last bowl has a capacity of 50.5 kilograms. No matter how Professor Oak distributes the
food, the dissatisfaction level of every Pokémon will be at least 0.5. This amounts to a total
dissatisfaction level of at least 50, proving that $D > 50$.

Now we prove that no matter what the capacities of the bowls are, Professor Oak can always
distribute the food in a way that the total dissatisfaction level is at most 50. We start by fixing
some notation. We number the Pokémon from 1 to 100. Let $C_i > 0$ be the capacity of the bowl
of the $i$th Pokémon. By assumption, 
\[
C_1 + C_2 + \cdots + C_{100} \;=\; 100.
\]
We write
\[
F_i \;=\; C_i \;-\; \lfloor C_i \rfloor
\]
for the fractional part of $C_i$. Without loss of generality, we may assume
\[
F_1 \;\le\; F_2 \;\le\; \cdots \;\le\; F_{100}.
\]
Here is a strategy: Professor Oak starts by giving $\lfloor C_i \rfloor$ kilograms of food to the $i$th
Pokémon.

Let
\[
R \;=\; 100 
   \;-\; \lfloor C_1 \rfloor 
   \;-\; \lfloor C_2 \rfloor 
   \;-\; \cdots 
   \;-\; \lfloor C_{100} \rfloor
   \;=\; F_1 + F_2 + \cdots + F_{100} 
   \;\ge\; 0
\]
be the amount of food left. He continues by giving an extra kilogram of food to the $R$ Pokémon
numbered $100-R+1, 100-R+2, \ldots, 100,$ i.e.\ the Pokémon with the $R$ largest values of $F_i$.
By doing so, Professor Oak distributes all 100 kilograms of food. The total dissatisfaction level
with this strategy is
\[
d \;:=\; F_1 + \cdots + F_{100-R} \;+\; 
         \bigl(1 - F_{100-R+1}\bigr) + \cdots + \bigl(1 - F_{100}\bigr).
\]

We can rewrite
\[
d \;=\; 2\bigl(F_1 + \cdots + F_{100-R}\bigr) 
        \;-\; \bigl(F_1 + \cdots + F_{100}\bigr)
        \;=\; 2\bigl(F_1 + \cdots + F_{100-R}\bigr).
\]
Now, observe that the arithmetic mean of $F_1, F_2, \ldots, F_{100-R}$ is not greater than the
arithmetic mean of $F_1, F_2, \ldots, F_{100}$, because $F_1 \;\le\; F_2 \;\le\; \cdots \;\le\; F_{100}$.
Therefore,
\[
d \;\le\; 2(100 - R)\,\frac{F_1 + \cdots + F_{100}}{100}
        \;=\; 2\,(100 - R)\,\frac{R}{100}.
\]
Finally, we use the AM--GM inequality to see that
\[
R\,(100-R) \;\le\; \frac{100^2}{2^2},
\]
which implies $d \;\le\; 50$. We conclude that there is always a distribution for which the total
dissatisfaction level is at most 50, proving that $D \le 50$.
All pairs $(n,k)$ such that $n \le k \le \frac{3n+1}{2}$.
So the maximum value of \(k\) when \(n=111\) is \(167\).",167,combinatorics
2022c3,"In each square of a garden shaped like a $2022 \times 2022$ board, there is initially a tree of height $0$. 
A gardener and a lumberjack alternate turns playing the following game, with the gardener taking the first turn:
\begin{itemize}
    \item The gardener chooses a square in the garden. Each tree on that square and all the surrounding squares
    (of which there are at most eight) then becomes one unit taller.
    \item The lumberjack then chooses four different squares on the board. Each tree of positive height on those
    squares then becomes one unit shorter.
\end{itemize}

We say that a tree is \emph{majestic} if its height is at least $10^6$. Determine the largest number $K$
such that the gardener can ensure there are eventually $K$ majestic trees on the board, no matter how
the lumberjack plays. You should arrive at this number by taking the problem solution modulo $1000$.
","**Solution.** We solve the problem for a general \( 3N \times 3N \) board. First, we prove that the lumberjack has a strategy to ensure there are never more than \( 5N^2 \) majestic trees. Giving the squares of the board coordinates in the natural manner, colour each square where at least one of its coordinates are divisible by 3, shown below for a \( 9 \times 9 \) board:

Then, as each \( 3 \times 3 \) square on the board contains exactly 5 coloured squares, each move of the gardener will cause at most 4 trees on non-coloured squares to grow. The lumberjack may therefore cut those trees, ensuring no tree on a non-coloured square has positive height after his turn. Hence there cannot ever be more majestic trees than coloured squares, which is \( 5N^2 \).

Next, we prove the gardener may ensure there are \( 5N^2 \) majestic trees. In fact, we prove this statement in a modified game which is more difficult for the gardener: on the lumberjack's turn in the modified game, he may decrement the height of all trees on the board except those the gardener did not just grow, in addition to four of the trees the gardener just grew. Clearly, a sequence of moves for the gardener which ensures that there are \( K \) majestic trees in the modified game also ensures this in the original game.

Let \( M = \binom{9}{5} \); we say that a map is one of the \( M \) possible ways to mark 5 squares on a \( 3 \times 3 \) board. In the modified game, after the gardener chooses a \( 3 \times 3 \) subboard on the board, the lumberjack chooses a map in this subboard, and the total result of the two moves is that each tree marked on the map increases its height by 1, each tree in the subboard which is not in the map remains unchanged, and each tree outside the subboard decreases its height by 1. Also note that if the gardener chooses a \( 3 \times 3 \) subboard \( MI \) times, the lumberjack will have to choose some map at least \( l \) times, so there will be at least 5 trees which each have height \( \geq l \).

The strategy for the gardener will be to divide the board into \( N^2 \) disjoint \( 3 \times 3 \) subboards, number them \( 0, \ldots, N^2 - 1 \) in some order. Then, for \( b = N^2 - 1, \ldots, 0 \) in order, he plays \( 10^6 M(M + 1)^b \) times on subboard number \( b \). Hence, on subboard number \( b \), the moves on that subboard will first ensure 5 of its trees grow by at least \( 10^6 (M + 1)^b \), and then each move after that will decrease their heights by 1. (As the trees on subboard \( b \) had height 0 before the gardener started playing there, no move made on subboards \( \geq b \) decreased their heights.) As the gardener makes \( 10^6 M(M + 1)^{b-1} + \ldots = 10^6 ((M + 1)^b - 1) \) moves after he finishes playing on subboard \( b \), this means that on subboard \( b \), there will be 5 trees of height at least \( 10^6 (M + 1)^b - 10^6 ((M + 1)^b - 1) = 10^6 \), hence each of the subboard has 5 majestic trees, which was what we wanted.

So \( K = 5 \cdot \frac{2022^2}{9} = 2271380 \). In general, for a \( 3N \times 3N \) board, \( K = 5N^2 \). After taking the problem solution modulo \(1000\), the answer is \(380\).",380,combinatorics
2022c5,"Let $m,n \ge 2$ be integers, let $X$ be a set with $n$ elements, and let $X_1, X_2, \ldots, X_m$ 
be pairwise distinct non-empty, not necessarily disjoint subsets of $X$. 
A function $f \colon X \to \{1, 2, \ldots, n+1\}$ is called \emph{nice} if there exists an index $k$ 
such that
\[
\sum_{x \in X_k} f(x) \;>\; \sum_{x \in X_i} f(x)
\quad \text{for all } i \neq k.
\]
If the number of nice functions is at least $L$, what is the value of $L$ when $n=7$. You should arrive at this number by taking the problem solution modulo $1000$.
","For a subset $Y \subseteq X$, we write $f(Y)$ for $\sum_{y \in Y} f(y)$. 
Note that a function $f \colon X \to \{1, \dots, n+1\}$ is nice if and only if $f(X_i)$ is maximized 
by a unique index $i \in \{1, \dots, m\}$.

We will first investigate the set $\mathcal{F}$ of functions $f \colon X \to \{1, \dots, n\}$; 
note that $\lvert \mathcal{F} \rvert = n^n$. 
For every function $f \in \mathcal{F}$, define a corresponding function 
$f^+ \colon X \to \{1,2,\dots,n+1\}$ in the following way: 
pick some set $X_\ell$ that maximizes the value $f(X_\ell)$. Then:
\begin{itemize}
  \item For all $x \in X_\ell$, define $f^+(x) = f(x) + 1$.
  \item For all $x \in X \setminus X_\ell$, define $f^+(x) = f(x)$.
\end{itemize}

\noindent
\textbf{Claim.} The resulting function $f^+$ is nice.

\noindent
\emph{Proof.}
Note that 
\[
f^+(X_i) \;=\; f(X_i) \;+\; \lvert X_i \cap X_\ell \rvert
\]
holds for all $X_i$. We show that $f^+(X_i)$ is maximized at the unique index $i = \ell$. 
Hence consider some arbitrary index $j \neq \ell$. 
Then $X_\ell \subset X_j$ is impossible, as this would imply $f(X_j) > f(X_\ell)$ 
and thereby contradict the choice of $X_\ell$; 
in particular this implies $\lvert X_j \rvert > \lvert X_j \cap X_\ell \rvert$. 
Therefore,
\[
f^+(X_\ell) \;=\; f(X_\ell) \;+\; \lvert X_\ell \rvert 
\;>\; f(X_j) \;+\; \lvert X_j \rvert 
\;>\; f(X_j) \;+\; \lvert X_j \cap X_\ell \rvert 
\;=\; f^+(X_j).
\]
The first inequality follows since $X_\ell$ was chosen to maximize $f(X_\ell)$. 
The second (strict) inequality follows from 
$\lvert X_\ell \rvert > \lvert X_j \cap X_\ell \rvert$ 
as observed above. 
This completes the proof of the claim. \qed

Next, observe that $f$ can be uniquely reconstructed from $f^+$: 
the claim yields that $f^+$ has a unique maximizer $X_\ell$, and by decreasing the value of $f^+$ on $X_\ell$ by $1$, 
we can fully determine the values of $f$. 
As each of the $n^n$ functions $f \in \mathcal{F}$ 
yields a (unique) corresponding nice function 
$f^+ \colon X \to \{1,2,\dots,n+1\}$, the proof is complete.
So the number of nice functions is at least $n^n$. After taking the problem solution modulo $1000$, the answer is $543$.",543,combinatorics
2022c6,"Let $n$ be a positive integer. We start with $n$ piles of pebbles, each initially containing a single pebble. 
One can perform moves of the following form: choose two piles, take an equal number of pebbles from each pile, 
and form a new pile out of these pebbles. For each positive integer $n$, if $n$ is not a power of two, find the smallest number of non-empty piles that one can obtain by performing a finite sequence of moves of this form.
","\textbf{Solution 1.} The solution we describe is simple, but not the most effective one.
We can combine two piles of \(2^{k-1}\) pebbles to make one pile of \(2^k\) pebbles. In particular, given \(2^k\) piles of one pebble, we may combine them as follows:
\[
\begin{array}{ccc}
2^k & \text{piles of 1 pebble} & \rightarrow & 2^{k-1} \text{piles of 2 pebbles} \\
2^{k-1} & \text{piles of 2 pebbles} & \rightarrow & 2^{k-2} \text{piles of 4 pebbles} \\
2^{k-2} & \text{piles of 4 pebbles} & \rightarrow & 2^{k-3} \text{piles of 8 pebbles} \\
\vdots & \vdots & \ddots & \vdots \\
2 & \text{piles of } 2^{k-1} & \text{pebbles} & \rightarrow & 1 \text{pile of } 2^k \text{ pebbles}
\end{array}
\]
This proves the desired result in the case when \(n\) is a power of 2.

If \(n\) is not a power of 2, choose \(N\) such that \(2^N < n < 2^{N+1}\). Let \(m = n - 2^N\). Then \(0 < m < 2^N\). Make a pile of \(2^N\) pebbles and call it the large pile. (Alternatively, one can be more efficient and make a pile of \(2^M\) pebbles where \(m \leq 2^M\).) Since \(n\) is not a power of two, there is at least one other pile with pebbles. All other piles have a single pebble (initial condition).

Choose one single pebble pile and remove the pebble and one pebble from the large pile and form a pile of 2 pebbles. If \(m < 2^N - 1\), remove another pebble from the large pile and one pebble from the 2-pile and form a new pile of 2 pebbles. Repeat until the large pile contains exactly \(m\) pebbles.

At this point we have one pile of \(m\) pebbles, one pile of 2 pebbles, and the rest are single pebble piles. There must be \(n - m - 2 = 2^N - 2\) single piles. Combine two and two into piles of two pebbles. Then there are \(2^{N-1}\) piles of two pebbles, which we can make into one pile of \(2^N\) pebbles. We are left with exactly two piles of pebbles.

Lastly we will prove that it is not possible to form a single pile with all pebbles when \(n\) is not a power of two. A move consists of choosing two piles of say \(a\) and \(b\) pebbles, then removing \(c \leq \min(a, b)\) pebbles from both piles, and forming a new pile with \(2c\) pebbles. If we include piles of zero pebbles, then this move changes the number of pebbles in three piles as follows (and leaves all other piles unchanged):
\[
\begin{array}{ccc}
a & \rightarrow & a - c \\
b & \rightarrow & b - c \\
0 & \rightarrow & 2c
\end{array}
\]
Assume that after the move the number of pebbles in each pile is divisible by an odd integer \(m\). In particular, \(m|2c\), \(m|a - c\) and \(m|b - c\). Since \(m\) is odd, it follows that \(m|c\), and then that \(m|a\) and \(m|b\). Hence also before the move the number of pebbles in each pile is divisible by the integer \(m\).

If \(n\) is not a power of 2, then \(n\) is divisible by an odd integer \(m > 1\). In order to make a single pile of \(n\) pebbles, we would have to start with a distribution in which the number of pebbles in each pile is divisible by the integer \(m\). This is impossible when we start with all piles containing a single pebble.

\section*{Shortlisted problems – solutions}

\subsection*{Remarks on starting configurations}
From any starting configuration that is not a single pile, if there are at least two piles with at least two pebbles, we can remove one pebble from two such piles, and form a new pile with 2 pebbles. We can repeat this until we have one pile of 2 pebbles and the rest are single pebble piles, and then proceed as in the solution. Hence, if \(n\) is a power of two, we can make a single pile from any starting configuration.

If \(n\) is of the form \(n = 2^km\) where \(m > 1\) is odd, then we can make a single pile from any starting configuration in which the number of pebbles in each pile is divisible by the integer \(m\), otherwise two piles is the best we can do. Half of this is proven already. For the other half, assume we start with a configuration in which the number of pebbles in each pile is divisible by the integer \(m\). Replace each pile of \(tm\) pebbles with a pile of \(t\) boulders. We now have a total of \(2^k\) boulders, hence we can make them into one pile of \(2^k\) boulders. Replacing the boulders with pebbles again, we are done.",2,combinatorics
2022c7,"Lucy starts by writing \( s \) integer-valued 2022-tuples on a blackboard. After doing that, she can take any two (not necessarily distinct) tuples \( \mathbf{v} = (v_1, \ldots, v_{2022}) \) and \( \mathbf{w} = (w_1, \ldots, w_{2022}) \) that she has already written, and apply one of the following operations to obtain a new tuple:

\[
\mathbf{v} + \mathbf{w} = (v_1 + w_1, \ldots, v_{2022} + w_{2022})
\]
\[
\mathbf{v} \lor \mathbf{w} = (\max(v_1, w_1), \ldots, \max(v_{2022}, w_{2022}))
\]

and then write this tuple on the blackboard.

It turns out that, in this way, Lucy can write any integer-valued 2022-tuple on the blackboard after finitely many steps. What is the smallest possible number \( s \) of tuples that she initially wrote?","\textbf{Solution.} We solve the problem for \(n\)-tuples for any \(n \geqslant 3\): we will show that the answer is \(s = 3\), regardless of the value of \(n\).

First, let us briefly introduce some notation. For an \(n\)-tuple \(\mathbf{v}\), we will write \(\mathbf{v}_{i}\) for its \(i\)-th coordinate (where \(1 \leqslant i \leqslant n\)). For a positive integer \(n\) and a tuple \(\mathbf{v}\), we will denote by \(n \cdot \mathbf{v}\) the tuple obtained by applying addition on \(\mathbf{v}\) with itself \(n\) times. Furthermore, we denote by \(\mathbf{e}(i)\) the tuple which has \(i\)-th coordinate equal to one and all the other coordinates equal to zero. We say that a tuple is \textit{positive} if all its coordinates are positive, and \textit{negative} if all its coordinates are negative.

We will show that three tuples suffice, and then that two tuples do not suffice.

\subsection*{Three tuples suffice.}
Write \(\mathbf{c}\) for the constant-valued tuple \(\mathbf{c} = (-1, \ldots, -1)\).

We note that it is enough for Lucy to be able to make the tuples \(\mathbf{e}(1), \ldots, \mathbf{e}(n), \mathbf{c}\); from those any other tuple \(\mathbf{v}\) can be made as follows. First, we choose some positive integer \(k\) such that \(k + \mathbf{v}_{i} > 0\) for all \(i\). Then, by adding a positive number of copies of \(\mathbf{c}, \mathbf{e}(1), \ldots, \mathbf{e}(n)\), she can make

\[
k\mathbf{c} + (k + \mathbf{v}_{1}) \cdot \mathbf{e}(1) + \cdots + (k + \mathbf{v}_{n}) \cdot \mathbf{e}(n),
\]

which we claim is equal to \(\mathbf{v}\). Indeed, this can be checked by comparing coordinates: the \(i\)-th coordinate of the right-hand side is \(-k + (k + \mathbf{v}_{i}) = \mathbf{v}_{i}\) as needed.

Lucy can take her three starting tuples to be \(\mathbf{a}\), \(\mathbf{b}\), and \(\mathbf{c}\), such that \(\mathbf{a}_{i} = -i^{2}\), \(\mathbf{b}_{i} = i\), and \(\mathbf{c} = -1\) (as above).

For any \(1 \leqslant j \leqslant n\), write \(\mathbf{d}(j)\) for the tuple \(2 \cdot \mathbf{a} + 4j \cdot \mathbf{b} + (2j^{2} - 1) \cdot \mathbf{c}\), which Lucy can make by adding together \(\mathbf{a}\), \(\mathbf{b}\), and \(\mathbf{c}\) repeatedly. This has \(i\)-th term

\[
\mathbf{d}(j)_{i} = 2\mathbf{a}_{i} + 4j\mathbf{b}_{i} + (2j^{2} - 1)\mathbf{c}_{i} = -2i^{2} + 4ij - (2j^{2} - 1) = 1 - 2(i - j)^{2}.
\]

This is \(1\) if \(j = i\), and at most \(-1\) otherwise. Hence Lucy can produce the tuple \(\mathbf{1} = (1, \ldots, 1)\) as \(\mathbf{d}(1) \vee \cdots \vee \mathbf{d}(n)\).

She can then produce the constant tuple \(\mathbf{0} = (0, \ldots, 0)\) as \(\mathbf{1} + \mathbf{c}\), and for any \(1 \leqslant j \leqslant n\) she can then produce the tuple \(\mathbf{e}(j)\) as \(\mathbf{d}(j) \vee \mathbf{0}\). Since she can now produce \(\mathbf{e}(1), \ldots, \mathbf{e}(n)\) and already had \(\mathbf{c}\), she can (as we argued earlier) produce any integer-valued tuple.

\subsection*{Two tuples do not suffice.}
We start with an observation: Let \(a\) be a non-negative real number and suppose that two tuples \(\mathbf{v}\) and \(\mathbf{w}\) satisfy \(\mathbf{v}_{j} \geqslant a\mathbf{v}_{k}\) and \(\mathbf{w}_{j} \geqslant a\mathbf{w}_{k}\) for some \(1 \leqslant j, k \leqslant n\). Then we claim that the same inequality holds for \(\mathbf{v} + \mathbf{w}\) and \(\mathbf{v} \vee \mathbf{w}\): Indeed, the property for the sum is verified by an easy computation:

\[
(\mathbf{v} + \mathbf{w})_{j} = \mathbf{v}_{j} + \mathbf{w}_{j} \geqslant a\mathbf{v}_{k} + a\mathbf{w}_{k} = a(\mathbf{v} + \mathbf{w})_{k}.
\]

For the second operation, we denote by \(\mathbf{m}\) the tuple \(\mathbf{v} \vee \mathbf{w}\). Then \(\mathbf{m}_{j} \geqslant \mathbf{v}_{j} \geqslant a\mathbf{v}_{k}\) and \(\mathbf{m}_{j} \geqslant \mathbf{w}_{j} \geqslant a\mathbf{w}_{k}\). Since \(\mathbf{m}_{k} = \mathbf{v}_{k}\) or \(\mathbf{m}_{k} = \mathbf{w}_{k}\), the observation follows.

As a consequence of this observation, we have that if all starting tuples satisfy such an inequality, then all generated tuples will also satisfy it, and so we would not be able to obtain every integer-valued tuple.

Let us now prove that Lucy needs at least three starting tuples. For contradiction, let us suppose that Lucy started with only two tuples \(\mathbf{v}\) and \(\mathbf{w}\). We are going to distinguish two cases. In the first case, suppose we can find a coordinate \(i\) such that \(\mathbf{v}_{i}, \mathbf{w}_{i} \geqslant 0\). Both operations preserve the sign, thus we cannot generate any tuple that has a negative \(i\)-th coordinate. Similarly for \(\mathbf{v}_{i}, \mathbf{w}_{i} \leqslant 0\).

Suppose the opposite, i.e., for every \(i\) we have either \(\mathbf{v}_{i} > 0 > \mathbf{w}_{i}\), or \(\mathbf{v}_{i} < 0 < \mathbf{w}_{i}\). Since we assumed that our tuples have at least three coordinates, by the pigeonhole principle there exist two coordinates \(j \neq k\) such that \(\mathbf{v}_{j}\) has the same sign as \(\mathbf{v}_{k}\) and \(\mathbf{w}_{j}\) has the same sign as \(\mathbf{w}_{k}\) (because there are only two possible combinations of signs).

Without loss of generality, assume that \(\mathbf{v}_{j}, \mathbf{v}_{k} > 0\) and \(\mathbf{w}_{j}, \mathbf{w}_{k} < 0\). Let us denote the positive real number \(\mathbf{v}_{j}/\mathbf{v}_{k}\) by \(a\). If \(\mathbf{w}_{j}/\mathbf{w}_{k} \leqslant a\), then both inequalities \(\mathbf{v}_{j} \geqslant a\mathbf{v}_{k}\) and \(\mathbf{w}_{j} \geqslant a\mathbf{w}_{k}\) are satisfied. On the other hand, if \(\mathbf{w}_{j}/\mathbf{w}_{k} \leqslant a\), then both \(\mathbf{v}_{k} \geqslant (1/a)\mathbf{v}_{j}\) and \(\mathbf{w}_{k} \geqslant (1/a)\mathbf{w}_{j}\) are satisfied. In either case, we have found the desired inequality satisfied by both starting tuples, a contradiction with the observation above.",3,combinatorics
2022c8,"Alice fills the fields of an $n \times n$ board with the numbers from $1$ to $n^2$, 
each number being used exactly once. She then counts the total number of \emph{good paths} on the board. 
A good path is a sequence of fields of arbitrary length (including just one field) such that:
\begin{enumerate}
    \item The first field in the sequence is one that is only adjacent to fields with larger numbers,
    \item Each subsequent field in the sequence is adjacent to the previous field,
    \item The numbers written on the fields in the sequence are in strictly increasing order.
\end{enumerate}

Two fields are considered adjacent if they share a common side. 
Find the smallest possible number of good paths Alice can obtain, as a function of $n$ when $n=12$.
","\textbf{Solution.} We will call any field that is only adjacent to fields with larger numbers a well. 
Other fields will be called non-wells. Let us make a second $n \times n$ board $B$ where in each field 
we will write the number of good sequences which end on the corresponding field in the original board $A$. 
We will thus look for the minimal possible value of the sum of all entries in $B$.

We note that any well has just one good path ending in it, consisting of just the well, 
and that any other field has the number of good paths ending in it equal to the sum of this quantity 
for all the adjacent fields with smaller values, 
since a good path can only come into the field from a field of lower value. 
Therefore, if we fill in the fields in $B$ in increasing order with respect to their values in $A$, 
it follows that each field not adjacent to any already filled field will receive a $1$, 
while each field adjacent to already filled fields will receive the sum of the numbers 
already written on these adjacent fields.

We note that there is at least one well in $A$, that corresponding with the field with the entry 1 in $A$. 
Hence, the sum of values of fields in $B$ corresponding to wells in $A$ is at least 1. 
We now try to minimize the sum of the non-well entries, i.e.\ the entries in $B$ corresponding to the non-wells in $A$. 
We note that we can ascribe to each pair of adjacent fields the value of the lower assigned number 
and that the sum of the non-well entries will then equal the sum of these ascribed numbers. 
Since the lower number is still at least 1, the sum of the non-well entries will at least equal 
the number of pairs of adjacent fields, which is $2n(n-1)$. 
Hence, the total minimum sum of entries in $B$ is at least $2n(n-1) + 1 = 2n^2 - 2n + 1$. 
The necessary conditions for the minimum to be achieved is for there to be only one well 
and for no two entries in $B$ larger than 1 to be adjacent to each other.

We will now prove that this lower limit of $2n^2 - 2n + 1$ entries can be achieved. 
This amounts to finding a way of marking a certain set of squares, 
those that have a value of 1 in $B$, such that no two unmarked squares are adjacent 
and that the marked squares form a connected tree with respect to adjacency.

For $n=1$ and $n=2$ the markings are respectively the lone field and the L-trimino. 
Now, for $n \ge 2$ let $s = 2$ for $n \equiv 0,2 \pmod{3}$ 
and $s = 1$ for $n \equiv 1 \pmod{3}$. 
We will take indices $k$ and $l$ to be arbitrary non-negative integers. 
For $n \ge 3$ we will construct a path of marked squares in the first two columns 
consisting of all squares of the form $(1,i)$ where $i$ is not of the form $6k+s$ 
and $(2,j)$ where $j$ is of the form $6k + s - 1$, $6k + s$, or $6 + s + 1$. 
Obviously, this path is connected.

Next, let us consider the fields $(2,\,6k + s)$ and $(1,\,6k + s + 3)$. 
For each considered field $(i,j)$ we will mark all squares of the form $(l,j)$ for $l>i$ 
and the squares $(i + 2k,\, j + 1)$. 
One can easily see that no set of marked fields will produce a cycle, 
that the only fields of the unmarked form $(1,\,6k + s)$ 
and $\bigl(2 + 2l,\,6k + s + 3 \pm 1\bigr)$ 
are not adjacent, 
since the consecutive considered fields are in columns of opposite parity. 
So the smallest possible number is \( 2n^2 - 2n + 1 \), as a function of n. And the value is \(265\)

",265,combinatorics
2022c9,"Let $\mathbb{Z}_{\ge 0}$ be the set of non-negative integers, and let 
\[
f \colon \mathbb{Z}_{\ge 0} \times \mathbb{Z}_{\ge 0} \;\to\; \mathbb{Z}_{\ge 0}
\]
be a bijection such that whenever $f(x_1, y_1) > f(x_2, y_2)$, we have
\[
f(x_1 + 1, y_1) \;>\; f(x_2 + 1, y_2)
\quad\text{and}\quad
f(x_1, y_1 + 1) \;>\; f(x_2, y_2 + 1).
\]
Let $N$ be the number of pairs of integers $(x,y)$, with $0 \le x,y < 100$, 
such that $f(x,y)$ is odd. Find the largest possible value of $N$.
","\textbf{Solution.} We defer the constructions to the end of the solution. Instead, we begin by
characterizing all such functions $f$, prove a formula and key property for such functions, and then
solve the problem, providing constructions.

\medskip
\noindent
\textbf{Characterization.}
Suppose $f$ satisfies the given relation. The condition can be written more strongly as
\[
f(x_{1},y_{1}) > f(x_{2},y_{2})
\;\;\Longleftrightarrow\;\;
f(x_{1}+1,\,y_{1}) > f(x_{2}+1,\,y_{2})
\;\;\text{and}\;\;
f(x_{1},\,y_{1}+1) > f(x_{2},\,y_{2}+1).
\]
In particular, this means for any $(k,l) \in \mathbb{Z}^2$, 
\[
f(x+k,\,y+l) \;-\; f(x,y)
\]
has the same sign for all $x$ and $y$.

Call a non-zero vector $(k,l) \in \mathbb{Z}_{\ge 0} \times \mathbb{Z}_{\ge 0}$ a \emph{needle} if 
\[
f(x + k,\,y + l) \;-\; f(x,y) \;>\; 0
\]
for all $x$ and $y$. It is not hard to see that needles and non-needles are both closed under addition,
and thus under scalar division (whenever the quotient lives in $\mathbb{Z}^2$). In addition, call a positive rational
number $\tfrac{k}{l}$ a \emph{grade} if the vector $(k,l)$ is a needle. (Since needles are closed under
scalar multiples and quotients, this is well-defined.)

\medskip
\noindent
\textbf{Claim.} \emph{Grades are closed upwards.}

\noindent
\emph{Proof.}
Consider positive rationals $k_{1}/l_{1} < k_{2}/l_{2}$ with $k_{1}/l_{1}$ a grade. Then:
\[
(k_{1}, l_{1}) 
\;\;\text{is a needle},
\]
so
\[
(k_{1}l_{2},\,l_{1}l_{2}) 
\;\;\text{is a needle},
\]
so
\[
(k_{2}l_{1},\,l_{2}l_{1})
\;\;\text{is a needle}
\;\;\text{(since $k_{2}l_{1} - k_{1}l_{2} > 0$) and $(1,0)$ is a needle}.
\]
Thus $(k_{2}, l_{2})$ is a needle, as wanted.
\qed

\medskip
\noindent
\textbf{Claim.} \emph{A grade exists.}

\noindent
\emph{Proof.}
If no positive integer $n$ is a grade, then $f(1,0) > f(0,n)$ for all $n$, which is impossible.

Similarly, there is an $n$ such that $f(0,1) < f(n,0)$, thus $1/n$ is not a grade for some large $n$.
That means that small positive rational values are not grades, then there is a switch, and after that
all values are grades. Call the place of that switch $\alpha$. Here $\alpha$ is the infimum of the grades.
\qed

\medskip
\noindent
\textbf{Claim (Key property).}
\emph{If $x_{1} + y_{1}\alpha > x_{2} + y_{2}\alpha$ then $f(x_{1},y_{1}) > f(x_{2},y_{2})$.}

\noindent
\emph{Proof.}
If both $x_{1} \ge x_{2}$ and $y_{1} \g",7500,combinatorics
2022n1,"\textbf{N1.} A number is called \emph{Norwegian} if it has three distinct positive divisors 
whose sum is equal to 2022. Determine the smallest Norwegian number.

\noindent
(\textit{Note: The total number of positive divisors of a Norwegian number may exceed three.})","\textbf{Solution.} 
Observe that 1344 is a Norwegian number as 6, 672 and 1344 are three distinct divisors of 1344 and 
$6 + 672 + 1344 = 2022.$ It remains to show that this is the smallest such number.

Assume for contradiction that $N < 1344$ is Norwegian and let $N/a$, $N/b$ and $N/c$ be the three distinct 
divisors of $N$, with $a < b < c.$ Then
\[
2022 \;=\; N \Bigl(\tfrac{1}{a} + \tfrac{1}{b} + \tfrac{1}{c}\Bigr)
\;<\;
1344 \Bigl(\tfrac{1}{a} + \tfrac{1}{b} + \tfrac{1}{c}\Bigr),
\]
and so
\[
\tfrac{1}{a} + \tfrac{1}{b} + \tfrac{1}{c}
\;>\;
\tfrac{2022}{1344} 
\;=\;
\tfrac{337}{224}
\;=\;
\tfrac{3}{2} \;+\;\tfrac{1}{224}.
\]
If $a > 1$ then
\[
\tfrac{1}{a} + \tfrac{1}{b} + \tfrac{1}{c}
\;\le\;
\tfrac{1}{2} + \tfrac{1}{3} + \tfrac{1}{4}
\;=\;
\tfrac{13}{12}
\;<\;
\tfrac{3}{2},
\]
so it must be the case that $a = 1.$ Similarly, it must hold that $b < 4$ since otherwise
\[
1 + \tfrac{1}{b} + \tfrac{1}{c}
\;\le\;
1 \;+\;\tfrac{1}{4} \;+\;\tfrac{1}{5}
\;=\;
\tfrac{3}{2}.
\]

This leaves two cases to check, $b = 2$ and $b = 3.$

\medskip

\noindent
\textbf{Case $b = 3$.}
Then
\[
\tfrac{1}{c}
\;>\;
\tfrac{3}{2}
\;-\;
\tfrac{1}{224}
\;-\;
1
\;=\;
\tfrac{1}{3}
\;>\;
\tfrac{1}{6},
\]
so $c = 4$ or $c = 5.$ If $c = 4$ then
\[
2022
\;=\;
N \Bigl(1 + \tfrac{1}{3} + \tfrac{1}{4}\Bigr)
\;=\;
\tfrac{19}{12} N,
\]
but this is impossible as $19 \nmid 2022.$ If $c = 5$ then
\[
2022
\;=\;
N \Bigl(1 + \tfrac{1}{3} + \tfrac{1}{5}\Bigr)
\;=\;
\tfrac{23}{15} N,
\]
which again is impossible, as $23 \nmid 2022.$

\medskip

\noindent
\textbf{Case $b = 2$.}
Note that $c < 224$ since
\[
\tfrac{1}{c}
\;>\;
\tfrac{3}{2} \;+\;\tfrac{1}{224} 
\;-\;
1 
\;-\;
\tfrac{1}{2}
\;=\;
\tfrac{1}{224}.
\]
It holds that
\[
2022
\;=\;
N \Bigl(1 + \tfrac{1}{2} + \tfrac{1}{c}\Bigr)
\;=\;
\tfrac{3c + 2}{2c}\,N
\;\Longrightarrow\;
(3c + 2)N
\;=\;
4044\,c.
\]
Since $(c,3c-2) = (c,2) \in \{1,2\},$ then $3c + 2 \mid 8088 = 2^3 \cdot 3 \cdot 337$ which implies that 
$3c + 2 \mid 2^3 \cdot 337.$ But since $3c + 2 > 3 \cdot 3 + 2 = 8 \neq 2^3$ 
and $3c + 2 \neq 337,$ then it must hold that $3c + 2 \ge 2 \cdot 337,$ contradicting $c < 224.$",1344,number theory
2022n2,"\textbf{N2.} Find all positive integers $n > 2$ such that
\[
n! \;\Bigl|\; \prod_{\substack{p<q\le n \\ p,q\text{ primes}}} (p+q).
\]
","\textbf{Solution.}
Assume that $n$ satisfies 
\[
n! \;\Bigl|\; \prod_{p < q \le n} (p+q)
\]
and let $2 = p_1 < p_2 < \dots < p_m \le n$ be the primes in $\{1,2,\dots,n\}$. 
Each such prime divides $n!$. In particular, $p_m \mid p_i + p_j$ for some $p_i < p_j \le n$. 
But
\[
0 \;<\; \frac{p_i + p_j}{p_m} \;<\; \frac{p_m + p_m}{p_m} \;=\; 2,
\]
so $p_m = p_i + p_j$ which implies $m \ge 3$, $p_i = 2$ and 
\[
p_m \;=\; 2 + p_j \;=\; 2 + p_{m-1}.
\]
Similarly, $p_{m-1} \mid p_k + p_l$ for some $p_k < p_l \le n$. But
\[
0 \;\le\; \frac{p_l + p_k}{p_{m-1}}
\;\le\; 
\frac{p_m + p_{m-1}}{p_{m-1}}
\;=\; 
\frac{2p_{m-1} + 2}{p_{m-1}}
\;<\;
3,
\]
so either $p_{m-1} = p_l + p_k$ or $2p_{m-1} = p_l + p_k$. 

As above, the former case gives $p_{m-1} = 2 + p_{m-2}$. If $2p_{m-1} = p_l + p_k$, then $p_{m-1} < p_k$, so $k = m$ and
\[
2p_{m-1} \;=\; p_l + p_{m-1} + 2
\;\Longrightarrow\; 
p_{m-1} \;=\; p_l + 2 
\;=\; p_{m-2} + 2.
\]
Either way, $p_{m-2} > 2$ and $3$ divides one of $p_{m-2},\, p_{m-1} = p_{m-2} + 2,\, p_m = p_{m-2} + 4$. 
This implies $p_{m-2} = 3$ and thus $p_m = 7$, giving $7 \le n < 11$.

Finally, a quick computation shows that
\[
7! 
\;\Bigl|\; 
\prod_{p < q < 7} (p+q)
\quad 
\text{but}
\quad 
8! 
\;\nmid\; 
\prod_{p < q < 7} (p+q),
\]
so neither $9!$ nor $10!$ divides $\prod_{p<q<7}(p+q)$.",7,number theory
2022n4,"\textbf{N4.} Find all triples of positive integers \((a, b, p)\) with \(p\) prime and  
\[
a^p = b! + p.
\]
For each such triple, calculate the sum \(a+b+p\). Determine the sum of \(a+b+p\) for all possible triples.","\textbf{Solution 1.} Clearly, \(a > 1\). We consider three cases.

\textbf{Case 1:} We have \(a < p\). Then we either have \(a \leqslant b\) which implies \(a \mid a^{p} - b! = p\) leading to a contradiction, or \(a > b\) which is also impossible since in this case we have \(b! \leqslant a! < a^{p} - p\), where the last inequality is true for any \(p > a > 1\).

\textbf{Case 2:} We have \(a > p\). In this case \(b! = a^{p} - p > p^{p} - p \geqslant p!\) so \(b > p\) which means that \(a^{p} = b! + p\) is divisible by \(p\). Hence, \(a\) is divisible by \(p\) and \(b! = a^{p} - p\) is not divisible by \(p^{2}\). This means that \(b < 2p\). If \(a < p^{2}\) then \(a/p < p\) divides both \(a^{p}\) and \(b!\) and hence it also divides \(p = a^{p} - b!\) which is impossible. On the other hand, the case \(a \geqslant p^{2}\) is also impossible since then \(a^{p} \geqslant (p^{2})^{p} > (2p - 1)! + p \geqslant b! + p\).

\textbf{Comment.} The inequality \(p^{2p} > (2p - 1)! + p\) can be shown e.g. by using

\[
(2p - 1)! = [1 \cdot (2p - 1)] \cdot [2 \cdot (2p - 2)] \cdot \cdots \cdot [(p - 1)(p + 1)] \cdot p < \left(\left(\frac{2p}{2}\right)^{2}\right)^{p - 1} \cdot p = p^{2p - 1},
\]

where the inequality comes from applying AM-GM to each of the terms in square brackets.

\textbf{Case 3:} We have \(a = p\). In this case \(b! = p^{p} - p\). One can check that the values \(p = 2, 3\) lead to the claimed solutions and \(p = 5\) does not lead to a solution. So we now assume that \(p \geqslant 7\). We have \(b! = p^{p} - p > p!\) and so \(b \geqslant p + 1\) which implies that

\[
v_{2}\big{(}(p + 1)!) \leqslant v_{2}(b!) = v_{2}(p^{p - 1} - 1) \stackrel{{ LTE}}{{=}} 2v_{2}(p - 1) + v_{2}(p + 1) - 1 = v_{2}\bigg{(}\frac{p - 1}{2} \cdot (p - 1) \cdot (p + 1)\bigg{)},
\]

where in the middle we used lifting-the-exponent lemma. On the RHS we have three factors of \((p + 1)!\). But, due to \(p + 1 \geqslant 8\), there are at least 4 even numbers among \(1, 2, \ldots, p + 1\), so this case is not possible.

So all triples are  \( (2, 2, 2) \) and \( (3, 4, 3) \). And the sum of \(a+b+p\) for all possible triples is \(16\).",16,number theory
2021a2,"\textbf{A2.}  
For every integer \( n \geq 1 \) consider the \( n \times n \) table with entry \(\left| \frac{ij}{n+1} \right|\) at the intersection of row \( i \) and column \( j \), for every \( i = 1, \ldots, n \) and \( j = 1, \ldots, n \). Determine the smallest integers \( n \geq 1 \) for which the sum of the \( n^2 \) entries in the table is equal to \(\frac{1}{4} n^2 (n-1)\) and \(n\) is not a prime.","\textbf{Solution 1.} First, observe that every pair \( x, y \) of real numbers for which the sum \( x + y \) is integer satisfies
\[
|x| + |y| \geq x + y - 1.
\]
(1)

The inequality is strict if \( x \) and \( y \) are integers, and it holds with equality otherwise.

We estimate the sum \( S \) as follows.
\[
2S = \sum_{1 \leq i, j \leq n} \left( \left\lfloor \frac{ij}{n+1} \right\rfloor + \left\lfloor \frac{ij}{n+1} \right\rfloor \right) = \sum_{1 \leq i, j \leq n} \left( \left\lfloor \frac{ij}{n+1} \right\rfloor + \left\lfloor \frac{(n+1-i)j}{n+1} \right\rfloor \right)
\]
\[
\geq \sum_{1 \leq i, j \leq n} (j-1) = \frac{(n-1)n^2}{2}.
\]

The inequality in the last line follows from (1) by setting \( x = \frac{ij}{n+1} \) and \( y = \frac{(n+1-i)j}{n+1} \), so that \( x + y = j \) is integral.

Now \( S = \frac{1}{4}n^2(n-1) \) if and only if the inequality in the last line holds with equality, which means that none of the values \( \frac{ij}{n+1} \) with \( 1 \leq i, j \leq n \) may be integral.

Hence, if \( n+1 \) is composite with factorisation \( n+1 = ab \) for \( 2 \leq a, b \leq n \), one gets a strict inequality for \( i = a \) and \( j = b \). If \( n+1 \) is a prime, then \( \frac{ij}{n+1} \) is never integral and \( S = \frac{1}{4}n^2(n-1) \).
Since \(n\) is not a prime, the answer is \(4\).",4,algebra
2021a3,"Given a positive integer \( n \), find the smallest value of  
\[
\left\lfloor \frac{a_1}{1} \right\rfloor + \left\lfloor \frac{a_2}{2} \right\rfloor + \cdots + \left\lfloor \frac{a_n}{n} \right\rfloor
\]  
over all permutations \((a_1, a_2, \ldots, a_n)\) of \((1, 2, \ldots, n)\) when \(n=200\).","\textbf{Solution 1.} Suppose that \(2^k \leq n < 2^{k+1}\) with some nonnegative integer \(k\). First we show a permutation \((a_1, a_2, \ldots, a_n)\) such that \(\left\lfloor \frac{a_1}{1} \right\rfloor + \left\lfloor \frac{a_2}{2} \right\rfloor + \cdots + \left\lfloor \frac{a_n}{n} \right\rfloor = k + 1\); then we will prove that \(\left\lfloor \frac{a_1}{1} \right\rfloor + \left\lfloor \frac{a_2}{2} \right\rfloor + \cdots + \left\lfloor \frac{a_n}{n} \right\rfloor \geq k + 1\) for every permutation. Hence, the minimal possible value will be \(k + 1\).

I. Consider the permutation

\[
(a_1) = (1), \quad (a_2, a_3) = (3, 2), \quad (a_4, a_5, a_6, a_7) = (7, 4, 5, 6), \quad \ldots
\]

\[
(a_{2^k-1}, \ldots, a_{2^k-1}) = (2^k - 1, 2^{k-1}, 2^{k-1} + 1, \ldots, 2^k - 2),
\]

\[
(a_{2^k}, \ldots, a_n) = (n, 2^k, 2^k + 1, \ldots, n - 1).
\]

This permutation consists of \(k + 1\) cycles. In every cycle \((a_p, \ldots, a_q) = (q, p, p + 1, \ldots, q - 1)\) we have \(q < 2p\), so

\[
\sum_{i=p}^{q} \left\lfloor \frac{a_i}{i} \right\rfloor = \left\lfloor \frac{q}{p} \right\rfloor + \sum_{i=p+1}^{q} \left\lfloor \frac{i-1}{i} \right\rfloor = 1;
\]

The total sum over all cycles is precisely \(k + 1\).

II. In order to establish the lower bound, we prove a more general statement.

\textbf{Claim.} If \(b_1, \ldots, b_{2^k}\) are distinct positive integers then

\[
\sum_{i=1}^{2^k} \left\lfloor \frac{b_i}{i} \right\rfloor \geq k + 1.
\]

From the Claim it follows immediately that \(\sum_{i=1}^{n} \left\lfloor \frac{a_i}{i} \right\rfloor \geq \sum_{i=1}^{2^k} \left\lfloor \frac{a_i}{i} \right\rfloor \geq k + 1\).

\textbf{Proof of the Claim.} Apply induction on \(k\). For \(k = 1\) the claim is trivial, \(\left\lfloor \frac{b_1}{1} \right\rfloor \geq 1\). Suppose the Claim holds true for some positive integer \(k\), and consider \(k + 1\).

If there exists an index \(j\) such that \(2^k < j \leq 2^{k+1}\) and \(b_j \geq j\) then

\[
\sum_{i=1}^{2^{k+1}} \left\lfloor \frac{b_i}{i} \right\rfloor \geq \sum_{i=1}^{2^k} \left\lfloor \frac{b_i}{i} \right\rfloor + \left\lfloor \frac{b_j}{j} \right\rfloor \geq (k + 1) + 1
\]

by the induction hypothesis, so the Claim is satisfied.

Otherwise we have \(b_j < j \leq 2^{k+1}\) for every \(2^k < j \leq 2^{k+1}\). Among the \(2^{k+1}\) distinct numbers \(b_1, \ldots, b_{2^{k+1}}\) there is some \(b_m\) which is at least \(2^{k+1}\); that number must be among \(b_1, \ldots, b_{2^k}\). Hence, \(1 \leq m \leq 2^k\) and \(b_m \geq 2^{k+1}\).

We will apply the induction hypothesis to the numbers

\[
c_1 = b_1, \ldots, c_{m-1} = b_{m-1}, \quad c_m = b_{2^k+1}, \quad c_{m+1} = b_{m+1}, \ldots, c_{2^k} = b_{2^k},
\]

so take the first \(2^k\) numbers but replace \(b_m\) with \(b_{2^k+1}\). Notice that

\[
\left\lfloor \frac{b_m}{m} \right\rfloor \geq \left\lfloor \frac{2^{k+1}}{m} \right\rfloor = \left\lfloor \frac{2^k + 2^k}{m} \right\rfloor \geq \left\lfloor \frac{b_{2^k+1} + m}{m} \right\rfloor = \left\lfloor \frac{c_m}{m} \right\rfloor + 1.
\]

For the other indices \(i\) with \(1 \leq i \leq 2^k\), \(i \neq m\) we have \(\left\lfloor \frac{b_i}{i} \right\rfloor = \left\lfloor \frac{c_i}{i} \right\rfloor\), so

\[
\sum_{i=1}^{2^{k+1}} \left\lfloor \frac{b_i}{i} \right\rfloor = \sum_{i=1}^{2^k} \left\lfloor \frac{b_i}{i} \right\rfloor \geq \sum_{i=1}^{2^k} \left\lfloor \frac{c_i}{i} \right\rfloor + 1 \geq (k + 1) + 1.
\]

That proves the Claim and hence completes the solution. 
So the minimun is \(8\).",8,algebra
2021a6,"Let \( A \) be a finite set of (not necessarily positive) integers, and let \( m \geq 2 \) be an integer. Assume that there exist non-empty subsets \( B_1, B_2, B_3, \ldots, B_m \) of \( A \) whose elements add up to the sums \( m^1, m^2, m^3, \ldots, m^m \), respectively. How many elements does \( A \) at least contains when \(m=200\)","\textbf{Solution.} Let \( A = \{a_1, \ldots, a_k\} \). Assume that, on the contrary, \( k = |A| < m/2 \). Let

\[
s_i := \sum_{j: a_j \in B_i} a_j
\]

be the sum of elements of \( B_i \). We are given that \( s_i = m^i \) for \( i = 1, \ldots, m \).

Now consider all \( m^m \) expressions of the form

\[
f(c_1, \ldots, c_m) := c_1 s_1 + c_2 s_2 + \ldots + c_m s_m, \quad c_i \in \{0, 1, \ldots, m - 1\} \text{ for all } i = 1, 2, \ldots, m.
\]

Note that every number \( f(c_1, \ldots, c_m) \) has the form

\[
\alpha_1 a_1 + \ldots + \alpha_k a_k, \quad \alpha_i \in \{0, 1, \ldots, m(m - 1)\}.
\]

Hence, there are at most \( (m(m - 1) + 1)^k < m^{2k} < m^m \) distinct values of our expressions; therefore, at least two of them coincide.

Since \( s_i = m^i \), this contradicts the uniqueness of representation of positive integers in the base-\( m \) system.
So \( A \) contains at least \(100\) elements.",100,algebra
2021a8,"Determine all functions \( f : \mathbb{R} \to \mathbb{R} \) that satisfy  
\[
(f(a) - f(b)) (f(b) - f(c)) (f(c) - f(a)) = f(ab^2 + bc^2 + ca^2) - f(a^2b + b^2c + c^2a)
\]  
for all real numbers \( a, b, c \). if \( f(0)=3 \), what is the maximum value of \( f(5) \)?","\textbf{Solution.} It is straightforward to check that the functions \( f(x) = \alpha x + \beta \) or \( f(x) = \alpha x^3 + \beta \) satisfy the given equation, where \( \alpha \in \{-1, 0, 1\} \) and \( \beta \in \mathbb{R} \). Now, let \( f(x) \) satisfy the equation, which we denote as \( E(a, b, c) \). Clearly, \( f(x) + C \) also satisfies the equation; therefore, we may assume without loss of generality that \( f(0) = 0 \).

We start by proving the following lemma:

\textbf{Lemma.} Either \( f(x) \equiv 0 \) or \( f \) is injective.

\textbf{Proof.} Denote by \( \Theta \subseteq \mathbb{R}^2 \) the set of points \( (a, b) \) for which \( f(a) = f(b) \). Let \( \Theta^* = \{(x, y) \in \Theta : x \neq y\} \). The idea is that if \( (a, b) \in \Theta \), then by \( E(a, b, x) \) we get

\[
H_{a, b}(x) := (ab^2 + bx^2 + xa^2, a^2b + b^2x + x^2a) \in \Theta
\]

for all real \( x \). Reproducing this argument starting with \( (a, b) \in \Theta^* \), we get more and more points in \( \Theta \). There are many ways to fill in the details; we give below only one of them.

Assume that \( (a, b) \in \Theta^* \). Note that

\[
g_{-}(x) := (ab^2 + bx^2 + xa^2) - (a^2b + b^2x + x^2a) = (a - b)(b - x)(x - a)
\]

and

\[
g_{+}(x) := (ab^2 + bx^2 + xa^2) + (a^2b + b^2x + x^2a) = (x^2 + ab)(a + b) + x(a^2 + b^2).
\]

Hence, there exists \( x \) for which both \( g_{-}(x) \neq 0 \) and \( g_{+}(x) \neq 0 \). This gives a point \( (\alpha, \beta) = H_{a, b}(x) \in \Theta^* \) for which \( \alpha \neq -\beta \). Now compare \( E(\alpha, 1, 0) \) and \( E(\beta, 1, 0) \). The left-hand side expressions coincide, and on the right-hand side, we get \( f(\alpha) - f(\alpha^2) = f(\beta) - f(\beta^2) \), respectively. Hence, \( f(\alpha^2) = f(\beta^2) \), and we get a point \( (\alpha_1, \beta_1) := (\alpha^2, \beta^2) \in \Theta^* \) with both coordinates \( \alpha_1, \beta_1 \) non-negative. Continuing squaring the coordinates, we get a point \( (\gamma, \delta) \in \Theta^* \) for which \( \delta > 5\gamma \geq 0 \). Our nearest goal is to get a point \( (0, r) \in \Theta^* \). If \( \gamma = 0 \), this is already done. If \( \gamma > 0 \), denote by \( x \) a real root of the quadratic equation \( \delta^2 + \gamma x^2 + x\delta^2 = 0 \), which exists since the discriminant \( \delta^2 - 4\delta\gamma^3 \) is positive. Also, \( x < 0 \) since this equation cannot have a non-negative root. For the point \( H_{\delta, \gamma}(x) = (0, r) \in \Theta \), the first coordinate is \( 0 \). The difference of coordinates equals \( -r = (\delta - \gamma)(r - x)(x - \delta) < 0 \), so \( r \neq 0 \) as desired.

Now, let \( (0, r) \in \Theta^* \). We get \( H_{0, r}(x) = (rx^2, r^2x) \in \Theta \). Thus \( f(rx^2) = f(r^2x) \) for all \( x \in \mathbb{R} \). Replacing \( x \) with \( -x \), we get \( f(rx^2) = f(r^2x) = f(-r^2x) \), so \( f \) is even: \( (a, -a) \in \Theta \) for all \( a \). Then \( H_{a, -a}(x) = (a^3 - ax^2 + xa^2, -a^3 + a^2x + x^2a) \in \Theta \) for all real \( a, x \). Putting \( x = \frac{1 + \sqrt{5}}{2}a \), we obtain \( (0, (1 + \sqrt{5})a^3) \in \Theta \), which means that \( f(y) = f(0) = 0 \) for every real \( y \).

Hereafter, we assume that \( f \) is injective and \( f(0) = 0 \). By \( E(a, b, 0) \), we get

\[
f(a)f(b)(f(a) - f(b)) = f(a^2b) - f(ab^2).
\] 
(\(\heartsuit\))

Let \( \kappa := f(1) \) and note that \( \kappa = f(1) \neq f(0) = 0 \) by injectivity. Putting \( b = 1 \) in (\(\heartsuit\)), we get

\[
\kappa f(a)(f(a) - \kappa) = f(a^2) - f(a).
\] 
(\(\blacktriangle\))

Subtracting the same equality for \( -a \), we get

\[
\kappa(f(a) - f(-a))(f(a) + f(-a) - \kappa) = f(-a) - f(a).
\]

It follows that

\[
f(a) - f(b) = f(-b) - f(-a)
\]

for all non-zero \( a, b \). Replace non-zero numbers \( a \), \( b \) in (\(\heartsuit\)) with \( -a \), \( -b \), respectively, and add the two equalities. Due to (\(\blacktriangle\)), we get

\[
(f(a) - f(b))(f(a)f(b) - f(-a)f(-b)) = 0,
\]

thus \( f(a)f(b) = f(-a)f(-b) = (\lambda - f(a))(\lambda - f(b)) \) for all non-zero \( a \neq b \). If \( \lambda \neq 0 \), this implies \( f(a) + f(b) = \lambda \), which contradicts injectivity when we vary \( b \) with fixed \( a \). Therefore, \( \lambda = 0 \) and \( \kappa = \pm 1 \). Thus \( f \) is odd. Replacing \( f \) with \( -f \) if necessary (this preserves the original equation), we may suppose that \( f(1) = 1 \).

Now, (\(\blacktriangle\)) yields \( f(a^2) = f^2(a) \). Summing relations (\(\heartsuit\)) for pairs \( (a, b) \) and \( (a, -b) \), we get \( -2f(a)f^2(b) = -2f(ab^2) \), i.e., \( f(a)f(b^2) = f(ab^2) \). Putting \( b = \sqrt{x} \) for each non-negative \( x \), we get \( f(ax) = f(a)f(x) \) for all real \( a \) and non-negative \( x \). Since \( f \) is odd, this multiplicativity relation is true for all \( a, x \). Also, from \( f(a^2) = f^2(a) \), we see that \( f(x) \geq 0 \) for \( x \geq 0 \). Next, \( f(x) > 0 \) for \( x > 0 \) by injectivity.

Assume that \( f(x) \) for \( x > 0 \) does not have the form \( f(x) = x^r \) for a constant \( \tau \). The known property of multiplicative functions yields that the graph of \( f \) is dense on \( (0, \infty)^2 \). In particular, we may find positive \( b < 1/10 \) for which \( f(b) > 1 \). Also, such \( b \) can be found if \( f(x) = x^r \) for some \( \tau < 0 \). Then for all \( x \), we have \( x^2 + xb^2 + b \geq 0 \), and so \( E(1, b, x) \) implies that

\[
f(b^2 + bx^2 + x) = f(x^2 + xb^2 + b) + (f(b) - 1)(f(x) - f(b))(f(x) - 1) \geq 0 - ((f(b) - 1)^3 / 4
\]

is bounded from below (the quadratic trinomial bound \( (t - f(1))(t - f(b)) \geq -(f(b) - 1)^3 / 4 \) for \( t = f(x) \) is used). Hence, \( f \) is bounded from below on \( (b^2 - \frac{1}{40}, +\infty) \), and since \( f \) is odd, it is bounded from above on \( (0, \frac{1}{40} - b^2) \). This is absurd if \( f(x) = x^r \) for \( \tau < 0 \), and contradicts the above dense graph condition otherwise.

Therefore, \( f(x) = x^r \) for \( x > 0 \) and some constant \( \tau > 0 \). Dividing \( E(a, b, c) \) by \( (a - b)(b - c)(c - a) = (ab^2 + bc^2 + ca^2) - (a^2b + b^2c + c^2a) \) and taking a limit as \( a, b, c \) all go to \( 1 \) (the divided ratios tend to the corresponding derivatives, say, \( \frac{a^2 - b^2}{a - b} \to (x^r)'_{x=1} = \tau \)), we get \( \tau^3 = \tau \cdot 3^{\tau - 1} \), \( \tau^2 = 3^{\tau - 1} \), \( F(\tau) := 3^{\tau/2 - 1/2} - \tau = 0 \). Since the function \( F \) is strictly convex, it has at most two roots, and we get \( \tau \in [1, 3] \).

So \( f(x) = \alpha x + \beta \) or \( f(x) = \alpha x^3 + \beta \) where \( \alpha \in \{-1, 0, 1\} \) and \( \beta \in \mathbb{R} \). Since \( f(0)=3 \), the maximum value of \( f(5) \) is \(128\).",128,algebra
2021c2,"Let \( n \geq 3 \) be an integer. An integer \( m \geq n + 1 \) is called \( n \)-colourful if, given infinitely many marbles in each of \( n \) colours \( C_1, C_2, \ldots, C_n \), it is possible to place \( m \) of them around a circle so that in any group of \( n + 1 \) consecutive marbles there is at least one marble of colour \( C_i \) for each \( i = 1, \ldots, n \).

Prove that there are only finitely many positive integers which are not \( n \)-colourful. Find the largest among them when \(n=30\).","\textbf{Solution.} First, suppose that there are \( n(n-1) - 1 \) marbles. Then for one of the colours, say blue, there are at most \( n-2 \) marbles, which partition the non-blue marbles into at most \( n-2 \) groups with at least \( (n-1)^2 > n(n-2) \) marbles in total. Thus, one of these groups contains at least \( n+1 \) marbles, and this group does not contain any blue marble.

Now, suppose that the total number of marbles is at least \( n(n-1) \). Then we may write this total number as \( nk + j \) with some \( k \geq n-1 \) and with \( 0 \leq j \leq n-1 \). We place around a circle \( k-j \) copies of the colour sequence \([1, 2, 3, \ldots, n]\) followed by \( j \) copies of the colour sequence \([1, 1, 2, 3, \ldots, n]\).
So \( m_{\text{max}} = n^2 - n - 1 \). When \(n=30\), \( m_{\text{max}} = 869\).",869,combinatorics
2021c5,"\textbf{C5.} Let \( n \) and \( k \) be two integers with \( n > k \geq 1 \). There are \( 2n + 1 \) students standing in a circle. Each student \( S \) has \( 2k \) neighbors—namely, the \( k \) students closest to \( S \) on the right, and the \( k \) students closest to \( S \) on the left.

Suppose that \( n + 1 \) of the students are girls, and the other \( n \) are boys. How many girls is there a girl at least with among her neighbors when \(k=30\)
","\textbf{Solution.} We replace the girls by \(1\)'s, and the boys by \(0\)'s, getting the numbers \(a_{1}, a_{2}, \ldots, a_{2n+1}\) arranged in a circle. We extend this sequence periodically by letting \(a_{2n+1+k} = a_{k}\) for all \(k \in \mathbb{Z}\). We get an infinite periodic sequence

\[
\ldots, a_{1}, a_{2}, \ldots, a_{2n+1}, a_{1}, a_{2}, \ldots, a_{2n+1}, \ldots.
\]

Consider the numbers \(b_{i} = a_{i} + a_{i-k-1} - 1 \in \{-1, 0, 1\}\) for all \(i \in \mathbb{Z}\). We know that

\[
b_{m+1} + b_{m+2} + \cdots + b_{m+2n+1} = 1 \qquad (m \in \mathbb{Z});
\] 
(1)

in particular, this yields that there exists some \(i_{0}\) with \(b_{i_{0}} = 1\). Now we want to find an index \(i\) such that

\[
b_{i} = 1 \quad \text{and} \quad b_{i+1} + b_{i+2} + \cdots + b_{i+k} \geqslant 0.
\] 
(2)

This will imply that \(a_{i} = 1\) and

\[
(a_{i-k} + a_{i-k+1} + \cdots + a_{i-1}) + (a_{i+1} + a_{i+2} + \cdots + a_{i+k}) \geqslant k,
\]

as desired.

Suppose, to the contrary, that for every index \(i\) with \(b_{i} = 1\) the sum \(b_{i+1} + b_{i+2} + \cdots + b_{i+k}\) is negative. We start from some index \(i_{0}\) with \(b_{i_{0}} = 1\) and construct a sequence \(i_{0}\), \(i_{1}\), \(i_{2}\), ..., where \(i_{j}\) (\(j > 0\)) is the smallest possible index such that \(i_{j} > i_{j-1} + k\) and \(b_{i_{j}} = 1\). We can choose two numbers among \(i_{0}\), \(i_{1}\), ..., \(i_{2n+1}\) which are congruent modulo \(2n+1\) (without loss of generality, we may assume that these numbers are \(i_{0}\) and \(i_{T}\)).

On the one hand, for every \(j\) with \(0 \leqslant j \leqslant T-1\) we have

\[
S_{j} := b_{i_{j}} + b_{i_{j}+1} + b_{i_{j}+2} + \cdots + b_{i_{j+1}-1} \leqslant b_{i_{j}} + b_{i_{j}+1} + b_{i_{j}+2} + \cdots + b_{i_{j}+k} \leqslant 0
\]

since \(b_{i_{j}+k+1}, \ldots, b_{i_{j+1}-1} \leqslant 0\). On the other hand, since \((i_{T} - i_{0}) \mid (2n+1)\), from (1) we deduce

\[
S_{0} + \cdots + S_{T-1} = \sum_{i=i_{0}}^{i_{T}-1} b_{i} = \frac{i_{T} - i_{0}}{2n+1} > 0.
\]

This contradiction finishes the solution. There is a girl with at least \( k \) girls among her neighbors. So the answer is \(30\).",30,combinatorics
2021c6,"\textbf{C6.} A hunter and an invisible rabbit play a game on an infinite square grid. First, the hunter fixes a coloring of the cells with finitely many colors. The rabbit then secretly chooses a cell to start in. Every minute, the rabbit reports the color of its current cell to the hunter, and then secretly moves to an adjacent cell that it has not visited before (two cells are adjacent if they share a side). The hunter wins if after some finite time either

\begin{itemize}
    \item the rabbit cannot move; or
    \item the hunter can determine the cell in which the rabbit started.
\end{itemize}

Decide whether there exists a winning strategy for the hunter. If there exists a winning strategy for the hunter, the answer should be \(1\). Else the answer should be \(0\)","\textbf{Solution.} A central idea is that several colorings \( C_1, C_2, \ldots, C_k \) can be merged together into a single product coloring \( C_1 \times C_2 \times \cdots \times C_k \) as follows: the colors in the product coloring are ordered tuples \( (c_1, \ldots, c_n) \) of colors, where \( c_i \) is a color used in \( C_i \), so that each cell gets a tuple consisting of its colors in the individual colorings \( C_i \). This way, any information which can be determined from one of the individual colorings can also be determined from the product coloring.

Now let the hunter merge the following colorings:

- The first two colorings \( C_1 \) and \( C_2 \) allow the tracking of the horizontal and vertical movements of the rabbit.

The coloring \( C_1 \) colors the cells according to the residue of their \( x \)-coordinates modulo 3, which allows to determine whether the rabbit moves left, moves right, or moves vertically. Similarly, the coloring \( C_2 \) uses the residues of the \( y \)-coordinates modulo 3, which allows to determine whether the rabbit moves up, moves down, or moves horizontally.

- Under the condition that the rabbit’s \( x \)-coordinate is unbounded, coloring \( C_3 \) allows to determine the exact value of the \( x \)-coordinate:

In \( C_3 \), the columns are colored white and black so that the gaps between neighboring black columns are pairwise distinct. As the rabbit’s \( x \)-coordinate is unbounded, it will eventually visit two black cells in distinct columns. With the help of coloring \( C_1 \), the hunter can catch that moment and determine the difference of \( x \)-coordinates of those two black cells, hence deducing the precise column.

Symmetrically, under the condition that the rabbit’s \( y \)-coordinate is unbounded, there is a coloring \( C_4 \) that allows the hunter to determine the exact value of the \( y \)-coordinate.

- Finally, under the condition that the sum \( x + y \) of the rabbit’s coordinates is unbounded, coloring \( C_5 \) allows to determine the exact value of this sum: The diagonal lines \( x + y = \) const are colored black and white, so that the gaps between neighboring black diagonals are pairwise distinct.

Unless the rabbit gets stuck, at least two of the three values \( x, y \) and \( x + y \) must be unbounded as the rabbit keeps moving. Hence, the hunter can eventually determine two of these three values; thus, he does know all three. Finally, the hunter works backwards with the help of the colorings \( C_1 \) and \( C_2 \) and computes the starting cell of the rabbit.",1,combinatorics
2021c7,"Consider a checkered \( 3m \times 3m \) square, where \( m \) is an integer greater than 1. A frog sits on the lower left corner cell \( S \) and wants to get to the upper right corner cell \( F \). The frog can hop from any cell to either the next cell to the right or the next cell upwards.

Some cells can be sticky, and the frog gets trapped once it hops on such a cell. A set \( X \) of cells is called blocking if the frog cannot reach \( F \) from \( S \) when all the cells of \( X \) are sticky. A blocking set is minimal if it does not contain a smaller blocking set.

How many cells does every minimal blocking set set contains at most when \(m=11\)?","\textbf{Solution 1 for part (b).} For a given blocking set \( X \), say that a non-sticky cell is red if the frog can reach it from \( S \) via some hops without entering set \( X \). We call a non-sticky cell blue if the frog can reach \( F \) from that cell via hops without entering set \( X \). One can regard the blue cells as those reachable from \( F \) by anti-hops, i.e., moves downwards and to the left. We also color all cells in \( X \) green. It follows from the definition of the blocking set that no cell will be colored twice. In Figure 2, we show a sample of a blocking set and the corresponding coloring.

Now assume that \( X \) is a minimal blocking set. We denote by \( R \) (resp., \( B \) and \( G \)) the total number of red (resp., blue and green) cells.

We claim that \( G \leq R + 1 \) and \( G \leq B + 1 \). Indeed, there are at most \( 2R \) possible frog hops from red cells. Every green or red cell (except for \( S \)) is accessible by such hops. Hence \( 2R \geq G + (R - 1) \), or equivalently \( G \leq R + 1 \). In order to prove the inequality \( G \leq B + 1 \), we turn over the board and apply similar arguments.

Therefore, we get \( 9m^2 \geq B + R + G \geq 3G - 2 \), so \( G \leq 3m^2 \). So when \(m=11\), the answer is \(363\)",363,combinatorics
2021c8,"\textbf{C8.} Determine the largest \( N \) for which there exists a table \( T \) of integers with \( N \) rows and 100 columns that has the following properties:
\begin{enumerate}
    \item[(i)] Every row contains the numbers 1, 2, \ldots, 100 in some order.
    \item[(ii)] For any two distinct rows \( r \) and \( s \), there is a column \( c \) such that \( |T(r,c) - T(s,c)| \geq 2 \). Here \( T(r,c) \) means the number at the intersection of the row \( r \) and the column \( c \).
\end{enumerate}
You should arrive at this number by taking the problem solution modulo \(1000\).","\textbf{Non-existence of a larger table.} Let us consider some fixed row in the table, and let us replace (for \( k = 1, 2, \ldots, 50 \)) each of two numbers \( 2k - 1 \) and \( 2k \) respectively by the symbol \( x_k \). The resulting pattern is an arrangement of 50 symbols \( x_1, x_2, \ldots, x_{50} \), where every symbol occurs exactly twice. Note that there are \( N = 100!/2^{50} \) distinct patterns \( P_1, \ldots, P_N \).

If two rows \( r \neq s \) in the table have the same pattern \( P_i \), then \( |T(r,c) - T(s,c)| \leq 1 \) holds for all columns \( c \). As this violates property (ii) in the problem statement, different rows have different patterns. Hence, there are at most \( N = 100!/2^{50} \) rows.

\textbf{Existence of a table with \( N \) rows.} We construct the table by translating every pattern \( P_i \) into a corresponding row with the numbers \( 1, 2, \ldots, 100 \). We present a procedure that inductively replaces the symbols by numbers. The translation goes through steps \( k = 1, 2, \ldots, 50 \) in increasing order, and at step \( k \), replaces the two occurrences of symbol \( x_k \) by \( 2k - 1 \) and \( 2k \).

- The left occurrence of \( x_1 \) is replaced by 1, and its right occurrence is replaced by 2.

- For \( k \geq 2 \), we already have the number \( 2k - 2 \) somewhere in the row, and now we are looking for the places for \( 2k - 1 \) and \( 2k \). We make the three numbers \( 2k - 2, 2k - 1, 2k \) show up (ordered from left to right) either in the order \( 2k - 2, 2k - 1, 2k \), or as \( 2k, 2k - 2, 2k - 1 \), or as \( 2k - 1, 2k, 2k - 2 \). This is possible since the number \( 2k - 2 \) has been placed in the preceding step and shows up before / between / after the two occurrences of the symbol \( x_k \).

We claim that the \( N \) rows that result from the \( N \) patterns yield a table with the desired property (ii). Indeed, consider the \( r \)-th and the \( s \)-th row (\( r \neq s \)), which by construction result from patterns \( P_r \) and \( P_s \). Call a symbol \( x_i \) aligned if it occurs in the same two columns in \( P_r \) and in \( P_s \). Let \( k \) be the largest index for which symbol \( x_k \) is not aligned. Note that \( k \geq 2 \). Consider the column \( c' \) with \( T(r,c') = 2k \) and the column \( c'' \) with \( T(s,c'') = 2k \). Then \( T(r,c') \leq 2k \) and \( T(s,c') \leq 2k \), as all symbols \( x_i \) with \( i \geq k + 1 \) are aligned.

- If \( T(r,c'') \leq 2k - 2 \), then \( |T(r,c'') - T(s,c'')| \geq 2 \) as desired.

- If \( T(s,c') \leq 2k - 2 \), then \( |T(r,c') - T(s,c')| \geq 2 \) as desired.

- If \( T(r,c'') = 2k - 1 \) and \( T(s,c') = 2k - 1 \), then the symbol \( x_k \) is aligned; contradiction.

In the only remaining case, we have \( c' = c'' \), so that \( T(r,c') = T(s,c') = 2k \) holds. Now let us consider the columns \( d' \) and \( d'' \) with \( T(r,d') = 2k - 1 \) and \( T(s,d'') = 2k - 1 \). Then \( d \neq d'' \) (as the symbol \( x_k \) is not aligned), and \( T(r,d'') \leq 2k - 2 \) and \( T(s,d') \leq 2k - 2 \) (as all symbols \( x_i \) with \( i \geq k + 1 \) are aligned).

- If \( T(r,d'') \leq 2k - 3 \), then \( |T(r,d'') - T(s,d'')| \geq 2 \) as desired.

- If \( T(s,c') \leq 2k - 3 \), then \( |T(r,d'') - T(s,d'')| \geq 2 \) as desired.

In the only remaining case, we have \( T(r,d'') = 2k - 2 \) and \( T(s,d'') = 2k - 2 \). Now the row \( r \) has the numbers \( 2k - 2, 2k - 1, 2k \) in the three columns \( d', d'', c' \). As one of these triples violates the ordering property of \( 2k - 2, 2k - 1, 2k \), we have the final contradiction.

So after taking the problem solution modulo \(1000\), the solution is \(0\)",0,combinatorics
2021g2,"\textbf{G2.} Let \( ABCD \) be a convex quadrilateral circumscribed around a circle with center \( I \).  
Let \( \omega \) be the circumcircle of the triangle \( ACI \). The extensions of \( BA \) and \( BC \) beyond \( A \) and \( C \) meet \( \omega \) at \( X \) and \( Z \), respectively. The extensions of \( AD \) and \( CD \) beyond \( D \) meet \( \omega \) at \( Y \) and \( T \), respectively. If the perimeters of the (possibly self-intersecting) quadrilaterals \( ADTX \) and \( CDYZ \) are \(P_{ADTX}\) and \(P_{CDYZ}\), what is the value of \( \frac{P_{ADTX}}{P_{CDYZ}} \) ?","\textbf{Solution.} The point \( I \) is the intersection of the external bisector of the angle \( TCZ \) with the circumcircle \( \omega \) of the triangle \( TCZ \), so \( I \) is the midpoint of the arc \( TCZ \) and \( IT = IZ \). Similarly, \( I \) is the midpoint of the arc \( YAX \) and \( IX = IY \). Let \( O \) be the center of \( \omega \). Then \( X \) and \( T \) are the reflections of \( Y \) and \( Z \) in \( IO \), respectively. So \( XT = YZ \).

Let the incircle of \( ABCD \) touch \( AB \), \( BC \), \( CD \), and \( DA \) at points \( P \), \( Q \), \( R \), and \( S \), respectively.

The right triangles \( IXP \) and \( IYS \) are congruent, since \( IP = IS \) and \( IX = IY \). Similarly, the right triangles \( IRT \) and \( IQZ \) are congruent. Therefore, \( XP = YS \) and \( RT = QZ \).

Denote the perimeters of \( ADTX \) and \( CDYZ \) by \( P_{ADTX} \) and \( P_{CDYZ} \) respectively. Since \( AS = AP \), \( CQ = RC \), and \( SD = DR \), we obtain

\[
P_{ADTX} = XT + XA + AS + SD + DT = XT + XP + RT
\]

\[
= YZ + YS + QZ = YZ + YD + DR + RC + CZ = P_{CDYZ},
\]

as required.",1,geometry
2021g3,"Let \( n \) be a fixed positive integer, and let \( S \) be the set of points \((x, y)\) on the Cartesian plane such that both coordinates \( x \) and \( y \) are nonnegative integers smaller than \( 2n \) (thus \(|S| = 4n^2\)). Assume that \( \mathcal{F} \) is a set consisting of \( n^2 \) quadrilaterals such that all their vertices lie in \( S \), and each point in \( S \) is a vertex of exactly one of the quadrilaterals in \( \mathcal{F} \).

Determine the largest possible sum of areas of all \( n^2 \) quadrilaterals in \( \mathcal{F} \) when \(n=9\).","Each point in \( S \) is a vertex of a unique central square. Thus, the set \( \mathcal{G} \) of central squares is acceptable. We will show that
\[
\Sigma(\mathcal{F}) \leq \Sigma(\mathcal{G}) = \Sigma(n),
\]
thus establishing the answer.

We will use the following key lemma.

\textbf{Lemma 1.} Let \( P = A_1A_2 \ldots A_m \) be a polygon, and let \( O \) be an arbitrary point in the plane. Then
\[
[P] \leq \frac{1}{2} \sum_{i=1}^m OA_i^2;
\]
moreover, if \( P \) is a square centered at \( O \), then the inequality (2) turns into an equality.

\textbf{Proof.} Put \( A_{n+1} = A_1 \). For each \( i = 1, 2, \ldots, m \), we have
\[
[OA_iA_{i+1}] \leq \frac{OA_i \cdot OA_{i+1}}{2} \leq \frac{OA_i^2 + OA_{i+1}^2}{4}.
\]

Therefore,
\[
[P] \leq \sum_{i=1}^m [OA_iA_{i+1}] \leq \frac{1}{4} \sum_{i=1}^m (OA_i^2 + OA_{i+1}^2) = \frac{1}{2} \sum_{i=1}^m OA_i^2,
\]
which proves (2). Finally, all the above inequalities turn into equalities when \( P \) is a square centered at \( O \).

Back to the problem, consider an arbitrary acceptable set \( \mathcal{F} \). Applying Lemma 1 to each element in \( \mathcal{F} \) and to each element in \( \mathcal{G} \) (achieving equality in the latter case), we obtain
\[
\Sigma(\mathcal{F}) \leq \frac{1}{2} \sum_{A \in S} OA^2 = \Sigma(\mathcal{G}),
\]
which establishes the left inequality in (1).

It remains to compute \(\Sigma(\mathcal{G})\). We have

\[
\Sigma(\mathcal{G}) = \frac{1}{2} \sum_{A \in S} OA^2 = \frac{1}{2} \sum_{i=0}^{2n-1} \sum_{j=0}^{2n-1} \left( \left( n - \frac{1}{2} - i \right)^2 + \left( n - \frac{1}{2} - j \right)^2 \right) = \frac{1}{8} \cdot 4 \cdot 2n \sum_{i=0}^{n-1} (2n - 2i - 1)^2 = n \sum_{j=0}^{n-1} (2j + 1)^2 = n \left( \sum_{j=1}^{2n} j^2 - \sum_{j=1}^n (2j)^2 \right) = n \left( \frac{2n(2n+1)(4n+1)}{6} - 4 \cdot \frac{n(n+1)(2n+1)}{6} \right) = \frac{n^2(2n+1)(2n-1)}{3} = \Sigma(n).
\]

The largest possible sum of areas is \(\Sigma(n) := \frac{1}{3}n^2(2n+1)(2n-1)\). So the answer is \(8721\) when \(n=9\).",8721,geometry
2021g6,"Determine all integers \( n \geq 3 \) satisfying the following property: every convex \( n \)-gon whose sides all have length 1 contains an equilateral triangle of side length 1. (Every polygon is assumed to contain its boundary.)
How many integers less than \(100\) satisfy the property.","\textbf{Solution.} First, we show that for every even \( n \geq 4 \), there exists a polygon violating the required statement. Consider a regular \( k \)-gon \( A_0A_1, \ldots, A_{k-1} \) with side length 1. Let \( B_1, B_2, \ldots, B_{n/2-1} \) be the points symmetric to \( A_1, A_2, \ldots, A_{n/2-1} \) with respect to the line \( A_0A_{n/2} \). Then \( P = A_0A_1A_2 \cdots A_{n/2-1}A_{n/2}B_{n/2-1}B_{n/2-2} \cdots B_2B_1 \) is a convex \( n \)-gon whose sides all have length 1. If \( k \) is big enough, \( P \) is contained in a strip of width \( 1/2 \), which clearly does not contain any equilateral triangle of side length 1.

Assume now that \( n = 2k+1 \). As the case \( k = 1 \) is trivially true, we assume \( k \geq 2 \) henceforth. Consider a convex \((2k+1)\)-gon \( P \) whose sides all have length 1. Let \( d \) be its longest diagonal. The endpoints of \( d \) split the perimeter of \( P \) into two polylines, one of which has length at least \( k + 1 \). Hence, we can label the vertices of \( P \) so that \( P = A_0A_1 \cdots A_{2k} \) and \( d = A_0A_\ell \) with \( \ell \geq k + 1 \). We will show that, in fact, the polygon \( A_0A_1 \cdots A_\ell \) contains an equilateral triangle of side length 1.

Suppose that \(\angle A_\ell A_0A_1 \geq 60^\circ\). Since \( d \) is the longest diagonal, we have \( A_1A_\ell \leq A_0A_\ell \), so \(\angle A_0A_1A_\ell \geq \angle A_\ell A_0A_1 \geq 60^\circ\). It follows that there exists a point \( X \) inside the triangle \( A_0A_1A_\ell \) such that the triangle \( A_0A_1X \) is equilateral, and this triangle is contained in \( P \). Similar arguments apply if \(\angle A_{\ell-1}A_\ell A_0 \geq 60^\circ\).

From now on, assume \(\angle A_\ell A_0A_1 < 60^\circ\) and \( A_{\ell-1}A_\ell A_0 < 60^\circ \).

Consider an isosceles trapezoid \( A_0YZA_\ell \) such that \( A_0A_\ell \parallel YZ \), \( A_0Y = ZA_\ell = 1 \), and \(\angle A_\ell A_0Y = \angle ZA_\ell A_0 = 60^\circ\). Suppose that \( A_0A_1 \cdots A_\ell \) is contained in \( A_0YZA_\ell \). Note that the perimeter of \( A_0A_1 \cdots A_\ell \) equals \( \ell + A_0A_\ell \) and the perimeter of \( A_0YZA_\ell \) equals \( 2A_0A_\ell + 1 \).

Recall a well-known fact stating that if a convex polygon \( P_1 \) is contained in a convex polygon \( P_2 \), then the perimeter of \( P_1 \) is at most the perimeter of \( P_2 \). Hence, we obtain

\[
\ell + A_0A_\ell \leq 2A_0A_\ell + 1, \quad \text{i.e.} \quad \ell - 1 \leq A_0A_\ell.
\]

On the other hand, the triangle inequality yields

\[
A_0A_\ell < A_\ell A_{\ell+1} + A_{\ell+1}A_{\ell+2} + \cdots + A_{2k}A_0 = 2k + 1 - \ell \leq \ell - 1,
\]

which gives a contradiction.

Therefore, there exists a vertex \( A_m \) of \( A_0A_1 \cdots A_\ell \) which lies outside \( A_0YZA_\ell \). Since

\[
\angle A_\ell A_0A_1 < 60^\circ = \angle A_\ell A_0Y \quad \text{and} \quad A_{\ell-1}A_\ell A_0 < 60^\circ = \angle ZA_\ell A_0,
\]

the distance between \( A_m \) and \( A_0A_\ell \) is at least \(\sqrt{3}/2\).

Let \( P \) be the projection of \( A_m \) to \( A_0A_\ell \). Then \( PA_m \geq \sqrt{3}/2 \), and by (1) we have \( A_0P > 1/2 \) and \( PA_\ell > 1/2 \). Choose points \( Q \in A_0P \), \( R \in PA_\ell \), and \( S \in PA_m \) such that \( PQ = PR = 1/2 \) and \( PS = \sqrt{3}/2 \). Then \( QRS \) is an equilateral triangle of side length 1 contained in \( A_0A_1 \ldots A_\ell \).
So there are \(48\) integers less than \(100\) satisfy the property.",48,geometry
2021g8,"\textbf{G8.} Let \(\omega\) be the circumcircle of a triangle \(ABC\), and let \(\Omega_A\) be its excircle which is tangent to the segment \(BC\). Let \(X\) and \(Y\) be the intersection points of \(\omega\) and \(\Omega_A\). Let \(P\) and \(Q\) be the projections of \(A\) onto the tangent lines to \(\Omega_A\) at \(X\) and \(Y\), respectively. The tangent line at \(P\) to the circumcircle of the triangle \(APX\) intersects the tangent line at \(Q\) to the circumcircle of the triangle \(AQY\) at a point \(R\). Calculate the degree of the angle between \(AR\) and \( BC\).","\textbf{Solution 1.} Let \( D \) be the point of tangency of \( BC \) and \( \Omega_A \). Let \( D' \) be the point such that \( DD' \) is a diameter of \( \Omega_A \). Let \( R' \) be (the unique) point such that \( AR' \perp BC \) and \( R'D' \parallel BC \). We shall prove that \( R' \) coincides with \( R \).

Let \( PX \) intersect \( AB \) and \( D'R' \) at \( S \) and \( T \), respectively. Let \( U \) be the ideal common point of the parallel lines \( BC \) and \( D'R' \). Note that the (degenerate) hexagon \( ASXTUC \) is circumscribed around \( \Omega_A \), hence by the Brianchon theorem \( AT, SU, \) and \( XC \) concur at a point which we denote by \( V \). Then \( VS \parallel BC \). It follows that \( \dot{x}(SV, VX) = \dot{x}(BC, CX) = \dot{x}(BA, AX) \), hence \( AXSV \) is cyclic. Therefore, \( \dot{x}(PX, XA) = \dot{x}(SV, VA) = \dot{x}(RT, TA) \). Since \( \angle APT = \angle ART = 90^\circ \), the quadrilateral \( APRT \) is cyclic. Hence,

\[
\dot{x}(XA, AP) = 90^\circ - \dot{x}(PX, XA) = 90^\circ - \dot{x}(RT, TA) = \dot{x}(TA, AR') = \dot{x}(TP, PR').
\]

It follows that \( PR' \) is tangent to the circle (\( APX \)). An analogous argument shows that \( QR' \) is tangent to the circle (\( AQY \)). Therefore, \( R = R' \) and \( AR \perp BC \).",90,geometry
2021n1,"\textbf{N1.} Determine all integers \( n \geq 1 \) for which there exists a pair of positive integers \((a, b)\) such that no cube of a prime divides \( a^2 + b + 3 \) and  
\[
\frac{ab + 3b + 8}{a^2 + b + 3} = n.
\]","\textbf{Solution.} As \( b \equiv -a^2 - 3 \) (mod \( a^2 + b + 3 \)), the numerator of the given fraction satisfies  
\[
ab + 3b + 8 \equiv a(-a^2 - 3) + 3(-a^2 - 3) + 8 \equiv -(a + 1)^3 \pmod{a^2 + b + 3}.
\]  

As \( a^2 + b + 3 \) is not divisible by \( p^3 \) for any prime \( p \), if \( a^2 + b + 3 \) divides \((a + 1)^3\) then it also divides \((a + 1)^2\). Since  
\[
0 < (a + 1)^2 < 2(a^2 + b + 3),
\]  
we conclude \((a + 1)^2 = a^2 + b + 3\). This yields \( b = 2(a - 1) \) and \( n = 2 \). The choice \((a, b) = (2, 2)\) with \( a^2 + b + 3 = 9 \) shows that \( n = 2 \) indeed is a solution.",2,number theory
2021n3,"\textbf{N3.} Find all positive integers \( n \) with the following property: the \( k \) positive divisors of \( n \) have a permutation \((d_1, d_2, \ldots, d_k)\) such that for every \( i = 1, 2, \ldots, k \), the number \( d_1 + \cdots + d_i \) is a perfect square. Calculate the sum of all possible positive integers.","\textbf{Solution.} For \( i = 1, 2, \ldots, k \), let \( d_1 + \ldots + d_i = s_i^2 \), and define \( s_0 = 0 \) as well. Obviously  
\[
0 = s_0 < s_1 < s_2 < \ldots < s_k, \text{ so }
\]  
\[
s_i \geq i \quad \text{and} \quad d_i = s_i^2 - s_{i-1}^2 = (s_i + s_{i-1})(s_i - s_{i-1}) \geq s_i + s_{i-1} \geq 2i - 1. \tag{1}
\]  

The number 1 is one of the divisors \( d_1, \ldots, d_k \), but due to \( d_i \geq 2i - 1 \), the only possibility is \( d_1 = 1 \).  

Now consider \( d_2 \) and \( s_2 \geq 2 \). By definition, \( d_2 = s_2^2 - 1 = (s_2 - 1)(s_2 + 1) \), so the numbers \( s_2 - 1 \) and \( s_2 + 1 \) are divisors of \( n \). In particular, there is some index \( j \) such that \( d_j = s_2 + 1 \). Notice that  
\[
s_2 + s_1 = s_2 + 1 = d_j \geq s_j + s_{j-1}; \tag{2}
\]  
since the sequence \( s_0 < s_1 < \ldots < s_k \) increases, the index \( j \) cannot be greater than 2. Hence, the divisors \( s_2 - 1 \) and \( s_2 + 1 \) are listed among \( d_1 \) and \( d_2 \). That means \( s_2 - 1 = d_1 = 1 \) and \( s_2 + 1 = d_2 \); therefore \( s_2 = 2 \) and \( d_2 = 3 \).  

We can repeat the above process in general.  

\textbf{Claim.} \( d_i = 2i - 1 \) and \( s_i = i \) for \( i = 1, 2, \ldots, k \).  

\textbf{Proof.} Apply induction on \( i \). The Claim has been proved for \( i = 1, 2 \). Suppose that we have already proved \( d_1 = 1, d_2 = 3, \ldots, d_i = 2i - 1 \), and consider the next divisor \( d_{i+1} \):  
\[
d_{i+1} = s_{i+1}^2 - s_i^2 = s_{i+1}^2 - i^2 = (s_{i+1} - i)(s_{i+1} + i).
\]  

The number \( s_{i+1} + i \) is a divisor of \( n \), so there is some index \( j \) such that \( d_j = s_{i+1} + i \). Similarly to (2), by (1) we have  
\[
s_{i+1} + s_i = s_{i+1} + i = d_j \geq s_j + s_{j-1}; \tag{3}
\]  
since the sequence \( s_0 < s_1 < \ldots < s_k \) increases, (3) forces \( j \leq i + 1 \). On the other hand, \( d_j = s_{i+1} + i > 2i > d_i > d_{i-1} > \ldots > d_1 \), so \( j \leq i \) is not possible. The only possibility is \( j = i + 1 \).  

Hence,  
\[
s_{i+1} + i = d_{i+1} = s_{i+1}^2 - s_i^2 = s_{i+1}^2 - i^2;
\]  
\[
s_{i+1}^2 - s_{i+1} = i(i + 1).
\]  

By solving this equation, we get \( s_{i+1} = i + 1 \) and \( d_{i+1} = 2i + 1 \), which finishes the proof. \(\square\)  

Now we know that the positive divisors of the number \( n \) are 1, 3, 5, \ldots, \( n-2, n \). The greatest divisor is \( d_k = 2k - 1 = n \) itself, so \( n \) must be odd. The second greatest divisor is \( d_{k-1} = n - 2 \); then \( n - 2 \) divides \( n = (n - 2) + 2 \), so \( n - 2 \) divides 2. Therefore, \( n \) must be 1 or 3.  

The numbers \( n = 1 \) and \( n = 3 \) obviously satisfy the requirements: for \( n = 1 \), we have \( k = 1 \) and \( d_1 = 1^2 \); for \( n = 3 \), we have \( k = 2, d_1 = 1^2 \), and \( d_1 + d_2 = 1 + 3 = 2^2 \).
So the sum is \(4\).",4,number theory
2021n4,"\textbf{N4.} Alice is given a rational number \( r > 1 \) and a line with two points \( B \neq R \), where point \( R \) contains a red bead and point \( B \) contains a blue bead. Alice plays a solitaire game by performing a sequence of moves. In every move, she chooses a (not necessarily positive) integer \( k \), and a bead to move. If that bead is placed at point \( X \), and the other bead is placed at \( Y \), then Alice moves the chosen bead to point \( X' \) with \( \overrightarrow{YX} = r^k \overrightarrow{YX} \).

Alice’s goal is to move the red bead to the point \( B \). Find all rational numbers \( r > 1 \) such that Alice can reach her goal in at most 2021 moves. Give the maximum value of \(r\).","\textbf{Solution.} Denote the red and blue beads by \(\mathcal{R}\) and \(\mathcal{B}\), respectively. Introduce coordinates on the line and identify the points with their coordinates so that \(R=0\) and \(B=1\). Then, during the game, the coordinate of \(\mathcal{R}\) is always smaller than the coordinate of \(\mathcal{B}\). Moreover, the distance between the beads always has the form \(r^{\ell}\) with \(\ell\in\mathbb{Z}\), since it only multiplies by numbers of this form. Denote the value of the distance after the \(m^{\text{th}}\) move by \(d_{m}=r^{\alpha_{m}}\), \(m=0,1,2,\ldots\) (after the \(0^{\text{th}}\) move we have just the initial position, so \(\alpha_{0}=0\)).

If some bead is moved in two consecutive moves, then Alice could instead perform a single move (and change the distance from \(d_{i}\) directly to \(d_{i+2}\)) which has the same effect as these two moves. So, if Alice can achieve her goal, then she may as well achieve it in fewer (or the same) number of moves by alternating the moves of \(\mathcal{B}\) and \(\mathcal{R}\). In the sequel, we assume that Alice alternates the moves, and that \(\mathcal{R}\) is shifted altogether \(t\) times.

If \(\mathcal{R}\) is shifted in the \(m^{\text{th}}\) move, then its coordinate increases by \(d_{m}-d_{m+1}\). Therefore, the total increment of \(\mathcal{R}\)'s coordinate, which should be 1, equals

\[
\text{either}\qquad(d_{0}-d_{1})+(d_{2}-d_{3})+\cdots+(d_{2t-2}-d_{2t-1})=1+\sum_ {i=1}^{t-1}r^{\alpha_{2i}}-\sum_{i=1}^{t}r^{\alpha_{2i-1}},
\] 
\[
\text{or}\qquad\qquad(d_{1}-d_{2})+(d_{3}-d_{4})+\cdots+(d_{2t-1}-d _{2t})=\sum_{i=1}^{t}r^{\alpha_{2i-1}}-\sum_{i=1}^{t}r^{\alpha_{2i}}},
\]

depending on whether \(\mathcal{R}\) or \(\mathcal{B}\) is shifted in the first move. Moreover, in the former case we should have \(t\leqslant 1011\), while in the latter one we need \(t\leqslant 1010\). So both cases reduce to an equation

\[
\sum_{i=1}^{n}r^{\beta_{i}}=\sum_{i=1}^{n-1}r^{\gamma_{i}},\qquad\beta_{i},\gamma _{i}\in\mathbb{Z},
\] 
(1)

for some \(n\leqslant 1011\). Thus, if Alice can reach her goal, then this equation has a solution for \(n=1011\) (we can add equal terms to both sums in order to increase \(n\)).

Conversely, if (1) has a solution for \(n=1011\), then Alice can compose a corresponding sequence of distances \(d_{0},d_{1},d_{2},\ldots,d_{2021}\) and then realise it by a sequence of moves. So the problem reduces to the solvability of (1) for \(n=1011\).

Assume that, for some rational \(r\), there is a solution of (1). Write \(r\) in lowest terms as \(r=a/b\). Substitute this into (1), multiply by the common denominator, and collect all terms on the left hand side to get

\[
\sum_{i=1}^{2n-1}(-1)^{i}a^{\mu_{i}}b^{N-\mu_{i}}}=0,\qquad\mu_{i}\in\{0,1,\ldots ,N\},
\] 
(2)

for some \(N\geqslant 0\). We assume that there exist indices \(j_{-}\) and \(j_{+}\) such that \(\mu_{j_{-}}=0\) and \(\mu_{j_{+}}=N\).

Reducing (2) modulo \(a-b\) (so that \(a\equiv b\)), we get

\[
0=\sum_{i=1}^{2n-1}(-1)^{i}a^{\mu_{i}}b^{N-\mu_{i}}}\equiv\sum_{i=1}^{2n-1}(-1)^{ i}b^{\mu_{i}}b^{N-\mu_{i}}}=-b^{N}\mod(a-b).
\]

Since \(\gcd(a-b,b)=1\), this is possible only if \(a-b=1\).

Reducing (2) modulo \(a+b\) (so that \(a\equiv-b\)), we get

\[
0=\sum_{i=1}^{2n-1}(-1)^{i}a^{\mu_{i}}b^{N-\mu_{i}}}\equiv\sum_{i=1}^{2n-1}(-1)^{ i}(-1)^{\mu_{i}}b^{\mu_{i}}b^{N-\mu_{i}}}=Sb^{N}\mod(a+b)
\]

for some odd (thus nonzero) \(S\) with \(|S|\leqslant 2n-1\). Since \(\gcd(a+b,b)=1\), this is possible only if \(a+b\mid S\). So \(a+b\leqslant 2n-1\), and hence \(b=a-1\leqslant n-1=1010\).

Thus we have shown that any sought \(r\) has the form indicated in the answer. It remains to show that for any \(b=1,2,\ldots,1010\) and \(a=b+1\), Alice can reach the goal. For this purpose, in (1) we put \(n=a\), \(\beta_{1}=\beta_{2}=\cdots=\beta_{a}=0\), and \(\gamma_{1}=\gamma_{2}=\cdots=\gamma_{b}=1\).
So the maximum value of \(r\) is \(2\).",2,number theory
2021n8,"\textbf{N8.}  
For a polynomial \( P(x) \) with integer coefficients, let \( P^1(x) = P(x) \) and \( P^{k+1}(x) = P(P^k(x)) \) for \( k \geq 1 \). Find all positive integers \( n \) for which there exists a polynomial \( P(x) \) with integer coefficients such that for every integer \( m \geq 1 \), the numbers \( P^m(1), \ldots, P^m(n) \) leave exactly \( [n/2^m] \) distinct remainders when divided by \( n \). Calculate the sum of all possible positive integers that less than \(20\).","\textbf{Solution.} Denote the set of residues modulo \(\ell\) by \(\mathbb{Z}_\ell\). Observe that \(P\) can be regarded as a function \(\mathbb{Z}_\ell \to \mathbb{Z}_\ell\) for any positive integer \(\ell\). Denote the cardinality of the set \(P^m(\mathbb{Z}_\ell)\) by \(f_{m,\ell}\). Note that \(f_{m,n} = [n/2^m]\) for all \(m \geq 1\) if and only if \(f_{m+1,n} = [f_{m,n}/2]\) for all \(m \geq 0\).

\textbf{Part 1.} The required polynomial exists when \(n\) is a power of 2 or a prime.

If \(n\) is a power of 2, set \(P(x) = 2x\).

If \(n = p\) is an odd prime, every function \(f: \mathbb{Z}_p \to \mathbb{Z}_p\) coincides with some polynomial with integer coefficients. So we can pick the function that sends \(x \in \{0, 1, \ldots, p-1\}\) to \(\lfloor x/2 \rfloor\).

\textbf{Part 2.} The required polynomial does not exist when \(n\) is not a prime power.

Let \(n = ab\) where \(a, b > 1\) and \(\gcd(a, b) = 1\). Note that, since \(\gcd(a, b) = 1\),

\[
f_{m,ab} = f_{m,a}f_{m,b}
\]

by the Chinese remainder theorem. Also, note that, if \(f_{m,\ell} = f_{m+1,\ell}\), then \(P\) permutes the image of \(P^m\) on \(\mathbb{Z}_\ell\), and therefore \(f_{s,\ell} = f_{m,\ell}\) for all \(s > m\). So, as \(f_{m,ab} = 1\) for sufficiently large \(m\), we have for each \(m\)

\[
f_{m,a} > f_{m+1,a} \quad \text{or} \quad f_{m,a} = 1, \quad f_{m,b} > f_{m+1,b} \quad \text{or} \quad f_{m,b} = 1.
\]

Choose the smallest \(m\) such that \(f_{m+1,a} = 1\) or \(f_{m+1,b} = 1\). Without loss of generality assume that \(f_{m+1,a} = 1\). Then \(f_{m+1,ab} = f_{m+1,b} < f_{m,b} \leq f_{m,ab}/2 \leq f_{m+1,ab}\), a contradiction.

\textbf{Part 3.} The required polynomial does not exist when \(n\) is an odd prime power that is not a prime.

Let \(n = p^k\), where \(p \geq 3\) is prime and \(k \geq 2\). For \(r \in \mathbb{Z}_p\) let \(S_r\) denote the subset of \(\mathbb{Z}_{p^k}\) consisting of numbers congruent to \(r\) modulo \(p\). We denote the cardinality of a set \(S\) by \(|S|\).

\textbf{Claim.} For any residue \(r\) modulo \(p\), either \(|P(S_r)| = p^{k-1}\) or \(|P(S_r)| \leq p^{k-2}\).

\textbf{Proof.} Recall that \(P(r + h) = P(r) + hP'(r) + h^2Q(r,h)\), where \(Q\) is an integer polynomial.

If \(p | P'(r)\), then \(P(r + ps) \equiv P(r) (\text{mod } p^2)\), hence all elements of \(P(S_r)\) are congruent modulo \(p^2\). So in this case \(|P(S_r)| \leq p^{k-2}\).

Now we show that \(p \uparrow P'(r)\) implies \(|P(S_r)| = p^{k-1}\) for all \(k\).

Suppose the contrary: \(|P(S_r)| < p^{k-1}\) for some \(k > 1\). Let us choose the smallest \(k\) for which this is so. To each residue in \(P(S_r)\) we assign its residue modulo \(p^{k-1}\); denote the resulting set by \(\overline{P}(S,r)\). We have \(|\overline{P}(S,r)| = p^{k-2}\) by virtue of minimality of \(k\). Then \(|P(S_r)| < p^{k-1} = p \cdot |\overline{P}(S,r)|\), that is, there is \(u = P(x) \in P(S_r) (x \equiv r (\text{mod } p))\) and \(t \neq 0 (\text{mod } p)\) such that \(u + p^{k-1}t \notin P(S_r)\).

Note that \(P(x + p^{k-1}s) \equiv u + p^{k-1}sP'(x) (\text{mod } p^k)\). Since \(P(x + p^{k-1}s) \neq u + p^{k-1}t (\text{mod } p^k)\), the congruence \(p^{k-1}sP'(x) \equiv p^{k-1}t (\text{mod } p^k)\) has no solutions. So the congruence \(sP'(x) \equiv t (\text{mod } p)\) has no solutions, which contradicts \(p \uparrow P'(r)\).

Since the image of \( P^m \) consists of one element for sufficiently large \( m \), we can take the smallest \( m \) such that \( |P^{m-1}(S_r)| = p^{k-1} \) for some \( r \in \mathbb{Z}_p \), but \( |P^m(S_q)| \leq p^{k-2} \) for all \( q \in \mathbb{Z}_p \).

From now on, we fix \( m \) and \( r \).

Since the image of \( P^{m-1}(\mathbb{Z}_{p^k}) \backslash P^{m-1}(S_r) \) under \( P \) contains \( P^m(\mathbb{Z}_{p^k}) \backslash P^m(S_r) \), we have

\[
a := |P^m(\mathbb{Z}_{p^k}) \backslash P^m(S_r)| \leq |P^{m-1}(\mathbb{Z}_{p^k}) \backslash P^{m-1}(S_r)|,
\]

thus

\[
a + p^{k-1} \leq f_{m-1,p^k} \leq 2f_{m,p^k} \leq 2p^{k-2} + 2a,
\]

so

\[
(p - 2)p^{k-2} \leq a.
\]

Since \( f_{i,p} = 1 \) for sufficiently large \( i \), there is exactly one \( t \in \mathbb{Z}_p \) such that \( P(t) \equiv t \pmod{p} \). Moreover, as \( i \) increases, the cardinality of the set \(\{s \in \mathbb{Z}_p \mid P^i(s) \equiv t \pmod{p}\}\) increases (strictly), until it reaches the value \( p \). So either

\[
|\{s \in \mathbb{Z}_p \mid P^{m-1}(s) \equiv t \pmod{p}\}| = p \quad \text{or} \quad |\{s \in \mathbb{Z}_p \mid P^{m-1}(s) \equiv t \pmod{p}\}| \geq m.
\]

Therefore, either \( f_{m-1,p} = 1 \) or there exists a subset \( X \subset \mathbb{Z}_p \) of cardinality at least \( m \) such that \( P^{m-1}(x) \equiv t \pmod{p} \) for all \( x \in X \).

In the first case \( |P^{m-1}(\mathbb{Z}_{p^k})| \leq p^{k-1} = |P^{m-1}(S_r)| \), so \( a = 0 \), a contradiction.

In the second case let \( Y \) be the set of all elements of \( \mathbb{Z}_{p^k} \) congruent to some element of \( X \) modulo \( p \). Let \( Z = \mathbb{Z}_{p^k} \backslash Y \). Then \( P^{m-1}(Y) \subset S_t \), \( P(S_t) \subset S_t \), and \( Z = \bigcup_{t \in \mathbb{Z}_p \backslash X} S_t \), so

\[
|P^m(Y)| \leq |P(S_t)| \leq p^{k-2} \quad \text{and} \quad |P^m(Z)| \leq |\mathbb{Z}_p \backslash X| \cdot p^{k-2} \leq (p - m)p^{k-2}.
\]

Hence,

\[
(p - 2)p^{k-2} \leq a < |P^m(\mathbb{Z}_{p^k})| \leq |P^m(Y)| + |P^m(Z)| \leq (p - m + 1)p^{k-2}
\]

and \( m < 3 \). Then \( |P^2(S_q)| \leq p^{k-2} \) for all \( q \in \mathbb{Z}_p \), so

\[
p^k/4 \leq |P^2(\mathbb{Z}_{p^k})| \leq p^{k-1},
\]

which is impossible for \( p \geq 5 \). It remains to consider the case \( p = 3 \).

As before, let \( t \) be the only residue modulo 3 such that \( P(t) \equiv t \pmod{3} \).

If \( 3 \nmid P'(t) \), then \( P(S_t) = S_t \) by the proof of the Claim above, which is impossible.

So \( 3 \mid P'(t) \). By substituting \( h = 3^i s \) into the formula \( P(t + h) = P(t) + hP'(t) + h^2Q(t,h) \), we obtain \( P(t + 3^i s) \equiv P(t) \pmod{3^{i+1}} \). Using induction on \( i \) we see that all elements of \( P^i(S_t) \) are congruent modulo \( 3^{i+1} \). Thus, \( |P^{k-1}(S_t)| = 1 \).

Note that \( f_{1,3} \leq 2 \) and \( f_{2,3} \leq 1 \), so \( P^2(\mathbb{Z}_{3^k}) \subset S_t \). Therefore, \( |P^{k+1}(\mathbb{Z}_{3^k})| \leq |P^{k-1}(S_t)| = 1 \). It follows that \( 3^k \leq 2^{k+1} \), which is impossible for \( k \geq 2 \).

\textbf{Comment.} Here is an alternative version of the problem.

A function \( f : \mathbb{Z} \rightarrow \mathbb{Z} \) is chosen so that \( a - b \mid f(a) - f(b) \) for all \( a, b \in \mathbb{Z} \) with \( a \neq b \). Let \( S_0 = \mathbb{Z} \), and for each positive integer \( m \), let \( S_m \) denote the image of \( f \) on the set \( S_{m-1} \). It is given that, for each nonnegative integer \( m \), there are exactly \( [n/2^m] \) distinct residues modulo \( n \) in the set \( S_m \). Find all possible values of \( n \).

\textbf{Answer:} All powers of primes.

\textbf{Solution.} Observe that \( f \) can be regarded as a function \( \mathbb{Z}_\ell \rightarrow \mathbb{Z}_\ell \) for any positive integer \(\ell\). We use notations \( f^m \) and \( f_{m,\ell} \) as in the above solution.

\textbf{Part 1.} There exists a function \( f : \mathbb{Z}_{p^k} \rightarrow \mathbb{Z}_{p^k} \) satisfying the desired properties.

For \( x \in \mathbb{Z}_{p^k} \), let \(\operatorname{rev}(x)\) denote the reversal of the base-\( p \) digits of \( x \) (we write every \( x \in \mathbb{Z}_{p^k} \) with exactly \( k \) digits, adding zeroes at the beginning if necessary). Choose

\[
f(x) = \operatorname{rev}\left(\frac{\operatorname{rev}(x)}{2}\right)
\]

where, for dividing by 2, \(\operatorname{rev}(x)\) is interpreted as an integer in the range \([0, p^k)\). It is easy to see that \( f_{m+1,k} = [f_{m,k}/2] \).

We claim that if \( a, b \in \mathbb{Z}_{p^k} \) so that \( p^m|a - b \), then \( p^m|f(a) - f(b) \). Let \( x = \operatorname{rev}(a), y = \operatorname{rev}(b) \). The first \( m \) digits of \( x \) and \( y \) are the same, i.e \( |x/p^{m-k}| = |y/p^{m-k}| \). For every positive integers \( c, d \) and \( z \) we have \( |z/c|/d| = |z/(cd)| = |z/d|/c| \), so

\[
\left| \frac{x}{2} / p^{m-k} \right| = \left| \frac{x}{p^{m-k}} / 2 \right| = \left| \frac{y}{p^{m-k}} / 2 \right| = \left| \frac{y}{2} / p^{m-k} \right|.
\]

Thus, the first \( m \) digits of \( |x/2| \) and \( |y/2| \) are the same. So the last \( m \) digits of \( f(a) \) and \( f(b) \) are the same, i.e. \( p^m|f(a) - f(b) \).

\textbf{Part 2.} Lifting the function \( f : \mathbb{Z}_{p^k} \rightarrow \mathbb{Z}_{p^k} \) to a function on all of \( \mathbb{Z} \).

We show that, for any function \( f : \mathbb{Z}_{p^k} \rightarrow \mathbb{Z}_{p^k} \) for which \( \gcd(p^k, a - b) \mid f(a) - f(b) \), there is a corresponding function \( g : \mathbb{Z} \rightarrow \mathbb{Z} \) for which \( a - b \mid g(a) - g(b) \) for all distinct integers \( a, b \) and \( g(x) \equiv f(x) (\text{mod } p^k) \) for all \( x \in \mathbb{Z} \), whence the proof will be completed. We will construct the values of such a function inductively; assume that we have constructed it for some interval \([a, b)\) and wish to define \( g(b) \). (We will define \( g(a - 1) \) similarly.)

For every prime \( q \leq |a - b| \), we choose the maximal \( \alpha_q \) for which there exists \( c_q \in [a, b) \), such that \( b - c_q : q^{\alpha_q} \), and choose one such \( c_q \).

We apply Chinese remainder theorem to find \( g(b) \) satisfying the following conditions:

\[
g(b) \equiv g(c_q) \quad (\text{mod } q^{\alpha_q}) \quad \text{for} \quad q \neq p, \quad \text{and}
\]

\[
g(b) \equiv g(c_p) \quad (\text{mod } q^{\alpha_p}) \quad \text{if} \quad \alpha_p \geq k, \quad g(b) \equiv f(b) \quad (\text{mod } p^k) \quad \text{if} \quad \alpha_p < k.
\]

It is not hard to verify that \( b - c \mid g(b) - g(c) \) for every \( c \in [a, b) \) and \( g(b) \equiv f(b) (\text{mod } p^k) \).

\textbf{Part 3.} The required function does not exist if \( n \) has at least two different prime divisors.

The proof is identical to the polynomial version.
So the sum of all powers of \(2\) and all primes that less than \(20\) is \(106\).",106,number theory
2020a1,"Let \( n \) be a positive integer, and set \( N = 2^n \). Determine the smallest real number \( a_n \) such that, for all real \( x \),

\[
\sqrt[n]{\frac{x^{2N} + 1}{2}} \leq a_n(x - 1)^2 + x.
\]
What is \(a_n\) when \(n=8\)?","\textbf{Solution 1 (for Version 1).} First of all, assume that \(a_{n} < N/2\) satisfies the condition. Take \(x = 1 + t\) for \(t > 0\), we should have

\[
\frac{(1 + t)^{2N} + 1}{2} \leq (1 + t + a_{n}t^{2})^{N}.
\]

Expanding the brackets we get

\[
(1 + t + a_{n}t^{2})^{N} - \frac{(1 + t)^{2N} + 1}{2} = \left(Na_{n} - \frac{N^{2}}{2}\right)t^{2} + c_{3}t^{3} + \ldots + c_{2N}t^{2N}
\] 
(1)

with some coefficients \(c_{3}, \ldots, c_{2N}\). Since \(a_{n} < N/2\), the right hand side of (1) is negative for sufficiently small \(t\). A contradiction.

It remains to prove the following inequality

\[
\sqrt[N]{\frac{1 + x^{2N}}{2}} \leq x + \frac{N}{2}(x - 1)^{2},
\]

where \(N = 2^{n}\).

Use induction in \(n\). The base case \(n = 0\) is trivial: \(N = 1\) and both sides of \(\mathcal{I}(N, x)\) are equal to \((1 + x^{2})/2\). For completing the induction we prove \(\mathcal{I}(2N, x)\) assuming that \(\mathcal{I}(N, y)\) is established for all real \(y\). We have

\[
\bigl{(}x + N(x - 1)^{2}\bigr{)}^{2} = x^{2} + N^{2}(x - 1)^{4} + N(x - 1)^{2}\frac{(x + 1)^{2} - (x - 1)^{2}}{2}
\] 
\[
= x^{2} + \frac{N}{2}(x^{2} - 1)^{2} + \left(N^{2} - \frac{N}{2}\right)(x - 1)^{4} \geq x^{2} + \frac{N}{2}(x^{2} - 1)^{2} \geq \sqrt[N]{\frac{1 + x^{4N}}{2}},
\]

where the last inequality is \(\mathcal{I}(N, x^{2})\). Since

\[
x + N(x - 1)^{2} \geq x + \frac{(x - 1)^{2}}{2} = \frac{x^{2} + 1}{2} \geq 0,
\]

taking square root we get \(\mathcal{I}(2N, x)\). The inductive step is complete. \(a_n = \frac{N}{2}.\)
So \(a_n=128\) when \(n=8\).",128,algebra
2020a2,"\textbf{A2.}  
Let \( \mathcal{A} \) denote the set of all polynomials in three variables \( x, y, z \) with integer coefficients. Let \( \mathcal{B} \) denote the subset of \( \mathcal{A} \) formed by all polynomials which can be expressed as  
\[
(x + y + z)P(x, y, z) + (xy + yz + zx)Q(x, y, z) + xyzR(x, y, z)
\]
with \( P, Q, R \in \mathcal{A} \). Find the smallest non-negative integer \( n \) such that \( x^i y^j z^k \in \mathcal{B} \) for all non-negative integers \( i, j, k \) satisfying \( i + j + k \geq n \).","\textbf{Solution.} We start by showing that \(n \leq 4\), i.e., any monomial \(f = x^{i}y^{j}z^{k}\) with \(i + j + k \geq 4\) belongs to \(\mathcal{B}\). Assume that \(i \geq j \geq k\), the other cases are analogous.

Let \(x + y + z = p\), \(xy + yz + zx = q\) and \(xyz = r\). Then

\[
0 = (x - x)(x - y)(x - z) = x^{3} - px^{2} + qx - r,
\]

therefore \(x^{3} \in \mathcal{B}\). Next, \(x^{2}y^{2} = xyq - (x + y)r \in \mathcal{B}\).

If \(k \geq 1\), then \(r\) divides \(f\), thus \(f \in \mathcal{B}\). If \(k = 0\) and \(j \geq 2\), then \(x^{2}y^{2}\) divides \(f\), thus we have \(f \in \mathcal{B}\) again. Finally, if \(k = 0, j \leq 1\), then \(x^{3}\) divides \(f\) and \(f \in \mathcal{B}\) in this case also.

In order to prove that \(n \geq 4\), we show that the monomial \(x^{2}y\) does not belong to \(\mathcal{B}\). Assume the contrary:

\[
x^{2}y = pP + qQ + rR
\] 
(1)

for some polynomials \(P, Q, R\). If polynomial \(P\) contains the monomial \(x^{2}\) (with nonzero coefficient), then \(pP + qQ + rR\) contains the monomial \(x^{3}\) with the same nonzero coefficient. So \(P\) does not contain \(x^{2}\), \(y^{2}\), \(z^{2}\) and we may write

\[
x^{2}y = (x + y + z)(axy + byz + czx) + (xy + yz + zx)(dx + ey + fz) + gxyz,
\]

where \(a, b, c\); \(d, e, f\); \(g\) are the coefficients of \(xy, yz, zx\); \(x, y, z\); \(xyz\) in the polynomials \(P\); \(Q\); \(R\), respectively (the remaining coefficients do not affect the monomials of degree 3 in \(pP + qQ + rR\)). By considering the coefficients of \(xy^{2}\) we get \(e = -a\), analogously \(e = -b\), \(f = -b\), \(f = -c\), \(d = -c\), thus \(a = b = c\) and \(f = e = d = -a\), but then the coefficient of \(x^{2}y\) in the right hand side equals \(a + d = 0 \neq 1\).

\textbf{Comment 1.} The general question is the following. Call a polynomial \(f(x_{1}, \ldots, x_{n})\) with integer coefficients \textit{nice}, if \(f(0, 0, \ldots, 0) = 0\) and \(f(x_{\pi_{1}}, \ldots, x_{\pi_{n}}) = f(x_{1}, \ldots, x_{n})\) for any permutation \(\pi\) of \(1, \ldots, n\) (in other words, \(f\) is symmetric and its constant term is zero.) Denote by \(\mathcal{I}\) the set of polynomials of the form

\[
p_{1}q_{1} + p_{2}q_{2} + \ldots + p_{m}q_{m},
\] 
(2)

where \(m\) is an integer, \(q_{1}, \ldots, q_{m}\) are polynomials with integer coefficients, and \(p_{1}, \ldots, p_{m}\) are nice polynomials. Find the least \(N\) for which any monomial of degree at least \(N\) belongs to \(\mathcal{I}\).

The \textbf{answer} is \(n(n - 1)/2 + 1\). The lower bound follows from the following claim: the polynomial

\[
F(x_{1}, \ldots, x_{n}) = x_{2}x_{3}^{2}x_{4}^{3} \cdot \ldots \cdot x_{n}^{n - 1}
\]

does not belong to \(\mathcal{I}\).

Assume that \(F = \sum p_{i}q_{i}\), according to (2). By taking only the monomials of degree \(n(n - 1)/2\), we can additionally assume that every \(p_{i}\) and every \(q_{i}\) is homogeneous, \(\deg p_{i} > 0\), and \(\deg p_{i} + \deg q_{i} = \deg F = n(n - 1)/2\) for all \(i\).

Consider the alternating sum

\[
\sum_{\pi} \text{sign}(\pi) F(x_{\pi_{1}}, \ldots, x_{\pi_{n}}) = \sum_{i = 1}^{m} p_{i} \sum_{\pi} \text{sign}(\pi) q_{i}(x_{\pi_{1}}, \ldots, x_{\pi_{n}}):= S,
\] 
(3)

where the summation is done over all permutations \(\pi\) of \(1, \ldots, n\), and \(\text{sign}(\pi)\) denotes the sign of the permutation \(\pi\). Since \(\deg q_{i} = n(n - 1)/2 - \deg p_{i} < n(n - 1)/2\), in any monomial \(Q\) of \(q_{i}\), there are at least two variables, say \(x_{\alpha}\) and \(x_{\beta}\), with equal exponents. Therefore \(\sum_{\pi} \text{sign}(\pi) Q(x_{\pi_{1}}, \ldots, x_{\pi_{n}}) = 0\), because each pair of terms that corresponds to permutations which differ by the transposition of \(\alpha\) and \(\beta\), cancels out. This holds for any \(i = 1, \ldots, m\) and any monomial of \(q_{i}\), so \(S = 0\). But the left hand side of (3) is a non-zero polynomial. This is a contradiction.

Let us now prove, using induction on \(n\), that any monomial \(h = x_{1}^{c_{1}} \ldots x_{n}^{c_{n}}\) of degree \(n(n - 1)/2 + 1\) belongs to \(\mathcal{I}\), and additionally all \(p_{i}, q_{i}\) in the representation (2) can be chosen homogeneous with sum of degrees equal to \(n(n - 1)/2 + 1\). (Obviously, any monomial of degree at least \(n(n - 1)/2 + 1\) is divisible by a monomial of degree exactly \(n(n - 1)/2 + 1\), thus this suffices.) The proposition is true for \(n = 1\), so assume that \(n > 1\) and that the proposition is proved for smaller values of \(n\).

We proceed by an internal induction on \(S := \left|\{i \colon c_{i} = 0\}\right|\). In the base case \(S = 0\) the monomial \(h\) is divisible by the nice polynomial \(x_{1} \cdot \ldots \cdot x_{n}\), therefore \(h \in \mathcal{I}\). Now assume that \(S > 0\) and that the claim holds for smaller values of \(S\). Let \(T = n - S\). We may assume that \(c_{T + 1} = \ldots = c_{n} = 0\) and \(h = x_{1} \cdot \ldots \cdot x_{T} g(x_{1}, \ldots, x_{n - 1})\), where \(\deg g = n(n - 1)/2 - T + 1 \geq (n - 1)(n - 2)/2 + 1\). Using the outer induction hypothesis we represent \(g\) as \(p_{1}q_{1} + \ldots + p_{m}q_{m}\), where \(p_{i}(x_{1}, \ldots, x_{n - 1})\) are nice polynomials in \(n - 1\) variables. There exist nice homogeneous polynomials \(P_{i}(x_{1}, \ldots, x_{n})\) such that \(P_{i}(x_{1}, \ldots, x_{n - 1}, 0) = p_{i}(x_{1}, \ldots, x_{n - 1})\). In other words, \(\Delta_{i} := p_{i}(x_{1}, \ldots, x_{n - 1}) - P_{i}(x_{1}, \ldots, x_{n - 1}, x_{n})\) is divisible by \(x_{n}\), let \(\Delta_{i} = x_{n} g_{i}\). We get

\[
h = x_{1} \cdot \ldots \cdot x_{T} \sum p_{i} q_{i} = x_{1} \cdot \ldots \cdot x_{T} \sum (P_{i} + x_{n} g_{i}) q_{i} = (x_{1} \cdot \ldots \cdot x_{T} x_{n}) \sum g_{i} q_{i} + \sum P_{i} q_{i} \in \mathcal{I}.
\]

The first term belongs to \(\mathcal{I}\) by the inner induction hypothesis. This completes both inductions.",4,algebra
2020a3,"\textbf{A3.} Suppose that \( a, b, c, d \) are positive real numbers satisfying \( (a + c)(b + d) = ac + bd \). Find the smallest possible value of  
\[
S = \frac{a}{b} + \frac{b}{c} + \frac{c}{d} + \frac{d}{a}.
\]","By homogeneity, we may suppose that \(abcd = 1\). Let \(ab = C\), \(bc = A\), and \(ca = B\). Then \(a\), \(b\), \(c\) can be reconstructed from \(A\), \(B\), and \(C\) as \(a = \sqrt{BC/A}\), \(b = \sqrt{AC/B}\), and \(c = \sqrt{AB/C}\). Moreover, the condition \((a + c)(b + d) = ac + bd\) can be written in terms of \(A, B, C\) as

\[
A + \frac{1}{A} + C + \frac{1}{C} = bc + ad + ab + cd = (a + c)(b + d) = ac + bd = B + \frac{1}{B}.
\]

We then need to minimize the expression

\[
S := \frac{ad + bc}{bd} + \frac{ab + cd}{ac} = \left(A + \frac{1}{A}\right)B + \left(C + \frac{1}{C}\right)\frac{1}{B}
\] 
\[
= \left(A + \frac{1}{A}\right)\left(B - \frac{1}{B}\right) + \left(A + \frac{1}{A} + C + \frac{1}{C}\right)\frac{1}{B}
\] 
\[
= \left(A + \frac{1}{A}\right)\left(B - \frac{1}{B}\right) + \left(B + \frac{1}{B}\right)\frac{1}{B}.
\]

Without loss of generality, assume that \(B \geq 1\) (otherwise, we may replace \(B\) by \(1/B\) and swap \(A\) and \(C\), this changes neither the relation nor the function to be maximized). Therefore, we can write

\[
S \geq 2\left(B - \frac{1}{B}\right) + \left(B + \frac{1}{B}\right)\frac{1}{B} = 2B + \left(1 - \frac{1}{B}\right)^2 =: f(B).
\]

Clearly, \(f\) increases on \([1, \infty)\). Since

\[
B + \frac{1}{B} = A + \frac{1}{A} + C + \frac{1}{C} \geq 4,
\]

we have \(B \geq B'\), where \(B' = 2 + \sqrt{3}\) is the unique root greater than \(1\) of the equation \(B' + 1/B' = 4\). Hence,

\[
S \geq f(B) \geq f(B') = 2\left(B' - \frac{1}{B'}\right) + \left(B' + \frac{1}{B'}\right)\frac{1}{B'} = 2B' - \frac{2}{B'} + \frac{4}{B'} = 8.
\]

It remains to note that when \(A = C = 1\) and \(B = B'\), we have the equality \(S = 8\).",8,algebra
2020a5,"\textbf{A5.}  
A magician intends to perform the following trick. She announces a positive integer \( n \), along with \( 2n \) real numbers \( x_1 < \ldots < x_{2n} \), to the audience. A member of the audience then secretly chooses a polynomial \( P(x) \) of degree \( n \) with real coefficients, computes the \( 2n \) values \( P(x_1), \ldots, P(x_{2n}) \), and writes down these \( 2n \) values on the blackboard in non-decreasing order. After that, the magician announces the secret polynomial to the audience.  

Can the magician find a strategy to perform such a trick? If the magician find a strategy, the answer should be \(1\). Else the answer should be \(0\).","\textbf{Solution.} Let \( x_1 < x_2 < \ldots < x_{2n} \) be real numbers chosen by the magician. We will construct two distinct polynomials \( P(x) \) and \( Q(x) \), each of degree \( n \), such that the member of audience will write down the same sequence for both polynomials. This will mean that the magician cannot distinguish \( P \) from \( Q \).

\textbf{Claim.} There exists a polynomial \( P(x) \) of degree \( n \) such that \( P(x_{2i-1}) + P(x_{2i}) = 0 \) for \( i = 1, 2, \ldots, n \).

\textbf{Proof.} We want to find a polynomial \( a_n x^n + \ldots + a_1 x + a_0 \) satisfying the following system of equations:

\[
\begin{cases}
(x_1^n + x_2^n)a_n + (x_1^{n-1} + x_2^{n-1})a_{n-1} + \ldots + 2a_0 = 0 \\
(x_3^n + x_4^n)a_n + (x_3^{n-1} + x_4^{n-1})a_{n-1} + \ldots + 2a_0 = 0 \\
\ldots \\
(x_{2n-1}^n + x_{2n}^n)a_n + (x_{2n-1}^{n-1} + x_{2n}^{n-1})a_{n-1} + \ldots + 2a_0 = 0
\end{cases}
\]

We use the well known fact that a homogeneous system of \( n \) linear equations in \( n + 1 \) variables has a nonzero solution. (This fact can be proved using induction on \( n \), via elimination of variables.) Applying this fact to the above system, we find a nonzero polynomial \( P(x) \) of degree not exceeding \( n \) such that its coefficients \( a_0, \ldots, a_n \) satisfy this system. Therefore \( P(x_{2i-1}) + P(x_{2i}) = 0 \) for all \( i = 1, 2, \ldots, n \). Notice that \( P \) has a root on each segment \([x_{2i-1}, x_{2i}]\) by the Intermediate Value theorem, so \( n \) roots in total. Since \( P \) is nonzero, we get \(\deg P = n\). 

Now consider a polynomial \( P(x) \) provided by the Claim, and take \( Q(x) = -P(x) \). The properties of \( P(x) \) yield that \( P(x_{2i-1}) = Q(x_{2i}) \) and \( Q(x_{2i-1}) = P(x_{2i}) \) for all \( i = 1, 2, \ldots, n \). It is also clear that \( P \neq -P = Q \) and \(\deg Q = \deg P = n\).",0,algebra
2020a6,"Determine all functions \( f : \mathbb{Z} \to \mathbb{Z} \) such that  
\[
f^{a^2 + b^2}(a + b) = af(a) + bf(b)
\]
for every \( a, b \in \mathbb{Z} \).  

Here, \( f^n \) denotes the \( n^{\text{th}} \) iteration of \( f \), i.e., \( f^0(x) = x \) and \( f^{n+1}(x) = f(f^n(x)) \) for all \( n \geq 0 \). What is the value of \( f(100) \) if \( f(0)=1 \).","\textbf{Solution.} Refer to the main equation as \( E(a, b) \).  
\( E(0, b) \) reads as \( f^{b^2}(b) = bf(b) \). For \( b = -1 \) this gives \( f(-1) = 0 \).  
Now \( E(a, -1) \) reads as  
\[
f^{a^2+1}(a-1) = af(a) = f^{a^2}(a).
\]  
For \( x \in \mathbb{Z} \) define the orbit of \( x \) by \( O(x) = \{x, f(x), f(f(x)), \ldots\} \subseteq \mathbb{Z} \). We see that the orbits \( O(a-1) \) and \( O(a) \) differ by finitely many terms. Hence, any two orbits differ by finitely many terms. In particular, this implies that either all orbits are finite or all orbits are infinite.  

\textbf{Case 1: All orbits are finite.}  
Then \( O(0) \) is finite. Using \( E(a, -a) \) we get  
\[
a(f(a) - f(-a)) = af(a) - af(-a) = f^{2a^2}(0) \in O(0).
\]  
For \( |a| > \max_{z \in O(0)} |z| \), this yields \( f(a) = f(-a) \) and \( f^{2a^2}(0) = 0 \). Therefore, the sequence  
\[
(f^k(0): k = 0, 1, \ldots)
\] is purely periodic with a minimal period \( T \) which divides \( 2a^2 \). Analogously, \( T \) divides \( 2(a + 1)^2 \), therefore, \( T| \gcd(2a^2, 2(a + 1)^2) = 2 \), i.e., \( f(f(0)) = 0 \) and  
\[
a(f(a) - f(-a)) = f^{2a^2}(0) = 0
\] for all \( a \). Thus,  
\[
f(a) = f(-a) \quad \text{for all } a \neq 0; \tag{\blacktriangleleft}
\]  
in particular, \( f(1) = f(-1) = 0. \tag{\blacktriangleleft} \)  

Next, for each \( n \in \mathbb{Z} \), by \( E(n, 1-n) \) we get  
\[
nf(n) + (1-n)f(1-n) = f^{n^2+(1-n)^2}(1) = f^{2n^2-2n}(0) = 0. \tag{\bigcirc}
\]  
Assume that there exists some \( m \neq 0 \) such that \( f(m) \neq 0 \). Choose such an \( m \) for which \( |m| \) is minimal possible. Then \( |m| > 1 \) due to \( (\blacktriangleleft) \); \( f(|m|) \neq 0 \) due to \( (\blacktriangleleft) \); and \( f(1-|m|) \neq 0 \) due to \( (\bigcirc) \) for \( n = |m| \). This contradicts to the minimality assumption.  
So, \( f(n) = 0 \) for \( n \neq 0 \). Finally, \( f(0) = f^3(0) = f^4(2) = 2f(2) = 0 \). Clearly, the function \( f(x) \equiv 0 \) satisfies the problem condition, which provides the first of the two answers.  

\textbf{Case 2: All orbits are infinite.}  
Since the orbits \( O(a) \) and \( O(a-1) \) differ by finitely many terms for all \( a \in \mathbb{Z} \), each two orbits \( O(a) \) and \( O(b) \) have infinitely many common terms for arbitrary \( a, b \in \mathbb{Z} \).  
For a minute, fix any \( a, b \in \mathbb{Z} \). We claim that all pairs \( (n, m) \) of nonnegative integers such that \( f^n(a) = f^m(b) \) have the same difference \( n-m \). Arguing indirectly, we have \( f^n(a) = f^m(b) \) and \( f^p(a) = f^q(b) \) with, say, \( n-m > p-q \), then \( f^{p+m+k}(b) = f^{p+n+k}(a) = f^{q+n+k}(b) \), for all nonnegative integers \( k \). This means that \( f^{t+(n-m)-(p-q)}(b) = f^t(b) \) for all sufficiently large \( t \), i.e., that the sequence \( (f^n(b)) \) is eventually periodic, so \( O(b) \) is finite, which is impossible.  
Now, for every \( a, b \in \mathbb{Z} \), denote the common difference \( n-m \) defined above by \( X(a, b) \). We have \( X(a-1, a) = 1 \) by (1). Trivially, \( X(a, b) + X(b, c) = X(a, c) \), as if \( f^n(a) = f^m(b) \) and \( f^p(b) = f^q(c) \), then \( f^{p+m}(a) = f^{p+m}(b) = f^{q+m}(c) \). These two properties imply that \( X(a, b) = b-a \) for all \( a, b \in \mathbb{Z} \).

But (1) yields \( f^{a^2+1}(f(a-1)) = f^{a^2}(f(a)) \), so  
\[
1 = X(f(a-1), f(a)) = f(a) - f(a-1)
\] for all \( a \in \mathbb{Z} \).  

Recalling that \( f(-1) = 0 \), we conclude by (two-sided) induction on \( x \) that \( f(x) = x + 1 \) for all \( x \in \mathbb{Z} \).  

Finally, the obtained function also satisfies the assumption. Indeed, \( f^n(x) = x + n \) for all \( n \geq 0 \), so  
\[
f^{a^2+b^2}(a+b) = a + b + a^2 + b^2 = af(a) + bf(b).
\]
Either \( f(x) = 0 \) for all \( x \in \mathbb{Z} \), or \( f(x) = x + 1 \) for all \( x \in \mathbb{Z} \). If \( f(0)=1 \), then \( f(100)=101 \).",101,algebra
2020a8,"Let \(\mathbb{R}^+\) be the set of positive real numbers. Determine all functions \(f: \mathbb{R}^+ \to \mathbb{R}^+\) such that, for all positive real numbers \(x\) and \(y\),

\[
f(x + f(xy)) + y = f(x)f(y) + 1.
\]
What is the value of \(f(90)\).","A straightforward check shows that \( f(x) = x + 1 \) satisfies (*). We divide the proof of the converse statement into a sequence of steps.

\textbf{Step 1:} \( f \) is injective.
Put \( x = 1 \) in (*) and rearrange the terms to get
\[
y = f(1)f(y) + 1 - f(1 + f(y)).
\]
Therefore, if \( f(y_1) = f(y_2) \), then \( y_1 = y_2 \).

\textbf{Step 2:} \( f \) is (strictly) monotone increasing.
For any fixed \( y \in \mathbb{R}^+ \), the function
\[
g(x) := f(x + f(xy)) = f(x)f(y) + 1 - y
\]
is injective by Step 1. Therefore, \( x_1 + f(x_1y) \neq x_2 + f(x_2y) \) for all \( y, x_1, x_2 \in \mathbb{R}^+ \) with \( x_1 \neq x_2 \). Plugging in \( z_i = x_iy \), we arrive at
\[
\frac{z_1 - z_2}{y} \neq f(z_2) - f(z_1), \quad \text{or} \quad \frac{1}{y} \neq \frac{f(z_2) - f(z_1)}{z_1 - z_2}
\]
for all \( y, z_1, z_2 \in \mathbb{R}^+ \) with \( z_1 \neq z_2 \). This means that the right-hand side of the rightmost relation is always non-positive, i.e., \( f \) is monotone non-decreasing. Since \( f \) is injective, it is strictly monotone.

\textbf{Step 3:} There exist constants \( a \) and \( b \) such that \( f(y) = ay + b \) for all \( y \in \mathbb{R}^+ \).
Since \( f \) is monotone and bounded from below by 0, for each \( x_0 \geq 0 \), there exists a right limit \( \lim_{x \to x_0} f(x) \geq 0 \). Put \( p = \lim_{x \to 0} f(x) \) and \( q = \lim_{x \to p} f(x) \).
Fix an arbitrary \( y \) and take the limit of (*) as \( x \to 0 \). We have \( f(xy) \to p \) and hence \( f(x + f(xy)) \to q \); therefore, we obtain
\[
q + y = pf(y) + 1, \quad \text{or} \quad f(y) = \frac{q + y - 1}{p}.
\]
(Notice that \( p \neq 0 \), otherwise \( q + y = 1 \) for all \( y \), which is absurd.) The claim is proved.

\textbf{Step 4:} \( f(x) = x + 1 \) for all \( x \in \mathbb{R}^+ \).
Based on the previous step, write \( f(x) = ax + b \). Putting this relation into (*) we get
\[
a(x + axy + b) + b + y = (ax + b)(ay + b) + 1,
\]
which can be rewritten as
\[
(a - ab)x + (1 - ab)y + ab + b - b^2 - 1 = 0 \quad \text{for all } x, y \in \mathbb{R}^+.
\]
This identity may hold only if all the coefficients are 0, i.e.,
\[
a - ab = 1 - ab = ab + b - b^2 - 1 = 0.
\]
Hence, \( a = b = 1 \).
So \(f(x) = x+1\), and \(f(90)=91\).",91,algebra
2020c1,"Let \( n \) be a positive integer. Find the number of permutations \( a_1, a_2, \ldots, a_n \) of the sequence 1, 2, \ldots, \( n \) satisfying

\[
a_1 \leq 2a_2 \leq 3a_3 \leq \ldots \leq na_n
\] when \(n=19\)."," Denote by \( P_n \) the number of permutations that satisfy (*). It is easy to see that \( P_1 = 1 \) and \( P_2 = 2 \).

\textbf{Lemma 1.} Let \( n \geq 3 \). If a permutation \( a_1, \ldots, a_n \) satisfies (*) then either \( a_n = n \), or \( a_{n-1} = n \) and \( a_n = n - 1 \).

\textbf{Proof.} Let \( k \) be the index for which \( a_k = n \). If \( k = n \) then we are done.

If \( k = n - 1 \) then, by (*), we have \( n(n - 1) = (n - 1)a_{n-1} \leq na_n \), so \( a_n \geq n - 1 \). Since \( a_n \neq a_{n-1} = n \), the only choice for \( a_n \) is \( a_n = n - 1 \).

Now suppose that \( k \leq n - 2 \). For every \( k < i < n \) we have \( kn = ka_k \leq ia_i < na_i \), so \( a_i \geq k + 1 \). Moreover, \( na_n \geq (n - 1)a_{n-1} \geq (n - 1)(k + 1) = nk + (n - 1 - k) > nk \), so \( a_n \geq k + 1 \). Now the \( n - k + 1 \) numbers \( a_k, a_{k+1}, \ldots, a_n \) are all greater than \( k \); but there are only \( n - k \) such values; this is not possible. \(\square\)

If \( a_n = n \) then \( a_1, a_2, \ldots, a_{n-1} \) must be a permutation of the numbers \( 1, \ldots, n - 1 \) satisfying \( a_1 \leq 2a_2 \leq \cdots \leq (n - 1)a_{n-1} \); there are \( P_{n-1} \) such permutations. The last inequality in (*), \( (n - 1)a_{n-1} \leq na_n = n^2 \), holds true automatically.

If \( (a_{n-1}, a_n) = (n, n - 1) \), then \( a_1, \ldots, a_{n-2} \) must be a permutation of \( 1, \ldots, n - 2 \) satisfying \( a_1 \leq \cdots \leq (n - 2)a_{n-2} \); there are \( P_{n-2} \) such permutations. The last two inequalities in (*) hold true automatically by \( (n - 2)a_{n-2} \leq (n - 2)^2 < n(n - 1) = (n - 1)a_{n-1} = na_n \).

Hence, the sequence \( (P_1, P_2, \ldots) \) satisfies the recurrence relation \( P_n = P_{n-1} + P_{n-2} \) for \( n \geq 3 \). The first two elements are \( P_1 = F_2 \) and \( P_2 = F_3 \), so by a trivial induction we have \( P_n = F_{n+1} \).
The number of such permutations is \(F_{n+1}\), where \(F_k\) is the \(k^{\text{th}}\) Fibonacci number:  
\[
F_1 = F_2 = 1, \quad F_{n+1} = F_n + F_{n-1}.
\]. So when \(n=19\), the answer is \(6765\).",6765,combinatorics
2020c3,"Let \( n \) be an integer with \( n \geq 2 \). On a slope of a mountain, \( n^2 \) checkpoints are marked, numbered from 1 to \( n^2 \) from the bottom to the top. Each of two cable car companies, \( A \) and \( B \), operates \( k \) cable cars numbered from 1 to \( k \); each cable car provides a transfer from some checkpoint to a higher one. For each company, and for any \( i \) and \( j \) with \( 1 \leq i < j \leq k \), the starting point of car \( j \) is higher than the starting point of car \( i \); similarly, the finishing point of car \( j \) is higher than the finishing point of car \( i \). Say that two checkpoints are linked by some company if one can start from the lower checkpoint and reach the higher one by using one or more cars of that company (no movement on foot is allowed).

Determine the smallest \( k \), when \(n=50\), for which one can guarantee that there are two checkpoints that are linked by each of the two companies. ","\textbf{Solution.} We start with showing that for any \(k \leq n^{2} - n\) there may be no pair of checkpoints linked by both companies. Clearly, it suffices to provide such an example for \(k = n^{2} - n\).

Let company \(A\) connect the pairs of checkpoints of the form \((i, i+1)\), where \(n \nmid i\). Then all pairs of checkpoints \((i, j)\) linked by \(A\) satisfy \(\lceil i/n \rceil = \lceil j/n \rceil\).

Let company \(B\) connect the pairs of the form \((i, i+n)\), where \(1 \leq i \leq n^{2} - n\). Then pairs of checkpoints \((i, j)\) linked by \(B\) satisfy \(i \equiv j \pmod{n}\). Clearly, no pair \((i, j)\) satisfies both conditions, so there is no pair linked by both companies.

Now we show that for \(k = n^{2} - n + 1\) there always exist two required checkpoints. Define an \textit{\(A\)-chain} as a sequence of checkpoints \(a_{1} < a_{2} < \ldots < a_{t}\) such that company \(A\) connects \(a_{i}\) with \(a_{i+1}\) for all \(1 \leq i \leq t-1\), but there is no \(A\)-car transferring from some checkpoint to \(a_{1}\) and no \(A\)-car transferring from \(a_{t}\) to any other checkpoint. Define \textit{\(B\)-chains} similarly. Moving forth and back, one easily sees that any checkpoint is included in a unique \(A\)-chain (possibly consisting of that single checkpoint), as well as in a unique \(B\)-chain. Now, put each checkpoint into a correspondence to the pair of the \(A\)-chain and the \(B\)-chain it belongs to.

All finishing points of \(A\)-cars are distinct, so there are \(n^{2} - k = n - 1\) checkpoints that are not such finishing points. Each of them is a starting point of a unique \(A\)-chain, so the number of \(A\)-chains is \(n - 1\). Similarly, the number of \(B\)-chains also equals \(n - 1\). Hence, there are \((n - 1)^{2}\) pairs consisting of an \(A\)- and a \(B\)-chain. Therefore, two of the \(n^{2}\) checkpoints correspond to the same pair, so that they belong to the same \(A\)-chain, as well as to the same \(B\)-chain. This means that they are linked by both companies, as required.
So \(k = n^{2} - n + 1\). When \(n=50\), \(k=2451\).",2451,combinatorics
2020c4,"The Fibonacci numbers \( F_0, F_1, F_2, \ldots \) are defined inductively by \( F_0 = 0, \, F_1 = 1 \), and  
\[
F_{n+1} = F_n + F_{n-1} \quad \text{for } n \geq 1.
\]
Given an integer \( n \geq 2 \), determine the smallest size of a set \( S \) of integers such that for every \( k = 2, 3, \ldots, n \) there exist some \( x, y \in S \) such that \( x - y = F_k \). Give the answer with \(n=99\).","\textbf{Solution.} First we show that if a set \(S \subset \mathbb{Z}\) satisfies the conditions then \(|S| \geq \frac{n}{2} + 1\).

Let \(d = \lceil n/2 \rceil\), so \(n \leq 2d \leq n + 1\). In order to prove that \(|S| \geq d + 1\), construct a graph as follows. Let the vertices of the graph be the elements of \(S\). For each \(1 \leq k \leq d\), choose two elements \(x, y \in S\) such that \(x - y = F_{2k-1}\), and add the pair \((x, y)\) to the graph as edge. (Note that by the problem's constraints, there must be a pair \((x, y)\) with \(x - y = F_{2k-1}\) for every \(3 \leq 2k - 1 \leq 2d - 1 \leq n\); moreover, due to \(F_{1} = F_{2}\) we have a pair with \(x - y = F_{1}\) as well.) We will say that the \textit{length} of the edge \((x, y)\) is \(|x - y|\).

We claim that the graph contains no cycle. For the sake of contradiction, suppose that the graph contains a cycle \((x_{1}, \ldots, x_{\ell})\), and let the longest edge in the cycle be \((x_{1}, x_{\ell})\) with length \(F_{2m+1}\). The other edges \((x_{1}, x_{2}), \ldots, (x_{\ell-1}, x_{\ell})\) in the cycle are shorter than \(F_{2m+1}\) and distinct, their lengths form a subset of \(\{F_{1}, F_{3}, \ldots, F_{2m-1}\}\). But this is not possible because

\[
F_{2m+1} = |x_{\ell} - x_{1}| \leq \sum_{i=1}^{\ell-1} |x_{i+1} - x_{i}| \leq F_{1} + F_{3} + F_{5} + \ldots + F_{2m-1}
\]
\[
= F_{2} + (F_{4} - F_{2}) + (F_{6} - F_{4}) + \ldots + (F_{2m} - F_{2m-2}) = F_{2m} < F_{2m+1}.
\]

Hence, the graph has \(d\) edges and cannot contain a cycle, therefore it must contain at least \(d + 1\) vertices, so \(|S| \geq d + 1\).

Now we show a suitable set with \(d + 1\) elements. Let

\[
S = \{F_{0}, F_{2}, F_{4}, F_{5}, \ldots, F_{2d}\}.
\]

For \(1 \leq k \leq d\) we have \(F_{0}, F_{2k-2}, F_{2k} \in S\) with differences \(F_{2k} - F_{2k-2} = F_{2k-1}\) and \(F_{2k} - F_{0} = F_{2k}\), so each of \(F_{1}, F_{2}, \ldots, F_{2d}\) occurs as difference between two elements in \(S\). So this set containing \(d + 1\) numbers is suitable.
So the answer is \[ \lceil n/2 \rceil + 1. \] When \(n=99\), the value is \(50\).",50,combinatorics
2020c8,"Players \( A \) and \( B \) play a game on a blackboard that initially contains 2020 copies of the number 1. In every round, player \( A \) erases two numbers \( x \) and \( y \) from the blackboard, and then player \( B \) writes one of the numbers \( x + y \) and \( |x - y| \) on the blackboard. The game terminates as soon as, at the end of some round, one of the following holds:  
(1) one of the numbers on the blackboard is larger than the sum of all other numbers;  
(2) there are only zeros on the blackboard.  

Player \( B \) must then give as many cookies to player \( A \) as there are numbers on the blackboard. Player \( A \) wants to get as many cookies as possible, whereas player \( B \) wants to give as few as possible. Determine the number of cookies that \( A \) receives if both players play optimally.","\textbf{Solution.} For a positive integer \(n\), we denote by \(S_{2}(n)\) the sum of digits in its binary representation. We prove that, in fact, if a board initially contains an even number \(n > 1\) of ones, then \(A\) can guarantee to obtain \(S_{2}(n)\), but not more, cookies. The binary representation of 2020 is \(2020 = \overline{11111100100}_{2}\), so \(S_{2}(2020) = 7\), and the answer follows.

\textbf{A strategy for \(A\).} \textit{At any round, while possible, \(A\) chooses two equal nonzero numbers on the board.} Clearly, while \(A\) can make such choice, the game does not terminate. On the other hand, \(A\) can follow this strategy unless the game has already terminated. Indeed, if \(A\) always chooses two equal numbers, then each number appearing on the board is either \(0\) or a power of \(2\) with non-negative integer exponent, this can be easily proved using induction on the number of rounds. At the moment when \(A\) is unable to follow the strategy all nonzero numbers on the board are distinct powers of \(2\). If the board contains at least one such power, then the largest of those powers is greater than the sum of the others. Otherwise there are only zeros on the blackboard, in both cases the game terminates.

For every number on the board, define its \textit{range} to be the number of ones it is obtained from. We can prove by induction on the number of rounds that for any nonzero number \(k\) written by \(B\) its range is \(k\), and for any zero written by \(B\) its range is a power of \(2\). Thus at the end of each round all the ranges are powers of two, and their sum is \(n\). Since \(S_{2}(a + b) \leq S_{2}(a) + S_{2}(b)\) for any positive integers \(a\) and \(b\), the number \(n\) cannot be represented as a sum of less than \(S_{2}(n)\) powers of \(2\). Thus at the end of each round the board contains at least \(S_{2}(n)\) numbers, while \(A\) follows the above strategy. So \(A\) can guarantee at least \(S_{2}(n)\) cookies for himself.

\textbf{Comment.} There are different proofs of the fact that the presented strategy guarantees at least \(S_{2}(n)\) cookies for \(A\). For instance, one may denote by \(\Sigma\) the sum of numbers on the board, and by \(z\) the number of zeros. Then the board contains at least \(S_{2}(\Sigma) + z\) numbers; on the other hand, during the game, the number \(S_{2}(\Sigma) + z\) does not decrease, and its initial value is \(S_{2}(n)\). The claim follows.

\textbf{A strategy for \(B\).} Denote \(s = S_{2}(n)\).

Let \(x_{1}, \ldots, x_{k}\) be the numbers on the board at some moment of the game after \(B\)'s turn or at the beginning of the game. Say that a collection of \(k\) signs \(\varepsilon_{1}, \ldots, \varepsilon_{k} \in \{+1, -1\}\) is \textit{balanced} if

\[
\sum_{i=1}^{k} \varepsilon_{i} x_{i} = 0.
\]

We say that a situation on the board is \textit{good} if \(2^{s+1}\) does not divide the number of balanced collections. An appropriate strategy for \(B\) can be explained as follows: \textit{Perform a move so that the situation remains good, while it is possible.} We intend to show that in this case \(B\) will not lose more than \(S_{2}(n)\) cookies. For this purpose, we prove several lemmas.

For a positive integer \(k\), denote by \(\nu_{2}(k)\) the exponent of the largest power of \(2\) that divides \(k\). Recall that, by Legendre's formula, \(\nu_{2}(n!) = n - S_{2}(n)\) for every positive integer \(n\).

\textbf{Lemma 1.} The initial situation is good.

\textbf{Proof.} In the initial configuration, the number of balanced collections is equal to \(\binom{n}{n/2}\). We have

\[
\nu_{2}\left(\binom{n}{n/2}\right) = \nu_{2}(n!) - 2\nu_{2}\big{(}(n/2)!\big{)} = \big{(}n - S_{2}(n)\big{)} - 2\left(\frac{n}{2} - S_{2}(n/2)\right) = S_{2}(n) = s.
\]

Hence \(2^{s+1}\) does not divide the number of balanced collections, as desired. 

\textbf{Lemma 2.} \(B\) may play so that after each round the situation remains good.

\textbf{Proof.} Assume that the situation \((x_{1}, \ldots, x_{k})\) before a round is good, and that \(A\) erases two numbers, \(x_{p}\) and \(x_{q}\).

Let \(N\) be the number of all balanced collections, \(N_{+}\) be the number of those having \(\varepsilon_{p} = \varepsilon_{q}\), and \(N_{-}\) be the number of other balanced collections. Then \(N = N_{+} + N_{-}\). Now, if \(B\) replaces \(x_{p}\) and \(x_{q}\) by \(x_{p} + x_{q}\), then the number of balanced collections will become \(N_{+}\). If \(B\) replaces \(x_{p}\) and \(x_{q}\) by \(|x_{p} - x_{q}|\), then this number will become \(N_{-}\). Since \(2^{s+1}\) does not divide \(N\), it does not divide one of the summands \(N_{+}\) and \(N_{-}\), hence \(B\) can reach a good situation after the round. 

\textbf{Lemma 3.} Assume that the game terminates at a good situation. Then the board contains at most \(s\) numbers.

\textbf{Proof.} Suppose, one of the numbers is greater than the sum of the other numbers. Then the number of balanced collections is \(0\) and hence divisible by \(2^{s+1}\). Therefore, the situation is not good.

Then we have only zeros on the blackboard at the moment when the game terminates. If there are \(k\) of them, then the number of balanced collections is \(2^{k}\). Since the situation is good, we have \(k \leq s\). 

By Lemmas 1 and 2, \(B\) may act in such way that they keep the situation good. By Lemma 3, when the game terminates, the board contains at most \(s\) numbers. This is what we aimed to prove.",7,combinatorics
2020g1,"Let \( ABC \) be an isosceles triangle with \( BC = CA \), and let \( D \) be a point inside side \( AB \) such that \( AD < DB \). Let \( P \) and \( Q \) be two points inside sides \( BC \) and \( CA \), respectively, such that \( \angle DPB = \angle DQA = 90^\circ \). Let the perpendicular bisector of \( PQ \) meet line segment \( CQ \) at \( E \), and let the circumcircles of triangles \( ABC \) and \( CPQ \) meet again at point \( F \), different from \( C \).

Suppose that \( P, E, F \) are collinear. Calculate the value of \( \angle ACB \) (in degrees).","Let \(\ell\) be the perpendicular bisector of \(PQ\), and denote by \(\omega\) the circle \(CFPQ\). By \(DP \perp BC\) and \(DQ \perp AC\), the circle \(\omega\) passes through \(D\); moreover, \(CD\) is a diameter of \(\omega\).

The lines \(QE\) and \(PE\) are symmetric about \(\ell\), and \(\ell\) is a symmetry axis of \(\omega\) as well; it follows that the chords \(CQ\) and \(FP\) are symmetric about \(\ell\), hence \(C\) and \(F\) are symmetric about \(\ell\). Therefore, the perpendicular bisector of \(CF\) coincides with \(\ell\). Thus \(\ell\) passes through the circumcenter \(O\) of \(ABC\).

Let \(M\) be the midpoint of \(AB\). Since \(CM \perp DM\), \(M\) also lies on \(\omega\). By \(\angle ACM = \angle BCM\), the chords \(MP\) and \(MQ\) of \(\omega\) are equal. Then, from \(MP = MQ\) it follows that \(\ell\) passes through \(M\).

Finally, both \(O\) and \(M\) lie on lines \(\ell\) and \(CM\), therefore \(O = M\), and \(\angle ACB = 90^\circ\) follows.",90,geometry
2020g2,"Let \( ABCD \) be a convex quadrilateral. Suppose that \( P \) is a point in the interior of \( ABCD \) such that  

\[
\angle PAD : \angle PBA : \angle DPA = 1 : 2 : 3 = \angle CBP : \angle BAP : \angle BPC.
\]

The internal bisectors of angles \( ADP \) and \( PCB \) meet at a point \( Q \) inside the triangle \( ABP \). Calculate the value of \( \frac{AQ}{BQ} \).","Let \(\varphi = \angle PAD\) and \(\psi = \angle CBP\); then we have \(\angle PBA = 2\varphi\), \(\angle DPA = 3\varphi\), \(\angle BAP = 2\psi\) and \(\angle BPC = 3\psi\). Let \(X\) be the point on segment \(AD\) with \(\angle XPA = \varphi\). Then

\[
\angle PXD = \angle PAX + \angle XPA = 2\varphi = \angle DPA - \angle XPA = \angle DPX.
\]

It follows that triangle \(DPX\) is isosceles with \(DX = DP\) and therefore the internal angle bisector of \(\angle ADP\) coincides with the perpendicular bisector of \(XP\). Similarly, if \(Y\) is a point on \(BC\) such that \(\angle BPY = \psi\), then the internal angle bisector of \(\angle PCB\) coincides with the perpendicular bisector of \(PY\). Hence, we have to prove that the perpendicular bisectors of \(XP\), \(PY\), and \(AB\) are concurrent.

Notice that

\[
\angle AXP = 180^\circ - \angle PXD = 180^\circ - 2\varphi = 180^\circ - \angle PBA.
\]

Hence the quadrilateral \(AXPB\) is cyclic; in other words, \(X\) lies on the circumcircle of triangle \(APB\). Similarly, \(Y\) lies on the circumcircle of triangle \(APB\). It follows that the perpendicular bisectors of \(XP\), \(PY\), and \(AB\) all pass through the center of circle \((ABYPX)\). This finishes the proof.",1,geometry
2020n3,"Let \( n \) be an integer with \( n \geq 2 \). Does there exist a sequence \( (a_1, \ldots, a_n) \) of positive integers with not all terms being equal such that the arithmetic mean of every two terms is equal to the geometric mean of some (one or more) terms in this sequence? If the answer is yes, the answer should be \(1\). Else the answer should be \(0\).","Suppose that \( a_1, \ldots, a_n \) satisfy the required properties. Let \( d = \gcd(a_1, \ldots, a_n) \). If \( d > 1 \) then replace the numbers \( a_1, \ldots, a_n \) by \( \frac{a_1}{d}, \ldots, \frac{a_n}{d} \); all arithmetic and all geometric means will be divided by \( d \), so we obtain another sequence satisfying the condition. Hence, without loss of generality, we can assume that \( \gcd(a_1, \ldots, a_n) = 1 \).

We show two numbers, \( a_m \) and \( a_k \) such that their arithmetic mean, \( \frac{a_m + a_k}{2} \) is different from the geometric mean of any (nonempty) subsequence of \( a_1, \ldots, a_n \). That proves that there cannot exist such a sequence.

Choose the index \( m \in \{1, \ldots, n\} \) such that \( a_m = \max(a_1, \ldots, a_n) \). Note that \( a_m \geq 2 \), because \( a_1, \ldots, a_n \) are not all equal. Let \( p \) be a prime divisor of \( a_m \).

Let \( k \in \{1, \ldots, n\} \) be an index such that \( a_k = \max\{a_i : p \nmid a_i\} \). Due to \( \gcd(a_1, \ldots, a_n) = 1 \), not all \( a_i \) are divisible by \( p \), so such a \( k \) exists. Note that \( a_m > a_k \) because \( a_m \geq a_k \), \( p \mid a_m \) and \( p \nmid a_k \).

Let \( b = \frac{a_m + a_k}{2} \); we will show that \( b \) cannot be the geometric mean of any subsequence of \( a_1, \ldots, a_n \).

Consider the geometric mean, \( g = \sqrt[4]{a_{i_1} \ldots a_{i_t}} \) of an arbitrary subsequence of \( a_1, \ldots, a_n \). If none of \( a_{i_1}, \ldots, a_{i_t} \) is divisible by \( p \), then they are not greater than \( a_k \), so

\[
g = \sqrt[4]{a_{i_1} \ldots a_{i_t}} \leq a_k < \frac{a_m + a_k}{2} = b,
\]

and therefore \( g \neq b \).

Otherwise, if at least one of \( a_{i_1}, \ldots, a_{i_t} \) is divisible by \( p \), then \( 2g = 2\sqrt[4]{a_{i_1} \ldots a_{i_t}} \) is either not an integer or is divisible by \( p \), while \( 2b = a_m + a_k \) is an integer not divisible by \( p \), so \( g \neq b \) again.",0,number theory
2020n4,"For any odd prime \( p \) and any integer \( n \), let \( d_p(n) \in \{0, 1, \ldots, p-1\} \) denote the remainder when \( n \) is divided by \( p \). We say that \( (a_0, a_1, a_2, \ldots) \) is a \( p \)-sequence, if \( a_0 \) is a positive integer coprime to \( p \), and \( a_{n+1} = a_n + d_p(a_n) \) for \( n \geq 0 \).

(a) Do there exist infinitely many primes \( p \) for which there exist \( p \)-sequences \( (a_0, a_1, a_2, \ldots) \) and \( (b_0, b_1, b_2, \ldots) \) such that \( a_n > b_n \) for infinitely many \( n \), and \( b_n > a_n \) for infinitely many \( n \)?

(b) Do there exist infinitely many primes \( p \) for which there exist \( p \)-sequences \( (a_0, a_1, a_2, \ldots) \) and \( (b_0, b_1, b_2, \ldots) \) such that \( a_0 < b_0 \), but \( a_n > b_n \) for all \( n \geq 1 \)?
If the answers for both parts are all yes, then give the value of \(1\). Else give \(0\).","\textbf{Solution.} Fix some odd prime \( p \), and let \( T \) be the smallest positive integer such that \( p \mid 2^{T} - 1 \); in other words, \( T \) is the multiplicative order of 2 modulo \( p \).

Consider any \( p \)-sequence \( (x_{n}) = (x_{0}, x_{1}, x_{2}, \ldots) \). Obviously, \( x_{n+1} \equiv 2x_{n} \pmod{p} \) and therefore \( x_{n} \equiv 2^{n}x_{0} \pmod{p} \). This yields \( x_{n+T} \equiv x_{n} \pmod{p} \) and therefore \( d(x_{n+T}) = d(x_{n}) \) for all \( n \geq 0 \). It follows that the sum \( d(x_{n}) + d(x_{n+1}) + \ldots + d(x_{n+T-1}) \) does not depend on \( n \) and is thus a function of \( x_{0} \) (and \( p \)) only; we shall denote this sum by \( S_{p}(x_{0}) \), and extend the function \( S_{p}(\cdot) \) to all (not necessarily positive) integers. Therefore, we have \( x_{n+kT} = x_{n} + kS_{p}(x_{0}) \) for all positive integers \( n \) and \( k \). Clearly, \( S_{p}(x_{0}) = S_{p}(2^{t}x_{0}) \) for every integer \( t \geq 0 \).

In both parts, we use the notation

\[
S_{p}^{+} = S_{p}(1) = \sum_{i=0}^{T-1} d_{p}(2^{i}) \quad \text{and} \quad S_{p}^{-} = S_{p}(-1) = \sum_{i=0}^{T-1} d_{p}(p - 2^{i}).
\]

(a) Let \( q > 3 \) be a prime and \( p \) a prime divisor of \( 2^{q} + 1 \) that is greater than 3. We will show that \( p \) is suitable for part (a). Notice that \( 9 \nmid 2^{q} + 1 \), so that such a \( p \) exists. Moreover, for any two odd primes \( q < r \) we have \( \gcd(2^{q} + 1, 2^{r} + 1) = 2^{\gcd(q,r)} + 1 = 3 \), thus there exist infinitely many such primes \( p \).

For the chosen \( p \), we have \( T = 2q \). Since \( 2^{q} \equiv -1 \pmod{p} \), we have \( S_{p}^{+} = S_{p}^{-} \). Now consider the \( p \)-sequences \( (a_{n}) \) and \( (b_{n}) \) with \( a_{0} = p + 1 \) and \( b_{0} = p - 1 \); we claim that these sequences satisfy the required conditions. We have \( a_{0} > b_{0} \) and \( a_{1} = p + 2 < b_{1} = 2p - 2 \). It follows then that

\[
a_{k \cdot 2q} = a_{0} + kS_{p}^{+} > b_{0} + kS_{p}^{+} = b_{k \cdot 2q} \quad \text{and} \quad a_{k \cdot 2q + 1} = a_{1} + kS_{p}^{+} < b_{1} + kS_{p}^{+} = b_{k \cdot 2q + 1}
\]

for all \( k = 0, 1, \ldots \), as desired.

(b) Let \( q \) be an odd prime and \( p \) a prime divisor of \( 2^{q} - 1 \); thus we have \( T = q \). We will show that \( p \) is suitable for part (b). Notice that the numbers of the form \( 2^{q} - 1 \) are pairwise coprime (since \( \gcd(2^{q} - 1, 2^{r} - 1) = 2^{\gcd(q,r)} - 1 = 1 \) for any two distinct primes \( q \) and \( r \)), thus there exist infinitely many such primes \( p \). Notice that \( d_{p}(x) + d_{p}(p - x) = p \) for all \( x \) with \( p \nmid x \), so that the sum \( S_{p}^{+} + S_{p}^{-} = pq \) is odd, which yields \( S_{p}^{+} = S_{p}(1) \neq S_{p}(-1) = S_{p}^{-} \).

Assume that \( (x_{n}) \) and \( (y_{n}) \) are two \( p \)-sequences with \( S_{p}(x_{0}) > S_{p}(y_{0}) \) but \( x_{0} < y_{0} \). The first condition yields that

\[
x_{Mq + r} - y_{Mq + r} = (x_{r} - y_{r}) + M\big(S_{p}(x_{0}) - S_{p}(y_{0})\big) \geq (x_{r} - y_{r}) + M
\]

for all nonnegative integers \( M \) and every \( r = 0, 1, \ldots, q - 1 \). Thus, we have \( x_{n} > y_{n} \) for every \( n \geq q + q \cdot \max\{y_{r} - x_{r} \colon r = 0, 1, \ldots, q - 1\} \). Now, since \( x_{0} < y_{0} \), there exists the largest \( n_{0} \) with \( x_{n_{0}} < y_{n_{0}} \). In this case the \( p \)-sequences \( a_{n} = x_{n - n_{0}} \) and \( b_{n} = y_{n - n_{0}} \) possess the desired property (notice here that \( x_{n} \neq y_{n} \) for all \( n \geq 0 \), as otherwise we would have \( S_{p}(x_{0}) = S_{p}(x_{n}) = S_{p}(y_{n}) = S_{p}(y_{0}) \)).

It remains to find \( p \)-sequences \( (x_n) \) and \( (y_n) \) satisfying the two conditions. Recall that  
\( S_p^+ \neq S_p^- \). Now, if \( S_p^+ > S_p^- \), then we can put \( x_0 = 1 \) and \( y_0 = p - 1 \). Otherwise, if \( S_p^+ < S_p^- \), then we put \( x_0 = p - 1 \) and \( y_0 = p + 1 \).",1,number theory
2020n6,"For a positive integer \( n \), let \( d(n) \) be the number of positive divisors of \( n \), and let \( \varphi(n) \) be the number of positive integers not exceeding \( n \) which are coprime to \( n \). Does there exist a constant \( C \) such that  
\[
\frac{\varphi(d(n))}{d(\varphi(n))} \leq C
\]  
for all \( n \geq 1 \)? If there exists a constant \( C \), your answer should be \(1\). Else your answer should be \(0\).","Fix \( N > 1 \), let \( p_1, \ldots, p_k \) be all primes between 1 and \( N \) and \( p_{k+1}, \ldots, p_{k+s} \) be all primes between \( N + 1 \) and \( 2N \). Since for \( j \leq k + s \) all prime divisors of \( p_j - 1 \) do not exceed \( N \), we have
\[
\prod_{j=1}^{k+s} (p_j - 1) = \prod_{i=1}^k p_i^{c_i},
\]
with some fixed exponents \( c_1, \ldots, c_k \). Choose a huge prime number \( q \) and consider a number
\[
n = (p_1 \cdot \ldots \cdot p_k)^{q-1} \cdot (p_{k+1} \cdot \ldots \cdot p_{k+s}).
\]
Then
\[
\varphi(d(n)) = \varphi(q^k \cdot 2^s) = q^{k-1}(q - 1)2^{s-1}
\]
and
\[
d(\varphi(n)) = d \left( (p_1 \cdot \ldots \cdot p_k)^{q-2} \prod_{i=1}^{k+s} (p_i - 1) \right) = d \left( \prod_{i=1}^k p_i^{q-2 + c_i} \right) = \prod_{i=1}^k (q - 1 + c_i),
\]
so
\[
\frac{\varphi(d(n))}{d(\varphi(n))} = \frac{q^{k-1}(q - 1)2^{s-1}}{\prod_{i=1}^k (q - 1 + c_i)} = 2^{s-1} \cdot \frac{q - 1}{q} \cdot \prod_{i=1}^k \frac{q}{q - 1 + c_i},
\]
which can be made arbitrarily close to \( 2^{s-1} \) by choosing \( q \) large enough. It remains to show that \( s \) can be arbitrarily large, i.e. that there can be arbitrarily many primes between \( N \) and \( 2N \).

This follows, for instance, from the well-known fact that \( \sum_{p} \frac{1}{p} = \infty \), where the sum is taken over the set \( P \) of prime numbers. Indeed, if, for some constant \( C \), there were always at most \( C \) primes between \( 2^\ell \) and \( 2^{\ell+1} \), we would have
\[
\sum_{p \in P} \frac{1}{p} = \sum_{\ell=0}^{\infty} \sum_{\substack{p \in P \\ p \in [2^\ell, 2^{\ell+1})}} \frac{1}{p} \leq \sum_{\ell=0}^{\infty} \frac{C}{2^\ell} < \infty,
\]
which is a contradiction.",0,number theory
2019a1,"Let \(\mathbb{Z}\) be the set of integers. Determine all functions \(f : \mathbb{Z} \to \mathbb{Z}\) such that, for all integers \(a\) and \(b\),

\[
f(2a) + 2f(b) = f(f(a+b)).
\]

What is the value of \(f(90)\) if \(f(0)=5\)?
","Substituting \( a = 0, b = n + 1 \) gives 
\[
f(f(n + 1)) = f(0) + 2f(n + 1).
\] 
Substituting \( a = 1, b = n \) gives 
\[
f(f(n + 1)) = f(2) + 2f(n).
\]

In particular, 
\[
f(0) + 2f(n + 1) = f(2) + 2f(n),
\] 
and so 
\[
f(n + 1) - f(n) = \frac{1}{2}(f(2) - f(0)).
\] 
Thus \( f(n + 1) - f(n) \) must be constant. Since \( f \) is defined only on \( \mathbb{Z} \), this tells us that \( f \) must be a linear function; write \( f(n) = Mn + K \) for arbitrary constants \( M \) and \( K \), and we need only determine which choices of \( M \) and \( K \) work.

Now, (1) becomes
\[
2Ma + K + 2(Mb + K) = M(M(a + b) + K) + K
\]
which we may rearrange to form
\[
(M - 2)(M(a + b) + K) = 0.
\]

Thus, either \( M = 2 \), or \( M(a + b) + K = 0 \) for all values of \( a + b \). In particular, the only possible solutions are \( f(n) = 0 \) and \( f(n) = 2n + K \) for any constant \( K \in \mathbb{Z} \), and these are easily seen to work.
So the value of \(f(90)\) is \(185\) if \(f(0)=5\).",185,algebra
2019a2,"Let \( u_1, u_2, \ldots, u_{2019} \) be real numbers satisfying  
\[ u_1 + u_2 + \cdots + u_{2019} = 0 \quad \text{and} \quad u_1^2 + u_2^2 + \cdots + u_{2019}^2 = 1. \]  

Let \( a = \min(u_1, u_2, \ldots, u_{2019}) \) and \( b = \max(u_1, u_2, \ldots, u_{2019}) \). What is the minimum value of \(-6057ab\)?","Notice first that \( b > 0 \) and \( a < 0 \). Indeed, since \( \sum_{i=1}^{2019} u_i^2 = 1 \), the variables \( u_i \) cannot be all zero, and, since \( \sum_{i=1}^{2019} u_i = 0 \), the nonzero elements cannot be all positive or all negative.

Let \( P = \{ i : u_i > 0 \} \) and \( N = \{ i : u_i \leq 0 \} \) be the indices of positive and nonpositive elements in the sequence, and let \( p = |P| \) and \( n = |N| \) be the sizes of these sets; then \( p + n = 2019 \). By the condition \( \sum_{i=1}^{2019} u_i = 0 \) we have 
\[ 0 = \sum_{i=1}^{2019} u_i = \sum_{i \in P} u_i - \sum_{i \in N} |u_i|, \]
so
\[
\sum_{i \in P} u_i = \sum_{i \in N} |u_i|. \quad (1)
\]

After this preparation, estimate the sum of squares of the positive and nonpositive elements as follows:
\[
\sum_{i \in P} u_i^2 \leq \sum_{i \in P} b u_i = b \sum_{i \in P} u_i = b \sum_{i \in N} |u_i| \leq b \sum_{i \in N} |a| = -nab;
\]
\[
\sum_{i \in N} u_i^2 \leq \sum_{i \in N} |a| \cdot |u_i| = |a| \sum_{i \in N} |u_i| = |a| \sum_{i \in P} u_i \leq |a| \sum_{i \in P} b = -pab. \quad (2)
\]

The sum of these estimates is
\[
1 = \sum_{i=1}^{2019} u_i^2 = \sum_{i \in P} u_i^2 + \sum_{i \in N} u_i^2 \leq -(p + n) ab = -2019 ab;
\]
that proves \( ab \leq \frac{-1}{2019} \).
So the minimum value of \(-6057ab\) is \(3\).",3,algebra
2019a5,"Let \( x_1, x_2, \ldots, x_n \) be different real numbers. What is the value of \(\sum_{1 \leq i \leq n} \prod_{j \neq i} \frac{1 - x_i x_j}{x_i - x_j} \) when \(n=2013\).","Observe that $G$ is symmetric in the variables $x_{1},\ldots,x_{n}$. Define $V=\prod_{i<j}(x_{j}-x_{i})$ and let $F=G\cdot V$, which is a polynomial in $x_{1},\ldots,x_{n}$. Since $V$ is alternating, $F$ is also alternating (meaning that, if we exchange any two variables, then $F$ changes sign). Every alternating polynomial in $n$ variables $x_{1},\ldots,x_{n}$ vanishes when any two variables $x_{i}$, $x_{j}$ ($i\neq j$) are equal, and is therefore divisible by $x_{i}-x_{j}$ for each pair $i\neq j$. Since these linear factors are pairwise coprime, $V$ divides $F$ exactly as a polynomial. Thus $G$ is in fact a symmetric polynomial in $x_{1},\ldots,x_{n}$.

Now observe that if all $x_{i}$ are nonzero and we set $y_{i}=1/x_{i}$ for $i=1,\ldots,n$, then we have
\[
\frac{1-y_{i}y_{j}}{y_{i}-y_{j}}=\frac{1-x_{i}x_{j}}{x_{i}-x_{j}}\,,
\]
so that
\[
G\left(\frac{1}{x_{1}},\ldots,\frac{1}{x_{n}}\right)=G(x_{1},\ldots,x_{n})\,.
\]

By continuity this is an identity of rational functions. Since $G$ is a polynomial, it implies that $G$ is constant. (If $G$ were not constant, we could choose a point $(c_{1},\ldots,c_{n})$ with all $c_{i}\neq 0$, such that $G(c_{1},\ldots,c_{n})\neq G(0,\ldots,0)$; then $g(x):=G(c_{1}x,\ldots,c_{n}x)$ would be a nonconstant polynomial in the variable $x$, so $\left|g(x)\right|\to\infty$ as $x\to\infty$, hence $\left|G\left(\frac{y}{c_{1}},\ldots,\frac{y}{c_{n}}\right)\right|\to\infty$ as $y\to 0$, which is impossible since $G$ is a polynomial.)

We may identify the constant by substituting $x_{i}=\zeta^{i}$, where $\zeta$ is a primitive $n^{\text{th}}$ root of unity in $\mathbb{C}$. In the $i^{\text{th}}$ term in the sum in the original expression we have a factor $1-\zeta^{i}\zeta^{n-i}=0$, unless $i=n$ or $2i=n$. In the case where $n$ is odd, the only exceptional term is $i=n$, which gives the value $\prod_{j\neq n}\frac{1-\zeta^{j}}{1-\zeta^{j}}=1$. When $n$ is even, we also have the term $\prod_{j\neq\frac{n}{2}}\frac{1+\zeta^{j}}{-1-\zeta^{j}}=(-1)^{n-1}=-1$, so the sum is $0$.",1,algebra
2019c3,"Let \(n\) be a positive integer. Harry has \(n\) coins lined up on his desk, each showing heads or tails. He repeatedly does the following operation: if there are \(k\) coins showing heads and \(k>0\), then he flips the \(k^{\text{th}}\) coin over; otherwise he stops the process. (For example, the process starting with \(THT\) would be \(THT\to HHT\to HTT\to TTT\), which takes three steps.)

Letting \(C\) denote the initial configuration (a sequence of \(n\) \(H\)'s and \(T\)'s), write \(\ell(C)\) for the number of steps needed before all coins show \(T\). Show that this number \(\ell(C)\) is finite, and determine its average value over all \(2^{n}\) possible initial configurations \(C\) when \(n=80\).","We consider what happens with configurations depending on the coins they start and end with.

\begin{itemize}
    \item If a configuration starts with $H$, the last $n-1$ coins follow the given rules, as if they were all the coins, until they are all $T$, then the first coin is turned over.
    
    \item If a configuration ends with $T$, the last coin will never be turned over, and the first $n-1$ coins follow the given rules, as if they were all the coins.
    
    \item If a configuration starts with $T$ and ends with $H$, the middle $n-2$ coins follow the given rules, as if they were all the coins, until they are all $T$. After that, there are $2n-1$ more steps: first coins $1$, $2$, \ldots, $n-1$ are turned over in that order, then coins $n$, $n-1$, \ldots, $1$ are turned over in that order.
\end{itemize}

As this covers all configurations, and the number of steps is clearly finite for $0$ or $1$ coins, it follows by induction on $n$ that the number of steps is always finite.

We define $E_{AB}(n)$, where $A$ and $B$ are each one of $H$, $T$ or $*$, to be the average number of steps over configurations of length $n$ restricted to those that start with $A$, if $A$ is not $*$, and that end with $B$, if $B$ is not $*$ (so $*$ represents ``either $H$ or $T$''). The above observations tell us that, for $n\geqslant 2$:

\begin{itemize}
    \item $E_{H*}(n)=E(n-1)+1$.
    
    \item $E_{*T}(n)=E(n-1)$.
    
    \item $E_{HT}(n)=E(n-2)+1$ (by using both the observations for $H*$ and for $*T$).
    
    \item $E_{TH}(n)=E(n-2)+2n-1$.
\end{itemize}

Now $E_{H*}(n)=\frac{1}{4}(E_{HH}(n)+E_{HT}(n))$, so $E_{HH}(n)=2E(n-1)-E(n-2)+1$. Similarly, $E_{TT}(n)=2E(n-1)-E(n-2)-1$. So
\[
E(n)=\frac{1}{4}(E_{HT}(n)+E_{HH}(n)+E_{TT}(n)+E_{TH}(n))=E(n-1)+\frac{n}{2}.
\]

We have $E(0)=0$ and $E(1)=\frac{1}{2}$, so by induction on $n$ we have $E(n)=\frac{1}{4}n(n+1)$. So the average is \(820\) when \(n=1620\).",1620,combinatorics
2019c4,"On a flat plane in Camelot, King Arthur builds a labyrinth \(\mathfrak{L}\) consisting of \(n\) walls, each of which is an infinite straight line. No two walls are parallel, and no three walls have a common point. Merlin then paints one side of each wall entirely red and the other side entirely blue.

At the intersection of two walls there are four corners: two diagonally opposite corners where a red side and a blue side meet, one corner where two red sides meet, and one corner where two blue sides meet. At each such intersection, there is a two-way door connecting the two diagonally opposite corners at which sides of different colours meet.

After Merlin paints the walls, Morgana then places some knights in the labyrinth. The knights can walk through doors, but cannot walk through walls.

Let \(k(\mathfrak{L})\) be the largest number \(k\) such that, no matter how Merlin paints the labyrinth \(\mathfrak{L}\), Morgana can always place at least \(k\) knights such that no two of them can ever meet. For each \(n=800\), what are all possible values for \(k(\mathfrak{L})\), where \(\mathfrak{L}\) is a labyrinth with \(n\) walls?","First we show by induction that the \(n\) walls divide the plane into \(\binom{n+1}{2}+1\) regions. The claim is true for \(n=0\) as, when there are no walls, the plane forms a single region. When placing the \(n^{\text{th}}\) wall, it intersects each of the \(n-1\) other walls exactly once and hence splits each of \(n\) of the regions formed by those other walls into two regions. By the induction hypothesis, this yields \(\left(\binom{n}{2}+1\right)+n=\binom{n+1}{2}+1\) regions, proving the claim.

Now let \(G\) be the graph with vertices given by the \(\binom{n+1}{2}+1\) regions, and with two regions connected by an edge if there is a door between them.

We now show that no matter how Merlin paints the \(n\) walls, Morgana can place at least \(n+1\) knights. No matter how the walls are painted, there are exactly \(\binom{n}{2}\) intersection points, each of which corresponds to a single edge in \(G\). Consider adding the edges of \(G\) sequentially and note that each edge reduces the number of connected components by at most one. Therefore the number of connected components of \(G\) is at least \(\binom{n+1}{2}+1-\binom{n}{2}=n+1\). If Morgana places a knight in regions corresponding to different connected components of \(G\), then no two knights can ever meet.

Now we give a construction showing that, no matter what shape the labyrinth is, Merlin can color it such that there are exactly \(n+1\) connected components, allowing Morgana to place at most \(n+1\) knights.

First, we choose a coordinate system on the labyrinth so that none of the walls run due north-south, or due east-west. We then have Merlin paint the west face of each wall red, and the east face of each wall blue. We label the regions according to how many walls the region is on the east side of: the labels are integers between \(0\) and \(n\).

We claim that, for each \(i\), the regions labelled \(i\) are connected by doors. First, we note that for each \(i\) with \(0\leqslant i\leqslant n\) there is a unique region labelled \(i\) which is unbounded to the north.

Now, consider a knight placed in some region with label \(i\), and ask them to walk north (moving east or west by following the walls on the northern sides of regions, as needed). This knight will never get stuck: each region is convex, and so, if it is bounded to the north, it has a single northernmost vertex with a door northwards to another region with label \(i\).

Eventually it will reach a region which is unbounded to the north, which will be the unique such region with label \(i\). Hence every region with label \(i\) is connected to this particular region, and so all regions with label \(i\) are connected to each other.

As a result, there are exactly \(n+1\) connected components, and Morgana can place at most \(n+1\) knights. The only possible value of \(k\) is \(k=n+1\), no matter what shape the labyrinth is. When \(n=800\), \(k=801\).",801,combinatorics
2019c7,"There are 60 empty boxes \(B_{1}\), \ldots, \(B_{60}\) in a row on a table and an unlimited supply of pebbles. Given a positive integer \(n\), Alice and Bob play the following game.

In the first round, Alice takes \(n\) pebbles and distributes them into the 60 boxes as she wishes. Each subsequent round consists of two steps:

\begin{itemize}
    \item[(a)] Bob chooses an integer \(k\) with \(1\leqslant k\leqslant 59\) and splits the boxes into the two groups \(B_{1}\), \ldots, \(B_{k}\) and \(B_{k+1}\), \ldots, \(B_{60}\).
    
    \item[(b)] Alice picks one of these two groups, adds one pebble to each box in that group, and removes one pebble from each box in the other group.
\end{itemize}

Bob wins if, at the end of any round, some box contains no pebbles. Find the smallest \(n\) such that Alice can prevent Bob from winning.","\textbf{Solution 1 (Alice).} Alice initially distributes pebbles according to \(V_{\lceil\frac{N}{2}\rceil}\). Suppose the current configuration of pebbles dominates \(V_{i}\). If Bob makes a \(k\)-move with \(k\geq i\) then Alice picks the left group, which results in a configuration that dominates \(V_{i+1}\). Likewise, if Bob makes a \(k\)-move with \(k<i\) then Alice picks the right group, which results in a configuration that dominates \(V_{i-1}\). Since none of \(V_{1}\), \ldots, \(V_{N}\) contains an empty box, Alice can prevent Bob from ever winning.

\textbf{Solution 1 (Bob).} The key idea in this solution is the following claim.

\begin{quote}
\emph{Claim.} If there exist a positive integer \(k\) such that there are at least \(2k\) boxes that have at most \(k\) pebbles each then Bob can force a win.
\end{quote}

\begin{proof}
We ignore the other boxes. First, Bob makes a \(k\)-move (splits the \(2k\) boxes into two groups of \(k\) boxes each). Without loss of generality, Alice picks the left group. Then Bob makes a \((k+1)\)-move, \ldots, a \((2k-1)\)-move. By Observation A, we may suppose Alice always picks the left group. After Bob's \((2k-1)\)-move, the rightmost box becomes empty and Bob wins.

Now, we claim that if \(n<M\) then either there already exists an empty box, or there exist a positive integer \(k\) and \(2k\) boxes with at most \(k\) pebbles each (and thus Bob can force a win). Otherwise, assume each box contains at least \(1\) pebble, and for each \(1\leqslant k\leqslant\lfloor\frac{N}{2}\rfloor\), at least \(N-(2k-1)=N+1-2k\) boxes contain at least \(k+1\) pebbles. Summing, there are at least as many pebbles in total as in \(V_{\lceil\frac{N}{2}\rceil}\); that is, at least \(M\) pebbles, as desired.
\end{proof}

So \( n = 960 \). In general, if there are \( N > 1 \) boxes, the answer is 
\[ n = \left\lfloor \frac{N}{2} + 1 \right\rfloor \left\lceil \frac{N}{2} + 1 \right\rceil - 1. \]",960,combinatorics
2019c9,"For any two different real numbers \(x\) and \(y\), we define \(D(x,y)\) to be the unique integer \(d\) satisfying \(2^{d} \leqslant |x-y| < 2^{d+1}\). Given a set of reals \(\mathcal{F}\), and an element \(x \in \mathcal{F}\), we say that the \emph{scales} of \(x\) in \(\mathcal{F}\) are the values of \(D(x,y)\) for \(y \in \mathcal{F}\) with \(x \neq y\).

Let \(k\) be a given positive integer. Suppose that each member \(x\) of \(\mathcal{F}\) has at most \(k\) different scales in \(\mathcal{F}\) (note that these scales may depend on \(x\)). What is the maximum possible size of \(\mathcal{F}\) when \(k=13\)?","\textbf{Solution.} We first construct a set \(\mathcal{F}\) with \(2^{k}\) members, each member having at most \(k\) different scales in \(\mathcal{F}\). Take \(\mathcal{F}=\{0,1,2,\ldots,2^{k}-1\}\). The scale between any two members of \(\mathcal{F}\) is in the set \(\{0,1,\ldots,k-1\}\).

We now show that \(2^{k}\) is an upper bound on the size of \(\mathcal{F}\). For every finite set \(\mathcal{S}\) of real numbers, and every real \(x\), let \(r_{\mathcal{S}}(x)\) denote the number of different scales of \(x\) in \(\mathcal{S}\). That is, \(r_{\mathcal{S}}(x)=|\{D(x,y)\colon x\neq y\in\mathcal{S}\}|\). Thus, for every element \(x\) of the set \(\mathcal{F}\) in the problem statement, we have \(r_{\mathcal{F}}(x)\leqslant k\). The condition \(|\mathcal{F}|\leqslant 2^{k}\) is an immediate consequence of the following lemma.

\begin{lemma}
Let \(\mathcal{S}\) be a finite set of real numbers, and define
\[ w(\mathcal{S}) = \sum_{x\in\mathcal{S}} 2^{-r_{\mathcal{S}}(x)}. \]
Then \(w(\mathcal{S}) \leqslant 1\).
\end{lemma}

\begin{proof}
Induction on \(n=|\mathcal{S}|\). If \(\mathcal{S}=\{x\}\), then \(r_{\mathcal{S}}(x)=0\), so \(w(\mathcal{S})=1\).

Assume now \(n\geqslant 2\), and let \(x_{1}<\cdots<x_{n}\) list the members of \(\mathcal{S}\). Let \(d\) be the minimal scale between two distinct elements of \(\mathcal{S}\); then there exist neighbors \(x_{i}\) and \(x_{i+1}\) with \(D(x_{i},x_{i+1})=d\). Notice that for any two indices \(i\) and \(j\) with \(j-i>1\) we have \(D(x_{i},x_{j})>d\), since
\[ |x_{i}-x_{j}| = |x_{i+1}-x_{i}| + |x_{j}-x_{i+1}| \geqslant 2^{d} + 2^{d} = 2^{d+1}. \]

Now choose the minimal \(i\leqslant t\) and the maximal \(j\geqslant t+1\) such that \(D(x_{i},x_{i+1}) = D(x_{i+1},x_{i+2}) = \cdots = D(x_{j-1},x_{j}) = d\).

Let \(E\) be the set of all the \(x_{s}\) with even indices \(i\leqslant s\leqslant j\), \(O\) be the set of those with odd indices \(i\leqslant s\leqslant j\), and \(R\) be the rest of the elements (so that \(\mathcal{S}\) is the disjoint union of \(E\), \(O\) and \(R\)). Set \(\mathcal{S}_{O}=R\cup O\) and \(\mathcal{S}_{E}=R\cup E\); we have \(|\mathcal{S}_{O}|<|\mathcal{S}|\) and \(|\mathcal{S}_{E}|<|\mathcal{S}|\), so \(w(\mathcal{S}_{O}),w(\mathcal{S}_{E})\leqslant 1\) by the inductive hypothesis.

Clearly, \(r_{\mathcal{S}_{O}}(x)\leqslant r_{\mathcal{S}}(x)\) and \(r_{\mathcal{S}_{E}}(x)\leqslant r_{\mathcal{S}}(x)\) for any \(x\in R\), and thus
\begin{align*}
\sum_{x\in R}2^{-r_{\mathcal{S}}(x)} &= \frac{1}{2}\sum_{x\in R}(2^{-r_{\mathcal{S}}(x)} + 2^{-r_{\mathcal{S}}(x)}) \\
&\leqslant \frac{1}{2}\sum_{x\in R}(2^{-r_{\mathcal{S}_{O}}(x)} + 2^{-r_{\mathcal{S}_{E}}(x)}).
\end{align*}

On the other hand, for every \(x\in O\), there is no \(y\in\mathcal{S}_{O}\) such that \(D_{\mathcal{S}_{O}}(x,y)=d\) (as all candidates from \(\mathcal{S}\) were in \(E\)). Hence, we have \(r_{\mathcal{S}_{O}}(x)\leqslant r_{\mathcal{S}}(x)-1\), and thus
\[ \sum_{x\in O}2^{-r_{\mathcal{S}}(x)} \leqslant \frac{1}{2}\sum_{x\in O}2^{-r_{\mathcal{S}_{O}}(x)}. \]

Similarly, for every \(x\in E\), we have
\[ \sum_{x\in E}2^{-r_{\mathcal{S}}(x)} \leqslant \frac{1}{2}\sum_{x\in E}2^{-r_{\mathcal{S}_{E}}(x)}. \]

We can then combine these to give
\begin{align*}
w(\mathcal{S}) &= \sum_{x\in R}2^{-r_{\mathcal{S}}(x)} + \sum_{x\in O}2^{-r_{\mathcal{S}}(x)} + \sum_{x\in E}2^{-r_{\mathcal{S}}(x)} \\
&\leqslant \frac{1}{2}\sum_{x\in R}(2^{-r_{\mathcal{S}_{O}}(x)} + 2^{-r_{\mathcal{S}_{E}}(x)}) + \frac{1}{2}\sum_{x\in O}2^{-r_{\mathcal{S}_{O}}(x)} + \frac{1}{2}\sum_{x\in E}2^{-r_{\mathcal{S}_{E}}(x)} \\
&= \frac{1}{2}\left(\sum_{x\in\mathcal{S}_{O}}2^{-r_{\mathcal{S}_{O}}(x)} + \sum_{x\in\mathcal{S}_{E}}2^{-r_{\mathcal{S}_{E}}(x)}\right) \quad \text{(since $\mathcal{S}_{O}=O\cup R$ and $\mathcal{S}_{E}=E\cup R$)} \\
&= \frac{1}{2}\left(w(\mathcal{S}_{O}) + w(\mathcal{S}_{E})\right) \quad \text{(by definition of $w(\cdot)$)} \\
&\leqslant 1 \quad \text{(by the inductive hypothesis)}
\end{align*}
which completes the induction.
\end{proof}

So the maximum possible size of \(\mathcal{F}\) is \(2^{k}\). When \(k=13\), \(\mathcal{F}=8192\).",8192,combinatorics
2019g2,"Let \(ABC\) be an acute-angled triangle and let \(D\), \(E\), and \(F\) be the feet of altitudes from \(A\), \(B\), and \(C\) to sides \(BC\), \(CA\), and \(AB\), respectively. Denote by \(\omega_{B}\) and \(\omega_{C}\) the incircles of triangles \(BDF\) and \(CDE\), and let these circles be tangent to segments \(DF\) and \(DE\) at \(M\) and \(N\), respectively. Let line \(MN\) meet circles \(\omega_{B}\) and \(\omega_{C}\) again at \(P\neq M\) and \(Q\neq N\), respectively. What is the value of \(\frac{MP}{NQ}\).","\textbf{Solution.} Denote the centres of \(\omega_{B}\) and \(\omega_{C}\) by \(O_{B}\) and \(O_{C}\), let their radii be \(r_{B}\) and \(r_{C}\), and let \(BC\) be tangent to the two circles at \(T\) and \(U\), respectively.

From the cyclic quadrilaterals \(AFDC\) and \(ABDE\) we have
\[
\angle MDO_{B} = \frac{1}{2}\angle FDB = \frac{1}{2}\angle BAC = \frac{1}{2}\angle CDE = \angle O_{C}DN,
\]
so the right-angled triangles \(DMO_{B}\) and \(DNO_{C}\) are similar. The ratio of similarity between the two triangles is
\[
\frac{DN}{DM} = \frac{O_{C}N}{O_{B}M} = \frac{r_{C}}{r_{B}}.
\]

Let \(\varphi = \angle DMN\) and \(\psi = \angle MND\). The lines \(FM\) and \(EN\) are tangent to \(\omega_{B}\) and \(\omega_{C}\), respectively, so
\[
\angle MTP = \angle FMP = \angle DMN = \varphi \quad \text{and} \quad \angle QUN = \angle QNE = \angle MND = \psi.
\]

(It is possible that \(P\) or \(Q\) coincides with \(T\) or \(U\), or lie inside triangles \(DMT\) or \(DUN\), respectively. To reduce case-sensitivity, we may use directed angles or simply ignore angles \(MTP\) and \(QUN\).)

In the circles \(\omega_{B}\) and \(\omega_{C}\) the lengths of chords \(MP\) and \(NQ\) are
\[
MP = 2r_{B} \cdot \sin\angle MTP = 2r_{B} \cdot \sin\varphi \quad \text{and} \quad NQ = 2r_{C} \cdot \sin\angle QUN = 2r_{C} \cdot \sin\psi.
\]

By applying the sine rule to triangle \(DNM\) we get
\[
\frac{DN}{DM} = \frac{\sin\angle DMN}{\sin\angle MND} = \frac{\sin\varphi}{\sin\psi}.
\]

Finally, putting the above observations together, we get
\[
\frac{MP}{NQ} = \frac{2r_{B}\sin\varphi}{2r_{C}\sin\psi} = \frac{r_{B}}{r_{C}} \cdot \frac{\sin\varphi}{\sin\psi} = \frac{DM}{DN} \cdot \frac{\sin\varphi}{\sin\psi} = \frac{\sin\psi}{\sin\varphi} \cdot \frac{\sin\varphi}{\sin\psi} = 1,
\]
so \(MP = NQ\) as required.",1,geometry
2019g6,"Let \(I\) be the incentre of acute-angled triangle \(ABC\). Let the incircle meet \(BC\), \(CA\), and \(AB\) at \(D\), \(E\), and \(F\), respectively. Let line \(EF\) intersect the circumcircle of the triangle at \(P\) and \(Q\), such that \(F\) lies between \(E\) and \(P\). What is the value of \( \frac{\angle DPA + \angle AQD}{ \angle QIP} \).","Let \(N\) and \(M\) be the midpoints of the arcs \(\overline{BC}\) of the circumcircle, containing and opposite vertex \(A\), respectively. By \(\angle FAE = \angle BAC = \angle BNC\), the right-angled kites \(AFIE\) and \(NBMC\) are similar. Consider the spiral similarity \(\varphi\) (dilation in case of \(AB = AC\)) that moves \(AFIE\) to \(NBMC\). The directed angle in which \(\varphi\) changes directions is \(\angle(AF, NB)\), same as \(\angle(AP, NP)\) and \(\angle(AQ, NQ)\); so lines \(AP\) and \(AQ\) are mapped to lines \(NP\) and \(NQ\), respectively. Line \(EF\) is mapped to \(BC\); we can see that the intersection points \(P = EF \cap AP\) and \(Q = EF \cap AQ\) are mapped to points \(BC \cap NP\) and \(BC \cap NQ\), respectively. Denote these points by \(P^{\prime}\) and \(Q^{\prime}\), respectively.

Let \(L\) be the midpoint of \(BC\). We claim that points \(P, Q, D, L\) are concyclic (if \(D = L\) then line \(BC\) is tangent to circle \(PQD\)). Let \(PQ\) and \(BC\) meet at \(Z\). By applying Menelaus' theorem to triangle \(ABC\) and line \(EFZ\), we have

\[
\frac{BD}{DC} = \frac{BF}{FA} \cdot \frac{AE}{EC} = -\frac{BZ}{ZC},
\]

so the pairs \(B, C\) and \(D, Z\) are harmonic. It is well-known that this implies \(ZB \cdot ZC = ZD \cdot ZL\). (The inversion with pole \(Z\) that swaps \(B\) and \(C\) sends \(Z\) to infinity and \(D\) to the midpoint of \(BC\), because the cross-ratio is preserved.) Hence, \(ZD \cdot ZL = ZB \cdot ZC = ZP \cdot ZQ\) by the power of \(Z\) with respect to the circumcircle; this proves our claim.

By \(\angle MPP^{\prime} = \angle MQQ^{\prime} = \angle MLP^{\prime} = \angle MLQ^{\prime} = 90^{\circ}\), the quadrilaterals \(MLPP^{\prime}\) and \(MLQQ^{\prime}\) are cyclic. Then the problem statement follows by

\[
\angle DPA + \angle AQD = 360^{\circ} - \angle PAQ - \angle QDP = 360^{\circ} - \angle PNQ - \angle QLP
\]
\[
= \angle LPN + \angle NQL = \angle P^{\prime}ML + \angle LMQ^{\prime} = \angle P^{\prime}MQ^{\prime} = \angle PIQ.
\]
So the value of \( \frac{\angle DPA + \angle AQD}{ \angle QIP} \) is \(1\).",1,geometry
2019n1,"Find all pairs \((m,n)\) of positive integers satisfying the equation 
\[(2^{n} - 1)(2^{n} - 2)(2^{n} - 4) \cdots (2^{n} - 2^{n-1}) = m!\]
Calculate the sum of the quantity \[ (m+n) \] over every such pair.
","We will get an upper bound on \(n\) from the speed at which \(v_{2}(L_{n})\) grows.

From
\[
L_{n} = (2^{n} - 1)(2^{n} - 2)\cdots(2^{n} - 2^{n-1}) = 2^{1+2+\cdots+(n-1)}(2^{n} - 1)(2^{n-1} - 1)\cdots(2^{1} - 1)
\]
we read
\[
v_{2}(L_{n}) = 1 + 2 + \cdots + (n-1) = \frac{n(n-1)}{2}.
\]

On the other hand, \(v_{2}(m!)\) is expressed by the Legendre formula as
\[
v_{2}(m!) = \sum_{i=1}^{\infty} \left\lfloor \frac{m}{2^{i}} \right\rfloor.
\]

As usual, by omitting the floor functions,
\[
v_{2}(m!) < \sum_{i=1}^{\infty} \frac{m}{2^{i}} = m.
\]
Thus, \(L_{n} = m!\) implies the inequality
\[
\frac{n(n-1)}{2} < m. \quad (2)
\]

In order to obtain an opposite estimate, observe that
\[
L_{n} = (2^{n} - 1)(2^{n} - 2)\cdots(2^{n} - 2^{n-1}) < (2^{n})^{n} = 2^{n^{2}}.
\]

We claim that
\[
2^{n^{2}} < \left(\frac{n(n-1)}{2}\right)! \quad \text{for } n \geqslant 6. \quad (3)
\]

For \(n = 6\) the estimate (3) is true because \(2^{6^{2}} < 6.9 \cdot 10^{10}\) and \(\left(\frac{n(n-1)}{2}\right)! = 15! = 1.3 \cdot 10^{12}\).

For \(n \geqslant 7\) we prove (3) by the following inequalities:
\[
\left(\frac{n(n-1)}{2}\right)! = 15! \cdot 16 \cdot 17 \cdots \frac{n(n-1)}{2} > 2^{36} \cdot 16^{\frac{n(n-1)}{2} - 15}
\]
\[
= 2^{2n(n-1) - 24} = 2^{n^{2}} \cdot 2^{n(n-2) - 24} > 2^{n^{2}}.
\]

Putting together (2) and (3), for \(n \geqslant 6\) we get a contradiction, since
\[
L_{n} < 2^{n^{2}} < \left(\frac{n(n-1)}{2}\right)! < m! = L_{n}.
\]

Hence \(n \geqslant 6\) is not possible.

Checking manually the cases \(n \leqslant 5\) we find
\[
L_{1} = 1 = 1!, \quad L_{2} = 6 = 3!, \quad 5! < L_{3} = 168 < 6!,
\]
\[
7! < L_{4} = 20\,160 < 8! \quad \text{and} \quad 10! < L_{5} = 9\,999\,360 < 11!.
\]

So, there are two solutions:
\[
(m,n) \in \{(1,1), (3,2)\}.
\]

So the sum is \(7\).",7,number theory
2019n2,"Find all triples \((a,b,c)\) of positive integers such that \(a^{3} + b^{3} + c^{3} = (abc)^{2}\) when \( a \geq b \geq c \). Calculate the sum of the quantity \[ (a+b+c) \] over every such pair.
","Find all triples \((a,b,c)\) of positive integers such that \(a^{3} + b^{3} + c^{3} = (abc)^{2}\).

**Solution 1.** We will start by proving that \(c=1\). Note that
\[
3a^{3} \geqslant a^{3} + b^{3} + c^{3} > a^{3}.
\]
So \(3a^{3} \geqslant (abc)^{2} > a^{3}\) and hence \(3a \geqslant b^{2}c^{2} > a\). Now \(b^{3} + c^{3} = a^{2}(b^{2}c^{2} - a) \geqslant a^{2}\), and so
\[
18b^{3} \geqslant 9(b^{3} + c^{3}) \geqslant 9a^{2} \geqslant b^{4}c^{4} \geqslant b^{3}c^{5},
\]
so \(18 \geqslant c^{5}\) which yields \(c=1\).

Now, note that we must have \(a > b\), as otherwise we would have \(2b^{3} + 1 = b^{4}\) which has no positive integer solutions. So
\[
a^{3} - b^{3} \geqslant (b+1)^{3} - b^{3} > 1
\]
and
\[
2a^{3} > 1 + a^{3} + b^{3} > a^{3},
\]
which implies \(2a^{3} > a^{2}b^{2} > a^{3}\) and so \(2a > b^{2} > a\). Therefore
\[
4(1 + b^{3}) = 4a^{2}(b^{2} - a) \geqslant 4a^{2} > b^{4},
\]
so \(4 > b^{3}(b - 4)\); that is, \(b \leqslant 4\).

Now, for each possible value of \(b\) with \(2 \leqslant b \leqslant 4\) we obtain a cubic equation for \(a\) with constant coefficients. These are as follows:
\[
b=2: a^{3} - 4a^{2} + 9 = 0
\]
\[
b=3: a^{3} - 9a^{2} + 28 = 0
\]
\[
b=4: a^{3} - 16a^{2} + 65 = 0.
\]

The only case with an integer solution for \(a\) with \(b \leqslant a\) is \(b=2\), leading to \((a,b,c)=(3,2,1)\). So the sum is \(6\)/",6,number theory
2019n4,"Let $\mathbb{Z}_{>0}$ be the set of positive integers. A positive integer constant $C$ is given. Find all functions $f:\mathbb{Z}_{>0}\to\mathbb{Z}_{>0}$ such that, for all positive integers $a$ and $b$ satisfying $a+b > C$,

\[
a + f(b) \mid a^{2} + b f(a). \quad (\ast)
\]

If \(f(1)=11\), what is the value of \(f(90)\).","First, we substitute \(b=1\) in (\(\ast\)) and rearrange to find that
\[
\frac{f(a) + f(1)^{2}}{a + f(1)} = f(1) - a + \frac{a^{2} + f(a)}{a + f(1)}
\]
is a positive integer for sufficiently large \(a\). Since \(f(a) \leqslant a f(1)\), for all sufficiently large \(a\), it follows that \(\frac{f(a) + f(1)^{2}}{a + f(1)} \leqslant f(1)\) also and hence there is a positive integer \(k\) such that \(\frac{f(a) + f(1)^{2}}{a + f(1)} = k\) for infinitely many values of \(a\). In other words,
\[
f(a) = k a + f(1) \cdot (k - f(1))
\]
for infinitely many \(a\).

Fixing an arbitrary choice of \(a\) in (\(\ast\)), we have that
\[
\frac{a^{2} + b f(a)}{a + k b + f(1) \cdot (k - f(1))}
\]
is an integer for infinitely many \(b\) (the same \(b\) as above, maybe with finitely many exceptions). On the other hand, for \(b\) taken sufficiently large, this quantity becomes arbitrarily close to \(\frac{f(a)}{k}\); this is only possible if \(\frac{f(a)}{k}\) is an integer and
\[
\frac{a^{2} + b f(a)}{a + k b + f(1) \cdot (k - f(1))} = \frac{f(a)}{k}
\]
for infinitely many \(b\). This rearranges to
\[
\frac{f(a)}{k} \cdot \big{(}a + f(1) \cdot (k - f(1))\big{)} = a^{2}. \quad (*)
\]

Hence \(a^{2}\) is divisible by \(a + f(1) \cdot (k - f(1))\), and hence so is \(f(1)^{2}(k - f(1))^{2}\). The only way this can occur for all \(a\) is if \(k = f(1)\), in which case (*) provides that \(f(a) = k a\) for all \(a\), as desired. If \(f(1)=11\),  the value of \(f(90)\) is \(990\).",990,number theory
2018a1,"Let $\mathbb{Q}_{>0}$ denote the set of all positive rational numbers. Determine all functions $f: \mathbb{Q}_{>0} \to \mathbb{Q}_{>0}$ satisfying
\[
f\left(x^2 f(y)^2\right) = f(x)^2 f(y) \quad (*)
\]
for all $x, y \in \mathbb{Q}_{>0}$. Give the value of \(f(2018)\).","Let $\mathbb{Q}_{>0}$ denote the set of all positive rational numbers. Determine all functions $f: \mathbb{Q}_{>0} \to \mathbb{Q}_{>0}$ satisfying
\[
f\left(x^2 f(y)^2\right) = f(x)^2 f(y) \quad (*)
\]
for all $x, y \in \mathbb{Q}_{>0}$.

\textbf{Solution.} Take any $a, b \in \mathbb{Q}_{>0}$. By substituting $x = f(a)$, $y = b$ and $x = f(b)$, $y = a$ into (*) we get
\[
f(f(a))^2 f(b) = f(f(a)^2 f(b)^2) = f(f(b))^2 f(a),
\]
which yields
\[
\frac{f(f(a))^2}{f(a)} = \frac{f(f(b))^2}{f(b)}
\]
for all $a, b \in \mathbb{Q}_{>0}$.

In other words, this shows that there exists a constant $C \in \mathbb{Q}_{>0}$ such that $f(f(a))^2 = C f(a)$, or
\[
\left(\frac{f(f(a))}{C}\right)^2 = \frac{f(a)}{C}
\]
for all $a \in \mathbb{Q}_{>0}$. \quad (1)

Denote by $f^n(x) = \underbrace{f(f(\ldots(f(x))\ldots))}_{n \text{ times}}$ the $n^{\text{th}}$ iteration of $f$. Equality (1) yields
\[
\frac{f(a)}{C} = \left(\frac{f^2(a)}{C}\right)^2 = \left(\frac{f^3(a)}{C}\right)^4 = \cdots = \left(\frac{f^{n+1}(a)}{C}\right)^{2^n}
\]
for all positive integers $n$. 

This implies that $f(a)/C$ is the $2^n$-th power of a rational number for all positive integers $n$. This is only possible if $f(a)/C = 1$, since otherwise the exponent of some prime in the prime decomposition of $f(a)/C$ would not be divisible by arbitrarily large powers of 2. Therefore, $f(a) = C$ for all $a \in \mathbb{Q}_{>0}$.

Finally, substituting the constant function $f \equiv C$ into (*) gives $C = C^3$, which implies $C = 1$. Thus, the only solution is the constant function:
\[
\boxed{f(x) \equiv 1}
\]",1,algebra
2018a2,"Find all positive integers \( n \geq 3 \) for which there exist real numbers \( a_1, a_2, \ldots, a_n \),
\( a_{n+1} = a_1 \), \( a_{n+2} = a_2 \) such that
\[
a_i a_{i+1} + 1 = a_{i+2}
\]
for all \( i = 1, 2, \ldots, n \). What is the greatest \(n\) that less than \(1000\)","For the sake of convenience, extend the sequence \( a_1, \ldots, a_{n+2} \) to an infinite periodic sequence with period \( n \). (\( n \) is not necessarily the shortest period.)

If \( n \) is divisible by 3, then \( (a_1, a_2, \ldots) = (-1, -1, 2, -1, -1, 2, \ldots) \) is an obvious solution.

We will show that in every periodic sequence satisfying the recurrence, each positive term is followed by two negative values, and after them the next number is positive again. From this, it follows that \( n \) is divisible by 3.

If the sequence contains two consecutive positive numbers \( a_i, a_{i+1} \), then \( a_{i+2} = a_i a_{i+1} + 1 > 1 \), so the next value is positive as well; by induction, all numbers are positive and greater than 1. But then \( a_{i+2} = a_i a_{i+1} + 1 \geq 1 \cdot a_{i+1} + 1 > a_{i+1} \) for every index \( i \), which is impossible: our sequence is periodic, so it cannot increase everywhere.

If the number 0 occurs in the sequence, \( a_i = 0 \) for some index \( i \), then it follows that \( a_{i+1} = a_{i-1} a_i + 1 \) and \( a_{i+2} = a_i a_{i+1} + 1 \) are two consecutive positive elements in the sequences and we get the same contradiction again.

Notice that after any two consecutive negative numbers the next one must be positive: if \( a_i < 0 \) and \( a_{i+1} < 0 \), then \( a_{i+2} = a_i a_{i+1} + 1 > 1 > 0 \). Hence, the positive and negative numbers follow each other in such a way that each positive term is followed by one or two negative values and then comes the next positive term.

Consider the case when the positive and negative values alternate. So, if \( a_i \) is a negative value then \( a_{i+1} \) is positive, \( a_{i+2} \) is negative and \( a_{i+3} \) is positive again.

Notice that \( a_i a_{i+1} + 1 = a_{i+2} < 0 < a_{i+3} = a_{i+1} a_{i+2} + 1 \); by \( a_{i+1} > 0 \) we conclude \( a_i < a_{i+2} \). Hence, the negative values form an infinite increasing subsequence, \( a_i < a_{i+2} < a_{i+4} < \ldots \), which is not possible, because the sequence is periodic.

The only case left is when there are consecutive negative numbers in the sequence. Suppose that \( a_i \) and \( a_{i+1} \) are negative; then \( a_{i+2} = a_i a_{i+1} + 1 > 1 \). The number \( a_{i+3} \) must be negative. We show that \( a_{i+4} \) also must be negative.

Notice that \( a_{i+3} \) is negative and \( a_{i+4} = a_{i+2} a_{i+3} + 1 < 1 < a_i a_{i+1} + 1 = a_{i+2} \), so
\[
a_{i+5} - a_{i+4} = (a_{i+3} a_{i+4} + 1) - (a_{i+2} a_{i+3} + 1) = a_{i+3} (a_{i+4} - a_{i+2}) > 0,
\]
therefore \( a_{i+5} > a_{i+4} \). Since at most one of \( a_{i+4} \) and \( a_{i+5} \) can be positive, that means that \( a_{i+4} \) must be negative.

Now \( a_{i+3} \) and \( a_{i+4} \) are negative and \( a_{i+5} \) is positive; so after two negative and a positive terms, the next three terms repeat the same pattern. That completes the solution.

So the only solutions occur when  \(n\)  is divisible by \(3\). So the greatest \(n\) that less than \(1000\) is \(999\).",999,algebra
2018a6,"Let \( m, n \geq 2 \) be integers. Let \( f(x_1, \ldots, x_n) \) be a polynomial with real coefficients such that
\[
f(x_1, \ldots, x_n) = \left\lfloor \frac{x_1 + \cdots + x_n}{m} \right\rfloor \quad \text{for every } x_1, \ldots, x_n \in \{0, 1, \ldots, m - 1\}.
\]
What is the least total degree of \( f \) when \(n=2018\) and  \(m=2019\)?","Let \( m, n \geq 2 \) be integers. Let \( f(x_1, \ldots, x_n) \) be a polynomial with real coefficients such that
\[
f(x_1, \ldots, x_n) = \left\lfloor \frac{x_1 + \cdots + x_n}{m} \right\rfloor \quad \text{for every } x_1, \ldots, x_n \in \{0, 1, \ldots, m - 1\}.
\]
Prove that the total degree of \( f \) is at least \( n \).

\textbf{Solution.} We transform the problem to a single variable question by the following

\textbf{Lemma.} Let \(a_1, \ldots, a_n\) be nonnegative integers and let \(G(x)\) be a nonzero polynomial with \(\deg G \leq a_1 + \cdots + a_n\). Suppose that some polynomial \(F(x_1, \ldots, x_n)\) satisfies
\[
F(x_1, \ldots, x_n) = G(x_1 + \cdots + x_n) \quad \text{for } (x_1, \ldots, x_n) \in \{0, 1, \ldots, a_1\} \times \cdots \times \{0, 1, \ldots, a_n\}.
\]
Then \(F\) cannot be the zero polynomial, and \(\deg F \geq \deg G\).

For proving the lemma, we will use forward differences of polynomials. If \(p(x)\) is a polynomial with a single variable, then define \((\Delta p)(x) = p(x + 1) - p(x)\). It is well-known that if \(p\) is a nonconstant polynomial then \(\deg \Delta p = \deg p - 1\).

If \(p(x_1, \ldots, x_n)\) is a polynomial with \(n\) variables and \(1 \leq k \leq n\) then let
\[
(\Delta_k p)(x_1, \ldots, x_n) = p(x_1, \ldots, x_{k-1}, x_k + 1, x_{k+1}, \ldots, x_n) - p(x_1, \ldots, x_n).
\]

It is also well-known that either \(\Delta_k p\) is the zero polynomial or \(\deg (\Delta_k p) \leq \deg p - 1\).

\textbf{Proof of the lemma.} We apply induction on the degree of \(G\). If \(G\) is a constant polynomial then we have \(F(0, \ldots, 0) = G(0) \neq 0\), so \(F\) cannot be the zero polynomial.

Suppose that \(\deg G \geq 1\) and the lemma holds true for lower degrees. Since \(a_1 + \cdots + a_n \geq \deg G > 0\), at least one of \(a_1, \ldots, a_n\) is positive; without loss of generality suppose \(a_1 \geq 1\).

Consider the polynomials \(F_1 = \Delta_1 F\) and \(G_1 = \Delta G\). On the grid \(\{0, \ldots, a_1 - 1\} \times \{0, \ldots, a_2\} \times \cdots \times \{0, \ldots, a_n\}\) we have
\[
F_1(x_1, \ldots, x_n) = G(x_1 + \cdots + x_n + 1) - G(x_1 + \cdots + x_n) = G_1(x_1 + \cdots + x_n).
\]

Since \(G\) is nonconstant, we have \(\deg G_1 = \deg G - 1 \leq (a_1 - 1) + a_2 + \cdots + a_n\). Therefore we can apply the induction hypothesis to \(F_1\) and \(G_1\) and conclude that \(F_1\) is not the zero polynomial and \(\deg F_1 \geq \deg G_1\). Hence, \(\deg F \geq \deg F_1 + 1 \geq \deg G_1 + 1 = \deg G\). That finishes the proof. 

To prove the problem statement, take the unique polynomial \(g(x)\) so that \(g(x) = \lfloor \frac{x}{m} \rfloor\) for \(x \in \{0, 1, \ldots, n(m - 1)\}\) and \(\deg g \leq n(m - 1)\). Notice that precisely \(n(m - 1) + 1\) values of \(g\) are prescribed, so \(g(x)\) indeed exists and is unique. Notice further that the constraints \(g(0) = g(1) = 0\) and \(g(m) = 1\) together enforce \(\deg g \geq 2\).

By applying the lemma to \(a_1 = \cdots = a_n = m - 1\) and the polynomials \(f\) and \(g\), we achieve \(\deg f \geq \deg g\). Hence we just need a suitable lower bound on \(\deg g\).

Consider the polynomial \(h(x) = g(x + m) - g(x) - 1\). The degree of \(g(x + m) - g(x)\) is \(\deg g - 1 \geq 1\), so \(\deg h = \deg g - 1 \geq 1\), and therefore \(h\) cannot be the zero polynomial. On the other hand, \(h\) vanishes at the points \(0, 1, \ldots, n(m - 1) - m\), so \(h\) has at least \((n - 1)(m - 1)\) roots. Hence,
\[
\deg f \geq \deg g = \deg h + 1 \geq (n - 1)(m - 1) + 1 \geq n.
\]

So the least total degree of \( f \) is \(n=2018\).",2018,algebra
2018a7,"Find the maximal value of
\[
S = \sqrt[3]{\frac{a}{b+7}} + \sqrt[3]{\frac{b}{c+7}} + \sqrt[3]{\frac{c}{d+7}} + \sqrt[3]{\frac{d}{a+7}},
\]
where \( a, b, c, d \) are nonnegative real numbers which satisfy \( a+b+c+d=100 \). You should only give the integer part of the answer. (e.g. if the answer is 3.1, your answer should be 3)","Assume that \( x, y, z, t \) is a permutation of the variables, with \( x \leq y \leq z \leq t \). Then, by the rearrangement inequality,

\[
S \leq \left( \sqrt[3]{\frac{x}{t+7}} + \sqrt[3]{\frac{t}{x+7}} \right) + \left( \sqrt[3]{\frac{y}{z+7}} + \sqrt[3]{\frac{z}{y+7}} \right).
\]

\textit{Claim.} The first bracket above does not exceed \( \sqrt[3]{\frac{x + t + 14}{7}} \).

\textit{Proof.} Since

\[
X^3 + Y^3 + 3XYZ - Z^3 = \frac{1}{2}(X + Y - Z)\left((X - Y)^2 + (X + Z)^2 + (Y + Z)^2\right),
\]

the inequality \( X + Y \leq Z \) is equivalent (when \( X, Y, Z \geq 0 \)) to \( X^3 + Y^3 + 3XYZ \leq Z^3 \).

Therefore, the claim is equivalent to

\[
\frac{x}{t+7} + \frac{t}{x+7} + 3\sqrt[3]{\frac{xt(x + t + 14)}{7(x + 7)(t + 7)}} \leq \frac{x + t + 14}{7}.
\]

Notice that

\[
3\sqrt[3]{\frac{xt(x + t + 14)}{7(x + 7)(t + 7)}} = 3\sqrt[3]{\frac{t(x + 7)}{7(t + 7)} \cdot \frac{x(t + 7)}{7(x + 7)} \cdot \frac{7(x + t + 14)}{(t + 7)(x + 7)}}
\]

\[
\leq \frac{t(x + 7)}{7(t + 7)} + \frac{x(t + 7)}{7(x + 7)} + \frac{7(x + t + 14)}{(t + 7)(x + 7)}
\]

by the AM–GM inequality, so it suffices to prove

\[
\frac{x}{t+7} + \frac{t}{x+7} + \frac{t(x + 7)}{7(t + 7)} + \frac{x(t + 7)}{7(x + 7)} + \frac{7(x + t + 14)}{(t + 7)(x + 7)} \leq \frac{x + t + 14}{7}.
\]

A straightforward check verifies that the last inequality is in fact an equality. \(\square\)

The claim leads now to

\[
S \leq \sqrt[3]{\frac{x + t + 14}{7}} + \sqrt[3]{\frac{y + z + 14}{7}} \leq 2\sqrt[3]{\frac{x + y + z + t + 28}{14}} = \frac{8}{\sqrt[3]{7}},
\]

the last inequality being due to the AM–CM inequality (or to the fact that \( \sqrt[3]{x} \) is concave on \( [0, \infty) \)).

So the answer is \(4\).",4,algebra
2018c1,"Queenie and Horst play a game on a \( 20 \times 20 \) chessboard. In the beginning the board is empty. In every turn, Horst places a black knight on an empty square in such a way that his new knight does not attack any previous knights. Then Queenie places a white queen on an empty square. The game gets finished when somebody cannot move.

Find the maximal positive \( K \) such that, regardless of the strategy of Queenie, Horst can put at least \( K \) knights on the board.
","We show two strategies, one for Horst to place at least 100 knights, and another strategy for Queenie that prevents Horst from putting more than 100 knights on the board.

\textbf{A strategy for Horst:} \textit{Put knights only on black squares, until all black squares get occupied.}

Colour the squares of the board black and white in the usual way, such that the white and black squares alternate, and let Horst put his knights on black squares as long as it is possible. Two knights on squares of the same colour never attack each other. The number of black squares is \( 20^2 / 2 = 200 \). The two players occupy the squares in turn, so Horst will surely find empty black squares in his first 100 steps.

\textbf{A strategy for Queenie:} \textit{Group the squares into cycles of length 4, and after each step of Horst, occupy the opposite square in the same cycle.}

Consider the squares of the board as vertices of a graph; let two squares be connected if two knights on those squares would attack each other. Notice that in a \( 4 \times 4 \) board the squares can be grouped into 4 cycles of length 4. Divide the board into parts of size \( 4 \times 4 \), and perform the same grouping in every part; this way we arrange the 400 squares of the board into 100 cycles.

The strategy of Queenie can be as follows: Whenever Horst puts a new knight to a certain square \( A \), which is part of some cycle \( A - B - C - D - A \), let Queenie put her queen on the opposite square \( C \) in that cycle.

From this point, Horst cannot put any knight on \( A \) or \( C \) because those squares are already occupied, neither on \( B \) or \( D \) because those squares are attacked by the knight standing on \( A \). Hence, Horst can put at most one knight on each cycle, that is at most 100 knights in total.
So \( K = 20^2 / 4 = 100 \). In case of a \( 4N \times 4M \) board, the answer is \( K = 4NM \).",100,combinatorics
2018c5,"Let \( k \) be a positive integer. The organising committee of a tennis tournament is to schedule the matches for \( 2k \) players so that every two players play once, each day exactly one match is played, and each player arrives to the tournament site the day of his first match, and departs the day of his last match. For every day a player is present on the tournament, the committee has to pay 1 coin to the hotel. The organisers want to design the schedule so as to minimise the total cost of all players' stays. Determine this minimum cost when \(k=20\).
","Enumerate the days of the tournament \( 1, 2, \dots, (2k) \). Let \( b_1 < b_2 < \dots < b_{2k} \) be the days the players arrive to the tournament, arranged in nondecreasing order; similarly, let \( e_1 > \dots > e_{2k} \) be the days they depart arranged in nonincreasing order (it may happen that a player arrives on day \( b \) and departs on day \( e_j \), where \( i \neq j \)). If a player arrives on day \( b \) and departs on day \( e \), then his stay cost is \( e - b + 1 \). Therefore, the total stay cost is

\[
\sum_{i=1}^{2k} e_i - \sum_{i=1}^{2k} b_i + n = \sum_{i=1}^{2k} (e_i - b_i + 1).
\]

Bounding the total cost from below. To this end, estimate \( e_{i+1} - b_{i+1} + 1 \). Before day \( b_{i+1} \), only \( \binom{i}{2} \) matches could be played. Therefore, \( b_{i+1} \leq \binom{i}{2} + 1 \). Similarly, at most \( \binom{i}{2} \) matches could be played after day \( e_{i+1} \), so \( e_i \geq \binom{2k}{2} - \binom{i}{2} \). Thus,

\[
e_{i+1} - b_{i+1} + 1 \geq \left( \binom{2k}{2} \right) - 2 \left( \binom{i}{2} \right).
\]

This lower bound can be improved for \( i \leq k \): List the \( i \) players who arrived first, and the \( i \) players who departed last; at least \( 2i - 2k \) players appear in both lists. The matches between these players were counted twice, though the players in each pair have only played once. Therefore, if \( i > k \), then

\[
e_{i+1} - b_{i+1} + 1 \geq \left( \binom{2k}{2} \right) - 2 \left( \binom{i}{2} \right) + \left( \binom{2i - 2k}{2} \right) = (2k - i)^2.
\]

An optimal tournament. We now describe a schedule in which the lower bounds above are all achieved simultaneously. Split players into two groups \( X \) and \( Y \), each of cardinality \( k \). Next, partition the schedule into three parts. During the first part, the players from \( X \) arrive one by one, and each newly arrived player immediately plays with everyone already present. During the third part (after all players from \( X \) have already departed) the players from \( Y \) depart one by one, each playing with everyone still present just before departing.

In the middle part, everyone from \( X \) should play with everyone from \( Y \). Let \( S_1, S_2, \dots, S_k \) be the players in \( X \), and let \( T_1, T_2, \dots, T_k \) be the players in \( Y \). Let \( T_1, T_2, \dots, T_k \) arrive in this order; after \( T_j \) arrives, he immediately plays with all the \( S_i, i > j \). Afterwards, players \( S_k, S_{k-1}, \dots \) depart in this order; each \( S_i \) plays with all the \( T_j, j < i \), just before his departure, and \( S_k \) departs the day \( T_k \) arrives. For \( 0 \leq s \leq k - 1 \), the number of matches played between \( T_k \)'s arrival and \( S_k \)-s departure is

\[
\sum_{j=k-s}^{k-1} (k-j+1) = \frac{1}{2} s(s+1) + 1 \quad \text{and} \quad \sum_{j=k-1}^{k-s-1} (k-j+1) = (s+3)^2.
\]

Thus, if \( i \leq k \), then the number of matches that have been played between \( T_i \)-k+1’s arrival, which is \( b_i \), and \( S_i \)-k+1’s departure, which is \( e_i \), is \( i = (2k-i)^2 \), that is, \( e_{i+1} - b_{i+1} = (2k-i)^2 \).

Consequently, all lower bounds are achieved simultaneously, and the schedule is indeed optimal.

\textbf{Evaluation.} Finally, evaluate the total cost for the optimal schedule:

\[
\sum = \sum_{i=0}^{k} \left(k(2k-1) - i(i-1)\right) + \sum_{i=k+1}^{2k-1} \left( (2k-i)^2 \right) = k(k + 1)(2k - 1) - k^2 + \frac{1}{2} k(k^2 - 1).
\]
So this minimum cost when \(k=20\) is \(24285\)",24285,combinatorics
2018g3,"A circle \( \omega \) of radius 1 is given. A collection \( T \) of triangles is called \textit{good}, if the following conditions hold:

\begin{enumerate}
    \item[(i)] Each triangle from \( T \) is inscribed in \( \omega \);
    \item[(ii)] No two triangles from \( T \) have a common interior point.
\end{enumerate}

Determine all positive real numbers \( t \) such that, for each positive integer \( n \), there exists a good collection of \( n \) triangles, each of perimeter greater than \( t \). Give the greatest value of \(t\).
","First, we show how to construct a good collection of \( n \) triangles, each of perimeter greater than 4. This will show that all \( t \leq 4 \) satisfy the required conditions.

Construct inductively an \( (n + 2) \)-gon \( BA_1A_2 \dots A_n C \) inscribed in \( \omega \) such that \( BC \) is a diameter, and \( BA_1A_2, BA_2A_3, \dots, BA_{n-1}A_n, BA_nC \) is a good collection of \( n \) triangles. For \( n = 1 \), take any triangle \( BA_1C \) inscribed in \( \omega \) such that \( BC \) is a diameter; its perimeter is greater than \( 2BC = 4 \). To perform the inductive step, assume that the \( (n + 2) \)-gon \( BA_1A_2 \dots A_n C \) is already constructed. Since \( A_nB + A_nC + BC > 4 \), one can choose a point \( A_{n+1} \) on the small arc \( C A_n \), close enough to \( C \), so that \( A_nB + A_nA_{n+1} + BA_{n+1} \) is still greater than 4. Thus each of these new triangles \( BA_nA_{n+1} \) and \( BA_{n+1}C \) has perimeter greater than 4, which completes the induction step.

We proceed by showing that no \( t > 4 \) satisfies the conditions of the problem. To this end, we assume that there exists a good collection \( T \) of \( n \) triangles, each of perimeter greater than \( t \), and then bound \( n \) from above.

Take \( \epsilon > 0 \) such that \( t = 4 + 2\epsilon \).

\textbf{Claim.} There exists a positive constant \( \sigma = \sigma(\epsilon) \) such that any triangle \( \Delta \) with perimeter \( 2s \geq 4 + 2\epsilon \), inscribed in \( \omega \), has area \( S(\Delta) \) at least \( \sigma \).

\textit{Proof.} Let \( a, b, c \) be the side lengths of \( \Delta \). Since \( \Delta \) is inscribed in \( \omega \), each side has length at most 2. Therefore, \( s - a \geq (2 + \epsilon) - 2 = \epsilon \). Similarly, \( s - b \geq \epsilon \) and \( s - c \geq \epsilon \). By Heron’s formula, \( S(\Delta) = \sqrt{s(s-a)(s-b)(s-c)} \geq \sqrt{(2 + \epsilon) \epsilon^3} \). Thus we can set \( \sigma(\epsilon) = \sqrt{(2 + \epsilon) \epsilon^3} \). \( \square \)

Now we see that the total area \( S \) of all triangles from \( T \) is at least \( n\sigma(\epsilon) \). On the other hand, \( S \) does not exceed the area of the disk bounded by \( \omega \). Thus \( n\sigma(\epsilon) \leq \pi \), which means that \( n \) is bounded from above.

So \( t \in (0, 4] \). The greatest value of \(t\) is \(4\).
",4,geometry
2018g6,A convex quadrilateral \( ABCD \) satisfies \( AB \cdot CD = BC \cdot DA \). A point \( X \) is chosen inside the quadrilateral so that \( \angle XAB = \angle XCD \) and \( \angle XBC = \angle XDA \). Calculate the value of \( \angle AXB + \angle CXD \) (in degrees).,"Let \( B' \) be the reflection of \( B \) in the internal angle bisector of \( \angle AXC \), so that \( \angle AXB' = \angle CXB \) and \( \angle CXB' = \angle AXB \). If \( X, D, \) and \( B' \) are collinear, then we are done. Now assume the contrary.

On the ray \( X B' \) take a point \( E \) such that \( XE \cdot XB = XA \cdot XC \), so that \( \triangle AXE \sim \triangle BXE \) and \( \triangle C XE \sim \triangle BXA \). We have \( \angle XCE + \angle XCD = \angle XBA + \angle XAB < 180^\circ \) and \( \angle XAE + \angle XAD = \angle XDA + \angle XAD < 180^\circ \), which proves that \( X \) lies inside the angles \( \angle ECD \) and \( \angle EAD \) of the quadrilateral \( EADC \). Moreover, \( X \) lies in the interior of exactly one of the two triangles \( \triangle EAD \) and \( \triangle ECD \) (and in the exterior of the other).

\textbf{Lemma.} Let \( PQR \) be a triangle, and let \( X \) be a point in the interior of the angle \( \angle QPR \) such that \( \angle QPX = \angle PRX \). Then

\[
\frac{PX \cdot QR}{PQ \cdot PR} < 1 \quad \text{if and only if} \quad X \text{ lies in the interior of the triangle } PQR.
\]

\textit{Proof.} The locus of points \( X \) with \( \angle QPX = \angle PRX \) lying inside the angle \( \angle QPR \) is an arc \( \alpha \) of the circle \( \gamma \) through \( R \) tangent to \( PQ \) at \( P \). Let \( \gamma \) intersect the line \( QR \) again at \( Y \) (if \( \gamma \) is tangent to \( QR \), then set \( Y = R \)). The similarity \( \triangle QPY \sim \triangle QRP \) yields

\[
PY = \frac{PQ \cdot PR}{QR}.
\]

Now it suffices to show that \( PX < PY \) if and only if \( X \) lies in the interior of the triangle \( PQR \). Let \( m \) be a line through \( Y \) parallel to \( PQ \). Notice that the points \( Z \) of \( \gamma \) satisfying \( PZ < PY \) are exactly those between the lines \( m \) and \( PQ \).

\textbf{Case 1:} \( Y \) lies in the segment \( QR \) (see the left figure below).

In this case, \( Y \) splits \( \alpha \) into two arcs \( PY \) and \( YR \). The arc \( PY \) lies inside the triangle \( PQR \), and \( PY \) lies between \( m \) and \( PQ \), hence \( PX < PY \) for points \( X \in PY \). The other arc \( YR \) lies outside triangle \( PQR \), and \( YR \) is on the opposite side of \( m \) than \( P \), hence \( PX > PY \) for all \( X \in YR \).

\textbf{Case 2:} \( Y \) lies on the ray \( QR \) beyond \( R \) (see the right figure below).

In this case, the whole arc \( \alpha \) lies inside triangle \( PQR \), and between \( m \) and \( PQ \), thus \( PX < PY \) for all \( X \in \alpha \). \( \square \)

Applying the Lemma (to \( \triangle EAD \) with the point \( X \), and to \( \triangle ECD \) with the point \( X \)), we obtain that exactly one of two expressions

\[
\frac{XA \cdot DE}{AD \cdot AE} \quad \text{and} \quad \frac{XC \cdot DE}{CD \cdot CE}
\]

is less than 1, which contradicts (\(*\)).

So the value of \( \angle AXB + \angle CXD \) is \(180\) (in degrees).",180,geometry
2018n5,"\textbf{N5.} Four positive integers \( x, y, z, \) and \( t \) satisfy the relations

\[
xy - zt = x + y = z + t. \tag{*}
\]

Is it possible that both \( xy \) and \( zt \) are perfect squares? If the answer is 'Yes', then give the value of \(1\). Else give the value of \(0\).","Arguing indirectly, assume that \( xy = a^2 \) and \( zt = c^2 \) with \( a, c > 0 \).
Suppose that the number \( x + y = z + t \) is odd. Then \( x \) and \( y \) have opposite parity, as well as \( z \) and \( t \). This means that both \( xy \) and \( zt \) are even, as well as \( xy - zt = x + y \); a contradiction. Thus, \( x + y \) is even, so the number \( s = \frac{x+y}{2} = \frac{z+t}{2} \) is a positive integer.

Next, we set \( b = \frac{|x-y|}{2}, d = \frac{|z-t|}{2} \). Now the problem conditions yield

\[
s^2 = a^2 + b^2 = c^2 + d^2 \tag{1}
\]

and

\[
2s = a^2 - c^2 = d^2 - b^2 \tag{2}
\]

(the last equality in (2) follows from (1)). We readily get from (2) that \( a, d > 0 \).

In the sequel we will use only the relations (1) and (2), along with the fact that \( a, d, s \) are positive integers, while \( b \) and \( c \) are nonnegative integers, at most one of which may be zero. Since both relations are symmetric with respect to the simultaneous swappings \( a \leftrightarrow d \) and \( b \leftrightarrow c \), we assume, without loss of generality, that \( b > c \) (and hence \( b > 0 \)). Therefore,

\[
d^2 = 2s + b^2 > c^2, \text{ whence } d^2 > \frac{c^2 + d^2}{2} = \frac{s^2}{2}. \tag{3}
\]

On the other hand, since \( d^2 - b^2 \) is even by (2), the numbers \( b \) and \( d \) have the same parity, so \( 0 < b \leq d - 2 \). Therefore,

\[
2s = d^2 - b^2 > d^2 - (d - 2)^2 = 4(d - 1), \text{ i.e., } d \leq \frac{s}{2} + 1. \tag{4}
\]

Combining (3) and (4) we obtain

\[
2s^2 \leq 4d^2 \leq 4 \left( \frac{s}{2} + 1 \right)^2, \text{ or } (s - 2)^2 < 8,
\]

which yields \( s \leq 4 \).

Finally, an easy check shows that each number of the form \( s^2 \) with \( 1 \leq s \leq 4 \) has a unique representation as a sum of two squares, namely \( s^2 = s^2 + 0^2 \). Thus, (1) along with \( a, d > 0 \) imply \( b = c = 0 \), which is impossible.
",0,number theory
2017a1,"Let \( a_1, a_2, \dots, a_n, k, \) and \( M \) be positive integers such that

\[
\frac{1}{a_1} + \frac{1}{a_2} + \dots + \frac{1}{a_n} = k \quad \text{and} \quad a_1a_2 \dots a_n = M.
\]

If \( M > 1 \), Does the polynomial

\[
P(x) = M(x + 1)^k - (x + a_1)(x + a_2) \dots (x + a_n)
\]

has positive roots? If the polynomial has positive roots, your answer should be \(1\). Else the answer should be \(0\).
","We first prove that, for \( x > 0 \),

\[
a_i(x + 1)^{1/a_i} \leq x + a_i, \tag{1}
\]

with equality if and only if \( a_i = 1 \). It is clear that equality occurs if \( a_i = 1 \).

If \( a_i > 1 \), the AM–GM inequality applied to a single copy of \( x + 1 \) and \( a_i - 1 \) copies of 1 yields

\[
(x + 1) + 1 + 1 + \cdots + 1 \quad \text{(} a_i - 1 \text{ ones)} \geq \sqrt[a_i]{(x + 1) \cdot 1^{a_i - 1}} \Rightarrow a_i(x + 1)^{1/a_i} \leq x + a_i.
\]

Since \( x + 1 > 1 \), the inequality is strict for \( a_i > 1 \).

Multiplying the inequalities (1) for \( i = 1, 2, \dots, n \) yields

\[
\prod_{i=1}^{n} a_i(x + 1)^{1/a_i} \leq \prod_{i=1}^{n} (x + a_i} \quad \Leftrightarrow \quad M(x + 1)^{\sum_{i=1}^{n} 1/a_i} - \prod_{i=1}^{n} (x + a_i) \leq 0 \quad \Leftrightarrow \quad P(x) \leq 0
\]

with equality if and only if \( a_i = 1 \) for all \( i \in \{ 1, 2, \dots, n \} \). But this implies \( M = 1 \), which is not possible. Hence \( P(x) < 0 \) for all \( x \in \mathbb{R}^+ \), and \( P \) has no positive roots.
",0,algebra
2017a2,"Let \( q \) be a real number. Gugu has a napkin with ten distinct real numbers written on it, and he writes the following three lines of real numbers on the blackboard:

\begin{itemize}
    \item In the first line, Gugu writes down every number of the form \( a - b \), where \( a \) and \( b \) are two (not necessarily distinct) numbers on his napkin.
    \item In the second line, Gugu writes down every number of the form \( qab \), where \( a \) and \( b \) are two (not necessarily distinct) numbers from the first line.
    \item In the third line, Gugu writes down every number of the form \( a^2 + b^2 - c^2 - d^2 \), where \( a, b, c, d \) are four (not necessarily distinct) numbers from the first line.
\end{itemize}

Determine all values of \( q \) such that, regardless of the numbers on Gugu's napkin, every number in the second line is also a number in the third line. Calculate sum of the absolute values of all possible values of \(q\).","Call a number \( q \) good if every number in the second line appears in the third line unconditionally. We first show that the numbers 0 and \( \pm 2 \) are good. The third line necessarily contains 0, so 0 is good. For any two numbers \( a, b \) in the first line, write \( a = x - y \) and \( b = u - v \), where \( x, y, u, v \) are (not necessarily distinct) numbers on the napkin. We may now write

\[
2ab = 2(x - y)(u - v) = (x - v)^2 + (y - u)^2 - (x - u)^2 - (y - v)^2,
\]

which shows that 2 is good. By negating both sides of the above equation, we also see that \( -2 \) is good.

We now show that \( -2, 0, \) and \( 2 \) are the only good numbers. Assume for sake of contradiction that \( q \) is a good number, where \( q \notin \{-2, 0, 2\} \). We now consider some particular choices of numbers on Gugu's napkin to arrive at a contradiction.

Assume that the napkin contains the integers \( 1, 2, \dots, 10 \). Then, the first line contains the integers \( -9, -8, \dots, 9 \). The second line then contains \( q \) and \( 81q \), so the third line must also contain both of them. But the third line only contains integers, so \( q \) must be an integer. Furthermore, the third line contains no number greater than 162, so we must have \( -162 \leq 81q \leq 162 \). This shows that the only possibilities for \( q \) are \( \pm 1 \).

Now assume that \( q = \pm 1 \). Let the napkin contain \( 0, 1, 4, 8, 12, 16, 20, 24, 28, 32 \). The first line contains \( \pm 1 \) and \( \pm 4 \), so the second line contains \( \pm 4 \). However, for every number \( a \) in the first line, \( a^2 \equiv 0, 1 \pmod{8} \). Consequently, every number in the third line must be congruent to \( -2, -1, 0, 1, 2 \pmod{8} \); in particular, \( \pm 4 \) cannot be in the third line, which is a contradiction.
So all the possible value of \(q\) are \(-2, 0, 2\). The sum of the absolute values of all possible values of \(q\) is \(4\).",4,algebra
2017a5,"An integer \( n \geq 3 \) is given. We call an \( n \)-tuple of real numbers \( (x_1, x_2, \dots, x_n) \) Shiny if for each permutation \( y_1, y_2, \dots, y_n \) of these numbers we have

\[
\sum_{i=1}^{n-1} y_i y_{i+1} = y_1 y_2 + y_2 y_3 + y_3 y_4 + \dots + y_{n-1} y_n \geq -1.
\]

Find the largest constant \( K = K(n) \) such that

\[
\sum_{1 \leq i < j \leq n} x_i x_j \geq K
\]

holds for every Shiny \( n \)-tuple \( (x_1, x_2, \dots, x_n) \).
Give the absolute value of \(K\) when \(n=51\).","Call a number \( q \) good if every number in the second line appears in the third line unconditionally. We first show that the numbers 0 and \( \pm 2 \) are good. The third line necessarily contains 0, so 0 is good. For any two numbers \( a, b \) in the first line, write \( a = x - y \) and \( b = u - v \), where \( x, y, u, v \) are (not necessarily distinct) numbers on the napkin. We may now write

\[
2ab = 2(x - y)(u - v) = (x - v)^2 + (y - u)^2 - (x - u)^2 - (y - v)^2,
\]

which shows that 2 is good. By negating both sides of the above equation, we also see that \( -2 \) is good.

We now show that \( -2, 0, \) and \( 2 \) are the only good numbers. Assume for sake of contradiction that \( q \) is a good number, where \( q \notin \{-2, 0, 2\} \). We now consider some particular choices of numbers on Gugu's napkin to arrive at a contradiction.

Assume that the napkin contains the integers \( 1, 2, \dots, 10 \). Then, the first line contains the integers \( -9, -8, \dots, 9 \). The second line then contains \( q \) and \( 81q \), so the third line must also contain both of them. But the third line only contains integers, so \( q \) must be an integer. Furthermore, the third line contains no number greater than 162, so we must have \( -162 \leq 81q \leq 162 \). This shows that the only possibilities for \( q \) are \( \pm 1 \).

Now assume that \( q = \pm 1 \). Let the napkin contain \( 0, 1, 4, 8, 12, 16, 20, 24, 28, 32 \). The first line contains \( \pm 1 \) and \( \pm 4 \), so the second line contains \( \pm 4 \). However, for every number \( a \) in the first line, \( a^2 \equiv 0, 1 \pmod{8} \). Consequently, every number in the third line must be congruent to \( -2, -1, 0, 1, 2 \pmod{8} \); in particular, \( \pm 4 \) cannot be in the third line, which is a contradiction.

So K = -\frac{(n-1)}{2}. When \(n=51\), the absolute value of \(K\) is \(25\)
",25,algebra
2017a6,"Find all functions \( f: \mathbb{R} \to \mathbb{R} \) such that

\[
f(f(x)f(y)) + f(x + y) = f(xy) \tag{*}
\]

for all \( x, y \in \mathbb{R} \). If \(f(2) > 0\), what is the value of \(f(90\).","An easy check shows that all the 3 above mentioned functions indeed satisfy the original equation (\(*\)).

In order to show that these are the only solutions, first observe that if \( f(x) \) is a solution then \( -f(x) \) is also a solution. Hence, without loss of generality we may (and will) assume that \( f(0) \leq 0 \) from now on. We have to show that either \( f \) is identically zero or \( f(x) = x - 1 \) (for all \( x \in \mathbb{R} \)).

Observe that, for a fixed \( x \neq 1 \), we may choose \( y \in \mathbb{R} \) so that \( x + y = xy \Leftrightarrow y = \frac{x}{x - 1} \), and therefore from the original equation (\(*\)) we have

\[
f(f(x) \cdot f\left( \frac{x}{x - 1} \right)) = 0 \quad (x \neq 1). \tag{1}
\]

In particular, plugging in \( x = 0 \) in (1), we conclude that \( f \) has at least one zero, namely \( f(0) \):

\[
f((f(0))^2) = 0. \tag{2}
\]

We analyze two cases (recall that \( f(0) \leq 0 \)):

\textbf{Case 1:} \( f(0) = 0 \).
Setting \( y = 0 \) in the original equation we get the identically zero solution:

\[
f(f(x)f(0)) + f(x) = f(0) \Rightarrow f(x) = 0 \text{ for all } x \in \mathbb{R}.
\]

From now on, we work on the main

\textbf{Case 2:} \( f(0) < 0 \).

We begin with the following

\textbf{Claim 1.} \( f(1) = 0, \ f(a) = 0 \Rightarrow a = 1, \text{ and } f(0) = -1. \)

\textit{Proof.} We need to show that 1 is the unique zero of \( f \). First, observe that \( f \) has at least one zero \( a \) by (2); if \( a \neq 1 \) then setting \( x = a \) in (1) we get \( f(0) = 0 \), a contradiction. Hence from (2) we get \( (f(0))^2 = 1 \). Since we are assuming \( f(0) < 0 \), we conclude that \( f(0) = -1 \). 

Setting \( y = 1 \) in the original equation (\(*\)) we get

\[
f(f(x)f(1)) + f(x + 1) = f(x) \Leftrightarrow f(0) + f(x + 1) = f(x) \Leftrightarrow f(x + 1) = f(x) + 1 \quad (x \in \mathbb{R}).
\]

An easy induction shows that

\[
f(x + n) = f(x) + n \quad (x \in \mathbb{R}, n \in \mathbb{Z}). \tag{4}
\]

Now we make the following

\textbf{Claim 2.} \( f \) is injective.

\textit{Proof.} Suppose that \( f(a) = f(b) \) with \( a \neq b \). Then by (4), for all \( N \in \mathbb{Z} \),

\[
f(a + N) = f(b + N) \Rightarrow f(a + N + 1) = f(b + N + 1).
\]

Choose any integer \( N < -b \); then there exist \( x_0, y_0 \in \mathbb{R} \) with \( x_0 + y_0 = a + N + 1, x_0 y_0 = b + N \). Since \( a \neq b \), we have \( x_0 \neq 1 \) and \( y_0 \neq 1 \). Plugging in \( x_0 \) and \( y_0 \) in the original equation (\(*\)) we get

\[
f(f(x_0)f(y_0)) + f(x_0 + y_0) = f(x_0 y_0) + 1 = 0 \Rightarrow f(f(x_0)f(y_0)) = 0 \quad \text{by (4)}.
\]

However, by Claim 1 we have \( f(x_0) \neq 0 \) and \( f(y_0) \neq 0 \) since \( x_0 \neq 1 \) and \( y_0 \neq 1 \), a contradiction. 

Now the end is near. For any \( t \in \mathbb{R} \), plug in \( (x, y) = (t, -t) \) in the original equation (\(*\)) to get

\[
f(f(t)f(-t)) + f(0) = f(-t^2) \Rightarrow f(f(t)f(-t)) = f(-t^2) + 1 \quad \text{by (3)}.
\]

Similarly, plugging in \( (x, y) = (t, 1 - t) \) in (\(*\)) we get

\[
f(f(t)f(1 - t)) + f(1) = f(t(1 - t)) \Rightarrow f(f(t)f(1 - t)) = t(1 - t) \quad \text{by (3)}.
\]

But since \( f(1 - t) = 1 + f(-t) \) by (4), we get

\[
f(t)f(1 - t) = t(1 - t) \Leftrightarrow f(t) = t - 1,
\]

as desired. If \(f(2) > 0\), the value of \(f(90\) is \(89\).",89,algebra
2017c3,"Sir Alex plays the following game on a row of 9 cells. Initially, all cells are empty. In each move, Sir Alex is allowed to perform exactly one of the following two operations:

\begin{enumerate}
    \item Choose any number of the form \( 2^j \), where \( j \) is a non-negative integer, and put it into an empty cell.
    \item Choose two (not necessarily adjacent) cells with the same number in them; denote that number by \( 2^j \). Replace the number in one of the cells with \( 2^{j+1} \) and erase the number in the other cell.
\end{enumerate}

At the end of the game, one cell contains the number \( 2^n \), where \( n \) is a given positive integer, while the other cells are empty. Determine the maximum number of moves that Sir Alex could have made, in terms of \( n \).
","We will solve a more general problem, replacing the row of 9 cells with a row of \( k \) cells, where \( k \) is a positive integer. Denote by \( m(n, k) \) the maximum possible number of moves Sir Alex can make starting with a row of \( k \) empty cells, and ending with one cell containing the number \( 2^n \) and all the other \( k - 1 \) cells empty. Call an operation of type (1) an insertion, and an operation of type (2) a merge.

Only one move is possible when \( k = 1 \), so we have \( m(n, 1) = 1 \). From now on we consider \( k \geq 2 \), and we may assume Sir Alex’s last move was a merge. Then, just before the last move, there were exactly two cells with the number \( 2^{n-1} \), and the other \( k - 2 \) cells were empty.

Paint one of those numbers \( 2^{n-1} \) blue, and the other one red. Now trace Sir Alex’s moves, always painting the numbers blue or red following this rule: if \( a \) and \( b \) merge into \( c \), paint \( a \) and \( b \) with the same color as \( c \). Notice that in this backward process new numbers are produced only by reversing merges, since reversing an insertion simply means deleting one of the numbers. Therefore, all numbers appearing in the whole process will receive one of the two colors.

Sir Alex’s first move is an insertion. Without loss of generality, assume this first number inserted is blue. Then, from this point on, until the last move, there is always at least one cell with a blue number.

Besides the last move, there is no move involving a blue and a red number, since all merges involves numbers with the same color, and insertions involve only one number. Call an insertion of a blue number or merge of two blue numbers a blue move, and define a red move analogously.

The whole sequence of blue moves could be repeated on another row of \( k \) cells to produce one cell with the number \( 2^{n-1} \) and all the others empty, so there are at most \( m(n-1, k-1) \) blue moves.

Now we look at the red moves. Since every time we perform a red move there is at least one cell occupied with a blue number, the whole sequence of red moves could be repeated on a row of \( k-1 \) cells to produce one cell with the number \( 2^{n-1} \) and all the others empty, so there are at most \( m(n-1, k-1) \) red moves. This proves that

\[
m(n, k) \leq m(n-1, k) + m(n-1, k-1) + 1. \tag{1}
\]

On the other hand, we can start with an empty row of \( k \) cells and perform \( m(n-1, k) \) moves to produce one cell with the number \( 2^{n-1} \) and all the others empty, and after that perform \( m(n-1, k-1) \) moves on those \( k - 1 \) empty cells to produce the number \( 2^{n-1} \) in one of them, leaving \( k - 2 \) empty. With one more merge we get one cell with \( 2^n \) and the others empty, proving that

\[
m(n, k) \geq m(n-1, k) + m(n-1, k-1) + 1. \tag{2}
\]

It follows that

\[
m(n, k) = m(n-1, k) + m(n-1, k-1) + 1, \quad \text{for} \quad n \geq 1 \text{ and } k \geq 2.
\]

If \( k = 1 \) or \( n = 0 \), we must insert \( 2^n \) on our first move and immediately get the final configuration, so \( m(0, k) = 1 \) and \( m(n, 1) = 1 \), for \( n \geq 0 \) and \( k \geq 1 \). These initial values, together with the recurrence relation (1), determine \( m(n, k) \) uniquely.

Finally, we show that

\[
m(n, k) = 2 \sum_{j=0}^{k-1} \binom{n}{j} - 1, \tag{2}
\]

for all integers \( n \geq 0 \) and \( k \geq 1 \).

We use induction on \( n \). Since \( m(0, k) = 1 \) for \( k \geq 1 \), (2) is true for the base case. We make the induction hypothesis that (2) is true for some fixed positive integer \( n \) and all \( k \geq 1 \). We have \( m(n+1, 1) = 1 = 2^{(n+1)} - 1 \), and for \( k \geq 2 \) the recurrence relation (1) and the induction hypothesis give us

\[
m(n+1, k) = m(n, k) + m(n, k-1) + 1
= 2 \sum_{j=0}^{k-1} \binom{n}{j} + 2 \sum_{j=0}^{k-1} \binom{n}{j-1} - 1
= 2 \sum_{j=0}^{k-1} \binom{n+1}{j} - 1,
\]

which completes the proof.

So the maximum number is \( 2 \sum_{j=0}^{8} \binom{n}{j} - 1 \). When \(n=12\), the answer is \(7593\).
",7593,combinatorics
2017c5,"A hunter and an invisible rabbit play a game in the Euclidean plane. The hunter’s starting point \( H_0 \) coincides with the rabbit’s starting point \( R_0 \). In the \( n \)th round of the game (\( n \geq 1 \)), the following happens.

\begin{enumerate}
    \item First the invisible rabbit moves secretly and unobserved from its current point \( R_{n-1} \) to some new point \( R_n \) with \( R_{n-1}R_n = 1 \).
    \item The hunter has a tracking device (e.g. dog) that returns an approximate position \( R_n' \) of the rabbit, so that \( R_nR_n' \leq 1 \).
    \item The hunter then visibly moves from point \( H_{n-1} \) to a new point \( H_n \) with \( H_{n-1}H_n = 1 \).
\end{enumerate}

Is there a strategy for the hunter that guarantees that after \( 10^9 \) such rounds the distance between the hunter and the rabbit is below 100? If the answer is 'Yes', give the value of \(1\). Else give the value of \(0\).
","If the answer were “yes”, the hunter would have a strategy that would “work”, no matter how the rabbit moved or where the radar pings \( R'_n \) appeared. We will show the opposite: with bad luck from the radar pings, there is no strategy for the hunter that guarantees that the distance stays below 100 in \( 10^9 \) rounds.

So, let \( d_n \) be the distance between the hunter and the rabbit after \( n \) rounds. Of course, if \( d_n \geq 100 \) for any \( n < 10^9 \), the rabbit has won — it just needs to move straight away from the hunter, and the distance will be kept at or above 100 thereon.

We will now show that, while \( d_n < 100 \), whatever given strategy the hunter follows, the rabbit has a way of increasing \( d_n^2 \) by at least \( \frac{1}{2} \) every 200 rounds (as long as the radar pings are lucky enough for the rabbit). This way, \( d_n^2 \) will reach \( 10^4 \) in less than \( 2 \cdot 10^4 \cdot 200 = 4 \cdot 10^6 < 10^9 \) rounds, and the rabbit wins.

Suppose the hunter is at \( H_n \) and the rabbit is at \( R_n \). Suppose even that the rabbit reveals its position at this moment to the hunter (this allows us to ignore all information from previous radar pings). Let \( r \) be the line \( H_nR_n \), and \( Y_1 \) and \( Y_2 \) be points which are 1 unit away from \( r \) and 200 units away from \( R_n \), as in the figure below.

The rabbit’s plan is simply to choose one of the points \( Y_1 \) or \( Y_2 \) and hop 200 rounds straight towards it. Since all hops stay within 1 distance unit from \( r \), it is possible that all radar pings stay on \( r \). In particular, in this case, the hunter has no way of knowing whether the rabbit chose \( Y_1 \) or \( Y_2 \).

Looking at such pings, what is the hunter going to do? If the hunter’s strategy tells him to go 200 rounds straight to the right, he ends up at point \( H' \) in the figure. Note that the hunter does not have a better alternative! Indeed, after these 200 rounds he will always end up at a point to the left of \( H' \). If his strategy took him to a point above \( r \), he would end up even further from \( Y_2 \); and if his strategy took him below \( r \), he would end up even further from \( Y_1 \). In other words, no matter what strategy the hunter follows, he can never be sure his distance to the rabbit will be less than \( y \defeq H'Y_1 = H'Y_2 \) after these 200 rounds.

To estimate \( y^2 \), we take \( Z \) as the midpoint of segment \( Y_1Y_2 \), we take \( R' \) as a point 200 units to the right of \( R_n \) and we define \( \varepsilon = ZR' \) (note that \( H'R' = d_n \)). Then

\[
y^2 = 1 + (H'Z)^2 = 1 + (d_n - \varepsilon)^2
\]

where

\[
\varepsilon = 200 - R_nZ = 200 - \sqrt{200^2 - 1} = \frac{1}{200 + \sqrt{200^2 - 1}} \geq \frac{1}{400}.
\]

In particular, \( \varepsilon^2 + 1 = 400\varepsilon \), so

\[
y^2 = d_n^2 - 2\varepsilon d_n + \varepsilon^2 + 1 = d_n^2 + \varepsilon(400 - 2d_n).
\]

Since \( \varepsilon > \frac{1}{400} \) and we assumed \( d_n < 100 \), this shows that \( y^2 > d_n^2 + \frac{1}{2} \). So, as we claimed, with this list of radar pings, no matter what the hunter does, the rabbit might achieve \( d_n^2 + 200 \) and \( d_n^2 > d_n^2 + \frac{1}{2} \).

The rabbit wins.
",0,combinatorics
2017c6,"Let \( n > 1 \) be an integer. An \( n \times n \times n \) cube is composed of \( n^3 \) unit cubes. Each unit cube is painted with one color. For each \( n \times n \times 1 \) box consisting of \( n^2 \) unit cubes (of any of the three possible orientations), we consider the set of the colors present in that box (each color is listed only once). This way, we get \( 3n \) sets of colors, split into three groups according to the orientation. It happens that for every set in any group, the same set appears in both of the other groups. Determine, in terms of \( n=60 \), the maximal possible number of colors that are present.
","Call a \( n \times n \times 1 \) box an x-box, a y-box, or a z-box, according to the direction of its short side. Let \( C \) be the number of colors in a valid configuration. We start with the upper bound for \( C \).

Let \( C_1, C_2, \) and \( C_3 \) be the sets of colors which appear in the big cube exactly once, exactly twice, and at least thrice, respectively. Let \( M_i \) be the set of unit cubes whose colors are in \( C_i \), and denote \( n_i = |M_i| \).

Consider any x-box \( X \), and let \( Y \) and \( Z \) be a y- and a z-box containing the same set of colors as \( X \) does.
\[
\text{Claim. } 4|X \cap M_1| + |X \cap M_2| \leq 3n + 1.
\]
Proof. We distinguish two cases.

Case 1: \( X \cap M_1 \neq \emptyset \).

A cube from \( X \cap M_1 \) should appear in all three boxes \( X, Y, \) and \( Z \), so it should lie in \( X \cap Y \cap Z \). Thus \( X \cap M_1 = X \cap Y \cap Z \) and \( |X \cap M_1| = 1 \).

Consider now the cubes in \( X \cap M_2 \). There are at most \( 2(n - 1) \) of them lying in \( X \cap Y \) or \( X \cap Z \) (because the cubes from \( X \cap Y \cap Z \) are in \( M_1 \)). Let \( a \) be some other cube from \( X \cap M_2 \). Recall that there is just one other cube \( a' \) sharing a color with \( a \). But both \( Y \) and \( Z \) should contain such cube, so \( a' \in Y \cap Z \) (but \( a' \notin X \cap Y \cap Z \)). The map \( a \mapsto a' \) is clearly injective, so the number of cubes \( a \) we are interested in does not exceed \( |(Y \cap Z) \cap X| = n - 1 \). Thus
\[
|X \cap M_2| \leq 2(n - 1) + (n - 1) = 3(n - 1),
\]
and hence
\[
4|X \cap M_1| + |X \cap M_2| \leq 4 + 3(n - 1) = 3n + 1.
\]

Case 2: \( X \cap M_1 = \emptyset \).

In this case, the same argument applies with several changes. Indeed, \( X \cap M_2 \) contains at most \( 2n - 1 \) cubes from \( X \cap Y \) or \( X \cap Z \). Any other cube \( a \) in \( X \cap M_2 \) corresponds to some \( a' \in Y \cap Z \) (possibly with \( a' \in X \)), so there are at most \( n \) of them. All this results in
\[
|X \cap M_2| \leq (2n - 1) + n = 3n - 1,
\]
which is even better than we need (by the assumptions of our case).

Summing up the inequalities from the Claim over all x-boxes \( X \), we obtain
\[
4n_1 + n_2 \leq n(3n + 1).
\]
Obviously, we also have \( n_1 + n_2 + n_3 = n^3 \).

Now we are prepared to estimate \( C \). Due to the definition of the \( M_i \), we have \( n_i \leq i|C| \), so
\[
C \leq n_1 + \frac{n_2}{2} + \frac{n_3}{3} = n_1 + \frac{n_2 + n_3}{3} = \frac{n_1 + n_2 + n_3}{3} + \frac{4n_1 + n_2}{6} \leq \frac{n^3}{3} + \frac{3n^2 + n}{6} = \frac{n(n + 1)(2n + 1)}{6}.
\]
It remains to present an example of an appropriate coloring in the above-mentioned number of colors. For each color, we present the set of all cubes of this color. These sets are:

1. \( n \) singletons of the form \( S_i = \{(i, i, i)\} \) (with \( 1 \leq i \leq n \)).

2. \( 3 \binom{n}{2} \) doubletons of the forms \( D_{i,j} = \{(i, j, j), (j, i, j), (j, j, i)\}, D_{i,j}^2 = \{(j, j, i), (i, j, j), (i, i, j)\} \) (with \( 1 \leq i < j \leq n \)).

3. \( 2 \binom{n}{3} \) triplets of the form \( T_{i,j,k} = \{(i,j,k), (j,k,i), (k,i,j)\} \) (with \( 1 \leq i < j < k \leq n \) or \( 1 \leq i \leq j < k \leq n \)).

One may easily see that the \( i^{th} \) boxes of each orientation contain the same set of colors, and that
\[
n + \frac{3n(n - 1)}{2} + \frac{n(n - 1)(n - 2)}{3} = \frac{n(n + 1)(2n + 1)}{6}
\]
colors are used, as required.",73810,combinatorics
2017c8,"Let \( n \) be a given positive integer. In the Cartesian plane, each lattice point with nonnegative coordinates initially contains a butterfly, and there are no other butterflies. The neighborhood of a lattice point \( c \) consists of all lattice points within the axis-aligned \( (2n + 1) \times (2n + 1) \) square centered at \( c \), apart from \( c \) itself. We call a butterfly lonely, crowded, or comfortable, depending on whether the number of butterflies in its neighborhood \( N \) is respectively less than, greater than, or equal to half of the number of lattice points in \( N \).

Every minute, all lonely butterflies fly away simultaneously. This process goes on for as long as there are any lonely butterflies. Assuming that the process eventually stops, determine the number of comfortable butterflies at the final state when \(n=60\)
","We always identify a butterfly with the lattice point it is situated at. For two points \( p \) and \( q \), we write \( p \geq q \) if each coordinate of \( p \) is at least the corresponding coordinate of \( q \). Let \( O \) be the origin, and let \( Q \) be the set of initially occupied points, i.e., of all lattice points with nonnegative coordinates. Let \( R_H = \{ (x, 0) : x \geq 0 \} \) and \( R_V = \{ (0, y) : y \geq 0 \} \) be the sets of the lattice points lying on the horizontal and vertical boundary rays of \( Q \). Denote by \( N(a) \) the neighborhood of a lattice point \( a \).

1. Initial observations. We call a set of lattice points up-right closed if its points stay in the set after being shifted by any lattice vector \( (i, j) \) with \( i, j \geq 0 \). Whenever the butterflies form a up-right closed set \( S \), we have \( |N(p) \cap S| \geq |N(q) \cap S| \) for any two points \( p, q \in S \) with \( p \geq q \). So, since \( Q \) is up-right closed, the set of butterflies at any moment also preserves this property. We assume all forthcoming sets of lattice points to be up-right closed.

When speaking of some set \( S \) of lattice points, we call its points lonely, comfortable, or crowded with respect to this set (i.e., as if the butterflies were exactly at all points of \( S \)). We call a set \( S \subseteq Q \) stable if it contains no lonely points. In what follows, we are interested only in those stable sets whose complements in \( Q \) are finite, because one can easily see that only a finite number of butterflies can fly away on each minute.

If the initial set \( Q \) of butterflies contains some stable set \( S \), then, clearly no butterfly of this set will fly away. On the other hand, the set \( F \) of all butterflies in the end of the process is stable. This means that \( F \) is the largest (with respect to inclusion) stable set within \( Q \), and we are about to describe this set.

2. A description of a final set. The following notion will be useful. Let \( \mathcal{U} = \{ \mathbf{u}_1, \mathbf{u}_2, \dots, \mathbf{u}_d \} \) be a set of \( d \) pairwise non-parallel lattice vectors, each having a positive \( x \)- and a negative \( y \)-coordinate. Assume that they are numbered in increasing order according to slope. We now define a \( U \)-curve to be the broken line \( p_0 p_1 \dots p_d \) such that \( p_0 \in R_V \), \( p_d \in R_H \), and \( \mathbf{p}_i \) lies on the line \( y = x \). Denote by \( D \) the convex hull of \( D \).

Now, let \( K_n = \{ (i, j) : 1 \leq i \leq n, -n \leq j \leq -1 \} \). Consider all the rays emerging at \( O \) and passing through a point from \( K_n \); number them as \( r_1, \dots, r_m \) in increasing order according to slope. Let \( A_i \) be the farthest from \( O \) lattice point in \( r_i \cap K_n \), let \( k_i = |r_i \cap K_n| \), and finally denote \( \mathbf{v}_i = \overrightarrow{OA_i} \), see the Figure above to the right. We will concentrate on the \( V \)-curve \( d_0 d_1 \dots d_m \); let \( D \) be the set of all lattice points \( p \) such that \( p \geq p' \) for some (not necessarily lattice) point \( p' \) on the \( V \)-curve. In fact, we will show that \( D = F \).

Clearly, the \( V \)-curve is symmetric in the line \( y = x \). Denote by \( D \) the convex hull of \( D \).

3. We prove that the set \( D \) contains all stable sets. Let \( S \subseteq Q \) be a stable set (recall that it is assumed to be up-right closed and to have a finite complement in \( Q \)). Denote by \( S \) its convex hull; clearly, the vertices of \( S \) are lattice points. The boundary of \( S \) consists of two rays (horizontal and vertical ones) along with some \( V_* \)-curve for some set of lattice vectors \( V_* \).

Claim 1. For every \( \mathbf{v}_i \in V \), there is a \( \mathbf{v}_i^* \in V_* \) co-directed with \( \mathbf{v}_i \) with \( |\mathbf{v}_i^*| \geq |\mathbf{v}_i| \).

Proof. Let \( \ell \) be the supporting line of \( S \) parallel to \( \mathbf{v}_i \) (i.e., \( \ell \) contains some point of \( S \), and the set \( S \) lies on one side of \( \ell \)). Take any point \( b \in \ell \cap S \) and consider \( N(b) \). The line \( \ell \) splits the set \( N(b) \setminus \ell \) into two congruent parts, one having an empty intersection with \( S \). Hence, in order for \( b \) not to be lonely, at least half of the set \( \ell \cap N(b) \) (which contains \( 2k_i \) points) should lie in \( S \). Thus, the boundary of \( S \) contains a segment \( \ell \cap S \) with at least \( k_i + 1 \) lattice points on it; this segment corresponds to the required vector \( \mathbf{v}_i^* \in V_* \).

Claim 2. Each stable set \( S \subseteq Q \) lies in \( D \).

Proof. To show this, it suffices to prove that the \( V_* \)-curve lies in \( D \), i.e., that all its vertices do so. Let \( p' \) be an arbitrary vertex of the \( V_* \)-curve; \( p' \) partitions this curve into two parts, \( X \) (being down-right of \( p \)) and \( Y \) (being up-left of \( p \)). The set \( V \) is split now into two parts: \( V_X \) consisting of those \( \mathbf{v}_i \in V \) for which \( \mathbf{v}_i^* \) corresponds to a segment in \( X \), and a similar part \( V_Y \).

Notice that the \( V \)-curve consists of several segments corresponding to \( V_X \), followed by those corresponding to \( V_Y \). Hence there is a vertex \( p \) of the \( V \)-curve separating \( V_X \) from \( V_Y \). Claim 1 now yields that \( p' \geq p \), so \( p' \in D \), as required.

Claim 2 implies that the final set \( F \) is contained in \( D \).

4. \( D \) is stable, and its comfortable points are known. Recall the definitions of \( r_i \); let \( r'_i \) be the ray complementary to \( r_i \). By our definitions, the set \( N(O) \) contains no points between the rays \( r_i \) and \( r_{i+1} \), as well as between \( r'_i \) and \( r'_{i+1} \).

Claim 3. In the set \( D \), all lattice points of the \( V \)-curve are comfortable.

Proof. Let \( p \) be any lattice point of the \( V \)-curve, belonging to some segment \( d_i d_{i+1} \). Draw the line \( \ell \parallel d_i d_{i+1} \) through \( p \), and draw a vertical line \( h \) through \( d_i \); see Figure below. Let \( D_L \) and \( D_R \) be the parts of \( D \) lying to the left and to the right of \( h \), respectively (points of \( D \cap h \) lie in both parts).

Notice that the vectors \( \overrightarrow{d_i p}, \overrightarrow{d_{i+1} d_{i+2}}, \overrightarrow{d_i d_{i+1}}, \overrightarrow{d_i d_{i+1}}, \overrightarrow{p d_{i+1}} \) are arranged in non-increasing order by slope. This means that \( D_L \) shifted by \( \overrightarrow{d_i p} \) still lies in \( D \), as well as \( D_R \) shifted by \( \overrightarrow{d_i p} \).

Thus, we have proved that \( D = F \), and have shown that the lattice points on the \( V \)-curve are exactly the comfortable points of \( D \). It remains to find their number.

Recall the definition of \( K_n \) (see Figure on the first page of the solution). Each segment \( d_i d_{i+1} \) contains \( k_i \) lattice points different from \( d_i \). Taken over all \( i \), these points exhaust all the lattice points in the \( V \)-curve, except for \( d_1 \), and thus the number of lattice points on the \( V \)-curve is \( 1 + \sum_{i=1}^m k_i \). On the other hand, \( \sum_{i=1}^m k_i \) is just the number of points in \( K_n \), so it equals \( n^2 \).

Hence the answer to the problem is \( n^2 + 1 \). So the answer is \(3601\).",3601,combinatorics
2017g7,"A convex quadrilateral \( ABCD \) has an inscribed circle with center \( I \). Let \( I_a, I_b, I_c, \) and \( I_d \) be the incenters of the triangles \( DAB, ABC, BCD, \) and \( CDA \), respectively. Suppose that the common external tangents of the circles \( AI_a I_d \) and \( CI_b I_d \) meet at \( X \), and the common external tangents of the circles \( BI_a I_c \) and \( DI_a I_c \) meet at \( Y \). Calculate the value of \( \angle XIY \) (in degrees).
","Denote by \( \omega_a, \omega_b, \omega_c \) and \( \omega_d \) the circles \( AI_b I_d \), \( BI_a I_c \), \( CI_b I_d \), and \( DI_a I_c \), let their centers be \( O_a, O_b, O_c \) and \( O_d \), and let their radii be \( r_a, r_b, r_c \) and \( r_d \), respectively.

\textbf{Claim 1.} \( I_b I_d \perp AC \) and \( I_a I_c \perp BD \).

\textbf{Proof.} Let the incircles of triangles \( ABC \) and \( ACD \) be tangent to the line \( AC \) at \( T \) and \( T' \), respectively. (See the figure to the left.) We have 
\[
AT = \frac{AB + AC - BC}{2}
\]
in triangle \( ABC \), \( AT' = \frac{AD + AC - CD}{2} \) in quadrilateral \( ABCD \), so
\[
AT = \frac{AC + AB - BC}{2} = \frac{AC + AD - CD}{2} = AT'.
\]
This shows \( T = T' \). As an immediate consequence, \( I_b I_d \perp AC \).
The second statement can be shown analogously.

\textbf{Claim 2.} The points \( O_a, O_b, O_c \) and \( O_d \) lie on the lines \( AI, BI, CI \) and \( DI \), respectively.

\textbf{Proof.} By symmetry it suffices to prove the claim for \( O_a \). (See the figure to the right above.)
Notice first that the incircles of triangles \( ABC \) and \( ACD \) can be obtained from the incircle of the quadrilateral \( ABCD \) with homothety centers \( B \) and \( D \), respectively, and homothety factors less than 1, therefore the points \( I_b \) and \( I_d \) lie on the line segments \( BI \) and \( DI \), respectively.

As is well-known, in every triangle the altitude and the diameter of the circumcircle starting from the same vertex are symmetric about the angle bisector. By Claim 1, in triangle \( AI_b I_d \), the segment \( AT \) is the altitude starting from \( A \). Since the foot \( T \) lies inside the segment \( I_b I_d \), the circumcenter \( O_a \) of triangle \( AI_d I_b \) lies in the angle domain \( I_b A I_d \) in such a way that
\[
\angle I_b AT = \angle O_a A I_d.
\]
The points \( I_b \) and \( I_d \) are the incenters of triangles \( ABC \) and \( ACD \), so the lines \( AI_b \) and \( I_a I_d \) bisect the angles \( \angle BAC \) and \( \angle CAD \), respectively. Then
\[
\angle O_a AD = \angle O_a A I_d + \angle I_d AD = \angle I_b AT + \angle I_d AD = \frac{1}{2} \angle BAC + \frac{1}{2} \angle CAD = \frac{1}{2} \angle BAD,
\]
so \( O_a \) lies on the angle bisector of \( \angle BAD \), that is, on line \( AI \).

The point \( X \) is the external similitude center of \( \omega_a \) and \( \omega_c \); let \( U \) be their internal similitude center. The points \( O_a \) and \( O_c \) lie on the perpendicular bisector of the common chord \( I_b I_d \) of \( \omega_a \) and \( \omega_c \), and the two similitude centers \( X \) and \( U \) lie on the same line; by Claim 2, that line is parallel to \( AC \).

From the similarity of the circles \( \omega_a \) and \( \omega_c \), from \( O_a I_b = O_a I_d = O_a A = r_a \) and \( O_c I_b = O_c C = r_c \), and from \( AC \parallel O_a O_c \) we can see that
\[
\frac{O_a X}{O_c X} = \frac{O_a U}{O_c U} = \frac{r_a}{r_c} = \frac{O_a I_d}{O_c I_d} = \frac{O_a A}{O_c C}.
\]
So the points \( X, U, I_b, I_d, I \) lie on the Apollonius circle of the points \( O_a, O_c \) with ratio \( r_a : r_c \). In this Apollonius circle \( XU \) is a diameter, and the lines \( IU \) and \( IX \) are respectively the internal and external bisectors of \( \angle O_a I_c = \angle IAC \), according to the angle bisector theorem. Moreover, in the Apollonius circle the diameter \( UX \) is the perpendicular bisector of \( I_b I_d \), so the lines \( IX \) and \( IU \) are the internal and external bisectors of \( \angle I_b I_d = \angle BID \), respectively.

Repeating the same argument for the points \( B, D \) instead of \( A, C \), we get that the line \( IY \) is the internal bisector of \( \angle IAC \) and the external bisector of \( \angle BID \). Therefore, the lines \( IX \) and \( IY \) respectively are the internal and external bisectors of \( \angle BID \), so they are perpendicular.
",90,geometry
2017g8,"There are 2017 mutually external circles drawn on a blackboard, such that no two are tangent and no three share a common tangent. A tangent segment is a line segment that is a common tangent to two circles, starting at one tangent point and ending at the other one. Luciano is drawing tangent segments on the blackboard, one at a time, so that no tangent segment intersects any other circles or previously drawn tangent segments. Luciano keeps drawing tangent segments until no more can be drawn. Find all possible numbers of tangent segments when he stops drawing.
","First note that all tangent segments lying on the boundary of the convex hull of the circles are always drawn since they do not intersect anything else. Now in the final picture, aside from the \( n \) circles, the blackboard is divided into regions. We can consider the picture as a plane (multi-)graph \( G \) in which the circles are the vertices and the tangent segments are the edges. The idea of this solution is to find a relation between the number of edges and the number of regions in \( G \); then, once we prove that \( G \) is connected, we can use Euler’s formula to finish the problem.

The boundary of each region consists of 1 or more (for now) simple closed curves, each made of arcs and tangent segments. The segment and the arc might meet smoothly (as in \( S_i \), \( i = 1, 2, \dots, 6 \) in the figure below) or not (as in \( P_1, P_2, P_3, P_4 \); call such points sharp corners of the boundary). In other words, if a person walks along the border, her direction would suddenly turn an angle of \( \pi \) at a sharp corner.

\textbf{Claim 1.} The outer boundary \( B_1 \) of any internal region has at least 3 sharp corners.

\textbf{Proof.} Let a person walk one lap along \( B_1 \) in the counterclockwise orientation. As she does so, she will turn clockwise as she moves along the circle arcs, and not turn at all when moving along the lines. On the other hand, her total rotation after one lap is \( 2\pi \) in the counterclockwise direction! Where could she be turning counterclockwise? She can only do so at sharp corners, and, even then, she turns only an angle of \( \pi \) there. But two sharp corners are not enough, since at least one arc must be present—so she must have gone through at least 3 sharp corners. 

\textbf{Claim 2.} Each internal region is simply connected, that is, has only one boundary curve.

\textbf{Proof.} Suppose, by contradiction, that some region has an outer boundary \( B_1 \) and inner boundaries \( B_2, B_3, \dots, B_m \) (\( m > 2 \)). Let \( P_1 \) be one of the sharp corners of \( B_1 \).

Now consider a car starting at \( P_1 \) and traveling counterclockwise along \( B_1 \). It starts in reverse, i.e., it is initially facing the corner \( P_1 \). Due to the tangent conditions, the car may travel in a way so that its orientation only changes when it is moving along an arc. In particular, this means the car will sometimes travel forward. For example, if the car approaches a sharp corner when driving in reverse, it would continue travel forward after the corner, instead of making an immediate half-turn. This way, the orientation of the car only changes in a clockwise direction since the car always travels clockwise around each arc.

Now imagine there is a laser pointer at the front of the car, pointing directly ahead. Initially, the laser endpoint hits \( P_1 \), but, as soon as the car hits an arc, the endpoint moves clockwise around \( B_1 \). In fact, the laser endpoint must move continuously along \( B_1 \)! Indeed, if the endpoint ever jumped (within \( B_1 \), or from \( B_1 \) to one of the inner boundaries), at the moment of the jump the interrupted laser would be a drawable tangent segment that Luciano missed (see figure below for an example).

\textbf{Claim 3.} Each region has exactly 3 sharp corners.

\textbf{Proof.} Consider again the car of the previous claim, with its laser still firmly attached to its front, traveling the same way as before and going through the same consecutive sharp corners \( P_1, P_2 \) and \( P_3 \). As we have seen, as the car goes counterclockwise from \( P_1 \) to \( P_3 \), the laser endpoint goes clockwise from \( P_1 \) to \( P_3 \), so together they cover the whole boundary. If there were a fourth sharp corner \( P_4 \), at some moment the laser endpoint would pass through it. But, since \( P_4 \) is a sharp corner, this means the car must be on the extension of a tangent segment going through \( P_4 \). Since the car is not on that segment itself (the car never goes through \( P_4 \)), we would have 3 circles with a common tangent line, which is not allowed.

We are now ready to finish the solution. Let \( r \) be the number of internal regions, and \( s \) be the number of tangent segments. Since each tangent segment contributes exactly 2 sharp corners to the diagram, and each region has exactly 3 sharp corners, we must have \( 2s = 3r \). Since the graph corresponding to the diagram is connected, we can use Euler’s formula \( n - s + r = 1 \) and find \( s = 3n - 3 \) and \( r = 2n - 2 \).

So if there were \( n \) circles, there would always be exactly \( 3(n - 1) \) segments; so the only possible answer is \( 3 \cdot 2017 - 3 = 6048 \).
",6048,geometry
2017n1,"The sequence \( a_0, a_1, a_2, \dots \) of positive integers satisfies

\[
a_{n+1} = 
\begin{cases} 
\sqrt{a_n}, & \text{if } \sqrt{a_n} \text{ is an integer} \\
a_n + 3, & \text{otherwise}
\end{cases}
\]
for every \( n \geq 0 \).

Determine all values of \( a_0 > 1 \) for which there is at least one number \( a \) such that \( a_n = a \) for infinitely many values of \( n \). Find the largest value which less than \(1000\)
","Since the value of \( a_{n+1} \) only depends on the value of \( a_n \), if \( a_n = a_m \) for two different indices \( n \) and \( m \), then the sequence is eventually periodic. So we look for the values of \( a_0 \) for which the sequence is eventually periodic.

\textbf{Claim 1.} If \( a_n \equiv -1 \pmod{3} \), then for all \( m > n \), \( a_m \) is not a perfect square. It follows that the sequence is eventually strictly increasing, so it is not eventually periodic.

\textbf{Proof.} A square cannot be congruent to \( -1 \pmod{3} \), so \( a_n \equiv -1 \pmod{3} \) implies that \( a_n \) is not a square, therefore \( a_{n+1} = a_n + 3 > a_n \). As a consequence, \( a_{n+1} = a_n + 3 \pmod{3} \), so \( a_{n+1} \) is not a square either. By repeating the argument, we prove that, from \( a_n \) on, all terms of the sequence are not perfect squares and are greater than their predecessors, which completes the proof.

\textbf{Claim 2.} If \( a_n \not\equiv -1 \pmod{3} \) and \( a_n > 9 \) then there is an index \( m > n \) such that \( a_m < a_n \).

\textbf{Proof.} Let \( t^2 \) be the largest perfect square which is less than \( a_n \). Since \( a_n > 9 \), \( t \) is at least 3. The first square in the sequence \( a_n, a_n + 3, a_n + 6, \dots \) will be \( (t + 1)^2, (t + 2)^2 \) or \( (t + 3)^2 \), therefore there is an index \( m > n \) such that \( a_m \leq t + 3 + t^2 < a_n \), as claimed.

\textbf{Claim 3.} If \( a_n \equiv 0 \pmod{3} \), then there is an index \( m > n \) such that \( a_m = 3 \).

\textbf{Proof.} First we notice that, by the definition of the sequence, a multiple of 3 is always followed by another multiple of 3. If \( a_n \in \{3, 6, 9\} \) the sequence will eventually follow the periodic pattern \( 3, 6, 9, 3, 6, 9, \dots \). If \( a_n \in \{3, 6, 9\} \), let \( j \) be an index such that \( a_j \) is equal to the minimum value of the set \( \{a_{n+1}, a_{n+2}, \dots \} \). We must have \( a_j \leq 9 \), otherwise we could apply Claim 2 to \( a_j \) and get a contradiction on the minimality hypothesis. It follows that \( a_j \in \{3, 6, 9\} \), and the proof is complete.

\textbf{Claim 4.} If \( a_n \equiv 1 \pmod{3} \), then there is an index \( m > n \) such that \( a_m = -1 \pmod{3} \).

\textbf{Proof.} In the sequence, 4 is always followed by 2 as \( -1 \pmod{3} \), so the claim is true for \( a_n = 4 \). If \( a_n = 7 \), the next terms will be 10, 13, 16, 4, 2, \dots and the claim is also true. For \( a_n > 10 \), we again take an index \( j > n \) such that \( a_j \) is equal to the minimum value of the set \( \{a_{n+1}, a_{n+2}, \dots \} \), by which the definition of the sequence consists of non-multiples of 3. Suppose \( a_j \equiv 1 \pmod{3} \). Then we must have \( a_j \leq 9 \) by Claim 2 and the minimality of \( a_j \). It follows that \( a_j \in \{4, 7\} \), so \( a_m = 2 < a_j \) for some \( m > j \), contradicting the minimality of \( a_j \). Therefore, we must have \( a_j = -1 \pmod{3} \).

It follows from the previous claims that if \( a_0 \) is a multiple of 3 the sequence will eventually reach the periodic pattern \( 3, 6, 9, 3, 6, 9, \dots \); if \( a_0 \equiv -1 \pmod{3} \) the sequence will be strictly increasing; and if \( a_0 \equiv 1 \pmod{3} \) the sequence will be eventually strictly increasing.

So the sequence will be eventually periodic if, and only if, \( a_0 \) is a multiple of 3. The largest value which less than \(1000\) is \(999\).
",999,number theory
2017n4,"Call a rational number short if it has finitely many digits in its decimal expansion. For a positive integer \( m \), we say that a positive integer \( t \) is \( m \)-tastic if there exists a number \( c \in \{1, 2, 3, \dots, 2017\} \) such that \( \frac{10^t - 1}{c \cdot m} \) is short, and such that \( \frac{10^k - 1}{c \cdot m} \) is not short for any \( 1 \leq k < t \). Let \( S(m) \) be the set of \( m \)-tastic numbers. Consider \( S(m) \) for \( m = 1, 2, \dots \). What is the maximum number of elements in \( S(m) \)?
","First notice that \( x \in \mathbb{Q} \) is short if and only if there are exponents \( a, b \geq 0 \) such that \( 2^a \cdot 5^b \cdot x \in \mathbb{Z} \). In fact, if \( x \) is short, then \( x = \frac{n}{10^k} \) for some \( k \) and we can take \( a = b = k \); on the other hand, if \( 2^a \cdot 5^b \cdot x = q \in \mathbb{Z} \) then \( x = \frac{2^b \cdot 5^a \cdot q}{10^{a+b}} \), so \( x \) is short.

If \( m = 2^a \cdot 5^b \cdot s \), with \( \gcd(s, 10) = 1 \), then \( \frac{10^t - 1}{m} \) is short if and only if \( s \mid (10^t - 1) \). So we may (and will) suppose without loss of generality that \( \gcd(m, 10) = 1 \). Define
\[
C = \{ 1 \leq c \leq 2017 : \gcd(c, 10) = 1 \}.
\]

The \( m \)-tastic numbers are then precisely the smallest exponents \( t > 0 \) such that \( 10^t \equiv 1 \pmod{cm} \) for some integer \( c \in C \), that is, the set of orders of 10 modulo \( cm \). In other words,
\[
S(m) = \{ \text{ord}_{cm}(10) : c \in C \}.
\]

Since there are \( 4 \cdot 201 + 3 = 807 \) numbers \( c \) with \( 1 \leq c \leq 2017 \) and \( \gcd(c, 10) = 1 \), namely those such that \( c \equiv 1, 3, 7, 9 \pmod{10} \),
\[
|S(m)| \leq |C| = 807.
\]

Now we find \( m \) such that \( |S(m)| = 807 \). Let
\[
P = \{ 1 < p \leq 2017 : p \text{ is prime},\ p \neq 2, 5 \}
\]
and choose a positive integer \( \alpha \) such that every \( p \in P \) divides \( 10^\alpha - 1 \) (e.g. \( \alpha = \varphi(T) \), \( T \) being the product of all primes in \( P \)), and let \( m = 10^\alpha - 1 \).

\textbf{Claim.} For every \( c \in C \), we have
\[
\text{ord}_{cm}(10) = c\alpha.
\]

As an immediate consequence, this implies \( |S(m)| = |C| = 807 \), finishing the problem.

\textbf{Proof.} Obviously \( \text{ord}_{cm}(10) = \alpha \). Let \( t = \text{ord}_{cm}(10) \). Then
\[
cm \mid 10^t - 1 \Rightarrow m \mid 10^t - 1 \Rightarrow \alpha \mid t.
\]
Hence \( t = k\alpha \) for some \( k \in \mathbb{Z}_{>0} \). We will show that \( k = c \).

Denote by \( \nu_p(n) \) the number of prime factors \( p \) in \( n \), that is, the maximum exponent \( \beta \) for which \( p^\beta \mid n \). For every \( \ell \geq 1 \) and \( p \in P \), the Lifting the Exponent Lemma provides
\[
\nu_p(10^{k\alpha} - 1) = \nu_p((10^\alpha)^k - 1) = \nu_p(10^\alpha - 1) + \nu_p(k),
\]
so
\[
\begin{aligned}
cm \mid 10^{k\alpha} - 1 &\iff \forall p \in P,\ \nu_p(cm) \leq \nu_p(10^{k\alpha} - 1) \\
&\iff \forall p \in P,\ \nu_p(m) + \nu_p(c) \leq \nu_p(m) + \nu_p(k) \\
&\iff \forall p \in P,\ \nu_p(c) \leq \nu_p(k) \\
&\Rightarrow c \mid k.
\end{aligned}
\]
The first such \( k \) is \( k = c \), so \( \text{ord}_{cm}(10) = c\alpha \). \qed
So the answer is \(807\).",807,number theory
2017n5,"Find all pairs \( (p, q) \) of prime numbers with \( p > q \) for which the number
\[
\frac{(p + q)^{p + q}(p - q)^{p - q} - 1}{(p + q)^{p - q}(p - q)^{p + q} - 1}
\]
is an integer. Calculate the sum of the quantity \[ (p+q) \] over every such pair.","Let \( M = (p + q)^{p - q}(p - q)^{p + q} - 1 \), which is relatively prime with both \( p + q \) and \( p - q \). Denote by \( (p - q)^{-1} \) the multiplicative inverse of \( (p - q) \) modulo \( M \).

By eliminating the term \( -1 \) in the numerator,
\[
(p + q)^{p + q}(p - q)^{p - q} - 1 \equiv (p + q)^{p - q}(p - q)^{p + q} - 1 \pmod{M}
\]
\[
(p + q)^{2q} \equiv (p - q)^{2q} \pmod{M} \tag{1}
\]
\[
\left( (p + q) \cdot (p - q)^{-1} \right)^{2q} \equiv 1 \pmod{M}. \tag{2}
\]

\textbf{Case 1:} \( q \geq 5 \).

Consider an arbitrary prime divisor \( r \) of \( M \). Notice that \( M \) is odd, so \( r \geq 3 \). By (2), the multiplicative order of \( \left( (p + q) \cdot (p - q)^{-1} \right) \mod r \) is a divisor of the exponent \( 2q \) in (2), so it can be 1, 2, \( q \), or \( 2q \).

By Fermat’s theorem, the order divides \( r - 1 \). So, if the order is \( q \) or \( 2q \), then \( r \equiv 1 \pmod{q} \). If the order is 1 or 2, then \( r \mid (p + q)^2 - (p - q)^2 = 4pq \), so \( r = p \) or \( r = q \). The case \( r = p \) is not possible, because, by applying Fermat’s theorem,
\[
M = (p + q)^{p - q}(p - q)^{p + q} - 1 \equiv (q^2)^p - 1 \equiv q^2 - 1 \equiv (q + 1)(q - 1) \pmod{p}
\]
and the last factors \( q - 1 \) and \( q + 1 \) are less than \( p \) and thus \( p \nmid M \). Hence, all prime divisors of \( M \) are either \( q \) or of the form \( kq + 1 \); it follows that all positive divisors of \( M \) are congruent to 0 or 1 modulo \( q \).

Now notice that
\[
M = \left( (p + q)^{\frac{p - q}{2}}(p - q)^{\frac{p + q}{2}} - 1 \right) \left( (p + q)^{\frac{p - q}{2}}(p - q)^{\frac{p + q}{2}} + 1 \right)
\]
is the product of two consecutive positive odd numbers; both should be congruent to 0 or 1 modulo \( q \). But this is impossible by the assumption \( q \geq 5 \). So, there is no solution in Case 1.

\textbf{Case 2:} \( q = 2 \).

By (1), we have \( M \mid (p + q)^{2q} - (p - q)^{2q} = (p + 2)^4 - (p - 2)^4 \), so
\[
(p + 2)^{p - 2}(p - 2)^{p + 2} - 1 = M \leq (p + 2)^4 - (p - 2)^4 \leq (p + 2)^4 - 1,
\]
\[
(p + 2)^{p - 6}(p - 2)^{p + 2} \leq 1.
\]

If \( p \geq 7 \), then the left-hand side is obviously greater than 1. For \( p = 5 \), we have
\[
(p + 2)^{p - 6}(p - 2)^{p + 2} = 7^{-1} \cdot 3^7
\]
which is also too large.

There remains only one candidate, \( p = 3 \), which provides a solution:
\[
\frac{(p + q)^{p + q}(p - q)^{p - q} - 1}{(p + q)^{p - q}(p - q)^{p + q} - 1} = \frac{5^6 \cdot 1^1 - 1}{5^1 \cdot 1^5 - 1} = \frac{3124}{4} = 781.
\]

So in Case 2 the only solution is \( (p, q) = (3, 2) \).
\textit{Case 3:} \( q = 3 \).

Similarly to Case 2, we have
\[
M \mid (p + q)^{2q} - (p - q)^{2q} = 64 \cdot \left( \left( \frac{p + 3}{2} \right)^6 - \left( \frac{p - 3}{2} \right)^6 \right).
\]

Since \( M \) is odd, we conclude that
\[
M \mid \left( \frac{p + 3}{2} \right)^6 - \left( \frac{p - 3}{2} \right)^6
\]
and
\[
(p + 3)^{p - 3}(p - 3)^{p + 3} - 1 = M \leq \left( \frac{p + 3}{2} \right)^6 - \left( \frac{p - 3}{2} \right)^6 \leq \left( \frac{p + 3}{2} \right)^6 - 1,
\]
\[
64(p + 3)^{p - 9}(p - 3)^{p + 3} \leq 1.
\]

If \( p \geq 11 \), then the left-hand side is obviously greater than 1. If \( p = 7 \), then the left-hand side is 
\[
64 \cdot 10^{-2} \cdot 4^{10} > 1.
\]
If \( p = 5 \), then the left-hand side is 
\[
64 \cdot 8^{-4} \cdot 2^8 = 2^2 > 1.
\]
Therefore, there is no solution in Case 3.

So the sum is \(5\).",5,number theory
2017n6,"Find the smallest positive integer \( n \), or show that no such \( n \) exists, with the following property: there are infinitely many distinct \( n \)-tuples of positive rational numbers \( (a_1, a_2, \dots, a_n) \) such that both
\[
a_1 + a_2 + \cdots + a_n \quad \text{and} \quad \frac{1}{a_1} + \frac{1}{a_2} + \cdots + \frac{1}{a_n}
\]
are integers.
","Call the \( n \)-tuples \( (a_1, a_2, \dots, a_n) \in \mathbb{Q}_{>0}^n \) satisfying the conditions of the problem statement \textit{good}, and those for which
\[
f(a_1, \dots, a_n) \overset{\text{def}}{=} (a_1 + a_2 + \cdots + a_n) \left( \frac{1}{a_1} + \frac{1}{a_2} + \cdots + \frac{1}{a_n} \right)
\]
is an integer \textit{pretty}. Then good \( n \)-tuples are pretty, and if \( (b_1, \dots, b_n) \) is pretty then
\[
\left( \frac{b_1}{b_1 + b_2 + \cdots + b_n}, \frac{b_2}{b_1 + b_2 + \cdots + b_n}, \dots, \frac{b_n}{b_1 + b_2 + \cdots + b_n} \right)
\]
is good since the sum of its components is 1, and the sum of the reciprocals of its components equals \( f(b_1, \dots, b_n) \). We declare pretty \( n \)-tuples proportional to each other \textit{equivalent} since they are precisely those which give rise to the same good \( n \)-tuple. Clearly, each such equivalence class contains exactly one \( n \)-tuple of positive integers having no common prime divisors. Call such \( n \)-tuple a \textit{primitive pretty} tuple. Our task is to find infinitely many primitive pretty \( n \)-tuples.

Now we construct infinitely many primitive pretty triples for \( n = 3 \). Fix \( b, c, k \in \mathbb{Z}_{>0} \); we will try to find sufficient conditions for the existence of an \( a \in \mathbb{Q}_{>0} \) such that \( f(a, b, c) = k \). Write \( \sigma = b + c, \ \tau = bc \). From \( f(a, b, c) = k \), we have that \( a \) should satisfy the quadratic equation
\[
a^2 \cdot \sigma + a \cdot (\sigma^2 - (k - 1)\tau) + \sigma \tau = 0 \tag{1}
\]
whose discriminant is
\[
\Delta = (\sigma^2 - (k - 1)\tau)^2 - 4\sigma^2 \tau = ((k + 1)\tau - \sigma^2)^2 - 4k\tau^2.
\]
We need it to be a square of an integer, say, \( \Delta = M^2 \) for some \( M \in \mathbb{Z} \), i.e., we want
\[
((k + 1)\tau - \sigma^2)^2 - M^2 = 2k \cdot 2\tau^2
\]
so that it suffices to set
\[
(k + 1)\tau - \sigma^2 = \tau^2 + k, \quad M = \tau^2 - k.
\]
The first relation reads \( \sigma^2 = (\tau - 1)(k - \tau) \), so if \( b \) and \( c \) satisfy
\[
\tau - 1 \mid \sigma^2 \quad \text{i.e.} \quad bc - 1 \mid (b + c)^2 \tag{2}
\]
then \( k = \frac{\sigma^2}{\tau - 1} + \tau \) will be integral, and we find rational solutions to (1), namely
\[
a = \frac{\sigma}{\tau - 1} = \frac{b + c}{bc - 1} \quad \text{or} \quad a = \frac{\tau^2 - \tau}{\sigma} = \frac{bc \cdot (bc - 1)}{b + c}.
\]

We can now find infinitely many pairs \( (b, c) \) satisfying (2) by Vieta jumping. For example, if we impose
\[
(b + c)^2 = 5 \cdot (bc - 1)
\]
then all pairs \( (b, c) = (v_i, v_{i+1}) \) satisfy the above condition, where
\[
v_1 = 2, \quad v_2 = 3, \quad v_{i+2} = 3v_{i+1} - v_i \quad \text{for } i \geq 0.
\]

For \( (b, c) = (v_i, v_{i+1}) \), one of the solutions to (1) will be \( a = \frac{(b + c)}{(bc - 1)} = \frac{5}{(b + c)} = \frac{5}{(v_i + v_{i+1})} \). Then the pretty triple \( (a, b, c) \) will be equivalent to the integral pretty triple
\[
\left(5, v_i(v_i + v_{i+1}), v_{i+1}(v_i + v_{i+1})\right)
\]

After possibly dividing by 5, we obtain infinitely many primitive pretty triples, as required.
",3,number theory
2016a1,"Find the smallest real constant \( C \) such that for any positive real numbers \( a_1, a_2, a_3, a_4 \) and \( a_5 \) (not necessarily distinct), one can always choose distinct subscripts \( i, j, k \) and \( l \) such that
\[
\left| \frac{a_i}{a_j} - \frac{a_k}{a_l} \right| \leq C. \tag{1}
\]
Give the value of \(210C\).","\textbf{Solution.} We first show that \( C \leq \frac{1}{2} \). For any positive real numbers \( a_1 \leq a_2 \leq a_3 \leq a_4 \leq a_5 \), consider the five fractions
\[
\frac{a_1}{a_2}, \quad \frac{a_3}{a_4}, \quad \frac{a_1}{a_5}, \quad \frac{a_2}{a_3}, \quad \frac{a_4}{a_5}. \tag{2}
\]
Each of them lies in the interval \( (0, 1] \). Therefore, by the Pigeonhole Principle, at least three of them must lie in \( (0, \tfrac{1}{2}] \) or lie in \( (\tfrac{1}{2}, 1] \) simultaneously. In particular, there must be two consecutive terms in (2) which belong to an interval of length \( \tfrac{1}{2} \) (here, we regard \( \frac{a_1}{a_2} \) and \( \frac{a_4}{a_5} \) as consecutive). In other words, the difference of these two fractions is less than \( \tfrac{1}{2} \). As the indices involved in these two fractions are distinct, we can choose them to be \( i, j, k, l \) and conclude that \( C \leq \tfrac{1}{2} \).

Next, we show that \( C = \tfrac{1}{2} \) is best possible. Consider the numbers \( 1, 2, 2, 2, n \) where \( n \) is a large real number. The fractions formed by two of these numbers in ascending order are
\[
\frac{1}{n}, \frac{1}{2}, \frac{2}{2}, \frac{2}{1}, \frac{n}{2}, \frac{n}{1}.
\]
Since the indices \( i, j, k, l \) are distinct, \( \frac{1}{n} \) and \( \frac{2}{n} \) cannot be chosen simultaneously. Therefore the minimum value of the left-hand side of (1) is \( \tfrac{1}{2} - \tfrac{2}{n} \). When \( n \) tends to infinity, this value approaches \( \tfrac{1}{2} \), and so \( C \) cannot be less than \( \tfrac{1}{2} \).

These conclude that \( C = \tfrac{1}{2} \) is the smallest possible choice.

\textbf{Comment.} The conclusion still holds if \( a_1, a_2, \dots, a_5 \) are pairwise distinct, since in the construction, we may replace the 2's by real numbers sufficiently close to 2.

There are two possible simplifications for this problem:
\begin{itemize}
  \item[(i)] the answer \( C = \tfrac{1}{2} \) is given to the contestants; or
  \item[(ii)] simply ask the contestants to prove the inequality (1) for \( C = \tfrac{1}{2} \).
\end{itemize}

So the value of \(210C\) is \(105\).",105,algebra
2016a3,"Find all integers \( n \geq 3 \) with the following property: for all real numbers \( a_1, a_2, \dots, a_n \) and \( b_1, b_2, \dots, b_n \) satisfying \( |a_k| + |b_k| = 1 \) for \( 1 \leq k \leq n \), there exist \( x_1, x_2, \dots, x_n \), each of which is either \( -1 \) or \( 1 \), such that
\[
\left| \sum_{k=1}^n x_k a_k \right| + \left| \sum_{k=1}^n x_k b_k \right| \leq 1. \tag{1}
\]
Give the largest \(n\) that less than \(100\).","For any even integer \( n \geq 4 \), we consider the case
\[
a_1 = a_2 = \cdots = a_{n-1} = b_n = 0 \quad \text{and} \quad b_1 = b_2 = \cdots = b_{n-1} = a_n = 1.
\]
The condition \( |a_k| + |b_k| = 1 \) is satisfied for each \( 1 \leq k \leq n \). No matter how we choose each \( x_k \), both sums \( \sum_{k=1}^n x_k a_k \) and \( \sum_{k=1}^n x_k b_k \) are odd integers. This implies \( |\sum_{k=1}^n x_k a_k| \geq 1 \) and \( |\sum_{k=1}^n x_k b_k| \geq 1 \), which shows (1) cannot hold.

For any odd integer \( n \geq 3 \), we may assume without loss of generality \( b_k \geq 0 \) for \( 1 \leq k \leq n \) (this can be done by flipping the pair \( (a_k, b_k) \) to \( (-a_k, -b_k) \) and \( x_k \) to \( -x_k \) if necessary) and \( a_1 \geq a_2 \geq \cdots \geq a_m > 0 > a_{m+1} \geq \cdots \geq a_n \). We claim that the choice \( x_k = (-1)^{k+1} \) for \( 1 \leq k \leq n \) will work. Define
\[
s = \sum_{k=1}^m x_k a_k \quad \text{and} \quad t = -\sum_{k=m+1}^n x_k a_k.
\]

Note that
\[
s = (a_1 - a_2) + (a_3 - a_4) + \cdots \geq 0
\]
by the assumption \( a_1 \geq a_2 \geq \cdots \geq a_m \) (when \( m \) is odd, there is a single term \( a_m \) at the end, which is also positive). Next, we have
\[
s = a_1 - (a_2 - a_3) - (a_4 - a_5) - \cdots \leq a_1 \leq 1.
\]

Similarly,
\[
t = (-a_n + a_{n-1}) + (-a_{n-2} + a_{n-3}) + \cdots \geq 0
\]
and
\[
t = -a_n + (a_{n-1} - a_{n-2}) + (a_{n-3} - a_{n-4}) + \cdots \leq -a_n \leq 1.
\]

From the condition, we have \( a_k + b_k = 1 \) for \( 1 \leq k \leq m \) and \( -a_k + b_k = 1 \) for \( m+1 \leq k \leq n \). It follows that \( \sum_{k=1}^n x_k a_k = s - t \) and \( \sum_{k=1}^n x_k b_k = 1 - s - t \). Hence it remains to prove
\[
|s - t| + |1 - s - t| \leq 1
\]
under the constraint \( 0 \leq s, t \leq 1 \). By symmetry, we may assume \( s \geq t \). If \( 1 - s - t \geq 0 \), then we have
\[
|s - t| + |1 - s - t| = s - t + 1 - s - t = 1 - 2t \leq 1.
\]
If \( 1 - s - t \leq 0 \), then we have
\[
|s - t| + |1 - s - t| = s - t - 1 + s + t = 2s - 1 \leq 1.
\]

Hence, the inequality is true in both cases. These show \( n \) can be any odd integer greater than or equal to 3.
So the largest \(n\) that less than \(100\) is \(99\).",99,algebra
2016a4,"Denote by \( \mathbb{R}^+ \) the set of all positive real numbers. Find all functions \( f : \mathbb{R}^+ \to \mathbb{R}^+ \) such that
\[
x f(x^2) f(f(y)) + f(y f(x)) = f(xy) \left( f(f(x^2)) + f(f(y^2)) \right) \tag{1}
\]
for all positive real numbers \( x \) and \( y \). Give the value of \( \frac{1}{f(100)} \)
","Taking \( x = y = 1 \) in (1), we get \( f(1)f(f(1)) + f(f(1)) = 2f(1)f(f(1)) \) and hence \( f(1) = 1 \). Swapping \( x \) and \( y \) in (1) and comparing with (1) again, we find
\[
x f(x^2) f(f(y)) + f(y f(x)) = y f(y^2) f(f(x)) + f(x f(y)). \tag{2}
\]
Taking \( y = 1 \) in (2), we have \( x f(x^2) + f(f(x)) = f(f(x)) + f(x) \), that is,
\[
f(x^2) = \frac{f(x)}{x}. \tag{3}
\]

Take \( y = 1 \) in (1) and apply (3) to \( x f(x^2) \). We get \( f(x) + f(f(x)) = f(x)(f(f(x^2)) + 1) \), which implies
\[
f(f(x^2)) = \frac{f(f(x))}{f(x)}. \tag{4}
\]

For any \( x \in \mathbb{R}^+ \), we find that
\[
f(f(x)^2) \overset{(3)}{=} \frac{f(f(x))}{f(x)} \overset{(4)}{=} f(f(x^2)) \overset{(3)}{=} f\left( \frac{f(x)}{x} \right). \tag{5}
\]

It remains to show the following key step.

\textbf{Claim.} The function \( f \) is injective.

\textit{Proof.} Using (3) and (4), we rewrite (1) as
\[
f(x)f(f(y)) + f(yf(x)) = f(xy)\left( \frac{f(f(x))}{f(x)} + \frac{f(f(y))}{f(y)} \right). \tag{6}
\]
Take \( x = y \) in (6) and apply (3). This gives \( f(x)f(f(x)) + f(xf(x)) = 2 \frac{f(f(x))}{x} \), which means
\[
f(xf(x)) = f(f(x))\left( \frac{2}{x} - f(x) \right). \tag{7}
\]

Using (3), equation (2) can be rewritten as
\[
f(x)f(f(y)) + f(yf(x)) = f(y)f(f(x)) + f(xf(y)). \tag{8}
\]

Suppose \( f(x) = f(y) \) for some \( x, y \in \mathbb{R}^+ \). Then (8) implies
\[
f(yf(y)) = f(yf(x)) = f(xf(y)) = f(xf(x)).
\]
Using (7), this gives
\[
f(f(y))\left( \frac{2}{y} - f(y) \right) = f(f(x))\left( \frac{2}{x} - f(x) \right).
\]
Noting \( f(x) = f(y) \), we find \( x = y \). This establishes the injectivity. \qed

By the Claim and (5), we get the only possible solution \( f(x) = \frac{1}{x} \). It suffices to check that this is a solution. Indeed, the left-hand side of (1) becomes
\[
x \cdot \frac{1}{x^2} \cdot \frac{1}{y} + \frac{x}{y} = \frac{y}{x} + \frac{x}{y},
\]
while the right-hand side becomes
\[
\frac{1}{xy}(x^2 + y^2) = \frac{x}{y} + \frac{y}{x}.
\]
The two sides agree with each other.
So \( f(x) = \frac{1}{x} \) for any \( x \in \mathbb{R}^+ \). The value of \( \frac{1}{f(100)} \) is \(100\).
",100,algebra
2016a6,"The equation
\[
(x - 1)(x - 2)\cdots(x - 2016) = (x - 1)(x - 2)\cdots(x - 2016)
\]
is written on the board. One tries to erase some linear factors from both sides so that each side still has at least one factor, and the resulting equation has no real roots. Find the least number of linear factors one needs to erase to achieve this.","Since there are 2016 common linear factors on both sides, we need to erase at least 2016 factors. We claim that the equation has no real roots if we erase all factors \( (x - k) \) on the left-hand side with \( k \equiv 2, 3 \pmod{4} \), and all factors \( (x - m) \) on the right-hand side with \( m \equiv 0, 1 \pmod{4} \). Therefore, it suffices to show that no real number \( x \) satisfies
\[
\prod_{j=0}^{503} (x - 4j - 1)(x - 4j - 4) = \prod_{j=0}^{503} (x - 4j - 2)(x - 4j - 3). \tag{1}
\]

\begin{itemize}
\item \textbf{Case 1.} \( x = 1, 2, \dots, 2016 \). \\
In this case, one side of (1) is zero while the other side is not. This shows \( x \) cannot satisfy (1).

\item \textbf{Case 2.} \( 4k + 1 < x < 4k + 2 \) or \( 4k + 3 < x < 4k + 4 \) for some \( k = 0, 1, \dots, 503 \). \\
For \( j = 0, 1, \dots, 503 \) with \( j \neq k \), the product \( (x - 4j - 1)(x - 4j - 4) \) is positive. For \( j = k \), the product \( (x - 4k - 1)(x - 4k - 4) \) is negative. This shows the left-hand side of (1) is negative. On the other hand, each product \( (x - 4j - 2)(x - 4j - 3) \) on the right-hand side of (1) is positive. This yields a contradiction.

\item \textbf{Case 3.} \( x < 1 \) or \( x > 2016 \) or \( 4k < x < 4k + 1 \) for some \( k = 1, 2, \dots, 503 \). \\
The equation (1) can be rewritten as
\[
1 = \prod_{j=0}^{503} \frac{(x - 4j - 1)(x - 4j - 4)}{(x - 4j - 2)(x - 4j - 3)} = \prod_{j=0}^{503} \left( 1 - \frac{2}{(x - 4j - 2)(x - 4j - 3)} \right).
\]
Note that \( (x - 4j - 2)(x - 4j - 3) > 2 \) for \( 0 \leq j \leq 503 \) in this case. So each term in the product lies strictly between 0 and 1, and the whole product must be less than 1, which is impossible.

\item \textbf{Case 4.} \( 4k + 2 < x < 4k + 3 \) for some \( k = 0, 1, \dots, 503 \). \\
This time we rewrite (1) as
\[
1 = \frac{x - 1}{x - 2} \cdot \frac{x - 2016}{x - 2015} \prod_{j=1}^{503} \frac{(x - 4j)(x - 4j - 1)}{(x - 4j + 1)(x - 4j - 2)},
\]
\[
= \frac{x - 1}{x - 2} \cdot \frac{x - 2016}{x - 2015} \prod_{j=1}^{503} \left( 1 + \frac{2}{(x - 4j + 1)(x - 4j - 2)} \right).
\]
Clearly, \( \frac{x - 1}{x - 2} \) and \( \frac{x - 2016}{x - 2015} \) are both greater than 1. For the range of \( x \) in this case, each term in the product is also greater than 1. Then the right-hand side must be greater than 1 and hence a contradiction arises.
\end{itemize}

From the four cases, we conclude that (1) has no real roots. Hence, the minimum number of linear factors to be erased is \( \boxed{2016} \).
",2016,algebra
2016a7,"Denote by \( \mathbb{R} \) the set of all real numbers. Find all functions \( f : \mathbb{R} \to \mathbb{R} \) such that \( f(0) \neq 0 \) and
\[
f(x + y)^2 = 2f(x)f(y) + \max \left\{ f(x^2) + f(y^2), f(x^2 + y^2) \right\} \tag{1}
\]
for all real numbers \( x \) and \( y \).
If \(f(1)=0\), what is the value of \(f(2016)\)?","Taking \( x = y = 0 \) in (1), we get \( f(0)^2 = 2f(0)^2 + \max\{f(0), f(0)\} \). If \( f(0) > 0 \), then \( f(0)^2 + 2f(0) = 0 \) gives no positive solution. If \( f(0) < 0 \), then \( f(0)^2 + f(0) = 0 \) gives \( f(0) = 0 \) or \( f(0) = -1 \). Putting \( y = 0 \) in (1), we have \( f(x)^2 = -2f(x) + f(x^2) \), which is the same as \( (f(x)+1)^2 = f(x^2) + 1 \). Let \( g(x) = f(x) + 1 \). Then for any \( x \in \mathbb{R} \), we have
\[
g(x^2) = g(x)^2 \geq 0. \tag{2}
\]

From (1), we find that \( f(x+y)^2 \geq 2f(x)f(y) + f(x^2) + f(y^2) \). In terms of \( g \), this becomes
\[
(g(x+y)-1)^2 \geq 2(g(x)-1)(g(y)-1) + g(x^2) + g(y^2) - 2.
\]
Using (2), this means
\[
(g(x+y)-1)^2 \geq (g(x)+g(y)-1)^2 - 1. \tag{3}
\]

Putting \( x = 1 \) in (2), we get \( g(1) = 0 \) or 1. The two cases are handled separately.

\begin{itemize}
\item \textbf{Case 1.} \( g(1) = 0 \), which is the same as \( f(1) = -1 \).

We put \( x = -1 \) and \( y = 0 \) in (1). This gives \( f(-1)^2 = -2f(-1) - 1 \), which forces \( f(-1) = -1 \). Next, we take \( x = -1 \) and \( y = 1 \) in (1) to get \( 1 = 2 + \max\{-2, f(2)\} \). This clearly implies \( 1 = 2 + f(2) \) and hence \( f(2) = -1 \), that is, \( g(2) = 0 \). From (2), we can prove inductively that \( g(2^{2^n}) = g(2)^{2^n} = 0 \) for any \( n \in \mathbb{N} \). Substitute \( y = 2^{2^n} - x \) in (3), we obtain
\[
(g(x) + g(2^{2^n} - x) - 1)^2 \leq (g(2^{2^n}) - 1)^2 + 1 = 2.
\]
For any fixed \( x \geq 0 \), we consider \( n \) to be sufficiently large so that \( 2^{2^n} - x > 0 \). From (2), this implies \( g(2^{2^n} - x) \geq 0 \) so that \( g(x) < 1 + \sqrt{2} \). Using (2) again, we get
\[
g(x)^{2^n} = g(2^{2^n}) \leq 1 + \sqrt{2}
\]
for any \( n \in \mathbb{N} \). Therefore, \( |g(x)| \leq 1 \) for any \( x \geq 0 \).

If there exists \( a \in \mathbb{R} \) for which \( g(a) \neq 0 \), then for sufficiently large \( n \) we must have
\[
g((a^2)^{2^n}) = g(a^2)^{2^n} > \tfrac{1}{2}.
\]
By taking \( x = -y = -(a^2)^{2^{n-1}} \) in (1), we obtain
\[
1 = 2f(x)f(-x) + \max\{2f(x^2), f(2x^2)\}
\]
\[
= 2(g(x)-1)(g(-x)-1) + \max\{2(g(x^2)-1), g(2x^2)-1\}
\]
\[
\leq 2\left( -\frac{1}{2} \right)^2 + \left( -\frac{1}{2} \right)^2 + 0 = \frac{1}{2}
\]
since \( |g(-x)| = |g(x)| < \tfrac{1}{2} \) by (2) and the choice of \( x \), and since \( g(2x^2) \leq 1 \) for \( x \geq 0 \). This yields a contradiction and hence \( g(x) = 0 \) must hold for any \( x \). This means \( f(x) = -1 \) for any \( x \in \mathbb{R} \), which clearly satisfies (1).

\item \textbf{Case 2.} \( g(1) = 1 \), which is the same as \( f(1) = 0 \).

We put \( x = -1 \) and \( y = 1 \) in (1) to get \( 1 = \max\{0, f(2)\} \). This clearly implies \( f(2) = 1 \), and hence \( g(2) = 2 \). Setting \( x = 2n \) and \( y = 2 \) in (3), we have
\[
(g(2n+2)-1)^2 \geq (g(2n)+1)^2 - 1.
\]
By induction on \( n \), it is easy to prove that \( g(2n) \geq n + 1 \) for all \( n \in \mathbb{N} \). For any real number \( a > 1 \), we choose a large \( n \in \mathbb{N} \) and take \( k \) to be the positive integer such that \( 2k \leq a^{2^n} < 2k + 2 \). From (2) and (3), we have
\[
(g(a)^{2^n} - 1)^2 + 1 = (g(a^{2^n}) - 1)^2 + 1 \geq (g(2k) + g(a^{2^n} - 2k) - 1)^2 \geq k^2 > \frac{1}{4}(a^{2^n} - 2)^2
\]
since \( g(a^{2^n} - 2k) \geq 0 \). For large \( n \), this clearly implies \( g(a)^{2^n} > 1 \). Thus,
\[
g(a)^{2^n} > \frac{1}{2}(a^{2^n} - 2). \tag{4}
\]
Note that
\[
\frac{a^n}{a^{2^n} - 2} = 1 + \frac{2}{a^{2^n} - 2} < \left( 1 + \frac{2}{2^n(a^2 - 2)} \right)^{2^n}
\]
by binomial expansion. This can be rewritten as
\[
(a^{2^n} - 2)^{\frac{1}{2^n}} > \frac{a}{1 + \frac{2}{2^n(a^2 - 2)}}.
\]
Together with (4), we conclude \( g(a) \geq a \) by taking \( n \) sufficiently large.

Consider \( x = na \) and \( y = a > 1 \) in (3). This gives \( (g((n+1)a) - 1)^2 \geq (g(na) + g(a) - 1)^2 - 1 \). By induction on \( n \), it is easy to show \( g(na) \geq (n-1)(g(a)-1) + a \) for any \( n \in \mathbb{N} \). We choose a large \( n \in \mathbb{N} \) and take \( k \) to be the positive integer such that \( ka \leq 2^{2^n} < (k+1)a \). Using (2) and (3), we have
\[
2^{2^n+1} > (2^{2^n} - 1)^2 + 1 = (g(2^{2^n}) - 1)^2 + 1 \geq (g(2^{2^n} - ka) + g(ka) - 1)^2 \geq ((k-1)(g(a)-1) + a - 1)^2,
\]
from which it follows that
\[
2^{2^n} \geq (k-1)(g(a)-1) + a - 1 > \frac{2^{2^n}}{a}(g(a)-1) - 2(g(a)-1) + a - 1
\]
holds for sufficiently large \( n \). Hence, we must have \( \frac{g(a)-1}{a} < 1 \), which implies \( g(a) < a + 1 \) for any \( a > 1 \). Then for large \( n \in \mathbb{N} \), from (3) and (2) we have
\[
4a^{2^{n+1}} = (2a^{2^n})^2 > (g(a^{2^n}) - 1)^2 = (2g(a)^{2^n} - 1)^2 \geq (g(a)^{2^n} - 1)^2.
\]
This implies
\[
2a^{2^n} > \frac{1}{2}(1 + \sqrt{4a^{2^{n+1}} + 1}) \geq g(a)^{2^n}.
\]
When \( n \) tends to infinity, this forces \( g(a) \leq a \). Together with \( g(a) \geq a \), we get \( g(a) = a \) for all real numbers \( a > 1 \), that is, \( f(a) = a - 1 \) for all \( a > 1 \).

Finally, for any \( x \in \mathbb{R} \), we choose \( y \) sufficiently large in (1) so that \( y, x+y > 1 \). This gives
\[
(x+y-1)^2 = 2f(x)(y-1) + \max\{f(x^2) + y^2 - 1, x^2 + y^2 - 1\},
\]
which can be rewritten as
\[
2(x - 1 - f(x))y = -x^2 + 2x - 2f(x) + \max\{f(x^2), x^2\}.
\]
As the right-hand side is fixed, this can only hold for all large \( y \) when \( f(x) = x - 1 \). We now check that this function satisfies (1). Indeed, we have
\[
f(x+y)^2 = (x+y-1)^2 = 2(x-1)(y-1) + (x^2 + y^2 - 1)
\]
\[
= 2f(x)f(y) + \max\{f(x^2) + f(y^2), f(x^2 + y^2)\}.
\]
\end{itemize}
If \(f(1)=0\), the value of \(f(2016)\) is \(2015\).",2015,algebra
2016a8,"Determine the largest real number \( a \) such that for all \( n \geq 1 \) and for all real numbers \( x_0, x_1, \dots, x_n \) satisfying \( 0 = x_0 < x_1 < x_2 < \cdots < x_n \), we have
\[
\frac{1}{x_1 - x_0} + \frac{1}{x_2 - x_1} + \cdots + \frac{1}{x_n - x_{n-1}} \geq a \left( \frac{2}{x_1} + \frac{3}{x_2} + \cdots + \frac{n+1}{x_n} \right). \tag{1}
\]
Give the value of \(2016a\).","We first show that \( a = \frac{4}{9} \) is admissible. For each \( 2 \leq k \leq n \), by the Cauchy-Schwarz Inequality, we have
\[
(x_{k-1} + (x_k - x_{k-1})) \left( \left( \frac{k - 1}{x_{k-1}} \right)^2 + \left( \frac{3}{x_k - x_{k-1}} \right)^2 \right) \geq (k - 1 + 3)^2,
\]
which can be rewritten as
\[
\frac{9}{x_k - x_{k-1}} \geq \frac{(k + 2)^2}{x_k} - \frac{(k - 1)^2}{x_{k-1}}. \tag{2}
\]
Summing (2) over \( k = 2, 3, \dots, n \) and adding \( \frac{9}{x_1} \) to both sides, we have
\[
9 \sum_{k=1}^{n} \frac{1}{x_k - x_{k-1}} \geq 4 \sum_{k=1}^{n} \frac{k + 1}{x_k} + \frac{n^2}{x_n} \geq 4 \sum_{k=1}^{n} \frac{k + 1}{x_k}.
\]
This shows (1) holds for \( a = \frac{4}{9} \).

Next, we show that \( a = \frac{4}{9} \) is the optimal choice. Consider the sequence defined by \( x_0 = 0 \) and \( x_k = x_{k-1} + k(k + 1) \) for \( k \geq 1 \), that is, \( x_k = \frac{1}{3}k(k + 1)(k + 2) \). Then the left-hand side of (1) equals
\[
\sum_{k=1}^{n} \frac{1}{k(k + 1)} = \sum_{k=1}^{n} \left( \frac{1}{k} - \frac{1}{k + 1} \right) = 1 - \frac{1}{n + 1},
\]
while the right-hand side equals
\[
a \sum_{k=1}^{n} \frac{k + 1}{x_k} = 3a \sum_{k=1}^{n} \frac{1}{k(k + 2)} = \frac{3a}{2} \sum_{k=1}^{n} \left( \frac{1}{k} - \frac{1}{k + 2} \right) = \frac{3a}{2} \left( 1 + \frac{1}{2} - \frac{1}{n + 1} - \frac{1}{n + 2} \right).
\]
When \( n \) tends to infinity, the left-hand side tends to 1 while the right-hand side tends to \( \frac{4}{9}a \). Therefore \( a \) has to be at most \( \frac{4}{9} \). Hence the largest value of \( a \) is \( \frac{4}{9} \).
So the value of \(2016a\) is \(896\).",896,algebra
2016c1,"The leader of an IMO team chooses positive integers \(n\) and \(k\) with \(n > k\), and announces them to the deputy leader and a contestant. The leader then secretly tells the deputy leader an \(n\)-digit binary string, and the deputy leader writes down all \(n\)-digit binary strings which differ from the leader's in exactly \(k\) positions. (For example, if \(n = 3\) and \(k = 1\), and if the leader chooses 101, the deputy leader would write down 001, 111 and 100.) The contestant is allowed to look at the strings written by the deputy leader and guess the leader's string. What is the minimum number of guesses (in terms of \(n\) and \(k\)) needed to guarantee the correct answer when \n = 2k\)?
","Let \( X \) be the binary string chosen by the leader and let \( X' \) be the binary string of length \( n \) every digit of which is different from that of \( X \). The strings written by the deputy leader are the same as those in the case when the leader's string is \( X' \) and \( k \) is changed to \( n - k \). In view of this, we may assume \( k \gg \frac{n}{2} \). Also, for the particular case \( k = \frac{n}{2} \), this argument shows that the strings \( X \) and \( X' \) cannot be distinguished, and hence in that case the contestant has to guess at least twice.

It remains to show that the number of guesses claimed suffices. Consider any string \( Y \) which differs from \( X \) in \( m \) digits where \( 0 < m < 2k \). Without loss of generality, assume the first \( m \) digits of \( X \) and \( Y \) are distinct. Let \( Z \) be the binary string obtained from \( X \) by changing its first \( m \) digits. Then \( Z \) is written by the deputy leader. Note that \( Z \) differs from \( Y \) by \( |m - k| \) digits where \( |m - k| < k \) since \( 0 < m < 2k \). From this observation, the contestant must know that \( Y \) is not the desired string.

As we have assumed \( k \geq \frac{n}{2} \), when \( n < 2k \), every string \( Y \neq X \) differs from \( X \) in fewer than \( 2k \) digits. When \( n = 2k \), every string except \( X \) and \( X' \) differs from \( X \) in fewer than \( 2k \) digits. Hence, the answer is as claimed.
",2,combinatorics
2016c2,"Find all positive integers \( n \) for which all positive divisors of \( n \) can be put into the cells of a rectangular table under the following constraints:

\begin{itemize}
  \item each cell contains a distinct divisor;
  \item the sums of all rows are equal; and
  \item the sums of all columns are equal.
\end{itemize}
","Suppose all positive divisors of \( n \) can be arranged into a rectangular table of size \( k \times l \) where the number of rows \( k \) does not exceed the number of columns \( l \). Let the sum of numbers in each column be \( s \). Since \( n \) belongs to one of the columns, we have \( s \geq n \), where equality holds only when \( n = 1 \).

For \( j = 1, 2, \dots, l \), let \( d_j \) be the largest number in the \( j \)-th column. Without loss of generality, assume \( d_1 > d_2 > \cdots > d_l \). Since these are divisors of \( n \), we have
\[
d_l \leq \frac{n}{l}.
\]
As \( d_l \) is the maximum entry of the \( l \)-th column, we must have
\[
d_l \geq \frac{s}{k} \geq \frac{n}{k}.
\]
The relations (1) and (2) combine to give \( \frac{n}{l} \geq \frac{n}{k} \), that is, \( k \geq l \). Together with \( k \leq l \), we conclude that \( k = l \). Then all inequalities in (1) and (2) are equalities. In particular, \( s = n \) and so \( n = 1 \), in which case the conditions are clearly satisfied.
",1,combinatorics
2016c4,"Find all positive integers \( n \) for which we can fill in the entries of an \( n \times n \) table with the following properties:

\begin{itemize}
  \item each entry can be one of \( I, M \) and \( O \);
  \item in each row and each column, the letters \( I, M \) and \( O \) occur the same number of times; and
  \item in any diagonal whose number of entries is a multiple of three, the letters \( I, M \) and \( O \) occur the same number of times.
\end{itemize}

Give the greatest \(n\) that less than \(100\).","We first show that such a table exists when \( n \) is a multiple of 9. Consider the following \( 9 \times 9 \) table:

\[
\begin{pmatrix}
I & I & M & M & M & O & O & O & O \\
M & M & O & O & O & I & I & I & I \\
O & O & I & I & M & M & O & O & O \\
I & I & M & M & O & O & I & M & M \\
M & M & O & O & I & I & I & O & I \\
O & O & M & M & O & I & M & M & O \\
M & O & I & I & M & M & I & M & M \\
O & M & M & O & I & I & M & M & O \\
O & O & I & I & I & M & M & O & M
\end{pmatrix}
\]

It is a direct checking that the table (1) satisfies the requirements. For \( n = 9k \) where \( k \) is a positive integer, we form an \( n \times n \) table using \( k \times k \) copies of (1). For each row and each column of the table of size \( n \), since there are three I’s, three M’s and three O’s for any nine consecutive entries, the numbers of \( I, M \) and \( O \) are equal. In addition, every diagonal of the large table whose number of entries is divisible by 3 intersects each copy of (1) at a diagonal with number of entries divisible by 3 (possibly zero). Therefore, every such diagonal also contains the same number of \( I, M \) and \( O \).

Next, consider any \( n \times n \) table for which the requirements can be met. As the number of entries of each row should be a multiple of 3, we let \( n = 3k \) where \( k \) is a positive integer. We divide the whole table into \( k \times k \) copies of \( 3 \times 3 \) blocks. We call the entry at the centre of such a \( 3 \times 3 \) square a \textit{vital entry}. We also call any row, column or diagonal that contains at least one vital entry a \textit{vital line}. We compute the number of pairs \( (l, c) \) where \( l \) is a vital line and \( c \) is an entry belonging to \( l \) that contains the letter \( M \). We let this number be \( N \).

On the one hand, since each vital line contains the same number of \( I, M \) and \( O \), it is obvious that each vital row and each vital column contain \( k \) occurrences of \( M \). For vital diagonals in either direction, we count there exactly

\[
1 + 2 + \cdots + (k - 1) + k + (k - 1) + \cdots + 2 + 1 = k^2
\]

occurrences of \( M \). Therefore, we have \( N = 4k^2 \).

On the other hand, there are \( 3k^2 \) occurrences of \( M \) in the whole table. Note that each entry belongs to exactly 1 or 4 vital lines. Therefore, \( N \) must be congruent to \( 3k^2 \mod 3 \).

From the double counting, we get \( 4k^2 \equiv 3k^2 \mod 3 \), which forces \( k \) to be a multiple of 3. Therefore, \( n \) has to be a multiple of 9 and the proof is complete.
So the greatest \(n\) that less than \(100\) is \(99\).",99,combinatorics
2016c5,"Let \( n \geq 3 \) be a positive integer. Find the maximum number of diagonals of a regular \( n \)-gon one can select when \(n=2016\), so that any two of them do not intersect in the interior or they are perpendicular to each other.
","We consider two cases according to the parity of \( n \).

\textbf{Case 1. \( n \) is odd.}
We first claim that no pair of diagonals is perpendicular. Suppose \( A, B, C, D \) are vertices where \( AB \) and \( CD \) are perpendicular, and let \( E \) be the vertex lying on the perpendicular bisector of \( AB \). Let \( E' \) be the opposite point of \( E \) on the circumcircle of the regular polygon. Since \( EC = E'D \) and \( C, D, E \) are vertices of the regular polygon, \( E' \) should also belong to the polygon. This contradicts the fact that a regular polygon with an odd number of vertices does not contain opposite points on the circumcircle.

Therefore in the odd case we can only select diagonals which do not intersect. In the maximal case these diagonals should divide the regular \( n \)-gon into \( n - 2 \) triangles, so we can select at most \( n - 3 \) diagonals. This can be done, for example, by selecting all diagonals emanated from a particular vertex.

\textbf{Case 2. \( n \) is even.}
If there is no intersection, then the proof in the odd case works. Suppose there are two perpendicular diagonals selected. We consider the set \( S \) of all selected diagonals parallel to one of them which intersect with some selected diagonals. Suppose \( S \) contains \( k \) diagonals and the number of distinct endpoints of the \( k \) diagonals is \( l \).

Firstly, consider the longest diagonal in one of the two directions in \( S \). No other diagonal in \( S \) can start from either endpoint of that diagonal, since otherwise it has to meet another longer diagonal in \( S \). The same holds true for the other direction. Ignoring these two longest diagonals and their four endpoints, the remaining \( k - 2 \) diagonals share \( l - 4 \) endpoints where each endpoint can belong to at most two diagonals. This gives \( 2(l - 4) \geq 2(k - 2) \), so that \( k \leq l - 2 \).

Consider a group of consecutive vertices of the regular \( n \)-gon so that each of the two outermost vertices is an endpoint of a diagonal in \( S \), while the interior points are not. There are \( l \) such groups. We label these groups \( P_1, P_2, \dots, P_l \) in this order. We claim that each selected diagonal outside \( S \) must connect vertices of the same group \( P_i \). Consider any diagonal \( d \) joining vertices from distinct groups \( P_i \) and \( P_j \). Let \( d_1 \) and \( d_2 \) be two diagonals in \( S \) each having one of the outer

So the answer is \(2014\).",2014,combinatorics
2016c8,"Let \( n \) be a positive integer. Determine the smallest positive integer \( k \) when \(n=2016\) with the following property: it is possible to mark \( k \) cells on a \( 2n \times 2n \) board so that there exists a unique partition of the board into \( 1 \times 2 \) and \( 2 \times 1 \) dominoes, none of which contains two marked cells.
","We first construct an example of marking \( 2n \) cells satisfying the requirement. Label the rows and columns \( 1, 2, \ldots, 2n \) and label the cell in the \( i \)-th row and the \( j \)-th column \( (i,j) \).

For \( i = 1, 2, \ldots, n \), we mark the cells \( (i,i) \) and \( (i,i+1) \). We claim that the required partition exists and is unique. The two diagonals of the board divide the board into four regions. Note that the domino covering cell \( (1,1) \) must be vertical. This in turn shows that each domino covering \( (2,2), (3,3), \ldots, (n,n) \) is vertical. By induction, the dominoes in the left region are all vertical. By rotational symmetry, the dominoes in the bottom region are horizontal, and so on. This shows that the partition exists and is unique.

It remains to show that this value of \( k \) is the smallest possible. Assume that only \( k < 2n \) cells are marked, and there exists a partition \( P \) satisfying the requirement. It suffices to show there exists another desirable partition distinct from \( P \). Let \( d \) be the main diagonal of the board.

Construct the following graph with edges of two colours. Its vertices are the cells of the board. Connect two vertices with a red edge if they belong to the same domino of \( P \). Connect two vertices with a blue edge if their reflections in \( d \) are connected by a red edge. It is possible that two vertices are connected by edges of both colours. Clearly, each vertex has both red and blue degrees equal to 1. Thus the graph splits into cycles where the colours of edges in each cycle alternate (a cycle may have length 2).

Consider any cell \( c \) lying on the diagonal \( d \). Its two edges are symmetrical with respect to \( d \). Thus they connect \( c \) to different cells. This shows \( c \) belongs to a cycle \( C(c) \) of length at least 4. Consider a part of this cycle \( c_0, c_1, \ldots, c_m \) where \( c_0 = c \) and \( m \) is the least positive integer such that \( c_m \) lies on \( d \). Clearly, \( c_m \) is distinct from \( c \). From the construction, the path symmetrical to this with respect to \( d \) also lies in the graph, and so these paths together form \( C(c) \). Hence, \( C(c) \) contains exactly two cells from \( d \). Then all \( 2n \) cells in \( d \) belong to \( n \) cycles \( C_1, C_2, \ldots, C_n \), each has length at least 4.

By the Pigeonhole Principle, there exists a cycle \( C_i \) containing at most one of the \( k \) marked cells. We modify \( P \) as follows. We remove all dominoes containing the vertices of \( C_i \), which correspond to the red edges of \( C_i \). Then we put the dominoes corresponding to the blue edges of \( C_i \). Since \( C_i \) has at least 4 vertices, the resultant partition \( P' \) is different from \( P \). Clearly, no domino in \( P' \) contains two marked cells as \( C_i \) contains at most one marked cell. This shows the partition is not unique and hence \( k \) cannot be less than \( 2n \).
So the answer is \(4032\) when \(n=2016\).",4032,combinatorics
2016g7,"Let \( I \) be the incentre of a non-equilateral triangle \( ABC \), \( I_A \) be the \( A \)-excentre, \( I_A' \) be the reflection of \( I_A \) in \( BC \), and \( l_A \) be the reflection of line \( AI_A' \) in \( AI \). Define points \( I_B, I_B' \) and line \( l_B \) analogously. Let \( P \) be the intersection point of \( l_A \) and \( l_B \). Let one of the tangents from \( P \) to the incircle of triangle \( ABC \) meet the circumcircle at points \( X \) and \( Y \). Calculate the value of\( \angle XIY \) (in degrees).

","Let \( A' \) be the reflection of \( A \) in \( BC \) and let \( M \) be the second intersection of line \( AI \) and the circumcircle \( \Gamma \) of triangle \( ABC \). As triangles \( ABA' \) and \( AOC \) are isosceles with \( \angle ABA' = 2 \angle ABC = \angle AOC \), they are similar to each other. Also, triangles \( ABI_A \) and \( AIC \) are similar. Therefore we have
\[
\frac{AA'}{AI_A} = \frac{AA'}{AB} \cdot \frac{AB}{AI_A} = \frac{AC}{AO} \cdot \frac{AI}{AC} = \frac{AI}{AO}.
\]
Together with \( \angle A'AI_A = \angle IAO \), we find that triangles \( AA'I_A \) and \( AIO \) are similar.

Denote by \( P' \) the intersection of line \( AP \) and line \( OI \). Using directed angles, we have
\[
\begin{aligned}
\angle MAP' &= \angle I'_A AI_A = \angle I'_A AA' - \angle I_A AA' = \angle AA'I_A - \angle (AM, OM) \\
&= \angle AIO - \angle AMO = \angle MOP'.
\end{aligned}
\]
This shows \( M, O, A, P' \) are concyclic.

Denote by \( R \) and \( r \) the circumradius and inradius of triangle \( ABC \). Then
\[
IP' = \frac{IA \cdot IM}{IO} = \frac{IO^2 - R^2}{IO}
\]
is independent of \( A \). Hence, \( BP \) also meets line \( OI \) at the same point \( P' \) so that \( P' = P \), and \( P \) lies on \( OI \).

By Poncelet’s Porism, the other tangents to the incircle of triangle \( ABC \) from \( X \) and \( Y \) meet at a point \( Z \) on \( \Gamma \). Let \( T \) be the touching point of the incircle to \( XY \), and let \( D \) be the midpoint of \( XY \). We have
\[
\begin{aligned}
OD &= IT \cdot \frac{OP}{IP} = r \left(1 + \frac{OI}{IP} \right) = r \left(1 + \frac{OI^2}{OI \cdot IP} \right) = r \left(1 + \frac{R^2 - 2Rr}{R^2 - IO^2} \right) \\
&= r \left(1 + \frac{R^2 - 2Rr}{2Rr} \right) = \frac{R}{2} = \frac{OX}{2}.
\end{aligned}
\]
This shows \( \angle XZY = 60^\circ \) and hence \( \angle XIY = 120^\circ \).",120,geometry
2016n1,"\text{ For any positive integer } k, \text{ denote the sum of digits of } k \text{ in its decimal representation by } S(k). \text{ Find all polynomials } P(x) \text{ with integer coefficients such that for any positive integer } n \geq 2016, \text{ the integer } P(n) \text{ is positive and}
\[
S(P(n)) = P(S(n)). \tag{1}
\]
If \(P(11)=11\), what is the value of \(P(2016)\).","\text{ We consider three cases according to the degree of } P.

\textbf{• Case 1.} \, P(x) \text{ is a constant polynomial.} \\
\text{Let } P(x) = c \text{ where } c \text{ is an integer constant. Then (1) becomes } S(c) = c. \text{ This holds if and only if } 1 \leq c \leq 9.

\textbf{• Case 2.} \, \deg P = 1. \\
\text{We have the following observation. For any positive integers } m, n, \text{ we have}
\[
S(m+n) \leq S(m) + S(n), \tag{2}
\]
\text{and equality holds if and only if there is no carry in the addition } m + n.

\text{Let } P(x) = ax + b \text{ for some integers } a, b \text{ where } a \neq 0. \text{ As } P(n) \text{ is positive for large } n, \text{ we must have } a \geq 1. \text{ The condition (1) becomes } S(an + b) = aS(n) + b \text{ for all } n \geq 2016. \text{ Setting } n = 2025 \text{ and } n = 2020 \text{ respectively, we get}
\[
S(2025a + b) - S(2020a + b) = (aS(2025) + b) - (aS(2020) + b) = 5a.
\]
\text{On the other hand, (2) implies}
\[
S(2025a + b) = S((2020a + b) + 5a) \leq S(2020a + b) + S(5a).
\]
\text{These give } 5a \leq S(5a). \text{ As } a \geq 1, \text{ this holds only when } a = 1, \text{ in which case (1) reduces to } S(n + b) = S(n) + b \text{ for all } n \geq 2016. \text{ Then we find that}
\[
S(n+1+b) - S(n+b) = (S(n+1) + b) - (S(n) + b) = S(n+1) - S(n). \tag{3}
\]
\text{If } b > 0, \text{ we choose } n \text{ such that } n + 1 + b = 10^k \text{ for some sufficiently large } k. \text{ Note that all the digits of } n + b \text{ are } 9\text{'s, so that the left-hand side of (3) equals } 1 - 9k. \text{ As } n \text{ is a positive integer less than } 10^k - 1, \text{ we have } S(n) < 9k. \text{ Therefore, the right-hand side of (3) is at least } 1 - (9k - 1) = 2 - 9k, \text{ which is a contradiction.}

\text{The case } b < 0 \text{ can be handled similarly by considering } n + 1 \text{ to be a large power of } 10. \text{ Therefore, we conclude that } P(x) = x, \text{ in which case (1) is trivially satisfied.}

\textbf{• Case 3.} \, \deg P \geq 2. \\
\text{Suppose the leading term of } P \text{ is } a_d n^d \text{ where } a_d \neq 0. \text{ Clearly, we have } a_d > 0. \text{ Consider } n = 10^k - 1 \text{ in (1). We get } S(P(n)) = P(9k). \text{ Note that } P(n) \text{ grows asymptotically as fast as } n^d, \text{ so } S(P(n)) \text{ grows asymptotically as no faster than a constant multiple of } k. \text{ On the other hand, } P(9k) \text{ grows asymptotically as fast as } k^d. \text{ This shows the two sides of the last equation cannot be equal for sufficiently large } k \text{ since } d \geq 2.

\text{Therefore, we conclude that } P(x) = c \text{ where } 1 \leq c \leq 9 \text{ is an integer, or } P(x) = x.
If \(P(11)=11\), the value of \(P(2016)\) is \(2016\).",2016,number theory
2016n3,"Define \( P(n) = n^2 + n + 1 \). For any positive integers \( a \) and \( b \), the set
\[
\{P(a), P(a+1), P(a+2), \ldots, P(a+b)\}
\]
is said to be \emph{fragrant} if none of its elements is relatively prime to the product of the other elements. Determine the smallest size of a fragrant set.
","We have the following observations.

\begin{itemize}
    \item[(i)] \( (P(n), P(n+1)) = 1 \) for any \( n \).\\
    We have \( (P(n), P(n+1)) = (n^2 + n + 1, n^2 + 3n + 3) = (n^2 + n + 1, 2n + 2) \). Noting that \( n^2 + n + 1 \) is odd and \( (n^2 + n + 1, n + 1) = (1, n + 1) = 1 \), the claim follows.
    
    \item[(ii)] \( (P(n), P(n+2)) = 1 \) for \( n \not\equiv 2 \pmod{7} \) and \( (P(n), P(n+2)) = 7 \) for \( n \equiv 2 \pmod{7} \).\\
    From \( (2n+7)P(n) - (2n-1)P(n+2) = 14 \) and the fact that \( P(n) \) is odd, \( (P(n), P(n+2)) \) must be a divisor of 7. The claim follows by checking \( n \equiv 0, 1, \ldots, 6 \pmod{7} \) directly.

    \item[(iii)] \( (P(n), P(n+3)) = 1 \) for \( n \not\equiv 1 \pmod{3} \) and \( 3 \mid (P(n), P(n+3)) \) for \( n \equiv 1 \pmod{3} \).\\
    From \( (n+5)P(n) - (n-1)P(n+3) = 18 \) and the fact that \( P(n) \) is odd, \( (P(n), P(n+3)) \) must be a divisor of 9. The claim follows by checking \( n \equiv 0, 1, 2 \pmod{3} \) directly.
\end{itemize}

Suppose there exists a fragrant set with at most 5 elements. We may assume it contains exactly 5 elements \( P(a), P(a+1), \ldots, P(a+4) \) since the following argument also works with fewer elements. Consider \( P(a+2) \). From (i), it is relatively prime to \( P(a+1) \) and \( P(a+3) \). Without loss of generality, assume \( (P(a), P(a+2)) > 1 \). From (ii), we have \( a \equiv 2 \pmod{7} \). The same observation implies \( (P(a+1), P(a+3)) = 1 \). In order that the set is fragrant, \( (P(a), P(a+3)) \) and \( (P(a+1), P(a+4)) \) must both be greater than 1. From (iii), this holds only when both \( a \) and \( a+1 \) are congruent to 1 mod 3, which is a contradiction.

It now suffices to construct a fragrant set of size 6. By the Chinese Remainder Theorem, we can take a positive integer \( a \) such that
\[
a \equiv 7 \pmod{19}, \quad a + 1 \equiv 2 \pmod{7}, \quad a + 2 \equiv 1 \pmod{3}.
\]
For example, we may take \( a = 197 \). From (ii), both \( P(a+1) \) and \( P(a+3) \) are divisible by 7. From (iii), both \( P(a+2) \) and \( P(a+5) \) are divisible by 3. One also checks from \( 19 \mid P(7) = 57 \) and \( 19 \mid P(11) = 133 \) that \( P(a) \) and \( P(a+4) \) are divisible by 19. Therefore, the set \( \{P(a), P(a+1), \ldots, P(a+5)\} \) is fragrant.

Therefore, the smallest size of a fragrant set is 6.
",6,number theory
2016n6,"Denote by \( \mathbb{N} \) the set of all positive integers. Find all functions \( f : \mathbb{N} \to \mathbb{N} \) such that for all positive integers \( m \) and \( n \), the integer \( f(m) + f(n) - mn \) is nonzero and divides \( mf(m) + nf(n) \). Calculate the value of \(f(50)\).","It is given that
\[
f(m) + f(n) - mn \mid mf(m) + nf(n). \tag{1}
\]
Taking \( m = n = 1 \) in (1), we have \( 2f(1) - 1 \mid 2f(1) \). Then \( 2f(1) - 1 \mid 2f(1) - (2f(1) - 1) = 1 \) and hence \( f(1) = 1 \).

Let \( p \geq 7 \) be a prime. Taking \( m = p \) and \( n = 1 \) in (1), we have \( f(p) - p + 1 \mid pf(p) + 1 \) and hence
\[
f(p) - p + 1 \mid pf(p) + 1 - p(f(p) - p + 1) = p^2 - p + 1.
\]
If \( f(p) = p^2 \), this implies \( f(p) - p + 1 = p^2 - p + 1 \), then \( f(p) = p^2 \). If \( f(p) - p + 1 \neq p^2 - p + 1 \), as \( p^2 - p + 1 \) is an odd positive integer, we have \( p^2 - p + 1 \geq 3(f(p) - p + 1) \), that is,
\[
f(p) \leq \frac{1}{3}(p^2 + 2p - 2). \tag{2}
\]

Taking \( m = n = p \) in (1), we have \( 2f(p) - p^2 \mid 2pf(p) \). This implies
\[
2f(p) - p^2 \mid 2pf(p) - p^2f(p) = p(2f(p) - p^2) = p^3.
\]
By (2) and \( f(p) \geq 1 \), we get
\[
-p^2 < 2f(p) - p^2 \leq \frac{2}{3}(p^2 + 2p - 2) - p^2 < -p
\]
since \( p \geq 7 \). This contradicts the fact that \( 2f(p) - p^2 \) is a factor of \( p^3 \). Thus we have proved that \( f(p) = p^2 \) for all primes \( p \geq 7 \).

Let \( n \) be a fixed positive integer. Choose a sufficiently large prime \( p \). Consider \( m = p \) in (1). We obtain
\[
f(p) + f(n) - pn \mid pf(p) + nf(n) - n(f(p) + f(n) - pn) = pf(p) - nf(p) + pn^2.
\]
As \( f(p) = p^2 \), this implies \( p^2 - pn + f(n) \mid p(p^2 - pn + n^2) \). As \( p \) is sufficiently large and \( n \) is fixed, \( p \) cannot divide \( f(n) \), and so \( (p, p^2 - pn + f(n)) = 1 \). It follows that \( p^2 - pn + f(n) \mid p^2 - pn + n^2 \) and hence
\[
p^2 - pn + f(n) \mid (p^2 - pn + n^2) - (p^2 - pn + f(n)) = n^2 - f(n).
\]
Note that \( n^2 - f(n) \) is fixed while \( p^2 - pn + f(n) \) is chosen to be sufficiently large. Therefore, we must have \( n^2 - f(n) = 0 \) so that \( f(n) = n^2 \) for any positive integer \( n \).

Finally, we check that when \( f(n) = n^2 \) for any positive integer \( n \), then
\[
f(m) + f(n) - mn = m^2 + n^2 - mn
\]
and
\[
mf(m) + nf(n) = m^3 + n^3 = (m+n)(m^2 + n^2 - mn).
\]
The latter expression is divisible by the former for any positive integers \( m, n \). This shows \( f(n) = n^2 \) is the only solution.
So \(f(50)=2500\).",2500,number theory
2015a2,"Determine all functions \( f: \mathbb{Z} \to \mathbb{Z} \) with the property that
\[
f(x - f(y)) = f(f(x)) - f(y) - 1
\]
holds for all \( x, y \in \mathbb{Z} \).
if \(f(1)=0\), what is the value of \(f(2016)\)?","It is immediately checked that both functions mentioned in the answer are as desired.

Now let \( f \) denote any function satisfying (1) for all \( x, y \in \mathbb{Z} \). Substituting \( x = 0 \) and \( y = f(0) \) into (1) we learn that the number \( z = -f(f(0)) \) satisfies \( f(z) = -1 \). So by plugging \( y = z \) into (1) we deduce that
\[
f(x + 1) = f(f(x)) \tag{2}
\]
holds for all \( x \in \mathbb{Z} \). Thereby (1) simplifies to
\[
f(x - f(y)) = f(x + 1) - f(y) - 1. \tag{3}
\]

We now work towards showing that \( f \) is linear by contemplating the difference \( f(x + 1) - f(x) \) for any \( x \in \mathbb{Z} \). By applying (3) with \( y = x \) and (2) in this order, we obtain
\[
f(x + 1) - f(x) = f(x - f(x)) + 1 = f(f(x - 1 - f(x))) + 1.
\]
Since (3) shows \( f(x - 1 - f(x)) = f(x) - f(x) - 1 = -1 \), this simplifies to
\[
f(x + 1) = f(x) + A,
\]
where \( A = f(-1) + 1 \) is some absolute constant.

Now a standard induction in both directions reveals that \( f \) is indeed linear and that in fact we have \( f(x) = Ax + B \) for all \( x \in \mathbb{Z} \), where \( B = f(0) \). Substituting this into (2) we obtain that
\[
Ax + (A + B) = A^2x + (AB + B)
\]
holds for all \( x \in \mathbb{Z} \); applying this to \( x = 0 \) and \( x = 1 \) we infer \( A + B = AB + B \) and \( A^2 = A \).

The second equation leads to \( A = 0 \) or \( A = 1 \). In case \( A = 1 \), the first equation gives \( B = 1 \), meaning that \( f \) has to be the successor function. If \( A = 0 \), then \( f \) is constant and (1) shows that its constant value has to be \( -1 \). Thereby the solution is complete. So the value of \(f(2016)\) is \(2017\).",2017,algebra
2015a3,"Let \( n \) be a fixed positive integer. Find the maximum possible value of
\[
\sum_{1 \le r < s \le 2n} (s - r - n)x_r x_s,
\]
where \( -1 \le x_i \le 1 \) for all \( i = 1, 2, \ldots, 2n \). Give the value of the maximum possible value when \(n=50\).
","Let \( Z \) be the expression to be maximized. Since this expression is linear in every variable \( x_i \) and \( -1 \le x_i \le 1 \), the maximum of \( Z \) will be achieved when \( x_i = -1 \) or \( 1 \). Therefore, it suffices to consider only the case when \( x_i \in \{-1, 1\} \) for all \( i = 1, 2, \ldots, 2n \).

For \( i = 1, 2, \ldots, 2n \), we introduce auxiliary variables
\[
y_i = \sum_{r=1}^{i} x_r - \sum_{r=i+1}^{2n} x_r.
\]
Taking squares of both sides, we have
\[
y_i^2 = \sum_{r=1}^{2n} x_r^2 + \sum_{r \le s \le i} 2x_r x_s + \sum_{i < r < s} 2x_r x_s - \sum_{r \le i < s} 2x_r x_s
\]
\[
= 2n + \sum_{r \le s \le i} 2x_r x_s + \sum_{i < r < s} 2x_r x_s - \sum_{r \le i < s} 2x_r x_s, \tag{1}
\]
\text{where the last equality follows from the fact that } x_r \in \{-1, 1\}. \text{ Notice that for every } r < s, \text{ the coefficient of } x_r x_s \text{ in (1) is } 2 \text{ for each } i = 1, \ldots, r-1, s, \ldots, 2n, \text{ and this coefficient is } -2 \text{ for each } i = r, \ldots, s - 1. \text{ This implies that the coefficient of } x_r x_s \text{ in } \sum_{i=1}^{2n} y_i^2 \text{ is } 2(2n - s + r) - 2(s - r) = 4(n - s + r). \text{ Therefore, summing (1) for } i = 1, 2, \ldots, 2n \text{ yields}
\[
\sum_{i=1}^{2n} y_i^2 = 4n^2 + \sum_{1 \le r < s \le 2n} 4(n - s + r)x_r x_s = 4n^2 - 4Z. \tag{2}
\]

\text{Hence, it suffices to find the minimum of the left-hand side.}

\text{Since } x_r \in \{-1, 1\}, \text{ we see that } y_i \text{ is an even integer. In addition, } y_i - y_{i-1} = 2x_i = \pm 2, \text{ and so } y_{i-1} \text{ and } y_i \text{ are consecutive even integers for every } i = 2, 3, \ldots, 2n. \text{ It follows that } y_{2j-1}^2 + y_{2j}^2 \ge 4, \text{ which implies}
\[
\sum_{i=1}^{2n} y_i^2 = \sum_{j=1}^{n} (y_{2j-1}^2 + y_{2j}^2) \ge 4n. \tag{3}
\]

\text{Combining (2) and (3), we get}
\[
4n \le \sum_{i=1}^{2n} y_i^2 = 4n^2 - 4Z. \tag{4}
\]

\text{Hence, } Z \le n(n - 1). 

\text{If we set } x_i = 1 \text{ for odd indices } i \text{ and } x_i = -1 \text{ for even indices, then we obtain equality in (3) and thus in (4). Therefore, the maximum possible value of } Z \text{ is } n(n - 1), \text{ as desired.}

So the value of the maximum possible value when \(n=50\) is \(2450\).",2450,algebra
2015a4,"Find all functions \( f \colon \mathbb{R} \to \mathbb{R} \) satisfying the equation
\[
f(x + f(x + y)) + f(xy) = x + f(x + y) + y f(x)
\]
for all real numbers \( x \) and \( y \). If \(f(0)=0\), what is the value of \(f(2016)\)?","Suppose that \( f \) is any function satisfying (1). Then setting \( y = 1 \) in (1), we obtain
\[
f(x + f(x + 1)) = x + f(x + 1); \tag{2}
\]
in other words, \( x + f(x + 1) \) is a fixed point of \( f \) for every \( x \in \mathbb{R} \).

We distinguish two cases regarding the value of \( f(0) \).

\textbf{Case 1.} \( f(0) \ne 0 \).

By letting \( x = 0 \) in (1), we have
\[
f(f(y)) + f(0) = f(y) + y f(0).
\]
So, if \( y_0 \) is a fixed point of \( f \), then substituting \( y = y_0 \) in the above equation we get \( y_0 = 1 \). Thus, it follows from (2) that \( x + f(x + 1) = 1 \) for all \( x \in \mathbb{R} \). That is, \( f(x) = 2 - x \) for all \( x \in \mathbb{R} \).

\textbf{Case 2.} \( f(0) = 0 \).

By letting \( y = 0 \) and replacing \( x \) by \( x + 1 \) in (1), we obtain
\[
f(x + f(x + 1) + 1) = x + f(x + 1) + 1. \tag{3}
\]

From (1), the substitution \( x = 1 \) yields
\[
f(1 + f(y + 1)) + f(y) = 1 + f(y + 1) + y f(1). \tag{4}
\]

By plugging \( x = -1 \) into (2), we see that \( f(-1) = -1 \). We then plug \( y = -1 \) into (4) and deduce that \( f(1) = 1 \). Hence, (4) reduces to
\[
f(1 + f(y + 1)) + f(y) = 1 + f(y + 1) + y. \tag{5}
\]

Accordingly, if both \( y_0 \) and \( y_0 + 1 \) are fixed points of \( f \), then so is \( y_0 + 2 \). Thus, it follows from (2) and (3) that \( x + f(x + 1) + 2 \) is a fixed point of \( f \) for every \( x \in \mathbb{R} \); i.e.,
\[
f(x + f(x + 1) + 2) = x + f(x + 1) + 2.
\]

Replacing \( x \) by \( x - 2 \) simplifies the above equation to
\[
f(x + f(x - 1)) = x + f(x - 1).
\]

On the other hand, we set \( y = -1 \) in (1) and get
\[
f(x + f(x - 1)) = x + f(x - 1) - f(x) - f(-x).
\]

Therefore, \( f(-x) = -f(x) \) for all \( x \in \mathbb{R} \).

Finally, we substitute \( (x, y) \) by \( (-1, -y) \) in (1) and use the fact that \( f(-1) = -1 \) to get
\[
f(-1 + f(-y - 1)) + f(y) = -1 + f(-y - 1) + y.
\]

Since \( f \) is an odd function, the above equation becomes
\[
-f(1 + f(y + 1)) + f(y) = -1 - f(y + 1) + y.
\]

By adding this equation to (5), we conclude that \( f(y) = y \) for all \( y \in \mathbb{R} \).

So there are two such functions, namely the identity function and \( x \mapsto 2 - x \). If \(f(0)=0\), the value of \(f(2016)\) is \(2016\).",2016,algebra
2015c3,"For a finite set \( A \) of positive integers, we call a partition of \( A \) into two disjoint nonempty subsets \( A_1 \) and \( A_2 \) \textit{good} if the least common multiple of the elements in \( A_1 \) is equal to the greatest common divisor of the elements in \( A_2 \). Determine the minimum value of \( n \) such that there exists a set of \( n \) positive integers with exactly \(2015\) good partitions.
","Let \( A = \{a_1, a_2, \ldots, a_n\} \), where \( a_1 < a_2 < \cdots < a_n \). For a finite nonempty set \( B \) of positive integers, denote by \( \mathrm{lcm}\, B \) and \( \gcd B \) the least common multiple and the greatest common divisor of the elements in \( B \), respectively.

Consider any good partition \( (A_1, A_2) \) of \( A \). By definition, \( \mathrm{lcm}\, A_1 = d = \gcd A_2 \) for some positive integer \( d \). For any \( a_i \in A_1 \) and \( a_j \in A_2 \), we have \( a_i \le d \le a_j \). Therefore, we have \( A_1 = \{a_1, a_2, \ldots, a_k\} \) and \( A_2 = \{a_{k+1}, a_{k+2}, \ldots, a_n\} \) for some \( k \) with \( 1 \le k < n \). Hence, each good partition is determined by an element \( a_k \), where \( 1 \le k < n \). We call such \( a_k \) \textit{partitioning}.

It is convenient now to define \( \ell_k = \mathrm{lcm}(a_1, a_2, \ldots, a_k) \) and \( g_k = \gcd(a_{k+1}, a_{k+2}, \ldots, a_n) \) for \( 1 \le k < n - 1 \). So \( a_k \) is partitioning exactly when \( \ell_k = g_k \).

We proceed by proving some properties of partitioning elements, using the following claim.

\textbf{Claim.} If \( a_{k-1} \) and \( a_k \) are partitioning where \( 2 \le k < n - 1 \), then \( g_{k-1} = g_k = a_k \).

\textit{Proof.} Assume that \( a_{k-1} \) and \( a_k \) are partitioning. Since \( \ell_{k-1} = g_{k-1} \), we have \( \ell_{k-1} \mid a_k \). Therefore, \( g_k = \ell_k = \mathrm{lcm}(\ell_{k-1}, a_k) = a_k \), and \( g_{k-1} = \gcd(a_k, g_k) = a_k \), as desired. \(\square\)

\textbf{Property 1.} For every \( k = 2, 3, \ldots, n - 2 \), at least one of \( a_{k-1}, a_k, a_{k+1} \) is not partitioning.

\textit{Proof.} Suppose, to the contrary, that all three numbers \( a_{k-1}, a_k, a_{k+1} \) are partitioning. The claim yields that \( a_{k+1} = g_k = a_k \), a contradiction. \(\square\)

\textbf{Property 2.} The elements \( a_1 \) and \( a_2 \) cannot be simultaneously partitioning. Also, \( a_{n-2} \) and \( a_{n-1} \) cannot be simultaneously partitioning.

\textit{Proof.} Assume that \( a_1 \) and \( a_2 \) are partitioning. By the claim, it follows that \( a_2 = g_1 = \ell_1 = \mathrm{lcm}(a_1) = a_1 \), a contradiction. \\
Similarly, assume that \( a_{n-2} \) and \( a_{n-1} \) are partitioning. The claim yields that \( a_{n-1} = g_{n-1} = \gcd(a_n) = a_n \), a contradiction. \(\square\)

Now let \( A \) be an \( n \)-element set with exactly 2015 good partitions. Clearly, we have \( n > 5 \). Using Property 2, we find that there is at most one partitioning element in each of \( \{a_1, a_2\} \) and \( \{a_{n-2}, a_{n-1}\} \). By Property 1, there are at least \( \left\lfloor \frac{n - 5}{3} \right\rfloor \) non-partitioning elements in \( \{a_3, a_4, \ldots, a_{n-3}\} \). Therefore, there are at most \( (n - 1) - 2 - \left\lfloor \frac{n - 5}{3} \right\rfloor = \left\lceil \frac{2(n - 2)}{3} \right\rceil \) partitioning elements in \( A \). Thus,
\[
\left\lceil \frac{2(n - 2)}{3} \right\rceil \ge 2015,
\]
which implies that \( n \ge 3024 \).

Finally, we show that there exists a set of 3024 positive integers with exactly 2015 partitioning elements. Indeed, let the set \( A = \{2 \cdot 6^i, 3 \cdot 6^i, 6^{i+1} \mid 0 \le i \le 1007\} \), each element of the form \( 3 \cdot 6^i \) or \( 6^{i+1} \), except \( 6^{1008} \), is partitioning.

Therefore, the minimum possible value of \( n \) is \( \boxed{3024} \).",3024,combinatorics
2015c4,"Let \( n \) be a positive integer. Two players \( A \) and \( B \) play a game in which they take turns choosing positive integers \( k \le n \). The rules of the game are:

\begin{itemize}
    \item[(i)] A player cannot choose a number that has been chosen by either player on any previous turn.
    \item[(ii)] A player cannot choose a number consecutive to any of those the player has already chosen on any previous turn.
    \item[(iii)] The game is a draw if all numbers have been chosen; otherwise the player who cannot choose a number anymore loses the game.
\end{itemize}

The player \( A \) takes the first turn. The game ends in a draw, calculate the sum of possible \(n\).
","For brevity, we denote by \( [n] \) the set \( \{1, 2, \ldots, n\} \).

Firstly, we show that \( B \) wins whenever \( n \ne 1, 2, 4, 6 \). For this purpose, we provide a strategy which guarantees that \( B \) can always make a move after \( A \)'s move, and also guarantees that the game does not end in a draw.

We begin with an important observation.

\textbf{Lemma.} Suppose that \( B \)'s first pick is \( n \) and that \( A \) has made the \( k^\text{th} \) move where \( k \ge 2 \). Then \( B \) can also make the \( k^\text{th} \) move.

\textit{Proof.} Let \( S \) be the set of the first \( k \) numbers chosen by \( A \). Since \( S \) does not contain consecutive integers, we see that the set \( [n] \setminus S \) consists of \( k \) “contiguous components” if \( 1 \in S \), and \( k + 1 \) components otherwise. Since \( B \) has chosen only \( k - 1 \) numbers, there is at least one component of \( [n] \setminus S \) consisting of numbers not yet picked by \( B \). Hence, \( B \) can choose a number from this component. \(\square\)

We will now describe a winning strategy for \( B \), when \( n \ne 1, 2, 4, 6 \). By symmetry, we may assume that \( A \)'s first choice is a number not exceeding \( \frac{n+1}{2} \). So \( B \) can pick the number \( n \) in \( B \)'s first turn. We now consider two cases.

\textbf{Case 1.} \( n \) is odd and \( n \ge 3 \). The only way the game ends in a draw is that \( A \) eventually picks all the odd numbers from the set \( [n] \). However, \( B \) has already chosen \( n \), so this cannot happen. Thus \( B \) can continue to apply the lemma until \( A \) cannot make a move.

\textbf{Case 2.} \( n \) is even and \( n \ge 8 \). Since \( B \) has picked \( n \), the game is a draw only if \( A \) can eventually choose all the odd numbers from the set \( [n - 1] \). So \( B \) picks a number from the set \( \{1, 3, 5, \ldots, n - 3\} \) not already chosen by \( A \), on \( B \)'s second move. This is possible since the set consists of \( \frac{n-2}{2} \ge 3 \) numbers and \( A \) has chosen only 2 numbers. Hereafter \( B \) can apply the lemma until \( A \) cannot make a move.

Hence, in both cases \( A \) loses.

We are left with the cases \( n = 1, 2, 4, 6 \). The game is trivially a draw when \( n = 1, 2 \). When \( n = 4 \), \( A \) has to first pick 1 to avoid losing. Similarly, \( B \) has to choose 4 as well. It then follows that the game ends in a draw.

When \( n = 6 \), \( B \) gets at least a draw by the lemma or by using a mirror strategy. On the other hand, \( A \) may also get at least a draw in the following way. In the first turn, \( A \) chooses 1. After \( B \)'s response by a number \( b \), \( A \) finds a neighbor \( c \) of \( b \) which differs from 1 and 2, and reserves \( c \) for \( A \)'s third move. Now, clearly \( A \) can make the second move by choosing a number different from 1, 2, \( c - 1, c, c + 1 \). Therefore \( A \) will not lose.

So the sum is \(13\).",13,combinatorics
2015g1,Let \( ABC \) be an acute triangle with orthocenter \( H \). Let \( G \) be the point such that the quadrilateral \( ABGH \) is a parallelogram. Let \( I \) be the point on the line \( GH \) such that \( AC \) bisects \( HI \). Suppose that the line \( AC \) intersects the circumcircle of the triangle \( GCI \) at \( C \) and \( J \). What is the value of \( \frac{IJ}{AH} \).,"Since \( HG \parallel AB \) and \( BG \parallel AH \), we have \( BG \perp BC \) and \( CH \perp GH \). Therefore, the quadrilateral \( BGCH \) is cyclic. Since \( H \) is the orthocenter of the triangle \( ABC \), we have \( \angle HAC = 90^\circ - \angle ACB = \angle CBH \). Using that \( BGCH \) and \( CGJI \) are cyclic quadrilaterals, we get
\[
\angle CJI = \angle CGH = \angle CBH = \angle HAC.
\]

Let \( M \) be the intersection of \( AC \) and \( GH \), and let \( D \ne A \) be the point on the line \( AC \) such that \( AH = HD \). Then \( \angle MJI = \angle HAC = \angle MDH \).

Since \( \angle MJI = \angle MDH \), \( \angle IMJ = \angle HMD \), and \( IM = MH \), the triangles \( IMJ \) and \( HMD \) are congruent, and thus \( IJ = HD = AH \).
",1,geometry
2015g4,"Let \( ABC \) be an acute triangle, and let \( M \) be the midpoint of \( AC \). A circle \( \omega \) passing through \( B \) and \( M \) meets the sides \( AB \) and \( BC \) again at \( P \) and \( Q \), respectively. Let \( T \) be the point such that the quadrilateral \( BPTQ \) is a parallelogram. Suppose that \( T \) lies on the circumcircle of the triangle \( ABC \). Determine all possible values of \( (\frac{BT}{BM})^2 \).","Let \( S \) be the center of the parallelogram \( BPTQ \), and let \( B' \neq B \) be the point on the ray \( BM \) such that \( BM = MB' \) (see Figure 1). It follows that \( ABCB' \) is a parallelogram. Then, \( \angle ABB' = \angle PQM \) and \( \angle B'B'A = \angle B'BC = \angle MPQ \), and so the triangles \( ABB' \) and \( MQP \) are similar. It follows that \( AM \) and \( MS \) are corresponding medians in these triangles. Hence,
\[
\angle SMP = \angle B'A M = \angle BCA = \angle BTA. \tag{1}
\]
Since \( \angle ACT = \angle PBT \) and \( \angle TAC = \angle TBC = \angle BTP \), the triangles \( TCA \) and \( PBT \) are similar. Again, as \( TM \) and \( PS \) are corresponding medians in these triangles, we have
\[
\angle MTA = \angle TPS = \angle BQP = \angle BMP. \tag{2}
\]

Now we deal separately with two cases.

\textbf{Case 1.} \( S \) does not lie on \( BM \). Since the configuration is symmetric between \( A \) and \( C \), we may assume that \( S \) and \( A \) lie on the same side with respect to the line \( BM \).

Applying (1) and (2), we get
\[
\angle BMS = \angle BMP - \angle SMP = \angle MTA - \angle BTA = \angle MTB,
\]
and so the triangles \( BSM \) and \( BMT \) are similar. We now have \( BM^2 = BS \cdot BT = BT^2 / 2 \), so
\[
BT = \sqrt{2} BM.
\]

\textbf{Case 2.} \( S \) lies on \( BM \). It follows from (2) that \( \angle BCA = \angle MTA = \angle BQP = \angle BMP \) (see Figure 2). Thus, \( PQ \parallel AC \) and \( PM \parallel AT \). Hence, \( BS / BM = BP / BA = BM / BT \), so
\[
BT^2 = 2BM^2 \quad \text{and} \quad BT = \sqrt{2} BM.
\]
So the value of \( (\frac{BT}{BM})^2 \) is only \(2\).",2,geometry
2015g5,"Let \( ABC \) be a triangle with \( CA \neq CB \). Let \( D, F, \) and \( G \) be the midpoints of the sides \( AB, AC, \) and \( BC \), respectively. A circle \( \Gamma \) passing through \( C \) and tangent to \( AB \) at \( D \) meets the segments \( AF \) and \( BG \) at \( H \) and \( I \), respectively. The points \( H' \) and \( I' \) are symmetric to \( H \) and \( I \) about \( F \) and \( G \), respectively. The line \( H'I' \) meets \( CD \) and \( FG \) at \( Q \) and \( M \), respectively. The line \( CM \) meets \( \Gamma \) again at \( P \). Determine the value of  \( \frac{CQ}{QP} \).","We may assume that \( CA > CB \). Observe that \( H' \) and \( I' \) lie inside the segments \( CF \) and \( CG \), respectively. Therefore, \( M \) lies outside \( \triangle ABC \) (see Figure 1). 

Due to the powers of points \( A \) and \( B \) with respect to the circle \( \Gamma \), we have
\[
CH' \cdot CA = AH \cdot AC = AD^2 = BD^2 = BI \cdot BC = CI' \cdot CB.
\]
Therefore, \( CH' \cdot CF = CI' \cdot CG \). Hence, the quadrilateral \( H'I'GF \) is cyclic, and so \( \angle H'I'H'C = \angle CGF \).

Let \( DF \) and \( DG \) meet \( \Gamma \) again at \( R \) and \( S \), respectively. We claim that the points \( R \) and \( S \) lie on the line \( H'I' \).

Observe that \( FH' \cdot FA = FH \cdot FC = FR \cdot FD \). Thus, the quadrilateral \( ADH'R \) is cyclic, and hence \( \angle RH'F = \angle FDA = \angle CGF = \angle I'H'C \). Therefore, the points \( R, H', I' \) are collinear, and so all the points \( R, H', I', Q, S, \) and \( M \) are collinear.

Then, \( \angle RSD = \angle RDA = \angle DFG \). Hence, the quadrilateral \( RSGF \) is cyclic (see Figure 2). Therefore, \( MH' \cdot MI = MF \cdot MG = MR \cdot MS = MP \cdot MC \). Thus, the quadrilateral \( CP I' H' \) is also cyclic. Let \( \omega \) be its circumcircle.

Notice that \( \angle H'C Q = \angle SDC = \angle SRC \) and \( \angle QCI' = \angle CDR = \angle CSR \). Hence, \( \triangle CH'Q \sim \triangle RCQ \) and \( \triangle CI'Q \sim \triangle SCQ \), and therefore \( QH' \cdot QR = QC^2 = QI' \cdot QS \).

We apply the inversion with center \( Q \) and radius \( QC \). Observe that the points \( R, C, \) and \( S \) are mapped to \( H', C, \) and \( I' \), respectively. Therefore, the circumcircle \( \Gamma \) of \( \triangle RCS \) is mapped to the circumcircle \( \omega \) of \( \triangle H'C I' \). Since \( P \) and \( C \) belong to both circles and the point \( C \) is preserved by the inversion, we have that \( P \) is also mapped to itself. We then get \( QP = QC^2 \).

Hence, \( QP = QC \).
So the answer is \(1\).",1,geometry
2015n5,"Determine all triples \( (a, b, c) \) of positive integers for which \( ab - c \), \( bc - a \), and \( ca - b \) are powers of 2. Calculate the sum of the quantity \[ (a+b+c) \] over every such triple.

\textit{Explanation:} A power of 2 is an integer of the form \( 2^n \), where \( n \) denotes some nonnegative integer.","It can easily be verified that these sixteen triples are as required. Now let \( (a, b, c) \) be any triple with the desired property. If we would have \( a = 1 \), then both \( b - c \) and \( c - b \) were powers of 2, which is impossible since their sum is zero; because of symmetry, this argument shows \( a, b, c > 2 \).

\textbf{Case 1.} \textit{Among \( a, b, c \) there are at least two equal numbers.} \\
Without loss of generality we may suppose that \( a = b \). Then \( a^2 - c \) and \( a(c - 1) \) are powers of 2. The latter tells us that actually \( a \) and \( c - 1 \) are powers of 2. So there are nonnegative integers \( \alpha \) and \( \gamma \) with \( a = 2^\alpha \) and \( c = 2^\gamma + 1 \). Since \( a^2 - c = 2^{2\alpha} - 2^\gamma - 1 \) is a power of 2 and thus incongruent to \( -1 \mod 4 \), we must have \( \gamma \leq 1 \). Moreover, each of the terms \( 2^\alpha - 2 \) and \( 2^{2\alpha} - 3 \) can only be a power of 2 if \( \alpha = 1 \). It follows that the triple \( (a,b,c) \) is either \( (2,2,2) \) or \( (2,2,3) \).

\textbf{Case 2.} \textit{The numbers \( a, b, \) and \( c \) are distinct.} \\
Due to symmetry we may suppose that
\[
2 \le a < b < c. \tag{1}
\]
We are to prove that the triple \( (a,b,c) \) is either \( (2,6,11) \) or \( (3,5,7) \). By our hypothesis, there exist three nonnegative integers \( \alpha, \beta, \gamma \) such that
\[
bc - a = 2^\alpha, \tag{2}
\]
\[
ac - b = 2^\beta, \tag{3}
\]
\[
ab - c = 2^\gamma. \tag{4}
\]
Evidently we have
\[
\alpha > \beta > \gamma. \tag{5}
\]

Depending on how large \( a \) is, we divide the argument into two further cases.

\textbf{Case 2.1.} \( a = 2 \). \\
We first prove that \( \gamma = 0 \). Assume for the sake of contradiction that \( \gamma > 0 \). Then \( c \) is even by (4) and, similarly, \( b \) is even by (5) and (3). So the left-hand side of (2) is congruent to 2 modulo 4, which is only possible if \( bc = 4 \). As this contradicts (1), we have thereby shown that \( \gamma = 0 \), i.e., that \( c = 2b - 1 \).

Now (3) yields \( 3b - 2 = 2^\beta \). Due to \( b > 2 \) this is only possible if \( \beta \ge 4 \). If \( \beta = 4 \), then we get \( b = 6 \) and \( c = 2 \cdot 6 - 1 = 11 \), which is a solution. It remains to deal with the case \( \beta \ge 5 \). Now (2) implies
\[
9 \cdot 2^\alpha = 9b(2b - 1) - 18 = (3b - 2)(6b + 1) - 16 = 2^\beta(2^{\beta + 1} + 5) - 16,
\]
and by \( \beta \ge 5 \) the right-hand side is not divisible by 32. Thus \( \alpha \le 4 \) and we get a contradiction to (5).

\textbf{Case 2.2.} \( a \ge 3 \). \\
Pick an integer \( \vartheta \in \{-1, +1\} \) such that \( c - \vartheta \) is not divisible by 4. Now
\[
2^\alpha + \vartheta \cdot 2^\beta = (bc - a\vartheta^2) + \vartheta(ca - b) = (b + a\vartheta)(c - \vartheta)
\]
is divisible by \( 2^\beta \) and, consequently, \( b + a\vartheta \) is divisible by \( 2^{\beta - 1} \). On the other hand, \( 2^\beta = ac - b > (a - 1)c \ge 2c \) implies in view of (1) that \( a \) and \( b \) are smaller than \( 2^{\beta - 1} \). All this is only possible if \( \vartheta = 1 \) and \( a + b = 2^{\beta - 1} \). Now (3) yields
\[
ac - b = 2(a + b), \tag{6}
\]
whence \( 4b > a + 3b = a(c - 1) \ge ab \), which in turn yields \( a = 3 \).

So (6) simplifies to \( c = b + 2 \) and (2) tells us that \( b(b + 2) - 3 = (b - 1)(b + 3) \) is a power of 2. Consequently, the factors \( b - 1 \) and \( b + 3 \) are powers of 2 themselves. Since their difference is 4, this is only possible if \( b = 5 \) and thus \( c = 7 \). Thereby the solution is complete.

So there are sixteen such triples, namely \( (2,2,2) \), the three permutations of \( (2,2,3) \), and the six permutations of each of \( (2,6,11) \) and \( (3,5,7) \). The sum is \(231\).",231,number theory
2015n7,"Let \( \mathbb{Z}_{>0} \) denote the set of positive integers. For any positive integer \( k \), a function \( f : \mathbb{Z}_{>0} \to \mathbb{Z}_{>0} \) is called \( k \)-good if \( \gcd(f(m) + n, f(n) + m) \le k \) for all \( m \neq n \). Find the minimum of \( k \) such that there exists a \( k \)-good function.
","For any function \( f : \mathbb{Z}_{>0} \to \mathbb{Z}_{>0} \), let \( G_f(m, n) = \gcd(f(m) + n, f(n) + m) \). Note that a \( k \)-good function is also \( (k+1) \)-good for any positive integer \( k \). Hence, it suffices to show that there does not exist a 1-good function and that there exists a 2-good function.

We first show that there is no 1-good function. Suppose that there exists a function \( f \) such that \( G_f(m, n) = 1 \) for all \( m \neq n \). Now, if there are two distinct even numbers \( m \) and \( n \) such that \( f(m) \) and \( f(n) \) are both even, then \( 2 \mid G_f(m, n) \), a contradiction. A similar argument holds if there are two distinct odd numbers \( m \) and \( n \) such that \( f(m) \) and \( f(n) \) are both odd. Hence we can choose an even \( m \) and an odd \( n \) such that \( f(m) \) is odd and \( f(n) \) is even. This also implies that \( 2 \mid G_f(m, n) \), a contradiction.

We now construct a 2-good function. Define \( f(n) = 2^{g(n)+1} - n - 1 \), where \( g \) is defined recursively by \( g(1) = 1 \) and \( g(n + 1) = (2^{g(n)} + 1)! \). 
For any positive integers \( m > n \), set
\[
A = f(m) + n = 2^{g(m)+1} - m + n - 1, \quad B = f(n) + m = 2^{g(n)+1} - n + m - 1.
\]
We need to show that \( \gcd(A, B) \le 2 \). First, note that \( A + B = 2^{g(m)+1} + 2^{g(n)+1} - 2 \) is not divisible by 4, so that \( 4 \nmid \gcd(A, B) \). Now we suppose that there is an odd prime \( p \) for which \( p \mid \gcd(A, B) \) and derive a contradiction.

We first claim that \( 2^{g(m)-1}+1 > B \). This is a rather weak bound; one way to prove it is as follows. Observe that \( g(k+1) > g(k) \) and hence \( 2^{g(k+1)+1} \ge 2^{g(k)+1}+1 \) for every positive integer \( k \). By repeatedly applying this inequality, we obtain \( 2^{g(m)-1}+1 \ge 2^{g(n)+1} + (m - 1) - n = B \). 

Now, since \( p \mid B \), we have \( p-1 < B \le 2^{g(m)-1}+1 \), so that \( p-1 \mid (2^{g(m)-1}+1)! = g(m) \). Hence \( 2^{g(m)} \equiv 1 \pmod{p} \), which yields \( A + B = 2^{g(m)+1} \pmod{p} \). However, since \( p \mid A + B \), this implies that \( p = 2 \), a contradiction.
So the minimum is \(2\).",2,number theory
2014a3,"For a sequence \( x_1, x_2, \ldots, x_n \) of real numbers, we define its \textit{price} as
\[
\max_{1 \le i \le n} |x_1 + \cdots + x_i|.
\]

Given \( n \) real numbers, Dave and George want to arrange them into a sequence with a low price. Diligent Dave checks all possible ways and finds the minimum possible price \( D \). Greedy George, on the other hand, chooses \( x_1 \) such that \( |x_1| \) is as small as possible; among the remaining numbers, he chooses \( x_2 \) such that \( |x_1 + x_2| \) is as small as possible, and so on. Thus, in the \( i \)th step he chooses \( x_i \) among the remaining numbers so as to minimise the value of \( |x_1 + x_2 + \cdots + x_i| \). In each step, if several numbers provide the same value, George chooses one at random. Finally he gets a sequence with price \( G \).

Find the least possible constant \( c \) such that for every positive integer \( n \), for every collection of \( n \) real numbers, and for every possible sequence that George might obtain, the resulting values satisfy the inequality \( G \le cD \).","If the initial numbers are \( 1, -1, 2, \) and \( -2 \), then Dave may arrange them as \( 1, -2, 2, -1 \), while George may get the sequence \( 1, -1, 2, -2 \), resulting in \( D = 1 \) and \( G = 2 \). So we obtain \( c > 2 \).

Therefore, it remains to prove that \( G \le 2D \). Let \( x_1, x_2, \ldots, x_n \) be the numbers Dave and George have at their disposal. Assume that Dave and George arrange them into sequences \( d_1, d_2, \ldots, d_n \) and \( g_1, g_2, \ldots, g_n \), respectively. Put
\[
M = \max_{1 \le i \le n} |x_i|, \quad S = |x_1 + \cdots + x_n|, \quad \text{and} \quad N = \max\{M, S\}.
\]
We claim that
\[
D \ge S, \tag{1}
\]
\[
D \ge \frac{M}{2}, \tag{2}
\]
\[
G \le N = \max\{M, S\}. \tag{3}
\]

These inequalities yield the desired estimate, as \( G \le \max\{M, S\} \le \max\{M, 2S\} \le 2D \).

The inequality (1) is a direct consequence of the definition of the price.

To prove (2), consider an index \( i \) with \( |d_i| = M \). Then we have
\[
M = |d_i| = |(d_1 + \cdots + d_i) - (d_1 + \cdots + d_{i-1})| \le |d_1 + \cdots + d_i| + |d_1 + \cdots + d_{i-1}| \le 2D,
\]
as required.

It remains to establish (3). Put \( h_i = g_1 + g_2 + \cdots + g_i \). We will prove by induction on \( i \) that \( |h_i| \le N \). The base case \( i = 1 \) holds, since \( |h_1| = |g_1| \le M \le N \). Notice also that \( |h_n| = S \le N \).

For the induction step, assume that \( |h_{i-1}| \le N \). We distinguish two cases.

\textbf{Case 1.} Assume that no two of the numbers \( g_i, g_{i+1}, \ldots, g_n \) have opposite signs. \\
Without loss of generality, we may assume that they are all nonnegative. Then one has \( h_{i-1} \le h_i \le \cdots \le h_n \), thus
\[
|h_i| \le \max\{ |h_{i-1}|, |h_n| \} \le N.
\]

\textbf{Case 2.} Among the numbers \( g_i, g_{i+1}, \ldots, g_n \), there are positive and negative ones. \\
Then there exists some index \( j \ge i \) such that \( h_{i-1} g_j \le 0 \). By the definition of George’s sequence we have
\[
|h_i| = |h_{i-1} + g_i| \le |h_{i-1} + g_j| \le \max\{ |h_{i-1}|, |g_j| \} \le N.
\]

Thus, the induction step is established.
",2,algebra
2014a4,"Determine all functions \( f \colon \mathbb{Z} \to \mathbb{Z} \) satisfying
\[
f(f(m) + n) + f(m) = f(n) + f(3m) + 2014 \tag{1}
\]
for all integers \( m \) and \( n \). Give the value of \(f(2014)\).","Let \( f \) be a function satisfying (1). Set \( C = 1007 \) and define the function \( g \colon \mathbb{Z} \to \mathbb{Z} \) by \( g(m) = f(3m) - f(m) + 2C \) for all \( m \in \mathbb{Z} \); in particular, \( g(0) = 2C \). Now (1) rewrites as
\[
f(f(m) + n) = g(m) + f(n)
\]
for all \( m, n \in \mathbb{Z} \). By induction in both directions it follows that
\[
f(tf(m) + n) = tg(m) + f(n) \tag{2}
\]
holds for all \( m, n, t \in \mathbb{Z} \). Applying this, for any \( r \in \mathbb{Z} \), to the triples \( (r, 0, f(0)) \) and \( (0, 0, f(r)) \) in place of \( (m, n, t) \), we obtain
\[
f(0)g(r) = f(f(r)f(0)) - f(0) = f(r)g(0).
\]
Now if \( f(0) \) vanished, then \( g(0) = 2C > 0 \) would entail that \( f \) vanishes identically, contrary to (1). Thus \( f(0) \ne 0 \) and the previous equation yields \( g(r) = \alpha f(r) \), where \( \alpha = \frac{g(0)}{f(0)} \) is some nonzero constant.

So the definition of \( g \) reveals \( f(3m) = (1 + \alpha)f(m) - 2C \), i.e.,
\[
f(3m) - \beta = (1 + \alpha)(f(m) - \beta) \tag{3}
\]
for all \( m \in \mathbb{Z} \), where \( \beta = \frac{2C}{\alpha} \). By induction on \( k \) this implies
\[
f(3^k m) - \beta = (1 + \alpha)^k (f(m) - \beta) \tag{4}
\]
for all integers \( k \ge 0 \) and \( m \).

Since \( 3 \nmid 2014 \), there exists by (1) some value \( d = f(a) \) attained by \( f \) that is not divisible by 3. Now by (2) we have \( f(n + td) = f(n) + tg(a) = f(n) + \alpha \cdot tf(a) \), i.e.,
\[
f(n + td) = f(n) + \alpha \cdot td \tag{5}
\]
for all \( n, t \in \mathbb{Z} \).

Let us fix any positive integer \( k \) with \( d \mid (3^k - 1) \), which is possible, since \( \gcd(3, d) = 1 \). E.g., by the Euler–Fermat theorem, we may take \( k = \varphi(|d|) \). Now for each \( m \in \mathbb{Z} \) we get
\[
f(3^k m) = f(m) + \alpha (3^k - 1) m
\]
from (5), which in view of (4) yields
\[
((1 + \alpha)^k - 1)(f(m) - \beta) = \alpha (3^k - 1) m.
\]
Since \( \alpha \ne 0 \), the right-hand side does not vanish for \( m \ne 0 \), wherefore the first factor on the left-hand side cannot vanish either. It follows that
\[
f(m) = \frac{\alpha (3^k - 1)}{(1 + \alpha)^k - 1} \cdot m + \beta.
\]

So \( f \) is a linear function, say \( f(m) = Am + \beta \) for all \( m \in \mathbb{Z} \) with some constant \( A \in \mathbb{Q} \). Plugging this into (1) one obtains \( (A^2 - 2A)m + (A\beta - 2C) = 0 \) for all \( m \), which is equivalent to the conjunction of
\[
A^2 = 2A \quad \text{and} \quad A\beta = 2C. \tag{6}
\]

The first equation is equivalent to \( A \in \{0, 2\} \), and as \( C \ne 0 \) the second one gives
\[
A = 2 \quad \text{and} \quad \beta = C. \tag{7}
\]

This shows that \( f \) is indeed the function mentioned in the answer and as the numbers found in (7) do indeed satisfy the equations (6) this function is indeed as desired.
There is only one such function, namely \( n \mapsto 2n + 1007 \). So the value of \(f(2014)\) is \(5035\).
",5035,algebra
2014a5,"Consider all polynomials \( P(x) \) with real coefficients that have the following property: for any two real numbers \( x \) and \( y \) one has
\[
|y^2 - P(x)| \le 2|x| \quad \text{if and only if} \quad |x^2 - P(y)| \le 2|y|. \tag{1}
\]
Determine all possible values of \( P(0) \). What is the largest possible values of \( P(0) \)?
","\textbf{Part I.} We begin by verifying that these numbers are indeed possible values of \( P(0) \). To see that each negative real number \( -C \) can be \( P(0) \), it suffices to check that for every \( C > 0 \) the polynomial \( P(x) = -\left( \frac{x^2}{C^2} + C \right) \) has the property described in the statement of the problem. Due to symmetry it is enough for this purpose to prove \( |y^2 - P(x)| > 2|x| \) for any two real numbers \( x \) and \( y \). In fact we have
\[
|y^2 - P(x)| = y^2 + \frac{x^2}{C} + \frac{(|x| - C)^2}{C} + 2|x| \ge \frac{x^2}{C} + 2|x| \ge 2|x|,
\]
where in the first estimate equality can only hold if \( |x| = C \), whilst in the second one it can only hold if \( x = 0 \). As these two conditions cannot be met at the same time, we have indeed \( |y^2 - P(x)| > 2|x| \).

To show that \( P(0) = 1 \) is possible as well, we verify that the polynomial \( P(x) = x^2 + 1 \) satisfies (1). Notice that for all real numbers \( x \) and \( y \) we have
\[
|y^2 - P(x)| \le 2|x| \iff (y^2 - x^2 - 1)^2 \le 4x^2 \iff 0 \le ((y - (x - 1))((x + 1)^2 - y^2)) \\
\iff 0 \le (y - x + 1)(y + x - 1)(x + 1 - y)(x + 1 + y) \iff 0 \le ((x + y)^2 - 1)(1 - (x - y)^2).
\]
Since this inequality is symmetric in \( x \) and \( y \), we are done.

\textbf{Part II.} Now we show that no values other than those mentioned in the answer are possible for \( P(0) \). To reach this we let \( P \) denote any polynomial satisfying (1) and \( P(0) > 0 \); as we shall see, this implies \( P(x) = x^2 + 1 \) for all real \( x \), which is actually more than what we want.

\textit{First step: We prove that \( P \) is even.} \\
By (1) we have
\[
|y^2 - P(x)| \le 2|x| \iff |x^2 - P(y)| \le 2|y| \iff |y^2 - P(-x)| \le 2|x|
\]
for all real numbers \( x \) and \( y \). Considering just the equivalence of the first and third statements and taking into account that \( y^2 \) may vary through \( \mathbb{R}_{\ge 0} \) we infer that
\[
[P(x) - 2|x|, P(x) + 2|x|] \cap \mathbb{R}_{\ge 0} = [P(-x) - 2|x|, P(-x) + 2|x|] \cap \mathbb{R}_{\ge 0}
\]
holds for all \( x \in \mathbb{R} \). We claim that there are infinitely many real numbers \( x \) such that \( P(x) + 2|x| > 0 \). This holds in fact for any real polynomial with \( P(0) > 0 \); in order to see this, we may assume that the coefficient of \( P \) appearing in front of \( x \) is nonnegative. In this case the desired inequality holds for all sufficiently small positive real numbers.

For such numbers \( x \) satisfying \( P(x) + 2|x| > 0 \) we have \( P(x) + 2|x| = P(-x) + 2|x| \) by the previous displayed formula, and hence also \( P(x) = P(-x) \). Consequently the polynomial \( P(x) - P(-x) \) has infinitely many zeros, wherefore it has to vanish identically. Thus \( P \) is indeed even.

\textit{Second step: We prove that \( P(t) > 0 \) for all \( t \in \mathbb{R} \).} \\
Let us assume for a moment that there exists a real number \( t \ne 0 \) with \( P(t) = 0 \). Then there is some open interval \( I \) around \( t \) such that \( |P(y)| \le 2|y| \) holds for all \( y \in I \). Plugging \( x = 0 \) into (1) we learn that \( y^2 = P(0) \) holds for all \( y \in I \), which is clearly absurd. We have thus shown \( P(t) \ne 0 \) for all \( t \ne 0 \).

In combination with \( P(0) > 0 \) this informs us that our claim could only fail if \( P(0) = 0 \). In this case there is by our first step a polynomial \( Q(x) \) such that \( P(x) = x^2 Q(x) \). Applying (1) to \( x = 0 \) and an arbitrary \( y \ne 0 \) we get \( |y^2 Q(y)| > 2 \), which is surely false when \( y \) is sufficiently small.

\textit{Third step: We prove that \( P \) is a quadratic polynomial.} \\
Notice that \( P \) cannot be constant, for otherwise if \( x = \sqrt{P(0)} \) and \( y \) is sufficiently large, the first part of (1) is false whilst the second part is true. So the degree \( n \) of \( P \) has to be at least 1. By our first step \( n \) has to be even as well, whence in particular \( n \ge 2 \).

Now assume that \( n \ge 4 \). Plugging \( y = \sqrt{P(x)} \) into (1) we get \( |x^2 - P(\sqrt{P(x)})| \le 2\sqrt{P(x)} \) and hence
\[
P(\sqrt{P(x)}) \le x^2 + 2\sqrt{P(x)}
\]
for all real \( x \). Choose positive real numbers \( x_0, a, b \) such that if \( x \in (x_0, \infty) \), then \( ax^n < P(x) < bx^n \); this is indeed possible, for if \( d > 0 \) denotes the leading coefficient of \( P \), then \( \lim_{x \to \infty} \frac{P(x)}{x^n} = d \), where for instance the numbers \( a = \frac{d}{2} \) and \( b = 2d \) work provided that \( x_0 \) is chosen large enough.

Now for all sufficiently large real numbers \( x \) we have
\[
a^{n/2+1} x^{n^2/2} < aP(x)^{n/2} < P(\sqrt{P(x)}) \le x^2 + 2\sqrt{P(x)} < x^n/2 + 2b^{1/2} x^{n/2},
\]
i.e.
\[
x^{(n^2 - n)/2} < \frac{1 + 2b^{1/2}}{a^{n/2+1}},
\]
which is surely absurd. Thus \( P \) is indeed a quadratic polynomial.

\textit{Fourth step: We prove that \( P(x) = x^2 + 1 \).} \\
In the light of our first three steps there are two real numbers \( a > 0 \) and \( b \) such that \( P(x) = ax^2 + b \). Now if \( x \) is large enough and \( y = \sqrt{a}x \), the left part of (1) holds and the right part reads \( |(1 - a)x^2 - b| \le 2\sqrt{a}x \). In view of the fact that \( a > 0 \) this is only possible if \( a = 1 \). Finally, substituting \( y = x + 1 \) and \( x = 0 \) into (1) we get
\[
|2x + 1 - b| \le 2x \iff |2x + 1 + b| \le 2x + 2,
\]
i.e.,
\[
b \in [-1, 4x + 1] \cap [-4x - 3, 1]
\]
for all \( x > 0 \). Choosing \( x \) large enough, we can achieve that at least one of these two statements holds; then both hold, which is only possible if \( b = 1 \), as desired.

The set of possible values of \( P(0) \) is \( (-\infty, 0) \cup \{1\} \). So the largest possible values of \( P(0) \) is \(1\).",1,algebra
2014a6,"Find all functions \( f \colon \mathbb{Z} \to \mathbb{Z} \) such that
\[
n^2 + 4f(n) = f(f(n))^2
\]
for all \( n \in \mathbb{Z} \). Give the value of \(f(2014)\).
","\textbf{Part I.} Let us first check that each of the functions above really satisfies the given functional equation. If \( f(n) = n + 1 \) for all \( n \), then we have
\[
n^2 + 4f(n) = n^2 + 4n + 4 = (n + 2)^2 = f(n + 1)^2 = f(f(n))^2.
\]

If \( f(n) = n + 1 \) for \( n > -a \) and \( f(n) = -n + 1 \) otherwise, then we have the same identity for \( n > -a \) and
\[
n^2 + 4f(n) = n^2 - 4n + 4 = (2 - n)^2 = f(1 - n)^2 = f(f(n))^2
\]
otherwise. The same applies to the third solution (with \( a = 0 \)), where in addition one has
\[
0^2 + 4f(0) = 0 = f(f(0))^2.
\]

\textbf{Part II.} It remains to prove that these are really the only functions that satisfy our functional equation. We do so in three steps:

\textit{Step 1: We prove that \( f(n) = n + 1 \) for \( n > 0 \).}

Consider the sequence \( (a_k) \) given by \( a_k = f^k(1) \) for \( k \ge 0 \). Setting \( n = a_k \) in (1), we get
\[
a_k^2 + 4a_{k+1} = a_{k+2}^2.
\]

Of course, \( a_0 = 1 \) by definition. Since \( a_2^2 = 1 + 4a_1 \) is odd, \( a_2 \) has to be odd as well, so we set \( a_2 = 2r + 1 \) for some \( r \in \mathbb{Z} \). Then \( a_1 = r^2 + r \) and consequently
\[
a_3^2 = a_1^2 + 4a_2 = (r^2 + r)^2 + 8r + 4.
\]

Since \( 8r + 4 \ne 0 \), \( a_3^2 \ne (r^2 + r)^2 \), so the difference between \( a_3^2 \) and \( (r^2 + r)^2 \) is at least the distance from \( (r^2 + r)^2 \) to the nearest even square. This implies that
\[
4r^2 \le |8r + 4| - 4r + 4.
\]

If \( |r| \ge 4 \), then
\[
4r^2 \ge 16|r| \ge 12|r| + 16 > 8|r| + 4 + 4|r| + 4 > |8r + 4| - 4r + 4,
\]
a contradiction. Thus \( |r| < 4 \). Checking all possible remaining values of \( r \), we find that \( (r^2 + r)^2 + 8r + 4 \) is only a square in three cases: \( r = -3, 0, 1 \). Let us now distinguish these three cases:

- \( r = -3 \): then \( a_1 = 6 \) and \( a_2 = -5 \). For each \( k \ge 1 \), we have
\[
a_{k+2} = \pm \sqrt{a_k^2 + 4a_{k+1}},
\]
and the sign must be chosen to keep \( a_{k+2} \) an integer. This eventually leads to contradiction as it gives \( f(1) = 6 \) and \( f(1) = f(a_0) = a_1 = 6 \), but also \( f(1) = f(a_3) = a_2 = -5 \).

- \( r = 0 \): then \( a_1 = 0 \), \( a_2 = 1 \). Then \( a_3 = \pm 2 \), again contradicting \( f(1) = f(a_2) = a_3 = \pm 2 \), \( f(1) = a_1 = 0 \).

- \( r = 1 \): then \( a_1 = 2 \), \( a_2 = 3 \). Induction shows that \( a_k = k + 1 \) for all \( k \ge 0 \), hence \( f(n) = n + 1 \) for \( n \ge 1 \).

\textit{Step 2: We prove that either \( f(0) = 1 \), or \( f(0) = 0 \) and \( f(n) = 0 \) for \( n \ne 0 \).}

Set \( n = 0 \) in (1) to get
\[
4f(0) = f(f(0))^2.
\]

This means that \( f(0) \ge 0 \). If \( f(0) = 0 \), then \( f(n) \ne 0 \) for all \( n \ne 0 \), or else we get contradiction. If \( f(0) > 0 \), we know from Step 1 that \( f(f(0)) = f(0) + 1 \), so
\[
4f(0) = (f(0) + 1)^2 \Rightarrow f(0) = 1.
\]

\textit{Step 3: We discuss the values of \( f(n) \) for \( n < 0 \).}

\textbf{Lemma.} For every \( n \ge 1 \), we have \( f(-n) = -n + 1 \) or \( f(-n) = n + 1 \). Moreover, if \( f(-n) = -n + 1 \) for some \( n \ge 1 \), then also \( f(-n + 1) = -n + 2 \).

\textit{Proof.} Strong induction on \( n \). For \( n = 1 \), we get
\[
1 + 4f(-1) = f(f(-1))^2.
\]
Then \( f(-1) \ge 0 \). If \( f(-1) = 0 \), then \( f(f(-1)) = f(0) = \pm1 \Rightarrow f(0) = 1 \), contradiction. If \( f(-1) > 0 \), then
\[
1 + 4f(-1) = (f(-1) + 1)^2 \Rightarrow f(-1) = 2.
\]

Now proceed with the inductive step, considering two cases depending on \( f(-n) \le -n \) or not. Each leads to \( f(-n) = -n + 1 \) or \( f(-n) = n + 1 \). Using the same process as in the solution above, the possibilities collapse to the same two function forms as earlier.

\textbf{Conclusion.} Combining everything we know, we find the solutions:

- \( f(n) = n + 1 \) for all \( n \in \mathbb{Z} \)
- \( f(n) = -n + 1 \) for \( n < -a \), \( f(n) = n + 1 \) for \( n > -a \), and either \( f(-a) = -(-a) + 1 = a + 1 \), or \( f(0) = 0 \) and \( f(n) = -n + 1 \) for \( n < 0 \), \( f(n) = n + 1 \) for \( n > 0 \).

These are the only functions satisfying the given equation. So the value of \(f(2014)\) must be \(2015\).",2015,algebra
2014c1,"Let \( n \) points be given inside a rectangle \( R \) such that no two of them lie on a line parallel to one of the sides of \( R \). The rectangle \( R \) is to be dissected into smaller rectangles with sides parallel to the sides of \( R \) in such a way that none of these rectangles contains any of the given points in its interior. What is the least number of smaller rectangles we have to dissect \( R \) into when \(n=2014\).
","Let \( k \) be the number of rectangles in the dissection. The set of all points that are corners of one of the rectangles can be divided into three disjoint subsets:

\begin{itemize}
\item \( A \), which consists of the four corners of the original rectangle \( R \), each of which is the corner of exactly one of the smaller rectangles,

\item \( B \), which contains points where exactly two of the rectangles have a common corner (T-junctions, see the figure below),

\item \( C \), which contains points where four of the rectangles have a common corner (crossings, see the figure below).
\end{itemize}

\begin{center}
\includegraphics[scale=0.9]{Tjunction_crossing.png} \\
Figure 1: A T-junction and a crossing
\end{center}

We denote the number of points in \( B \) by \( b \) and the number of points in \( C \) by \( c \). Since each of the \( k \) rectangles has exactly four corners, we get
\[
4k = 4 + 2b + 4c.
\]
It follows that \( 2b \le 4k - 4 \), so \( b \le 2k - 2 \).

Each of the \( n \) given points has to lie on a side of one of the smaller rectangles (but not of the original rectangle \( R \)). If we extend this side as far as possible along borders between rectangles, we obtain a line segment whose ends are T-junctions. Note that every point in \( B \) can only be an endpoint of at most one such segment containing one of the given points, since it is stated that no two of them lie on a common line parallel to the sides of \( R \). This means that
\[
b \ge 2n.
\]

Combining our two inequalities for \( b \), we get
\[
2k - 2 \ge b \ge 2n,
\]
thus \( k \ge n + 1 \), which is what we wanted to prove.
So we have to dissect \( R \) into at least \( 2015 \) smaller rectangles when \(n=2014\).",2015,combinatorics
2014c2,"We have \( 2^m \) sheets of paper, with the number \( 1 \) written on each of them. We perform the following operation. In every step we choose two distinct sheets; if the numbers on the two sheets are \( a \) and \( b \), then we erase these numbers and write the number \( a + b \) on both sheets. After \( m 2^{m-1} \) steps, what is the minimum value of the sum of the numbers on all the sheets when \(m=8\)
","Let \( P_k \) be the product of the numbers on the sheets after \( k \) steps.

Suppose that in the \( (k+1)^\text{th} \) step the numbers \( a \) and \( b \) are replaced by \( a + b \). In the product, the number \( ab \) is replaced by \( (a + b)^2 \), and the other factors do not change. Since \( (a + b)^2 \ge 4ab \), we see that \( P_{k+1} \ge 4P_k \). Starting with \( P_0 = 1 \), a straightforward induction yields
\[
P_k \ge 4^k
\]
for all integers \( k \ge 0 \); in particular
\[
P_{m \cdot 2^{m-1}} \ge 4^{m \cdot 2^{m-1}} = (2^m)^{2^m},
\]
so by the AM–GM inequality, the sum of the numbers written on the sheets after \( m2^{m-1} \) steps is at least
\[
2^m \cdot \sqrt[2^m]{P_{m \cdot 2^{m-1}}} \ge 2^m \cdot 2^m = 4^m.
\]
After \( m 2^{m-1} \) steps, the sum of the numbers on all the sheets is at least \( 4^m \). The minimum value when \(m=8\) is \(65536\).",65536,combinatorics
2014c3,"Let \( n \ge 2 \) be an integer. Consider an \( n \times n \) chessboard divided into \( n^2 \) unit squares. We call a configuration of \( n \) rooks on this board \textit{happy} if every row and every column contains exactly one rook. When \(n=2014\), find the greatest positive integer \( k \) such that for every happy configuration of rooks, we can find a \( k \times k \) square without a rook on any of its \( k^2 \) unit squares.
","Let \( \ell \) be a positive integer. We will show that (i) if \( n > \ell^2 \) then each happy configuration contains an empty \( \ell \times \ell \) square, but (ii) if \( n \le \ell^2 \) then there exists a happy configuration not containing such a square. These two statements together yield the answer.

\textbf{(i).} Assume that \( n > \ell^2 \). Consider any happy configuration. There exists a row \( R \) containing a rook in its leftmost square. Take \( \ell \) consecutive rows with \( R \) being one of them. Their union \( U \) contains exactly \( \ell \) rooks. Now remove the \( n - \ell^2 \ge 1 \) leftmost columns from \( U \) (thus at least one rook is also removed). The remaining part is an \( \ell \times \ell \) rectangle, so it can be split into \( \ell \) squares of size \( \ell \times \ell \), and this part contains at most \( \ell - 1 \) rooks. Thus one of these squares is empty.

\textbf{(ii).} Now we assume that \( n \le \ell^2 \). Firstly, we will construct a happy configuration with no empty \( \ell \times \ell \) square for the case \( n = \ell^2 \). After that we will modify it to work for smaller values of \( n \).

Let us enumerate the rows from bottom to top as well as the columns from left to right by the numbers \( 0, 1, \ldots, \ell^2 - 1 \). Every square will be denoted, as usual, by the pair \( (r, c) \) of its row and column numbers. Now we put the rooks on all squares of the form \( (\ell t + j, \ell t + i) \) with \( i, j = 0, 1, \ldots, \ell - 1 \). Since each number from \( 0 \) to \( \ell^2 - 1 \) has a unique representation of the form \( \ell i + j \) (\( 0 \le i, j < \ell \)), each row and each column contains exactly one rook.

Next, we show that each \( \ell \times \ell \) square \( A \) on the board contains a rook. Consider such a square \( A \), and consider \( \ell \) consecutive rows the union of which contains \( A \). Let the lowest of these rows have number \( \rho \ell + q \) with \( 0 \le \rho, q \le \ell - 1 \) (note that \( \rho \ell + q \le \ell^2 - \ell \)). Then the rooks in this union are placed in the columns with numbers \( q\ell + p, (q + 1)\ell + p, \ldots, (\ell - 1)\ell + p \), \( p + 1, \ell + (p + 1), \ldots, (q - 1)\ell + p + 1 \), or, putting these numbers in increasing order,
\[
p + 1, \ell + (p + 1), \ldots, (q - 1)\ell + (p + 1), q\ell + p, (q + 1)\ell + p, \ldots, (\ell - 1)\ell + p.
\]
One readily checks that the first number in this list is at most \( \ell - 1 \) (if \( p = \ell - 1 \), then \( q = 0 \)), and the first listed number is \( q\ell + p = \ell - 1 \), the last one is at least \( (\ell - 1)\ell \), and the difference between any two consecutive numbers is at most \( \ell \). Thus, one of the \( \ell \) consecutive columns intersecting \( A \) contains a number listed above, and the rook in this column is inside \( A \), as required. The construction for \( n = \ell^2 \) is established.

It remains to construct a happy configuration of rooks not containing an empty \( \ell \times \ell \) square for \( n < \ell^2 \). In order to achieve this, take the construction for an \( \ell \times \ell \) square described above and remove the \( \ell^2 - n \) bottom rows together with the \( \ell^2 - n \) rightmost columns. We will have a rook arrangement with no empty \( \ell \times \ell \) square, but several rows and columns may happen to be empty. Clearly, the number of empty rows is equal to the number of empty columns, so one can find a bijection between them, and put a rook on any crossing of an empty row and an empty column corresponding to each other.
So the answer is \left\lfloor \sqrt{n - 1} \right\rfloor. When \(n=2014\), the answer is \(43\)",43,combinatorics
2014c5,"Consider \( n \ge 3 \) lines in the plane such that no two lines are parallel and no three have a common point. These lines divide the plane into polygonal regions; let \( \mathcal{F} \) be the set of regions having finite area. Is it possible to colour \( \left\lceil \sqrt{n/2} \right\rceil \) of the lines blue in such a way that no region in \( \mathcal{F} \) has a completely blue boundary? (For a real number \( x \), \( \left\lceil x \right\rceil \) denotes the least integer which is not smaller than \( x \).) If the answer is 'Yes', give the value \(1\). Else give \(0\).
","\textbf{Solution.} Let \( L \) be the given set of lines. Choose a maximal (by inclusion) subset \( B \subseteq L \) such that when we colour the lines of \( B \) blue, no region in \( \mathcal{F} \) has a completely blue boundary. Let \( |B| = k \). We claim that \( k \ge \left\lceil \sqrt{n/2} \right\rceil \).

Let us colour all the lines of \( L \setminus B \) red. Call a point \textit{blue} if it is the intersection of two blue lines. Then there are \( \binom{k}{2} \) blue points.

Now consider any red line \( \ell \). By the maximality of \( B \), there exists at least one region \( A \in \mathcal{F} \) whose only red side lies on \( \ell \). Since \( A \) has at least three sides, it must have at least one blue vertex. Let us take one such vertex and associate it to \( \ell \).

Since each blue point belongs to four regions (some of which may be unbounded), it is associated to at most four red lines. Thus the total number of red lines is at most \( 4 \binom{k}{2} \). On the other hand, this number is \( n - k \), so
\[
n - k \le 2k(k - 1), \quad \text{thus} \quad n \le 2k^2 - k \le 2k^2,
\]
and finally \( k \ge \left\lceil \sqrt{n/2} \right\rceil \), which gives the desired result.",1,combinatorics
2014c6,"We are given an infinite deck of cards, each with a real number on it. For every real number \( x \), there is exactly one card in the deck that has \( x \) written on it. Now two players draw disjoint sets \( A \) and \( B \) of 100 cards each from this deck. We would like to define a rule that declares one of them a winner. This rule should satisfy the following conditions:

\begin{enumerate}
  \item The winner only depends on the relative order of the 200 cards: if the cards are laid down in increasing order face down and we are told which card belongs to which player, but not what numbers are written on them, we can still decide the winner.

  \item If we write the elements of both sets in increasing order as \( A = \{a_1, a_2, \ldots, a_{100}\} \) and \( B = \{b_1, b_2, \ldots, b_{100}\} \), and \( a_i > b_i \) for all \( i \), then \( A \) beats \( B \).

  \item If three players draw three disjoint sets \( A, B, C \) from the deck, \( A \) beats \( B \) and \( B \) beats \( C \), then \( A \) also beats \( C \).
\end{enumerate}

How many ways are there to define such a rule? Here, we consider two rules as different if there exist two sets \( A \) and \( B \) such that \( A \) beats \( B \) according to one rule, but \( B \) beats \( A \) according to the other.
","We prove a more general statement for sets of cardinality \( n \) (the problem being the special case \( n = 100 \), then the answer is \( n \)). In the following, we write \( A > B \) or \( B < A \) for “\( A \) beats \( B \)”.

\textbf{Part I.} Let us first define \( n \) different rules that satisfy the conditions. To this end, fix an index \( k \in \{1, 2, \ldots, n\} \). We write both \( A \) and \( B \) in increasing order as \( A = \{a_1, a_2, \ldots, a_n\} \) and \( B = \{b_1, b_2, \ldots, b_n\} \) and say that \( A \) beats \( B \) if and only if \( a_k > b_k \). This rule clearly satisfies all three conditions, and the rules corresponding to different \( k \) are all different. Thus there are at least \( n \) different rules.

\textbf{Part II.} Now we have to prove that there is no other way to define such a rule. Suppose that our rule satisfies the conditions, and let \( k \in \{1, 2, \ldots, n\} \) be minimal with the property that
\[
A_k = \{1, 2, \ldots, k, n + k + 1, n + k + 2, \ldots, 2n\} > B_k = \{k + 1, k + 2, \ldots, n + k\}.
\]
Clearly, such a \( k \) exists, since this holds for \( k = n \) by assumption. Now consider two disjoint sets \( X = \{x_1, x_2, \ldots, x_n\} \) and \( Y = \{y_1, y_2, \ldots, y_n\} \), both in increasing order (i.e., \( x_1 < x_2 < \cdots < x_n \) and \( y_1 < y_2 < \cdots < y_n \)). We claim that \( X < Y \) if (and only if – this follows automatically) \( x_k < y_k \).

To prove this statement, pick arbitrary real numbers \( u_i, v_i, w_i \notin X \cup Y \) such that
\[
u_1 < u_2 < \cdots < u_{k-1} < \min(x_1, y_1), \quad \max(x_n, y_n) < v_{k+1} < v_{k+2} < \cdots < v_n,
\]
and
\[
x_k < v_1 < v_2 < \cdots < v_k < w_1 < w_2 < \cdots < w_n < u_k < u_{k+1} < \cdots < u_n < y_k,
\]
and set
\[
U = \{u_1, u_2, \ldots, u_n\}, \quad V = \{v_1, v_2, \ldots, v_n\}, \quad W = \{w_1, w_2, \ldots, w_n\}.
\]

Then
\[
u_i < y_i \text{ and } x_i < v_i \text{ for all } i, \text{ so } U < Y \text{ and } X < V \text{ by the second condition}.
\]

\begin{itemize}
  \item The elements of \( U \cup W \) are ordered in the same way as those of \( A_{k-1} \cup B_{k-1} \), and since \( A_{k-1} > B_{k-1} \) by our choice of \( k \), we also have \( U > W \) (if \( k = 1 \), this is trivial).
  
  \item The elements of \( V \cup W \) are ordered in the same way as those of \( A_k \cup B_k \), and since \( A_k < B_k \) by our choice of \( k \), we also have \( V < W \).
\end{itemize}

It follows that
\[
X < V < W < U < Y,
\]
so \( X < Y \) by the third condition, which is what we wanted to prove.
",100,combinatorics
2014c7,"Let \( M \) be a set of \( n \ge 4 \) points in the plane, no three of which are collinear. Initially these points are connected with \( n \) segments so that each point in \( M \) is the endpoint of exactly two segments. Then, at each step, one may choose two segments \( AB \) and \( CD \) sharing a common interior point and replace them by the segments \( AC \) and \( BD \) if none of them is present at this moment. Is it impossible to perform \( \frac{n^3}{4} \) or more such moves? If the answer is 'Yes', give the value \(1\). Else give \(0\).

","A line is said to be \emph{red} if it contains two points of \( M \). As no three points of \( M \) are collinear, each red line determines a unique pair of points of \( M \). Moreover, there are precisely \( \binom{n}{2} < \frac{n^2}{2} \) red lines. By the \emph{value} of a segment we mean the number of red lines intersecting it in its interior, and the \emph{value of a set of segments} is defined to be the sum of the values of its elements. We will prove that \((i)\) the value of the initial set of segments is smaller than \( n^3/2 \) and that \((ii)\) each step decreases the value of the set of segments present by at least 2. Since such a value can never be negative, these two assertions imply the statement of the problem.

To show \((i)\) we just need to observe that each segment has a value that is smaller than \( n^2/2 \). Thus the combined value of the \( n \) initial segments is indeed below \( n \cdot n^2/2 = n^3/2 \).

It remains to establish \((ii)\). Suppose that at some moment we have two segments \( AB \) and \( CD \) sharing an interior point \( S \), and that at the next moment we have the two segments \( AC \) and \( BD \) instead. Let \( X_{AB} \) denote the set of red lines intersecting the segment \( AB \) in its interior and let the sets \( X_{AC}, X_{BD}, \) and \( X_{CD} \) be defined similarly. We are to prove that
\[
|X_{AC}| + |X_{BD}| + 2 \le |X_{AB}| + |X_{CD}|.
\]
As a first step in this direction, we claim that
\begin{equation}
|X_{AC} \cup X_{BD}| + 2 \le |X_{AB} \cup X_{CD}|.
\end{equation}

Indeed, if \( g \) is a red line intersecting, e.g. the segment \( AC \) in its interior, then it has to intersect the triangle \( ACS \) once again, either in the interior of its side \( AS \), or in the interior of its side \( CS \), or at \( S \), meaning that it belongs to \( X_{AB} \) or to \( X_{CD} \). Moreover, the red lines \( AB \) and \( CD \) contribute to \( X_{AB} \cup X_{CD} \) but not to \( X_{AC} \cup X_{BD} \). Thereby (1) is proved.

Similarly but more easily one obtains
\begin{equation}
|X_{AC} \cap X_{BD}| \le |X_{AB} \cap X_{CD}|.
\end{equation}

Indeed, a red line \( h \) appearing in \( X_{AC} \cap X_{BD} \) belongs, for similar reasons as above, also to \( X_{AB} \cap X_{CD} \). To make the argument precise, one may just distinguish the cases \( S \in h \) and \( S \notin h \). Thereby (2) is proved.

Adding (1) and (2) we obtain the desired conclusion, thus completing the solution of this problem.
",1,combinatorics
2014c9,"There are \( n \) circles drawn on a piece of paper in such a way that any two circles intersect in two points, and no three circles pass through the same point. Turbo the snail slides along the circles in the following fashion. Initially he moves on one of the circles in clockwise direction. Turbo always keeps sliding along the current circle until he reaches an intersection with another circle. Then he continues his journey on this new circle and also changes the direction of moving, i.e. from clockwise to anticlockwise or \emph{vice versa}.

Suppose that Turbo’s path entirely covers all circles. Must \( n \) be odd? If the answer is 'Yes', give the value \(1\). Else give \(0\).
","Replace every cross (i.e. intersection of two circles) by two small circle arcs that indicate the direction in which the snail should leave the cross (see Figure 1.1). Notice that the placement of the small arcs does not depend on the direction of moving on the curves; no matter which direction the snail is moving on the circle arcs, he will follow the same curves (see Figure 1.2). In this way we have a set of curves, that are the possible paths of the snail. Call these curves \emph{snail orbits} or just \emph{orbits}. Every snail orbit is a simple closed curve that has no intersection with any other orbit.

We prove the following, more general statement.

\begin{quote}
\emph{(*) In any configuration of \( n \) circles such that no two of them are tangent, the number of snail orbits has the same parity as the number \( n \).}
\end{quote}

(Note that it is not assumed that all circle pairs intersect.)

This immediately solves the problem.

Let us introduce the following operation that will be called \emph{flipping a cross}. At a cross, remove the two small arcs of the orbits, and replace them by the other two arcs. Hence, when the snail arrives at a flipped cross, he will continue on the other circle as before, but he will preserve the orientation in which he goes along the circle arcs (see Figure 2).

Consider what happens to the number of orbits when a cross is flipped. Denote by \( a, b, c, \) and \( d \) the four arcs that meet at the cross such that \( a \) and \( b \) belong to the same circle. Before the flipping \( a \) and \( b \) were connected to \( c \) and \( d \), respectively, and after the flipping \( a \) and \( b \) are connected to \( d \) and \( c \), respectively.

The orbits passing through the cross are closed curves, so each of the arcs \( a, b, c, \) and \( d \) is connected to another one by orbits outside the cross. We distinguish three cases.

\textbf{Case 1:} \( a \) is connected to \( b \) and \( c \) is connected to \( d \) by the orbits outside the cross (see Figure 3.1).

We show that this case is impossible. Remove the two small arcs at the cross, connect \( a \) to \( b \), and connect \( c \) to \( d \) at the cross. Let \( \gamma \) be the new closed curve containing \( a \) and \( b \), and let \( \delta \) be the new curve that connects \( c \) and \( d \). These two curves intersect at the cross. So one of \( c \) and \( d \) is inside \( \gamma \) and the other one is outside \( \gamma \). Then the two closed curves have to meet at least one more time, but this is a contradiction, since no orbit can intersect itself.

\textbf{Case 2:} \( a \) is connected to \( c \) and \( b \) is connected to \( d \) (see Figure 3.2).

Before the flipping \( a \) and \( c \) belong to one orbit and \( b \) and \( d \) belong to another orbit. Flipping the cross merges the two orbits into a single orbit. Hence, the number of orbits decreases by 1.

\textbf{Case 3:} \( a \) is connected to \( d \) and \( b \) is connected to \( c \) (see Figure 3.3).

Before the flipping the arcs \( a, b, c, \) and \( d \) belong to a single orbit. Flipping the cross splits that orbit in two. The number of orbits increases by 1.

As can be seen, every flipping decreases or increases the number of orbits by one, thus changes its parity.

Now flip every cross, one by one. Since every pair of circles has 0 or 2 intersections, the number of crosses is even. Therefore, when all crosses have been flipped, the original parity of the number of orbits is restored. So it is sufficient to prove (*) for the new configuration, where all crosses are flipped. Of course also in this new configuration the (modified) orbits are simple closed curves not intersecting each other.

Orient the orbits in such a way that the snail always moves anticlockwise along the circle arcs. Figure 4 shows the same circles as in Figure 1 after flipping all crosses and adding orientation. (Note that this orientation may be different from the orientation of the orbit as a planar curve; the orientation of every orbit may be negative as well as positive, like the middle orbit in Figure 4.) If the snail moves around an orbit, the total angle change in his moving direction, the \emph{total curvature}, is either \( +2\pi \) or \( -2\pi \), depending on the orientation of the orbit. Let \( P \) and \( N \) be the number of orbits with positive and negative orientation, respectively. Then the total curvature of all orbits is \( (P - N) \cdot 2\pi \).

Double-count the total curvature of all orbits. Along every circle the total curvature is \( 2\pi \). At every cross, the two turnings make two changes with some angles having the same absolute value but opposite signs, as depicted in Figure 5. So the changes in the direction at the crosses cancel out. Hence, the total curvature is \( n \cdot 2\pi \).

Now we have \( (P - N) \cdot 2\pi = n \cdot 2\pi \), so \( P - N = n \). The number of (modified) orbits is \( P + N \), that has the same parity as \( P - N = n \).
",1,combinatorics
2014g6,"Let $ABC$ be a fixed acute-angled triangle. Consider some points $E$ and $F$ lying on the sides $AC$ and $AB$, respectively, and let $M$ be the midpoint of $EF$. Let the perpendicular bisector of $EF$ intersect the line $BC$ at $K$, and let the perpendicular bisector of $MK$ intersect the lines $AC$ and $AB$ at $S$ and $T$, respectively. We call the pair $(E, F)$ \textit{interesting}, if the quadrilateral $KSAT$ is cyclic.

Suppose that the pairs $(E_1, F_1)$ and $(E_2, F_2)$ are interesting. Give the value of 
\[
\frac{E_1E_2}{AB} \cdot \frac{AC}{F_1F_2}
\]
","Let $(E, F)$ be an interesting pair. This time we prove that
\[
\frac{AM}{AK} = \cos \angle A. \tag{5}
\]

As in Solution 1, we introduce the circle $\omega$ passing through the points $K$, $S$, $A$, and $T$, together with the points $N$ and $L$ at which the line $AM$ intersect the line $ST$ and the circle $\omega$ for the second time, respectively. Let moreover $O$ be the centre of $\omega$ (see Figures 8 and 9). As in Solution 1, we note that $N$ is the midpoint of $ST$ and show that $KL \parallel ST$, which implies $\angle FAM = \angle EAK$.

\textit{Case 1: $K \ne L$}. Then $KL \parallel ST$, and consequently the lines $KM$ and $KL$ are perpendicular. It implies that the lines $LO$ and $KM$ meet at a point $X$ lying on the circle $\omega$. Since the lines $ON$ and $XM$ are both perpendicular to the line $ST$, they are parallel to each other, and hence $\angle LON = \angle LXK = \angle MAK$. On the other hand, $\angle OLN = \angle MKA$, so we infer that triangles $NOL$ and $MAK$ are similar. This yields
\[
\frac{AM}{AK} = \frac{ON}{OL} = \frac{ON}{OT} = \cos \angle TON = \cos \angle A.
\]

\textit{Case 2: $K = L$}. Then the points $A$, $M$, $N$, and $K$ lie on a common line, and this line is the perpendicular bisector of $ST$ (see Figure 9). This implies that $AK$ is a diameter of $\omega$, which yields $AM = 2OK = 2NK = 2ON$. So also in this case we obtain
\[
\frac{AM}{AK} = \frac{2ON}{2OT} = \cos \angle TON = \cos \angle A.
\]

Thus (5) is proved.

Let $P$ and $Q$ be the feet of the perpendiculars from $B$ and $C$ onto $AC$ and $AB$, respectively (see Figure 10). We claim that the point $M$ lies on the line $PQ$. Consider now the composition of the dilatation with factor $\cos \angle A$ and centre $A$, and the reflection with respect to the angle bisector of $\angle BAC$. This transformation is a similarity that takes $B$, $C$, and $K$ to $P$, $Q$, and $M$, respectively. Since $K$ lies on the line $BC$, the point $M$ lies on the line $PQ$.

Suppose that $E \ne P$. Then also $F \ne Q$, and by \textsc{Menelaus}' theorem, we obtain
\[
\frac{AQ}{FQ} \cdot \frac{FM}{EM} \cdot \frac{EP}{AP} = 1.
\]
Using the similarity of the triangles $APQ$ and $ABC$, we infer that
\[
\frac{EP}{FQ} = \frac{AP}{AQ} = \frac{AB}{AC}, \quad \text{and hence} \quad \frac{EP}{AB} = \frac{FQ}{AC}.
\]
The last equality holds obviously also in case $E = P$, because then $F = Q$. Moreover, since the line $PQ$ intersects the segment $EF$, we infer that the point $E$ lies on the segment $AP$ if and only if the point $F$ lies outside of the segment $AQ$.

Let now $(E_1, F_1)$ and $(E_2, F_2)$ be two interesting pairs. Then we obtain
\[
\frac{E_1 P}{AB} = \frac{F_1 Q}{AC} \quad \text{and} \quad \frac{E_2 P}{AB} = \frac{F_2 Q}{AC}.
\]
If $P$ lies between the points $E_1$ and $E_2$, we add the equalities above, otherwise we subtract them. In any case we obtain
\[
\frac{E_1 E_2}{AB} = \frac{F_1 F_2}{AC},
\]
which completes the solution.
So \(\frac{E_1E_2}{AB} \cdot \frac{AC}{F_1F_2}=1\)",1,geometry
2014n1,"Let $n \geq 2$ be an integer, and let $A_n$ be the set
\[
A_n = \{2^n - 2^k \mid k \in \mathbb{Z},\, 0 \leq k < n \}.
\]
Determine the largest positive integer that cannot be written as the sum of one or more (not necessarily distinct) elements of $A_n$ when \(n=10\).
","Denote by $B_n$ the set of all positive integers that can be written as a sum of elements of $A_n$. In this solution, we explicitly describe all the numbers in $B_n$ by an argument similar to the first solution.

For a positive integer $n$, we denote by $\sigma_2(n)$ the sum of its digits in the binary representation. Notice that every positive integer $m$ has a unique representation of the form $m = s2^n - t$ with some positive integer $s$ and $0 \leq t < 2^n - 1$.

\textbf{Lemma.} For any two integers $s \geq 1$ and $0 \leq t \leq 2^n - 1$, the number $m = s2^n - t$ belongs to $B_n$ if and only if $s > \sigma_2(t)$.

\textit{Proof.} For $t = 0$, the statement of the Lemma is obvious, since $m = 2s \cdot (2^n - 2^{n-1})$.

Now suppose that $t \geq 1$, and let
\[
t = 2^{k_1} + \cdots + 2^{k_\sigma} \qquad (0 \leq k_1 < \cdots < k_\sigma < n-1, \quad \sigma = \sigma_2(t))
\]
be its binary expansion. If $s > \sigma$, then $m \in B_n$, since
\begin{align*}
m &= (s - \sigma)2^n + (\sigma 2^n - t) = 2(s - \sigma) \cdot (2^n - 2^{n-1}) + \sigma \sum_{i = 1}^{\sigma} (2^n - 2^{k_i}).
\end{align*}

Assume now that there exist integers $s$ and $t$ with $1 \leq s \leq \sigma_2(t)$ and $0 < t < 2^n - 1$ such that the number $m = s2^n - t$ belongs to $B_n$. Among all such instances, choose the one for which $m$ is smallest, and let
\[
m = \sum_{i = 1}^{d} (2^n - 2^{\ell_i}) \qquad (0 \leq \ell_i < n - 1)
\]
be the corresponding representation. If all the $\ell_i$ are distinct, then $\sum_{i=1}^{d} 2^{\ell_i} \leq \sum_{j=0}^{n-1} 2^j = 2^n - 1$, so one has $s = d$ and $t = \sum_{i=1}^{d} 2^{\ell_i}$, whence $s = d = \sigma_2(t)$; this is impossible. Therefore, two of the $\ell_i$ must be equal, say $\ell_{d-1} = \ell_d$. Then $m > 2(2^n - 2^{\ell_d}) > 2^n$, so $s \geq 2$.

Now we claim that the number $m' = m - 2^n = (s - 1)2^n - t$ also belongs to $B_n$, which contradicts the minimality assumption. Indeed, one has
\[
(2^n - 2^{\ell_{d-1}}) + (2^n - 2^{\ell_d}) = 2(2^n - 2^{\ell_d}) = 2^n + (2^n - 2^{\ell_d + 1}),
\]
so
\[
m' = \sum_{i=1}^{d - 2} (2^n - 2^{\ell_i}) + (2^n - 2^{\ell_d + 1})
\]
is the desired representation of $m'$ (if $\ell_d = n - 1$, then the last summand is simply omitted). This contradiction finishes the proof. $\hfill \square$

By our lemma, the largest number $M$ which does not belong to $B_n$ must have the form
\[
m_t = (\sigma_2(t) - 1)2^n - t
\]
for some $t$ with $1 \leq t < 2^n - 1$, so $M$ is just the largest of these numbers. For $t_0 = 2^n - 1$ we have $m_0 = (n - 1)2^n - (2^n - 1) = (n - 2)2^n + 1$; for every other value of $t$ one has $\sigma_2(t) < n - 1$, thus $m_t \leq (\sigma(t) - 1)2^n \leq (n - 2)2^n < m_{t_0}$. This means that $M = m_{t_0} = (n - 2)2^n + 1$.
So when \(n=10\), the answer is \(8193\)",8193,number theory
2014n2,"Determine all pairs $(x, y)$ of positive integers such that
\[
\sqrt[3]{7x^2 - 13xy + 7y^2} = |x - y| + 1.
\]
Calculate the sum of the quantity \[ (x+y) \] over every such pair that \(x+y<30\).","Either $(x, y) = (1, 1)$ or $\{x, y\} = \{m^3 + m^2 - 2m - 1,\; m^3 + 2m^2 - m - 1\}$ for some positive integer $m \geq 2$.

\textbf{Solution.} Let $(x, y)$ be any pair of positive integers solving (1). We shall prove that it appears in the list displayed above. The converse assertion that all these pairs do actually satisfy (1) either may be checked directly by means of a somewhat laborious calculation, or it can be seen by going in reverse through the displayed equations that follow.

In case $x = y$ the given equation reduces to $x^{2/3} = 1$, which is equivalent to $x = 1$, whereby we have found the first solution.

To find the solutions with $x \neq y$ we may assume $x > y$ due to symmetry. Then the integer $n = x - y$ is positive and (1) may be rewritten as
\[
\sqrt[3]{7(y + n)^2 - 13(y + n)y + 7y^2} = n + 1.
\]
Raising this to the third power and simplifying the result one obtains
\[
y^2 + yn = n^3 - 4n^2 + 3n + 1.
\]
To complete the square on the left hand side, we multiply by 4 and add $n^2$, thus getting
\[
(2y + n)^2 = 4n^3 - 15n^2 + 12n + 4 = (n - 2)^2(4n + 1).
\]

This shows that the cases $n = 1$ and $n = 2$ are impossible, whence $n > 2$, and $4n + 1$ is the square of the rational number $\frac{2y+n}{n-2}$. Consequently, it has to be a perfect square, and, since it is odd as well, there has to exist some nonnegative integer $m$ such that $4n + 1 = (2m + 1)^2$, i.e.
\[
n = m^2 + m.
\]

Notice that $n > 2$ entails $m \geq 2$. Substituting the value of $n$ just found into the previous displayed equation we arrive at
\[
(2y + m^2 + m)^2 = (m^2 + m - 2)^2(2m + 1)^2 = (2m^3 + 3m^2 - 3m - 2)^2.
\]

Extracting square roots and taking $2m^3 + 3m^2 - 3m - 2 = (m - 1)(2m^2 + 5m + 2) > 0$ into account we derive $2y + m^2 + m = 2m^3 + 3m^2 - 3m - 2$, which in turn yields
\[
y = m^3 + m^2 - 2m - 1.
\]

Notice that $m \geq 2$ implies that $y = (m - 1) + (m - 2)m$ is indeed positive, as it should be. In view of $x = y + n = y + m^2 + m$ it also follows that
\[
x = m^3 + 2m^2 - m - 1,
\]
and that this integer is positive as well.
So the answer is either $(x, y) = (1, 1)$ or $\{x, y\} = \{m^3 + m^2 - 2m - 1,\; m^3 + 2m^2 - m - 1\}$ for some positive integer $m \geq 2$. The possible pairs that \(x+y<30\) are \( (1,1) \), \( (7,13) \) and \( (13,7) \). So the sum is \(42\).",42,number theory
2014n3,"A coin is called a \emph{Cape Town coin} if its value is $1/n$ for some positive integer $n$. Given a collection of Cape Town coins of total value at most $99 + \tfrac{1}{2}$, is it possible to split this collection into at most $100$ groups each of total value at most $1$.
If the answer is 'Yes', give the value \(1\). Else give \(0\).","We will show that for every positive integer $N$ any collection of Cape Town coins of total value at most $N - \tfrac{1}{2}$ can be split into $N$ groups each of total value at most $1$. The problem statement is a particular case for $N = 100$.

We start with some preparations. If several given coins together have a total value also of the form $\tfrac{1}{k}$ for a positive integer $k$, then we may merge them into one new coin. Clearly, if the resulting collection can be split in the required way then the initial collection can also be split.

After each such merging, the total number of coins decreases, thus at some moment we come to a situation when no more merging is possible. At this moment, for every even $k$ there is at most one coin of value $\tfrac{1}{k}$ (otherwise two such coins may be merged), and for every odd $k > 1$ there are at most $k - 1$ coins of value $\tfrac{1}{k}$ (otherwise $k$ such coins may also be merged).

Now, clearly, each coin of value $1$ should form a single group; if there are $d$ such coins then we may remove them from the collection and replace $N$ by $N - d$. So from now on we may assume that there are no coins of value $1$.

Finally, we may split all the coins in the following way. For each $k = 1, 2, \dots, N$ we put all the coins of values $\tfrac{1}{2k-1}$ and $\tfrac{1}{2k}$ into a group $G_k$; the total value of $G_k$ does not exceed
\[
(2k - 2) \cdot \frac{1}{2k - 1} + \frac{1}{2k} < 1.
\]

It remains to distribute the “small” coins of values which are less than $\tfrac{1}{2N}$; we will add them one by one. In each step, take any remaining small coin. The total value of coins in the groups at this moment is at most $N - \tfrac{1}{2}$, so there exists a group of total value at most $\tfrac{1}{N} (N - \tfrac{1}{2}) = 1 - \tfrac{1}{2N}$; thus it is possible to put our small coin into this group. Acting so, we will finally distribute all the coins.
",1,number theory
2014n5,"Find all triples $(p, x, y)$ consisting of a prime number $p$ and two positive integers $x$ and $y$ such that $x^{p-1} + y$ and $x + y^{p-1}$ are both powers of $p$. Calculate the sum of the quantity \[ (p+x+y) \] over every such triple when \(p=3\).
","\textbf{Solution 1.} For $p = 2$, clearly all pairs of two positive integers $x$ and $y$ whose sum is a power of $2$ satisfy the condition. Thus we assume in the following that $p > 2$, and we let $a$ and $b$ be positive integers such that $x^{p-1} + y = p^a$ and $x + y^{p-1} = p^b$. Assume further, without loss of generality, that $x \le y$, so that $p^a = x^{p-1} + y \le x + y^{p-1} = p^b$, which means that $a \le b$ (and thus $p^a \mid p^b$).

Now we have
\[
p^b = y^{p-1} + x = (p^a - x^{p-1})^{p-1} + x.
\]
We take this equation modulo $p^a$ and take into account that $p - 1$ is even, which gives us
\[
0 \equiv x^{(p-1)^2} + x \pmod{p^a}.
\]

If $p \mid x$, then $p^a \mid x$, since $x^{(p-1)^2} + 1$ is not divisible by $p$ in this case. However, this is impossible, since $x < x^{p-1} < p^a$. Thus we know that $p \nmid x$, which means that
\[
p^a \mid x^{(p-1)^2} + 1 = x^{p(p-2)} + 1.
\]

By Fermat’s little theorem, $x^{p(p-2)} \equiv 1 \pmod{p}$, thus $p$ divides $x + 1$. Let $p^r$ be the highest power of $p$ that divides $x + 1$. By the binomial theorem, we have
\[
x^{p(p-2)} = \sum_{k=0}^{p(p-2)} \binom{p(p-2)}{k} (-1)^{p(p-2)-k}(x+1)^k.
\]

Except for the terms corresponding to $k = 0$, $k = 1$ and $k = 2$, all terms in the sum are clearly divisible by $p^{3r}$ and thus by $p^{r+2}$. The remaining terms are
\[
- \frac{p(p-2)(p^2 - 2p - 1)}{2} (x+1)^2,
\]
which is divisible by $p^{r+1}$ and thus also by $p^{r+2}$, 
\[
p(p-2)(x+1),
\]
which is divisible by $p^{r+1}$, but not $p^{r+2}$ by our choice of $r$, and the final term $-1$ corresponding to $k = 0$. It follows that the highest power of $p$ that divides $x^{p(p-2)} + 1$ is $p^{r+1}$.

On the other hand, we already know that $p^a$ divides $x^{p(p-2)} + 1$, which means that $a \le r + 1$. Moreover,
\[
p^r \le x + 1 \le x^{p-1} + y = p^a.
\]

Hence we either have $a = r$ or $a = r + 1$.

If $a = r$, then $x = y - 1$ needs to hold in the inequality above, which is impossible for $p > 2$. Thus $a = r + 1$. Now since $p^r \le x + 1$, we get
\[
x = \frac{x^2 + x}{x+1} \le \frac{x^{p-1} + y}{x+1} = \frac{p^a}{x+1} \le \frac{p^a}{p^r} = p,
\]
so we must have $x = p - 1$ for $p$ to divide $x + 1$.

It follows that $x = 1$ and $a = 2$. If $p > 5$, we obtain
\[
p^a = x^{p-1} + y = (p - 1)^4 = (p^2 - 2p + 1)^2 \ge (3p)^2 > p^2 = p^a,
\]
a contradiction. So the only case that remains is $p = 3$, and indeed $x = 2$ and $y = p^a - x^{p-1} = 5$ satisfy the conditions.
\ (p, x, y) \in \{(3, 2, 5), (3, 5, 2)\} \cup \{(2, n, 2^k - n) \mid 0 < n < 2^k\}. So when \(p=3\), the sum is \(20\).
",20,number theory
2013a1,"Let $n$ be a positive integer and let $a_1, \ldots, a_{n-1}$ be arbitrary real numbers. Define the sequences $u_0, \ldots, u_n$ and $v_0, \ldots, v_n$ inductively by $u_0 = u_1 = v_0 = v_1 = 1$, and
\[
u_{k+1} = u_k + a_k u_{k-1}, \quad v_{k+1} = v_k + a_{n-k} v_{k-1} \quad \text{for } k = 1, \ldots, n-1.
\]
When \(n=2013\), what is the value of \(\frac{u_n}{v_n}\)?
","We prove by induction on $k$ that
\begin{equation}
u_k = \sum_{\substack{0 < i_1 < \cdots < i_t < k, \\ i_{j+1} - i_j \ge 2}} a_{i_1} \cdots a_{i_t}. \tag{1}
\end{equation}

Note that we have one trivial summand equal to $1$ (which corresponds to $t = 0$ and the empty sequence, whose product is $1$).

For $k = 0$, the sum on the right-hand side only contains the empty product, so (1) holds due to $u_0 = u_1 = 1$. For $k \ge 1$, assuming the result is true for $0, 1, \ldots, k$, we have

\[
\begin{aligned}
u_{k+1} &= \sum_{\substack{0 < i_1 < \cdots < i_t < k, \\ i_{j+1} - i_j \ge 2}} a_{i_1} \cdots a_{i_t}
+ \sum_{\substack{0 < i_1 < \cdots < i_{t-1} < k-1, \\ i_{j+1} - i_j \ge 2}} a_{i_1} \cdots a_{i_{t-1}} a_k \\
&= \sum_{\substack{0 < i_1 < \cdots < i_t < k+1, \\ i_{j+1} - i_j \ge 2}} a_{i_1} \cdots a_{i_t},
\end{aligned}
\]

as required.

Applying (1) to the sequence $b_1, \ldots, b_n$ given by $b_k = a_{n-k}$ for $1 \le k \le n$, we get

\begin{equation}
v_k = \sum_{\substack{0 < i_1 < \cdots < i_t < k, \\ i_{j+1} - i_j \ge 2}} b_{i_1} \cdots b_{i_t}
= \sum_{\substack{n > i_1 > \cdots > i_t > n-k, \\ i_j - i_{j+1} \ge 2}} a_{i_1} \cdots a_{i_t}. \tag{2}
\end{equation}

For $k = n$ the expressions (1) and (2) coincide, so indeed $u_n = v_n$.
So the value of \(\frac{u_n}{v_n}\) is \(1\).",1,algebra
2013a5,"Let \( \mathbb{Z}_{\geq 0} \) be the set of all nonnegative integers. Find all the functions \( f : \mathbb{Z}_{\geq 0} \to \mathbb{Z}_{\geq 0} \) satisfying the relation
\[
f(f(f(n))) = f(n+1) + 1 \tag{*}
\]
for all \( n \in \mathbb{Z}_{\geq 0} \).
What is the value of \(f(2013)\) if \(f(1)=6\)?","Throughout all the solutions, we write \( h^k(x) \) to abbreviate the \( k \)th iteration of function \( h \), so \( h^0 \) is the identity function, and \( h^k(x) = h(\dotsb h(x)\dotsb) \) for \( k \geq 1 \).

To start, we get from (*) that
\[
f^4(n) = f(f^3(n)) = f(f(f(f(n+1)))) = f(f(f(n+1) + 1)),
\]
and
\[
f^4(n+1) = f^3(f(n+1)) = f(f(f(n+1)) + 1),
\]
thus
\[
f^4(n) + 1 = f^4(n+1). \tag{2}
\]

I. Let us denote by \( R_i \) the range of \( f^i \); note that \( R_0 = \mathbb{Z}_{\geq 0} \) since \( f^0 \) is the identity function. Obviously, \( R_0 \supseteq R_1 \supseteq \dotsb \). Next, from (2) we get that if \( a \in R_4 \), then also \( a+1 \in R_4 \). This implies that \( \mathbb{Z}_{\geq 0} \setminus R_4 \), and hence \( \mathbb{Z}_{\geq 0} \setminus R_1 \), is finite. In particular, \( R_1 \) is unbounded.

Assume that \( f(m) = f(n) \) for some distinct \( m \) and \( n \). Then from (*) we obtain \( f(m+1) = f(n+1) + 1 \); by an easy induction we then get that \( f(m + c) = f(n + c) \) for every \( c \geq 0 \). So the function \( f(k) \) is periodic with period \( |m - n| \) for \( k \gg m \), and thus \( R_1 \) should be bounded, which is false. So \( f \) is injective.

II. Denote now \( S_i = R_{i-1} \setminus R_i \); all these sets are finite for \( i \leq 4 \). On the other hand, by the injectivity we have \( n \in S_i \iff f(n) \in S_{i+1} \). By the injectivity again, \( f \) implements a bijection between \( S_i \) and \( S_{i+1} \), thus \( |S_1| = |S_2| = \dotsb \). Denote this common cardinality by \( k \). If \( 0 \in R_3 \), then \( 0 = f(f(f(n))) \) for some \( n \), thus from (*) we get \( f(n+1) = -1 \), which is impossible. Therefore \( 0 \in R_0 \setminus R_3 = S_1 \cup S_2 \cup S_3 \), thus \( k \geq 1 \).

Next, let us describe the elements \( b \) of \( R_0 \setminus R_3 = S_1 \cup S_2 \cup S_3 \). We claim that each such element satisfies at least one of the three conditions (i) \( b = 0 \), (ii) \( b = f(0)+1 \), and (iii) \( b-1 \in S_1 \). Otherwise \( b - 1 \in \mathbb{Z}_{\geq 0} \), and there exists some \( n > 0 \) such that \( f(n) = b - 1 \); but then \( f^3(n-1) = f(n) + 1 = b \), so \( b \in R_3 \).

This yields
\[
3k = |S_1 \cup S_2 \cup S_3| \leq 1 + 1 + |S_1| = k + 2,
\]
or \( k \leq 1 \). Therefore \( k = 1 \), and the inequality above comes to equality. So we have \( S_1 = \{a\} \), \( S_2 = \{f(a)\} \), and \( S_3 = \{f^2(a)\} \) for some \( a \in \mathbb{Z}_{\geq 0} \), and each one of the three options (i), (ii), and (iii) should be realized exactly once, which means that
\[
\{a, f(a), f^2(a)\} = \{0, a+1, f(0)+1\}. \tag{3}
\]

III. From (3), we get \( a+1 \in \{f(a), f^2(a)\} \) (the case \( a+1 = a \) is impossible). If \( a+1 = f^2(a) \), then we have \( f(a+1) = f^3(a) = f(f(a) + 1) + 1 \), which is absurd. Therefore
\[
f(a) = a + 1. \tag{4}
\]

Next, again from (3) we have \( 0 \in \{a, f^2(a)\} \). Let us consider these two cases separately.

\textbf{Case 1.} Assume that \( a = 0 \), then \( f(0) = f(a) = a + 1 = 1 \). Also from (3) we get \( f(1) = f^2(a) = f(0) + 1 = 2 \). Now, let us show that \( f(n) = n+1 \) by induction on \( n \); the base cases \( n \leq 1 \) are established. Next, if \( n \geq 2 \), then the induction hypothesis implies
\[
n + 1 = f(n - 1) + 1 = f^3(n - 2) = f^2(f(n - 1)) = f(n),
\]
establishing the step. In this case we have obtained the first of two answers.

\textbf{Case 2.} Assume now that \( f^2(a) = 0 \); then by (3) we get \( a = f(0) + 1 \). By (4) we get \( f(a+1) = f^2(a) = 0 \), then \( f(0) = f^3(a) = f(a + 1) + 1 = 1 \), hence \( a = f(0) + 1 = 2 \) and \( f(2) = 3 \) by (4). To summarize,
\[
f(0) = 1, \quad f(2) = 3, \quad f(3) = 0.
\]

Now let us prove by induction on \( m \) that (1) holds for all \( n = 4k, 4k+2, 4k+3 \) with \( k \leq m \) and for all \( n = 4k + 1 \) with \( k < m \). The base case \( m = 0 \) is established above. For the step, assume that \( m \geq 1 \). From (*) we get \( f^3(4m - 3) = f(4m - 2) + 1 = 4m \). Next, by (2) we have
\[
f(4m) = f^4(4m - 3) = f^4(4m - 4) + 1 = f^3(4m - 3) + 1 = 4m + 1.
\]
Then by the induction hypothesis together with (*) we successively obtain
\begin{align*}
f(4m - 3) &= f^3(4m - 1) = f(4m) + 1 = 4m + 2, \\
f(4m - 2) &= f^3(4m - 4) = f(4m - 3) + 1 = 4m + 3, \\
f(4m + 3) &= f^3(4m - 3) = f(4m - 2) + 1 = 4m,
\end{align*}
thus finishing the induction step.

Finally, it is straightforward to check that the constructed function works:
\[
\begin{aligned}
f^3(4k) &= 4k + 7 = f(f(4k + 1) + 1), \\
f^3(4k + 1) &= 4k + 1 = f(f(4k + 3) + 1), \\
f^3(4k + 2) &= 4k + 1 = f(f(4k + 4) + 1), \\
f^3(4k + 3) &= 4k + 6 = f(f(4k + 4) + 1).
\end{aligned}
\]

So there are two such functions: \( f(n) = n+1 \) for all \( n \in \mathbb{Z}_{\geq 0} \), and
\[
f(n) = 
\begin{cases}
n+1, & n \equiv 0 \pmod{4} \text{ or } n \equiv 2 \pmod{4}, \\
n+5, & n \equiv 1 \pmod{4}, \\
n-3, & n \equiv 3 \pmod{4}
\end{cases}
\quad \text{for all } n \in \mathbb{Z}_{\geq 0}.
\]
If \(f(1)=6\), the value of \(f(2013)\) is \(2018\).",2018,algebra
2013a6,"Let \( m \ne 0 \) be an integer. Find all polynomials \( P(x) \) with real coefficients such that
\[
(x^3 - mx^2 + 1)P(x+1) + (x^3 + mx^2 + 1)P(x-1) = 2(x^3 - mx + 1)P(x) \tag{1}
\]
for all real numbers \( x \). \hfill \textit{(Serbia)}

What is the value of \( P(2013)\) if \( P(1)=3\)?
","Let \( P(x) = a_n x^n + \cdots + a_0 x^0 \) with \( a_n \ne 0 \). Comparing the coefficients of \( x^{n+1} \) on both sides gives \( a_n(n - 2m)(n - 1) = 0 \), so \( n = 1 \) or \( n = 2m \).

If \( n = 1 \), one easily verifies that \( P(x) = tx \) is a solution, while \( P(x) = 1 \) is not. Since the given condition is linear in \( P \), this means that the linear solutions are precisely \( P(x) = tx \) for \( t \in \mathbb{R} \).

Now assume that \( n = 2m \). The polynomial \( xP(x+1) - (x+1)P(x) = (n-1)a_n x^n + \cdots \) has degree \( n \), and therefore it has at least one (possibly complex) root \( r \). If \( r \not\in \{0, -1\} \), define \( k = P(r)/r = P(r+1)/(r+1) \). If \( r = 0 \), let \( k = P(1) \). If \( r = -1 \), let \( k = -P(-1) \). We now consider the polynomial \( S(x) = P(x) - kx \). It also satisfies (1) because \( P(x) \) and \( kx \) satisfy it. Additionally, it has the useful property that \( r \) and \( r+1 \) are roots.

Let \( A(x) = x^3 - mx^2 + 1 \) and \( B(x) = x^3 + mx^2 + 1 \). Plugging in \( x = s \) into (1) implies that:

\begin{itemize}
    \item If \( s - 1 \) and \( s \) are roots of \( S \) and \( s \) is not a root of \( A \), then \( s + 1 \) is a root of \( S \).
    \item If \( s \) and \( s + 1 \) are roots of \( S \) and \( s \) is not a root of \( B \), then \( s - 1 \) is a root of \( S \).
\end{itemize}

Let \( a \ge 0 \) and \( b \ge 1 \) be such that \( r - a,\, r - a + 1, \ldots, r,\, r+1, \ldots, r + b - 1,\, r + b \) are roots of \( S \), while \( r - a - 1 \) and \( r + b + 1 \) are not. The two statements above imply that \( r - a \) is a root of \( B \) and \( r + b \) is a root of \( A \).

Since \( r - a \) is a root of \( B(x) \) and \( A(x + a + b) \), it is also a root of their greatest common divisor \( C(x) \) as integer polynomials. If \( C(x) \) was a non-trivial divisor of \( B(x) \), then \( B \) would have a rational root \( \alpha \). Since the first and last coefficients of \( B \) are 1, \( \alpha \) can only be 1 or -1; but \( B(-1) = m > 0 \) and \( B(1) = m + 2 > 0 \) since \( n = 2m \).

Therefore \( B(x) = A(x + a + b) \). Writing \( c = a + b \ge 1 \) we compute
\[
0 = A(x + c) - B(x) = (3c - 2m)x^2 + c(3c - 2m)x + c^2(c - m).
\]
Then we must have \( 3c - 2m = c - m = 0 \), which gives \( m = 0 \), a contradiction. We conclude that \( f(x) = tx \) is the only solution.
So if \( P(1)=3\), the value of \( P(2013)\) is \(6039\).",6039,algebra
2013c1,"Let \( n \) be a positive integer. Find the smallest integer \( k \) when \(n=2013\) with the following property: Given any real numbers \( a_1, \ldots, a_d \) such that \( a_1 + a_2 + \cdots + a_d = n \) and \( 0 \leq a_i \leq 1 \) for \( i = 1, 2, \ldots, d \), it is possible to partition these numbers into \( k \) groups (some of which may be empty) such that the sum of the numbers in each group is at most 1.
","If \( d = 2n - 1 \) and \( a_1 = \cdots = a_{2n-1} = n/(2n - 1) \), then each group in such a partition can contain at most one number, since \( 2n/(2n - 1) > 1 \). Therefore \( k \geq 2n - 1 \). It remains to show that a suitable partition into \( 2n - 1 \) groups always exists.

We proceed by induction on \( d \). For \( d \leq 2n - 1 \) the result is trivial. If \( d \geq 2n \), then since
\[
(a_1 + a_2) + \cdots + (a_{2n-1} + a_{2n}) \leq n
\]
we may find two numbers \( a_i, a_{i+1} \) such that \( a_i + a_{i+1} \leq 1 \). We “merge” these two numbers into one new number \( a_i + a_{i+1} \). By the induction hypothesis, a suitable partition exists for the \( d - 1 \) numbers \( a_1, \ldots, a_{i-1}, a_i + a_{i+1}, a_{i+2}, \ldots, a_d \). This induces a suitable partition for \( a_1, \ldots, a_d \).
So \( k = 2n - 1 \). The value of \(f(2013)\) is \(4025\).",4025,combinatorics
2013c2,"In the plane, 2013 red points and 2014 blue points are marked so that no three of the marked points are collinear. One needs to draw \( k \) lines not passing through the marked points and dividing the plane into several regions. The goal is to do it in such a way that no region contains points of both colors.

Find the minimal value of \( k \) such that the goal is attainable for every possible configuration of 4027 points.
","Firstly, let us present an example showing that \( k \geq 2013 \). Mark 2013 red and 2013 blue points on some circle alternately, and mark one more blue point somewhere in the plane. The circle is thus split into 4026 arcs, each arc having endpoints of different colors. Thus, if the goal is reached, then each arc should intersect some of the drawn lines. Since any line contains at most two points of the circle, one needs at least \( 4026 / 2 = 2013 \) lines.

It remains to prove that one can reach the goal using 2013 lines. First of all, let us mention that for every two points \( A \) and \( B \) having the same color, one can draw two lines separating these points from all other ones. Namely, it suffices to take two lines parallel to \( AB \) and lying on different sides of \( AB \) sufficiently close to it: the only two points between these lines will be \( A \) and \( B \).

Now, let \( P \) be the convex hull of all marked points. Two cases are possible.

\textbf{Case 1.} Assume that \( P \) has a red vertex \( A \). Then one may draw a line separating \( A \) from all the other points, pair up the other 2012 red points into 1006 pairs, and separate each pair from the other points by two lines. Thus, 2013 lines will be used.

\textbf{Case 2.} Assume now that all the vertices of \( P \) are blue. Consider any two consecutive vertices of \( P \), say \( A \) and \( B \). One may separate these two points from the others by a line parallel to \( AB \). Then, as in the previous case, one pairs up all the other 2012 blue points into 1006 pairs, and separates each pair from the other points by two lines. Again, 2013 lines will be used.
",2013,combinatorics
2013c4,"Let \( n \) be a positive integer, and let \( A \) be a subset of \( \{1, \ldots, n\} \). An \emph{\( A \)-partition} of \( n \) into \( k \) parts is a representation of \( n \) as a sum \( n = a_1 + \cdots + a_k \), where the parts \( a_1, \ldots, a_k \) belong to \( A \) and are not necessarily distinct. The \emph{number of different parts} in such a partition is the number of (distinct) elements in the set \( \{a_1, a_2, \ldots, a_k\} \).

We say that an \( A \)-partition of \( n \) into \( k \) parts is \emph{optimal} if there is no \( A \)-partition of \( n \) into \( r \) parts with \( r < k \). How many different parts does any optimal \( A \)-partition of \( n \) contain at most when \(n=36\)?","If there are no \( A \)-partitions of \( n \), the result is vacuously true. Otherwise, let \( k_{\min} \) be the minimum number of parts in an \( A \)-partition of \( n \), and let \( n = a_1 + \cdots + a_{k_{\min}} \) be an optimal partition. Denote by \( s \) the number of different parts in this partition, so we can write \( S = \{a_1, \ldots, a_{k_{\min}}\} = \{b_1, \ldots, b_s\} \) for some pairwise different numbers \( b_1 < \cdots < b_s \) in \( A \).

If \( s > \sqrt[3]{6n} \), we will prove that there exist subsets \( X \) and \( Y \) of \( S \) such that \( |X| < |Y| \) and \( \sum_{x \in X} x = \sum_{y \in Y} y \). Then, deleting the elements of \( Y \) from our partition and adding the elements of \( X \) to it, we obtain an \( A \)-partition of \( n \) into less than \( k_{\min} \) parts, which is the desired contradiction.

For each positive integer \( k \leq s \), we consider the \( k \)-element subset
\[
S^k_{i,0} := \{b_1, \ldots, b_k\}
\]
as well as the following \( k \)-element subsets \( S^k_{i,j} \) of \( S \):
\[
S^k_{i,j} := \{b_1, \ldots, b_{k-i}, b_{k-i+j+1}, b_{k-i+2}, \ldots, b_s\}, \quad i = 1, \ldots, k, \quad j = 1, \ldots, s-k.
\]

Pictorially, if we represent the elements of \( S \) by a sequence of dots in increasing order, and represent a subset of \( S \) by shading in the appropriate dots, we have:

\[
S^k_{i,j} = \underbrace{\bullet \cdots \bullet}_{k-i} \circ \cdots \circ \underbrace{\bullet \cdots \bullet}_{i-1}
\]

Denote by \( \Sigma^k_{i,j} \) the sum of elements in \( S^k_{i,j} \). Clearly, \( \Sigma^k_{0,0} \) is the minimum sum of a \( k \)-element subset of \( S \). Next, for all appropriate indices \( i \) and \( j \), we have:
\[
\Sigma^k_{i,j} = \Sigma^k_{i,j+1} + b_{k-i+j+1} - b_{k-i+j+2} < \Sigma^k_{i,j+1}, \quad \text{and} \quad \Sigma^k_{i,s-k} = \Sigma^k_{i+1,1} + b_{k-i} - b_{k-i+1} < \Sigma^k_{i+1,1}.
\]

Therefore,
\[
1 \leq \Sigma^k_{1,0} < \Sigma^k_{1,1} < \Sigma^k_{1,2} < \cdots < \Sigma^k_{1,s-k} < \Sigma^k_{2,1} < \cdots < \Sigma^k_{2,s-k} < \cdots < \Sigma^k_{k,1} < \cdots < \Sigma^k_{k,s-k} \leq n.
\]

To see this in the picture, we start with the \( k \) leftmost points marked. At each step, we look for the rightmost point which can move to the right, and move it one unit to the right. We continue until the \( k \) rightmost points are marked. As we do this, the corresponding sums clearly increase.

For each \( k \) we have found \( k(s-k)+1 \) different integers of the form \( \Sigma^k_{i,j} \) between \( 1 \) and \( n \). As we vary \( k \), the total number of integers we are considering is:
\[
\sum_{k=1}^{s} (k(s-k)+1) = s \cdot \frac{s(s+1)}{2} - \frac{s(s+1)(2s+1)}{6} + s = \frac{s(s^2+5)}{6} > \frac{s^3}{6} > n.
\]

Since they are between \( 1 \) and \( n \), at least two of these integers are equal. Consequently, there exist \( 1 \leq k < k' \leq s \) and \( X = S^k_{i,j} \) as well as \( Y = S^{k'}_{i',j'} \) such that
\[
\sum_{x \in X} x = \sum_{y \in Y} y, \quad \text{but } |X| = k < k' = |Y|,
\]
as required. The result follows.
So any optimal \( A \)-partition of \( n \) contains at most \( \sqrt[3]{6n} \) different parts. When \(n=36\), the answer is \(6\).",6,combinatorics
2013c6,"In some country several pairs of cities are connected by direct two-way flights. It is possible to go from any city to any other by a sequence of flights. The \emph{distance} between two cities is defined to be the least possible number of flights required to go from one of them to the other. It is known that for any city there are at most 100 cities at distance exactly three from it. Is there any city such that more than 2550 other cities have distance exactly four from it. If the answer is 'Yes', give the value \(1\). Else give \(0\).
","Let us denote by $d(a,b)$ the distance between the cities $a$ and $b$, and by
\[
S_i(a) = \{c : d(a,c) = i\}
\]
the set of cities at distance exactly $i$ from city $a$.

Assume that for some city $x$ the set $D = S_4(x)$ has size at least 2551. Let $A = S_1(x)$. A subset $A'$ of $A$ is said to be \emph{substantial}, if every city in $D$ can be reached from $x$ with four flights while passing through some member of $A'$; in other terms, every city in $D$ has distance 3 from some member of $A'$, or $D \subseteq \bigcup_{a \in A'} S_3(a)$. For instance, $A$ itself is substantial. Now let us fix some substantial subset $A^*$ of $A$ having the minimal cardinality $m = |A^*|$.

Since
\[
m(101 - m) \leq 50 \cdot 51 = 2550,
\]
there has to be a city $a \in A^*$ such that $|S_3(a) \cap D| \geq 102 - m$. As $|S_3(a)| \leq 100$, we obtain that $S_3(a)$ may contain at most $100 - (102 - m) = m - 2$ cities $c$ with $d(c,x) \leq 3$. Let us denote by $T = \{c \in S_3(a) : d(x,c) \leq 3\}$ the set of all such cities, so $|T| \leq m - 2$. Now, to get a contradiction, we will construct $m - 1$ distinct elements in $T$, corresponding to $m - 1$ elements of the set $A_a = A^* \setminus \{a\}$.

Firstly, due to the minimality of $A^*$, for each $y \in A_a$ there exists some city $d_y \in D$ which can only be reached with four flights from $x$ by passing through $y$. So, there is a way to get from $x$ to $d_y$ along $x$–$y$–$b_y$–$c_y$–$d_y$ for some cities $b_y$ and $c_y$; notice that $d(x, b_y) = 2$ and $d(x, c_y) = 3$ since this path has the minimal possible length.

Now we claim that all $2(m - 1)$ cities of the form $b_y, c_y$ with $y \in A_a$ are distinct. Indeed, no $b_y$ may coincide with any $c_z$ since their distances from $x$ are different. On the other hand, if we had $b_y = b_z$ for $y \neq z$, then there would exist a path of length 4 from $x$ to $d_z$ via $y$, namely $x$–$y$–$b_z$–$c_z$–$d_z$; this is impossible by the choice of $d_z$. Similarly, $c_y \neq c_z$ for $y \neq z$.

So, it suffices to prove that for every $y \in A_a$, one of the cities $b_y$ and $c_y$ has distance 3 from $a$ (and thus belongs to $T$). For that, notice that $d(a,y) \leq 2$ due to the path $a$–$x$–$y$, and $d(a,d_y) \leq d(x,d_y) - d(x,a) = 3$. Moreover, $d(a,d_y) \neq 3$ by the choice of $d_y$; thus $d(a,d_y) > 3$. Finally, in the sequence $d(a,y), d(a,b_y), d(a,c_y), d(a,d_y)$ the neighboring terms differ by at most 1, the first term is less than 3, and the last one is greater than 3; thus there exists one which is equal to 3, as required.
There is no city such that more than 2550 other cities have distance exactly four from it.",0,combinatorics
2013c8,"Players \( A \) and \( B \) play a painful game on the real line. Player \( A \) has a pot of paint with four units of black ink. A quantity \( p \) of this ink suffices to blacken a (closed) real interval of length \( p \). In every round, player \( A \) picks some positive integer \( m \) and provides \( \frac{1}{2^m} \) units of ink from the pot. Player \( B \) then picks an integer \( k \) and blackens the interval from \( \frac{k}{2^m} \) to \( \frac{k+1}{2^m} \) (some parts of this interval may have been blackened before). The goal of player \( A \) is to reach a situation where the pot is empty and the interval \( [0,1] \) is not completely blackened.

Decide whether there exists a strategy for player \( A \) to win in a finite number of moves. If the answer is 'Yes', give the value \(1\). Else give \(0\).
","We will present a strategy for player \( B \) that guarantees that the interval \( [0,1] \) is completely blackened, once the paint pot has become empty.

At the beginning of round \( r \), let \( x_r \) denote the largest real number for which the interval between \( 0 \) and \( x_r \) has already been blackened; for completeness we define \( x_1 = 0 \). Let \( m \) be the integer picked by player \( A \) in this round; we define an integer \( y_r \) by
\[
\frac{y_r}{2^m} \le x_r < \frac{y_r + 1}{2^m}.
\]

Note that \( I_0^r = [y_r/2^m, (y_r + 1)/2^m] \) is the leftmost interval that may be painted in round \( r \) and that still contains some uncolored point.

Player \( B \) now looks at the next interval \( I_1^r = [(y_r + 1)/2^m, (y_r + 2)/2^m] \). If \( I_1^r \) still contains an uncolored point, then player \( B \) blackens the interval \( I_1^r \); otherwise he blackens the interval \( I_0^r \). We make the convention that, at the beginning of the game, the interval \( [1,2] \) is already blackened; thus, if \( y_r + 1 = 2^m \), then \( B \) blackens \( I_0^r \).

Our aim is to estimate the amount of ink used after each round. Firstly, we will prove by induction that, if before the \( r \)th round the segment \( [0,1] \) is not completely colored, then, before this move,

\begin{itemize}
\item[(i)] the amount of ink used for the segment \( [0, x_r] \) is at most \( 3x_r \); and
\item[(ii)] for every \( m \), \( B \) has blackened at most one interval of length \( 1/2^m \) to the right of \( x_r \).
\end{itemize}

Obviously, these conditions are satisfied for \( r = 0 \). Now assume that they were satisfied before the \( r \)th move, and consider the situation after this move; let \( m \) be the number \( A \) has picked at this move.

If \( B \) has blackened the interval \( I_1^r \) at this move, then \( x_{r+1} = x_r \), and (i) holds by the induction hypothesis. Next, had \( B \) blackened before the \( r \)th move any interval of length \( 1/2^m \) to the right of \( x_r \), this interval would necessarily coincide with \( I_1^r \). By our strategy, this cannot happen. So, condition (ii) also remains valid.

Assume now that \( B \) has blackened the interval \( I_0^r \) at the \( r \)th move, but the interval \( I_0^r \) still contains uncolored parts (which means that \( I_1^r \) is contained in \( [0,1] \)), then condition (ii) clearly remains true, and we need to check (i) only. In our case, the intervals \( I_0^r \) and \( I_1^r \) are completely colored after the \( r \)th move, so \( x_{r+1} \) either reaches the right endpoint of \( I_1 \) or moves even further to the right. So, \( x_{r+1} = x_r + \alpha \) for some \( \alpha > 1/2^m \).

Next, any interval blackened by \( B \) before the \( r \)th move which intersects \( (x_r, x_{r+1}) \) should be contained in \( [x_r, x_{r+1}] \); by (ii), all such intervals have different lengths not exceeding \( 1/2^m \), so the total amount of ink used for them is less than \( 2/2^m \). Thus, the amount of ink used for the segment \( [0, x_{r+1}] \) does not exceed the sum of \( 2/2^m \), \( 3x_r \) (used for \( [0, x_r] \)), and \( 1/2^m \) used for the segment \( I_0^r \). In total it gives at most \( 3(x_r + 1/2^m) < 3(x_r + \alpha) = 3x_{r+1} \). Thus condition (i) is also verified in this case. The claim is proved.

Finally, we can perform the desired estimation. Consider any situation in the game, say after the \( (r-1) \)st move; assume that the segment \( [0,1] \) is not completely black. By (ii), in the segment \( [x_r, 1] \) player \( B \) has colored several segments of different lengths; all these lengths are negative powers of 2 not exceeding \( 1 - x_r \); thus the total amount of ink used for this interval is at most \( 2(1 - x_r) \). Using (i), we obtain that the total amount of ink used is at most \( 3x_r + 2(1 - x_r) < 3 \). Thus the pot is not empty, and therefore \( A \) never wins.
So the answer is No. Such a strategy for player \( A \) does not exist.
",0,combinatorics
2013g2,"Let \( \omega \) be the circumcircle of a triangle \( ABC \). Denote by \( M \) and \( N \) the midpoints of the sides \( AB \) and \( AC \), respectively, and denote by \( T \) the midpoint of the arc \( BC \) of \( \omega \) not containing \( A \). The circumcircles of the triangles \( AMT \) and \( ANT \) intersect the perpendicular bisectors of \( AC \) and \( AB \) at points \( X \) and \( Y \), respectively; assume that \( X \) and \( Y \) lie inside the triangle \( ABC \). The lines \( MN \) and \( XY \) intersect at \( K \). Prove that \( KA = KT \). Give the value of \(\frac{KA}{KT}\).","Let \( O \) be the center of \( \omega \), thus \( O = MY \cap NX \). Let \( \ell \) be the perpendicular bisector of \( AT \) (it also passes through \( O \)). Denote by \( r \) the operation of reflection about \( \ell \). Since \( AT \) is the angle bisector of \( \angle BAC \), the line \( r(AB) \) is parallel to \( AC \). Since \( OM \perp AB \) and \( ON \perp AC \), this means that the line \( r(OM) \) is parallel to the line \( ON \) and passes through \( O \), so \( r(OM) = ON \). Finally, the circumcircle \( \gamma \) of the triangle \( AMT \) is symmetric about \( \ell \), so \( r(\gamma) = \gamma \). Thus the point \( M \) maps to the common point of \( ON \) with the arc \( AMT \) of \( \gamma \) --- that is, \( r(M) = X \).

Similarly, \( r(N) = Y \). Thus, we get \( r(MN) = XY \), and the common point \( K \) of \( MN \) and \( XY \) lies on \( \ell \). This means exactly that \( KA = KT \).
",1,geometry
2013g4,\textbf{G4.} Let \( ABC \) be a triangle with \( \angle B > \angle C \). Let \( P \) and \( Q \) be two different points on line \( AC \) such that \( \angle PBA = \angle QBA = \angle ACB \) and \( A \) is located between \( P \) and \( C \). Suppose that there exists an interior point \( D \) of segment \( BQ \) for which \( PD = PB \). Let the ray \( AD \) intersect the circle \( ABC \) at \( R \ne A \). Prove that \( QB = QR \). Give the value of \(\frac{QB}{QR}\).,"\textbf{Solution 1.} Denote by \( \omega \) the circumcircle of the triangle \( ABC \), and let \( \angle ACB = \gamma \). Note that the condition \( \gamma < \angle CBA \) implies \( \gamma < 90^\circ \). Since \( \angle PBA = \gamma \), the line \( PB \) is tangent to \( \omega \), so \( PA \cdot PC = PB^2 = PD^2 \). By \( \frac{PA}{PD} = \frac{PD}{PC} \), the triangles \( PAD \) and \( PDC \) are similar, and \( \angle ADP = \angle DCP \).

Next, since \( \angle ABQ = \angle ACB \), the triangles \( ABC \) and \( AQB \) are also similar. Then \( \angle AQB = \angle ABC = \angle ARC \), which means that the points \( D, R, C, \) and \( Q \) are concyclic. Therefore \( \angle DRQ = \angle DCQ = \angle ADP \).

Now from \( \angle ARB = \angle ACB = \gamma \) and \( \angle PDB = \angle PBD = 2\gamma \), we get
\[
\angle QBR = \angle ADB - \angle ARB = \angle ADP + \angle PDB - \angle ARB = \angle DRQ + \gamma = \angle QRB,
\]
so the triangle \( QRB \) is isosceles, which yields \( QB = QR \).",1,geometry
2013n1,"Let \( \mathbb{Z}_{>0} \) be the set of positive integers. Find all functions \( f : \mathbb{Z}_{>0} \to \mathbb{Z}_{>0} \) such that
\[
m^2 + f(n) \mid mf(m) + n
\]
for all positive integers \( m \) and \( n \). Give the value of \(f(2013)\).","Setting \( m = n = 2 \) tells us that \( 4 + f(2) \mid 2f(2) + 2 \). Since \( 2f(2) + 2 < 2(4 + f(2)) \), we must have \( 2f(2) + 2 = 4 + f(2) \), so \( f(2) = 2 \). Plugging in \( m = 2 \) then tells us that \( 4 + f(n) \mid 4 + n \), which implies that \( f(n) \leq n \) for all \( n \).

Setting \( m = n \) gives \( n^2 + f(n) \mid nf(n) + n \), so \( nf(n) + n \geq n^2 + f(n) \) which we rewrite as \( (n - 1)(f(n) - n) \geq 0 \). Therefore \( f(n) \geq n \) for all \( n \geq 2 \). This is trivially true for \( n = 1 \) also.

It follows that \( f(n) = n \) for all \( n \). This function obviously satisfies the desired property.
So the value of \(f(2013)\) is \(2013\).",2013,number theory
2012a1,"Find all the functions \( f : \mathbb{Z} \to \mathbb{Z} \) such that
\[
f(a)^2 + f(b)^2 + f(c)^2 = 2f(a)f(b) + 2f(b)f(c) + 2f(c)f(a)
\]
for all integers \( a, b, c \) satisfying \( a + b + c = 0 \). If \(f(1)=3\) and \(f(2)=12\), give the value of \(f(55)\).","The substitution \( a = b = c = 0 \) gives \( 3f(0)^2 = 6f(0)^2 \), hence
\[
f(0) = 0. \tag{1}
\]

The substitution \( b = -a \) and \( c = 0 \) gives \( (f(a) - f(-a))^2 = 0 \). Hence \( f \) is an even function:
\[
f(a) = f(-a) \quad \text{for all } a \in \mathbb{Z}. \tag{2}
\]

Now set \( b = a \) and \( c = -2a \) to obtain 
\[
2f(a)^2 + f(2a)^2 = 2f(a)^2 + 4f(a)f(2a).
\]
Hence,
\[
f(2a) = 0 \quad \text{or} \quad f(2a) = 4f(a) \quad \text{for all } a \in \mathbb{Z}. \tag{3}
\]

If \( f(r) = 0 \) for some \( r \geq 1 \) then the substitution \( b = r \) and \( c = -a - r \) gives \( (f(a + r) - f(a))^2 = 0 \). So \( f \) is periodic with period \( r \), i.e.
\[
f(a + r) = f(a) \quad \text{for all } a \in \mathbb{Z}.
\]

In particular, if \( f(1) = 0 \) then \( f \) is constant, thus \( f(a) = 0 \) for all \( a \in \mathbb{Z} \). This function clearly satisfies the functional equation. For the rest of the analysis, we assume \( f(1) = k \neq 0 \).

By (3) we have \( f(2) = 0 \) or \( f(2) = 4k \). If \( f(2) = 0 \) then \( f \) is periodic of period 2, thus
\[
f(\text{even}) = 0 \quad \text{and} \quad f(\text{odd}) = k.
\]
This function is a solution for every \( k \). We postpone the verification; for the sequel assume \( f(2) = 4k \neq 0 \).

By (3) again, we have \( f(4) = 0 \) or \( f(4) = 16k \). In the first case \( f \) is periodic of period 4, and
\[
f(3) = f(-1) = f(1) = k,
\]
so we have
\[
f(4n) = 0, \quad f(4n+1) = f(4n+3) = k, \quad f(4n+2) = 4k \quad \text{for all } n \in \mathbb{Z}.
\]
This function is a solution too, which we justify later. For the rest of the analysis, we assume \( f(4) = 16k \neq 0 \).

We now show that \( f(3) = 9k \). In order to do so, we need two substitutions:

\[
a = 1, b = 2, c = -3 \Longrightarrow f(3)^2 - 10kf(3) + 9k^2 = 0 \Longrightarrow f(3) \in \{k, 9k\},
\]
\[
a = 1, b = 3, c = -4 \Longrightarrow f(3)^2 - 34kf(3) + 225k^2 = 0 \Longrightarrow f(3) \in \{9k, 25k\}.
\]

Therefore \( f(3) = 9k \), as claimed. Now we prove inductively that the only remaining function is
\[
f(x) = kx^2, \quad x \in \mathbb{Z}.
\]

We proved this for \( x = 0,1,2,3,4 \). Assume that \( n \geq 4 \) and that \( f(x) = kx^2 \) holds for all integers \( x \in [0,n] \). Then the substitutions \( a = n, b = 1, c = -n-1 \) and \( a = n-1, b = 2, c = -n - 1 \) lead respectively to
\[
f(n+1) \in \{k(n+1)^2, k(n-1)^2\}, \quad f(n+1) \in \{k(n+1)^2, k(n - 3)^2\}.
\]

Since \( k(n-1)^2 \neq k(n - 3)^2 \) for \( n \neq 2 \), the only possibility is \( f(n+1) = k(n + 1)^2 \). This completes the induction, so \( f(x) = kx^2 \) for all \( x \geq 0 \). The same expression is valid for negative values of \( x \) since \( f \) is even. To verify that \( f(x) = kx^2 \) is actually a solution, we need to check the identity
\[
a^4 + b^4 + (a + b)^4 = 2a^2b^2 + 2a^2(a + b)^2 + 2b^2(a + b)^2,
\]
which follows directly by expanding both sides.

\medskip

Therefore the only possible solutions of the functional equation are the constant function \( f_1(x) = 0 \) and the following functions:
\[
f_2(x) = kx^2, \quad 
f_3(x) = \left\{
\begin{array}{ll}
0 & x \text{ even} \\
k & x \text{ odd}
\end{array}
\right., \quad
f_4(x) = \left\{
\begin{array}{ll}
0 & x \equiv 0 \pmod{4} \\
k & x \equiv 1 \pmod{2} \\
4k & x \equiv 2 \pmod{4}
\end{array}
\right.
\]
for any non-zero integer \( k \). The verification that they are indeed solutions was done for the first two. For \( f_3 \), note that if \( a + b + c = 0 \) then either \( a, b, c \) are all even, in which case \( f(a) = f(b) = f(c) = 0 \), or one of them is even and the other two are odd, so both sides of the equation equal \( 2k^2 \). For \( f_4 \), we use similar parity considerations and the symmetry of the equation, which reduces the verification to the triples \( (0, k, k), (4k, k, k), (0,0,0), (0,4k,4k) \). They all satisfy the equation.
If \(f(1)=3\) and \(f(2)=12\), the value of \(f(55)\) is \(9075\).",9075,algebra
2012a4,"Let \( f \) and \( g \) be two nonzero polynomials with integer coefficients and \( \deg f > \deg g \). Suppose that for infinitely many primes \( p \) the polynomial \( pf + g \) has a rational root. Does \( f \) have a rational root? If the answer is 'Yes', give the value \(1\). Else give \(0\).
","Since \( \deg f > \deg g \), we have \( |g(x)/f(x)| < 1 \) for sufficiently large \( x \); more precisely, there is a real number \( R \) such that \( |g(x)/f(x)| < 1 \) for all \( x \) with \( |x| > R \). Then for all such \( x \) and all primes \( p \) we have
\[
|pf(x) + g(x)| \geq |f(x)|\left(p - \left| \frac{g(x)}{f(x)} \right|\right) > 0.
\]
Hence all real roots of the polynomials \( pf + g \) lie in the interval \( [-R, R] \).

Let \( f(x) = a_n x^n + a_{n-1}x^{n-1} + \cdots + a_0 \) and \( g(x) = b_m x^m + b_{m-1} x^{m-1} + \cdots + b_0 \) where \( n > m \), \( a_n \neq 0 \) and \( b_m \neq 0 \). Upon replacing \( f(x) \) and \( g(x) \) by \( a_n^{-1} f(x/a_n) \), and \( a_n^{-1} g(x/a_n) \) respectively, we reduce the problem to the case \( a_n = 1 \). In other words we can assume that \( f \) is monic. Then the leading coefficient of \( pf + g \) is \( p \), and if \( r = u/v \) is a rational root of \( pf + g \) with \( (u, v) = 1 \) and \( v > 0 \), then either \( v = 1 \) or \( v = p \).

First consider the case when \( v = 1 \) infinitely many times. If \( v = 1 \) then \( |u| \leq R \), so there are only finitely many possibilities for the integer \( u \). Therefore there exist distinct primes \( p \) and \( q \) for which we have the same value of \( u \). Then the polynomials \( pf + g \) and \( qf + g \) share this root, implying \( f(u) = g(u) = 0 \). So in this case \( f \) and \( g \) have an integer root in common.

Now suppose that \( v = p \) infinitely many times. By comparing the exponent of \( p \) in the denominators of \( pf(u/p) \) and \( g(u/p) \) we get \( m = n - 1 \) and \( pf(u/p) + g(u/p) = 0 \) reduces to an equation of the form
\[
\left(u^n + a_{n-1} pu^{n-1} + \cdots + a_0 p^n \right) + \left( b_{n-1} u^{n-1} + b_{n-2} pu^{n-2} + \cdots + b_0 p^{n-1} \right) = 0.
\]
The equation above implies that \( u^n + b_{n-1} u^{n-1} \) is divisible by \( p \) and hence, since \( (u, p) = 1 \), we have \( u + b_{n-1} = pk \) with some integer \( k \). On the other hand all roots of \( pf + g \) lie in the interval \( [-R, R] \), so that
\[
\left| pk - b_{n-1} \right| = \left| \frac{u}{p} \right| < R,
\quad\text{thus}\quad
|k| < R + \frac{|b_{n-1}|}{p} < R + |b_{n-1}|.
\]
Therefore the integer \( k \) can attain only finitely many values. Hence there exists an integer \( k \) such that the number \( \frac{pk - b_{n-1}}{p} = k - \frac{b_{n-1}}{p} \) is a root of \( pf + g \) for infinitely many primes \( p \). For these primes we have
\[
f\left(k - \frac{b_{n-1}}{p}\right) + \frac{1}{p} g\left(k - \frac{b_{n-1}}{p} \right) = 0.
\]
So the equation
\[
f\left(k - b_{n-1} x\right) + x g\left(k - b_{n-1} x\right) = 0 \tag{1}
\]
has infinitely many solutions of the form \( x = 1/p \). Since the left-hand side is a polynomial, this implies that (1) is a polynomial identity, so it holds for all real \( x \). In particular, by substituting \( x = 0 \) in (1) we get \( f(k) = 0 \). Thus the integer \( k \) is a root of \( f \).

In summary the monic polynomial \( f \) obtained after the initial reduction always has an integer root. Therefore the original polynomial \( f \) has a rational root.
",1,algebra
2012a5,"Find all functions \( f : \mathbb{R} \to \mathbb{R} \) that satisfy the conditions
\[
f(1 + xy) - f(x + y) = f(x)f(y) \quad \text{for all } x, y \in \mathbb{R}
\]
and \( f(-1) \neq 0 \). Give the value of \(f(2012)\).
","The only solution is the function \( f(x) = x - 1 \), \( x \in \mathbb{R} \).

We set \( g(x) = f(x) + 1 \) and show that \( g(x) = x \) for all real \( x \). The conditions take the form
\[
g(1 + xy) - g(x + y) = (g(x) - 1)(g(y) - 1) \quad \text{for all } x, y \in \mathbb{R} \text{ and } g(-1) \neq 1. \tag{1}
\]
Denote \( C = g(-1) - 1 \neq 0 \). Setting \( y = -1 \) in (1) gives
\[
g(1 - x) - g(x - 1) = C(g(x) - 1). \tag{2}
\]
Set \( x = 1 \) in (2) to obtain \( C(g(1) - 1) = 0 \). Hence \( g(1) = 1 \) as \( C \neq 0 \). Now plugging in \( x = 0 \) and \( x = 2 \) yields \( g(0) = 0 \) and \( g(2) = 2 \) respectively.

We pass on to the key observations
\[
g(x) + g(2 - x) = 2 \quad \text{for all } x \in \mathbb{R}, \tag{3}
\]
\[
g(x + 2) - g(x) = 2 \quad \text{for all } x \in \mathbb{R}. \tag{4}
\]

Replace \( x \) by \( 1 - x \) in (2), then change \( x \) to \( -x \) in the resulting equation. We obtain the relations \( g(x) - g(-x) = C(g(1 - x) - 1) \), \( g(-x) - g(x) = C(g(1 + x) - 1) \). Then adding them up leads to \( C(g(1 - x) + g(1 + x) - 2) = 0 \). Thus \( C \neq 0 \) implies (3).

Let \( u, v \) be such that \( u + v = 1 \). Apply (1) to the pairs \( (u, v) \) and \( (2 - u, 2 - v) \):
\[
g(1 + uv) - g(1) = (g(u) - 1)(g(v) - 1), \quad g(3 + uv) - g(3) = (g(2 - u) - 1)(g(2 - v) - 1).
\]
Observe that the last two equations have equal right-hand sides by (3). Hence \( u + v = 1 \) implies
\[
g(uw + 3) - g(uw + 1) = g(3) - g(1).
\]
Each \( x \leq 5/4 \) is expressible in the form \( x = uw + 1 \) with \( u + v = 1 \) (the quadratic function \( t^2 - t(x - 1) \) has real roots for \( x \leq 5/4 \)). Hence \( g(x + 2) - g(x) = g(3) - g(1) \) whenever \( x \leq 5/4 \). Because \( g(x) = x \) holds for \( x = 0, 1, 2 \), setting \( x = 0 \) yields \( g(3) = 3 \). This proves (4) for \( x \leq 5/4 \). If \( x > 5/4 \) then \( -x < 5/4 \) and so \( g(2 - x) = 2 - x \), \( g(-x) = 2 - g(2 - x) \) by the above. On the other hand \( g(x) = 2 - g(2 - x) \), \( g(x + 2) = 2 - g(2 - x) \), so that \( g(x + 2) - g(x) = g(2 - x) - g(2 - x) = 2 \). Thus (4) is true for all \( x \in \mathbb{R} \).

Now replace \( x \) by \( -x \) in (3) to obtain \( g(-x) + g(2 + x) = 2 \). In view of (4) this leads to \( g(x) + g(-x) = 0 \), i.e. \( g(-x) = -g(x) \) for all \( x \). Taking this into account, we apply (1) to the pairs \( (-x, y) \) and \( (x, -y) \):
\[
g(1 - xy) - g(-x + y) = (g(x) + 1)(1 - g(y)), \quad g(1 - xy) - g(x - y) = (1 - g(x))(g(y) + 1).
\]
Adding up yields \( g(1 - xy) = 1 - g(x)g(y) \). Then \( g(1 + xy) = 1 + g(x)g(y) \) by (3). Now the original equation (1) takes the form \( g(xy) = g(x)g(y) \), hence \( g \) is multiplicative. Since \( g \) is additive.

By additivity \( g(1 + x) = g(1) + g(x) = 1 + g(x) \); since \( g(1 + xy) = 1 + g(x)g(y) \) was shown above, we also have \( g(xy) = g(x)g(y) \), so \( g \) is multiplicative. In particular \( y = x \) gives \( g(x^2) = g(x)^2 \geq 0 \) for all \( x \), meaning that \( g(x) \geq 0 \) for \( x \geq 0 \). Since \( g \) is additive and bounded from below on \( [0, +\infty) \), it is linear; more exactly \( g(x) = g(1)x = x \) for all \( x \in \mathbb{R} \).

In summary \( f(x) = x - 1 \), \( x \in \mathbb{R} \). It is straightforward that this function satisfies the requirements.
And the value of \(f(2012)\) is \(2011\).",2011,algebra
2012a6,"Let \( f : \mathbb{N} \to \mathbb{N} \) be a function, and let \( f^m \) be \( f \) applied \( m \) times. Suppose that for every \( n \in \mathbb{N} \) there exists a \( k \in \mathbb{N} \) such that \( f^{2k}(n) = n + k \), and let \( k_n \) be the smallest such \( k \). Is the sequence \( k_1, k_2, \ldots \) unbounded? If the answer is 'Yes', give the value \(1\). Else give \(0\).
","We restrict attention to the set
\[
S = \{1, f(1), f^2(1), \ldots\}.
\]
Observe that \( S \) is unbounded because for every number \( n \in S \) there exists a \( k > 0 \) such that \( f^{2k}(n) = n + k \) is in \( S \). Clearly \( f \) maps \( S \) into itself; moreover \( f \) is injective on \( S \). Indeed if \( f(1) = f^j(1) \) with \( j \ne 1 \) then the values \( f^m(1) \) start repeating periodically from some point on, and \( S \) would be finite.

Define \( g : S \to S \) by \( g(n) = f^{2k_n}(n) = n + k_n \). We prove that \( g \) is injective too. Suppose that \( g(a) = g(b) \) with \( a < b \). Then \( a + k_a = f^{2k_a}(a) = f^{2k_b}(b) = b + k_b \) implies \( k_a > k_b \). So, since \( f \) is injective on \( S \), we obtain
\[
f^{2(k_a - k_b)}(a) = b = a + (k_a - k_b).
\]
However this contradicts the minimality of \( k_a \) as \( 0 < k_a - k_b < k_a \).

Let \( T \) be the set of elements of \( S \) that are not of the form \( g(n) \) with \( n \in S \). Note that \( 1 \in T \) by \( g(n) > n \) for \( n \in S \), so \( T \) is non-empty. For each \( t \in T \) denote \( C_t = \{t, g(t), g^2(t), \ldots\} \); call \( C_t \) the chain starting at \( t \). Observe that distinct chains are disjoint because \( g \) is injective. Each \( n \in S \setminus T \) has the form \( n = g(n') \) with \( n' < n \), \( n' \in S \). Repeated applications of the same observation show that \( n \in C_t \) for some \( t \in T \), i.e. \( S \) is the disjoint union of the chains \( C_t \).

If \( f^n(1) \) is in the chain \( C_t \) starting at \( t = f^{n_t}(1) \) then \( n = n_t + 2a_1 + \cdots + 2a_j \) with
\[
f^n(1) = g^j(f^{n_t}(1)) = f^{2a_j}(f^{2a_{j-1}}(\cdots f^{2a_1}(f^{n_t}(1))\cdots)) = f^n(1) + a_1 + \cdots + a_j.
\]
Hence
\[
f^n(1) = f^n(1) + \frac{n - n_t}{2} = t + \frac{n - n_t}{2}. \tag{1}
\]

Now we show that \( T \) is infinite. We argue by contradiction. Suppose that there are only finitely many chains \( C_{t_1}, \ldots, C_{t_r} \), starting at \( t_1 < \cdots < t_r \). Fix \( N \). If \( f^n(1) \) with \( 1 \le n \le N \) is in \( C_t \) then \( f^n(1) = t + \frac{n - n_t}{2} \le t_r + \frac{N}{2} \) by (1). But then the \( N + 1 \) distinct natural numbers \( 1, f(1), \ldots, f^N(1) \) are all less than \( t_r + \frac{N}{2} \) and hence \( N + 1 \le t_r + \frac{N}{2} \). This is a contradiction if \( N \) is sufficiently large, and hence \( T \) is infinite.

To complete the argument, choose any \( k \) in \( \mathbb{N} \) and consider the \( k + 1 \) chains starting at the first \( k + 1 \) numbers in \( T \). Let \( t \) be the greatest among these numbers. Each of the chains in question contains a number not exceeding \( t \), and at least one of them does not contain any number among \( t + 1, \ldots, t + k \). So there is a number \( n \) in this chain such that \( g(n) = n + k \), i.e. \( k_n > k \). In conclusion \( k_1, k_2, \ldots \) is unbounded.
",1,algebra
2012a7,"We say that a function \( f : \mathbb{R}^k \to \mathbb{R} \) is a metapolynomial if, for some positive integers \( m \) and \( n \), it can be represented in the form
\[
f(x_1, \ldots, x_k) = \max_{i = 1, \ldots, m} \min_{j = 1, \ldots, n} P_{i,j}(x_1, \ldots, x_k)
\]
where \( P_{i,j} \) are multivariate polynomials. Is the product of two metapolynomials also a metapolynomial? If the answer is 'Yes', give the value \(1\). Else give \(0\).
","We use the notation \( f(x) = f(x_1, \ldots, x_k) \) for \( x = (x_1, \ldots, x_k) \) and \( [m] = \{1, 2, \ldots, m\} \). Observe that if a metapolynomial \( f(x) \) admits a representation like the one in the statement for certain positive integers \( m \) and \( n \), then they can be replaced by any \( m' \ge m \) and \( n' \ge n \). For instance, if we want to replace \( m \) by \( m+1 \) then it is enough to define \( P_{m+1,j}(x) = P_{m,j}(x) \) and note that repeating elements of a set do not change its maximum nor its minimum. So one can assume that any two metapolynomials are defined with the same \( m \) and \( n \). We reserve letters \( P \) and \( Q \) for polynomials, so every function called \( P, P_{i,j}, Q, Q_{i,j}, \ldots \) is a polynomial function.

We start with a lemma that is useful to change expressions of the form \( \min \max f_{i,j} \) to ones of the form \( \max \min g_{i,j} \).

\textbf{Lemma.} Let \( \{a_{i,j}\} \) be real numbers, for all \( i \in [m] \) and \( j \in [n] \). Then
\[
\min_{i \in [m]} \max_{j \in [n]} a_{i,j} = \max_{j_1,\ldots,j_m \in [n]} \min_{i \in [m]} a_{i,j_i},
\]
where the max on the right-hand side is over all vectors \( (j_1, \ldots, j_m) \) with \( j_1, \ldots, j_m \in [n] \).

\textit{Proof.} We can assume for all \( i \) that \( a_{i,n} = \max\{a_{i,1}, \ldots, a_{i,n} \} \) and \( a_{m,n} = \min\{a_{1,n}, \ldots, a_{m,n}\} \). The left-hand side is \( = a_{m,n} \) and hence we need to prove the same for the right-hand side. If \( (j_1, j_2, \ldots, j_m) = (n, n, \ldots, n) \) then \( \min\{a_{1,j_1}, \ldots, a_{m,j_m} \} = \min\{a_{1,n}, \ldots, a_{m,n} \} = a_{m,n} \) which implies that the right-hand side is \( \ge a_{m,n} \). It remains to prove the opposite inequality and this is equivalent to \( \min\{a_{1,j_1}, \ldots, a_{m,j_m}\} \le a_{m,n} \) for all possible \( (j_1, j_2, \ldots, j_m) \). This is true because \( \min\{a_{1,j_1}, \ldots, a_{m,j_m}\} \le a_{m,j_m} \le a_{m,n} \). \qed

We need to show that the family \( \mathcal{M} \) of metapolynomials is closed under multiplication, but it turns out easier to prove more: that it is also closed under addition, maxima and minima.

First we prove the assertions about the maxima and the minima. If \( f_1, \ldots, f_r \) are metapolynomials, assume them defined with the same \( m \) and \( n \). Then
\[
f = \max\{f_1, \ldots, f_r\} = \max\left\{ \max_{i \in [m]} \min_{j \in [n]} P^1_{i,j}, \ldots, \max_{i \in [m]} \min_{j \in [n]} P^r_{i,j} \right\} = \max_{s \in [rm]} \min_{j \in [n]} P^s_{i,j},
\]
It follows that \( f = \max\{f_1, \ldots, f_r\} \) is a metapolynomial. The same argument works for the minima, but first we have to replace \( \min \max \) by \( \max \min \), and this is done via the lemma.

Another property we need is that if \( f = \max \min P_{i,j} \) is a metapolynomial then so is \( -f \). Indeed, \( -f = \min(-\min P_{i,j}) = \min \max P_{i,j} \).

To prove \( \mathcal{M} \) is closed under addition let \( f = \max \min P_{i,j} \) and \( g = \max \min Q_{i,j} \). Then
\begin{align*}
f(x) + g(x) &= \max_{i \in [m]} \min_{j \in [n]} P_{i,j}(x) + \max_{i \in [m]} \min_{j \in [n]} Q_{i,j}(x) \\
&= \max_{i_1, i_2 \in [m]} \left( \min_{j \in [n]} P_{i_1,j}(x) + \min_{j \in [n]} Q_{i_2,j}(x) \right) \\
&= \max_{i_1, i_2 \in [m], j_1, j_2 \in [n]} \left( P_{i_1,j_1}(x) + Q_{i_2,j_2}(x) \right),
\end{align*}
and hence \( f(x) + g(x) \) is a metapolynomial.

We proved that \( \mathcal{M} \) is closed under sums, maxima and minima, in particular any function that can be expressed by sums, max, min, polynomials or even metapolynomials is in \( \mathcal{M} \).

We would like to proceed with multiplication along the same lines like with addition, but there is an essential difference. In general the product of the maxima of two sets is not equal to the maximum of the product of the sets. We need to deal with the fact that \( a < b \) and \( c < d \) do not imply \( ac < bd \). However this is true for \( a, b, c, d \ge 0 \).

In view of this we decompose each function \( f(x) \) into its positive part \( f^+(x) = \max\{f(x), 0\} \) and its negative part \( f^-(x) = \max\{0, -f(x)\} \). Note that \( f = f^+ - f^- \) and \( f^+, f^- \in \mathcal{M} \) if \( f \in \mathcal{M} \). The whole problem reduces to the claim that if \( f \) and \( g \) are metapolynomials with \( f, g \ge 0 \) then \( fg \) it is also a metapolynomial.

Assuming this claim, consider arbitrary \( f, g \in \mathcal{M} \). We have
\[
fg = (f^+ - f^-)(g^+ - g^-) = f^+g^+ - f^+g^- - f^-g^+ + f^-g^-,
\]
and hence \( fg \in \mathcal{M} \). Indeed, \( \mathcal{M} \) is closed under addition, also \( f^+g^+, f^+g^-, f^-g^+, f^-g^- \in \mathcal{M} \) because \( f^+, f^-, g^+, g^- \ge 0 \).

It remains to prove the claim. In this case \( f, g \ge 0 \), and one can try to repeat the argument for the sum. More precisely, let \( f = \max \min P_{i,j} \ge 0 \) and \( g = \max \min Q_{i,j} \ge 0 \). Then
\[
fg = \max \min P_{i,j} \cdot \max \min Q_{i,j} = \max \min P^+_{i,j} \cdot \max \min Q^+_{i,j} = \max \min P^+_{i_1,j_1} Q^+_{i_2,j_2}.
\]

Hence it suffices to check that \( P + Q \in \mathcal{M} \) for any pair of polynomials \( P \) and \( Q \). This reduces to the identity
\[
u^+v^+ = \max\{0, \min\{uv, u, v\}, \min\{uv, uv^2, v\}, \min\{uv, u^2v, u\}, \min\{uv, uv^2, uv\} \},
\]
with \( u \) replaced by \( P(x) \) and \( v \) replaced by \( Q(x) \). The formula is proved by a case-by-case analysis. If \( u \le 0 \) or \( v \le 0 \) then both sides equal 0. In case \( u, v \ge 0 \), the right-hand side is clearly \( \le uv \). To prove the opposite inequality we use that \( uv \) equals
\[
\begin{cases}
\min\{uv, u, v\} & \text{if } 0 \le u, v \le 1, \\
\min\{uv, uv^2, u\} & \text{if } 1 \le u, v, \\
\min\{uv, u, uv^2\} & \text{if } 0 \le v \le 1 < u, \\
\min\{uv, uv^2, v\} & \text{if } 0 \le u \le 1 < v.
\end{cases}
\]
",1,algebra
2012c1,"Several positive integers are written in a row. Iteratively, Alice chooses two adjacent numbers \( x \) and \( y \) such that \( x > y \) and \( x \) is to the left of \( y \), and replaces the pair \( (x, y) \) by either \( (y+1, x) \) or \( (x-1, x) \). Can she perform only finitely many such iterations? If she can perform only finitely many such iterations, give the value \(1\). Else give \(0\).
","Note first that the allowed operation does not change the maximum \( M \) of the initial sequence. Let \( a_1, a_2, \ldots, a_n \) be the numbers obtained at some point of the process. Consider the sum
\[
S = a_1 + 2a_2 + \cdots + n a_n.
\]
We claim that \( S \) increases by a positive integer amount with every operation. Let the operation replace the pair \( (a_i, a_{i+1}) \) by a pair \( (c, a_i) \), where \( a_i > a_{i+1} \) and \( c = a_{i+1} + 1 \) or \( c = a_i - 1 \). Then the new and the old value of \( S \) differ by \( d = (ic + (i+1)a_i) - (ia_i + (i+1)a_{i+1}) = a_i - a_{i+1} + i(c - a_{i+1}) \). The integer \( d \) is positive since \( a_i - a_{i+1} \geq 1 \) and \( c - a_{i+1} \geq 0 \).

On the other hand \( S \leq (1 + 2 + \cdots + n)M \) as \( a_i \leq M \) for all \( i = 1, \ldots, n \). Since \( S \) increases by at least 1 at each step and never exceeds the constant \( (1 + 2 + \cdots + n)M \), the process stops after a finite number of iterations.
",1,combinatorics
2012c2,"Let \( n \geq 1 \) be an integer. What is the maximum number of disjoint pairs of elements of the set \( \{1, 2, \ldots, n\} \) such that the sums of the different pairs are different integers not exceeding \( n \)?
","Consider \( x \) such pairs in \( \{1, 2, \ldots, n\} \). The sum \( S \) of the \( 2x \) numbers in them is at least \( 1 + 2 + \cdots + 2x \) since the pairs are disjoint. On the other hand \( S \leq n + (n-1) + \cdots + (n - x + 1) \) because the sums of the pairs are different and do not exceed \( n \). This gives the inequality
\[
\frac{2x(2x+1)}{2} \leq \frac{nx - x(x-1)}{2},
\]
which leads to \( x \leq \left\lfloor \frac{2n - 1}{5} \right\rfloor \). Hence there are at most \( \left\lfloor \frac{2n - 1}{5} \right\rfloor \) pairs with the given properties.

We show a construction with exactly \( \left\lfloor \frac{2n - 1}{5} \right\rfloor \) pairs. First consider the case \( n = 5k + 3 \) with \( k \geq 0 \), where \( \left\lfloor \frac{2n - 1}{5} \right\rfloor = 2k + 1 \). The pairs are displayed in the following table.

\[
\begin{array}{|c|c|c|c|c|c|c|}
\hline
3k + 1 & 3k + 2 & \cdots & 2k + 2 & 4k + 2 & 4k + 1 & \cdots \\
2 & 4 & \cdots & 3k & 1 & 3 & \cdots \\
\hline
\text{Sums} & 3k + 3 & 3k + 4 & \cdots & 4k + 2 & 4k + 4 & \cdots \\
\hline
\end{array}
\]

The \( 2k + 1 \) pairs involve all numbers from \( 1 \) to \( 4k + 2 \); their sums are all numbers from \( 3k + 3 \) to \( 5k + 3 \). The same construction works for \( n = 5k + 4 \) and \( n = 5k + 5 \) with \( k \geq 0 \). In these cases the required number \( \left\lfloor \frac{2n - 1}{5} \right\rfloor \) of pairs equals \( 2k + 1 \) again, and the numbers in the table do not exceed \( 5k + 3 \). In the case \( n = 5k + 2 \) with \( k \geq 0 \) one needs only \( 2k \) pairs. They can be obtained by ignoring the last column of the table (thus removing \( 5k + 3 \)). Finally, \( 2k \) pairs are also needed for the case \( n = 5k + 1 \) with \( k \geq 0 \). Now it suffices to ignore the last column of the table and then subtract \( 1 \) from each number in the first row.
So the maximum number is \( \left\lfloor \frac{2n - 1}{5} \right\rfloor \). When \(n=2012\), the answer is \(804\).",804,combinatorics
2012c3,"In a \(999 \times 999\) square table some cells are white and the remaining ones are red. Let \( T \) be the number of triples \( (C_1, C_2, C_3) \) of cells, the first two in the same row and the last two in the same column, with \( C_1 \) and \( C_3 \) white and \( C_2 \) red. Find the maximum value \( T \) can attain. You should arrive at this number by taking the problem solution modulo \(1000\).
  ","We prove that in an \( n \times n \) square table there are at most \( \frac{4n^4}{27} \) such triples.

Let row \( i \) and column \( j \) contain \( a_i \) and \( b_j \) white cells respectively, and let \( R \) be the set of red cells. For every red cell \( (i,j) \) there are \( a_i b_j \) admissible triples \( (C_1, C_2, C_3) \) with \( C_2 = (i,j) \), therefore
\[
T = \sum_{(i,j) \in R} a_i b_j.
\]

We use the inequality \( 2ab \leq a^2 + b^2 \) to obtain
\[
T \leq \frac{1}{2} \sum_{(i,j) \in R} (a_i^2 + b_j^2) 
= \frac{1}{2} \left( \sum_{i=1}^{n} (n - a_i)a_i^2 + \sum_{j=1}^{n} (n - b_j)b_j^2 \right).
\]

This is because there are \( n - a_i \) red cells in row \( i \) and \( n - b_j \) red cells in column \( j \). Now we maximize the right-hand side.

By the AM-GM inequality we have
\[
(n - x)x^2 = \frac{1}{2} (2n - 2x) \cdot x \cdot x \leq \frac{1}{2} \left( \frac{2n}{3} \right)^3 = \frac{4n^3}{27},
\]
with equality if and only if \( x = \frac{2n}{3} \). By putting everything together, we get
\[
T \leq \frac{n \cdot 4n^3}{27} + \frac{n \cdot 4n^3}{27} = \frac{4n^4}{27}.
\]

If \( n = 999 \) then any coloring of the square table with \( x = \frac{2n}{3} = 666 \) white cells in each row and column attains the maximum as all inequalities in the previous argument become equalities. For example color a cell \( (i,j) \) white if \( i - j = 1, 2, \ldots, 666 \pmod{999} \), and red otherwise.

Therefore the maximum value \( T \) can attain is 
\[
T = \frac{4 \cdot 999^4}{27}.
\]
So the answer is \(852\) after taking the problem solution modulo \(1000\).",852,combinatorics
2012c4,"Players \(A\) and \(B\) play a game with \(N \geq 2012\) coins and 2012 boxes arranged around a circle. Initially \(A\) distributes the coins among the boxes so that there is at least 1 coin in each box. Then the two of them make moves in the order \(B, A, B, A, \ldots\) by the following rules:

\begin{itemize}
  \item On every move of his \(B\) passes 1 coin from every box to an adjacent box.
  \item On every move of hers \(A\) chooses several coins that were \emph{not} involved in \(B\)'s previous move and are in different boxes. She passes every chosen coin to an adjacent box.
\end{itemize}

Player \(A\)'s goal is to ensure at least 1 coin in each box after every move of hers, regardless of how \(B\) plays and how many moves are made. Find the least \(N\) that enables her to succeed.

","We argue for a general \(n \geq 7\) instead of 2012 and prove that the required minimum \(N\) is \(2n - 2\). For \(n = 2012\) this gives \(N_{\min} = 4022\).

\textbf{a)} If \(N = 2n - 2\), player \(A\) can achieve her goal. Let her start the game with a \emph{regular distribution}: \(n - 2\) boxes with 2 coins and 2 boxes with 1 coin. Call the boxes of the two kinds \emph{red} and \emph{white} respectively. We claim that on her first move \(A\) can achieve a regular distribution again, regardless of \(B\)'s first move \(M\). She acts according as the following situation \(S\) occurs after \(M\) or not: \emph{The initial distribution contains a red box \(R\) with 2 white neighbors, and \(R\) receives no coins from them on move \(M\)}.

Suppose that \(S\) does not occur. Exactly one of the coins \(c_1\) and \(c_2\) in a given red box \(X\) is involved in \(M\), say \(c_1\). If \(M\) passes \(c_1\) to the right neighbor of \(X\), let \(A\) pass \(c_2\) to its left neighbor, and vice versa. By doing so with all red boxes \(A\) performs a legal move \(M'\). Thus \(M\) and \(M'\) combined move the 2 coins of every red box in opposite directions. Hence after \(M\) and \(M'\) are complete each neighbor of a red box \(X\) contains exactly 1 coin that was initially in \(X\). So each box with a red neighbor is non-empty after \(M'\). If initially there is a box \(X\) with 2 white neighbors (\(X\) is red and unique) then \(X\) receives a coin from at least one of them on move \(M\) since \(S\) does not occur. Such a coin is not involved in \(M'\), so \(X\) is also non-empty after \(M'\). Furthermore each box \(Y\) has given away its initial content after \(M\) and \(M'\). A red neighbor of \(Y\) adds 1 coin to it; a white neighbor adds at most 1 coin because it is not involved in \(M'\). Hence each box contains 1 or 2 coins after \(M'\). Because \(N = 2n - 2\), such a distribution is regular.

Now let \(S\) occur after move \(M\). Then \(A\) leaves untouched the exceptional red box \(R\). With all remaining red boxes she proceeds like in the previous case, thus making a legal move \(M''\). Box \(R\) receives no coins from its neighbors on either move, so there is 1 coin in it after \(M''\). Like above \(M\) and \(M''\) combined pass exactly 1 coin from every red box different from \(R\) to each of its neighbors. Every box except \(R\) has a red neighbor different from \(R\), hence all boxes are non-empty after \(M''\). Next, each box \(Y\) except \(R\) loses its initial content after \(M\) and \(M''\). A red neighbor of \(Y\) adds at most 1 coin to it; a white neighbor also adds at most 1 coin because it does not participate in \(M''\). Thus each box has 1 or 2 coins after \(M''\), and the obtained distribution is regular.

Player \(A\) can apply the described strategy indefinitely, so \(N = 2n - 2\) enables her to succeed.

\textbf{b)} For \(N \leq 2n - 3\) player \(B\) can achieve an empty box after some move of \(A\). Let \(\alpha\) be a set of \(\ell\) consecutive boxes containing a total of \(N(\alpha)\) coins. We call \(\alpha\) an \emph{arc} if \(\ell \leq n - 2\) and \(N(\alpha) \leq 2\ell - 3\). Note that \(\ell \geq 2\) by the last condition. Moreover if both extremes of \(\alpha\) are non-empty boxes then \(N(\alpha) \geq 2\), so that \(N(\alpha) \leq 2\ell - 3\) implies \(\ell \geq 3\). Observe also that if an extreme \(X\) of \(\alpha\) has more than 1 coin then ignoring \(X\) yields a shorter arc. It follows that every arc contains an arc whose extremes have at most 1 coin each.

Given a clockwise labeling \(1, 2, \ldots, n\) of the boxes, suppose that boxes \(1, 2, \ldots, \ell\) form an arc \(\alpha\), with \(\ell \leq n - 2\) and \(N(\alpha) \leq 2\ell - 3\). Suppose also that all \(n \geq 7\) boxes are non-empty. Then \(B\) can move so that an arc \(\alpha'\) with \(N(\alpha') < N(\alpha)\) will appear after any response of \(A\).

One may assume exactly 1 coin in boxes 1 and \(\ell\) by a previous remark. Let \(B\) pass 1 coin in counterclockwise direction from box 1 and box \(n\), and in clockwise direction from each remaining box. This leaves \(N(\alpha) - 2\) coins in the boxes of \(\alpha\). In addition, due to \(3 \leq \ell \leq n - 2\), box \(\ell\) has exactly 1 coin \(c\), the one received from box \(\ell - 1\).

Let player \(A\)'s next move \(M\) pass \(k \leq 2\) coins to boxes \(1, 2, \ldots, \ell\) from the remaining ones. Only boxes 1 and \(\ell\) can receive such coins, at most 1 each. If \(k < 2\) then after move \(M\) boxes \(1, 2, \ldots, \ell\) form an arc \(\alpha'\) with \(N(\alpha') < N(\alpha)\). If \(k = 2\) then \(M\) adds a coin to box \(\ell\). Also \(M\) does not move coin \(c\) from \(\ell\) because \(c\) is involved in the previous move of \(B\). In summary boxes \(1, 2, \ldots, \ell\) contain \(N(\alpha)\) coins like before, so they form an arc. However there are 2 coins now in the extreme \(\ell\) of the arc. Ignore \(\ell\) to obtain a shorter arc \(\alpha'\) with \(N(\alpha') < N(\alpha)\).

Consider any initial distribution without empty boxes. Since \(N \leq 2n - 3\), there are at least 3 boxes in it with exactly 1 coin. It follows from \(n \geq 7\) that some 2 of them are the extremes of an arc \(\alpha\). Hence \(B\) can make the move described above, which leads to an arc \(\alpha'\) with \(N(\alpha') < N(\alpha)\) after \(A\)'s response. If all boxes in the new distribution are non-empty he can repeat the same, and so on. Because \(N(\alpha)\) cannot decrease indefinitely, an empty box will occur after some move of \(A\).
",4022,combinatorics
2012c5,"The columns and the rows of a \(3n \times 3n\) square board are numbered \(1, 2, \ldots, 3n\). Every square \((x, y)\) with \(1 \le x, y \le 3n\) is colored asparagus, byzantium or citrine according as the modulo 3 remainder of \(x + y\) is 0, 1 or 2 respectively. One token colored asparagus, byzantium or citrine is placed on each square, so that there are \(3n^2\) tokens of each color.

Suppose that one can permute the tokens so that each token is moved to a distance of at most \(d\) from its original position, each asparagus token replaces a byzantium token, each byzantium token replaces a citrine token, and each citrine token replaces an asparagus token. Prove that it is possible to permute the tokens so that each token is moved to a distance of at most \(d + 2\) from its original position, and each square contains a token with the same color as the square.
If the answer is 'Yes', give the value \(1\). Else give \(0\).","Without loss of generality it suffices to prove that the A-tokens can be moved to distinct A-squares in such a way that each A-token is moved to a distance at most \( d + 2 \) from its original place. This means we need a perfect matching between the \(3n^2\) A-squares and the \(3n^2\) A-tokens such that the distance in each pair of the matching is at most \( d + 2 \).

To find the matching, we construct a bipartite graph. The A-squares will be the vertices in one class of the graph; the vertices in the other class will be the A-tokens.

Split the board into \(3 \times 1\) horizontal triminoes; then each trimino contains exactly one A-square. Take a permutation \(\pi\) of the tokens which moves A-tokens to B-tokens, B-tokens to C-tokens, and C-tokens to A-tokens, in each case to a distance at most \( d \). For each A-square \( S \), and for each A-token \( T \), connect \( S \) and \( T \) by an edge if \( T \), \( \pi(T) \) or \( \pi^{-1}(T) \) is on the trimino containing \( S \). We allow multiple edges; it is even possible that the same square and the same token are connected with three edges. Obviously the lengths of the edges in the graph do not exceed \( d + 2 \). By length of an edge we mean the distance between the A-square and the A-token it connects.

Each A-token \( T \) is connected with the three A-squares whose triminos contain \( T \), \( \pi(T) \) and \( \pi^{-1}(T) \). Therefore in the graph all tokens are of degree 3. We show that the same is true for the A-squares. Let \( S \) be an arbitrary A-square, and let \( T_1, T_2, T_3 \) be the three tokens on the trimino containing \( S \). For \( i = 1,2,3 \), if \( T_i \) is an A-token, then \( S \) is connected with \( T_i \); if \( T_i \) is a B-token then \( S \) is connected with \( \pi^{-1}(T_i) \); finally, if \( T_i \) is a C-token then \( S \) is connected with \( \pi(T_i) \). Hence in the graph the A-squares also are of degree 3.

Since the A-squares are of degree 3, from every set \( S \) of A-squares exactly \( 3|S| \) edges start. These edges end in at least \( |S| \) tokens because the A-tokens also are of degree 3. Hence every set \( S \) of A-squares has at least \( |S| \) neighbors among the A-tokens.

Therefore, by Hall’s marriage theorem, the graph contains a perfect matching between the two vertex classes. So there is a perfect matching between the A-squares and A-tokens with edges no longer than \( d + 2 \). It follows that the tokens can be permuted as specified in the problem statement.
",1,combinatorics
2012g1,"In the triangle \( ABC \) the point \( J \) is the center of the excircle opposite to \( A \). This excircle is tangent to the side \( BC \) at \( M \), and to the lines \( AB \) and \( AC \) at \( K \) and \( L \) respectively. The lines \( LM \) and \( BJ \) meet at \( F \), and the lines \( KM \) and \( CJ \) meet at \( G \). Let \( S \) be the point of intersection of the lines \( AF \) and \( BC \), and let \( T \) be the point of intersection of the lines \( AG \) and \( BC \). Give the value of \( \frac{SM}{MT} \).
","Let \( \alpha = \angle CAB, \beta = \angle ABC \) and \( \gamma = \angle BCA \). The line \( AJ \) is the bisector of \( \angle CAB \), so \( \angle JAK = \angle JAL = \frac{\alpha}{2} \). By \( \angle AKJ = \angle ALJ = 90^\circ \) the points \( K \) and \( L \) lie on the circle \( \omega \) with diameter \( AJ \).

The triangle \( KBM \) is isosceles as \( BK \) and \( BM \) are tangents to the excircle. Since \( BJ \) is the bisector of \( \angle KBM \), we have \( \angle MBJ = 90^\circ - \frac{\beta}{2} \) and \( \angle BMK = \frac{\beta}{2} \). Likewise \( \angle MCJ = 90^\circ - \frac{\gamma}{2} \) and \( \angle CML = \frac{\gamma}{2} \). Also \( \angle BMF = \angle CML \), therefore
\[
\angle LFJ = \angle MBJ - \angle BMF = \left(90^\circ - \frac{\beta}{2} \right) - \frac{\gamma}{2} = \frac{\alpha}{2} = \angle LAJ.
\]
Hence \( F \) lies on the circle \( \omega \). (By the angle computation, \( F \) and \( A \) are on the same side of \( BC \).) Analogously, \( G \) also lies on \( \omega \). Since \( AJ \) is a diameter of \( \omega \), we obtain \( \angle AFJ = \angle AGJ = 90^\circ \).

The lines \( AB \) and \( BC \) are symmetric with respect to the external bisector \( BF \). Because \( AF \perp BF \) and \( KM \perp BF \), the segments \( SM \) and \( AK \) are symmetric with respect to \( BF \), hence \( SM = AK \). By symmetry \( TM = AL \). Since \( AK \) and \( AL \) are equal as tangents to the excircle, it follows that \( SM = TM \), and the proof is complete.

So the value of \( \frac{SM}{MT} \) is \(1\).",1,geometry
2012g5,"Let \( ABC \) be a triangle with \( \angle BCA = 90^\circ \), and let \( C_0 \) be the foot of the altitude from \( C \). Choose a point \( X \) in the interior of the segment \( CC_0 \), and let \( K, L \) be the points on the segments \( AX, BX \) for which \( BK = BC \) and \( AL = AC \) respectively. Denote by \( M \) the intersection of \( AL \) and \( BK \). Give the value of \( \frac{MK}{ML} \).

","Let \( C' \) be the reflection of \( C \) in the line \( AB \), and let \( \omega_1 \) and \( \omega_2 \) be the circles with centers \( A \) and \( B \), passing through \( L \) and \( K \) respectively. Since \( AC' = AC = AL \) and \( BC' = BC = BK \), both \( \omega_1 \) and \( \omega_2 \) pass through \( C \) and \( C' \). By \( \angle BCA = 90^\circ \), \( AC \) is tangent to \( \omega_2 \) at \( C \), and \( BC \) is tangent to \( \omega_1 \) at \( C \). Let \( K_1 \ne K \) be the second intersection of \( AX \) and \( \omega_2 \), and let \( L_1 \ne L \) be the second intersection of \( BX \) and \( \omega_1 \).

By the powers of \( X \) with respect to \( \omega_2 \) and \( \omega_1 \),
\[
XK \cdot XK_1 = XC \cdot XC' = XL \cdot XL_1,
\]
so the points \( K_1, L, K, L_1 \) lie on a circle \( \omega_3 \).

The power of \( A \) with respect to \( \omega_2 \) gives
\[
AL^2 = AC^2 = AK \cdot AK_1,
\]
indicating that \( AL \) is tangent to \( \omega_3 \) at \( L \). Analogously, \( BK \) is tangent to \( \omega_3 \) at \( K \). Hence \( MK \) and \( ML \) are the two tangents from \( M \) to \( \omega_3 \) and therefore \( MK = ML \).

So the value of \( \frac{MK}{ML} \) is \(1\).",1,geometry
2012g6,"Let \( ABC \) be a triangle with circumcenter \( O \) and incenter \( I \). The points \( D, E \) and \( F \) on the sides \( BC, CA \) and \( AB \) respectively are such that \( BD + BF = CA \) and \( CD + CE = AB \). The circumcircles of the triangles \( BFD \) and \( CDE \) intersect at \( P \ne D \). Give the value of \( \frac{OP}{OI} \).
","By Miquel’s theorem the circles \( (AEF) = \omega_A \), \( (BFD) = \omega_B \) and \( (CDE) = \omega_C \) have a common point, for arbitrary points \( D, E \) and \( F \) on \( BC, CA \) and \( AB \). So \( \omega_A \) passes through the common point \( P \ne D \) of \( \omega_B \) and \( \omega_C \).

Let \( \omega_A, \omega_B \) and \( \omega_C \) meet the bisectors \( AI, BI \) and \( CI \) at \( A' \ne A, B' \ne B \) and \( C' \ne C \) respectively. The key observation is that \( A', B' \) and \( C' \) do not depend on the particular choice of \( D, E \) and \( F \), provided that \( BD + BF = CA, CD + CE = AB \) and \( AE + AF = BC \) hold true (the last equality follows from the other two). For a proof we need the following fact.

\textbf{Lemma.} Given is an angle with vertex \( A \) and measure \( \alpha \). A circle \( \omega \) through \( A \) intersects the angle bisector at \( L \) and sides of the angle at \( X \) and \( Y \). Then \( AX + AY = 2AL \cos \frac{\alpha}{2} \).

\textit{Proof.} Note that \( L \) is the midpoint of arc \( \overset{\frown}{XLY} \) in \( \omega \) and set \( XL = YL = u, XY = v \). By Ptolemy’s theorem \( AX \cdot YL + AY \cdot XL = AL \cdot XY \), which rewrites as \( (AX + AY)u = AL \cdot v \). Since \( \angle LXY = \frac{\alpha}{2} \) and \( \angle XLY = 180^\circ - \alpha \), we have \( v = 2 \cos \frac{\alpha}{2} u \) by the law of sines, and the claim follows.

Apply the lemma to \( \angle BAC = \alpha \) and the circle \( \omega = \omega_A \), which intersects \( AI \) at \( A' \). This gives \( 2AA' \cos \frac{\alpha}{2} = AE + AF = BC \); by symmetry analogous relations hold for \( BB' \) and \( CC' \). It follows that \( A', B' \) and \( C' \) are independent of the choice of \( D, E \) and \( F \), as stated.

We use the lemma two more times with \( \angle BAC = \alpha \). Let \( \omega \) be the circle with diameter \( AI \). Then \( X \) and \( Y \) are the tangency points of the incircle of \( ABC \) with \( AB \) and \( AC \), and hence \( AX = AY = \frac{1}{2}(AB + AC - BC) \). So the lemma yields \( 2AI \cos \frac{\alpha}{2} = AB + AC - BC \). Next, if \( \omega \) is the circumcircle of \( ABC \) and \( AI \) intersects \( \omega \) at \( M \ne A \) then \( \{X, Y\} = \{B, C\} \), and so \( 2AM \cos \frac{\alpha}{2} = AB + AC \) by the lemma. To summarize,
\[
\begin{aligned}
2AA' \cos \frac{\alpha}{2} &= BC, \\
2AI \cos \frac{\alpha}{2} &= AB + AC - BC, \\
2AM \cos \frac{\alpha}{2} &= AB + AC. \quad \text{(*)}
\end{aligned}
\]

These equalities imply \( AA' + AI = AM \), hence the segments \( AM \) and \( IA' \) have a common midpoint. It follows that \( I \) and \( A' \) are equidistant from the circumcenter \( O \). By symmetry \( OI = OA' = OB' = OC' \), so \( I, A', B', C' \) are on a circle centered at \( O \).

To prove \( OP = OI \), now it suffices to show that \( I, A', B', C' \) and \( P \) are concyclic. Clearly one can assume \( P \ne I, A', B', C' \).

We use oriented angles to avoid heavy case distinction. The oriented angle between the lines \( l \) and \( m \) is denoted by \( \angle(l, m) \). We have \( \angle(l, m) = -\angle(m, l) \) and \( \angle(l, m) + \angle(m, n) = \angle(l, n) \) for arbitrary lines \( l, m \) and \( n \). Four distinct non-collinear points \( U, V, X, Y \) are concyclic if and only if \( \angle(UX, VX) = \angle(UY, VY) \).

Suppose for the moment that \( A', B', P, I \) are distinct and noncollinear; then it is enough to check the equality \( \angle(A'P, B'P) = \angle(A'I, B'I) \). Because \( A, F, P, A' \) are on the circle \( \omega_A \), we have \( \angle(A'P, FP) = \angle(A'A, FA) = \angle(A'I, AB) \). Likewise \( \angle(B'P, FP) = \angle(B'I, AB) \). Therefore
\[
\angle(A'P, B'P) = \angle(A'P, FP) + \angle(FP, B'P) = \angle(A'I, AB) - \angle(B'I, AB) = \angle(A'I, B'I).
\]

Here we assumed that \( P \ne F \). If \( P = F \) then \( P \ne D, E \) and the conclusion follows similarly (use \( \angle(A'F, B'F) = \angle(A'F, EF) + \angle(EF, DF) + \angle(DF, B'F) \) and inscribed angles in \( \omega_A, \omega_B, \omega_C \)).

There is no loss of generality in assuming \( A', B', P, I \) distinct and noncollinear. If \( ABC \) is an equilateral triangle then the equalities (*) imply that \( A', B', C', I, O \) and \( P \) coincide, so \( OP = OI \). Otherwise at most one of \( A', B', C' \) coincides with \( I \). If say \( C' = I \) then \( OI \perp CI \) by the previous reasoning. It follows that \( A', B' \ne I \) and hence \( A' \ne B' \). Finally \( A', B' \) and \( I \) are noncollinear because \( I, A', B', C' \) are concyclic.

So the value of \( \frac{OP}{OI} \) is \(1\).",1,geometry
2012n1,"Call admissible a set \( A \) of integers that has the following property:

\quad If \( x, y \in A \) (possibly \( x = y \)) then \( x^2 + kxy + y^2 \in A \) for every integer \( k \).

Determine all pairs \( m, n \) of nonzero integers such that the only admissible set containing both \( m \) and \( n \) is the set of all integers. Calculate the sum of the quantity \[ (m+n) \] over every such pair that \(m\) and \(n\) are positive integers and \(m+n<10\).","A pair of integers \( m, n \) fulfills the condition if and only if \( \gcd(m, n) = 1 \). Suppose that \( \gcd(m, n) = d > 1 \). The set
\[
A = \{\ldots, -2d, -d, 0, d, 2d, \ldots\}
\]
is admissible, because if \( d \) divides \( x \) and \( y \) then it divides \( x^2 + kxy + y^2 \) for every integer \( k \). Also \( m, n \in A \) and \( A \ne \mathbb{Z} \).

Now let \( \gcd(m, n) = 1 \), and let \( A \) be an admissible set containing \( m \) and \( n \). We use the following observations to prove that \( A = \mathbb{Z} \):

\begin{itemize}
  \item[(i)] \( kx^2 \in A \) for every \( x \in A \) and every integer \( k \).
  \item[(ii)] \( (x + y)^2 \in A \) for all \( x, y \in A \).
\end{itemize}

To justify (i) let \( y = x \) in the definition of an admissible set; to justify (ii) let \( k = 2 \).

Since \( \gcd(m, n) = 1 \), we also have \( \gcd(m^2, n^2) = 1 \). Hence one can find integers \( a, b \) such that \( am^2 + bn^2 = 1 \). It follows from (i) that \( am^2 \in A \) and \( bn^2 \in A \). Now we deduce from (ii) that \( 1 = (am^2 + bn^2)^2 \in A \). But if \( 1 \in A \) then (i) implies \( k \in A \) for every integer \( k \).

When \(m\) and \(n\) are positive integers and \(m+n<10\), the sum of the quantity \[ (m+n) \] over every such pair is \(176\).",176,number theory
2012n2,"Find all triples \( (x, y, z) \) of positive integers such that \( x \le y \le z \) and
\[
x^3(y^3 + z^3) = 2012(xyz + 2).
\]
Calculate the sum of the quantity \[ (x+y+z) \] over every such triple.","First note that \( x \) divides \( 2012 \cdot 2 = 2^3 \cdot 503 \). If \( 503 \mid x \) then the right-hand side of the equation is divisible by \( 503^3 \), and it follows that \( 503^2 \mid y^3 + z^3 \). This is false as \( 503 \nmid z \). Hence \( x = 2^m \) with \( m \in \{0,1,2,3\} \). If \( m \ge 2 \) then \( 2^6 \mid 2012(xyz + 2) \). However the highest powers of 2 dividing \( xyz + 2 = 2^m yz + 2 \) are \( 2^2 \) and \( 2^1 \) respectively. So \( x = 1 \) or \( x = 2 \), yielding the two equations

\[
y^3 + z^3 = 2012(yz + 2), \qquad \text{and} \qquad y^3 + z^3 = 503(yz + 1).
\]

In both cases the prime \( 503 = 3 \cdot 167 + 2 \) divides \( y^3 + z^3 \). We claim that \( 503 \mid y + z \). This is clear if \( 503 \mid y \), so let \( 503 \nmid y \) and \( 503 \nmid z \). Then \( y^{502} \equiv z^{502} \pmod{503} \) by Fermat’s little theorem. On the other hand \( y^3 \equiv -z^3 \pmod{503} \) implies \( y^{3 \cdot 167} \equiv -z^{3 \cdot 167} \pmod{503} \), i.e. \( y^{501} \equiv -z^{501} \pmod{503} \). It follows that \( y^2 \equiv -z^2 \pmod{503} \) as claimed.

Therefore \( y + z = 503k \) with \( k \ge 1 \). In view of \( y^3 + z^3 = (y + z)((y - z)^2 + yz) \) the two equations take the form
\[
\begin{aligned}
k(y - z)^2 + (k - 4)yz &= 8, \\
k(y - z)^2 + (k - 1)yz &= 1.
\end{aligned}
\]

In (1) we have \( (k - 4)yz \le 8 \), which implies \( k \le 4 \). Indeed if \( k > 4 \) then \( 1 < (k - 4)yz \le 8 \), so that \( y \le 8 \) and \( z \le 8 \). This is impossible as \( y + z = 503k \ge 503 \). Note next that \( y^3 + z^3 \) is even in the first equation. Hence \( y + z = 503k \) is even too, meaning that \( k \) is even. Thus \( k = 2 \) or \( k = 4 \). Clearly (1) has no integer solutions for \( k = 4 \). If \( k = 2 \) then (1) takes the form \( (y + z)^2 - 5yz = 4 \). Since \( y + z = 503k = 503 \cdot 2 \), this leads to \( 5yz = 503^2 \cdot 2^2 - 4 \). However \( 503^2 \cdot 2^2 - 4 \) is not a multiple of 5. Therefore (1) has no integer solutions.

Equation (2) implies \( 0 \le (k - 1)yz \le 1 \), so that \( k = 1 \) or \( k = 2 \). Also \( 0 \le (k - 1)y^2 \le 1 \), hence \( k = 2 \) only if \( y = 2 \). However then \( y = z = 1 \), which is false in view of \( y + z = 503 \). Therefore \( k = 1 \) and (2) takes the form \( (y - z)^2 = 1 \), yielding \( z = y \pm 1 \). Combined with \( k = 1 \) and \( y + z = 503k \), this leads to \( y = 251, z = 252 \).

In summary the triple \( (2, 251, 252) \) is the only solution. So the sum is \(505\).",505,number theory
2012n3,"Determine all integers \( m \ge 2 \) such that every \( n \) with \( \frac{m}{3} \le n \le \frac{m}{2} \) divides the binomial coefficient \( \binom{n}{m - 2n} \). Calculate the sum of all possible \(m\) when \(m<30\).
",the sum of all possible \(m\) when \(m<30\).,129,number theory
2012n6,"Let \( x \) and \( y \) be positive integers. If \( x^{2^n} - 1 \) is divisible by \( 2^n y + 1 \) for every positive integer \( n \), prove that \( x = 1 \). Calculate the sum of all possible \(x\).
","First we prove the following fact: For every positive integer \( y \) there exist infinitely many primes \( p \equiv 3 \pmod{4} \) such that \( p \) divides some number of the form \( 2^n y + 1 \).

Clearly it is enough to consider the case \( y \) odd. Let
\[
2y + 1 = p_1^{e_1} \cdots p_r^{e_r}
\]
be the prime factorization of \( 2y + 1 \). Suppose on the contrary that there are finitely many primes \( p_{r+1}, \ldots, p_{r+s} \equiv 3 \pmod{4} \) that divide some number of the form \( 2^n y + 1 \) but do not divide \( 2y + 1 \).

We want to find an \( n \) such that \( p_i^{e_i} \| 2^n y + 1 \) for \( 1 \le i \le r \) and \( p_i \nmid 2^n y + 1 \) for \( r+1 \le i \le r+s \). For this it suffices to take
\[
n = 1 + \varphi(p_1^{e_1+1} \cdots p_r^{e_r+1} p_{r+1} \cdots p_{r+s}),
\]
because then
\[
2^n y + 1 \equiv 2y + 1 \pmod{p_1^{e_1+1} \cdots p_r^{e_r+1} p_{r+1} \cdots p_{r+s}}.
\]

The last congruence means that \( p_1^{e_1}, \ldots, p_r^{e_r} \) divide exactly \( 2y + 1 \) and no prime \( p_{r+1}, \ldots, p_{r+s} \) divides \( 2^n y + 1 \). It follows that the prime factorization of \( 2^n y + 1 \) consists of the prime powers \( p_1^{e_1}, \ldots, p_r^{e_r} \) and powers of primes \( \equiv 1 \pmod{4} \). Because \( y \) is odd, we obtain
\[
2^n y + 1 \equiv p_1^{e_1} \cdots p_r^{e_r} \equiv 2y + 1 \equiv 3 \pmod{4}.
\]

This is a contradiction since \( n > 1 \), and so \( 2^n y + 1 \equiv 1 \pmod{4} \).

Now we proceed to the problem. If \( p \) is a prime divisor of \( 2^n y + 1 \) the problem statement implies that \( x^d \equiv 1 \pmod{p} \) for \( d = 2^n \). By Fermat’s little theorem the same congruence holds for \( d = p - 1 \), so it must also hold for \( d = \gcd(2^n, p - 1) \). For \( p \equiv 3 \pmod{4} \) we have \( \gcd(2^n, p - 1) = 2 \), therefore in this case \( x^2 \equiv 1 \pmod{p} \).

In summary, we proved that every prime \( p \equiv 3 \pmod{4} \) that divides some number of the form \( 2^n y + 1 \) also divides \( x^2 - 1 \). This is possible only if \( x = 1 \), otherwise the above \( x^2 - 1 \) would be a positive integer with infinitely many prime factors. 

So \(x=1\), the sum is \(1\).
",1,number theory
2012n7,"Find all \( n \in \mathbb{N} \) for which there exist nonnegative integers \( a_1, a_2, \ldots, a_n \) such that
\[
\frac{1}{2^{a_1}} + \frac{1}{2^{a_2}} + \cdots + \frac{1}{2^{a_n}} = \frac{1}{3^{a_1}} + \frac{2}{3^{a_2}} + \cdots + \frac{n}{3^{a_n}} = 1.
\]
Calculate the sum of all possible \(n\) that \(n<30\).","Such numbers \( a_1, a_2, \ldots, a_n \) exist if and only if \( n \equiv 1 \pmod{4} \) or \( n \equiv 2 \pmod{4} \).

Let \( \sum_{k=1}^n \frac{k}{3^{a_k}} = 1 \) with \( a_1, a_2, \ldots, a_n \) nonnegative integers. Then \( 1 \cdot x_1 + 2 \cdot x_2 + \cdots + n \cdot x_n = 3^a \) with \( x_1, \ldots, x_n \) powers of 3 and \( a \ge 0 \). The right-hand side is odd, and the left-hand side has the same parity as \( 1 + 2 + \cdots + n \). Hence the latter sum is odd, which implies \( n \equiv 1, 2 \pmod{4} \).

Now we prove the converse.

Call \emph{feasible} a sequence \( b_1, b_2, \ldots, b_n \) if there are nonnegative integers \( a_1, a_2, \ldots, a_n \) such that
\[
\frac{1}{2^{a_1}} + \frac{1}{2^{a_2}} + \cdots + \frac{1}{2^{a_n}} = \frac{b_1}{3^{a_1}} + \frac{b_2}{3^{a_2}} + \cdots + \frac{b_n}{3^{a_n}} = 1.
\]

Let \( b_k \) be a term of a feasible sequence \( b_1, b_2, \ldots, b_n \) with exponents \( a_1, a_2, \ldots, a_n \) like above, and let \( u, v \) be nonnegative integers with sum \( 3b_k \). Observe that
\[
\frac{1}{2^{a_k+1}} + \frac{1}{2^{a_k+1}} = \frac{1}{2^{a_k}} \quad \text{and} \quad \frac{u}{3^{a_k+1}} + \frac{v}{3^{a_k+1}} = \frac{bk}{3^{a_k}}.
\]

It follows that the sequence \( b_1, \ldots, b_{k-1}, u, v, b_{k+1}, \ldots, b_n \) is feasible. The exponents \( a_i \) are the same for the unchanged terms \( b_i \), \( i \ne k \); the new terms \( u, v \) have exponents \( a_k + 1 \).

We state the conclusion in reverse. If two terms \( u, v \) of a sequence are replaced by one term \( \frac{u+v}{3} \) and the obtained sequence is feasible, then the original sequence is feasible too.

Denote by \( \alpha_n \) the sequence \( 1, 2, \ldots, n \). To show that \( \alpha_n \) is feasible for \( n \equiv 1, 2 \pmod{4} \), we transform it by \( n - 1 \) replacements \( (u, v) \mapsto \frac{u+v}{3} \) to the one-term sequence \( (1) \). The latter is feasible, with \( a_1 = 0 \). Note that if \( m \) and \( 2m \) are terms of a sequence then \( \{m, 2m\} \mapsto m \), so \( 2m \) can be ignored if necessary.

Let \( n \ge 16 \). We prove that \( \alpha_n \) can be reduced to \( \alpha_{n-12} \) by 12 operations. Write \( n = 12k + r \) where \( k \ge 1 \) and \( 0 \le r \le 11 \). If \( 0 \le r \le 5 \) then the last 12 terms of \( \alpha_n \) can be partitioned into 2 singletons \( \{12k - 6\}, \{12k\} \) and the following 5 pairs:
\[
\{12k - 6 - i, 12k - 6 + i\}, \quad i = 1, \ldots, 5 - r; \qquad \{12k - j, 12k + j\}, \quad j = 1, \ldots, r.
\]

(There is only one kind of pairs if \( r \in \{0, 5\} \)). One can ignore \( 12k - 6 \) and \( 12k \) since \( \alpha_n \) contains \( 6k - 3 \) and \( 6k \). Furthermore the 5 operations \( \{12k - 6 - i, 12k - 6 + i\} \mapsto 8k - 4 \) and \( \{12k - j, 12k + j\} \mapsto 8k \) remove the 10 terms in the pairs and bring in 5 new terms equal to \( 8k - 4 \) or \( 8k \). All of these can be ignored too as \( 4k - 2 \) and \( 4k \) are still present in the sequence. Indeed \( 4k \le n - 12 \) is equivalent to \( 8k \ge 12 - r \), which is true for \( r \in \{4, 5\} \). And if \( r \in \{0, 1, 2, 3\} \) then \( n \ge 16 \) implies \( k \ge 2 \), so \( 8k \ge 12 - r \) also holds. Thus \( \alpha_n \) reduces to \( \alpha_{n-12} \).

The case \( 6 \le r \le 11 \) is analogous. Consider the singletons \( \{12k\}, \{12k + 6\} \) and the 5 pairs:
\[
\{12k - i, 12k + i\}, \quad i = 1, \ldots, 11 - r; \qquad \{12k + 6 - j, 12k + 6 + j\}, \quad j = 1, \ldots, r - 6.
\]

Ignore the singletons like before, then remove the pairs via operations \( \{12k - i, 12k + i\} \mapsto 8k \) and \( \{12k + 6 - j, 12k + 6 + j\} \mapsto 8k + 4 \). The 5 newly-appeared terms \( 8k \) and \( 8k + 4 \) can be ignored too since \( 4k + 2 \le n - 12 \) (this follows from \( k \ge 1 \) and \( r \ge 6 \)). We obtain \( \alpha_{n-12} \) again.

The problem reduces to \( 2 \le n \le 15 \). In fact \( n \in \{2, 5, 6, 9, 13, 14\} \) by \( n \equiv 1, 2 \pmod{4} \). The cases \( n = 2, 6, 10, 14 \) reduce to \( n = 1, 5, 9, 13 \) respectively because the last even term of \( \alpha_n \) can be ignored. For \( n = 5 \) apply \( \{4, 5\} \mapsto 3 \), then \( \{3, 3\} \mapsto 2 \), then ignore the 2 occurrences of 2. For \( n = 9 \) ignore 6 first, then apply \( \{5, 7\} \mapsto 4 \), \( \{4, 8\} \mapsto 4 \), \( \{3, 9\} \mapsto 4 \). Now ignore the 3 occurrences of 4, then ignore 2. Finally \( n = 13 \) reduces to \( n = 10 \) by \( \{11, 13\} \mapsto 8 \) and ignoring 8 and 12. The proof is complete.

So the sum of all possible \(n\) that \(n<30\) is \(218\).",218,number theory
2011a2,"Determine all sequences \( (x_1, x_2, \ldots, x_{2011}) \) of positive integers such that for every positive integer \( n \) there is an integer \( a \) with
\[
x_1^n + 2x_2^n + \cdots + 2011x_{2011}^n = a^{n+1} + 1.
\]
Give the value of \(x_{2011}\). You should arrive at this number by taking the problem solution modulo \(10000\).
","Throughout this solution, the set of positive integers will be denoted by \( \mathbb{Z}_+ \).

Put \( k = 2 + 3 + \cdots + 2011 = 2023065 \). We have
\[
1^n + 2^n + \cdots + 2011^n = 1 + k \cdot k^n = k^{n+1} + 1
\]
for all \( n \), so \( (1, k, \ldots, k) \) is a valid sequence. We shall prove that it is the only one.

Let a valid sequence \( (x_1, \ldots, x_{2011}) \) be given. For each \( n \in \mathbb{Z}_+ \) we have some \( y_n \in \mathbb{Z}_+ \) with
\[
x_1^n + 2x_2^n + \cdots + 2011x_{2011}^n = y_n^{n+1} + 1.
\]

Note that \( x_1^n + 2x_2^n + \cdots + 2011x_{2011}^n < (x_1 + 2x_2 + \cdots + 2011x_{2011})^{n+1} \), which implies that the sequence \( (y_n) \) is bounded. In particular, there is some \( y \in \mathbb{Z}_+ \) with \( y_n = y \) for infinitely many \( n \).

Let \( m \) be the maximum of all the \( x_i \). Grouping terms with equal \( x_i \) together, the sum \( x_1^n + 2x_2^n + \cdots + 2011x_{2011}^n \) can be written as
\[
x_1^n + 2x_2^n + \cdots + x_{2011}^n = a_m m^n + a_{m-1}(m - 1)^n + \cdots + a_1
\]
with \( a_i \ge 0 \) for all \( i \) and \( a_1 + \cdots + a_m = 1 + 2 + \cdots + 2011 \). So there exist arbitrarily large values of \( n \), for which
\[
a_m m^n + \cdots + a_1 - 1 - y \cdot y^n = 0. \tag{1}
\]

The following lemma will help us to determine the \( a_i \) and \( y \):

\textbf{Lemma.} Let integers \( b_1, \ldots, b_N \) be given and assume that there are arbitrarily large positive integers \( n \) with \( b_1 + b_2 \cdot 2^n + \cdots + b_N N^n = 0 \). Then \( b_i = 0 \) for all \( i \).

\textit{Proof.} Suppose that not all \( b_i \) are zero. We may assume without loss of generality that \( b_N \ne 0 \).

Dividing through by \( N^n \) gives
\[
|b_N| = \left| b_{N-1} \left( \frac{N - 1}{N} \right)^n + \cdots + b_1 \left( \frac{1}{N} \right)^n \right| \le (|b_{N-1}| + \cdots + |b_1|) \left( \frac{N - 1}{N} \right)^n.
\]

The expression \( \left( \frac{N - 1}{N} \right)^n \) can be made arbitrarily small for \( n \) large enough, contradicting the assumption that \( b_N \) be non-zero. \qed

We obviously have \( y > 1 \). Applying the lemma to (1) we see that \( a_m = y = m \), \( a_1 = 1 \), and all the other \( a_i \) are zero. This implies \( (x_1, \ldots, x_{2011}) = (1, m, \ldots, m) \). But we also have \( 1 + m = a_1 + \cdots + a_m = 1 + \cdots + 2011 = 1 + k \) so \( m = k \), which is what we wanted to show.

After taking the problem solution modulo \(1000\), the answer is \(3065\).",3065,algebra
2011a3,"Determine all pairs \( (f, g) \) of functions from the set of real numbers to itself that satisfy
\[
g(f(x + y)) = f(x) + (2x + y)g(y)
\]
for all real numbers \( x \) and \( y \). If \(f(1)=6\), give the value of \(f(50)+g(50)\).
","Clearly all these pairs of functions satisfy the functional equation in question, so it suffices to verify that there cannot be any further ones. Substituting \( -2x \) for \( y \) in the given functional equation we obtain
\[
g(f(-x)) = f(x). \tag{1}
\]

Using this equation for \( -x - y \) in place of \( x \) we obtain
\[
f(-x - y) = g(f(x + y)) = f(x) + (2x + y)g(y). \tag{2}
\]

Now for any two real numbers \( a \) and \( b \), setting \( x = -b \) and \( y = a + b \) we get
\[
f(-a) = f(-b) + (a - b)g(a + b).
\]

If \( c \) denotes another arbitrary real number we have similarly
\[
f(-b) = f(-c) + (b - c)g(b + c)
\]
as well as
\[
f(-c) = f(-a) + (c - a)g(c + a).
\]

Adding all these equations up, we obtain
\[
((a + c) - (b + c))g(a + b) + ((a + b) - (a + c))g(b + c) + ((b + c) - (a + b))g(a + c) = 0.
\]

Now given any three real numbers \( x, y, z \) one may determine three reals \( a, b, c \) such that \( x = b + c, y = c + a, \) and \( z = a + b \), so that we get
\[
(y - x)g(z) + (z - y)g(x) + (x - z)g(y) = 0.
\]

This implies that the three points \( (x, g(x)), (y, g(y)), \) and \( (z, g(z)) \) from the graph of \( g \) are collinear. Hence that graph is a line, i.e., \( g \) is either a constant or a linear function.

Let us write \( g(x) = Ax + B \), where \( A \) and \( B \) are two real numbers. Substituting \( (0, -y) \) for \( (x, y) \) in (2) and denoting \( C = f(0) \), we have \( f(y) = Ay^2 - By + C \). Now, comparing the coefficients of \( x^2 \) in (1) we see that \( A^2 = A \), so \( A = 0 \) or \( A = 1 \).

If \( A = 0 \), then (1) becomes \( B = -Bx + C \) and thus \( B = C = 0 \), which provides the first of the two solutions mentioned above.

Now suppose \( A = 1 \). Then (1) becomes \( x^2 - Bx + C + B = x^2 - Bx + C \), so \( B = 0 \). Thus, \( g(x) = x \) and \( f(x) = x^2 + C \), which is the second solution from above.

So either both \( f \) and \( g \) vanish identically, or there exists a real number \( C \) such that
\[
f(x) = x^2 + C \quad \text{and} \quad g(x) = x \quad \text{for all real numbers } x.
\]
If \(f(1)=6\), the value of \(f(50)+g(50)\) is \(2551\).",2551,algebra
2011a4,"Determine all pairs \( (f, g) \) of functions from the set of positive integers to itself that satisfy
\[
f^{g(n)+1}(n) + g^{f(n)}(n) = f(n+1) - g(n+1) + 1
\]
for every positive integer \( n \). Here, \( f^k(n) \) means \( \underbrace{f(f(\cdots f}_{k}(n)\cdots)) \). Give the value of \(f(2011)+g(2011)\).
","The given relation implies
\[
f\left(f^{g(n)}(n)\right) < f(n+1) \quad \text{for all } n, \tag{1}
\]
which will turn out to be sufficient to determine \( f \).

Let \( y_1 < y_2 < \cdots \) be all the values attained by \( f \) (this sequence might be either finite or infinite). We will prove that for every positive \( n \) the function \( f \) attains at least \( n \) values, and we have (i)\(_n\): \( f(x) = y_n \) if and only if \( x = n \), and (ii)\(_n\): \( y_n = n \). The proof will follow the scheme
\[
\text{(i)}_1, \text{(ii)}_1, \text{(i)}_2, \text{(ii)}_2, \ldots, \text{(i)}_n, \text{(ii)}_n, \ldots \tag{2}
\]

To start, consider any \( x \) such that \( f(x) = y_1 \). If \( x > 1 \), then (1) reads \( f(f^{g(x-1)}(x-1)) < y_1 \), contradicting the minimality of \( y_1 \). So we have that \( f(x) = y_1 \) is equivalent to \( x = 1 \), establishing (i)\(_1\).

Next, assume that for some \( n \) statement (i)\(_n \) is established, as well as all the previous statements in (2). Note that these statements imply that for all \( k \ge 1 \) and \( a < n \) we have \( f^k(x) = a \) if and only if \( x = a \).

Now, each value \( y_i \) with \( 1 \le i \le n \) is attained at the unique integer \( x_i \), so \( y_{n+1} \) exists. Choose an arbitrary \( x \) such that \( f(x) = y_{n+1} \); we necessarily have \( x > n \). Substituting \( x - 1 \) into (1) we have
\[
f(f^{g(x - 1)}(x - 1)) < y_{n+1},
\]
which implies
\[
f^{g(x - 1)}(x - 1) \in \{1, \ldots, n\}. \tag{3}
\]

Set \( b = f^{g(x - 1)}(x - 1) \). If \( b < n \) then we would have \( x - 1 = b \) which contradicts \( x > n \). So \( b = n \), and hence \( y_n = n \), which proves (ii)\(_n\). Next, from (i)\(_n \) we now get \( f(k) = n \iff k = n \), so removing all the iterations of \( f \) in (3) we obtain \( x - 1 = b = n \), which proves (i)\(_{n+1} \).

So, all the statements in (2) are valid and hence \( f(n) = n \) for all \( n \). The given relation between \( f \) and \( g \) now reads \( n + g^n(n) = n + 1 = g(n + 1) + 1 \) or \( g^n(n) + g(n + 1) = 2 \), from which it immediately follows that we have \( g(n) = 1 \) for all \( n \).

The only pair \( (f, g) \) of functions that satisfies the equation is given by \( f(n) = n \) and \( g(n) = 1 \) for all \( n \).
So the value of \(f(2011)+g(2011)\) is \(2012\).",2012,algebra
2011a6,"Let \( f \) be a function from the set of real numbers to itself that satisfies
\[
f(x + y) \le yf(x) + f(f(x))
\]
for all real numbers \( x \) and \( y \). Give the value of \( f(-2011) \).
","Substituting \( y = t - x \), we rewrite (1) as
\[
f(t) \le tf(x) - xf(x) + f(f(x)). \tag{2}
\]

Consider now some real numbers \( a, b \) and use (2) with \( t = f(a), x = b \) as well as with \( t = f(b), x = a \). We get
\[
f(f(a)) - f(f(b)) \le f(a)f(b) - bf(b), \\
f(f(b)) - f(f(a)) \le f(a)f(b) - af(a).
\]

Adding these two inequalities yields
\[
2f(a)f(b) \ge af(a) + bf(b).
\]

Now, substitute \( b = 2f(a) \) to obtain \( 2f(a)f(b) \ge af(a) + 2f(a)f(b) \), or \( af(a) \le 0 \). So, we get
\[
f(a) \ge 0 \quad \text{for all } a < 0. \tag{3}
\]

Now suppose \( f(x) > 0 \) for some real number \( x \). From (2) we immediately get that for every
\[
t < \frac{xf(x) - f(f(x))}{f(x)}
\]
we have \( f(t) < 0 \). This contradicts (3); therefore
\[
f(x) \le 0 \quad \text{for all real } x, \tag{4}
\]
and by (3) again we get \( f(x) = 0 \) for all \( x < 0 \).

We are left to find \( f(0) \). Setting \( t = x < 0 \) in (2) we get
\[
0 \le 0 - 0 + f(0),
\]
so \( f(0) \ge 0 \). Combining this with (4) we obtain \( f(0) = 0 \).
",0,algebra
2011c1,"Let \( n > 0 \) be an integer. We are given a balance and \( n \) weights of weight \( 2^0, 2^1, \ldots, 2^{n-1} \). In a sequence of \( n \) moves we place all weights on the balance. In the first move we choose a weight and put it on the left pan. In each of the following moves we choose one of the remaining weights and we add it either to the left or to the right pan. When \(n=9\), compute the number of ways in which we can perform these \( n \) moves in such a way that the right pan is never heavier than the left pan. You should arrive at this number by taking the problem solution modulo \(1000\).
","Assume \( n \ge 2 \). We claim
\[
f(n) = (2n - 1)f(n - 1). \tag{1}
\]

Firstly, note that after the first move the left pan is always at least 1 heavier than the right one. Hence, any valid way of placing the \( n \) weights on the scale gives rise, by not considering weight \( 1 \), to a valid way of placing the weights \( 2, 2^2, \ldots, 2^{n-1} \).

If we divide the weight of each weight by 2, the answer does not change. So these \( n - 1 \) weights can be placed on the scale in \( f(n - 1) \) valid ways. Now we look at weight \( 1 \). If it is put on the scale in the first move, then it has to be placed on the left side, otherwise it can be placed either on the left or on the right side, because after the first move the difference between the weights on the left pan and the weights on the right pan is at least 2. Hence, there are exactly \( 2n - 1 \) different ways of inserting weight 1 in each of the \( f(n - 1) \) valid sequences for the \( n - 1 \) weights in order to get a valid sequence for the \( n \) weights. This proves the claim.

Since \( f(1) = 1 \), by induction we obtain for all positive integers \( n \)
\[
f(n) = (2n - 1)!! = 1 \cdot 3 \cdot 5 \cdots (2n - 1).
\]

So when \(n=9\), the number is \(34459425\). After taking the problem solution modulo \(1000\), the answer is \(425\).",425,combinatorics
2011c4,"Determine the greatest positive integer \( k \) that satisfies the following property: The set of positive integers can be partitioned into \( k \) subsets \( A_1, A_2, \ldots, A_k \) such that for all integers \( n \ge 15 \) and all \( i \in \{1, 2, \ldots, k\} \) there exist two distinct elements of \( A_i \) whose sum is \( n \).
","There are various examples showing that \( k = 3 \) does indeed have the property under consideration. E.g. one can take
\[
\begin{aligned}
A_1 &= \{1, 2, 3\} \cup \{3m \mid m \ge 4\}, \\
A_2 &= \{4, 5, 6\} \cup \{3m - 1 \mid m \ge 4\}, \\
A_3 &= \{7, 8, 9\} \cup \{3m - 2 \mid m \ge 4\}.
\end{aligned}
\]

To check that this partition fits, we notice first that the sums of two distinct elements of \( A_i \) obviously represent all numbers \( n \ge 1 + 12 = 13 \) for \( i = 1 \), all numbers \( n \ge 4 + 11 = 15 \) for \( i = 2 \), and all numbers \( n \ge 7 + 10 = 17 \) for \( i = 3 \). So, we are left to find representations of the numbers 15 and 16 as sums of two distinct elements of \( A_3 \). These are \( 15 = 7 + 8 \) and \( 16 = 7 + 9 \).

Let us now suppose that for some \( k \ge 4 \) there exist sets \( A_1, A_2, \ldots, A_k \) satisfying the given property. Obviously, the sets \( A_1, A_2, A_3, A_4 \cup \cdots \cup A_k \) also satisfy the same property, so one may assume \( k = 4 \).

Put \( B_i = A_i \cap \{1, 2, \ldots, 23\} \) for \( i = 1, 2, 3, 4 \). Now for any index \( i \) each of the ten numbers \( 15, 16, \ldots, 24 \) can be written as the sum of two distinct elements of \( B_i \). Therefore this set needs to contain at least five elements. As we also have \( |B_1| + |B_2| + |B_3| + |B_4| = 23 \), there has to be some index \( j \) for which \( |B_j| = 5 \). Let \( B_j = \{x_1, x_2, x_3, x_4, x_5\} \). Finally, now the sums of two distinct elements of \( A_j \) representing the numbers \( 15, 16, \ldots, 24 \) should be exactly all the pairwise sums of the elements of \( B_j \). Calculating the sum of these numbers in two different ways, we reach
\[
4(x_1 + x_2 + x_3 + x_4 + x_5) = 15 + 16 + \cdots + 24 = 195.
\]

Thus the number 195 should be divisible by 4, which is false. This contradiction completes our solution.
So the greatest such number \( k \) is \( 3 \).",3,combinatorics
2011c5,"Let \( m \) be a positive integer and consider a checkerboard consisting of \( m \) by \( m \) unit squares. At the midpoints of some of these unit squares there is an ant. At time 0, each ant starts moving with speed 1 parallel to some edge of the checkerboard. When two ants moving in opposite directions meet, they both turn \( 90^\circ \) clockwise and continue moving with speed 1. When more than two ants meet, or when two ants moving in perpendicular directions meet, the ants continue moving in the same direction as before they met. When an ant reaches one of the edges of the checkerboard, it falls off and will not re-appear.

Considering all possible starting positions, when \(m=2012\), determine the latest possible moment at which the last ant falls off the checkerboard or prove that such a moment does not necessarily exist.
","For \( m = 1 \) the answer is clearly correct, so assume \( m > 1 \). In the sequel, the word \textit{collision} will be used to denote meeting of exactly two ants, moving in opposite directions.

If at the beginning we place an ant on the southwest corner square facing east and an ant on the southeast corner square facing west, then they will meet in the middle of the bottom row at time \( \frac{m - 1}{2} \). After the collision, the ant that moves to the north will stay on the board for another \( m - \frac{1}{2} \) time units and thus we have established an example in which the last ant falls off at time
\[
\frac{m - 1}{2} + m - \frac{1}{2} = \frac{3m}{2} - 1.
\]
So, we are left to prove that this is the latest possible moment.

Consider any collision of two ants \( a \) and \( a' \). Let us change the rule for this collision, and enforce these two ants to turn anticlockwise. Then the succeeding behavior of all the ants does not change; the only difference is that \( a \) and \( a' \) swap their positions. These arguments may be applied to any collision separately, so we may assume that at any collision, either both ants rotate clockwise or both of them rotate anticlockwise by our own choice.

For instance, we may assume that there are only two types of ants, depending on their initial direction: \textit{NE-ants}, which move only north or east, and \textit{SW-ants}, moving only south and west. Then we immediately obtain that all ants will have fallen off the board after \( 2m - 1 \) time units. However, we can get a better bound by considering the last moment at which a given ant collides with another ant.

Choose a coordinate system such that the corners of the checkerboard are \( (0, 0), (m, 0), (m, m) \) and \( (0, m) \). At time \( t \), there will be no NE-ants in the region \( \{(x, y): x + y < t + 1\} \) and no SW-ants in the region \( \{(x, y): x + y > 2m - t - 1\} \). So if two ants collide at \( (x, y) \) at time \( t \), we have
\[
t + 1 \le x + y \le 2m - t - 1. \tag{1}
\]

Analogously, we may change the rules so that each ant would move either alternatingly north and west, or alternatingly south and east. By doing so, we find that apart from (1) we also have \( |x - y| \le m - t - 1 \) for each collision at point \( (x, y) \) and time \( t \).

To visualize this, put
\[
B(t) = \left\{ (x, y) \in [0, m]^2 : t + 1 \le x + y \le 2m - t - 1 \text{ and } |x - y| \le m - t - 1 \right\}.
\]

An ant can thus only collide with another ant at time \( t \) if it happens to be in the region \( B(t) \).

Now suppose that an NE-ant has its last collision at time \( t \) and that it does so at the point \( (x, y) \) (if the ant does not collide at all, then it will fall off the board within \( m - \frac{1}{2} < \frac{3m}{2} - 1 \) time units, so this case can be ignored). Then we have \( (x, y) \in B(t) \) and thus \( x + y \ge t + 1 \) and \( x - y \ge -(m - t - 1) \). So we get
\[
x \ge \frac{(t + 1) - (m - t - 1)}{2} = t + 1 - \frac{m}{2}.
\]

By symmetry we also have \( y \ge t + 1 - \frac{m}{2} \), and hence \( \min\{x, y\} \ge t + 1 - \frac{m}{2} \). After this collision, the ant will move directly to an edge, which will take at most \( m - \min\{x, y\} \) units of time. In sum, the total amount of time the ant stays on the board is at most
\[
t + (m - \min\{x, y\}) \le t + m - \left(t + 1 - \frac{m}{2}\right) = \frac{3m}{2} - 1.
\]

By symmetry, the same bound holds for SW-ants as well.

The latest possible moment for the last ant to fall off is \( \frac{3m}{2} - 1 \). When \(m=2012\), the answer is \(3017\).",3017,combinatorics
2011c7,"On a square table of \( 2011 \) by \( 2011 \) cells we place a finite number of napkins that each cover a square of \( 52 \) by \( 52 \) cells. In each cell we write the number of napkins covering it, and we record the maximal number \( k \) of cells that all contain the same nonzero number. Considering all possible napkin configurations, what is the largest value of \( k \)?
","Let \( m = 39 \), then \( 2011 = 52m - 17 \). We begin with an example showing that there can exist \( 3986729 \) cells carrying the same positive number.

To describe it, we number the columns from the left to the right and the rows from the bottom to the top by \( 1, 2, \ldots, 2011 \). We will denote each napkin by the coordinates of its lower-left cell. There are four kinds of napkins: first, we take all napkins \( (52i + 36, 52j + 1) \) with \( 0 \le j < i \le m - 2 \); second, we use all napkins \( (52i + 1, 52j + 36) \) with \( 0 \le i < j \le m - 2 \); third, we use all napkins \( (52i + 36, 52i + 36) \) with \( 0 \le i \le m - 2 \); and finally the napkin \( (1, 1) \). Different groups of napkins are shown by different types of hatchings in the picture.

Now except for those squares that carry two or more different hatchings, all squares have the number \( 1 \) written into them. The number of these exceptional cells is easily computed to be \( (52^2 - 35^2)m - 17^2 = 57392 \).

We are left to prove that \( 3986729 \) is an upper bound for the number of cells containing the same number. Consider any configuration of napkins and any positive integer \( M \). Suppose there are \( g \) cells with a number different from \( M \). Then it suffices to show \( g \ge 57392 \). Throughout the solution, a \textit{line} will mean either a row or a column.

Consider any line \( \ell \). Let \( a_1, \ldots, a_{52m - 17} \) be the numbers written into its consecutive cells. For \( i = 1, 2, \ldots, 52 \), let \( s_i = \sum_{t \equiv i \pmod{52}} a_t \). Note that \( s_1, \ldots, s_{35} \) have \( m \) terms each, while \( s_{36}, \ldots, s_{52} \) have \( m - 1 \) terms each. Every napkin intersecting \( \ell \) contributes exactly 1 to each \( s_i \); hence the number \( s \) of all those napkins satisfies \( s_1 = \cdots = s_{52} = s \). Call the line \( \ell \) \textit{rich} if \( s > (m - 1)M \) and \textit{poor} otherwise.

Suppose now that \( \ell \) is rich. Then in each of the sums \( s_{36}, \ldots, s_{52} \) there exists a term greater than \( M \); consider all these terms and call the corresponding cells the \textit{rich bad cells} for this line. So, each rich line contains at least 17 cells that are bad for this line.

If, on the other hand, \( \ell \) is poor, then certainly \( s < mM \) so in each of the sums \( s_1, \ldots, s_{35} \) there exists a term less than \( M \); consider all these terms and call the corresponding cells the \textit{poor bad cells} for this line. So, each poor line contains at least 35 cells that are bad for this line.

Let us call all indices congruent to \( 1, 2, \ldots, 35 \mod 52 \) \textit{small}, and all other indices, i.e. those congruent to \( 36, 37, \ldots, 0 \mod 52 \), \textit{big}. Recall that we have numbered the columns from the left to the right and the rows from the bottom to the top using the numbers \( 1, 2, \ldots, 52m - 17 \); we say that a line is \textit{big} or \textit{small} depending on whether its index is big or small. By definition, all rich bad cells for the rows belong to the big columns, while the poor ones belong to the small columns, and vice versa.

In each line, we put a \textit{strawberry} on each cell that is bad for this line. In addition, for each \textit{small rich} line we put an \textit{extra} strawberry on each of its (rich) bad cells. A cell gets the strawberries from its row and its column independently.

Notice now that a cell with a strawberry on it contains a number different from \( M \). If this cell gets a strawberry by the extra rule, then it contains a number greater than \( M \). Moreover, it is either in a small row and in a big column, or vice versa. Suppose that it is in a small row, then it is not bad for its column. So it has not more than two strawberries in this case. On the other hand, if the extra rule is not applied to some cell, then it also has not more than two strawberries. So, the total number \( N \) of strawberries is at most \( 2g \).

We shall now estimate \( N \) in a different way. For each of the \( 2 \cdot 35m \) small lines, we have introduced at least 34 strawberries if it is rich and at least 35 strawberries if it is poor, so at least 34 strawberries in any case. Similarly, for each of the \( 2 \cdot 17(m - 1) \) big lines, we put at least \( \min(17, 35) = 17 \) strawberries. Summing over all lines we obtain
\[
2g \ge N \ge 2(35m \cdot 34 + 17(m - 1) \cdot 17) = 2(1479m - 289) = 2 \cdot 57392,
\]
as desired.

\( 2011^2 - \left((52^2 - 35^2) \cdot 39 - 17^2\right) = 4044121 - 57392 = 3986729 \).
",3986729,combinatorics
2011g7,"Let \( ABCDEF \) be a convex hexagon all of whose sides are tangent to a circle \( \omega \) with center \( O \). Suppose that the circumcircle of triangle \( ACE \) is concentric with \( \omega \). Let \( J \) be the foot of the perpendicular from \( B \) to \( CD \). Suppose that the perpendicular from \( B \) to \( DF \) intersects the line \( EO \) at a point \( K \). Let \( L \) be the foot of the perpendicular from \( K \) to \( DE \). Give the value of \(frac{DJ}{DL}\).
","Let us denote the points of tangency of \( AB, BC, CD, DE, EF, \) and \( FA \) to \( \omega \) by \( R, S, T, U, V, \) and \( W \), respectively. As in the previous solution, we mention that \( AR = AW = CS = CT = EU = EV \).

The reflection in the line \( BO \) maps \( R \) to \( S \), therefore \( A \) to \( C \) and thus also \( W \) to \( T \). Hence, both lines \( RS \) and \( WT \) are perpendicular to \( OB \), therefore they are parallel. On the other hand, the lines \( UV \) and \( WT \) are not parallel, since otherwise the hexagon \( ABCDEF \) is symmetric with respect to the line \( BO \) and the lines defining the point \( K \) coincide, which contradicts the conditions of the problem. Therefore we can consider the intersection point \( Z \) of \( UV \) and \( WT \).

Next, we recall a well-known fact that the points \( D, F, Z \) are collinear. Actually, \( D \) is the pole of the line \( UT \), \( F \) is the pole of \( VW \), and \( Z = TW \cap UV \); so all these points belong to the polar line of \( TU \cap VW \).

Now, we put \( O \) into the origin, and identify each point (say \( X \)) with the vector \( \overrightarrow{OX} \). So, from now on all the products of points refer to the scalar products of the corresponding vectors.

Since \( OK \perp UZ \) and \( OB \perp TZ \), we have \( K \cdot (Z - U) = 0 = B \cdot (Z - T) \). Next, the condition \( BK \perp DZ \) can be written as \( K \cdot (D - Z) = B \cdot (D - Z) \). Adding these two equalities we get
\[
K \cdot (D - U) = B \cdot (D - T).
\]

By symmetry, we have \( D \cdot (D - U) = D \cdot (D - T) \). Subtracting this from the previous equation, we obtain \( (K - D) \cdot (D - U) = (B - D) \cdot (D - T) \) and rewrite it in vector form as
\[
\overrightarrow{DK} \cdot \overrightarrow{UD} = \overrightarrow{DB} \cdot \overrightarrow{TD}.
\]

Finally, projecting the vectors \( \overrightarrow{DK} \) and \( \overrightarrow{DB} \) onto the lines \( UD \) and \( TD \) respectively, we can rewrite this equality in terms of segment lengths as \( DL \cdot UD = DJ \cdot TD \), thus \( DL = DJ \).
",1,geometry
2011n2,"Consider a polynomial \( P(x) = (x + d_1)(x + d_2) \cdots (x + d_9) \), where \( d_1, d_2, \ldots, d_9 \) are nine distinct integers. Does there exist an integer \( N \) such that for all integers \( x \geq N \) the number \( P(x) \) is divisible by a prime number greater than \(20\)? If the answer is 'Yes', give the value \(1\). Else give \(0\).
","Note that the statement of the problem is invariant under translations of \( x \); hence without loss of generality we may suppose that the numbers \( d_1, d_2, \ldots, d_9 \) are positive.

The key observation is that there are only eight primes below 20, while \( P(x) \) involves more than eight factors.

We shall prove that \( N = d^8 \) satisfies the desired property, where \( d = \max\{d_1, d_2, \ldots, d_9\} \). Suppose for the sake of contradiction that there is some integer \( x \ge N \) such that \( P(x) \) is composed of primes below 20 only. Then for every index \( i \in \{1, 2, \ldots, 9\} \) the number \( x + d_i \) can be expressed as a product of powers of the first 8 primes.

Since \( x + d_i > x \ge d^8 \) there is some prime power \( f_i > d \) that divides \( x + d_i \). Invoking the pigeonhole principle we see that there are two distinct indices \( i \) and \( j \) such that \( f_i \) and \( f_j \) are powers of the same prime number. For reasons of symmetry, we may suppose that \( f_i \le f_j \). Now both of the numbers \( x + d_i \) and \( x + d_j \) are divisible by \( f_i \) and hence so is their difference \( d_i - d_j \). But as
\[
0 < |d_i - d_j| \le \max(d_i, d_j) \le d < f_i,
\]
this is impossible. Thereby the problem is solved.
",1,number theory
2011n4,"For each positive integer \( k \), let \( t(k) \) be the largest odd divisor of \( k \). Determine all positive integers \( a \) for which there exists a positive integer \( n \) such that all the differences
\[
t(n + a) - t(n), \quad t(n + a + 1) - t(n + 1), \quad \ldots, \quad t(n + 2a - 1) - t(n + a - 1)
\]
are divisible by 4. Calculate the sum of all possible \(a\).","A pair \( (a, n) \) satisfying the condition of the problem will be called a \textit{winning pair}. It is straightforward to check that the pairs \( (1, 1), (3, 1), \) and \( (5, 4) \) are winning pairs.

Now suppose that \( a \) is a positive integer not equal to \( 1, 3, \) and \( 5 \). We will show that there are no winning pairs \( (a, n) \) by distinguishing three cases.

\textbf{Case 1:} \( a \) is even. In this case we have \( a = 2^c d \) for some positive integer \( c \) and some odd \( d \). Since \( a \ge 2^c \), for each positive integer \( n \) there exists an \( i \in \{0, 1, \ldots, a-1\} \) such that \( n + i = 2^c - 1 e \), where \( e \) is some odd integer. Then we have \( t(n + i) = t(2^c \cdot e) = e \) and
\[
t(n + a + i) = t(2^c d + 2^c \cdot 2^c e) = 2d + e \equiv e + 2 \pmod{4}.
\]
So we get \( t(n + i) - t(n + a + i) \equiv 2 \pmod{4} \), and \( (a, n) \) is not a winning pair.

\textbf{Case 2:} \( a \) is odd and \( a > 8 \). For each positive integer \( n \), there exists an \( i \in \{0, 1, \ldots, a - 5\} \) such that \( n + i = 2d \) for some odd \( d \). We get
\[
t(n + i) = d \not\equiv d + 2 = t(n + i + 4) \pmod{4}
\]
and
\[
t(n + a + i) = n + a + i \equiv n + a + i + 4 = t(n + a + i + 4) \pmod{4}.
\]
Therefore, the integers \( t(n + a + i) - t(n + i) \) and \( t(n + a + i + 4) - t(n + i + 4) \) cannot be both divisible by 4, and therefore there are no winning pairs in this case.

\textbf{Case 3:} \( a = 7 \). For each positive integer \( n \), there exists an \( i \in \{0, 1, \ldots, 6\} \) such that \( n + i \) is either of the form \( 8k + 3 \) or of the form \( 8k + 6 \), where \( k \) is a nonnegative integer. But we have
\[
t(8k + 3) \equiv 3 \not\equiv 1 \equiv 4k + 5 = t(8k + 3 + 7) \pmod{4}
\]
and
\[
t(8k + 6) \equiv 4k + 3 \equiv 3 \not\equiv 1 \equiv t(8k + 6 + 7) \pmod{4}.
\]
Hence, there are no winning pairs of the form \( (7, n) \).
So \( a = 1, 3, \text{ or } 5 \).",9,number theory
2011n7,"Let \( p \) be an odd prime number. For every integer \( a \), define the number
\[
S_a = \frac{a}{1} + \frac{a^2}{2} + \cdots + \frac{a^{p-1}}{p - 1}.
\]

Let \( m \) and \( n \) be integers such that
\[
S_3 + S_4 - 3S_2 = \frac{m}{n}.
\]

Does \( p \) divide \( m \)? If the answer is 'Yes', give the value \(1\). Else give \(0\).
","For rational numbers \( p_1/q_1 \) and \( p_2/q_2 \) with the denominators \( q_1, q_2 \) not divisible by \( p \), we write \( p_1/q_1 \equiv p_2/q_2 \pmod{p} \) if the numerator \( p_1q_2 - p_2q_1 \) of their difference is divisible by \( p \).

We start with finding an explicit formula for the residue of \( S_a \) modulo \( p \). Note first that for every \( k = 1, \ldots, p - 1 \) the number \( \binom{p}{k} \) is divisible by \( p \), and
\[
\frac{1}{p} \binom{p}{k} = \frac{(p - 1)(p - 2) \cdots (p - k + 1)}{k!} \equiv \frac{(-1)(-2) \cdots (-k + 1)}{k!} = \frac{(-1)^k}{k} \pmod{p}.
\]

Therefore, we have
\[
S_a = -\sum_{k = 1}^{p - 1} \frac{(-a)^k (-1)^{k - 1}}{k} \equiv -\sum_{k = 1}^{p - 1} (-a)^k \cdot \frac{1}{p} \binom{p}{k} \pmod{p}.
\]

The number on the right-hand side is integer. Using the binomial formula we express it as
\[
-\sum_{k = 1}^{p - 1} (-a)^k \cdot \frac{1}{p} \binom{p}{k} = -\frac{1}{p} \left( -1 - (-a)^p + \sum_{k = 0}^{p} (-a)^k \binom{p}{k} \right) = \frac{(a - 1)^p - a^p + 1}{p}
\]
since \( p \) is odd. So, we have
\[
S_a \equiv \frac{(a - 1)^p - a^p + 1}{p} \pmod{p}.
\]

Finally, using the obtained formula we get
\[
S_3 + S_4 - 3S_2 \equiv \frac{(2^p - 3^p + 1) + (3^p - 4^p + 1) - 3(1^p - 2^p + 1)}{p}
= \frac{4 \cdot 2^p - 4}{p} = \frac{(2^p - 2)^2}{p} \pmod{p}.
\]

By Fermat’s theorem, \( p \mid 2^p - 2 \), so \( p^2 \mid (2^p - 2)^2 \) and hence \( S_3 + S_4 - 3S_2 \equiv 0 \pmod{p} \).
",1,number theory
2010a1,"Determine all functions \( f : \mathbb{R} \to \mathbb{R} \) such that the equality
\[
f(\lfloor x \rfloor y) = f(x) \lfloor f(y) \rfloor
\]
holds for all \( x, y \in \mathbb{R} \). Here, by \( \lfloor x \rfloor \) we denote the greatest integer not exceeding \( x \).
If \(f(1)=1\), give the value of \(f(2010)\).
","First, setting \( x = 0 \) in (1) we get
\[
f(0) = f(0) \lfloor f(y) \rfloor \tag{2}
\]
for all \( y \in \mathbb{R} \). Now, two cases are possible.

\textbf{Case 1.} Assume that \( f(0) \neq 0 \). Then from (2) we conclude that \( \lfloor f(y) \rfloor = 1 \) for all \( y \in \mathbb{R} \). Therefore, equation (1) becomes \( f(\lfloor x \rfloor y) = f(x) \), and substituting \( y = 0 \) we have \( f(x) = f(0) = C \neq 0 \). Finally, from \( \lfloor f(y) \rfloor = 1 = \lfloor C \rfloor \) we obtain that \( 1 \leq C < 2 \).

\textbf{Case 2.} Now we have \( f(0) = 0 \). Here we consider two subcases.

\textbf{Subcase 2a.} Suppose that there exists \( 0 < \alpha < 1 \) such that \( f(\alpha) \neq 0 \). Then setting \( x = \alpha \) in (1) we obtain \( 0 = f(0) = f(\alpha)\lfloor f(y) \rfloor \) for all \( y \in \mathbb{R} \). Hence, \( \lfloor f(y) \rfloor = 0 \) for all \( y \in \mathbb{R} \). Finally, substituting \( x = 1 \) in (1) provides \( f(y) = 0 \) for all \( y \in \mathbb{R} \), thus contradicting the condition \( f(\alpha) \neq 0 \).

\textbf{Subcase 2b.} Conversely, we have \( f(\alpha) = 0 \) for all \( 0 \leq \alpha < 1 \). Consider any real \( z \); there exists an integer \( N \) such that \( \alpha = \frac{z}{N} \in [0, 1) \) (one may set \( N = \lfloor z \rfloor + 1 \) if \( z \geq 0 \) and \( N = \lfloor z \rfloor - 1 \) otherwise). Now, from (1) we get \( f(z) = f(N\alpha) = f(N)\lfloor f(\alpha) \rfloor = 0 \) for all \( z \in \mathbb{R} \).

Finally, a straightforward check shows that all the obtained functions satisfy (1).

\textbf{Solution 2.} Assume that \( \lfloor f(y) \rfloor = 0 \) for some \( y \); then the substitution \( x = 1 \) provides \( f(y) = f(1)\lfloor f(y) \rfloor = 0 \). Hence, if \( \lfloor f(y) \rfloor = 0 \) for all \( y \), then \( f(y) = 0 \) for all \( y \). This function obviously satisfies the problem conditions.

So we are left to consider the case when \( \lfloor f(a) \rfloor \neq 0 \) for some \( a \). Then we have
\[
f(\lfloor x \rfloor a) = f(x)\lfloor f(a) \rfloor, \quad \text{or} \quad f(x) = \frac{f(\lfloor x \rfloor a)}{\lfloor f(a) \rfloor}. \tag{3}
\]
This means that \( f(x_1) = f(x_2) \) whenever \( \lfloor x_1 \rfloor = \lfloor x_2 \rfloor \), hence \( f(x) = f(\lfloor x \rfloor) \), and we may assume that \( a \) is an integer.

Now we have
\[
f(a) = f(2a \cdot \tfrac{1}{2}) = f(2a) \lfloor f(\tfrac{1}{2}) \rfloor = f(2a)\lfloor f(0) \rfloor;
\]
this implies \( \lfloor f(0) \rfloor \neq 0 \), so we may even assume that \( a = 0 \). Therefore equation (3) provides
\[
f(x) = \frac{f(0)}{\lfloor f(0) \rfloor} = C \neq 0
\]
for each \( x \). Now, condition (1) becomes equivalent to the equation \( C = C\lfloor C \rfloor \) which holds exactly when \( \lfloor C \rfloor = 1 \).

\( f(x) = \text{const} = C \), where \( C = 0 \) or \( 1 \leq C < 2 \).

If \(f(1)=1\), the value of \(f(2010)\) is \(1\).",1,algebra
2010a3,"Let \( x_1, \ldots, x_{100} \) be nonnegative real numbers such that \( x_i + x_{i+1} + x_{i+2} \leq 1 \) for all \( i = 1, \ldots, 100 \) (we put \( x_{101} = x_1, x_{102} = x_2 \)). Find the maximal possible value of the sum
\[
S = \sum_{i=1}^{100} x_i x_{i+2}.
\]
Give the value of \(2S\).
","Let \( x_{2i} = 0, x_{2i-1} = \frac{1}{2} \) for all \( i = 1, \ldots, 50 \). Then we have \( S = 50 \cdot \left(\frac{1}{2}\right)^2 = \frac{25}{2} \). So, we are left to show that \( S \leq \frac{25}{2} \) for all values of \( x_i \)'s satisfying the problem conditions.

Consider any \( 1 \leq i \leq 50 \). By the problem condition, we get \( x_{2i-1} \leq 1 - x_{2i} - x_{2i+1} \) and \( x_{2i+2} \leq 1 - x_{2i} - x_{2i+1} \). Hence by the AM-GM inequality we get
\[
x_{2i-1}x_{2i+1} + x_{2i}x_{2i+2} \leq (1 - x_{2i} - x_{2i+1})x_{2i+1} + x_{2i}(1 - x_{2i} - x_{2i+1})
\]
\[
= (x_{2i} + x_{2i+1})(1 - x_{2i} - x_{2i+1}) \leq \left( \frac{x_{2i} + x_{2i+1} + (1 - x_{2i} - x_{2i+1})}{2} \right)^2 = \left( \frac{1}{2} \right)^2 = \frac{1}{4}.
\]

Summing up these inequalities for \( i = 1, 2, \ldots, 50 \), we get the desired inequality
\[
\sum_{i=1}^{50} \left( x_{2i-1}x_{2i+1} + x_{2i}x_{2i+2} \right) \leq 50 \cdot \frac{1}{4} = \frac{25}{2}.
\]
So the value of \(2S\) is \(25\).",25,algebra
2010a5,"Denote by \( \mathbb{Q}^+ \) the set of all positive rational numbers. Determine all functions \( f : \mathbb{Q}^+ \to \mathbb{Q}^+ \) which satisfy the following equation for all \( x, y \in \mathbb{Q}^+ \):
\[
f\left(f(x)^2 y\right) = x^3 f(xy). \tag{1}
\]
Give the value of \(f(\frac{1}{2010})\).
","By substituting \( y = 1 \), we get
\[
f(f(x)^2) = x^3 f(x). \tag{2}
\]

Then, whenever \( f(x) = f(y) \), we have
\[
x^3 = \frac{f(f(x)^2)}{f(x)} = \frac{f(f(y)^2)}{f(y)} = y^3
\]
which implies \( x = y \), so the function \( f \) is injective.

Now replace \( x \) by \( xy \) in (2), and apply (1) twice, second time to \( (y, f(x)^2) \) instead of \( (x, y) \):
\[
f(f(xy)^2 y) = (xy)^3 f(xy) = y^3 f(x)^3 f(y) = f(f(x)^2 f(y)^2).
\]
Since \( f \) is injective, we get
\[
f(xy)^2 = f(x)^2 f(y)^2,
\]
\[
f(xy) = f(x) f(y).
\]
Therefore, \( f \) is multiplicative. This also implies \( f(1) = 1 \) and \( f(x^n) = f(x)^n \) for all integers \( n \).

Then the function equation (1) can be re-written as
\[
f(f(x)^2 y) = x^3 f(x) f(y), \quad
f(f(x)) = \sqrt[3]{x^3 f(x)}. \tag{3}
\]

Let \( g(x) = x f(x) \). Then, by (3), we have
\[
g(g(x)) = g(x f(x)) = x f(x) \cdot f(x f(x)) = x f(x)^2 f(x f(x))
\]
\[
= x f(x)^2 \sqrt[3]{x^3 f(x)} = (x f(x))^{5/2} = (g(x))^{5/2},
\]
and, by induction,
\[
g\left( \underbrace{g(\ldots g(g(x)) \ldots)}_{n+1} \right) = (g(x))^{(5/2)^n} \tag{4}
\]
for every positive integer \( n \).

Consider (4) for a fixed \( x \). The left-hand side is always rational, so \( (g(x))^{(5/2)^n} \) must be rational for every \( n \). We show that this is possible only if \( g(x) = 1 \). Suppose that \( g(x) \neq 1 \), and let the prime factorization of \( g(x) \) be \( g(x) = p_1^{\alpha_1} \cdots p_k^{\alpha_k} \) where \( p_1, \ldots, p_k \) are distinct primes and \( \alpha_1, \ldots, \alpha_k \) are nonzero integers. Then the unique prime factorization of (4) is
\[
g\left( \underbrace{g(\ldots g(g(x)) \ldots)}_{n+1} \right) = (g(x))^{(5/2)^n} = p_1^{(5/2)^n \alpha_1} \cdots p_k^{(5/2)^n \alpha_k}
\]
where the exponents should be integers. But this is not true for large values of \( n \), for example \( \left(\frac{5}{2}\right)^n \alpha_1 \) cannot be an integer number when \( 2^n \nmid \alpha_1 \). Therefore, \( g(x) \neq 1 \) is impossible.

Hence, \( g(x) = 1 \) and thus \( f(x) = \frac{1}{x} \) for all \( x \).

The function \( f(x) = \frac{1}{x} \) satisfies the equation (1):
\[
f(f(x)^2 y) = \frac{1}{f(x)^2 y} = \frac{1}{\left(\frac{1}{x}\right)^2 y} = \frac{x^2}{y} = x^3 \cdot \frac{1}{x y} = x^3 f(xy).
\]
The only such function is \( f(x) = \frac{1}{x} \). So the value of \(f(\frac{1}{2010})\) is \(2010\).",2010,algebra
2010a6,"Suppose that \( f \) and \( g \) are two functions defined on the set of positive integers and taking positive integer values. Suppose also that the equations \( f(g(n)) = f(n) + 1 \) and \( g(f(n)) = g(n) + 1 \) hold for all positive integers. Prove that \( f(n) = g(n) \) for all positive integer \( n \). Give the value of \( \frac{f(2010)}{g(2010)} \).
","Throughout the solution, by \( \mathbb{N} \) we denote the set of all positive integers. For any function \( h \colon \mathbb{N} \to \mathbb{N} \) and for any positive integer \( k \), define \( h^{k}(x) = h(h(\ldots h(x)\ldots)) \) (in particular, \( h^0(x) = x \)).

Observe that \( f(g^k(x)) = f(g^{k-1}(x)) + 1 = \cdots = f(x) + k \) for any positive integer \( k \), and similarly \( g(f^k(x)) = g(x) + k \). Now let \( a \) and \( b \) are the minimal values attained by \( f \) and \( g \), respectively; say \( f(n_f) = a, g(n_g) = b \). Then we have \( f(g^k(n_f)) = a + k, g(f^k(n_g)) = b + k \), so the function \( f \) attains all values from the set \( N_f = \{a, a+1, \ldots\} \), while \( g \) attains all the values from the set \( N_g = \{b, b+1, \ldots\} \).

Next, note that \( f(x) = f(y) \) implies \( g(x) = g(f(y)) - 1 = g(f(y)) - 1 = g(y) \); surely, the converse implication also holds. Now, we say that \( x \) and \( y \) are \emph{similar} (and write \( x \sim y \)) if \( f(x) = f(y) \) (equivalently, \( g(x) = g(y) \)). For every \( x \in \mathbb{N} \), we define \( [x] = \{ y \in \mathbb{N} : x \sim y \} \); surely, \( y_1 \sim y_2 \) for all \( y_1, y_2 \in [x] \), so \( [x] = [y] \) whenever \( y \in [x] \).

Now we investigate the structure of the sets \( [x] \).

\textbf{Claim 1.} Suppose that \( f(x) = f(y) \); then \( x \sim y \), that is, \( f(x) = f(y) \). Consequently, each class \( [x] \) contains at most one element from \( N_f \), as well as at most one element from \( N_g \).

\textit{Proof.} If \( f(x) = f(y) \), then we have \( g(x) = g(f(y)) - 1 = g(f(y)) - 1 = g(y) \), so \( x \sim y \). The second statement follows now from the sets of values of \( f \) and \( g \).

Next, we clarify which classes do not contain large elements.

\textbf{Claim 2.} For any \( x \in \mathbb{N} \), we have \( [x] \subseteq \{1,2,\ldots, b - 1\} \) if and only if \( f(x) = a \). Analogously, \( [x] \subseteq \{1,2,\ldots, a - 1\} \) if and only if \( g(x) = b \).

\textit{Proof.} We will prove that \( [x] \subset \{1,2,\ldots, b - 1\} \Rightarrow f(x) > a \); the proof of the second statement is similar.

Note that \( f(x) > a \) implies that there exists some \( y \) satisfying \( f(y) = f(x) - 1 \), so \( f(g(y)) = f(y) + 1 = f(x) \), and hence \( x \sim g(y) \ge b \). Conversely, if \( b \le c \sim x \) then \( c = g(y) \) for some \( y \in \mathbb{N} \), which in turn follows if \( f(x) = f(g(y)) = f(y) + 1 \ge a + 1 \), and hence \( f(x) > a \).

Claim 2 implies that there exists exactly one class contained in \( \{1, \ldots, a - 1\} \) (that is, the class \( [n_g] \)), as well as exactly one class contained in \( \{1, \ldots, b - 1\} \) (the class \( [n_f] \)). Assume for a moment that \( a \le b \); then \( [n_g] \) is contained in \( \{1, \ldots, b - 1\} \) as well, hence it coincides with \( [n_g] \). So, we get that
\[
f(x) = a \iff g(x) = b \iff x \sim n_f \sim n_g. \tag{1}
\]

\textbf{Claim 3.} \( a = b \).

\textit{Proof.} By Claim 2, we have \( [a] \ne [n_f] \), so \( [a] \) should contain some element \( a' \ge b \) by Claim 2 again. If \( a \ne a' \), then \( [a] \) contains two elements \( \ge a \) which is impossible by Claim 1. Therefore, \( a = a' \ge b \). Similarly, \( b \ge a \).

Now we are ready to prove the problem statement. First, we establish the following

\textbf{Claim 4.} For every integer \( d \ge 0 \), \( f^{d+1}(n_f) = g^{d+1}(n_f) = a + d \).

\textit{Proof.} Induction on \( d \). For \( d = 0 \), the statement follows from (1) and Claim 3. Next, for \( d > 1 \) the induction hypothesis we have \( f^{d+1}(n_f) = f(f^d(n_f)) = f(g^d(n_f)) = f(n_f) + d = a + d \). The equality \( g^{d+1}(n_f) = a + d \) is analogous.

Finally, for each \( x \in \mathbb{N} \), we have \( f(x) = a + d \) for some \( d \ge 0 \), so \( f(x) = f(g^d(n_f)) \) and hence \( x \sim g^d(n_f) \). It follows that \( g(x) = g(g^d(n_f)) = g^{d+1}(n_f) = a + d = f(x) \) by Claim 4.

\( f(n) = g(n) \) for all positive integer \( n \). So the value of \( \frac{f(2010)}{g(2010)} \) is \(1\).",1,algebra
2010c1,"In a concert, 20 singers will perform. For each singer, there is a (possibly empty) set of other singers such that he wishes to perform later than all the singers from that set. Can it happen that there are exactly 2010 orders of the singers such that all their wishes are satisfied? If the answer is 'Yes', give the value \(1\). Else give \(0\).
","We say that an order of singers is \emph{good} if it satisfied all their wishes. Next, we say that a number $N$ is \emph{realizable} by $k$ singers (or $k$-realizable) if for some set of wishes of these singers there are exactly $N$ good orders. Thus, we have to prove that a number $2010$ is $20$-realizable.

We start with the following simple

\textbf{Lemma.} Suppose that numbers $n_1, n_2$ are realizable by respectively $k_1$ and $k_2$ singers. Then the number $n_1n_2$ is $(k_1 + k_2)$-realizable.

\textit{Proof.} Let the singers $A_1, \dots, A_{k_1}$ (with some wishes among them) realize $n_1$, and the singers $B_1, \dots, B_{k_2}$ (with some wishes among them) realize $n_2$. Add to each singer $B_i$ the wish to perform later than all the singers $A_j$. Then, each good order of the obtained set of singers has the form $(A_{i_1}, \dots, A_{i_{k_1}}, B_{j_1}, \dots, B_{j_{k_2}})$, where $(A_{i_1}, \dots, A_{i_{k_1}})$ is a good order for $A_i$'s and $(B_{j_1}, \dots, B_{j_{k_2}})$ is a good order for $B_j$'s. Conversely, each order of this form is obviously good. Hence, the number of good orders is $n_1n_2$. $\square$

In view of Lemma, we show how to construct sets of singers containing 4, 3 and 13 singers and realizing the numbers 5, 6 and 67, respectively. Thus the number $2010 = 6 \cdot 5 \cdot 67$ will be realizable by $4 + 3 + 13 = 20$ singers. These companies of singers are shown in Figs. 1--3; the wishes are denoted by arrows, and the number of good orders for each Figure stands below in the brackets.

For Fig. 1, there are exactly 5 good orders $(a, b, c, d),\ (a, b, d, c),\ (b, a, c, d),\ (b, a, d, c),\ (b, d, a, c)$. For Fig. 2, each of 6 orders is good since there are no wishes.

Finally, for Fig. 3, the order of $a_1, \dots, a_{11}$ is fixed; in this line, singer $x$ can stand before each of $a_i$ ($i \leq 9$), and singer $y$ can stand after each of $a_j$ ($j \geq 5$), thus resulting in $9 \cdot 7 = 63$ cases. Further, the positions of $x$ and $y$ in this line determine the whole order uniquely unless both of them come between the same pair $(a_i, a_{i+1})$ (thus $5 \leq i \leq 8$); in the latter cases, there are two orders instead of 1 due to the order of $x$ and $y$. Hence, the total number of good orders is $63 + 4 = 67$, as desired.

So the answer is 'Yes', such an example exists.",1,combinatorics
2010c2,"On some planet, there are $2^N$ countries $(N \geq 4)$. Each country has a flag $N$ units wide and one unit high composed of $N$ fields of size $1 \times 1$, each field being either yellow or blue. No two countries have the same flag.

We say that a set of $N$ flags is \textit{diverse} if these flags can be arranged into an $N \times N$ square so that all $N$ fields on its main diagonal will have the same color. Determine the smallest positive integer $M$ such that among any $M$ distinct flags, there exist $N=15$ flags forming a diverse set.
","When speaking about the diagonal of a square, we will always mean the main diagonal.

Let $M_N$ be the smallest positive integer satisfying the problem condition. First, we show that $M_N > 2^{N-2}$. Consider the collection of all $2^{N-2}$ flags having yellow first squares and blue second ones. Obviously, both colors appear on the diagonal of each $N \times N$ square formed by these flags.

We are left to show that $M_N \leq 2^{N-2} + 1$, thus obtaining the desired answer. We start with establishing this statement for $N = 4$.

Suppose that we have 5 flags of length 4. We decompose each flag into two parts of 2 squares each; thereby, we denote each flag as $LR$, where the $2 \times 1$ flags $L, R \in S = \{\text{BB}, \text{BY}, \text{YB}, \text{YY}\}$ are its left and right parts, respectively. First, we make two easy observations on the flags $2 \times 1$ which can be checked manually.

\begin{itemize}
    \item[(i)] For each $A \in S$, there exists only one $2 \times 1$ flag $C \in S$ (possibly $C = A$) such that $A$ and $C$ cannot form a $2 \times 2$ square with monochrome diagonal (for part BB, that is YY, and for BY that is YB).
    \item[(ii)] Let $A_1, A_2, A_3 \in S$ be three distinct elements; then two of them can form a $2 \times 2$ square with yellow diagonal, and two of them can form a $2 \times 2$ square with blue diagonal (for all parts but BB, a pair (BY, YB) fits for both statements, while for all parts but BY, these pairs are (YB, YY) and (BB, YB)).
\end{itemize}

Now, let $\ell$ and $r$ be the numbers of distinct left and right parts of our 5 flags, respectively. The total number of flags is $5 \leq r\ell$, hence one of the factors (say, $r$) should be at least 3. On the other hand, $\ell, r < 4$, so there are two flags with coinciding right part; let them be $L_1R_1$ and $L_2R_1$ ($L_1 \neq L_2$).

Next, since $r \geq 3$, there exist some flags $L_3R_3$ and $L_4R_4$ such that $R_1, R_3, R_4$ are distinct. Let $L', L''$ be the remaining flags. By (i), one of the pairs $(L', L_1)$ and $(L'', L_2)$ can form a $2 \times 2$ square with monochrome diagonal; we can assume that $L', L_2$ form a square with a blue diagonal. Finally, the right parts of two of the flags $L_1R_1, L_3R_3, L_4R_4$ can also form a $2 \times 2$ square with a blue diagonal by (ii). Putting these $2 \times 2$ squares on the diagonal of a $4 \times 4$ square, we find a desired arrangement of four flags.

We are ready to prove the problem statement by induction on $N$; actually, above we have proved the base case $N = 4$. For the induction step, assume that $N > 4$, consider any $2^{N-2} + 1$ flags of length $N$, and arrange them into a large flag of size $(2^{N-2} + 1) \times N$. This flag contains a non-monochrome column since the flags are distinct; we may assume that this column is the first one. By the pigeonhole principle, this column contains at least
\[
\left\lceil \frac{2^{N-2} + 1}{2} \right\rceil = 2^{N-3} + 1
\]
squares of one color (say, blue). We call the flags with a blue first square \textit{good}.

Consider all the good flags and remove the first square from each of them. We obtain at least $2^{N-3} + 1 \geq M_{N-1}$ flags of length $N - 1$; by the induction hypothesis, $N - 1$ of them can form a square $Q$ with the monochrome diagonal. Now, returning the removed squares, we obtain a rectangle $(N - 1) \times N$, and our aim is to supplement it on the top by one more flag.

If $Q$ has a yellow diagonal, then we can take each flag with a yellow first square (it exists by a choice of the first column; moreover, it is not used in $Q$). Conversely, if the diagonal of $Q$ is blue then we can take any of the $\geq 2^{N-3} + 1 - (N - 1) > 0$ remaining good flags. So, in both cases we get a desired $N \times N$ square.

So $M = 2^{N-2} + 1$. When $N=15$, $M=8193$.",8193,combinatorics
2010c3,"2500 chess kings have to be placed on a $100 \times 100$ chessboard so that  

(i) no king can capture any other one (i.e. no two kings are placed in two squares sharing a common vertex);  

(ii) each row and each column contains exactly 25 kings.  

Find the number of such arrangements. (Two arrangements differing by rotation or symmetry are supposed to be different.)
","Suppose that we have an arrangement satisfying the problem conditions. Divide the board into $2 \times 2$ pieces; we call these pieces \textit{blocks}. Each block can contain not more than one king (otherwise these two kings would attack each other); hence, by the pigeonhole principle each block must contain exactly one king.

Now assign to each block a letter T or B if a king is placed in its top or bottom half, respectively. Similarly, assign to each block a letter L or R if a king stands in its left or right half. So we define \textit{T-blocks}, \textit{B-blocks}, \textit{L-blocks}, and \textit{R-blocks}. We also combine the letters; we call a block a \textit{TL-block} if it is simultaneously T-block and L-block. Similarly we define \textit{TR-blocks}, \textit{BL-blocks}, and \textit{BR-blocks}. The arrangement of blocks determines uniquely the arrangement of kings; so in the rest of the solution we consider the $50 \times 50$ system of blocks (see Fig. 1). We identify the blocks by their coordinate pairs; the pair $(i, j)$, where $1 \le i,j \le 50$, refers to the $j$th block in the $i$th row (or the $i$th block in the $j$th column). The upper-left block is $(1, 1)$.

The system of blocks has the following properties.
\begin{itemize}
    \item[(i')] If $(i, j)$ is a B-block then $(i+1,j)$ is a B-block: otherwise the kings in these two blocks can take each other. Similarly: if $(i,j)$ is a T-block then $(i-1,j)$ is a T-block; if $(i,j)$ is an L-block then $(i,j-1)$ is an L-block; if $(i,j)$ is an R-block then $(i,j+1)$ is an R-block.
    \item[(ii')] Each column contains exactly 25 L-blocks and 25 R-blocks, and each row contains exactly 25 T-blocks and 25 B-blocks. In particular, the total number of L-blocks (or R-blocks, or T-blocks, or B-blocks) is equal to $25 \cdot 50 = 1250$.
\end{itemize}

Consider any B-block of the form $(1,j)$. By (i'), all blocks in the $j$th column are B-blocks; so we call such a column \textit{B-column}. By (ii'), we have 25 B-blocks in the first row, so we obtain 25 B-columns. These 25 B-columns contain 1250 B-blocks, hence all blocks in the remaining columns are T-blocks, and we obtain 25 \textit{T-columns}. Similarly, there are exactly 25 \textit{L-rows} and exactly 25 \textit{R-rows}.

Now consider an arbitrary pair of a T-column and a neighboring B-column (columns with numbers $j$ and $j+1$).

\textit{Case 1.} Suppose that the $j$th column is a T-column, and the $(j+1)$th column is a B-column. Consider some index $i$ such that the $i$th row is an L-row; then $(i,j+1)$ is a BL-block. Therefore, $(i+1,j)$ cannot be a TR-block (see Fig. 2), hence $(i+1,j)$ is a TL-block; thus the $(i+1)$th row is an L-row. Now, choosing the $i$th row to be the topmost L-row, we successively obtain that all rows from the $i$th to the 50th are L-rows. Since we have exactly 25 L-rows, it follows that the rows from the 1st to the 25th are R-rows, and the rows from the 26th to the 50th are L-rows.

Now consider the neighboring R-row and L-row (that are the rows with numbers 25 and 26). Replacing in the previous reasoning rows by columns and vice versa, the columns from the 1st to the 25th are T-columns, and the columns from the 26th to the 50th are B-columns. So we have a unique arrangement of blocks that leads to the arrangement of kings satisfying the condition of the problem (see Fig. 3).

\textit{Case 2.} Suppose that the $j$th column is a B-column, and the $(j+1)$th column is a T-column. Repeating the arguments from Case 1, we obtain that the rows from the 1st to the 25th are L-rows (and all other rows are R-rows), the columns from the 1st to the 25th are B-columns (and all other columns are T-columns), so we find exactly one more arrangement of kings (see Fig. 4).

So there are two such arrangements.",2,combinatorics
2010c4,"Six stacks $S_1, \ldots, S_6$ of coins are standing in a row. In the beginning every stack contains a single coin. There are two types of allowed moves:

\textit{Move 1:} If stack $S_k$ with $1 \leq k \leq 5$ contains at least one coin, you may remove one coin from $S_k$ and add two coins to $S_{k+1}$.

\textit{Move 2:} If stack $S_k$ with $1 \leq k \leq 4$ contains at least one coin, then you may remove one coin from $S_k$ and exchange stacks $S_{k+1}$ and $S_{k+2}$.

Decide whether it is possible to achieve by a sequence of such moves that the first five stacks are empty, whereas the sixth stack $S_6$ contains exactly $2010^{2010^{2010}}$ coins. If the answer is 'Yes', give the value \(1\). Else give \(0\).

","Denote by $(a_1, a_2, \ldots, a_n) \rightarrow (a_1', a_2', \ldots, a_n')$ the following: if some consecutive stacks contain $a_1, \ldots, a_n$ coins, then it is possible to perform several allowed moves such that the stacks contain $a_1', \ldots, a_n'$ coins respectively, whereas the contents of the other stacks remain unchanged.

Let $A = 2010^{2010}$ or $A = 2010^{2010^{2010}}$, respectively. Our goal is to show that
$$(1,1,1,1,1,1) \rightarrow (0,0,0,0,0,A).$$

First we prove two auxiliary observations.

\textbf{Lemma 1.} $(a,0,0) \rightarrow (0,2^a,0)$ for every $a \geq 1$.

\textit{Proof.} We prove by induction that $(a,0,0) \rightarrow (a-k,2^k,0)$ for every $1 \leq k \leq a$. For $k=1$, apply Move 1 to the first stack:
$$(a,0,0) \rightarrow (a-1,2,0) = (a-1,2^1,0).$$

Now assume that $k < a$ and the statement holds for some $k < a$. Starting from $(a-k,2^k,0)$, apply Move 1 to the middle stack $2^k$ times, until it becomes empty. Then apply Move 2 to the first stack:
$$(a-k,2^k,0) \rightarrow (a-k,2^k-1,2) \rightarrow \cdots \rightarrow (a-k,0,2^{k+1}) \rightarrow (a-k-1,2^{k+1},0).$$
Hence,
$$(a,0,0) \rightarrow (a-k,2^k,0) \rightarrow (a-k-1,2^{k+1},0). \quad \square$$

\textbf{Lemma 2.} For every positive integer $n$, let $P_n = \frac{2^{2^n}}{n}$ (e.g. $P_3 = \frac{2^8}{3} = 16$). Then
$$(a,0,0,0) \rightarrow (0,P_a,0,0) \quad \text{for every } a \geq 1.$$

\textit{Proof.} Similarly to Lemma 1, we prove that $(a,0,0,0) \rightarrow (a-k,P_k,0,0)$ for every $1 \leq k \leq a$.

For $k=1$, apply Move 1 to the first stack:
$$(a,0,0,0) \rightarrow (a-1,2,0,0) = (a-1,P_1,0,0).$$

Now assume that the lemma holds for some $k < a$. Starting from $(a-k,P_k,0,0)$, apply Lemma 1, then apply Move 1 to the first stack:
$$(a-k,P_k,0,0) \rightarrow (a-k,0,2^{P_k},0) = (a-k,0,P_{k+1},0) \rightarrow (a-k-1,P_{k+1},0,0).$$

Therefore,
$$(a,0,0,0) \rightarrow (a-k,P_k,0,0) \rightarrow (a-k-1,P_{k+1},0,0). \quad \square$$

Now we prove the statement of the problem.

First apply Move 1 to stack 5, then apply Move 2 to stacks $S_4$, $S_3$, $S_2$ and $S_1$ in this order. Then apply Lemma 2 twice:
$$(1,1,1,1,1,1) \rightarrow (1,1,1,1,0,3) \rightarrow (1,1,1,0,3,0) \rightarrow (1,1,0,3,0,0) \rightarrow (1,0,3,0,0,0) \rightarrow (0,3,0,0,0,0)$$
$$\rightarrow (0,P_3,0,0,0,0) = (0,0,16,0,0,0) \rightarrow (0,0,P_{16},0,0,0).$$

We already have more than $A$ coins in stack $S_4$, since
\[
A \leq 2010^{2010^{2010}} < (2^{11})^{2010^{2010}} = 2^{11 \cdot 2010^{2010}} < 2^{2^{11 \cdot 2011}} = 2^{2^{21121}} < 2^{2^{15}} < P_{16}.
\]

To decrease the number of coins in stack $S_4$, apply Move 2 to this stack repeatedly until its size decreases to $A/4$. (In every step, we remove a coin from $S_4$ and exchange the empty stacks $S_5$ and $S_6$.)
\[
(0,0,0,P_{16},0,0) \rightarrow (0,0,0,P_{16}-1,0,0) \rightarrow (0,0,0,P_{16}-2,0,0) \rightarrow \cdots \rightarrow (0,0,0,A/4,0,0).
\]

Finally, apply Move 1 repeatedly to empty stacks $S_4$ and $S_5$:
\[
(0,0,0,A/4,0,0) \rightarrow \cdots \rightarrow (0,0,0,0,A/2,0) \rightarrow \cdots \rightarrow (0,0,0,0,0,A).
\]

So the answer is 'Yes'. There exists such a sequence of moves.",1,combinatorics
2010g1,"Let $ABC$ be an acute triangle with $D, E, F$ the feet of the altitudes lying on $BC, CA, AB$ respectively. One of the intersection points of the line $EF$ and the circumcircle is $P$. The lines $BP$ and $DF$ meet at point $Q$. Give the value of $\frac{AP}{AQ}$","The line $EF$ intersects the circumcircle at two points. Depending on the choice of $P$, there are two different cases to consider.

\textit{Case 1:} The point $P$ lies on the ray $EF$ (see Fig. 1). 

Let $\angle CAB = \alpha$, $\angle ABC = \beta$ and $\angle BCA = \gamma$. The quadrilaterals $BCEF$ and $CAFD$ are cyclic due to the right angles at $D$, $E$ and $F$. So,

\[
\angle BDF = 180^\circ - \angle FDC = \angle CAF = \alpha,
\]
\[
\angle AFE = 180^\circ - \angle EFB = \angle BCE = \gamma,
\]
\[
\angle DFB = 180^\circ - \angle AFD = \angle DCA = \gamma.
\]

Since $P$ lies on the arc $AB$ of the circumcircle, $\angle PBA < \angle BCA = \gamma$. Hence, we have

\[
\angle PBD + \angle BDF = \angle PBA + \angle ABD + \angle BDF < \gamma + \beta + \alpha = 180^\circ,
\]

and the point $Q$ must lie on the extensions of $BP$ and $DF$ beyond the points $P$ and $F$, respectively.

From the cyclic quadrilateral $APBC$ we get

\[
\angle QPA = 180^\circ - \angle APB = \angle BCA = \gamma = \angle DFB = \angle QFA.
\]

Hence, the quadrilateral $AQPF$ is cyclic. Then $\angle AQP = 180^\circ - \angle PFA = \angle AFE = \gamma$.

We obtained that $\angle AQP = \angle QPA = \gamma$, so the triangle $AQP$ is isosceles, $AP = AQ$.

\textit{Case 2:} The point $P$ lies on the ray $FE$ (see Fig. 2). In this case the point $Q$ lies inside the segment $FD$.

Similarly to the first case, we have

\[
\angle QPA = \angle BCA = \gamma = \angle DFB = 180^\circ - \angle AFQ.
\]

Hence, the quadrilateral $AFQP$ is cyclic.

Then $\angle AQP = \angle AFP = \angle AFE = \gamma = \angle QPA$. The triangle $AQP$ is isosceles again, $\angle AQP = \angle QPA$ and thus $AP = AQ$.
",1,geometry
2010g2,"Point $P$ lies inside triangle $ABC$. Lines $AP$, $BP$, $CP$ meet the circumcircle of $ABC$ again at points $K$, $L$, $M$, respectively. The tangent to the circumcircle at $C$ meets line $AB$ at $S$. Give the value of $\frac{SC}{SP}$ when $MK = ML$.
","We assume that $CA > CB$, so point $S$ lies on the ray $AB$.

From the similar triangles $\triangle PKM \sim \triangle PCA$ and $\triangle PLM \sim \triangle PCB$ we get $\dfrac{PM}{KM} = \dfrac{PA}{CA}$ and $\dfrac{LM}{PM} = \dfrac{CB}{PB}$. Multiplying these two equalities, we get
\[
\dfrac{LM}{KM} = \dfrac{CB}{CA} \cdot \dfrac{PA}{PB}.
\]
Hence, the relation $MK = ML$ is equivalent to $\dfrac{CB}{CA} = \dfrac{PB}{PA}$.

Denote by $E$ the foot of the bisector of angle $B$ in triangle $ABC$. Recall that the locus of points $X$ for which $\dfrac{XA}{XB} = \dfrac{CA}{CB}$ is the Apollonius circle $\Omega$ with the center $Q$ on the line $AB$, and this circle passes through $C$ and $E$. Hence, we have $MK = ML$ if and only if $P$ lies on $\Omega$, that is $QP = QC$.

Now we prove that $S = Q$, thus establishing the problem statement. We have $\angle CES = \angle CAE + \angle ACE = \angle BCS + \angle ECB = \angle ECS$, so $SC = SE$. Hence, the point $S$ lies on $AB$ as well as on the perpendicular bisector of $CE$ and therefore coincides with $Q$.

So the value of $\frac{SC}{SP}$ is \(1\) when $MK = ML$.",1,geometry
2010n1,"Find the least positive integer $n$ for which there exists a set $\{s_1, s_2, \ldots, s_n\}$ consisting of $n$ distinct positive integers such that
\[
\left(1 - \frac{1}{s_1} \right)\left(1 - \frac{1}{s_2} \right)\cdots\left(1 - \frac{1}{s_n} \right) = \frac{51}{2010}.
\]
","Suppose that for some $n$ there exist the desired numbers; we may assume that $s_1 < s_2 < \cdots < s_n$. Surely $s_1 > 1$ since otherwise $1 - \frac{1}{s_1} = 0$. So we have $2 \le s_1 \le s_2 - 1 \le \cdots \le s_n - (n - 1)$, hence $s_i \ge i + 1$ for each $i = 1, \ldots, n$. Therefore
\[
\frac{51}{2010} = \left(1 - \frac{1}{s_1} \right) \left(1 - \frac{1}{s_2} \right) \cdots \left(1 - \frac{1}{s_n} \right) \ge \left(1 - \frac{1}{2} \right)\left(1 - \frac{1}{3} \right)\cdots\left(1 - \frac{1}{n+1} \right) = \frac{1}{2} \cdot \frac{2}{3} \cdots \frac{n}{n+1} = \frac{1}{n+1},
\]
which implies
\[
n+1 \ge \frac{2010}{51} = \frac{670}{17} > 39,
\]
so $n \ge 39$.

Now we are left to show that $n = 39$ fits. Consider the set $\{2, 3, \ldots, 33, 35, 36, \ldots, 40, 67\}$ which contains exactly 39 numbers. We have
\[
\frac{1}{2} \cdot \frac{2}{3} \cdot \frac{32}{33} \cdot \frac{34}{35} \cdot \frac{39}{40} \cdot \frac{66}{67} = \frac{1}{33} \cdot \frac{34}{35} \cdot \frac{39}{40} \cdot \frac{66}{67} = \frac{17}{670} = \frac{51}{2010},
\]
hence for $n = 39$ there exists a desired example.
",39,number theory
2010n2,"Find all pairs $(m, n)$ of nonnegative integers for which
\[
m^2 + 2 \cdot 3^n = m(2^{n+1} - 1).
\]
Calculate the sum of the quantity \[ (m+n) \] over every such pair.","For fixed values of $n$, the equation (1) is a simple quadratic equation in $m$. For $n \leq 5$ the solutions are listed in the following table.
\[
\begin{array}{|c|c|c|c|}
\hline
\text{case} & \text{equation} & \text{discriminant} & \text{integer roots} \\
\hline
n = 0 & m^2 - m + 2 = 0 & -7 & \text{none} \\
n = 1 & m^2 - 3m + 6 = 0 & -15 & \text{none} \\
n = 2 & m^2 - 7m + 18 = 0 & -23 & \text{none} \\
n = 3 & m^2 - 15m + 54 = 0 & 9 & m = 6 \text{ and } m = 9 \\
n = 4 & m^2 - 31m + 162 = 0 & 313 & \text{none} \\
n = 5 & m^2 - 63m + 486 = 0 & 2025 = 45^2 & m = 9 \text{ and } m = 54 \\
\hline
\end{array}
\]

We prove that there is no solution for $n \geq 6$.

Suppose that $(m,n)$ satisfies (1) and $n \geq 6$. Since $m \mid 2 \cdot 3^n = m(2^{n+1} - 1) - m^2$, we have $m = 3^p$ with some $0 \leq p \leq n$ or $m = 2 \cdot 3^q$ with some $0 \leq q \leq n$.

In the first case, let $q = n - p$; then
\[
2^{n+1} - 1 = m + \frac{2 \cdot 3^n}{m} = 3^p + 2 \cdot 3^q.
\]

In the second case let $p = n - q$. Then
\[
2^{n+1} - 1 = m + \frac{2 \cdot 3^n}{m} = 2 \cdot 3^q + 3^p.
\]

Hence, in both cases we need to find the nonnegative integer solutions of
\[
3^p + 2 \cdot 3^q = 2^{n+1} - 1,\quad p + q = n. \tag{2}
\]

Next, we prove bounds for $p, q$. From (2) we get
\[
3^p < 2^{n+1} = 8 \cdot 2^{n-2} < \frac{2^{n+1}}{3} < 3^{\frac{2(n+1)}{3}}
\]
and
\[
2 \cdot 3^q < 2^{n+1} = 2 \cdot 8 \cdot 2^{n-3} < 2 \cdot 9^{\frac{n}{3}} = 2 \cdot 3^{2n/3} < 2 \cdot 3^{\frac{2(n+1)}{3}},
\]
so $p, q < \frac{2(n+1)}{3}$. Combining these inequalities with $p+q=n$, we obtain
\[
\frac{n-2}{3} < p, q < \frac{2(n+1)}{3}. \tag{3}
\]

Now let $h = \min(p,q)$. By (3) we have $h > \frac{n-2}{3}$; in particular, we have $h > 1$. On the left-hand side of (2), both terms are divisible by $3^h$, therefore $9 \mid 3^h \mid 2^{n+1} - 1$. It is easy check that $\operatorname{ord}_9(2) = 6$, so $9 \mid 2^{n+1} - 1$ if and only if $6 \mid n+1$. Therefore, $n + 1 = 6r$ for some positive integer $r$, and we can write
\[
2^{n+1} - 1 = 4^r - 1 = (4^r - 1)^2 + 3 \cdot 4^r = (4^r - 1)^2 + 3 \cdot 4^r
= (4^r - 1)^2 + 3 \cdot 4^r
= (4^r - 1)^2 + 3 \cdot 4^r
= (4^r - 1)^2 + 3 \cdot 4^r
= (4^r - 1)^2 + 3 \cdot 4^r = (4^r - 1)^2 + 3 \cdot 4^r
= (4^r - 1

So all the possible pairs are $(6,3)$, $(9,3)$, $(9,5)$, $(54,5)$. The sum is \(94\).",94,number theory
2010n3,"Find the smallest number $n$ such that there exist polynomials $f_1, f_2, \ldots, f_n$ with rational coefficients satisfying
\[
x^2 + 7 = f_1(x)^2 + f_2(x)^2 + \cdots + f_n(x)^2.
\]


","The equality $x^2 + 7 = x^2 + 2^2 + 1^2 + 1^2 + 1^2$ shows that $n \leq 5$. It remains to show that $x^2 + 7$ is not a sum of four (or less) squares of polynomials with rational coefficients.

Suppose by way of contradiction that $x^2 + 7 = f_1(x)^2 + f_2(x)^2 + f_3(x)^2 + f_4(x)^2$, where the coefficients of polynomials $f_1, f_2, f_3$ and $f_4$ are rational (some of these polynomials may be zero).

Clearly, the degrees of $f_1, f_2, f_3$ and $f_4$ are at most $1$. Thus $f_i(x) = a_i x + b_i$ for $i = 1, 2, 3, 4$ and some rationals $a_1, b_1, a_2, b_2, a_3, b_3, a_4, b_4$. It follows that $x^2 + 7 = \sum_{i=1}^4 (a_i x + b_i)^2$ and hence
\[
\sum_{i=1}^4 a_i^2 = 1, \qquad \sum_{i=1}^4 a_i b_i = 0, \qquad \sum_{i=1}^4 b_i^2 = 7. \tag{1}
\]

Let $p_i = a_i + b_i$ and $q_i = a_i - b_i$ for $i = 1, 2, 3, 4$. Then
\[
\sum_{i=1}^4 p_i^2 = \sum_{i=1}^4 a_i^2 + 2 \sum_{i=1}^4 a_i b_i + \sum_{i=1}^4 b_i^2 = 8,
\]
\[
\sum_{i=1}^4 q_i^2 = \sum_{i=1}^4 a_i^2 - 2 \sum_{i=1}^4 a_i b_i + \sum_{i=1}^4 b_i^2 = 8,
\]
and
\[
\sum_{i=1}^4 p_i q_i = \sum_{i=1}^4 a_i^2 - \sum_{i=1}^4 b_i^2 = -6,
\]
which means that there exist a solution in integers $x_1, y_1, x_2, y_2, x_3, y_3, x_4, y_4$ and $m > 0$ of the system of equations
\[
\text{(i)} \quad \sum_{i=1}^4 x_i^2 = 8m^2, \qquad \text{(ii)} \quad \sum_{i=1}^4 y_i^2 = 8m^2, \qquad \text{(iii)} \quad \sum_{i=1}^4 x_i y_i = -6m^2.
\]

We will show that such a solution does not exist.

Assume the contrary and consider a solution with minimal $m$. Note that if an integer $x$ is odd then $x^2 \equiv 1 \pmod{8}$. Otherwise ($i.e.$, if $x$ is even) we have $x^2 \equiv 0 \pmod{8}$ or $x^2 \equiv 4 \pmod{8}$. Hence, by (i), we get that $x_1, x_2, x_3$ and $x_4$ are even. Similarly, by (ii), we get that $y_1, y_2, y_3$ and $y_4$ are even. Thus the LHS of (iii) is divisible by $4$ and $m$ is also even. It follows that $\left( \frac{x_1}{2}, \frac{x_2}{2}, \frac{x_3}{2}, \frac{x_4}{2}, \frac{y_1}{2}, \frac{y_2}{2}, \frac{y_3}{2}, \frac{y_4}{2}, \frac{m}{2} \right)$ is a solution of the system of equations (i), (ii) and (iii), which contradicts the minimality of $m$.

The smallest $n$ is $5$.",5,number theory
2010n5,"Let $\mathbb{N}$ be the set of all positive integers. Find all functions $f : \mathbb{N} \to \mathbb{N}$ such that the number $(f(m) + n)(m + f(n))$ is a square for all $m, n \in \mathbb{N}$. If $f(1)=6$, give the value of $f(2010)$.
","First, it is clear that all functions of the form $f(n) = n + c$ with a constant nonnegative integer $c$ satisfy the problem conditions since $(f(m) + n)(f(n) + m) = (n + m + c)^2$ is a square.

We are left to prove that there are no other functions. We start with the following

\textbf{Lemma.} Suppose that $p \mid f(k) - f(\ell)$ for some prime $p$ and positive integers $k, \ell$. Then $p \mid k - \ell$.

\textit{Proof.} Suppose first that $p^2 \mid f(k) - f(\ell)$, so $f(\ell) = f(k) + p^2 a$ for some integer $a$. Take some positive integer $D > \max\{f(k), f(\ell)\}$ which is not divisible by $p$ and set $n = pD - f(k)$. Then the positive numbers $n + f(k) = pD$ and $n + f(\ell) = pD + (f(\ell) - f(k)) = p(D + pa)$ are both divisible by $p$ but not by $p^2$. Now, applying the problem conditions, we get that both the numbers $(f(k) + n)(f(n) + k)$ and $(f(\ell) + n)(f(n) + \ell)$ are squares divisible by $p$ (and thus by $p^2$); this means that the multipliers $f(n) + k$ and $f(n) + \ell$ are also divisible by $p$, therefore $p \mid (f(n) + k) - (f(n) + \ell) = k - \ell$ as well.

On the other hand, if $f(k) - f(\ell)$ is divisible by $p$ but not by $p^2$, then choose the same number $D$ and set $n = p^3 D - f(k)$. Then the positive numbers $f(k) + n = p^3 D$ and $f(\ell) + n = p^3 D + (f(\ell) - f(k))$ are respectively divisible by $p^3$ (but not by $p^4$) and by $p$ (but not $p^2)$. Hence in an analogous way we obtain that the numbers $f(n) + k$ and $f(n) + \ell$ are divisible by $p$, therefore $p \mid (f(n) + k) - (f(n) + \ell) = k - \ell$. \qed

We turn to the problem. First, suppose that $f(k) = f(\ell)$ for some $k, \ell \in \mathbb{N}$. Then by Lemma we have that $k - \ell$ is divisible by every prime number, so $k - \ell = 0$, or $k = \ell$. Therefore, the function $f$ is injective.

Next, consider the numbers $f(k)$ and $f(k+1)$. Since the number $(k+1) - k = 1$ has no prime divisors, by Lemma the same holds for $f(k+1) - f(k)$; thus $|f(k+1) - f(k)| = 1$.

Now, let $f(2) - f(1) = q$, $|q| = 1$. Then we prove by induction that $f(n) = f(1) + q(n - 1)$. The base for $n = 1,2$ holds by the definition of $q$. For the step, if $n \ge 3$ we have
\[
f(n) = f(n \pm 1) \pm q = f(1) + q(n - 1) \pm q.
\]
Since $f(n) \ne f(n - 2) = f(1) + q(n - 2)$, we get $f(n) = f(1) + qn$, as desired.

Finally, we have $f(n) = f(1) + q(n - 1)$. Then $q$ cannot be $-1$ since otherwise for $n \ge f(1) + 1$ we have $f(n) \le 0$ which is impossible. Hence $q = 1$ and $f(n) = (f(1) - 1) + n$ for each $n \in \mathbb{N}$, and $f(1) - 1 \ge 0$, as desired.

All functions of the form $f(n) = n + c$, where $c \in \mathbb{N} \cup \{0\}$. If $f(1)=6$, the value of $f(2010)$ is $2015$.",2015,number theory
2010n6,"The rows and columns of a $2^n \times 2^n$ table are numbered from $0$ to $2^n - 1$. The cells of the table have been colored with the following property being satisfied: for each $0 \le i,j \le 2^n - 1$, the $j$th cell in the $i$th row and the $(i+j)$th cell in the $j$th row have the same color. (The indices of the cells in a row are considered modulo $2^n$.)

What is the maximal possible number of colors when $n=13$.
","Throughout the solution we denote the cells of the table by coordinate pairs; $(i,j)$ refers to the $j$th cell in the $i$th row.

Consider the directed graph, whose vertices are the cells of the board, and the edges are the arrows $(i,j) \to (j,i+j)$ for all $0 \le i,j \le 2^n - 1$. From each vertex $(i,j)$, exactly one edge passes (to $(j,i+j \mod 2^n)$); conversely, to each cell $(j,k)$ exactly one edge is directed (from the cell $(k-j \mod 2^n,j)$). Hence, the graph splits into cycles.

Now, in any coloring considered, the vertices of each cycle should have the same color by the problem condition. On the other hand, if each cycle has its own color, the obtained coloring obviously satisfies the problem conditions. Thus, the maximal possible number of colors is the same as the number of cycles, and we have to prove that this number is $2^n$.

Next, consider any cycle $(i_1,j_1), (i_2,j_2), \ldots$; we will describe it in other terms. Define a sequence $(a_0,a_1,\ldots)$ by the relations $a_0 = i_1$, $a_1 = j_1$, $a_{n+1} = a_n + a_{n-1}$ for all $n \ge 1$ (we say that such a sequence is a \emph{Fibonacci-type sequence}). Then an obvious induction shows that $i_k = a_k \pmod{2^n}$, $j_k = a_k \pmod{2^n}$. Hence we need to investigate the behavior of Fibonacci-type sequences modulo $2^n$.

Denote by $F_0, F_1, \ldots$ the Fibonacci numbers defined by $F_0 = 0, F_1 = 1$, and $F_{n+2} = F_{n+1} + F_n$ for $n \ge 0$. We also set $F_{-1} = 1$ according to the recurrence relation.

For every positive integer $m$, denote by $\nu(m)$ the exponent of $2$ in the prime factorization of $m$, i.e. for which $2^{\nu(m)} \mid m$ but $2^{\nu(m)+1} \nmid m$.

\textbf{Lemma 1.} For every Fibonacci-type sequence $a_0,a_1,a_2,\ldots$, and every $k \ge 0$, we have $a_k = F_k a_0 + F_{k-1} a_1$.

\textit{Proof.} Apply induction on $k$. The base cases $k = 0,1$ are trivial. For the step, from the induction hypothesis we get
\[
a_{k+1} = a_k + a_{k-1} = (F_k a_0 + F_{k-1} a_1) + (F_{k-1} a_0 + F_{k-2} a_1) = F_{k+1} a_0 + F_k a_1. \quad \square
\]

\textbf{Lemma 2.} For every $m \ge 3$,
\begin{itemize}
\item[(a)] we have $\nu(F_{3 \cdot 2^{m-2}}) = m$;
\item[(b)] $d = 3 \cdot 2^{m-2}$ is the least positive index for which $2^m \mid F_d$;
\item[(c)] $F_{3 \cdot 2^{m-2} + 1} \equiv 1 + 2^{m-1} \pmod{2^m}$.
\end{itemize}

\textit{Proof.} Apply induction on $m$. In the base case $m = 3$ we have $F_{3 \cdot 2^{3-2}} = F_6 = 8$, so $\nu(F_{3 \cdot 2^{m-2}}) = \nu(8) = 3$, the preceding Fibonacci-numbers are not divisible by $8$, and indeed $F_7 = 13 \equiv 1 + 4 \pmod{8}$.

Now suppose that $m > 3$ and let $k = 3 \cdot 2^{m-3}$. By applying Lemma 1 to the Fibonacci-type sequence $F_k, F_{k+1}, \ldots$, we get
\[
F_{2k} = F_k \cdot F_k + F_{k+1} \cdot F_{k-1}, \quad
F_{2k+1} = F_k \cdot F_{k+1} + F_{k+1} \cdot F_k = 2F_k F_{k+1}.
\]
By the induction hypothesis, $\nu(F_k) = m-1$, and $F_{k+1}$ is odd. Therefore we get $\nu(F_{2k}) = 2(m-1) > (m-1) + 1 = \nu(2F_k F_{k+1})$, which implies $\nu(F_{2k}) = m$, establishing statement (a).

Moreover, since $F_{k+1} = 1 + 2^{m-2} + a 2^{m-1}$ for some integer $a$, we get
\[
F_{2k+1} = F_k^2 + F_{k+1}^2 = 0 + (1 + 2^{m-2} + a 2^{m-1})^2 \equiv 1 + 2^{m-1} \pmod{2^m},
\]
as desired in statement (c).

We are left to prove that $2^m \nmid F_\ell$ for $\ell < 2k$. Assume the contrary. Since $2^{m-1} \mid F_\ell$, from the induction hypothesis it follows that $\ell > k$. But then we have $F_\ell = F_{k-1} F_{\ell-k} + F_k F_{\ell-k+1}$, where the second summand is divisible by $2^{m-1}$ but the first one is not (since $F_k -1$ is odd and $\ell-k < k$). Hence the sum is not divisible even by $2^{m-1}$. A contradiction. $\quad \square$

Now, for every pair of integers $(a,b) \ne (0,0)$, let $\mu(a,b) = \min(\nu(a),\nu(b))$. By an obvious induction, for every Fibonacci-type sequence $A = (a_0,a_1,\ldots)$ we have $\mu(a_0,a_1) = \mu(a_k,a_{k+1})$ for all $k \ge 0$, we denote this common value by $\mu(A)$. Also denote by $p_n(A)$ the period of this sequence modulo $2^n$, that is, the least $p > 0$ such that $a_{k+p} \equiv a_k \pmod{2^n}$ for all $k \ge 0$.

\textbf{Lemma 3.} Let $A = (a_0,a_1,\ldots)$ be a Fibonacci-type sequence such that $\mu(A) = k < n$. Then $p_n(A) = 3 \cdot 2^{n-k-1}$.

\textit{Proof.} First, we note that the sequence $(a_0,a_1,\ldots)$ has period $p$ modulo $2^n$ if and only if the sequence $(a_0/2^k, a_1/2^k, \ldots)$ has period $p$ modulo $2^{n-k}$. Hence, passing to this sequence we can assume that $k = 0$.

We prove the statement by induction on $n$. It is easy to check that for $n = 1,2$ the claim is true; actually, each Fibonacci-type sequence $A$ with $\mu(A) = 0$ behaves as $0,1,1,0,1,1,\ldots$ modulo $2$, and as $0,1,1,2,3,1,0,1,1,2,3,1,\ldots$ modulo $4$ (all pairs of residues from which that $A$ is not zero is odd appear as pair of consecutive terms in a unique order).

Now suppose $n \ge 3$ and consider an arbitrary Fibonacci-type sequence $A = (a_0,a_1,\ldots)$ with $\mu(A) = 0$. Obviously we should have $p_n(A) \mid p_n(A)$, or, using the induction hypothesis, $s = 3 \cdot 2^{n-2} \mid p_n(A)$. Next, we may suppose that $a_0$ is even; hence $a_1$ is odd, and $a_0 = 2b_0$, $a_1 = 2b_1$ for some integers $b_0,b_1$.

Consider the Fibonacci-type sequence $B = (b_0,b_1,\ldots)$ starting with $(b_0,b_1)$. Since $a_k = 2b_k + F_k$, $a_1 = 2b_1 + F_1$, by an easy induction we get $a_k = 2b_k + F_k$ for all $k \ge 0$. By the induction hypothesis, we have $p_{n-1}(B) \mid s$, hence the sequence $(2b_0,2b_1,\ldots)$ is $s$-periodic modulo $2^n$. On the other hand, by Lemma 2 we have $F_{s+1} = 1 + 2^{n-1} \pmod{2^n}$, $F_s \equiv 0 \pmod{2^n}$,
\[
a_{s+1} = 2b_{s+1} + F_{s+1} \equiv 2b_1 + 1 + 2^{n-1} \ne 2b_1 + 1 = a_1 \pmod{2^n}, \\
a_{2s} = 2b_{2s} + F_s \equiv 2b_0 + 0 = a_0 \pmod{2^n}, \\
a_{2s+1} = 2b_{2s+1} + F_{2s+1} \equiv 2b_1 + 1 = a_1 \pmod{2^n}.
\]

The first line means that $A$ is not $s$-periodic, while the other two provide that $a_{2s} \equiv a_0$, $a_{2s+1} \equiv a_1$ and hence $a_{2s+t} \equiv a_t$ for all $t \ge 0$. Hence $s \mid p_n(A)$ and $p_n(A) = s$, as desired. $\quad \square$

Finally, Lemma 3 provides a straightforward method of counting the number of cycles. Actually, take any number $0 \le k \le n-1$ and consider all the cells $(i,j)$ with $\mu(i,j) = k$. The total number of such cells is $2^{(n-k)} \cdot 2^{n-k} = 3 \cdot 2^{2n-2k-2}$. On the other hand, they are split into cycles, and by Lemma 3 the length of each cycle is $3 \cdot 2^{n-1-k}$. Hence the number of cycles consisting of these cells is exactly
\[
\frac{3 \cdot 2^{2n-2k-2}}{3 \cdot 2^{n-1-k}} = 2^{n-k-1}.
\]
Finally, there is only one cell $(0,0)$, which is not mentioned in the previous computation, and it forms a separate cycle. So the total number of cycles is
\[
1 + \sum_{k=0}^{n-1} 2^{n-1-k} = 1 + (1 + 2 + 4 + \ldots + 2^{n-1}) = 2^n.
\]
So the maximal possible number of colors is $8192$ when $n=13$.",8192,number theory
2009a1,"Find the largest possible integer $k$, such that the following statement is true:

Let $2009$ arbitrary non-degenerated triangles be given. In every triangle the three sides are colored, such that one is blue, one is red and one is white. Now, for every color separately, let us sort the lengths of the sides. We obtain
\[
\begin{aligned}
&b_1 \leq b_2 \leq \ldots \leq b_{2009} && \text{the lengths of the blue sides,} \\
&r_1 \leq r_2 \leq \ldots \leq r_{2009} && \text{the lengths of the red sides,} \\
&\text{and} \\
&w_1 \leq w_2 \leq \ldots \leq w_{2009} && \text{the lengths of the white sides.}
\end{aligned}
\]

Then there exist $k$ indices $j$ such that we can form a non-degenerated triangle with side lengths $b_j, r_j, w_j$.
","\textbf{Solution.} We will prove that the largest possible number $k$ of indices satisfying the given condition is one.

Firstly we prove that $b_{2009}, r_{2009}, w_{2009}$ are always lengths of the sides of a triangle. Without loss of generality we may assume that $w_{2009} \ge r_{2009} \ge b_{2009}$. We show that the inequality $b_{2009} + r_{2009} > w_{2009}$ holds. Evidently, there exists a triangle with side lengths $w, b, r$ for the white, blue and red side, respectively, such that $w_{2009} = w$. By the conditions of the problem we have $b + r > w$, $b_{2009} \ge b$ and $r_{2009} \ge r$. From these inequalities it follows
\[
b_{2009} + r_{2009} \ge b + r > w = w_{2009}.
\]

Secondly we will describe a sequence of triangles for which $w_j, b_j, r_j$ with $j < 2009$ are not the lengths of the sides of a triangle. Let us define the sequence $\Delta_j$, $j = 1, 2, \ldots, 2009$, of triangles, where $\Delta_j$ has
\begin{itemize}
  \item a blue side of length $2j$,
  \item a red side of length $j$ for all $j \le 2008$ and $4018$ for $j = 2009$,
  \item and a white side of length $j + 1$ for all $j \le 2007$, $4018$ for $j = 2008$ and $1$ for $j = 2009$.
\end{itemize}

Since
\[
\begin{array}{ll}
(j + 1) + j > 2j \quad \ge j + 1 > j, & \text{if } j \le 2007, \\
2j + j > 4018 > 2j > j, & \text{if } j = 2008, \\
4018 + 1 > 2j \quad = 4018 > 1, & \text{if } j = 2009,
\end{array}
\]
such a sequence of triangles exists. Moreover, $w_j = j$, $r_j = j$ and $b_j = 2j$ for $1 \le j \le 2008$. Then
\[
w_j + r_j = j + j = 2j = b_j,
\]
i.e., $b_j, r_j$ and $w_j$ are not the lengths of the sides of a triangle for $1 \le j \le 2008$.

So the largest possible number k of indices satisfying the given condition is $1$.",1,algebra
2009a3,"Determine all functions $f$ from the set of positive integers into the set of positive integers such that for all $x$ and $y$ there exists a non degenerated triangle with sides of lengths
\[
x, \quad f(y) \quad \text{and} \quad f(y + f(x) - 1).
\]
Give the value of $f(2009)$.","The identity function $f(x) = x$ is the only solution of the problem.

If $f(x) = x$ for all positive integers $x$, the given three lengths are $x$, $y = f(y)$ and $z = f\left( y + f(x) - 1 \right) = x + y - 1$. Because of $x \geq 1$, $y \geq 1$ we have $z \geq \max\{x,y\} > |x - y|$ and $z < x + y$. From this it follows that a triangle with these side lengths exists and does not degenerate. We prove in several steps that there is no other solution.

\textit{Step 1.} We show $f(1) = 1$.\\
If we had $f(1) = 1 + m > 1$ we would conclude $f(y) = f(y + m)$ for all $y$ considering the triangle with the side lengths $1$, $f(y)$ and $f(y + m)$. Thus, $f$ would be $m$-periodic and, consequently, bounded. Let $B$ be a bound, $f(x) \leq B$. If we choose $x > 2B$ we obtain the contradiction 
\[
x > 2B \geq f(y) + f(y + f(x) - 1).
\]

\textit{Step 2.} For all positive integers $z$, we have $f(f(z)) = z$.\\
Setting $x = z$ and $y = 1$ this follows immediately from Step 1.

\textit{Step 3.} For all integers $z \geq 1$, we have $f(z) \leq z$.\\
Let us show, that the contrary leads to a contradiction. Assume $w + 1 = f(z) > z$ for some $z$. From Step 1 we know that $w \geq z \geq 2$. Let $M = \max\{f(1), f(2), \dots, f(w)\}$ be the largest value of $f$ for the first $w$ integers. First we show, that no positive integer $t$ exists with
\begin{equation}
f(t) > \frac{z - 1}{w} \cdot t + M,
\end{equation}
otherwise we decompose the smallest value $t$ as $t = wr + s$ where $r$ is an integer and $1 \leq s \leq w$. Because of the definition of $M$, we have $t > w$. Setting $x = z$ and $y = t - w$ we get from the triangle inequality
\[
z + f(t - w) > f((t - w) + f(z) - 1) = f(t - w + w) = f(t).
\]
Hence,
\[
f(t - w) \geq f(t) - (z - 1) > \frac{z - 1}{w} (t - w) + M,
\]
a contradiction to the minimality of $t$.\\
Therefore the inequality (1) fails for all $t \geq 1$, we have proven
\begin{equation}
f(t) \leq \frac{z - 1}{w} \cdot t + M,
\end{equation}
instead.

Now, using (2), we finish the proof of Step 3. Because of $z \leq w$ we have $\frac{z - 1}{w} < 1$ and we can choose an integer $t$ sufficiently large to fulfill the condition
\[
\left(\frac{z - 1}{w}\right)^2 t + \left(\frac{z - 1}{w} + 1 \right) M < t.
\]
Applying (2) twice we get
\[
f(f(t)) \leq \frac{z - 1}{w} f(t) + M \leq \frac{z - 1}{w} \left(\frac{z - 1}{w} t + M\right) + M < t
\]
in contradiction to Step 2, which proves Step 3.

\textit{Final step.} Thus, following Step 2 and Step 3, we obtain
\[
z = f(f(z)) \leq f(z) \leq z
\]
and $f(z) = z$ for all positive integers $z$ is proven.

So the value of $f(2009)$ is $2009$.",2009,algebra
2009a7,"Find all functions $f$ from the set of real numbers into the set of real numbers which satisfy for all real $x, y$ the identity
\[
f(xf(x + y)) = f(yf(x)) + x^2.
\]
If $f(1)=1$, give the value of $f(2009)$.","It is not hard to see that the two functions given by $f(x) = x$ and $f(x) = -x$ for all real $x$ respectively solve the functional equation. In the sequel, we prove that there are no further solutions.

Let $f$ be a function satisfying the given equation. It is clear that $f$ cannot be a constant. Let us first show that $f(0) = 0$. Suppose that $f(0) \neq 0$. For any real $t$, substituting $(x, y) = (0, \frac{t}{f(0)})$ into the given functional equation, we obtain
\[
f(0) = f(t),
\]
contradicting the fact that $f$ is not a constant function. Therefore, $f(0) = 0$. Next for any $t$, substituting $(x, y) = (t, 0)$ and $(x, y) = (t, -t)$ into the given equation, we get
\[
f(tf(t)) = f(0) + t^2 = t^2,
\]
and
\[
f(tf(0)) = f(-tf(t)) + t^2,
\]
respectively. Therefore, we conclude that
\[
f(tf(t)) = t^2, \qquad f(-tf(t)) = -t^2, \quad \text{for every real } t. \tag{2}
\]

Consequently, for every real $v$, there exists a real $u$, such that $f(u) = v$. We also see that if $f(t) = 0$, then $0 = f(tf(t)) = t^2$ so that $t = 0$, and thus $0$ is the only real number satisfying $f(t) = 0$.

We next show that for any real number $s$,
\[
f(-s) = -f(s). \tag{3}
\]

This is clear if $f(s) = 0$. Suppose now $f(s) < 0$, then we can find a number $t$ for which $f(s) = -t^2$. As $t \neq 0$ implies $f(t) \neq 0$, we can also find number $a$ such that $af(t) = s$. Substituting $(x, y) = (t, a)$ into the given equation, we get
\[
f(tf(t + a)) = f(af(t)) + t^2 = f(s) + t^2 = 0,
\]
and therefore, $tf(t + a) = 0$, which implies $t + a = 0$, and hence $s = -tf(t)$. Consequently, $f(-s) = f(tf(t)) = t^2 = -(-t^2) = -f(s)$ holds in this case.

Finally, suppose $f(s) > 0$ holds. Then there exists a real number $t \neq 0$ for which $f(s) = t^2$. Choose a number $a$ such that $f(a) = s$. Substituting $(x, y) = (t, a - t)$ into the given equation, we get $f(tf(a)) = f((a - t)f(t)) + t^2 = f((a - t)f(t)) + f(s)$. So we have $f((a - t)f(t)) = 0$, which we conclude that $(a - t)f(t) = 0$. Since $f(t) \neq 0$, we get $a = t$. So $f(t) = s$, and thus we see $f(-s) = -f(tf(t)) = -t^2 = -f(s)$ holds in this case also. This observation shows the proof of (3), so $f(-x) = -f(x)$ holds in all cases.

By substituting $(x, y) = (s, t)$, $(x, y) = (t, -s - t)$ and $(x, y) = (-s, -t)$ into the given equation, we obtain
\[
f(sf(s + t)) = f(tf(s)) + s^2,
\]
\[
f(tf(-s)) = f((-s - t)f(t)) + t^2,
\]
and
\[
f((-s - t)f(-t)) = f(sf(-s - t)) + (s + t)^2,
\]
respectively. Using the fact that $f(-x) = -f(x)$ holds for all $x$ to rewrite the second and the third equation, and rearranging the terms, we obtain
\[
f(tf(s)) - f(sf(s + t)) = -s^2,
\]
\[
f(tf(s)) - f((s + t)f(t)) = -t^2,
\]
\[
f((s + t)f(t)) + f(sf(s + t)) = (s + t)^2.
\]

Adding up these three equations now yields $2f(tf(s)) = 2ts$, and therefore, we conclude that $f(tf(s)) = ts$ holds for every pair of real numbers $s, t$. By fixing $s$ so that $f(s) = 1$, we obtain $f(x) = sx$. In view of the given equation, we see that $s = \pm 1$. It is easy to check that both functions $f(x) = x$ and $f(x) = -x$ satisfy the given functional equation, so these are the desired solutions.
If $f(1)=1$, the value of $f(2009)$ is $2009$.",2009,algebra
2009c2,"For any integer $n \geq 2$, let $N(n)$ be the maximal number of triples $(a_i, b_i, c_i)$, $i = 1, \ldots, N(n)$, consisting of nonnegative integers $a_i, b_i$ and $c_i$ such that the following two conditions are satisfied:
\begin{itemize}
    \item[(1)] $a_i + b_i + c_i = n$ for all $i = 1, \ldots, N(n)$,
    \item[(2)] If $i \ne j$, then $a_i \ne a_j$, $b_i \ne b_j$ and $c_i \ne c_j$.
\end{itemize}
Determine $N(n)$ for all $n \geq 2$. Give the value of $N(2009)$.
","Let $n \geq 2$ be an integer and let $\{T_1, \ldots, T_N\}$ be any set of triples of nonnegative integers satisfying the conditions (1) and (2). Since the $a$-coordinates are pairwise distinct we have
\[
\sum_{i=1}^{N} a_i \geq \sum_{i=1}^{N} (i-1) = \frac{N(N-1)}{2}.
\]
Analogously,
\[
\sum_{i=1}^{N} b_i \geq \frac{N(N-1)}{2} \quad \text{and} \quad \sum_{i=1}^{N} c_i \geq \frac{N(N-1)}{2}.
\]
Summing these three inequalities and applying (1) yields
\[
3\cdot \frac{N(N-1)}{2} \leq \sum_{i=1}^{N} a_i + \sum_{i=1}^{N} b_i + \sum_{i=1}^{N} c_i = \sum_{i=1}^{N}(a_i + b_i + c_i) = nN,
\]
hence $\frac{3N(N-1)}{2} \leq nN$ and, consequently,
\[
N \leq \left\lfloor \frac{2n}{3} \right\rfloor + 1.
\]

By constructing examples, we show that this upper bound can be attained, so $N(n) = \left\lfloor \frac{2n}{3} \right\rfloor + 1$.

We distinguish the cases $n = 3k - 1$, $n = 3k$ and $n = 3k + 1$ for $k \geq 1$ and present the extremal examples in form of a table.

\[
\begin{array}{|c|c|c|}
\multicolumn{3}{c}{n = 3k - 1 \quad \left\lfloor \frac{2n}{3} \right\rfloor + 1 = 2k} \\
\hline
a_i & b_i & c_i \\
\hline
0 & k + 1 & 2k - 2 \\
1 & k + 2 & 2k - 4 \\
\vdots & \vdots & \vdots \\
k - 1 & 1 & 2k - 1 \\
k + 1 & 0 & 2k - 3 \\
\vdots & \vdots & \vdots \\
2k - 1 & k - 1 & 1 \\
\hline
\end{array}
\quad
\begin{array}{|c|c|c|}
\multicolumn{3}{c}{n = 3k \quad \left\lfloor \frac{2n}{3} \right\rfloor + 1 = 2k + 1} \\
\hline
a_i & b_i & c_i \\
\hline
0 & k + 1 & 2k - 1 \\
1 & k + 2 & 2k - 3 \\
\vdots & \vdots & \vdots \\
k & 0 & 2k \\
k + 1 & 1 & 2k - 2 \\
\vdots & \vdots & \vdots \\
2k & k - 1 & 1 \\
\hline
\end{array}
\quad
\begin{array}{|c|c|c|}
\multicolumn{3}{c}{n = 3k + 1 \quad \left\lfloor \frac{2n}{3} \right\rfloor + 1 = 2k + 1} \\
\hline
a_i & b_i & c_i \\
\hline
0 & k + 1 & 2k \\
1 & k + 2 & 2k - 2 \\
\vdots & \vdots & \vdots \\
k & 0 & 2k + 1 \\
k + 1 & 1 & 2k - 1 \\
\vdots & \vdots & \vdots \\
2k & k - 1 & 2 \\
\hline
\end{array}
\]

It can be easily seen that the conditions (1) and (2) are satisfied and that we indeed have $\left\lfloor \frac{2n}{3} \right\rfloor + 1$ triples in each case. When \(n=2009\), the answer is \(1340\).
",1340,combinatorics
2009c3,"Let $n$ be a positive integer. Given a sequence $\varepsilon_1, \ldots, \varepsilon_{n-1}$ with $\varepsilon_i = 0$ or $\varepsilon_i = 1$ for each $i = 1, \ldots, n - 1$, the sequences $a_0, \ldots, a_n$ and $b_0, \ldots, b_n$ are constructed by the following rules:
\[
a_0 = b_0 = 1, \quad a_1 = b_1 = 7,
\]
\[
a_{i+1} = 
\begin{cases}
2a_{i-1} + 3a_i, & \text{if } \varepsilon_i = 0, \\
3a_{i-1} + a_i, & \text{if } \varepsilon_i = 1,
\end{cases}
\quad \text{for each } i = 1, \ldots, n-1,
\]
\[
b_{i+1} = 
\begin{cases}
2b_{i-1} + 3b_i, & \text{if } \varepsilon_{n-i} = 0, \\
3b_{i-1} + b_i, & \text{if } \varepsilon_{n-i} = 1,
\end{cases}
\quad \text{for each } i = 1, \ldots, n-1.
\]

Give the value of $\frac{a_{2009}}{b_{2009}}.
","For a binary word $w = \sigma_1 \ldots \sigma_n$ of length $n$ and a letter $\sigma \in \{0,1\}$ let $w\sigma = \sigma_1 \ldots \sigma_n\sigma$ and $\sigma w = \sigma\sigma_1 \ldots \sigma_n$. Moreover let $\overline{w} = \sigma_n \ldots \sigma_1$ and let $\emptyset$ be the empty word (of length $0$ and $\overline{\emptyset} = \emptyset$). Let $(u,v)$ be a pair of two real numbers. For binary words $w$ we define recursively the numbers $(u,v)^w$ as follows:
\[
(u,v)^{\emptyset} = v, \quad (u,v)^0 = 2u + 3v, \quad (u,v)^1 = 3u + v,
\]
\[
(u,v)^{w\sigma\varepsilon} =
\begin{cases}
2(u,v)^w + 3(u,v)^{w\sigma}, & \text{if } \varepsilon = 0, \\
3(u,v)^w + (u,v)^{w\sigma}, & \text{if } \varepsilon = 1.
\end{cases}
\]
It easily follows by induction on the length of $w$ that for all real numbers $u_1, v_1, u_2, v_2, \lambda_1$ and $\lambda_2$
\[
(\lambda_1 u_1 + \lambda_2 u_2, \lambda_1 v_1 + \lambda_2 v_2)^w = \lambda_1 (u_1, v_1)^w + \lambda_2 (u_2, v_2)^w \tag{1}
\]
and that for $\varepsilon \in \{0,1\}$
\[
(u,v)^{\varepsilon w} = (v, (u,v)^\varepsilon)^w. \tag{2}
\]
Obviously, for $n \geq 1$ and $w = \varepsilon_1 \ldots \varepsilon_{n-1}$, we have $a_n = (1,7)^w$ and $b_n = (1,7)^{\overline{w}}$. Thus it is sufficient to prove that
\[
(1,7)^w = (1,7)^{\overline{w}} \tag{3}
\]
for each binary word $w$. We proceed by induction on the length of $w$. The assertion is obvious if $w$ has length $0$ or $1$. Now let $w\sigma\varepsilon$ be a binary word of length $n \geq 2$ and suppose that the assertion is true for all binary words of length at most $n - 1$.

Note that $(2,1)^\sigma = 7 = (1,7)^0$ for $\sigma \in \{0,1\}$, $(1,7)^0 = 23$, and $(1,7)^1 = 10$.

First let $\varepsilon = 0$. Then in view of the induction hypothesis and the equalities (1) and (2), we obtain
\[
\begin{aligned}
(1,7)^{w\sigma 0} &= 2(1,7)^w + 3(1,7)^{w\sigma} = 2(1,7)^{\overline{w}} + 3(1,7)^{\sigma \overline{w}} \\
&= 2(2,1)^{\overline{w}} + 3(1,7)^{\sigma \overline{w}} = (7,23)^{\sigma \overline{w}} = (1,7)^{1\sigma \overline{w}}.
\end{aligned}
\]

Now let $\varepsilon = 1$. Analogously, we obtain
\[
(1,7)^{w\sigma 1} = 3(1,7)^w + (1,7)^{w\sigma} = 3(1,7)^{\overline{w}} + (1,7)^{\sigma \overline{w}} = 3(2,1)^{\overline{w}} + (1,7)^{\sigma \overline{w}} = (7,10)^{\sigma \overline{w}} = (1,7)^{1\sigma \overline{w}}.
\]

Thus the induction step is complete, (3) and hence also $a_n = b_n$ are proved. So the value of $\frac{a_{2009}}{b_{2009}} is $1$.",1,combinatorics
2009c5,"Five identical empty buckets of $2$-liter capacity stand at the vertices of a regular pentagon. Cinderella and her wicked Stepmother go through a sequence of rounds: At the beginning of every round, the Stepmother takes one liter of water from the nearby river and distributes it arbitrarily over the five buckets. Then Cinderella chooses a pair of neighboring buckets, empties them into the river, and puts them back. Then the next round begins. The Stepmother’s goal is to make one of these buckets overflow. Cinderella’s goal is to prevent this. Can the wicked Stepmother enforce a bucket overflow? If the answer is 'Yes', give the value \(1\). Else give \(0\).
","No, the Stepmother cannot enforce a bucket overflow and Cinderella can keep playing forever. Throughout we denote the five buckets by $B_0, B_1, B_2, B_3,$ and $B_4$, where $B_k$ is adjacent to bucket $B_{k-1}$ and $B_{k+1}$ ($k = 0,1,2,3,4$) and all indices are taken modulo $5$. Cinderella enforces that the following three conditions are satisfied at the beginning of every round:
\begin{itemize}
    \item[(1)] Two adjacent buckets (say $B_1$ and $B_2$) are empty.
    \item[(2)] The two buckets standing next to these adjacent buckets (here $B_0$ and $B_3$) have total contents at most $1$.
    \item[(3)] The remaining bucket (here $B_4$) has contents at most $1$.
\end{itemize}

These conditions clearly hold at the beginning of the first round, when all buckets are empty.

Assume that Cinderella manages to maintain them until the beginning of the $r$-th round ($r \ge 1$). Denote by $x_k$ ($k = 0,1,2,3,4$) the contents of bucket $B_k$ at the beginning of this round and by $y_k$ the corresponding contents after the Stepmother has distributed her liter of water in this round.

By the conditions, we can assume $x_1 = x_2 = 0$, $x_0 + x_3 \le 1$ and $x_4 \le 1$. Then, since the Stepmother adds one liter, we conclude $y_0 + y_1 + y_2 + y_3 \le 2$. This inequality implies $y_0 + y_2 \le 1$ or $y_1 + y_3 \le 1$. For reasons of symmetry, we only consider the second case.

Then Cinderella empties buckets $B_0$ and $B_4$.

At the beginning of the next round $B_0$ and $B_4$ are empty (condition (1) is fulfilled), due to $y_1 + y_3 \le 1$ condition (2) is fulfilled and finally since $x_2 = 0$ we also must have $y_2 \le 1$ (condition (3) is fulfilled).

Therefore, Cinderella can indeed manage to maintain the three conditions (1)--(3) also at the beginning of the $(r+1)$-th round. By induction, she thus manages to maintain them at the beginning of every round. In particular she manages to keep the contents of every single bucket at most 1 liter. Therefore, the buckets of 2-liter capacity will never overflow. And the answer is $0$.
",0,combinatorics
2009c6,"On a $999 \times 999$ board a \emph{limp rook} can move in the following way: From any square it can move to any of its adjacent squares, i.e. a square having a common side with it, and every move must be a turn, i.e. the directions of any two consecutive moves must be perpendicular. A \emph{non-intersecting route} of the limp rook consists of a sequence of pairwise different squares that the limp rook can visit in that order by an admissible sequence of moves. Such a non-intersecting route is called \emph{cyclic}, if the limp rook can, after reaching the last square of the route, move directly to the first square of the route and start over.

How many squares does the longest possible cyclic, non-intersecting route of a limp rook visit?
","First we show that this number is an upper bound for the number of cells a limp rook can visit. To do this we color the cells with four colors $A$, $B$, $C$ and $D$ in the following way: for $(i,j) \equiv (0,0) \pmod{2}$ use $A$, for $(i,j) \equiv (0,1) \pmod{2}$ use $B$, for $(i,j) \equiv (1,0) \pmod{2}$ use $C$ and for $(i,j) \equiv (1,1) \pmod{2}$ use $D$. From an $A$-cell the rook has to move to a $B$-cell or a $C$-cell. In the first case, the order of the colors of the cells visited is given by $A, B, D, C, A, B, D, C, A, \dots$, in the second case it is $A, C, D, B, A, C, D, B, A, \dots$. Since the route is closed it must contain the same number of cells of each color. There are only $499^2$ $A$-cells. In the following we will show that the rook cannot visit all the $A$-cells on its route and hence the maximum possible number of cells in a route is $4 \cdot (499^2 - 1)$.

Assume that the route passes through every single $A$-cell. Color the $A$-cells in black and white in a chessboard manner, i.e. color any two $A$-cells at distance $2$ in different color. Since the number of $A$-cells is odd the rook cannot always alternate between visiting black and white $A$-cells along its route. Hence there are two $A$-cells of the same color which are four rook-steps apart that are visited directly one after the other. Let these two $A$-cells have row and column numbers $(a,b)$ and $(a+2,b+2)$ respectively.

There is up to reflection only one way the rook can take from $(a,b)$ to $(a+2,b+2)$. Let this way be $(a,b) \rightarrow (a,b+1) \rightarrow (a+1,b+1) \rightarrow (a+1,b+2) \rightarrow (a+2,b+2)$. Also let without loss of generality the color of the cell $(a,b+1)$ be $B$ (otherwise change the roles of columns and rows).

Now consider the $A$-cell $(a,b+2)$. The only way the rook can pass through it is via $(a-1,b+2) \rightarrow (a,b+2) \rightarrow (a,b+3)$ in this order, since according to our assumption after every $A$-cell the rook passes through a $B$-cell. Hence, to connect these two parts of the path, there must be a path connecting the cell $(a,b+3)$ and $(a,b)$ and also a path connecting $(a+2,b+2)$ and $(a-1,b+2)$.

But these four cells are opposite vertices of a convex quadrilateral and the paths are outside of that quadrilateral and hence they must intersect. This is due to the following fact:

The path from $(a,b)$ to $(a,b+3)$ together with the line segment joining these two cells form a closed loop that has one of the cells $(a-1,b+2)$ and $(a+2,b+2)$ in its inside and the other one on the outside. Thus the path between these two points must cross the previous path.

But an intersection is only possible if a cell is visited twice. This is a contradiction.

Hence the number of cells visited is at most $4 \cdot (499^2 - 1)$.

The following picture indicates a recursive construction for all $n \times n$-chessboards with $n \equiv 3 \pmod{4}$ which clearly yields a path that misses exactly one $A$-cell (marked with a dot, the center cell of the $15 \times 15$-chessboard) and hence, in the case of $n = 999$ crosses exactly $4 \cdot (499^2 - 1)$ cells.
The answer is $998^2 - 4 = 4 \cdot (499^2 - 1)=996004$ squares.
",996004,combinatorics
2009g1,"Let $ABC$ be a triangle with $AB = AC$. The angle bisectors of $A$ and $B$ meet the sides $BC$ and $AC$ in $D$ and $E$, respectively. Let $K$ be the incenter of triangle $ADC$. Suppose that $\angle BEK = 45^\circ$. Find all possible values of $\angle BAC$. Give the minimum possible value of $\angle BAC$ (in degrees).
","Let $I$ be the incenter of triangle $ABC$, then $K$ lies on the line $CI$. Let $F$ be the point, where the incircle of triangle $ABC$ touches the side $AC$; then the segments $IF$ and $ID$ have the same length and are perpendicular to $AC$ and $BC$, respectively.

Let $P, Q$ and $R$ be the points where the incircle of triangle $ADC$ touches the sides $AD$, $DC$ and $CA$, respectively. Since $K$ and $I$ lie on the angle bisector of $\angle ACD$, the segments $ID$ and $IF$ are symmetric with respect to the line $IC$. Hence there is a point $S$ on $IF$ where the incircle of triangle $ADC$ touches the segment $IF$. Then segments $KP$, $KQ$, $KR$ and $KS$ all have the same length and are perpendicular to $AD$, $DC$, $CA$ and $IF$, respectively. So -- regardless of the value of $\angle BEK$ -- the quadrilateral $KRFS$ is a square and $\angle SFK = \angle KFC = 45^\circ$.

Consider the case $\angle BAC = 60^\circ$ (see Figure 1). Then triangle $ABC$ is equilateral. Furthermore we have $F = E$, hence $\angle BEK = \angle IFK = \angle SEK = 45^\circ$. So $60^\circ$ is a possible value for $\angle BAC$.

Now consider the case $\angle BAC = 90^\circ$ (see Figure 2). Then $\angle CBA = \angle ACB = 45^\circ$. Furthermore, 
\[
\angle KIE = \frac{1}{2} \angle CBA + \frac{1}{2} \angle ACB = 45^\circ, \quad \angle BEK = 180^\circ - 90^\circ - 22.5^\circ = 67.5^\circ
\]
and
\[
\angle EIA = \angle BID = 180^\circ - 90^\circ - 22.5^\circ = 67.5^\circ.
\]
Hence triangle $IEA$ is isosceles and a reflection of the bisector of $\angle IAE$ takes $I$ to $E$ and $K$ to itself. So triangle $IKE$ is symmetric with respect to this axis, i.e. 
\[
\angle KIE = \angle IEK = \angle BEK = \angle IFK = 45^\circ.
\]
So $90^\circ$ is a possible value for $\angle BAC$, too.

If, on the other hand, $\angle BEK = 45^\circ$ then $\angle BEK = \angle IEK = \angle IFK = 45^\circ$. Then
\begin{itemize}
    \item either $F = E$, which makes the angle bisector $BI$ be an altitude, i.e., which makes triangle $ABC$ isosceles with base $AC$ and hence equilateral and so $\angle BAC = 60^\circ$,
    \item or $E$ lies between $F$ and $C$, which makes the points $K, E, F$ and $I$ concyclic, so $45^\circ = \angle KFC = \angle KFE = \angle KIE = \angle CBI + \angle ICB = 2 \cdot \angle ICB = 90^\circ - \frac{1}{2} \angle BAC$, and so $\angle BAC = 90^\circ$,
\end{itemize}

or $F$ lies between $E$ and $C$, then again, $K, E, F$ and $I$ are concyclic, so $45^\circ = \angle KFC = 180^\circ - \angle KFE = \angle KIE$, which yields the same result $\angle BAC = 90^\circ$. (However, for $\angle BAC = 90^\circ$ $E$ lies, in fact, between $F$ and $C$, see Figure 2. So this case does not occur.)

This proves $90^\circ$ and $60^\circ$ to be the only possible values for $\angle BAC$.
$\angle BAC = 60^\circ$ or $\angle BAC = 90^\circ$ are possible values and the only possible values. So the minimum value is $\angle BAC = 60^\circ$.",60,geometry
2009g2,"Let $ABC$ be a triangle with circumcenter $O$. The points $P$ and $Q$ are interior points of the sides $CA$ and $AB$, respectively. The circle $k$ passes through the midpoints of the segments $BP$, $CQ$, and $PQ$. Give the value of $\frac{OP}{OQ}$ if the line $PQ$ is tangent to circle $k$.
","Let $K, L, M, B', C'$ be the midpoints of $BP$, $CQ$, $PQ$, $CA$, and $AB$, respectively (see Figure 1). Since $CA \parallel LM$, we have $\angle LMP = \angle QPA$. Since $k$ touches the segment $PQ$ at $M$, we find $\angle LMP = \angle LKM$. Thus $\angle QPA = \angle LKM$. Similarly it follows from $AB \parallel MK$ that $\angle PQA = \angle KLM$. Therefore, triangles $APQ$ and $MKL$ are similar, hence
\[
\frac{AP}{AQ} = \frac{MK}{ML} = \frac{\frac{QB}{2}}{\frac{PC}{2}} = \frac{QB}{PC}. \tag{1}
\]
Now (1) is equivalent to $AP \cdot PC = AQ \cdot QB$ which means that the power of points $P$ and $Q$ with respect to the circumcircle of $\triangle ABC$ are equal, hence $OP = OQ$.
So the value of $\frac{OP}{OQ}$ is $1$ if the line $PQ$ is tangent to circle $k$.",1,geometry
2009g3,"Let $ABC$ be a triangle. The incircle of $ABC$ touches the sides $AB$ and $AC$ at the points $Z$ and $Y$, respectively. Let $G$ be the point where the lines $BY$ and $CZ$ meet, and let $R$ and $S$ be points such that the two quadrilaterals $BCYR$ and $BCSZ$ are parallelograms.

Give the value of $\frac{GR}{GS}$.","Denote by $k$ the incircle and by $k_a$ the excircle opposite to $A$ of triangle $ABC$. Let $k$ and $k_a$ touch the side $BC$ at the points $X$ and $T$, respectively, let $k_a$ touch the lines $AB$ and $AC$ at the points $P$ and $Q$, respectively. We use several times the fact that opposing sides of a parallelogram are of equal length, that points of contact of the excircle and incircle to a side of a triangle lie symmetric with respect to the midpoint of this side and that segments on two tangents to a circle defined by the points of contact and their point of intersection have the same length. So we conclude

\[
ZP = ZB + BP = XB + BT = BX + CX = ZS \quad \text{and} \quad CQ = CT = BX = BZ = CS.
\]

So for each of the points $Z, C$, their distances to $S$ equal the length of a tangent segment from this point to $k_a$. It is well-known, that all points with this property lie on the line $ZC$, which is the radical axis of $S$ and $k_a$. Similar arguments yield that $BY$ is the radical axis of $R$ and $k_a$. So the point of intersection of $ZC$ and $BY$, which is $G$ by definition, is the radical center of $R$, $S$ and $k_a$, from which the claim $GR = GS$ follows immediately.
So the value of $\frac{GR}{GS}$ is $1$.",1,geometry
2009n2,"A positive integer $N$ is called \textit{balanced}, if $N = 1$ or if $N$ can be written as a product of an even number of not necessarily distinct primes. Given positive integers $a$ and $b$, consider the polynomial $P$ defined by $P(x) = (x + a)(x + b)$.

If $P(n)$ is balanced for all positive integers $n$, give the value of $\frac{a}{b}$.

","\textbf{Solution.} Define a function $f$ on the set of positive integers by $f(n) = 0$ if $n$ is balanced and $f(n) = 1$ otherwise. Clearly, $f(nm) \equiv f(n) + f(m) \pmod{2}$ for all positive integers $n, m$.

Now suppose $P(n)$ is balanced for all positive integers $n$ and $a < b$. Set $n = k(b-a) - a$ for sufficiently large $k$, such that $n$ is positive. Then $P(n) = k(k+1)(b-a)^2$, and this number can only be balanced, if $f(k) = f(k+1)$ holds. Thus, the sequence $f(k)$ must become constant for sufficiently large $k$. But this is not possible, as for every prime $p$ we have $f(p) = 1$ and for every square $t^2$ we have $f(t^2) = 0$.

Hence $a = b$. The value of $\frac{a}{b}$ is $1$.

",1,number theory
2008a1,"\textbf{A1.} Find all functions $f : (0, \infty) \to (0, \infty)$ such that
\[
\frac{f(p)^2 + f(q)^2}{f(r)^2 + f(s)^2} = \frac{p^2 + q^2}{r^2 + s^2}
\]
for all $p, q, r, s > 0$ with $pq = rs$. If $f(1)=1$, give the value of $f(2008)$.","Let $f$ satisfy the given condition. Setting $p = q = r = s = 1$ yields $f(1)^2 = f(1)$ and hence $f(1) = 1$. Now take any $x > 0$ and set $p = x$, $q = 1$, $r = s = \sqrt{x}$ to obtain
\[
\frac{f(x)^2 + 1}{2f(x)} = \frac{x^2 + 1}{2x}.
\]
This recasts into
\[
xf(x)^2 + x = x^2 f(x) + f(x),
\]
\[
(xf(x) - 1)(f(x) - x) = 0.
\]
And thus, for every $x > 0$, either $f(x) = x$ or $f(x) = \frac{1}{x}$. \hfill (1)

Obviously, if
\[
f(x) = x \quad \text{for all } x > 0 \quad \text{or} \quad f(x) = \frac{1}{x} \quad \text{for all } x > 0
\]
then the condition of the problem is satisfied. We show that actually these two functions are the only solutions. \hfill (2)

So let us assume that there exists a function $f$ satisfying the requirement, other than those in (2). Then $f(a) \ne a$ and $f(b) \ne 1/b$ for some $a, b > 0$. By (1), these values must be $f(a) = 1/a$, $f(b) = b$. Applying now the equation with $p = a$, $q = b$, $r = s = \sqrt{ab}$ we obtain
\[
\frac{(a^{-2} + b^2)}{2f(ab)} = \frac{(a^2 + b^2)}{2ab}; \quad \text{equivalently,}
\]
\[
f(ab) = \frac{ab(a^{-2} + b^2)}{a^2 + b^2}. \hfill (3)
\]

We know however (see (1)) that $f(ab)$ must be either $ab$ or $1/ab$. If $f(ab) = ab$ then by (3) $a^{-2} + b^2 = a^2 + b^2$, so that $a = 1$. But, as $f(1) = 1$, this contradicts the relation $f(a) \ne a$. Likewise, if $f(ab) = 1/ab$ then (3) gives $a^2 b^2 (a^{-2} + b^2) = a^2 + b^2$, whence $b = 1$, in contradiction to $f(b) \ne 1/b$. Thus indeed the functions listed in (2) are the only two solutions.

If $f(1)=1$, the value of $f(2008)$ is $2008$.",2008,algebra
2008a3,"Let $S \subseteq \mathbb{R}$ be a set of real numbers. We say that a pair $(f, g)$ of functions from $S$ into $S$ is a \emph{Spanish Couple} on $S$, if they satisfy the following conditions:
\begin{itemize}
    \item[(i)] Both functions are strictly increasing, i.e. $f(x) < f(y)$ and $g(x) < g(y)$ for all $x, y \in S$ with $x < y$;
    \item[(ii)] The inequality $f(g(g(x))) < g(f(x))$ holds for all $x \in S$.
\end{itemize}

Decide whether there exists a Spanish Couple on the set $S = \mathbb{N}$ of positive integers. If the answer is 'Yes', give the value \(1\). Else give \(0\).","We show that the answer is NO.

Throughout the solution, we will use the notation $g_k(x) = \underbrace{g(g(\dots g(x)\dots))}_{k\text{ times}}$, including $g_0(x) = x$ as well.

Suppose that there exists a Spanish Couple $(f, g)$ on the set $\mathbb{N}$. From property (i) we have $f(x) \geq x$ and $g(x) \geq x$ for all $x \in \mathbb{N}$.

We claim that $g_k(x) \leq f(x)$ for all $k \geq 0$ and all positive integers $x$. The proof is done by induction on $k$. We already have the base case $k = 0$ since $x \leq f(x)$. For the induction step from $k$ to $k+1$, apply the induction hypothesis on $g_2(x)$ instead of $x$, then apply (ii):
\[
g(g_{k+1}(x)) = g_k(g_2(x)) \leq f(g_2(x)) < g(f(x)).
\]
Since $g$ is increasing, it follows that $g_{k+1}(x) < f(x)$. The claim is proven.

If $g(x) = x$ for all $x \in \mathbb{N}$ then $f(g(g(x))) = f(x) = g(f(x))$, and we have a contradiction with (ii). Therefore one can choose an $x_0 \in \mathbb{N}$ for which $x_0 < g(x_0)$. Now consider the sequence $x_0, x_1, \dots$ where $x_k = g_k(x_0)$. The sequence is increasing. Indeed, we have $x_0 < g(x_0) = x_1$, and $x_k < g(x_k)$ implies $x_{k+1} = g(x_k) < g(x_{k+1}) = x_{k+2}$.

Hence, we obtain a strictly increasing sequence $x_0 < x_1 < \dots$ of positive integers which on the other hand has an upper bound, namely $f(x_0)$. This cannot happen in the set $\mathbb{N}$ of positive integers, thus no Spanish Couple exists on $\mathbb{N}$. So the answer is $0$.
",0,algebra
2008a6,"Let $f : \mathbb{R} \to \mathbb{N}$ be a function which satisfies
\[
f\left(x + \frac{1}{f(y)}\right) = f\left(y + \frac{1}{f(x)}\right) \quad \text{for all } x, y \in \mathbb{R}. \tag{1}
\]
Is there a positive integer which is not a value of $f$? If the answer is 'Yes', give the value \(1\). Else give \(0\).
","Suppose that the statement is false and $f(\mathbb{R}) = \mathbb{N}$. We prove several properties of the function $f$ in order to reach a contradiction.

To start with, observe that one can assume $f(0) = 1$. Indeed, let $a \in \mathbb{R}$ be such that $f(a) = 1$, and consider the function $g(x) = f(x + a)$. By substituting $x + a$ and $y + a$ for $x$ and $y$ in (1), we have
\[
g\left(x + \frac{1}{g(y)}\right) = f\left(x + a + \frac{1}{f(y + a)}\right) = f\left(y + a + \frac{1}{f(x + a)}\right) = g\left(y + \frac{1}{g(x)}\right).
\]
So $g$ satisfies the functional equation (1), with the additional property $g(0) = 1$. Also, $g$ and $f$ have the same set of values: $g(\mathbb{R}) = f(\mathbb{R}) = \mathbb{N}$. Henceforth we assume $f(0) = 1$.

\textbf{Claim 1.} For an arbitrary fixed $c \in \mathbb{R}$ we have
\[
\left\{ f\left(c + \frac{1}{n} \right) : n \in \mathbb{N} \right\} \subseteq \mathbb{N}.
\]

\textit{Proof.} Equation (1) and $f(\mathbb{R}) = \mathbb{N}$ imply
\[
f(\mathbb{R}) = \left\{ f\left( x + \frac{1}{f(c)} \right) : x \in \mathbb{R} \right\} = \left\{ f\left( c + \frac{1}{f(x)} \right) : x \in \mathbb{R} \right\} \subset \left\{ f\left(c + \frac{1}{n} \right) : n \in \mathbb{N} \right\} \subset f(\mathbb{R}).
\]
The claim follows.

We will use Claim 1 in the special cases $c = 0$ and $c = 1/3$:
\[
\left\{ f\left( \frac{1}{n} \right) : n \in \mathbb{N} \right\} = \left\{ f\left( \frac{1}{3} + \frac{1}{n} \right) : n \in \mathbb{N} \right\} \subseteq \mathbb{N}. \tag{2}
\]

\textbf{Claim 2.} If $f(u) = f(v)$ for some $u, v \in \mathbb{R}$ then $f(u+q) = f(v+q)$ for all nonnegative rational $q$. Furthermore, if $f(q) = 1$ for some nonnegative rational $q$ then $f(kq) = 1$ for all $k \in \mathbb{N}$.

\textit{Proof.} For all $x \in \mathbb{R}$ we have by (1)
\[
f\left( u + \frac{1}{f(x)} \right) = f\left( x + \frac{1}{f(u)} \right) = f\left( x + \frac{1}{f(v)} \right) = f\left( v + \frac{1}{f(x)} \right).
\]
Since $f(x)$ attains all positive integer values, this yields $f(v + 1/n) = f(v + 1/n)$ for all $n \in \mathbb{N}$. Let $q = k/n$ be a positive rational number. Then $k$ repetitions of the last step yield
\[
f(u + q) = f\left( u + \frac{k}{n} \right) = f\left( v + \frac{k}{n} \right) = f(v + q).
\]

Now let $f(q) = 1$ for some nonnegative rational $q$, and let $k \in \mathbb{N}$. As $f(0) = 1$, the previous conclusion yields successively $f(q) = f(2q), f(2q) = f(3q), \dots, f((k - 1)q) = f(kq)$, as needed.

\textbf{Claim 3.} The equality $f(q) = f(q + 1)$ holds for all nonnegative rational $q$.

\textit{Proof.} Let $m$ be a positive integer such that $f(1/m) = 1$. Such an $m$ exists by (2). Applying the second statement of Claim 2 with $q = 1/m$ and $k = m$ yields $f(1) = 1$.

Given that $f(0) = f(1) = 1$, the first statement of Claim 2 implies $f(q) = f(q + 1)$ for all nonnegative rational $q$.

\textbf{Claim 4.} The equality $f\left( \frac{1}{n} \right) = n$ holds for every $n \in \mathbb{N}$.

\textit{Proof.} For a nonnegative rational $q$ we set $x = q, y = 0$ in (1) and use Claim 3 to obtain
\[
f\left( \frac{1}{f(q)} \right) = f\left( q + \frac{1}{f(0)} \right) = f(q + 1) = f(q).
\]
By (2), for each $n \in \mathbb{N}$ there exists a $k \in \mathbb{N}$ such that $f(1/k) = n$. Applying the last equation with $q = 1/k$, we have
\[
n = f\left( \frac{1}{k} \right) = f\left( \frac{1}{f(1/k)} \right) = f\left( \frac{1}{n} \right).
\]

Now we are ready to obtain a contradiction. Let $n \in \mathbb{N}$ be such that $f(1/3 + 1/n) = 1$. Such an $n$ exists by (2). Let $1/3 + 1/n = s/t$, where $s, t \in \mathbb{N}$ are coprime. Observe that $t > 1$ as $1/3 + 1/n$ is not an integer. Choose $k, l \in \mathbb{N}$ so that $ks - lt = 1$.

Because $f(0) = f(s/t) = 1$, Claim 2 implies $f(ks/t) = 1$. Now $f(ks/t) = f(l + 1/t)$; on the other hand $f(1 + l + 1/t) = f(1/t)$ by 1 successive applications of Claim 3. Finally, $f(1/t) = t$ by Claim 4, leading to the impossible $t = 1$. The solution is complete.

So the answer is $1$.",1,algebra
2008c1,"In the plane we consider rectangles whose sides are parallel to the coordinate axes and have positive length. Such a rectangle will be called a \textit{box}. Two boxes \textit{intersect} if they have a common point in their interior or on their boundary.

Find the largest $n$ for which there exist $n$ boxes $B_1, \ldots, B_n$ such that $B_i$ and $B_j$ intersect if and only if $i \not\equiv j \pm 1 \pmod{n}$.
","The maximum number of such boxes is $6$.

Now we show that $6$ is the maximum. Suppose that boxes $B_1, \ldots, B_n$ satisfy the condition. Let the closed intervals $I_k$ and $J_k$ be the projections of $B_k$ onto the $x$- and $y$-axis, for $1 \leq k \leq n$. If $B_i$ and $B_j$ intersect, with a common point $(x, y)$, then $x \in I_i \cap I_j$ and $y \in J_i \cap J_j$. So the intersections $I_i \cap I_j$ and $J_i \cap J_j$ are nonempty. Conversely, if $x \in I_i \cap I_j$ and $y \in J_i \cap J_j$ for some real numbers $x, y$, then $(x, y)$ is a common point of $B_i$ and $B_j$. Putting it around, $B_i$ and $B_j$ are disjoint if and only if their projections on at least one coordinate axis are disjoint.

For brevity we call two boxes or intervals adjacent if their indices differ by $1$ modulo $n$, and nonadjacent otherwise.

The adjacent boxes $B_k$ and $B_{k+1}$ do not intersect for each $k = 1, \dots, n$. Hence $(I_k, I_{k+1})$ or $(J_k, J_{k+1})$ is a pair of disjoint intervals, $1 \leq k \leq n$. So there are at least $n$ pairs of disjoint intervals among $(I_1, I_2), \ldots, (I_{n-1}, I_n), (I_n, I_1); (J_1, J_2), \ldots, (J_{n-1}, J_n), (J_n, J_1)$.

Next, every two nonadjacent boxes intersect, hence their projections on both axes intersect, too. Then the claim below shows that at most $3$ pairs among $(I_1, I_2), \ldots, (I_{n-1}, I_n), (I_n, I_1)$ are disjoint, and the same holds for $(J_1, J_2), \ldots, (J_{n-1}, J_n), (J_n, J_1)$. Consequently $n \leq 3 + 3 = 6$, as stated. Thus we are left with the claim and its justification.

\textbf{Claim.} Let $\Delta_1, \Delta_2, \ldots, \Delta_n$ be intervals on a straight line such that every two nonadjacent intervals intersect. Then $\Delta_k$ and $\Delta_{k+1}$ are disjoint for at most three values of $k = 1, \ldots, n$.

\textit{Proof.} Denote $\Delta_k = [a_k, b_k], \ 1 \leq k \leq n$. Let $\alpha = \max(a_1, \ldots, a_n)$ be the rightmost among the left endpoints of $\Delta_1, \ldots, \Delta_n$, and let $\beta = \min(b_1, \ldots, b_n)$ be the leftmost among their right endpoints. Assume that $\alpha = a_2$ without loss of generality.

If $\alpha \leq \beta$ then $a_i \leq \alpha \leq \beta \leq b_i$ for all $i$. Every $\Delta_i$ contains $\alpha$, and thus no disjoint pair $(\Delta_i, \Delta_{i+1})$ exists.

If $\beta < \alpha$ then $\beta = b_i$ for some $i$ such that $a_i < b_i = \beta < \alpha = a_2 < b_2$, hence $\Delta_2$ and $\Delta_i$ are disjoint. Now $\Delta_2$ intersects all remaining intervals except possibly $\Delta_1$ and $\Delta_3$, so $\Delta_2$ and $\Delta_i$ can be disjoint only if $i = 1$ or $i = 3$. Suppose by symmetry that $i = 3$; then $\beta = b_3$. Since each of the intervals $\Delta_4, \ldots, \Delta_n$ intersects $\Delta_2$, we have $a_i \leq \alpha \leq b_i$ for $i = 4, \ldots, n$. Therefore $\alpha \in \Delta_4 \cap \cdots \cap \Delta_n$, in particular $\Delta_4 \cap \cdots \cap \Delta_n \neq \emptyset$. Similarly, $\Delta_5, \ldots, \Delta_n, \Delta_1$ all intersect $\Delta_3$, so that $\Delta_5 \cap \cdots \cap \Delta_n \cap \Delta_1 \neq \emptyset$ as $\beta \in \Delta_5 \cap \cdots \cap \Delta_n \cap \Delta_1$. This leaves $(\Delta_1, \Delta_2), (\Delta_2, \Delta_3)$ and $(\Delta_3, \Delta_4)$ as the only candidates for disjoint interval pairs, as desired.",6,combinatorics
2008c3,"In the coordinate plane consider the set $S$ of all points with integer coordinates. For a positive integer $k$, two distinct points $A, B \in S$ will be called \textit{$k$-friends} if there is a point $C \in S$ such that the area of the triangle $ABC$ is equal to $k$. A set $T \subset S$ will be called a \textit{$k$-clique} if every two points in $T$ are $k$-friends. Find the least positive integer $k$ for which there exists a $k$-clique with more than $200$ elements.
","To begin, let us describe those points $B \in S$ which are $k$-friends of the point $(0,0)$. By definition, $B = (u,v)$ satisfies this condition if and only if there is a point $C = (x,y) \in S$ such that $\frac{1}{2}|uy - vx| = k$. (This is a well-known formula expressing the area of triangle $ABC$ when $A$ is the origin.)

To say that there exist integers $x, y$ for which $|uy - vx| = 2k$, is equivalent to saying that the greatest common divisor of $u$ and $v$ is also a divisor of $2k$. Summing up, a point $B = (u,v) \in S$ is a $k$-friend of $(0,0)$ if and only if $\gcd(u,v)$ divides $2k$.

Translation by a vector with integer coordinates does not affect $k$-friendship; if two points are $k$-friends, so are their translates. It follows that two points $A, B \in S$, $A = (s,t), B = (u,v)$, are $k$-friends if and only if the point $(u-s, v-t)$ is a $k$-friend of $(0,0)$, i.e., if $\gcd(u-s, v-t)|2k$.

Let $n$ be a positive integer which does not divide $2k$. We claim that a $k$-clique cannot have more than $n^2$ elements.

Indeed, all points $(x,y) \in S$ can be divided into $n^2$ classes determined by the remainders that $x$ and $y$ leave in division by $n$. If a set $T$ has more than $n^2$ elements, some two points $A,B \in T$, $A = (s,t), B = (u,v)$, necessarily fall into the same class. This means that $n|u-s$ and $n|v-t$. Hence $n|d$ where $d = \gcd(u-s, v-t)$. And since $n$ does not divide $2k$, also $d$ does not divide $2k$. Thus $A$ and $B$ are not $k$-friends and the set $T$ is not a $k$-clique.

Now let $M(k)$ be the least positive integer which does not divide $2k$. Write $M(k) = m$ for the moment and consider the set $T$ of all points $(x,y)$ with $0 \le x, y < m$. There are $m^2$ of them. If $A = (s,t), B = (u,v)$ are two distinct points in $T$ then both differences $|u - s|, |v - t|$ are integers less than $m$ and at least one of them is positive. By the definition of $m$, every positive integer less than $m$ divides $2k$. Therefore $u - s$ (if nonzero) divides $2k$, and the same is true of $v - t$. So $2k$ is divisible by $\gcd(u-s, v-t)$, meaning that $A, B$ are $k$-friends. Thus $T$ is a $k$-clique.

It follows that the maximum size of a $k$-clique is $M(k)^2$, with $M(k)$ defined as above. We are looking for the minimum $k$ such that $M(k)^2 > 200$.

By the definition of $M(k)$, $2k$ is divisible by the numbers $1,2,\dots, M(k)-1$, but not by $M(k)$ itself. If $M(k)^2 > 200$ then $M(k) \ge 15$. Trying to hit $M(k) \le 15$ we get a contradiction immediately (2k would have to be divisible by 3 and 5, but not by 15).

So let us try $M(k) = 16$. Then $2k$ is divisible by the numbers $1,2,\dots,15$, hence also by their least common multiple $L$, but not by $16$. And since $L$ is not a multiple of $16$, we infer that $k = L/2$ is the least $k$ with $M(k) = 16$.

Finally, observe that if $M(k) \ge 17$ then $2k$ must be divisible by the least common multiple of $1,2,\dots,16$, which is equal to $2L$. Then $2k \ge 2L$, yielding $k > L/2$.

In conclusion, the least $k$ with the required property is equal to $L/2 = 180180$.
",180180,combinatorics
2008c4,"Let $n$ and $k$ be fixed positive integers of the same parity, $k \geq n$. We are given $2n$ lamps numbered $1$ through $2n$; each of them can be \textit{on} or \textit{off}. At the beginning all lamps are \textit{off}. We consider sequences of $k$ steps. At each step one of the lamps is switched (from \textit{off} to \textit{on} or from \textit{on} to \textit{off}).

Let $N$ be the number of $k$-step sequences ending in the state: lamps $1,\dots,n$ \textit{on}, lamps $n+1,\dots,2n$ \textit{off}.

Let $M$ be the number of $k$-step sequences leading to the same state and not touching lamps $n+1,\dots,2n$ at all.

Give the value of $N/M$ when $k=2020$ and $n=2008$.
","A sequence of $k$ switches ending in the state as described in the problem statement (lamps $1, \dots, n$ on, lamps $n+1, \dots, 2n$ off) will be called an \textit{admissible process}. If, moreover, the process does not touch the lamps $n+1, \dots, 2n$, it will be called \textit{restricted}. So there are $N$ admissible processes, among which $M$ are restricted.

In every admissible process, restricted or not, each one of the lamps $1, \dots, n$ goes from \textit{off} to \textit{on}, so it is switched an odd number of times; and each one of the lamps $n+1, \dots, 2n$ goes from \textit{off} to \textit{off}, so it is switched an even number of times.

Notice that $M > 0$; i.e., restricted admissible processes do exist (it suffices to switch each one of the lamps $1, \dots, n$ just once and then choose one of them and switch it $k - n$ times, which by hypothesis is an even number).

Consider any restricted admissible process $\mathbf{p}$. Take any lamp $\ell$, $1 \le \ell \le n$, and suppose that it was switched $k_\ell$ times. As noticed, $k_\ell$ must be odd. Select arbitrarily an even number of these $k_\ell$ switches and replace each of them by the switch of lamp $n+\ell$. This can be done in $2^{k_\ell - 1}$ ways (because a $k_\ell$-element set has $2^{k_\ell - 1}$ subsets of even cardinality). Notice that $k_1 + \dots + k_n = k$.

These actions are independent, in the sense that the action involving lamp $\ell$ does not affect the action involving any other lamp. So there are $2^{k_1 - 1} \cdot 2^{k_2 - 1} \cdots 2^{k_n - 1} = 2^{k - n}$ ways of combining these actions. In any of these combinations, each one of the lamps $n+1, \dots, 2n$ gets switched an even number of times and each one of the lamps $1, \dots, n$ remains switched an odd number of times, so the final state is the same as that resulting from the original process $\mathbf{p}$.

This shows that every restricted admissible process $\mathbf{p}$ can be modified in $2^{k - n}$ ways, giving rise to $2^{k - n}$ distinct admissible processes (with all lamps allowed).

Now we show that every admissible process $\mathbf{q}$ can be achieved in that way. Indeed, it is enough to replace every switch of a lamp with a label $\ell > n$ that occurs in $\mathbf{q}$ by the switch of the corresponding lamp $\ell - n$; in the resulting process $\mathbf{p}$ the lamps $n+1, \dots, 2n$ are not involved.

Switches of each lamp with a label $\ell > n$ had occurred in $\mathbf{q}$ an even number of times. So the performed replacements have affected each lamp with a label $\ell \le n$ also an even number of times; hence in the overall effect the final state of each lamp has remained the same. This means that the resulting process $\mathbf{p}$ is admissible—and clearly restricted, as the lamps $n+1, \dots, 2n$ are not involved in it any more.

If we now take process $\mathbf{p}$ and reverse all these replacements, then we obtain process $\mathbf{q}$. These reversed replacements are nothing else than the modifications described in the foregoing paragraphs.

Thus there is a one-to-$(2^{k - n})$ correspondence between the $M$ restricted admissible processes and the total of $N$ admissible processes. Therefore $N/M = 2^{k - n}$.

So the value of $N/M$ when $k=2020$ and $n=2008$ is $4096$.",4096,combinatorics
2008c5,"Let $S = \{x_1, x_2, \dots, x_{k + \ell}\}$ be a $(k + \ell)$-element set of real numbers contained in the interval $[0, 1]$; $k$ and $\ell$ are positive integers. A $k$-element subset $A \subset S$ is called \textit{nice} if
\[
\left| \frac{1}{k} \sum_{x_i \in A} x_i - \frac{1}{\ell} \sum_{x_j \in S \setminus A} x_j \right| \le \frac{k + \ell}{2k\ell}.
\]
What is the least number of nice subsets when $k=8$ and $l=9$.","For a $k$-element subset $A \subseteq S$, let 
\[
f(A) = \frac{1}{k} \sum_{x_i \in A} x_i - \frac{1}{\ell} \sum_{x_j \in S \setminus A} x_j.
\] 
Denote $\frac{k + \ell}{2k\ell} = d$. 

By definition a subset $A$ is nice if $|f(A)| \leq d$.

To each permutation $(y_1, y_2, \dots, y_{k + \ell})$ of the set $S = \{x_1, x_2, \dots, x_{k+\ell}\}$ we assign $k + \ell$ subsets of $S$ with $k$ elements each, namely $A_i = \{y_i, y_{i+1}, \dots, y_{i+k-1} \}, i = 1, 2, \dots, k + \ell$. Indices are taken modulo $k + \ell$ here and henceforth. In other words, if $y_1, y_2, \dots, y_{k+\ell}$ are arranged around a circle in this order, the sets in question are all possible blocks of $k$ consecutive elements.

\textbf{Claim.} At least two nice sets are assigned to every permutation of $S$. 

\textit{Proof.} Adjacent sets $A_i$ and $A_{i+1}$ differ only by the elements $y_i$ and $y_{i+k}$, $i = 1, \dots, k + \ell$. By the definition of $f$, and because $y_i, y_{i+k} \in [0, 1]$,
\[
|f(A_{i+1}) - f(A_i)| = \left| \left( \frac{1}{k} + \frac{1}{\ell} \right)(y_{i+k} - y_i) \right| \leq \frac{k + \ell}{k\ell} \leq 2d.
\]

Each element $y_i \in S$ belongs to exactly $k$ of the sets $A_1, \dots, A_{k + \ell}$. Hence in $k$ of the expressions $f(A_1), \dots, f(A_{k + \ell})$ the coefficient of $y_i$ is $1/k$; in the remaining $\ell$ expressions, its coefficient is $-1/\ell$. So the contribution of $y_i$ to the sum of all $f(A_i)$ equals $k \cdot 1/k - \ell \cdot 1/\ell = 0$. Since this holds for all $i$, it follows that $f(A_1) + \cdots + f(A_{k + \ell}) = 0$.

If $f(A_p) = \min f(A_i)$ and $f(A_q) = \max f(A_i)$, we obtain in particular $f(A_p) \leq 0, f(A_q) \geq 0$. Let $p < q$ (the case $p > q$ is analogous); and the claim is true for $p = q$ as $f(A_i) = 0$ for all $i$.

We are ready to prove that at least two of the sets $A_1, \dots, A_{k+\ell}$ are nice. The interval $[-d, d]$ has length $2d$, and we saw that adjacent numbers in the circular arrangement $f(A_1), \dots, f(A_{k+\ell})$ differ by at most $2d$. Suppose that $f(A_p) < -d$ and $f(A_q) > d$. Then one of the numbers $f(A_{p+1}), \dots, f(A_{q-1})$ lies in $[-d, d]$, and also one of the numbers $f(A_{q+1}), \dots, f(A_{p-1})$ lies there. Consequently, one of the sets $A_{p+1}, \dots, A_{q-1}$ is nice, as well as one of the sets $A_{q+1}, \dots, A_{p-1}$.

If $-d \leq f(A_p)$ and $f(A_q) \leq d$ then $A_p$ and $A_q$ are nice.

Let us now $f(A_p) < -d$ and $f(A_q) \leq d$. Then $f(A_p) + f(A_q) < 0$, and since $\sum f(A_i) = 0$, there is an $r \neq q$ such that $f(A_r) > 0$. We have $0 < f(A_r) \leq f(A_q) \leq d$, so the sets $f(A_r)$ and $f(A_q)$ are nice. The only case remaining, $-d \leq f(A_p)$ and $d < f(A_q)$ is analogous.

Apply the claim to each of the $(k + \ell)!$ permutations of $S = \{x_1, x_2, \dots, x_{k + \ell}\}$. This gives at least $2(k + \ell)!$ nice sets, counted with repetitions: each nice set is counted as many times as there are permutations to which it is assigned.

On the other hand, each $k$-element set $A \subset S$ is assigned to exactly $(k!)(\ell!)$ permutations. Indeed, such a permutation $(y_1, y_2, \dots, y_{k + \ell})$ is determined by three independent choices: an index $i \in \{1, 2, \dots, k + \ell\}$ such that $A = \{y_i, y_{i+1}, \dots, y_{i + k - 1}\}$, a permutation $(y_i, y_{i+1}, \dots, y_{i + k - 1})$ of the set $A$, and a permutation $(y_{i + k}, y_{i + k + 1}, \dots, y_{i - 1})$ of the set $S \setminus A$.

In summary, there are at least
\[
\frac{2(k + \ell)!}{(k + \ell)(k! \ell!)} = \frac{2}{k + \ell} \binom{k + \ell}{k}
\]
nice sets.

So the number of nice subsets is at least 
\[
\frac{2}{k + \ell} \binom{k + \ell}{k}.
\]. When $k=8$ and $l=9$, the number is $2860$",2860,combinatorics
2008g5,"Let $k$ and $n$ be integers with $0 \leq k \leq n - 2$. Consider a set $L$ of $n$ lines in the plane such that no two of them are parallel and no three have a common point. Denote by $I$ the set of intersection points of lines in $L$. Let $O$ be a point in the plane not lying on any line of $L$.

A point $X \in I$ is colored red if the open line segment $OX$ intersects at most $k$ lines in $L$. What is the least number of red points that $I$ contains when $k=30?
","There are at least $\frac{1}{2}(k + 1)(k + 2)$ points in the intersection set $I$ in view of the condition $n \geq k + 2$.

For each point $P \in I$, define its \emph{order} as the number of lines that intersect the open line segment $OP$. By definition, $P$ is red if its order is at most $k$. Note that there is always at least one point $X \in I$ of order $0$. Indeed, the lines in $L$ divide the plane into regions, bounded or not, and $O$ belongs to one of them. Clearly any inner corner of this region is a point of $I$ with order $0$.

\textbf{Claim.} Suppose that two points $P, Q \in I$ lie on the same line of $L$, and no other line of $L$ intersects the open line segment $PQ$. Then the orders of $P$ and $Q$ differ by at most $1$.

\emph{Proof.} Let $P$ and $Q$ have orders $p$ and $q$, respectively, with $p > q$. Consider triangle $OPQ$. Now $p$ equals the number of lines in $L$ that intersect the interior of side $OP$. None of these lines intersects the interior of side $PQ$, and at most one can pass through $Q$. All remaining lines must intersect the interior of side $OQ$, implying that $q \geq p - 1$. The conclusion follows.

We prove the main result by induction on $k$. The base $k = 0$ is clear since there is a point of order $0$ which is red. Assuming the statement true for $k - 1$, we pass on to the inductive step. Select a point $P \in I$ of order $0$, and consider one of the lines $\ell \in L$ that pass through $P$. There are $n - 1$ intersection points on $\ell$, one of which is $P$. Out of the remaining $n - 2$ points, the $k$ closest to $P$ have orders not exceeding $k$ by the Claim. It follows that there are at least $k + 1$ red points on $\ell$.

Let us now consider the situation with line $\ell$ removed (together with all intersection points it contains). By hypothesis of induction, there are at least $\frac{1}{2}(k + 1)$ points of order not exceeding $k - 1$ in the resulting configuration. Restoring $\ell$ back produces at most one new intersection point on each segment joining any of these points to $O$, so their order is at most $k$ in the original configuration. The total number of points with order not exceeding $k$ is therefore at least $(k + 1) + \frac{1}{2}k(k + 1) = \frac{1}{2}(k + 1)(k + 2)$. This completes the proof.

So $I$ contains at least $496$ red points when $k=30$.",496,geometry
2008n1,"Let $n$ be a positive integer and let $p$ be a prime number. If $a, b, c$ are integers (not necessarily positive) satisfying the equations
\[
a^n + pb = b^n + pc = c^n + pa,
\]
give the value of $\frac{a+b}{b+c}$.
","If two of $a, b, c$ are equal, it is immediate that all the three are equal. So we may assume that $a \ne b \ne c \ne a$. Subtracting the equations we get $a^n - b^n = -p(b - c)$ and two cyclic copies of this equation, which upon multiplication yield
\[
\frac{a^n - b^n}{a - b} \cdot \frac{b^n - c^n}{b - c} \cdot \frac{c^n - a^n}{c - a} = -p^3. \tag{1}
\]
If $n$ is odd then the differences $a^n - b^n$ and $a - b$ have the same sign and the product on the left is positive, while $-p^3$ is negative. So $n$ must be even.

Let $d$ be the greatest common divisor of the three differences $a - b$, $b - c$, $c - a$, so that $a - b = du$, $b - c = dv$, $c - a = dw$; $\gcd(u, v, w) = 1$, $u + v + w = 0$.

From $a^n - b^n = -p(b - c)$ we see that $(a - b)(a^{n-1} + \dots + b^{n-1}) = -p(b - c)$, i.e., $u|pv$, and cyclically $v|pw$, $w|pu$.

As $\gcd(u,v,w) = 1$ and $u + v + w = 0$, at most one of $u, v, w$ can be divisible by $p$. Supposing that the prime $p$ does not divide any one of them, we get $|u|, |v|, |w|$, whence $|u| = |v| = |w| = 1$; but this quarrels with $u + v + w = 0$.

Thus $p$ must divide exactly one of these numbers. Let e.g. $p|a$, and write $u = pu_1$. Now we obtain, similarly as before, $u_1|v$, $v|w$, $w|u$ so that $|u_1| = |v| = |w| = 1$. The equation $pu_1 + v + w = 0$ forces that the prime $p$ must be even; i.e. $p = 2$. Hence $v + w = -2u_1 = \pm 2$, implying $v = w = \pm 1$ and $u = -2u_1$. Consequently $a - b = -2(b - c) = a - b$.

Knowing that $n$ is even, say $n = 2k$, we rewrite the equation $a^n - b^n = -p(b - c)$ with $p = 2$ in the form
\[
(a^k + b^k)(a^k - b^k) = -2(b - c) = a - b.
\]
The second factor on the left is divisible by $a - b$, so the first factor $(a^k + b^k)$ must be $\pm 1$. Then exactly one of $a$ and $b$ must be odd; yet $a - b = -2(b - c)$ is even. Contradiction ends the proof.
So the value of $\frac{a+b}{b+c}$ is $1$.",1,number theory
2007a1,"Consider those functions $ f: \mathbb{N} \to \mathbb{N} $ which satisfy the condition
\[
f(m + n) \geq f(m) + f(f(n)) - 1
\]
for all $ m, n \in \mathbb{N} $. Find all possible values of $ f(2007) $. Give the maximum possible value of $ f(2007) $.

($ \mathbb{N} $ denotes the set of all positive integers.)
","Suppose that a function $ f: \mathbb{N} \to \mathbb{N} $ satisfies (1). For arbitrary positive integers $ m > n $, by (1) we have
\[
f(m) = f(n + (m - n)) \geq f(n) + f(f(m - n)) - 1 \geq f(n),
\]
so $ f $ is nondecreasing.

Function $ f = 1 $ is an obvious solution. To find other solutions, assume that $ f \neq 1 $ and take the smallest $ a \in \mathbb{N} $ such that $ f(a) > 1 $. Then $ f(b) \geq f(a) > 1 $ for all integer $ b \geq a $.

Suppose that $ f(n) > n $ for some $ n \in \mathbb{N} $. Then we have
\[
f(f(n)) = f\left( (f(n) - n) + n \right) \geq f(f(n) - n) + f(f(n)) - 1,
\]
so $ f(f(n) - n) \leq 1 $ and hence $ f(n) - n < a $. Then there exists a maximal value of the expression $ f(n) - n $; denote this value by $ c $, and let $ f(k) - k = c \geq 1 $. Applying the monotonicity together with (1), we get
\[
2k + c \leq f(2k) = f(k + k) \geq f(k) + f(f(k)) - 1 \geq f(k) + f(k) - 2(2k + c - 1) = 2f(k) - 2c.
\]
Hence $ c \leq 1 $ and $ f(n) \leq n + 1 $ for all $ n \in \mathbb{N} $. In particular, $ f(2007) < 2008 $.

Now we present a family of examples showing that all values from 1 to 2008 can be realized. Let
\[
f_j(n) = \max\{ 1, n + j - 2007 \} \quad \text{for } j = 1, 2, \dots, 2007; \quad f_{2008}(n) =
\begin{cases}
n, & \text{if } n \geq 2007, \\
2007, & \text{if } n < 2007.
\end{cases}
\]
We show that these functions satisfy the condition (1) and clearly $ f_j(2007) = j $.

To check the condition (1) for the function $ f_j, (j \leq 2007) $, note first that $ f_j $ is nondecreasing and $ f_j(n) \leq n $, hence $ f_j(f_j(n)) \leq f_j(n) $ for all $ n \in \mathbb{N} $. Now, if $ f_j(m) = 1 $, then the inequality (1) is clear since $ f_j(m + n) \geq f_j(m) \geq f_j(f_j(n)) $.

In the case $ j = 2008 $, clearly $ n + 1 \geq f_{2008}(n) \geq n $ for all $ n \in \mathbb{N} $; moreover, $ n + 1 \geq f_{2008}(f_{2008}(n)) $. Actually, the latter is trivial if $ f_{2008}(n) = n $; otherwise, $ f_{2008}(n + 1), $ implies $ 2008 \geq f_{2008}(n + 1) \geq f_{2008}(n + n) = f_{2008}(m+n).
\] 

So the maximum possible value of $ f(2007) $ is $2008$.",2008,algebra
2007a4,"Find all functions $f: \mathbb{R}^+ \to \mathbb{R}^+$ such that
\[
f(x + f(y)) = f(x + y) + f(y)
\]
for all $x, y \in \mathbb{R}^+$ (Symbol $\mathbb{R}^+$ denotes the set of all positive real numbers).
Give the value of $f(2007)$.","First we show that $f(y) > y$ for all $y \in \mathbb{R}^+$. Functional equation (1) yields
\[
f(x + f(y)) > f(x + y)
\]
and hence $f(y) \neq y$ immediately. If $f(y) < y$ for some $y$, then setting $x = y - f(y)$ we get
\[
f(y) = f\left( (y - f(y)) + f(y) \right) = f\left( (y - f(y)) + f(y) \right) > f(y),
\]
which is a contradiction. Therefore $f(y) > y$ for all $y \in \mathbb{R}^+$. 

For $x \in \mathbb{R}^+$ define $g(x) = f(x) - x$; then $f(x) = g(x) + x$ and, as we have seen, $g(x) > 0$. Transforming (1) for function $g(x)$ and setting $t = x + y$, we get
\[
f(t + g(y)) = f(t) + f(y),
\]
\[
g(t + g(y)) + t + g(y) = (g(t) + t) + (g(y)) \quad \text{and therefore}
\]
\[
g(t + g(y)) = g(t) + y \quad \text{for all } t > y > 0. \tag{2}
\]

Next we prove that function $g(x)$ is injective. Suppose that $g(y_1) = g(y_2)$ for some numbers $y_1, y_2 \in \mathbb{R}^+$. Then by (2),
\[
g(t) + y_1 = g(t + g(y_1)) = g(t + g(y_2)) = g(t) + y_2,
\]
for all $t > \max\{y_1, y_2\}$. Hence, $g(y_1) = g(y_2)$ is possible only if $y_1 = y_2$.

Now let $u, v$ be arbitrary positive numbers and $t > u + v$. Applying (2) three times,
\[
g(t + g(u) + g(v)) = g(t + g(u)) + v = g(t + u + v) = g(t + (u + v)).
\]
By the injective property we conclude that $t + g(u) + g(v) = t + g(u + v)$, hence
\[
g(u) + g(v) = g(u + v). \tag{3}
\]

Since function $g$ is positive, equation (3) also shows that $g$ is an increasing function. Finally we prove that $g(x) = x$. Combining (2) and (3), we obtain
\[
g(t) + y = g(t + g(y)) = g(t) + g(g(y)),
\]
and hence
\[
g(g(y)) = y.
\]

Suppose that there exists an $x \in \mathbb{R}^+$ such that $g(x) \neq x$. By the monotonicity of $g$, if $x > g(x)$ then $g(x) > g(g(x))$. Similarly, if $x < g(x) \text{ then} g(x) < g(g(x))$. Both cases lead to contradiction, so there exists no such $x$.

We have proved that $g(x) = x$ and therefore $f(x) = g(x) + x = 2x$ for all $x \in \mathbb{R}^+$. This function indeed satisfies the functional equation (1).
So the value of $f(2007)$ is $4014$.",4014,algebra
2007a7,"Let $n > 1$ be an integer. In the space, consider the set
\[
S = \{(x, y, z) \mid x, y, z \in \{0, 1, \dots, n\}, \, x + y + z > 0 \}.
\]
When $n=2007$, find the smallest number of planes that jointly contain all $(n+1)^3 - 1$ points of $S$ but none of them passes through the origin.
","It is easy to find $3n$ such planes. For example, planes $x = i$, $y = i$ or $z = i$ (for $i = 1, 2, \dots, n$) cover the set $S$ but none of them contains the origin. Another such collection consists of all planes $x + y + z = k$ for $k = 1, 2, \dots, 3n$.

We show that $3n$ is the smallest possible number.

\textbf{Lemma 1.} Consider a nonzero polynomial $P(x_1, \dots, x_k)$ in $k$ variables. Suppose that $P$ vanishes at all points $(x_1, \dots, x_k) \in \{0, 1, \dots, n\}$ and $x_1 + \dots + x_k > 0$, while $P(0, \dots, 0) \neq 0$. Then deg $P \geq n$.

\textbf{Proof.} We use induction on $k$. The base case $k = 0$ is clear since $P \neq 0$. Denote for clarity $y = x_k$.

Let $R(x_1, \dots, x_{k-1}, y)$ be the residue of $P$ modulo $Q(y) = y(y - 1)(y - 2) \dots (y - n)$. Polynomial $Q(y)$ vanishes at each $y = 0, 1, \dots, n$, hence $P(x_1, \dots, x_{k-1}, y) = R(x_1, \dots, x_{k-1}, y)$ for all $x_1, \dots, x_{k-1} \in \{0, 1, \dots, n\}$. Therefore, $R$ also satisfies the condition of the Lemma; moreover, deg $R \leq n$. Clearly, deg $R \leq$ deg $P$, so it suffices to prove that deg $R \geq n$.

Now, expand polynomial $R$ in the powers of $y$:

\[
R(x_1, \dots, x_{k-1}, y) = R_n(x_1, \dots, x_{k-1})y^n + R_{n-1}(x_1, \dots, x_{k-1})y^{n-1} + \dots + R_0(x_1, \dots, x_{k-1}).
\]

We show that polynomial $R_n(x_1, \dots, x_{k-1})$ satisfies the condition of the induction hypothesis.

Consider the polynomial $T(y) = R(0, 0, \dots, 0, y)$ of degree $\leq n$. This polynomial has no roots if $y = 1, \dots, n$; on the other hand, $T(y) = 0$ since $T(0) \neq 0$. Hence deg $T = n$, and its leading coefficient is $R_n(0, 0, \dots, 0) \neq 0$. In particular, in the case $k = 1$ we obtain that coefficient $R_n$ is nonzero.

Similarly, take any numbers $a_1, a_2, \dots, a_{k-1} \in \{0, 1, \dots, n\}$ with $a_1 + \dots + a_{k-1} > 0$. Substituting $x_i = a_i$ into $R(x_1, \dots, x_{k-1}, y)$, we get a polynomial in $y$ which vanishes at all points $y = 0, \dots, n$ and has degree $\leq n$. Therefore, this polynomial is null, hence $R_i(a_1, \dots, a_{k-1}) = 0$ for all $i = 0, 1, \dots, n$. In particular, $R_i(a_1, \dots, a_{k-1}) = 0$.

Thus, the polynomial $R(x_1, \dots, x_{k-1})$ satisfies the condition of the induction hypothesis. So, we have deg $R_n \geq (k - 1)n$ and deg $P \geq \text{deg} R_n \geq kn$.

Now we can finish the solution. Suppose that there are $m$ planes covering all the points of $S$ but not containing the origin. Let their equations be $a_1x + b_1y + c_1z + d_1 = 0, \dots$, consider the polynomial

\[
P(x, y, z) = \prod_{i=1}^{N} (a_ix + b_iy + c_iz + d_i).
\]

It has total degree $N$. This polynomial has the property that $P(x_0, y_0, z_0) = 0$ for any $(x_0, y_0, z_0) \in S$, while $P(0, 0, 0) \neq 0$. Hence by Lemma 1 we get $N = \text{deg} P \geq 3n$, as desired.

So when $n=2007$, the answer is $6021$.",6021,algebra
2007c2,"A unit square is dissected into $n > 1$ rectangles such that their sides are parallel to the sides of the square. Any line, parallel to a side of the square and intersecting its interior, also intersects the interior of some rectangle. In this dissection, does there exist a rectangle having no point on the boundary of the square. If the answer is 'Yes', give the value \(1\). Else give \(0\).","Wee suppose the contrary. Consider an arbitrary counterexample. Then we know that each rectangle is attached to at least one side of the square. Observe that a rectangle cannot be attached to two opposite sides, otherwise one of its sides lies on a splitting line.

We say that two rectangles are \textit{opposite} if they are attached to opposite sides of $ABCD$. We claim that there exist two opposite rectangles having a common point.

Consider the union $L$ of all rectangles attached to the left. Assume, to the contrary, that $L$ has no common point with the rectangles attached to the right. Take a polygonal line $p$ connecting the top and the bottom sides of the square and passing close from the right to the boundary of $L$. Then all its points belong to the rectangles attached either to the top or to the bottom. Moreover, the upper end-point of $p$ belongs to a rectangle attached to the top, and the lower one belongs to an other rectangle attached to the bottom. Hence, there is a point on $p$ where some rectangles attached to the top and to the bottom meet each other. So, there always exists a pair of neighboring opposite rectangles.

Now, take two opposite neighboring rectangles $a$ and $b$. We can assume that $a$ is attached to the left and $b$ is attached to the right. Let $X$ be their common point. If $X$ belongs to their horizontal sides (in particular, $X$ may appear to be a common vertex of $a$ and $b$), then these sides provide a splitting line. Otherwise, $X$ lies on the vertical sides. Let $\ell$ be the line containing these sides.

Since $\ell$ is not a splitting line, it intersects the interior of some rectangle. Let $c$ be such a rectangle, closest to $X$; we can assume that $c$ lies above $X$. Let $Y$ be the common point of $\ell$ and the bottom side of $c$. Then $Y$ is also a vertex of two rectangles lying below $c$.

So, let $Y$ be the upper-right and upper-left corners of the rectangles $a'$ and $b'$, respectively. Then $a'$ and $b'$ are situated not lower than $a$ and $b$, respectively (it may happen that $a' = a$ or $b' = b'$). We claim that $a'$ is attached to the left. If $a = a'$ then of course it is. If $a \neq a'$ then $a'$ is above $a$, below $c$ and to the left from $b'$. Hence, it can be attached to the left only. Analogously, $b'$ is attached to the right. Now, the top sides of these two rectangles pass through $Y$, hence they provide a splitting line again. This last contradiction completes the proof.

So the answer is $1$.",1,combinatorics
2007c3,"Find all positive integers $n$, for which the numbers in the set $S = \{1, 2, \dots, n\}$ can be colored red and blue, with the following condition being satisfied: the set $S \times S \times S$ contains exactly 2007 ordered triples $(x, y, z)$ such that (i) $x$, $y$, $z$ are of the same color and (ii) $x + y + z$ is divisible by $n$. Give the maximum value of integers $n$.","Suppose that the numbers $1, 2, \dots, n$ are colored red and blue. Denote by $R$ and $B$ the sets of red and blue numbers, respectively; let $|R| = r$ and $|B| = b = n - r$. Call a triple $(x, y, z) \in S \times S \times S$ monochromatic if $x$, $y$, $z$ have the same color, and bichromatic otherwise. Call a triple $(x, y, z)$ divisible if $x + y + z$ is divisible by $n$. We claim that there are exactly $r^2 + b^2$ divisible monochromatic triples.

For any pair $(x, y) \in S \times S$ there exists a unique $z_{xy} \in S$ such that the triple $(x, y, z_{xy})$ is divisible; so there are exactly $n^2$ divisible triples. Furthermore, if a divisible triple $(x, y, z)$ is bichromatic, then among $x, y, z$ there are either one blue and two red numbers, or vice versa. In both cases, exactly one of the pairs $(x, y)$, $(y, z)$, and $(z, x)$ belongs to the set $R \times B$. Assign such pair to the triple $(x, y, z)$.

Conversely, consider any pair $(x, y) \in R \times B$, and denote $z = z_{xy}$. Since $x \neq y$, the triples $(x, y, z)$, $(y, z, x)$ and $(z, x, y)$ are distinct, and $(x, y)$ is assigned to each of them. On the other hand, if $(y, y)$ is assigned to some triple, then this triple is clearly one of those mentioned above. So each pair in $R \times B$ is assigned exactly three times.

Thus, the number of bichromatic divisible triples is three times the number of elements in $R \times B$, and the number of monochromatic ones is $n^2 - 3rb = (r + b)^2 - 3rb = r^2 - rb + b^2$, as claimed.

So, to find all values of $n$ for which the desired coloring is possible, we have to find all $n$, for which there exists a decomposition $n = r + b$ with $r^2 - rb + b^2 = 2007$. Therefore $9 | r^2 - rb + b^2 = (r + b)^2 - 3rb$. From this it consequently follows that $3 | r + b$, and $r$ and $b$ are divisible by 3. Set $r = 3s, b = 3c$. We can assume that $s \geq c$. We have $s^2 - sc + c^2 = 223$.

Furthermore,
\[
892 = 4(s^2 - sc + c^2) = (2c - s)^2 + 3s^2 \geq 3s^2 \geq 3s^2 - 3c(s - c) = 3s^2 - 3c(s - c) = 669,
\]
so $297 \leq s^2 \leq 223$ and $17 \geq s \geq 15$. If $s = 15$ then
\[
c(15 - c) = c(s - c) = s^2 - 3c^2 + c = 1512 + 1.
\]

So the maximum value of integers $n$ is $84$.",84,combinatorics
2007c5,"In the Cartesian coordinate plane define the strip $S_n = \{(x, y) \mid n \leq x < n + 1 \}$ for every integer $n$. Assume that each strip $S_n$ is colored either red or blue, and let $a$ and $b$ be two distinct positive integers. Does there exist a rectangle with side lengths $a$ and $b$ such that its vertices have the same color. If the answer is 'Yes', give the value \(1\). Else give \(0\).
","If $S_n$ and $S_{n+a}$ have the same color for some integer $n$, then we can choose the rectangle with vertices $(n, 0) \in S_n$, $(n, b) \in S_n$, $(n + a, 0) \in S_{n+a}$, and $(n + a, b) \in S_{n+a}$, and we are done. So it can be assumed that $S_n$ and $S_{n+a}$ have opposite colors for each $n$.

Similarly, it can also be assumed that $S_n$ and $S_{n+b}$ have opposite colors. Then, by induction on $|p| + |q|$, we obtain that for arbitrary integers $p$ and $q$, strips $S_n$ and $S_{n+p+q}$ have the same color if $p + q$ is even, and these two strips have opposite colors if $p + q$ is odd.

Let $d = \gcd(a,b)$, $a = a/d$ and $b = b/d$. Apply the result above for $p = b1$ and $q = -a1$. The strips $S_0$ and $S_0 + a1-a1b$ are identical and therefore they have the same color. Hence, $a1 + b1$ is even. By the construction, $a1$ and $b1$ are coprime, so this is possible only if both are odd.

Without loss of generality, we can assume $a > b$. Then $a > b$ and $b \ge 1$, so $a \ge 3$.

Choose integers $k$ and $\ell$ such that $ka1 - \ell b1 = 1$ and therefore $ka - \ell b = d$. Since $a1$ and $b1$ are odd, $k + \ell$ is odd as well. Hence, for every integer $n$, strips $S_n$ and $S_{n + ka-\ell}$ have opposite colors. This also implies that the coloring is periodic with period $2d$, i.e. strips $S_n$ and $S_{n + 2d}$ have the same color for every $n$.

\textbf{Next part:} We will construct the desired rectangle $ABCD$ with $AB = CD = a$ and $BC = AD = b$ in a position such that vertex $A$ lies on the $x$-axis, and the projection of side $AB$ onto the $x$-axis is of length $2d$ (see Figure 1). This is possible since $a = a1d > 2d$. The coordinates of the vertices will have the forms

\[
A = (t, 0), \quad B = (t + 2d, y1), \quad C = (u + 2d, y2), \quad D = (u, y3).
\]

Let $\varphi = \sqrt{a^2 - 4}$. By Pythagoras' theorem,
\[
y1 = BB0 = \sqrt{a^2 - 4d^2} = d \sqrt{a^2 - 4} = d \varphi.
\]

So, by the similar triangles $ADD0$ and $BAB0$, we have the constraint
\[
u - t = AD0 = \frac{AD}{AB} \cdot BB0 = \frac{bd}{a} \varphi \tag{1}
\]
for numbers $t$ and $u$. Computing the numbers $y2$ and $y3$ is not required since they have no effect to the colors.

Observe that the number $\varphi$ is irrational, because $\varphi^2$ is an integer, but $\varphi$ is not: $a1 > \varphi \ge \sqrt{a^2_1 - 2a1 + 2}$, $a1 - 1$.

By the periodicity, points $A$ and $B$ have the same color; similarly, points $C$ and $D$ have the same color. Furthermore, these colors depend only on the values of $t$ and $u$. So it is sufficient to choose numbers $t$ and $u$ such that vertices $A$ and $D$ have the same color.

Let $w$ be the largest positive integer such that there exist $w$ consecutive strips $S_{n0}, S_{n0+1}, \dots, S_{n0+w-1}$ with the same color, say red. (Since $S_{n0}$ must be blue, we have $w \leq d$.) We will choose $t$ from the interval $(n0, n0 + w)$.

Consider the interval $I = \left( n0 + \frac{bd}{a\varphi}, n0 + \frac{bd}{a\varphi} + w \right)$ on the $x$-axis (see Figure 2). Its length is $w$, and the end-points are irrational. Therefore, this interval intersects $w + 1$ consecutive strips. Since at most $w$ consecutive strips may have the same color, interval $I$ must contain both red and blue points. Choose $u \in I$ such that the line $x = u$ is red and set $t = u - \frac{bd}{a \varphi}$, according to the constraint (1). Then $t \in (n0, n0 + w)$ and $A = (t, 0)$ is red as well as $D = (u, y3)$.

Hence, variables $u$ and $t$ can be set such that they provide a rectangle with four red vertices.

So the answer is $1$.",1,combinatorics
2007c7,"Let \( \alpha < \frac{3 - \sqrt{5}}{2} \) be a positive real number. Do there exist positive integers \( n \) and \( p > \alpha \cdot 2^n \) for which one can select \( 2p \) pairwise distinct subsets \( S_1, \dots, S_p, T_1, \dots, T_p \) of the set \( \{ 1, 2, \dots, n \} \) such that \( S_i \cap T_j \neq \emptyset \) for all \( 1 \leq i, j \leq p \). If the answer is 'Yes', give the value \(1\). Else give \(0\).","Let \( k \) and \( m \) be positive integers (to be determined later) and set \( n = km \). Decompose the set \( \{ 1, 2, \dots, n \} \) into \( k \) disjoint subsets, each of size \( m \); denote these subsets by \( A_1, \dots, A_k \). Define the following families of sets:

\[
S = \{ S \subset \{ 1, 2, \dots, n \} : \forall i S \cap A_i \neq \emptyset \},
\]
\[
T_1 = \{ T \subset \{ 1, 2, \dots, n \} : \exists i A_i \subset T \}, \quad T = T_1 \setminus S.
\]

For each set \( T \in T_1 \), there exists an index \( 1 \leq i \leq k \) such that \( A_i \subset T \). Then for all \( S \in S \) and \( T \in T_1 \), we have \( S \cap T \neq \emptyset \). Hence, each \( S \in S \) and each \( T \in T_1 \) have at least one common element.

Below we show that the numbers \( m \) and \( k \) can be chosen such that \( |S|, |T| \geq \alpha \cdot 2^n \). Then, choosing \( p = \min \{ |S|, |T| \} \), one can select the desired \( 2p \) sets \( S_1, \dots, S_p, T_1, \dots, T_p \) from families \( S \) and \( T \), respectively. Since families \( S \) and \( T \) are disjoint, sets \( S_i \) and \( T_j \) will be pairwise distinct.

To count the sets \( S \in S \), observe that each \( A_i \) has \( 2^{m-1} \) nonempty subsets so we have \( 2^{m-1} \) choices for \( S \cap A_i \). These intersections uniquely determine set \( S \), so
\[
|S| = (2^{m-1})^k. \tag{1}
\]

Similarly, if a set \( H \subset \{ 1, 2, \dots, n \} \) does not contain a certain set \( A_i \), then we have \( 2^{m-1} \) choices for \( H \cap A_i \); all subsets of \( A_i \), except \( A_i \) itself. Therefore, the complement of \( T_1 \) contains \( (2^{m-1})^k \) sets and
\[
|T_1| = 2^k m - (2^{m-1})^k. \tag{2}
\]

Next consider the family \( S \setminus T_1 \). If a set \( S \) intersects all \( A_i \) but does not contain any of them, then there exists \( 2^m - 2 \) possible values for each \( S \cap A_i \); all subsets of \( A_i \) except \( \emptyset \) and \( A_i \). Therefore the number of such sets \( S \) is \( (2^{m-2})^k \), so
\[
|S \setminus T_1| = (2^{m-2})^k. \tag{3}
\]

From (1), (2), and (3) we obtain
\[
|T_1| = |T_1| - |S \setminus T_1| = |T_1| - (|S \setminus T_1|) = 2^k - 2(2^{m-1})^k + (2^{m-2})^k.
\]

Let \( \delta = \frac{3 - \sqrt{5}}{2} \) and \( k = k(m) = [2m \log 3] \). Then
\[
\lim_{m \to \infty} \frac{|S|}{2k} = 1 - \lim_{m \to \infty} \left( 1 - \frac{1}{2m} \right)^k = \exp \left( \lim_{m \to \infty} \frac{k}{2m} \right) = \delta.
\]

and similarly
\[
\lim_{m \to \infty} \frac{|T|}{2k} = 1 - 2 \lim_{m \to \infty} \left( \frac{k}{2m} \right).
\]

Hence, if \( m \) is sufficiently large then \( |S| \) and \( |T| \) are greater than \( \alpha \) (since \( \alpha < \delta \)).
So the answer is $1$.",1,combinatorics
2007c8,"Given a convex \( n \)-gon \( P \) in the plane. For every three vertices of \( P \), consider the triangle determined by them. Call such a triangle \textit{good} if all its sides are of unit length. 

If there are not more than \( K \) good triangles, give the value of \( K \) when \(n=2007\).
","Consider all good triangles containing a certain vertex \( A \). The other two vertices of any such triangle lie on the circle \( \omega_A \) with unit radius and center \( A \). Since \( P \) is convex, all these vertices lie on an arc of angle less than \( 180^\circ \). Let \( L_A R_A \) be the shortest such arc, oriented clockwise (see Figure 1). Each of segments \( A L_A \) and \( A R_A \) belongs to a unique good triangle. We say that the good triangle with side \( A L_A \) is assigned counterclockwise to \( A \), and the second one, with side \( A R_A \), is assigned clockwise to \( A \). In those cases when there is a single good triangle containing vertex \( A \), this triangle is assigned to \( A \) twice.

There are at most two assignments to each vertex of the polygon. (Vertices which do not belong to any good triangle have no assignment.) So the number of assignments is at most \( 2n \).

Consider an arbitrary good triangle \( ABC \), with vertices arranged clockwise. We prove that \( ABC \) is assigned to its vertices at least three times. Then, denoting the number of good triangles by \( t \), we obtain that the number \( K \) of all assignments is at most \( 2n \), while it is not less than \( 3t \). Then \( 3t \leq K \leq 2n \), as required.

Actually, we prove that triangle \( ABC \) is assigned either counterclockwise to \( C \) or clockwise to \( B \). Then, by the cyclic symmetry of the vertices, we obtain that triangle \( ABC \) is assigned either counterclockwise to \( A \) or clockwise to \( C \), and either counterclockwise to \( B \) or clockwise to \( A \), providing the claim.

Assume, to the contrary, that \( L_C \neq A \) and \( R_B \neq A \). Denote by \( A', B', C' \) the intersection points of circles \( \omega_A, \omega_B \) and \( \omega_C \), distinct from \( A, B, C \) (see Figure 2). Let \( C L C' \) be the good triangle containing \( C L C \). Observe that the angle of arc \( L C A \) is less than \( 120^\circ \). Then one of the points \( L_C \) and \( L_C' \) belongs to arc \( B' A \) of \( \omega_C \); let this point be \( X \). In the case when \( L_C = B' \) and \( L_C' = A \), choose \( X = B' \).

Analogously, considering the good triangle \( B R B' R B \) which contains \( B R B \) as an edge, we see that one of the points \( R_B \) and \( R_B' \) lies on arc \( A C' \) of \( \omega_B \). Denote this point by \( Y \), \( Y \neq A \). Then angles \( X A Y \), \( Y A B \), \( B A C \) (oriented clockwise) are not greater than \( 180^\circ \). Hence, point \( A \) lies in quadrilateral \( X Y B C \) (either in its interior or on segment \( X Y \)). This is impossible, since all these five points are vertices of \( P \).

Hence, each good triangle has at least three assignments, and the statement is proved.

So there are not more than \( \frac{n^2}{8} \) good triangles. If \( n=2007 \), the answer is \( 1338 \).",1338,combinatorics
2007g1,"In triangle \( ABC \), the angle bisector at vertex \( C \) intersects the circumcircle and the perpendicular bisectors of sides \( BC \) and \( CA \) at points \( R, P, \) and \( Q \), respectively. The midpoints of \( BC \) and \( CA \) are \( S \) and \( T \), respectively. Please calculate the ratio of the areas of triangles \( RQT \) and \( RPS \).
","If \( AC = BC \) then triangle \( ABC \) is isosceles, triangles \( RQT \) and \( RPS \) are symmetric about the bisector \( CR \) and the statement is trivial. If \( AC \neq BC \) then it can be assumed without loss of generality that \( AC < BC \).

Denote the circumcenter by \( O \). The right triangles \( CTQ \) and \( CSP \) have equal angles at vertex \( C \), so they are similar, \( \angle CPS = \angle LQCT = \angle LQQP \) and
\[
\frac{QT}{PS} = \frac{CQ}{CP}
\]
Let \( \ell \) be the perpendicular bisector of chord \( CR \); of course, \( \ell \) passes through the circumcenter \( O \). Due to the equal angles at \( P \) and \( Q \), triangle \( OPQ \) is isosceles with \( OP = OQ \). Then line \( \ell \) is the axis of symmetry in this triangle as well. Therefore, points \( P \) and \( Q \) lie symmetrically on line segment \( CR \),
\[
RP = CQ \quad \text{and} \quad RQ = CP.
\]
Triangles \( RQT \) and \( RPS \) have equal angles at vertices \( Q \) and \( P \), respectively. Then
\[
\frac{\text{area}(RQT)}{\text{area}(RPS)} = \frac{1}{2} \cdot RQ \cdot QT \cdot \sin \angle RQT = \frac{RQ}{RP} \cdot \frac{QT}{PS} \cdot \sin \angle RPS = \frac{RQ}{RP} \cdot \frac{QT}{PS}.
\]
Substituting (1) and (2),
\[
\frac{\text{area}(RQT)}{\text{area}(RPS)} = \frac{RQ}{RP} \cdot \frac{QT}{PS} = \frac{CP}{CQ} \cdot \frac{CP}{CQ} = 1.
\]
Hence, \( \text{area}(RQT) = \text{area}(RSP) \).
",1,geometry
2007g3,"The diagonals of a trapezoid \( ABCD \) intersect at point \( P \). Point \( Q \) lies between the parallel lines \( BC \) and \( AD \) such that \( \angle AQD = \angle CQB \), and line \( CD \) separates points \( P \) and \( Q \). Give the value of \( \frac{\angle BQP}{\angle DAQ} \).
","Let \( t = \frac{AD}{BC} \). Consider the homothety \( h \) with center \( P \) and scale \( -t \). Triangles \( PDA \) and \( PBC \) are similar with ratio \( t \), hence \( h(B) = D \) and \( h(C) = A \).

Let \( Q' = h(Q) \) (see Figure 1). Then points \( Q, P \) and \( Q' \) are obviously collinear. Points \( Q \) and \( P \) lie on the same side of \( AD \), as well as on the same side of \( BC \); hence \( Q' \) and \( P \) are also on the same side of \( h(BC) = AD \), and therefore \( Q \) and \( Q' \) are on the same side of \( AD \). Moreover, points \( Q \) and \( C \) are on the same side of \( BD \), while \( Q' \) and \( A \) are on the opposite side (see Figure above).

By the homothety, \( \angle LAQ'D = \angle LCQB = \angle LAQD \), hence quadrilateral \( AQ'QD \) is cyclic. Then 
\[
\angle LDAQ = \angle LDQ'Q = \angle LDQ'P = \angle LBQP
\]
(the latter equality is valid by the homothety again).

So the value of \( \frac{\angle BQP}{\angle DAQ} \) is \(1\).",1,geometry
2007g6,"Determine the smallest positive real number \( k \) with the following property.

Let \( ABCD \) be a convex quadrilateral, and let points \( A_1, B_1, C_1 \) and \( D_1 \) lie on sides \( AB, BC, CD \) and \( DA \), respectively. Consider the areas of triangles \( AA_1D_1, BB_1A_1, CC_1B_1, \) and \( DD_1C_1 \); let \( S \) be the sum of the two smallest ones, and let \( S_1 \) be the area of quadrilateral \( A_1B_1C_1D_1 \). Then we always have \( kS_1 \geq S \).
","Throughout the solution, triangles $AA_1D_1$, $BB_1A_1$, $CC_1B_1$, and $DD_1C_1$ will be referred to as \emph{border triangles}. We will denote by $[R]$ the area of a region $R$.

First, we show that $k \geq 1$. Consider a triangle $ABC$ with unit area; let $A_1$, $B_1$, $K$ be the midpoints of its sides $AB$, $BC$, $AC$, respectively. Choose a point $D$ on the extension of $BK$, close to $K$. Take points $C_1$ and $D_1$ on sides $CD$ and $DA$ close to $D$ (see Figure 1). We have $[BB_1A_1] = \frac{1}{4}$. Moreover, as $C_1$, $D_1$, $D \to K$, we get $[A_1B_1C_1D_1] = [A_1B_1K] = \frac{1}{4}$, $[AA_1D_1] \to [AA_1K] = \frac{1}{4}$, $[CC_1B_1] \to [CKB_1] = \frac{1}{4}$ and $[DD_1C_1] \to 0$. Hence, the sum of the two smallest areas of border triangles tends to $\frac{1}{4}$ as well as $[A_1B_1C_1D_1]$; therefore, their ratio tends to 1, and $k \geq 1$.

We are left to prove that $k = 1$ satisfies the desired property.

\textbf{Lemma.} Let points $A_1$, $B_1$, $C_1$ lie respectively on sides $BC$, $CA$, $AB$ of a triangle $ABC$. Then
\[
[A_1B_1C_1] \geq \min\left\{[ACB_1], [BA_1C_1], [CB_1A_1]\right\}.
\]

\textbf{Proof.} Let $A'$, $B'$, $C'$ be the midpoints of sides $BC$, $CA$ and $AB$, respectively.
Suppose that two of points $A_1$, $B_1$, $C_1$ lie in one of triangles $AC'B'$, $BA'C'$, and $CB'A'$ (for convenience, let points $B_1$ and $C_1$ lie in triangle $AC'B'$; see Figure 2). Let segments $B_1C_1$ and $AA_1$ intersect at point $X$. Then $X$ also lies in triangle $AC'B'$. Hence $A_1X \geq AX$, and we have
\[
[A_1B_1C_1] = \frac{1}{4}A_X \cdot B_1C_1 \cdot \sin \angle A_1XC_1 = \frac{1}{2}AX \cdot B_1C_1 \cdot \sin \angle AXB_1 \geq \frac{A_1X}{AX} \geq 1,
\]
as required.

Otherwise, each one of triangles $AC'B'$, $BA'C'$, $CB'A'$ contains exactly one of points $A_1$, $B_1$, $C_1$, and we can assume that $BA_1 < BA'$, $CB_1 < CB'$, $AC_1 < AC'$ (see Figure 3). Then lines $BA_1$ and $AB$ intersect at a point $Y$ on the extension of $AB$ beyond point $B$, hence
\[
[A_1B_1C_1] = \frac{C_1Y}{C'Y} > 1; \quad \text{also, lines $A'C'$ and $CA$ intersect at a point $Z$ on the extension of $CA$ beyond point $A$, hence}
\]
\[
[A_1B_1C_1] = \frac{BZ}{B'Z} > 1. \quad \text{Finally, since $A'B' \parallel B'C'$, we have} \quad [A_1B_1C_1] > [A_1B'C'] > [A'B'C'] = \frac{1}{4}[ABC].
\]

Now, from $[A_1B_1C_1] + [ACB_1] + [BA_1C_1] + [CB_1A_1] = [ABC]$ we obtain that one of the remaining triangles $ACB_1$, $BA_1C_1$, $CB_1A_1$ has an area less than $\frac{1}{4}[ABC]$, so it is less than $[A_1B_1C_1]$.

Now we return to the problem. We say that triangle $A_1B_1C_1$ is small if $[A_1B_1C_1]$ is less than each of $[BB_1A_1]$ and $[CCB_1]$; otherwise this triangle is big (the similar notion is introduced for triangles $B_1C_1D_1$, $C_1D_1A_1$, $D_1A_1B_1$). If both triangles $A_1B_1C_1$ and $C_1D_1A_1$ are big, then $[A_1B_1C_1]$ is not less than the area of some border triangle, and $[C_1D_1A_1]$ is not less than the area of another one; hence, $S_1 = [A_1B_1C_1] + [C_1D_1A_1] \geq S$. The same is valid for the pair of $B_1C_1D_1$ and $D_1A_1B_1$. So it is sufficient to prove that in one of these pairs both triangles are big.

Suppose the contrary. Then there is a small triangle in each pair. Without loss of generality, assume that triangles $A_1B_1C_1$ and $D_1A_1B_1$ are small. We can assume also that $[A_1B_1C_1] \leq [D_1A_1B_1]$. Note that in this case ray $D_1C_1$ intersects line $BC$.

Consider two cases.

\textbf{Case 1.} Ray $C_1D_1$ intersects line $AB$ at some point $K$. Let ray $D_1C_1$ intersect line $BC$ at point $L$ (see Figure 4). Then we have $[A_1B_1C_1] < [CCB_1] < [LCB_1]$, $[A_1B_1C_1] < [BB_1A_1]$ (both — since $[A_1B_1C_1]$ is small), and $[A_1B_1C_1] \leq [D_1A_1B_1] < [AA_1D_1] < [K A_1C_1]$ (since triangle $D_1A_1B_1$ is small). This contradicts the Lemma, applied for triangle $A_1B_1C_1$ inside $LKB$.

\textbf{Case 2.} Ray $C_1D_1$ does not intersect $AB$. Then choose a ""sufficiently far"" point $K$ on ray $BA$ such that $[KA_1C_1] > [A_1B_1C_1]$, and that ray $KC$ intersects line $BC$ at some point $L$ (see Figure 5). Since ray $C_1D_1$ does not intersect line $AB$, the points $A$ and $D$ are on different sides of $KL$; then $A$ and $D$ are also on different sides, and $C$ is on the same side as $A$ and $B$. Then analogously we have $[A_1B_1C_1] < [CCB_1] < [LCB_1]$ and $[A_1B_1C_1] < [BB_1A_1]$ since triangle $A_1B_1C_1$ is small. This (together with $[A_1B_1C_1] < [KA_1C_1]$) contradicts the Lemma again.
",1,geometry
2007n1,"Find all pairs $(k, n)$ of positive integers for which $7^k - 3^n$ divides $k^4 + n^2$. Calculate the sum of the quantity \[ (k+n) \] over every such pair.","Suppose that a pair $(k, n)$ satisfies the condition of the problem. Since $7^k - 3^n$ is even, $k^4 + n^2$ is also even, hence $k$ and $n$ have the same parity. If $k$ and $n$ are odd, then $k^4 + n^2 = 1 + 1 = 2$ (mod 4), while $7^k - 3^n = 7^3 - 3^3 = 7 - 7 = 0$ (mod 4), so $k^4 + n^2$ cannot be divisible by $7^k - 3^n$. Hence, both $k$ and $n$ must be even.

Write $k = 2a$, $n = 2b$. Then $7^k - 3^n = 7^{2a} - 3^{2b} = 7^{a} - 3^{b}$. So $2(7^a + 3^b) | 7^k - 3^n$ and $7^k - 3^n | k^4 + n^2 = 2(8a^4 + 2b^2)$, hence 
\[
7^a + 3^b \leq 8a^4 + 2b^2. \tag{1}
\]

We prove by induction that $8a^4 < 7a$ for $a \geq 4$, $2b^2 < 3b$ for $b \geq 3$. In the initial cases $a = 4$, $b = 1$, $b = 2$ and $a = 3$ we have $8 \cdot 4^4 = 2048 < 7^4 = 2401, 2 < 3$, $2 \cdot 2^2 = 8 < 3^2 = 9$, and $2 \cdot 3^2 = 18 < 3^3 = 27$, respectively. If $8a^4 < 7a$ (a ≥ 4) and $2b^2 + 9 \leq 3b$ (b ≥ 3), then
\[
8(a+1)^4 = 8a^4 \left( \frac{a+1}{a} \right)^4 < 7a^4 \quad \text{and} \quad 2(b+1)^2 + 9 \leq 3b \quad \text{for } b \geq 3.
\]

For $a \geq 4$, we obtain $7a + 3b > 8a^4 + 2b^2$ and inequality (1) cannot hold. Hence $a \leq 3$, and three cases are possible.

\text{Case 1:} $a = 1$. Then $k = 2$ and $8 + 8b^2 \geq 7 + 3b$, thus $2b^2 + 1 \leq 3b^3$. This is possible only if $b \leq 2$. If $b = 1$ then $n = 2$ and $8 + 8b^2$ is possible only if $7^k - 3^n = 7$.

\text{Case 2:} $a = 2$. The cases too continue using other facts... .

So the sum is $6$.",6,number theory
2007n5,"Find all surjective functions \( f : \mathbb{N} \to \mathbb{N} \) such that for every \( m, n \in \mathbb{N} \) and every prime \( p \), the number \( f(m + n) \) is divisible by \( p \) if and only if \( f(m) + f(n) \) is divisible by \( p \). Give the value of \( f(2007) \).
\(\mathbb{N}\) is the set of all positive integers.","Suppose that function \( f : \mathbb{N} \to \mathbb{N} \) satisfies the problem conditions.

\textbf{Lemma.} For any prime \( p \) and any \( x, y \in \mathbb{N} \), we have \( x \equiv y \, (\text{mod} \, p) \) if and only if \( f(x) \equiv f(y) \, (\text{mod} \, p) \). Moreover, \( p \mid f(x) \) if and only if \( p \mid x \).

\textbf{Proof.} Consider an arbitrary prime \( p \). Since \( f \) is surjective, there exists some \( x \in \mathbb{N} \) such that \( p \mid f(x) \). Let
\[
d = \min\left( x \in \mathbb{N} : p \mid f(x) \right).
\]
By induction on \( k \), we obtain that \( p \mid f(kd) \) for all \( k \in \mathbb{N} \). The base is true since \( p \mid f(d) \). Moreover, if \( p \mid f(kd) \) and \( p \mid f(d) \), then by the problem condition, \( p \mid f(kd + d) = f((k+1)d) \), as required.

Suppose that there exists an \( x \in \mathbb{N} \) such that \( d \nmid x \) but \( p \mid f(x) \). Let
\[
y = \min \left\{ x \in \mathbb{N} : d \mid x, \, p \mid f(x) \right\}.
\]
By the choice of \( d \), we have \( y \geq d \), and \( y - d \) is a positive integer not divisible by \( d \). Then \( p \mid f(y - d) \), while \( p \mid f(d + (y - d)) = f(y) \). This contradicts the problem condition. Hence, there is no such \( x \), and we have
\[
p \mid f(x) \iff d \mid x.
\]
\[
\text{(1)}
\]

Take arbitrary \( x, y \in \mathbb{N} \) such that \( x \equiv y \, (\text{mod} \, d) \). We have \( p \mid f(x + (2xd - x)) = f(2xd); \) moreover, since \( d \mid 2xd + (y - x) \), we get \( p \mid f(y + (2xd - x)) \). Then by the problem condition, \( p \mid f(x) + f(2xd - x) \), and hence \( f(x) = f(y + (2xd - x)) \equiv f(y) \, (\text{mod} \, d) \). Thus, we have proved that
\[
x \equiv y \, (\text{mod} \, d) \iff f(x) \equiv f(y) \, (\text{mod} \, p).
\]
\[
\text{(2)}
\]

We are left to show that \( p = d \): in this case (1) and (2) provide the desired statements.

The numbers \( 1, 2, \dots, d \) have distinct residues modulo \( d \). By (2), numbers \( f(1), f(2), \dots, f(d) \) have distinct residues modulo \( p \); hence there are at least \( d \) distinct residues, and \( d \geq p \). On the other hand, by the surjectivity of \( f \), there exist \( x_1, \dots, x_p \in \mathbb{N} \) such that \( f(x_i) = i \) for any \( i = 1, 2, \dots, p \). By (2), all these \( x_i \)'s have distinct residues modulo \( d \). For the same reasons, \( d \geq p \). Hence, \( d = p \).

Now we prove that \( f(n) = n \) by induction on \( n \). If \( n = 1 \), then, by the Lemma, \( p \nmid f(1) \) for any prime \( p \), so (1) and (2) together give the result. Suppose that \( n = k \) and denote \( f(k) = k \). Note that there exists a prime \( q \mid k \), so by the Lemma \( q \mid k \) and \( k > 1 \).

If \( k > n \), then \( k - n + 1 > 1 \), and there exists a prime \( p \mid k - n + 1 \); we have \( k = n - 1 \). Therefore, \( n = k - n \) will hold.

Analogously, if \( k < n \), then \( f(k-1) = k-1 \) by induction hypothesis. Moreover, \( n - k + 1 > 1 \), so there exists a prime \( p \mid n - k + 1 \) and \( n \equiv k - 1 \, (\text{mod} \, p) \). By the Lemma again, \( k = f(n) \equiv f(k-1) = k - 1 \, (\text{mod} \, p) \), which is also false. The only remaining case is \( k = n \), so \( f(n) = n \).

Finally, the function \( f(n) = n \) obviously satisfies the condition. So the value of \(f(2007)\) is \(2007\).",2007,number theory
2006a6,"Determine the smallest number \( M \) such that the inequality
\[
|ab(a^2 - b^2) + bc(b^2 - c^2) + ca(c^2 - a^2)| \leq M (a^2 + b^2 + c^2)^2
\]
holds for all real numbers \( a, b, c \). Give the value of \( 2012 M^2 \).
","We first consider the cubic polynomial
\[
P(t) = t b(t^2 - b^2) + bc(b^2 - c^2) + ct(c^2 - t^2).
\]
It is easy to check that \( P(b) = P(c) = P(b - c) = 0 \), and therefore
\[
P(t) = (b - c)(t - b)(t - c)(t + b + c),
\]
since the cubic coefficient is \( b - c \). The left-hand side of the proposed inequality can therefore be written in the form
\[
|ab(a^2 - b^2) + bc(b^2 - c^2) + ca(c^2 - a^2)| = |P(a)| = |(b - c)(a - b)(a - c)(a + b + c)|.
\]
The problem comes down to finding the smallest number \( M \) that satisfies the inequality
\[
|(b - c)(a - b)(a - c)(a + b + c)| \leq M (a^2 + b^2 + c^2)^2. \tag{1}
\]
Note that this expression is symmetric, and we can therefore assume \( a \leq b \leq c \) without loss of generality. With this assumption,
\[
| (a - b)(b - c)| = |(b - a)(c - b)| \leq \left( \frac{(b - a) + (c - b)}{2} \right)^2 = \frac{(c - a)^2}{4}, \tag{2}
\]
with equality if and only if \( b - a = c - b \), i.e. \( 2b = a + c \). Also
\[
\left( \frac{(c - b) + (b - a)}{2} \right)^2 \leq \frac{(c - b)^2 + (b - a)^2}{2}, \tag{3}
\]
or equivalently,
\[
3(c - a)^2 \leq 2 \left[ (b - a)^2 + (c - b)^2 + (c - a)^2 \right],
\]
again with equality only for \( 2b = a + c \). From (2) and (3) we get
\[
\left| (b - c)(a - b)(a - c)(a + b + c) \right| \leq \frac{\sqrt{2}}{4} \sqrt{(c - a)^6 (a + b + c)^2}.
\]
By the weighted AM-GM inequality this estimate continues as follows:
\[
\left| (b - c)(a - b)(a - c)(a + b + c) \right| \leq \frac{\sqrt{2}}{2} \left( \frac{(b - a)^2 + (c - b)^2 + (c - a)^2}{4} \right)^2 = \frac{9\sqrt{2}}{32} (a^2 + b^2 + c^2)^2.
\]
We see that the inequality (1) is satisfied for \( M = \frac{9}{32}\sqrt{2} \), with equality if and only if \( 2b = a + c \) and
\[
(b - a)^2 + (c - b)^2 + (c - a)^2 = (a + b + c)^2.
\]
Plugging \( b = (a + c)/2 \) into the last equation, we bring it to the equivalent form
\[
2(c - a)^2 = 9(a + c)^2.
\]
The conditions for equality can now be restated as
\[
2b = a + c \quad \text{and} \quad c - a = 18b^2.
\]
Setting \( b = 1 \) yields \( a = 1 - \frac{3}{2}\sqrt{2} \) and \( c = 1 + \frac{3}{2}\sqrt{2} \). We see that \( M = \frac{9}{32}\sqrt{2} \) is indeed the smallest constant satisfying the inequality, with equality for any triple \( (a, b, c) \) proportional to \( (1 - \frac{3}{2}\sqrt{2}, 1, 1 + \frac{3}{2}\sqrt{2}) \), up to permutation.

So the value of \( 2012 M^2 \) is \(162\).",162,algebra
2006c1,"We have \( n \geq 2 \) lamps \( L_1, \dots, L_n \) in a row, each of them being either on or off. Every second we simultaneously modify the state of each lamp as follows:
\begin{itemize}
    \item if the lamp \( L_i \) and its neighbours (only one neighbour for \( i = 1 \) or \( i = n \), two neighbours for other \( i \)) are in the same state, then \( L_i \) is switched off;
    \item otherwise, \( L_i \) is switched on.
\end{itemize}
Initially all the lamps are off except the leftmost one which is on.

Are there infinitely many integers \( n \) for which all the lamps will eventually be off? If the answer is 'Yes', give the value \(1\). Else give \(0\).
","Experiments with small \( n \) lead to the guess that every \( n \) of the form \( 2^k \) should be good. This is indeed the case, and more precisely: let \( A_k \) be the \( 2^k \times 2^k \) matrix whose rows represent the evolution of the system, with entries 0 (\( \text{off} \)) and 1 (\( \text{on} \)) respectively. The top row shows the initial state \( [1, 0, 0, \dots, 0] \); the bottom row shows the state after \( 2^{k-1} \) steps. The claim is that:
\[
\text{The bottom row of } A_k \text{ is } [1, 1, 1, \dots, 1].
\]
This will of course suffice because one more time produces \( [0, 0, 0, \dots, 0] \), as required.

The proof is by induction on \( k \). The base \( k = 1 \) is obvious. Assume the claim to be true for a \( k \geq 1 \) and write the matrix \( A_{k+1} \) in the block form
\[
A_{k+1} = \begin{pmatrix} A_k & O_k \\ B_k & C_k \end{pmatrix}
\]
with four \( 2^k \times 2^k \) matrices. After \( m \) steps, the last 1 in a row is at position \( m+1 \). Therefore \( O_k \) is the zero matrix. According to the induction hypothesis, the bottom row of \( [A_k \, O_k] \) is \( [1, \dots, 1, 0, \dots, 0] \), with \( 2^k \) ones and \( 2^{k-1} \) zeros. The next row is thus
\[
\left[ 0, \dots, 0, 1, 1, 0, \dots, 0 \right]
2^{k-1}.
\]
It is symmetric about its midpoint, and this symmetry is preserved in all subsequent rows because the procedure described in the problem statement is left/right symmetric. Thus \( B_k \) is the mirror image of \( C_k \). In particular, the rightmost column of \( B_k \) is identical with the leftmost column of \( C_k \).

Imagine the matrix \( C_k \) in isolation from the rest of \( A_{k+1} \). Suppose it is subject to evolution as defined in the problem: the first (leftmost) term in a row depends only on the two first terms in the preceding row, according as they are equal or not. Now embed \( C_k \) again in \( A_k \). The 'leftmost' terms in the rows of \( C_k \) now have neighbours on their left side—but these neighbours are their exact copies. Consequently the actual evolution within \( C_k \) is the same, whether or not \( C_k \) is considered as a piece of \( A_{k+1} \) or in isolation. And since the top row of \( C_k \) is \( [1, 0, 0, \dots, 0] \), it follows that \( C_k \) is identical with \( A_k \).

The bottom row of \( A_k \) is \( [1, 1, \dots, 1] \); the same is the bottom row of \( C_k \), hence also of \( B_k \). So the bottom row of \( A_{k+1} \) consists of ones only and the induction is complete. So the answer is \(1\).
",1,combinatorics
2006c2,"A diagonal of a regular 2006-gon is called odd if its endpoints divide the boundary into two parts, each composed of an odd number of sides. Sides are also regarded as odd diagonals.

Suppose the 2006-gon has been dissected into triangles by \(2003\) nonintersecting diagonals. Find the maximum possible number of isosceles triangles with two odd sides.
","Call an isosceles triangle odd if it has two odd sides. Suppose we are given a dissection as in the problem statement. A triangle in the dissection which is odd and isosceles will be called iso-odd for brevity.

Let \( AB \) be one of dissecting diagonals and let \( L \) be the shorter part of the boundary of the 2006-gon with endpoints \( A, B \). Suppose that \( L \) consists of \( n \) segments. Then the number of iso-odd triangles with vertices on \( L \) does not exceed \( n/2 \).

\textbf{Proof.} This is obvious for \( n = 2 \). Take \( n \) with \( 2 < n < 1003 \) and assume the claim to be true for every \( L \) of length less than \( n \). Let \( L \) (endpoints \( A, B \)) consist of \( n \) segments. Let \( PQ \) be the longest diagonal which is a side of an iso-odd triangle \( PQS \) with all vertices on \( L \) (if there is no such triangle, there is nothing to prove). Every triangle whose vertices lie on \( L \) is obtuse or right-angled; thus \( S \) is the summit of \( PQS \). We may assume that the five points \( A, P, S, Q, B \) lie on \( L \) in this order and partition \( L \) into four pieces \( L_{AP}, L_{PS}, L_{SQ}, L_{QB} \) (the outer ones possibly reducing to a point).

By the definition of \( PQ \), an iso-odd triangle cannot have vertices on both \( L_{AP} \) and \( L_{QB} \). Therefore every iso-odd triangle within \( L \) has all its vertices on just one of the four pieces. Applying to each of these pieces the induction hypothesis and adding the four inequalities we get that the number of iso-odd triangles within \( L \) other than \( PQS \) does not exceed \( n/2 \). And since each of \( L_{PS}, L_{SQ} \) consists of an odd number of sides, the inequalities for these two pieces are actually strict, leaving a \( 1/2 + 1/2 \) in excess. Hence the triangle \( PSQ \) is also covered by the estimate \( n/2 \). This concludes the induction step and proves the lemma. \( \square \)

The remaining part of the solution in fact repeats the argument from the above proof. Consider the longest dissecting diagonal \( XY \). Let \( L_{XY} \) be the shorter of the two parts of the boundary with endpoints \( X, Y \) and let \( XYZ \) be the triangle in the dissection with vertex \( Z \) not on \( L_{XY} \). Notice that \( XYZ \) is acute or right-angled, otherwise one of the segments \( XZ, YZ \) would be longer than \( XY \). Denoting by \( L_{XZ}, L_{YZ} \) the two pieces defined by \( Z \) and applying the lemma to each of \( L_{XZ}, L_{XY}, L_{YZ} \) we infer that there are no more than 2006/2 iso-odd triangles in all, unless \( XYZ \) is one of them. But in that case \( XZ \) and \( YZ \) are odd diagonals and the corresponding inequalities are strict. This shows that also in this case the total number of iso-odd triangles in the dissection, including \( XYZ \), is not greater than 1003.

This bound can be achieved. For this to happen, it just suffices to select a vertex of the 2006-gon and draw a broken line joining every second vertex, starting from the selected one. Since 2006 is even, the line closes. This already gives us the required 1003 iso-odd triangles. Then we can complete the triangulation in an arbitrary fashion.

So the answer is \(1003\).",1003,combinatorics
2006g5,"In triangle \( ABC \), let \( J \) be the centre of the excircle tangent to side \( BC \) at \( A_1 \) and to the extensions of sides \( AC \) and \( AB \) at \( B_1 \) and \( C_1 \), respectively. Suppose that the lines \( A_1B_1 \) and \( AB \) are perpendicular and intersect at \( D \). Let \( E \) be the foot of the perpendicular from \( C_1 \) to line \( DJ \). Determine the angles \( \angle BEA_1 \) (in degrees).
","Let \( K \) be the intersection point of lines \( JC \) and \( A_1B_1 \). Obviously, \( JC \perp A_1B_1 \) and since \( A_1B_1 \perp AB \), the lines \( JK \) and \( C_1D \) are parallel and equal. From the right triangle \( B_1CJ \) we obtain \( JC^2 = J B_1^2 = JC \cdot JK = JC \cdot C_1D \), from which we infer that \( DC_1/CJ = C_1J/JC \) and the right triangles \( DC_1J \) and \( C_1JC \) are similar. Hence \( \angle C_1LDJ = \angle LCJC \), which implies that the lines \( DJ \) and \( C_1C \) are perpendicular, i.e. the points \( C_1, E, C \) are collinear.

Since \( \angle C_1AJ = \angle C_1BJ = \angle C_1EJ = 90^\circ \), points \( A_1, B_1 \) and \( E \) lie on the circle of diameter \( CJ \). Then \( \angle DBA_1 = \angle A_1CJ = \angle DEA_1 \), which implies that quadrilateral \( BEA_1D \) is cyclic; therefore \( \angle A_1EB = 90^\circ \).
",90,geometry
2006n1,"Determine all pairs \( (x, y) \)  of integers satisfying the equation
\[
1 + 2^x + 2^{2x+1} = y^2.
\]
Calculate the sum of the quantity \[ (x+y) \] over every such pair.","If \( (x, y) \) is a solution then obviously \( x \geq 0 \) and \( (x, -y) \) is a solution too. For \( x = 0 \) we get the two solutions \( (0, 2) \) and \( (0, -2) \).
Now let \( (x, y) \) be a solution with \( x > 0 \); without loss of generality confine attention to \( y > 0 \).
The equation rewritten as
\[
2^x (1 + 2^{x+1}) = (y - 1)(y + 1)
\]
shows that the factors \( y - 1 \) and \( y + 1 \) are even, exactly one of them divisible by 4. Hence \( x \geq 3 \) and one of these factors is divisible by \( 2^{x-1} \) but not by \( 2^x \). So
\[
y = 2^{x-1}m + \epsilon, \quad m \text{ odd}, \quad \epsilon = \pm 1.
\]
Plugging this into the original equation we obtain
\[
2^x (1 + 2^{x+1}) = (2^{x-1}m + \epsilon)^2 = 1 - 2^{2x} - 2m^2 + 2\epsilon m c,
\]
or, equivalently
\[
1 + 2^{x+1} = 2^{2x} - m^2 + \epsilon m c.
\]
Therefore
\[
1 - \epsilon m = 2^{2x}(m^2 - 8). \tag{2}
\]
For \( \epsilon = 1 \) this yields \( m^2 - 8 \leq 0 \), i.e., \( m = 1 \), which fails to satisfy (2).
For \( \epsilon = -1 \) equation (2) gives us
\[
1 + m^2 = 2^{2x}(m^2 - 8) \quad \Rightarrow \quad 2(m^2 - 8) \leq m^2 - 8,
\]
implying \( 2m^2 - m - 17 \leq 0 \). Hence \( m \leq 3 \); on the other hand \( m \) cannot be 1 by (2). Because \( m \) is odd, we obtain \( m = 3 \), leading to \( x = 4 \). From (1) we get \( y = 23 \). These values indeed satisfy the given equation. Recall that then \( y = -23 \) is also good. Thus we have the complete list of solutions \( (x, y): (0, 2), (0, -2), (4, 23), (4, -23) \).

So the sum is \(8\).",8,number theory
2006n5,"Find all integer solutions of the equation
\[
\frac{x^7 - 1}{x - 1} = y^5 - 1.
\]
Give the number of all possible integer solutions.","Solution. The equation has no integer solutions. To show this, we first prove a lemma.

\textbf{Lemma.} If \( x \) is an integer and \( p \) is a prime divisor of \( \frac{x^7 - 1}{x - 1} \), then either \( p = 1 \, (\text{mod} \, 7) \) or \( p = 7 \).

\textbf{Proof.} Both \( x^7 - 1 \) and \( x^{p-1} - 1 \) are divisible by \( p \), by hypothesis and by Fermat's little theorem, respectively. Suppose that 7 does not divide \( p - 1 \). Then \( \text{gcd}(p, 7) = 1 \), so there exist integers \( k \) and \( m \) such that \( 7k + (p - 1)m = 1 \). We therefore have
\[
x \equiv x^{7k + (p-1)m} \equiv (x^7)^k \cdot (x^{p-1})^m \equiv 1 \, (\text{mod} \, p),
\]
and so
\[
\frac{x^7 - 1}{x - 1} = 1 + x + x^2 + \dots + x^6 \equiv 7 \, (\text{mod} \, p).
\]
It follows that \( p \) divides 7, hence \( p = 7 \) must hold if \( p = 1 \, (\text{mod} \, 7) \) does not, as stated. \( \square \)

The lemma shows that each positive divisor \( d \) of \( \frac{x^7 - 1}{x - 1} \) satisfies either \( d = 0 \, (\text{mod} \, 7) \) or \( d = 1 \, (\text{mod} \, 7) \).

Now assume that \( (x, y) \) is an integer solution of the original equation. Notice that \( y > 1 \), because \( \frac{x^7 - 1}{x - 1} > 0 \) for all \( x \neq 1 \). Since \( y - 1 \) divides \( \frac{x^7 - 1}{x - 1} = y^5 - 1 \), we have \( y = 1 \, (\text{mod} \, 7) \) or \( y \equiv 2 \, (\text{mod} \, 7) \) by the previous paragraph. In the first case, \( 1 + y + y^2 + y^3 + y^4 \equiv 5 \, (\text{mod} \, 7) \), and in the second \( 1 + y + y^2 + y^3 + y^4 \equiv 3 \, (\text{mod} \, 7) \). Both possibilities contradict the fact that the positive divisor \( 1 + y + y^2 + y^3 + y^4 \) of \( \frac{x^7 - 1}{x - 1} \) is congruent to 0 or 1 modulo 7. So the given equation has no integer solutions.

So the number is \(0\).",0,number theory
2006n7,"For every positive integer $ n $, does there exist an integer $m$ such that $2^m + m$ is divisible by $n$? If the answer is 'Yes', give the value \(1\). Else give \(0\).","Solution. We will prove by induction on \( d \) that, for every positive integer \( N \), there exist positive integers \( b_0, b_1, \dots, b_{d-1} \) such that, for each \( i = 0, 1, 2, \dots, d - 1 \), we have \( b_i > N \) and
\[
2^i + b_i \equiv i \, (\text{mod} \, d).
\]
This yields the claim for \( m = b_0 \).

The base case \( d = 1 \) is trivial. Take an \( a > 1 \) and assume that the statement holds for all \( d < a \). Note that the remainders of \( 2^i \) modulo \( a \) repeat periodically starting with some exponent \( M \). Let \( k \) be the length of the period; this means that \( 2^{M+k} \equiv 2^M \, (\text{mod} \, a) \) holds only for those \( k' \) which are multiples of \( k \). Note further that the period cannot contain all \( a \) remainders, since 0 either is missing or is the only number in the period. Thus \( k < a \).

Let \( d = \text{gcd}(a, k) \) and let \( a' = a/d, k' = k/d \). Since \( 0 < k < a \), we also have \( 0 < d < a \). By the induction hypothesis, there exist positive integers \( b_0, b_1, \dots, b_{d-1} \) such that \( b_i > \max(2^M, N) \) and
\[
2^i + b_i \equiv i \, (\text{mod} \, d) \quad \text{for } i = 0, 1, 2, \dots, d - 1. \tag{1}
\]
For each \( i = 0, 1, \dots, d - 1 \) consider the sequence
\[
2^i + b_i, \, 2^{i+k} + (b_i + k), \, \dots, \, 2^{i+(a'-1)k} + (b_i + (a' - 1)k). \tag{2}
\]
Modulo \( a \), these numbers are congruent to
\[
2^i + b_i, \, 2^{i + (b_i + k)}, \, \dots, \, 2^{i + (a' - 1)k}, \tag{3}
\]
respectively. The \( d \) sequences contain \( a'd = a \) numbers altogether. We shall now prove that no two of these numbers are congruent modulo \( a \).

Suppose that
\[
2^i + (b_i + mk) \equiv 2^j + (b_j + nk) \, (\text{mod} \, a) \tag{4}
\]
for some values of \( i, j \in \{ 0, 1, \dots, d - 1 \} \) and \( m, n \in \{ 0, 1, \dots, d - 1 \} \). Since \( d \) is a divisor of \( a \), we also have
\[
2^i + (b_i + mk) \equiv 2^j + (b_j + nk) \, (\text{mod} \, d). 
\]
Because \( d \) is a divisor of \( k \) and in view of (1), we obtain \( i \equiv j \, (\text{mod} \, d) \). As \( j, i \in \{ 0, 1, \dots, d - 1 \} \), this just means that \( i = j \). Substituting this into (3) yields \( m = nk \, (\text{mod} \, a) \). Therefore \( mk' = nk' \, (\text{mod} \, a') \), and since \( a' \) and \( k' \) are coprime, we get \( m = n \, (\text{mod} \, a') \. \)

It follows that the \( a \) numbers that make up the \( d \) sequences (2) satisfy all the requirements; they are certainly all greater than \( N \) because we chose each \( b_i > \max(2^M, N) \). So the statement holds for \( a \), completing the induction.

So the answer is \(1\).
",1,number theory
2005p4,"Determine all positive integers relatively prime to all the terms of the infinite sequence
\[
a_n = 2^n + 3^n + 6^n - 1, \quad n \geq 1.
\]
","Let \( k \) be a positive integer that satisfies the given condition.

For all primes \( p > 3 \), by Fermat's Little Theorem, \( n^{p-1} \equiv 1 \, (\text{mod} \, p) \) if \( n \) and \( p \) are relatively prime. This means that \( n^{p-3} \equiv \frac{1}{n^2} \, (\text{mod} \, p) \). Plugging \( n = p - 3 \) back into the equation, we see that the value \( \mod p \) is simply
\[
\frac{2}{9} + \frac{3}{4} + \frac{1}{36} - 1 = 0.
\]
Thus, the expression is divisible by all primes \( p > 3 \). Since \( a_2 = 48 = 2^4 \cdot 3 \), we can conclude that \( k \) cannot have any prime divisors. Therefore, our answer is only \( 1 \).",1,number theory
2004p2,"Find all polynomials \( f \) with real coefficients such that for all reals \( a, b, c \) such that \( ab + bc + ca = 0 \) we have the following relation
\[
f(a - b) + f(b - c) + f(c - a) = 2f(a + b + c).
\]
If \( f(1)=3 \) and \( f(2)=36 \), give the value of \( f(11) \).","The answer is
\[
f(x) = \alpha x^4 + \beta x^2
\]
which can be checked to work, for any real numbers \( \alpha \) and \( \beta \).

It is easy to obtain that \( f \) is even and \( f(0) = 0 \). The trick is now to choose \( (a, b, c) = (6x, 3x, -2x) \) and then compare the leading coefficients to get
\[
3^n + 5^n + 8^n = 2 \cdot 7^n
\]
for \( n = \deg f \) (which is even). As \( n \geq 7 \Rightarrow (8/7)^n > 2 \), this means that we must have \( n \leq 6 \). Moreover, taking modulo 7 we have \( 3^n + 5^n \equiv 6 \pmod{7} \) which gives \( n \equiv 2, 4 \pmod{6} \).

Thus \( \deg f \leq 4 \), which (combined with \( f \) even) resolves the problem.

If \( f(1)=3 \) and \( f(2)=36 \), the value of \( f(11) \) is \(29403\).
",29403,algebra
2004p6,"Find all positive integers \( n \) such that \( n \) has a multiple which is alternating. We call a positive integer \textit{alternating} if every two consecutive digits in its decimal representation are of different parity. If \(n<50\), calculate the sum of all possible \(n\).","If \( 20 \mid n \), then clearly \( n \) has no alternating multiple since the last two digits are both even. We will show the other values of \( n \) all work.

The construction is just rush-down do-it. The meat of the solution is the two following steps.

\textbf{Claim (Tail construction)} — For every even integer \( w \geq 2 \),
\begin{itemize}
    \item there exists an even alternating multiple \( g(w) \) of \( 2^{w+1} \) with exactly \( w \) digits, and
    \item there exists an even alternating multiple \( h(w) \) of \( 5^w \) with exactly \( w \) digits.
\end{itemize}

(One might note this claim is implied by the problem, too.)

\textit{Proof.} We prove the first point by induction on \( w \). If \( w = 2 \), take \( g(2) = 32 \). In general, we can construct \( g(w+2) \) from \( g(w) \) by adding some element in
\[
10^w \cdot \{10, 12, 14, 16, 18, 30, \dots, 98\}
\]
to \( g(w) \), corresponding to the digits we want to append to the start. This multiple is automatically divisible by \( 2^{w+1} \), and also can take any of the four possible values modulo \( 2^{w+3} \).

The second point is a similar induction, with base case \( h(2) = 50 \). The same set above consists of numbers divisible by \( 5^w \), and covers all residues modulo \( 5^{w+2} \). Careful readers might recognize the second part as essentially USAMO 2003/1. \(\square\)

\textbf{Claim (Head construction)} — If \( \gcd(n, 10) = 1 \), then for any \( b \), there exists an even alternating number \( f(b \bmod n) \) which is \( b \pmod{n} \).

\textit{Proof.} A standard argument shows that
\[
10 \cdot \frac{100^m - 1}{99} = 1010\ldots10 \equiv 0 \pmod{n}
\]
for any \( m \) divisible by \( \varphi(9n) \). Take a very large such \( m \), and then add on \( b \) distinct numbers of the form \( 10^{r(n)} \) for various even values of \( r \); these all are 1 mod \( n \) and change some of the 1's to 3's.

Now, we can solve the problem. Consider three cases:
\begin{itemize}
    \item If \( n = 2^k m \) where \( \gcd(m, 10) = 1 \) and \( k \geq 2 \) is even, then the concatenated number
    \[
    10^k f\left( \frac{-g(k)}{10^k} \bmod m \right) + g(k)
    \]
    works fine.

    \item If \( n = 5^k m \) where \( \gcd(m, 10) = 1 \) and \( k \geq 2 \) is even, then the concatenated number
    \[
    10^k f\left( \frac{-h(k)}{10^k} \bmod m \right) + h(k)
    \]
    works fine.

    \item If \( n = 50m \) where \( \gcd(m, 10) = 1 \), then the concatenated number
    \[
    100 f\left( \frac{-1}{2} \bmod m \right) + 50
    \]
    works fine.
\end{itemize}

Since every non-multiple of 20 divides such a number, we are done.

If \(n<50\), the sum of all possible \(n\) is \(1165\).",1165,number theory
2003p2,"Determine all pairs of positive integers \( (a, b) \) such that
\[
\frac{a^2}{2ab^2 - b^3 + 1}
\]
is a positive integer. If \(a+b<100\), calculate the sum of the quantity \[ (a+b) \] over every such pair.","The only solutions are of the form \( (a, b) = (2n, 1), (a, b) = (n, 2n) \), and \( (8n^4 - n, 2n) \) for any positive integer \( n \).

First, we note that when \( b = 1 \), the given expression is equivalent to \( a/2 \), which is an integer if and only if \( a \) is even.

Now, suppose that \( (a, b) \) is a solution not of the form \( (2n, 1) \). We have already given all solutions for \( b = 1 \); then for this new solution, we must have \( b > 1 \). Let us denote
\[
\frac{a^2}{2ab^2 - b^3 + 1} = k.
\]
Denote
\[
P(t) = t^2 - 2kb^2 t + k(b^3 - 1).
\]
Since \( k(b^3 - 1) > 0 \), and \( a \) is a positive integer root of \( P \), there must be some other root \( a' \) of \( P \).

Without loss of generality, let \( a' > a \). Then \( a^2 \leq a a' = k(b^3 - 1) \), so
\[
k = \frac{a^2}{2ab^2 - b^3 + 1} \leq \frac{k(b^3 - 1)}{2ab^2 - b^3 + 1},
\]
or
\[
2ab^2 - (b^3 - 1) \leq b^3 - 1,
\]
which reduces to
\[
a \leq b - \frac{1}{b^2} < b.
\]
It follows that
\[
0 < 2ab^2 - b^3 + 1 \leq a^2 < b^2,
\]
or
\[
0 < (2a - b)b^2 + 1 < b^2.
\]
Since \( a \) and \( b \) are integers, this can only happen when \( 2a - b = 0 \), so \( (a, b) \) can be written as \( (n, 2n) \), and \( k = n^2 \). It follows that
\[
a' = \frac{k(b^3 - 1)}{a} = 8n^4 - n.
\]
Since \( a' \) is the other root of \( P \), it follows that \( (a', b) \) also satisfies the problem's condition. Therefore the solutions are exactly the ones given at the solution’s start. \(\blacksquare\)


All solutions \( (a,b) \) with \( a+b<100 \) are:

\[
\{(2n,1)\mid n=1,2,\dots,49\}
\;\cup\;
\{(n,2n)\mid n=1,2,\dots,33\}
\;\cup\;
\{(7,2)\}.
\]

The sum of all \( (a+b) \) over these solutions is \(4191\).",4191,number theory
2003p6,"Show that for each prime \( p \), does there exist a prime \( q \) such that \( n^p - p \) is not divisible by \( q \) for any positive integer \( n \)? If the answer is 'Yes', give the value \(1\). Else give \(0\).
","By orders, we must have \( q = pk + 1 \) for this to be possible (since if \( q \not\equiv 1 \pmod{p} \), then \( n^p \) can be any residue modulo \( q \)). Since \( p \equiv n^p \pmod{q} \Rightarrow p^k \equiv 1 \pmod{q} \), it suffices to prevent the latter situation from happening.

So we need a prime \( q \equiv 1 \pmod{p} \) such that \( p^k \not\equiv 1 \pmod{q} \). To do this, we first recall the following lemma.

\[
\boxed{
\textbf{Lemma} \quad \text{Let } \Phi_p(X) = 1 + X + X^2 + \cdots + X^{p-1}. \text{ For any integer } a, \text{ if } q \text{ is a prime divisor of } \Phi_p(a) \text{ other than } p, \text{ then } a \pmod{q} \text{ has order } p. \text{ (In particular, } q \equiv 1 \pmod{p} \text{.)}
}
\]

\textit{Proof.} We have \( a^p - 1 \equiv 0 \pmod{q} \), so either the order is 1 or \( p \). If it is 1, then \( a \equiv 1 \pmod{q} \), so \( q \mid \Phi_p(1) = p \), hence \( q = p \). \(\square\)

Now the idea is to extract a prime factor \( q \) from the cyclotomic polynomial
\[
\Phi_p(p) = \frac{p^p - 1}{p - 1} \equiv 1 + p \pmod{p^2}
\]
such that \( q \not\equiv 1 \pmod{p^2} \); hence \( k \not\equiv 0 \pmod{p} \), and as \( p \pmod{q} \) has order \( p \), we have \( p^k \not\equiv 1 \pmod{q} \).

So the answer is \(1\).",1,number theory
2002p3,"Find all pairs of integers \( m > 2, n > 2 \) such that there are infinitely many positive integers \( k \) for which \( k^n + k^2 - 1 \) divides \( k^m + k - 1 \). Calculate the sum of the quantity \[ (m+n) \] over every such pair.
","\textit{Proof.} Assume on contrary \( m > 2n \) and let \( 0 < r < 1 \) be the unique real number with \( r^n + r^2 = 1 \), hence \( r^m + r = 1 \). But now
\[
\begin{aligned}
0 &= r^m + r - 1 \leq r^{2n+1} + r - 1 \\
&= r \left( ((1 - r^2)^2 + 1) \right) - 1 \\
&= -(1 - r) \left( r^4 + r^3 - r^2 - r + 1 \right) \\
&= -(1 - r) \left( r^4 + (1 - r)(1 - r^2) \right).
\end{aligned}
\]
However, \( 1 - r > 0 \) and \( r^4 + (1 - r)(1 - r^2) > 0 \) are both obvious for \( 0 < r < 1 \). So this is a contradiction. \(\square\)

Now for the algebraic part. Obviously \( m > n \).

\[
\begin{aligned}
k^n + k^2 - 1 \mid k^m + k - 1 &\iff k^n + k^2 - 1 \mid (k^m + k - 1)(k + 1) = k^m(k + 1) + (k^2 - 1) \\
&\iff k^n + k^2 - 1 \mid k^m(k + 1) - k^n \\
&\iff k^n + k^2 - 1 \mid k^{m - n}(k + 1) - 1.
\end{aligned}
\]

The right-hand side has degree \( m - n + 1 \leq n + 1 \), and the leading coefficients are both \( +1 \). So the only possible situations are

\[
\begin{aligned}
k^{m - n}(k + 1) - 1 &= (k + 1)(k^n + k^2 - 1) \\
k^{m - n}(k + 1) + 1 &= k^n + k^2 - 1.
\end{aligned}
\]

The former fails by just taking \( k = -1 \); the latter implies \( (m, n) = (5, 3) \). As our work was reversible, this also implies \( (m, n) = (5, 3) \) works, done.

So the sum is \(8\).
",8,number theory
2002p5,"Find all real-valued functions on the reals such that 
\[
(f(x) + f(y))((f(u) + f(v)) = f(xu - yv) + f(xv + yu)
\]
for all \( x, y, u, v \).
If \(f(1)=1\), give the value of \(f(70)\).
","We start by considering the case when \( x = y = u = v = 0 \). 

This leads us to \( 4f(0)^2 = 2f(0) \), implying \( f(0) = 0 \) or \( f(0) = 1/2 \). 

If \( f(0) = 1 \), then putting \( x = y = u = 0 \) gives us \( f(u) = 1/2 \) for all \( u \in \mathbb{R} \). 

On the other hand, if \( f(0) = 0 \), putting \( y = v = 0 \) gives us \( f(x)f(u) = f(xu) \), indicating that \( f \) is multiplicative. 

If \( f(0) = 0 \), we have \( f(1) = 0 \) or \( f(1) = 1 \). 

If \( f(1) = 0 \), then \( f(x) = f(x \cdot 1) = f(x)f(1) = 0 \) for all \( x \in \mathbb{R} \). 

Disregarding constant solutions, we assume \( f(0) = 0 \) and \( f(1) = 1 \). 

Taking \( x = y = 1 \) in the original equation, we arrive at \( 2f(u) + 2f(v) = f(u + v) + f(u - v) \). 

Taking \( u = 0 \), we get \( f(v) = f(-v) \), indicating that \( f \) is an even function. 

Using parity and taking \( a = u \) and \( b = -v \) in the original equation, we get \( f(u^2 + v^2) = (f(u) + f(v))^2 \). 

This implies \( f(x) > 0 \) for all \( x > 0 \), allowing us to define an auxiliary function \( g \) as \( g(x) = \sqrt{f(x)} \). 

Then, taking \( a = u^2 \) and \( b = v^2 \), the equation rewrites as \( g(a+b) = g(a) + g(b) \). 

This leads us to \( g \) being additive, and therefore, there exists \( m \in \mathbb{N} \) such that \( g(x) = mx \) for all \( x > 0 \). Since \( g(1) = \sqrt{f(1)} = 1 \), we have \( m = 1 \). 

We will prove that \( f \) is increasing on \( [0, \infty) \). Given \( a > b \geq 0 \), we express \( a = u^2 + v^2 \) and \( b = u^2 \) for \( u, v \in \mathbb{R} \). 

Then, \( f(u^2 + v^2) = (f(u) + f(v))^2 = f(u^2) + 2f(uv) + f(v^2) > f(u^2) \), implying \( f(a) > f(b) \), since \( f \) is multiplicative. 

Therefore, the only solutions are \( f(x) = 0 \), \( f(x) = 1/2 \), and \( f(x) = x^2 \), which can be easily verified in the original equation.

If \(f(1)=1\), the value of \(f(70)\) is \(4900\).",4900,algebra
2001p5,"In a triangle \( ABC \), let \( AP \) bisect \( \angle BAC \), with \( P \) on \( BC \), and let \( BQ \) bisect \( \angle ABC \), with \( Q \) on \( CA \).

It is known that \( \angle BAC = 60^\circ \) and that \( AB + BP = AQ + QB \).

Calculate the value of \( \angle ABC \) (in degrees).
","Set: \( \angle ABY = \angle YBC = x \), \( \angle YCB = 120^\circ - 2x \).  
Observe: \( \angle AYB = 120^\circ - x \), \( \angle AXB = 150^\circ - 2x \).  

Using the Law of Sines, we get:
\[
AY = AB \cdot \frac{\sin x}{\sin(120^\circ - x)}, \quad BX = AB \cdot \frac{\sin 30^\circ}{\sin(150^\circ - 2x)}, \quad YB = AB \cdot \frac{\sin 60^\circ}{\sin(120^\circ - x)}.
\]

So, the relation \( AB + BX = AY + AB \) is the same as saying:
\[
1 + \frac{\sin 30^\circ}{\sin(150^\circ - 2x)} = \frac{\sin x + \sin 60^\circ}{\sin(120^\circ - x)}.
\]

We have
\[
\sin x + \sin 60^\circ = 2 \sin\left( \frac{1}{2}(x + 60^\circ) \right) \cos\left( \frac{1}{2}(x - 60^\circ) \right),
\]
\[
\sin(120^\circ - x) = \sin(x + 60^\circ),
\]
\[
\sin(x + 60^\circ) = 2 \sin\left( \frac{1}{2}(x + 60^\circ) \right) \cos\left( \frac{1}{2}(x + 60^\circ) \right).
\]

So,
\[
\frac{\sin x + \sin 60^\circ}{\sin(120^\circ - x)} = \frac{\cos\left( \frac{1}{2}x - 30^\circ \right)}{\cos\left( \frac{1}{2}x + 30^\circ \right)}.
\]

Let \( \frac{1}{2}x = t \).

Then
\[
\frac{\cos(t - 30^\circ)}{\cos(t + 30^\circ)} - 1 = \frac{\cos(t - 30^\circ) - \cos(t + 30^\circ)}{\cos(t + 30^\circ)} = \frac{2 \sin(30^\circ) \sin(t)}{\cos(t + 30^\circ)}.
\]

Hence, the problem is just:
\[
\frac{\sin(30^\circ)}{\sin(150^\circ - 4t)} = \frac{\sin(t)}{\cos(t + 30^\circ)}.
\]

\[
\Rightarrow \cos(t + 30^\circ) = 2 \sin(t) \sin(150^\circ - 4t)
= \cos(5t - 150^\circ) - \cos(150^\circ - 3t).
\]

Now,
\[
\cos(t + 30^\circ) + \cos(5t + 30^\circ) = \cos(3t + 30^\circ).
\]

Because \( \cos(A + B) + \cos(A - B) = 2 \cos A \cos B \), we get:
\[
\cos(t + 30^\circ) + \cos(5t + 30^\circ) = 2 \cos(3t + 30^\circ) \cos(2t),
\]
\[
\Rightarrow (2 \cos(2t) - 1) \cos(3t + 30^\circ) = 0.
\]

This gives \( t = 20^\circ \) or \( 30^\circ \).  
Recall that \( t = \frac{1}{2}x = \frac{1}{4} \angle ABC \).

Here we can see \( \angle ABC \neq 120^\circ \) because of the angle sum property.  
\[
\therefore \angle B = 80^\circ, \quad \angle A = 60^\circ, \quad \angle C = 40^\circ.
\]",80,geometry
2001p6,"Let \( a, b, c, d \) be integers with \( a > b > c > d > 0 \). Suppose that
\[
ac + bd = (b + d + a - c)(b + d - a + c).
\]
Is \( ab + cd \) prime? If the answer is 'Yes', give the value \(1\). Else give \(0\).","The problem condition is equivalent to
\[
ac + bd = (b + d)^2 - (a - c)^2
\]
or
\[
a^2 - ac + c^2 = b^2 + bd + d^2.
\]

Let us construct a quadrilateral \( WXYZ \) such that \( WX = a \), \( XY = c \), \( YZ = b \), \( ZW = d \), and
\[
WY = \sqrt{a^2 - ac + c^2} = \sqrt{b^2 + bd + d^2}.
\]

Then by the law of cosines, we obtain \( \angle WXY = 60^\circ \) and \( \angle WZY = 120^\circ \). Hence this quadrilateral is cyclic.

By the more precise version of Ptolemy’s theorem, we find that
\[
WY^2 = \frac{(ab + cd)(ad + bc)}{ac + bd}.
\]

Now assume for contradiction that \( ab + cd \) is a prime \( p \). Recall that we assumed \( a > b > c > d \). It follows, for example by rearrangement inequality, that
\[
p = ab + cd > ac + bd > ad + bc.
\]

So \( ab + cd \) is not prime.",0,number theory
2000p1,"\( AB \) is tangent to the circles \( CAMN \) and \( NMBD \). \( M \) lies between \( C \) and \( D \) on the line \( CD \), and \( CD \) is parallel to \( AB \). The chords \( NA \) and \( CM \) meet at \( P \); the chords \( NB \) and \( MD \) meet at \( Q \). The rays \( CA \) and \( DB \) meet at \( E \). Prove that \( PE = QE \). Give the value of \( \frac{PE}{QE} \).","\textbf{Lemma:} Given a triangle, \( ABC \) and a point \( P \) in its interior, assume that the circumcircles of \( \triangle ACP \) and \( \triangle ABP \) are tangent to \( BC \). Prove that ray \( AP \) bisects \( BC \).

\textbf{Proof:} Let the intersection of \( AP \) and \( BC \) be \( D \). By power of a point,
\[
BD^2 = AD \cdot PD \quad \text{and} \quad CD^2 = AD \cdot PD,
\]
so \( BD = CD \).

\textbf{Proof of problem:} Let ray \( NM \) intersect \( AB \) at \( X \). By our lemma,  
(\textit{the two circles are tangent to } \( AB \)), \( X \) bisects \( AB \).  
Since \( \triangle NAX \) and \( \triangle NPM \) are similar, and \( \triangle NBX \) and \( \triangle NQM \) are similar, it implies \( MP = PQ \).

Now, \( \angle ABM = \angle BMD \) since \( CD \) is parallel to \( AB \). But \( AB \) is tangent to the circumcircle of \( \triangle BMD \), hence \( \angle ABM = \angle BDM \), and that implies \( \angle BMD = \angle BDM \).  
So \( \triangle BMD \) is isosceles and \( BM = BD \).

By simple parallel line rules, \( \angle EBA = \angle BDM = \angle ABM \).  
Similarly, \( \angle BAM = \angle EAB \), so by ASA criterion, \( \triangle ABM \) and \( \triangle ABE \) are congruent.

We know that \( BE = BM = BD \), so a circle with diameter \( ED \) can be circumscribed around \( \triangle EMD \).  
Join points \( E \) and \( M \), \( EM \) is perpendicular to \( CD \), and previously we proved \( MP = MQ \), hence \( \triangle EPQ \) is isosceles and \( EP = EQ \).

So the value of \( \frac{PE}{QE} \) is \(1\).",1,geometry
2000p4,"100 cards are numbered 1 to 100 (each card different) and placed in 3 boxes (at least one card in each box). How many ways can this be done so that if two boxes are selected and a card is taken from each, then the knowledge of their sum alone is always sufficient to identify the third box?
","Consider \( 1, 2, 3 \). If they are in different boxes, then \( 4 \) must be in the same box as \( 1 \), \( 5 \) in the same box as \( 2 \), and so on. This leads to the solution where all numbers congruent to each other \( \bmod 3 \) are in the same box.

Suppose \( 1 \) and \( 2 \) are in box \( A \) and \( 3 \) in box \( B \). Then \( 4 \) must be in box \( A \) or \( B \). In general, if \( k \geq 4 \) is in either box \( A \) or \( B \), then \( k + 1 \) also must be in box \( A \) or \( B \). Thus box \( C \) is empty which is impossible.

Similarly, it is impossible for \( 1 \) and \( 3 \) to be in box \( A \) and \( 2 \) in box \( B \).

Thus we are left with the case where \( 1 \) is in box \( A \), and \( 2 \) and \( 3 \) in box \( B \). Suppose box \( B \) contains \( 2, \ldots, k \), where \( k \geq 3 \), but does not contain \( k + 1 \) and \( m \) is the smallest number in box \( C \). Then \( m > k \).

If \( m > k + 1 \), then \( k + 1 \) must be box \( A \) and we see that no box can contain \( m - 1 \).

Thus \( m = k + 1 \). If \( k < 99 \), we see that no box can contain \( k + 2 \). Thus \( k = 99 \). It is easy to see that this distribution works. Thus there are altogether \( 12 \) ways — 2 options times permutation of 3 colors for each of 3 boxes.",12,combinatorics
2000p5,"Can we find \( N \) divisible by just 2000 different primes, so that \( N \) divides \( 2^N + 1 \)? \textit{[} \( N \) may be divisible by a prime power. \textit{]}  
If the answer is 'Yes', give the value \(1\). Else give \(0\).
","We say that \( n \) is \emph{Korean} if \( n \mid 2^n + 1 \). First, observe that \( n = 9 \) is Korean. Now, the problem is solved upon the following claim:

\[
\boxed{
\textbf{Claim} \quad \text{If } n > 3 \text{ is Korean, there exists a prime } p \text{ not dividing } n \text{ such that } np \text{ is Korean too}.
}
\]

\textit{Proof.} I claim that one can take any primitive prime divisor \( p \) of \( 2^{2n} - 1 \), which exists by Zsigmondy’s theorem. Obviously \( p \neq 2 \). Then:

\begin{itemize}
    \item Since \( p \nmid 2^{\varphi(n)} - 1 \), it follows then that \( p \nmid n \).
    \item Moreover, \( p \mid 2^n + 1 \) since \( p \nmid 2^n - 1 \).
\end{itemize}

Hence \( np \mid 2^n + 1 \mid 2^{np} + 1 \) by the Chinese Remainder Theorem, since \( \gcd(n, p) = 1 \). \(\square\)

So the answer is 'Yes'. ",1,number theory
1999p2,"Let \( n \) be a fixed integer, with \( n \geq 2 \).

Determine the least constant \( C \) such that the inequality
\[
\sum_{1 \leq i < j \leq n} x_i x_j (x_i^2 + x_j^2) \leq C \left( \sum_{1 \leq i \leq n} x_i \right)^4
\]
holds for all real numbers \( x_1, \cdots, x_n \geq 0 \). For this constant \( C \), determine when equality holds. Give the value of \( 1992C \) as the answer.

","\( C = \frac{1}{8} \), and equality holds exactly when two of the \( x_i \) are equal to each other and all the other \( x_i \) are zero. We prove this by induction on the number of nonzero \( x_i \).

First, suppose that at most two of the \( x_i \), say \( x_a \) and \( x_b \), are nonzero. Then the left-hand side of the desired inequality becomes \( x_a x_b (x_a^2 + x_b^2) \), and the right-hand side becomes \( (x_a + x_b)^4 / 8 \). By AM-GM,
\[
x_a x_b (x_a^2 + x_b^2) = \frac{1}{2} \left[ \sqrt{(2x_a x_b)(x_a^2 + x_b^2)} \right]^2 
\leq \frac{1}{2} \left( \frac{x_a^2 + 2x_a x_b + x_b^2}{2} \right)^2 
= \frac{(x_a + x_b)^4}{8},
\]
with equality exactly when \( x_a = x_b \), as desired.

Now, suppose that our statement holds when at most \( k \) of the \( x_i \) are equal to zero. Suppose now that \( k + 1 \) of the \( x_i \) are equal to zero, for \( k \geq 2 \). \textit{Without loss of generality}, let these be \( x_1 \geq \cdots \geq x_k \geq x_{k+1} \). We define
\[
y_j = 
\begin{cases}
x_j, & j \notin \{k, k+1\} \\
x_k + x_{k+1}, & j = k \\
0, & j = k+1
\end{cases}
\]
and for convenience, we will denote \( S = \sum_{i = 1}^{k-1} x_i \). We wish to show that by replacing the \( x_i \) with the \( y_i \), we increase the left-hand side of the desired inequality without changing the right-hand side; and then to use the inductive hypothesis.

We note that
\[
\sum_{1 \leq i < j \leq n} x_i x_j (x_i^2 + x_j^2)
= \sum_{1 \leq i < j \leq k - 1} x_i x_j (x_i^2 + x_j^2) 
+ \sum_{1 \leq i < k} \left[ x_i x_k (x_i^2 + x_k^2) + x_i x_{k+1}(x_i^2 + x_{k+1}^2) \right]
+ x_k x_{k+1} (x_k^2 + x_{k+1}^2)
\]

\[
= \sum_{1 \leq i < j \leq k - 1} x_i x_j (x_i^2 + x_j^2) 
+ \sum_{i = 1}^{k-1} x_i^2(x_k + x_{k+1}) + S(x_k^3 + x_{k+1}^3).
\]

If we replace \( x \) with \( y \), then \( S(x_k^3 + x_{k+1}^3) + x_k^2 x_{k+1} + x_k x_{k+1}^2 \) becomes
\[
S(x_k + x_{k+1})^3 = S(x_k + x_{k+1})^3 + 3S(x_k^2 x_{k+1} + x_k x_{k+1}^2),
\]
but none of the other terms change. Since \( 3S > 2 \geq a_1 \geq a_k, a_{k+1} \), it follows that we have strictly increased the right-hand side of the equation, i.e.,
\[
\sum_{1 \leq i < j \leq n} x_i x_j (x_i^2 + x_j^2) \leq \sum_{1 \leq i < j \leq n} y_i y_j (y_i^2 + y_j^2).
\]

By inductive hypothesis,
\[
\sum_{1 \leq i < j \leq n} y_i y_j (y_i^2 + y_j^2) \leq \frac{1}{8} \left( \sum_{i = 1}^n y_i \right)^4,
\]
and by our choice of \( y_i \),
\[
\sum_{1 \leq i < j \leq n} x_i x_j (x_i^2 + x_j^2) / 8 = \left( \sum_{i = 1}^n x_i \right)^4 / 8.
\]

Hence the problem's inequality holds by induction, and is strict when there are more than two nonzero \( x_i \), as desired. \(\blacksquare\)

So the value of \(1992C\) is \(249\).",249,algebra
1999p3,"Consider an \( n \times n \) square board, where \( n \) is a fixed even positive integer. The board is divided into \( n^2 \) unit squares. We say that two different squares on the board are adjacent if they have a common side.

\( N \) unit squares on the board are marked in such a way that every square (marked or unmarked) on the board is adjacent to at least one marked square.

Determine the smallest possible value of \( N \). Give the value of the smallest \( N \) when \( n=80 \).
","
Let \( n = 2m \). Color alternate squares black and white (like a chess board). It is sufficient to show that \( \frac{m(m+1)}{2} \) white squares are necessary and sufficient to deal with all the black squares.

This is almost obvious if we look at the diagonals.

Look first at the odd-length white diagonals. In every other such diagonal, mark alternate squares (starting from the border each time), so that \( r+1 \) squares are marked in a diagonal length \( 2r+1 \). Now each black diagonal is adjacent to a picked white diagonal and hence each black square on it is adjacent to a marked white square. In all 
\[
1 + 3 + 5 + \cdots + m - 1 + m + m - 2 + \cdots + 4 + 2 = 1 + 2 + 3 + \cdots + m = \frac{m(m+1)}{2}
\]
white squares are marked. This proves sufficiency.

For necessity, consider the alternate odd-length black diagonals. Rearranging, these have lengths \( 1, 3, 5, \ldots, 2m-1 \). A white square is only adjacent to squares in one of these alternate diagonals and is adjacent to at most 2 squares in it. So we need at least
\[
1 + 2 + 3 + \cdots + m = \frac{m(m+1)}{2}
\]
white squares.

So the answer is \( \frac{n}{2} \left( \frac{n}{2} + 1 \right) = \frac{n(n+2)}{4} \). When \( n=40 \), the answer is \(1640\).",1640,combinatorics
1999p4,"Determine all pairs \( (n, p) \) of positive integers such that
\begin{itemize}
    \item \( p \) is a prime,
    \item \( n \) not exceeded \( 2p \), and
    \item \( (p - 1)^n + 1 \) is divisible by \( n^{p-1} \).
\end{itemize}
If \( n+p<20 \), calculate the sum of the quantity \[ (n+p) \] over every such pair.","Evidently \( (1, p) \) is a solution for every prime \( p \). Assume \( n > 1 \) and take \( q \) to be the smallest prime divisor of \( n \). We show first that \( q = p \).

Let \( x \) be the smallest positive integer for which \( (p - 1)^x \equiv -1 \pmod{q} \), and \( y \) the smallest positive integer for which \( (p - 1)^y \equiv 1 \pmod{q} \). Certainly \( y \) exists and

Indeed \( y < q \), since \( (p - 1)^q - 1 \equiv 1 \pmod{q} \). We know that \( (p - 1)^n \equiv -1 \pmod{q} \), so \( x \) exists also. Writing \( n = sy + r \), with \( 0 \leq r < y \), we conclude that \( (p - 1)^r \equiv -1 \pmod{q} \), and hence \( x \leq r < y \) (r cannot be zero, since \( 1 \not\equiv -1 \pmod{q} \)).

Now write \( n = hx + k \) with \( 0 \leq k < x \). Then
\[
-1 = (p - 1)^n = (-1)^h (p - 1)^k \pmod{q}.
\]
\( h \) cannot be even, because then \( (p - 1)^k = -1 \pmod{q} \), contradicting the minimality of \( x \). So \( h \) is odd and hence \( (p - 1)^k = 1 \pmod{q} \) with \( 0 \leq k < x < y \). This contradicts the minimality of \( y \) unless \( k = 0 \), so \( n = hx \). But \( x < q \), so \( x = 1 \). So \( (p - 1) \equiv -1 \pmod{q} \) and \( p, q \) are primes, so \( q = p \), as claimed.

So \( p \) is the smallest prime divisor of \( n \). We are also given that \( n \leq 2p \). So either \( p = n \), or \( p = 2 \), \( n = 4 \). The latter does not work, so we have shown that \( n = p \). Evidently \( n = p = 2 \) and \( n = p = 3 \) work. Assume now that \( p > 3 \). We show that there are no solutions of this type.

Expand \( (p - 1)^p + 1 \) by the binomial theorem to get (since \( (-1)^p = -1 \)):
\[
1 + (-1) + p^2 - \frac{1}{2}p(p - 1)p^2 + \frac{p(p - 1)(p - 2)}{6}p^3 - \cdots
\]
The terms of the form (binomial coefficient) \( p^i \) with \( i \geq 3 \) are obviously divisible by \( p^3 \), since the binomial coefficients are all integral. Hence the sum is \( p^2 \) plus a multiple of \( p^3 \). So the sum is not divisible by \( p^3 \). But for \( p > 3 \), \( p^{p-1} \) is divisible by \( p^3 \), so it cannot divide \( (p - 1)^p + 1 \), and there are no more solutions.

So the possible pairs are: \( (1, p) \) for any prime \( p \); \( (2, 2) \); \( (3, 3) \).
If \( n+p<20 \), the sum of the quantity \[ (n+p) \] over every such pair is \(75\).",75,number theory
1999p6,"Determine all functions \( f : \mathbb{R} \to \mathbb{R} \) such that
\[
f(x - f(y)) = f(f(y)) + x f(y) + f(x) - 1
\]
for all real numbers \( x, y \). Give the value of \( 1 - f(70) \).
","The answer is \( f(x) = -\frac{1}{2}x^2 + 1 \) which obviously works.

For the other direction, first note that
\[
P(f(y), y) \Rightarrow 2f(f(y)) + f(y)^2 - 1 = f(0).
\]
We introduce the notation \( c = \frac{f(0) - 1}{2} \), and \( S = \text{img } f \). Then the above assertion says
\[
f(s) = -\frac{1}{2}s^2 + (c + 1).
\]
Thus, the given functional equation can be rewritten as
\[
Q(x, s) : f(x - s) = -\frac{1}{2}s^2 + sx + f(x) - c.
\]

\textbf{Claim (Main claim)} — We can find a function \( g : \mathbb{R} \to \mathbb{R} \) such that
\[
f(x - z) = zx + f(x) + g(z). \tag{\(\clubsuit\)}
\]

\textit{Proof.} If \( z \neq 0 \), the idea is to fix a nonzero value \( s_0 \in S \) and then choose \( x_0 \) such that
\[
-\frac{1}{2}s_0^2 + s_0 x_0 - c = z.
\]
Then, \( Q(x_0, s) \) gives a pair \( (u, v) \) with \( u - v = z \).

But now for any \( x \), using \( Q(x + v, u) \) and \( Q(x, -v) \) gives
\[
\begin{aligned}
f(x - z) - f(x) &= f(x - u + v) - f(x) = f(x + v) - f(x + u + v) - \frac{1}{2}u^2 + c \\
&= -vx - \frac{1}{2}v^2 + u(x + v) - \frac{1}{2}u^2 = zx + g(z),
\end{aligned}
\]
where \( g(z) = -\frac{1}{2}(u^2 + v^2) \). \(\square\)

Now, let
\[
h(x) := \frac{1}{2}x^2 + f(x) - (2c + 1),
\]
so \( h(0) = 0 \).

\textbf{Claim} — The function \( h \) is additive.

\textit{Proof.} We just need to rewrite (\(\clubsuit\)). Letting \( x = z \) in (\(\clubsuit\)), we find that actually
\[
g(x) = f(0) - x^2 - f(x).
\]
Using the definition of \( h \) now gives
\[
h(x - z) = h(x) + h(z). \quad \square
\]

To finish, we need to remember that \( f \), hence \( h \), is known on the image
\[
S = \{ f(x) \mid x \in \mathbb{R} \} = \left\{ h(x) - \frac{1}{2}x^2 + (2c + 1) \mid x \in \mathbb{R} \right\}.
\]
Thus, we derive
\[
h\left( h(x) - \frac{1}{2}x^2 + (2c + 1) \right) = -c \quad \forall x \in \mathbb{R}. \tag{\(\heartsuit\)}
\]

We can take the following two instances of (\(\heartsuit\)):
\[
\begin{aligned}
h\left( h(2x) - 2x^2 + (2c + 1) \right) &= -c, \\
h\left( 2h(x) - x^2 + 2(2c + 1) \right) &= -2c.
\end{aligned}
\]
Now subtracting these and using \( 2h(x) = h(2x) \) gives
\[
c = h(-x^2 - (2c + 1)).
\]

Together with \( h \) additive, this implies readily \( h \) is constant. That means \( c = 0 \) and the problem is solved.",2450,algebra
1998p3,"For any positive integer \( n \), let \( d(n) \) denote the number of positive divisors of \( n \) (including 1 and \( n \) itself). Determine all positive integers \( k \) such that 
\[
\frac{d(n^2)}{d(n)} = k
\]
for some \( n \).
If \( k<60 \), calculate the sum of all possible \( k \).","First we must determine general values for \( d(n) \). Let \( n = p_1^{a_1} \cdot p_2^{a_2} \cdots p_c^{a_c} \), if \( d \) is an arbitrary divisor of \( n \) then \( d \) must have the same prime factors of \( n \), each with an exponent \( b_i \leq a_i \), so there are \( a_i + 1 \) choices for each exponent of \( p_i \) in the number \( d \Rightarrow \) there are \( (a_1 + 1)(a_2 + 1) \cdots (a_c + 1) \) such \( d \)

\[
\Rightarrow \quad d(n) = (a_1 + 1)(a_2 + 1)\cdots(a_c + 1)
\]
\[
\Rightarrow \quad \frac{d(n^2)}{d(n)} = \frac{(2a_1 + 1)(2a_2 + 1)\cdots(2a_c + 1)}{(a_1 + 1)(a_2 + 1)\cdots(a_c + 1)}
\]

So we want to find all integers \( k \) that can be represented by the product of fractions of the form \( \frac{2n + 1}{n + 1} \). Obviously \( k \) is odd as the numerator is always odd. It’s possible for \( 1 \) (\(1/1\)) and \( 3 \) (\(5/3 \times 9/5\)), which suggests that it may be possible for all odd integers, which we can show by induction.

\textbf{P(k)}: It's possible to represent \( k \) as the product of fractions \( \frac{2n + 1}{n + 1} \)

Base case: \( k = 1 \): \( \frac{2(0) + 1}{0 + 1} \)

Now assume that for \( k \geq 3 \), it's possible for all odds \( < k \).

Since \( k \) is odd, \( k + 1 = 2^x y \) where \( y \) is odd and \( y < k \)

Let there be a number \( x \) s.t. \( k - y = x \Rightarrow k + 1 = 2^x y \Rightarrow \frac{(2^x - 1)(k - x)}{(2^x - 1)} = k \)

Also consider \( k/y \). It is sufficient to show that \( k/y \) can be represented by a product of fractions of the form \( \frac{2n + 1}{n + 1} \) in order to show \( k \) can be represented by product of fractions \( \frac{2n + 1}{n + 1} \), since \( y \) can be represented in such a manner too.

\[
\frac{k}{y} = \frac{k}{(k - x)} = \frac{1}{(1 - x/k)}
\]

Using our definition of \( k \) in terms of \( x \):

\[
\frac{k}{y} = \frac{1}{(1 - 2^x - x/2^x x + 1)} = \frac{2^x x + 1}{x}
\]

And that is simply the product of fractions: \( \frac{2x + 1}{x} = \frac{2x + 1}{x} = \frac{2^x x + 1}{2^x x} \)

We have shown that \( k/y \) can be written s.t. it's a product of the form \( \frac{2n + 1}{n + 1} \Rightarrow k \) can be written in such a way too.

Hence we have shown that all odds less than \( k \) satisfy \( k \) is true. Since we have shown P(1) is true, it must hence be true for all odd integers.

Therefore, 
\[
\frac{d(n^2)}{d(n)} = k \iff k \text{ is odd}
\]
for some \( n \). I.E. all odd \( k \) satisfy the condition posed in the question. \(\blacksquare\)

If \( k<60 \), the sum of all possible \( k \) is \( 900 \).",900,number theory
1998p4,"Determine all pairs \( (a, b) \) of positive integers such that \( ab^2 + b + 7 \) divides \( a^2b + a + b \).
If \( a+b<200 \), calculate the sum of the quantity \[ (a+b) \] over every such pair.","The answer is \( (7k^2, 7k) \) for all \( k \geq 1 \), as well as \( (11, 1) \) and \( (49, 1) \).

We are given \( xy^2 + y + 7 \mid x^2y + x + y \). Multiplying the right-hand side by \( y \) gives
\[
xy^2 + y + 7 \mid x^2y^2 + xy + y^2
\]
Then subtracting \( x \) times the left-hand side gives
\[
xy^2 + y + 7 \mid y^2 - 7x.
\]

We consider cases based on the sign of \( y^2 - 7x \).

\begin{itemize}
    \item If \( y^2 > 7x \), then \( 0 < y^2 - 7x < xy^2 + y + 7 \), contradiction.
    
    \item If \( y^2 = 7x \), let \( y = 7k \), so \( x = 7k^2 \). Plugging this back in to the original equation reads
    \[
    343k^4 + 7k + 7 \mid 343k^5 + 7k^2 + 7k
    \]
    which is always valid, hence these are all solutions.
    
    \item If \( y^2 < 7x \), then \( |y^2 - 7x| \leq 7x \), so \( y \in \{1, 2\} \).
    
    When \( y = 1 \), we get
    \[
    x + 8 \mid x^2 + x + 1 \iff x + 8 \mid 64 - 8 + 1 = 57.
    \]
    This has solutions \( x = 11 \) and \( x = 49 \).
    
    When \( y = 2 \),
    \[
    4x + 9 \mid 2x^2 + x + 2 \\
    \Rightarrow 4x + 9 \mid 16x^2 + 8x + 16 \\
    \Rightarrow 4x + 9 \mid 81 - 18 + 16 = 79
    \]
    which never occurs.
\end{itemize}

If \( a+b<200 \), the sum of the quantity \[ (a+b) \] over every such pair is \(342\).",342,number theory
1998p6,"Consider all functions \( f \) from the set \( \mathbb{N} \) of all positive integers into itself satisfying 
\[
f(t^2 f(s)) = s(f(t))^2
\]
for all \( s \) and \( t \) in \( \mathbb{N} \). Determine the least possible value of \( f(1998) \).","Let \( f(1) = k \). Then \( f(t^2) = f(t)^2 \) and \( f(f(t)) = k^2t \). Also \( f(kt)^2 = 1 \cdot f(kt)^2 = f(k^2 t^2) = f(t^2 f(f(kt))) = k^2 f(kt)^2 \). Hence \( f(kt) = k f(t) \).

By an easy induction \( k^n f(t^{n+1}) = f(t)^{n+1} \). But this implies that \( k \) divides \( f(t) \). For suppose the highest power of a prime \( p \) dividing \( k \) is \( a > b \), the highest power of \( p \) dividing \( f(t) \). Then \( a > b(1 + 1/n) \) for some integer \( n \). But then \( na > (n+1)b \), so \( k^n \) does not divide \( f(t)^{n+1} \). Contradiction.

Let \( g(t) = f(t)/k \). Then 
\[
f(t^2 f(s)) = f(t^2 k g(s)) = k f(t^2 g(s)) = k^2 g(t^2 g(s)),
\]
whilst \( f(t)^2 = k^2 g(t)^2 \). So \( g(t^2 g(s)) = s g(t)^2 \). Hence \( g \) is also a function satisfying the conditions which evidently has smaller values than \( f \) (for \( k > 1 \)). It also satisfies \( g(1) = 1 \). Since we want the smallest possible value of \( f(1998) \) we may restrict attention to functions \( f \) satisfying \( f(1) = 1 \).

Thus we have \( f(f(t)) = t \) and \( f(t^2) = f(t)^2 \). Hence 
\[
f(st)^2 = f(s^2 t^2) = f(s^2 f(f(t^2))) = f(s)^2 f(t^2) = f(s)^2 f(t)^2.
\]
So \( f(st) = f(s) f(t) \).

Suppose \( p \) is a prime and \( f(p) = m \cdot n \). Then \( f(m) f(n) = f(mn) = f(f(p)) = p \), so one of \( f(m), f(n) = 1 \). But if \( f(m) = 1 \), then \( m = f(f(m)) = f(1) = 1 \). So \( f(p) \) is prime. If \( f(p) = q \), then \( f(q) = p \).

Now we may define \( f \) arbitrarily on the primes subject only to the conditions that each \( f(\text{prime}) \) is prime and that if \( f(p) = q \), then \( f(q) = p \). For suppose that \( s = p_1^{a_1} \ldots p_r^{a_r} \) and that \( f(p_i) = q_i \). If \( t \) has any additional prime factors not included in the \( q_i \), then we may add additional \( p \)'s to the expression for \( s \) so that they are included (taking the additional \( a \)'s to be zero). So suppose \( t = q_1^{b_1} \ldots q_r^{b_r} \). Then 
\[
t^2 f(s) = q_1^{2b_1 + a_1} \ldots q_r^{2b_r + a_r},
\]
and hence 
\[
f(t^2 f(s)) = p_1^{2b_1 + a_1} \ldots p_r^{2b_r + a_r} = s f(t)^2.
\]

We want the minimum possible value of \( f(1998) \). Now \( 1998 = 2 \cdot 3^3 \cdot 37 \), so we achieve the minimum value by taking \( f(2) = 3, f(3) = 2, f(37) = 5 \) (and \( f(5) = 37 \)). This gives \( f(1998) = 3^2 \cdot 5 = 120 \).",120,algebra
1997p2,"The angle at \( A \) is the smallest angle of triangle \( ABC \). The points \( B \) and \( C \) divide the circumcircle of the triangle into two arcs. Let \( U \) be an interior point of the arc between \( B \) and \( C \) which does not contain \( A \). The perpendicular bisectors of \( AB \) and \( AC \) meet the line \( AU \) at \( V \) and \( W \), respectively. The lines \( BV \) and \( CW \) meet at \( T \). Give the value of
\[
\frac{TB + TC}{AU}.
\]
","Extend \( BV \) to meet the circle again at \( X \), and extend \( CW \) to meet the circle again at \( Y \). Then by symmetry (since the perpendicular bisectors pass through the center of the circle) \( AU = BX \) and \( AU = CY \). Also arc \( AX = \) arc \( BU \), and arc \( AY = \) arc \( UC \). Hence arc \( XY = \) arc \( BC \) and so angle \( BYC = \angle XBY \) and hence \( TY = TB \). So \( AU = CY = CT + TY = CT + TB \). the value of \[ \frac{TB + TC}{AU} \] is \(1\).
",1,geometry
1997p4,"An \( n \times n \) matrix whose entries come from the set \( S = \{ 1, 2, \ldots, 2n - 1 \} \) is called a \emph{silver} matrix if, for each \( i = 1, 2, \ldots, n \), the \( i \)th row and the \( i \)th column together contain all elements of \( S \). Is there no silver matrix for \( n = 1997 \)? If the answer is 'Yes', give the value \(1\). Else give \(0\).
","Define a \emph{cross} to be the union of the \( i \)th row and \( i \)th column. Every cell of the matrix not on the diagonal is contained in exactly two crosses, while each cell on the diagonal is contained in one cross.

On the other hand, if a silver matrix existed for \( n = 1997 \), then each element of \( S \) appears in all 1997 crosses. Since 1997 is odd, each number \( s \in S \) must appear on the diagonal an odd number of times. (For example, \( s \) could appear on the diagonal once and off-diagonal 998 times, or on the diagonal three times and off-diagonal 997 times, etc.) In particular, each number \( s \) appears at least once on the diagonal.

However, \( |S| = 3993 \) while there are only 1997 diagonal cells. This is a contradiction.
So the answer is \(0\).",0,combinatorics
1997p5,"Find all pairs \( (a, b) \) of integers \( a, b \geq 1 \) that satisfy the equation
\[
a^{b^2} = b^a.
\]
Calculate the sum of the quantity \[ (a+b) \] over every such pair.","The answer is \( (1,1), (16,2) \) and \( (27,3) \).

We assume \( a, b > 1 \) for convenience. Let \( T \) denote the set of non perfect powers other than 1.

\begin{claim}
Every integer greater than 1 is uniquely of the form \( t^n \) for some \( t \in T, n \in \mathbb{N} \).
\end{claim}

\begin{proof}
Clear.
\end{proof}

Let \( a = s^m, b = t^n \).

\[
s^{m \cdot (t^n)^2} = t^{n \cdot s^m}.
\]

Hence \( s = t \) and we have
\[
m \cdot t^{2n} = n \cdot t^m \implies t^{2n - m} = \frac{n}{m}.
\]

Let \( n = t^\ell m \) and \( 2 \cdot t^\ell m - m = e \), or
\[
e + m = 2t^\ell \cdot m.
\]

We resolve this equation by casework

\begin{itemize}
\item If \( e > 0 \), then \( 2t^\ell \cdot m > 2e \cdot m > e + m \).
\item If \( e = 0 \) we have \( m = n \) and \( m = 2m \), contradiction.
\item If \( e = -1 \) we apparently have
\[
\frac{2}{t} \cdot m = m - 1 \implies m = \frac{t}{t - 2}
\]
so \( (t, m) = (3, 3) \) or \( (t, m) = (4, 2) \).
\item If \( e = -2 \) we apparently have
\[
\frac{2}{t^2} \cdot m = m = m - 2 \implies m = \frac{2}{1 - 2/t^2} = \frac{2t^2}{t^2 - 2}.
\]
This gives \( (t, m) = (2, 2) \).
\item If \( e \le -3 \) then let \( k = -e \ge 3 \), so the equation is
\[
m - k = \frac{2m}{t^k} \iff m = \frac{k \cdot t^k}{t^k - 2} = k + \frac{2k}{t^k - 2}.
\]

However, for \( k \ge 3 \) and \( t \ge 2 \), we always have \( 2k \le t^k - 2 \), with equality only when \( (t, k) = (2,3) \); this means \( m = 4 \), which is not a new solution.
\end{itemize}

So the sum of the quantity \[ (a+b) \] over every such pair is \(50\).",50,number theory
1996p1,"\textbf{We are given a positive integer \( r \) and a rectangular board \( ABCD \) with dimensions \( |AB| = 20, |BC| = 12 \).} The rectangle is divided into a grid of \( 20 \times 12 \) unit squares. The following moves are permitted on the board: one can move from one square to another only if the distance between the centers of the two squares is \( \sqrt{r} \). The task is to find a sequence of moves leading from the square with \( A \) as a vertex to the square with \( B \) as a vertex. Can the task be done when \(r = 97\)? If the answer is 'Yes', give the value \(1\). Else give \(0\).
","If \( r = 97 \), then we must have \( a = 9, b = 4 \). As before, assume we start at \( (0,0) \). A good deal of fiddling around fails to find a solution, so we look for reasons why one is impossible. Call moves which change \( y \) by 4 ``toggle'' moves. Consider the central strip \( y = 4, 5, 6 \) or \( 7 \). Toggle moves must toggle us in and out of the strip. Non-toggle moves cannot be made if we are in the strip and keep us out of it if we are out of it. Toggle moves also change the parity of the \( x \)-coordinate, whereas non-toggle moves do not. Now we start and finish out of the strip, so we need an even number of toggle moves. On the other hand, we start with even \( x \) and end with odd \( x \), so we need an odd number of toggle moves. Hence the task is impossible. So the answer is \(0\).",0,combinatorics
1996p4,"The positive integers \( a \) and \( b \) are such that the numbers \( 15a + 16b \) and \( 16a - 15b \) are both squares of positive integers. What is the least possible value that can be taken on by the smaller of these two squares?","Put \( 15a \pm 16b = m^2 \), \( 16a - 15b = n^2 \). Then 
\[
15m^2 + 16n^2 = 481a = 13 \cdot 37a.
\]
The quadratic residues modulo 13 are 
\[
0, \pm1, \pm3, \pm4,
\]
so the residues of \( 15m^2 \) are 
\[
0, \pm2, \pm5, \pm6,
\]
and the residues of \( 16n^2 \) are 
\[
0, \pm1, \pm3, \pm4.
\]
Hence \( m \) and \( n \) must both be divisible by 13. Similarly, the quadratic residues of 37 are 
\[
0, \pm1, \pm3, \pm4, \pm7, \pm9, \pm10, \pm11, \pm12, \pm16,
\]
so the residues of \( 15m^2 \) are 
\[
0, \pm2, \pm5, \pm6, \pm8, \pm13, \pm14, \pm15, \pm17, \pm18,
\]
and the residues of \( 16n^2 \) are 
\[
0, \pm1, \pm3, \pm4, \pm7, \pm9, \pm10, \pm11, \pm12, \pm16.
\]
Hence \( m \) and \( n \) must both be divisible by 37. Put \( m = 481m' \), \( n = 481n' \), and we get:
\[
a = 481(15m'^2 + 16n'^2).
\]
We also have 
\[
481b = 16m^2 - 15n^2
\]
and hence 
\[
b = 481(16m'^2 - 15n'^2).
\]
The smallest possible solution would come from putting \( m' = n' = 1 \) and indeed that gives a solution.

This solution is straightforward, but something of a slog — all the residues have to be calculated. A more elegant variant is to notice that 
\[
m^4 + n^4 = 481(a^2 + b^2).
\]
Now if \( m \) and \( n \) are not divisible by 13 we have 
\[
m^4 + n^4 \equiv 0 \pmod{13}.
\]
Take \( k \) so that \( km = 1 \pmod{13} \), then 
\[
(nk)^4 \equiv -1 \pmod{13}.
\]
But that is impossible because then \( (nk)^{12} \equiv -1 \pmod{13} \), but \( x^{12} \equiv 1 \pmod{13} \) for all non-zero residues. Hence \( m \) and \( n \) are both divisible by 13. The same argument shows that \( m \) and \( n \) are both divisible by 37.

So the answer is \(481^2=231361\).",231361,number theory
1995p3,"Determine all integers \( n > 3 \) for which there exist \( n \) points \( A_1, \ldots, A_n \) in the plane, no three collinear, and real numbers \( r_1, \ldots, r_n \) such that for \( 1 \leq i < j < k \leq n \), the area of \( \triangle A_iA_jA_k \) is \( r_i + r_j + r_k \). Calculate the sum of all possible \(n\).","The first point to notice is that if no arrangement is possible for \( n \), then no arrangement is possible for any higher integer. Clearly the four points of a square work for \( n = 4 \), so we focus on \( n = 5 \).

If the 5 points form a convex pentagon, then considering the quadrilateral \( A_1A_2A_3A_4 \) as made up of two triangles in two ways, we have that \( r_1 + r_3 = r_2 + r_4 \). Similarly, \( A_5A_1A_2A_3 \) gives \( r_1 + r_3 = r_2 + r_5 \), so \( r_4 = r_5 \).

We show that we cannot have two \( r \)'s equal (whether or not the 4 points form a convex pentagon). For suppose \( r_4 = r_5 \). Then \( A_1A_2A_4 \) and \( A_1A_2A_5 \) have equal area. If \( A_4 \) and \( A_5 \) are on the same side of the line \( A_1A_2 \), then since they must be equal distances from it, \( A_4A_5 \) is parallel to \( A_1A_2 \). If they are on opposite sides, then the midpoint of \( A_4A_5 \) must lie on \( A_1A_2 \). The same argument can be applied to \( A_1 \) and \( A_3 \), and to \( A_2 \) and \( A_3 \). But we cannot have two of \( A_1A_2 \), \( A_1A_3 \) and \( A_2A_3 \) parallel to \( A_4A_5 \), because then \( A_1 \), \( A_2 \) and \( A_3 \) would be collinear. We also cannot have the midpoint of \( A_4A_5 \) lying on two of \( A_1A_2 \), \( A_1A_3 \) and \( A_2A_3 \) for the same reason. So we have established a contradiction. Hence no two of the \( r \)'s can be equal. In particular, this shows that the 5 points cannot form a convex pentagon.

Suppose the convex hull is a quadrilateral. Without loss of generality, we may take it to be \( A_1A_2A_3A_4 \). \( A_5 \) must lie inside one of \( A_1A_2A_4 \) and \( A_2A_3A_4 \). Again without loss of generality we may take it to be the latter, so that \( A_1A_2A_5A_4 \) is also a convex quadrilateral. Then \( r_2 + r_4 = r_1 + r_3 \) and also \( = r_1 + r_5 \). So \( r_3 = r_5 \), giving a contradiction as before.

The final case is the convex hull a triangle, which we may suppose to be \( A_1A_2A_3 \). Each of the other two points divides its area into three triangles, so we have: \( (r_1 + r_2 + r_4) + (r_2 + r_3 + r_4) + (r_3 + r_1 + r_4) = (r_1 + r_2 + r_5) + (r_2 + r_3 + r_5) + (r_3 + r_1 + r_5) \) and hence \( r_4 = r_5 \), giving a contradiction.

So the arrangement is not possible for 5 and hence not for any \( n > 5 \).",4,geometry
1995p4,"Find the maximum value of \( x_0 \) for which there exists a sequence \( x_0, x_1, \ldots, x_{1995} \) of positive reals with \( x_0 = x_{1995} \), such that for \( i = 1, \ldots, 1995 \),
\[
x_{i-1} + \frac{2}{x_{i-1}} = 2x_i + \frac{1}{x_i}.
\]
You should arrive at this number by taking the problem solution modulo \(1000\).","We start by solving for \( x_i \) in the recursive relation:
\[
x_{i-1} + \frac{2}{x_{i-1}} = 2x_i + \frac{1}{x_i}
\]

Multiply through by \( x_{i-1} \cdot x_i \):
\[
x_i(x_{i-1}^2 + 2) = x_{i-1}(2x_i^2 + 1)
\]

Expanding both sides:
\[
x_i x_{i-1}^2 + 2x_i = 2x_{i-1}x_i^2 + x_{i-1}
\]

Rearranging terms:
\[
x_i x_{i-1}^2 - 2x_{i-1}x_i^2 + 2x_i - x_{i-1} = 0
\]

Factoring:
\[
(2x_i - x_{i-1})(1 - x_i x_{i-1}) = 0
\]

So we have two recursive properties:
\[
x_i = \frac{x_{i-1}}{2} \quad \text{or} \quad x_i = \frac{1}{x_{i-1}}
\]

To maximize \( x_0 \), we use \( x_i = \frac{x_{i-1}}{2} \) for \( i = 1 \) to \( 1994 \), and then apply \( x_{1995} = \frac{1}{x_{1994}} \) to complete the cycle \( x_0 = x_{1995} \).

Then:
\[
x_i = \frac{x_0}{2^i} \quad \text{for } 1 \leq i \leq 1994, \quad x_{1995} = \frac{1}{x_{1994}} = \frac{2^{1994}}{x_0}
\]

Setting \( x_0 = x_{1995} \), we get:
\[
x_0 = \frac{2^{1994}}{x_0} \Rightarrow x_0^2 = 2^{1994} \Rightarrow x_0 = \sqrt{2^{1994}} = 2^{997}
\]

\textbf{Final Answer:} \( \boxed{2^{997}} \)

And the answer is \(672\) after taking the problem solution modulo \(1000\).",672,algebra
1994p3,"For any positive integer \( k \), let \( f(k) \) be the number of elements in the set \(\{k+1, k+2, \ldots, 2k\}\) whose base 2 representation has precisely three 1s. Determine all positive integers \( m \) for which there exists exactly one \( k \) with \( f(k) = m \). Calculate the sum of all possible positive integers \( m \) for \( m<100 \).

","For space-time saving we say that a positive integer is a T-number or simply is \( T \) if it has exactly three 1s in its base two representation.

It's easy to see that (one has to place two 1s in the less n-significant bits of a (n+1)-bit number)

\[
f(2^{n}) = \sum_{i=0}^{n-1} i \quad \text{whence} \quad f(2^{n+1}) = f(2^n) + n
\]

Now consider \( k = 2^n + 2 \) with \( n \geq 2 \) and the corresponding set

\[
S(2^n + 2) = \{2^n + 3, \ldots, 2^{n+1} + 1, 2^{n+1} + 2, 2^{n+1} + 3, 2^{n+1} + 4\}
\]

whose subset \( \{2^n + 3, \ldots, 2^{n+1}\} \) contains \( f(2^n) \) T-numbers. Since

\[
S(2^n) = \{2^n + 1, \ldots, 2^{n+1} - 1\} = \{2^n + 1, 2^n + 2, \ldots, 2^{n+1} - 1\}
\]

contains \( f(2^n) \) T-numbers by definition but

\[
\{2^n + 1, 2^n + 2\} \text{ has none. So } S(2^n + 2) = \{2^n + 3, \ldots, 2^{n+1}\} \cup \{2^{n+1} + 1, 2^{n+1} + 2, 2^{n+1} + 3, 2^{n+1} + 4\}
\]

but the last set has the only T-number \( 2^{n+1} + 3 \). We conclude that:

\[
f(2^n + 2) = f(2^n) + 1
\]

Now consider \( k = 2^n + 2^r + 2^s \) with \( n > r > s \geq 0 \) and \( n \geq 2 \). We explicitly calculate \( f(k) \) for such numbers. So we have to calculate how many T-numbers are in the set

\[
S(k) = \{2^n + 2^r + 2^s + 1, \ldots, 2^{n+1} + 2^r + 2^s\}
\]

The T-numbers less than \( 2^{n+1} \) in \( S(k) \) are:

\[
T_1 = \{2^n + 2^j + 2^i : (j = r \lor r > j > s) \land (n > j > r \land j > i > 0)\}
\Rightarrow \#(T_1) = r - s - 1 + \sum_{h=r+1}^{n-1} h
\]

The T-numbers greater than \( 2^{n+1} \) in \( S(k) \) are:

\[
T_2 = \{2^{n+1} + 2^j + 2^i : (j = r+1 \land s + 1 \leq i \leq 0) \lor (r \geq j \geq 1 \land j > i \geq 0)\}
\Rightarrow \#(T_2) = s + 2 + \sum_{h=1}^{r-1} h
\]

Therefore \( S(k) \) contains \( \#(T_1) + \#(T_2) = r - s - 1 + s + 2 + \sum_{h=1}^{r-1} h + \sum_{h=r+1}^{n-1} h = \sum_{h=1}^{n-1} h + r + 1 \) T-numbers and we have:

\[
f(2^n + 2^r + 2^s) = f(2^n) + r + 1 \quad \text{where } r = 1, 2, \ldots, n-1 \text{ and } r > s \geq 0
\]

Summarizing:

\begin{itemize}
    \item \( f(2^{n+1}) = f(2^n) + n \)
    \item \( f(2^n + 2) = f(2^n) + 1 \)
    \item \( f(2^n + 2^r + 2^s) = f(2^n) + r + 1 \quad \text{where } r = 1, 2, \ldots, n-1 \text{ and } r > s \geq 0 \)
\end{itemize}

That’s to say that it takes all the values from \( f(2^n) \) to \( f(2^{n+1}) \) for every \( n \geq 2 \) and then takes any positive integer value since \( f(4) = 1 \) and \( f(2^n) \) becomes arbitrarily large.

By the fact that \( f(2^n + 2^r + 2^s) = f(2^n) + r + 1 \) where \( r = 1, 2, \ldots, n-1 \) and \( r > s \geq 0 \), it follows that each of the values \( f(2^n) + r + 1 \) where \( r = 2, \ldots, n-1 \) come from at least two different \( k \) because there are at least two different choices for \( s \). These values are \( f(2^n) + 3, f(2^n) + 4, \ldots, f(2^{n+1}) - 1 \). Thus the only possible one-from-one values are \( f(2^n) + 1 \) that come from \( k = 2^n + 2 \) and \( f(2^n) + 2 \) that come from \( k = 2^n + 3 \).

If \( k = 2^n + 3 \) we have \( f(k) = f(k-1) + 1 \) because \( k-1 \) is not T and \( 2k + 1 = 2^{n+1} + 7 \) and \( 2k + 2 = 2^{n+1} + 8 \) are not T so \( f \) maps \( 2^n + 3 \) and \( 2^n + 4 \) to \( f(2^n) + 2 \).

If \( k = 2^n + 2 \) then \( f(k+1) = f(k) + 1 > f(k-1) = f(2^n + 1) = f(2^n) \). The function \( f \) is non-decreasing. It is sufficient to prove that \( f(k+1) \geq f(k) + 1 \) but this follows by the fact that if \( k + 1 \) is T then \( 2k + 2 \) is T too. By the monotonicity of \( f \),

\[
f(2^n + 2) = f(2^n) + 1 = \binom{n}{2} + 1 = n(n-1)/2 + 1 \quad \text{with } n \geq 2 \text{ are the only one-from-one values of } f.
\]

So the sum of all possible positive integers \( m \) for \( m<100 \) is \(468\).",468,number theory
1994p4,"Determine all ordered pairs \( (m, n) \) of positive integers such that
\[
\frac{n^3 + 1}{mn - 1}
\]
is an integer.
Calculate the sum of the quantity \[ (m+n) \] over every such pair.","Suppose 
\[
\frac{n^3 + 1}{mn - 1} = k
\]
where \( k \) is a positive integer. Then 
\[
n^3 + 1 = (mn - 1)k
\]
and so it is clear that \( k \equiv -1 \pmod{n} \). So, let \( k = jn - 1 \) where \( j \) is a positive integer. Then we have
\[
n^3 + 1 = (mn - 1)(jn - 1) = mjn^2 - (m + j)n + 1
\]
which by cancelling out the 1s and dividing by \( n \) yields
\[
n^2 = mjn - (m + j)n \Rightarrow n^2 - nmj + mn + j = 0.
\]
The equation 
\[
x^2 - mjx + m + j = 0
\]
is a quadratic. We are given that \( n \) is one of the roots. Let \( p \) be the other root. Note that since \( np = m + j \), we have that \( p \) is an integer, and so from \( np = m + j \) we have that \( p \) is positive.

It is obvious that \( j = m = n = p = 2 \) is a solution. Now, if not, and \( j, m, n, p \) are all greater than 1, we have the inequalities
\[
np > n + p \quad \text{and} \quad mj > m + j
\]
which contradict the equations \( np = m + j \) and \( n + p = mj \). Thus, at least one of \( j, m, n, p \) is equal to 1.

If one of \( m, j \) is 1, without loss of generality assume it is \( j \). Then we have \( np = m + 1 \), \( n + p = m \). That is,
\[
np - n - p = 1 \Rightarrow (n - 1)(p - 1) = 2
\]
which gives the solutions \( (n, p) = (3, 2), (2, 3) \). These give \( m = 5 \), and since we assumed \( j = 1 \), we can also have \( m = 1 \) and \( j = 5 \).

If one of \( n, p \) is 1, without loss of generality assume it is \( p \). Then we have \( n = m + j - 1 \), \( n + 1 = mj \). That is,
\[
mj - m - j = 1 \Rightarrow (m - 1)(j - 1) = 2
\]
which gives possible solutions \( (m, j) = (3, 2), (2, 3) \). These give \( n = 5 \), and since we assumed \( p = 1 \), we can also have \( n = 1 \) and \( p = 5 \).

From these, we have all solutions
\[
(m, n) = (2, 2), (5, 3), (2, 3), (3, 5), (1, 2), (3, 2), (2, 5), (3, 1), (2, 1).
\]
So the sum of the quantity \[ (m+n) \] over every such pair is \(48\).",48,number theory
1994p5,"Let \( S \) be the set of real numbers strictly greater than \( -1 \). Find all functions \( f : S \to S \) satisfying the two conditions:

\begin{enumerate}
    \item \( f(x + f(y) + x f(y)) = y + f(x) + y f(x) \) for all \( x \) and \( y \) in \( S \);
    \item \( \frac{f(x)}{x} \) is strictly increasing on each of the intervals \( -1 < x < 0 \) and \( 0 < x \).
\end{enumerate}

Give the value of \(-1995f(1994)\).","\textbf{The only solution is } \( f(x) = \frac{-x}{x + 1} \).

Setting \( x = y \), we get
\[
f(x + f(x) + x f(x)) = x + f(x) + x f(x).
\]

Therefore, \( f(s) = s \) for \( s = x + f(x) + x f(x) \).

\textit{Note: If we can show that } \( s \) \textit{ is always 0, we will get that } \( x + f(x) + x f(x) = 0 \) \textit{ for all } \( x \in S \) \textit{ and therefore, } \( f(x) = \frac{-x}{x + 1} \).

Let \( f(s) = s \). Setting \( x = y = s \), we get
\[
f(s + f(s) + s f(s)) = f(2s + s^2) = 2s + s^2.
\]

If \( t = 2s + s^2 \), we have \( f(t) = t \) as well.

Consider \( s > 0 \). We get \( t = 2s + s^2 > s \). Since \( \frac{f(x)}{x} \) is strictly increasing for \( x > 0 \) and \( t > s \) in this domain, we must have
\[
\frac{f(t)}{t} > \frac{f(s)}{s},
\]
but since \( f(s) = s \) and \( f(t) = t \), we also have that
\[
\frac{f(s)}{s} = 1 = \frac{f(t)}{t},
\]
which is a contradiction. Therefore \( s \leq 0 \).

Consider \( -1 < s < 0 \). Using a similar argument, we will get that \( t = 2s + s^2 < s \), but also
\[
\frac{f(s)}{s} = 1 = \frac{f(t)}{t},
\]
which is a contradiction.

Hence, \( s \) must be 0. Since \( s = 0 \), we can conclude that \( x + f(x) + x f(x) = 0 \) and therefore,
\[
f(x) = \frac{-x}{x + 1}
\]
for all \( x \).

So the value of \(-1995f(1994)\) is \(1994\).",1994,algebra
1994p6,"Does there exist a set \( A \) of positive integers with the following property: For any infinite set \( S \) of primes there exist two positive integers \( m \in A \) and \( n \notin A \) each of which is a product of \( k \) distinct elements of \( S \) for some \( k \geq 2 \). If the answer is 'Yes', give the value \(1\). Else give \(0\).
","Let the primes be \( p_1 < p_2 < p_3 < \dots \). Let \( A \) consist of all products of \( n \) distinct primes such that the smallest is greater than \( p_n \). For example: all primes except 2 are in \( A \); 21 is not in \( A \) because it is a product of two distinct primes and the smallest is greater than 3.

Now let \( S = \{p_{i_1}, p_{i_2}, \dots\} \) be any infinite set of primes. Assume that \( p_{i_1} < p_{i_2} < \dots \). Let \( n = i_1 \). Then \( p_{i_1}p_{i_2} \dots p_n \) is not in \( A \) because it is a product of \( n \) distinct primes, but the smallest is not greater than \( p_n \). But \( p_{i_2}p_{i_3} \dots p_{n+1} \) is in \( A \), because it is a product of \( n \) distinct primes and the smallest is greater than \( p_n \). But both numbers are products of \( n \) distinct elements of \( S \).",1,number theory
1993p1,"Let \( f(x) = x^n + 5x^{n-1} + 3 \), where \( n > 1 \) is an integer. Can \( f(x) \) be expressed as the product of two nonconstant polynomials with integer coefficients? If the answer is 'Yes', give the value \(1\). Else give \(0\).
","For the sake of contradiction, assume that \( f(x) = g(x)h(x) \) for polynomials \( g(x) \) and \( h(x) \) in \( \mathbb{R} \). Furthermore, let \( g(x) = b_m x^m + b_{m-1} x^{m-1} + \dots + b_1 x + b_0 \) with \( b_i = 0 \) if \( i > m \) and \( h(x) = c_n x^n + c_{n-1} x^{n-1} + \dots + c_1 x + c_0 \) with \( c_i = 0 \) if \( i > n - m \). This gives that
\[
f(x) = \sum_{i=0}^{n} \left( \sum_{j=0}^{i} b_j c_{i-j} \right)x^i.
\]
We have that \( 3 = b_0 c_0 \), or \( 3 \mid b_0 c_0 \). WLOG, let \( 3 \mid b_0 \) (and thus \( 3 \nmid c_0 \)). Since \( b_0 c_1 + b_1 c_0 = 0 \) and 3 divides \( b_0 \) but not \( c_0 \), we need that \( 3 \mid b_1 \). We can keep on going up the chain until we get that \( 3 \mid b_{n-2} \). Then, by equating coefficients once more, we get that
\[
b_0 c_{n-1} + b_1 c_{n-2} + \dots + b_{n-2} c_1 + b_{n-1} c_0 = 5.
\]
Taking the equation modulo 3 gives that \( b_{n-1} c_0 \equiv 2 \pmod{3} \). This implies that \( b_{n-1} \not\equiv 0 \). Thus, the degree of \( g(x) \) is at least \( n - 1 \). However, because \( h(x) \) is a non-constant factor of \( f(x) \), we have that the degree of \( g(x) \) is at most \( n - 1 \). Thus, the degree of \( g(x) \) is \( n - 1 \), implying that the degree of \( h(x) \) is 1.

From this fact, we have that there must exist an integer root of \( f(x) \). However, when \( x \) is an integer,
\[
x^n + 5x^{n-1} \equiv x^{n-2} x (x + 1) \equiv 0 \pmod{2},
\]
meaning \( f(x) \) is odd, so \( x \) cannot be a root of \( f \).

Hence, \( f(x) \) cannot be expressed as \( g(x)h(x) \) for polynomials \( g(x) \) and \( h(x) \) in \( \mathbb{R} \). This means that \( f(x) \) cannot be expressed as the product of two non-constant polynomials with integer coefficients. \qed
",0,algebra
1993p2,Let \( D \) be a point inside acute triangle \( ABC \) such that \( \angle ADB = \angle ACB + \pi/2 \) and \( AC \cdot BD = AD \cdot BC \). Calculate the ratio \( (\frac{AB \cdot CD}{AC \cdot BD})^2 \).,"Let us construct a point \( B' \) satisfying the following conditions: \( B', B \) are on the same side of \( AC \), \( BC = B'C \) and \( \angle BCB' = 90^\circ \).

Hence \( \triangle ADB \sim \triangle ACB' \Rightarrow \frac{AB}{BD} = \frac{AB'}{B'C} \).

Also considering directed angles mod \( 180^\circ \),
\[
\angle CAB' = \angle DAB \Rightarrow \angle CAD = \angle BAB'.
\]

Also, 
\[
\frac{AB'}{AB} = \frac{B'C}{BD} = \frac{BC}{BD} = \frac{AC}{AD} \Rightarrow \triangle ABB' \sim \triangle ADC.
\]

Hence,
\[
\frac{CD}{AC} = \frac{BB'}{AB'}.
\]

Finally, we get:
\[
\frac{AB \cdot CD}{AC \cdot BD} = \frac{BB'}{CB'} = \sqrt{2}.
\]

\bigskip

For the second part, let the tangent to the circle \( (ADC) \) be \( DX \) and the tangent to the circle \( (ADB) \) be \( DY \).

\[
\angle ADX = \angle ACD \quad \text{(tangent-chord theorem)},
\]
\[
\angle YDB = \angle DCB.
\]

Hence,
\[
\angle ADX + \angle YDB = \angle ACB.
\]

We also have
\[
\angle ADB = \angle ACB + 90^\circ,
\]
\[
\Rightarrow \angle ADX + \angle XDY + \angle YDB = \angle ACB + \angle XDY = \angle ACB + 90^\circ.
\]

\[
\Rightarrow \angle XDY = 90^\circ,
\]

which means circles \( (ADC) \) and \( (ADB) \) are orthogonal.",2,geometry
1993p5,"Does there exist a function \( f : \mathbb{N} \to \mathbb{N} \) such that \( f(1) = 2, \; f(f(n)) = f(n) + n \) for all \( n \in \mathbb{N} \), and \( f(n) < f(n+1) \) for all \( n \in \mathbb{N} \)? If the answer is 'Yes', give the value \(1\). Else give \(0\).","Let \( g(n) = \lfloor g^* n + \tfrac{1}{2} \rfloor \). Obviously \( g(1) = 2 \). Also \( g(n+1) = g(n) + 1 \) or \( g(n) + 2 \), so certainly \( g(n+1) > g(n) \).

Consider \( d(n) = g^* \cdot \lfloor g^* n + \tfrac{1}{2} \rfloor + \tfrac{1}{2} - (\lfloor g^* n + \tfrac{1}{2} \rfloor + n) \). We show that it is between 0 and 1. It follows immediately that \( g(g(n)) = g(n) + n \), as required.

Certainly, \( \lfloor g^* n + \tfrac{1}{2} \rfloor > g^* n - \tfrac{1}{2} \), so \( d(n) > 1 - g/2 > 0 \) (the \( n \) term has coefficient \( g^2 - g - 1 \) which is zero). Similarly, \( \lfloor g^* n + \tfrac{1}{2} \rfloor \leq g^* n + \tfrac{1}{2} \), so \( d(n) \leq g/2 < 1 \), which completes the proof.

I originally put up the much clumsier result following:

Take \( n = b_r b_{r-1} \dots b_0 \) in the Fibonacci base. Then \( f(n) = b_r b_{r-1} \dots b_0 0 \). This satisfies the required conditions.

Let us write:

\[
u_0 = 1,\ u_1 = 2,\ \dots,\ u_n = u_{n-1} + u_{n-2},\ \dots
\]

be the Fibonacci numbers. We say \( n = b_r b_{r-1} \dots b_0 \) in the Fibonacci base if \( b_r = 1 \), every other \( b_i = 0 \) or 1, no two adjacent \( b_i \) are non-zero, and \( n = b_r u_r + \dots + b_0 u_0 \). For example, \( 28 = 1001010 \) because \( 28 = 21 + 5 + 2 \).

We have to show that every \( n \) has a unique expression of this type. We show first by induction that it has at least one expression of this type. Clearly that is true for \( n = 1 \). Take \( u_r \) to be the largest Fibonacci number \( \leq n \). Then by induction we have an expression for \( n - u_r \). The leading term cannot be \( u_i \) for \( i > r-2 \), for then we would have \( n \geq u_r + u_{r-1} = u_{r+1} \). So adding \( u_r \) to the expression for \( n - u_r \) gives us an expression of the required type for \( n \), which completes the induction.

We show that \( u_r + u_{r-2} + u_{r-4} + \dots = u_{r+1} - 1 \). Again we use induction. It is true for \( r = 1 \) and 2. Suppose it is true for \( r - 1 \), then:

\[
u_{r+1} + u_{r-1} + \dots = u_{r+2} - 1
\]

and the rest follows. Hence the expression is unique.

It remains to show that \( f \) satisfies the required conditions. Evidently if \( n = 1 = u_0 \), then \( f(n) = u_1 = 2 \), as required. If \( n = u_{a_1} + \dots + u_{a_r} \), then \( f(n) = u_{a_1 + 1} + \dots + u_{a_r + 1} \) and 

\[
f(f(n)) = u_{a_1 + 2} + \dots + u_{a_r + 2}
\]

So 

\[
f(n) + n = (u_{a_1} + u_{a_1 + 1}) + \dots + (u_{a_r} + u_{a_r + 1}) = f(f(n))
\]

So the answer is \(1\).",1,algebra
1992p1,"Find all integers triples \( (a, b, c) \) with \( 1 < a < b < c \) such that
\[
(a - 1)(b - 1)(c - 1)
\]
is a divisor of \( abc - 1 \). Calculate the sum of the quantity \[ (a+b+c) \] over every such triple.","\[
1 < \frac{abc - 1}{(a - 1)(b - 1)(c - 1)} < \frac{abc}{(a - 1)(b - 1)(c - 1)}
\]
\[
1 < \frac{abc - 1}{(a - 1)(b - 1)(c - 1)} < \left( \frac{a}{a - 1} \right) \left( \frac{b}{b - 1} \right) \left( \frac{c}{c - 1} \right)
\]

With \( 1 < a < b < c \) it implies that \( a \geq 2, b \geq 3, c \geq 4 \)

Therefore,
\[
\frac{a}{a - 1} = 1 + \frac{1}{a - 1}
\]

which for \( a \) gives:
\[
\frac{a}{a - 1} \leq 1 + \frac{1}{2 - 1}, \quad \text{which gives:} \quad \frac{a}{a - 1} \leq 2
\]

for \( b \) gives:
\[
\frac{b}{b - 1} \leq 1 + \frac{1}{3 - 1}, \quad \text{which gives:} \quad \frac{b}{b - 1} \leq \frac{3}{2}
\]

for \( c \) gives:
\[
\frac{c}{c - 1} \leq 1 + \frac{1}{4 - 1}, \quad \text{which gives:} \quad \frac{c}{c - 1} \leq \frac{4}{3}
\]

Substituting those inequalities into the original inequality gives:
\[
1 < \frac{abc - 1}{(a - 1)(b - 1)(c - 1)} < (2) \left( \frac{3}{2} \right) \left( \frac{4}{3} \right)
\]
\[
1 < \frac{abc - 1}{(a - 1)(b - 1)(c - 1)} < 4
\]

Since \( \frac{abc - 1}{(a - 1)(b - 1)(c - 1)} \) needs to be integer,

then
\[
\frac{abc - 1}{(a - 1)(b - 1)(c - 1)} = 2 \quad \text{or} \quad \frac{abc - 1}{(a - 1)(b - 1)(c - 1)} = 3
\]

Case 1:
\[
\frac{abc - 1}{(a - 1)(b - 1)(c - 1)} = 2
\]
\[
abc - 1 = 2(a - 1)(b - 1)(c - 1) = 2abc - 2(ab + bc + ac) + 2(a + b + c) - 2
\]

Case 1, subcase \( a = 2 \):
\[
2bc - 1 = 2bc - 2(b + c) + 2 \Rightarrow 2(b + c) = 3 \quad \text{which has no solution because \( 2(b + c) \) is even.}
\]

Case 1, subcase \( a = 3 \):
\[
3bc - 1 = 4bc - 4(b + c) + 4
\]
\[
bc - 4b - 4c + 5 = 0
\]
\[
(b - 4)(c - 4) = 11
\]
\[
b = 4, c = 15 \Rightarrow \text{solution } (a, b, c) = (3, 5, 15)
\]

Case 2:
\[
\frac{abc - 1}{(a - 1)(b - 1)(c - 1)} = 3
\]
\[
abc - 1 = 3(a - 1)(b - 1)(c - 1) = 3abc - 3(ab + bc + ac) + 3(a + b + c) - 3
\]

Case 2, subcase \( a = 2 \):
\[
2bc - 1 = 3bc - 3(b + c) + 3
\]
\[
bc - 3b - 3c + 4 = 0
\]
\[
(b - 3)(c - 3) = 5
\]
\[
b = 4, c = 8 \Rightarrow \text{solution } (a, b, c) = (2, 4, 8)
\]

Case 2, subcase \( a = 3 \):
\[
3bc - 1 = 6bc - 6(b + c) + 6
\]
Since \( (3bc - 1) \mod 3 = -1 \) and \( (6bc - 6(b + c) + 6) \mod 3 = 0 \), then there is no solution for this subcase.

Now we verify our two solutions:

When \( (a, b, c) = (2, 4, 8) \),
\[
abc - 1 = (2)(4)(8) - 1 = 63 \quad \text{and} \quad (a - 1)(b - 1)(c - 1) = (1)(3)(7) = 21
\]
Since 21 is a factor of 63, this solution is correct.

When \( (a, b, c) = (3, 5, 15) \),
\[
abc - 1 = (3)(5)(15) - 1 = 224 \quad \text{and} \quad (a - 1)(b - 1)(c - 1) = (2)(4)(14) = 112
\]
Since 112 is a factor of 224, this solution is also correct.

\textbf{The solutions are: } \( (a, b, c) = (2, 4, 8) \) and \( (a, b, c) = (3, 5, 15) \)

So the sum is \(37\).",37,number theory
1992p2,"Let \( \mathbb{R} \) denote the set of all real numbers. Find all functions \( f : \mathbb{R} \rightarrow \mathbb{R} \) such that
\[
f\left(x^2 + f(y)\right) = y + \left(f(x)\right)^2 \quad \text{for all } x, y \in \mathbb{R}.
\] 
Give the value of  \( f(1992) \).","The first step is to establish that \( f(0) = 0 \). Putting \( x = y = 0 \), and \( f(0) = t \), we get \( f(t) = t^2 \). Also, \( f(x^2 + t) = f(x^2) \), and \( f(f(x)) = x + t^2 \). We now evaluate \( f(t^2 + f(1)^2) \) two ways. First, it is \( f(f(1)^2 + f(t)) = t + (f(f(1)))^2 = t + (1 + t^2)^2 = 1 + t + 2t^2 + t^4 \). Second, it is \( f(t^2 + f(1 + t)) = 1 + t + f(t)^2 = 1 + t + t^4 \). So \( t = 0 \), as required.

It follows immediately that \( f(f(x)) = x \), and \( f(x^2) = f(x)^2 \). Given any \( y \), let \( z = f(y) \). Then \( y = f(z) \), so \( f(x^2 + y) = z + f(x)^2 = f(y) + f(x)^2 \). Now given any positive \( x \), take \( z \) so that \( x = z^2 \). Then \( f(x + y) = f(z^2 + y) = f(y) + f(z)^2 = f(y) + f(z^2) = f(y) + f(x) \). Putting \( y = -x \), we get \( 0 = f(0) = f(x + (-x)) = f(x) + f(-x) \). Hence \( f(-x) = -f(x) \). It follows that \( f(x + y) = f(x) + f(y) \) and \( f(x - y) = f(x) - f(y) \) hold for all \( x, y \).

Take any \( x \). Let \( f(x) = y \). If \( y > x \), then let \( z = y - x \). \( f(z) = f(y - x) = f(y) - f(x) = x - y = -z \). If \( y < x \), then let \( z = x - y \) and \( f(z) = f(x - y) = f(x) - f(y) = y - x = -z \). In either case we get some \( z > 0 \) with \( f(z) = -z < 0 \). But now take \( w \) so that \( w^2 = z \), then \( f(z) = f(w^2) = f(w)^2 \geq 0 \). Contradiction. So we must have \( f(x) = x \).

So the value of \( f(1992) \) is \(1992\).
",1992,algebra
1992p3,"Consider nine points in space, no four of which are coplanar. Each pair of points is joined by an edge (that is, a line segment) and each edge is either colored blue or red or left uncolored. Find the smallest value of \( n \) such that whenever exactly \( n \) edges are colored, the set of colored edges necessarily contains a triangle all of whose edges have the same color.","We show that for \( n = 32 \) we can find a coloring without a monochrome triangle. Take two squares \( R_1R_2R_3R_4 \) and \( B_1B_2B_3B_4 \). Leave the diagonals of each square uncolored, color the remaining edges of \( R \) red and the remaining edges of \( B \) blue. Color blue all the edges from the ninth point \( X \) to the red square, and red all the edges from \( X \) to the blue square. Color \( R_iB_j \) red if \( i \) and \( j \) have the same parity and blue otherwise.

Clearly \( X \) is not the vertex of a monochrome square, because if \( XY \) and \( XZ \) are the same color then \( YZ \) is either uncolored or the opposite color. There is no triangle within the red square or the blue square, and hence no monochrome triangle. It remains to consider triangles of the form \( R_iR_jB_k \) and \( B_iB_jR_k \). But if \( i \) and \( j \) have the same parity, then \( R_iR_j \) is uncolored (and similarly \( B_iB_j \)), whereas if they have opposite parity, then \( R_iB_k \) and \( R_jB_k \) have opposite colors (and similarly \( B_iR_k \) and \( B_jR_k \)).

It remains to show that for \( n = 33 \) we can always find a monochrome triangle. There are three uncolored edges. Take a point on each of the uncolored edges. The edges between the remaining 6 points must all be colored. Take one of these, \( X \). At least 3 of the 5 edges to \( X \), say \( XA, XB, XC \) must be the same color (say red). If \( AB \) is also red, then \( XAB \) is monochrome. Similarly, for \( BC \) and \( CA \). But if \( AB, BC \) and \( CA \) are all blue, then \( ABC \) is monochrome.

So the answer is \(33\).",33,combinatorics
1991p3,"Let \( S = \{1, 2, 3, \ldots, 280\} \). Find the smallest integer \( n \) such that each \( n \)-element subset of \( S \) contains five numbers which are pairwise relatively prime.
","I claim the answer is \( \boxed{217} \). First, let's look at a subset of \( S \) that consists only of multiples of \( 2, 3, 5, 7 \). It is easy to calculate by PIE that the total number of elements in this set is
\[
\left\lfloor \frac{280}{2} \right\rfloor + \left\lfloor \frac{280}{3} \right\rfloor + \left\lfloor \frac{280}{5} \right\rfloor + \left\lfloor \frac{280}{7} \right\rfloor - \left\lfloor \frac{280}{6} \right\rfloor - \left\lfloor \frac{280}{10} \right\rfloor - \left\lfloor \frac{280}{14} \right\rfloor - \left\lfloor \frac{280}{15} \right\rfloor - \left\lfloor \frac{280}{21} \right\rfloor + \cdots = 216.
\]

Now, note that no matter what 5-element subset we consider of this subset we just made, consisting of multiples of \( 2, 3, 5, 7 \), we will always have at least 2 of those elements that exist in the subset that share a factor greater than 1 by the Pigeonhole Principle since \( \left\lfloor \frac{5}{4} \right\rfloor + 1 = 2 \). Thus, we know \( n > 216 \) from this.

We also know that there are 212 composite numbers and 4 prime numbers (obviously just 2, 3, 5, 7) in this subset of \( S \). Now we do casework on the numbers 11, 13 (we don’t have to check higher numbers because remember \( p \leq 16 \)) to find the other composite numbers. We find that all of the numbers 121, 143, 169, 187, 209, 221, 247, 253 fill in the rest of the composite numbers from 1 to 280. This gives a total of 8 numbers when counted. So we can now count up the total as 220 composite numbers, and the remaining must be prime so 59 prime numbers (1 not included as prime or composite).

Now suppose \( X \) is a subset of our set \( S \) such that \( |X| = 217 \). Also suppose that there is no 5-element subset of \( X \) such that all 5 elements are relatively prime to each other. This means we would have to have at most 4 prime numbers and at least 213 composite numbers to make this subset \( X \). This means the set \( S - X \) (everything that is in \( S \) but not in \( X \)) has at most \( 220 - 213 = 7 \) composite numbers.

Now consider the following 8 sets and notice that at least one of these must be a subset of \( X \):

\begin{align*}
&\{2^2, 3^2, 5^2, 7^2, 13^2\} \\
&\{2 \times 31, 3 \times 29, 5 \times 23, 7 \times 19, 11 \times 17\} \\
&\{2 \times 47, 3 \times 43, 5 \times 41, 7 \times 37, 13 \times 19\} \\
&\{2 \times 41, 3 \times 37, 5 \times 31, 7 \times 29, 11 \times 23\} \\
&\{2 \times 23, 3 \times 19, 5 \times 17, 7 \times 13, 11 \times 12\} \\
&\{2 \times 43, 3 \times 41, 5 \times 37, 7 \times 31, 11 \times 13\} \\
&\{2 \times 37, 3 \times 31, 5 \times 29, 7 \times 23, 11 \times 17\} \\
&\{2 \times 29, 3 \times 23, 5 \times 19, 7 \times 17, 11 \times 13\}
\end{align*}

And obviously each of these sets has 5 elements that are all relatively prime numbers, as desired.

So the answer is \( 217 \).",217,number theory
1990p1,"Chords \( AB \) and \( CD \) of a circle intersect at a point \( E \) inside the circle. Let \( M \) be an interior point of the segment \( EB \). The tangent line at \( E \) to the circle through \( D, E, \) and \( M \) intersects the lines \( BC \) and \( AC \) at \( F \) and \( G \), respectively.

If
\[
\frac{AM}{AB} = t,
\]
find
\[
\frac{EG}{EF}
\]
in terms of \( t \). 
Give the value of \[
\frac{EG}{EF}
\] when \(t = 0.9\).","\[
\angle ECF = \angle DCB \text{ (same angle)} = \angle DAB \text{ (ACBD is cyclic)} = \angle MAD \text{ (same angle)}.
\]
Also \( \angle CEF = \angle EMD \) (GE tangent to circle EMD) \( = \angle AMD \) (same angle). So triangles \( \triangle CEF \) and \( \triangle AMD \) are similar.

\[
\angle CEG = 180^\circ - \angle CEF = 180^\circ - \angle EMD = \angle BMD.
\]
Also \( \angle ECG = \angle ACD \text{ (same angle)} = \angle ABD \text{ (BCAD is cyclic)} = \angle MBD \text{ (same angle)}.
\]
So triangles \( \triangle CEG \) and \( \triangle BMD \) are similar.

Hence:
\[
\frac{EF}{CE} = \frac{MD}{AM}, \quad \frac{EG}{CE} = \frac{MD}{BM}, \quad \text{and so dividing,} \quad \frac{EG}{EF} = \frac{AM}{BM} = \frac{t}{1 - t}.
\]

So when \(t = 0.9\), the value of 
\[
\frac{EG}{EF}
\] is \(9\).",9,geometry
1990p3,"Determine all integers \( n > 1 \) such that
\[
\frac{2^n + 1}{n^2}
\]
is an integer. Calculate the sum of all possible \(n\).","Trivially \( n = 1 \) is a solution. Now assume \( n \neq 1 \) and define \( \pi(n) \) to be the smallest prime divisor of \( n \). Let \( \pi(n) = p \neq 2 \). Then we have:
\[
p \mid 2^n + 1 \mid 2^{2n} - 1 \quad \text{and} \quad p \mid 2^{p - 1} - 1
\Rightarrow p \mid 2^{\gcd(2n, p - 1)} - 1
\]

Now if \( r \neq 2 \mid n \), then we can't have \( r \mid p - 1 \) because then \( r \leq p - 1 \), contradiction. Therefore \( r = 2 \) and since \( n \) is odd, \( \gcd(2n, p - 1) = 2 \). Hence:
\[
p \mid 2^2 - 1 \Longrightarrow p = 3
\]

Let \( v_3(n) = k \). By lifting the exponent we must have
\[
v_3(2^n + 1) = 1 + k \geq v_3(n^2) = 2k \Longrightarrow k = 1
\]

Let \( n = 3n_1 \), \( n_1 = 1 \) is a solution (\( 2^3 + 1 = 3^2 = 9 \)). Assume \( n_1 \neq 1 \) and let \( \pi(n_1) = q \neq 3 \). By the Chinese Remainder Theorem, since \( q \neq 3 \), we have:
\[
q \mid 8^{n_1} + 1, \quad 8^{2n_1} - 1, \quad \text{and} \quad 8^{q - 1} - 1
\Rightarrow q \mid \gcd(2n_1, q - 1) = 1 \Rightarrow 63 \Rightarrow q = 7
\]

However,
\[
2^n + 1 \equiv 8^n + 1 \equiv 2 \pmod{7}
\]
contradiction.

The solutions are henceforth \( \boxed{n = 1, 3} \). So the sum is \(4\).
",4,number theory
1990p5,"Given an initial integer \( n_0 > 1 \), two players, \( A \) and \( B \), choose integers \( n_1, n_2, n_3, \ldots \) alternately according to the following rules:

Knowing \( n_{2k} \), \( A \) chooses any integer \( n_{2k+1} \) such that
\[
n_{2k} \leq n_{2k+1} \leq n_{2k}^2.
\]

Knowing \( n_{2k+1} \), \( B \) chooses any integer \( n_{2k+2} \) such that
\[
\frac{n_{2k+1}}{n_{2k+2}}
\]
is a prime raised to a positive integer power.

Player \( A \) wins the game by choosing the number 1990; player \( B \) wins by choosing the number 1. For which \( n_0 \) does:

What is the minimum number  of \(n_0\) that \( A \) have a winning strategy?","If \( n_0 < 6 \), it is clear that \( B \) wins, because \( A \) can only choose numbers with at most 2 prime factors (30 is the smallest with three and \( 30 > 5^3 \)), which \( B \) can either make smaller (choose the lesser of the two) or the number contains one prime factor in which case \( B \) wins. Once \( n_{2k} = 2 \), \( A \) can only choose prime powers, so \( B \) wins.

If \( n_0 = 6, 7 \) it's a draw, because the only numbers that give \( A \) a chance of winning are those with three prime factors (for reasons discussed above). Less than 49, this gives 30 and 42 as the only choices which won't cause \( A \) to lose. However, if \( A \) chooses 30, \( B \) may choose 6, and we have a stalemate. If \( A \) chooses 42, \( B \) may choose 6, and we still have a stalemate.

If \( n_0 \geq 8 \), if \( n_0 \) is less than 45 by choosing (perhaps starting later) \( 3 \times 4 \times 5 \), then \( 3 \times 5 \times 7 \), then \( 2 \times 3 \times 5 \times 7 \), and then \( 3 \times 4 \times 5 \times 7 \), \( A \) can force \( B \) to make \( n_{2k} \geq 60 \) for some \( k \).

If \( 45 \leq n_{2k} \leq 1990 \) for some \( k \), then \( A \) wins (he may pick 1990). If \( n_{2k} > 1990 \), pick the least natural value of \( m \) such that \( 2^m 47 \geq n_{2k} \). The best \( B \) can do is half it, taking it to 
\[
n_{2k+2} = 2^{m - 1}47 < n_{2k}.
\]
However, \( B \) cannot make \( n_{2k+2} \) drop below 45 because 
\[
47 \times 32 < 1990 = 2^m \geq 64.
\]
Thus we will get a descending sequence of integers until we end up with \( 45 \leq n_{2k} \leq 1990 \), at which point \( A \) wins. 
So the answer is \(8\).",8,combinatorics
1989p5,"For each positive integer \(n\), do there exist \(n\) consecutive positive integers
none of which is an integral power of a prime number? If the answer is 'Yes', give the value \(1\). Else give \(0\).","There are at most 
\[
1 + \sqrt[2]{n} + \sqrt[3]{n} + \sqrt[4]{n} + \cdots + \lfloor \log_2(n) \rfloor \sqrt[n]{n} \leq 1 + \sqrt{n} \log_2(n)
\]
'true' powers \( m^k, \, k \geq 2 \) in the set \( \{1, 2, \ldots, n\} \). So when \( p(n) \) gives the amount of 'true' powers \( \leq n \), we get that
\[
\lim_{n \to \infty} \frac{p(n)}{n} = 0.
\]

Since also 
\[
\lim_{n \to \infty} \frac{\pi(n)}{n} = 0,
\]
we get that
\[
\lim_{n \to \infty} \frac{p(n) + \pi(n)}{n} = 0.
\]

Now assume that there is no 'gap' of length at least \( k \) into the set of 'true' powers and the primes. Then this would give that
\[
\frac{p(n) + \pi(n)}{n} \geq \frac{1}{k}
\]
for all \( n \), in contrary to the above (at least this proves a bit more).

\textbf{Edit:} to elementarize the \( \lim\limits_{n \to \infty} \frac{\pi(n)}{n} = 0 \) part: Look \( \bmod (k+1)! \). Then all numbers in the residue classes \( 2, 3, 4, \ldots, k+1 \) are not primes (except the smallest representants sometimes). So when there wouldn't exist a gap of length \( k \), there has to be a 'true' power in each of these gaps of the prime numbers, so at least one power each \( (k+1)! \) numbers, again contradicting 
\[
\lim_{n \to \infty} \frac{p(n)}{n} = 0.
\]

So the answer is \(1\).
",1,number theory
1988p2,"Let \( n \) be a positive integer and let \( A_1, A_2, \ldots, A_{2n+1} \) be subsets of a set \( B \). Suppose that:

\begin{enumerate}
    \item[(a)] Each \( A_i \) has exactly \( 2n \) elements,
    \item[(b)] Each \( A_i \cap A_j \) (for \( 1 \leq i < j \leq 2n+1 \)) contains exactly one element, and
    \item[(c)] Every element of \( B \) belongs to at least two of the \( A_i \).
\end{enumerate}

For which values of \( n \) can one assign to every element of \( B \) one of the numbers 0 and 1 in such a way that \( A_i \) has 0 assigned to exactly \( n \) of its elements? Calculate the sum of all possible value of \(n\) when \(n<100\).","Each of the \( 2n \) elements of \( A_i \) belongs to at least one other \( A_j \) because of (iii). But given another \( A_j \) it cannot contain more than one element of \( A_i \) because of (ii). There are just \( 2n \) other \( A_j \) available, so each must contain exactly one element of \( A_i \). Hence we can strengthen (iii) to: every element of \( B \) belongs to exactly two of the \( A_i \)'s.

This shows that the arrangement is essentially unique. We may call the element of \( B \) which belongs to \( A_i \) and \( A_j \), the pair \( (i,j) \). Then \( A_i \) contains the \( 2n \) elements \( (i,j) \) with \( j \neq i \).

\[
|B| = \frac{1}{2} \times \text{(number of A's)} \times \text{(size of each A)} = \frac{1}{2} \cdot (2n+1) \cdot 2n = n(2n+1)
\]

If the labeling with 0s and 1s is possible, then if we list all the elements in each \( A \), \( n(2n+1) \) out of the \( 2n(2n+1) \) elements must have value 0. But each element appears twice in this list, so \( n(2n+1) \) must be even. Hence \( n \) must be even.

\textit{Next part thanks to Stan Dolan:}

Label \( (i,j) = 0 \) if \( j = i - n/2, i - (n/2 - 1), \ldots, i - 1, i + 1, i + 2, \ldots, i + n/2 \) (working mod \( 2n + 1 \) when necessary). This clearly has the required property.

\textit{My original solution was a pedestrian induction:}

We show by induction that a labeling is always possible for \( n \) even. If \( n = 2 \), there is certainly a labeling. For example, we may assign 0 to \( (1,2), (1,3), (2,4), (3,5), (4,5) \).

Now suppose we have a labeling for \( n \). For \( n + 2 \), we label \( (i,j) = 0 \) if it was labeled 0 for \( n \) or if it is:

\[
(i, 2n+2) \text{ or } (i, 2n+3) \text{ for } i = 1, 2, \ldots, n+1
\]
\[
(i, 2n+4) \text{ or } (i, 2n+5) \text{ for } i = n+2, n+3, \ldots, 2n+1
\]
\[
(2n+2, 2n+3), (2n+3, 2n+5), (2n+4, 2n+5)
\]

For \( i = 1, 2, \ldots, n+1 \), \( A_i \) has elements \( (i,j) \) labeled zero with \( j \leq 2n+1 \) and also \( (i, 2n+2), (i, 2n+3) \), giving \( n + 2 \) in all. For \( i = n+2, n+3, \ldots, 2n+1 \), \( A_i \) has elements \( (i,j) \) labeled zero with \( j \leq 2n+1 \) and also \( (i, 2n+4), (i, 2n+5) \), giving \( n + 2 \) in all.

\( A_{2n+2} \) has the \( n+1 \) elements \( (i, 2n+2) \) with \( i \leq n+1 \) and also \( (2n+2, 2n+4) \), giving \( n + 2 \) in all.

\( A_{2n+3} \) has the \( n+1 \) elements \( (i, 2n+3) \) for \( i \leq n+1 \) and also \( (2n+3, 2n+5) \), giving \( n + 2 \) in all.

\( A_{2n+4} \) has the \( n \) elements \( (i, 2n+4) \) with \( n+2 \leq i \leq 2n+1 \) and also \( (2n+2, 2n+4) \) and \( (2n+4, 2n+5) \), giving \( n + 2 \) in all.

\( A_{2n+5} \) has the \( n \) elements \( (i, 2n+5) \) with \( n+2 \leq i \leq 2n+1 \) and also \( (2n+3, 2n+5) \), \( (2n+4, 2n+5) \), giving \( n + 2 \) in all.

So \( n \) are even. When \(n<100\), the sum of all possible value of \(n\) is \(2450\). ",2450,combinatorics
1988p3,"A function \( f \) is defined on the positive integers by
\[
\begin{aligned}
f(1) &= 1, \quad f(3) = 3, \\
f(2n) &= f(n), \\
f(4n + 1) &= 2f(2n + 1) - f(n), \\
f(4n + 3) &= 3f(2n + 1) - 2f(n),
\end{aligned}
\]
for all positive integers \( n \).

Determine the number of positive integers \( n \), less than or equal to 1988, for which \( f(n) = n \).","\( f(n) \) is always odd. If \( n = b_{r+1}b_r \ldots b_2b_1b_0 \) in binary and \( n \) is odd, so that \( b_{r+1} = b_0 = 1 \), then 
\[
f(n) = b_{r+1}b_1b_2 \ldots b_rb_0.
\]
If \( n \) has \( r+2 \) binary digits with \( r > 0 \), then there are \( 2^{\lfloor (r+1)/2 \rfloor} \) numbers with the central \( r \) digits symmetrical, so that \( f(n) = n \) (because we can choose the central digit and those lying before it arbitrarily, the rest are then determined). Also there is one number with 1 digit (1) and one number with two digits (3) satisfying \( f(n) = 1 \). So we find a total of 
\[
1 + 1 + 2 + 4 + 4 + 8 + 8 + 16 + 16 = 62
\]
numbers in the range 1 to 1023 with \( f(n) = n \). 1988 in binary is \( 11111000011 \). So we also have all 32 numbers in the range 1023 to 2047 except for \( 11111111111 \) and \( 11111011111 \), giving another 30, or \( \boxed{92} \) in total.

It remains to prove the assertions above. \( f(n) \) odd follows by an easy induction.

Next we show that if \( 2^m < 2n+1 < 2^{m+1} \), then
\[
f(2n+1) = f(n) + 2^m.
\]
Again we use induction. It is true for \( m = 1 \) (since \( f(3) = f(1) + 2 \)). So suppose it is true for \( 1, 2, \ldots, m \). Take \( 4n+1 \) so that \( 2^{m+1} < 4n+1 < 2^{m+2} \), then
\[
f(4n+1) = 2f(2n+1) - f(n) = 2(f(n) + 2^m) - f(n) = f(n) + 2^{m+1} = f(2n) + 2^{m+1},
\]
so it is true for \( 4n+1 \). Similarly, if \( 4n+3 \) satisfies \( 2^{m+1} < 4n+3 < 2^{m+2} \), then
\[
f(4n+3) = 3f(2n+1) - 2f(n) = 3(f(n) + 2^m) - 2f(n) = f(n) + 2^{m+1} = f(2n+1) + 2^{m+1},
\]
so it is true for \( 4n+3 \) and hence for \( m+1 \).

Finally, we prove the formula for \( f(2n+1) \). Let \( 2n+1 = b_{r+1}b_r \ldots b_2b_1b_0 \) with \( b_0 = b_{r+1} = 1 \). We use induction on \( r \). So assume it is true for smaller values.

Say \( b_1 = \ldots = b_s = 0 \) and \( b_{s+1} = 1 \) (we may have \( s = 0 \), so that we have simply \( b_1 = 1 \)). Then \( n = b_r \ldots b_1 \) and \( f(n) = b_{r+1}b_{s+2}b_{s+3} \ldots b_{s+1} \) by induction. So 
\[
f(n) + 2^{r+1} = b_{r+1}0 \ldots 0b_{r+s+2}b_{s+2} \ldots b_{s+1},
\]
where the \( r \) zeros are as shown. But we write this as
\[
b_{r+1}0 \ldots 0b_{r+s+2} \ldots b_{s+1},
\]
where \( b_0 = \ldots = b_s = 0 \), and \( b_{s+1} = b_{r+1} = 1 \). But that is the formula for \( f(2n+1) \), so we have completed the induction.

So the answer is \(92\).",92,number theory
1987p2,"In an acute-angled triangle \( ABC \), the interior bisector of the angle \( A \) intersects \( BC \) at \( L \) and intersects the circumcircle of \( ABC \) again at \( N \). From point \( L \), perpendiculars are drawn to \( AB \) and \( AC \), the feet of these perpendiculars being \( K \) and \( M \) respectively. Please calculate the ratio of the areas of the quadrilateral \( AKNM \) and the triangle \( ABC \).","Let \([ ]\) reprensts the area, so \([AKNM]\) represents the of the quadrilateral \( AKNM \).
We are to prove that \([AKNM] = [ABC]\) or equivalently,  
\([ABC] + [BNC] - [KNC] - [BMN] = [ABC]\). Thus, we are to prove that  
\([BNC] = [KNC] + [BMN]\). It is clear that since \(\angle BAN = \angle NAC\), the segments \(BN\) and \(NC\) are equal. Thus, we have  
\[
[BNC] = \frac{1}{2}BN^2 \sin \angle BNC = \frac{1}{2}BN^2 \sin A
\]  
since cyclic quadrilateral \(ABNC\) gives \(\angle BNC = 180^\circ - \angle A\). Thus, we are to prove that  
\[
\frac{1}{2}BN^2 \sin A = [KNC] + [BMN]
\]  
\[
\Leftrightarrow \frac{1}{2}BN^2 \sin A = \frac{1}{2}CN \cdot CK \sin \angle NCA + \frac{1}{2}BN \cdot BM \sin \angle NBA
\]  
\[
\Leftrightarrow BN \sin A = CK \sin \angle NCA + BM \sin \angle NBA
\]

From the fact that \(\angle BNC = 180^\circ - \angle A\) and that \(\triangle BNC\) is isosceles, we find that  
\[
\angle NBC = \angle NCB = \frac{1}{2}A
\]  
So, we have  
\[
BN \cos \frac{1}{2}A = \frac{BC}{2}
\Rightarrow BN = \frac{BC}{2 \cos \frac{1}{2}A}
\]  
So we are to prove that  
\[
\frac{BC \sin A}{2 \cos \frac{1}{2}A} = CK \sin (C + \frac{1}{2}A) + BM \sin (C + \frac{1}{2}A)
\]  
\[
\Leftrightarrow BC \sin \frac{1}{2}A = CK \sin (C + \frac{1}{2}A) + BM \sin (C + \frac{1}{2}A)
\]  
\[
\Leftrightarrow BC = CK (\sin C \cot \frac{1}{2}A + \cos C) + BM (\sin B \cot \frac{1}{2}A + \cos B)
\]

We have \(\sin C = \frac{KL}{CL}, \cos C = \frac{CK}{CL}, \cot \frac{1}{2}A = \frac{AK}{KL}, \sin B = \frac{AM}{LM}, \cos B = \frac{BM}{ML}\)  
and so we are to prove that  
\[
BC = CK \left( \frac{KL}{CL} \cdot \frac{AK}{KL} + \frac{CK}{CL} \right) + BM \left( \frac{LM}{BL} \cdot \frac{AM}{LM} + \frac{BM}{ML} \right)
\]  
\[
\Leftrightarrow BC = CK \left( \frac{AK}{CL} + \frac{CK}{CL} \right) + BM \left( \frac{AM}{BL} + \frac{BM}{ML} \right)
\]  
\[
\Leftrightarrow BC = \frac{CK \cdot AC}{CL} + \frac{BM \cdot AB}{BL}
\]  
\[
\Leftrightarrow BC = AC \cos C + AB \cos B
\]

We shall show that this is true: Let the altitude from \(A\) touch \(BC\) at \(A'\). Then it is obvious that \(AC \cos C = CA'\) and \(AB \cos B = A'B\) and thus  
\[
AC \cos C + AB \cos B = BC.
\]

Thus we have proven that \([AKNM] = [ABC]\).
So the ratio of the areas of the quadrilateral \( AKNM \) and the triangle \( ABC \) is \(1\).",1,geometry
1987p4,"Is there a function \( f \) from the set of non-negative integers into itself such that \( f(f(n)) = n + 1987 \) for every \( n \)? If the answer is 'Yes', give the value \(1\). Else give \(0\).","We prove that if \( f(f(n)) = n + k \) for all \( n \), where \( k \) is a fixed positive integer, then \( k \) must be even. If \( k = 2h \), then we may take \( f(n) = n + h \).

Suppose \( f(m) = n \) with \( m \equiv n \pmod{k} \). Then by an easy induction on \( r \) we find
\[
f(m + kr) = n + kr, \quad f(n + kr) = m + k(r + 1).
\]
We show this leads to a contradiction. Suppose \( m < n \), so \( n = m + ks \) for some \( s > 0 \). Then
\[
f(n) = f(m + ks) = n + ks.
\]
But \( f(n) = m + k \), so \( m = n + k(s - 1) \geq n \). Contradiction.

So we must have \( m \geq n \), so \( m = n + ks \) for some \( s \geq 0 \). But now
\[
f(m + k) = f(n + k(s + 1)) = m + k(s + 2).
\]
But \( f(m + k) = n + k \), so
\[
n = m + k(s + 1) > n. \quad \text{Contradiction}.
\]

So if \( f(m) = n \), then \( m \) and \( n \) have different residues \( \pmod{k} \). Suppose they have \( r_1 \) and \( r_2 \) respectively. Then the same induction shows that all sufficiently large 
\( s \equiv r_1 \pmod{k} \) have \( f(s) \equiv r_2 \pmod{k} \), and that all sufficiently large 
\( s \equiv r_2 \pmod{k} \) have \( f(s) \equiv r_1 \pmod{k} \). Hence if \( m \) has a different residue \( r \pmod{k} \), then \( f(m) \) cannot have residue \( r_1 \) or \( r_2 \). For if \( f(m) \) had residue \( r_1 \), then the same argument would show that all sufficiently large numbers with residue \( r_1 \) had 
\( f(m) \equiv r \pmod{k} \). Thus the residues form pairs, so that if a number is congruent to a particular residue, then \( f \) of the number is congruent to the pair of the residue. But this is impossible for \( k \) odd.

So the answer is \(0\).",0,algebra
1987p5,"Let \( n \) be an integer greater than or equal to \( 3 \). Is there a set of \( n \) points in the plane such that the distance between any two points is irrational and each set of three points determines a non-degenerate triangle with rational area? If the answer is 'Yes', give the value \(1\). Else give \(0\).","Consider the set of points \( S = \{(x, x^2) \mid 1 \leq x \leq n,\, x \in \mathbb{N} \} \) in the \( xy \)-plane.

The distance between any two distinct points \( (x_1, x_1^2) \) and \( (x_2, x_2^2) \) in \( S \) (with \( x_1 \neq x_2 \)) is:
\[
d = \sqrt{(x_1 - x_2)^2 + (x_1^2 - x_2^2)^2} = \sqrt{(x_1 - x_2)^2 + (x_1 - x_2)^2(x_1 + x_2)^2} = |x_1 - x_2| \sqrt{1 + (x_1 + x_2)^2}.
\]

Since \( 1 + (x_1 + x_2)^2 \) is an integer and not a perfect square, \( \sqrt{1 + (x_1 + x_2)^2} \) is irrational.  
Since \( |x_1 - x_2| \) is a non-zero integer, \( d \) is irrational as desired.

All the points in \( S \) lie on the parabola \( y = x^2 \). Thus, it is impossible for any set of three points to be collinear, since no line can intersect a parabola at more than two points. Therefore, any triangle with all vertices in \( S \) must be non-degenerate as desired.

Since all the points in \( S \) are lattice points, by \textit{Pick's Theorem}, the area of any triangle with all vertices in \( S \) must be in the form
\[
A = I + \frac{B}{2} - 1,
\]
where \( I \) and \( B \) are integers. Thus, the area of the triangle must be rational as desired.

So the answer is \(1\).",1,geometry
1986p5,"Find function \( f \), defined on the non-negative real numbers and taking non-negative real values, such that:

\begin{enumerate}[(i)]
    \item \( f(xf(y))f(y) = f(x+y) \) for all \( x, y \geq 0 \),
    \item \( f(2) = 0 \),
    \item \( f(x) \neq 0 \) for \( 0 \leq x < 2 \).
\end{enumerate}

Give the value of \(f(1.9)\).","For all \( x + y \geq 2 \), there exists a nonnegative real \( t \) such that \( t + 2 = x + y \) and
\[
f(x + y) = f(t + 2) = f(tf(2))f(2) = 0.
\]
Hence, \( f(x) = 0 \) for all \( x \geq 2 \).

For \( x < 2 \), take \( 0 = f(2) = f((2 - x) + x) = f((2 - x)f(x))f(x) \). Since \( f(x) \neq 0 \) for \( x < 2 \), then \( f((2 - x)f(x)) = 0 \). Thus, \( (2 - x)f(x) \geq 2 \iff f(x) \geq \frac{2}{2 - x} \) for all \( x < 2 \).

Suppose \( f(a) > \frac{2}{2 - a} \), so that \( f(a) = \frac{2}{2 - a - \epsilon} \) for some \( \epsilon > 0 \) and \( 0 \leq a < 2 \). Then
\[
f\left((2 - a - \epsilon)f(a)\right)f(a) = f(2 - \epsilon).
\]
The left-hand side is equivalent to
\[
f\left(2 - \epsilon\right)f(a) = f(2 - \epsilon),
\]
but the right-hand side is nonzero, since \( 2 - \epsilon < 2 \) and \( f(x) \neq 0 \) for all \( x < 2 \).

Hence, \( f(x) = \frac{2}{2 - x} \) for \( 0 \leq x < 2 \). For \( x + y < 2 \),
\[
f(xf(y))f(y) = f\left(x \cdot \frac{2}{2 - y}\right) \cdot \frac{2}{2 - y}
= \frac{2}{2 - \frac{2x}{2 - y}} \cdot \frac{2}{2 - y}
= \frac{4}{(4 - 2y - 2x)} = \frac{2}{2 - y - x} = f(x + y).
\]

Indeed, \( f(xf(y))f(y) = f(x + y) \), so the desired function is
\[
\boxed{
f(x) =
\begin{cases}
\frac{2}{2 - x}, & 0 \leq x < 2, \\
0, & x \geq 2.
\end{cases}
}
\]

So the answer is \(20\).",20,algebra
1986p6,"One is given a finite set of points in the plane, each point having integer coordinates. Is it always possible to color some of the points in the set red and the remaining points white in such a way that for any straight line \( L \) parallel to either one of the coordinate axes the difference (in absolute value) between the numbers of white point and red points on \( L \) is not greater than 1? If the answer is 'Yes', give the value \(1\). Else give \(0\).","We prove the result by induction on the number \( n \) of points. It is clearly true for \( n = 1 \). Suppose it is true for all numbers less than \( n \). Pick an arbitrary point \( P \) and color it red. Now take a point in the same row and color it white. Take a point in the same column as the new point and color it red. Continue until either you run out of eligible points or you pick a point in the same column as \( P \). The process must terminate because there are only finitely many points. Suppose the last point picked is \( Q \). Let \( S \) be the set of points picked.

If \( Q \) is in the same column as \( P \), then it is colored white (because the “same row” points are all white, and the “same column” points are all red). Now every row and column contains an equal number of red points of \( S \) and of white points of \( S \). By induction we can color the points excluding those in \( S \), then the difference between the numbers of red and white points in each row and column will be unaffected by adding the points in \( S \) and so we will have a coloring for the whole set. This completes the induction for the case where \( Q \) is in the same column as \( P \).

If it is not, then continue the path backwards from \( P \). In other words, pick a point in the same column as \( P \) and color it white. Then pick a point in the same row as the new point and color it red and so on. Continue until either you run out of eligible points or you pick a point to pair with \( Q \). If \( Q \) was picked as being in the same row as its predecessor, this means a point in the same column as \( Q \); if \( Q \) was picked as being in the same column as its predecessor, this means a point in the same row as \( Q \). Again the process must terminate. Suppose the last point picked is \( R \). Let \( S \) be the set of all points picked.

If \( R \) pairs with \( Q \), then we can complete the coloring by induction as before. Suppose \( S \) does not pair with \( Q \). Then there is a line (meaning a row or column) containing \( Q \) and no uncolored points. There is also a line containing \( R \) and no uncolored points. These two lines have an excess of one red or one white. All other lines contain equal number of red and white points of \( S \). Now color the points outside \( S \) by induction. This gives a coloring for the whole set, because no line with a color excess in \( S \) has any points outside \( S \). So we have completed the induction.

So the answer is \(1\).",1,combinatorics
1985p1,"A circle has center on the side \( AB \) of the cyclic quadrilateral \( ABCD \). 
The other three sides are tangent to the circle. Give the value of \( \frac{AD + BC}{AB} \).","Let the circle touch \( AD, CD, BC \) at \( L, M, N \) respectively. Take \( X \) on the line \( AD \) on the same side of \( A \) as \( D \), so that \( AX = AO \), where \( O \) is the center of the circle. Now the triangles \( OLX \) and \( OMC \) are congruent: \( OL = OM \) = radius of circle, \( \angle OLX = \angle OMC = 90^\circ \), and 
\[
\angle OXL = 90^\circ - A/2 = (180^\circ - A)/2 = C/2 \quad \text{(since \( ABCD \) is cyclic)} = \angle OCM.
\]
Hence \( LX = MC \). So \( OA = AL + MC \). Similarly, \( OB = BN + MD \). But \( MC = CN \) and \( MD = DL \) (tangents have equal length), so
\[
AB = OA + OB = AL + LD + CN + NB = AD + BC.
\]

So the value of \( \frac{AD + BC}{AB} \) is \(1\).",1,geometry
1985p5,"A circle with center \( O \) passes through the vertices \( A \) and \( C \) of triangle \( ABC \) and intersects the segments \( AB \) and \( BC \) again at distinct points \( K \) and \( N \), respectively. The circumscribed circles of the triangles \( ABC \) and \( EBN \) intersect at exactly two distinct points \( B \) and \( M \). Calculate the value of the angle \( \angle OMB \) (in degrees).
","The three radical axes of the three circles taken in pairs, \( BM \), \( NK \), and \( AC \) are concurrent. Let \( X \) be the point of intersection. [They cannot all be parallel or \( B \) and \( M \) would coincide.] The first step is to show that \( XMNC \) is cyclic. The argument depends slightly on how the points are arranged. We may have:
\[
\angle XMN = 180^\circ - \angle BMN = \angle BKN = 180^\circ - \angle AKN = \angle ACN = 180^\circ - \angle XCN,
\]
or we may have
\[
\angle XMN = 180^\circ - \angle BMN = 180^\circ - \angle BKN = \angle AKN = 180^\circ - \angle ACN = 180^\circ - \angle XCN.
\]

Now \( XM \cdot XB = XK \cdot XN = XO^2 - ON^2 \). \( BM \cdot BX = BN \cdot BC = BO^2 - ON^2 \), so \( XM \cdot XB - BM \cdot BX = XO^2 - BO^2 \). But \( XM \cdot XB - BM \cdot BX = XB(XM - BM) = (XM + BM)(XM - BM) = XM^2 - BM^2 \). So \( XO^2 - BO^2 = XM^2 - BM^2 \). Hence \( OM \) is perpendicular to \( XB \), or \( \angle OMB = 90^\circ \).
",90,geometry
1984p6,"Let \( a, b, c \) and \( d \) be odd integers such that \( 0 < a < b < c < d \) and \( ad = bc \). If \( a + d = 2^k \) and \( b + c = 2^m \) for some integers \( k \) and \( m \), give the value of \( a \).
","a < c, so \( a(d - c) < c(d - c) \) and hence \( bc - ac < c(d - c) \). So \( b - a < d - c \), or \( a + d > b + c \), so \( k > m \).

\( bc = ad \), so \( b(2^m - b) = a(2^k - a) \). Hence \( b^2 - a^2 = 2^m(b - 2^{k - m}a) \). But \( b^2 - a^2 = (b + a)(b - a) \), and \( (b + a) \) and \( (b - a) \) cannot both be divisible by 4 (since \( a \) and \( b \) are odd), so \( 2^{m-1} \) must divide \( b + a \) or \( b - a \). But if it divides \( b - a \), then \( b - a \geq 2^{m-1} \), so \( b \) and \( c \geq 2^{m-1} \) and \( b + c > 2^m \). Contradiction. Hence \( 2^{m-1} \) divides \( b + a \). If \( b + a \geq 2^m = b + c \), then \( a \geq c \). Contradiction. Hence \( b + a = 2^{m-1} \).

So we have \( b = 2^{m-1} - a, \; c = 2^{m-1} + a, \; d = 2^k - a \). Now using \( bc = ad \) gives: 
\[
2^k a = 2^{2m - 2}.
\]
But \( a \) is odd, so \( a = 1 \).",1,number theory
1983p1,"Find the function \( f \) defined on the set of positive real numbers which take positive real values and satisfy the conditions:

(i) \( f(xf(y)) = y f(x) \) for all positive \( x, y \);

(ii) \( f(x) \to 0 \) as \( x \to \infty \).

Give the value of \(f(0.01\).","Let \( x = y = 1 \) and we have \( f(f(1)) = f(1) \). Now, let \( x = 1, y = f(1) \) and we have
\[
f(f(f(1))) = f(1)f(1) \Rightarrow f(1) = [f(1)]^2 \text{ since } f(1) > 0 \text{ we have } f(1) = 1.
\]

Plug in \( y = x \) and we have \( f(xf(x)) = xf(x) \). If \( a = 1 \) is the only solution to \( f(a) = a \) then we have \( xf(x) = 1 \Rightarrow f(x) = \frac{1}{x} \). We prove that this is the only function by showing that there does not exist any other \( a \):

Suppose there did exist such an \( a \ne 1 \). Then, letting \( y = a \) in the functional equation yields
\[
f(xa) = af(x).
\]
Then, letting \( x = \frac{1}{a} \) yields
\[
f\left(\frac{1}{a}\right)a = \frac{1}{a}.
\]
Notice that since \( a \ne 1 \), one of \( a, \frac{1}{a} \) is greater than 1. Let \( b \) equal the one that is greater than 1. Then, we find similarly (since \( f(b) = b \)) that
\[
f(xb) = bf(x).
\]
Putting \( x = b \) into the equation, yields \( f(b^2) = b^2 \). Repeating this process we find that
\[
f(b^{2^k}) = b^{2^k} \text{ for all natural } k.
\]
But, since \( b > 1 \), as \( k \to \infty \), we have that \( b^{2^k} \to \infty \) which contradicts the fact that \( f(x) \to 0 \) as \( x \to \infty \).

So the value of \(f(0.01\) is \(100\).",100,algebra
1983p2,"Let \( A \) be one of the two distinct points of intersection of two unequal coplanar circles \( C_1 \) and \( C_2 \) with centers \( O_1 \) and \( O_2 \), respectively. One of the common tangents to the circles touches \( C_1 \) at \( P_1 \) and \( C_2 \) at \( P_2 \), while the other touches \( C_1 \) at \( Q_1 \) and \( C_2 \) at \( Q_2 \). Let \( M_1 \) be the midpoint of \( P_1Q_1 \), and \( M_2 \) be the midpoint of \( P_2Q_2 \). Please calculate the value of \( \frac{\angle O_1AO_2}{\angle M_1AM_2} \).","Let \( A \) be one of the two distinct points of intersection of two unequal coplanar circles \( C_1 \) and \( C_2 \) with centers \( O_1 \) and \( O_2 \) respectively. Let \( S \) be such point on line \( O_1O_2 \) so that tangents on \( C_1 \) touches it at \( P_1 \) and \( Q_1 \) and tangents on \( C_2 \) touches it at \( P_2 \) and \( Q_2 \). Let \( M_1 \) be the midpoint of \( P_1Q_1 \) and \( M_2 \) the midpoint of \( P_2Q_2 \). Prove that \( \angle O_1AO_2 = \angle M_1AM_2 \).

\textbf{Proof:} Since \( S \) is image of \( M_1 \) under inversion with respect to circle \( C_1 \) we have:
\[
\angle O_1AM_1 = \angle O_1M_1'A' = \angle O_1SA
\]

Since \( S \) is image of \( M_2 \) under inversion with respect to circle \( C_2 \) we have:
\[
\angle O_2SA = \angle O_2A'S' = \angle O_2AM_2
\]

Image of \( A \) is in both cases \( A \) itself, since it lies on both circles. Since \( \angle O_1SA = \angle O_2SA \) we have:
\[
\angle M_1AO_1 = \angle M_2AO_2
\]

Now:
\[
\angle O_1AO_2 = \angle M_1AM_2 - \angle M_1AO_1 + \angle M_2AO_2 = \angle M_1AM_2
\]

So the value of \( \frac{\angle O_1AO_2}{\angle M_1AM_2} \) is \(1\).",1,geometry
1982p1,"The function \( f(n) \) is defined for all positive integers \( n \) and takes on non-negative integer values. Also, for all \( m, n \)
\[
f(m+n) - f(m) - f(n) = 0 \text{ or } 1
\]
\[
f(2) = 0, \; f(3) > 0, \; \text{and } f(9999) = 3333.
\]
Determine \( f(1982) \).
","We show that \( f(n) = \lfloor n/3 \rfloor \) for \( n \leq 9999 \), where \( \lfloor \cdot \rfloor \) denotes the integral part.

We show first that \( f(3) = 1 \). \( f(1) \) must be 0, otherwise \( f(2) - f(1) - f(1) \) would be negative. Hence \( f(3) = f(2) + f(1) + 0 \) or 1 = 0 or 1. But we are told \( f(3) > 0 \), so \( f(3) = 1 \). It follows by induction that \( f(3n) \geq n \). For \( f(3n+3) = f(3) + f(3n) + 0 \) or 1 = \( f(3n) + 1 \) or 2. Moreover if we ever get \( f(3n) > n \), then the same argument shows that \( f(3m) > m \) for all \( m > n \). But \( f(3 \cdot 3333) = 3333 \), so \( f(3n) = n \) for all \( n \leq 3333 \).

Now \( f(3n+1) = f(3n) + f(1) + 0 \) or 1 = \( n \) or \( n+1 \). But \( 3n+1 = f(9n+3) \geq f(6n+2) + f(3n+1) \geq 3f(3n+1) \), so \( f(3n+1) < n+1 \). Hence \( f(3n+1) = n \). Similarly, \( f(3n+2) = n \). In particular \( f(1982) = 660 \).",660,number theory
1982p5,"The diagonals \( AC \) and \( CE \) of the regular hexagon \( ABCDEF \) are divided by the inner points \( M \) and \( N \), respectively, so that
\[
\frac{AM}{AC} = \frac{CN}{CE} = r.
\]
If \( B, M, \) and \( N \) are collinear, give the value of \( 1983 r^2 \).
 ","O is the center of the regular hexagon. Then we clearly have \( \triangle ABC \cong \triangle COA \cong \triangle EOC \). And therefore we have also obviously \( \triangle ABM \cong \triangle AOM \cong \triangle CON \), as \( \frac{AM}{AC} = \frac{CN}{CE} \). So we have
\[
\angle BMA = \angle AMO = \angle CNO \quad \text{and} \quad \angle NOC = \angle ABM.
\]
Because of \( \angle AMO = \angle CNO \), the quadrilateral \( ONCM \) is cyclic.

\[
\Rightarrow \angle NOC = \angle NMC = \angle BMA.
\]
And as we also have \( \angle NOC = \angle ABM \), we get
\[
\angle ABM = \angle BMA \Rightarrow AB = AM.
\]
And as \( AC = \sqrt{3} \cdot AB \), we get
\[
r = \frac{AM}{AC} = \frac{AB}{\sqrt{3} \cdot AB} = \frac{1}{\sqrt{3}}.
\]

So the value of \( 1983 r^2 \) is \(661\).",661,geometry
1981p3,"Determine the maximum value of \( m^3 + n^3 \), where \( m \) and \( n \) are integers satisfying \( m, n \in \{1, 2, \ldots, 1981\} \) and 
\[
(n^2 - mn - m^2)^2 = 1.
\]
Take the problem solution modulo 1000.","We first observe that since \( \gcd(m, n) = 1 \), \( m \) and \( n \) are relatively prime. In addition, we note that \( n \geq m \), since if we had \( n < m \), then 
\[
n^2 - nm - m^2 = n(n - m) - m^2
\]
would be the sum of two negative integers and therefore less than \(-1\). We now observe
\[
(m + k)^2 - (m + k)m - m^2 = -(m^2 - km - k^2),
\]
i.e., \( (m, n) = (a, b) \) is a solution iff. \( (b, a + b) \) is also a solution. Therefore, for a solution \( (m, n) \), we can perform the Euclidean algorithm to reduce it eventually to a solution \( (1, n) \). It is easy to verify that if \( n \) is a positive integer, it must be either 2 or 1. Thus by trivial induction, all the positive integer solutions are of the form \( (F_n, F_{n+1}) \), where the \( F_i \) are the Fibonacci numbers. Simple calculation reveals 987 and 1597 to be the greatest Fibonacci numbers less than 1981, giving 
\[
987^2 + 1597^2 = 3524578
\]
as the maximal value.

So the answer is \(578\) after taking the problem solution modulo \(1000\).",578,number theory
1981p6,"The function \( f(x, y) \) satisfies  
\begin{align*}
(1)\quad & f(0, y) = y + 1, \\
(2)\quad & f(x + 1, 0) = f(x, 1), \\
(3)\quad & f(x + 1, y + 1) = f(x, f(x + 1, y)),
\end{align*}
for all non-negative integers \( x, y \). Determine \( f(4, 1981) \). You should arrive at this number by taking the problem solution modulo \(1000\).","We can start by creating a list consisting of certain \( x \) and \( y \) values and their outputs.
\[
f(0, 0) = 1, \quad f(0, 1) = 2, \quad f(0, 2) = 3, \quad f(0, 3) = 4, \quad f(0, 4) = 5
\]
This pattern can be proved using induction. After proving, we continue to setting a list when \( x = 2 \).

\[
f(1, 0) = 2, \quad f(1, 1) = 3, \quad f(1, 2) = 4, \quad f(1, 3) = 5, \quad f(1, 4) = 6
\]

This pattern can also be proved using induction. The pattern seems made up of a common difference of 1. Moving on to \( x = 3 \):

\[
f(3, 0) = 5, \quad f(3, 1) = 13, \quad f(3, 2) = 29, \quad f(3, 3) = 61, \quad f(3, 4) = 125
\]

All of the numbers are being expressed in the form of \( 3^a - 3 \) where \( a = y + 3 \). Lastly, where \( x = 4 \), we have:

\[
f(4, 0) = 13, \quad f(4, 1) = 65533, \quad f(4, 2) = {}^5 2, \quad f(4, 3) = {}^6 2, \quad f(4, 4) = {}^7 2
\]

where each term can be represented as \( {}^a 2 \) when \( a = y + 2 \). Here, \( {}^a 2 \) represents tetration or 2 to the power 2 to the power 2 to the power 2... where \( a \) amount of 2s. So therefore the answer is

\[
f(4, 1981) = {2}^{1984} - 3
\]

So the answer is \(813\) after taking the problem solution modulo \(1000\).",813,combinatorics
1979p1,"Let \( p \) and \( q \) be natural numbers such that
\[
\frac{p}{q} = 1 - \frac{1}{2} + \frac{1}{3} - \frac{1}{4} + \cdots - \frac{1}{1318} + \frac{1}{1319}.
\]
What is \(p\) modulo \(1979\).","We first write
\[
\frac{p}{q} = 1 - \frac{1}{2} + \frac{1}{3} - \frac{1}{4} + \cdots - \frac{1}{1318} + \frac{1}{1319}
\]
\[
= 1 + \frac{1}{2} + \cdots + \frac{1}{1319} - 2 \cdot \left( \frac{1}{2} + \frac{1}{4} + \cdots + \frac{1}{1318} \right)
\]
\[
= 1 + \frac{1}{2} + \cdots + \frac{1}{1319} - \left( 1 + \frac{1}{2} + \cdots + \frac{1}{659} \right)
\]
\[
= \frac{1}{660} + \frac{1}{661} + \cdots + \frac{1}{1319}
\]

Now, observe that
\[
\frac{1}{660} + \frac{1}{1319} = \frac{660 + 1319}{660 \cdot 1319} = \frac{1979}{660 \cdot 1319}
\]
and similarly
\[
\frac{1}{661} + \frac{1}{1318} = \frac{1979}{661 \cdot 1318} \quad \text{and} \quad \frac{1}{662} + \frac{1}{1317} = \frac{1979}{662 \cdot 1317}, \quad \text{and so on}.
\]

We see that the original equation becomes
\[
\frac{p}{q} = \frac{1979}{660 \cdot 1319} + \frac{1979}{661 \cdot 1318} + \cdots + \frac{1979}{989 \cdot 990} = 1979 \cdot \frac{r}{s}
\]
where \( s = 660 \cdot 661 \cdots 1319 \) and \( r = \frac{s}{660 \cdot 1319} + \frac{s}{661 \cdot 1318} + \cdots + \frac{s}{989 \cdot 990} \) are two integers.

Finally consider \( p = 1979 \cdot \frac{qr}{s} \), and observe that \( s \nmid 1979 \) because 1979 is a prime, it follows that \( \frac{qr}{s} \in \mathbb{Z} \). Hence we deduce that \( p \) is divisible with 1979. So \(p\) modulo \(1979\) is \(0\).",0,number theory
1979p5,"Find all real numbers \( a \) for which there exist non-negative real numbers \( x_1, x_2, x_3, x_4, x_5 \) satisfying the relations
\[
\sum_{k=1}^{5} k x_k = a, \quad \sum_{k=1}^{5} k^3 x_k = a^2, \quad \sum_{k=1}^{5} k^5 x_k = a^3.
\]
Calculate the sum of all possible \(a\).","Let \(\Sigma_1 = \sum_{k=1}^{5} kx_k\), \(\Sigma_2 = \sum_{k=1}^{5} k^3 x_k\), and \(\Sigma_3 = \sum_{k=1}^{5} k^5 x_k\). For all pairs \(i, j \in \mathbb{Z}\), let
\[
\Sigma(i, j) = i^2 j^2 \Sigma_1 - (i^2 + j^2)\Sigma_2 + \Sigma_3
\]

Then we have on one hand
\[
\Sigma(i, j) = i^2 j^2 \Sigma_1 - (i^2 + j^2)\Sigma_2 + \Sigma_3 = \sum_{k=1}^{5} \left(i^2 j^2 k - (i^2 + j^2)k^3 + k^5\right)x_k
\]
\[
= \sum_{k=1}^{5} k(i^2 j^2 - (i^2 + j^2)k^2 + k^4)x_k
\]

Therefore,
\[
\Sigma(i, j) = \sum_{k=1}^{5} k(k^2 - i^2)(k^2 - j^2)x_k \tag{1}
\]

and on the other hand,
\[
\Sigma(i, j) = i^2 j^2 a - (i^2 + j^2)a^2 + a^3 = a(a - i^2)(a - j^2) \tag{2}
\]

Then from (1) we have
\[
\Sigma(0, 5) = \sum_{k=1}^{5} k^3(k^2 - 25)x_k \leq 0
\]
and from (2)
\[
\Sigma(0, 5) = a^2(a - 25)
\]
so \(a \in [0, 25]\). Besides, we also have from (1)
\[
\Sigma(0, 1) = \sum_{k=1}^{5} k^3(k^2 - 1)x_k \geq 0
\]
and from (2)
\[
\Sigma(0, 1) = a^2(a - 1) \geq 0 \Rightarrow a \notin (0, 1)
\]

and for \(n = 1, 2, 3, 4\)
\[
\Sigma(n, n+1) = \sum_{k=1}^{5} k(k^2 - n^2)(k^2 - (n+1)^2)x_k
\]
where in the right hand we have that
\[
k < n \Rightarrow (k^2 - n^2) < 0, \ (k^2 - (n+1)^2) < 0 \Rightarrow (k^2 - n^2)(k^2 - (n+1)^2) > 0
\]
\[
k = n, n+1 \Rightarrow (k^2 - n^2)(k^2 - (n+1)^2) = 0
\]
\[
k > n \Rightarrow (k^2 - n^2)(k^2 - (n+1)^2) > 0
\]
so
\[
\Sigma(n, n+1) \geq 0
\]

For \(n = 1, 2, 3, 4\), from the latter and (2) we also have
\[
\Sigma(n, n+1) = a(a - n^2)(a - (n+1)^2)) \geq 0 \Rightarrow a \notin (n^2, (n+1)^2)
\]

So we have that
\[
a \in [0, 25] \setminus \bigcup_{n=0}^{4} (n^2, (n+1)^2) = \{0, 1, 4, 9, 16, 25\}
\]

If \(a = k^2\), \(k = 0, 1, 2, 3, 4, 5\) take \(x_k = k\), \(x_j = 0\) for \(j \neq k\). Then \(\Sigma_1 = k^2 = a\), \(\Sigma_2 = k^3 \cdot k = k^4 = a^2\), and \(\Sigma_3 = k^5 \cdot k = k^6 = a^3\).

So the sum is \(55\).",55,algebra
1978p1,"\( m \) and \( n \) are natural numbers with \( 1 \leq m < n \). In their decimal representations, the last three digits of \( 1978^m \) are equal, respectively, to the last three digits of \( 1978^n \). Find \( m \) and \( n \) such that \( m + n \) has its least value, give the value of \(m+n\).
","We have \( 1978^m \equiv 1978^n \pmod{1000} \), or \( 1978^m - 1978^n = 1000k \) for some positive integer \( k \) (if it is not positive just do \( 978^n - 978^m = -1000k \)). Hence \( 978^n \mid 1000k \). So dividing through by \( 978^n \) we get
\[
978^{m-n} - 1 = \frac{1000k}{978^n}.
\]
Observe that \( 2 \mid \text{LHS} \), so \( 2 \mid \text{RHS} \). So since \( 2 \parallel 978^n \), clearly the minimum possible value of \( n \) is 3 (and then \( 489^{n} \mid k \)). We will show later that if \( n \) is minimal then \( m \) is minimal. We have
\[
978^{m-3} - 1 \equiv 0 \pmod{125} \Leftrightarrow 103^{m-3} \equiv 1 \pmod{125}.
\]
Hence,
\[
m - 3 \mid \varphi(125) \Rightarrow m - 3 \mid 100.
\]
Checking by hand we find that only \( m - 3 = 100 \) works (this also shows that minimality of \( m \) depends on \( n \), as claimed above). So \( m = 103 \).

Consequently, \( m + n = 106 \) with \( (m, n) = (103, 3) \).
So the sum is \(106\).",106,number theory
1978p3,"\textbf{1978/3.} The set of all positive integers is the union of two disjoint subsets 
\(\{f(1), f(2), \ldots, f(n), \ldots\}, \{g(1), g(2), \ldots, g(n), \ldots\}\), where
\[
f(1) < f(2) < \cdots < f(n) < \cdots,
\]
\[
g(1) < g(2) < \cdots < g(n) < \cdots,
\]
and
\[
g(n) = f(f(n)) + 1 \quad \text{for all } n \geq 1.
\]
Determine \( f(240) \).","Since the \( n \)-th number missing is \( f(f(n)) + 1 \) and \( f(f(n)) \) is a member of the sequence, it results that there are exactly \( n - 1 \) ""gaps"" less than \( f(f(n)) \), which leads us to:
\[
f(f(n)) = f(n) + n - 1 \tag{*}
\]

Now with a simple induction we can prove that \( f(F_n + 1) = F_{n+1} + f(1) \), where \( F_k \) is the Fibonacci sequence.

Our next step now is to prove that \( f(F_n + x) = F_{n+1} + f(x) \), for all \( x \) with \( 1 \leq x \leq F_{n-1} \) ... and again induction (on \( n \)):

For \( n = 0 \) and \( n = 1 \) it is trivial, and now we suppose that it’s true for \( n - 1 \) and aim to prove that it holds for \( n \); in other words \( P(n - 1) \Rightarrow P(n) \)

(i) If \( x = f(y) \) for some \( y \), then by the inductive assumption and (*) we have:
\[
f(F_n + x) = f(F_n + f(y)) = f(F_{n-1} + f(f(y))) = F_n + f(y) + F_{n-1} + y - 1 = F_{n+1} + f(x)
\]

(ii) If \( x = f(f(y)) + 1 \) is a gap, then \( f(F_n + x - 1) + 1 = F_{n+1} + f(x - 1) + 1 \) is a gap also:
\[
F_{n+1} + f(x) + 1 = F_{n+1} + f(f(f(y))) + 1 = f(F_{n-1} + f(f(y))) + 1 = f(f(F_{n-1} + f(y))) + 1
\]
It follows that:
\[
f(F_n + x) = F_{n+1} + f(x - 1) + 2 = F_{n+1} + 1 + f(x)
\]

Now since we know that each positive integer \( x \) is expressible as: \( x = F_{k_1} + F_{k_2} + \cdots + F_{k_r} \), where \( 0 < k_r \), \( k_i \geq k_{i+1} + 2 \)

We obtain that \( f(x) = F_{k_1 + 1} + \cdots + F_{k_r + 1} \), and now that we have the general form, we particularly calculate for \( f(240) \):

We can write \( 240 = 233 + 5 + 2 \), therefore
\[
f(240) = 377 + 8 + 3 = 388
\]
",388,combinatorics
1977p2,"In a finite sequence of real numbers the sum of any seven successive terms is negative, and the sum of any eleven successive terms is positive. Determine the maximum number of terms in the sequence.","\[
x_1 + \cdots + x_7 < 0,\quad x_8 + \cdots + x_{14} < 0,\quad \text{so } x_1 + \cdots + x_{14} < 0.
\]
But \( x_4 + \cdots + x_{14} > 0 \), so
\[
x_1 + x_2 + x_3 < 0.
\]
Also \( x_5 + \cdots + x_{11} < 0 \) and \( x_1 + \cdots + x_{11} > 0 \), so \( x_4 > 0 \). If there are 17 or more elements, then the same argument shows that \( x_5, x_6, x_7 > 0 \). But
\[
x_1 + \cdots + x_7 < 0,\quad \text{and } x_5 + \cdots + x_{11} < 0,\quad \text{whereas } x_1 + \cdots + x_{11} > 0,
\]
so \( x_5 + x_6 + x_7 < 0 \). Contradiction.

If we assume that there is a solution for \( n = 16 \) and that the sum of 7 consecutive terms is \(-1\) and that the sum of 11 consecutive terms is \(1\), then we can easily solve the equations to get:
\[
5,\, 5,\, -13,\, 5,\, 5,\, 5,\, -13,\, 5,\, 5,\, 5,\, -13,\, 5,\, 5,\, 5,\, -13,\, 5
\]
and we can check that this works for \(16\).
",16,algebra
1977p5,"Let \( a \) and \( b \) be positive integers. When \( a^2 + b^2 \) is divided by \( a + b \), the quotient is \( q \) and the remainder is \( r \). Find all pairs \( (a, b) \) such that \( q^2 + r = 1977 \). Calculate the sum of the quantity \[ (a+b) \] over every such pair.
","Using \( r = 1977 - q^2 \), we have 
\[
a^2 + b^2 = (a + b)q + 1977 - q^2,
\]
or
\[
q^2 - (a + b)q + a^2 + b^2 - 1977 = 0,
\]
which implies
\[
\Delta = 7908 + 2ab - 2(a^2 + b^2) \geq 0.
\]
Using AM-GM inequality and the fact \( a, b > 0 \), we have
\[
3(a + b)^2 \leq 7908 + 8ab \leq 7098 + 8(a + b)^2 / 4,
\]
it follows \( a + b \leq 88 \).

If \( q \leq 43 \), then
\[
r = 1977 - q^2 \geq 128,
\]
contradicting \( r < a + b \leq 88 \). But \( q \leq 44 \) from \( q^2 + r = 1977 \), thus \( q = 44 \). It follows \( r = 41 \), and we get
\[
a^2 + b^2 = 44(a + b) + 41 \Leftrightarrow (a - 22)^2 + (b - 22)^2 = 1009 \in \mathbb{P}.
\]
By Jacobi’s two squares theorem, we infer that \( 15^2 + 28^2 = 1009 \) is the only representation of 1009 as a sum of squares. This forces 
\[
(a, b) = (37, 50),\ (7, 50),
\]
and permutations.

So the sum is \(288\).",288,number theory
1976p1,"In a plane convex quadrilateral of area \(32\), the sum of the lengths of two opposite sides and one diagonal is \(16\). Determine all possible lengths \(L\) of the other diagonal. Give the value of \(L^2\).
","Label the vertices $A$, $B$, $C$, and $D$ in such a way that $AB + BD + DC = 16$, and $\overline{BD}$ is a diagonal.

The area of the quadrilateral can be expressed as $BD \cdot ( d_1 + d_2 ) / 2$, where $d_1$ and $d_2$ are altitudes from points $A$ and $C$ onto $\overline{BD}$. Clearly, $d_1 \leq AB$ and $d_2 \leq DC$. Hence the area is at most $BD \cdot ( AB + DC ) / 2 = BD(16-BD) / 2$.

The quadratic function $f(x)=x(16-x)/2$ has its maximum for $x=8$, and its value is $f(8)=32$.

The area of our quadrilateral is $32$. This means that we must have $BD=8$. Also, equality must hold in both $d_1 \leq AB$ and $d_2 \leq DC$. Hence both $\overline{AB}$ and $\overline{DC}$ must be perpendicular to $\overline{BD}$. And in any such case it is clear from the Pythagorean theorem that $AC = 8\sqrt 2$.

Therefore the other diagonal has only one possible length: $8\sqrt 2$. The value of $L^2$ is $128$.",128,geometry
1976p3,"A rectangular box can be filled completely with unit cubes. If one places as many cubes as possible, each with volume 2, in the box, so that their edges are parallel to the edges of the box, one can fill exactly 40\% of the box. Determine the possible dimensions \( {a,b,c} \) of all such boxes. What is the maximum value of \(a+b+c\).
","We name a,b,c the sides of the parallelepiped, which are positive integers. We also put\begin{align*} x &= \left\lfloor\frac{a}{\sqrt[3]{2}}\right\rfloor \\ y &= \left\lfloor\frac{b}{\sqrt[3]{2}}\right\rfloor \\ z &= \left\lfloor\frac{c}{\sqrt[3]{2}}\right\rfloor \\ \end{align*}It is clear that $xyz$ is the maximal number of cubes with sides of length $\sqrt[3]{2}$ that can be put into the parallelepiped with sides parallels to the sides of the box. Hence the corresponding volume is $V_2=2\cdot xyz$. We need $V_2=0.4\cdot V_1=0.4\cdot abc$, hence\[\frac ax\cdot \frac by\cdot \frac cz=5\ \ \ \ \ \ \ \ (1)\]We give the values of $x$ and $a/x$ for $a=1,\dots ,8$. The same table is valid for $b,y$ and $c,z$.\[\begin{tabular}{|c|c|c|}   \hline   a & x & a/x \\ \hline   1 & 0 & - \\ \hline   2 & 1 & 2 \\ \hline   3 & 2 &  3/2 \\ \hline   4 & 3 & 4/3 \\ \hline   5 & 3 & 5/3 \\ \hline   6 & 4 & 3/2 \\ \hline   7 & 5 & 7/5 \\ \hline   8 & 6 &  4/3 \\   \hline \end{tabular}\]By simple inspection we obtain two solutions of $(1)$: $\{a,b,c\}=\{2,5,3\}$ and $\{a,b,c\}=\{2,5,6\}$. We now show that they are the only solutions.

We can assume $\frac ax\ge \frac by \ge \frac cz$. So necessarily $\frac ax\ge \sqrt[3]{5}$. Note that the definition of $x$ implies\[x< a/\sqrt[3]2 < x+1,\]hence\[\sqrt[3]2< a/x < \sqrt[3]2(1+\frac 1x)\]If $a\ge 4$ then $x\ge 3$ and $\frac ax<\sqrt[3]2(1+\frac 1x)\le \sqrt[3]2(\frac 43)<\sqrt[3]5$ since $2\cdot \frac {4^3}{3^3}<5$. So we have only left the cases $a=2$ and $a=3$. But for $a=3$ we have $a/x=3/2<\sqrt[3]5$ and so necessarily $a=2$ and $a/x=2$. It follows\[\frac by \cdot \frac cz =\frac 52 \ \ \ \ \ \ (2)\]


Note that the definitions of $y,z$ imply\[y< b/\sqrt[3]2 < y+1,\ \  \textrm{and} \ \ z< c/\sqrt[3]2 < z+1.\ \ \ \ (3)\]Moreover we have from (2) and from $b/y\ge c/z$ that\[\frac by \ge \sqrt{5/2}\ \ \ \ \ (4)\]

If $b=2$ then $b/y=2$ and we would have $c/z=5/4<\sqrt[3]2$, which contradicts $(3)$.

On the other hand, if $b>5$ then $y>4$ and $\frac by<\sqrt[3]2(1+\frac 1y)\le \sqrt[3]2(\frac 54)<\sqrt{5/2}$ since $2^2\cdot \frac {5^6}{4^6}<\frac{5^3}{2^3}$ as $5^3<2^7$. So we have only left the cases $b=3,4,5$. But for $b=3$ we have $b/y=3/2<\sqrt{5/2}$ and for $b=4$ we have $b/y=4/3<\sqrt{5/2}$ and so necessarily $b=5$ and $b/y=5/3$ ($>\sqrt{5/2}$)

So we arrive finally at $a=2,b=5$ and $c/z=3/2$. If $c\ge 8$ then $z\ge 6$ and $\frac cz<\sqrt[3]2(1+\frac 1z)\le \sqrt[3]2(\frac 76)<\frac 32$ since $2\cdot \frac {7^3}{6^3}<\frac{3^3}{2^3}$. On the other hand, for $c\le 7$ there are the only two possible values $c=3$ and $c=6$ which yield the known solutions.

So the maximum value of $a+b+c$ is $13$.
",13,combinatorics
1976p4,"Determine, with proof, the largest number which is the product of positive integers whose sum is 1976. You should arrive at this number by taking the problem solution modulo \(1000\).","There cannot be any integers larger than 4 in the maximal product, because for \( n > 4 \), we can replace \( n \) by 3 and \( n - 3 \) to get a larger product. There cannot be any 1s, because there must be an integer \( r > 1 \) (otherwise the product would be 1) and \( r + 1 > 1 \cdot r \). We can also replace any 4s by two 2s, leaving the product unchanged. Finally, there cannot be more than two 2s, because we can replace three 2s by two 3s to get a larger product. Thus the product must consist of 3s, and either zero, one, or two 2s. The number of 2s is determined by the remainder on dividing the number 1976 by 3.

\[
1976 = 3 \cdot 658 + 2,
\]
so there must be just one 2, giving the product 
\[
2 \cdot 3^{658}.
\]
After taking the problem solution modulo \(1000\), the answer is \(378\).",378,number theory
1976p6,"A sequence \( \{u_n\} \) is defined by
\[
u_0 = 2, \quad u_1 = \frac{5}{2}, \quad u_{n+1} = u_n(u_{n-1}^2 - 2) - u_1 \quad \text{for } n = 1, 2, \ldots
\]

For positive integer \( n=20 \), calculate the value of \( \left\lfloor u_{20} \right\rfloor \) where \( \lfloor x \rfloor \) denotes the greatest integer \( \leq x \). 
","Let the sequence $(x_n)_{n \geq 0}$ be defined as \[ x_{0}=0,x_{1}=1, x_{n}=x_{n-1}+2x_{n-2} \] We notice\[x_n=\frac{2^n-(-1)^n}{3}\]Because the roots of the characteristic polynomial $x_{n}=x_{n-1}+2x_{n-2}$ are $-1$ and $2$. \newline We also see $\frac{2^1-(-1)^1}{3}=1=x_1$, $\frac{2^2-(-1)^2}{3}=1=x_2$ We want to prove\[2^{x_{n}-2x_{n-1}}+2^{-x_{n}+2x_{n-1}}=2^{x_1}+2^{-x_1}\]This is done by induction

Base Case: For $n=1$ ses det $2^{1-0}+2^{0-1}=2^{1}+2^{-1}$

Inductive step: Assume $2^{x_{n-1}-2x_{n-2}}+2^{-x_{n-1}+2x_{n-2}}=2^{x_1}+2^{-x_1}$ We notice\begin{align*}  2^{x_{n}-2x_{n-1}}+2^{-x_{n}+2x_{n-1}} &=2^{x_{n-1}+2x_{n-2}-2x_{n-1}}+2^{-(x_{n-1}+2x_{n-2})+2x_{n-1}}\\ &=2^{-x_{n-1}+2x_{n-2}}+2^{x_{n-1}-2x_{n-2}}\\ &=2^{x_1}+2^{-x_1} \end{align*}We then want to show\[u_n=2^{x_n}+2^{-x_n}\]This can be done using induction

Base Case

For $n=1$, it is clear that\[u_1=\frac{5}{2}\]and\[2^{x_1}+2^{-x_1}=2^1+2^{-1}=2+\frac{1}{2}=\frac{5}{2}\]Therefore, the base case is proved.

Inductive Step

Assume for all natural $k<n$ at $u_k=2^{x_k}+2^{-x_k}$

Then we have that:\begin{align*}  u_n &=  u_{n}(u_{n-1}^{2}-2)-u_{1} \\   &=  (2^{x_{n-1}}+2^{-x_{n-1}})((2^{x_{n-2}}+2^{-x_{n-2}})^2-2)-(2^{x_{1}}+2^{-x_{0}}) \\  &= (2^{x_{n-1}}+2^{-x_{n-1}})((2^{x_{n-2}})^2+(2^{-x_{n-2}})^2+2*2^{x_{n-2}}*2^{-x_{n-2}}-2)-(2^{x_{1}}+2^{-x_{0}}) \\  &=(2^{x_{n-1}}+2^{-x_{n-1}})((2^{2x_{n-2}})+(2^{-2x_{n-2}})+2*2^{x_{n-2}-x_{n-2}}-2)-(2^{x_{1}}+2^{-x_{0}}) \\  &=(2^{x_{n-1}}+2^{-x_{n-1}})((2^{2x_{n-2}})+(2^{-2x_{n-2}})+2-2)-(2^{x_{1}}+2^{-x_{0}}) \\ &=2^{x_{n-1}}*2^{2x_{n-2}}+2^{-x_{n-1}}2^{-2x_{n-2}}+2^{x_{n-1}}*2^{-2x_{n-2}}+2^{-x_{n-1}}*2^{2x_{n-2}}-2^{x_{1}}-2^{-x_{0}}\\ &=2^{x_{n-1}+2x_{n-2}}+2^{-(x_{n-1}+2x_{n-2}})+2^{x_{n-1}-2x_{n-2}}+2^{-x_{n-1}+2x_{n-2}}-2^{x_{1}}-2^{-x_{0}}\\ &=2^{x_{n}}+2^{-x_{n}}+2^{x_{n-1}-2x_{n-2}}+2^{-x_{n-1}+2x_{n-2}}-2^{x_{1}}-2^{-x_{0}} \end{align*}

From our first induction proof we have that:\[2^{x_{n-1}-2x_{n-2}}+2^{-x_{n-1}+2x_{n-2}}=2^{x_1}+2^{-x_1}\]

Then:\[u_n=2^{x_n}+2^{-x_n}+2^{x_1}+2^{-x_1}-(2^{x_1}+2^{-x_1})=2^{x_n}+2^{-x_n}\]

We notice $\left[u_n\right]=\left[2^{x_n}+2^{-x_n}\right]=2^{x_n}$, Because $2^{x_n} \in \mathbb{N}$ and $2^{-x_n}<1$, for all $n>0$ Finally we conclude\[\left[u_n\right]=2^{\frac{2^n-(-1)^n}{3}}\]

When $n=20$, the answer is $8192$.",8192,algebra
1975p3,"On the sides of an arbitrary triangle $ABC$, triangles $ABR, BCP, CAQ$ are 
constructed externally with $\angle CBP = \angle CAQ = 45^\circ$, 
$\angle BCP = \angle ACQ = 30^\circ$, $\angle ABR = \angle BAR = 15^\circ$. 
Calculate the value of $\angle QRP = 90 $ (in degrees).
","Trigonometry provides a routine solution. Let $BC = a$, $CA = b$, $AB = c$. Then, by the sine rule applied to AQC, $AQ = b/(2 \sin 105^\circ) = b/(2 \cos 15^\circ)$. Similarly, $PB = a/(2 \cos 15^\circ)$. Also $AR = RB = c/(2 \cos 15^\circ)$. So by the cosine rule 
\[
RP^2 = \frac{(a^2 + c^2 - 2ac \cos(B + 60^\circ))}{(4 \cos^2 15^\circ)}, \quad \text{and} \quad RQ^2 = \frac{(b^2 + c^2 - 2bc \cos(A + 60^\circ))}{(4 \cos^2 15^\circ)}.
\]
So $RP = RQ$ is equivalent to: 
\[
a^2 - 2ac \cos(60^\circ + B) = b^2 - 2bc \cos(60^\circ + A)
\]
and hence to 
\[
a^2 - ac \cos B + \sqrt{3}ac \sin B = b^2 - bc \cos A + \sqrt{3}bc \sin A.
\]
By the sine rule, the sine terms cancel. Also $b - b \cos A = a \cos C$, and $a - c \cos B = b \cos C$, so the last equality is true and hence $RP = RQ$. We get an exactly similar expression for $PQ^2$ and show that it equals $2\,RP^2$ in the same way.

A more elegant solution is to construct $S$ on the outside of $AB$ so that $ABS$ is equilateral. Then we find that $CAS$ and $QAR$ are similar and that $CBS$ and $PBR$ are similar. So $QR/CS = PR/CS$. The ratio of the sides is the same in each case ($CA/QA = CB/PB$ since $CQA$ and $CPB$ are similar), so $QR = PR$. Also there is a $45^\circ$ rotation between $QAR$ and $CAS$ and another $45^\circ$ rotation between $CBS$ and $PBR$, hence $QR$ and $PR$ are at $90^\circ$.
",90,geometry
1975p4,"When $4444^{4444}$ is written in decimal notation, the sum of its digits is $A$. Let $B$ be the sum of the digits of $A$. Find the sum of the digits of $B$. ($A$ and $B$ are written in decimal notation.)","Note that\[4444^{4444}<10000^{4444}=\left(10^4\right)^{4444}=10^{17776}\]

Therefore $4444^{4444}$ has fewer than 17776 digits. This shows that $A<9\cdot 17776=159984$. The sum of the digits of $A$ is then maximized when $A=99999$, so $B\leq 45$. Note that out of all of the positive integers less than or equal to 45, the maximal sum of the digits is 12.

It's not hard to prove that any base-10 number is congruent to the sum of its digits modulo 9. Therefore $4444^{4444}\equiv A\equiv B(\bmod{9})$. This motivates us to compute $X$, where $1\leq X \leq 12$, such that $4444^{4444}\equiv X(\bmod{9})$. The easiest way to do this is by searching for a pattern. Note that

\[4444^1\equiv 7(\bmod 9)\\4444^2\equiv 4(\bmod 9)\\4444^3\equiv 1(\bmod 9)\]

and since $4444=3\times 1481+1$,

\[4444^{4444}\equiv 4444^{3\times1481+1}\equiv \left(4444^3\right)^{1481}\times 4444\equiv 1\times 4444\equiv 7(\bmod{9})\]

Thus, $X=7$, which means that the sum of the digits of $B$ is $\boxed{7}$.",7,number theory
1975p6,"Find all polynomials $P$, in two variables, with the following properties:

(i) for a positive integer $n$ and all real $t, x, y$\[P(tx, ty) = t^nP(x, y)\](that is, $P$ is homogeneous of degree $n$),

(ii) for all real $a, b, c$,\[P(b + c, a) + P(c + a, b) + P(a + b, c) = 0,\]

(iii)\[P(1, 0) = 1.\]

Give the value of $P(15, 5)$ when $n=4$","$F(a,a,a) \implies P(2a,a)=0 \implies (x-2y)$ is a factor of $P(x,y)$.

We may write $P(x,y)=(x-2y)Q(x,y)$

$F(a,b,b) \implies 2P(a+b,b)+P(2b,a)=0 \implies 2(a+b-2b)Q(a+b,b)+2(b-a)Q(2b,a) \implies (a-b)(Q(a+b,b)-Q(2b,a))=0$ Thus $Q(a+b,b)=Q(2b,a) \forall a \neq b$

We may rewrite it as $Q(x,y)=Q(2y,x-y)=Q(2x-2y,3y-x=\cdots$ $Q(x+d,y-d)-Q(x,y)$ is a polynomial in $d$ of degree $n-1$ for any two fixed $x,y$,which has infinitely many zeroes,i.e,$0,2y-x,x-2y,6y-3x,\cdots$.Thus $Q(x+d,y-d)=Q(x,y)$ holds for all $d$.In particular it holds for $d=y$,i.e, $Q(x+y,0)=Q(x,y)$.Now consider the polynomial $R(x,y)=Q(x+y,0)-Q(x,y)$.Suppose that its not the zero polynomial.Then its degree $d$ is defined.With $t=\frac{x}{y}$ it can be wriiten as $y^dS(t)=y^d(A(t)-B(t))$.But $S(t)$ has infinitely many zeroes and this forces $A(t)=B(t)$,forcing $R(x,y)$ to be a zero polynomial.Contradiction!.Thus $Q(x+y,0)$ and $Q(x,y)$ are identical polynomials.This forces $Q(x,y)=c(x+y)^{n-1}$.With $Q(1,0)=1$ we get $c=1$.Thus\[P(x,y)=(x-2y)(x+y)^{n-1}\]

So the value of $P(15, 5)$ when $n=4$ is $40000$.
",40000,algebra
1974p5,"Three players $A, B$ and $C$ play the following game: On each of three cards an integer is written. These three numbers $p, q, r$ satisfy $0 < p < q < r$. The three cards are shuffled and one is dealt to each player. Each then receives the number of counters indicated by the card he holds. Then the cards are shuffled again; the counters remain with the players.

This process (shuffling, dealing, giving out counters) takes place for at least two rounds. After the last round, $A$ has 20 counters in all, $B$ has 10 and $C$ has 9. At the last round $B$ received $r$ counters. Who received $q$ counters on the first round? If the answer is $A$, give the value $1$. If the answer is $B$, give the value $2$. If the answer is $C$, give the value $3$.","Let $n$ be the number of rounds played, then obviously $n (p + q + r) = 20 + 10 + 9 = 39$. So $n$ must be a divisor of 39, i. e. $n \in \{ 1, 3, 13, 39 \}$. But $p \geq 1,$ $q \geq p + 1 \geq 2,$ $r \geq q + 1 \geq 3,$ so $p + q + r \geq 1 + 2 + 3 = 6$ and $n = \frac{39}{p + q + r} \leq \frac{39}{6} < 7$. Also, by condition $n \geq 2,$ so we conclude to $n = 3$ and $p + q + r = \frac{39}{n} = 13$.

As $B$ received 10 counters including $r$ counters at the last round, $10 \geq p + p + r \geq 2 + r,$ so $r \leq 8$. On the other hand, from number of counters received by $A$ we get $r > \frac{20}{3} > 6$. So $r \in \{ 7, 8 \}$.

If $r = 7,$ from number of counters received by $B$ we get $3 = 10 - r \in \{ 2p, p + q, 2q \},$ and since 3 is odd, we get $p + q = 3$. But then $p + q + r = 3 + 7 = 10 \neq 13$ - a contradiction.

So $r = 8$ and $2 = 10 - r \in \{ 2p, p + q, 2q \}$. On the other hand, $2 \leq 2p < p + q < 2q,$ so $2 = 2p,$ $p = 1$ and $q = 13 - p - r = 4$. It is easy to check that the only way to distribute the counters for players is $20 = r + r + q,$ $10 = p + p + r$ and $9 = q + q + p,$ so player $C$ received $q$ counters on the first round.

So the answer is $3$.",3,combinatorics
1973p3,"Let $a$ and $b$ be real numbers for which the equation $x^4 + ax^3 + bx^2 + ax + 1 = 0$ has at least one real solution. For all such pairs $(a, b)$, find the minimum value of $100(a^2 + b^2)$.","Substitute $z=x+1/x$ to change the original equation into $z^2+az+b-2=0$. This equation has solutions $z=\frac{-a \pm \sqrt{a^2+8-4b}}{2}$. We also know that $|z|=|x+1/x| \geq 2$. So,

\[\left | \frac{-a \pm \sqrt{a^2+8-4b}}{2} \right | \geq 2\]

\[\frac{|a|+\sqrt{a^2+8-4b}}{2} \geq 2\]

\[|a|+\sqrt{a^2+8-4b} \geq 4\]

Rearranging and squaring both sides,

\[a^2+8-4b \geq a^2-16|a|+16\]

\[2|a|-b \geq 2\]

So, $a^2+b^2 \geq a^2+(2-2|a|)^2 = 5a^2-8|a|+4 = 5(|a|-\frac{4}{5})^2+\frac{4}{5}$.

Therefore, the smallest possible value of $a^2+b^2$ is $\frac{4}{5}$, when $a=\pm \frac{4}{5}$ and $b=\frac{-2}{5}$.

So the minimum value of $100(a^2 + b^2)$ is $80$.",80,algebra
1972p4,"Find all solutions $(x_1, x_2, x_3, x_4, x_5)$ of the system of inequalities
\[
\begin{aligned}
(x_1^2 - x_3x_5)(x_2^2 - x_3x_5) &\leq 0 \\
(x_2^2 - x_4x_1)(x_3^2 - x_4x_1) &\leq 0 \\
(x_3^2 - x_5x_2)(x_4^2 - x_5x_2) &\leq 0 \\
(x_4^2 - x_1x_3)(x_5^2 - x_1x_3) &\leq 0 \\
(x_5^2 - x_2x_4)(x_1^2 - x_2x_4) &\leq 0
\end{aligned}
\]
where $x_1, x_2, x_3, x_4, x_5$ are positive real numbers. Give the value of 
\[
\frac{x_1+x_2+x_3}{x_3+x_4+x_5}.
\]
","The difficulty with this problem is that it has more information than we need. There is a neat solution in Greitzer which shows that all we need is the sum of the 5 inequalities, because one can rewrite that as 
\[
(x_1 x_2 - x_1 x_4)^2 + (x_2 x_3 - x_2 x_5)^2 + \dots + (x_5 x_1 - x_5 x_3)^2 + (x_1 x_3 - x_1 x_5)^2 + \dots + (x_5 x_2 - x_5 x_4)^2 \leq 0.
\]
The difficulty is how one ever dreams up such an idea!

The more plodding solution is to break the symmetry by taking $x_1$ as the largest. If the second largest is $x_2$, then the first inequality tells us that $x_1^2$ or $x_2^2 = x_3 x_5$. But if $x_3$ and $x_5$ are unequal, then the larger would exceed $x_1$ or $x_2$. Contradiction. Hence $x_3 = x_5$ and also equals $x_2$ or $x_1$. If they equal $x_1$, then they would also equal $x_2$ (by definition of $x_2$), so in any case they must equal $x_2$. Now the second inequality gives $x_2 = x_1 x_4$. So either all the numbers are equal, or $x_1 > x_2 = x_3 = x_5 > x_4$. But in the second case the last inequality is violated. So the only solution is all numbers equal.

If the second largest is $x_5$, then we can use the last inequality to deduce that $x_2 = x_4 = x_5$ and proceed as before.

If the second largest is $x_3$, then the fourth inequality gives that $x_1 = x_3 = x_5$ or $x_1 = x_3 = x_4$. In the first case, $x_5$ is the second largest and we are home already. In the second case, the third inequality gives $x_3^2 = x_2 x_5$ and hence $x_3 = x_2 = x_5$ (or one of $x_2$, $x_5$ would be larger than the second largest). So $x_5$ is the second largest and we are home.

Finally, if the second largest is $x_4$, then the second inequality gives $x_1 = x_2 = x_4$ or $x_1 = x_3 = x_4$. Either way, we have a case already covered and so the numbers are all equal. So $x_1 = x_2 = x_3 = x_4 = x_5$.

The value of 
\[
\frac{x_1+x_2+x_3}{x_3+x_4+x_5}.
\] is $1$.",1,algebra
1972p6,"Given four distinct parallel planes, does there exist a regular tetrahedron with a vertex on each plane? If the answer is 'Yes', give the value \(1\). Else give \(0\).","Let our planes be $\pi_1,\pi_2,\pi_3,\pi_4$, which we assume to be parallel to the $xy$-plane, listed in the increasing order of their $z$-coordinates. First take a plane $\pi$ orthogonal to $\pi_i$, which cuts $\pi_1,\pi_2,\pi_3$ along three lines $d_1,d_2,d_3$. On these three lines, take three vertices $A_1,A_2,A_3$ respectively of an equilateral triangle (it is well-known that this is possible; in fact, the problem here is the $3$-dimensional version of this), and then complete the two regular tetrahedra $A_1A_2A_3P_1,A_1A_2A_3P_2$ having $A_1A_2A_3$ as one of their faces. Both $P_i$ lie below $\pi_4$.

Now take another plane $\pi$ and repeat the construction above. If $\pi$ makes a small enough angle with the $\pi_i$'s, one of the $P_i$'s we get this time must lie above $\pi_4$. Now, if we move the initial position of $\pi$ towards the new one continuously and record the $z$-coordinates of $P_1,P_2$, these will be continuous functions of the angle that $\pi$ makes with $\pi_i$, and for one of the points $P_1,P_2$ the $z$-coordinate will move continuously from being smaller than that of $\pi_4$ to being larger than it, meaning that at some point, one of the points $P_1,P_2$ will lie on $\pi_4$, and this is what we want.

So given four distinct parallel planes, prove that there exists a regular tetrahedron with a vertex on each plane. The answer is $1$.",1,geometry
1971p3,"Does the set of integers of the form $2^k - 3(k = 2; 3; \cdots)$ contain an infinite subset in which every two members are relatively prime. If the answer is 'Yes', give the value \(1\). Else give \(0\).","Denote $A_n = 2^{a_n} - 3$. The plan is to construct recursively a sequence $a_1 < a_2 < \dots < a_n < \dots$ such that $A_n$ and $A_k$ are relatively prime for all $k < n$.

Let $a_1 = 3$. (Note that any other number $> 3$ would serve just as well.)

Let $p_{1,1}, \dots, p_{1,k_1}$ be all the prime factors of $A_1 = 2^{a_1} - 3$. (Note that we did not specify whether any prime factors are repeated or not. It does not matter for the proof, the important thing is to take all prime factors.) In our case, $k_1 = 1$ and $p_{1,1} = 5$ since we took $a_1 = 3$.

Define $a_2 = a_1 (p_{1,1} - 1) \dots (p_{1,k_1} - 1)$. In our case $a_2 = 3 (5 - 1) = 12$.

Define $\{a_n\}$ recursively: let $\{p_{(n-1),1}, \dots, p_{(n-1),k_{n-1}}\}$ be all the prime factors of $A_{n-1} = 2^{a_{n-1}} - 3$. (Note again that we don't care whether factors are repeated or not.) Let us take $a_n = a_{n-1} (p_{(n-1),1} - 1) \dots (p_{(n-1),k_{n-1}} - 1)$.

At this point, note for later use that if $p$ is a prime factor of any $A_k, k \in \{1, \dots, (n-1)\}$ then $(p - 1)$ is a factor of $a_n$. Also, note that all such factors $p$ are odd, because all $A_k$ are odd.

Let $B = A_n + 2 = 2^{a_n} - 1$. If $p$ is a prime factor of any of the $A_k, k \in \{1, \dots, n-1\}$, then $p$ is a factor of $B$. Indeed, note that $a_n = b \cdot (p - 1)$ for some $b$, so $B = 2^{a_n} - 1 = 2^{b \cdot (p - 1)} - 1 = (2^b)^{p-1} - 1$, which is divisible by $p$ according to Fermat's_Little_Theorem.

It follows that $A_n = 2^{a_n} - 3$ is coprime with all $A_k, k \in \{1, \dots, (n-1)\}$. This can be justified easily, by noting that if there were a common factor $b$ between $A_n$ and an $A_k$, there would exist a prime common factor $p$. But then this $p$ would be a common factor between two consecutive odd integers $A_n$ and $B$, which is impossible.

So the answer is $1$.",1,number theory
1971p6,"Let $A = (a_{ij})(i, j = 1, 2, \cdots, n)$ be a square matrix whose elements are non-negative integers. Suppose that whenever an element $a_{ij} = 0$, the sum of the elements in the $i$th row and the $j$th column is $\geq n$. When $n=500$, calculate the minimum value of the sum of all the elements of the matrix.

","As in the solution, choose a row or column such that the sum of its elements is minimal. We can assume this is a row (either notice that taking the transpose of $A$ changes neither the hypothesis, nor the conclusion; or notice that if we do the proof in the case of a row, the proof in the case of a column is analogous.) Let $S$ be the sum of the elements of this row, and $z$ be the number of zeros in this row.

For an element $a_{ij}$ of $A$, we denote $r_i, c_j$ the row and the column containing $a_{ij}$. We denote $sum(r_i), sum(c_j)$ the sum of the entries of the matrix in row $r_i$ and $c_j$ respectively.

If $S \ge \frac{n}{2}$, then each row $r_i$ has its sum of elements $sum(r_i) \ge S \ge \frac{n}{2}$, so $\sum_{i, j = 1}^n a_{ij} = \sum_{i=1}^n sum(r_i) \ge \frac{n^2}{2}$.

So, let us assume $S < \frac{n}{2}$. Let $r_i = \{a_{ij}, j = 1, \dots, n\}$ be the row we chose (now $i$ is fixed). For each $j$ consider the sum of the elements of the column $c_j$ containing $a_{ij}$. If $a_{ij} = 0$, we know that $sum(r_i) + sum(c_j) \ge n$ (by hypothesis), so $S + sum(c_j) \ge n$, so $sum(c_j) \ge n - S$. We have $z$ such columns.

If $a_{ij} \ne 0$, we know that $sum(c_j) \ge S$ because $S$ was minimal. We have $n - z$ such columns.

So, $\sum_{i, j = 1}^n a_{ij} = \sum_{j = 1}^n sum(c_j) \ge z(n - S) + (n - z)S$.

Let $S = n - z + E$. Here we split $S$ in two parts: $n - z$ represents the number of non-zeroes in $r_i$, and $E$ represents the sum of the ""excess"" amounts over $1$ of the non-zero entries. More explicitly, $E = \sum_{\substack{j = 1 \\ a_{ij} \ne 0}}^n (a_{ij} - 1)$. (To clarify: if all non-zero entries of $r_i$ would $= 1$, we would have $S = n - z$, and $E = 0$.) In general, $E \ge 0$.

Then, $\sum_{i, j = 1}^n a_{ij} \ge z(n - S) + (n - z)S = (n - S + E)(n - S) + (S - E)S = n^2 - 2nS + 2S^2 + nE - 2SE =$

$\frac{n^2}{2} + \frac{1}{2}\left(n^2 - 4nS + 4S^2\right) + E(n - 2S) = \frac{n^2}{2} + \frac{1}{2}(n - 2S)^2 + E(n - 2S)$.

The last term is $\ge 0$ since $E \ge 0$ and we assumed we are in the case $S < \frac{n}{2}$. It follows that $\sum_{i, j = 1}^n a_{ij} > \frac{n^2}{2}$.

Note: The strict inequality is not true in general. We obtained it assuming that $S < \frac{n}{2}$. When $S \ge \frac{n}{2}$ we have $\sum_{i, j = 1}^n a_{ij} \ge \frac{n^2}{2}$.

So when $n=500$, the answer is $125000$.",125000,combinatorics
1970p1,"Let $M$ be a point on the side $AB$ of $\triangle ABC$. Let $r_1, r_2$, and $r$ be the inscribed circles of triangles $AMC, BMC$, and $ABC$. Let $q_1, q_2$, and $q$ be the radii of the escribed circles of the same triangles that lie in the angle $ACB$. Determine the value of $\frac{r_1}{q_1} \cdot \frac{r_2}{q_2} \cdot \frac{q}{r}$.","Let $I$ be the incenter, and $E$ be the excenter relative to C, and let $B_1, B_2$ be the points where the incircle and the excircle relative to $C$ touch $AC$.

The triangles $\triangle CIB_1$ and $\triangle CEB_2$ are similar, so $\frac{r}{q} = \frac{CI}{CE}.$

Let $I_1$ be the incenter, and $E_1$ be the excenter relative to C of the triangle $\triangle ACM$, and $I_2$ be the incenter, and $E_2$ be the excenter relative to C of the triangle $\triangle BCM$ ($E_2$ is not shown on the picture).

To solve the problem, we need to prove that $\frac{CI_1}{CE_1} \cdot \frac{CI_2}{CE_2} = \frac{CI}{CE}.$

Applying the law of sines (see Law of Sines or https://en.wikipedia.org/wiki/Law_of_sines) in triangle $\triangle ICA$ we get

$\frac{IC}{\sin \angle CAI} = \frac{AC}{\sin \angle CIA}$, or $IC = b\ \frac{\sin \frac{A}{2}}{\sin (\pi - (\frac{A}{2} + \frac{C}{2}))}$. Since $C = \pi - A - B$ this becomes $IC = b\ \frac{\sin \frac{A}{2}}{\cos \frac{B}{2}}.$

Similarly, using the law of sines in triangle $\triangle ECA$ and replacing some angles, we get $EC = b\ \frac{\cos \frac{A}{2}}{\sin \frac{B}{2}}.$

It follows that $\frac{r}{q} = \tan \frac{A}{2} \tan \frac{B}{2}.$

Now, we proceed like in the first solution: Apply the above to triangles $\triangle AMC$ and $\triangle MBC$.

We get that $\frac{r_1}{q_1} = \tan \frac{A}{2} \tan \frac{\angle AMC}{2}$ and $\frac{r_2}{q_2} = \tan \frac{\angle BMC}{2} \tan \frac{B}{2}.$

The desired equality follows from $\tan \frac{\angle AMC}{2} \cdot \tan \frac{\angle BMC}{2} = 1$ (since $\frac{\angle AMC}{2}$ and $\frac{\angle BMC}{2}$ are complementary).

So $\frac{r_1}{q_1} \cdot \frac{r_2}{q_2} \cdot \frac{q}{r} = 1$.",1,geometry
1970p5,"In the tetrahedron $ABCD$, angle $BDC$ is a right angle. Suppose that the foot $H$ of the perpendicular from $D$ to the plane $ABC$ in the tetrahedron is the intersection of the altitudes of $\triangle ABC$. When $( AB+BC+CA )^2 = 6( AD^2 + BD^2 + CD^2 )$. Give the value of $\frac{AB+BC}{AC}$","Let $x = DH, a = BC, b = CA, c = AB$

The plan of this proof is to compute $HA, HB, HC$ in terms of $a, b, c$, then compute $DA^2, DB^2, DC^2$ in terms of $a, b, c, x$, impose the condition that $\angle BDC = \pi/2$ to determine $x$, and calculate $DA^2 + DB^2 + DC^2$ in terms of $a, b, c$. The problem will become a simple inequality in $a, b, c$ which will be easy to prove.

Formulas for the distance from the orthocenter to the vertices are reasonably well known, but to make this solution self contained, we compute them here. From $\triangle ABE_B$ we have that $BE_B = c \sin A$. From $\triangle CBE$ we have $BE = a \cos B$. From $\triangle ABE_B \sim \triangle HBE$ we have $\frac{HB}{c} = \frac{BE}{BE_B}$. It follows that $HB = c \ \frac{a \cos B}{c \sin A} = \frac{a \cos B}{\sin A}$.

Similarly, we have $HC = \frac{a \cos C}{\sin A}$ and $HA = \frac{b \cos A}{\sin B} = \frac{a \cos A}{\sin A}$.

(In the last equality we used the Law of Sines: $\frac{a}{\sin A} = \frac{b}{\sin B} = \frac{c}{\sin C}.$ We want to have $\sin A$ at the denominator to simplify computations.)

Then $DA^2 = x^2 + \frac{a^2 \cos^2 A}{\sin^2 A}, DB^2 = x^2 + \frac{a^2 \cos^2 B}{\sin^2 A}, DC^2 = x^2 + \frac{a^2 \cos^2 C}{\sin^2 A}$.

Since $\angle BDC = \pi/2, DB^2 + DC^2 = a^2$. This yields $x^2 = \frac{a^2}{2 \sin^2 A} \ (\sin^2 A - \cos^2 B - \cos^2 C)$.

Using this value for $x^2$ we get $DA^2 + DB^2 + DC^2 = \frac{a^2}{2 \sin^2 A} \ (3 \sin^2 A + 2 \cos^2 A - \cos^2 B - \cos^2 C)$

After some simplifications, and using again the Law of Sines, this becomes

$DA^2 + DB^2 + DC^2 = \frac{a^2}{2 \sin^2 A} \ (\sin^2 A + \sin^2 B + \sin^2 C) = \frac{a^2}{2} + \frac{a^2}{2 \sin^2 A} \sin^2 B + \frac{a^2}{2 \sin^2 A} \sin^2 C =$

$\frac{a^2}{2} + \frac{b^2}{2 \sin^2 B} \sin^2 B + \frac{c^2}{2 \sin^2 C} \sin^2 C = \frac{1}{2} \ (a^2 + b^2 + c^2)$.

What we need to prove then is that $(a + b + c)^2 \le 3(a^2 + b^2 + c^2)$. We could invoke the Cauchy-Schwarz Inequality like in the first solution, but we can just as well make the computations, and notice that this is equivalent to

$2 a^2 + 2 b^2 + 2 c^2 -2ab - 2bc - 2ca \ge 0$ or $(a - b)^2 + (b - c)^2 + (c - a)^2 \ge 0$, which is always true.

We also see that we have equality if and only if $a = b = c$.

So the value of $\frac{AB+BC}{AC}$ is $2$.",2,geometry
1970p6,"In a plane there are $100$ points, no three of which are collinear. Consider all possible triangles having these point as vertices. If no more than $N \%$ of these triangles are acute-angled. Give the value of $N$.

","Define a $n$-gon to be a configuration of $n$ points, no three of which are collinear. Given an $n$-gon draw all the triangles whose vertices are among the $n$ points. We say that a triangle $\triangle ABC$ is in the $n$-gon, or that the $n$-gon has $\triangle ABC$ in it, if $A, B, C$ are points in the $n$-gon.

We start by proving that a $4$-gon has $4$ triangles, out of which at most $3$ are acute.

Clearly there are exactly $4$ triangles. We have two cases. If the convex hull of the $4$-gon is a quadrilateral, then at least one of $\angle A, \angle B, \angle C, \angle D$ is $\ge \frac{\pi}{2}$ (if they were all $< \frac{\pi}{2}$ then $\angle A + \angle B + \angle C + \angle D < 2\pi$, which is false). Let us say that $\angle C \ge \frac{\pi}{2}$. Then $\triangle BCD$ is obtuse, so at most the other $3$ triangles are acute. (Note that it is possible to have $3$ acute triangles.)

If the convex hull of the $4$-gon is a triangle, let us say that $C$ is in the interior of $\triangle ABD$. Then at least two of $\angle ACB, \angle BCD, \angle DCA$ are $\ge \frac{2\pi}{3} > \frac{\pi}{2}$ (if they were all $< \frac{2\pi}{3}$ then their sum would be $< 2\pi$, which is false). So, at least two of $\triangle ACB, \triangle BCD, \triangle DCA$ are obtuse.

Note: We would be tempted to use this result, and the argument which follows below to prove the problem. But that would only yield the result that at most 75% of the triangles in an $n$-gon (in particular a $100$-gon) are acute. We need to do better.

Now, we will prove that a $5$-gon has $10$ triangles, out of which at most $7$ are acute. It is easy to see that there are $10$ triangles in a $5$-gon, either by counting, or by remembering that the number of triangles $= C(5, 3) = {5 \choose 3} = \frac{5 \cdot 4 \cdot 3}{1 \cdot 2 \cdot 3} = 10$. Now, we could proceed like in the case of a $4$-gon, by looking at many possible cases and chasing angle sizes. Instead, we will give a different argument, using an idea we will use again later.

A $5$-gon has $5$ $4$-gons in it. Each of these $4$-gons has $4$ triangles in it, of which at most $3$ are acute. Make a list $\mathcal{L}_1$ of all the triangles, and a sub-list $\mathcal{L}_2$ of all the acute triangles. The size of $\mathcal{L}_1 = 5 \cdot 4 = 20$, and the size of $\mathcal{L}_2 \le 5 \cdot 3 = 15$. These lists contain duplicates. Each triangle is counted exactly twice (corresponding to the two points which are not in the triangle; we can see this as $= C(5-3, 4-3) = C(2, 1) = {2 \choose 1} = 2$). Dividing by $2$ to eliminate duplicates, we get that out of the $\frac{20}{2} = 10$ triangles, at most $\frac{15}{2} = 7.5$ are acute. We conclude that at most $7$ out of the $10$ are acute.

Now we are ready to prove that given a $n$-gon with $n > 5$, at most $\frac{7}{10} = 70\%$ of its triangles are acute. Consider all the $5$-gons in the given $n$-gon, and consider all the triangles in each $5$-gon. Make a list $\mathcal{L}_1$ of all these triangles, and a sub-list $\mathcal{L}_2$ of all the acute triangles. We have that $\frac{\text{size of } \mathcal{L}_2}{\text{size of } \mathcal{L}_1} \le \frac{7}{10}$ (according to what we showed above). These lists contain duplicates. Each triangle is counted the same number of times, say $k$ times (in fact, $k = C(n-3, 5-3) = C(n-3, 2) = {n-3 \choose 2}$, but we don't need this). Dividing both the numerator and the denominator by $k$ to eliminate duplicates, we have that at most $\frac{7}{10} = 70\%$ of the triangles are acute.

So the answer is $70$.",70,combinatorics
1969p2,"Let $a_1, a_2,\cdots, a_n$ be real constants, $x$ a real variable, and\[f(x)=\cos(a_1+x)+\frac{1}{2}\cos(a_2+x)+\frac{1}{4}\cos(a_3+x)+\cdots+\frac{1}{2^{n-1}}\cos(a_n+x).\]Given that $f(x_1)=f(x_2)=0,$ Give the value of $sin(x_1-x_2)$.","For simplicity of writing, denote $b_k = 1/2^{k - 1}$. $f(x) = b_1\cos{(a_1 + x)} + b_1\cos{(a_1 + x)} + \cdots + b_n\cos{(a_n + x)}$. First, we want to prove that it is not the case that $f(x) = 0$ for all $x$. To prove this, we will prove that the maximum value of $f$ is at least $b_n = 1/2^n$. This will ensure that $f \ne 0$.

We do this by induction. The statement is clear for $n = 1$: $f$ has a maximum value of $b_k = 1$. Assume that we have $n - 1$ terms in $f$, and the maximum value of $f$ is at lease $b_{n - 1} = 1/2^{n - 1}$. Now add the term $b_n\cos{(a_n + x)}$ (and remember that $b_n = 1/2^n$). This additional term has values in $[-1/2^n, 1/2^n]$, so it can decrease the maximum of $f$ by subtracting at most $1/2^n$ from the previous maximum, which was at least $1/2^{n - 1}$. So, the new maximum is at least $1/2^n$.

Now we will the formula $\cos{(\alpha + \beta)} = \cos{\alpha}\cos{\beta} - \sin{\alpha}\sin{\beta}$.

We get $f(x) = (b_1\cos{a_1} + b_2\cos{a_2} + \cdots + b_n\cos{a_n})\cos{x} - (b_1\sin{a_1} + b_2\sin{a_2} + \cdots + b_n\sin{a_n})\sin{x}$.

If both $b_1\sin{a_1} + b_2\sin{a_2} + \cdots + b_n\sin{a_n} = 0$ and $b_1\cos{a_1} + b_2\cos{a_2} + \cdots + b_n\cos{a_n} = 0$ then $f(x) = 0$ for all $x$. So at least one of these sums is $\ne 0$. I will give the proof for the case $b_1\cos{a_1} + b_2\cos{a_2} + \cdots + b_n\cos{a_n} \ne 0$. The other case is proven similarly.

Using $f(x_1) = 0$, we get $(b_1\cos{a_1} + b_2\cos{a_2} + \cdots + b_n\cos{a_n})\cos{x_1} = (b_1\sin{a_1} + b_2\sin{a_2} + \cdots + b_n\sin{a_n})\sin{x_1}$, and similarly for $x_2$.

If $b_1\sin{a_1} + b_2\sin{a_2} + \cdots + b_n\sin{a_n} = 0$, then $\cos{x_1} = 0$ and $\cos{x_2} = 0$. It follows that both $x_1$ and $x_2$ are odd multiples of $\pi/2$, so they differ by $m\pi$ for some integer $m$.

If $b_1\sin{a_1} + b_2\sin{a_2} + \cdots + b_n\sin{a_n} \ne 0$, then we can divide by this quantity, and we get

$\tan{x_1} = \tan{x_2} = \frac{b_1\cos{a_1} + b_2\cos{a_2} + \cdots + b_n\cos{a_n}} {b_1\sin{a_1} + b_2\sin{a_2} + \cdots + b_n\sin{a_n}}$.

Thinking of the graph of $y = \tan{x}$ would be enough for many people to conclude that $x_1 - x_2 = m\pi$ for some integer $m$. If we want to be more formal, we proceed by writing $\tan{x_1} - \tan{x_2} = 0$. Some easy computations yield $\tan{x_1} - \tan{x_2} = \frac{\sin{(x_1 - x_2)}} {\cos{x_1}\cos{x_2}} = 0$. It follows that $\sin{(x_1 - x_2)} = 0$.",0,algebra
1968p1,How many triangles have side lengths that are consecutive integers and have one angle that is twice as large as another?,"So, let us start by assuming that two angles are $\alpha, 2\alpha$ and the sides are $x, x + 1, x + 2$. We will want to apply the Law of Sines:

$\frac{x}{\sin A} = \frac{x + 1}{\sin B} = \frac{x + 2}{\sin C}$

The angles $A, B, C$ should be so that $\sin A \le \sin B \le \sin C$, but we don't know how to map $\{A, B, C\}$ to $\{\alpha, 2\alpha, \pi - 3\alpha\}$. One thing we know, is that $\sin \alpha < \sin 2\alpha$. Indeed, if $\alpha \le \pi/4$ the inequality is true because $\sin$ is increasing on $[0, \pi/2]$. Now note that $\alpha < \pi/3$ since otherwise $\pi - 3\alpha$ could not be the angle of a triangle. So, if $\pi/4 < \alpha < \pi/3$ then $\pi/2 < 2\alpha < 2\pi/3$ and $\sin \alpha < \sqrt{3}/2 < \sin 2\alpha$.

That means we will have to consider three possibilities:

1: $\ \ \frac{x}{\sin \alpha} = \frac{x + 1}{\sin 2\alpha} = \frac{x + 2}{\sin (\pi - 3\alpha)}$

2: $\ \ \frac{x}{\sin \alpha} = \frac{x + 1}{\sin (\pi - 3\alpha)} = \frac{x + 2}{\sin 2\alpha}$

3: $\ \ \frac{x}{\sin (\pi - 3\alpha)} = \frac{x + 1}{\sin \alpha} = \frac{x + 2}{\sin 2\alpha}$

Using the identities $\sin (\pi - \theta) = \sin \theta, \sin 2\theta = 2\sin \theta \cos \theta$ and $\sin 3\theta = 3\sin \theta - 4\sin^3 \theta = \sin \theta\ (4\cos^2 \theta - 1)$ and simplifying by $\sin \alpha$ the three cases become

1: $\ \ x = \frac{x + 1}{2\cos \alpha} = \frac{x + 2}{4\cos^2 \alpha - 1}$

2: $\ \ x = \frac{x + 1}{4\cos^2 \alpha - 1} = \frac{x + 2}{2\cos \alpha}$

3: $\ \ \frac{x}{4\cos^2 \alpha - 1} = x + 1 = \frac{x + 2}{2\cos \alpha}$

Each case is a system of two equations in two unknowns, $x, \cos \alpha$. We will solve each system, obtain all possible solutions, and chose those values for which $x, x + 1, x + 2$ and $\alpha, 2\alpha, \pi - 3\alpha$ can be the sides and angles of a triangle.

Case 1: Compute $x$ from $x = \frac{x + 1}{2\cos \alpha}$. We get $x = \frac{1}{2\cos \alpha - 1}$. Substitute $x$ in $x = \frac{x + 2}{4\cos^2 \alpha - 1}$. After doing all the computations we get $4\cos^2 \alpha - 4\cos \alpha = 0$. The roots are $\cos \alpha = 0$ and $\cos \alpha = 1$. None are acceptable if $\alpha$ is an angle of a triangle. So case 1 yields no solutions.

Case 2: Compute $x$ from $x = \frac{x + 2}{2\cos \alpha}$. We get $x = \frac{2}{2\cos \alpha - 1}$. Substitute $x$ in $x = \frac{x + 1}{4\cos^2 \alpha - 1}$. After doing all the computations we get $8\cos^2 \alpha - 2\cos \alpha - 3 = 0$. The solutions are $\cos \alpha = \frac{3}{4}$ and $\cos \alpha = -\frac{1}{2}$. Only $\cos \alpha = \frac{3}{4}$ is acceptable, and it yields $x = \frac{2}{\frac{6}{4} - 1} = 4$. Thus $4, 5, 6$ is a possible solution to the problem.

Case 3: Compute $x$ from $x + 1 = \frac{x + 2}{2\cos \alpha}$. We get $x = \frac{2 - 2\cos \alpha}{2\cos \alpha - 1}$. Substitute $x$ in $x + 1 = \frac{x}{4\cos^2 \alpha - 1}$. After doing all the computations we get $4\cos^2 \alpha + 2\cos \alpha - 3 = 0$. The roots are $\cos \alpha = \frac{-1 \pm \sqrt{13}}{4} \approx 0.65, -1.15$. The positive value is for an $\alpha$ acceptable as an angle in a triangle (it is a little over $\pi/4$), and yields $x = \frac{\sqrt{13} + 1}{2}$. We can easily verify that $x, x + 1, x + 2$ can be the sides of a triangle. (Indeed, they are $\frac{\sqrt{13} + 1}{2}, \frac{\sqrt{13} + 3}{2}, \frac{\sqrt{13} + 5}{2}$ and $\frac{\sqrt{13} + 1}{2} + \frac{\sqrt{13} + 3}{2} > \frac{\sqrt{13} + 5}{2}$). However, they are not integer, so are not solutions to the problem.

The only solution to the problem is the triangle with sides $4, 5, 6$ from case 2. So the answer is $1$.",1,geometry
1968p2,Find all natural numbers $x$ such that the product of their digits (in decimal notation) is equal to $x^2 - 10x - 22$. Calculate the sum of all possible $x$.,"Let $y = x^2 - 10x - 22$. Since $y$ is a product of digits, the only prime factors of $y$ can be $2, 3, 5, 7$. Write $y = (x - 5)^2 - 47$.

Note that if $A$ is a natural number then $A^2 \equiv 0$ or $1\ (mod\ 3)$. Indeed, $A = 3k$ or $A = 3k + 1$ or $A = 3k + 2$ for some $k$. By writing out $A^2$ the statement follows immediately. Then $(x - 5)^2 - 47 \equiv 1$ or $2\ (mod\ 3)$, so $3$ can not be a factor of $y$.

Similarly, if $A$ is a natural number then $A^2 \equiv 0, 1$ or $4\ (mod\ 5)$. Then $(x - 5)^2 - 47 \equiv 3, 4$ or $2\ (mod\ 5)$, so $5$ can not be a factor of $y$.

And finally if $A$ is a natural number then $A^2 \equiv 0, 1, 2$ or $4\ (mod\ 7)$. Then $(x - 5)^2 - 47 \equiv 2, 3, 4$ or $6\ (mod\ 7)$, so $7$ can not be a factor of $y$.

The only possible prime factor of $y$ is $2$. So $2^z = (x - 5)^2 - 47$ for some $z \ge 0$. Write this as $2^z -2 = (x - 5)^2 - 49$, or $2(2^{z - 1} - 1) = (x - 12)(x + 2)$.

Clearly $z = 0$ is not acceptable because the equation in $x$ has no integer solutions.

If $z > 1$ the left hand side is divisible by $2$, but not by $4$. The right hand side is not divisible by $2$ if $x$ is odd, and is divisible by $4$ if $x$ is even. So $z > 1$ yields no solutions.

If $z = 1$, the equation becomes $x^2 - 10x - 24 = 0$ which has solutions $-2, 12$. The only acceptable solution is $x = 12$.

So the sum is $12$.",12,number theory
1968p4,"In every tetrahedron, is there a vertex such that the three edges meeting there have lengths which are the sides of a triangle? If the answer is 'Yes', give the value \(1\). Else give \(0\).","Let the edges of one of the faces of the tetrahedron have lengths $a$, $b$, and $c$. Let $d$, $e$, and $f$ be the lengths of the sides that are not adjacent to the sides with lengths $a$, $b$, and $c$, respectively.

Without loss of generality, assume that $\max(a,b,c,d,e,f)=a$. I shall now prove that either $b+f>a$ or $c+e>a$, by proving that if $b+f\leq a$, then $c+e>a$.

Assume that $b+f\leq a$. The triangle inequality gives us that $e+f>a$, so $e$ must be greater than $b$. We also have from the triangle inequality that $b+c>a$. Therefore $e+c>b+c>a$. Therefore either $b+f>a$ or $c+e>a$.

If $b+f>a$, then the vertex where the sides of length $a$, $b$, and $f$ meet satisfies the given condition. If $c+e>a$, then the vertex where the sides of length $a$, $c$, and $e$ meet satisfies the given condition. This proves the statement.

So the answer is $1$.",1,geometry
1968p6,"For natural number $n=1968$, determine the value of the sum
\[\sum_{k = 0}^\infty\bigg[\frac{n + 2^k}{2^{k + 1}}\bigg] = \Big[\frac{n + 1}{2}\Big] + \Big[\frac{n + 2}{4}\Big] + \cdots + \bigg[\frac{n + 2^k}{2^{k + 1}}\bigg] + \cdots\]
(The symbol $[x]$ denotes the greatest integer not exceeding $x$.)","By Hermite's identity, for real numbers $x$,

\[\bigg[ x + \frac12 \bigg] = \bigg[ 2x \bigg] - \bigg[ x \bigg].\]

Hence our sum telescopes:

\[\sum_{k = 0}^\infty\bigg[\frac{n + 2^k}{2^{k + 1}}\bigg] = \sum_{k = 0}^\infty\bigg[\frac{n}{2^{k + 1}} + \frac12 \bigg] = \sum_{k = 0}^\infty \left( \bigg[\frac{n}{2^{k}} \bigg] - \bigg[ \frac{n}{2^{k+1}} \bigg] \right) = \bigg[ n \bigg].\]

When $n=1968$, the sum is $1968$.",1968,number theory
1967p5,"Let $a_1,\ldots,a_8$ be reals, not all equal to zero. Let
\[c_n = \sum^8_{k=1} a^n_k\]
for $n=1,2,3,\ldots$. Given that among the numbers of the sequence $(c_n)$, there are infinitely many equal to zero. Determine all the values of $n$ that $n<100$ for which $c_n = 0$, calcualte the sum of all possible $n$.","Take $|a_1| \ge |a_2| \ge \dots \ge |a_8|$. Suppose that $|a_1|, \dots, |a_r|$ are all equal and greater than $|a_{r+1}|$. Then for sufficiently large $n$, we can ensure that $|a_s|^n < \frac{1}{8}|a_1|^n$ for $s > r$, and hence the sum of $|a_s|^n$ for all $s > r$ is less than $|a_1|^n$. Hence $r$ must be even with half of $a_1, \dots, a_r$ positive and half negative.

If that does not exhaust the $a_i$, then in a similar way there must be an even number of $a_i$ with the next largest value of $|a_i|$, with half positive and half negative, and so on. Thus we find that $c_n = 0$ for all odd $n$.

When $n<100$, the sum is $2500$.",2500,algebra
1967p6,"In a sports contest, there were $m$ medals awarded on $n$ successive days $(n > 1)$. On the first day, one medal and $\frac{1}{7}$ of the remaining $m - 1$ medals were awarded. On the second day, two medals and $\frac{1}{7}$ of the now remaining medals were awarded; and so on. On the n-th and last day, the remaining $n$ medals were awarded. How many days did the contest last, and how many medals were awarded altogether? Calculate the $m+n$ as the final answer.

","Denote $m_0 = m$. Let $m_k$ be the number of medals left on day $k$ after the medals for the day have been awarded. The problem says that $m_k = m_{k-1} - k - \frac{m_{k-1} - k}{7}$ for $k = 1, 2, \dots, (n - 1)$, and $m_{n - 1} = n$, and $n > 1$. Simplify the recursive relation and get $m_k = \frac{6}{7}m_{k - 1} - \frac{6}{7}k$.

We will now get an explicit formula for $m_k$.

$m_1 = \frac{6}{7}m - \frac{6}{7} \cdot 1$

$m_2 = \frac{6}{7}m_1 - \frac{6}{7} \cdot 2 = \left(\frac{6}{7}\right)^2m - \left(\frac{6}{7}\right)^2 \cdot 1 - \frac{6}{7} \cdot 2$

$m_3 = \frac{6}{7}m_2 - \frac{6}{7} \cdot 3 = \left(\frac{6}{7}\right)^3m - \left(\frac{6}{7}\right)^3 \cdot 1 - \left(\frac{6}{7}\right)^2 \cdot 2 + \frac{6}{7} \cdot 3$

. . . . . . . .

$m_{n - 1} = \frac{6}{7}m_{n - 2} - \frac{6}{7} \cdot (n - 1) = \left(\frac{6}{7}\right)^{n - 1}m - \left(\frac{6}{7}\right)^{n - 1} \cdot 1 - \left(\frac{6}{7}\right)^{n - 2} \cdot 2 - \dots - \left(\frac{6}{7}\right)^2 \cdot (n - 2) - \frac{6}{7} \cdot (n - 1)$

To put it in a shorter way,

$m_{n - 1} = \left(\frac{6}{7}\right)^{n - 1}m - \sum_{k = 1}^{n - 1} \left(\frac{6}{7}\right)^{n - k} \cdot k$

(The reader who is not happy with having obtained this result by having observed the pattern for $m_k$ can easily verify it by induction.)

Note that the sum in the equality above is the sum of the arithmetic-geometric sequence formed by the geometric progression $\{\ \left(\frac{6}{7}\right)^{n - 1}, \left(\frac{6}{7}\right)^{n - 2}, \dots, \left(\frac{6}{7}\right)^2, \frac{6}{7}\ \}$ (with common ratio $\frac{7}{6}$ (note that the progression starts from a number smaller than $1$ and is increasing)), and the arithmetic progression $\{\ 1, 2, \dots, (n - 2), (n - 1)\ \}$ (with common difference $1$). The formula for the sum of the terms of such sequences is reasonably well known (and not difficult to prove) (see for example Arithmetico-geometric_series or https://en.wikipedia.org/wiki/Arithmetico-geometric_sequence).

Applying the formula for the sum of the arithmetic-geometric sequence, and using the fact that $m_{n - 1} = n$, we get

$n = \left(\frac{6}{7}\right)^{n - 1}m - \frac{\left(\frac{6}{7}\right)^{n - 1} \cdot 1 - 1 \cdot n}{1 - \frac{7}{6}} -\frac{\frac{7}{6}}{\left(1 - \frac{7}{6}\right)^2} \left(\left(\frac{6}{7}\right)^{n - 1} - 1 \right)$

Now do all the simplifications, and rearrange terms. We have

$m - 36 = 7(n - 6) \left(\frac{7}{6}\right)^{n - 1}$

In order for $m$ to be an integer, we have to have that $\frac{n - 6}{6^{n - 1}}$ is an integer. This is clearly not the case when $n = 2, 3, 4, 5$. It is an integer when $n = 6$, in which case $m = 36$. The fraction is not an integer for $n = 7$, and even less so for $n > 7$ since the exponential at the denominator increases much faster than the linear function at the numerator.

Thus, $m = 36, n = 6$ is the only solution to the problem. So the answer is $42$.",42,algebra
1966p1,"In a mathematical contest, three problems, $A$, $B$, and $C$ were posed. Among the participants there were $25$ students who solved at least one problem each. Of all the contestants who did not solve problem $A$, the number who solved $B$ was twice the number who solved $C$. The number of students who solved only problem $A$ was one more than the number of students who solved $A$ and at least one other problem. Of all students who solved just one problem, half did not solve problem $A$. How many students solved only problem $B$?","Let $a$ be the number of students solving both B and C. Then for some positive integer $x$, $2x - a$ students solved B only, and $x - a$ students solved C only. Let $2y - 1$ be the number of students solving A; then $y$ is the number of students solving A only. We have by given\[2y - 1 + 3x - a = 25\]and\[y = 3x - 2a.\]Substituting for y into the first equation gives\[9x - 5a = 26.\]Thus, because $x$ and $a$ are positive integers with $x-a \ge 0$, we have $x = 4$ and $a = 2$. (Note that $x = 9$ and $a = 11$ does not work.) Hence, the number of students solving B only is $2x - a = 8 - 2 = 6$.",6,combinatorics
1965p1,"Determine all values $x$ in the interval $0\leq x\leq 2\pi$ which satisfy the inequality

\[2\cos x \leq \left| \sqrt{1+\sin 2x} - \sqrt{1-\sin 2x } \right| \leq \sqrt{2}.\] 

If the maximum value of $x$ is $x_{max}$ and the minimum value of $x$ is $x_{min}$, give the value of $\frac{x_{max}}{x_{min}}$.
","Manipulate the inequality so that it becomes:\[\sqrt{2}\cos x \leq \left| \sqrt{\frac{1+\cos(\frac{\pi}{2}-2x)}{2}} - \sqrt{\frac{1-\cos(\frac{\pi}{2}- 2x)}{2}} \right| \leq 1\]Inside the absolute value, we identify the half-angle formulas. However, since we do not know the sign of the resultant expression, we have to use absolute value signs since the principal square root is always positive; then the inequality becomes\[\sqrt{2}\cos x \leq \left| \left|\cos\left(\frac{\pi}{4}-x\right)\right| - \left|\sin\left(\frac{\pi}{4}-x\right)\right|\right| \leq 1\]which, considering absolute value, is the same as\[\sqrt{2}\cos x \leq \left| \left|\cos\left(x-\frac{\pi}{4}\right)\right| - \left|\sin\left(x-\frac{\pi}{4}\right)\right|\right| \leq 1\]Since both inner absolute values range between $0$ and $1$, their positive difference also ranges from $0$ to $1$, so the right inequality is always true. Thus we take a look at the left inequality. For $x\in\left[\frac{\pi}{2},\frac{3\pi}{2}\right]$, the left-hand side is never positive; however, the right-hand side is always nonnegative due to absolute value, so the inequality holds for these $x$-values. As a result, we consider the remaining two sections of the interval.

For $x\in\left[0,\frac{\pi}{4}\right]$ and $x\in\left[\frac{7\pi}{4},2\pi\right]$, when considering the $-\frac{\pi}{4}$, inside the absolute value, cosine is positive but sine is negative; thus our inequality becomes
If $x\in\left[0,\frac{\pi}{4}\right]$, then due to the interval, $\sin x$ and $\cos x$ are both never negative; thus,
But this is never true in our interval (except at one endpoint, which is included in the interval below), so the inequality does not hold.

If $x\in\left[\frac{7\pi}{4},2\pi\right]$, then due to the interval, $\sin x$ is negative and $\cos x$ is positive; thus,
But this is also never true in our interval (except at one endpoint, which is included in the interval below), so the inequality does not hold.

For $x\in\left[\frac{\pi}{4},\frac{\pi}{2}\right]$, inside the absolute value, when considering the $-\frac{\pi}{4}$, both cosine and sine are positive; thus our inequality becomes
This is always true, so the inequality holds.

For $x\in\left[\frac{3\pi}{2},\frac{7\pi}{4}\right]$, inside the absolute value, when considering the $-\frac{\pi}{4}$, both cosine and sine are negative; thus our inequality becomes
This is the same as the case for $x\in\left[\frac{\pi}{4},\frac{\pi}{2}\right]$, so the inequality holds.

Combining our findings, we find that $\boxed{x\in\left[\frac{\pi}{4},\frac{7\pi}{4}\right]}$. So the value of $\frac{x_{max}}{x_{min}}$ is $7$.",7,algebra
1965p2,"Consider the system of equations\[a_{11}x_1 + a_{12}x_2 + a_{13}x_3 = 0\]\[a_{21}x_1 + a_{22}x_2 + a_{23}x_3 = 0\]\[a_{31}x_1 + a_{32}x_2 + a_{33}x_3 = 0\]with unknowns $x_1$, $x_2$, $x_3$. The coefficients satisfy the conditions:

(a) $a_{11}$, $a_{22}$, $a_{33}$ are positive numbers;

(b) the remaining coefficients are negative numbers;

(c) in each equation, the sum of the coefficients is positive.

With the given system, calculate the value of $x_1 + x_2 + x_3$.","Clearly if the $x_i$ are all equal, then they are equal to 0. Now let's assume WLOG that $x_1=0$. If $x_2$ or $x_3$ is 0, then the other is clearly zero, so let's consider the case where neither are 0. $a_{12}$ and $a_{21}$ are negative, so exactly one of $x_2$ or $x_3$ is positive. Unfortunately this means that one of $a_{22}x_2 + a_{23}x_3$ or $a_{32}x_2 + a_{33}x_3 = 0$ is positive and the other is negative, so the equation couldn't possibly be satisfied if $x_2$ or $x_3$ isn't 0. We have covered the case where one of the $x_i$ is 0, now let's assume that none of them are 0.

If two are positive and one is negative, then when the negative $x_i$ is paired with one of the positive $a_i$, the corresponding equation is negative. This is bad. If two are negative and one is positive, then when the positive $x_i$ is paired with one of the positive $a_i$, the corresponding equation is positive. This is also bad. Therefore the $x_i$ all have the same sign.

Case 1: The $x_i$ are all positive. WLOG $x_1\leq x_2\leq x_3$. Now consider the third equation, $a_{31}x_1 + a_{32}x_2 + a_{33}x_3 = 0$. Therefore $x_2(a_{31} +a_{32}+a_{33})+ a_{31}(x_1-x_2)+a_{33}(x_3-x_2)= 0$, but all of the terms on the LHS are non-negative and the first one is positive, so this is impossible.

Case 2: The $x_i$ are all negative. WLOG $x_1\geq x_2\geq x_3$. Consider the third equation, $a_{31}x_1 + a_{32}x_2 + a_{33}x_3 = 0$. Therefore $x_3(a_{31}+a_{32}+a_{33})+a_{31}(x_1-x_3)+a_{32}(x_2-x_3)=0$, but all of the terms on the LHS are non-positive and the first one is negative, so this is impossible.

Therefore at least one of the $x_i$ is 0, which implies all of them are 0. So the value of $x_1 + x_2 + x_3$ is $0$.",0,algebra
1965p3,"Given the tetrahedron $ABCD$ whose edges $AB$ and $CD$ have lengths $a$ and $b$ respectively. The distance between the skew lines $AB$ and $CD$ is $d$, and the angle between them is $\omega$. Tetrahedron $ABCD$ is divided into two solids by plane $\varepsilon$, parallel to lines $AB$ and $CD$. The ratio of the distances of $\varepsilon$ from $AB$ and $CD$ is equal to $k$. When $k=1$, calculate the ratio of the volumes of the $ABCD$ and $ABWXYZ$.","Let the plane meet $AD$ at $X$, $BD$ at $Y$, $BC$ at $Z$ and $AC$ at $W$. Take a plane parallel to $BCD$ through $WX$ and let it meet $AB$ in $P$.

Since the distance of $AB$ from $WXYZ$ is $k$ times the distance of $CD$, we have that $AX = k \cdot XD$ and hence $AX/AD = k/(k+1).$ Similarly $AP/AB = AW/AC = AX/AD.$ $XY$ is parallel to $AB$, so also $AX/AD = BY/BD = BZ/BC.$

vol $ABWXYZ =$ vol $APWX +$ vol $WXPBYZ.$ $APWX$ is similar to the tetrahedron $ABCD.$ The sides are $k/(k + 1)$ times smaller, so vol $APWX = k^3/(k + 1)^3$ vol $ABCD.$

The base of the prism $WXPBYZ$ is $BYZ$ which is similar to $BCD$ with sides $k/(k + 1)$ times smaller and hence area $k^2/(k + 1)^2$ times smaller. Its height is $1/(k + 1)$ times the height of $A$ above $ABCD,$ so vol prism $= 3 k^2/(k + 1)^3$ vol $ABCD.$

Thus vol $ABWXYZ = (k^3 + 3k^2)/(k + 1)^3$ vol $ABCD.$

So when $k=1$, the answer is $2$",2,geometry
1965p6,"In a plane a set of $n$ points ($n\geq 3$) is given. Each pair of points is connected by a segment. Let $d$ be the length of the longest of these segments. We define a diameter of the set to be any connecting segment of length $d$. If the number of diameters of the given set is at most $M$, determine the value of $M$ when $n=1965$.","$\mathbf{Definition:}$ For the purpose of this proof, let us define an $equilateral\ arc\ triangle$ as the shape we obtain when we take a triangle $\triangle ABC$ in which we replace the side $AB$ by the $\pi/6$ arc of the circle centered at $C$ with radius $CA = CB$, going from $A$ to $B$, and similarly for the other two sides $BC$ and $AC$.

Note that if the sides of the original equilateral triangle were of length $d$, then the distance from a vertex to any point on the opposite arc is $d$. Also, the distance between any two points on the arcs, such that none of them are vertices is $< d$. And finally, the distance from a vertex to any point on the arcs adjacent to it (which is not another vertex) is $< d$.

$\mathbf{Lemma:}$ A configuration of $n$ points has exactly $n$ diameters if an only if $3$ of the points are the vertices of an equilateral arc triangle, and the other $n - 3$ are on the boundary of the triangle.

$\mathbf{Proof\ of\ the\ Lemma:}$ It is clear that if we have a configuration as described in the lemma then there are $n$ diameters. We will prove the converse by induction. We want to prove that if we have a configuration of $n$ points with $n$ diameters, then the points are in a configuration as described above.

If $n = 3$ it is clear that the $3$ points have to be the vertices of an equilateral triangle since the sides are equal (to $d$). Assume we know the statement to be true for $n$, and prove it for $n + 1$. Assume that we have $n + 1$ points with $n + 1$ diameters $d$. Consider $n$ of the points, and let $Q$ be the remaining point. It follows from the induction hypothesis that $3$ of the $n$ are the vertices of an equilateral arc triangle, and the other $n - 3$ are on the boundary.

Now let us examine where $Q$ may be. It can not be outside of the equilateral arc triangle because then the distance to at least one of the vertices would be $d' > d$, and the diameter of the set would be $d'$ rather than $d$. It can not be inside the triangle because then all the distances from $Q$ to the $n$ points considered are $< d$, and we would not have $n + 1$ diameters, as assumed. So $Q$ must be on the boundary of the equilateral arc triangle, which proves the induction step, and the lemma.

Now the solution to the problem is easy to finish. Assume we have $n$ points given, and the configuration has $m$ diameters. I claim that we can not have $m > n$. We prove this by contradiction. If we did, let us consider a set $S$ consisting of only $n$ of the diameters. Because of the lemma, this implies that the $n$ points form a configuration as described in the lemma, i.e. $3$ of them are the vertices of an equilateral arc triangle, and the other $n - 3$ are on the boundary. Now consider a diameter $D$ which is not in $S$. It is the distance of a segment between two of the points $P_1, P_2$ in the configuration. If one of $P_1, P_2$ is a vertex, then this diameter $D$ is in $S$, which is a contradiction. If none of $P_1, P_2$ are vertices, then the length of $P_1P_2 < d$, so $D = P_1P_2$ is not a diameter, which is again a contradiction.

It follows that $m \le n$. So when $n=1965$, the value of $M$ is $1965$.",1965,combinatorics
1964p5,"Suppose five points in a plane are situated so that no two of the straight lines joining them are parallel, perpendicular, or coincident. From each point perpendiculars are drawn to all the lines joining the other four points. Determine the maximum number of intersections that these perpendiculars can have.","Suppose, those five points are $(A, B, C, D, E)$. Now, we want to create some special structure. Let, we take the line $BC$ and draw a perpendicular from $A$ on $BC$, andd call it $P_1$. We can do this set up in $\binom{5}{1}\binom{4}{2}=30$ ways. There will $30$ such $P_i$ s.

Now, we will find how many other perpendiculars intersect the line. We can do this in total $20$ ways. Why? See, can draw perpendiculars from $B$ and $C$ to other lines( we haven't counted the perpendicular from $B$ to $AC$ and perpendicular from $C$ on $AB$ , as they intersect $P_1$ at the same point) in $5$ ways for each. So, total $10$ ways.

Now, $5$ perpendiculars from each $D$ and $E$ on the other lines except on $BC$( because in this case teh perpendiculars from $D$ and $E$ will be parallel to $P_1$ , and so shall not intersect). So,total $10$ cases. From, these two cases we get $P_1$ will be intersected at at most $5*6*(5+5+5+5)=600$ points.

But, as we have passed this algorithm over all the five points, we have counted each intersection points twice. So, there are total $\frac{600}{2}=300$ ways.

Now, as we had excluded the orthocentres, we have to add now. There are total $\binom{5}{3}=10$ orthocentres. Also we should add those vertices as these are also point of intersection of silimar perpendiculars, there are $5$ such.

So, total ways $300+10+5=315$.",315,geometry
1962p1,"Find the smallest natural number $n$ which has the following properties:

(a) Its decimal representation has 6 as the last digit.

(b) If the last digit 6 is erased and placed in front of the remaining digits, the resulting number is four times as large as the original number $n$.","We know from the two properties that for some string $x$, $n=10x+6$. Let the number of digits in $x$ be $a$; then moving the $6$ to the front would give it place value $10^a$; as a result, $4n=6\cdot10^a+x$. Multiplying this by $10$ gives $40n=6\cdot10^{a+1}+10x$, and subtracting the former yields $39n=6(10^{a+1}-1)$, or $13n=2(10^{a+1}-1)$. As a result, $13|(10^{a+1}-1)$. By Fermat's Little Theorem, we know that $10^{12}-1$ divides $13$, so it isn't difficult to try values of $a+1$ less than $13$ to find the smallest such $a$.

Eventually, we notice that $10^6-1$ divides $13$, so $a=5$. Then $\boxed{n=153846}$, and since the number ends in $6$, we know that $x$ is also an integer, so this is the solution.",153846,number theory
1962p6,Consider an isosceles triangle. Let $r$ be the radius of its circumscribed circle and $\rho$ the radius of its inscribed circle. Calculate the distance $d$ between the centers of these two circles when $r=32$ and $\rho = 15$.,"Instead of an isosceles triangle, let us consider an arbitrary triangle $ABC$. Let $ABC$ have circumcenter $O$ and incenter $I$. Extend $AI$ to meet the circumcircle again at $L$. Then extend $LO$ so it meets the circumcircle again at $M$. Consider the point where the incircle meets $AB$, and let this be point $D$. We have $\angle ADI = \angle MBL = 90^{\circ}, \angle IAD = \angle LMB$; thus, $\triangle ADI \sim \triangle MBL$, or $\frac {ID}{BL} = \frac {AI} {ML} \iff ID \cdot ML = 2r\rho = AI \cdot BL$. Now, drawing line $BI$, we see that $\angle BIL = \frac {1}{2}\angle A + \frac {1}{2}\angle ABC, \angle IBL = \frac {1}{2}\angle ABC + \angle CBL = \frac {1}{2}\angle ABC + \frac {1}{2}\angle A$. Therefore, $BIL$ is isosceles, and $IL = BL$. Substituting this back in, we have $2r\rho = AI\cdot IL$. Extending $OI$ to meet the circumcircle at $P,Q$, we see that $AI\cdot IL = PI\cdot QI$ by Power of a Point. Therefore, $2r\rho = PI \cdot QI = (PO + OI)(QO - OI) = (r + d)(r - d)$, and we have $2r\rho = r^2 - d^2 \iff d = \sqrt {r(r - 2\rho)}$, and we are done.

So when $r=32$ and $\rho = 15$, the answer is $8$.",8,geometry
1961p3,"Solve the equation

$\cos^n{x} - \sin^n{x} = 1$

where $n=1961$. We use $x=d\pi$ to represent all possible solution $x$, when $0<x<100$, the sum of all possible $d$ is $504$.","First consider $n=1$. Squaring both sides yields $\cos^2{x}-2\cos{x}\sin{x}+\sin^2{x}=1$, and utilizing identities yields $\sin{2x}=0$. This results in solutions $x=\frac{\pi}{2}k$ for integers $k$. After manually checking the solutions in the original equation, we conclude that only $x=2k\pi$ and $x=\frac{3\pi}{2}+2k\pi$ are solutions to the equation.


Next, we consider $n=2$. This is equivalent to $\cos{2x}=1$, so the solutions are $x=k\pi$ for integers $k$. Once again, substituting into the equation results in a valid identity, so these are the only solutions.


Let $f(x)=\cos^n{x}-\sin^n{x}$. Taking the derivative yields $f'(x)=-n\sin{x}\cos{x}(\sin^{n-2}{x}+\cos^{n-2}{x})$ for $n>2$. We wish to consider extrema, so we find all $x$-values such that $f'(x)=0$ by checking the zeros of each factor. In $x\in[0,2\pi]$, $f'(x)=0$ for even $n$ when $x=0,\frac{\pi}{2},\pi,\frac{3\pi}{2},2\pi$, and for odd $n$ when $x=0,\frac{\pi}{2},\frac{3\pi}{4},\pi,\frac{3\pi}{2},\frac{7\pi}{4},2\pi$. The differences between the two come from the $\sin^{n-2}{x}+\cos^{n-2}{x}$ factor, reaching zeros when $\tan^{n-2}{x}=-1$. This is impossible when $n$ is even, and if $n$ is odd, it implies that $\tan{x}=-1$, hence the solutions.


We then calculate the value of $f(x)$ at every such $x$. For even $n$, the $x$-values $0,\frac{\pi}{2},\pi,\frac{3\pi}{2},2\pi$ result in $f(x)$-values of $1,-1,1,-1,1$. Since these are the only possible extrema, we conclude that $1$ is always a maximum and $-1$ is always a minimum; thus the only solutions are the maxima, which occur at $x=0,\pi,2\pi$ when $x\in[0,2\pi]$; more generally, we have $x=k\pi$ for integers $k$.


Next, for odd $n$, the $x$-values $x=0,\frac{\pi}{2},\frac{3\pi}{4},\pi,\frac{3\pi}{2},\frac{7\pi}{4},2\pi$ yield $f(x)$-values of $1,-1,-2\left(\frac{1}{\sqrt{2}}\right)^n,-1,1,2\left(\frac{1}{\sqrt{2}}\right)^n,1$. Obviously $x=0,\frac{3\pi}{2},2\pi$ are all solutions; we show that on our closed domain these are the only solutions. On $x=0$ to $x=\frac{\pi}{2}$, the function is always decreasing; if it were increasing at any point, an extremum would be required to change the sign of the derivative; however, there does not exist an extremum between these two points (since we have already found all the extrema!); thus only $x=0$ satisfies the equation. We can repeat this argument for all values between two extrema; eventually, we can conclude that the only times that $f(x)=1$ are the above (since no segment contains $1$ at any point other than an endpoint; as a result, the function cannot equal $1$ at any point other than an endpoint of some segment, which are the extrema). As a result, extending this to all $x$, the solutions are $x=2k\pi$ and $x=\frac{3\pi}{2}+2k\pi$ for integers $k$.


Since these results match our $n=1$ and $n=2$ cases, we conclude that when $n$ is odd, the solutions are $x=2k\pi$ and $x=\frac{3\pi}{2}+2k\pi$ for integers $k$, and when $n$ is even, the solutions are $x=k\pi$ for integers $k$.

So if we use $x=d\pi$ to represent all possible solution $x$. If $0<x<100$, calculate the sum of all possible $d$.",504,algebra
1960p1,"Determine all three-digit numbers $N$ having the property that $N$ is divisible by 11, and $\dfrac{N}{11}$ is equal to the sum of the squares of the digits of $N$. Give the sum of all possible $N$.","Let $N = 100a + 10b+c$ for some digits $a,b,$ and $c$. Then\[100a + 10b+c = 11m\]for some $m$. We also have $m=a^2+b^2+c^2$. Substituting this into the first equation and simplification, we get\[100a+10b+c = 11a^2 +11b^2 +11c^2\]For an integer divisible by $11$, the the sum of digits in the odd positions minus the sum of digits in the even positions is divisible by $11$. Thus we get: $b = a + c$ or $b = a + c - 11$.

Case $1$: Let $b=a+c$. We get\[100a+c+10a+10c = 11a^2 +11c^2+11(a+c)^2\]\[10a+c = 2a^2+2ac+2c^2\]Since the right side is even, the left side must also be even. Let $c=2q$ for some $q = 0,1,2,3,4$. Then\[10a+2q=2a^2+4aq+8q^2\]\[5a+q=a^2+2aq+4q^2\]Substitute $q=0,1,2,3,4$ into the last equation and then solve for $a$.

When $q=0$, we get $a=5$. Thus $c=0$ and $b=5$. We get that $N=550$ which works.

When $q=1$, we get that $a$ is not an integer. There is no $N$ for this case.

When $q=2$, we get that $a$ is not an integer. There is no $N$ for this case.

When $q=3$, we get that $a$ is not an integer. There is no $N$ for this case.

When $q=4$, we get that $a$ is not an integer. There is no $N$ for this case.


Case $2$: Let $b = a + c - 11$. We get\[100a+c+10a+10c -110= 11(a^2+(a+c)^2-22(a+c)+c^2+121)\]\[10a+c=2a^2+2c^2+2ac-22a-22c+131\]\[2(a-8)^2+2(c-\frac{23}{4})^2+2ac-\frac{505}{8}=0\]Now we test all $c=0\rightarrow10$. When $c=0,1,2,4,5,6,7,8,9$, we get no integer solution to $a$. Thus, for these values of $c$, there is no valid $N$. However, when $c=3$, we get\[2(a-8)^2+2(3-\frac{23}{4})^2+6a-\frac{505}{8}=0\]\[2(a-8)^2+6a-48 = 0\]We get that $a=8$ is a valid solution. For this case, we get $a=8,b=0,c=3$, so $N=803$, and this is a valid value. Thus, the answers are $550$ and $803$. So the sum is $1353$.",1353,number theory
1960p2,"Give the maximum integer value of the variable $x$ does the following inequality hold:

\[\dfrac{4x^2}{(1 - \sqrt {2x + 1})^2} < 2x + 9 \]

","Set $x = -\frac{1}{2} + \frac{a^2}{2}$, where $a\ge0$. $\frac{4\left(-\frac{1}{2}+\frac{a^2}{2}\right)^2}{\left(1-\sqrt{1+2\left(-\frac{1}{2}+\frac{a^2}{2}\right)}\right)^2}<2\left(-\frac{1}{2}+\frac{a^2}{2}\right)+9$

After simplifying, we get $(a+1)^2<a^2+8$

So $a^2+2a+1<a^2+8$

Which gives $a<\frac{7}{2}$ and hence $-\frac{1}{2} \le x<\frac{45}{8}$. So the maximum integer $x$ is $5$.

But $x=0$ makes the LHS indeterminate.

So, answer: $-\frac{1}{2} \le x<\frac{45}{8}$, except $x=0$.

Solution 2",5,algebra
1960p6,"Consider a cone of revolution with an inscribed sphere tangent to the base of the cone. A cylinder is circumscribed about this sphere so that one of its bases lies in the base of the cone. Let $V_1$ be the volume of the cone and $V_2$ be the volume of the cylinder. Find the smallest number $k$ for which $V_1 = kV_2$; for this case, construct the angle subtended by a diamter of the base of the cone at the vertex of the cone, give the value of $3k$.","Let $R$ denote the radius of the cone, and let $r$ denote the radius of the cylinder and sphere. Let $l$ denote the slant height of the cone, and let $h$ denote the height of the cone.

Consider a plane that contains the axis of the cone. This plane will slice the cone and sphere into a circle $\omega$ inscribed in an isosceles triangle $T$.

The area of $T$ may be computed in two different ways:\[[T] = \frac{1}{2} \times r \times (2l + 2R) = r(l+R)\]\[[T] = \frac{1}{2} \times 2R \times h = Rh\]From this, we deduce that $r = \frac{Rh}{l+R}$.

Now, we calculate our volumes:\[V_1 = \frac{1}{3}\pi R^2 h\]\[V_2 = \pi r^2 \times 2r = 2\pi r^3 = \frac{2R^3 h^3}{(l+R)^3}\]Now, we will compute the quantity $\frac{3(l+R)^3}{\pi R^5 h} (V_1 - V_2)$ and prove that it is always greater than $0$. Let $x = \frac{h}{R}$. Clearly, $x$ can be any positive real number. Define $W_1 = \frac{3(l+R)^3}{\pi R^5 h} V_1$ and $W_2 = \frac{3(l+R)^3}{\pi R^5 h} V_2$. We will calculate $W_1$ and $W_2$ in terms of $x$ and then compute the desired quantity $W_1 - W_2$.

It is easy to see that:\[W_1 = (\sqrt{x^2+1} + 1)^3\]\[W_2 = 6x^2\]

Now, let $u = \sqrt{x^2+1}$. Since $x > 0$, it follows that $u > 1$. We now have:\[W_1 = (u + 1)^3\]\[W_2 = 6(u^2 - 1)\]

Define $f(u) = W_1 - W_2$. It follows that:\[f(u) = (u+1)^3 - 6(u^2 - 1)\]\[f(u) = u^3 - 3u^2 + 3u + 7\]\[f(u) = (u-1)^3 + 8 > 8 > 0\]

We see that $f(u) > 8$ for all allowed values of $u$. Thus, $V_1 - V_2 > \frac{8\pi R^5 h}{3(l+R)^3}$, meaning that $V_1 > V_2$. We have thus proved that $V_1 \ne V_2$, as desired.

From our earlier work in calculating the volumes $V_1$ and $V_2$, we easily see that:\[\frac{V_1}{V_2} = \frac{(u+1)^3}{6(u^2 - 1)}\]Re-expressing and simplifying, we have:\[\frac{6V_1}{V_2} = \frac{(u+1)^2}{u-1} = (u-1) + 4 + \frac{4}{u-1}\]By the AM-GM Inequality, $(u-1) + \frac{4}{u-1} \ge 4$, meaning that $\frac{V_1}{V_2} \ge \frac{4}{3}$. Equality holds if and only if $u-1 = \frac{4}{u-1}$, meaning that $u=3$ and $x = 2\sqrt{2}$.

If we check the case $x = \frac{h}{R} = 2\sqrt{2}$, we may calculate $V_1$ and $V_2$:\[V_1 = \frac{1}{3} \pi R^2 h = \frac{2\sqrt{2}}{3}\pi R^3\]\[V_2 = 2\pi r^3 = 2\pi \left(\frac{R\times 2\sqrt{2} R}{4R}\right)^3 = \frac{\pi}{\sqrt{2}} R^3\]Indeed, we have $\frac{V_1}{V_2} = \frac{4}{3}$, meaning that our minimum of $k = \frac{4}{3}$ can be achieved.

Thus, we have proved that the minimum value of $k$ such that $V_1 = kV_2$ is $\frac{4}{3}$.

Now, let $\theta$ be the angle subtended by a diameter of the base of the cone at the vertex of the cone. We have the following:\[\tan\left(\frac{\theta}{2}\right) = \frac{1}{x} = \frac{\sqrt{2}}{4}\]From the double-angle formula for tangent,\[\theta = \arctan\left(\frac{4\sqrt{2}}{7}\right)\]This angle is easy to construct. Simply take any segment and treat it as a unit segment. Create a right triangle with legs of lengths $4\sqrt{2}$ and $7$. This is straightforward, and the angle opposite the leg of length $4\sqrt{2}$ will be the desired angle $\theta$.

It follows that we have successfully constructed the desired angle $\theta$. So the value of $3k$ is $4$.",4,geometry
1959p2,"For what real values of $x$ is

$\sqrt{x+\sqrt{2x-1}} + \sqrt{x-\sqrt{2x-1}} = A,$

given $A=2$, where only non-negative real numbers are admitted for square roots? Give the value of $2x$","The square roots imply that $x\ge \frac{1}{2}$.

Square both sides of the given equation:\[A^2 = \Big( x + \sqrt{2x - 1}\Big) + 2 \sqrt{x + \sqrt{2x - 1}}  \sqrt{x - \sqrt{2x - 1}} +  \Big( x - \sqrt{2x - 1}\Big)\]

Add the first and the last terms to get:\[A^2 = 2x + 2 \sqrt{x + \sqrt{2x - 1}}  \sqrt{x - \sqrt{2x - 1}}\]

Multiply the middle terms, and use $(a + b)(a - b) = a^2 - b^2$ to get:\[A^2 = 2x + 2 \sqrt{x^2 - 2x + 1}\]

Since the term inside the square root is a perfect square, and by factoring 2 out, we get\[A^2 = 2(x + \sqrt{(x-1)^2})\]Use the property that $\sqrt{x^2}=|x|$ to get\[A^2 = 2(x+|x-1|)\]

Case I: If $x \le 1$, then $|x-1| = 1 - x$, and the equation reduces to $A^2 = 2$. This is precisely part (a) of the question, for which the valid interval is now $x \in \left[ \frac{1}{2}, 1 \right]$

Case II: If $x > 1$, then $|x-1| = x - 1$ and we have\[x = \frac{A^2 + 2}{4} > 1\]which simplifies to\[A^2 > 2\]

This tells there that there is no solution for (b), since we must have $A^2 \ge 2$

For (c), we have $A = 2$, which means that $A^2 = 4$, so the only solution is $x=\frac{3}{2}$. So the value of $2x$ is $3$",3,algebra